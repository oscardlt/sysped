      ************************************************************************
      *  budsjett feil
      ************************************************************************
     FKOSTB     IF   E           K DISK
     FSYGE71FM  CF   E             WORKSTN
     FKOSBU12   IF   E           K DISK
     FTRAPRAV   IF   E           K DISK
     FDOKUF     IF   E           K DISK
     D                 DS
     D  TRVK01                 1      5  0
     D  TRVK02                 6     10  0
     D  TRVK03                11     15  0
     D  TRVK04                16     20  0
     D  TRVK05                21     25  0
     D  TRVK06                26     30  0
     D  TRVK07                31     35  0
     D  TRVK08                36     40  0
     D  TRVK09                41     45  0
     D  TRVK10                46     50  0
     D  TRVK11                51     55  0
     D  TRVK12                56     60  0
     D  FV                     1     60  0
     D                                     DIM(12) ASCEND                       VEKTGR. AVTALE
     D                 DS
     D  TRPA01                 1      3  1
     D  TRPA02                 4      6  1
     D  TRPA03                 7      9  1
     D  TRPA04                10     12  1
     D  TRPA05                13     15  1
     D  TRPA06                16     18  1
     D  TRPA07                19     21  1
     D  TRPA08                22     24  1
     D  TRPA09                25     27  1
     D  TRPA10                28     30  1
     D  TRPA11                31     33  1
     D  TRPA12                34     36  1
     D  FP                     1     36  1
     D                                     DIM(12)                              VEKTGR. AVTALE
      *
     c                   z-add     2000191       bil7              7 0
     c     bil7          chain     kostb                              33
     c                   exsr      init
      *
     c     start         tag
     c                   exfmt     BILDE01
N04  C     butnr         chain     traprav                            33
n04  c     *in33         ifeq      '0'
     c                   z-add     dfvkt         vekt5             5 0
     c                   z-add     1             xn                2 0
     C     vekt5         LOOKUP    FV(XN)                             76  76
     c     *in76         ifeq      '1'
     c                   z-add     FP(XN)        upros
     c                   z-sub     FP(XN)        uprosn            3 1
     c                   move      'N'           feil1
n04  c     kbdiff        ifgt      upros
N04  c                   move      'J'           feil1
N04  C                   end
n04  c     kbdiff        iflt      uprosn
N04  c                   move      'J'           feil1
N04  C                   end
N04  C                   end
     C                   END
     c  n03              goto      start
     c                   seton                                        lr
     c                   return
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C*    *entry        plist
n04  C*                  parm                    kbavd             4 0
n04  C*                  parm                    kbopd             7 0
n04  C*                  parm                    kbvk              3
n04  c*                  parm                    kbblhb           13 2
n04  c*                  parm                    kbbuds           13 2
n04  c*                  parm                    kbblf            13 2
n04  c*                  parm                    upros             3 1
n04  c*                  parm                    kbdiff            5 2
     C*                  parm                    feil1             1
      *
N04  C     DOKUFK        KLIST
     C                   KFLD                    DFRI
N04  C                   KFLD                    KBAVD
N04  C                   KFLD                    KBOPD
     C                   KFLD                    DFFBNR
     c                   z-add     1             dffbnr
     c                   move      'F'           DFRI
      *
N04  c     KBBLHB        ifne      0
N04  C     KBBLHB        DIV(h)    KBBUDS        work             12 2
N04  C                   mult      100           work             12 2
     C                   sub       100           work
N04  C                   z-add     work          KBDIFF            5 2
n04  c                   else
n04  c                   z-add     100           KBDIFF
n04  c                   end
N04  C     DOKUFK        CHAIN     DOKUF                              33
     C                   ENDSR
