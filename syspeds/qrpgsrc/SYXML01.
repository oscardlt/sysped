      *
      ***********************************************************
      *** PROGRAM SKAL SENDE XML-FAKTURA                      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 31       64-69             ***
      ***********************************************************
     FXMLUFL01  UF   E           K DISK
     FFIRM      IF   E           K DISK
     FFAIN      IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FFAKT      IF   E           K DISK    USROPN
     FEDIC      UF A E             DISK    USROPN
     FEDIS      O  A E             DISK    USROPN
     FEDIM      O  A E             DISK    USROPN
     FEDISE     O  A E             DISK    USROPN
     D TXT             S             80    DIM(100) CTDATA PERRCD(1)
     D                 DS
     D  XMBR                   1     10
     D  XMBRA                  1      1
     D  XMBRB                  2      8S 0
     D                 DS
     D  SDATA                  1     80
     D  SD80                   1     80    DIM(80)
     D                 DS
     D  XXA80                  1     80
     D  A80                    1     80    DIM(80)
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C     XMLUFL01K     SETLL     XMLULF01
     C     XMLUFL01K     READE     XMLULF01                               33
     C   33              GOTO      SLUTT
      *
     C                   EXSR      SRINIT
      *
     C                   EXSR      SRSTART
     C                   DOW       *IN33 = *OFF
     C                   EXSR      SRNESTE
     C     XMLUFL01K     READE     XMLULF01                               33
     C  N33              IF        XFKN <> XXKN
     C                   LEAVE
     C                   END
     C  N33              ENDDO
     C                   EXSR      SRSLUTT
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SRINIT        BEGSR
      ***********************************************
     C                   OPEN      FAIN
     C                   OPEN      HEADF
     C                   OPEN      FAKT
     C                   OPEN      EDIC
     C                   OPEN      EDIS
     C                   OPEN      EDIM
     C                   OPEN      EDISE
      *
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
      *
     C                   MOVE      XFKN          XXKN              8 0
     C                   MOVE      *BLANKS       XXA80            80
     C                   MOVE      *ZEROS        XXAN01            1 0
     C                   Z-ADD     1             XNPOS             3 0
     C                   MOVE      *BLANKS       XMBR
     C                   MOVE      'F'           XMBRA
     C                   MOVE      CSN           XMBRB
     C                   MOVE      XMBR          SEMBR
     C                   MOVE      *BLANKS       SDATA
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSTART       BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
     C                   EVAL      XXA80 = TXT(1)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(2)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(3)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(4)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(5)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(6)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(7)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(8)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(9)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(10)
     C                   EXSR      SRCAT
      *
     C                   OPEN      FAKT
     C                   OPEN      EDIC
     C                   OPEN      EDIS
     C                   OPEN      EDIM
     C                   OPEN      EDISE
      *
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
      *
     C                   MOVE      *BLANKS       XMBR
     C                   MOVE      'F'           XMBRA
     C                   MOVE      CSN           XMBRB
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left            SRCAT
      *////////////////////////////////////////////////////////////
     C     SRCAT         BEGSR
      *
     C                   Z-ADD     80            XN                3 0
     C                   DOW       XN > 1
     C                   IF        A80(XN) <> ' '
     C                   LEAVE
     C                   END
     C                   ENDDO
      *
     C     1             DO        XN            XN2               3 0
     C                   IF        XNPOS = 80
     C                   WRITE     EDIRER
     C                   Z-ADD     1             XNPOS
     C                   ELSE
     C                   ADD       1             XNPOS
     C                   ENDIF
     C                   MOVE      A80(XN2)      SD80(XNPOS)
     C                   ENDDO
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     XMLUFL01K     KLIST
     C                   KFLD                    XFST
     C                   KFLD                    FIFIRM
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
**
<?xml version="1.0" endcoding="ISO-8859-1"?>                                    001
<?xml-stylesheet type="text/xsl" href="PIC_Viewer1.xsl1"?>                      002
<PostenInterchange xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"        003
xsi=noNamespaceSchemaLocation="http://efaktura.test.posten.no/PostenMessage-    004
Invoice-PS14C-rev3.xsd>                                                         005
<InterchangeType>PostenInterchange</InterchangeType>                            006
<Version>1.4-rev3</Version>                                                     007
<CustomerImplementation code="PS-14">PostenMessage-Invoice-PS14C-rev3.xsd       008
</CustomerImplementation>                                                       009
<Originator>                                                                    010
</Originator>                                                                   011
<Address>                                                                       012
</Address>                                                                      013
<SubAddress/>                                                                   014
<AddressQualifier>                                                              015
</AddressQualifier>                                                             016
<Recipient>                                                                     017
</Recipient>                                                                    018
<InterchangeId>                                                                 019
</InterchangeId>                                                                020
<InterchangeTime>                                                               021
</InterchangeTime>                                                              022
<Date                                                                           023
<Time fraction="                                                                027
" hour="                                                                        028
" minute="                                                                      029
" second="                                                                      030
"/>                                                                             031
<ReceiptNotificationRequest>                                                    032
</ReceiptNotificationRequest>                                                   033
<ReceiptType code="PSI-14">PostenInterchange-Generic-PS14C-rev3.xsd             034
</ReceiptType>                                                                  035
<ReceiptNotificationReference>UTV-1</ReceiptNotificationReference>              036
<ProcessInstructions>                                                           037
</ProcessInstructions>                                                          038
<Instruction>                                                                   039
</Instruction>                                                                  040
<PIValueParameter                                                               041
</PIValueParameter                                                              042
<PIComplexParameter                                                             043
</PIComplexParameter>                                                           044
<PIAttribute                                                                    045
</PIAttribute                                                                   046
<FormatOptions>                                                                 047
</FormatOptions>                                                                048
<Option>                                                                        049
</Option>                                                                       050
<FOValueParameter                                                               051
</FOValueParameter                                                              052
<FOComplexParameter                                                             053
</FOComplexParameter                                                            054
<FOAttribute                                                                    055
</FOAttribute                                                                   056
<FOValue>                                                                       057
</FOValue>                                                                      058
<CustomContent>                                                                 059
</CustomContent>                                                                060
<EncodedBinary encoding="BASE64"/>                                              061
<eMessage>                                                                      062
</eMessage>                                                                     063
<MessageType>                                                                   064
</MessageType>                                                                  065
<MessageVersion>
</MessageVersion>
<DocumentType>
</DocumentType>
<DocumentCode>
</DocumentCode>
<DocumentDescriptiveName>
</DocumentDescriptiveName>
<MessageReference>
</MessageReference>
<MessageOriginator>
</MessageOriginator>
<MessageRecipient>
</MessageRecipient>
<ReceiptNotificationRequest>
</ReceiptNotificationRequest>
<ReceiptType code="PSM-14">PostenInterchange-Generic-PS14C-rev3.xsd
</ReceiptType>
<ReceiptNotificationReference>
</ReceiptNotificationReference>
<ProcessInstructions>
</ProcessInstructions>
<Instruction>
</Instruction>
<PIValueParameter
</PIValueParameter
<MessageAttachments>
</MessageAttachments>
<AttachmentIndicator>
</AttachmentIndicator>
<Attachment
</Attachment
<AttachmentNumber>
</AttachmentNumber>
<CopyIndicator>
</CopyIndicator>
<AttachmentType>
</AttachmentType>
<AttachmentName
</AttachmentName
<AttachmentLocation>
</AttachmentLocation>
<AttachmentArchive
</AttachmentArchive
<LocationURI
</LocationURI
<CustomContent
</CustomContent
<MessageContent>
</MessageContent>
<Invoice>
</Invoice>
<InvoiceDates>
</InvoiceDates>
<InvoiceDate
<DueDate
<OrderDate
<ReqDeliveryDate
<ConfDeliveryDate
<ActualDeliveryDate
<InvoiceReferences>
</InvoiceReferences>
<InvoiceNo>
</InvoiceNo>
<InvoiceeRef>
</InvoiceeRef>
<InvoiceRefNo>
</InvoiceRefNo>
<ConsignmentNo>
</ConsignmentNo>
<BuyerOrderNo>
</BuyerOrderNo>
<SellerOrderNo>
</SellerOrderNo>
<RequisitionNo>
</RequisitionNo>
<DispatchAdviceNo>
</DispatchAdviceNo>
<OtherReferences
</OtherReferences
day="
" month="                                                                       024
" year="                                                                        025
name="
" value="
"/>
">
