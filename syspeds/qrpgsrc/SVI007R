********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10112 * 01 CB  PTF10 Lengre og flere R44
10170 * 02 CB  PTF10 Legg ut oppdragsnummer i ARKIVP
10170 * 03 sh  PTF10 Legg ut avsenders mottaker i arkivet
10170 * 04 CB  PTF10 Extra mængdenhet 999 999 999 = 0
10XXX * 05 CB  PTF10 Repetition av R44
P11081* 06 CB  PTF11  Varubeskrivelse 2
********************************************************************
     FSVIV      IF   E           K DISK
     FSVIVA     IF   E           K DISK
     FSVIH      IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FSVI007P   O    E             PRINTER OFLIND(*IN27) USROPN
     FFIRM      IF   E             DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E           K DISK
     D                SDS
     D  ZUSER                254    263
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN154                  1     15  4
     D  ØA154H                 1     11
     D  ØA154D                12     15
     D                 DS
     D  ØA16                   1     16
     D  Ø16                    1     16
     D                                     DIM(16)                              Num edit
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVIHASYAV         4
     C                   PARM                    UVIHASYOP         7
     C                   PARM                    CALLTYP           1
     C                   MOVE      UVIHASYAV     UVIH_SYAV
     C                   MOVE      UVIHASYOP     UVIH_SYOP
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SVIH_SYAV     UVIH_SYAV
     C     *LIKE         DEFINE    SVIH_SYOP     UVIH_SYOP
     C     *LIKE         DEFINE    KOPUNI        UOPUNI
     C     *LIKE         DEFINE    KOPAVD        UOPAVD
     C     *LIKE         DEFINE    KOPLNR        UOPLNR
     C     *LIKE         DEFINE    KFMSD         UFMSD
N06  C                   Z-ADD     0             ØX                2 0
N06  C                   MOVE      *BLANKS       ØAN              12
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
     C     KEYB          KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
     C                   KFLD                    SVIV_SYLI
     C     KEYP          KLIST
     C                   KFLD                    UOPUNI
     C                   KFLD                    UOPAVD
     C                   KFLD                    UOPLNR
     C     KEYF          KLIST
     C                   KFLD                    KOPFM
     C                   KFLD                    UFMSD
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C                   EVAL      UOPUNI='P'
     C                   EVAL      UOPAVD=UVIH_SYAV
     C                   EVAL      UOPLNR=252
     C                   EVAL      UFMSD=1
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD           1024
      *______________________________________
      * Hente firmaopplysninger fra spedisjon
      *""""""""""""""""""""""""""""""""""""""
     C                   READ      FIRM
      *_____________________
      * Hente printerstyring
      *"""""""""""""""""""""
     C     KEYP          CHAIN     KODTP
     C     KEYF          CHAIN     KODTFM
      *_______________
      * Printerstyring
      *"""""""""""""""
     C     CALLTYP       IFEQ      'A'
     C                   CALL      'SVI007CA'
     C                   ELSE
     C                   EVAL      UCMD='OVRPRTF FILE(SVI007P) OUTQ('
     C     UCMD          CAT       KOPNVN:0      UCMD
     C     UCMD          CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   ENDIF
     C                   OPEN      SVI007P
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Læs varuposter                                       SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     SVIH
     C                   WRITE     SVI007PA

     C     KEYA          SETLL     SVIV
     C     KEYA          READE     SVIV                                   51
     C     *IN51         DOWEQ     *OFF
     C                   EVAL      WRUBR32=SVIV_VANO
     C                   MOVEL     SVIV_VATA     WRUBR33A
     C                   MOVE      SVIV_VATA     WRUBR33B
     C                   EVAL      WRUBR33C=SVIV_VATI
     C                   EVAL      WRUBR34=SVIV_ULKD
     C                   EVAL      WRUBR37A=SVIV_EUP1
     C                   MOVEL     SVIV_EUP2     WRUBR37B
     C                   EVAL      WRUBR36=SVIV_FOKD
     C                   EVAL      WRUBR39=SVIV_KVOT
     C                   EVAL      WRUBR35=SVIV_BRUT
     C                   EVAL      WRUBR38=SVIV_NETO
     C                   EVAL      WRUBR31=SVIV_GODM
S06  C*                  EVAL      WRUBR31B=SVIV_VASL
N06  C                   EVAL      WRUBR31B=*BLANKS
N06  C                   EVAL      WRUBR31C=*BLANKS
N06  C                   EVAL      ØN154=SVIV_KOTA
N06  C                   EXSR      SRNE
N06  C                   MOVEL     ØAN           WRUBR31B
N06  C     WRUBR31B      CAT       SVIV_KOSL:1   WRUBR31B
N06  C     WRUBR31B      CAT       SVIV_VASL:1   WRUBR31B
N06  C                   EVAL      WRUBR31C=SVIV_VAS2
     C                   EVAL      WRUBR41=SVIV_ANKV
N04  C                   IF        WRUBR41=999999999
N04  C                   EVAL      WRUBR41=*ZEROS
N04  C                   ENDIF
     C                   EVAL      WRUBR46=SVIV_STVA
S01  C*                  EVAL      WRUBR44=SVIV_SUTX
N01  C                   MOVEL     SVIV_SUTX     WRUBR44
N01  C     WRUBR44       CAT       SVIV_CO01:1   WRUBR44
N01  C     WRUBR44       CAT       SVIV_CO02:1   WRUBR44

     C                   IF        *IN27
     C                   EVAL      *IN27=*OFF
     C                   WRITE     SVI007PA
     C                   ENDIF
     C                   WRITE     SVI007PB

N05  C                   EXSR      SRBB
     C                   EXSR      SRBA
     C
     C     KEYA          READE     SVIV                                   51
     C                   ENDDO

     C                   WRITE     SVI007PZ
     C     CALLTYP       IFEQ      'C'
     C                   EXSR      ARKSR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Læs avgifter                                        SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
     C     KEYB          SETLL     SVIVA
     C     KEYB          READE     SVIVA                                  52
     C     *IN52         DOWEQ     *OFF

     C                   EVAL      WRUBR47A=SVIVA_ABK
     C                   EVAL      WRUBR47B=SVIVA_ABG
     C                   EVAL      WRUBR47C=SVIVA_ABS
     C                   EVAL      WRUBR47D=SVIVA_ABB

     C                   IF        *IN27
     C                   EVAL      *IN27=*OFF
     C                   WRITE     SVI007PA
     C                   ENDIF
     C                   WRITE     SVI007PC
     C
     C     KEYB          READE     SVIVA                                  52
     C                   ENDDO
     C                   ENDSR
N05   *////////////////////////////////////////////////////////////
N05   *  Skriv R44                                           SRBB /
N05   *////////////////////////////////////////////////////////////
N05  C     SRBB          BEGSR
N05
N05   * Særskilda upplysningar-1
N05  C     SVIV_SUKO     IFNE      *BLANKS
N05  C     SVIV_SUTX     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUKO     WRUBR44
N05  C     WRUBR44       CAT       SVIV_SUTX:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-2
N05  C     SVIV_SUT2     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT2     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-3
N05  C     SVIV_SUT3     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT3     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-4
N05  C     SVIV_SUT4     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT4     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-5
N05  C     SVIV_SUT5     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT5     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-6
N05  C     SVIV_SUK6     IFNE      *BLANKS
N05  C     SVIV_SUT6     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUK6     WRUBR44
N05  C     WRUBR44       CAT       SVIV_SUT6:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-7
N05  C     SVIV_SUT7     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT7     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-8
N05  C     SVIV_SUT8     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT8     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-9
N05  C     SVIV_SUT9     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUT9     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-10
N05  C     SVIV_SUTA     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUTA     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-11
N05  C     SVIV_SUKB     IFNE      *BLANKS
N05  C     SVIV_SUTB     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUKB     WRUBR44
N05  C     WRUBR44       CAT       SVIV_SUTB:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-12
N05  C     SVIV_SUTC     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUTC     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-13
N05  C     SVIV_SUTD     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUTD     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-14
N05  C     SVIV_SUTE     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUTE     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Særskilda upplysningar-15
N05  C     SVIV_SUTF     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_SUTF     WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-1
N05  C     SVIV_BIT1     IFNE      *BLANKS
N05  C     SVIV_BII1     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT1     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII1:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-2
N05  C     SVIV_BIT2     IFNE      *BLANKS
N05  C     SVIV_BII2     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT2     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII2:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-3
N05  C     SVIV_BIT3     IFNE      *BLANKS
N05  C     SVIV_BII3     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT3     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII3:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-4
N05  C     SVIV_BIT4     IFNE      *BLANKS
N05  C     SVIV_BII4     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT4     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII4:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-5
N05  C     SVIV_BIT5     IFNE      *BLANKS
N05  C     SVIV_BII5     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT5     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII5:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-6
N05  C     SVIV_BIT6     IFNE      *BLANKS
N05  C     SVIV_BII6     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT6     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII6:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-7
N05  C     SVIV_BIT7     IFNE      *BLANKS
N05  C     SVIV_BII7     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT7     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII7:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-8
N05  C     SVIV_BIT8     IFNE      *BLANKS
N05  C     SVIV_BII8     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT8     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII8:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Bilagda handlingar-9
N05  C     SVIV_BIT9     IFNE      *BLANKS
N05  C     SVIV_BII9     ORNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_BIT9     WRUBR44
N05  C     WRUBR44       CAT       SVIV_BII9:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Container 1 - 4
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_CO01     WRUBR44
N05  C     WRUBR44       CAT       SVIV_CO02:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_CO03:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_CO04:1   WRUBR44
N05  C     WRUBR44       IFNE      *BLANKS
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Container 5 - 8
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_CO05     WRUBR44
N05  C     WRUBR44       CAT       SVIV_CO06:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_CO07:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_CO08:1   WRUBR44
N05  C     WRUBR44       IFNE      *BLANKS
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Tidigare handlingar-1
N05  C     SVIV_TIX1     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_TIK1     WRUBR44
N05  C     WRUBR44       CAT       SVIV_TIT1:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_TIX1:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * Tidigare handlingar-2
N05  C     SVIV_TIX2     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_TIK2     WRUBR44
N05  C     WRUBR44       CAT       SVIV_TIT2:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_TIX2:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05   * LagerID
N05  C     SVIV_LAGI     IFNE      *BLANKS
N05  C                   EVAL      WRUBR44=*BLANKS
N05  C                   MOVEL     SVIV_LAGT     WRUBR44
N05  C     WRUBR44       CAT       SVIV_LAGL:1   WRUBR44
N05  C     WRUBR44       CAT       SVIV_LAGI:1   WRUBR44
N05  C                   IF        *IN27
N05  C                   EVAL      *IN27=*OFF
N05  C                   WRITE     SVI007PA
N05  C                   ENDIF
N05  C                   WRITE     SVI007PD
N05  C                   ENDIF
N05  C
N05  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *    Arkiver                                          ARKSR /
      /////////////////////////////////////////////////////////////
     C     ARKSR         BEGSR
      * SKAL DOKUMENT ARKIVERES ?
     C                   MOVE      'S1'          ARTYPE
     C     FIFIRM        CHAIN     FIRMARC                            34
     C  N34ARTYPE        CHAIN     ARKTXT                             34
     C     *IN(34)       IFEQ      '0'
     C     ARKJN         ANDEQ     'J'

s03  C*                  z-add     SVIH_MOKN     ARKUND
n03  C                   z-add     SVIH_AVKN     ARKUND
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      UVIH_SYAV     ARAVD
S02  C*                  MOVE      *ZEROS        AROPD
N02  C                   MOVE      UVIH_SYOP     AROPD
     C                   MOVE      WDT           ARDATE
     C                   MOVE      WTM           ARTIME
     C                   MOVE      ZUSER         ARUSER
     C                   MOVE      UVIH_SYOP     ARUNDE
     C                   MOVEL     'S1:'         ARUNDE
     C                   WRITE     ARKIVR
     C                   ENDIF
     C                   ENDSR
N06   *////////////////////////////////////////////////////////////
N06   *  Venstrestill numeriske verdier                      SRNE /
N06   *////////////////////////////////////////////////////////////
N06  C     SRNE          BEGSR
N06   * Flytte in rett verdi i Alfa 12-felt
N06  C                   MOVE      *ZEROS        ØA16
N06  C     ØA154D        IFEQ      '0000'                                       <-------------I
N06  C                   MOVE      ØA154H        ØA16                                         I
N06  C                   ELSE                                                   <-------------I
N06  C                   MOVEL     ØA154H        ØA16                                         I
N06  C                   MOVE      '.    '       ØA16                                         I
N06  C                   MOVE      ØA154D        ØA16                                         I
N06  C     Ø16(16)       IFEQ      '0'
N06  C                   MOVE      ' '           Ø16(16)
N06  C     Ø16(15)       IFEQ      '0'
N06  C                   MOVE      ' '           Ø16(15)
N06  C                   END
N06  C                   END
N06  C                   END                                                    <-------------I
N06   * lete fra venstre og finn foerste siffer over 0
N06  C     1             DO        15            ØX                             <-------------I
N06  C     Ø16(ØX)       IFNE      '0'                                           <-----------II
N06  C                   GOTO      SRNE1                                                     II
N06  C                   END                                                     <-----------II
N06  C                   END                                                    <-------------I
N06  C     SRNE1         TAG
N06   * Venstrestill til et nytt felt
N06  C                   MOVE      *BLANKS       ØAN
N06  C                   MOVEA     Ø16(ØX)       ØAN
N06   *
N06  C                   ENDSR
