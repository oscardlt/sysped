     FSVTX15F   IF   E           K DISK
     FSVTX08F2  IF   E           K DISK
     FSVTX01F   IF   E           K DISK
     FSVTX03F   IF   E           K DISK
     D  WT             S              4    DIM(99)
     D                 DS
     D  W                      1     10
     D  W9                     9     10
     D  W7                     7     10
     D  W5                     5     10
     D  W3                     3     10
     D                 DS
     D  WDT                    1      8
     D  WDTY                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  WD                     1     10
     D  WDY                    1      4
     D  WD1                    5      5
     D  WDM                    6      7
     D  WD2                    8      8
     D  WDD                    9     10
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EXSR      SRD
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVTA_IE           2
     C                   PARM                    UVTX15_01
     C                   PARM                    ULK               2
     C                   PARM                    UTKOD1            4
     C                   PARM                    UTTXT1          100
     C                   PARM                    UTKOD2            4
     C                   PARM                    UTTXT2          100
     C                   PARM                    UTKOD3            4
     C                   PARM                    UTTXT3          100
     C                   PARM                    UTKOD4            4
     C                   PARM                    UTTXT4          100
     C                   PARM                    UTKOD5            4
     C                   PARM                    UTTXT5          100
     C                   PARM                    UTKOD6            4
     C                   PARM                    UTTXT6          100
     C                   PARM                    UTKOD7            4
     C                   PARM                    UTTXT7          100
     C                   PARM                    UTKOD8            4
     C                   PARM                    UTTXT8          100
     C                   PARM                    UTKOD9            4
     C                   PARM                    UTTXT9          100
      *________________
      * Arbetsvariablar
      *""""""""""""""""
     C     *LIKE         DEFINE    SVTX15_08     WVKD_KD1
     C     *LIKE         DEFINE    SVTX15_09     WVKD_KD2
     C     *LIKE         DEFINE    SVTX15_01     UVTX15_01
     C     *LIKE         DEFINE    SVTX15_01     WVTX15_01
     C     *LIKE         DEFINE    SVTX03_01     WIE
     C     *LIKE         DEFINE    SVTX03_02     WTYP
     C     *LIKE         DEFINE    SVTX03_03     WKOD
     C                   EVAL      WVTX15_01=UVTX15_01
     C                   Z-ADD     0             WTN               2 0
     C                   MOVEL     ULK           WULK              4
     C                   EVAL      WIE=UVTA_IE
     C                   EVAL      WTYP='MTT'
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     SVTLKKEY      KLIST
     C                   KFLD                    WULK
     C                   KFLD                    SVTX15_02
     C     SVTX01K       KLIST
     C                   KFLD                    WVKD_KD1
     C                   KFLD                    WVKD_KD2
     C     SVTX03K       KLIST
     C                   KFLD                    WIE
     C                   KFLD                    WTYP
     C                   KFLD                    WKOD
      *_________________
      * Hent dagens dato
      *"""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   EVAL      WD1='-'
     C                   EVAL      WD2='-'
     C                   EVAL      WDY=WDTY
     C                   EVAL      WDM=WDTM
     C                   EVAL      WDD=WDTD
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Finnes tillæggskoder ?                               SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C                   EVAL      W=UVTX15_01
     C                   EVAL      WVTX15_01=W
     C                   EXSR      SRC

     C                   EVAL      W=UVTX15_01
     C     W9            IFNE      '00'
     C                   EVAL      W9='00'
     C                   EVAL      WVTX15_01=W
     C                   EXSR      SRC
     C                   ENDIF

     C                   EVAL      W=UVTX15_01
     C     W7            IFNE      '0000'
     C                   EVAL      W7='0000'
     C                   EVAL      WVTX15_01=W
     C                   EXSR      SRC
     C                   ENDIF

     C                   EVAL      W=UVTX15_01
     C     W5            IFNE      '000000'
     C                   EVAL      W5='000000'
     C                   EVAL      WVTX15_01=W
     C                   EXSR      SRC
     C                   ENDIF

     C                   EVAL      W=UVTX15_01
     C     W3            IFNE      '00000000'
     C                   EVAL      W3='00000000'
     C                   EVAL      WVTX15_01=W
     C                   EXSR      SRC
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Finns tillæggskoder ?                                SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
     C                   EVAL      *IN55=*OFF
     C     WVTX15_01     SETLL     SVTX15F
     C     WVTX15_01     READE     SVTX15F                                55
     C     *IN55         DOWEQ     *OFF
      * Tillæggskod ?
     C     SVTX15_08     CABEQ     *BLANKS       SRC2
     C     SVTX15_09     CABEQ     *BLANKS       SRC2
      * Inga Z-koder på export
     C                   IF        WIE='E'
     C                   IF        SVTX15_08='Z'
     C                   GOTO      SRC2
     C                   ENDIF
     C                   ENDIF
      * Stæmmer datum ?
     C     SVTX15_11     CABGT     WD            SRC2
     C     SVTX15_10     CABLT     WD            SRC2
      * Stæmmer measureType ?
     C                   MOVEL     SVTX15_04     WKOD
     C     SVTX03K       CHAIN     SVTX03F                            56
     C     *IN56         CABEQ     *ON           SRC2
      * Er landkoden riktig ?
     C     SVTX15_02     CABEQ     WULK          SRC1
      * Eller stæmmer regionen ?
     C     SVTLKKEY      CHAIN     SVTX08F2                           56
     C     *IN56         CABEQ     *OFF          SRC1
     C                   GOTO      SRC2
     C     SRC1          TAG
      * Har nå funnet kod, legg inn i array
     C                   MOVEL     SVTX15_08     WT12              4
     C                   MOVE      SVTX15_09     WT12
     C     WT12          LOOKUP    WT                                     58
     C     *IN58         IFEQ      *OFF
     C                   ADD       1             WTN
     C                   MOVEA     WT12          WT(WTN)
     C                   ENDIF

     C     SRC2          TAG
     C     WVTX15_01     READE     SVTX15F                                55
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Avsluta med text till koder                          SRD /
      *////////////////////////////////////////////////////////////
     C     SRD           BEGSR

     C     1             DO        9             WTN

     C                   MOVEL     WT(WTN)       WVKD_KD1
     C                   MOVE      WT(WTN)       WVKD_KD2
     C     SVTX01K       CHAIN     SVTX01F                            57
     C                   IF        *IN57=*ON
     C                   EVAL      SVTX01_03=*BLANKS
     C                   ENDIF

     C                   SELECT
     C
     C     UTKOD1        WHENEQ    *BLANKS
     C                   EVAL      UTKOD1=WT(WTN)
     C                   EVAL      UTTXT1=SVTX01_03
     C
     C     UTKOD2        WHENEQ    *BLANKS
     C                   EVAL      UTKOD2=WT(WTN)
     C                   EVAL      UTTXT2=SVTX01_03
     C
     C     UTKOD3        WHENEQ    *BLANKS
     C                   EVAL      UTKOD3=WT(WTN)
     C                   EVAL      UTTXT3=SVTX01_03
     C
     C     UTKOD4        WHENEQ    *BLANKS
     C                   EVAL      UTKOD4=WT(WTN)
     C                   EVAL      UTTXT4=SVTX01_03
     C
     C     UTKOD5        WHENEQ    *BLANKS
     C                   EVAL      UTKOD5=WT(WTN)
     C                   EVAL      UTTXT5=SVTX01_03
     C
     C     UTKOD6        WHENEQ    *BLANKS
     C                   EVAL      UTKOD6=WT(WTN)
     C                   EVAL      UTTXT6=SVTX01_03
     C
     C     UTKOD7        WHENEQ    *BLANKS
     C                   EVAL      UTKOD7=WT(WTN)
     C                   EVAL      UTTXT7=SVTX01_03
     C
     C     UTKOD8        WHENEQ    *BLANKS
     C                   EVAL      UTKOD8=WT(WTN)
     C                   EVAL      UTTXT8=SVTX01_03
     C
     C     UTKOD9        WHENEQ    *BLANKS
     C                   EVAL      UTKOD9=WT(WTN)
     C                   EVAL      UTTXT9=SVTX01_03
     C
     C                   ENDSL
     C     SRD2          TAG
     C                   ENDDO
     C                   ENDSR
