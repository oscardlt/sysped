/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 12XXX * 01 YBC PTF12 MONITOR PÅ CHGAUT                                  */
/* 12324 * 02 ORG PTF12 Fil til excel endret fra .xls til .xlsx            */
/* ********************************************************************    */
/* VED KOMPILERING ADDLIBLE HSSFCGI */
/* +               ADDLIBLE MMAIL   */
/* SENDE FIL TIL SEG SELV      */
/* I EXCEL FORMAT              */
/* CPYCMD ENDRET               */
/* IKKE BRUK QDLS              */
             PGM        PARM(&FILE &MBR &EPOST &EMNE)
             DCL        VAR(&FILE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MBR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TMPF10) TYPE(*CHAR) LEN(10)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(30)
             DCL        VAR(&EMNE) TYPE(*CHAR) LEN(70)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EPOSTF) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&RPLNA) TYPE(*CHAR) LEN(8) +
                          VALUE('*CURRENT')
             DCL        VAR(&RPLAD) TYPE(*CHAR) LEN(8)
             CHGJOB     CCSID(277)
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             RTVJOBA    USER(&QUSER) NBR(&QNBR)
/*                                                */
/* BESTEMMER STREAMFILE OG EMNE                  */
/*                                                */
/*           CHGVAR     VAR(&STMF) VALUE('/tmp/' *CAT &FILE *TCAT +
                          '.xls') */ /* S02 */
             CHGVAR     VAR(&STMF) VALUE('/tmp/' *CAT &FILE *TCAT +
                          '.xlsx') /* N02 */
             DEL        OBJLNK(&STMF)
             MONMSG     MSGID(CPF0000)
/*                                                */
/* LEGGER TIL XLS VERKTØY                        */
/*                                                */
             ADDLIBLE   LIB(HSSFCGI)
             MONMSG     MSGID(CPF0000)
             TABLEXLS   FROMFILE(&FILE) FROMMBR(&MBR) TOXLS(&STMF)
             MONMSG     MSGID(CPF0000)
/*                                                */
             CHGAUT     OBJ(&STMF) USER(*PUBLIC) DTAAUT(*RWX) +
                          OBJAUT(*ALL)
             MONMSG     MSGID(CPF0000) /*N01*/
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOST) TO(&EPOST/&QUSER/*TO) +
                          STMF(&STMF)
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             RMVLIBLE   LIB(HSSFCGI)
             MONMSG     MSGID(CPF0000)
 SLUTT:      ENDPGM
