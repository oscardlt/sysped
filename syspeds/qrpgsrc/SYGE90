********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 vekt  0  går til vekt 1
********************************************************************
     H DECEDIT(',') debug(*yes)
      ************************************************************************
      *  fordeling på oppdrag
      ************************************************************************
     Fhead11    IF   E           K DISK
     Fwrkfor    UF A E           K DISK
      *
     c                   exsr      init
      *
     c                   exsr      tomm
      *
     c                   exsr      sumvktsr
      *
     c                   exsr      fordel
      *
     c                   seton                                        lr
     c                   return
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     c     *entry        plist
     c                   parm                    uproa             8
     c                   parm                    ubelopa          13
     c                   move      uproa         upro              8 0
     c                   move      ubelopa       ubelop           13 2
     c                   z-add     upro          hepro
     C     turkey        KLIST
     C                   KFLD                    hepro
     C                   ENDSR
      *
      ***********************************************
     C     tomm          BEGSR
      ***********************************************
      *  tømmer evt gamle data
      *
     c                   setoff                                       33
     c     turkey        setll     wrkfor
     c     *in33         doweq     '0'
     c     turkey        reade     wrkfor                                 33
     c  N33              delete    wrkforr
     c                   enddo
     C                   ENDSR
      ***********************************************
     C     sumvktsr      BEGSR
      ***********************************************
      *  summerer fraktvekt
      *
     c                   setoff                                       33
     c     turkey        setll     head11
     c     *in33         doweq     '0'
     c     turkey        reade     head11                                 33
N01  c  N33hefbv         ifeq      0
N01  c                   z-add     1             hefbv
N01  c                   end
     c  N33              add       hefbv         sumvkt           15 2
     c                   enddo
     C                   ENDSR
      ***********************************************
     C     fordel        BEGSR
      ***********************************************
      *  summerer fraktvekt
      *
     c                   setoff                                       33
     c     turkey        setll     head11
     c     *in33         doweq     '0'
     c     turkey        reade     head11                                 33
     c     *in33         ifeq      '0'
N01  c     hefbv         ifeq      0
N01  c                   z-add     1             hefbv
N01  c                   end
     c     hefbv         div       sumvkt        faktor           17 5
     c     ubelop        mult      faktor        heandel          13 2
     c                   write     wrkforr
     c                   add       heandel       sumford          15 2
     c                   endif
     c                   enddo
      *
      * eventuell korriger rest
      *
     c     ubelop        ifne      sumford
     c     turkey        chain     wrkfor                             34
     c     *in34         ifeq      '0'
     c     ubelop        sub       sumford       mangler          15 2
     c     heandel       add       mangler       heandel
     c                   update    wrkforr
     c                   end
     c                   end
     C                   ENDSR
