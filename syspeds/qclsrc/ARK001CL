             PGM        PARM(&FI &SPLF &AAR &PER)
             DCL        VAR(&DATA) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&NBR) TYPE(*DEC) LEN(3) VALUE(0)
             DCL        VAR(&aar) TYPE(*CHAR) LEN(4)
             DCL        VAR(&per) TYPE(*CHAR) LEN(2)
             DCL        VAR(&FI) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SPLF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
/*                      */
/*                      */
/* HENTER JOBBPARAMETER */
/*                      */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &QNBR)
/* LAGER MEMBER WRK     */
/*                      */
             RMVM       FILE(ARKWORK) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(ARKWORK) MBR(&UNIK)
             OVRDBF     FILE(ARKWORK) TOFILE(ARKWORK) MBR(&UNIK)
/*                                     */
/* KOPIERER SPOOLFIL                   */
/* GÅR I LØKKE                         */
/*                                     */
 ARKIV:
/*     Arkivering av DAGBOK                                          */
             CHGVAR     VAR(&NBR) VALUE(&NBR + 1)
             IF         COND(&NBR *GE 900) THEN(GOTO CMDLBL(VIDERE))
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
                                                                  /**/
/*     Hvis feilm. CPF3303, gå til ARKIV og forsøk på nytt          */
/*     Hvis feilm. CPF3344, FLYTTET UTKØ OG FORSØK på nytt          */
/*     Hvis feilm. CPF3309, ingen dagbok finnes, fortsett rutinen   */
                                                                  /**/
             MONMSG     MSGID(CPF3303) EXEC(GOTO CMDLBL(ARKIV))
             MONMSG     MSGID(CPF3344) EXEC(GOTO CMDLBL(ARKIV))
             MONMSG     MSGID(CPF3309) EXEC(RETURN)
             CPYSPLF    FILE(&SPLF) TOFILE(ARKWORK) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(&NBR) +
                          MBROPT(*ADD) CTLCHAR(*PRTCTL)
             MONMSG     MSGID(CPF3303) EXEC(RETURN)
             CHGVAR     VAR(&DATA) VALUE('J')
/*                           */
/* FLYTTER TIL RESPEKTIV KØ  */
/*                           */
/*                      */
/* FAKTURAJORNAL SYSPED */
/*                      */
             IF         COND(&SPLF = 'SYFA35P    ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVJ) SAVE(*YES)
             ENDDO
/* KOSTNADSJOURNAL SYSPED */
             IF         COND(&SPLF = 'SYKS35P    ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVJ) SAVE(*YES)
             ENDDO
/* INTERNOVERFØRING SYSPED */
             IF         COND(&SPLF = 'SYTR35P    ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVJ) SAVE(*YES)
             ENDDO
/* TRANSPORTØRAVREGNING    */
             IF         COND(&SPLF = 'SYKR35P    ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVJ) SAVE(*YES)
             ENDDO
/* DAGBOK LØSNING 1       */
             IF         COND(&SPLF = 'HR940U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVD) SAVE(*YES)
             ENDDO
             IF         COND(&SPLF = 'HR940U10   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVD) SAVE(*YES)
             ENDDO
/* HOVEDBOK LØSNING 1  */
             IF         COND(&SPLF = 'HR040U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVH) SAVE(*YES)
             ENDDO
/* MOMSOPPGJØR LØSNING 1  */
             IF         COND(&SPLF = 'HR140U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVH) SAVE(*YES)
             ENDDO
             IF         COND(&SPLF = 'HR142U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVH) SAVE(*YES)
             ENDDO
/* REORG DEB LØSNING 1  */
             IF         COND(&SPLF = 'VR830U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVR) SAVE(*YES)
             ENDDO
/* OCR DEBITOR   205    */
             IF         COND(&SPLF = 'DR205U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVR) SAVE(*YES)
             ENDDO
/* OCR DEBITOR   210    */
             IF         COND(&SPLF = 'DR210U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVR) SAVE(*YES)
             ENDDO
/* REORG KRE LØSNING 1  */
             IF         COND(&SPLF = 'VR860U01   ') THEN(DO)
             CHGSPLFA   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR) OUTQ(SYARKIVR) SAVE(*YES)
             ENDDO
/* KVITTERINGSLISTE UTBETALINGER  */
             IF         COND(&SPLF = 'KR085U01   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             ENDDO
/* RENTENOTA LØSNING 1 FRIGJØRES   */
             IF         COND(&SPLF = 'DR150U01   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             ENDDO
             IF         COND(&SPLF = 'DR150U04   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             ENDDO
/* PURREBREV LØSNING 1 FRIGJØRES   */
             IF         COND(&SPLF = 'DR170U01   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             MONMSG     MSGID(CPF0000)
             ENDDO
             IF         COND(&SPLF = 'DR170U04   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             MONMSG     MSGID(CPF0000)
             ENDDO
             IF         COND(&SPLF = 'DR170U05   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             MONMSG     MSGID(CPF0000)
             ENDDO
             IF         COND(&SPLF = 'DR170U07   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             MONMSG     MSGID(CPF0000)
             ENDDO
             IF         COND(&SPLF = 'DR170U09   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             ENDDO
             IF         COND(&SPLF = 'DR170U10   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             MONMSG     MSGID(CPF0000)
             ENDDO
/* GENERALNOTA LØSNING 1 FRIGJØRES   */
             IF         COND(&SPLF = 'DR260U01   ') THEN(DO)
             RLSSPLF   FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(&NBR)
             MONMSG     MSGID(CPF0000)
             ENDDO
             GOTO       CMDLBL(ARKIV)
 VIDERE:     IF         COND(&DATA = 'N') THEN(RETURN)
             CALL       PGM(ARK001) PARM(&FI &SPLF &AAR &PER)
             RMVM       FILE(ARKWORK) MBR(&UNIK)
             ENDPGM
