********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10008 * 01 SH  PTF10 skuff og antall kopier
10008 * 02 SH  PTF10 laser D = duplex
10008 * 03 SH  PTF10 feil h¦yre venstrflytt
10008 * 04 SH  PTF10 utskuff innf¦rt
10008 * 05 SH  PTF10 endring innskuff
      * 06 JOV PTF10 MANGELFULL PTF3
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      * 07 SH  PTF11 FRAKTBREV VARELINJER PÅ FAKTURA
      * 08 JOV PTF11 DEFAULT OPPDRTYPE TR-MOD PR AVD
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE AVDELINGSFASTDATA         ***
      *
      ***         AVD 0000 INNEHOLDER KUN STANDARD VEKTGRUPPER***
      ***         FOR STATISTIKKOPPDATERING (FOR Å FÅ ET OVER ***
      ***         ORDNET BEGREP I STAT. VED ULIK INNDELING PÅ ***
      ***         AVDELINGENE ELLER VED KUNDEAVTALTE VEKTGR.) ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 06 07 09-11 13-24       ***
      *** LEDIGE INDIKATORER 27-32 35-89 95 97                ***
      ***********************************************************
      *
     FKODTA     IF   E           K DISK
     FKODTV     UF A E           K DISK
     FKODTW     UF A E           K DISK
     FKODTP     UF A E           K DISK
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FUTSKRS    IF   E           K DISK
     FSYFA28FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D LN              S              2  0 DIM(20)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  KOPLPI                 1      2  0
     D  KOPLP2                 2      2  0
N01  D                 DS
N01  D  KOPDRAW                1      7
s05  D* KOPDR2                 1      2
n05  D  KOPDR3                 1      3
N01  D                 DS
N01  D  KOPCOPI                1      6
N01  D  KOPCO2                 1      2
N01  D                 DS
N01  D  UTPTXT                 1     30
N01  D  UTTX22                 1     22
     D                 DS
     D  WSVXXX                 1      8
     D  WSBELA                 1      1
     D  WSTPFK                 2      3
     D  WSFBSE                 4      4
     D  WSTPSE                 5      5
     D  WSFBFK                 6      7
     D                 DS
     D  KOWXXX                 1     41
     D  KOWFET                 1      1
N07  D  KOWVLF                 2      2
N08  D  KOWSOT                 3      4
     D                UDS
     D  USYSPR               201    210
     C*
     C                   EXSR      INIT
     c     wsaavd        ifne      0
     c     wsavdk        ifne      0
     c                   seton                                        02
     c                   end
     c                   goto      videre
     c                   end
     C*
     C*  LES AVDELING FRA SKJERMEN
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   SETOFF                                       999896
     C   03              GOTO      SLUTT
     c     videre        tag
     C*
     C     WSAAVD        COMP      *ZEROS                                 99
     C  N99KODTAK        CHAIN     KODTA                              99
     C   99              GOTO      START
      *
     C   02              DO
      * TEST OM AVDELING SOM SKAL BLI KOPIERT FINNES
     C     WSAVDK        COMP      *ZEROS                                 98
     C  N98KODAKK        CHAIN     KODTA                              98
     C   98              GOTO      START
      * TEST OM OPPLYSNGER SOM SKAL BLI KOPIERT FINNES
     C     KODVKK        CHAIN     KODTV                              98
     C   98              GOTO      START
     C                   UPDATE    KOVR
      *
     C     KODTVK        CHAIN(N)  KODTV                              33
     C  N33              DO
     C     WSSLET        COMP      'J'                                9696
     C   96              GOTO      START
     C                   END
     C                   EXSR      KOPIAV
     C                   END
      *
     C   27              GOTO      START3
      *
     C                   MOVE      *ZEROS        WSAVDK
     C                   MOVE      *BLANKS       WSSLET
     C*
     C* VEDLIKEHOLD AV VEKTGRUPPER
     C                   EXSR      HENTVW
     C*
     C     START2        TAG
     C                   EXFMT     BILDE02
     C   12              GOTO      START
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØK
     C                   GOTO      START2
     C                   END
     C*
     C                   EXSR      OPDVW
     C*
     C* VEDLIKEHOLD AV PRINTERSTYRING
     C* HENTE UTSKRIFTTYPER
     C     START3        TAG
     C                   EXSR      HENTP
     C*
     C*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     C     ST1           TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   Z-ADD     *ZEROS        YLNR              3 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     KODTPK        SETLL     KODTP
     C     ST2           TAG
     C     WSPUNI        READE(N)  KODTP                                  94
     C  N94WSAAVD        COMP      KOPAVD                             9494
     C  N94
     CAN 27KOPLNR        IFGE      81
     C     KOPLNR        ANDLE     99
     C                   ELSE
     C                   GOTO      ST2
     C                   END
      *
     C     ST3           TAG
      *
     C  N94              DO
     C                   DO        14
     C     KOPLNR        CHAIN     UTSKRS                             94
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     ST31          TAG
     C     WSPUNI        READE(N)  KODTP                                  94
     C  N94WSAAVD        COMP      KOPAVD                             9494
     C  N94
     CAN 27KOPLNR        IFGE      81
     C     KOPLNR        ANDLE     99
     C                   ELSE
     C                   GOTO      ST31
     C                   END
     C  N94              Z-ADD     KOPLNR        YLNR
     C  N94              END
     C                   END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     ST4           TAG
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       98
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*
     C*** FRISK OPP
     C   05              GOTO      ST1
     C*** SØK FRA UTSKRIFT TYPE
     C   08              GOTO      ST7
     C*** GÅ TIL BILDE02
     C   12
     CAN 27              GOTO      START
     C   12              GOTO      START2
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   SETOFF                                       25
     C                   Z-ADD     YRECNO        ZRECNO
     C  N94KODTP3        SETLL     KODTP
     C  N94WSPUNI        READE(N)  KODTP                                  94
     C                   GOTO      ST3
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      ST4
     C*
     C*** SØK FRA UTSKRIFTTYPE
     C     ST7           TAG
     C                   EXFMT     VAREL2
     C   12              GOTO      ST4
     C                   GOTO      ST1
     C*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SØK           BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C                   MOVEL     *BLANKS       PKODE             2
     C                   CALL      'SYFI10I'
     C                   PARM                    PKODE
     C     PKODE         IFNE      *BLANKS
     C     POSNBR        IFLT      68
     C                   MOVE      PKODE         WSFBFK
     C                   ELSE
     C                   MOVE      PKODE         WSTPFK
     C                   END
     C                   END
     C*
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       14            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     W2NR          IFEQ      '2'
     C                   SETON                                        99
     C                   EXSR      CHGP
     C   12              GOTO      SLHENT
     C                   END
     C     W2NR          IFEQ      '9'
     C                   SETON                                        99
     C                   EXSR      ALLAVD
     C   12              GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGP          BEGSR
     C***********************************************
     C                   MOVE      KOPTY         W2PTY
     C                   MOVE      KOPNVN        W2PNVN
     C                   MOVE      KOPLNR        WSPLNR
     C                   MOVE      KOPHEA        W2PHEA
     C                   MOVE      KOPFM         W2PFM
     C                   MOVE      KOPLAS        W2PLAS
     C                   MOVE      KOPLPI        W2LPI
N01  C                   movel     KOPDRAW       W2DRAW
N04  C                   movel     KOPOUTB       W2DRAU
N01  C                   movel     KOPCOPI       W2COPY
N01  C                   movel     KOPFOV1       W2FOV1
     C*
     C     STCHG         TAG
     C                   EXFMT     VARELI
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
     C                   MOVE      '0'           *IN70
     C   12              GOTO      SLCHG
     C     *IN04         IFEQ      '1'
     C                   MOVE      'S'           MODE              1
     C                   CALL      'SYFA08'
     C                   PARM                    MODE
     C                   PARM                    W2PFM
     C                   END
     C*
     C     W2PFM         IFNE      *BLANKS
     C     W2PFM         CHAIN     KODTFM                             90
     C   90              DO
     C                   MOVE      'SHU0559'     MSGNR
     C                   SETON                                        30
     C                   GOTO      STCHG
     C                   END
     C                   END
     C     W2PLAS        IFNE      'J'
     C     W2PLAS        ANDNE     'N'
     C     W2PLAS        ANDNE     ' '
     C     W2PLAS        ANDNE     'A'
     C     W2PLAS        ANDNE     'P'                                          PDF/Infoprint
     C     W2PLAS        ANDNE     'F'                                          AFP-direkte
n02  C     W2PLAS        ANDNE     'D'                                          AFP-direkte
     C                   MOVE      'SHU0560'     MSGNR
     C                   SETON                                        3070
     C                   GOTO      STCHG
     C                   END
      *
     C     W2PTY         IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2PTY
     C                   MOVEL     '*STD'        W2PTY
     C                   END
     C     W2PNVN        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2PNVN
     C*                    MOVE USYSPR    W2PNVN
     C                   MOVEL     '*JOB'        W2PNVN
     C                   END
     C*
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      W2PNVN        KOPNVN
     C                   MOVE      W2PHEA        KOPHEA
     C                   MOVE      W2PFM         KOPFM
     C                   MOVE      W2PLAS        KOPLAS
     C                   MOVE      W2PTY         KOPTY
     C                   MOVE      W2LPI         KOPLPI
N01  C                   movel     W2DRAW        KOPDRAW
N04  C                   movel     W2DRAU        KOPOUTB
N01  C                   movel     W2COPY        KOPCOPI
N01  C                   movel     W2FOV1        KOPFOV1
     C                   UPDATE    KOPR
     C*
     C     SLCHG         TAG
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   MOVE      ' '           W2NR
     C                   UPDATE    SUBFIL
     C                   MOVE      *BLANKS       W2PTY
     C                   MOVE      *BLANKS       W2PNVN
     C                   MOVE      *BLANKS       W2PHEA
     C                   MOVE      *BLANKS       W2PFM
     C                   MOVE      *BLANKS       W2PLAS
     C                   MOVE      *BLANKS       W2LPI
     C*
N01  C                   movel     *BLANKS       W2DRAW
N04  C                   movel     *BLANKS       W2DRAU
N01  C                   movel     *BLANKS       W2COPY
N01  C                   movel     *BLANKS       W2FOV1
     C                   ENDSR
     C***********************************************
     C     ALLAVD        BEGSR
     C***********************************************
     C                   MOVE      KOPLAS        W2PLAS
     C                   MOVE      KOPLPI        W2LPI
     C                   MOVE      KOPTY         W2PTY
     C                   MOVE      KOPNVN        W2PNVN
     C                   MOVE      KOPLNR        WSPLNR
     C                   MOVE      KOPHEA        W2PHEA
     C                   MOVE      KOPFM         W2PFM
N01  C                   movel     KOPDRAW       W2DRAW
N04  C                   movel     KOPOUTB       W2DRAU
N01  C                   movel     KOPCOPI       W2COPY
N01  C                   movel     KOPFOV1       W2FOV1
     C                   CALL      'SYFA28A'
     C                   PARM                    WSPLNR
     C                   PARM                    W2PTY
     C                   PARM                    W2PNVN
     C                   PARM                    W2PHEA
     C                   PARM                    W2PFM
     C                   PARM                    W2PLAS
     C                   PARM                    W2LPI
n01  C                   PARM                    W2DRAW
n04  C                   PARM                    W2DRAU
n01  C                   PARM                    W2COPY
N01  C                   PARM                    W2FOV1
     C*
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   MOVE      ' '           W2NR
     C                   UPDATE    SUBFIL
     C                   MOVE      *BLANKS       W2PTY
     C                   MOVE      *BLANKS       W2PNVN
     C                   MOVE      *BLANKS       W2PHEA
     C                   MOVE      *BLANKS       W2PFM
     C                   MOVE      *BLANKS       W2PLAS
     C                   MOVE      *BLANKS       W2LPI
N01  C                   movel     *blanks       W2DRAW
N04  C                   movel     *blanks       W2DRAU
N01  C                   movel     *blanks       W2COPY
N01  C                   movel     *blanks       W2FOV1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTVW        BEGSR
     C***********************************************
     C     KODTVK        CHAIN     KODTV                              33
     C  N33              EXSR      MOVEV
     C   33              EXSR      MOVEBV
     C*
     C     KODTWK        CHAIN     KODTW                              33
     C  N33              EXSR      MOVEW
     C   33              EXSR      MOVEBW
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEV         BEGSR
     C***********************************************
     C                   UPDATE    KOVR
     C                   MOVE      KOVLKG        WSVLKG
     C                   MOVE      KOVKKG        WSVKKG
     C                   MOVE      KOVK1         WSVK1
     C                   MOVE      KOVK2         WSVK2
     C                   MOVE      KOVK3         WSVK3
     C                   MOVE      KOVK4         WSVK4
     C                   MOVE      KOVK5         WSVK5
     C                   MOVE      KOVK6         WSVK6
     C                   MOVE      KOVK7         WSVK7
     C                   MOVE      KOVK8         WSVK8
     C                   MOVE      KOVK9         WSVK9
     C                   MOVE      KOVK10        WSVK10
     C                   MOVE      KOVK11        WSVK11
     C                   MOVE      KOVOMR        WSVOMR
     C                   MOVE      KOVPRO        WSVPRO
     C                   MOVE      KOVAVR        WSVAVR
     C                   MOVE      KOVXXX        WSVXXX
     C                   MOVE      AVUTPR        WSUTPR
     C                   MOVE      AVUTMI        WSUTMI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEBV        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSVLKG
     C                   MOVE      *ZEROS        WSVKKG
     C                   MOVE      *ZEROS        WSVK1
     C                   MOVE      *ZEROS        WSVK2
     C                   MOVE      *ZEROS        WSVK3
     C                   MOVE      *ZEROS        WSVK4
     C                   MOVE      *ZEROS        WSVK5
     C                   MOVE      *ZEROS        WSVK6
     C                   MOVE      *ZEROS        WSVK7
     C                   MOVE      *ZEROS        WSVK8
     C                   MOVE      *ZEROS        WSVK9
     C                   MOVE      *ZEROS        WSVK10
     C                   MOVE      *ZEROS        WSVK11
     C                   MOVE      *ZEROS        WSVOMR
     C                   MOVE      *BLANKS       WSVPRO
     C*                    MOVE *BLANKS   WSVFIR
     C                   MOVE      *BLANKS       WSVAVR
     C                   MOVE      *ZEROS        WSUTPR
     C                   MOVE      *ZEROS        WSUTMI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEW         BEGSR
     C***********************************************
     C                   UPDATE    KOWR
     C                   MOVE      KOWF1         WSWF1
     C                   MOVE      KOWF2         WSWF2
     C                   MOVE      KOWF3         WSWF3
     C                   MOVE      KOWF4         WSWF4
     C                   MOVE      KOWF5         WSWF5
     C                   MOVE      KOWF6         WSWF6
     C                   MOVE      KOWF7         WSWF7
     C                   MOVE      KOWF8         WSWF8
     C                   MOVE      KOWF9         WSWF9
     C                   MOVE      KOWF10        WSWF10
     C                   MOVE      KOWF11        WSWF11
     C                   MOVE      KOWF12        WSWF12
     C                   MOVE      KOWMM         WSWMM
     C                   MOVE      KOWLAS        WSWLAS
     C                   MOVE      KOWAWB        WSWAWB
     C                   MOVE      KOWHOD        WSWHOD
     C                   MOVE      KOWBBS        WSWBBS
     C                   MOVE      KOWKOM        WSKOMB
     C     KOWFET        IFEQ      *BLANKS
     C                   MOVE      'N'           WSWFET
     C                   ELSE
     C                   MOVE      KOWFET        WSWFET
     C                   END
N07  C     KOWVLF        IFEQ      *BLANKS
N07  C                   MOVE      'N'           WSWVLF
N07  C                   ELSE
N07  C                   MOVE      KOWVLF        WSWVLF
N07  C                   END
N08  C                   MOVE      KOWSOT        WSWSOT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEBW        BEGSR
     C***********************************************
     C                   MOVE      ' '           WSWF1
     C                   MOVE      ' '           WSWF2
     C                   MOVE      ' '           WSWF3
     C                   MOVE      ' '           WSWF4
     C                   MOVE      ' '           WSWF5
     C                   MOVE      ' '           WSWF6
     C                   MOVE      ' '           WSWF7
     C                   MOVE      ' '           WSWF8
     C                   MOVE      ' '           WSWF9
     C                   MOVE      ' '           WSWF10
     C                   MOVE      ' '           WSWF11
     C                   MOVE      ' '           WSWF12
     C                   MOVE      *ZEROS        WSWMM
     C                   MOVE      ' '           WSWLAS
     C                   MOVE      ' '           WSWAWB
     C                   MOVE      ' '           WSWHOD
     C                   MOVE      ' '           WSWBBS
     C                   MOVE      ' '           WSKOMB
     C                   MOVE      'N'           WSWFET
N07  C                   MOVE      'N'           WSWVLF
N08  C                   MOVE      *BLANKS       WSWSOT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDVW         BEGSR
     C***********************************************
     C     KODTVK        CHAIN     KODTV                              33
     C                   EXSR      VMOVE
     C   33              WRITE     KOVR
     C  N33              UPDATE    KOVR
     C     KODTWK        CHAIN     KODTW                              33
     C                   EXSR      WMOVE
     C   33              WRITE     KOWR
     C  N33              UPDATE    KOWR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VMOVE         BEGSR
     C***********************************************
     C                   MOVE      WSAAVD        KOVAVD
     C                   MOVE      WSVUNI        KOVUNI
     C                   MOVE      WSVLKG        KOVLKG
     C                   MOVE      WSVKKG        KOVKKG
     C                   MOVE      WSVK1         KOVK1
     C                   MOVE      WSVK2         KOVK2
     C                   MOVE      WSVK3         KOVK3
     C                   MOVE      WSVK4         KOVK4
     C                   MOVE      WSVK5         KOVK5
     C                   MOVE      WSVK6         KOVK6
     C                   MOVE      WSVK7         KOVK7
     C                   MOVE      WSVK8         KOVK8
     C                   MOVE      WSVK9         KOVK9
     C                   MOVE      WSVK10        KOVK10
     C                   MOVE      WSVK11        KOVK11
     C                   MOVE      WSVOMR        KOVOMR
     C                   MOVE      WSVPRO        KOVPRO
     C                   MOVE      KOAFIR        KOVFIR
     C                   MOVE      WSVAVR        KOVAVR
     C                   MOVE      WSVXXX        KOVXXX
     C                   MOVE      WSUTPR        AVUTPR
     C                   MOVE      WSUTMI        AVUTMI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     WMOVE         BEGSR
     C***********************************************
     C                   MOVE      WSAAVD        KOWAVD
     C                   MOVE      WSWUNI        KOWUNI
     C                   MOVE      WSWF1         KOWF1
     C                   MOVE      WSWF2         KOWF2
     C                   MOVE      WSWF3         KOWF3
     C                   MOVE      WSWF4         KOWF4
     C                   MOVE      WSWF5         KOWF5
     C                   MOVE      WSWF6         KOWF6
     C                   MOVE      WSWF7         KOWF7
     C                   MOVE      WSWF8         KOWF8
     C                   MOVE      WSWF9         KOWF9
     C                   MOVE      WSWF10        KOWF10
     C                   MOVE      WSWF11        KOWF11
     C                   MOVE      WSWF12        KOWF12
     C                   MOVE      WSWMM         KOWMM
     C                   MOVE      WSWLAS        KOWLAS
     C                   MOVE      WSWAWB        KOWAWB
     C                   MOVE      WSWHOD        KOWHOD
     C                   MOVE      WSWBBS        KOWBBS
     C                   MOVE      WSKOMB        KOWKOM
     C                   MOVE      WSWFET        KOWFET
N07  C                   MOVE      WSWVLF        KOWVLF
N08  C                   MOVE      WSWSOT        KOWSOT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTP         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSPLNR            3 0
     C     WSPLNR        SETLL     UTSKRS
     C     STHP          TAG
     C                   SETOFF                                       33
     C                   READ      UTSKRS                                 33
     C  N33              DO
     C                   MOVE      UTPNR         WSPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C   33              MOVE      WSPUNI        KOPUNI
     C   33              MOVE      WSAAVD        KOPAVD
     C   33              MOVE      WSPLNR        KOPLNR
     C   33              MOVE      *BLANKS       KOPNVN
     C   33              MOVEL     '*JOB'        KOPNVN
     C   33              MOVE      ' '           KOPHEA
     C   33              MOVE      UTPTY         KOPTY
     C   33              MOVE      *BLANKS       KOPFM
     C   33              MOVE      *BLANKS       KOPLAS
     C   33              MOVE      *BLANKS       KOPLPI
N01  C   33              movel     *blanks       KOPDRAW
N04  C   33              movel     *blanks       KOPOUTB
N01  C   33              movel     *blanks       KOPCOPI
N01  C   33              movel     *blanks       KOPFOV1
     C   33              WRITE     KOPR
     C  N33              UPDATE    KOPR
     C                   GOTO      STHP
     C                   END
     C                   MOVE      *ZEROS        WSPLNR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PMOVE         BEGSR
     C***********************************************
     C                   MOVE      WSPUNI        KOPUNI
     C                   MOVE      WSAAVD        KOPAVD
     C                   MOVE      WSPLNR        KOPLNR
     C                   MOVE      XPNVN         KOPNVN
     C                   MOVE      XPHEA         KOPHEA
     C                   MOVE      XPTY          KOPTY
     C                   MOVE      XPFM          KOPFM
     C                   MOVE      XPLAS         KOPLAS
     C                   MOVE      XLPI          KOPLPI
S06  C*                  MOVE      XDRAW         KOPDRAW
N06  C                   MOVEL     XDRAW         KOPDRAW
N04  C                   MOVEL     XDRAU         KOPOUTB
s03  C*                  MOVE      XCOPY         KOPCOPI
N03  C                   MOVEL     XCOPY         KOPCOPI
N01  C                   MOVE      XFOV1         KOPFOV1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEP         BEGSR
     C***********************************************
     C                   MOVE      KOPLNR        WSPLNR
     C                   MOVE      KOPNVN        XPNVN            10
     C                   MOVE      KOPHEA        XPHEA             1
     C                   MOVE      KOPTY         XPTY             10
     C                   MOVE      KOPFM         XPFM              5
     C                   MOVE      KOPLAS        XPLAS             1
     C                   MOVE      KOPLPI        XLPI              1 0
N01  C                   movel     KOPDRAW       XDRAW             2
N04  C                   movel     KOPOUTB       XDRAU             2
N01  C                   movel     KOPCOPI       XCOPY             2
N01  C                   movel     KOPFOV1       XFOV1             9
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KOPIAV        BEGSR
     C***********************************************
     C     KODVKK        CHAIN     KODTV                              33
     C                   EXSR      MOVEV
     C     KODTVK        CHAIN     KODTV                              33
     C                   EXSR      VMOVE
     C  N33              UPDATE    KOVR
     C   33              WRITE     KOVR
     C*
     C     KODWKK        CHAIN     KODTW                              33
     C                   EXSR      MOVEW
     C     KODTWK        CHAIN     KODTW                              33
     C                   EXSR      WMOVE
     C  N33              UPDATE    KOWR
     C   33              WRITE     KOWR
     C*
     C     KODPKK        SETLL     KODTP
     C                   SETOFF                                       33
     C     STKP          TAG
     C     KODPKK        READE     KODTP                                  33
     C  N33              DO
     C                   UPDATE    KOPR
     C                   EXSR      MOVEP
     C     KODTPK        CHAIN     KODTP                              34
     C                   EXSR      PMOVE
     C   34              WRITE     KOPR
     C  N34              UPDATE    KOPR
     C     WSPLNR        IFLT      999
     C                   ADD       1             WSPLNR
     C     KODPK1        SETLL     KODTP
     C                   GOTO      STKP
     C                   END
     C                   END
     C*
     C     KODTAK        CHAIN     KODTA                              33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     KODAKK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAVDK
     C     KODTVK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    WSAAVD
     C     KODVKK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    WSAVDK
     C     KODTWK        KLIST
     C                   KFLD                    WSWUNI
     C                   KFLD                    WSAAVD
     C     KODWKK        KLIST
     C                   KFLD                    WSWUNI
     C                   KFLD                    WSAVDK
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSPLNR
     C     KODPKK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAVDK
     C     KODPK1        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAVDK
     C                   KFLD                    WSPLNR
     C     KODTP3        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAAVD
     C                   KFLD                    YLNR
     C*
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVE      'V'           WSVUNI            1
     C                   MOVE      'W'           WSWUNI            1
     C                   MOVE      'P'           WSPUNI            1
      *
     C     *ENTRY        PLIST
     C                   PARM                    USAD              1
     c                   parm                    uavd              4 0
     c                   parm                    uavdk             4 0
     c                   move      uavd          wsaavd
     c                   move      uavdk         wsavdk
     C     USAD          COMP      'J'                                    27
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
