      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 office vision utgår / hindre . i filnavn (resreveres for .csv)
********************************************************************
      ************************************************************
      * UTVALG / PARAMETEROPPSAMLING FOR KJØRING AV DAGJOURNAL   *
      ************************************************************
      *
     FFIRM      IF   E           K DISK
     FSYTR50FM  CF   E             WORKSTN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18
     D  USG                   19     21
     C*
     C                   EXSR      INIT
     C     START         TAG
     C                   EXFMT     BILDE1
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C*
     C                   SETOFF                                       30
     C                   MOVE      WSDTD         UDTD
     C                   MOVE      WSDTM         UDTM
     C                   MOVE      WSDTÅ         UDTÅ
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      98
     C   98
     CANN30              MOVE      'SPD0001'     MSGNR
     C   98              SETON                                        30
     C   30              GOTO      START
     C*
     C                   MOVE      WSDT          UUDT              6 0
     C* KONVERTER TIL YYMMDD
     C     FIDTFM        IFNE      3
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM                    UUDT
     C                   END
     C*
     C     WSDOC         IFEQ      *BLANKS
s01  C*                  MOVEL     'DB'          DOC1              8
s01  C*                  MOVE      UUDT          DOC1
n01  C                   MOVEL     'DB'          DOC1              2
     C     WSAV01        IFEQ      *ZEROS                                       INGEN AVD.FELT
S01  C*                  MOVE      '.ALL'        DOC2              4
N01  C                   MOVE      '_ALL'        DOC2              4
     C                   ELSE
     C     WSAV02        IFEQ      *ZEROS                                       AVD.FELT1 FYLT UT
     C     WSAV06        ANDEQ     *ZEROS                                       (MEN IKKE ANDRE)
     C                   MOVE      WSAV01        DOC2
S01  C*                  MOVEL     '.'           DOC2
N01  C                   MOVEL     '_'           DOC2
     C                   ELSE
     C                   MOVE      USG           DOC2                           FLERE AVD:
S01  C*                  MOVEL     '.'           DOC2                              SIGNATUR.
N01  C                   MOVEL     '_'           DOC2                              SIGNATUR.
     C                   END
     C                   END
s01  C*                  MOVEL     DOC1          WSDOC
s01  C*                  MOVE      DOC2          WSDOC
N01  c                   eval      WSdoc = Doc1 + Doc2
     C                   else
N01   * max 10 inkl .csv
N01  C                   MOVEL     WSDOC         doc6              6
N01  c                   eval      WSdoc = DOc6
     C                   END
N01  c                   eval      WSdoc = %trim(wsdoc)+'.csv'
     C*
     C* SETTER STATUS PÅ TURER KUN DERSOM EN SPESIELT BER OM DET
     C* (BLIR ELLERS UTFØRT I NATTRUTINE)
     C     WSREGE        IFEQ      'J'
     C     WSREGE        OREQ      'Y'
     C                   CALL      'SYTR50AU'
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C***********************************************
     C     SJDATO        BEGSR
     C***********************************************
     C                   CALL      'TESTDATO'
     C                   PARM                    UDTD              2 0
     C                   PARM                    UDTM              2 0
     C                   PARM                    UDTÅ              2 0
     C                   PARM                    UFLAGG            1 0
     C*
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM      UUDT          UUDT
     C                   PARM      WSAV01        WSAV01
     C                   PARM      WSAV02        WSAV02
     C                   PARM      WSAV03        WSAV03
     C                   PARM      WSAV04        WSAV04
     C                   PARM      WSAV05        WSAV05
     C                   PARM      WSAV06        WSAV06
     C                   PARM      WSAV07        WSAV07
     C                   PARM      WSAV08        WSAV08
     C                   PARM      WSAV09        WSAV09
     C                   PARM      WSAV10        WSAV10
     C                   PARM      WSBK01        WSBK01
     C                   PARM      WSBK02        WSBK02
     C                   PARM      WSBK03        WSBK03
     C                   PARM      WSBK04        WSBK04
     C                   PARM      WSBK05        WSBK05
     C                   PARM      WSOPPD        WSOPPD
     C                   PARM      WSDOC         WSDOC
     C                   PARM      UIN01         UIN01             1
     C*
     C                   MOVE      'N'           WSOPPD
     C                   MOVE      'N'           WSREGE
     C* WSDOC IKKE BLANK: RETURNERER PGA DOKUMENT I BRUK....
     C     WSDOC         IFNE      *BLANKS
     C                   MOVE      'DIV2384'     MSGNR
     C                   SETON                                        3099
     C                   END
     C                   MOVE      *ZEROS        WSDT
     C                   READ      FIRM                                   33
     C                   MOVE      'DB'          WSBB              2
     C                   MOVE      *BLANKS       BETTXT           30
     C                   MOVE      *ZEROS        XFFDT             6 0
     C                   CALL      'SYFA20A'
     C                   PARM                    XFFDT
     C                   PARM                    BETTXT
     C                   PARM                    FIFIRM
     C                   PARM                    WSBB
     C                   MOVE      XFFDT         WSDT
     C                   ENDSR
     C*
