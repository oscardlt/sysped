     FSADMAVF   UF A E           K DISK
     FSAD032F   IP   E             DISK
     FKODTS8    IF   E           K DISK
     D                 DS
     D  XAN75                  1     75
     D  T1                     1     75    DIM(75)
     D                 DS
     D  KS8FTX                 1     52
     D  KS8MIL                52     52
     D                 DS
     D  S32FLD                 1    512
     D  TX                     1    512    DIM(512)
      *
     C     XINIT         IFNE      'J'
     C     *ENTRY        PLIST
     C                   PARM                    UKD               2
     C                   PARM                    USLT              1
     C     SADMAVFK      KLIST
     C                   KFLD                    UKD
     C                   KFLD                    XRG               9 0
     C     UKD           CHAIN     KODTS8                             33
     C  N33KS8MIL        COMP      'J'                                3333
     C                   IF        *IN33
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
     C                   BITON     '346'         WÆ                1
     C                   BITOFF    '01257'       WÆ
     C                   BITON     '35'          WØ                1
     C                   BITOFF    '012467'      WØ
     C                   BITON     '2347'        WØ2               1
     C                   BITOFF    '0156'        WØ2
     C                   BITON     '3467'        WÅ                1
     C                   BITOFF    '0125'        WÅ
     C                   BITON     '56'          WÆLITE            1
     C                   BITOFF    '012347'      WÆLITE
     C                   BITON     '03'          WØLITE            1
     C                   BITOFF    '124567'      WØLITE
     C                   BITON     '235'         WÅLITE            1
     C                   BITOFF    '01467'       WÅLITE
     C                   MOVE      'J'           XINIT             1
     C                   END
      *
     C                   IF        ((TX(1) < '0') OR (TX(1) > '9'))
     C                   GOTO      ENDTAG
     C                   END
      *
     C                   IF        USLT = 'J'
     C     UKD           SETLL     SADMAVF
     C     UKD           READE     SADMAVF                                33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADMAVFR
     C     UKD           READE     SADMAVF                                33
     C                   ENDDO
     C                   EVAL      USLT = 'O'
     C                   END
      * ORGANISASJONSNR
     C                   MOVE      *ZEROS        XRG
     C                   Z-ADD     1             XN                3 0
     C                   DO        50
     C     TX(XN)        IFEQ      ';'
     C                   LEAVE
     C                   END
     C                   MULT      10            XRG
     C                   MOVE      TX(XN)        XRG
     C                   ADD       1             XN
     C                   ENDDO
      *
     C     SADMAVFK      CHAIN(N)  SADMAVF                            33
     C     *IN33         CABEQ     *OFF          ENDTAG
      * HENT NAVN
     C                   ADD       1             XN                3 0
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        X2                3 0
     C                   DO        75
     C     TX(XN)        IFEQ      ';'
     C                   LEAVE
     C                   END
     C     TX(XN)        IFNE      '"'
     C                   ADD       1             X2
     C                   EXSR      FLYTT
     C                   END
     C                   ADD       1             XN
     C                   ENDDO
     C                   MOVEL     XAN75         XNV              35
      * HENT ADRESSE
     C                   ADD       1             XN                3 0
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        X2                3 0
     C                   DO        75
     C     TX(XN)        IFEQ      ';'
     C                   LEAVE
     C                   END
     C     TX(XN)        IFNE      '"'
     C                   ADD       1             X2
     C                   EXSR      FLYTT
     C                   END
     C                   ADD       1             XN
     C                   ENDDO
     C                   MOVEL     XAN75         XAD1             35
      * POSTNR
     C                   MOVE      *ZEROS        XPN               4 0
     C                   ADD       1             XN                3 0
     C                   DO        50
     C     TX(XN)        IFEQ      ';'
     C                   LEAVE
     C                   END
     C                   MULT      10            XPN
     C                   MOVE      TX(XN)        XPN
     C                   ADD       1             XN
     C                   ENDDO
      * HENT POSTSTED
     C                   ADD       1             XN                3 0
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        X2                3 0
     C                   DO        75
     C     TX(XN)        IFEQ      ';'
     C                   LEAVE
     C                   END
     C     TX(XN)        IFNE      '"'
     C                   ADD       1             X2
     C                   EXSR      FLYTT
     C                   END
     C                   ADD       1             XN
     C                   ENDDO
     C                   MOVEL     XAN75         XST              35
      *
     C                   MOVE      UKD           MAKD
     C                   MOVE      XRG           MARG
     C                   MOVE      XNV           MANV
     C                   MOVE      XAD1          MAAD1
     C                   MOVE      XPN           MAPN
     C                   MOVE      XST           MAST
     C                   WRITE     SADMAVFR
      *
     C     ENDTAG        TAG
      *
     C***********************************************
     C     FLYTT         BEGSR
     C***********************************************
      *
     C                   SELECT
     C     TX(XN)        WHENEQ    WÆ
     C                   MOVE      'Æ'           T1(X2)
     C     TX(XN)        WHENEQ    WØ
     C                   MOVE      'Ø'           T1(X2)
     C     TX(XN)        WHENEQ    WØ2
     C                   MOVE      'Ø'           T1(X2)
     C     TX(XN)        WHENEQ    WÅ
     C                   MOVE      'Å'           T1(X2)
     C     TX(XN)        WHENEQ    WÆLITE
     C                   MOVE      'Æ'           T1(X2)
     C     TX(XN)        WHENEQ    WØLITE
     C                   MOVE      'Ø'           T1(X2)
     C     TX(XN)        WHENEQ    WÅLITE
     C                   MOVE      'Å'           T1(X2)
     C     TX(XN)        WHENEQ    'a'
     C                   MOVE      'A'           T1(X2)
     C     TX(XN)        WHENEQ    'b'
     C                   MOVE      'B'           T1(X2)
     C     TX(XN)        WHENEQ    'c'
     C                   MOVE      'C'           T1(X2)
     C     TX(XN)        WHENEQ    'd'
     C                   MOVE      'D'           T1(X2)
     C     TX(XN)        WHENEQ    'e'
     C                   MOVE      'E'           T1(X2)
     C     TX(XN)        WHENEQ    'f'
     C                   MOVE      'F'           T1(X2)
     C     TX(XN)        WHENEQ    'g'
     C                   MOVE      'G'           T1(X2)
     C     TX(XN)        WHENEQ    'h'
     C                   MOVE      'H'           T1(X2)
     C     TX(XN)        WHENEQ    'i'
     C                   MOVE      'I'           T1(X2)
     C     TX(XN)        WHENEQ    'g'
     C                   MOVE      'G'           T1(X2)
     C     TX(XN)        WHENEQ    'k'
     C                   MOVE      'K'           T1(X2)
     C     TX(XN)        WHENEQ    'l'
     C                   MOVE      'L'           T1(X2)
     C     TX(XN)        WHENEQ    'm'
     C                   MOVE      'M'           T1(X2)
     C     TX(XN)        WHENEQ    'n'
     C                   MOVE      'N'           T1(X2)
     C     TX(XN)        WHENEQ    'o'
     C                   MOVE      'O'           T1(X2)
     C     TX(XN)        WHENEQ    'p'
     C                   MOVE      'P'           T1(X2)
     C     TX(XN)        WHENEQ    'q'
     C                   MOVE      'Q'           T1(X2)
     C     TX(XN)        WHENEQ    'r'
     C                   MOVE      'R'           T1(X2)
     C     TX(XN)        WHENEQ    's'
     C                   MOVE      'S'           T1(X2)
     C     TX(XN)        WHENEQ    't'
     C                   MOVE      'T'           T1(X2)
     C     TX(XN)        WHENEQ    'u'
     C                   MOVE      'U'           T1(X2)
     C     TX(XN)        WHENEQ    'v'
     C                   MOVE      'V'           T1(X2)
     C     TX(XN)        WHENEQ    'w'
     C                   MOVE      'W'           T1(X2)
     C     TX(XN)        WHENEQ    'x'
     C                   MOVE      'X'           T1(X2)
     C     TX(XN)        WHENEQ    'y'
     C                   MOVE      'Y'           T1(X2)
     C     TX(XN)        WHENEQ    'z'
     C                   MOVE      'Z'           T1(X2)
     C     TX(XN)        WHENEQ    'æ'
     C                   MOVE      'Æ'           T1(X2)
     C     TX(XN)        WHENEQ    'ø'
     C                   MOVE      'Ø'           T1(X2)
     C     TX(XN)        WHENEQ    'å'
     C                   MOVE      'Å'           T1(X2)
     C                   OTHER
     C                   MOVE      TX(XN)        T1(X2)
     C                   ENDSL
      *
     C                   ENDSR
      *
