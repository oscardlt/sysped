********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SORT PÅ SPEDITØR
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE BOOKING-LISTE                   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 28-32 34-48 62-99
      ***********************************************************
      *
     FBOOKLF01  IF   E           K DISK
     FBOOKLF05  IF   E           K DISK    RENAME(BOOKINGR:BOOKIN5R)
     FBOOKLF06  IF   E           K DISK    RENAME(BOOKINGR:BOOKIN6R)
N01  FBOOKLF07  IF   E           K DISK    RENAME(BOOKINGR:BOOKIN7R)
     FBOOKLF09  IF   E           K DISK    RENAME(BOOKINGR:BOOKIN9R)
     FBOOKLF13  IF   E           K DISK    RENAME(BOOKINGR:BOOKIN3R)
     FBOOKLF14  IF   E           K DISK    RENAME(BOOKINGR:BOOKI14R)
     FBOOKLF12  IF   E           K DISK    RENAME(BOOKINGR:BOOKI12R)
     FBOOKLF10  IF   E           K DISK    RENAME(BOOKINGR:BOOKI10R)
     FBOOKLF08  IF   E           K DISK    RENAME(BOOKINGR:BOOKI08R)
     FBOOKLF04  IF   E           K DISK    RENAME(BOOKINGR:BOOKI04R)
     FKODTA     IF   E           K DISK
     FBLV1LF    IF   E           K DISK
     FBLV2LF    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYSJ60P   O    E             PRINTER
     D                 DS
     D  UAVD1                  1     20
     D  AVD                    1     20  0
     D                                     DIM(5)
     D                 DS
     D  XIDAG1                 1      2  0
     D  XIDAG2                 3      4  0
     D  XIDAG3                 5      6  0
     D  XIDAG                  1      6  0
     D                 DS
     D  XDTFD                  1      2  0
     D  XDTFM                  3      4  0
     D  XDTFÅ                  5      6  0
     D  XDTF                   1      6  0
     D                 DS
     D  UDTFÅ                  1      4  0
     D  UDTFM                  5      6  0
     D  UDTFD                  7      8  0
     D  UDTF                   1      8  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTTÅ                  5      6  0
     D  XDTT                   1      6  0
     D                 DS
     D  UDTTÅ                  1      4  0
     D  UDTTM                  5      6  0
     D  UDTTD                  7      8  0
     D  UDTT                   1      8  0
     D                 DS
     D  XDTLD                  1      2  0
     D  XDTLM                  3      4  0
     D  XDTLÅ                  5      6  0
     D  XDTL                   1      6  0
     D                 DS
     D  UDTLÅ                  1      4  0
     D  UDTLM                  5      6  0
     D  UDTLD                  7      8  0
     D  UDTL                   1      8  0
     D                 DS
     D  XDTHD                  1      2  0
     D  XDTHM                  3      4  0
     D  XDTHÅ                  5      6  0
     D  XDTH                   1      6  0
     D                 DS
     D  UDTHÅ                  1      4  0
     D  UDTHM                  5      6  0
     D  UDTHD                  7      8  0
     D  UDTH                   1      8  0
     D                 DS
     D  XDTPD                  1      2  0
     D  XDTPM                  3      4  0
     D  XDTPÅ                  5      6  0
     D  XDTP                   1      6  0
     D                 DS
     D  UDTPÅ                  1      4  0
     D  UDTPM                  5      6  0
     D  UDTPD                  7      8  0
     D  UDTP                   1      8  0
     D                 DS
     D  XDTVD                  1      2  0
     D  XDTVM                  3      4  0
     D  XDTVÅ                  5      6  0
     D  XDTV                   1      6  0
     D                 DS
     D  UDTVÅ                  1      4  0
     D  UDTVM                  5      6  0
     D  UDTVD                  7      8  0
     D  UDTV                   1      8  0
     D                 DS
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTSÅ                  5      6  0
     D  XDTS                   1      6  0
     D                 DS
     D  UDTSÅ                  1      4  0
     D  UDTSM                  5      6  0
     D  UDTSD                  7      8  0
     D  UDTS                   1      8  0
     D                 DS
     D  XDTOD                  1      2  0
     D  XDTOM                  3      4  0
     D  XDTOÅ                  5      6  0
     D  XDTO                   1      6  0
     D                 DS
     D  UDTOÅ                  1      4  0
     D  UDTOM                  5      6  0
     D  UDTOD                  7      8  0
     D  UDTO                   1      8  0
     D                 DS
     D  XDTAD                  1      2  0
     D  XDTAM                  3      4  0
     D  XDTAÅ                  5      6  0
     D  XDTA                   1      6  0
     D                 DS
     D  UDTAÅ                  1      4  0
     D  UDTAM                  5      6  0
     D  UDTAD                  7      8  0
     D  UDTA                   1      8  0
N01  D                 DS
N01  D  XDTSPD                 1      2  0
N01  D  XDTSPM                 3      4  0
N01  D  XDTSPÅ                 5      6  0
N01  D  XDTSP                  1      6  0
N01  D                 DS
N01  D  UDTSPÅ                 1      4  0
N01  D  UDTSPM                 5      6  0
N01  D  UDTSPD                 7      8  0
N01  D  UDTSP                  1      8  0
     D                 DS
     D  XDT1D                  1      2  0
     D  XDT1M                  3      4  0
     D  XDT1Å                  5      6  0
     D  XDT1                   1      6  0
     D                 DS
     D  BODT1Å                 1      4  0
     D  BODT1M                 5      6  0
     D  BODT1D                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  XDT3D                  1      2  0
     D  XDT3M                  3      4  0
     D  XDT3Å                  5      6  0
     D  XDT3                   1      6  0
     D                 DS
     D  BODT3Å                 1      4  0
     D  BODT3M                 5      6  0
     D  BODT3D                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  XDT4D                  1      2  0
     D  XDT4M                  3      4  0
     D  XDT4Å                  5      6  0
     D  XDT4                   1      6  0
     D                 DS
     D  BODT4Å                 1      4  0
     D  BODT4M                 5      6  0
     D  BODT4D                 7      8  0
     D  BODT4                  1      8  0
     D                 DS
     D  BONT1                  1      7  0
     D  BONT2                  8     14  0
     D  BONT3                 15     21  0
     D  BONT4                 22     28  0
     D  NT                     1    630  0
     D                                     DIM(90)
     D                 DS
     D  BOKDC1                 1      2
     D  BOKDC2                 3      4
     D  BOKDC3                 5      6
     D  BOKDC4                 7      8
     D  CD                     1      8
     D                                     DIM(4)
     D                 DS
     D  BOMN1                 81    100
     D  BOMN2                101    120
     D  BOMN3                121    140
     D  BOMN4                141    160
     D  MN                     1   1800
     D                                     DIM(90)
     D                 DS
     D  BOVS1                  1     25
     D  BOVS2                 26     50
     D  BOVS3                 51     75
     D  BOVS4                 76    100
     D  VS                     1   2250
     D                                     DIM(90)
     D                 DS
     D  BOVKT1                 1      9  0
     D  BOVKT2                10     18  0
     D  BOVKT3                19     27  0
     D  BOVKT4                28     36  0
     D  VK                     1    810  0
     D                                     DIM(90)
     D                 DS
     D  BOM31                  1      7  3
     D  BOM32                  8     14  3
     D  BOM33                 15     21  3
     D  BOM34                 22     28  3
     D  M3                     1    630  3
     D                                     DIM(90)
     D                 DS
     D  UAVD2                  1     20
     D  UDTF2                 21     26
     D  UDTT2                 27     32
     D  UAAR2                 33     34
     D  UUKEF2                35     36
     D  UUKET2                37     38
     D  ULB                   39     43
     D  UDTL2                 44     49
     D  ULSH                  50     54
     D  UDTH2                 55     60
     D  UPRO2                 61     68
     D  UDTP2                 69     74
     D  UVH                   75     79
     D  UDTV2                 80     85
     D  ULOH                  86     90
     D  UDTS2                 91     96
     D  UREIS                 97    110
     D  UOB                  111    115
     D  UDTO2                116    121
     D  UKNA2                122    129
     D  UDTA2                130    135
N01  D  UKNSP2               136    143
N01  D  UDTSP2               144    149
     D  UPARM                  1    160
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     C*
     C                   EXSR      INIT
     C*
     C                   Z-ADD     0             XSIDE             3 0
     C                   Z-ADD     1             XN                2 0
     C                   MOVE      '1'           *IN27
     C     XN            DOWLE     5
     C     AVD(XN)       IFNE      0
     C                   MOVE      '0'           *IN27
     C                   SETOFF                                       61
     C   51              MOVE      AVD(XN)       YAVD9             4 0
     C   51BOOK9K        SETLL     BOOKLF09
     C   52              MOVE      AVD(XN)       YAVD1             4 0
     C   52BOOK1K        SETLL     BOOKLF01
     C   53              MOVE      AVD(XN)       YAVD5             4 0
     C   53BOOK5K        SETLL     BOOKLF05
     C   54              MOVE      AVD(XN)       YAVD6             4 0
     C   54BOOK6K        SETLL     BOOKLF06
     C   55              MOVE      AVD(XN)       YAVD3             4 0
     C   55BOOK3K        SETLL     BOOKLF13
     C   56              MOVE      AVD(XN)       YAVD14
     C   56BOO14K        SETLL     BOOKLF14
     C   57              MOVE      AVD(XN)       YAVD12
     C   57BOO12K        SETLL     BOOKLF12
     C   58              MOVE      AVD(XN)       YAVD10
     C   58BOO10K        SETLL     BOOKLF10
     C   59              MOVE      AVD(XN)       YAVD8
     C   59BOO08K        SETLL     BOOKLF08
     C   50              MOVE      AVD(XN)       YAVD4
     C   50BOO04K        SETLL     BOOKLF04
N01  C   49              MOVE      AVD(XN)       YAVD7
N01  C   49BOO07K        SETLL     BOOKLF07
     C                   EXSR      PRINT
     C                   END
     C                   ADD       1             XN
     C                   END
      * ALLE AVDELINGER
     C     *IN27         IFEQ      '1'
     C                   MOVE      'A'           KOAUNI
     C     KOAUNI        SETLL     KODTA                              33
     C     START         TAG
     C                   READ      KODTA                                  33
     C     *IN33         IFEQ      '0'
     C   51              MOVE      KOAAVD        YAVD9             4 0
     C   51BOOK9K        SETLL     BOOKLF09
     C   52              MOVE      KOAAVD        YAVD1             4 0
     C   52BOOK1K        SETLL     BOOKLF01
     C   53              MOVE      KOAAVD        YAVD5             4 0
     C   53BOOK5K        SETLL     BOOKLF05
     C   54              MOVE      KOAAVD        YAVD6             4 0
     C   54BOOK6K        SETLL     BOOKLF06
     C   55              MOVE      KOAAVD        YAVD3             4 0
     C   55BOOK3K        SETLL     BOOKLF13
     C   56              MOVE      KOAAVD        YAVD14
     C   56BOO14K        SETLL     BOOKLF14
     C   57              MOVE      KOAAVD        YAVD12
     C   57BOO12K        SETLL     BOOKLF12
     C   58              MOVE      KOAAVD        YAVD10
     C   58BOO10K        SETLL     BOOKLF10
     C   59              MOVE      KOAAVD        YAVD8
     C   59BOO08K        SETLL     BOOKLF08
     C   50              MOVE      KOAAVD        YAVD4
     C   50BOO04K        SETLL     BOOKLF04
N01  C   49              MOVE      KOAAVD        YAVD7
N01  C   49BOO07K        SETLL     BOOKLF07
     C                   EXSR      PRINT
     C                   MOVE      '0'           *IN33
     C                   GOTO      START
     C                   END
     C                   END
     C*
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C                   SETOFF                                       60
     C   52              MOVE      UUKEF         XUKE              2 0
     C*
     C     STP           TAG
     C                   MOVE      *ZEROS        NT
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       VS
     C                   MOVE      *ZEROS        VK
     C                   MOVE      *ZEROS        M3
     C   51              READ      BOOKLF09                               60
     C   51
     CANN60BODT1         COMP      UDTT                               60
     C   51
     CANN60BOAVD         IFNE      YAVD9
     C                   GOTO      STP
     C                   END
     C   52BOK11K        READE     BOOKLF01                               60
     C   52
     CANN60BOUKE         COMP      UUKET                              60
     C   53BOK51K        READE     BOOKLF05                               60
     C   54BOK61K        READE     BOOKLF06                               60
     C   55BOK31K        READE     BOOKLF13                               60
     C   56BOK14K        READE     BOOKLF14                               60
     C   57BOK12K        READE     BOOKLF12                               60
     C   58BOK10K        READE     BOOKLF10                               60
     C   59BOK08K        READE     BOOKLF08                               60
     C   50BOK04K        READE     BOOKLF04                               60
N01  C   49BOK07K        READE     BOOKLF07                               60
     C  N60BOST          IFEQ      'S'
     C                   GOTO      STP
     C                   END
     C   61
     CAN 52
     CAN 60XUKE          DOWLT     UUKET
     C                   ADD       1             XSIDE
     C                   ADD       1             XUKE
     C                   WRITE     LHEAD
     C                   END
     C  N61              DO
     C   52              Z-ADD     7             XLINJE            2 0
     C  N52              Z-ADD     50            XLINJE
     C   52
     CAN 60XUKE          DOWLE     UUKET
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD
     C                   ADD       1             XUKE
     C                   END
     C   52
     CANN60              ADD       1             XSIDE
     C   52
     CANN60              WRITE     LHEAD
     C   52
     CANN60XUKE          DOWLT     BOUKE
     C                   ADD       1             XSIDE
     C                   ADD       1             XUKE
     C                   WRITE     LHEAD
     C                   END
     C                   SETON                                        61
     C                   END
     C*
     C   60              GOTO      SLP
     C                   EXSR      KDTFM2
     C*
     C   52XUKE          DOWLT     BOUKE
     C                   Z-ADD     7             XLINJE
     C                   ADD       1             XSIDE
     C                   ADD       1             XUKE
     C                   WRITE     LHEAD
     C                   END
     C                   EXSR      HHENT
      *
     C                   MOVE      *ZEROS        XN3               3 0
     C     BLV1K         SETLL     BLV1LF                             33
     C     BLV1K         READE     BLV1LF                                 33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *ZEROS        NT
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       VS
     C                   MOVE      *ZEROS        VK
     C                   MOVE      *ZEROS        M3
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XN3
     C                   MOVE      BVNT          NT(XN3)
     C                   MOVEL     BVMN          MN(XN3)
     C                   MOVE      BVVS          VS(XN3)
     C                   MOVE      BVVKT         VK(XN3)
     C                   MOVE      BVM3          M3(XN3)
     C     BLV1K         READE     BLV1LF                                 33
     C                   END
     C                   ELSE
     C                   Z-ADD     5             XN4               1 0
     C     1             DO        4             XN2                            1<-B
     C     CD(XN2)       IFNE      *BLANKS                                       2<-B
     C                   MOVE      CD(XN2)       XKDC              2
     C     XKDC          CHAIN     CDCON4                             33
     C  N33              ADD       1             XN3
     C  N33              MOVEL     CC4FT         MN(XN3)
     C                   END                                                     2<-E
     C     MN(XN4)       IFNE      *BLANKS                                       2<-B
     C     XN3           IFNE      0                                              3<-B
     C     MN(XN4)       IFEQ      MN(XN3)                                         4<-B
     C                   MOVE      *BLANKS       MN(XN4)
     C                   GOTO      STP2
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   ADD       1             XN3
     C                   MOVE      MN(XN4)       MN(XN3)
     C     XN4           IFLT      8                                              3<-B
     C                   MOVE      *BLANKS       MN(XN4)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     STP2          TAG
     C                   ADD       1             XN4
     C                   END                                                    1<-E
     C                   END
      *
     C                   SETOFF                                       33
     C     1             DO        90            XN2               3 0
     C     NT(XN2)       IFNE      0
     C     MN(XN2)       ORNE      *BLANKS
     C     VS(XN2)       ORNE      *BLANKS
     C     VK(XN2)       ORNE      0
     C     M3(XN2)       ORNE      0
     C                   MOVE      NT(XN2)       XNT
     C                   MOVE      MN(XN2)       XMN
     C                   MOVE      VS(XN2)       XVS
     C                   MOVE      VK(XN2)       XVK
     C                   MOVE      M3(XN2)       XM3
     C  N33              ADD       3             XLINJE
     C   33              ADD       1             XLINJE
     C     XLINJE        IFGE      45
     C  N33              Z-ADD     9             XLINJE
     C   33              Z-ADD     8             XLINJE
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD
     C                   END
     C  N33              WRITE     DET1
     C   33              WRITE     DET2
     C                   SETON                                        33
     C                   END
     C                   END
     C*
     C  N33              DO
     C                   MOVE      *ZEROS        XNT
     C                   MOVE      *BLANKS       XMN
     C                   MOVE      *BLANKS       XVS
     C                   MOVE      *ZEROS        XVK
     C                   MOVE      *ZEROS        XM3
     C                   ADD       3             XLINJE
     C     XLINJE        IFGE      45
     C                   Z-ADD     9             XLINJE
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD
     C                   END
     C                   WRITE     DET1
     C                   END
      *
     C     BLV2K         SETLL     BLV2LF                             33
     C     STP3          TAG
     C     BLV2K         READE     BLV2LF                                 33
     C  N33BVKD          IFEQ      'N'
     C     BVKD          OREQ      'Y'
     C                   ADD       1             XLINJE
     C     XLINJE        IFGE      45
     C                   Z-ADD     8             XLINJE
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD
     C                   END
     C                   WRITE     DET4
     C                   END
     C  N33              GOTO      STP3
     C*
     C                   ADD       1             XLINJE
     C                   WRITE     DET3
     C*
     C                   GOTO      STP
     C*
     C     SLP           ENDSR
     C*
     C******************************************
     C     HHENT         BEGSR
     C******************************************
     C     BOLB          CHAIN     CDBOAT                             33
     C  N33              MOVEL     CBNAB         XLBN             30
     C   33              MOVE      *BLANKS       XLBN
     C   33              MOVEL     BOLBN         XLBN
     C     BOOB          CHAIN     CDBOAT                             33
     C  N33              MOVEL     CBNAB         XOBN             30
     C   33              MOVE      *BLANKS       XOBN
     C   33              MOVEL     BOOBN         XOBN
     C*
     C     BOLSH         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XLSHN            20
     C   33              MOVE      *BLANKS       XLSHN
     C   33              MOVEL     BOLSHN        XLSHN
     C     BOLSS         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XLSSN            20
     C   33              MOVE      *BLANKS       XLSSN
     C   33              MOVEL     BOLSSN        XLSSN
     C     BOVH          CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XVHN             20
     C   33              MOVE      *BLANKS       XVHN
     C   33              MOVEL     BOVHN         XVHN
     C     BOLOS         IFEQ      *BLANKS
     C     BOLOH         CHAIN     STED2                              33
     C                   ELSE
     C     BOLOS         CHAIN     STED2                              33
     C                   END
     C  N33              MOVEL     ST2NVN        XLOHN            20
     C   33              MOVE      *BLANKS       XLOHN
     C   33BOLOSN        IFEQ      *BLANKS
     C                   MOVEL     BOLOHN        XLOHN
     C                   ELSE
     C                   MOVEL     BOLOSN        XLOHN
     C                   END
     C*
     C                   MOVE      BOKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         XNAA             25
     C   33              MOVE      *BLANKS       XNAA
     C   33              MOVEL     BONAA         XNAA
     C                   MOVE      BOKNS         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         XNAS             25
     C   33              MOVE      *BLANKS       XNAS
     C   33              MOVEL     BONAS         XNAS
     C*
     C                   ENDSR
     C*
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     BOOK1K        KLIST
     C                   KFLD                    YAVD1
     C                   KFLD                    UACC
     C                   KFLD                    UAAR
     C                   KFLD                    UUKEF
     C     BOK11K        KLIST
     C                   KFLD                    YAVD1
     C                   KFLD                    UACC
     C                   KFLD                    UAAR
     C     BOOK5K        KLIST
     C                   KFLD                    YAVD5
     C                   KFLD                    ULB
     C                   KFLD                    UDTL
     C     BOK51K        KLIST
     C                   KFLD                    YAVD5
     C                   KFLD                    ULB
     C     BOOK6K        KLIST
     C                   KFLD                    YAVD6
     C                   KFLD                    ULSH
     C                   KFLD                    UDTH
     C     BOK61K        KLIST
     C                   KFLD                    YAVD6
     C                   KFLD                    ULSH
     C     BOOK3K        KLIST
     C                   KFLD                    YAVD3
     C                   KFLD                    UPRO
     C                   KFLD                    UDTP
     C     BOK31K        KLIST
     C                   KFLD                    YAVD3
     C                   KFLD                    UPRO
     C     BOOK9K        KLIST
     C                   KFLD                    UDTF
     C     BOO14K        KLIST
     C                   KFLD                    YAVD14
     C                   KFLD                    UVH
     C                   KFLD                    UDTV
     C     BOK14K        KLIST
     C                   KFLD                    YAVD14
     C                   KFLD                    UVH
     C     BOO12K        KLIST
     C                   KFLD                    YAVD12
     C                   KFLD                    ULOH
     C                   KFLD                    UDTS
     C     BOK12K        KLIST
     C                   KFLD                    YAVD12
     C                   KFLD                    ULOH
     C     BOO10K        KLIST
     C                   KFLD                    YAVD10
     C                   KFLD                    UREIS
     C     BOK10K        KLIST
     C                   KFLD                    YAVD10
     C                   KFLD                    UREIS
     C     BOO08K        KLIST
     C                   KFLD                    YAVD8
     C                   KFLD                    UOB
     C                   KFLD                    UDTO
     C     BOK08K        KLIST
     C                   KFLD                    YAVD8
     C                   KFLD                    UOB
     C     BOO04K        KLIST
     C                   KFLD                    YAVD4
     C                   KFLD                    UKNA
     C                   KFLD                    UDTA
     C     BOK04K        KLIST
     C                   KFLD                    YAVD4
     C                   KFLD                    UKNA
N01  C     BOO07K        KLIST
N01  C                   KFLD                    YAVD7
N01  C                   KFLD                    UKNSP
N01  C                   KFLD                    UDTSP
N01  C     BOK07K        KLIST
N01  C                   KFLD                    YAVD7
N01  C                   KFLD                    UKNSP
     C     BLV1K         KLIST
     C                   KFLD                    BOAVD
     C                   KFLD                    BOOPD
     C     BLV2K         KLIST
     C                   KFLD                    BOAVD
     C                   KFLD                    BOOPD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UPARM2          160
     C                   MOVE      UPARM2        UPARM
     C*
     C                   MOVE      *ZEROS        NT
     C                   MOVE      *BLANKS       CD
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       VS
     C                   MOVE      *ZEROS        VK
     C                   MOVE      *ZEROS        M3
     C                   MOVE      *ZEROS        UDTF
     C                   MOVE      *ZEROS        UDTT
     C                   MOVE      *ZEROS        UDTL
     C                   MOVE      *ZEROS        UDTH
     C                   MOVE      *ZEROS        UDTP
     C                   MOVE      *ZEROS        UDTV
     C                   MOVE      *ZEROS        UDTS
     C                   MOVE      *ZEROS        UDTO
     C                   MOVE      *ZEROS        UDTA
N01  C                   MOVE      *ZEROS        UDTSP
     C*
     C                   EXSR      TDIGIT
     C                   EXSR      KDTFM1
     C                   SELECT
     C     UDTF          WHENNE    0
     C                   MOVE      '1'           *IN51
     C     UUKEF         WHENNE    0
     C                   MOVE      '1'           *IN52
     C     ULB           WHENNE    *BLANKS
     C                   MOVE      '1'           *IN53
     C     ULB           CHAIN     CDBOAT                             33
     C  N33              MOVEL     CBNAB         XLBNV
     C   33              MOVE      *BLANKS       XLBNV
     C     ULSH          WHENNE    *BLANKS
     C                   MOVE      '1'           *IN54
     C     ULSH          CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XLSHNV
     C   33              MOVE      *BLANKS       XLSHNV
     C     UPRO          WHENNE    0
     C                   MOVE      '1'           *IN55
     C     UVH           WHENNE    *BLANKS
     C                   MOVE      '1'           *IN56
     C     UVH           CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XVHNV
     C   33              MOVE      *BLANKS       XVHNV
     C     ULOH          WHENNE    *BLANKS
     C                   MOVE      '1'           *IN57
     C     ULOH          CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XLOHNV
     C   33              MOVE      *BLANKS       XLOHNV
     C     UREIS         WHENNE    *BLANKS
     C                   MOVE      '1'           *IN58
     C     UOB           WHENNE    *BLANKS
     C                   MOVE      '1'           *IN59
     C     UOB           CHAIN     CDBOAT                             33
     C  N33              MOVEL     CBNAB         XOBNV
     C   33              MOVE      *BLANKS       XOBNV
S01  C*                  OTHER
N01  C     UKNA          WHENNE    0
     C                   MOVE      '1'           *IN50
     C                   MOVE      UKNA          KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         XKNANV
     C   33              MOVE      *BLANKS       XKNANV
N01  C     UKNSP         WHENNE    0
N01  C                   MOVE      '1'           *IN49
N01  C                   MOVE      UKNSP         KUNDNR
N01  C     KUND1K        CHAIN     CUNDL01                            33
N01  C  N33              MOVEL     KNAVN         XKNSNV
N01  C   33              MOVE      *BLANKS       XKNSNV
     C                   ENDSL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TDIGIT        BEGSR
     C***********************************************
     C                   TESTN                   UAVD2                33
     C  N33              MOVE      *ZEROS        UAVD1
     C   33              MOVE      UAVD2         UAVD1
     C                   TESTN                   UDTF2                33
     C     *IN33         IFEQ      '0'
     C     UDTF2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTF
     C                   ELSE
     C     UDTF2         IFGT      '501231'
     C                   MOVE      19000000      UDTF
     C                   ELSE
     C                   MOVE      20000000      UDTF
     C                   END
     C                   MOVE      UDTF2         UDTF
     C                   END
     C                   TESTN                   UDTT2                33
     C     *IN33         IFEQ      '0'
     C     UDTT2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTT
     C                   ELSE
     C     UDTT2         IFGT      '501231'
     C                   MOVE      19000000      UDTT
     C                   ELSE
     C                   MOVE      20000000      UDTT
     C                   END
     C                   MOVE      UDTT2         UDTT
     C                   END
     C                   TESTN                   UAAR2                33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *ZEROS        UAAR              2 0
     C                   MOVE      *ZEROS        UACC              2 0
     C                   ELSE
     C     UAAR2         IFGT      '50'
     C                   MOVE      19            UACC
     C                   ELSE
     C                   MOVE      20            UACC
     C                   END
     C                   MOVE      UAAR2         UAAR
     C                   END
     C                   TESTN                   UUKEF2               33
     C  N33              MOVE      *ZEROS        UUKEF             2 0
     C   33              MOVE      UUKEF2        UUKEF
     C                   TESTN                   UUKET2               33
     C  N33              MOVE      *ZEROS        UUKET             2 0
     C   33              MOVE      UUKET2        UUKET
     C                   TESTN                   UDTL2                33
     C     *IN33         IFEQ      '0'
     C     UDTL2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTL
     C                   ELSE
     C     UDTL2         IFGT      '501231'
     C                   MOVE      19000000      UDTL
     C                   ELSE
     C                   MOVE      20000000      UDTL
     C                   END
     C                   MOVE      UDTL2         UDTL
     C                   END
     C                   TESTN                   UDTH2                33
     C     *IN33         IFEQ      '0'
     C     UDTH2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTH
     C                   ELSE
     C     UDTH2         IFGT      '501231'
     C                   MOVE      19000000      UDTH
     C                   ELSE
     C                   MOVE      20000000      UDTH
     C                   END
     C                   MOVE      UDTH2         UDTH
     C                   END
     C                   TESTN                   UPRO2                33
     C  N33              MOVE      *ZEROS        UPRO              8 0
     C   33              MOVE      UPRO2         UPRO
     C                   TESTN                   UDTP2                33
     C     *IN33         IFEQ      '0'
     C     UDTP2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTP
     C                   ELSE
     C     UDTP2         IFGT      '501231'
     C                   MOVE      19000000      UDTP
     C                   ELSE
     C                   MOVE      20000000      UDTP
     C                   END
     C                   MOVE      UDTP2         UDTP
     C                   END
     C                   TESTN                   UDTV2                33
     C     *IN33         IFEQ      '0'
     C     UDTV2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTV
     C                   ELSE
     C     UDTV2         IFGT      '501231'
     C                   MOVE      19000000      UDTV
     C                   ELSE
     C                   MOVE      20000000      UDTV
     C                   END
     C                   MOVE      UDTV2         UDTV
     C                   END
     C                   TESTN                   UDTS2                33
     C     *IN33         IFEQ      '0'
     C     UDTS2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTS
     C                   ELSE
     C     UDTS2         IFGT      '501231'
     C                   MOVE      19000000      UDTS
     C                   ELSE
     C                   MOVE      20000000      UDTS
     C                   END
     C                   MOVE      UDTV2         UDTS
     C                   END
     C                   TESTN                   UDTO2                33
     C     *IN33         IFEQ      '0'
     C     UDTO2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTO
     C                   ELSE
     C     UDTO2         IFGT      '501231'
     C                   MOVE      19000000      UDTO
     C                   ELSE
     C                   MOVE      20000000      UDTO
     C                   END
     C                   MOVE      UDTO2         UDTO
     C                   END
     C                   TESTN                   UKNA2                33
     C  N33              MOVE      *ZEROS        UKNA              8 0
     C   33              MOVE      UKNA2         UKNA
     C                   TESTN                   UDTA2                33
     C     *IN33         IFEQ      '0'
     C     UDTA2         OREQ      *ZEROS
     C                   MOVE      *ZEROS        UDTA
     C                   ELSE
     C     UDTA2         IFGT      '501231'
     C                   MOVE      19000000      UDTA
     C                   ELSE
     C                   MOVE      20000000      UDTA
     C                   END
     C                   MOVE      UDTA2         UDTA
     C                   END
N01  C                   TESTN                   UKNSP2               33
N01  C  N33              MOVE      *ZEROS        UKNSP             8 0
N01  C   33              MOVE      UKNSP2        UKNSP
N01  C                   TESTN                   UDTSP2               33
N01  C     *IN33         IFEQ      '0'
N01  C     UDTSP2        OREQ      *ZEROS
N01  C                   MOVE      *ZEROS        UDTSP
N01  C                   ELSE
N01  C     UDTSP2        IFGT      '501231'
N01  C                   MOVE      19000000      UDTSP
N01  C                   ELSE
N01  C                   MOVE      20000000      UDTSP
N01  C                   END
N01  C                   MOVE      UDTA2         UDTSP
N01  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      UYEAR         UDT3              2 0
     C                   MOVE      UMONTH        UDT2              2 0
     C                   MOVE      UDAY          UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XIDAG3
     C                   MOVE      UDT2          XIDAG2
     C                   MOVE      UDT1          XIDAG1
     C                   MOVE      UDTFÅ         UDT3              2 0
     C                   MOVE      UDTFM         UDT2              2 0
     C                   MOVE      UDTFD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTFÅ
     C                   MOVE      UDT2          XDTFM
     C                   MOVE      UDT1          XDTFD
     C                   MOVE      UDTTÅ         UDT3              2 0
     C                   MOVE      UDTTM         UDT2              2 0
     C                   MOVE      UDTTD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTTÅ
     C                   MOVE      UDT2          XDTTM
     C                   MOVE      UDT1          XDTTD
     C                   MOVE      UDTLÅ         UDT3              2 0
     C                   MOVE      UDTLM         UDT2              2 0
     C                   MOVE      UDTLD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTLÅ
     C                   MOVE      UDT2          XDTLM
     C                   MOVE      UDT1          XDTLD
     C                   MOVE      UDTHÅ         UDT3              2 0
     C                   MOVE      UDTHM         UDT2              2 0
     C                   MOVE      UDTHD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTHÅ
     C                   MOVE      UDT2          XDTHM
     C                   MOVE      UDT1          XDTHD
     C                   MOVE      UDTPÅ         UDT3              2 0
     C                   MOVE      UDTPM         UDT2              2 0
     C                   MOVE      UDTPD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTPÅ
     C                   MOVE      UDT2          XDTPM
     C                   MOVE      UDT1          XDTPD
     C                   MOVE      UDTVÅ         UDT3              2 0
     C                   MOVE      UDTVM         UDT2              2 0
     C                   MOVE      UDTVD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTVÅ
     C                   MOVE      UDT2          XDTVM
     C                   MOVE      UDT1          XDTVD
     C                   MOVE      UDTSÅ         UDT3              2 0
     C                   MOVE      UDTSM         UDT2              2 0
     C                   MOVE      UDTSD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTSÅ
     C                   MOVE      UDT2          XDTSM
     C                   MOVE      UDT1          XDTSD
     C                   MOVE      UDTOÅ         UDT3              2 0
     C                   MOVE      UDTOM         UDT2              2 0
     C                   MOVE      UDTOD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTOÅ
     C                   MOVE      UDT2          XDTOM
     C                   MOVE      UDT1          XDTOD
     C                   MOVE      UDTAÅ         UDT3              2 0
     C                   MOVE      UDTAM         UDT2              2 0
     C                   MOVE      UDTAD         UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDTAÅ
     C                   MOVE      UDT2          XDTAM
     C                   MOVE      UDT1          XDTAD
N01  C                   MOVE      UDTSPÅ        UDT3              2 0
N01  C                   MOVE      UDTSPM        UDT2              2 0
N01  C                   MOVE      UDTSPD        UDT1              2 0
N01  C                   EXSR      KDTFMT
N01  C                   MOVE      UDT3          XDTSPÅ
N01  C                   MOVE      UDT2          XDTSPM
N01  C                   MOVE      UDT1          XDTSPD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      BODT1Å        UDT3              2 0
     C                   MOVE      BODT1M        UDT2              2 0
     C                   MOVE      BODT1D        UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDT1Å
     C                   MOVE      UDT2          XDT1M
     C                   MOVE      UDT1          XDT1D
     C                   MOVE      BODT3Å        UDT3              2 0
     C                   MOVE      BODT3M        UDT2              2 0
     C                   MOVE      BODT3D        UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDT3Å
     C                   MOVE      UDT2          XDT3M
     C                   MOVE      UDT1          XDT3D
     C                   MOVE      BODT4Å        UDT3              2 0
     C                   MOVE      BODT4M        UDT2              2 0
     C                   MOVE      BODT4D        UDT1              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          XDT4Å
     C                   MOVE      UDT2          XDT4M
     C                   MOVE      UDT1          XDT4D
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
