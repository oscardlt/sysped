********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 POSISJON FLYTTING I UDS
********************************************************************
      *
      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE UT      ***
      ***                   GODSLISTE                          ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 01 02 04-26                       ***
      *** LEDIGE INDIKATORER 27-97                             ***
      ************************************************************
      *
     FFIRM      IF   E           K DISK
     FTURER     IF   E           K DISK
     FHEAD14    IF   E           K DISK
     FWRKAG     O  A E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTH     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FSYFAGOFM  CF   E             WORKSTN
     D                 DS
     D  UDAG                   1      2  0
     D  UMND                   3      4  0
     D  UAAR                   5      6  0
     D  UDATO                  1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  KOVFIR                 3      4
     D  KOVPRO                13     13
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D* XBLA1/XBLA2 ER IKKE I BRUK. HVIS TAR NOEN POSISJONER TIL BRUK
     D* HUSK Å SYNKE STØRRELSE PÅ XBLA1/XBL2
     D  XBLA1                 30    256
     D  XBLA2                257    510
     D  CMR                   30     30
     D  INS1                  56     85
S01  D* VED2                  86    115
S01  D* INS2                 116    145
S01  D* VED3                 146    175
S01  D* INS3                 176    205
S01  D* INS4                 206    235
S01  D* CFRANK               236    238
N01  D  VED2                  96    125
N01  D  INS2                 126    155
N01  D  VED3                 156    185
N01  D  INS3                 186    215
N01  D  INS4                 216    245
N01  D  CFRANK               246    248
     D* SYINN 200689 - LEV.ADRESSE STYRES FRA BESTILLINGSBILDE
     D  LEV1                 265    294
     D  LEV2                 295    324
     D  LEV3                 325    354
     D  LEV4                 355    384
     D  CSTED                385    410
     D  CDATO                411    416  0
     D  VED1                 417    446
     D  UPRT11               821    830
     D  UPT11                831    840
     D  UPRT12               841    850
     D  UPT12                851    860
     D  UPRT13               861    870
     D  UPT13                871    880
     D  BRUDDA               961    961
     I*
     C*
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPLNR
     C     KODTWK        KLIST
     C                   KFLD                    WSWUNI
     C                   KFLD                    WSAVD
     C     KODTVK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    WSAVD
     C     KODTHK        KLIST
     C                   KFLD                    WSHUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    WSFUNI
     C                   KFLD                    WSSG
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TUKNA
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UJBKØ             1
     C                   PARM                    UIN03             1
     C                   PARM                    UIN04             1
     C                   PARM                    UIN01             1
     C                   PARM                    FAXJN             1
     C                   PARM                    FAXNR            15
     C                   PARM                    UUAVD             4
     C                   PARM                    UUTUR             8
     C                   PARM                    UBRUD             1
     C                   PARM                    EDIJN
     C                   PARM                    LISJN
     C                   PARM                    BELJN
     C                   PARM                    BELJN2
     C                   PARM                    DADRJN
     C                   MOVE      '0'           UIN01
     C     FAXJN         COMP      'J'                                    50
     C  N50              MOVE      'J'           UJBKØ
     C  N50              MOVE      'J'           WSJBK
     C                   MOVE      *BLANKS       BRUDDA
     C  N50              MOVE      'J'           LISJN
     C*
     C                   MOVE      'P'           WSPUNI            1
     C                   MOVE      'W'           WSWUNI            1
     C                   MOVE      'V'           WSVUNI            1
     C                   MOVE      'H'           WSHUNI            1
     C                   MOVE      'SF'          WSFUNI            2
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
     C* BLANKE DE FELTENE SOM IKKE ER I BRUK
     C                   MOVE      *BLANKS       XBLA1
     C                   MOVE      *BLANKS       XBLA2
     C                   MOVE      UDAY          UDAG
     C                   MOVE      UMONTH        UMND
     C                   MOVE      UYEAR         UAAR
     C                   MOVE      UDATO         CDATO
     C*
     C                   READ      FIRM                                   99
     C                   MOVE      FIFIRM        UFIRM
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C*
     C     KODTVK        CHAIN     KODTV                              99
     C  N99KODTWK        CHAIN     KODTW                              99
     C  N99KODTHK        CHAIN     KODTH                              99
     C  N99              Z-ADD     22            WSPLNR            3 0
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT11
     C  N99              MOVE      KOPTY         UPT11
     C  N99              Z-ADD     23            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT12
     C  N99              MOVE      KOPTY         UPT12
     C  N99              Z-ADD     24            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT13
     C  N99              MOVE      KOPTY         UPT13
     C   99              GOTO      START
     C     WSSG          IFNE      'ALL'
     C     KODSFK        CHAIN     KODTSF                             98
     C   98              GOTO      START
     C                   END
     C*
     C* HENTER OPPLYSNINGER FRA TURREGISTER
     C*
     C     TUKEY         KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPRO
     C*
     C     TUKEY         CHAIN     TURER                              97
     C   97              GOTO      START
     C*
     C     EDIJN         IFEQ      'J'
     C     DADRJN        ANDEQ     'J'
     C                   MOVE      'J'           BRUDDA
     C                   END
     C*
     C                   MOVE      WSAVD         UAVD
     C                   MOVE      WSAVD         UUAVD
     C                   MOVE      WSSG          USG
     C                   MOVE      WSPRO         UPRO
     C                   MOVE      WSPRO         UUTUR
     C                   MOVE      WSJBK         UJBKØ
     C     KOHLS1        IFEQ      'L'                                                      TÅENDE')
     C                   MOVE      '0'           UIN03
     C                   ELSE
     C                   MOVE      '1'           UIN03
     C                   END
     C     KOH421        IFEQ      'J'
     C                   MOVE      '1'           UIN04
     C                   ELSE
     C                   MOVE      '0'           UIN04
     C                   END
     C     WSPRT         IFNE      *BLANKS
     C                   MOVE      WSPRT         UPRT11
     C                   MOVE      WSPRT         UPRT12
     C                   MOVE      WSPRT         UPRT13
     C                   END
     C     UPRT11        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT11
     C                   END
     C     UPT11         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT11
     C                   END
     C     UPRT12        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT12
     C                   END
     C     UPT12         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT12
     C                   END
     C*
     C     UPRT13        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT13
     C                   END
     C     UPT13         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT13
     C                   END
     C*
     C     BRUDDA        IFEQ      'J'
     C     FAXJN         ANDEQ     'J'
     C     EDIJN         OREQ      'J'
     C                   EXSR      AGENT
     C                   END
     C     LISJN         IFNE      'J'
     C     BELJN         ANDEQ     'J'
     C                   MOVE      *BLANK        BELJN
     C                   ENDIF
     C     FAXJN         IFNE      'J'
     C     BELJN2        ANDEQ     'J'
     C                   MOVE      *BLANK        BELJN2
     C                   ENDIF
     C     DADRJN        IFNE      'J'
     C                   MOVE      *BLANK        DADRJN
     C                   ENDIF
     C*
     C     SLUTT         TAG
     C                   MOVE      BRUDDA        UBRUD
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      CDATO         XDTFMT            4 0
     C                   MOVEL     CDATO         UDT1              2 0
     C                   MOVEL     XDTFMT        UDT2              2 0
     C                   MOVE      XDTFMT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVEL     UDT1          CDATO
     C                   MOVEL     UDT2          XDTFMT
     C                   MOVE      UDT3          XDTFMT
     C                   MOVE      XDTFMT        CDATO
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     AGENT         BEGSR
     C***********************************************
     C     AGKE1         KLIST
     C                   KFLD                    WSPRO
     C                   KFLD                    HEKNA             8 0
     C                   MOVE      *ZEROS        HEKNA
     C     AGKE2         KLIST
     C                   KFLD                    WSPRO
     C     AGKE3         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    HEKNA             8 0
      *_______________
      * Brudd på Agent
      *"""""""""""""""
     C                   SELECT
     C     BRUDDA        WHENEQ    'J'
      *
     C     STAG          TAG
     C     AGKE1         SETLL     HEAD14
     C     AGKE2         READE     HEAD14                                 33
     C  N33              DO
     C     AGKE3         CHAIN     CUNDL01                            34
     C  N34              DO
     C                   MOVE      TFAXNR        AFAXNR
     C                   Z-ADD     TUAVD         WRAVD
     C                   Z-ADD     WSPRO         WRPRO
     C                   WRITE     WRKAGR
     C                   END
     C                   ADD       1             HEKNA
     C                   GOTO      STAG
     C                   END
      *____________________
      * Ikke brudd på Agent
      *""""""""""""""""""""
     C                   OTHER
      *
     C                   MOVE      TUKNA         HEKNA
     C     AGKE3         CHAIN     CUNDL01                            34
     C     *IN34         IFEQ      '0'
     C                   MOVE      TFAXNR        AFAXNR
     C                   Z-ADD     TUAVD         WRAVD
     C                   Z-ADD     WSPRO         WRPRO
     C                   WRITE     WRKAGR
     C                   ENDIF
      *
     C                   ENDSL
      *
     C                   ENDSR
