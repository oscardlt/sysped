/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 JOV PTF10 IKKE KOPIER SPOOLFIL VED TR014PF                   */
/* 10XXX * 01 SH  PTF11 TATT BORT CPYSPLF                                 */
/* TATT BORT EMLSPL N01 */
/* FJERNET ALLE FOREKOMSTER AV EMLSPL FYSISK */
/* KUTTET SENDING TIL DISTRIBUSJONSMOTTAGERE */
/* ********************************************************************    */
/* ENDRET EPOSTSRC TIL Å LIGGE I QTEMPO */
             PGM        PARM(&QUSER &QNBR &QJOB &SPOOL &EPOST &EMNE +
                          &CVP1 &CVP2 &CVP3 &CVP4 &CVP5 &CVP6 &CVP7 +
                          &CVP8 &PDF &AVD &OPD &KUNDE)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(22)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&KUNDE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&MANAUT) TYPE(*CHAR) LEN(1) VALUE('V')
             DCL        VAR(&RPLNA) TYPE(*CHAR) LEN(8) +
                          VALUE('*CURRENT')
             DCL        VAR(&RPLAD) TYPE(*CHAR) LEN(8)
             DCL        VAR(&UUUNIK) TYPE(*CHAR) LEN(9)
             DCL        VAR(&MELD1) TYPE(*CHAR) LEN(256)
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(1) /* DISTLISTE */
             DCL        VAR(&MELD1) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD2) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD3) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD4) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD5) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD6) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD) TYPE(*CHAR) LEN(1536)
             DCL        VAR(&DISTL) TYPE(*CHAR) LEN(6) /* DISTLISTE */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(11) /* Unikkode */
             DCL        VAR(&TIL) TYPE(*CHAR) LEN(30)
             DCL        VAR(&JOBN) TYPE(*CHAR) LEN(6)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOSTF) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO01) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO02) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO03) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO04) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO05) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO06) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO07) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO08) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO09) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO10) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO11) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO12) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO13) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO14) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO15) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO16) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO17) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO18) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO19) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO20) TYPE(*CHAR) LEN(50)
             DCL        VAR(&SPOOL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMNE) TYPE(*CHAR) LEN(70)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(70)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&PDF) TYPE(*CHAR) LEN(4)
             DCL        VAR(&TIL50) TYPE(*CHAR) LEN(50)
             DCL        VAR(&LOG50) TYPE(*CHAR) LEN(50)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10) VALUE(QTEMP)
             DMPCLPGM
 RTVTIME:    RTVJOBA    NBR(&JOBN)
/*                      */
             CHGVAR     VAR(&RPLNA) VALUE(&QUSER)
             RTVNETA    SYSNAME(&RPLAD)
/*                      */
/* HENT REPLYADRESSE    */
/*                      */
/*                      */
             CALL       PGM(EPOS04) PARM(&QUSER &RPLNA &RPLAD &EPOSTF)
/*                      */
/*                      */
/* LEGGER UT COVERPAGE  */
/* I SOURCE             */
/*                      */
             RTVDTAARA  DTAARA(FIRMDT (141 10)) RTNVAR(&LIB)
             ADDPFM     FILE(&LIB/EPOSTSRC) MBR(&QUSER)
             MONMSG     MSGID(CPF0000)
             CLRPFM     FILE(&LIB/EPOSTSRC) MBR(&QUSER)
             OVRDBF     FILE(EPOSTSRC) TOFILE(&LIB/EPOSTSRC) +
                          MBR(&QUSER)
             CHGVAR     VAR(&LOG50) VALUE(&EPOST)
             CALL       PGM(EPMM01N) PARM(&CVP1 &CVP2 &CVP3 &CVP4 +
                          &CVP5 &CVP6 &CVP7 &EMNE &LOG50 &MANAUT +
                          &UUUNIK &AVD &OPD &KUNDE)
/* LAG SNDDST I QTEMP   */
/*                      */
             DLTF       FILE(QTEMP/SNDDST)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(EPOST80) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(SNDDST)
/*                                     */
/* PRØVER Å LAGRE SPOOLFILE            */
/*                                     */
/*           IF         COND(((&SPOOL *NE 'SYEF44P') *AND (&SPOOL +
                          *NE 'SYEF14P')) *AND (&SPOOL *NE +
                          'TR014PF')) THEN(DO)    */
/*           CPYSPLF    FILE(&SPOOL) TOFILE(QTEMP/SNDDST) +      */
/*                        JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST)  */
/*                        MBROPT(*ADD) CTLCHAR(*NONE)            */
/*           MONMSG     MSGID(CPA0000 CPF0000)                   */
/*           ENDDO                                               */
/*           OVRDBF     FILE(EPOST80) TOFILE(QTEMP/SNDDST)       */
/*           CALL       PGM(EPMM02) PARM(&UUUNIK)                */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*N01*/      CHGVAR     VAR(&BANE) VALUE('/temp/' *TCAT &QUSER *TCAT +
                            'HO.PDF')
/*N01*/      CVTSPLFPDF SPLF(&SPOOL) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
/*                                     */
/* UTEN DISTRIBUSJONSLISTE             */
/*                                     */
             CHGVAR     VAR(&DIST) VALUE(%SST(&EPOST 1 1))
             CHGVAR     VAR(&DISTL) VALUE(%SST(&EPOST 2 6))
             IF         COND(&DIST *NE '*') THEN(DO)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
/*                      */
/*           DLTSPLF    FILE(&SPOOL) JOB(&QNBR/&QUSER/&QJOB)  */
/*           MONMSG     MSGID(CPF0000)   */
             RMVLIBLE   LIB(MMAIL)
             RETURN
             ENDDO
/*                      */
/*                                       */
/*                                     */
/*  SENDING VED DISTRIBUSJONSLISTE     */
/*                                     */
             CALL       PGM(EPODIS) PARM(&DISTL &EPO01 &EPO02 &EPO03 +
                          &EPO04 &EPO05 &EPO06 &EPO07 &EPO08 &EPO09 +
                          &EPO10 &EPO11 &EPO12 &EPO13 &EPO14 &EPO15 +
                          &EPO16 &EPO17 &EPO18 &EPO19 &EPO20)
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO01 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO01)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO02 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO02)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO03 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO03)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO04 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO04)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO05 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO05)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO06 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO06)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO07 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO07)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO08 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO08)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO09 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO09)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO10 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO10)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO11 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO11)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO12 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO12)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO13 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO13)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO14 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO14)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO15 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO15)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO16 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO16)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO17 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO17)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO18 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO18)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO19 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO19)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO20 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPOST) VALUE(&EPO20)
/*N01*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&QUSER) +
                          FROMADDR(&EPOSTF) TO(&EPOST/&QUSER/*TO) +
                          STMF(&BANE) /*N05*/
             MONMSG     MSGID(CPF0000) EXEC(RETURN)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             ENDPGM
/*                      */
