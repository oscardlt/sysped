/*N01 - FEIL VED *NOMAX   */
             PGM        PARM(&FRALIB &FILSIZ)
             DCL        VAR(&FRALIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FILSIZ) TYPE(*CHAR) LEN(10)
             DCLF       FILE(*LIBL/FILSIZP) RCDFMT(QWHFDBAS)

             OVRDBF     FILE(FILSIZP) TOFILE(&FRALIB/FILSIZP)

             CHGJOB     JOB(*) LOG(4 00 *SECLVL) LOGCLPGM(*YES)

             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Lager +
                          filoversikt i FILSIZP i bibliotek') +
                          TOPGMQ(*EXT) MSGTYPE(*STATUS)

             DSPFD      FILE(&FRALIB/*ALL) TYPE(*BASATR) +
                          OUTPUT(*OUTFILE) FILEATR(*PF) +
                          OUTFILE(&FRALIB/FILSIZP)
             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Endrer +
                          filstørrelsen') TOPGMQ(*EXT) MSGTYPE(*STATUS)
LOOP1:
             RCVF       DEV(*FILE) RCDFMT(*FILE)
             MONMSG     MSGID(CPF0864) EXEC(GOTO CMDLBL(SLUTT))

             IF         COND(&ATDTAT *NE 'D') THEN(GOTO +
                          CMDLBL(LOOP1)) /* Hopper over source filer */

 /*S01       IF         COND(&FILSIZ = *NOMAX *OR &FILSIZ = *SAME) +*/
             IF         COND(&FILSIZ = *NOMAX) +
                          THEN(DO)
             CHGPF      FILE(&FRALIB/&ATFILE) SIZE(*NOMAX *N *N)
             ENDDO
             ELSE       CMD(DO)
             CHGPF      FILE(&FRALIB/&ATFILE) SIZE(&FILSIZ 30000 10)
             ENDDO

             GOTO       CMDLBL(LOOP1)

SLUTT:
             DLTF       FILE(&FRALIB/FILSIZP)
             MONMSG     MSGID(CPF0000)
             RCLRSC
