********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12240 * 01 YBC PTF12 Antall kolli og containerkode på side2
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE BILL OF LADING            ***
      ***        VARELINJER (SIDE-2)                          ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-11 13-24                ***
      *** LEDIGE INDIKATORER 27-32 35-99                      ***
      ***********************************************************
      *
     FBLVSD2    UF A E           K DISK
N01  FCDCON4    IF   E           K DISK
     FSYSJ50FG  CF   E             WORKSTN
N01  F                                     INFDS(FBAREA)
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
     D                 DS
     D  WSMN1                  1     17
     D  WSMN2                 18     34
     D  WSMN3                 35     51
     D  WSMN4                 52     68
     D  WSMN5                 69     85
     D  WSMN6                 86    102
     D  WSMN7                103    119
     D  WSMN8                120    136
     D  WSMN9                137    153
     D  WSMN10               154    170
     D  WSMN11               171    187
     D  WSMN12               188    204
     D  WSMN13               205    221
     D  WSMN14               222    238
     D  WSMN15               239    255
     D  WSMN16               256    272
     D  WSMN17               273    289
     D  WSMN18               290    306
     D  WSMN19               307    323
     D  WSMN20               324    340
     D  MN                     1    340    DIM(20)
     D                 DS
     D  WSFT1                  1     40
     D  WSFT2                 41     80
     D  WSFT3                 81    120
     D  WSFT4                121    160
     D  WSFT5                161    200
     D  WSFT6                201    240
     D  WSFT7                241    280
     D  WSFT8                281    320
     D  WSFT9                321    360
     D  WSFT10               361    400
     D  WSFT11               401    440
     D  WSFT12               441    480
     D  WSFT13               481    520
     D  WSFT14               521    560
     D  WSFT15               561    600
     D  WSFT16               601    640
     D  WSFT17               641    680
     D  WSFT18               681    720
     D  WSFT19               721    760
     D  WSFT20               761    800
     D  FT                     1    800    DIM(20)
     D                 DS
     D  WSVK1                  1      9  0
     D  WSVK2                 10     18  0
     D  WSVK3                 19     27  0
     D  WSVK4                 28     36  0
     D  WSVK5                 37     45  0
     D  WSVK6                 46     54  0
     D  WSVK7                 55     63  0
     D  WSVK8                 64     72  0
     D  WSVK9                 73     81  0
     D  WSVK10                82     90  0
     D  WSVK11                91     99  0
     D  WSVK12               100    108  0
     D  WSVK13               109    117  0
     D  WSVK14               118    126  0
     D  WSVK15               127    135  0
     D  WSVK16               136    144  0
     D  WSVK17               145    153  0
     D  WSVK18               154    162  0
     D  WSVK19               163    171  0
     D  WSVK20               172    180  0
     D  VK                     1    180  0 DIM(20)
     D                 DS
     D  WSM31                  1      9  3
     D  WSM32                 10     18  3
     D  WSM33                 19     27  3
     D  WSM34                 28     36  3
     D  WSM35                 37     45  3
     D  WSM36                 46     54  3
     D  WSM37                 55     63  3
     D  WSM38                 64     72  3
     D  WSM39                 73     81  3
     D  WSM310                82     90  3
     D  WSM311                91     99  3
     D  WSM312               100    108  3
     D  WSM313               109    117  3
     D  WSM314               118    126  3
     D  WSM315               127    135  3
     D  WSM316               136    144  3
     D  WSM317               145    153  3
     D  WSM318               154    162  3
     D  WSM319               163    171  3
     D  WSM320               172    180  3
     D  M3                     1    180  3 DIM(20)
N01  D                 DS
N01  D  WSNT1                  1      5  0
N01  D  WSNT2                  6     10  0
N01  D  WSNT3                 11     15  0
N01  D  WSNT4                 16     20  0
N01  D  WSNT5                 21     25  0
N01  D  WSNT6                 26     30  0
N01  D  WSNT7                 31     35  0
N01  D  WSNT8                 36     40  0
N01  D  WSNT9                 41     45  0
N01  D  WSNT10                46     50  0
N01  D  WSNT11                51     55  0
N01  D  WSNT12                56     60  0
N01  D  WSNT13                61     65  0
N01  D  WSNT14                66     70  0
N01  D  WSNT15                71     75  0
N01  D  WSNT16                76     80  0
N01  D  WSNT17                81     85  0
N01  D  WSNT18                86     90  0
N01  D  WSNT19                91     95  0
N01  D  WSNT20                96    100  0
N01  D  NT                     1    100  0 DIM(20)
N01  D                 DS
N01  D  WSKD1                  1      2
N01  D  WSKD2                  3      4
N01  D  WSKD3                  5      6
N01  D  WSKD4                  7      8
N01  D  WSKD5                  9     10
N01  D  WSKD6                 11     12
N01  D  WSKD7                 13     14
N01  D  WSKD8                 15     16
N01  D  WSKD9                 17     18
N01  D  WSKD10                19     20
N01  D  WSKD11                21     22
N01  D  WSKD12                23     24
N01  D  WSKD13                25     26
N01  D  WSKD14                27     28
N01  D  WSKD15                29     30
N01  D  WSKD16                31     32
N01  D  WSKD17                33     34
N01  D  WSKD18                35     36
N01  D  WSKD19                37     38
N01  D  WSKD20                39     40
N01  D  KD                     1     40    DIM(20)
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE
N01   *
N01  C   04              DO
N01  C                   EXSR      SØKDTA
N01  C                   GOTO      START
N01  C                   END
     C*
     C   12YLI           IFEQ      1
     C                   GOTO      SLUTT
     C                   ELSE
     C                   SUB       20            YLI
     C                   EXSR      MOVBVW
     C                   GOTO      START
     C                   END
N01   *
N01  C  N031             DO        20            XN
N01  C                   IF        KD(XN) <> *BLANKS
N01  C     KD(XN)        CHAIN     CDCON4                             33
N01  C                   IF        *IN33
N01  C                   EVAL      LINNBR = XN + 3
N01  C                   EVAL      POSNBR = 87
N01  C                   GOTO      START
N01  C                   END
N01  C                   END
N01  C                   ENDDO
     C*
     C                   EXSR      OPDBV
     C  N03YLI           IFLT      201
     C                   GOTO      START
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     MOVBVW        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       FT
     C                   MOVE      *ZEROS        VK
     C                   MOVE      *ZEROS        M3
N01  C                   MOVE      *ZEROS        NT
N01  C                   MOVE      *BLANKS       KD
     C*
     C     YLI           SUB       1             XLI               3 0
     C     XLI           ADD       20            XLI2              3 0
     C     YLI           DO        XLI2          YLI
     C     BLVSDK        CHAIN     BLVSD2                             33
     C  N33              UPDATE    BLVSD2R
     C  N33              DO
     C     BVLI          SUB       XLI           BL                3 0
     C                   MOVE      BVMN          MN(BL)
     C                   MOVE      BVFT2         FT(BL)
     C                   MOVE      BVVKT         VK(BL)
     C                   MOVE      BVM3          M3(BL)
N01  C                   MOVE      BVNT          NT(BL)
N01  C                   MOVE      BVKDC         KD(BL)
     C                   END
     C                   END
     C     XLI           ADD       1             YLI
     C*
     C     YLI           IFEQ      1
     C                   MOVE      MSG1          MSGLIN
     C                   END
     C     YLI           IFEQ      21
     C                   MOVE      MSG2          MSGLIN
     C                   END
     C     YLI           IFEQ      41
     C                   MOVE      MSG3          MSGLIN
     C                   END
     C     YLI           IFEQ      61
     C                   MOVE      MSG4          MSGLIN
     C                   END
     C     YLI           IFEQ      81
     C                   MOVE      MSG5          MSGLIN
     C                   END
     C     YLI           IFEQ      101
     C                   MOVE      MSG6          MSGLIN
     C                   END
     C     YLI           IFEQ      121
     C                   MOVE      MSG7          MSGLIN
     C                   END
     C     YLI           IFEQ      141
     C                   MOVE      MSG8          MSGLIN
     C                   END
     C     YLI           IFEQ      161
     C                   MOVE      MSG9          MSGLIN
     C                   END
     C     YLI           IFEQ      181
     C                   MOVE      MSG10         MSGLIN
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBV         BEGSR
     C***********************************************
     C     YLI           SUB       1             XLI
     C     XLI           ADD       20            XLI2
     C     YLI           DO        XLI2          YLI
     C     BLVSDK        CHAIN     BLVSD2                             33
     C     YLI           SUB       XLI           BL
     C     MN(BL)        IFEQ      *BLANKS
     C     FT(BL)        ANDEQ     *BLANKS
     C     VK(BL)        ANDEQ     0
     C     M3(BL)        ANDEQ     0
N01  C     NT(BL)        ANDEQ     0
N01  C     KD(BL)        ANDEQ     *BLANKS
     C  N33              DELETE    BLVSD2R
     C                   ELSE
     C                   MOVE      UAVD          BVAVD
     C                   MOVE      UOPD          BVOPD
     C                   MOVE      YLI           BVLI
     C                   MOVE      MN(BL)        BVMN
     C                   MOVE      FT(BL)        BVFT2
     C                   MOVE      VK(BL)        BVVKT
     C                   MOVE      M3(BL)        BVM3
N01  C                   MOVE      NT(BL)        BVNT
N01  C                   MOVE      KD(BL)        BVKDC
N01  C     KD(BL)        CHAIN     CDCON4                             34
N01  C   34              Z-ADD     0             BVENH
N01  C  N34              Z-ADD     CC4NT         BVENH
     C   33              WRITE     BLVSD2R
     C  N33              UPDATE    BLVSD2R
     C                   END
     C                   END
     C*
     C     XLI           ADD       21            YLI
     C                   EXSR      MOVBVW
     C*
     C                   ENDSR
     C*
N01   ***********************************************
N01  C     SØKDTA        BEGSR
N01   ***********************************************
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C                   IF        LINNBR >= 4 AND LINNBR <= 20
N01  C                             AND POSNBR >= 87 AND POSNBR <= 88
N01  C     LINNBR        SUB       3             XN                3 0
N01  C                   MOVE      KD(XN)        UKD               2
N01  C                   CALL      'SYSJ02X'
N01  C                   PARM                    UKD
N01  C                   IF        UKD <> *BLANKS
N01  C                   EVAL      KD(XN) = UKD
N01  C                   END
N01  C                   IF        LINNBR < 20
N01  C                   ADD       1             LINNBR
N01  C                   END
N01  C                   Z-ADD     87            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BLVSDK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    YLI
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UDTR              6 0
     C                   PARM                    USG               3
     C                   PARM                    UUKE              2 0
     C                   PARM                    UAAR              2 0
     C                   PARM                    UFLAGG            1 0
     C                   Z-ADD     0             UFLAGG
     C*
     C                   MOVE      'DIV3180'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     40            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG1             40
     C                   MOVE      'DIV3181'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG2             40
     C                   MOVE      'DIV3182'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG3             40
     C                   MOVE      'DIV5117'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG4             40
     C                   MOVE      'DIV5118'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG5             40
     C                   MOVE      'DIV5121'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG6             40
     C                   MOVE      'DIV5122'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG7             40
     C                   MOVE      'DIV5123'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG8             40
     C                   MOVE      'DIV5124'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG9             40
     C                   MOVE      'DIV5125'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          MSG10            40
     C*
     C                   Z-ADD     1             YLI               3 0
     C                   EXSR      MOVBVW
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
