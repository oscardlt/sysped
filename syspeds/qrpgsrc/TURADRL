********************************************************************
      * Program for OVERSIKT OVER TURER SOM.....
********************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 ...
********************************************************************
     FTURER22   IF   E           K DISK
     FHEAD14    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FTURADRFL  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     C                   EXSR      INIT
      *
     C     VALGTAG       TAG
     C                   EVAL      *IN03=*OFF
     C                   EVAL      *IN12=*OFF
     C                   EXFMT     VALG
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
      *
     C     Start0        tag
     c                   movea     '00'          *in(71)
     c                   move      '0'           *in(30)
     c     WSDTT         ifeq      *zeros
     c                   z-add     wsdtf         WSDTT
     c                   endif
     c     WSdtf         ifeq      *zeros
     C                   MOVE      *ON           *IN30
     C                   MOVE      *ON           *IN70
     C                   MOVE      'JOV1529'     MSGNR
     c                   goto      ValgTag
     c                   end
     C*
     C* OK datoer angitt - vis turer
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      * Sett ind, for underutvalg  (*IN50 brukes i DSPF)
     C                   MOVE      'J'           INCL              1
     C                   MOVE      *ZEROS        ANTLEST           5 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     WSDTF         SETLL     TURER22
     C*
     C                   READ      TURER22                                94
     C     *IN94         DOWEQ     '0'
     C                   ADD       1             ANTLEST
     C     TUDT          CABGT     WSDTT         UTTUR
     C     ANTLEST       CABGT     1000          UTTUR
     C     TUKNT2        CABNE     *ZEROS        NEXTTUR
     C                   EXSR      INCLUD
     C     INCL          CABEQ     'N'           NEXTTUR
     C                   EXSR      TSTSUBF
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     NEXTTUR       TAG
     C                   READ      TURER22                                94
     C  N94              END
     C     UTTUR         TAG
      *
     C                   MOVE      'J'           FRTOPP            1
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C     FRTOPP        IFEQ      'J'
     C                   Z-ADD     1             ZRECNO
     C                   MOVE      'N'           FRTOPP            1
     C                   END
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C                   SETOFF                                       9899
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*
     C*** FRISK OPP
     C   05              GOTO      START
     C*
     C*** Underutvalg
     C     *IN08         IFEQ      '1'
     C     *IN12         oreq      '1'
     C                   GOTO      VALGTAG
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   END
      * Enter - også uten utført valg - vis samme bilde/poster
     C                   GOTO      START3
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*

     C***********************************************
     C     TSTSUBF       BEGSR
     C***********************************************
     C                   MOVEA     '00000'       *IN(55)
     C                   MOVE      TUPRO         SFTUR
     C                   MOVE      TUKNA         SFAGENT
     C                   MOVE      ' '           SFAGPLU
     C                   MOVE      TUDT          SFDATO
     C*                  MOVE      xxxx          SFLRGK1
     C*                  MOVE      xxxx          SFLRGK2
     C*                  MOVE      xxxx          SFLRST
     C     TUPRO         SETLL     HEAD14
     C     TUPRO         READE     HEAD14                                 55
     C     *IN55         DOWEQ     '0'
     C                   ADD       1             SFAO
     C                   ADD       HENT          SFAKLL
     C     HEKNA         IFNE      TUKNA
     C                   MOVE      '+'           SFAGPLU
     C                   ENDIF
     C     TUPRO         READE     HEAD14                                 55
     C                   ENDDO
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INCLUD        BEGSR
     C***********************************************
     C                   MOVE      'J'           INCL
      * Kun agent
     c     WSage         Ifne      *zeros
     c     WSage         andne     TUKNA
     C                   MOVE      'N'           INCL
     c                   goto      EndInc
     c                   endif
      * Kun avdeling
     c     WSavd         Ifne      *zeros
     c     WSavd         andne     TUAVD
     C                   MOVE      'N'           INCL
     c                   goto      EndInc
     c                   endif
      * Kun im/ex - sjekk første oppdrag
     c     WSIE          Ifne      ' '
     C     TUPRO         CHAIN     HEAD14                             55
     c     *in55         ifeq      '0'
     c     WSIE          ifeq      'I'
     c     HEUR          andne     'A'
     C                   MOVE      'N'           INCL
     c                   goto      EndInc
     c                   endif
     c     WSIE          ifeq      'E'
     c     HEUR          andne     'B'
     C                   MOVE      'N'           INCL
     c                   goto      EndInc
     c                   endif
     c                   endif
     c                   endif
     C*
     C     EndInc        ENDSR
     C*
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR            3 0
     C                   MVR                     POSNBR            3 0
     C                   move      LINNBR        GMLNBR            3 0
     C                   move      POSNBR        GMPNBR            3 0
     C                   SETOFF                                       30
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   GOTO      SLHENT
     C                   END
      * VIS MANIFEST / TURDETALJER
     C     WSNR          IFEQ      '1'
     C                   MOVE      ' '           WSNR
     C                   EXSR      MANIFSR
     C   12              GOTO      SLHENT
     C                   END
      * ARBEIDE MED LOSSERAPPORT
     C     WSNR          IFEQ      '2'                                          SLETTE
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGSI
     C   12              GOTO      SLHENT
     C                   END
      * Vis fraktbrev
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C***                CALL      'SYFM21C'
     C***                PARM                    FIFIRM
     C                   SETON                                        99
     C*                  EXSR      TSTSUBF
     C                   UPDATE    SUBFIL
     C                   END
     C*
     C                   END
     C*
     C     SLHENT        TAG
     C                   move      GMLNBR        LINNBR
     C                   move      GMPNBR        POSNBR
     C*
     C                   ENDSR
     C***********************************************
     C     CHGSI         BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   Z-ADD     25            LINNBR
     C                   Z-ADD     24            POSNBR
     c     StrChg        tag
      *
     C*                  EXSR      TSTSUBF
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
      ***********************************************
     C     MANIFSR       BEGSR
      ***********************************************
     C                   MOVE      SFTUR         XXPRO             8
     C                   move      '00000000'    XXAGE             8
N02  C                   MOVE      ' '           XXFUNK            1
     C                   CALL      'TURADR'
     C                   PARM                    XXPRO
     C                   PARM                    XXAGE
N02  c                   PARM                    XXFUNK
      *
     C*                  EXSR      TSTSUBF
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    AATUR             8
N03  C                   PARM                    AAFUNK            1
     C     AAFUNK        IFEQ      'D'
     c                   move      AATUR         SFTUR
     C                   endif
      * KOMMER INN MED TURNR OG AAFUNK ER ?? - GÅ RETT TIL TIL TUREN
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      * dagens dato
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WSDTF             8 0
      *
      * DSfelt
     C*                  move      *zeros        XXXT
     C                   ENDSR
     C*
