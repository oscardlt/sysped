             PGM

             DCL        VAR(&QNAME) TYPE(*CHAR) LEN(10) VALUE(SMA05Q)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10) VALUE(*LIBL)
             DCL        VAR(&FLDLEN) TYPE(*DEC) LEN(5 0) VALUE(10)
             DCL        VAR(&FIELD) TYPE(*CHAR) LEN(5)
             DCL        VAR(&WAIT) TYPE(*DEC) LEN(5 0) VALUE(9999)
             DCL        VAR(&ORDER) TYPE(*CHAR) LEN(2) VALUE(GE)
             DCL        VAR(&KEYLEN) TYPE(*DEC) LEN(3 0) VALUE(10)
             DCL        VAR(&KEY) TYPE(*CHAR) LEN(10)

             DCLF       FILE(SMA03D)

             SNDRCVF    RCDFMT(SMA03DA) WAIT(*NO)

 START:      CHGVAR     VAR(&KEYLEN) VALUE(10)
             CHGVAR     VAR(&KEY) VALUE('          ')
             CHGVAR     VAR(&FIELD) VALUE('          ')

             CALL       PGM(QRCVDTAQ) PARM(&QNAME &LIB &FLDLEN +
                          &FIELD &WAIT &ORDER &KEYLEN &KEY)

             CHGVAR     VAR(&TFIELD) VALUE(&FIELD)
             CHGVAR     VAR(&TKEY) VALUE(&KEY)
             SNDRCVF    RCDFMT(SMA03DB) WAIT(*NO)

             GOTO       CMDLBL(START)

             ENDPGM
