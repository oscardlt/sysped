********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 CB  PTF10 8 nye felter, ikke merket
     FSVT055D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FSVTFI     UF   E             DISK
     FEDII      IF   E           K DISK
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_______________________
      * Hent firmaopplysninger
      *"""""""""""""""""""""""
     C     1             CHAIN(N)  SVTFI                              51
     C                   CLEAR                   SVT055DA
     C                   EVAL      ZVTF_SIGM=SVTF_SIGM
     C                   EVAL      ZVTF_0004=SVTF_0004
     C                   EVAL      ZVTF_0008=SVTF_0008
     C                   EVAL      ZVTF_0010=SVTF_0010
     C                   EVAL      ZVTF_0014=SVTF_0014
     C                   EVAL      ZVTF_0022=SVTF_0022
     C                   EVAL      ZVTF_0035=SVTF_0035
     C                   EVAL      ZVTF_PREF=SVTF_PREF
     C                   EVAL      ZVTF_NUMB=SVTF_NUMB
     C                   EVAL      ZVTF_KVAL=SVTF_KVAL
     C                   EVAL      ZVTF_SEC1=SVTF_SEC1
     C                   EVAL      ZVTF_SEC2=SVTF_SEC2
     C                   EVAL      ZVTF_CER1=SVTF_CER1
     C                   EVAL      ZVTF_CER2=SVTF_CER2
     C                   EVAL      ZVTF_CER3=SVTF_CER3
     C                   EVAL      ZVTF_CER4=SVTF_CER4
     C                   EVAL      ZVTF_USRI=SVTF_USRI
     C                   EVAL      ZVTF_USRA=SVTF_USRA
      *_______________
      * Behandle bilde
      *"""""""""""""""
     C     SRB1          TAG

     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     SVT055DØ
     C                   EXFMT     SVT055DA
     C                   EVAL      *IN30=*OFF
     C                   EVAL      *IN31=*OFF
     C                   EVAL      *IN32=*OFF
     C                   EVAL      *IN33=*OFF
     C                   EVAL      *IN34=*OFF
     C                   EVAL      *IN35=*OFF
     C                   EVAL      *IN36=*OFF
     C                   EVAL      *IN37=*OFF
     C                   EVAL      *IN38=*OFF
     C                   EVAL      *IN39=*OFF
     C                   EVAL      *IN40=*OFF
     C                   EVAL      *IN41=*OFF
     C                   EVAL      *IN42=*OFF
     C                   EVAL      *IN43=*OFF
     C                   EVAL      *IN44=*OFF
     C                   EVAL      *IN45=*OFF
     C                   EVAL      *IN46=*OFF
     C                   EVAL      *IN47=*OFF
      *_______________
      * F3,F12=Avlsutt
      *"""""""""""""""
     C                   IF         *IN03
     C                   GOTO      SRB9
     C                   ENDIF
     C                   IF         *IN12
     C                   GOTO      SRB9
     C                   ENDIF
      *_______
      * F4=Søk
      *"""""""
     C                   IF        *IN04

     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * Avsændarid
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDEQ     34
     C                   CALL      'EDI52R'
     C                   PARM                    ZVTF_0004
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDEQ     34
     C                   CALL      'EDI52R'
     C                   PARM                    ZVTF_0010
     C                   GOTO      SRB1
     C                   ENDIF

     C                   ENDIF
      *___________
      * Test input
      *"""""""""""
     C     SRB2          TAG
      * Sigilleringsmetod må vare 'M'
     C     ZVTF_SIGM     IFNE      'M'
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN31=*ON
     C                   MOVE      'SVT0000'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Avsændarid må vare utfyllt
     C     ZVTF_0004     IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN32=*ON
     C                   MOVE      'SVT0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Avsændarid må finnes
     C     ZVTF_0004     CHAIN     EDII                               30
     C                   IF        *IN30
     C                   EVAL      *IN32=*ON
     C                   MOVE      'SVT0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid må vare utfyllt
     C     ZVTF_0010     IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN33=*ON
     C                   MOVE      'SVT0002'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid må finnes
     C     ZVTF_0010     CHAIN     EDII                               30
     C                   IF        *IN30
     C                   EVAL      *IN33=*ON
     C                   MOVE      'SVT0002'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Testindikator må vare 1 eller blank
     C     ZVTF_0035     IFNE      *BLANKS
     C     ZVTF_0035     ANDNE     '1'
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN34=*ON
     C                   MOVE      'SVT0003'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Løsenord må vare utfyllt
     C     ZVTF_0022     IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN35=*ON
     C                   MOVE      'SVT0004'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF

     C     1             CHAIN     SVTFI                              51

     C                   EVAL      SVTF_SIGM=ZVTF_SIGM
     C                   EVAL      SVTF_0004=ZVTF_0004
     C                   EVAL      SVTF_0008=ZVTF_0008
     C                   EVAL      SVTF_0010=ZVTF_0010
     C                   EVAL      SVTF_0014=ZVTF_0014
     C                   EVAL      SVTF_0022=ZVTF_0022
     C                   EVAL      SVTF_0035=ZVTF_0035
     C                   EVAL      SVTF_PREF=ZVTF_PREF
     C                   EVAL      SVTF_NUMB=ZVTF_NUMB
     C                   EVAL      SVTF_KVAL=ZVTF_KVAL
     C                   EVAL      SVTF_SEC1=ZVTF_SEC1
     C                   EVAL      SVTF_SEC2=ZVTF_SEC2
     C                   EVAL      SVTF_CER1=ZVTF_CER1
     C                   EVAL      SVTF_CER2=ZVTF_CER2
     C                   EVAL      SVTF_CER3=ZVTF_CER3
     C                   EVAL      SVTF_CER4=ZVTF_CER4
     C                   EVAL      SVTF_USRI=ZVTF_USRI
     C                   EVAL      SVTF_USRA=ZVTF_USRA
     C                   UPDATE    SVTFIR

     C   30              GOTO      SRB1

     C     SRB9          ENDSR
