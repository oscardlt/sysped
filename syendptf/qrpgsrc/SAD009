********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12248 * 01 YBC PTF12 VEKT, KOLLI ER UTVIDET.
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT SPEDISJONSJOURNAL            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-11 13-26                ***
      *** LEDIGE INDIKATORER 27-29 31-40 44 48    56-96       ***
      ***********************************************************
      *
     Fsysthlp   IF   E             DISK
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSADH1     IF   E           K DISK
     FSADH6B    IF   E           K DISK
     F                                     RENAME(SADHR:SADH6R)
     FSAEH6B    IF   E           K DISK
     FSADH7     IF   E           K DISK
     F                                     RENAME(SADHR:SADH7R)
     FEDIM2     IF   E           K DISK
     FSAD009FM  CF   E             WORKSTN
     FDATALIST  O    F  132        PRINTER OFLIND(*INOF)
     F                                     FORMLEN(48)
     F                                     FORMOFL(44)
     D                 DS
     D  XÅRF2                  1      4  0
     D  XMNDF2                 5      6  0
     D  XDAGF2                 7      8  0
     D  XDATOF                 1      8  0
     D                 DS
     D  XÅRT2                  1      4  0
     D  XMNDT2                 5      6  0
     D  XDAGT2                 7      8  0
     D  XDATOT                 1      8  0
     D                 DS
     D  XDAGF                  1      2  0
     D  XMNDF                  3      4  0
     D  XÅRF                   5      6  0
     D  WSDTF                  1      6  0
     D                 DS
     D  XDAGT                  1      2  0
     D  XMNDT                  3      4  0
     D  XÅRT                   5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  WSDTGD                 1      2  0
     D  WSDTGM                 3      4  0
     D  WSDTGÅ                 5      6  0
     D  WSDTGF                 1      6  0
     D                 DS
     D  SIGN                   1     15
     D  SIPOS5                16     20
     D  SIPOS                 16     24
     D  NYGOPO                 1     24
     D                 DS
     D  GMGN                   1     15
     D  GMPOS                 16     24
     D  GMGOPO                 1     24
     D                 DS
     D  SIDTG                  1     10
     D  SIDTG8                 1      8
     D                 DS
     D  SIVKB                  1      9  0
     D  SIVKB6                 4      9  0
     D                 DS
     D  SEDTG                  1     10
     D  SEDTG8                 1      8
     D                 DS
S01  D* SEVKB                  1      9  0
S01  D* SEVKB6                 4      9  0
N01  D  SEVKB                  1     11  0
N01  D  SEVKB6                 6     11  0
N01  D                 DS
N01  D  SENTK                  1     10  0
N01  D  SENTK7                 4     10  0
     D                 DS
     D  SINAS                  1     30
     D  SINASX                 1     23
     D                 DS
     D  SENAK                  1     30
     D  SENAKX                 1     23
     D                 DS
     D  SEPOS                  1      8
     D  SEPOS5                 1      5
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE01
     c   01              do
     c                   movel     'sad0091'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START
     c                   end
     C                   SETOFF                                       4299
     C   03              GOTO      SLUTT
     C*
     C     WSVALG        COMP      1                                  999941
     C   99WSVALG        COMP      2                                  999942
     C   99              GOTO      START
     C                   EXSR      MOVBWS
     C   42              GOTO      START3
     C*
     C     START2        TAG
     C                   EXFMT     BILDE02
     c   01              do
     c                   movel     'sad0092'     hlpna
     c                   exsr      helpsr
     C                   GOTO      START2
     c                   end
     C                   SETOFF                                       309998
     C                   SETOFF                                       97
     C   03              GOTO      SLUTT
     C   12              MOVE      *ZEROS        WSVALG
     C   12              GOTO      START
     C*
     C                   EXSR      TESTB2
     C   30              GOTO      START2
     C                   EXSR      PRINT2
     C                   GOTO      SLUTT
     C*
     C     START3        TAG
     C                   EXFMT     BILDE03
     c   01              do
     c                   movel     'sad0093'     hlpna
     c                   exsr      helpsr
     C                   GOTO      START3
     c                   end
     C                   SETOFF                                       309998
     C                   SETOFF                                       97
     C   03              GOTO      SLUTT
     C   12              MOVE      *ZEROS        WSVALG
     C   12              GOTO      START
     C*
     C                   EXSR      TESTB3
     C   30              GOTO      START3
     C                   EXSR      PRINT3
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSDTF         IFEQ      0
     C                   Z-ADD     010151        WSDTF
     C                   END
     C                   MOVE      XDAGF         XDAGF2
     C                   MOVE      XMNDF         XMNDF2
     C     XÅRF          IFGT      50
     C     XÅRF          ADD       1900          XÅRF2
     C                   ELSE
     C     XÅRF          ADD       2000          XÅRF2
     C                   END
     C                   MOVE      XDAGT         XDAGT2
     C                   MOVE      XMNDT         XMNDT2
     C     XÅRT          IFGT      50
     C     XÅRT          ADD       1900          XÅRT2
     C                   ELSE
     C     XÅRT          ADD       2000          XÅRT2
     C                   END
     C     XDATOF        COMP      XDATOT                             99
     C   99              MOVE      'SPD0007'     MSGNR
     C   99              SETON                                        30
     C*
     C     WSAVDF        COMP      *ZEROS                               9898
     C   98
     CANN30              MOVE      'SPA0024'     MSGNR
     C  N98              DO
     C     WSAVDT        IFEQ      *ZEROS
     C                   MOVE      WSAVDF        WSAVDT
     C                   END
     C     WSAVDF        COMP      WSAVDT                             98
     C   98
     CANN30              MOVE      'SPA0003'     MSGNR
     C                   END
     C   98              SETON                                        30
     C*
     C  N30
     CAN 41WSMI          COMP      'J'                                    43
     C  N30
     CAN 43              SETOFF                                           41
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
     C                   SETOFF                                       979899
     C     WSGNF         COMP      *BLANKS                                99
     C   99              MOVE      'SPG0007'     MSGNR
     C  N99              DO
     C     WSGNT         IFEQ      *BLANKS
     C                   MOVE      WSGNF         WSGNT
     C                   END
     C     WSGNF         COMP      WSGNT                              99
     C   99              MOVE      'SPG0006'     MSGNR
     C                   END
     C   99              SETON                                        30
     C* DATO FRA OG MED - GODSNR???
     C     WSDTGF        IFNE      *ZEROS
     C                   MOVE      WSDTGD        UDTD
     C                   MOVE      WSDTGM        UDTM
     C                   MOVE      WSDTGÅ        UDTÅ
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      97
     C   97
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPD0001'     MSGNR
     C                   END
     C                   ELSE
     C                   Z-ADD     010151        WSDTGF
     C                   END
     C     WSAVDT        IFEQ      *ZEROS
     C                   MOVE      WSAVDF        WSAVDT
     C                   END
     C     WSAVDF        COMP      WSAVDT                             98
     C   98
     CANN30              MOVE      'SPA0003'     MSGNR
     C   98              SETON                                        30
     C*
     C* INGEN FEIL ?
     C* KONVERTER TIL YYMMDD
     C                   Z-ADD     WSDTGF        UUDT              6 0
     C  N30FIDTFM        IFNE      3
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM                    UUDT
     C                   END
     C                   MOVE      UUDT          UUDT8             8 0
     C     UUDT          IFGT      500000
     C                   MOVEL     '19'          UUDT8
     C                   ELSE
     C                   MOVEL     '20'          UUDT8
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SJDATO        BEGSR
     C***********************************************
     C                   CALL      'TESTDATO'
     C                   PARM                    UDTD              2 0
     C                   PARM                    UDTM              2 0
     C                   PARM                    UDTÅ              2 0
     C                   PARM                    UFLAGG            1 0
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     MOVBWS        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSDTF
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        WSDTGF
     C                   MOVE      *BLANKS       WSGNF
     C                   MOVE      *BLANKS       WSGNT
     C                   MOVE      *BLANKS       WSKKUN
     C                   MOVE      *BLANKS       WSKUTS
     C                   MOVE      *BLANKS       WSMI
     C                   MOVE      *BLANKS       WSKUEX
     C                   MOVE      *ZEROS        WSAVDF
     C                   MOVE      *ZEROS        WSAVDT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRINT2        BEGSR
     C***********************************************
     C     WSKKUN        COMP      'J'                                    50
     C  N50WSKKUN        COMP      'Y'                                    50
     C     WSKUTS        COMP      'J'                                    51
     C  N51WSKUTS        COMP      'Y'                                    51
     C*
     C     WSAVDF        DOWLE     WSAVDT
     C   41SADH1K        SETLL     SADH1
     C   43SADH7K        SETLL     SADH7
     C                   SETOFF                                       305253
     C*
     C     STPRI         TAG
     C                   SETOFF                                       454647
     C   41WSAVDF        READE     SADH1                                  30
     C   43WSAVDF        READE     SADH7                                  30
     C   41
     CANN30SIDT          COMP      XDATOT                             30
     C   43
     CANN30SIMI          COMP      'I'                                30
     C   43
     CANN30              EXSR      TVIINS
     C   43
     CANN30
     CAN 46              GOTO      STPRI
     C   43
     CANN30
     CANN45SIDT          COMP      XDATOT                             30
     C   43
     CANN30
     CANN45XDATOA        COMP      XDATOT                             30
     C*
     C  N30              DO
     C   50SIKTA         COMP      *ZEROS                             5252
     C   50
     CAN 51
     CANN52SIST          COMP      'P'                                5252
     C  N50
     CAN 51SIST          COMP      'P'                                5252
     C*
     C  N52              DO
     C  N53              EXCEPT    DLHEAD
     C  N53              SETON                                        53
     C   OF              EXCEPT    DLHEAD
     C                   ADD       1             ANOPPO            5 0
     C                   ADD       SIVKB         TOKGPO            9 0
     C                   ADD       SINTK         TOKOPO            9 0
     C                   EXCEPT    DLDET
     C                   END
     C*** END PÅ <N52 DO>
     C*
     C                   GOTO      STPRI
     C                   END
     C*** END PÅ <N30 DO>
     C*
     C   53              DO
     C   OF              EXCEPT    DLHEAD
     C                   EXCEPT    DLTOTP
     C                   ADD       ANOPPO        XANTOP            5 0
     C                   ADD       TOKGPO        XTKG              9 0
     C                   ADD       TOKOPO        XTNTK             9 0
     C                   MOVE      *ZEROS        ANOPPO
     C                   MOVE      *ZEROS        TOKGPO
     C                   MOVE      *ZEROS        TOKOPO
     C                   END
     C     WSAVDF        IFLT      9999
     C                   ADD       1             WSAVDF
     C                   ELSE
     C                   GOTO      SLPRI
     C                   END
     C                   END
     C*** END PÅ <WSAVDF  DOWLE  WSAVDT>
     C*
     C     SLPRI         TAG
     C* TOTALER
     C     XANTOP        IFGT      *ZEROS
     C                   EXCEPT    DLTOT
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     TVIINS        BEGSR
     C***********************************************
     C* DENNE RUTINEN TESTER OM INNSTIKK ER PÅ TVINN.
     C* FINNER MAN I LOGGEN ER MI OG IKKE UA RETURNERES 46 ON
     C* HOVEDRUTINEN HOPPER OVER POSTEN (INNSTIKKET ER IKKE GJORT ENNÅ)
     C* FINNER MAN I LOGGEN EN MI OG EN UA RETURNERES 45 ON
     C* DATO FOR UA LIGGER I XDATOA.
     C* VED 45 OFF ANTAR HOVEDRUTINEN AT INNSTIKKET ER MANUELLT
     C*
     C                   MOVE      *ZEROS        XDATOA            8 0
     C     TVIMK2        SETLL     EDIM2
     C     STTVI         TAG
     C     SIAVD         READE     EDIM2                                  47
     C  N47SITDN         COMP      MTDN                               4747
     C  N47              DO
     C  N46M0065         COMP      'NSADMI'                               46
     C  N45
     CAN 46M0065         COMP      'NCUMUA'                               45
     C   45              DO
     C                   SETOFF                                       46
     C                   MOVE      MDT           XDATOA
     C                   GOTO      SLTVI
     C                   END
     C                   GOTO      STTVI
     C                   END
     C*
     C     SLTVI         ENDSR
     C*
     C*
     C***********************************************
     C     PRINT3        BEGSR
     C***********************************************
     C     WSKKUN        COMP      'J'                                    50    UTEN KONTO
     C  N50WSKKUN        COMP      'Y'                                    50
     C     WSKUTS        COMP      'J'                                    51     BARE UTSKR.
     C  N51WSKUTS        COMP      'Y'                                    51
     C     WSKUEX        COMP      'J'                                    49     UTEN LØPENR
     C  N49WSKUEX        COMP      'Y'                                    49
     C*
     C     SADH6K        SETLL     SADH6B
     C                   SETOFF                                       30
     C*
     C     STPRI3        TAG
     C                   READ      SADH6B                                 30
     C  N30SIGN          COMP      WSGNT                              30
     C* OPPDRAGET FRA FØR GITT DATO FOR GODSNR.
     C  N30UUDT          IFNE      *ZEROS
     C     SIDT          ANDLT     UUDT8
     C                   GOTO      STPRI3
     C                   END
     C* MINDRE ENN FRA OG MED AVDELING
     C  N30WSAVDF        IFNE      *ZEROS
     C     SIAVD         ANDLT     WSAVDF
     C                   GOTO      STPRI3
     C                   END
     C* STØRRE ENN TIL OG MED AVDELING
     C  N30WSAVDT        IFNE      *ZEROS
     C     SIAVD         ANDGT     WSAVDT
     C                   GOTO      STPRI3
     C                   END
     C* KUN KONTANT??
     C  N30
     CAN 50SIKTA         IFNE      *ZEROS
     C                   GOTO      STPRI3
     C                   END
     C* KUN UTSKREVNE
     C  N30
     CAN 51SIST          IFNE      'P'
     C                   GOTO      STPRI3
     C                   END
     C*
     C* KUN DE UTEN LØPENUNMMER / EXP.STED
     C  N30
     CAN 49SITLL         IFNE      *BLANKS
     C                   GOTO      STPRI3
     C                   END
     C*
     C* FUNNET POST SOM SKAL SKRIVES PÅ JOURNAL
     C  N30              DO                                                     B1
     C* DERSOM FØRSTE POST - LEGG GODSNR/POS. INN I GM...
     C*                      (FOR Å UNNGÅ "TOTAL PÅ POS. ETTER 1. POST)
     C*                    - SKRIV HEADING  (HEADING OGSÅ V/OWERFLOW)
     C  N53              MOVE      SIGN          GMGN
     C  N53              MOVE      SIPOS         GMPOS
     C  N53              EXCEPT    GLHEAD
     C  N53              SETON                                        53
     C   OF              EXCEPT    GLHEAD
     C* DERSOM GODS/POS.NR ULIK FORIGE LINJE.....
     C     NYGOPO        IFNE      GMGOPO                                        B2
     C*       ...SKRIV TOTAL PÅ FORIGE OM DET VAR MER EN EN POSISJON
     C     ANOPPO        IFGT      1                                              B3
     C                   EXCEPT    GLTOTP
     C                   END                                                      E3
     C*  OM BRUDDET ER FORÅRSAKET AV NYTT GODSNR... SKRIV REEKSPORTERTE
     C     SIGN          IFNE      GMGN                                            B3
     C                   EXSR      REEXP
     C                   END                                                       E3
     C*       ...START AKKUMULERING PÅ NYTT GODSNR/POS
     C                   MOVE      SIGN          GMGN
     C                   MOVE      SIPOS         GMPOS
     C                   Z-ADD     1             ANOPPO            5 0
     C                   Z-ADD     SIVKB         TOKGPO            9 0
     C                   Z-ADD     SINTK         TOKOPO            9 0
     C                   ELSE                                                    X2
     C*  ELLERS  ADDER VEKTER PR GODSNR/POS. NÅR LIK FORIGE
     C                   ADD       1             ANOPPO            5 0
     C                   ADD       SIVKB         TOKGPO            9 0
     C                   ADD       SINTK         TOKOPO            9 0
     C                   END                                                     E2
     C*
     C* ADDER SIST LESTE TIL TOTALER / SKRIV DETALJLINJE
     C                   ADD       1             XANTOP            5 0
     C                   ADD       SIVKB         XTKG              9 0
     C                   ADD       SINTK         XTNTK             9 0
     C                   EXCEPT    GLDET
     C*FLERE SAD ??
     C*
     C                   GOTO      STPRI3
     C                   END                                                    E1
     C*SKRIV TOTAL PÅ FORIGE (SISTE) OM DET VAR MER EN EN POSISJON
     C     ANOPPO        IFGT      1                                            B1
     C                   EXCEPT    GLTOTP
     C                   END                                                    E1
     C* TOTALER
     C     XANTOP        IFGT      *ZEROS
     C                   EXCEPT    GLTOT
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     REEXP         BEGSR
     C***********************************************
     C*
     C                   SETOFF                                       5455
     C     GMGN          SETLL     SAEH6B
     C     GMGN          READE     SAEH6B                                 54
     C     *IN54         DOWEQ     '0'
     C   OF              EXCEPT    GLHEAD
     C  N55              EXCEPT    GLRHEA
     C  N55              SETON                                        55
     C                   EXCEPT    GLRDET
     C     GMGN          READE     SAEH6B                                 54
     C                   END
     C   55              EXCEPT    GLBLAN
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     GETMSG        BEGSR
     C***********************************************
     C                   MOVE      'DIV1814'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     35            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT1            35
     C                   MOVE      'DIV1815'     XMSGNR                         AVD.
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     4             XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT2             4
     C                   MOVE      'DIV1816'     XMSGNR                         FRA DATO
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     9             XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT3             9
     C                   MOVE      'DIV1787'     XMSGNR                         TIL DATO
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT4             8
     C                   MOVE      'DIV1817'     XMSGNR                         FRA GODNR.
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     12            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT5            12
     C                   MOVE      'DIV1818'     XMSGNR                         TIL GODNR.
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     11            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT6            11
     C                   MOVE      'DIV1819'     XMSGNR                         UOPPGJ. INNSTIKK
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     17            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT7            17
     C                   MOVE      'DIV1820'     XMSGNR                         UTSKR. DATO
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     15            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT8            15
     C                   MOVE      'DIV1821'     XMSGNR                         KUN KONTAKTKUNDER
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     48            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT9            48
     C                   MOVE      'DIV1822'     XMSGNR                         KUN UTSKREVNE SAD
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     48            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT10           48
     C                   MOVE      'DIV1823'     XMSGNR                         LEDERTEKST
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     120           XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT11          120
     C                   MOVE      'DIV1824'     XMSGNR                         * TVINN *
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     9             XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT12            8
     C                   MOVE      'DIV1825'     XMSGNR                         * TOTALT *
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     12            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT13           12
     C                   MOVE      'DIV1826'     XMSGNR                         ANT. OPPDRAG
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     30            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT14           30
     C                   MOVE      'DIV2374'     XMSGNR                         TOT. POS:
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     10            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT15           10
     C                   MOVE      'DIV2375'     XMSGNR                         LEDERTEKST
     C                   Z-ADD     3             XLEVEL                         VED VALG PÅ
     C                   Z-ADD     0             XRETUR                         GODSNR
     C                   Z-ADD     120           XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT16          120
     C                   MOVE      'DIV2380'     XMSGNR                         LEDERTEKST2
     C                   Z-ADD     3             XLEVEL                         VED VALG PÅ
     C                   Z-ADD     0             XRETUR                         GODSNR
     C                   Z-ADD     10            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT20           10
     C                   MOVE      'DIV2376'     XMSGNR                         SUMMER PR
     C                   Z-ADD     3             XLEVEL                         POSISJON
     C                   Z-ADD     0             XRETUR                         VED FLERE
     C                   Z-ADD     40            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT17           40
     C                   MOVE      'DIV2377'     XMSGNR                         ANT OPPDR.
     C                   Z-ADD     3             XLEVEL                         PÅ GODSNR
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT18           40
     C                   MOVE      'DIV2378'     XMSGNR                         REEKSP. PÅ
     C                   Z-ADD     3             XLEVEL                         SAMME GODSNR
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     40            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT19           40
     C                   MOVE      'DIV2381'     XMSGNR                         REEKSP. PÅ
     C                   Z-ADD     3             XLEVEL                         SAMME GODSNR
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     30            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT21           30
     C                   MOVE      'DIV2382'     XMSGNR                         UTSKR. AV.
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     15            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT22           15
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETTXT        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG            120
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C     USER          PARM      USER          USER             10
     C     LASER         PARM      LASER         LASER             1
     C     STRING        PARM      STRING        STRING            5
     C     COPY          PARM      COPY          COPY              2 0
     C*
     C     SADH1K        KLIST
     C                   KFLD                    WSAVDF
     C                   KFLD                    XDATOF
     C     SADH6K        KLIST
     C                   KFLD                    WSGNF
     C                   KFLD                    YYPOS
     C     *LIKE         DEFINE    SIPOS         YYPOS
     C                   MOVE      *ZEROS        YYPOS
     C     SADH7K        KLIST
     C                   KFLD                    WSAVDF
     C                   KFLD                    YMI
     C     TVIMK2        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C*
     C                   EXSR      GETMSG
     C                   READ      FIRM                                   33
     C                   MOVE      *ZEROS        WSDTF
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        WSDTGF
     C                   MOVE      *BLANKS       GMGN
     C                   MOVE      *BLANKS       GMPOS
     C*
     C                   MOVE      'I'           YMI               1
     C*
     C     STRING        IFNE      *BLANKS
     C     STRING        CHAIN     KODTFM                             33
     C                   END
     C     LASER         IFEQ      'A'
     C                   SETON                                        88
     C                   END
     C                   ENDSR
     C***********************************************
     C     HELPSR        BEGSR
     C***********************************************
     c
     c                   move      *blanks       pcocmd           70
     c     1             chain     systhlp                            33
     c     *in(33)       ifeq      '0'
      *
      * intern
     c                   movel     'http://'     pcocmd
     C     pcocmd        CAT       systip:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       systba:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       hlpna:0       pcocmd
     C     pcocmd        CAT       '.htm':0      pcocmd
      *
     c                   call      'SYGE34CL'
     c                   parm                    pcocmd
     c                   end
     C                   ENDSR
     C*
     O* VED  VALG PÅ DATO...
     ODATALIST  E            DLHEAD           01
     O                       KFMT1               75
     ODATALIST  E            DLHEAD           02
     O                       KFMT2               75
     O               88                          90 '¤&l'
     O               88      COPY                92
     O               88                          93 'X'
     O               88                         100 '¤(s12H'
     O               88                         106 '¤&l1O'
     ODATALIST  E            DLHEAD           03
     O               88                          10 '¤&a-3R'
     O               88                          35 '¤(12U¤(s0p12h0s3b4099T'
     ODATALIST  E            DLHEAD           03
     O               88                          24 '¤*c3350A¤*c190B¤*c11G¤*c'
     O               88                          26 '2P'
     ODATALIST  E            DLHEAD           03
     O                       XTXT22             121
     O                       USER               132
     ODATALIST  E            DLHEAD           04
     O                       XTXT1               35
     O                       XTXT2               41
     O                       WSAVDF        Z     46
     O                       XTXT3               58
     O                       WSDTF         Y     67
     O                       XTXT4               77
     O                       WSDTT         Y     86
     O               43      XTXT7              105
     O                       UDAY               124
     O                                          125 '/'
     O                       UMONTH             127
     O                                          128 '/'
     O                       UYEAR              130
     O          E            DLHEAD           05
     O               50      XTXT9               48
     O               51      XTXT10             100
     O          E            DLHEAD           06
     O                       XTXT11             120
     O          E            DLHEAD           07
     O                                           24 '------------------------'
     O                                           48 '------------------------'
     O                                           72 '------------------------'
     O                                           96 '------------------------'
     O                                          120 '------------------------'
     O                                          132 '------------'
     O          E            DLHEAD         1 07
     O               88                          25 '¤(12U¤(s0p12h0s0b4099T'
     O          E            DLDET          1
     O                       SITDN         Z      7
     O                       SINTK         Z     29
     O                       SIGN                23
     O                       SIVKB6        Z     37
     O                       SITLL               48
     O                       SITLE               55
     O                       SIDTG8              64
     O                       SINASX              89
     O                       SINAK              120
     O               45      XTXT12             130
     O          E            DLTOTP      2
     O                                           12 '*AVD. TOTAL*'
     O                       TOKGPO        Z     36
     O                       TOKOPO        Z     28
     O                       XTXT14              70
     O                       ANOPPO        Z     76
     O* SLUTTTOTAL
     O          E            DLTOT       2
     O                       XTXT13              12
     O                       XTKG          Z     36
     O                       XTNTK         Z     28
     O                       XTXT14              70
     O                       XANTOP        Z     76
     O* VED VALG PÅ GODSNR...
     ODATALIST  E            GLHEAD           01
     O                       KFMT1               75
     ODATALIST  E            GLHEAD           02
     O                       KFMT2               75
     O               88                          90 '¤&l'
     O               88      COPY                92
     O               88                          93 'X'
     O               88                         100 '¤(s12H'
     O               88                         106 '¤&l1O'
     ODATALIST  E            GLHEAD           03
     O               88                          10 '¤&a-3R'
     O               88                          35 '¤(12U¤(s0p12h0s3b4099T'
     ODATALIST  E            GLHEAD           03
     O               88                          24 '¤*c3350A¤*c190B¤*c11G¤*c'
     O               88                          26 '2P'
     ODATALIST  E            GLHEAD           03
     O                       XTXT22             121
     O                       USER               132
     ODATALIST  E            GLHEAD           04
     O                       XTXT1               35
     O                       XTXT5               59
     O                       WSGNF               75
     O                       XTXT6               88
     O                       WSGNT              102
     O                       UDAY               124
     O                                          125 '/'
     O                       UMONTH             127
     O                                          128 '/'
     O                       UYEAR              130
     O          E            GLHEAD           05
     O               50      XTXT9               48
     O               51      XTXT10             100
     O               49      XTXT21             132
     O          E            GLHEAD           06
     O                       XTXT16             120
     O                       XTXT20             132
     O          E            GLHEAD         1 07
     O                                           24 '------------------------'
     O                                           48 '------------------------'
     O                                           72 '------------------------'
     O                                           96 '------------------------'
     O                                          120 '------------------------'
     O                                          132 '------------'
     O          E            GLDET          1
     O                       SIGN                16
     O                       SIPOS5              22
     O                       SINTK         Z     28
     O                       SIVKB6        Z     36
     O                       SITLL               47
     O                       SITLE               54
     O                       SIDTG8              63
     O                       SINASX              88
     O                       SINAK              119
     O                       SIAVD         Z    124
     O                                          125 '/'
     O                       SITDN         Z    132
     O* ANTALL PÅ DENNE POSISJON
     O          E            GLTOTP         0
     O                       XTXT15              11
     O                       GMPOS               20
     O                       TOKGPO        Z     36
     O                       TOKOPO        Z     28
     O                       XTXT17              80
     O                       ANOPPO        Z     90
     O          E            GLTOTP         1
     O                       XTXT15              11
     O                       GMPOS               20
     O                       TOKOPO        Z     28
     O                       TOKGPO        Z     36
     O                       XTXT17              80
     O                       ANOPPO        Z     90
     O* REEKSPORT
     O          E            GLRHEA         0
     O                       XTXT19              41
     O          E            GLRHEA         1
     O                       XTXT19              41
     O          E            GLRDET         1
     O                       SEGN                16
     O                       SEPOS5              22
S01  O*                      SENTK         Z     28
N01  O                       SENTK7        Z     28
     O                       SEVKB6        Z     36
     O                       SETLL               47
     O                       SETLE               54
     O                       SEDTG8              63
     O                       SENAKX              88
     O                       SENAS              119
     O                       SEAVD         Z    124
     O                                          125 '/'
     O                       SETDN         Z    132
     O* BLANKLINJE
     O          E            GLBLAN         1
     O* SLUTTTOTAL
     O          E            GLTOT       2
     O                       XTXT13              12
     O                       XTKG          Z     36
     O                       XTNTK         Z     28
     O                       XTXT18              80
     O                       XANTOP        Z     90
