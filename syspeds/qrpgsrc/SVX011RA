      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED EL.TRANSIT HOVED-OPPLYSNING***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 02 03 05-09 11 13-26
      ***                    29 31 32 34-71
      ***        INDIKATOR   27 PÅ = SPØRRING                 ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
      *
     FSVXH      IF   E           K DISK
     FSVXHFV    UF A E           K DISK
     FSVXVFV    UF   E           K DISK
     FSVXSTDFV  IF   E           K DISK
     FSVXKODL01 IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSVTKD     IF   E           K DISK
     FSVX011DA  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTAÅ                 1      4  0
     D  WSDTAM                 5      6  0
     D  WSDTAD                 7      8  0
     D  WSDTA                  1      8  0
     D                 DS
     D  THDTAÅ                 1      4  0
     D  THDTAM                 5      6  0
     D  THDTAD                 7      8  0
     D  THDTA                  1      8  0
     D                 DS
     D  WSTMAH                 1      2  0
     D  WSTMAM                 3      4  0
     D  WSTMA                  1      4  0
     D                 DS
     D  THTSD1                 1      8
     D  THTSD2                 9     16
     D  THTSD3                17     24
     D  THTSD4                25     32
     D  THTSD5                33     40
     D  THTSD6                41     48
     D  THTSD7                49     56
     D  THTSD8                57     64
     D  TSD                    1     64    DIM(8)
     D                 DS
     D  THLKR1                 1      2
     D  THLKR2                 3      4
     D  THLKR3                 5      6
     D  THLKR4                 7      8
     D  THLKR5                 9     10
     D  THLKR6                11     12
     D  THLKR7                13     14
     D  THLKR8                15     16
     D  LKR                    1     16    DIM(8)
      *
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   OPEN      SVX011DA
     C                   EXSR      INIT
      *
      *...............................................
      * BILDE-1 INNLESING AV HOVED OPPL. FORH.VARSLING
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C  N30              Z-ADD     3             LINNBR
     C  N30              Z-ADD     13            POSNBR
      *
     C     START1        TAG
     C                   EXFMT     SVX011DA1
     C                   MOVEA     '000000000000'*IN(89)
     C                   MOVEA     '000000000000'*IN(75)
     C                   MOVEA     '000'         *IN(72)
     C                   MOVE      '0'           *IN(30)
      *
      *  04 = SØK AVSENDER/MOTTAKER/HOVEDANSVARLIG
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START1
     C                   END
      *
      *  10 = SLETT FORHÅNDSVARSEL INFORMASJON
     C   10              DO
     C                   EXSR      SLTFV
     C                   GOTO      SLUTT
     C                   END
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL SVX011D02
     C   12              GOTO      SLUTT
      *
     C     UTYPE         IFEQ      'DSP'
     C                   GOTO      SLUTT
     C                   END
      *
      * ----------- T E S T   B I L D E 0 2 ----------
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
      * ----- INGEN FEIL HITTIL     OPPDATER SVXH -----
     C                   EXSR      OPDSVH
      *
     C     SLUTT         TAG
     C     *IN12         IFEQ      '1'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     0             UFLAGG
     C                   END
     C                   CLOSE     SVX011DA
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * SPESIELLE OMSTENDIGHETER
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     64
     C     POSNBR        ANDLE     64
     C                   MOVE      '096'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSSPOM        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSPOM
     C                   Z-ADD     79            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TRANSPORTKOSTNADS BETALINGSMÅTE
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     79
     C     POSNBR        ANDLE     79
     C                   MOVE      '116'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSTKBM        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTKBM
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL LOSSESTED
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     61
     C     POSNBR        ANDLE     62
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSLOSDSK      UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSLOSDSK
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 1
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     27
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR1 = UKD
     C                   END
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 2
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     30
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR2 = UKD
     C                   END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 3
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR3 = UKD
     C                   END
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 4
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     36
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR4 = UKD
     C                   END
     C                   Z-ADD     38            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 5
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     38
     C     POSNBR        ANDLE     39
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR5 = UKD
     C                   END
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 6
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     42
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR6 = UKD
     C                   END
     C                   Z-ADD     44            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 7
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     44
     C     POSNBR        ANDLE     45
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR7 = UKD
     C                   END
     C                   Z-ADD     47            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL REISERUTE 8
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     47
     C     POSNBR        ANDLE     48
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKR8 = UKD
     C                   END
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVSENDERSNR SIKKERHET
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNSS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   IF        WSKNSS <> 0
     C                   EXSR      TESTSS
     C                   END
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL AVSENDER SIKKERHET
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKSS = UKD
     C                   END
     C                   Z-ADD     72            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL AVSENDER SIKKERHET
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKSS        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKSS
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * MOTTAKERSNR SIKKERHET
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNKS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   IF        WSKNKS <> 0
     C                   EXSR      TESTKK
     C                   END
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL MOTTAKER SIKKERHET
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKKS = UKD
     C                   END
     C                   Z-ADD     72            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL MOTTAKER SIKKERHET
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKKS        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKKS
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TRANSPORTØR
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNT
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   IF        WSKNT <> 0
     C                   EXSR      TESTTT
     C                   END
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL TRANSPORTØR
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKT = UKD
     C                   END
     C                   Z-ADD     72            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL TRANSPORTØR
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKT         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKT
     C                   Z-ADD     72            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     TESTB         BEGSR
      ***********************************************
     C                   EVAL      WSSIK = 1
      *
      * DATO FOR ANKOMST TIL GRENSE
     C                   IF        ((WSSIK = 1) OR (WSDTA <> 0))
      * BETINGELSE 186
     C                   MOVE      WSDTAÅ        UÅÅ
     C                   CALL      'TESTDATO'
     C                   PARM      WSDTAD        UDD               2 0
     C                   PARM      WSDTAM        UMM               2 0
     C                   PARM                    UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      99
     C                   IF        *IN99 = *OFF
     C     WSDTA         COMP      XIDAG                                99
     C                   END
     C   99              MOVE      'SPD0001'     MSGNR
     C   99              SETON                                        30
      * TID FOR ANKOMST TIL GRENSE
     C                   IF        (((WSTMAH > 23) OR
     C                               (WSTMAM > 59)) OR
     C                               (WSTMA = 0))
     C                   SETON                                        98
     C  N30              MOVE      'SVX1944'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C  N99              IF        THDTA = XIDAG
     C     WSTMA         COMP      XITID                                9898
     C   98
     CANN30              MOVE      'SVX1944'     MSGNR
     C   98              SETON                                        30
     C                   END
     C                   END
     C                   END
      *
      * BETINGELSE 186
     C                   IF        WSSIK    = 0
     C                   EVAL      WSSPOM   = *BLANKS
     C                   EVAL      WSTKBM   = *BLANKS
     C                   EVAL      WSLOSD   = *BLANKS
     C                   EVAL      WSLOSDSK = *BLANKS
     C                   EVAL      WSLOSDSK = *BLANKS
     C                   EVAL      WSTREF   = *BLANKS
     C                   EVAL      WSKREF   = *BLANKS
     C                   GOTO      STTESTB1
     C                   END
      *
      * SPESIELLE OMSTENDIGHETER
      * BETINGELSE 186: SIKKERHET --> VALGFRI
     C                   IF        WSSPOM <> *BLANKS
     C                   MOVE      '096'         YUNIK
     C                   EVAL      YKODE = WSSPOM
     C     SVK01K        CHAIN     SVXKODL01                          97
     C   97              MOVE      'SVX1943'     MSGNR
     C   97              SETON                                        30
     C                   END
      *
     C                   IF        WSTKBM <> *BLANKS
     C                   MOVE      '116'         YUNIK
     C                   EVAL      YKODE = WSTKBM
     C     SVK01K        CHAIN     SVXKODL01                          96
     C   96              MOVE      'SVX1945'     MSGNR
     C   96              SETON                                        30
     C                   END
      *
      * Transportørsref
      * BETINGELSE 531: TRANSPORTMÅTE = 40 --> OBLIGATORISK
     C                   IF        THTRM = 40
     C                   IF        WSTREF = *BLANKS
     C  N30              MOVE      'SVX1950'     MSGNR
     C                   SETON                                        3072
     C                   END
     C                   END
      *
      * LOSSESTED
      * BETINGELSE 589: OMSTENDIGHET = B/E --> VALGFRI
      *                 ELLERS             --> OBLIGATORISK
     C                   IF        ((WSSPOM <> 'B') AND
     C                              (WSSPOM <> 'E'))
     C                   IF        WSLOSD = *BLANKS
     C  N30              MOVE      'SVX1946'     MSGNR
     C                   SETON                                        3095
     C                   END
     C                   END
      *
     C                   IF        WSLOSDSK <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   EVAL      YKODE = WSLOSDSK
     C     SVK01K        CHAIN     SVXKODL01                          94
     C   94
     CANN30              MOVE      'SVX0810'     MSGNR
     C   94              SETON                                        30
     C                   END
      *
     C                   EVAL      SVKD_KD = WSLKR1
     C     SVTKDK        CHAIN     SVTKD                              93
     C   93
     CANN30              MOVE      'SPL0001'     MSGNR
     C   93              SETON                                        30
      *
     C                   IF        WSLKR2 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR2
     C     SVTKDK        CHAIN     SVTKD                              92
     C   92
     CANN30              MOVE      'SPL0001'     MSGNR
     C   92              SETON                                        30
     C                   END
      *
     C                   IF        WSLKR3 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR3
     C     SVTKDK        CHAIN     SVTKD                              91
     C   91
     CANN30              MOVE      'SPL0001'     MSGNR
     C   91              SETON                                        30
     C                   END
      *
     C                   IF        WSLKR4 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR4
     C     SVTKDK        CHAIN     SVTKD                              90
     C   90
     CANN30              MOVE      'SPL0001'     MSGNR
     C   90              SETON                                        30
     C                   END
      *
     C                   IF        WSLKR5 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR5
     C     SVTKDK        CHAIN     SVTKD                              89
     C   89
     CANN30              MOVE      'SPL0001'     MSGNR
     C   89              SETON                                        30
     C                   END
      *
     C                   IF        WSLKR6 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR6
     C     SVTKDK        CHAIN     SVTKD                              88
     C   88
     CANN30              MOVE      'SPL0001'     MSGNR
     C   88              SETON                                        30
     C                   END
      *
     C                   IF        WSLKR7 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR7
     C     SVTKDK        CHAIN     SVTKD                              87
     C   87
     CANN30              MOVE      'SPL0001'     MSGNR
     C   87              SETON                                        30
     C                   END
      *
     C                   IF        WSLKR8 <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKR8
     C     SVTKDK        CHAIN     SVTKD                              86
     C   86
     CANN30              MOVE      'SPL0001'     MSGNR
     C   86              SETON                                        30
     C                   END
      *
     C     STTESTB1      TAG
      *
     C                   IF        WSKNSS <> 0                                  1<-B
     C                   MOVE      WSKNSS        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            85
     C                   IF        *IN85                                         2<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE                                                    2
     C                   MOVE      KNAVN         WSNASS
     C                   MOVE      ADR1          WSADSS1
     C     SYPOGE        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      *BLANKS       WSPNSS
     C                   MOVEL     POSTNR        WSPNSS
     C                   ELSE                                                     3
     C                   MOVEL     SYPOGE        WSPNSS
     C                   END                                                      3<-E
     C                   MOVE      ADR3          WSPSSS
     C                   IF        SYLAND = *BLANKS                               3<-B
     C                   MOVE      FILAND        WSLKSS
     C                   ELSE                                                     3
     C                   MOVE      SYLAND        WSLKSS
     C                   END                                                      3<-E
     C                   IF        WSTINSS = *BLANKS                              3<-B
     C                   IF        EORI    = *BLANKS                               4<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   EVAL      WSTINSS = WSLKSS + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      WSTINSS = *BLANKS
     C                   END                                                        5<-E
     C                   ELSE                                                      4
     C                   EVAL      WSTINSS = EORI
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      * BETINGELSE 572
     C                   IF        WSSPOM = 'E'
     C                   IF        WSTINSS = *BLANKS
     C  N30              MOVE      'SVX1947'     MSGNR
     C                   SETON                                        3084
     C                   END
     C                   IF        WSNASS = *BLANKS
     C  N30              MOVE      'SPK0037'     MSGNR
     C                   SETON                                        3083
     C                   END
     C                   END
     C                   IF        ((WSADSS1 = *BLANKS) AND (WSNASS <> *BLANKS))
     C                   EVAL      WSADSS1 = '.'
     C                   END
      *
     C                   IF        WSLKSS <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKSS
     C     SVTKDK        CHAIN     SVTKD                              82
     C   82
     CANN30              MOVE      'SPL0001'     MSGNR
     C   82              SETON                                        30
     C                   END
      *
     C                   IF        WSSKSS <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVEL     WSSKSS        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          81
     C   81
     CANN30              MOVE      'SVX0810'     MSGNR
     C   82              SETON                                        30
     C                   END
      *
     C                   IF        WSKNKS <> 0                                  1<-B
     C                   MOVE      WSKNKS        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            80
     C                   IF        *IN80                                         2<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE                                                    2
     C                   MOVE      KNAVN         WSNAKS
     C                   MOVE      ADR1          WSADKS1
     C     SYPOGE        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      *BLANKS       WSPNKS
     C                   MOVEL     POSTNR        WSPNKS
     C                   ELSE                                                     3
     C                   MOVEL     SYPOGE        WSPNKS
     C                   END                                                      3<-E
     C                   MOVE      ADR3          WSPSKS
     C                   IF        SYLAND = *BLANKS                               3<-B
     C                   MOVE      FILAND        WSLKKS
     C                   ELSE                                                     3
     C                   MOVE      SYLAND        WSLKKS
     C                   END                                                      3<-E
     C                   IF        WSTINKS = *BLANKS                              3<-E
     C                   IF        EORI    = *BLANKS                               4<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   EVAL      WSTINKS = WSLKKS + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      WSTINKS = *BLANKS
     C                   END                                                        5<-E
     C                   ELSE                                                      4
     C                   EVAL      WSTINKS = EORI
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      * BETINGELSE 596
     C                   IF        WSSPOM = 'E'
     C                   IF        WSTINKS = *BLANKS
     C  N30              MOVE      'SVX1948'     MSGNR
     C                   SETON                                        3079
     C                   END
     C                   IF        WSNAKS = *BLANKS
     C  N30              MOVE      'SPK0037'     MSGNR
     C                   SETON                                        3078
     C                   END
     C                   END
     C                   IF        ((WSADKS1 = *BLANKS) AND (WSNAKS <> *BLANKS))
     C                   EVAL      WSADKS1 = '.'
     C                   END
      *
     C                   IF        WSLKKS <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKKS
     C     SVTKDK        CHAIN     SVTKD                              77
     C   77
     CANN30              MOVE      'SPL0001'     MSGNR
     C   77              SETON                                        30
     C                   END
      *
     C                   IF        WSSKKS <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   EVAL      YKODE = WSSKKS
     C     SVK01K        CHAIN     SVXKODL01                          76
     C   76
     CANN30              MOVE      'YBC0810'     MSGNR
     C   76              SETON                                        30
     C                   END
      *
     C                   IF        WSKNT <> 0                                   1<-B
     C                   MOVE      WSKNT         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            75
     C                   IF        *IN75                                         2<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE                                                    2
     C                   MOVE      KNAVN         WSNAT
     C                   MOVE      ADR1          WSADT1
     C     SYPOGE        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      *BLANKS       WSPNT
     C                   MOVEL     POSTNR        WSPNT
     C                   ELSE                                                     3
     C                   MOVEL     SYPOGE        WSPNT
     C                   END                                                      3<-E
     C                   MOVE      ADR3          WSPST
     C                   IF        SYLAND = *BLANKS                               3<-B
     C                   MOVE      FILAND        WSLKT
     C                   ELSE                                                     3
     C                   MOVE      SYLAND        WSLKT
     C                   END                                                      3<-E
     C                   IF        WSTINT = *BLANKS                               3<-B
     C                   IF        EORI    = *BLANKS                               4<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   EVAL      WSTINT = WSLKT + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      WSTINT = *BLANKS
     C                   END                                                        5<-E
     C                   ELSE                                                      4
     C                   EVAL      WSTINT = EORI
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        WSLKT <> *BLANKS
     C                   EVAL      SVKD_KD = WSLKT
     C     SVTKDK        CHAIN     SVTKD                              74
     C   74
     CANN30              MOVE      'SPL0001'     MSGNR
     C   74              SETON                                        30
     C                   END
      *
     C                   IF        WSSKT <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   EVAL      YKODE = WSSKT
     C     SVK01K        CHAIN     SVXKODL01                          73
     C   73
     CANN30              MOVE      'SVX0810'     MSGNR
     C   73              SETON                                        30
     C                   END
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETCUR        BEGSR
      ***********************************************
     C   73              Z-ADD     17            LINNBR
     C   73              Z-ADD     72            POSNBR
     C   74              Z-ADD     17            LINNBR
     C   74              Z-ADD     52            POSNBR
     C   75              Z-ADD     15            LINNBR
     C   75              Z-ADD     22            POSNBR
     C   76              Z-ADD     14            LINNBR
     C   76              Z-ADD     72            POSNBR
     C   77              Z-ADD     14            LINNBR
     C   77              Z-ADD     52            POSNBR
     C   78              Z-ADD     13            LINNBR
     C   78              Z-ADD     2             POSNBR
     C   79              Z-ADD     12            LINNBR
     C   79              Z-ADD     31            POSNBR
     C   80              Z-ADD     12            LINNBR
     C   80              Z-ADD     22            POSNBR
     C   81              Z-ADD     11            LINNBR
     C   81              Z-ADD     72            POSNBR
     C   82              Z-ADD     11            LINNBR
     C   82              Z-ADD     52            POSNBR
     C   83              Z-ADD     10            LINNBR
     C   83              Z-ADD     2             POSNBR
     C   84              Z-ADD     9             LINNBR
     C   84              Z-ADD     31            POSNBR
     C   85              Z-ADD     9             LINNBR
     C   85              Z-ADD     22            POSNBR
     C   86              Z-ADD     7             LINNBR
     C   86              Z-ADD     47            POSNBR
     C   87              Z-ADD     7             LINNBR
     C   87              Z-ADD     44            POSNBR
     C   88              Z-ADD     7             LINNBR
     C   88              Z-ADD     41            POSNBR
     C   89              Z-ADD     7             LINNBR
     C   89              Z-ADD     38            POSNBR
     C   90              Z-ADD     7             LINNBR
     C   90              Z-ADD     35            POSNBR
     C   91              Z-ADD     7             LINNBR
     C   91              Z-ADD     32            POSNBR
     C   92              Z-ADD     7             LINNBR
     C   92              Z-ADD     29            POSNBR
     C   93              Z-ADD     7             LINNBR
     C   93              Z-ADD     26            POSNBR
     C   94              Z-ADD     6             LINNBR
     C   94              Z-ADD     61            POSNBR
     C   95              Z-ADD     6             LINNBR
     C   95              Z-ADD     13            POSNBR
     C   72              Z-ADD     5             LINNBR
     C   72              Z-ADD     20            POSNBR
     C   96              Z-ADD     3             LINNBR
     C   96              Z-ADD     79            POSNBR
     C   97              Z-ADD     3             LINNBR
     C   97              Z-ADD     64            POSNBR
     C   98              Z-ADD     3             LINNBR
     C   98              Z-ADD     38            POSNBR
     C   99              Z-ADD     3             LINNBR
     C   99              Z-ADD     29            POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVW          BEGSR
      ***********************************************
     C                   Z-ADD     1             WSSIK
     C                   MOVE      THDTA         WSDTA
     C                   MOVE      THTMA         WSTMA
     C                   MOVE      THSPOM        WSSPOM
     C                   MOVE      THTKBM        WSTKBM
     C                   MOVE      THKREF        WSKREF
     C                   MOVE      THTREF        WSTREF
     C                   MOVE      THLOSD        WSLOSD
     C                   MOVE      THLOSDSK      WSLOSDSK
     C                   MOVE      THLKR1        WSLKR1
     C                   MOVE      THLKR2        WSLKR2
     C                   MOVE      THLKR3        WSLKR3
     C                   MOVE      THLKR4        WSLKR4
     C                   MOVE      THLKR5        WSLKR5
     C                   MOVE      THLKR6        WSLKR6
     C                   MOVE      THLKR7        WSLKR7
     C                   MOVE      THLKR8        WSLKR8
     C                   MOVE      THKNSS        WSKNSS
     C                   MOVE      THTINSS       WSTINSS
     C                   MOVE      THNASS        WSNASS
     C                   MOVE      THADSS1       WSADSS1
     C                   MOVE      THPNSS        WSPNSS
     C                   MOVE      THPSSS        WSPSSS
     C                   MOVE      THLKSS        WSLKSS
     C                   MOVE      THSKSS        WSSKSS
     C                   MOVE      THKNKS        WSKNKS
     C                   MOVE      THTINKS       WSTINKS
     C                   MOVE      THNAKS        WSNAKS
     C                   MOVE      THADKS1       WSADKS1
     C                   MOVE      THPNKS        WSPNKS
     C                   MOVE      THPSKS        WSPSKS
     C                   MOVE      THLKKS        WSLKKS
     C                   MOVE      THSKKS        WSSKKS
     C                   MOVE      THKNT         WSKNT
     C                   MOVE      THTINT        WSTINT
     C                   MOVE      THNAT         WSNAT
     C                   MOVE      THADT1        WSADT1
     C                   MOVE      THPNT         WSPNT
     C                   MOVE      THPST         WSPST
     C                   MOVE      THLKT         WSLKT
     C                   MOVE      THSKT         WSSKT
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVTRH        BEGSR
      ***********************************************
     C                   MOVE      UAVD          THAVD
     C                   MOVE      UTDN          THTDN
     C                   MOVE      WSDTA         THDTA
     C                   MOVE      WSSIK         THSIK
     C                   MOVE      WSTMA         THTMA
     C                   MOVE      WSSPOM        THSPOM
     C                   MOVE      WSTKBM        THTKBM
     C                   MOVE      WSKREF        THKREF
     C                   MOVE      WSTREF        THTREF
     C                   MOVE      WSLOSD        THLOSD
     C                   MOVE      WSLOSDSK      THLOSDSK
     C                   MOVE      WSLKR1        THLKR1
     C                   MOVE      WSLKR2        THLKR2
     C                   MOVE      WSLKR3        THLKR3
     C                   MOVE      WSLKR4        THLKR4
     C                   MOVE      WSLKR5        THLKR5
     C                   MOVE      WSLKR6        THLKR6
     C                   MOVE      WSLKR7        THLKR7
     C                   MOVE      WSLKR8        THLKR8
     C                   MOVE      WSKNSS        THKNSS
     C                   MOVE      WSTINSS       THTINSS
     C                   MOVE      WSNASS        THNASS
     C                   MOVE      WSADSS1       THADSS1
     C                   MOVE      WSPNSS        THPNSS
     C                   MOVE      WSPSSS        THPSSS
     C                   MOVE      WSLKSS        THLKSS
     C                   MOVE      WSSKSS        THSKSS
     C                   MOVE      WSKNKS        THKNKS
     C                   MOVE      WSTINKS       THTINKS
     C                   MOVE      WSNAKS        THNAKS
     C                   MOVE      WSADKS1       THADKS1
     C                   MOVE      WSPNKS        THPNKS
     C                   MOVE      WSPSKS        THPSKS
     C                   MOVE      WSLKKS        THLKKS
     C                   MOVE      WSSKKS        THSKKS
     C                   MOVE      WSKNT         THKNT
     C                   MOVE      WSTINT        THTINT
     C                   MOVE      WSNAT         THNAT
     C                   MOVE      WSADT1        THADT1
     C                   MOVE      WSPNT         THPNT
     C                   MOVE      WSPST         THPST
     C                   MOVE      WSLKT         THLKT
     C                   MOVE      WSSKT         THSKT
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSVH        BEGSR
     C***********************************************
     C     SVXHFVK       CHAIN     SVXHFV                             33
     C                   EXSR      MOVTRH
      *
     C   33              WRITE     SVXHFVR
     C  N33              UPDATE    SVXHFVR
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTSS        BEGSR
      ***********************************************
     C                   MOVE      WSKNSS        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            86
     C                   IF        *IN86                                        1<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     9             LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   SETON                                        30
     C                   ELSE                                                   1
     C                   MOVE      KNAVN         WSNASS
     C                   MOVE      ADR1          WSADSS1
     C     SYPOGE        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      *BLANKS       WSPNSS
     C                   MOVEL     POSTNR        WSPNSS
     C                   ELSE                                                    2
     C                   MOVEL     SYPOGE        WSPNSS
     C                   END                                                     2<-E
     C                   MOVE      ADR3          WSPSSS
     C                   IF        SYLAND = *BLANKS                              2<-B
     C                   MOVE      FILAND        WSLKSS
     C                   ELSE                                                    2
     C                   MOVE      SYLAND        WSLKSS
     C                   END                                                     2<-E
     C                   IF        WSTINSS = *BLANKS                             2<-B
     C                   IF        EORI    = *BLANKS                              3<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   EVAL      WSTINSS = WSLKSS + SYFOR9
     C                   ELSE                                                      4
     C                   EVAL      WSTINSS = *BLANKS
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   EVAL      WSTINSS = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTKK        BEGSR
      ***********************************************
     C                   MOVE      WSKNKS        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            83
     C                   IF        *IN83                                        1<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   SETON                                        30
     C                   ELSE                                                   1
     C                   MOVE      KNAVN         WSNAKS
     C                   MOVE      ADR1          WSADKS1
     C     SYPOGE        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      *BLANKS       WSPNKS
     C                   MOVEL     POSTNR        WSPNKS
     C                   ELSE                                                    2
     C                   MOVEL     SYPOGE        WSPNKS
     C                   END                                                     2<-E
     C                   MOVE      ADR3          WSPSKS
     C                   IF        SYLAND = *BLANKS                              2<-B
     C                   MOVE      FILAND        WSLKKS
     C                   ELSE                                                    2
     C                   MOVE      SYLAND        WSLKKS
     C                   END                                                     2<-E
     C                   IF        WSTINKS = *BLANKS                             2<-B
     C                   IF        EORI    = *BLANKS                              3<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   EVAL      WSTINKS = WSLKKS + SYFOR9
     C                   ELSE                                                      4
     C                   EVAL      WSTINKS = *BLANKS
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   EVAL      WSTINKS = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTTT        BEGSR
      ***********************************************
     C                   MOVE      WSKNT         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            80
     C                   IF        *IN80                                        1<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     15            LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   SETON                                        30
     C                   ELSE                                                   1
     C                   MOVE      KNAVN         WSNAT
     C                   MOVE      ADR1          WSADT1
     C     SYPOGE        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      *BLANKS       WSPNT
     C                   MOVEL     POSTNR        WSPNT
     C                   ELSE                                                    2
     C                   MOVEL     SYPOGE        WSPNT
     C                   END                                                     2<-E
     C                   MOVE      ADR3          WSPST
     C                   IF        SYLAND = *BLANKS                              2<-B
     C                   MOVE      FILAND        WSLKT
     C                   ELSE                                                    2
     C                   MOVE      SYLAND        WSLKT
     C                   END                                                     2<-E
     C                   IF        WSTINT = *BLANKS                              2<-B
     C                   IF        EORI   = *BLANKS                               3<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   EVAL      WSTINT = WSLKT + SYFOR9
     C                   ELSE                                                      4
     C                   EVAL      WSTINT = *BLANKS
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   EVAL      WSTINT = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SLTFV         BEGSR
      ***********************************************
     C     SVXHFVK       CHAIN     SVXHFV                             33
     C  N33              DELETE    SVXHFVR
     C     SVXHFVK       SETLL     SVXVFV
     C     SVXHFVK       READE     SVXVFV                                 33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SVXVFVR
     C     SVXHFVK       READE     SVXVFV                                 33
     C                   ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SVXHFVK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SVXHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     SVK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     SVTKDK        KLIST
     C                   KFLD                    SVKD_IE
     C                   KFLD                    SVKD_TYP
     C                   KFLD                    SVKD_KD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG
     C                   PARM                    UDK               2
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C                   MOVE      'GCY'         SVKD_TYP
     C                   MOVE      'A'           SVKD_IE
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
     C                   MOVEL     WTM           XITID             4 0
      *
     C     UTYPE         COMP      'DSP'                                  27
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     SVXHK         CHAIN     SVXH                               33
     C                   IF        (((THBLK = 'IS') OR
     C                               (THBLK = 'SJ')) OR
     C                               (THBLK = 'FO'))
     C                   EVAL      *IN28 = *ON
     C                   END
      *
     C                   MOVEA     *BLANKS       LKR
     C     SVXHFVK       CHAIN(N)  SVXHFV                             33
     C                   IF        *IN33
     C     UAVD          CHAIN     SVXSTDFV                           33
     C                   EVAL      WSDTA = 0
     C                   EVAL      WSTMA = 0
     C                   IF        THNASS  = *BLANKS
     C                   EVAL      THKNSS  = THKNS
     C                   EVAL      THTINSS = THTINS
     C                   EVAL      THNASS  = THNAS
     C                   EVAL      THADSS1 = THADS1
     C                   EVAL      THPNSS  = THPNS
     C                   EVAL      THPSSS  = THPSS
     C                   EVAL      THLKSS  = THLKS
     C                   END
     C                   IF        THNAKS  = *BLANKS
     C                   EVAL      THKNKS  = THKNK
     C                   EVAL      THTINKS = THTINK
     C                   EVAL      THNAKS  = THNAK
     C                   EVAL      THADKS1 = THADK1
     C                   EVAL      THPNKS  = THPNK
     C                   EVAL      THPSKS  = THPSK
     C                   EVAL      THLKKS  = THLKK
     C                   END
     C                   MOVE      THALK         THLKR1
     C                   IF        THALK <> THBLK
     C                   MOVE      THBLK         THLKR8
     C                   END
     C                   Z-ADD     1             XN2               3 0
      *
     C     1             DO        8             XN                3 0
     C                   IF        TSD(XN) <> *BLANKS
     C                   MOVEL     TSD(XN)       XA02              2
     C                   IF        ((XA02 <> LKR(1)) AND (XA02 <> LKR(8)))
     C     2             DO        7             XN3               3 0
     C                   SELECT
     C                   WHEN      LKR(XN3) = *BLANKS
     C                   EVAL      LKR(XN3) = XA02
     C                   LEAVE
     C                   WHEN      LKR(XN3) = XA02
     C                   LEAVE
     C                   ENDSL
     C                   ENDDO
     C                   END
     C                   END
     C                   ENDDO
      *
     C                   END
     C                   EXSR      MOVW
      *
     C                   ENDSR
      *
