********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 NYTT PARAMETER FOR Å HÅNDTERE FEILDATO
10250 * 02 YBC PTF10 DOKUMENTKODE ER ENDRET FRA 3A TIL 4A
********************************************************************
      *
      ***********************************************************
      *                                                        **
      *** PROGRAM SKAL KONVERTER XML-FIL TIL TET-EXPORT       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24          ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-88 95-97    ***
      ***********************************************************
      *
     FXMLRCVF   IF   E           K DISK
     FXMLRCVF01 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR01)
     FXMLRCVF02 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR02)
     FXMLRCVF03 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR03)
     FXMLRCVF04 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR04)
     FXMLRCVF05 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR05)
     FXMLRCLF   IF   E           K DISK
     FXMLRCAF   IF   E           K DISK
     FTRUH      UF A E           K DISK
     FTRUHFS    UF A E           K DISK
     FTRUV      UF A E           K DISK
     FTRUVAM    UF A E           K DISK
     FTRUVMN    UF A E           K DISK
     FTRUVDK    UF A E           K DISK
     FTRUSTD    IF   E           K DISK
     FEDIM      O  A E             DISK
     FEDIC      UF   E             DISK
     FTVIND     UF A E           K DISK
     FHEADF     UF A E           K DISK
     FDISP      UF A E           K DISK
     FFRISOL01  IF A E           K DISK
     FFRISOK    UF   E           K DISK    RENAME(FRISOKR:FRISOKR0)
     FTELL      UF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYPARL3   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTSI    IF   E           K DISK
     FKODTS2    IF   E           K DISK
      *
     D FS              S             20    DIM(90)
     D MN              S             17    DIM(90)
S02  D*RF1             S              3    DIM(90)
N02  D RF1             S              4    DIM(90)
     D RF2             S             20    DIM(90)
     D                 DS
     D  XTXT                   1     15
     D  XT                     1     15    DIM(15)
     D                 DS
     D  XTAL                   1     15  3
     D  XTALH                  1     12  0
     D  XTALD1                13     13
     D  XTALD2                14     14
     D  XTALD3                15     15
     D                 DS
     D  THAVD                  1      4  0
     D  HEAVD                  1      4  0
     D  DEAVD                  1      4  0
     D  FSAVD                  1      4  0
     D  THTDN                  5     11  0
     D  HEOPD                  5     11  0
     D  FSOPD                  5     11  0
     D  DIOPD                  5     11  0
     D  THSG                  12     14
     D  HESG                  12     14
     D  DISG                  12     14
     D  X14S                   1     14
     D                 DS
     D  THDT                   1      8  0
     D  HEDTR                  1      8  0
     D  HEDTOP                 1      8  0
     D  FSDTOP                 1      8  0
     D                 DS
     D  THKNS                  1      8  0
     D  HEKNS                  1      8  0
     D                 DS
     D  THNAS                  1     30
     D  HENAS                  1     30
     D                 DS
     D  THADS1                 1     30
     D  HEADS1                 1     30
     D                 DS
     D  THADS2                 1     30
     D  HEADS2                 1     30
     D                 DS
     D  THADS3                 1     30
     D  HEADS3                 1     30
     D                 DS
     D  THKNK                  1      8  0
     D  HEKNK                  1      8  0
     D                 DS
     D  THNAK                  1     30
     D  HENAK                  1     30
     D                 DS
     D  THADK1                 1     30
     D  HEADK1                 1     30
     D                 DS
     D  THADK2                 1     30
     D  HEADK2                 1     30
     D                 DS
     D  THADK3                 1     30
     D  HEADK3                 1     30
     D                 DS
     D  THBLK                  1      2
     D  HELKA                  1      2
     D                 DS
     D  THNTK                  1      7  0
     D  HENT                   1      7  0
     D                 DS
     D  THVKB                  1      9  0
     D  HEVKT                  1      9  0
     D                 DS
     D  THTSD1                 1      8
     D  THTSD2                 9     16
     D  THTSD3                17     24
     D  THTSD4                25     32
     D  THTSD5                33     40
     D  THTSD6                41     48
     D  THTSD7                49     56
     D  THTSD8                57     64
     D  TSD                    1     64    DIM(8)
     D                 DS
     D  WSDDTD                 1      2  0
     D  WSDDTM                 3      4  0
     D  WSDDTÅ                 5      6  0
     D  WSDDT                  1      6  0
     D                 DS
     D  THDDTÅ                 1      4  0
     D  THDDTM                 5      6  0
     D  THDDTD                 7      8  0
     D  THDDT                  1      8  0
     D                 DS
     D  XDT                    1      8  0
     D  XDTA                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D                 DS
     D  X0068Æ                 1      9  0
     D  M0068A                10     17  0
     D  M0068B                18     23  0
     D  M0068C                24     25  0
     D  X0068Å                 1     25
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
      *
     C                   EXSR      SRXML0
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     SRXML0        BEGSR
      ***********************************************
      *
      * HENT MELDINGS REFERANSE
     C                   Z-ADD     1             X000_XRLEV1
     C     STSRXML0      TAG
     C                   ADD       1             X000_XRLEV1
     C                   Z-ADD     1             X000_XRLEV2
     C                   Z-ADD     0             X000_XRLEV3
     C     XMLKEY00A     CHAIN     XMLRCAF                            33
     C     *IN33         CABEQ     *ON           SLSRXML0
     C                   DOW       *IN33 = *OFF
     C                   IF        XRATN = 'summaryId'
     C                   EXSR      SRXML1
     C                   GOTO      STSRXML0
     C                   END
     C     XMLKEY00A     READE     XMLRCAF                                33
     C                   ENDDO
      *
     C     SLSRXML0      ENDSR
      *
      ***********************************************
     C     SRXML1        BEGSR
      ***********************************************
      *
      * BEVARE NØKKEL
     C                   EVAL      X001_XRLEV1 = XRLEV1
     C                   EVAL      X001_XRLEV2 = 1
     C                   EVAL      X001_XRLEV3 = 0
      *
     C                   EXSR      SRAVD
     C     XSLUTT        CABEQ     'J'           SLXML1
      *
      * OPPDATER FRISØKEVEI
     C                   EVAL      FSSOK  = XRATV
     C                   EVAL      FSKODE = '*CN'
     C                   WRITE     FRISOKR
      *
      *
     C     XMLKEY01      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * HENT INFOR. FRA <SummarySet>
     C                   WHEN      XRNV = 'SummarySet'                           2<-B
     C                   EXSR      SRXML2100
     C                   EXSR      SROPDHEA
     C                   EXSR      SNDTVINN
      * HENT INFOR. FRA <ConsignmentSet>
     C                   WHEN      XRNV = 'ConsignmentSet'                       2<-B
     C                   EXSR      SRXML2200
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X001_XRLEV2
     C     XMLKEY01      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C     SLXML1        ENDSR
      *
      ***********************************************
     C     SRXML2100     BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       XM0068
     C                   MOVE      *BLANKS       FS
      *
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TransportLeg'                         2
     C                   EXSR      SRXML2110
     C                   WHEN      XRNV = 'Reference'                            2
     C                   EXSR      SRXML2120
     C                   WHEN      XRNV = 'Party'                                2
     C                   EXSR      SRXML2130
     C                   WHEN      XRNV = 'DateAndTimes'                         2
     C                   EXSR      SRXML2140
     C                   WHEN      XRNV = 'ControlTotals'                        2
     C                   EXSR      SRXML2150
     C                   WHEN      XRNV = 'FreeText'                             2
     C                   EXSR      SRXML2160
     C                   WHEN      XRNV = 'TransitHeader'                        2
     C                   EXSR      SRXML2170
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X002_XRLEV3 = X002_XRLEV3 + 1
     C     XMLKEY02      CHAIN     XMLRCVF02                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2110     BEGSR
      ***********************************************
      * <TransportLeg>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   MOVE      *ZEROS        XTSDNR            1 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TransportLegType'                     2
     C                   EXSR      SRXML2111
     C                   WHEN      XRNV = 'TransportLegId'                       2
     C                   EXSR      SRXML2112
     C                   WHEN      XRNV = 'MeansOfTransport'                     2
     C                   EXSR      SRXML2113
     C                   WHEN      XRNV = 'Location'                             2
     C                   EXSR      SRXML2114
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2111     BEGSR
      ***********************************************
      * <TransportLegType>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2112     BEGSR
      ***********************************************
      * <TransportLegId>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2113     BEGSR
      ***********************************************
      * <MeansOfTransport>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'MeansOfTransportId'                   2
     C                   EVAL      THTAID = XRVERD
     C                   EVAL      THTGID = XRVERD
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   EVAL      THTALK = XRVERD
     C                   EVAL      THTGLK = XRVERD
     C                   WHEN      XRNV = 'MeansOfTransportType'                 2
     C                   MOVEL     XRVERD        THTRM
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2114     BEGSR
      ***********************************************
      * <Location
      *
     C                   MOVE      *BLANKS       XSUBCL           70
     C                   MOVE      *BLANKS       XLOCID           70
     C     XMLKEY04A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'subClass'                            2
     C                   EVAL      XSUBCL = XRATV
     C                   WHEN      XRATN = 'locationId'                          2
     C                   EVAL      XLOCID = XRATV
     C                   ENDSL                                                   2<-E
     C     XMLKEY04A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
      * VERDIER HENTES FRA PARAMETER
     C                   SELECT                                                 1<-B
     C                   WHEN      XSUBCL = 'CustomsDeparture'                  1
     C                   EVAL      THCATS = XLOCID
     C                   GOTO      SLXML2114
     C                   WHEN      XSUBCL = 'CustomsTransit'                    1
     C                   ADD       1             XTSDNR
     C                   EVAL      TSD(XTSDNR) = XLOCID
     C                   GOTO      SLXML2114
     C                   WHEN      XSUBCL = 'CustomsDestination'                1
     C                   EVAL      THTSB  = XLOCID
     C                   GOTO      SLXML2114
     C                   ENDSL                                                  1<-E
      *
      * VERDIER HENTES FRA UNDERTAG
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'LocationName'                         2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'DocumentIssue'                       3
     C                   EVAL      THDST = XRVERD
     C                   GOTO      SLXML2114
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'StartLocation'                       3
     C                   EVAL      THALK = XRVERD
     C                   GOTO      SLXML2114
     C                   WHEN      XSUBCL = 'EndLocation'                         3
     C                   EVAL      THBLK = XRVERD
     C                   GOTO      SLXML2114
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C     SLXML2114     ENDSR
      *
      ***********************************************
     C     SRXML2120     BEGSR
      ***********************************************
      * <Reference>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   MOVE      *BLANKS       FSKODE
     C                   MOVE      *BLANKS       FSSOK
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'ReferenceNo'                          2
     C                   EVAL      FSSOK  = XRVERD
     C                   WHEN      XRNV = 'ReferenceType'                        2
     C                   EVAL      FSKODE = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        ((FSSOK <> *BLANKS) AND (FSKODE <> *BLANKS))
     C                   WRITE     FRISOKR
     C                   END
      *
     C                   IF        FSKODE = 'ABE'
     C                   EVAL      XM0068 = FSSOK
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2130     BEGSR
      ***********************************************
      * <Party
      *
     C                   MOVE      *BLANKS       XSUBCL           70
     C                   MOVE      *BLANKS       XPARID           70
     C                   MOVE      *BLANKS       XIDTYP           70
     C                   MOVE      *BLANKS       XSUBPI           70
     C                   MOVE      *BLANKS       XSUBPIT          70
     C     XMLKEY03A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'subClass'                            2
     C                   EVAL      XSUBCL = XRATV
     C                   WHEN      XRATN = 'partyId'                             2
     C                   EVAL      XPARID = XRATV
     C                   WHEN      XRATN = 'idType'                              2
     C                   EVAL      XIDTYP = XRATV
     C                   WHEN      XRATN = 'subPartyId'                          2
     C                   EVAL      XSUBPI = XRATV
     C                   WHEN      XRATN = 'subPartyIdType'                      2
     C                   EVAL      XSUBPIT = XRATV
     C                   ENDSL                                                   2<-E
     C     XMLKEY03A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
      * VERDIER HENTES FRA PARAMETER
     C                   SELECT                                                 1<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                  1
     C                   EVAL      SYVRDA = XPARID
     C     SYPARL3K1     CHAIN     SYPARL3                            33
     C  N33              EVAL      THKNS = SYKUNR
     C  N33CUNDL01K2     CHAIN     CUNDL01                            33
     C  N33              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))   3<-B
     C                   IF        THLKS = *BLANKS                                 4<-B
     C                   EVAL      THTINS = 'NO' + SYFOR9
     C                   ELSE                                                      4
     C                   EVAL      THTINS = THLKS + SYFOR9
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      THTINS = EORI
     C                   ENDSL                                                   2<-E
     C                   WHEN      XSUBCL = 'ReceivingAgent'                    1
     C                   EVAL      SYVRDA = XPARID
     C     SYPARL3K2     CHAIN     SYPARL3                            33
     C  N33              EVAL      THKNK = SYKUNR
     C  N33CUNDL01K2     CHAIN     CUNDL01                            33
     C  N33              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))   3<-B
     C                   IF        THLKK = *BLANKS                                 4<-B
     C                   EVAL      THTINK = 'NO' + SYFOR9
     C                   ELSE                                                      4
     C                   EVAL      THTINK = THLKK + SYFOR9
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      THTINK = EORI
     C                   ENDSL                                                   2<-E
     C                   WHEN      XSUBCL = 'CustomsBroker'                     1
     C                   ENDSL                                                  1<-E
      *
      * VERDIER HENTES FRA UNDERTAG
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Name'                                 2
     C                   EXSR      SRXML2131
     C                   WHEN      XRNV = 'Address'                              2
     C                   EXSR      SRXML2132
     C                   WHEN      XRNV = 'Contact'                              2
     C                   IF        XSUBCL = 'CustomsBroker'                       3<-B
     C                   EXSR      SRXML2133
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'VATNo'                                2
     C                   EXSR      SRXML2134
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2131     BEGSR
      ***********************************************
      * <Name>
      *
     C                   SELECT                                                 1<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                  1
     C                   EVAL      THNAS  = XRVERD
     C                   WHEN      XSUBCL = 'ReceivingAgent'                    1
     C                   EVAL      THNAK  = XRVERD
     C                   WHEN      XSUBCL = 'CustomsBroker'                     1
     C                   EVAL      THNAA  = XRVERD
     C                   ENDSL                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2132     BEGSR
      ***********************************************
      * <Address
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'City'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                    3
     C                   EVAL      THPSS  = XRVERD
     C                   WHEN      XSUBCL = 'ReceivingAgent'                      3
     C                   EVAL      THPSK  = XRVERD
     C                   WHEN      XSUBCL = 'CustomsBroker'                       3
     C                   EVAL      THPSA  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'ZIPCode'                              2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                    3
     C                   EVAL      THPNS  = XRVERD
     C                   WHEN      XSUBCL = 'ReceivingAgent'                      3
     C                   EVAL      THPNK  = XRVERD
     C                   WHEN      XSUBCL = 'CustomsBroker'                       3
     C                   EVAL      THPNA  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                    3
     C                   EVAL      THLKS  = XRVERD
     C                   WHEN      XSUBCL = 'ReceivingAgent'                      3
     C                   EVAL      THLKK  = XRVERD
     C                   WHEN      XSUBCL = 'CustomsBroker'                       3
     C                   EVAL      THLKA  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Street'                               2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                    3
     C                   EVAL      THADS1 = XRVERD
     C                   WHEN      XSUBCL = 'ReceivingAgent'                      3
     C                   EVAL      THADK1 = XRVERD
     C                   WHEN      XSUBCL = 'CustomsBroker'                       3
     C                   EVAL      THADA1 = XRVERD
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2133     BEGSR
      ***********************************************
      * <Contact>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'ContactName'                          2
     C                   EVAL      THSG = XRVERD
     C                   WHEN      XRNV = 'ContactFunction'                      2
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2134     BEGSR
      ***********************************************
      * <VATNo>
      *
     C                   MOVE      *BLANKS       XLK               2
     C     XMLKEY04A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'countryCode'                         2
     C                   EVAL      XLK    = XRATV
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C     XMLKEY04A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'DespatchingAgent'                    3
     C                   EVAL      THTINS = %TRIM(XLK) + %TRIM(XRVERD)
     C                   WHEN      XSUBCL = 'ReceivingAgent'                      3
     C                   EVAL      THTINK = %TRIM(XLK) + %TRIM(XRVERD)
     C                   WHEN      XSUBCL = 'CustomsBroker'                       3
     C                   EVAL      THTINA = %TRIM(XLK) + %TRIM(XRVERD)
     C                   ENDSL                                                    3<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2140     BEGSR
      ***********************************************
      * <DateAndTimes
      *
     C                   MOVE      *BLANKS       XSUBCL           70
     C     XMLKEY03A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'subClass'                            2
     C                   EVAL      XSUBCL = XRATV
     C                   ENDSL                                                   2<-E
     C     XMLKEY03A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
      * VERDIER HENTES FRA UNDERTAG
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   MOVE      *ZEROS        XDT
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Year'                                 2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      XDTA = XTAL
     C                   WHEN      XRNV = 'Month'                                2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      XDTM = XTAL
     C                   WHEN      XRNV = 'Day'                                  2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      XDTD = XTAL
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
      * OPPDATER DATO
     C                   SELECT                                                 1<-B
     C                   WHEN      XSUBCL = 'DocumentDate'                      1
     C                   EVAL      THDT   = XDT
     C                   WHEN      XSUBCL = 'TransitLimits'                     1
     C                   EVAL      THDDT  = XDT
     C                   WHEN      XSUBCL = 'DepartureDateEstimated'            1
     C                   WHEN      XSUBCL = 'DepartureDate'                     1
     C                   WHEN      XSUBCL = 'ArrivalDateEstimated'              1
     C                   ENDSL                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2150     BEGSR
      ***********************************************
      * <ControlTotals>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TotalNoOfConsignments'                2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      THVPOS = XTAL
     C                   WHEN      XRNV = 'TotalNoOfPackages'                    2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      THNTK  = XTAL
     C                   WHEN      XRNV = 'TotalGrossWeight'                     2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      THVKB  = XTAL
     C                   WHEN      XRNV = 'TotalGrossVolume'                     2
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2160     BEGSR
      ***********************************************
      * <FreeText>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Usage'                                2
     C                   WHEN      XRNV = 'LanguageCode'                         2
     C                   EVAL      THSKFD = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2170     BEGSR
      ***********************************************
      * <TransitHeader>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   MOVE      *ZEROS        XDT
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'MessageType'                          2
     C*                  EVAL      XMTYPE = %SUBST(XRVERD:3:3)                  MELDINGSTYPE  015
     C                   WHEN      XRNV = 'DeclarationType'                      2
     C                   EVAL      THDK   = XRVERD
     C                   WHEN      XRNV = 'Containerized'                        2
     C                   IF        XRVERD = 'NO'                                  3<-B
     C                   EVAL      THKDC  = '0'
     C                   ELSE                                                     3
     C                   EVAL      THKDC  = '1'
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'AcceptanceCode'                       2
     C                   EVAL      THDKR  = XRVERD
     C                   MOVE      *ZEROS        UINNDT            6 0
     C                   Z-ADD     8             UANTDG            3 0
     C                   CALL      'SYFA20B'
     C                   PARM                    UINNDT
     C                   PARM                    UANTDG
     C     WSDDT         PARM                    UUTDT             6 0
N01  C                   PARM                    UFLAGG            1 0
     C                   MOVE      WSDDTD        THDDTD
     C                   MOVE      WSDDTM        THDDTM
     C     WSDDTÅ        ADD       2000          THDDTÅ
     C                   WHEN      XRNV = 'GuaranteeReference'                   2
     C                   EXSR      SRXML2175
     C                   WHEN      XRNV = 'TransitLeg'                           2
     C                   EXSR      SRXML2176
     C                   WHEN      XRNV = 'Seals'                                2
     C                   EXSR      SRXML2177
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2175     BEGSR
      ***********************************************
      * <GuaranteeReference>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Text'                                 2
     C     XMLKEY05A     CHAIN     XMLRCAF                            33
     C                   SELECT                                                   3<-B
     C                   WHEN      ((XRATN = 'code') AND (XRATV = 'GTY'))         3
     C                   MOVEL     XRVERD        THGKD
     C                   WHEN      ((XRATN = 'code') AND (XRATV = 'GRN'))         3
     C                   MOVEL     XRVERD        THGFT1
     C                   WHEN      ((XRATN = 'code') AND (XRATV = 'ACD'))         3
     C                   MOVEL     XRVERD        THGADK
     C                   WHEN      ((XRATN = 'code') AND (XRATV = 'GVC'))         3
     C                   MOVEL     XRVERD        THGBGI
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2176     BEGSR
      ***********************************************
      * <TransitLeg
      *
     C                   MOVE      *BLANKS       XSUBCL           70
     C     XMLKEY04A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'subClass'                            2
     C                   EVAL      XSUBCL = XRATV
     C                   ENDSL                                                   2<-E
     C     XMLKEY04A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
      * VERDIER HENTES FRA UNDERTAG
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'MeansOfTransport'                     2
     C                   EXSR      SRXML2176A
     C                   WHEN      XRNV = 'Documents'                            2
     C                   WHEN      XRNV = 'Language'                             2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'AtDeparture'                         3
     C                   EVAL      THTASK = XRVERD
     C                   WHEN      XSUBCL = 'AtBorder'                            3
     C                   EVAL      THTGSK = XRVERD
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2176A    BEGSR
      ***********************************************
      * <MeansOfTransport>
      *
     C                   EVAL      X005_XRLEV1 = XRLEV1
     C                   EVAL      X005_XRLEV2 = XRLEV2
     C                   EVAL      X005_XRLEV3 = XRLEV3
     C                   EVAL      X005_XRLEV4 = XRLEV4
     C                   EVAL      X005_XRLEV5 = XRLEV5
     C                   EVAL      X005_XRLEV6 = 1
     C                   EVAL      X005_XRLEV7 = 0
      *
     C     XMLKEY05      CHAIN     XMLRCVF05                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'MeansOfTransportId'                   2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'AtDeparture'                         3
     C                   EVAL      THTAID = XRVERD
     C                   WHEN      XSUBCL = 'AtBorder'                            3
     C                   EVAL      THTGID = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'AtDeparture'                         3
     C                   EVAL      THTALK = XRVERD
     C                   WHEN      XSUBCL = 'AtBorder'                            3
     C                   EVAL      THTGLK = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Name'                                 2
     C                   WHEN      XRNV = 'MeansOfTransportType'                 2
     C                   MOVEL     XRVERD        THTRM
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X005_XRLEV6 = X005_XRLEV6 + 1
     C     XMLKEY05      CHAIN     XMLRCVF05                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2177     BEGSR
      ***********************************************
      * <Seals
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'SealCount'                            2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      THDANT = XTAL
     C                   WHEN      XRNV = 'SealIdentity'                         2
     C     1             DO        90            XN                               3<-B
     C                   IF        FS(XN) = *BLANKS                                4<-B
     C                   EVAL      FS(XN) = XRVERD
     C                   LEAVE
     C                   END                                                       4<-E
     C                   ENDDO                                                    3<-E
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   WHEN      XRNV = 'Language'                             2
     C                   EVAL      THDFSK = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2200     BEGSR
      ***********************************************
     C     TRUHK         CHAIN     TRUH                               33
     C                   MOVE      *BLANKS       MN
      *
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Consignment'                          2
     C                   EXSR      SRXML2210
     C                   WHEN      XRNV = 'TransitDetails'                       2
     C                   EXSR      SRXML2220
     C                   WHEN      XRNV = 'ConsignmentGoodsItemSet'              2
     C                   EXSR      SRXML2230
     C                   WHEN      XRNV = 'Party'                                2
     C                   EXSR      SRXML2240
     C                   WHEN      XRNV = 'TransportLeg'                         2
     C                   EXSR      SRXML2250
     C                   WHEN      XRNV = 'TermsOfDelivery'                      2
     C                   EXSR      SRXML2260
     C                   WHEN      XRNV = 'Service'                              2
     C                   EXSR      SRXML2270
     C                   WHEN      XRNV = 'DateAndTimes'                         2
     C                   EXSR      SRXML2280
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X002_XRLEV3 = X002_XRLEV3 + 1
     C     XMLKEY02      CHAIN     XMLRCVF02                          33
     C                   ENDDO                                                  1<-E
      *
     C                   EXSR      SROPDLIN
      *
     C                   IF        THTASK = *BLANKS
     C                   MOVE      THTALK        KS2LK
     C     KODTS2K       CHAIN     KOS2R                              33
     C  N33              MOVE      KS2NAS        THTASK
     C                   END
     C                   IF        THTGSK = *BLANKS
     C                   MOVE      THTGLK        KS2LK
     C     KODTS2K       CHAIN     KOS2R                              33
     C  N33              MOVE      KS2NAS        THTGSK
     C                   END
     C                   UPDATE    TRUHR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2210     BEGSR
      ***********************************************
      * <Consignment
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TotalGrossWeight'                     2
     C                   EXSR      SRXML2211
     C                   WHEN      XRNV = 'TotalVolume'                          2
     C                   EXSR      SRXML2212
     C                   WHEN      XRNV = 'NumberOfPackages'                     2
     C                   EXSR      SRXML2213
     C                   WHEN      XRNV = 'Reference'                            2
     C                   EXSR      SRXML2214
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2211     BEGSR
      ***********************************************
      * <TotalGrossWeight>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2212     BEGSR
      ***********************************************
      * <TotalVolume>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2213     BEGSR
      ***********************************************
      * <NumberOfPackages>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2214     BEGSR
      ***********************************************
      * <Reference>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2220     BEGSR
      ***********************************************
      * <TransitDetails>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'GoodsDescription'                     2
     C                   EXSR      SRXML2221
     C                   WHEN      XRNV = 'NumberOfPackages'                     2
     C                   EXSR      SRXML2222
     C                   WHEN      XRNV = 'PackageTypeCode'                      2
     C                   EXSR      SRXML2223
     C                   WHEN      XRNV = 'GrossWeight'                          2
     C                   EXSR      SRXML2224
     C                   WHEN      XRNV = 'NetWeight'                            2
     C                   EXSR      SRXML2225
     C                   WHEN      XRNV = 'Marking'                              2
     C                   EXSR      SRXML2226
     C                   WHEN      XRNV = 'Reference'                            2
     C                   EXSR      SRXML2227
     C                   WHEN      XRNV = 'TermsOfDelivery'                      2
     C                   EXSR      SRXML2228
     C                   WHEN      XRNV = 'FreeText'                             2
     C                   EXSR      SRXML2229
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2221     BEGSR
      ***********************************************
      * <GoodsDescription>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2222     BEGSR
      ***********************************************
      * <NumberOfPackages>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2223     BEGSR
      ***********************************************
      * <PackageTypeCode>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2224     BEGSR
      ***********************************************
      * <GrossWeight
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2225     BEGSR
      ***********************************************
      * <NetWeight
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2226     BEGSR
      ***********************************************
      * <Marking>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2227     BEGSR
      ***********************************************
      * <Reference>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
     C                   MOVE      *BLANKS       XAN03             3
     C                   MOVE      *BLANKS       XAN20            20
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'ReferenceNo'                          2
     C                   EVAL      XAN20 = XRVERD
     C                   WHEN      XRNV = 'ReferenceType'                        2
     C                   EVAL      XAN03 = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XAN20 <> *BLANKS                             1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XAN03 = 'ABT'                                 2
     C                   EVAL      XAN03 = '830'
     C                   OTHER                                                   2
     C                   GOTO      SLXML2227
     C                   ENDSL                                                   2<-E
     C     1             DO        90            XN                              2<-B
     C                   IF        RF1(XN) = *BLANKS                              3<-B
     C                   EVAL      RF1(XN) = XAN03
     C                   EVAL      RF2(XN) = XAN20
     C                   LEAVE
     C                   END                                                      3<-E
     C                   ENDDO                                                   2<-E
     C                   END                                                    1<-E
      *
     C     SLXML2227     ENDSR
      *
      ***********************************************
     C     SRXML2228     BEGSR
      ***********************************************
      * <TermsOfDelivery>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2229     BEGSR
      ***********************************************
      * <TermsOfDelivery>
      *
      * <FreeText>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Usage'                                2
     C                   WHEN      XRNV = 'Text'                                 2
     C     XMLKEY05A     CHAIN     XMLRCAF                            33
     C                   IF        XRATV = 'CAL'                                  3<-B
     C     1             DO        70            XN
     C                   EVAL      XTEGN = %SUBST(XRVERD:XN:1)
     C                   IF        ((XTEGN < '0') OR (XTEGN > '9'))
     C                   LEAVE
     C                   END
     C                   ENDDO
     C                   EVAL      XTXT = %SUBST(XRVERD:1:XN-1)
     C                   EXSR      KNVTAL
     C                   EVAL      THGBL = XTAL
     C                   EVAL      THGVK = %SUBST(XRVERD:XN:3)
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2230     BEGSR
      ***********************************************
      * <ConsignmentGoodsItemSet>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'GoodsItem'                            2
     C                   EXSR      SRXML2231
     C                   WHEN      XRNV = 'Package'                              2
     C                   EXSR      SRXML2232
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2231     BEGSR
      ***********************************************
      * <GoodsItem
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'GoodsDescription'                     2
     C                   EVAL      TVVT   = XRVERD
     C                   WHEN      XRNV = 'NumberOfPackages'                     2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      TVNT   = XTAL
     C                   WHEN      XRNV = 'PackageTypeCode'                      2
     C                   MOVEL     XRVERD        TVEH
     C                   WHEN      XRNV = 'GrossWeight'                          2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      TVVKTB = XTAL
     C                   EVAL      TVVKTN = TVVKTB * 0.9
     C                   WHEN      XRNV = 'Volume'                               2
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2232     BEGSR
      ***********************************************
      * <Package
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'PackageTypeCode'                      2
     C                   WHEN      XRNV = 'PackageTypeText'                      2
     C                   WHEN      XRNV = 'Marking'                              2
     C     1             DO        90            XN                3 0
     C                   IF        ((XRVERD = MN(XN)) OR (MN(XN) = *BLANKS))
     C                   LEAVE
     C                   END
     C                   ENDDO
     C                   MOVEL     XRVERD        MN(XN)
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2240     BEGSR
      ***********************************************
      * <Party
      *
     C                   MOVE      *BLANKS       XSUBCL           70
     C                   MOVE      *BLANKS       XPARID           70
     C                   MOVE      *BLANKS       XIDTYP           70
     C                   MOVE      *BLANKS       XSUBPI           70
     C                   MOVE      *BLANKS       XSUBPIT          70
     C     XMLKEY03A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'subClass'                            2
     C                   EVAL      XSUBCL = XRATV
     C                   WHEN      XRATN = 'partyId'                             2
     C                   EVAL      XPARID = XRATV
     C                   WHEN      XRATN = 'idType'                              2
     C                   EVAL      XIDTYP = XRATV
     C                   WHEN      XRATN = 'subPartyId'                          2
     C                   EVAL      XSUBPI = XRATV
     C                   WHEN      XRATN = 'subPartyIdType'                      2
     C                   EVAL      XSUBPIT = XRATV
     C                   ENDSL                                                   2<-E
     C     XMLKEY03A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
      * VERDIER HENTES FRA PARAMETER
     C                   SELECT                                                 1<-B
     C                   WHEN      XSUBCL = 'Consignor'                         1
     C                   IF        XPARID <> *BLANKS                             2<-B
     C                   MOVEL     XPARID        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      TVKNS = XTAL
     C     CUNDL01K3     CHAIN     CUNDL01                            33
     C  N33              SELECT                                                   3<-B
     C                   WHEN      EORI = *BLANKS                                 3
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   IF        TVLKS = *BLANKS                                  5<-B
     C                   EVAL      TVTINS = 'NO' + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      TVTINS = TVLKS + SYFOR9
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   OTHER                                                    3
     C                   EVAL      TVTINS = EORI
     C                   ENDSL                                                    3<-E
     C                   END                                                     2<-E
     C                   WHEN      XSUBCL = 'Consignee'                         1
     C                   IF        XPARID <> *BLANKS                             2<-B
     C                   MOVEL     XPARID        XTXT
     C                   EXSR      KNVTAL
     C                   EVAL      TVKNK = XTAL
     C     CUNDL01K4     CHAIN     CUNDL01                            33
     C  N33              SELECT                                                   3<-B
     C                   WHEN      EORI = *BLANKS                                 3
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   IF        TVLKK = *BLANKS                                  5<-B
     C                   EVAL      TVTINK = 'NO' + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      TVTINK = TVLKK + SYFOR9
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   OTHER                                                    3
     C                   EVAL      TVTINK = EORI
     C                   ENDSL                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDSL                                                  1<-E
      *
      * VERDIER HENTES FRA UNDERTAG
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Name'                                 2
     C                   EXSR      SRXML2241
     C                   WHEN      XRNV = 'VATNo'                                2
     C                   EXSR      SRXML2242
     C                   WHEN      XRNV = 'Address'                              2
     C                   EXSR      SRXML2243
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2241     BEGSR
      ***********************************************
      * <Name>
      *
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'Consignor'                           3
     C                   EVAL      TVNAS  = XRVERD
     C                   WHEN      XSUBCL = 'Consignee'                           3
     C                   EVAL      TVNAK  = XRVERD
     C                   ENDSL                                                    3<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2242     BEGSR
      ***********************************************
      * <VATNo>
      *
     C                   MOVE      *BLANKS       XLK               2
     C     XMLKEY04A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'countryCode'                         2
     C                   EVAL      XLK    = XRATV
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C     XMLKEY04A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'Consignor'                           3
     C                   EVAL      TVTINS = %TRIM(XLK) + %TRIM(XRVERD)
     C                   WHEN      XSUBCL = 'Consignee'                           3
     C                   EVAL      TVTINK = %TRIM(XLK) + %TRIM(XRVERD)
     C                   ENDSL                                                    3<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2243     BEGSR
      ***********************************************
      * <Address
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'PostalCode'                           2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'Consignor'                           3
     C                   EVAL      TVPNS  = XRVERD
     C                   WHEN      XSUBCL = 'Consignee'                           3
     C                   EVAL      TVPNK  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'City'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'Consignor'                           3
     C                   EVAL      TVPSS  = XRVERD
     C                   WHEN      XSUBCL = 'Consignee'                           3
     C                   EVAL      TVPSK  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'Consignor'                           3
     C                   EVAL      TVLKS  = XRVERD
     C                   WHEN      XSUBCL = 'Consignee'                           3
     C                   EVAL      TVLKK  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Street'                               2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'Consignor'                           3
     C                   EVAL      TVADS1 = XRVERD
     C                   WHEN      XSUBCL = 'Consignee'                           3
     C                   EVAL      TVADK1 = XRVERD
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2250     BEGSR
      ***********************************************
      * <TransportLeg>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   MOVE      *ZEROS        XTSDNR            1 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TransportLegType'                     2
     C                   EXSR      SRXML2251
     C                   WHEN      XRNV = 'TransportLegId'                       2
     C                   EXSR      SRXML2252
     C                   WHEN      XRNV = 'MeansOfTransport'                     2
     C                   EXSR      SRXML2253
     C                   WHEN      XRNV = 'Location'                             2
     C                   EXSR      SRXML2254
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF03                          33
     C                   ENDDO                                                  1<-E
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2251     BEGSR
      ***********************************************
      * <TransportLegType>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2252     BEGSR
      ***********************************************
      * <TransportLegId>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2253     BEGSR
      ***********************************************
      * <MeansOfTransport>
      *
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2254     BEGSR
      ***********************************************
      * <Location
      *
     C                   MOVE      *BLANKS       XSUBCL           70
     C     XMLKEY04A     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'subClass'                            2
     C                   EVAL      XSUBCL = XRATV
     C                   ENDSL                                                   2<-E
     C     XMLKEY04A     READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
      * VERDIER HENTES FRA UNDERTAG
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'StartLocation'                       3
     C                   IF        THALK <> XRVERD                                 4<-B
     C                   EVAL      TVALK = XRVERD
     C                   END                                                       4<-E
     C                   GOTO      SLXML2254
     C                   WHEN      XSUBCL = 'EndLocation'                         3
     C                   IF        THBLK <> XRVERD                                 4<-B
     C                   EVAL      TVBLK = XRVERD
     C                   END                                                       4<-E
     C                   GOTO      SLXML2254
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X004_XRLEV5 = X004_XRLEV5 + 1
     C     XMLKEY04      CHAIN     XMLRCVF04                          33
     C                   ENDDO                                                  1<-E
      *
     C     SLXML2254     ENDSR
      *
      ***********************************************
     C     SRXML2260     BEGSR
      ***********************************************
      * <TermsOfDelivery>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2270     BEGSR
      ***********************************************
      * <Service>
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML2280     BEGSR
      ***********************************************
      * <DateAndTimes
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRAVD         BEGSR
      ***********************************************
      *
     C                   MOVE      'N'           XOKAVD            1
     C                   MOVE      *ZEROS        XXAVD             4 0
     C     XRSN          SETLL     XMLRCVF
     C     XRSN          READE     XMLRCVF                                33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   IF        XRNV = 'Party'                                2<-B
     C     XMLKEYAVD     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                   3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      ((XRATN = 'subClass') AND                       4
     C                              (XRATV = 'CustomsBroker'))
     C                   MOVE      'J'           XOKAVD            1
     C                   WHEN      ((XRATN = 'subPartyId') AND (XOKAVD = 'J'))     4
     C                   MOVEL     XRATV         XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          XXAVD
     C                   GOTO      SLFAVD
     C                   ENDSL                                                     4<-E
     C     XMLKEYAVD     READE     XMLRCAF                                33
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C     XRSN          READE     XMLRCVF                                33
     C                   ENDDO                                                  1<-E
      *
     C     SLFAVD        TAG
     C                   MOVE      'N'           XSLUTT            1
      *
     C                   EVAL      FSSOK  = XRATV
     C                   EVAL      FSKODE = '*CN'
     C     FRISOL01K     CHAIN     FRISOL01                           33
      *
     C                   IF        *IN33
     C     XXAVD         CHAIN     TRUSTD                             33
N01  C  N33              EVAL      THDDT = 0
      * PÅ TEST SETT *IN33 PÅ
     C                   EVAL      *IN33 = *ON
      *
     C                   IF        *IN33
      * PÅ TEST SETT AVDELINMG=1 (HOS BRING SETTES TIL 9910)
     C                   Z-ADD     1             XXAVD                33
     C     XXAVD         CHAIN     TRUSTD                             33
N01  C  N33              EVAL      THDDT = 0
     C                   END
     C     THAVD         CHAIN     TELL                               33
     C                   MOVE      TEOPDN        THTDN
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   MOVE      WDT           HEDTR
     C                   WRITE     FRISOKR
      *
     C                   ELSE
      *
     C                   MOVE      FSAVD         XAVD
     C                   MOVE      FSOPD         XTDN
     C     TRUHK         CHAIN     TRUH                               33
     C  N33              IF        ((THST = ' ') OR (THST = 'M'))
     C                   DELETE    TRUHR
     C                   ELSE
      * KAN IKKE TA NY VERSJON
     C                   UPDATE    TRUHR
     C                   MOVE      'J'           XSLUTT
     C                   GOTO      SLSRAVD
     C                   END
      * SLETT ALLE GAMLE POSTER
     C     TRUHK         CHAIN     HEADFR                             33
     C  N33              DELETE    HEADFR
     C     TRUHK         CHAIN     DISP                               33
     C  N33              DELETE    DISPR
     C     TRUHK         SETLL     TRUV
     C     TRUHK         READE     TRUV                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    TRUVR
     C     TRUHK         READE     TRUV                                   33
     C                   ENDDO
     C     TRUHK         SETLL     TRUVAM
     C     TRUHK         READE     TRUVAM                                 33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    TRUVAMR
     C     TRUHK         READE     TRUVAM                                 33
     C                   ENDDO
     C     TRUHK         SETLL     TRUVMN
     C     TRUHK         READE     TRUVMN                                 33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    TRUVMNR
     C     TRUHK         READE     TRUVMN                                 33
     C                   ENDDO
     C     TRUHK         SETLL     TRUVDK
     C     TRUHK         READE     TRUVDK                                 33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    TRUVDKR
     C     TRUHK         READE     TRUVDK                                 33
     C                   ENDDO
     C     TRUHK         SETLL     FRISOK
     C     TRUHK         READE     FRISOK                                 33
     C                   DOW       *IN33 = *OFF
     C*                  IF        FSKODE = 'CNT'
     C                   DELETE    FRISOKR0
     C*                  ELSE
     C*                  UPDATE    FRISOKR0
     C*                  END
     C     TRUHK         READE     FRISOK                                 33
     C                   ENDDO
      *
     C                   CLEAR                   TRUHR
     C                   CLEAR                   TRUVR
     C                   CLEAR                   TRUVAMR
     C                   CLEAR                   TRUVMNR
     C                   CLEAR                   HEADFR
     C                   CLEAR                   DISPR
     C                   MOVE      XAVD          FSAVD
     C     FSAVD         CHAIN     TRUSTD                             33
N01  C  N33              EVAL      THDDT = 0
     C     KODTAK        CHAIN     KODTA                              33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   IF        *IN33 = *OFF
     C                   EVAL      THTINA = 'NO' + SYFOR9
     C                   EVAL      THKNA  = KUNDNR
     C                   EVAL      THNAA  = KNAVN
     C                   EVAL      THADA1 = ADR1
     C                   MOVE      *BLANKS       THPNA
     C                   MOVEL     POSTNR        THPNA
     C                   MOVE      ADR3          THPSA
     C                   IF        SYLAND <> *BLANKS
     C                   MOVE      SYLAND        THLKA
     C                   END
     C                   END
     C                   MOVE      XTDN          FSOPD
     C                   MOVE      WDT           HEDTR
      *
     C                   END
      *
     C     SLSRAVD       ENDSR
      *
      ***********************************************
     C     SROPDHEA      BEGSR
      ***********************************************
     C                   Z-ADD     1             THTET
     C                   MOVE      WDT           THDT
     C                   IF        THDKR = *BLANKS
     C                   MOVE      'N'           THENKL
     C                   ELSE
     C                   MOVE      'J'           THENKL
     C                   END
     C                   MOVE      '015'         THMF
     C                   MOVE      *ZEROS        THMP
     C                   MOVE      *BLANKS       THPKL
     C                   MOVE      *BLANKS       TH0035
      *
     C                   IF        THSG = *BLANKS
     C                   MOVE      'YBC'         THSG
     C                   END
     C                   IF        THTARF = *BLANKS
     C     KODTSIK       CHAIN     KODTSI                             33
     C                   EVAL      THTARF = KSINAV
     C                   END
     C                   MOVE      'Q'           THST
     C                   MOVE      'F'           HEST
     C                   MOVEL     THTINS        XAN02             2
     C                   IF        (((XAN02 = 'NO') AND
     C                               (THLKS <> 'NO')) AND
     C                               (THLKS <> *BLANKS))
     C                   MOVEL     THLKS         THTINS
     C                   END
     C                   MOVEL     THTINK        XAN02             2
     C                   IF        (((XAN02 = 'NO') AND
     C                               (THLKK <> 'NO')) AND
     C                               (THLKK <> *BLANKS))
     C                   MOVEL     THLKK         THTINK
     C                   END
      *
     C                   MOVE      FS(1)         THDFKD
     C                   MOVE      THAVD         TFAVD
     C                   MOVE      THTDN         TFTDN
     C                   MOVE      THDFSK        TFDFSK
     C     2             DO        90            XN
     C                   IF        FS(XN) = *BLANKS
     C                   LEAVE
     C                   END
     C                   EVAL      TFDFKD  = FS(XN)
     C                   WRITE     TRUHFSR
     C                   ENDDO
      *
     C                   WRITE     TRUHR
     C                   WRITE     HEADFR
     C                   WRITE     DISPR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SNDTVINN      BEGSR
      ***********************************************
      * SEND TIL TVINN
     C                   MOVE      '015'         M1N07
     C                   MOVEL     WDT           M0068A
     C     M0068A        CHAIN     TVIND                              32
     C   32              Z-ADD     M0068A        D0068A
     C   32              Z-ADD     0             D0068B
     C                   ADD       1             D0068B
     C   32              WRITE     TVINDF
     C  N32              UPDATE    TVINDF
     C                   MOVE      D0068B        M0068B
     C                   MOVE      *ZEROS        M0068C
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   MOVE      S0004         M0004
     C                   MOVE      S0010         M0010
     C                   MOVE      S0035         M0035
     C                   EVAL      M0062 = X14S
     C                   MOVE      'CUSDEC'      M0065
     C                   IF        XM0068 = *BLANKS
     C                   MOVEL     S0004         X0068Æ
     C                   MOVEL     X0068Å        M0068
     C                   ELSE
     C                   EVAL      M0068  = XM0068
     C                   END
     C                   MOVE      *ZEROS        M0068D
     C                   MOVE      *ZEROS        M0068E
     C                   MOVE      *ZEROS        M0068F
     C                   MOVE      '830'         M1001
     C                   MOVE      *BLANKS       M1004
     C                   MOVEL     '015'         M1225
     C                   MOVE      'TET'         M1001
     C                   MOVE      *BLANKS       M1004
     C                   MOVE      *BLANKS       M1N08
      *
     C                   MOVE      *ZEROS        MSN
     C                   Z-ADD     CMN           MMN
     C                   MOVE      'S'           MSR
     C                   MOVE      *BLANKS       MST
     C                   MOVE      *ZEROS        MDT
     C                   MOVE      *ZEROS        MTM
     C                   MOVE      THAVD         MAVD
     C                   MOVE      THTDN         MTDN
      *
     C                   WRITE     EDIMR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDLIN      BEGSR
      ***********************************************
      *
     C                   EVAL      TVAVD = THAVD
     C                   EVAL      TVTDN = THTDN
     C                   EVAL      XTVLI = XTVLI + 1
     C                   EVAL      TVLI = XTVLI
     C                   IF        ((TVVKTB = 0) AND (TVVKTN = 0))
     C                   EVAL      TVVKTB = 1
     C                   EVAL      TVVKTN = 1
     C                   END
     C                   EVAL      TVMN   = MN(1)
     C                   EVAL      TVDTY  = RF1(1)
     C                   EVAL      TVDREF = RF2(1)
     C                   IF        TVEH = *BLANKS
     C                   EVAL      TVEH = 'PK'
     C                   END
      *
     C                   WRITE     TRUVR
      *
     C                   IF        ((TVNAS <> *BLANKS) OR (TVNAK <> *BLANKS))
     C                   WRITE     TRUVAMR
     C                   END
      *
     C     2             DO        90            XN
     C                   IF        MN(XN) = *BLANKS
     C                   LEAVE
     C                   END
     C                   EVAL      TVMN  = MN(XN)
     C                   WRITE     TRUVMNR
     C                   ENDDO
      *
     C     2             DO        90            XN
     C                   IF        RF1(XN) = *BLANKS
     C                   LEAVE
     C                   END
     C                   EVAL      TVDTY  = RF1(XN)
     C                   EVAL      TVDREF = RF1(XN)
     C                   WRITE     TRUVDKR
     C                   ENDDO
      *
     C                   CLEAR                   TRUVR
     C                   CLEAR                   TRUVAMR
     C                   CLEAR                   TRUVMNR
     C                   CLEAR                   TRUVDKR
      *
     C                   ENDSR
      *
      ***********************************************
     C     KNVTAL        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTAL
     C     1             DO        15            XN                3 0          1<-B
     C                   IF        ((XT(XN) = *BLANKS) OR (XT(XN) = '.'))        2<-B
     C                   LEAVE
     C                   ENDIF                                                   2<-E
     C                   MULT      10            XTALH
     C                   MOVE      XT(XN)        XTALH
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XT(XN) = '.'                                 1<-B
     C                   ADD       1             XN
     C                   MOVE      XT(XN)        XTALD1
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                 2<-B
     C                   MOVE      XT(XN)        XTALD2
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                  3<-B
     C                   MOVE      XT(XN)        XTALD3
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    USN               9
      *
     C     TRUHK         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     FRISOL01K     KLIST
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     CUNDL01K2     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    SYKUNR
     C     CUNDL01K3     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TVKNS
     C     CUNDL01K4     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TVKNK
     C     SYPARL3K1     KLIST
     C                   KFLD                    XSYPAID1
     C                   KFLD                    SYVRDA
     C     SYPARL3K2     KLIST
     C                   KFLD                    XSYPAID2
     C                   KFLD                    SYVRDA
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    THAVD
     C     KODTSIK       KLIST
     C                   KFLD                    KSIUNI
     C                   KFLD                    THSG
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C     XMLKEY01      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X001_XRLEV1
     C                   KFLD                    X001_XRLEV2
     C                   KFLD                    X001_XRLEV3
     C     XMLKEY02      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X002_XRLEV1
     C                   KFLD                    X002_XRLEV2
     C                   KFLD                    X002_XRLEV3
     C                   KFLD                    X002_XRLEV4
     C     XMLKEY03      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEY04      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X004_XRLEV1
     C                   KFLD                    X004_XRLEV2
     C                   KFLD                    X004_XRLEV3
     C                   KFLD                    X004_XRLEV4
     C                   KFLD                    X004_XRLEV5
     C                   KFLD                    X004_XRLEV6
     C     XMLKEY05      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X005_XRLEV1
     C                   KFLD                    X005_XRLEV2
     C                   KFLD                    X005_XRLEV3
     C                   KFLD                    X005_XRLEV4
     C                   KFLD                    X005_XRLEV5
     C                   KFLD                    X005_XRLEV6
     C                   KFLD                    X005_XRLEV7
     C     XMLKEY00A     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X000_XRLEV1
     C                   KFLD                    X000_XRLEV2
     C                   KFLD                    X000_XRLEV3
     C     XMLKEY03A     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X002_XRLEV1
     C                   KFLD                    X002_XRLEV2
     C                   KFLD                    X002_XRLEV3
     C                   KFLD                    X002_XRLEV4
     C     XMLKEY04A     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEY05A     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X004_XRLEV1
     C                   KFLD                    X004_XRLEV2
     C                   KFLD                    X004_XRLEV3
     C                   KFLD                    X004_XRLEV4
     C                   KFLD                    X004_XRLEV5
     C                   KFLD                    X004_XRLEV6
     C     XMLKEYAVD     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    XRLEV1
     C                   KFLD                    XRLEV2
     C                   KFLD                    XRLEV3
     C                   KFLD                    XRLEV4
     C                   KFLD                    XRLEV5
     C                   KFLD                    XRLEV6
      *
     C     *LIKE         DEFINE    THAVD         XAVD
     C     *LIKE         DEFINE    THTDN         XTDN
     C     *LIKE         DEFINE    XRLEV1        X000_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X000_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X000_XRLEV3
     C     *LIKE         DEFINE    XRLEV1        X001_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X001_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X001_XRLEV3
     C     *LIKE         DEFINE    XRLEV1        X002_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X002_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X002_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X002_XRLEV4
     C     *LIKE         DEFINE    XRLEV1        X003_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X003_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X003_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X003_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X003_XRLEV5
     C     *LIKE         DEFINE    XRLEV1        X004_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X004_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X004_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X004_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X004_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X004_XRLEV6
     C     *LIKE         DEFINE    XRLEV1        X005_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X005_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X005_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X005_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X005_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X005_XRLEV6
     C     *LIKE         DEFINE    XRLEV6        X005_XRLEV7
     C     *LIKE         DEFINE    XRNV          X001_XRNV
     C     *LIKE         DEFINE    TVLI          XTVLI
     C     *LIKE         DEFINE    M0068         XM0068
     C     *LIKE         DEFINE    SYPAID        XSYPAID1
     C     *LIKE         DEFINE    SYPAID        XSYPAID2
      *
     C                   MOVE      USN           XRSN
     C                   MOVE      'A'           KOAUNI
     C                   MOVE      'SI'          KSIUNI
     C                   MOVE      'S2 '         KS2UNI
     C                   MOVE      *BLANKS       XTEGN             1
     C                   EVAL      XSYPAID1 = 'ZGLN'
     C                   EVAL      XSYPAID2 = 'ZAGT'
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT08             8 0
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
