      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT FLYFRAKTBREV (INNENLAND)     ***
      *****************************************************************
     FELOGO     IF   E           K DISK
     FTRACKF    O  A E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FHEADF     UF   E           K DISK
     FDOKUI     UF   E           K DISK
     FDOKUI2    IF   E           K DISK
     F                                     RENAME(DOKUIR:DOKUIR2)
     FCUNDL01   IF   E           K DISK
     FFAK2      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTDIS   IF   E           K DISK
     FKODTINP   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCNFF      UF   E             DISK    USROPN
     FLABF      IF A E             DISK    USROPN
     FISUL01    IF   E           K DISK    USROPN
     FPARL01    IF   E           K DISK    USROPN
     FDOLAF     UF A E             DISK
     F                                     INFDS(DOLADS)
     FFLYFRAKT  O    F   85        PRINTER
     F                                     FORMLEN(72)
     F                                     FORMOFL(72)
     FMERKL1    O    F   75        PRINTER
     F                                     FORMLEN(18)
     F                                     FORMOFL(18)
     FMERKL2    O    F   75        PRINTER
     F                                     FORMLEN(24)
     F                                     FORMOFL(24)
     FSYIN14P   O    E             PRINTER
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XUL≈≈                 11     14  0
     D                 DS
     D  UL≈≈                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  KOAIAT                 1      7  0
     D  XIAT1                  1      2  0
     D  XIAT2                  3      3  0
     D  XIAT3                  4      7  0
     D                 DS
     D  DITIL                  1      5
     D  XTIL1                  1      1
     D  XTIL2                  2      2
     D  XTIL3                  3      3
     D                 DS
     D  DIFRA                  1      5
     D  XIFRA                  1      5
     D                 DS
     D  DIAWB                  1     11  0
     D  YIAWB                  1     11  0
     D  ZIAWB                  1     11  0
     D  XAWB1                  1      1  0
     D  XAWB2                  2      2  0
     D  XAWB3                  3      3  0
     D  XAWB4                  4      4  0
     D  XAWB5                  5      5  0
     D  XAWB6                  6      6  0
     D  XAWB7                  7      7  0
     D  XAWB8                  8      8  0
     D  XAWB9                  9      9  0
     D  XAWBA                 10     10  0
     D  XAWBB                 11     11  0
     D  XAWBW                  9     11  0
     D  DIAWB3                 1      3  0
     D  DIAWB8                 4     11  0
     D  YIAWB3                 1      3  0
     D  YIAWB8                 4     11  0
     D  ZIAWB3                 1      3  0
     D  ZIAWB8                 4     11  0
     D                 DS
     D  HEHAWB                 1      9
     D  XHAWB                  4      9  0
     D  XHAWB1                 4      4  0
     D  XHAWB2                 5      5  0
     D  XHAWB3                 6      6  0
     D  XHAWB4                 7      7  0
     D  XHAWB5                 8      8  0
     D  XHAWB6                 9      9  0
     D                 DS
     D  AWBDES                 1     14
     D  WHESDT                 4      6
     D                 DS
     D  ROUTIN                 1     16
     D  WWA                    1      3
     D  WWB                    5     11
     D  WWC                   12     12
     D  WWD                   13     14
     D                 DS
     D  DIXXX1                 1      7
     D  DIXXV1                 1      3
     D  DFROA1                 1      3
     D  DIXXV2                 4      6
     D  DFROA2                 4      6
     D                 DS
     D  IDAG0                  1      2  0
     D  IDAG1                  3      4  0
     D  IDAG2                  5      6  0
     D  IDAG3                  7      8  0
     D  IDAG                   3      8  0
     D  IDAG8                  1      8  0
     D                 DS
     D  XALUFT                 1     17
     D  YALUFT                 1     17
     D  ZALUFT                 1     17
     D                 DS
     D  XBLUFT                 1     17
     D  YBLUFT                 1     17
     D  ZBLUFT                 1     17
     D                 DS
     D  XGRUNN                 1      5  0
     D  YGRUNN                 1      5  0
     D                 DS
     D  DIVEKT                 1      5  0
     D  ZIVEKT                 1      5  0
     D                 DS
     D  DIFVKT                 1      5  0
     D  ZIFVKT                 1      5  0
     D  YIFVKT                 1      5  0
     D                 DS
     D  DIMVA                  1      9  2
     D  XIMVA                  1      9  2
     D  YIMVA                  1      9  2
     D                 DS
     D  DIFRAK                 1      7  0
     D  YIFRAK                 1      7  0
     D  ZIFRAK                 1      7  0
     D                 DS
     D  DIVGEB                 1      7  0
     D  YIVGEB                 1      7  0
     D                 DS
     D  YIFS2                  1      9  2
     D  ZIFS2                  1      9  2
     D                 DS
     D  XISUM                  1      9  2
     D  YISUM                  1      9  2
     D                 DS
     D  XKNA24                 1     24
     D  YKNA24                 1     24
     D  XKNA30                 1     30
     D  YKNA30                 1     30
     D                 DS
     D  DIANT                  1      7  0
     D  DIANT4                 4      7  0
     D  YIANT4                 4      7  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UDT                   64     69  0
     D  UGN                  981    995
V10  D  UOPD                  82     88  0
      * Get recordnumber from file
     D DOLADS          DS
     D  DORECN               397    400B 0
     D                SDS
     D  WUSER                254    263
     IDOLAR
     I              LAISTX                      DOISTX
      *
     C                   EXSR      INIT
      *
     C     DOKI2K        SETLL     DOKUI2
     C                   SETOFF                                       33
     C     START         TAG
     C     DOKI2K        READE     DOKUI2                                 33
     C   33              GOTO      SLUTT
     C     HEADFK        CHAIN     HEADF                              34
     C   34              GOTO      START
     C     USG           IFNE      'ALL'
     C     USG           ANDNE     DISG
     C                   GOTO      START
     C                   END
      *
     C     DIAWB         IFEQ      0
     C                   GOTO      START
     C                   END
      *
     C     UPRO          IFNE      0
     C     UPRO          ANDNE     HEPRO
V10  C*    UPRO          ANDNE     HEOPD
V10  C     UOPD          ANDEQ     0
V10  C     UOPD          ORNE      0
V10  C     UOPD          ANDNE     HEOPD
V10  C     UPRO          ANDEQ     0
     C                   GOTO      START
     C     UDT           IFNE      0
     C     UDT8          ANDGT     HEDTR
     C                   GOTO      START
     C                   END
     C                   END
      *
     C     UGN           IFNE      *BLANKS
     C     UGN           ANDNE     HEGN
     C                   GOTO      START
     C                   END
      *
      *** N≈ SKAL DET SKRIVE FLYFRAKBREV / MERKELAPP
      *
     C     DOKUIK        CHAIN     DOKUI                              33
     C     DIMLAP        IFEQ      'J'
      *** HEUR = 'E' BETYR OPPDRAG ER FRA INNENLANDSFORSENDELSE
     C     HEUR          COMP      'E'                                7777
      *** HEHAWB <> 0 BETYR SAMLAST
     C  N77XHAWB         COMP      0                                      77
     C                   EXSR      PRINT2
     C                   END
      *
     C     DIMLAP        IFEQ      'B'
     C     HEUR          COMP      'E'                                7777
     C  N77XHAWB         COMP      0                                      77
     C                   EXSR      PRINT2
     C                   END
      *
      * UTFÿRER RUTINE FOR ≈ SKRIVE BARCODE MERKELAPP
      *
     C     *IN44         IFEQ      '0'
     C     DIMLAP        IFEQ      'S'
     C     FITDVI        IFEQ      'J'
     C                   MOVE      *OFF          *IN90
     C                   EXSR      OPNFIL                                       <≈pne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      PRINT3                                       <Write Label data
     C     *IN90         IFEQ      '0'
     C                   EXSR      SNDTA2                                       <Send dataq
     C                   SETON                                        50
     C                   ENDIF                                                  <*IN90
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ELSE
     C                   EXSR      PRINT4
     C                   SETON                                        50
     C                   ENDIF                                                  <FITDVI
     C                   ELSE
     C                   MOVE      *ON           *IN90
     C                   ENDIF                                                  <DIMLAP
     C                   ENDIF                                                  <*IN44
     C                   EXSR      PRINT
      *
      * UTFÿRER RUTINER FOR ≈ SENDE FRAKTBREV ELEKTRONISK
      *
     C     *IN44         IFEQ      '0'
     C     DICMN         IFEQ      'J'
     C     DICMN         OREQ      'Y'
     C     DICMN         OREQ      'j'
     C     DICMN         OREQ      'y'
     C                   EXSR      OPNFIL                                       <≈pne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      WRTFWB                                       <Write inhouse
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ENDIF                                                  <DFCMN
     C                   ENDIF                                                  <*IN44
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   MOVE      XPRANT        UPRANT
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     PRINT         BEGSR
      ***********************************************
      *
      * OPPDATERER TRACK AND TRACING
      *
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
      *
      * HENTER FRA PRISREGISTER
      *
     C     HEPK9         IFEQ      'J'
     C     'IN2PR'       CHAIN     KODTINP                            34
     C                   ELSE
     C     'INNPR'       CHAIN     KODTINP                            34
     C                   END
     C     DIFVKT        SUB       KIPXX2        DIFVK2            5 0
     C     DIFRAK        SUB       DIPRIS        DIPRI2            5 0
     C     DIFVKT        COMP      KIPXX2                             51
      *
      * BEREGNER GRUNNPRIS
      *
     C                   Z-ADD     DIFRAK        XTSTP1            8 0
     C     DIFVKT        MULT(H)   DIPRIS        XTSTP2            8 0
     C     HEPK9         IFEQ      'J'
     C                   Z-ADD     DIPRIS        XGRUNN
     C                   Z-ADD     KIPXX1        DIPRIS
     C  N51              Z-ADD     0             DIPRIS
     C                   ELSE
     C     XTSTP1        SUB       XTSTP2        XGRUNN            5 066
     C                   END
     C     DIFRAK        SUB       XGRUNN        PRDIFF            5 0
      *
     C                   Z-ADD     0             XCCFR             7 2
     C     DICCPP        COMP      'PP'                                   50
     C  N50DICCPP        COMP      'CP'                                   50
     C                   EXSR      BEREGN
      *
     C     DICCPP        IFEQ      'CP'
     C                   Z-ADD     XTOTK         XCCFR
     C                   Z-ADD     0             DIVGEB
     C                   Z-ADD     0             XMOMS             8 2
     C                   END
      *
      * START PP/PC
      *
     C     DICCPP        IFEQ      'PP'
     C     DICCPP        OREQ      'PC'
      *
      * JETPAKKE
      *
     C     HEPK9         IFNE      'J'
     C                   Z-ADD     KDSBL5        DIVGEB
      * VARIABLE VAT
     C                   MOVE      FITAX         FITAXB            4 4
      *
      *FIXER MOMSFAKTOR
      *
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     IDAG8         ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAXB            4 4
     C                   END
      *
      *FIXER MOMSFAKTOR SLUTT
      *
     C     KDSBL5        MULT      FITAX         XMOMS
      *
      *
      *ELSE VED IKKE JETPAKKE
      *
     C                   ELSE
     C                   Z-ADD     0             DIVGEB
     C                   Z-ADD     0             XMOMS
     C                   END
     C                   END
      *
      * SLUTT PP/PC
      *
      *
      * XTOTK TIL DUE AGENT VED CC
      *
     C     DICCPP        IFEQ      'CC'
     C                   Z-ADD     XTOTK         DIVGEB
     C                   END
      *
     C     DIFRA         CHAIN     STED2                              34
     C  N34              MOVEL     ST2NVN        XALUFT           17
     C   34              MOVE      *BLANKS       XALUFT
     C     DITIL         CHAIN     STED2                              34
     C  N34              MOVEL     ST2NVN        XBLUFT           17
     C   34              MOVE      *BLANKS       XBLUFT
      *
     C     HEPK2         COMP      'N'                                7171
     C   71HEPK2         COMP      ' '                                7171
      *
     C     DIFRAK        ADD       DIFS          XISUM
     C     DIFRAK        ADD       DIFS          DISUM
     C                   ADD       DIFPRE        XISUM
     C                   ADD       DIFPRE        DISUM
     C                   ADD       DIFUEL        XISUM
     C                   ADD       DIFUEL        DISUM
     C  N71DISUM         MULT      FITAX         DIMVA
     C                   ADD       XMOMS         DIMVA
     C   71              MOVE      *ZEROS        DIMVA
      *
     C     DITIL         IFEQ      'LYR'
     C                   MOVE      *ZEROS        DIMVA
     C                   END
     C                   ADD       DIMVA         XISUM
     C                   ADD       DIMVA         DISUM
     C                   ADD       1             XPRANT
     C                   ADD       DIVGEB        XISUM
     C                   ADD       DIVGEB        DISUM
     C                   Z-ADD     DIFS          YIFS2
     C                   ADD       DIFUEL        YIFS2
     C                   Z-ADD     DIFS          XIFS2                92
     C     DIMVA         COMP      0                                  72
     C     XCCFR         COMP      0                                  73
     C     XAWBW         COMP      154                                    74
     C     XIFS2         COMP      0                                  5555
     C     DIRUN2        COMP      *BLANKS                            8282
     C     DIRUN3        COMP      *BLANKS                            8383
      *
     C     HEPK2         COMP      ' '                                    44
     C   44XHAWB         COMP      0                                  44
      *
     C     DIFS          COMP      *ZEROS                             47
     C     HEPK9         COMP      'J'                                    70
     C                   MOVE      *OFF          *IN67
     C     DIFT          IFNE      *BLANKS
     C                   MOVE      *ON           *IN67
     C                   ENDIF
     C                   EXSR      UTFBR
     C                   EXSR      UTFBR
     C                   MOVE      'P'           HEPK5
     C                   EXCEPT    OPDHEA
     C                   MOVE      'P'           DIST
     C                   EXCEPT    OPDDOK
      *
     C                   ENDSR
      *
      ***********************************************
     C     PRINT2        BEGSR
      ***********************************************
     C                   Z-ADD     1             XANTL             3 0
     C     XANTL         DOWLE     DIANT
     C                   EXSR      UTML
     C     DIMLAP        IFEQ      'B'
     C                   EXSR      UTML2
     C                   END
     C                   ADD       1             XANTL
     C                   END
     C                   MOVE      'P'           DIMLAP
      *
     C                   ENDSR
      *
      ******************************************
     C     UTFBR         BEGSR
      ******************************************
     C     DIAWB3        CHAIN     ELOGO                              33
     C                   Z-ADD     1             WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              42
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C     LAYOUT        IFEQ      'I'
     C                   EXCEPT    DET
     C                   ELSE
     C                   WRITE     PRT2
     C                   END
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM1         TAG
     C     KOPFM         READE     KODTFM                                 42
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C     LAYOUT        IFEQ      'I'
     C                   EXCEPT    DET
     C                   ELSE
     C                   WRITE     PRT2
     C                   END
     C                   GOTO      STFM1
     C                   END                                                     2<-E
     C     LAYOUT        IFEQ      'I'
     C   42
     CANN43              EXCEPT    DET
     C                   ELSE
     C   42
     CANN43              WRITE     PRT2
     C                   END                                                    1<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ******************************************
     C     UTML          BEGSR
      ******************************************
     C                   Z-ADD     2             WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              42
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C                   EXCEPT    MLAP
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM2         TAG
     C     KOPFM         READE     KODTFM                                 42
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C                   EXCEPT    MLAP
     C                   GOTO      STFM2
     C                   END                                                     2<-E
     C   42
     CANN43              EXCEPT    MLAP
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ******************************************
     C     UTML2         BEGSR
      ******************************************
     C                   Z-ADD     3             WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              42
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C                   EXCEPT    MLAP2
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM3         TAG
     C     KOPFM         READE     KODTFM                                 42
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C                   EXCEPT    MLAP2
     C                   GOTO      STFM3
     C                   END                                                     2<-E
     C   42
     CANN43              EXCEPT    MLAP2
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     BEREGN        BEGSR
      ***********************************************
     C                   SETOFF                                       34
     C     FAK2K         SETLL     FAK2
     C                   EXSR      SUM2
     C                   Z-ADD     XBRUTT        XTOTK             9 2
      *
     C                   ENDSR
      *
      ***********************************************
     C     SUM2          BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTOTAL            9 2
     C                   MOVE      *ZEROS        XMVAGR            9 2
     C     STVALI        TAG
     C     FAK2K         READE     FAK2                                   34
     C  N34FAVK          IFEQ      'FFN'
     C                   GOTO      STVALI
     C                   END
      *
     C  N34FAKDM         IFEQ      'J'
     C                   ADD       FABELN        XMVAGR
     C                   END
     C  N34              ADD       FABELN        XTOTAL
     C  N34              GOTO      STVALI
      *
     C     XMVAGR        MULT(H)   FITAX         XMOMS
     C                   Z-ADD     XTOTAL        XBRUTT            9 2
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    WSPLNR
     C                   MOVE      'P'           WSPUNI            1
      *
     C     HEADFK        KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C     DOKUIK        KLIST
     C                   KFLD                    DIRI
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C                   KFLD                    DIFBNR
     C     DOKI2K        KLIST
     C                   KFLD                    XRI
     C                   KFLD                    UAVD
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KOAKNR
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XSK
     C     KODTAK        KLIST
     C                   KFLD                    XAUNI
     C                   KFLD                    UAVD
      *
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPRANT            2
      *
     C     UDT           IFGT      501231
     C     UDT           ADD       19000000      UDT8              8 0
     C                   ELSE
     C     UDT           ADD       20000000      UDT8
     C                   END
     C                   MOVE      ' '           XRI               1
     C                   MOVE      'F'           XSK               1
     C                   MOVE      'A'           XAUNI             1
     C                   MOVE      'DISPU'       XDISPU            5
     C                   MOVE      *ZEROS        XPRANT            2 0
     C                   MOVE      *BLANKS       WKOPFM            5
     C                   MOVEL     *BLANKS       PGID             17
     C                   MOVEL     *BLANKS       PGIDNE           35
     C                   MOVEL     *BLANKS       PGPACP           17
     C                   MOVEL     *BLANKS       PGPACA           35
     C                   MOVEL     *BLANKS       PGCPAI           17
     C                   MOVEL     *BLANKS       PGCPAA           35
     C                   MOVEL     *BLANKS       PGMTM1            1
     C                   MOVEL     *BLANKS       PGMTM2            1
     C                   MOVEL     *BLANKS       PGMTM3            1
      *
     C                   READ      FIRM                                   33
      *
      * FIRMAPARAM.   UTLANDSLAYOUT P≈ FRAKTBREV??       (J=UTL.LAYOUT)
      *
     C     INNUTL        IFNE      'J'
     C                   MOVE      'I'           LAYOUT            1            =INNL-LAYOUT
     C                   END
     C                   MOVE      UDAY          IDAG3
     C                   MOVE      UMONTH        IDAG2
     C                   MOVE      UYEAR         IDAG1
     C     UYEAR         IFGT      50
     C                   MOVE      '19'          IDAG0
     C                   ELSE
     C                   MOVE      '20'          IDAG0
     C                   END
      *
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     IDAG8         ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAX
     C                   END
      *
      *
     C     KODTAK        CHAIN     KODTA                              35
     C     XDISPU        CHAIN     KODTDIS                            33
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVEL     KNAVN         XKNA30           30
      *
     C                   MOVEL     WUSER         WWUSER           17
      *
     C                   ENDSR
      ***********************************************
     C     OPNFIL        BEGSR
      ***********************************************
      * DUMMY READ AV FILER
     C  N90
     CAN 90              READ      LABF                                   90
      * ≈PNER FILER
     C                   OPEN      CNFF                                 90
     C  N90              OPEN      LABF                                 90
     C  N90              OPEN      ISUL01                               90
     C  N90              OPEN      PARL01                               90
      * HVIS ≈PNING AV FILER GIKK GALT KAN IKKE RUTINEN UTFÿRES
     C     *IN90         CABEQ     '1'           OPNF99
      * HVIS ALT GIKK GREIT KAN RUTINEN UTFÿRES
     C     OPNF99        ENDSR
      ***********************************************
     C     WRTFWB        BEGSR
      ***********************************************
     C                   Z-ADD     DIAWB3        W0211             3 0
     C     W0211         CHAIN     ISUL01                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     ISPART        PGID
     C                   ELSE
     C                   MOVEL     *BLANKS       PGID
     C                   ENDIF
     C     1             CHAIN(N)  CNFF                               90
     C     *IN90         IFEQ      *OFF
     C     CNCOD1        ANDEQ     'Y'
     C                   MOVEL     'CCS'         PGID
     C                   ENDIF
     C                   CALL      'TDV14R'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM      *BLANKS       AWB              11
     C                   PARM                    PGID
     C                   PARM                    PGIDNE
     C                   PARM                    PGPACP
     C                   PARM                    PGPACA
     C                   PARM                    PGCPAI
     C                   PARM                    PGCPAA
     C                   PARM                    PGMTM1
     C                   PARM                    PGMTM2
     C                   PARM                    PGMTM3
      *
     C                   ENDSR
      ******************************************
     C     PRINT3        BEGSR
      ******************************************
      * LABEL PRINT MED BARCODE (TDV IS)
     C     DIAWB3        CHAIN     ISUL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     ISPART        LAPAID
     C                   MOVEL     'LAI'         LAMEID
     C     1             CHAIN     CNFF                               90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   ADD       1             CNRECN
     C                   UPDATE    CNFR
     C                   Z-ADD     CNRECN        LARECN
      * HENT PRINTER NAVN
     C                   CALL      'SYGE01'
     C                   PARM                    DIAVD
     C                   PARM      068           WUSKNR            3 0
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WKOPFM
     C                   MOVEL     WOPNVN        LAPRID
     C                   Z-ADD     DIANT         LANUMC
     C     ISPART        CHAIN     PARL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     LABNAM        LAISTX
     C     HEPK9         IFEQ      'J'
     C                   MOVEL     'JETPAK'      LASERC
     C                   ELSE                                                   <WHEGN3
     C                   MOVEL     *BLANKS       LASERC
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     DIFRA         WHESDT
     C                   MOVEL     DIAWB3        AWBDES
     C                   MOVE      DIAWB8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     DITIL         LADCTY
     C                   Z-ADD     DIANT         LANUMP
     C                   Z-ADD     DIVEKT        LAWGHT
     C                   MOVEL     DIMERK        LAHAIN
     C                   MOVEL     DISNAV        LASHP1
     C                   MOVEL     DISAD1        LASHP2
     C                   MOVEL     DISAD2        LASHP3
     C                   MOVEL     DISAD3        LASHP4
     C                   MOVEL     DIKNAV        LACNE1
     C                   MOVEL     DIKAD1        LACNE2
     C                   MOVEL     DIKAD2        LACNE3
     C                   MOVEL     DIKAD3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     DIRUNR        IFNE      *BLANKS
     C     DIRUN2        ANDEQ     *BLANKS
     C     DIRUN3        ANDEQ     *BLANKS
     C                   MOVEL     DITIL         WWA
     C                   MOVEL     DIRUNR        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     DIRUN2        IFNE      *BLANKS
     C     DIRUN3        ANDEQ     *BLANKS
     C     DIRUNR        ANDNE     *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DIXXV1        WWA
     C                   MOVEL     DIRUNR        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DITIL         WWA
     C                   MOVEL     DIRUN2        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     DIRUN2        IFNE      *BLANKS
     C     DIRUN3        ANDNE     *BLANKS
     C     DIRUNR        ANDNE     *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DIXXV1        WWA
     C                   MOVEL     DIRUNR        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DIXXV2        WWA
     C                   MOVEL     DIRUN2        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DITIL         WWA
     C                   MOVEL     DIRUN3        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   Z-ADD     DIAWB         LAAWBN
     C                   Z-ADD     DIAWB         LAAWB2
     C                   MOVEL     *ZEROS        LAHNUM
     C                   MOVEL     *ZEROS        LAHWGT
     C                   MOVE      ' '           LAHCDE
      *
     C                   WRITE     LABR
      *
     C                   MOVE      'P'           DIMLAP
     C     ENDPR3        ENDSR
      *
      ***********************************************
     C     SNDTA2        BEGSR
      ***********************************************
     C                   MOVEL     'SMADTARQ'    QTNAME           10
     C                   MOVEL     '*LIBL'       QTLIB            10
     C                   Z-ADD     9             QTLEN             5 0
     C                   MOVE      *BLANKS       QTFIEL            9
     C                   MOVE      LARECN        QTFIEL
     C                   Z-ADD     9             QKILEN            3 0
     C                   MOVE      *BLANKS       QKEY              9
     C                   MOVEL     'LAI'         QKEY
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QTNAME
     C                   PARM                    QTLIB
     C                   PARM                    QTLEN
     C                   PARM                    QTFIEL
     C                   PARM                    QKILEN
     C                   PARM                    QKEY
      *
     C                   ENDSR
     C***********************************************
     C     CLOFIL        BEGSR
      ***********************************************
      * CLOSER FILER
     C                   CLOSE     CNFF                                 90
     C                   CLOSE     LABF                                 90
     C                   CLOSE     ISUL01                               90
     C                   CLOSE     PARL01                               90
      *
     C                   ENDSR
      ******************************************
     C     PRINT4        BEGSR
      ******************************************
     C     DIAWB3        CHAIN     ISUL01                             90
     C  N90ISPART        CHAIN     PARL01                             90
      * LABEL PRINT MED BARCODE STANDARD SYSPED400
      * HENT PRINTER NAVN
     C                   CALL      'SYGE01'
     C                   PARM                    DIAVD
     C                   PARM      068           WUSKNR            3 0
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WKOPFM
      * SJEKK OM DET ER KORREKT PRINTER ANGITT I PAPIRTYPE
     C     WOPTY         IFEQ      'ZEBRA 95'
     C     WOPTY         OREQ      'STRIPE  '
     C     WOPTY         OREQ      'ELTRON  '
     C                   CLEAR                   DOLAR
     C     *IN90         IFEQ      *ON
     C     LABNAM        OREQ      *BLANKS
     C                   MOVEL     FIKRTN        DOISTX
     C                   ELSE
     C                   MOVEL     LABNAM        DOISTX
     C                   ENDIF
     C                   MOVEL     WOPNVN        LAPRID
     C                   Z-ADD     DIANT         LANUMC
     C                   MOVEL     *BLANKS       LAISTX
     C     HEPK9         IFEQ      'J'
     C                   MOVEL     'JETPAK'      LASERC
     C                   ELSE                                                   <WHEGN3
     C                   MOVEL     *BLANKS       LASERC
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     DIFRA         WHESDT
     C                   MOVEL     DIAWB3        AWBDES
     C                   MOVE      DIAWB8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     DITIL         LADCTY
     C                   Z-ADD     DIANT         LANUMP
     C                   Z-ADD     DIVEKT        LAWGHT
     C                   MOVEL     DIMERK        LAHAIN
     C                   MOVEL     DISNAV        LASHP1
     C                   MOVEL     DISAD1        LASHP2
     C                   MOVEL     DISAD2        LASHP3
     C                   MOVEL     DISAD3        LASHP4
     C                   MOVEL     DIKNAV        LACNE1
     C                   MOVEL     DIKAD1        LACNE2
     C                   MOVEL     DIKAD2        LACNE3
     C                   MOVEL     DIKAD3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     DIRUNR        IFNE      *BLANKS
     C     DIRUN2        ANDEQ     *BLANKS
     C     DIRUN3        ANDEQ     *BLANKS
     C                   MOVEL     DITIL         WWA
     C                   MOVEL     DIRUNR        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     DIRUN2        IFNE      *BLANKS
     C     DIRUN3        ANDEQ     *BLANKS
     C     DIRUNR        ANDNE     *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DIXXV1        WWA
     C                   MOVEL     DIRUNR        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DITIL         WWA
     C                   MOVEL     DIRUN2        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     DIRUN2        IFNE      *BLANKS
     C     DIRUN3        ANDNE     *BLANKS
     C     DIRUNR        ANDNE     *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DIXXV1        WWA
     C                   MOVEL     DIRUNR        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DIXXV2        WWA
     C                   MOVEL     DIRUN2        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DITIL         WWA
     C                   MOVEL     DIRUN3        WWB
     C                   MOVE      '/'           WWC
     C                   MOVEL     DIDAG3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   Z-ADD     DIAWB         LAAWBN
     C                   Z-ADD     DIAWB         LAAWB2
     C                   MOVEL     *ZEROS        LAHNUM
     C                   MOVEL     *ZEROS        LAHWGT
     C                   MOVE      ' '           LAHCDE
     C                   Z-ADD     DIAVD         LAAVD
     C                   Z-ADD     DIOPD         LAOPD
     C                   MOVE      HESG          LASIGN
      *
     C                   WRITE     DOLAR
      *
     C                   CALL      'SYLA01C'
     C                   PARM                    DIAVD
     C                   PARM                    DIOPD
     C                   PARM                    WOPTY
     C                   PARM                    WOPNVN
      *
     C     DORECN        CHAIN     DOLAR                              90
     C     *IN90         IFEQ      *OFF
     C                   DELETE    DOLAR
     C                   ENDIF
      *
     C                   ENDIF                                                  <WOPTY
      *
     C                   MOVE      'P'           DIMLAP
     C     ENDPR4        ENDSR
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
     C                   MOVE      DIFBNR        TTFBNR
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XUL≈≈         UL≈≈
     C                   MOVE      'PRA'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      TTDATE        DIPDAT
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      WUSER         TTUSER
     C                   MOVEL     'Airwaybi'    XXTE16           16
     C                   MOVE      'll print'    XXTE16
     C                   MOVEL     XXTE16        XXTE32           32
     C                   MOVEL     'printed '    XXTE16
     C                   MOVE      '(Inb)   '    XXTE16
     C                   MOVE      XXTE16        XXTE32
     C                   MOVEL     XXTE32        TTTEXT
     C                   MOVE      *BLANKS       XXTE32
     C                   MOVE      DIAWB         XXTE32
     C                   MOVE      XXTE32        TTTEXT
     C                   WRITE     TRACKFR
     C                   ENDSR
      *
     OFLYFRAKT  E            DET              01
     O                       KFMT1               75
     O          E            DET              01
     O                       KFMT2               75
     OFLYFRAKT  E            DET              02
     O              N44N70   DIFNAV              49
     O              N44 70                       43 'JETPAKKE NORGE          '
     O              N44      DIAWB               68 '0   &--&    &    '
     O              N44      HEPK9               57
     O               44      KNAVN               49
     O               44      DITIL               55
     O               44                          55 '-'
     O               44      XHAWB               62
     O          E            DET              05
     O                       XALUFT              38
     O                       DIRUNR              41
     O                       DIDAG1              44
     O               82      DIRUN2              51
     O               82      DIDAG2              54
     O                       XBLUFT              73
     O          E    83      DET              06
     O                       DIRUN3              41
     O                       DIDAG3              44
     O          E            DET              08
     O                       DIKNAV              55
     O          E            DET              09
     O                       DIKAD1              55
     O                       DIKTLF              72
     O          E            DET              10
     O                       DIKAD2              55
     O          E            DET              11
     O                       DIKAD3              55
     O          E            DET              14
     O                       DISNAV              55
     O          E            DET              15
     O                       DISAD1              55
     O                       DISTLF              72
     O          E            DET              16
     O                       DISAD2              55
     O          E            DET              17
     O                       DISAD3              55
     O          E            DET              20
     O                       DIANT         Z     21
     O                       DIVEKT        Z     28
     O                       DISLAG              51
     O                       DIFVKT        Z     54
     O              N70      DIPRIS        J     69
     O          E            DET              21
     O              N70      DIVSL2              49
     O               70                          49 'Grunnpris JETPAKKE'
     O               70      DIPRIS        J     71
     O               70                          71 '    '
     O          E    51 70   DET              22
     O                                           32 '+'
     O                       DIFVK2        Z     37
     O                                           41 'kg x'
     O                       KIPXX1        Z     46
     O                                           48 'kr'
     O                       XGRUNN        Z     67
     O          E    71      DET              26
     O                                           43 '** TOLLPASS ** TOLLPASS '
     O                                           67 '** TOLLPASS **          '
     O          E    71      DET              26
     O                                           43 '** TOLLPASS ** TOLLPASS '
     O                                           67 '** TOLLPASS **          '
     O          E            DET              27
     O                       DIMERK              69
     O          E            DET              29
     O                       DIFORS        Z     39
     O                       DIFORA              69
     O          E            DET              33
     O               66                          43 'Ink.gr.pris kr.    '
      * KIPB1 slutter pÂ 45 i S/36
     O               66      XGRUNN        3     45
     O               50      DIFRAK        Z     52
     O               50                          55 ',00'
     O              N50      DIFRAK        Z     62
     O              N50                          65 ',00'
     O          E            DET              37
     O               50      DIFPRE        Z     55
     O              N50      DIFPRE        Z     62
     O          E            DET              43
     O               50      DIVGEB        Z     52
     O               50                          55 ',00'
     O              N50      DIVGEB        Z     62
     O              N50                          65 ',00'
     O               50 73   XCCFR         J     66
     O          E            DET              45
     O               47      DITXUT              35
     O               50 47   DIFS          Z     52
     O               50 47                       55 ',00'
     O              N50 47   DIFS          Z     62
     O              N50 47                       65 ',00'
     O          E            DET              47
     O               71      HEGN                41
     O               50 72   DIMVA               55 '      0,  '
     O              N50 72N74DIMVA               65 '      0,  '
     O          E            DET              51
     O               50      DISUM               55 '    0,  '
     O          E            DET              54
     O                       XALUFT              36
     O              N35      XIAT1               39
     O              N35                          40 '-'
     O              N35      XIAT2               41
     O              N35                          42 '-'
     O              N35      XIAT3               46
     O          E            DET              55
     O                       IDAG1               23
     O                       IDAG2               25
     O                       IDAG3               27
     O              N35      KOAIA2        Z     41
     O          E            DET              57
     O                       XKNA24              70
     O          E            DET              61
     O                       DISG                49
     O                       HEAVD         Z     61
     O                                           62 '/'
     O                       HEOPD         Z     69
     O          E            DET              64
     O                       DIAWB               68 '0   &--&    &    '
     O                       HEPK9               57
     OMERKL1    E            MLAP             01
     O                       KFMT1               75
     O          E            MLAP             01
     O                       KFMT2               75
     OMERKL1    E            MLAP             06
     O                       XAWB1                5
     O                       XAWB2                7
     O                       XAWB3                9
     O                       XAWB4               12
     O                       XAWB5               14
     O                       XAWB6               16
     O                       XAWB7               18
     O                       XAWB8               21
     O                       XAWB9               23
     O                       XAWBA               25
     O                       XAWBB               27
     O               77      DIANT         Z     36
     O               77      DIVEKT        Z     45
     O          E            MLAP             09
     O                       XTIL1                5
     O                       XTIL2                7
     O                       XTIL3                9
     OMERKL2    E            MLAP2            01
     O                       KFMT1               75
     O          E            MLAP2            01
     O                       KFMT2               75
     OMERKL2    E            MLAP2            04
     O                       DIKNAV              35
     O          E            MLAP2            06
     O                       DIKAD1              35
     O          E            MLAP2            08
     O                       DIKAD2              35
     O          E            MLAP2            10
     O                       DIKAD3              35
     OHEADFR    E            OPDHEA
     O                       HEPK5
     ODOKUIR    E            OPDDOK
     O                       DIST
     O                       DIMLAP
     O                       DIPDAT
