********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 UTVIDELSE AV OPPDRAGSNR
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 02 YBC PTF11 ÅPNE FOR PRINTER
********************************************************************
      * OBS! FOR DEM SOM VIL HA MERKELAPPER MÅ HA EGEN DESIGN PÅ M.L
      * OBS! STANDARD PROGRAM SKRIVER IKKE MERKELAPPE. SE LINJE SOM
      * OBS! MERKET MED XXX FRA FØRST POSISJON.
      *
      * Be aware that the "caret" value  ^  is typed by entering
      * Alt Hex 5F in EBCDIC. That corresponds to the ASCII value
      * of 5E.
      * Be aware that the "tilde" value  ~  is typed by entering
      * Alt Hex DC in EBCDIC. That corresponds to the ASCII value
      * of 7E.
      *
     H FTRANS
     FGSS035W   UF   E           K DISK
     FGSS035W2  UF   E           K DISK
     FGSSORL22  IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FLISTE     O    F   36        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D A5              S              1    DIM(5)                               Input string
     D B5              S              1    DIM(5)                               Output string
     D B8              S              1    DIM(8)                               Output string
     D                 DS
     D  DATA                   1     36
     D  DATA1                  4     36
     D  DATA12                 9      9
     D  DATA13                10     10
     D  DATA3                  1      3
     D                 DS
     D  A8                     1      8
     D                                     DIM(8)                               Input string
     D  XNR06                  1      6  0
     D  XAN01                  7      7
     D  XNR01                  8      8  0
     D UCMD            DS          1024
     D                 DS
     D XCMD01          C                   CONST('OVRPRTF -
     D                                     FILE(LISTE) -
     D                                     OUTQ(')
     D XCMD02          C                   CONST('PAGESIZE(73 132) -
     D                                     CPI(10) -
     D                                     OVRFLW(73) -
     D                                     COPIES(')
     D                 DS            26
     D DFLT            C                   CONST('^XA^LH00,00^CI4-
     D                                     ^FWN^LRY^XZ')
     D                 DS            13
     D XON             C                   CONST('GSL Order No.')
     D                 DS             9
     D XKLNR           C                   CONST('Colli No.')
     D                 DS            13
     D XDTLT           C                   CONST('Delivery date')
     D                 DS            11
     D XCLT            C                   CONST('Total colli')
     D                 DS            12
     D XVKT            C                   CONST('Total weight')
     D                 DS            11
     D XSDT            C                   CONST('Destination')
     D                 DS
      * Make "No. of Pieces" Zoned numeric
     D  LANUMA                 1      5  0
     D                 DS
     D  WRK                    1      5  0
      * ORDNE NØKKEL
     C     GOR22K        KLIST
     C                   KFLD                    W3TNO
     C                   KFLD                    W32CLN
      * Input Parameter
     C     *ENTRY        PLIST
S01  C*                  PARM                    UON               9            ORDRENR      ID
N01  C                   PARM                    UON              11            ORDRENR      ID
      *
     C                   MOVE      UON           W3TNO
S02  C*    W3TNO         CHAIN     GSS035W                            33
N02  C     W3TNO         CHAIN(N)  GSS035W                            33
     C   33              GOTO      ENDPGM
S02  C*                  DELETE    GSS035WR
S02  C*    W3TNO         SETLL     GSS035W2
S02  C*    W3TNO         READE     GSS035W2                               33
S02  C*    *IN33         DOWEQ     '0'
S02  C*                  DELETE    GSS35WR2
S02  C*    W3TNO         READE     GSS035W2                               33
S02  C* N33              ENDDO
S02  C*                  GOTO      ENDPGM
     C     W3SDT         CHAIN     STED2                              33
     C   33              MOVEL     W3SDT         ST2NVN
     C     W3FC          CHAIN     GSSFIF                             33
     C                   Z-ADD     W3VKT         XNR06
     C                   MOVE      W3VKT         XNR01
     C                   MOVE      '.'           XAN01             1
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B8
     C     A8(X)         DOWEQ     '0'
     C     X             ANDLT     8
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     8
     C                   MOVEA     A8(X)         B8(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
      * OVERSTYRE PRINTERFIL
     C                   MOVE      2             WSKOPI
     C                   MOVE      '1'           UKOPI             1
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     XCMD01        CAT       WSMLP:0       UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD02:1      UCMD
     C                   CAT       UKOPI:0       UCMD
     C                   CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            55
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      * Open Printerfile
     C                   OPEN      LISTE                                55
      * Execute init routine only once
     C                   EXSR      SRINIT
      *
     C     W3TNO         SETLL     GSS035W2
     C     W3TNO         READE     GSS035W2                               33
     C     *IN33         DOWEQ     '0'
      * Execute Label Init
     C                   EXSR      SR0001
      * Execute Name of vessel
     C                   EXSR      SR0010
      * Execute CONSIGNEE
     C                   EXSR      SR0020
      * Execute GSL order No.
     C                   EXSR      SR0030
      * Execute No. of colli
     C                   EXSR      SR0040
      * Execute delivery date
     C                   EXSR      SR0050
      * Execute Total colli / weight
     C                   EXSR      SR0060
      * Execute Destination
     C                   EXSR      SR0070
      * Execute Free text
     C                   EXSR      SR0080
      * Execute Company
     C                   EXSR      SR0090
      * Execute P.O.No. as Bar codes
     C                   EXSR      SR0100
      * Execute Number of Copies
     C                   EXSR      SRNUMB
      * Execute End Label Format
     C                   EXSR      SREND
      *
     C                   DELETE    GSS35WR2
     C     W3TNO         READE     GSS035W2                               33
     C  N33              ENDDO
      *
     C                   MOVE      1             WSKOPI
     C                   EXSR      SR0001
     C                   EXSR      SR0010
     C                   EXSR      SR0020
     C                   EXSR      SR0030
     C                   EXSR      SR0050
     C                   EXSR      SR0060
     C                   EXSR      SR0070
     C                   EXSR      SR0080
     C                   EXSR      SR0090
     C                   EXSR      SR0100
     C                   EXSR      SRNUMB
     C                   EXSR      SREND
      *
      * Close Prinerfile
     C                   CLOSE     LISTE                                55
      * End Program
     C     ENDPGM        TAG
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *_____________________________________________________
      * Execute Label Init
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      * Send Default Instructions
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Name of Vessel
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
     C                   MOVE      W3NAB         X3NAB            30
     C     W3NAB         IFEQ      *BLANKS
     C     GOR22K        SETLL     GSSORL22
     C     W3TNO         READPE    GSSORL22                               34
     C     *IN34         IFEQ      '0'
     C     W32CLN        ANDLE     ORCLNT
     C     ORBCD         CHAIN     CDBOAT                             34
     C  N34              MOVEL     CBNAB         W3NAB
     C                   END
     C                   END
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '640,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3NAB         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
     C                   MOVE      X3NAB         W3NAB
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute CONSIGNEE
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0020        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '600,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3AD1         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C     W3AD2         IFNE      *BLANKS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '570,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3AD2         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
     C                   END
      *
     C     W3AD3         IFNE      *BLANKS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3AD3         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
     C                   END
      *
     C     W3AD4         IFNE      *BLANKS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '510,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3AD4         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
     C                   END
      *
     C     W3AD5         IFNE      *BLANKS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '480,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3AD5         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
     C                   END
      *
     C     W3AD6         IFNE      *BLANKS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '450,400'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3AD6         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
     C                   END
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute GSL Order No.
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0030        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '350,300'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XON           DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '350,700'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3TNO         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute No. of colli
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0040        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '350,1100'    DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XKLNR         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '350,1400'    DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * No. of colli
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     W32CLN        LANUMA
     C                   MOVE      LANUMA        CHAR5             5
     C                   MOVEA     CHAR5         A5
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B5
     C     A5(X)         DOWEQ     '0'
     C     X             ANDLT     5
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     5
     C                   MOVEA     A5(X)         B5(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B5            DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Delivery date
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0050        BEGSR
      * Start of Text bit (^XA)
      *                    MOVE *BLANKS   DATA
      *                    MOVELWXA       DATA
      *                    EXCPTLISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '320,300'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XDTLT         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '320,700'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     W3DTL         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Total colli / weight
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0060        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '290,300'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XCLT          DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '290,700'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Total colli
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     W3CLT         LANUMA
     C                   MOVE      LANUMA        CHAR5             5
     C                   MOVEA     CHAR5         A5
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B5
     C     A5(X)         DOWEQ     '0'
     C     X             ANDLT     5
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     5
     C                   MOVEA     A5(X)         B5(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B5            DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '260,300'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XVKT          DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '260,700'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Total weight
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEA     B8            DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Destination
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0070        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '230,300'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XSDT          DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '230,700'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,20,16'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     ST2NVN        DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Free text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0080        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '170,300'     DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,30,24'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WSFTXT        DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Company
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0090        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '60,300'      DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,15,12'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     FINM          DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '60,900'      DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,15,12'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     FIAD1         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '30,300'      DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,15,12'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     FIAD2         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '30,900'      DATA1
     C                   EXCEPT    LISTEA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     'R,15,12'     DATA1
     C                   EXCEPT    LISTEA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     FIAD3         DATA1
     C                   EXCEPT    LISTEA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute P.O.no. as Bar Code  (Interleaved 2 of 5)
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0100        BEGSR
      * Data Position
     C*                    MOVE *BLANKS   DATA
     C*                    MOVELWFO       DATA
     C*                    MOVEL'300,300' DATA1
     C*                    EXCPTLISTEA
      * Font (Selecting Barcode Field Default)
     C*                    MOVE *BLANKS   DATA
     C*                    MOVEL'^BY'     DATA
     C*                    MOVEL'3,3:1,15'DATA1
     C*                    EXCPTLISTEA
      * Font (Selecting Barcode Interleaved 2 of 5)
     C*                    MOVE *BLANKS   DATA
     C*                    MOVEL'^B3'     DATA
     C*                    MOVEL'R,N,70,Y'DATA1
     C*                    EXCPTLISTEA
      * Text to be printed as Barcode
     C*                    MOVE *BLANKS   DATA
     C*                    MOVELWFD       DATA
     C**                   MOVELUPON01    DATA1
     C*                    MOVELTRTNO     DATA1
     C*                    EXCPTLISTEA
      * Field Separator instruction (^FS)
     C*                    MOVE *BLANKS   DATA
     C*                    MOVELWFS       DATA
     C*                    EXCPTLISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * Initialise subroutine, set character set
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
     C                   MOVE      *ON           *IN50
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVE      *BLANKS       MSGVAR            7            Message Variabel
      *
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to set number of copies
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRNUMB        BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^PQ'         DATA
     C                   Z-ADD     WSKOPI        WRK
     C                   MOVEL     WRK           DATA1
     C                   EXCEPT    LISTEA
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to end Label Format
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    LISTEA
     C                   ENDSR
      *
     OLISTE     E            LISTEA
     O                       DATA
**    *  Translation table for Zebra 9X printers, ÆØÅ.
LISTE     9E7B
LISTE     E07C
LISTE     9F5B
LISTE     9CC0
LISTE     BB6A
LISTE     47D0
