********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 Kilometerpris innført
11XXX * 02 SH  PTF11 Kilometerpris innland/eksport innført
11XXX * 03 SH  PTF12 opsjon 9 avvik km-priser pr. avdeling
11XXX * 04 SH  PTF12 viser de med avvik i km
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE UNITREGISTER                 ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24             ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-88 95-97       ***
      **************************************************************
      *
N04  FUNITAKM   IF   E           K DISK
     FUNIT      UF A E           K DISK
     FTRAN      IF   E           K DISK
     FBILK      IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FUNTY      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYTR06FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSRETU                 1     30
     D  PDATST                 1      2
     D  PDATXT                 1      4
     D  PDASJNR                5     12
     D                 DS
     D  UNBILN                 1     10
     D  XDLT                   1      8
     D                 DS
     D  UNDATE                 1      8  0
     D  UNYEAR                 1      4  0
     D  UNMONT                 5      6  0
     D  UNDAY                  7      8  0
     D                 DS
     D  WNDATE                 1      6  0
     D  WNDAY                  1      2  0
     D  WNMONT                 3      4  0
     D  WNYEAR                 5      6  0
     D                 DS
     D  WSDATE                 1      6  0
     D  WSDAY                  1      2  0
     D  WSMONT                 3      4  0
     D  WSYEAR                 5      6  0
     C*
     C     STINI         TAG
     C                   EXSR      INIT
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      W2BILN        YSBILN
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     KODSI1        SETLL     UNIT
     C     START1        TAG
     C     WSFIRM        READE(N)  UNIT                                   94
     C  N94              MOVE      WSBILN        YSBILN
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        14
     C                   ADD       1             ZRECNO
     C                   MOVE      UNYEAR        WNYEAR
     C                   MOVE      UNMONT        WNMONT
     C                   MOVE      UNDAY         WNDAY
n04  c                   setoff                                       67
N04  c     keykm         chain     unitakm                            66
N04  c  N66              seton                                        67
     C                   WRITE     SUBFIL
     C     WSFIRM        READE(N)  UNIT                                   94
     C  N94              MOVE      WSBILN        YSBILN
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   Z-ADD     4             POSNBR
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       9899
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*** F12 - FORIGE = NYTT SØK
     C   12              GOTO      STINI
     C*
     C*** FRISK OPP
     C   05              GOTO      START
     C*
     C*** LAGE NY
     C   06              DO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     04            POSNBR
     C                   EXSR      MOVB2
     C                   GOTO      START5
     C                   END
     C*** SØK FRA
     C   08              GOTO      START6
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   SETOFF                                       25
     C                   Z-ADD     YRECNO        ZRECNO
     C  N94              MOVE      UNBILN        YSBILN
     C  N94KODSI3        SETLL     UNIT
     C  N94WSFIRM        READE(N)  UNIT                                   94
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
     C*
     C*** LAGE NY
     C     START5        TAG
     C                   EXFMT     VARELI
     C     *IN04         IFEQ      *ON
     C                   EXSR      SØKDTA
     C                   GOTO      START5
     C                   END
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C*
     C*** SØK FRA
     C     START6        TAG
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     04            POSNBR
     C                   EXFMT     VAREL2
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     27
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLAND
     C                   PARM                    USPED
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     31
     C                   CALL      'SYTR21A'
     C                   PARM                    WSTRME
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01  C     LINNBR        IFEQ      23
N01  C     POSNBR        ANDGE     75
N01  C     POSNBR        ANDLE     78
N01  C                   MOVE      'P'           UMODE             1
N01  C                   CALL      'SYTR20CLP'
N01  C                   PARM                    UMODE
N01  C                   PARM                    WSUNTY
N01  C                   GOTO      SLSØK
N01  C                   END
     C     SLSØK         ENDSR
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '0000'        *IN(80)
     C  N40              DO
     C*
     C     WSBILN        COMP      *BLANKS                                80
     C   80              MOVE      'SPB0107'     MSGNR
     C  N80KODSIK        CHAIN(N)  UNIT                               33
     C  N80
     CANN33              DO
     C                   SETON                                        80
     C                   MOVE      'SPB0108'     MSGNR
     C                   END
     C   80              SETON                                        30
     C   80              Z-ADD     22            LINNBR
     C                   END
     C*
     C   30              GOTO      SLTB
      * øvrige tester utføres i omvent rekkefølge - higlight all/cursor første
      * Test bilTYPE
     C     WSUNTY        IFNE      *BLANKS
     C     WSUNTY        Chain     UNTY                               83
     C   83              Z-ADD     23            LINNBR
     C   83              Z-ADD     75            POSNBR
     C   83              MOVE      '1'           *IN30
     C   83              MOVE      'JOV1489'     MSGNR
     C                   END
      * Test garanti/PDA/sjåf.nummer
     C     PDATST        IFeq      'PD'
     C                   TESTN                   PDASJNR              34
     C     PDATXT        comp      'PDA:'                             8484
     C  N84*IN34         COMP      '0'                                    84    IKKE NUMERISK
     C   84              Z-ADD     23            LINNBR
     C   84              Z-ADD     35            POSNBR
     C   84              MOVE      '1'           *IN30
     C   84              MOVE      'JOV1490'     MSGNR
     C                   end
      * Test bilkode
     C     WSTRME        Chain     BILK                               82
     C   82              Z-ADD     22            LINNBR
     C   82              Z-ADD     29            POSNBR
     C   82              MOVE      '1'           *IN30
     C   82              MOVE      'DIV4014'     MSGNR
      * Test Landkode
     C     LKKEY         Chain     KODTLK                             81
     C   81              Z-ADD     22            LINNBR
     C   81              Z-ADD     26            POSNBR
     C   81              MOVE      '1'           *IN30
     C   81              MOVE      'SPL0001'     MSGNR
     C*
     C   30              GOTO      SLTB
     C*
     C*** OPPDATERE PÅ REGISTER OG SUBFIL
     C     KODSIK        CHAIN     UNIT                               33
     C                   EXSR      MOVWSI
     C  N33              UPDATE    UNITR
     C   33              MOVE      *ZEROS        UNSAVD
     C   33              MOVE      *ZEROS        UNSPRO
     C   33              MOVE      *ZEROS        UNRUND
     C   33              WRITE     UNITR
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C                   EXSR      MOVB2
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       14            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '2'                                          ENDRE
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE*'                             98
     C   98              GOTO      SLHENT
     C                   EXSR      CHGSI
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '4'                                          SLETTE
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE*'                             98
     C   98              GOTO      SLHENT
     C                   EXSR      DLTSI
     C   12              GOTO      SLHENT
     C                   END
      *
     C     WSNR          IFEQ      '6'                                          FAXNR
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE*'                             98
     C   98              GOTO      SLHENT
     C                   CALL      'SYTR09'
     C                   PARM                    UNBILN
     C                   PARM                    UUFAXN           15
     C                   PARM                    UUTXT            20
     C                   PARM                    UMODUS            1
     C                   UPDATE    SUBFIL
     C                   END
      *
N03  C     WSNR          IFEQ      '9'                                          FAXNR
N03  C                   MOVE      ' '           WSNR
N03  C     XDLT          COMP      '*DELETE*'                             98
N03  C   98              GOTO      SLHENT
N03  C                   CALL      'SYTR04K'
N03  C                   PARM                    UNTRAN
N03  C                   PARM                    UNBILN
N03  C                   PARM                    WSNAVN
N03  C                   UPDATE    SUBFIL
N03  C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLTSI         BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   EXFMT     VAREL3
     C  N12              DO
     C                   MOVE      UNBILN        WSBILN
     C     KODSIK        CHAIN     UNIT                               33
     C  N33              DELETE    UNITR
     C                   EXSR      MOVB1
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGSI         BEGSR
     C***********************************************
     C                   EXSR      MOVSIW
     C                   SETON                                        99
     C     STCHG         TAG
     C                   EXFMT     VARELI
     C     *IN04         IFEQ      *ON
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
     C   12              DO
     C                   UPDATE    SUBFIL
     C                   EXSR      MOVB2
     C                   END
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       UNBILN
     C                   MOVE      *BLANKS       UNTILH
     C                   MOVE      *ZEROS        UNAVD
N01  C                   MOVE      *ZEROS        UNKMP
N01  C                   MOVE      *BLANKS       UNVAL
N02  C                   MOVE      *ZEROS        UNKMPI
N02  C                   MOVE      *BLANKS       UNVALI
N02  C                   MOVE      *ZEROS        UNKMPE
N02  C                   MOVE      *BLANKS       UNVALE
     C                   MOVE      *BLANKS       UNLAND
     C                   MOVE      *ZEROS        UNVEKT
     C                   MOVE      *ZEROS        UNTARA
     C                   MOVE      *ZEROS        UNM3
     C                   MOVE      *ZEROS        UNLM
     C                   MOVE      *BLANKS       UNTRME
     C                   MOVE      *ZEROS        UNTRMA
     C                   MOVE      *ZEROS        UNDATE
     C                   MOVE      *ZEROS        WNDATE
     C                   MOVE      *BLANKS       UNRETU
     C                   MOVE      *BLANKS       UNUNTY
     C                   MOVE      *ZEROS        UNHØYD
     C*
     C                   MOVEL     '*DELETE*'    XDLT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       30
     C                   SETOFF                                       40
     C*
     C                   MOVE      *BLANKS       WSBILN
     C                   MOVE      *BLANKS       WSTILH
     C                   MOVE      *ZEROS        WSAVD
N01  C                   MOVE      *ZEROS        WSKMP
N01  C                   MOVE      *BLANKS       WSVAL
N02  C                   MOVE      *ZEROS        WSKMPI
N02  C                   MOVE      *BLANKS       WSVALI
N02  C                   MOVE      *ZEROS        WSKMPE
N02  C                   MOVE      *BLANKS       WSVALE
     C                   MOVE      *BLANKS       WSLAND
     C                   MOVE      *ZEROS        WSVEKT
     C                   MOVE      *ZEROS        WSTARA
     C                   MOVE      *ZEROS        WSM3
     C                   MOVE      *ZEROS        WSLM
     C                   MOVE      *BLANKS       WSTRME
     C                   MOVE      *ZEROS        WSTRMA
     C                   MOVE      *ZEROS        WSDATE
     C                   MOVE      *BLANKS       WSRETU
     C                   MOVE      *BLANKS       WSUNTY
     C                   MOVE      *ZEROS        WSHØYD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVSIW        BEGSR
     C***********************************************
     C                   MOVE      UNBILN        WSBILN
     C                   MOVE      UNTILH        WSTILH
     C                   MOVE      UNAVD         WSAVD
N01  C                   MOVE      UNKMP         WSKMP
N01  C                   MOVE      UNVAL         WSVAL
N02  C                   MOVE      UNKMPI        WSKMPI
N02  C                   MOVE      UNVALI        WSVALI
N02  C                   MOVE      UNKMPE        WSKMPE
N02  C                   MOVE      UNVALE        WSVALE
     C                   MOVE      UNLAND        WSLAND
     C                   MOVE      UNVEKT        WSVEKT
     C                   MOVE      UNTARA        WSTARA
     C                   MOVE      UNM3          WSM3
     C                   MOVE      UNLM          WSLM
     C                   MOVE      UNTRME        WSTRME
     C                   MOVE      UNTRMA        WSTRMA
     C                   MOVE      UNYEAR        WSYEAR
     C                   MOVE      UNMONT        WSMONT
     C                   MOVE      UNDAY         WSDAY
     C                   MOVE      UNRETU        WSRETU
     C                   MOVE      UNUNTY        WSUNTY
     C                   MOVE      UNHØYD        WSHØYD
     C*
     C                   SETON                                        40
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     15            POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWSI        BEGSR
     C***********************************************
     C* FIX KEY IF NOT FOUND
     C   33              DO
     C                   MOVE      WSBILN        UNBILN
     C                   END
     C*
     C* FIXES VARIABLES
     C                   MOVE      WSTILH        UNTILH
     C                   MOVE      WSAVD         UNAVD
N01  C                   MOVE      WSKMP         UNKMP
N01  C                   MOVE      WSVAL         UNVAL
N02  C                   MOVE      WSKMPI        UNKMPI
N02  C                   MOVE      WSVALI        UNVALI
N02  C                   MOVE      WSKMPE        UNKMPE
N02  C                   MOVE      WSVALE        UNVALE
     C                   MOVE      WSLAND        UNLAND
     C                   MOVE      WSVEKT        UNVEKT
     C                   MOVE      WSTARA        UNTARA
     C                   MOVE      WSM3          UNM3
     C                   MOVE      WSLM          UNLM
     C                   MOVE      WSTRME        UNTRME
     C                   MOVE      WSTRMA        UNTRMA
     C     WSDATE        IFEQ      0
     C                   MOVE      *ZEROS        UNDATE
     C                   ELSE
     C     WSYEAR        IFGT      50
     C     WSYEAR        ADD       1900          UNYEAR
     C                   ELSE
     C     WSYEAR        ADD       2000          UNYEAR
     C                   END
     C                   MOVE      WSMONT        UNMONT
     C                   MOVE      WSDAY         UNDAY
     C                   END
     C                   MOVE      WSRETU        UNRETU
     C                   MOVE      WSUNTY        UNUNTY
     C                   MOVE      WSHØYD        UNHØYD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UUTRAN            8 0
      *
     C     *LIKE         DEFINE    UNBILN        YSBILN
n04  C     KEYKM         KLIST
n04  C                   KFLD                    UNTRAN
n04  C                   KFLD                    UNBILN
     C     KODSIK        KLIST
     C                   KFLD                    WSFIRM
     C                   KFLD                    WSBILN
     C     KODSI1        KLIST
     C                   KFLD                    WSFIRM
     C                   KFLD                    W2BILN
     C     KODSI3        KLIST
     C                   KFLD                    WSFIRM
     C                   KFLD                    YSBILN
     C*
     C     LEVEK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSFIRM
     C*
     C     LKKEY         KLIST
     C                   KFLD                    XXUNIK
     C                   KFLD                    WSLAND
     C                   move      'LK '         XXUNIK            3
     C                   READ      FIRM                                   33
     C*
     C     UUTRAN        IFNE      *ZEROS
     C     WSFIRM        ANDEQ     *ZEROS
     C                   Z-ADD     UUTRAN        WSFIRM
     C                   GOTO      STI2
     C                   END
     C     STI           TAG
     C                   EXFMT     BILDE1
     C   03              GOTO      UTI
     C   04              DO
     C                   CALL      'SYTR04A'
     C                   PARM                    UTRAN             8 0
     C                   MOVE      UTRAN         WSFIRM
     C                   END
     C     STI2          TAG
     C     LEVEK         CHAIN     TRAN                               44
     C   44              MOVE      'SPT0105'     MSGNR
     C   44              GOTO      STI
     C                   MOVE      WSFIRM        UNTRAN
     C                   MOVE      VMNAVN        WSNAVN
     C                   MOVE      *ZEROS        WSDATE
     C                   MOVE      *ZEROS        WNDATE
     C*
     C     UTI           ENDSR
     C*
