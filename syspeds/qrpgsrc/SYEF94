      *
      ***********************************************************
      *** ADD ORDER TO CONSOLLIDATION                         ***
      ***********************************************************
     FFAI4      IF A E           K DISK
     FHEADF     UF   E           K DISK
     FFAK2      UF   E           K DISK
     FHEAD14    IF   E           K DISK
     F                                     RENAME(HEADFR:HEADFR7)
     FDOKEF     UF   E           K DISK
     FSAMLB     UF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FTELLAWB   UF   E           K DISK
     FSYEF94FM  CF   E             WORKSTN
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  SMDTÅ                  1      4  0
     D  SMDTM                  5      6  0
     D  SMDTD                  7      8  0
     D  SMDT                   1      8  0
     D                 DS
     D  WSSD                   1      3
     D  WSLNR                  4      6  0
     D  XSAML2                 1      6
     D  XSAML3                 1     15
     D                UDS
     D  WSAVD                 15     18  0
     D  WSSG                  19     21
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C   03              GOTO      SLUTT
     C*
     C     KODSFK        CHAIN     KODTSF                             99
     C   99              GOTO      START
     C     KODTAK        CHAIN     KODTA                              98
     C  N98KODTWK        CHAIN     KOWR                               98
     C   98              GOTO      START
     C*
     C* HENTER PROSJEKTNUMMER
     C*
     C     SAMLBK        CHAIN     SAMLB                              96
     C   96              GOTO      START
     C                   MOVE      SMDTD         WSDTD
     C                   MOVE      SMDTM         WSDTM
     C                   MOVE      SMDTÅ         WSDTÅ
     C     SMPRO         SETLL     HEAD14
     C     SMPRO         READE     HEAD14                                 97
     C  N97HEADF2        CHAIN     FAI4                               66
     C  N97
     CANN66              DO
     C                   MOVE      WSAVD         FIAVD
     C                   MOVE      WSOPD         FIOPD
     C                   WRITE     FAINR
     C                   END
     C  N97HEADFK        CHAIN     HEADF                              97
     C  N97              DO
     C     HEST          COMP      ' '                                9797
     C  N97HESAML        COMP      *BLANKS                            9797
     C   97              UPDATE    HEADFR
     C                   END
     C   97              GOTO      START
     C*
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE02
     C                   EXSR      KDTFMT
     C   05              DO
     C     DOKEFK        CHAIN     DOKEF                              33
     C  N33              UPDATE    DOKEFR
     C                   ADD       1             SMNT
     C* UPDATE'S HEADER
     C                   MOVE      SMPRO         HEPRO
     C                   MOVE      SMMAWB        HEGN
     C                   MOVE      *BLANKS       HESAML
     C                   MOVEL     XSAML2        HESAML
     C                   Z-ADD     SMKNF         HEKNT
     C                   Z-ADD     SMKNS         HEKNA
     C                   Z-ADD     SMKNS         HEKNKF
     C     TELAWK        CHAIN     TELLAWB                            33
     C  N33              MOVE      TEHAWB        HEHAWB
     C  N33              ADD       1             TEHAWB
     C  N33              UPDATE    TELLAWBR
     C                   END
     C*
     C                   UPDATE    SAMLAR
     C                   UPDATE    HEADFR
     C*
     C* UPDATE'S INVOICELINES ON CONSOLLIDATION
     C* KUN HVIS FAKTURERT TIDLIGERE
     C* IN66 IKKE LIK '1'
     C     *IN66         IFEQ      '0'
     C     FAKTKE        SETLL     FAK2
     C     FAKTKE        READE     FAK2                                   32
     C   32              DO
     C                   MOVE      'F'           WSSK              1
     C     FAKTKE        SETLL     FAK2
     C     FAKTKE        READE     FAK2                                   32
     C                   END
     C     FAKTKE        SETLL     FAK2
     C*
     C*
     C     STFA          TAG
     C     FAKTKE        READE     FAK2                                   32
     C  N32              DO
     C                   MOVE      'K'           FASK
     C                   MOVE      HEKNKF        FAKUNR
     C                   MOVE      FIFN          FAFAKT
     C                   MOVE      'F'           FAOPKO
     C                   MOVEL     HEDTÅ         FACC
     C                   MOVE      HEDTÅ         FAÅR
     C                   MOVE      HEDTM         FAMND
     C                   UPDATE    FAKTR
     C                   GOTO      STFA
     C                   END
     C*
     C                   END
     C*
     C                   MOVE      'K'           WSSK
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEADF2        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADFK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     HEAD7K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    XSAML3
     C     DOKEFK        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     SAMLBK        KLIST
     C                   KFLD                    WSSD
     C                   KFLD                    WSLNR
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    WSSG
     C     TELAWK        KLIST
     C                   KFLD                    TEHUNI
     C                   KFLD                    KOWLAS
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    WSAVD
     C     FAKTKE        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C                   KFLD                    WSSK              1
     C*
     C                   MOVE      'K'           WSSK              1
     C*
     C                   MOVE      'E'           TEHUNI
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'F'           YRI               1
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSLNR
     C*
     C                   MOVE      'DIV2200'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT              8
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
