             PGM PARM(&MBR)
/*____________________*/
/* Definier variabler */
/* MIDLERTIDIG HEADF I SYENDPTF */
/*""""""""""""""""""""*/
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10) +
                          VALUE('SYNETTL   ')
             DCL        VAR(&LIB4) TYPE(*CHAR) LEN(10) +
                          VALUE('SYEDIF    ')
             DCL        VAR(&QVAL) TYPE(*CHAR) LEN(15)
             DCL        VAR(&LINSUI) TYPE(*CHAR) LEN(8)
             DCL        VAR(&MAILI) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MBR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QT) TYPE(*CHAR) LEN(3)
             DCL        VAR(&TCP) TYPE(*CHAR) LEN(1) VALUE('J')
/*_____________*/
/* LAGER UT-MBR*/
/*"""""""""""""*/
 NY:         RMVM       FILE(&LIB/EDIUT) MBR(&MBR)
             MONMSG     MSGID(CPF0000)
             ADDPFM     FILE(&LIB/EDIUT) MBR(&MBR)
             MONMSG     MSGID(CPF7306) EXEC(GOTO CMDLBL(NY))
             OVRDBF     FILE(SNDDST) TOFILE(&LIB/EDIUT) MBR(&MBR)
             OVRDBF     FILE(EDIINN) TOFILE(&LIB/EDIINN) MBR(&MBR)
/*                 */
/*   ANDRE FILER   */
/*                 */
             OVRDBF     FILE(PWDINT) TOFILE(&LIB4/PWDINT)
/*_____________*/
/* Lag et svar */
/*"""""""""""""*/
             CALL       PGM(EDI21R) PARM(&QT &LINSUI &TCP &MBR &QVAL +
                          &MAILI)
             IF         COND(&QT = 'shr') THEN(DO)
             CALL       PGM(EDI21R9C) PARM(&QT &MBR)
             ENDDO
             IF         COND(&QT = 'do ') THEN(DO)
             CALL       PGM(EDI21R10C) PARM(&QT &MBR &QVAL &LINSUI)
             ENDDO
/* SENDER SVAR TIL INTERNETT BRUKER */
/*________________________*/
/* Send svar til avsender */
/*""""""""""""""""""""""""*/
             IF         COND(&MAILI *NE '        ') THEN(DO)
             DLTOVR     FILE(SNDDST)
             MONMSG     MSGID(CPF0000)
/*__________________________*/
/* Klargør utfil for SNDDST */
/*""""""""""""""""""""""""""*/
             CRTDUPOBJ  OBJ(E101C) FROMLIB(SYEDIF) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(SNDDST)
             CPYF       FROMFILE(SYNETTL/EDIUT) TOFILE(QTEMP/SNDDST) +
                          FROMMBR(&MBR) MBROPT(*REPLACE) +
                          CRTFILE(*NO) FMTOPT(*NOCHK)

             MRGDOC     FROMDOC(SNDDST) FROMFLR(STATUS) +
                          TODOC(SNDDSTX) REPLACE(*YES) +
                          MRGTYPE(*FILE) DTAFILE(SYNETTL/EDIUT) +
                          DTAMBR(&MBR) JOBQ(*NO)

             CHGDOCD    DOC(SNDDSTX) FLR(STATUS) SUBJECT((BOOKING +
                          'Bekreftet booket oppdrag'))
             MONMSG     MSGID(CPF0000)
             SNDDST     TYPE(*DOC) TOINTNET((&MAILI)) +
                          DSTD(QUERYANSWER) MSG('booked ordre +
                          internett') IMPORTANCE(*NORMAL) +
                          PTY(*HIGH) SNDFMT(*FINALFORM) +
                          DOC(SNDDSTX) FLR(STATUS) DOCD(QUERYANSWER)
             ENDDO
/* GRIEG SLUTT */
/*________________________*/
/* Send svar til avsender */
/*""""""""""""""""""""""""*/
             IF         COND(&QT = 'boo') THEN(DO)
             IF         COND(&LINSUI *NE '        ') THEN(DO)
             DLTOVR     FILE(SNDDST)
/*__________________________*/
/* Klargør utfil for SNDDST */
/*""""""""""""""""""""""""""*/
             CRTDUPOBJ  OBJ(E101C) FROMLIB(SYEDIF) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(SNDDST)
             CPYF       FROMFILE(SYNETTL/EDIUT) TOFILE(QTEMP/SNDDST) +
                          FROMMBR(&MBR) MBROPT(*REPLACE) +
                          CRTFILE(*NO) FMTOPT(*NOCHK)

             MRGDOC     FROMDOC(SNDDST) FROMFLR(STATUS) +
                          TODOC(SNDDSTX) REPLACE(*YES) +
                          MRGTYPE(*FILE) DTAFILE(SYNETTL/EDIUT) +
                          DTAMBR(&MBR) JOBQ(*NO)

             CHGDOCD    DOC(SNDDSTX) FLR(STATUS) SUBJECT((BOOKING +
                          'Bekreftet booket oppdrag'))
             MONMSG     MSGID(CPF0000)
             SNDDST     TYPE(*DOC) TOUSRID((&LINSUI NO542SYS)) +
                          DSTD(QUERYANSWER) MSG('Booked ordre +
                          internet') IMPORTANCE(*NORMAL) PTY(*HIGH) +
                          SNDFMT(*FINALFORM) DOC(SNDDSTX) +
                          FLR(STATUS) DOCD(QUERYANSWER)
             ENDDO
             ENDDO
             ENDPGM
