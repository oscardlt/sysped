********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 YBC PTF12 Div. endring
12XXX * 02 YBC PTF12 Forhåndsvarsel benytter normalprosedyre
12XXX * 03 CB  PTF12 Blanke ut garantibeløp og valuta ved kopiering
12307 * 04 CB  PTF12 Ikke krav til bestemmelseslandkode
12319 * 05 CB  PTF12 Kopier itemadresser ved kopiering av transitering
12325 * 06 CB  PTF12 Set THLIDT(Limit date) lik THDDT(Release date)
12339 * 07 CB  PTF12 Test at fristdato ikke er tilbake i tid og
      *              heller ikke mer en 30 dager fremover
12340 * 08 CB  PTF12 Endring logikk Dispatch country
      *              pluss litt til av andre tester vedr. PT
12347 * 09 CB  PTF12 Ikke summer vekter ved ant.kolli = 0
12349 * 10 CB  PTF12 Ikke kopier NCTSEIAM i PT
12354 * 11 CB  PTF12 Autor skal ikke fylles ut ved normalprosedyre
12360 * 12 CB  PTF12 Test kombinasjoner for lastested
12375 * 13 CB  PTF12 Test kombinasjoner for lossested
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED NCTS HOVED-OPPLYSNING      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05 06 08 09 11 13 16 18-26
      *** LEDIGE INDIKATORER 40 42
      ***        INDIKATOR   27 PÅ = SPØRRING                 ***
      ***        INDIKATOR   34 BRUKES FOR TVINN              ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
      *
     FSYPTFF    IF   E           K DISK
     FTRXREF    UF A E           K DISK
     FFRATXT    IF   E           K DISK
     FNCTSEH    UF A E           K DISK
     FNCTSEH10  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR10)
     FNCTSEC    IF A E           K DISK
     FNCTSEI    IF A E           K DISK
S10  F*CTSEIAM  IF A E           K DISK
     FNCTSECAM  IF A E           K DISK
     FTRUVCN    IF A E           K DISK
     FTRUVDK    IF A E           K DISK
     FTRUVFS    IF A E           K DISK
     FTRUVMN    IF A E           K DISK
     FTRUVTD    IF A E           K DISK
     FTRUVVT    IF A E           K DISK
     FNCTSESTD  UF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FTRUHL     UF A E           K DISK
     FTRUHGB    IF A E           K DISK
     FTRUHFS    IF A E           K DISK
     FTRUHGN    IF A E           K DISK
     FTRUGH     UF   E           K DISK
     FTRUGD     IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FTURER14   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FHEAD14    IF   E           K DISK    RENAME(HEADFR:HEADFR14)
     FKODTA     IF   E           K DISK
     FSAMLB     IF   E           K DISK
     FSAEH      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYPARL1   IF   E           K DISK
     FFRISOK    IF A E           K DISK
     FFRISOL01  IF   E           K DISK    RENAME(FRISOKR:FRISOKR1)
     FZNCTSEH1  UF   E           K DISK    RENAME(NCTSEHR:ZNCTSEHR)
     F                                     PREFIX(Z_)
     FEDIM1     UF   E           K DISK
     FEDIM4     IF   E           K DISK
     F                                     RENAME(EDIMR:EDIMR4)
     FKODTSI    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTS4    IF   E           K DISK
     FNCTS011D  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D AD              s             30
     D XAN02           s              2A
     D XAN02_1         s              2A
     D XAN02_2         s              2A
     D XAN02_3         s              2A
     D XAN02_4         s              2A
     D XAN02_5         s              2A
     D XAN02_6         s              2A
     D XAN02_7         s              2A
     D XAN02_8         s              2A
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  TUBILN                 1     10
     D  TUBIL8                 1      8
     D                 DS
     D  TUHENG                 1     10
     D  TUHEN8                 1      8
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTA                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  THDTA                  1      4  0
     D  THDTM                  5      6  0
     D  THDTD                  7      8  0
     D  THDT                   1      8  0
     D                 DS
     D  WSDDTD                 1      2  0
     D  WSDDTM                 3      4  0
     D  WSDDTA                 5      6  0
     D  WSDDT                  1      6  0
N07  D                 DS
N07  D  UWSDDTD                1      2  0
N07  D  UWSDDTM                3      4  0
N07  D  UWSDDTA                5      6  0
N07  D  UWSDDT                 1      6  0
N07  D                 DS
N07  D  W2DAT                  1      8  0
N07  D  W2DATY                 1      2  0
N07  D  W2DATA                 3      4  0
N07  D  W2DATM                 5      6  0
N07  D  W2DATD                 7      8  0
N07  D                 DS
N07  D  W3DAT                  1      8  0
N07  D  W3DATY                 1      2  0
N07  D  W3DATA                 3      4  0
N07  D  W3DATM                 5      6  0
N07  D  W3DATD                 7      8  0
     D                 DS
     D  THDDTA                 1      4  0
     D  THDDTM                 5      6  0
     D  THDDTD                 7      8  0
     D  THDDT                  1      8  0
     D                 DS
     D  WSTRDTD                1      2  0
     D  WSTRDTM                3      4  0
     D  WSTRDTA                5      6  0
     D  WSTRDT                 1      6  0
     D                 DS
     D  THTRDTA                1      4  0
     D  THTRDTM                5      6  0
     D  THTRDTD                7      8  0
     D  THTRDT                 1      8  0
     D*                DS
     D* WSDDTKD                1      2  0
     D* WSDDTKM                3      4  0
     D* WSDDTKA                5      6  0
     D* WSDDTK                 1      6  0
     D*                DS
     D* THDDTKA                1      4  0
     D* THDDTKM                5      6  0
     D* THDDTKD                7      8  0
     D* THDDTK                 1      8  0
     D                 DS
     D  WSEMC                  1     50
     D  WSEMC_40               1     40
     D                 DS
     D  HESG                   1      3
     D  SESG                   1      3
     D                 DS
     D  HEKNK                  1      8  0
     D  SEKNS                  1      8  0
     D                 DS
     D  HENAK                  1     30
     D  SENAS                  1     30
     D                 DS
     D  HEADK1                 1     30
     D  SEADS1                 1     30
     D                 DS
     D  HEADK3                 1     30
     D  SEADS3                 1     30
     D                 DS
     D  HEKNS                  1      8  0
     D  SEKNK                  1      8  0
     D                 DS
     D  HENAS                  1     30
     D  SENAK                  1     30
     D                 DS
     D  HEADS1                 1     30
     D  SEADK1                 1     30
     D                 DS
     D  HEADS3                 1     30
     D  SEADK3                 1     30
     D                 DS
     D  HEVKT                  3     11  0
     D  SEVKB                  1     11  0
     D                 DS
     D  HENT                   4     10  0
     D  SENTK                  1     10  0
      *
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  THAVD                  1      4  0
     D  THTDN                  5     11  0
     D  BLUR                  12     12
     D  UWS2                  13     22
     D  WSTVIN                23     23
     D  UIN27                 24     24
     D  UIN34                 25     25
     D  UIN36                 26     26
     D  THVKB                 27     39  3
     D  U1N07                 40     42
     D  THDK                  43     47
     D  THKDC                 48     48
     D  THALK                 49     50
     D  THBLK                 51     52
     D  WSPRO                 53     60  0
     D  WSLSTL                61     64  0
     D  U2REFF                65     81
     D  U2UNIK                82     90  0
     D  UPARM2                 1    128
      *
     C                   OPEN      NCTS011D
     C                   EXSR      INIT
     C     UTYPE         CABEQ     'DSP'         START1
     C     UTYPE         CABEQ     'NOT'         START2
      *...............................................
      * BILDE-1 INNLESING AV OPDNR./TARIFFØR OSV.
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C  N30
     CANN31              Z-ADD     10            LINNBR
     C  N30
     CAN 31              Z-ADD     9             LINNBR
     C  N30UTYPE         IFEQ      'CPY'
     C                   Z-ADD     13            LINNBR
     C                   END
     C  N30              Z-ADD     34            POSNBR
     C  N30WSSG          IFEQ      *BLANKS
     C                   Z-ADD     9             LINNBR
     C                   END
     C                   EXFMT     NCTS011D01
     C                   MOVEA     '00'          *IN(98)
     C                   MOVEA     '00'          *IN(95)
     C                   MOVE      '0'           *IN30
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START
     C                   END
     C   12              GOTO      SLUTT
      *
     C     START1        TAG
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C   04UFLAGG        CABEQ     1             START
      *
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *BLANKS       WSTRNR
     C                   MOVE      *BLANKS       WSTRDT
     C                   MOVE      *ZEROS        WSDDT
N03  C                   MOVE      *ZEROS        WSGBL
N03  C                   MOVE      *BLANKS       WSGVK
     C                   END
      *===============================================
      *
      *...............................................
      * BILDE-2 INNLESING AV HOVED OPPLYSNINGER AV SAD
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START2        TAG
     C  N30              Z-ADD     2             LINNBR
     C  N30              Z-ADD     10            POSNBR
     C     ST21          TAG
      *
     C                   EXSR      TSTOPL
      *
     C                   EXFMT     NCTS011D02
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '000000000000'*IN(76)
     C                   MOVEA     '000000000000'*IN(64)
     C                   MOVEA     '000000000000'*IN(52)
     C                   MOVEA     '00'          *IN(50)
     C                   MOVE      '0'           *IN30
      *
      *  04 = SØK AVSENDER/MOTTAKER/HOVEDANSVARLIG
     C   04              DO
     C                   EXSR      SOKDT2
     C                   GOTO      ST21
     C                   END
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START2
     C                   END
      *
      *  10 = SE OPPLYSNIGER OM GODKJENNELSE FRA TOLLVESENET (KUN KOMMUNIKASJON)
     C   10              DO
     C                   EXSR      VISTOL
     C                   GOTO      START2
     C                   END
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL TR011D01
     C   12              DO
      *
     C                   IF        UTYPE = 'NOT'
      * AVBRYT PÅ IE170
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
      *
     C     UTYPE         IFNE      'DSP'
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C*                  IF        THTRNR = *BLANKS
     C*                  MOVE      ' '           THST
     C*                  ELSE
     C*                  MOVE      'U'           THST
     C*                  END
     C                   MOVE      X_THST        THST
     C  N33              UPDATE    NCTSEHR
     C                   END
     C     UTYPE         IFEQ      'CR2'
     C                   MOVE      *ZEROS        WSTDN
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      SLUTT
     C                   END
     C                   END
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START2
     C                   END
      *
     C   15UTYPE         IFEQ      'DSP'
     C                   EXSR      TILKOD
     C                   GOTO      START2
     C                   END
      *
     C     UTYPE         IFEQ      'DSP'
     C                   GOTO      START3
     C                   END
      *
      * ----------- T E S T   B I L D E 0 2 ----------
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      *
      * TEST OM GARANTITYPE PASSER PROSEDYRE
     C*                  IF        WSDK='ENTRY' OR WSDK='EXIT'
     C*                  EVAL      WSGKD = '7'
     C*                  ELSE
     C                   IF        ((WSENKL = 'J') AND (WSGKD > '1'))
     C                   MOVE      'J'           WSJN
     C                   EXFMT     NCTS011D04
     C     WSJN          CABEQ     'N'           START2
     C                   MOVE      'N'           WSENKL
     C                   END
     C*                  END
      *
      * ----- INGEN FEIL HITTIL     OPPDATER TRUH -----
     C                   EXSR      OPDNCTSEH
      *
     C                   IF        UTYPE = 'NOT'
     C                   MOVE      'J'           WSTOLK
     C                   MOVE      'N'           WSTVIN
     C                   MOVE      '1'           UIN34
     C                   MOVE      '170'         U1N07
     C                   CALL      'NCTS012RT'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C*  15              GOTO      START2
      *
      *===============================================
      *
     C     START3        TAG
      *
      * ETA og tid ved transit
     C                   IF        WSSECU > 0 OR *IN15 OR THETA1 <> 0
     C                             OR THPDTY <> *BLANKS OR THSDTY <> *BLANKS
     C                             OR THTDTY <> *BLANKS OR THADTY <> *BLANKS
     C                             OR THAICD <> *BLANKS
     C                   CALL      'NCTS011RA'
     C                   PARM                    UAVD
     C                   PARM      WSTDN         UTDN
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C                   IF        UFLAGG = 1
     C                   GOTO      START2
     C                   END
     C                   END
      *
      * Til HouseConsignment
     C                   EXSR      TONCTSEC
     C   12              GOTO      START2
     C     UTYPE         IFEQ      'CR2'
     C     *IN17         OREQ      '1'
     C                   MOVE      *ZEROS        WSTDN
     C  N03              DO
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *ZEROS        WSNTK
     C                   MOVE      *ZEROS        WSVKB
     C                   MOVE      *BLANKS       WSTRNR
     C                   MOVE      *BLANKS       WSTRDT
     C                   GOTO      START2
     C                   END
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     *IN12         IFEQ      '1'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     0             UFLAGG
     C                   END
     C                   CLOSE     NCTS011D
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
     C***********************************************
     C     TILKOD        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     14
     C     POSNBR        ANDLE     37
     C     *IN35         IFEQ      '1'
     C     WSGKD         OREQ      '2'
     C     WSGKD         OREQ      '4'
     C                   CALL      'TR025R'
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSGFT1
     C                   PARM                    WSGADK
     C*                  PARM                    WSGBGI
     C*                  PARM                    WSGBGU
     C                   PARM                    WSGBL
     C                   PARM                    WSGVK
     C                   PARM                    UTYPE
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C                   MOVE      WSGFT1        THGFT1
     C                   MOVE      WSGADK        THGADK
     C                   UPDATE    NCTSEHR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SOKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * DEKLARASJONSTYPE
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      '031'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSDK          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDK
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
      * DEKLARASJONSTYPE TILLEGG
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     17
     C                   MOVE      '942'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSDKT         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDKT
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
      * AUTORISATION TYPE
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     29
     C                   MOVE      '235'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSATYP        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSATYP
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * AVGANGSTOLLSTED
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     16
     C     POSNBR        ANDLE     23
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSCATS        UKODE
     C                   MOVE      'AVG'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSCATS
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * BESTEMMELSESTEDS TOLLSTED
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     36
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   MOVEL     WSTSB         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSB
     C                   Z-ADD     46            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-1
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     53
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD1        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD1
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-2
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     62
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD2        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD2
     C                   Z-ADD     64            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-3
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     64
     C     POSNBR        ANDLE     71
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD3        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD3
     C                   Z-ADD     73            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-4
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     73
     C     POSNBR        ANDLE     80
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD4        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD4
     C                   Z-ADD     82            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-5
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     82
     C     POSNBR        ANDLE     89
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD5        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD5
     C                   Z-ADD     91            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-6
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     91
     C     POSNBR        ANDLE     98
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD6        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD6
     C                   Z-ADD     100           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-7
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     100
     C     POSNBR        ANDLE     107
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD7        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD7
     C                   Z-ADD     109           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-8
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     109
     C     POSNBR        ANDLE     116
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTSD8        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD8
     C                   Z-ADD     127           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Betalingsmåte
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     127
     C     POSNBR        ANDLE     127
     C                   MOVE      '116'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTRCH        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTRCH
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * HOLDER
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNH
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     46            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Secureity
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     95
     C     POSNBR        ANDLE     95
     C                   MOVE      '217'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSSECU        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSECU
     C                   Z-ADD     103           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Reduced dataset indicator
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     103
     C     POSNBR        ANDLE     103
     C                   MOVE      '027'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSRDIN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSRDIN
     C                   Z-ADD     111           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Specific circumstance indicator
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     111
     C     POSNBR        ANDLE     113
     C                   MOVE      '296'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSSCIN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSCIN
     C                   Z-ADD     121           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Communication language at departure
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     121
     C     POSNBR        ANDLE     122
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSCLKD        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSCLKD
     C                   Z-ADD     130           POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Binding itinerary
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     130
     C     POSNBR        ANDLE     130
     C                   MOVE      '027'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSBINI        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSBINI
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * HOLDERS LANDKODE
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKH
     C                   PARM                    USPED
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * HOVEDANSVARLIGNR
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNA
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Garanti type
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDEQ     12
     C                   MOVE      '251'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSGKD         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGKD
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ADGANGSKODE FOR GARANTI
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     78
     C                   IF        WSGFT1 <> *BLANKS
     C                   CALL      'TR034R'
     C                   PARM                    WSGFT1
     C                   PARM                    WSGADK
     C                   ELSE
     C                   MOVE      '105'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSGADK        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGADK
     C                   END
     C                   Z-ADD     91            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     123
     C     POSNBR        ANDLE     125
     C                   MOVE      WDT           UDT               8 0
     C                   CALL      'SAD061F'
     C                   PARM                    WSGVK
     C                   PARM                    UDT
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * AVSENDERSLANDKODE
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   CALL      'SYFI10L'
     C                   PARM                    WSALK
     C                   PARM                    USPED
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * BESTEMMELESLANDKODE
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     24
     C                   CALL      'SYFI10L'
     C                   PARM                    WSBLK
     C                   PARM                    USPED
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Inland mode of transport
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     57
     C     POSNBR        ANDLE     57
     C                   MOVE      '218'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTMIN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTMIN
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Mode of transport at the border
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     59
     C     POSNBR        ANDLE     59
     C                   MOVE      '218'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTMGR        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTMGR
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORTØR
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNC
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * AVSENDERSNR
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *søk vareadresse avsender
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     46
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNS
     C                   PARM                    WSNAS
     C                   PARM                    WSAD1S
     C                   PARM                    WSAD2S           30
     C                   PARM                    WSAD3S           30
     C                   PARM                    WSLKS
     C                   PARM                    UADRNR            5
     C     wsnas         IFNE      *blanks
     c                   move      wsad3S        ad
     c     ' '           scan      ad            f                 2 0
     c     f             ifgt      9
     c                   eval      wspss=wsad3s
     c                   else
     c                   eval      wspns = %SUBST(ad:1:f-1)
     c                   eval      wspss = %SUBST(ad:f+1:30-f-1)
     c                   move      '.'           wspss
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   END
     C                   END
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL AVSENDER
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKS
     C                   PARM                    USPED
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * MOTTAKERSNR
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNK
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *søk vareadresse mottager
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     46
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNK
     C                   PARM                    WSNAK
     C                   PARM                    WSAD1K
     C                   PARM                    WSAD2K           30
     C                   PARM                    WSAD3K           30
     C                   PARM                    WSLKK
     C                   PARM                    UADRNR            5
     C     wsnaK         IFNE      *blanks
     c                   move      wsad3K        ad
     c     ' '           scan      ad            f                 2 0
     c     f             ifgt      9
     c                   eval      wspsK=wsad3k
     c                   else
     c                   eval      wspnk = %SUBST(ad:1:f-1)
     c                   eval      wspsk = %SUBST(ad:f+1:30-f-1)
     c                   move      '.'           wspsk
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   END
     C                   END
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL MOTTAKER
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKK
     C                   PARM                    USPED
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ADDITIONAL SUPPLY CHAIN ACTOR: Role
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     14
     C                   MOVE      '704'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSROLE        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSROLE
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LOCATION OF GOODS: Type of location
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     9
     C     POSNBR        ANDLE     9
     C                   MOVE      '347'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLGTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLGTY
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LOCATION OF GOODS: Qualifier of identification
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     13
     C                   MOVE      '326'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLGID        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLGID
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LOCATION OF GOODS: UN LOCODE
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     66
     C     POSNBR        ANDLE     82
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLGUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLGUN
     C                   Z-ADD     87            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TIL TILLEGGS UN
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     87
     C     POSNBR        ANDLE     94
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSLGTS        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSLGTS
     C                   Z-ADD     96            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ØKONOMI
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNE
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL ØKONOMI HUSNR
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     81
     C     POSNBR        ANDLE     82
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKE2
     C                   PARM                    USPED
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     48            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL ØKONOMI GATEADRESSE
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKE
     C                   PARM                    USPED
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORTTYPE
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C*                  CALL      'SAD061I'
     C*                  PARM                    WSTRM
     C                   MOVE      '750'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTRM         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTRM
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     66
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTALK
     C                   PARM                    USPED
     C                   Z-ADD     75            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 1
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     76
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR1
     C                   PARM                    USPED
     C                   Z-ADD     78            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 2
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR2
     C                   PARM                    USPED
     C                   Z-ADD     81            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 3
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     81
     C     POSNBR        ANDLE     82
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR3
     C                   PARM                    USPED
     C                   Z-ADD     84            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 4
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     84
     C     POSNBR        ANDLE     85
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR4
     C                   PARM                    USPED
     C                   Z-ADD     87            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 5
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     87
     C     POSNBR        ANDLE     88
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR5
     C                   PARM                    USPED
     C                   Z-ADD     90            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 6
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     90
     C     POSNBR        ANDLE     91
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR6
     C                   PARM                    USPED
     C                   Z-ADD     23            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TIL AKTIV GRENSE
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     32
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTGTS        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTGTS
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORTTYPE
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     39
     C     POSNBR        ANDLE     40
     C                   MOVE      '219'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTRMG        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTRMG
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED GRENSE
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     84
     C     POSNBR        ANDLE     85
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTGLK
     C                   PARM                    USPED
     C                   Z-ADD     94            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * PLACE OF LOADING
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     24
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLSUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLSUN
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL LASTESTED
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     27
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLSLK
     C                   PARM                    USPED
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * PLACE OF UNLOADING
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     71
     C     POSNBR        ANDLE     87
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLOUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLOUN
     C                   Z-ADD     89            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL LOSSESTED
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     89
     C     POSNBR        ANDLE     90
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLOLK
     C                   PARM                    USPED
     C                   Z-ADD     92            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * KONTROLL RESULTAT
     C*    LINNBR        IFEQ      25
     C*    POSNBR        ANDGE     13
     C*    POSNBR        ANDLE     14
     C*                  MOVE      '047'         UUNIK
     C*                  MOVE      *BLANKS       UKODE
     C*                  MOVEL     WSDKR         UKODE
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK
     C*                  PARM                    UKODE
     C*                  PARM                    UTYPE2
     C*                  MOVEL     UKODE         WSDKR
     C*                  Z-ADD     27            POSNBR
     C*                  END
      * EXIT FOR TOLLSTED
     C     LINNBR        IFEQ      25
     C     POSNBR        ANDGE     45
     C     POSNBR        ANDLE     52
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   MOVEL     WSTSDE        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSDE
     C                   GOTO      SLSOK
     C                   Z-ADD     54            POSNBR
     C                   END
      * EXIT FOR TOLLSTED 2
     C     LINNBR        IFEQ      25
     C     POSNBR        ANDGE     54
     C     POSNBR        ANDLE     61
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   MOVEL     WSTSDE2       UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSDE2
     C                   GOTO      SLSOK
     C                   Z-ADD     54            POSNBR
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSOK         ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        Z_THUNIK
     C                   MOVE      *BLANKS       Z_THREFF
      *
      * henter fra eksterref
      *
     C   04              IF        LINNBR = 8
     C                   CALL      'SYGE47R'
     C                   PARM      'B'           UHEUR             1
     C                   PARM                    WSEXTR
     C                   EVAL      *IN04=*OFF
     C                   IF        WSEXTR = *BLANKS
     C                   EVAL      *IN30=*ON
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      * EKSTEN REFERANSE
     C                   IF        ((UTYPE <> 'CPY') AND (WSEXTR <> *BLANKS))
     C     FRISOL01K     CHAIN     FRISOL01                           33
     C                   DOW       *IN33 = *OFF
     C     NCTSEHKFRI    CHAIN(N)  NCTSEH                             33
     C                   IF        *IN33 = *OFF
     C                   MOVE      FSOPD         WSTDN
     C                   MOVE      FSAVD         UAVD
     C                   LEAVE
     C                   END
     C     FRISOL01K     READE     FRISOL01                               33
     C                   ENDDO
      * Ny ekstern ref  - hent data
     C                   move      'N'           EXTMAN            1
     C   33              IF        THEKST = 'J'
     C     FRISOL01K2    CHAIN     FRISOL01                           33
     C     *in33         ifeq      '0'
     C                   move      fsopd         UXOPD
     C                   move      'M'           EXTMAN
     c                   ELSE
     C                   MOVE      *ZEROS        UXOPD             7 0
     C                   CALL      'SADEXT'
     C                   PARM                    UAVD
     C                   PARM                    WSEXTR
     C                   PARM                    UXOPD
     C                   PARM                    WSSG
     C                   end
     C                   MOVE      UXOPD         WSTDN
     C                   IF        WSTDN = 0
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'SHU1172'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
     C                   END
      *** TEST AVDELING
     C     UAVD          CHAIN(N)  NCTSESTD                           95
     C  N95              DO
     C                   MOVE      *BLANKS       THST
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *ZEROS        THDDT
N06  C                   MOVE      *BLANKS       THLIDT
     C                   END
     C   95              DO
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTB1
     C                   END
      *** TEST TARIFFØR
     C                   IF        UTYPE <> 'DSP'
     C     KODTSIK       CHAIN     KOSIR                              99
     C   99              DO
     C                   MOVE      'SPS0001'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
      *** TEST OM TASTET TOLLDEKNR. ER RIKTIG
      * WSTDN = 0  --> HENT STANDARD SAD-OPPLYSNINGER
     C     UTYPE         IFEQ      'CPY'                                        1<-B
     C     NCTSEHKK      CHAIN(N)  NCTSEH                             33
     C                   ELSE                                                   1
     C     WSTDN         IFNE      0                                             2<-B
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C  N33UTYPE         IFEQ      'DSP'                                          3<-B
     C                   UPDATE    NCTSEHR
     C                   GOTO      STTB1
     C                   END                                                      3<-E
      * THST = ' ' --> ÅPEN TRANSITTERING
      *        'A' --> HOLD PÅ Å SENDE UT
      *        'B' --> SENDT TIL IBM
      *        'C' --> SENDT TIL TOLLVESENET
      *        'c' --> SENDT TIL TOLLVESENET OG FÅTT IE928
      *        'D' --> KANSELLERT
      *        'E' --> HOLD PÅ Å BLI ENDRET
      *        'F' --> MELDING OM INGEN FRIGIVELSE
      *        'K' --> VENT PÅ Å BLI UTSKREVET
      *        'M' --> FEILMELDING FRA TOLLVESENET
      *        'P' --> UTSKREVET
      *        'S' --> MELDING OM AVVIST FRIGIVELSE
      *        'U' --> HAR FÅTT MRN-NUMMER
      *        'V' --> VAREKONTROLL
      *        'Z' --> TRANSITT AVSLUTTET
     C  N33THST          IFNE      ' '                                            3<-B
     C     THST          ANDNE     'K'
     C     THST          ANDNE     'M'
     C     THST          ANDNE     'c'
     C     THST          COMP      'P'                                9898
     C   98THST          COMP      'U'                                9898
     C   98THST          COMP      'Q'                                9898
     C   98THST          COMP      'F'                                9898
     C                   END                                                      3<-E
     C  N33
     CANN98THST          IFEQ      'A'                                            3<-B
     C     THWS          COMP      UWS                                9898
     C                   END                                                      3<-E
      *
     C  N33
     CANN98              DO                                                       3<-B
     C                   EXSR      TSTM
     C   98              UPDATE    NCTSEHR
     C   98              GOTO      SLTB1
     C                   END                                                      3<-E
      *
     C                   IF        *IN33 = *OFF AND *IN98 = *OFF
     C                   MOVE      THST          X_THST            1
     C                   ELSE
     C                   MOVE      ' '           X_THST
     C                   END
      *
     C  N33
     CANN98              MOVE      'E'           THST
     C  N33              UPDATE    NCTSEHR
     C   33HEADFK        CHAIN     HEADF                              98
     C   33
     CAN 98HEADFK        CHAIN     SAEH                               98
      *
     C   98              DO                                                       3<-B
     C                   MOVE      'SPT0028'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * TEST OM DET SKAL SENDES PÅ TVINN  (34 ON = DENNE SENDES TVINN)
     C     WSTOLK        COMP      'J'                                    34
      *
      *  04 = PLUKK FRA Z-FIL
     C                   MOVE      *ZEROS        UZAVD             4 0
     C                   MOVE      *ZEROS        UZTDN             7 0
     C                   MOVE      *BLANKS       UZREFF           17
     C                   MOVE      *ZEROS        UZUNIK            9 0
     C  N30              IF        *IN04
     C                   CALL      'NCTS011RB'
     C                   PARM                    FIFIRM
     C                   PARM                    UZAVD
     C                   PARM                    UZTDN
     C                   PARM                    UZREFF
     C                   PARM                    UZUNIK
     C                   PARM                    UFLAGG
     C     UFLAGG        CABEQ     1             SLTB1
     C                   IF        UZREFF <> *BLANKS
     C                   EVAL      WSSOK = UZREFF
     C                   END
     C                   END
      *
      *** HENT OPPLYSNINGER FRA HEADF/DOKUF
     C  N30
     CAN 33              MOVE      WSTDN         UTDN
     C  N30
     CAN 33              EXSR      SRU1
      *
      *** FLYTT DATA FRA FIL-VARIABLER TIL WS-VARIABLER
     C     STTB1         TAG
     C  N30              EXSR      MOVW2
      *
     C  N30              IF        (*IN04 OR (Z_THREFF <> *BLANKS))
     C                   EXSR      HZFIL
     C                   END
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     TSTM          BEGSR
     C***********************************************
      *
      * Test om det finnes sending i "postkasse"
     C     TVINMK        SETGT     EDIM1
     C     STTSTM        TAG
     C     TVINMK        READPE    EDIM1                                  98
     C  N98MSR           IFEQ      'S'
     C     M1001         ANDEQ     'TET'
     C   10              DELETE    EDIMR
     C   10              GOTO      SLTSTM
     C                   UPDATE    EDIMR
     C                   MOVE      'SPT0043'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   ELSE
     C                   UPDATE    EDIMR
     C                   GOTO      STTSTM
     C                   END
      *
      * Test om det har fått transitteringsnr
     C     TVIM4K        SETLL     EDIM4                              98
     C     STTST2        TAG
     C     TVI41K        READPE    EDIM4                                  98
     C  N98MST           IFEQ      'D'
     C     M1001         ORNE      'TET'
     C                   GOTO      STTST2
     C                   ELSE
     C*    M1N07         IFEQ      '028'
     C*    M1N07         OREQ      '029'
     C     M1N07         IFEQ      '029'
     C                   MOVE      'YBC0819'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   END
     C                   END
     C                   MOVE      '0'           *IN98
      *
     C     SLTSTM        ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
      *
N02  C                   IF        WSDK = 'ENTRY' OR WSDK = 'EXIT'
N02  C                   MOVE      'N'           WSENKL
N02  C                   EVAL      WSATYP = *BLANKS
N02  C                   EVAL      WSAREF = *BLANKS
N02  C                   IF        WSTSD1 = *BLANKS
N02  C                   EVAL      WSTSD1 = WSCATS
N02  C                   END
N02  C                   EVAL      WSTSB  = WSCATS
N02  C                   IF        WSSECU = 0
N02  C                   SELECT
N02  C                   WHEN      WSDK = 'ENTRY'
N02  C                   EVAL      WSSECU = 1
N02  C                   WHEN      WSDK = 'EXIT'
N02  C                   EVAL      WSSECU = 2
N02  C                   ENDSL
N02  C                   END
N02  C                   END
      * Tur
     C     WSPRO         IFNE      0
     C     WSLSTL        ORGT      0
     C     WSENKL        ANDEQ     'N'
     C     WSPRO         CHAIN     TURER14                            99
     c  n99tubiln        ifeq      *blanks
     c                   movel     tuheng        tubiln
     c                   end
     C   99              IF        WSDK='ENTRY' OR WSDK='EXIT'
     C     WSPRO         CHAIN     HEAD14                             99
     C  N99              IF        ((WSKNS = 0) AND (WSNAS = *BLANKS))
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        WSKNS
     C                   EXSR      TESTS
     C                   END
     C  N99              IF        ((WSKNK = 0) AND (WSNAK = *BLANKS))
     C                   MOVEL     HESAML        SMSD
     C                   MOVE      HESAML        SMLNR
     C     SAMLBK        CHAIN     SAMLB                              33
     C  N33              MOVE      SMKNS         WSKNK
     C                   EXSR      TESTK
     C                   END
     C                   END
     C   99              MOVE      'SPT0017'     MSGNR
     C   99              EVAL      *IN30 = *ON
     C     *IN99         IFEQ      '0'
     C     WSKNK         IFEQ      0
     C     WSNAK         ANDEQ     *BLANKS
     C                   MOVE      TUKNA         WSKNK
     C                   END
     C     WSTAID        IFEQ      *BLANKS
     C                   MOVEL     TUBILN        WSTAID
     C                   MOVEL     TULK          WSTALK
     C                   END
     C     WSTGID        IFEQ      *BLANKS
     C                   MOVEL     TUBILN        WSTGID
     C                   END
     C     WSTRM         IFEQ      0
     C                   MOVE      TUTRMA        WSTRM
     C                   END
     C     WSTRMG        IFEQ      0
     C                   MOVE      TUTRMA        WSTRMG
     C                   END
     C                   END
     C                   END
      * Deklarsjonstype
     C*                  IF        UIE = 'I'
     C*    WSDK          COMP      'ENTRY'                            9898
     C*  98WSDK          COMP      'EXIT'                             9898
     C*                  ELSE
     C                   MOVE      '031'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDK          YKODE
     C     TRK01K        CHAIN     TRKODL01                           98
     C*                  END
      *
     C  N30              IF        WSDKT = *BLANKS
     C                   EVAL      LINNBR = 2
     C                   EVAL      POSNBR = 17
     C                   EVAL      *IN30 = *ON
     C                   GOTO      SLTB02
     C                   END
     C   98
     CANN30              MOVE      'YBC0809'     MSGNR
     C   98              EVAL      *IN30 = *ON
      * Kode til autorisasjon
     C                   IF        WSRDIN = 1 OR WSATYP <> *BLANKS
     C                             OR WSENKL = 'J'
     C                   MOVE      '235'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSATYP        YKODE
     C     TRK01K        CHAIN     TRKODL01                           97
     C  N30              IF        *IN97
     C                   MOVE      'YBC2129'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Autorisasjonsreferanse
     C                   IF        WSRDIN = 1 OR WSATYP <> *BLANKS
     C                             OR WSENKL = 'J'
     C     WSAREF        COMP      *BLANKS                                96
     C  N30              IF        *IN96
     C                   MOVE      'YBC2130'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
N11   *Aut skal ikke fylles ut ved normalprosedyre
N11  C                   IF        WSENKL = 'N'
N11  C                   IF        WSATYP <> *BLANKS
N11  C                   EVAL      *IN30=*ON
N11  C                   EVAL      *IN97=*ON
N11  C                   MOVE      'CBA0510'     MSGNR
N11  C                   ENDIF
N11  C                   IF        WSAREF <> *BLANKS
N11  C                   EVAL      *IN30=*ON
N11  C                   EVAL      *IN96=*ON
N11  C                   MOVE      'CBA0510'     MSGNR
N11  C                   ENDIF
N11  C                   ENDIF
      *
     C*    WSENKL        IFEQ      'J'
     C*    WSLSTL        ANDGT     0
     C* N30              MOVE      'YBC1734'     MSGNR
     C*                  EVAL      *IN95 = *ON
     C*                  EVAL      *IN30 = *ON
     C*                  END
      * Avgangs tollsted
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSCATS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           94
     C   94
     CANN30              MOVE      'YBC1768'     MSGNR
     C   94              EVAL      *IN30 = *ON
      * Bestemmelse tollsted
     C                   IF        WSTSB = *BLANKS
     C     SYPARL1K      CHAIN     SYPARL1                            33
     C  N33              EVAL      WSTSB = SYVRDA
     C                   END
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSB         YKODE
     C     TRK01K        CHAIN     TRKODL01                           93
     C  N93TKANK         COMP      'J'                                9393
     C   93
     CANN30              MOVE      'YBC1768'     MSGNR
     C   93              EVAL      *IN30 = *ON
      * Tollsteder i rute
     C                   IF        WSTSD1 <> *BLANKS
     C                             OR %SUBST(WSCATS:1:2) <> %SUBST(WSTSB:1:2)
     C                             OR WSDK = 'T2' OR WSDK = 'T'
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD1        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 46
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD2 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD2        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 55
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD3 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD3        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 64
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD4 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD4        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 73
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD5 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD5        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 82
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD6 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD6        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 91
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD7 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD7        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 100
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTSD8 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD8        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C                   IF        *IN92 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 109
     C                   MOVE      'YBC1768'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * R0006: Må minst en transittollsted fra samme land som land til destinasjonstollsted
     C  N92              IF        WSTSD1 <> *BLANKS OR WSTSD2 <> *BLANKS OR
     C                             WSTSD3 <> *BLANKS OR WSTSD4 <> *BLANKS OR
     C                             WSTSD5 <> *BLANKS OR WSTSD6 <> *BLANKS OR
     C                             WSTSD7 <> *BLANKS OR WSTSD8 <> *BLANKS
     C                   EVAL      XAN02 = %SUBST(WSTSB:1:2)
     C                   EVAL      XAN02_1 = %SUBST(WSTSD1:1:2)
     C                   EVAL      XAN02_2 = %SUBST(WSTSD2:1:2)
     C                   EVAL      XAN02_3 = %SUBST(WSTSD3:1:2)
     C                   EVAL      XAN02_4 = %SUBST(WSTSD4:1:2)
     C                   EVAL      XAN02_5 = %SUBST(WSTSD5:1:2)
     C                   EVAL      XAN02_6 = %SUBST(WSTSD6:1:2)
     C                   EVAL      XAN02_7 = %SUBST(WSTSD7:1:2)
     C                   EVAL      XAN02_8 = %SUBST(WSTSD8:1:2)
     C                   IF        WSTSD1 <> *BLANKS AND XAN02 = XAN02_1 OR
     C                             WSTSD2 <> *BLANKS AND XAN02 = XAN02_2 OR
     C                             WSTSD3 <> *BLANKS AND XAN02 = XAN02_3 OR
     C                             WSTSD4 <> *BLANKS AND XAN02 = XAN02_4 OR
     C                             WSTSD5 <> *BLANKS AND XAN02 = XAN02_5 OR
     C                             WSTSD6 <> *BLANKS AND XAN02 = XAN02_6 OR
     C                             WSTSD7 <> *BLANKS AND XAN02 = XAN02_7 OR
     C                             WSTSD8 <> *BLANKS AND XAN02 = XAN02_8
     C                   ELSE
     C*                  EVAL      *IN92 = *ON
     C*                  IF        *IN30 = *OFF
     C*                  EVAL      LINNBR = 3
     C*                  EVAL      POSNBR = 46
     C*                  MOVE      'YBC2272'     MSGNR
     C*                  EVAL      *IN30 = *ON
     C*                  END
     C                   END
     C                   END
      * Method of payment
     C                   IF        WSSECU = 0
     C                   EVAL      WSTRCH = *BLANKS
     C                   ELSE
     C                   IF        WSTRCH <> *BLANKS
     C                   MOVE      '116'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTRCH        YKODE
      * Indikator er ikke valgt ennå.
     C     TRK01K        CHAIN     TRKODL01                           33
     C                   IF        *IN33 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 3
     C                   EVAL      POSNBR = 127
     C                   MOVE      'YBC2257'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      * TIR id
     C                   IF        WSDK = 'TIR'
      * Indikator er ikke valgt ennå.
     C     WSTIRH        COMP      *BLANKS                                33
     C                   IF        *IN33 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 46
     C                   MOVE      'YBC2258'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * TIR Carnet nr
     C                   IF        WSDK = 'TIR'
      * Indikator er ikke valgt ennå.
     C     WSTIRN        COMP      *BLANKS                                33
     C                   IF        *IN33 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 76
     C                   MOVE      'YBC2259'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Holder
     C                   IF        WSKNH <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNH
     C     CUND1K        CHAIN     CUNDL01                            91
     C                   IF        *IN91                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 4
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINH = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINH = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINH = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINH = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAH  = KNAVN
     C                   EVAL      WSAD1H = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNH  = *BLANKS
     C                   MOVEL     POSTNR        WSPNH
     C                   ELSE                                                     3
     C                   EVAL      WSPNH  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSH  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKH  = SYLAND
     C                   END                                                      3<-E
     C*                  IF        WSCPH = *BLANKS                                3<-B
     C                   EVAL      WSCPH  = KPERS
     C*                  END                                                      3<-E
     C*                  IF        WSTLH = *BLANKS                                3<-B
     C                   EVAL      WSTLH  = TLF
     C*                  END                                                      3<-E
     C*                  IF        WSEMH = *BLANKS                                3<-B
     C                   EVAL      WSEMH  = SYEPOS
     C*                  END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN91 = *OFF                                 1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINH:1:2)
     C     KODS2K        CHAIN     KODTS2                             91
     C                   IF        *IN91 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END                                                    1<-E
      *
     C     WSNAH         COMP      *BLANKS                                90
     C   90
     CANN30              MOVE      'YBC2132'     MSGNR
     C   90              EVAL      *IN30 = *ON
      *
     C     WSPNH         COMP      *BLANKS                                89
N01  C  N89              IF        %SUBST(WSPNH:10:8) <> *BLANKS
N01  C                   EVAL      *IN89 = *ON
N01  C                   END
     C   89
     CANN30              MOVE      'YBC2133'     MSGNR
     C   89              EVAL      *IN30 = *ON
      *
     C     WSPSH         COMP      *BLANKS                                88
     C   88
     CANN30              MOVE      'YBC2134'     MSGNR
     C   88              EVAL      *IN30 = *ON
      *
     C                   MOVE      WSLKH         KS2LK
     C     KODS2K        CHAIN     KODTS2                             87
     C   87
     CANN30              MOVE      'SPL0001'     MSGNR
     C   87              EVAL      *IN30 = *ON
      * Representative
     C                   IF        WSKNA <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNA
     C     CUND1K        CHAIN     CUNDL01                            86
     C                   IF        *IN86                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINA = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINA = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINA = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINA = EORI
     C                   ENDSL                                                     4<-E
     C*                  IF        WSCPA = *BLANKS                                 4<-B
     C                   EVAL      WSCPA  = KPERS
     C*                  END                                                       4<-E
     C*                  IF        WSTLA = *BLANKS                                 4<-B
     C                   EVAL      WSTLA  = TLF
     C*                  END                                                       4<-E
     C*                  IF        WSEMA = *BLANKS                                 4<-B
     C                   EVAL      WSEMA  = SYEPOS
     C*                  END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * Representative ID
     C                   IF        WSKNA <> 0                                   1<-B
     C     WSTINA        COMP      *BLANKS                                85
     C  N30              IF        *IN85
     C                   MOVE      'YBC2131'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END                                                    1<-E
      *
     C                   IF        WSDK='ENTRY' OR WSDK='EXIT'                  1<-B
     C*                  EVAL      WSGKD  = '7'
N02  C                   EVAL      WSGKD  = 'A'
     C                   EVAL      WSGFT1 = *BLANKS
     C                   EVAL      WSGFT2 = *BLANKS
     C                   EVAL      WSGADK = *BLANKS
     C                   EVAL      WSGBL  = *ZEROS
     C                   EVAL      WSGVK  = *BLANKS
      *
     C                   ELSE                                                   1
      *
     C                   MOVE      *ZEROS        XGGBLR           11 0
     C     WSGFT1        IFEQ      *BLANKS                                       2<-B
     C*    WSGFT2        COMP      *BLANKS                                66
     C*  66
     C*NN30              MOVE      'YBC0838'     MSGNR
     C*  66              EVAL      *IN30 = *OFF
      *
     C                   IF        WSGKD = '0' OR WSGKD = '1' OR WSGKD = '2' OR   3<-B
     C                             WSGKD = '4' OR WSGKD = '9' OR
     C                             WSGADK <> *BLANKS
     C                   MOVE      '105'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSGADK        YKODE
     C     TRK01K        CHAIN     TRKODL01                           83
     C   83
     CANN30              MOVE      'YBC0811'     MSGNR
     C   83              SETON                                        30
     C                   END                                                      3<-E
      *
     C                   ELSE                                                    2
      *
     C                   IF        WSGKD = '2' OR WSGKD = '4'                     3<-B
     C     WSGADK        COMP      *BLANKS                                83
     C   83
     CANN30              MOVE      'YBC0811'     MSGNR
     C   83              EVAL      *IN30 = *ON
     C                   ELSE                                                     3
     C                   MOVE      *BLANKS       WSGFT2
     C     WSGFT1        CHAIN(N)  TRUGH                              84
     C  N84TGST          COMP      'S'                                    84
     C  N84              IF        TGGTY >= 6                                      4<-B
     C                   Z-ADD     0             XSGBL2           11 0
     C                   EVAL      XSGBL2 = TGGBL - TGGBLB + XSGBL - WSGBL
     C     XSGBL2        COMP      0                                    84
     C                   END                                                       4<-E
     C                   IF        *IN84                                           4<-B
     C  N30              MOVE      'YBC1900'     MSGNR
     C  N30              EVAL      *IN30 = *ON
     C                   ELSE                                                      4
     C                   MOVE      TGGTY         WSGKD
     C                   EVAL      XGGBLR = TGGBL - TGGBLB + XSGBL
     C                   MOVE      TGGVK         WSGVK
     C                   IF        ((WSGADK <> TGAKNY) OR (WSGADK = *BLANKS))       5<-B
     C     TRUGDK        CHAIN     TRUGD                              83
     C   83
     CANN30              MOVE      'YBC0811'     MSGNR
     C   83              EVAL      *IN30 = *ON
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      * Garanti prosent eller beløp
     C                   IF        ((WSGBL > XGGBLR) AND (XGGBLR <> 0))          2<-B
     C  N30              MOVE      'YBC1902'     MSGNR
     C                   MOVE      '1'           *IN82
     C                   MOVE      '1'           *IN30
     C                   END                                                     2<-E
      * Valutakode til garanti
     C     WSGVK         CHAIN     KODTVAL2                           81
     C   81
     CANN30              MOVE      'SPV0001'     MSGNR
     C   81              EVAL      *IN30 = *ON
      *
     C                   END                                                    1<-E
      * Avsenderland                                                            C0909
     C*                  IF        WSDK = 'TIR' OR WSALK <> *BLANKS
S08  C*                  IF        WSDK = 'TIR' AND WSALK <> *BLANKS
N08  C                   IF        WSALK <> *BLANKS
     C                   MOVE      WSALK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             80
     C   80
     CANN30              MOVE      'SPL0001'     MSGNR
     C   80              EVAL      *IN30 = *ON
     C                   ELSE
     C                   EVAL      WSALK = *BLANKS
     C                   END
S01   * Bestemmelsesland                                                        C0343
N01   * Flyttes etter test på mottaker (*IN71) pga. landkode kan hentes fra mottaker.
S01  C**                 IF        WSBLK <> *BLANKS                             1<-B
S01  C*                  IF        WSBLK = *BLANKS                              1<-B
S01  C*                  EVAL      WSBLK = WSLKK
S01  C*                  END                                                    1<-E
S01  C*                  MOVE      WSBLK         KS2LK
S01  C*    KODS2K        CHAIN     KODTS2                             79
S01  C*  79
S01  C*NN30              MOVE      'SPL0001'     MSGNR
S01  C*  79              EVAL      *IN30 = *ON
S01  C**                 END                                                    1<-E
      * Carrier
     C                   IF        WSKNC <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNC
     C     CUND1K        CHAIN     CUNDL01                            78
     C                   IF        *IN78                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 11
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINC = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINC = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINC = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINC = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAC  = KNAVN
     C*                  IF        WSTLC = *BLANKS                                3<-B
     C                   EVAL      WSTLC  = TLF
     C*                  END                                                      3<-E
     C*                  IF        WSEMC = *BLANKS                                3<-B
     C                   EVAL      WSEMC  = SYEPOS
     C*                  END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN78 = *OFF AND WSTINC <> *BLANKS           1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINC:1:2)
     C     KODS2K        CHAIN     KODTS2                             78
     C                   IF        *IN78 AND *IN30 = *OFF                        2<-B
     C                   EVAL      LINNBR = 11
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C  N78              IF        WSTINC <> *BLANKS
     C     WSNAC         COMP      *BLANKS                                77
     C   77
     CANN30              MOVE      'YBC2132'     MSGNR
     C   77              EVAL      *IN30 = *ON
     C                   END
      * Avsender
     C                   IF        WSKNS <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNS
     C     CUND1K        CHAIN     CUNDL01                            76
     C                   IF        *IN76                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 12
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINS = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINS = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINS = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINS = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAS  = KNAVN
     C                   EVAL      WSAD1S = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNS  = *BLANKS
     C                   MOVEL     POSTNR        WSPNS
     C                   ELSE                                                     3
     C                   EVAL      WSPNS  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSS  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKS  = SYLAND
     C                   END                                                      3<-E
     C*                  IF        WSCPS = *BLANKS                                3<-B
     C                   EVAL      WSCPS  = KPERS
     C*                  END                                                      3<-E
     C*                  IF        WSTLS = *BLANKS                                3<-B
     C                   EVAL      WSTLS  = TLF
     C*                  END                                                      3<-E
     C*                  IF        WSEMS = *BLANKS                                3<-B
     C                   EVAL      WSEMS  = SYEPOS
     C*                  END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN76 = *OFF AND WSTINS <> *BLANKS           1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINS:1:2)
     C     KODS2K        CHAIN     KODTS2                             76
     C                   IF        *IN76 AND *IN30 = *OFF                        2<-B
     C                   EVAL      LINNBR = 12
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     WSNAS         COMP      *BLANKS                                75
     C   75
     CANN30              MOVE      'YBC2132'     MSGNR
     C   75              EVAL      *IN30 = *ON
      *
     C     WSPNS         COMP      *BLANKS                                74
N01  C  N74              IF        %SUBST(WSPNS:10:8) <> *BLANKS
N01  C                   EVAL      *IN74 = *ON
N01  C                   END
     C   74
     CANN30              MOVE      'YBC2133'     MSGNR
     C   74              EVAL      *IN30 = *ON
      *
     C     WSPSS         COMP      *BLANKS                                73
     C   73
     CANN30              MOVE      'YBC2134'     MSGNR
     C   73              EVAL      *IN30 = *ON
      *
     C                   MOVE      WSLKS         KS2LK
     C     KODS2K        CHAIN     KODTS2                             72
     C   72
     CANN30              MOVE      'SPL0001'     MSGNR
     C   72              EVAL      *IN30 = *ON
      * Mottaker
     C                   IF        WSKNK <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNK
     C     CUND1K        CHAIN     CUNDL01                            71
     C                   IF        *IN71                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 15
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINK = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINK = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINK = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINK = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAK  = KNAVN
     C                   EVAL      WSAD1K = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNK  = *BLANKS
     C                   MOVEL     POSTNR        WSPNK
     C                   ELSE                                                     3
     C                   EVAL      WSPNK  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSK  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKK  = SYLAND
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N01   *
N01   * Bestemmelsesland                                                        C0343
N01  C                   IF        WSBLK = *BLANKS                              1<-B
S04  C*                  EVAL      WSBLK = WSLKK
N01  C                   END                                                    1<-E
N04  C                   IF        WSBLK <> *BLANKS                              1<-B
N01  C                   MOVE      WSBLK         KS2LK
N01  C     KODS2K        CHAIN     KODTS2                             79
N01  C   79
N01  CANN30              MOVE      'SPL0001'     MSGNR
N01  C   79              EVAL      *IN30 = *ON
N04  C                   ENDIF                                                  1<-E
      *
     C                   IF        *IN71 = *OFF AND WSTINK <> *BLANKS           1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINK:1:2)
     C     KODS2K        CHAIN     KODTS2                             71
     C                   IF        *IN71 AND *IN30 = *OFF                        2<-B
     C                   EVAL      LINNBR = 15
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     WSNAK         COMP      *BLANKS                                70
     C   70
     CANN30              MOVE      'YBC2132'     MSGNR
     C   70              EVAL      *IN30 = *ON
      *
     C     WSPNK         COMP      *BLANKS                                69
N01  C  N69              IF        %SUBST(WSPNK:10:8) <> *BLANKS
N01  C                   EVAL      *IN69 = *ON
N01  C                   END
     C   69
     CANN30              MOVE      'YBC2133'     MSGNR
     C   69              EVAL      *IN30 = *ON
      *
     C     WSPSK         COMP      *BLANKS                                68
     C   68
     CANN30              MOVE      'YBC2134'     MSGNR
     C   68              EVAL      *IN30 = *ON
      *
     C                   MOVE      WSLKK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             67
     C   67
     CANN30              MOVE      'SPL0001'     MSGNR
     C   67              EVAL      *IN30 = *ON
      *
      * IE170 krever <LocationOfGoods> utfylt
     C                   MOVE      'N'           X_TSTLG           1
     C  N30              IF        UTYPE = 'NOT' OR WSLGTY <> *BLANKS
     C                   MOVE      'J'           X_TSTLG
      * Type of location
     C                   MOVE      '347'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLGTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           33
     C                   IF        *IN33
     C                   MOVE      'YBC2277'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 18
     C                   EVAL      POSNBR = 9
     C                   END
      * Type of location
     C                   IF        *IN33 = *OFF
     C                   MOVE      '326'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLGID        YKODE
     C     TRK01K        CHAIN     TRKODL01                           33
     C                   IF        *IN33
     C                   MOVE      'YBC2278'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 18
     C                   EVAL      POSNBR = 13
     C                   END
     C                   END
      *
     C                   IF        *IN33 = *OFF
     C                   SELECT
     C                   WHEN      WSLGID = 'Z'
      * Address
     C                   IF        WSADE1 = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2279'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 20
     C                   EVAL      POSNBR = 48
     C                   END
     C  N33              IF        WSPSE = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2279'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 20
     C                   EVAL      POSNBR = 97
     C                   END
     C  N33              IF        WSLKE = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2279'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 20
     C                   EVAL      POSNBR = 122
     C                   END
     C                   WHEN      WSLGID = 'X'
      * Economic operator
     C                   IF        WSTINE = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2280'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 19
     C                   EVAL      POSNBR = 21
     C                   END
     C                   WHEN      WSLGID = 'Y'
      * Autorisasjonsnr
     C                   IF        WSLGAU = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2281'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 18
     C                   EVAL      POSNBR = 19
     C                   END
     C                   WHEN      WSLGID = 'W'
      * GNSS
     C                   IF        WSLGLA = *BLANKS OR WSLGLO = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2282'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 18
     C                   EVAL      POSNBR = 96
     C                   END
     C                   WHEN      WSLGID = 'V'
      * Tollsted
     C                   IF        WSLGTS = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2283'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 18
     C                   EVAL      POSNBR = 87
     C                   END
     C                   WHEN      WSLGID = 'U'
      * UN locode
     C                   IF        WSLGUN = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2284'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 18
     C                   EVAL      POSNBR = 66
     C                   END
     C                   WHEN      WSLGID = 'T'
      * Postcode address
     C                   IF        WSPNE2 = *BLANKS OR WSLKE2 = *BLANKS
     C                   EVAL      *IN33 = *ON
     C                   MOVE      'YBC2286'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 19
     C                   EVAL      POSNBR = 63
     C                   END
      *
     C                   ENDSL
     C                   END
      *
     C                   END
      *
      * Tollsted
     C                   IF        WSLGTS <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLGTS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           66
     C   66
     CANN30              MOVE      'YBC1768'     MSGNR
     C   66              EVAL      *IN30 = *ON
     C                   END
      * Økonomi
     C                   IF        WSKNE <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNK
     C     CUND1K        CHAIN     CUNDL01                            65
     C                   IF        *IN65                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINE = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINE = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINE = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINE = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSADE1 = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNE  = *BLANKS
     C                   MOVEL     POSTNR        WSPNE
     C                   ELSE                                                     3
     C                   EVAL      WSPNE  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSE  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKE  = SYLAND
     C                   END                                                      3<-E
     C                   IF        WSCPE = *BLANKS                                3<-B
     C                   EVAL      WSCPE  = KPERS
     C                   END                                                      3<-E
     C                   IF        WSTLE = *BLANKS                                3<-B
     C                   EVAL      WSTLE  = TLF
     C                   END                                                      3<-E
     C                   IF        WSEME = *BLANKS                                3<-B
     C                   EVAL      WSEME  = SYEPOS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        WSLKE2 <> *BLANKS
     C                   MOVE      WSLKE2        KS2LK
     C     KODS2K        CHAIN     KODTS2                             64
     C   64
     CANN30              MOVE      'SPL0001'     MSGNR
     C   64              EVAL      *IN30 = *ON
     C                   END
      *
     C*                  IF        WSTINE <> *BLANKS
     C*    WSPNE         COMP      *BLANKS                                63
     C*  63
     C*NN30              MOVE      'YBC2133'     MSGNR
     C*  63              EVAL      *IN30 = *ON
      *
     C*    WSPSK         COMP      *BLANKS                                62
     C*  62
     C*NN30              MOVE      'YBC2134'     MSGNR
     C*  62              EVAL      *IN30 = *ON
     C*                  END
      *
     C                   IF        WSLKE <> *BLANKS
     C                   MOVE      WSLKE         KS2LK
     C     KODS2K        CHAIN     KODTS2                             61
     C   61
     CANN30              MOVE      'SPL0001'     MSGNR
     C   61              EVAL      *IN30 = *ON
     C                   END
      *
     C*    KODS4K        CHAIN     KODTS4                             60
N01  C                   IF        WSTMIN = 3                                   G0088
N01  C                             OR WSTRM <> 0 OR WSTAID <> *BLANKS
     C                   MOVE      '750'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTRM         YKODE
     C     TRK01K        CHAIN     TRKODL01                           60
     C*  60
     C*NN30              MOVE      'YBC2261'     MSGNR
     C*  60              EVAL      *IN30 = *ON
     C                   IF        *IN60 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 12
     C                   MOVE      'YBC2261'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   ELSE
     C  N60WSTAID        COMP      *BLANKS                                60
     C                   IF        *IN60 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 26
     C                   MOVE      'YBC1705'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
N01  C                   END
      *
     C                   IF        XIDAG < X_FASE5 AND WSTMIN = 2               G1897
     C                   EVAL      WSTALK = *BLANKS
     C                   ELSE
     C                   MOVE      WSTALK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             59
     C   59
     CANN30              MOVE      'SPL0001'     MSGNR
     C   59              EVAL      *IN30 = *ON
     C                   END
      * Landkode 1 i rute
     C                   IF        WSLKR1 <> *BLANKS
     C                   MOVE      WSLKR1        KS2LK
     C     KODS2K        CHAIN     KODTS2                             58
     C                   IF        *IN58 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 75
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Landkode 2 i rute
     C                   IF        WSLKR2 <> *BLANKS
     C                   MOVE      WSLKR2        KS2LK
     C     KODS2K        CHAIN     KODTS2                             58
     C                   IF        *IN58 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 78
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Landkode 3 i rute
     C                   IF        WSLKR3 <> *BLANKS
     C                   MOVE      WSLKR3        KS2LK
     C     KODS2K        CHAIN     KODTS2                             58
     C                   IF        *IN58 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 81
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Landkode 4 i rute
     C                   IF        WSLKR4 <> *BLANKS
     C                   MOVE      WSLKR4        KS2LK
     C     KODS2K        CHAIN     KODTS2                             58
     C                   IF        *IN58 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 84
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Landkode 5 i rute
     C                   IF        WSLKR5 <> *BLANKS
     C                   MOVE      WSLKR5        KS2LK
     C     KODS2K        CHAIN     KODTS2                             58
     C                   IF        *IN58 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 87
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Landkode 6 i rute
     C                   IF        WSLKR6 <> *BLANKS
     C                   MOVE      WSLKR6        KS2LK
     C     KODS2K        CHAIN     KODTS2                             58
     C                   IF        *IN58 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 22
     C                   EVAL      POSNBR = 90
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Tollsted grense
     C*                  IF        WSTGTS <> *BLANKS
N01  C                   IF        WSTGTS = *BLANKS
N01   * Kopier først transitttollsted til aktiv grense tollsted
N01  C                   EVAL      WSTGTS = WSTSD1
N01  C                   END
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTGTS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           57
     C   57
     CANN30              MOVE      'YBC1768'     MSGNR
     C   57              EVAL      *IN30 = *ON
     C*                  END
      * Grense transport type
N01  C                   IF        WSTRMG = 0
N01  C                   EVAL      WSTRMG = WSTRM
N01  C                   END
     C                   MOVE      '219'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTRMG        YKODE
     C     TRK01K        CHAIN     TRKODL01                           56
     C*  56
     C*NN30              MOVE      'YBC2261'     MSGNR
     C*  56              EVAL      *IN30 = *ON
     C                   IF        *IN56 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 23
     C                   EVAL      POSNBR = 39
     C                   MOVE      'YBC2261'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   ELSE
N01  C                   IF        WSTGID = *BLANKS
N01  C                   EVAL      WSTGID = WSTAID
N01  C                   END
     C  N56WSTGID        COMP      *BLANKS                                56
     C                   IF        *IN56 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 23
     C                   EVAL      POSNBR = 45
     C                   MOVE      'YBC1705'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      * Tollsted grense, landkode
N01  C                   IF        WSTGLK = *BLANKS
N01  C                   EVAL      WSTGLK = WSTALK
N01  C                   END
     C                   IF        WSTGLK <> *BLANKS OR WSTGID <> *BLANKS
     C                   MOVE      WSTGLK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             55
     C   55
     CANN30              MOVE      'SPL0001'     MSGNR
     C   55              EVAL      *IN30 = *ON
     C                   END
N12
N12  C                   IF        WSDKT <> 'D'
N12  C                             OR UTYPE = 'NOT'                             IE170 KREVER
N12  C                             OR WSDK = 'EXIT'                             FORHÅNDSVARSEL
N12
N12  C                   IF        WSLSUN = *BLANKS
N12  C                   IF        WSLSLK = *BLANKS
N12  C                   MOVE      'CBA0520'     MSGNR
N12  C                   EVAL      LINNBR = 24
N12  C                   EVAL      POSNBR = 8
N12  C                   EVAL      *IN30 = *ON
N12  C                   EVAL      *IN54 = *ON
N12  C                   ENDIF
N12  C                   ENDIF
N12
N12  C                   IF        WSLSLK <> *BLANKS
N12  C                   IF        WSLSNA = *BLANKS
N12  C                   MOVE      'CBA0530'     MSGNR
N12  C                   EVAL      LINNBR = 24
N12  C                   EVAL      POSNBR = 29
N12  C                   EVAL      *IN30 = *ON
N12  C                   EVAL      *IN54 = *ON
N12  C                   ENDIF
N12  C                   ENDIF
N12  C                   ENDIF

     C                   IF        XIDAG >= X_FASE5 AND WSSECU > 0              B1893
     C                             OR WSDKT <> 'D' AND XIDAG >= X_FASE5         C0403
     C                             OR UTYPE = 'NOT'                             IE170 KREVER
     C                             OR WSDK = 'EXIT'                             FORHÅNDSVARSEL
      * B1893 Krever place of loading når secure ikke er 0 og i Post-Transition Period.
      * C0403 krever place of loading når additional declaration type ikke er D.
      *       !!! Lagt inn test på Post-TP pga. feil ved In-TP hvis send laststed.
      * Lastested, UN LOCODE
     C                   MOVE      '244'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLSUN        YKODE
     C     TRK01K        CHAIN     TRKODL01                           54
N08  C     WSLSUN        IFEQ      *BLANKS
N08  C                   EVAL      *IN54=*OFF
N08  C                   ENDIF
     C                   IF        *IN54
     C  N30              MOVE      'YBC2256'     MSGNR
     C  N30              EVAL      LINNBR = 24
     C  N30              EVAL      POSNBR = 8
     C                   EVAL      *IN30 = *ON
     C                   ELSE
N08  C     WSLSUN        IFNE      *BLANKS
     C                   EVAL      WSLSNA = TKTXTN
N08  C                   ENDIF
      * Lastested, landkode
     C                   IF        WSLSLK = *BLANKS
     C                   EVAL      WSLSLK = %SUBST(WSLSUN:1:2)
     C                   ELSE
     C                   MOVE      WSLSLK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             54
     C                   IF        *IN54
     C  N30              MOVE      'SPL0001'     MSGNR
     C  N30              EVAL      LINNBR = 24
     C  N30              EVAL      POSNBR = 26
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END

     C                   ELSE
      *
     C                   END
      *
     C                   IF        WSSECU <> 0
     C                             OR WSLOUN <> *BLANKS OR WSLOLK <> *BLANKS
N13  C                             OR WSLONA <> *BLANKS
N13
N13  C                   IF        WSLOUN = *BLANKS
N13  C                   IF        WSLOLK = *BLANKS
N13  C                   MOVE      'CBA0550'     MSGNR
N13  C                   EVAL      LINNBR = 24
N13  C                   EVAL      POSNBR = 71
N13  C                   EVAL      *IN30 = *ON
N12  C                   EVAL      *IN53 = *ON
N13  C                   ENDIF
N13  C                   ENDIF
N13
N13  C                   IF        WSLOLK <> *BLANKS
N13  C                   IF        WSLONA = *BLANKS
N13  C                   MOVE      'CBA0530'     MSGNR
N13  C                   EVAL      LINNBR = 24
N13  C                   EVAL      POSNBR = 89
N13  C                   EVAL      *IN30 = *ON
N13  C                   EVAL      *IN53 = *ON
N13  C                   ENDIF
N13  C                   ENDIF
N13  C                   IF        WSLOLK = *BLANKS
N13  C                   IF        WSLONA <> *BLANKS
N13  C                   MOVE      'CBA0530'     MSGNR
N13  C                   EVAL      LINNBR = 24
N13  C                   EVAL      POSNBR = 89
N13  C                   EVAL      *IN30 = *ON
N13  C                   EVAL      *IN53 = *ON
N13  C                   ENDIF
N13  C                   ENDIF
      * Lossested, UN LOCODE
     C                   MOVE      '244'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLOUN        YKODE
     C     TRK01K        CHAIN     TRKODL01                           53
     C                   IF        *IN53
     C  N30              MOVE      'YBC2256'     MSGNR
     C  N30              EVAL      LINNBR = 24
     C  N30              EVAL      POSNBR = 71
     C                   EVAL      *IN30 = *ON
     C                   ELSE
     C                   EVAL      WSLONA = TKTXTN
      * Lossested, landkode
     C                   IF        WSLOLK = *BLANKS
     C                   EVAL      WSLOLK = %SUBST(WSLOUN:1:2)
     C                   ELSE
     C                   MOVE      WSLOLK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             53
     C                   IF        *IN53
     C  N30              MOVE      'SPL0001'     MSGNR
     C  N30              EVAL      LINNBR = 24
     C  N30              EVAL      POSNBR = 89
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   END
      *
      *
     C*    WSDKR         IFNE      *BLANKS
     C     WSDDT         IFNE      0
     C*    WSATYP        ANDNE     'C521'
     C     WSATYP        ANDEQ     'C521'
     C*    WSENKL        OREQ      'J'                                          FORENKLET PROS.
     C*    WSATYP        ANDNE     'C521'
     C     WSDKT         ORNE      'D'                                          TILLEGGS DEKL.TYPE
     C     WSATYP        ANDEQ     'C521'
     C*                  MOVE      '047'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSDKR         YKODE
     C*    TRK01K        CHAIN     TRKODL01                           53
     C*  53
     C*NN30              MOVE      'YBC0854'     MSGNR
     C* N53              IF        WSENKL = 'N' AND WSDKR = 'A3'
     C*                  EVAL      *IN53 = *ON
     C*                  EVAL      MSGNR = 'YBC2032'
     C*                  END
     C*  53              EVAL      *IN30 = *ON
      *
     C     WSDDT         IFEQ      0
     C                   MOVE      *ZEROS        UINNDT            6 0
     C                   IF        XANTDG = 0
     C                   Z-ADD     8             UANTDG            3 0
     C                   ELSE
     C                   Z-ADD     XANTDG        UANTDG
     C                   END
     C                   CALL      'SYFA20B'
     C                   PARM                    UINNDT
     C                   PARM                    UANTDG
     C     WSDDT         PARM                    UUTDT             6 0
     C                   PARM                    UFLAGG            1 0
     C                   END
      * Språkkode
     C*                  IF        WSSKFD <> *BLANKS
     C*                  MOVE      '012'         YUNIK
     C*                  EVAL      YKODE = WSSKFD
     C*    TRK01K        CHAIN     TRKODL01                           54
     C*  54
     C*NN30              MOVE      'YBC0810'     MSGNR
     C*  54              EVAL      *IN30 = *ON
     C*                  END
      *
     C                   IF        WSDDT = 0
     C                   MOVE      *ZEROS        UINNDT            6 0
     C                   IF        XANTDG = 0
     C                   Z-ADD     8             UANTDG            3 0
     C                   ELSE
     C                   Z-ADD     XANTDG        UANTDG
     C                   END
     C                   CALL      'SYFA20B'
     C                   PARM                    UINNDT
     C                   PARM                    UANTDG
     C     WSDDT         PARM                    UUTDT             6 0
     C                   PARM                    UFLAGG            1 0
     C                   END
      *
     C                   CALL      'TESTDATO'
     C                   PARM      WSDDTD        UDD               2 0
     C                   PARM      WSDDTM        UMM               2 0
     C                   PARM      WSDDTA        UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      52
     C   52
     CANN30              MOVE      'SPD0001'     MSGNR
     C   52              EVAL      *IN30 = *ON
     C                   END
N07  C                   IF        WSDDT > 0
N07   * Test at fristdato ikke er lavere en dagens dato.
N07  C                   EVAL      W2DATY=20
N07  C                   EVAL      W2DATA=WSDDTA
N07  C                   EVAL      W2DATM=WSDDTM
N07  C                   EVAL      W2DATD=WSDDTD
N07  C     W2DAT         IFLT      XIDAG
N07  C                   EVAL      *IN52 = *ON
N07  C     *IN30         IFEQ      *OFF
N07  C                   EVAL      *IN30 = *ON
N07  C                   MOVE      'CBA0414'     MSGNR
N07  C                   ENDIF
N07  C                   ENDIF
N07   * Test at fristdato ikke er mer en 30 dager fremover
N07  C     *IN52         IFEQ      *OFF
N07  C                   CALL      'SYFA20B'
N07  C                   PARM      0             UINNDT
N07  C                   PARM      20            UANTDG
N07  C     UWSDDT        PARM                    UUTDT
N07  C                   PARM                    UFLAGG
N07  C                   EVAL      W3DATY=20
N07  C                   EVAL      W3DATA=UWSDDTA
N07  C                   EVAL      W3DATM=UWSDDTM
N07  C                   EVAL      W3DATD=UWSDDTD
N07  C     W2DAT         IFGT      W3DAT
N07  C                   EVAL      *IN52 = *ON
N07  C                   EVAL      *IN30 = *ON
N07  C                   MOVE      'CBA0415'     MSGNR
N07  C                   ENDIF
N07  C                   ENDIF
N07  C                   ENDIF
      * Exit for transit
     C                   IF        WSSECU = 2 OR WSSECU = 3
     C                   IF        WSTSDE <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSDE        YKODE
     C     TRK01K        CHAIN     TRKODL01                           51
     C  N51TKANK         COMP      'J'                                5151
     C   51
     CANN30              MOVE      'YBC1768'     MSGNR
     C   51              EVAL      *IN30 = *ON
      * Exit for transit 2
     C                   IF        WSTSDE2 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSDE2       YKODE
     C     TRK01K        CHAIN     TRKODL01                           50
     C  N50TKANK         COMP      'J'                                5050
     C   50
     CANN30              MOVE      'YBC1768'     MSGNR
     C   50              EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   ELSE
     C                   EVAL      WSTSDE = *BLANKS                             C0587
     C                   END
      *
     C*    WSDST         COMP      *BLANKS                                51
     C*                  IF        *IN51
     C* N30              MOVE      'SPK0001'     MSGNR
     C*  51              EVAL      *IN30 = *ON
     C*                  END
      *
     C   30              EXSR      SETCUR
      *
     C                   IF        *IN33 = *OFF
     C                   IF        WSTMIN = 0
     C                   MOVE      'YBC2288'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 10
     C                   EVAL      POSNBR = 57
     C                   ELSE
     C                   IF        WSTMGR = 0
     C                   MOVE      'YBC2288'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   EVAL      LINNBR = 10
     C                   EVAL      POSNBR = 59
     C                   END
     C                   END
     C                   END
      *
     C     SLTB02        TAG
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   30              IF        X_TSTLG = 'J'
     C                   GOTO      SLSETCUR
     C                   END
      *
     C                   IF        *IN92 = *OFF
     C                   IF        *IN60 = *OFF
     C                   IF        *IN58 = *OFF
     C                   IF        *IN56 = *OFF
     C   50              Z-ADD     25            LINNBR
     C   50              Z-ADD     54            POSNBR
     C*  51              Z-ADD     25            LINNBR
     C*  51              Z-ADD     70            POSNBR
     C   51              Z-ADD     25            LINNBR
     C   51              Z-ADD     45            POSNBR
     C   52              Z-ADD     25            LINNBR
S07  C*  52              Z-ADD     16            POSNBR
N07  C   52              Z-ADD     22            POSNBR
     C*  53              Z-ADD     25            LINNBR
     C*  53              Z-ADD     13            POSNBR
     C*  53              Z-ADD     24            LINNBR
     C*  53              Z-ADD     89            POSNBR
     C*  54              Z-ADD     24            LINNBR
     C*  54              Z-ADD     26            POSNBR
     C   55              Z-ADD     23            LINNBR
     C   55              Z-ADD     84            POSNBR
     C*  56              Z-ADD     23            LINNBR
     C*  56              Z-ADD     39            POSNBR
     C                   END
     C   57              Z-ADD     23            LINNBR
     C   57              Z-ADD     25            POSNBR
     C                   END
      *
     C   59              Z-ADD     22            LINNBR
     C   59              Z-ADD     65            POSNBR
     C*  60              Z-ADD     22            LINNBR
     C*  60              Z-ADD     12            POSNBR
     C                   END
      *
     C   61              Z-ADD     20            LINNBR
     C   61              Z-ADD     122           POSNBR
     C   62              Z-ADD     20            LINNBR
     C   62              Z-ADD     97            POSNBR
     C   63              Z-ADD     20            LINNBR
     C   63              Z-ADD     79            POSNBR
     C   64              Z-ADD     19            LINNBR
     C   64              Z-ADD     81            POSNBR
     C   65              Z-ADD     19            LINNBR
     C   65              Z-ADD     12            POSNBR
     C   66              Z-ADD     18            LINNBR
     C   66              Z-ADD     87            POSNBR
     C   67              Z-ADD     16            LINNBR
     C   67              Z-ADD     122           POSNBR
     C   68              Z-ADD     16            LINNBR
     C   68              Z-ADD     97            POSNBR
     C   69              Z-ADD     16            LINNBR
     C   69              Z-ADD     79            POSNBR
     C   70              Z-ADD     16            LINNBR
     C   70              Z-ADD     17            POSNBR
     C*  71              Z-ADD     15            LINNBR
     C*  71              Z-ADD     12            POSNBR
     C   72              Z-ADD     13            LINNBR
     C   72              Z-ADD     122           POSNBR
     C   73              Z-ADD     13            LINNBR
     C   73              Z-ADD     97            POSNBR
     C   74              Z-ADD     13            LINNBR
     C   74              Z-ADD     79            POSNBR
     C   75              Z-ADD     13            LINNBR
     C   75              Z-ADD     17            POSNBR
     C*  76              Z-ADD     12            LINNBR
     C*  76              Z-ADD     12            POSNBR
     C   77              Z-ADD     11            LINNBR
     C   77              Z-ADD     39            POSNBR
     C*  78              Z-ADD     11            LINNBR
     C*  78              Z-ADD     12            POSNBR
     C   79              Z-ADD     10            LINNBR
     C   79              Z-ADD     23            POSNBR
     C   80              Z-ADD     10            LINNBR
     C   80              Z-ADD     12            POSNBR
     C   81              Z-ADD     9             LINNBR
     C   81              Z-ADD     123           POSNBR
     C   82              Z-ADD     9             LINNBR
     C   82              Z-ADD     106           POSNBR
     C   83              Z-ADD     9             LINNBR
     C   83              Z-ADD     75            POSNBR
     C   84              Z-ADD     9             LINNBR
     C   84              Z-ADD     14            POSNBR
     C   85              Z-ADD     7             LINNBR
     C   85              Z-ADD     21            POSNBR
     C   86              Z-ADD     7             LINNBR
     C   86              Z-ADD     12            POSNBR
     C   87              Z-ADD     5             LINNBR
     C   87              Z-ADD     122           POSNBR
     C   88              Z-ADD     5             LINNBR
     C   88              Z-ADD     97            POSNBR
     C   89              Z-ADD     5             LINNBR
     C   89              Z-ADD     79            POSNBR
     C   90              Z-ADD     5             LINNBR
     C   90              Z-ADD     17            POSNBR
     C*  91              Z-ADD     4             LINNBR
     C*  91              Z-ADD     12            POSNBR
     C                   END
      *
     C   93              Z-ADD     3             LINNBR
     C   93              Z-ADD     29            POSNBR
     C   94              Z-ADD     3             LINNBR
     C   94              Z-ADD     16            POSNBR
     C   95              Z-ADD     2             LINNBR
     C   95              Z-ADD     77            POSNBR
     C   96              Z-ADD     2             LINNBR
     C   96              Z-ADD     31            POSNBR
     C   97              Z-ADD     2             LINNBR
     C   97              Z-ADD     26            POSNBR
     C   98              Z-ADD     2             LINNBR
     C   98              Z-ADD     10            POSNBR
     C   99              Z-ADD     1             LINNBR
     C   99              Z-ADD     68            POSNBR
      *
     C     SLSETCUR      TAG
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVW2         BEGSR
      ***********************************************
     C                   IF        UTYPE = 'NOT'
     C                   EVAL      WSENKL = THENKL
     C                   END
      *
     C                   IF        WSSOK = *BLANKS
     C                   EVAL      WSSOK = WSEXTR
     C                   END
     C                   EVAL      WSDTD = THDTD
     C                   EVAL      WSDTM = THDTM
     C                   MOVE      THDTA         WSDTA
     C                   EVAL      WSDDTD = THDDTD
     C                   EVAL      WSDDTM = THDDTM
     C                   MOVE      THDDTA        WSDDTA
     C                   IF        WSTDN = 0
     C                   MOVE      UPRO2         WSPRO
     C*                  MOVE      *ZEROS        WSDDTK
     C*                  MOVE      *BLANKS       WSDATS
     C                   ELSE
     C                   MOVE      THPRO         WSPRO
     C*                  MOVE      THDDTKD       WSDDTKD
     C*                  MOVE      THDDTKM       WSDDTKM
     C*                  MOVE      THDDTKA       WSDDTKA
     C*                  MOVE      THDATS        WSDATS
     C                   END
      *
     C                   EVAL      WSDK   = THDK
     C                   EVAL      WSDKT  = THDKT
     C                   EVAL      WSTIRN = THTIRN
     C                   EVAL      WSSECU = THSECU
     C                   EVAL      WSRDIN = THRDIN
     C                   EVAL      WSSCIN = THSCIN
     C                   EVAL      WSCLKD = THCLKD
     C                   EVAL      WSBINI = THBINI
     C                   EVAL      WSATYP = THATYP
     C                   EVAL      WSAREF = THAREF
     C                   EVAL      WSCATS = THCATS
     C                   EVAL      WSTSB  = THTSB
     C                   EVAL      WSTSD1 = THTSD1
     C                   EVAL      WSTSD2 = THTSD2
     C                   EVAL      WSTSD3 = THTSD3
     C                   EVAL      WSTSD4 = THTSD4
     C                   EVAL      WSTSD5 = THTSD5
     C                   EVAL      WSTSD6 = THTSD6
     C                   EVAL      WSTSD7 = THTSD7
     C                   EVAL      WSTSD8 = THTSD8
     C                   EVAL      WSTSDE = THTSDE
     C                   EVAL      WSTSDE2 = THTSDE2
     C                   EVAL      WSKNH  = THKNH
     C                   EVAL      WSTINH = THTINH
     C                   EVAL      WSTIRH = THTIRH
     C                   EVAL      WSNAH  = THNAH
     C                   EVAL      WSAD1H = THAD1H
     C                   EVAL      WSPNH  = THPNH
     C                   EVAL      WSPSH  = THPSH
     C                   EVAL      WSLKH  = THLKH
     C                   EVAL      WSCPH  = THCPH
     C                   EVAL      WSTLH  = THTLH
     C                   EVAL      WSEMH  = THEMH
     C                   EVAL      WSKNA  = THKNA
     C                   EVAL      WSTINA = THTINA
     C                   EVAL      WSSTA  = THSTA
     C                   EVAL      WSCPA  = THCPA
     C                   EVAL      WSTLA  = THTLA
     C                   EVAL      WSEMA  = THEMA
     C                   EVAL      WSGKD  = THGKD
     C                   EVAL      WSGFT1 = THGFT1
     C                   EVAL      WSGFT2 = THGFT2
     C                   EVAL      WSGADK = THGADK
     C                   IF        THGBL < 0
     C                   Z-SUB     THGBL         WSGBL
     C                   MOVE      *ZEROS        XSGBL            11 0
     C                   ELSE
     C                   MOVE      THGBL         WSGBL
     C                   MOVE      THGBL         XSGBL            11 0
     C                   END
     C                   EVAL      WSGVK  = THGVK
     C                   EVAL      WSALK  = THALK
     C                   EVAL      WSBLK  = THBLK
     C                   EVAL      WSKDC  = THKDC
     C                   EVAL      WSTMIN = THTMIN
     C                   EVAL      WSTMGR = THTMGR
     C                   EVAL      WSUCR  = THUCR
     C                   EVAL      WSKNC  = THKNC
     C                   EVAL      WSTINC = THTINC
     C                   EVAL      WSNAC  = THNAC
     C                   EVAL      WSTLC  = THTLC
     C                   EVAL      WSEMC  = THEMC
     C                   EVAL      WSKNS  = THKNS
     C                   EVAL      WSTINS = THTINS
     C                   EVAL      WSNAS  = THNAS
     C                   EVAL      WSAD1S = THAD1S
     C                   EVAL      WSPNS  = THPNS
     C                   EVAL      WSPSS  = THPSS
     C                   EVAL      WSLKS  = THLKS
     C                   EVAL      WSCPS  = THCPS
     C                   EVAL      WSTLS  = THTLS
     C                   EVAL      WSEMS  = THEMS
     C                   EVAL      WSKNK  = THKNK
     C                   EVAL      WSTINK = THTINK
     C                   EVAL      WSNAK  = THNAK
     C                   EVAL      WSAD1K = THAD1K
     C                   EVAL      WSPNK  = THPNK
     C                   EVAL      WSPSK  = THPSK
     C                   EVAL      WSLKK  = THLKK
     C                   EVAL      WSROLE = THROLE
     C                   EVAL      WSIDR  = THIDR
     C*                  EVAL      WSCNR  = THCNR
     C*                  EVAL      WSDANT = THDANT
     C*                  EVAL      WSDFKD = THDFKD
     C*                  EVAL      WSGINR = THGINR
     C                   EVAL      WSLGTY = THLGTY
     C                   EVAL      WSLGID = THLGID
     C                   EVAL      WSLGAU = THLGAU
     C                   EVAL      WSLGAI = THLGAI
     C                   EVAL      WSLGUN = THLGUN
     C                   EVAL      WSLGTS = THLGTS
     C                   EVAL      WSLGLA = THLGLA
     C                   EVAL      WSLGLO = THLGLO
     C                   EVAL      WSKNE  = THKNE
     C                   EVAL      WSTINE = THTINE
     C                   EVAL      WSADE1 = THADE1
     C                   EVAL      WSPNE  = THPNE
     C                   EVAL      WSPSE  = THPSE
     C                   EVAL      WSLKE  = THLKE
     C                   EVAL      WSCPE  = THCPE
     C                   EVAL      WSTLE  = THTLE
     C                   EVAL      WSEME  = THEME
     C                   EVAL      WSADE2 = THADE2
     C                   EVAL      WSPNE2 = THPNE2
     C                   EVAL      WSLKE2 = THLKE2
     C                   EVAL      WSTRM  = THTRM
     C                   EVAL      WSTAID = THTAID
     C                   EVAL      WSTALK = THTALK
     C                   EVAL      WSLKR1 = THLKR1
     C                   EVAL      WSLKR2 = THLKR2
     C                   EVAL      WSLKR3 = THLKR3
     C                   EVAL      WSLKR4 = THLKR4
     C                   EVAL      WSLKR5 = THLKR5
     C                   EVAL      WSLKR6 = THLKR6
     C                   EVAL      WSTGTS = THTGTS
     C                   EVAL      WSTRMG = THTRMG
     C                   EVAL      WSTGID = THTGID
     C                   EVAL      WSTGLK = THTGLK
     C                   EVAL      WSTGCN = THTGCN
     C                   EVAL      WSLSUN = THLSUN
     C                   EVAL      WSLSLK = THLSLK
     C                   EVAL      WSLSNA = THLSNA
     C                   EVAL      WSLOUN = THLOUN
     C                   EVAL      WSLOLK = THLOLK
     C                   EVAL      WSLONA = THLONA
     C*                  EVAL      WSDKR  = THDKR
     C                   MOVE      THDTD         WSDTD
     C                   MOVE      THDTM         WSDTM
     C                   MOVE      THDTA         WSDTA
     C*                  EVAL      WSSKFD = THSKFD
     C*                  EVAL      WSDST  = THDST
     C                   EVAL      WSTRCH = THTRCH
      *
     C                   EVAL      WSLSTL = THLSTL
     C                   EVAL      WSVPOS = THVPOS
     C                   EVAL      WSNTK  = THNTK
     C                   EVAL      WSVKB  = THVKB
     C     KODTSIK       CHAIN     KOSIR                              33
     C                   EVAL      WSTARF = KSINAV
     C                   EVAL      WSTRNR = THTRNR
     C                   MOVE      THTRDTD       WSTRDTD
     C                   MOVE      THTRDTM       WSTRDTM
     C                   MOVE      THTRDTA       WSTRDTA
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVNCTSEH     BEGSR
     C***********************************************
     C                   EVAL      THAVD  = UAVD
     C                   EVAL      THTDN  = WSTDN
     C                   EVAL      THSG   = WSSG
     C                   EVAL      THENKL = WSENKL
     C                   EVAL      THPRO  = WSPRO
     C*                  IF        WSDDTK = 0
     C*                  EVAL      THDDTK = 0
     C*                  ELSE
     C*                  EVAL      THDDTK = 20000000 + WSDDTKA * 10000
     C*                            + WSDDTKM * 100 + WSDDTKD
     C*                  END
      *
     C                   EVAL      THDK   = WSDK
     C                   EVAL      THDKT  = WSDKT
     C                   EVAL      THTIRN = WSTIRN
     C                   EVAL      THSECU = WSSECU
     C                   EVAL      THRDIN = WSRDIN
     C                   EVAL      THSCIN = WSSCIN
     C                   EVAL      THCLKD = WSCLKD
     C                   EVAL      THBINI = WSBINI
     C                   EVAL      THATYP = WSATYP
     C                   EVAL      THAREF = WSAREF
     C                   EVAL      THCATS = WSCATS
     C                   EVAL      THTSB  = WSTSB
     C                   EVAL      THTSD1 = WSTSD1
     C                   EVAL      THTSD2 = WSTSD2
     C                   EVAL      THTSD3 = WSTSD3
     C                   EVAL      THTSD4 = WSTSD4
     C                   EVAL      THTSD5 = WSTSD5
     C                   EVAL      THTSD6 = WSTSD6
     C                   EVAL      THTSD7 = WSTSD7
     C                   EVAL      THTSD8 = WSTSD8
     C                   EVAL      THTSDE = WSTSDE
     C                   EVAL      THTSDE2 = WSTSDE2
     C                   EVAL      THKNH  = WSKNH
     C                   EVAL      THTINH = WSTINH
     C                   EVAL      THTIRH = WSTIRH
     C                   EVAL      THNAH  = WSNAH
     C                   EVAL      THAD1H = WSAD1H
     C                   EVAL      THPNH  = WSPNH
     C                   EVAL      THPSH  = WSPSH
     C                   EVAL      THLKH  = WSLKH
     C                   EVAL      THCPH  = WSCPH
     C                   EVAL      THTLH  = WSTLH
     C                   EVAL      THEMH  = WSEMH
     C                   EVAL      THKNA  = WSKNA
     C                   EVAL      THTINA = WSTINA
     C                   EVAL      THSTA  = WSSTA
     C                   EVAL      THCPA  = WSCPA
     C                   EVAL      THTLA  = WSTLA
     C                   EVAL      THEMA  = WSEMA
     C*                  EVAL      THGKD  = WSGKD
     C*                  EVAL      THGFT1 = WSGFT1
     C*                  EVAL      THGFT2 = WSGFT2
     C*                  EVAL      THGADK = WSGADK
     C*                  EVAL      THGBL  = WSGBL
     C*                  EVAL      THGVK  = WSGVK
     C                   EVAL      THALK  = WSALK
     C                   EVAL      THBLK  = WSBLK
     C                   EVAL      THKDC  = WSKDC
     C                   EVAL      THTMIN = WSTMIN
     C                   EVAL      THTMGR = WSTMGR
     C                   EVAL      THUCR  = WSUCR
     C                   EVAL      THKNC  = WSKNC
     C                   EVAL      THTINC = WSTINC
     C                   EVAL      THNAC  = WSNAC
     C                   EVAL      THTLC  = WSTLC
     C                   EVAL      THEMC  = WSEMC
     C                   EVAL      THKNS  = WSKNS
     C                   EVAL      THTINS = WSTINS
     C                   EVAL      THNAS  = WSNAS
     C                   EVAL      THAD1S = WSAD1S
     C                   EVAL      THPNS  = WSPNS
     C                   EVAL      THPSS  = WSPSS
     C                   EVAL      THLKS  = WSLKS
     C                   EVAL      THCPS  = WSCPS
     C                   EVAL      THTLS  = WSTLS
     C                   EVAL      THEMS  = WSEMS
     C                   EVAL      THKNK  = WSKNK
     C                   EVAL      THTINK = WSTINK
     C                   EVAL      THNAK  = WSNAK
     C                   EVAL      THAD1K = WSAD1K
     C                   EVAL      THPNK  = WSPNK
     C                   EVAL      THPSK  = WSPSK
     C                   EVAL      THLKK  = WSLKK
     C                   EVAL      THROLE = WSROLE
     C                   EVAL      THIDR  = WSIDR
     C*                  EVAL      THCNR  = WSCNR
     C*                  EVAL      THDANT = WSDANT
     C*                  EVAL      THDFKD = WSDFKD
     C*                  EVAL      THGINR = WSGINR
     C                   EVAL      THLGTY = WSLGTY
     C                   EVAL      THLGID = WSLGID
     C                   EVAL      THLGAU = WSLGAU
     C                   EVAL      THLGAI = WSLGAI
     C                   EVAL      THLGUN = WSLGUN
     C                   EVAL      THLGTS = WSLGTS
     C                   EVAL      THLGLA = WSLGLA
     C                   EVAL      THLGLO = WSLGLO
     C                   EVAL      THKNE  = WSKNE
     C                   EVAL      THTINE = WSTINE
     C                   EVAL      THADE1 = WSADE1
     C                   EVAL      THPNE  = WSPNE
     C                   EVAL      THPSE  = WSPSE
     C                   EVAL      THLKE  = WSLKE
     C                   EVAL      THCPE  = WSCPE
     C                   EVAL      THTLE  = WSTLE
     C                   EVAL      THEME  = WSEME
     C                   EVAL      THADE2 = WSADE2
     C                   EVAL      THPNE2 = WSPNE2
     C                   EVAL      THLKE2 = WSLKE2
     C                   EVAL      THTRM  = WSTRM
     C                   EVAL      THTAID = WSTAID
     C                   EVAL      THTALK = WSTALK
     C                   EVAL      THLKR1 = WSLKR1
     C                   EVAL      THLKR2 = WSLKR2
     C                   EVAL      THLKR3 = WSLKR3
     C                   EVAL      THLKR4 = WSLKR4
     C                   EVAL      THLKR5 = WSLKR5
     C                   EVAL      THLKR6 = WSLKR6
     C                   EVAL      THTGTS = WSTGTS
     C                   EVAL      THTRMG = WSTRMG
     C                   EVAL      THTGID = WSTGID
     C                   EVAL      THTGLK = WSTGLK
     C                   EVAL      THTGCN = WSTGCN
     C                   EVAL      THLSUN = WSLSUN
     C                   EVAL      THLSLK = WSLSLK
     C                   EVAL      THLSNA = WSLSNA
     C                   EVAL      THLOUN = WSLOUN
     C                   EVAL      THLOLK = WSLOLK
     C                   EVAL      THLONA = WSLONA
     C*                  EVAL      THDKR  = WSDKR
     C*                  EVAL      THDDT  = WSDDT
     C*                  EVAL      THSKFD = WSSKFD
     C*                  EVAL      THDST  = WSDST
     C                   EVAL      THTRCH = WSTRCH
      *
     C                   IF        WSENKL = 'J' OR WSTRNR <> *BLANKS
     C                   IF        WSDDT  = 0
     C                   EVAL      THDDT  = 0
N06  C                   EVAL      THLIDT = *BLANKS
     C                   ELSE
     C                   EVAL      THDDT = 20000000 + WSDDTA * 10000
     C                             + WSDDTM * 100 + WSDDTD
N06  C                   MOVEL     THDDT         THLIDT
     C                   END
     C*                  EVAL      THDFKD = WSDFKD
     C*                  EVAL      THDKR  = WSDKR
     C*                  EVAL      THDANT = WSDANT
     C                   ELSE
     C                   EVAL      THDDT  = 0
N06  C                   EVAL      THLIDT = *BLANKS
     C*                  EVAL      THDFKD = *BLANKS
     C*                  EVAL      THDKR  = *BLANKS
     C*                  EVAL      THDANT = 0
     C                   END
      * OPPDATER TOTAL PÅ GAMMEL GARANTI
     C  N33              IF        ((THGFT1 <> *BLANKS) AND
     C                             ((THGKD <= '1') OR
     C                               (THGKD >= '6')))
     C     THGFT1        CHAIN     TRUGH                              30
     C  N30              EVAL      TGGBLB = TGGBLB - THGBL
     C  N30              UPDATE    TRUGHR
     C  N30              MOVE      THGBL         XSGBL            11 0
     C                   MOVE      '0'           *IN30
     C                   END
      * OPPDATER TOTAL PÅ NY GARANTI
     C                   IF        ((WSGFT1 <> *BLANKS) AND
     C                             ((WSGKD <= '1') OR
     C                               (WSGKD >= '6')))
     C     WSGFT1        CHAIN     TRUGH                              30
     C                   IF        *IN30 = *OFF
     C                   EVAL      TGGBLB = TGGBLB + WSGBL
     C                   UPDATE    TRUGHR
     C                   MOVE      THGBL         XSGBL            11 0
     C                   IF        TGGBLB > TGGBL
     C                   Z-ADD     100           XPRM
     C                   ELSE
     C     TGGBLB        DIV       TGGBL         XPRM              5 2
     C                   MULT      100           XPRM
     C                   END
     C                   IF        ((XPRM > TGPRM) AND (TGPRM <> 0))
     C                   EXFMT     NCTS011D03
     C                   END
     C                   END
     C                   MOVE      '0'           *IN30
     C                   END
      *
     C                   EVAL      THGBL  = WSGBL
     C                   EVAL      THGVK  = WSGVK
     C                   EVAL      THGKD  = WSGKD
     C                   EVAL      THGFT1 = WSGFT1
     C                   EVAL      THGFT2 = WSGFT2
     C                   EVAL      THGADK = WSGADK
     C                   MOVE      WSLSTL        THLSTL
     C                   MOVE      WSVPOS        THVPOS
     C                   MOVE      WSNTK         THNTK
     C                   MOVE      WSVKB         THVKB
     C*                  MOVE      WSDST         THDST
     C                   MOVE      WSTARF        THTARF
     C                   MOVE      UWS           THWS
     C                   MOVE      WSTRNR        THTRNR
     C                   IF        WSTRDT = 0
     C                   EVAL      THTRDT = 0
     C                   ELSE
     C                   EVAL      THTRDT = 20000000 + WSTRDTA * 10000
     C                             + WSTRDTM * 100 + WSTRDTD
     C                   END
     C                   MOVE      *BLANKS       THMF
     C                   MOVE      *ZEROS        THMP
     C                   MOVE      *BLANKS       THPKL
     C                   MOVE      *BLANKS       TH0035
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDNCTSEH     BEGSR
     C***********************************************
     C                   IF        WSTDN = 0
     C     UAVD          CHAIN     NCTSESTD                           33
     C                   MOVE      THTDN         WSTDN
     C                   ADD       1             THTDN
     C                   UPDATE    NCTSESTDR
     C                   END
      *
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C                   EXSR      MOVNCTSEH
      *
     C                   MOVE      'E'           THST
     C                   IF        *IN33
     C                   EVAL      THAVD   = UAVD
     C                   EVAL      THTDN   = WSTDN
     C                   EVAL      THSG    = WSSG
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           THDT
     C                   MOVE      THDTD         WSDTD
     C                   MOVE      THDTM         WSDTM
     C                   MOVE      THDTA         WSDTA
     C                   IF        UTYPE = 'CPY' AND KAVD <> 0
     C                   EXSR      CPYNCTSEC
     C                   EVAL      KAVD = 0
     C                   END
     C                   Z-ADD     1             THTET
     C                   WRITE     NCTSEHR
     C                   IF        WSEXTR <> *BLANKS
     C                   EVAL      TRXAVD = THAVD
     C                   EVAL      TRXOPD = THTDN
     C                   EVAL      TRXLI  = 0
     C                   EVAL      TRXEXT = WSEXTR
     C                   WRITE     TRXREFR
     C                   END
      *
      * OPPDATER Z-FIL
      *
     C                   IF        ((Z_THREFF<>*BLANKS) AND (Z_THUNIK <> 0))     2<-B
     C     ZNCTSEH1K     CHAIN     ZNCTSEH1                           33
     C                   IF        *IN33 = *OFF                                   3<-B
     C                   EVAL      Z_THST   = 'O'
     C                   EVAL      Z_THAVD  = THAVD
     C                   EVAL      Z_THAVD  = THTDN
     C                   EVAL      Z_THDT   = THDT
     C                   UPDATE    ZNCTSEHR
     C                   END                                                      3<-E
     C                   EVAL      *IN33 = *ON
     C                   END                                                     2<-E
      *
     C                   END
     C  N33              UPDATE    NCTSEHR
      *
     C     WSLSTL        IFEQ      0
     C     NCTSEHK       SETLL     TRUHL
     C     NCTSEHK       READE     TRUHL                                  33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    TRUHLR
     C     NCTSEHK       READE     TRUHL                                  33
     C  N33              END
     C                   END
      *
      * FOR DE SOM REGISTRERER EGEN REF
      *
     C                   IF        ((THEKST = 'R') OR (EXTMAN = 'M'))
     C                   IF        (WSSOK <> *BLANKS)
     C     FRISOKK2      CHAIN     FRISOK                             33
     C                   EVAL      FSSOK = WSSOK
     C                   IF        *IN33
     C                   EVAL      FSKODE = '*CN'
     C                   EVAL      FSAVD  = THAVD
     C                   EVAL      FSOPD  = THTDN
     C                   EVAL      FSKODE = WSKODE
     C                   EVAL      FSSOK  = WSSOK
     C                   EVAL      FSDTOP = THDT
     C                   WRITE     FRISOKR
     C                   ELSE
     C                   EVAL      WSSOK  = WSEXTR
     C                   END
     C                   END
     C                   END
      *
     C   15              EXSR      TILKOD
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYNCTSEC     BEGSR
     C***********************************************
      *
     C     NCTSEHKK      SETLL     TRUHFS
     C     NCTSEHKK      READE     TRUHFS                                 33
     C     *IN33         IFEQ      '1'
     C     NCTSEHKK      SETLL     TRUHFS
     C     NCTSEHKK      READE     TRUHFS                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TFAVD
     C                   MOVE      THTDN         TFTDN
     C                   WRITE     TRUHFSR
     C     NCTSEHKK      READE     TRUHFS                                 33
     C  N33              ENDDO
     C                   END
      *
     C     NCTSEHKK      SETLL     TRUHL
     C     NCTSEHKK      READE(N)  TRUHL                                  33
     C     *IN33         IFEQ      '1'
     C     NCTSEHKK      SETLL     TRUHL
     C     NCTSEHKK      READE(N)  TRUHL                                  33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TLAVD
     C                   MOVE      THTDN         TLTDN
     C                   WRITE     TRUHLR
     C     NCTSEHKK      READE(N)  TRUHL                                  33
     C  N33              ENDDO
     C                   END
      *
     C     NCTSEHKK      SETLL     TRUHGB
     C     NCTSEHKK      READE     TRUHGB                                 33
     C     *IN33         IFEQ      '1'
     C     NCTSEHKK      SETLL     TRUHGB
     C     NCTSEHKK      READE     TRUHGB                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TGAVD
     C                   MOVE      THTDN         TGTDN
     C                   WRITE     TRUHGBR
     C     NCTSEHKK      READE     TRUHGB                                 33
     C  N33              ENDDO
     C                   END
      *
     C     NCTSEHK       SETLL     TRUHGN
     C     NCTSEHK       READE     TRUHGN                                 33
     C     *IN33         IFEQ      '1'
     C     NCTSEHKK      SETLL     TRUHGN
     C     NCTSEHKK      READE     TRUHGN                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TGAVD
     C                   MOVE      THTDN         TGTDN
     C                   WRITE     TRUHGNR
     C     NCTSEHKK      READE     TRUHGN                                 33
     C  N33              ENDDO
     C                   END
      *
     C     NCTSEHKK      SETLL     NCTSEC
     C     NCTSEHKK      READE     NCTSEC                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TCAVD
     C                   MOVE      THTDN         TCTDN
     C                   WRITE     NCTSECR
     C     NCTSEHKK      READE     NCTSEC                                 33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     NCTSEI
     C     NCTSEHKK      READE     NCTSEI                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TIAVD
     C                   MOVE      THTDN         TITDN
     C                   WRITE     NCTSEIR
     C     NCTSEHKK      READE     NCTSEI                                 33
     C  N33              ENDDO
      *
S10  C*    NCTSEHKK      SETLL     NCTSEIAM
S10  C*    NCTSEHKK      READE     NCTSEIAM                               33
S10  C*    *IN33         DOWEQ     '0'
S10  C*                  MOVE      THAVD         TIAVD
S10  C*                  MOVE      THTDN         TITDN
S10  C*                  WRITE     NCTSEIAMR
S10  C*    NCTSEHKK      READE     NCTSEIAM                               33
S10  C* N33              ENDDO
      *
     C     NCTSEHKK      SETLL     NCTSECAM
     C     NCTSEHKK      READE     NCTSECAM                               33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TCAVD
     C                   MOVE      THTDN         TCTDN
     C                   WRITE     NCTSECAMR
     C     NCTSEHKK      READE     NCTSECAM                               33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     TRUVCN
     C     NCTSEHKK      READE     TRUVCN                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     TRUVCNR
     C     NCTSEHKK      READE     TRUVCN                                 33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     TRUVDK
     C     NCTSEHKK      READE     TRUVDK                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     TRUVDKR
     C     NCTSEHKK      READE     TRUVDK                                 33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     TRUVFS
     C     NCTSEHKK      READE     TRUVFS                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     TRUVFSR
     C     NCTSEHKK      READE     TRUVFS                                 33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     TRUVMN
     C     NCTSEHKK      READE     TRUVMN                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     TRUVMNR
     C     NCTSEHKK      READE     TRUVMN                                 33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     TRUVTD
     C     NCTSEHKK      READE     TRUVTD                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     TRUVTDR
     C     NCTSEHKK      READE     TRUVTD                                 33
     C  N33              ENDDO
      *
     C     NCTSEHKK      SETLL     TRUVVT
     C     NCTSEHKK      READE     TRUVVT                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     TRUVVTR
     C     NCTSEHKK      READE     TRUVVT                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     TONCTSEC      BEGSR
     C***********************************************
      *
     C                   MOVE      *IN34         UIN34
     C                   MOVE      *IN27         UIN27
     C                   MOVE      UZREFF        U2REFF
     C                   MOVE      UZUNIK        U2UNIK
     C                   CALL      'NCTS012R'
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C     *IN27         IFEQ      '0'
     C                   MOVE      *ZEROS        WSVPOS
     C                   MOVE      *ZEROS        WSVKB
     C                   MOVE      *ZEROS        WSNTK
     C     NCTSEHK       SETLL     NCTSEI
     C     NCTSEHK       READE     NCTSEI                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             WSVPOS
N09  C                   IF        TIPNT > 0
     C                   ADD       TIVKB         WSVKB
N09  C                   ENDIF
     C     TIPNT         IFEQ      0
     C*                  ADD       TINTS         WSNTK
     C                   ELSE
     C                   ADD       TIPNT         WSNTK
     C                   END
     C     TIPTY         IFEQ      'VQ'
     C     TIPTY         OREQ      'VG'
     C     TIPTY         OREQ      'VL'
     C     TIPTY         OREQ      'VY'
     C     TIPTY         OREQ      'VR'
     C     TIPTY         OREQ      'VO'
     C     TIPTY         OREQ      'VS'
     C                   ADD       1             WSNTK
     C                   END
     C     NCTSEHK       READE     NCTSEI                                 33
     C  N33              ENDDO
      *
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C                   MOVE      WSPRO         THPRO
     C     WSLSTL        IFNE      0
     C                   MOVE      *ZEROS        WSVPOS
     C     NCTSEHK       SETLL     TRUHL
     C     NCTSEHK       READE     TRUHL                                  33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             WSVPOS
     C     NCTSEHK       READE     TRUHL                                  33
     C  N33              ENDDO
     C                   END
     C                   MOVE      WSVPOS        THVPOS
     C                   MOVE      WSVKB         THVKB
     C                   MOVE      WSNTK         THNTK
     C                   UPDATE    NCTSEHR
     C                   END
      *
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      2                                      17
     C     UFLAGG        COMP      3                                      03
      *
     C                   ENDSR
      *
     C***********************************************
     C     VISTOL        BEGSR
     C***********************************************
      *________________________
      * Call på eksternt CL-pgm
      *""""""""""""""""""""""""
     C                   MOVE      '2'           WIN03             1
     C                   CALL      'SAD003'
     C                   PARM      THAVD         UAVD
     C                   PARM      THTDN         UTDN
     C                   PARM                    WIN03
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTS         BEGSR
     C***********************************************
     C                   MOVE      WSKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            97
     C     *IN97         IFEQ      '1'                                          1<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     12            POSNBR
     C                   SETON                                        30
     C                   ELSE                                                   1
      * ikke flytt hvis vareadresse plukket
     c                   move      wspss         punkt             1
     c     punkt         ifne      '.'
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSAD1S
     C     SYPOGE        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      *BLANKS       WSPNS
     C                   MOVEL     POSTNR        WSPNS
     C                   ELSE                                                    2
     C                   MOVEL     SYPOGE        WSPNS
     C                   END                                                     2<-E
     C                   MOVE      ADR3          WSPSS
     c                   end
     C                   IF        SYLAND = *BLANKS                              2<-B
     C                   MOVE      SYLAND        WSLKS
     C                   END                                                     2<-E
     C                   IF        SYLAND <> *BLANKS                             2<-B
     C                   EVAL      WSLKS  = SYLAND
     C                   END                                                     2<-E
     C                   IF        WSCPS = *BLANKS                               2<-B
     C                   EVAL      WSCPS  = KPERS
     C                   END                                                     2<-E
     C                   IF        WSTLS = *BLANKS                               2<-B
     C                   EVAL      WSTLS  = TLF
     C                   END                                                     2<-E
     C                   IF        WSEMS = *BLANKS                               2<-B
     C                   EVAL      WSEMS  = SYEPOS
     C                   END                                                     2<-E
     C                   IF        WSTINS = *BLANKS                              2<-B
     C                   SELECT                                                   3<-B
     C                   WHEN      EORI = *BLANKS                                 3
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   IF        WSLKS = *BLANKS                                  5<-B
     C                   EVAL      WSTINS = 'NO' + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      WSTINS = WSLKS + SYFOR9
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   OTHER                                                    3
     C                   EVAL      WSTINS = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTK         BEGSR
     C***********************************************
     C                   MOVE      WSKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            90
     C     *IN90         IFEQ      '1'                                          1<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     15            LINNBR
     C  N30              Z-ADD     12            POSNBR
     C                   SETON                                        30
     C                   ELSE                                                   1
     c                   move      wspsk         punkt             1
     c     punkt         ifne      '.'
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSAD1K
     C     SYPOGE        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      *BLANKS       WSPNK
     C                   MOVEL     POSTNR        WSPNK
     C                   ELSE                                                    2
     C                   MOVEL     SYPOGE        WSPNK
     C                   END                                                     2<-E
     C                   MOVE      ADR3          WSPSK
     c                   end
     C     SYLAND        IFNE      *BLANKS                                       2<-B
     C                   MOVE      SYLAND        WSLKK
     C                   END                                                     2<-E
     C                   IF        WSTINK = *BLANKS                              2<-B
     C                   SELECT                                                   3<-B
     C                   WHEN      EORI = *BLANKS                                 3
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   IF        WSLKK = *BLANKS                                  5<-B
     C                   EVAL      WSTINK = 'NO' + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      WSTINK = WSLKK + SYFOR9
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   OTHER                                                    3
     C                   EVAL      WSTINK = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRU1          BEGSR
      ***********************************************
     C                   MOVE      UTDN          WSTDN
     C     NCTSEHK       CHAIN     NCTSEH                             98
     C     *IN98         IFEQ      '0'
     C                   MOVE      'E'           THST
     C                   UPDATE    NCTSEHR
     C                   GOTO      SLSRU
     C                   END
      *
      * HENT STANDARDVERDIER FOR AVDELING
     C     NCTSESTDK     CHAIN(N)  NCTSESTD                           98
     C  N98              MOVE      *BLANKS       THST
     C                   MOVE      *ZEROS        THGBL
     C                   MOVE      *ZEROS        THDDT
N06  C                   MOVE      *BLANKS       THLIDT
      * A3 = FORENKLET ER IKKE TILLATT VED NORMAL-PROSEDYRE
     C*                  IF        WSENKL = 'N' AND THDKR = 'A3'
     C                   IF        WSENKL = 'N'
     C*                  EVAL      THDKR = '  '
     C                   EVAL      THDDT = 0
N06  C                   EVAL      THLIDT = *BLANKS
     C                   ENDIF
      * HENT FRA OPPDRAG
     C                   CLEAR                   HEADFR
     C                   CLEAR                   SAEHR
     C     HEADFK        CHAIN     HEADF                              98
     C     HEADFK        CHAIN     SAEH                               33
     C   33              EVAL      SERG = *BLANKS
     C   98
     CANN33              MOVE      '0'           *IN98
     C                   MOVE      *ZEROS        WSTDN
      *
     C  N98WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          WSSG
     C                   END
     C     THTARF        IFEQ      *BLANKS
     C     KODTSIK       CHAIN     KOSIR                              97
     C  N97              MOVE      KSINAV        THTARF
     C                   END
      *
      *** START N98
     C  N98              DO                                                     1<-B
      *
      *.................................................
      *** FLYTT DATA FRA HEADF TIL TRUH
      ** AVSENDER HENT NAVN/ADR FRA REGISTER - EVT FRA OPPDRAG
     C                   MOVE      HEKNS         THKNS
     C                   MOVE      HEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'                                           2<-B
     C                   MOVE      *ZEROS        THKNS
     C                   MOVE      HENAS         THNAS
     C                   MOVE      HEADS1        THAD1S
     C                   MOVEL     HEADS3        THPNS
     C                   MOVEL     HEADS3        THPSS
     C                   IF        SERG <> *BLANKS
     C                   EVAL      THTINS = 'NO' + %TRIM(SERG)
     C                   END
     C                   ELSE                                                    2
     C                   MOVE      KNAVN         THNAS
     C                   MOVE      ADR1          THAD1S
     C     SYPOGE        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      *BLANKS       THPNS
     C                   MOVEL     POSTNR        THPNS
     C                   ELSE                                                     3
     C                   MOVEL     SYPOGE        THPNS
     C                   END                                                      3<-E
     C                   MOVE      ADR3          THPSS
     C     SYLAND        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FILAND        THLKS
     C                   ELSE                                                     3
     C                   MOVE      SYLAND        THLKS
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       WSTINS
     C                   SELECT                                                   3<-B
     C                   WHEN      EORI = *BLANKS                                 3<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   IF        THLKS = *BLANKS                                  5<-B
     C                   EVAL      THTINS = 'NO' + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      THTINS = THLKS + SYFOR9
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   OTHER                                                    3
     C                   EVAL      THTINS = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     HEUR          IFNE      'H'                                           2<-B
     C                   MOVE      HELKA         THBLK
     C                   ELSE                                                    2
     C                   MOVE      HETRI         THBLK
     C                   END                                                     2<-E
      *
      ** MOTTAKER HENT NAVN/ADR FRA REGISTER - EVT FRA OPPDRAG
     C                   MOVE      HEKNK         THKNK
     C                   MOVE      HEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'                                           2<-B
     C                   MOVE      *ZEROS        THKNK
     C                   MOVE      *BLANKS       THTINK
     C                   MOVE      HENAK         THNAK
     C                   MOVE      HEADK1        THAD1K
     C                   MOVEL     HEADK3        THPNK
     C                   MOVEL     HEADK3        THPSK
     C                   MOVE      HELKK         THLKK
     C                   ELSE                                                    2
     C                   MOVE      KNAVN         THNAK
     C                   MOVE      ADR1          THAD1K
     C     SYPOGE        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      *BLANKS       THPNK
     C                   MOVEL     POSTNR        THPNK
     C                   ELSE                                                     3
     C                   MOVEL     SYPOGE        THPNK
     C                   END                                                      3<-E
     C                   MOVE      ADR3          THPSK
     C     SYLAND        IFNE      *BLANKS                                        3<-B
     C                   MOVE      SYLAND        THLKK
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       WSTINK
     C                   SELECT                                                   3<-B
     C                   WHEN      EORI = *BLANKS                                 3<-B
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))    4<-B
     C                   IF        THLKK = *BLANKS                                  5<-B
     C                   EVAL      THTINK = 'NO' + SYFOR9
     C                   ELSE                                                       5
     C                   EVAL      THTINK = THLKK + SYFOR9
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   OTHER                                                    3
     C                   EVAL      THTINK = EORI
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C                   Z-ADD     HENT          THNTK
     C                   Z-ADD     HEVKT         THVKB
     C     SELKB         IFNE      *BLANKS                                       2<-B
     C                   MOVE      SELKB         THBLK
     C                   END                                                     2<-E
     C     SETRID        IFNE      *BLANKS                                       2<-B
     C     SELKT         ORNE      *BLANKS
     C                   MOVEL     SETRID        THTGID
     C                   MOVE      SELKT         THTGLK
     C                   MOVEL     SETRID        THTAID
     C                   MOVE      SELKT         THTALK
     C                   END                                                     2<-E
     C     SETRID        IFEQ      *BLANKS                                       2<-B
     C     SELKT         andeq     *BLANKS
     c     hepro         andne     0
     C     HEPRO         CHAIN     TURER14                            98
     c     *in98         ifeq      '0'
     C                   eval      thtgid=tubiln
     c     tuheng        ifne      *blanks
     c     thtgid        cat       ',':0         thtgid
     c     thtgid        cat       tuheng:0      thtgid
     c                   end
     C                   eval      thtglk=tulk
     C                   eval      thtaid=thtgid
     C                   eval      thtalk=tulk
     C                   end
     C                   end
     C     SETRM         IFNE      0                                             2<-B
     C                   MOVE      SETRM         THTRM
     C                   MOVE      SETRM         THTRMG
     C                   END                                                     2<-E
     C*                  MOVE      *ZEROS        THDDTK
     C*                  MOVE      *BLANKS       THDATS
     C                   MOVE      *BLANKS       THDKAV
     C                   MOVE      *BLANKS       THDKTX
     C                   MOVE      UTDN          WSTDN
     C     WSSG          IFEQ      *BLANKS                                       2<-B
     C                   MOVE      HESG          THSG
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *
     C     SLSRU         TAG
     C                   SETOFF                                       9897
      *
     C                   ENDSR
      *
      ***********************************************
     C*    PRINT         BEGSR
      ***********************************************
     C*                  Z-ADD     7             UFLAGG            1 0
     C*                  MOVE      *IN34         UIN34
     C*                  CALL      'NCTS012RT'
     C*                  PARM      UPARM2        UPARM1
     C*                  PARM                    UFLAGG
      *
     C*    UFLAGG        COMP      1                                      12
      *
     C*                  ENDSR
      *
      ***********************************************
     C     HZFIL         BEGSR
      ***********************************************
     C                   MOVE      UZUNIK        Z_THUNIK
     C                   MOVE      UZREFF        Z_THREFF
      *
     C     ZNCTSEH1K     CHAIN(N)  ZNCTSEH1                           98
     C     *IN98         IFEQ      '0'                                          1<-B
     C                   IF        WSDK = *BLANKS                                2<-B
     C                   MOVE      Z_THDK        WSDK
     C                   END                                                     2<-E
      *
     C                   IF        ((WSKNH = 0) AND (WSNAS = *BLANKS))           2<-B
     C                   MOVE      Z_THKNH       WSKNH
     C                   MOVE      Z_THTINH      WSTINH
     C                   MOVE      Z_THTIRH      WSTIRH
     C                   MOVE      Z_THNAH       WSNAH
     C                   MOVE      Z_THAD1H      WSAD1H
     C                   MOVE      Z_THPNH       WSPNH
     C                   MOVE      Z_THPSH       WSPSH
     C                   MOVE      Z_THLKH       WSLKH
     C                   MOVE      Z_THCPH       WSCPH
     C                   MOVE      Z_THTLH       WSTLH
     C                   MOVE      Z_THEMH       WSEMH
     C                   END                                                     2<-E
      *
     C                   IF        WSKNA = 0                                     2<-B
     C                   MOVE      Z_THKNA       WSKNA
     C                   MOVE      Z_THTINA      WSTINA
     C                   MOVE      Z_THSTA       WSSTA
     C                   MOVE      Z_THCPA       WSCPA
     C                   MOVE      Z_THTLA       WSTLA
     C                   MOVE      Z_THEMA       WSEMA
     C                   END                                                     2<-E
      *
     C                   IF        ((WSKNS = 0) AND (WSNAS = *BLANKS))           2<-B
     C                   MOVE      Z_THKNS       WSKNS
     C                   MOVE      Z_THTINS      WSTINS
     C                   MOVE      Z_THNAS       WSNAS
     C                   MOVE      Z_THAD1S      WSAD1S
     C                   MOVE      Z_THPNS       WSPNS
     C                   MOVE      Z_THPSS       WSPSS
     C                   MOVE      Z_THLKS       WSLKS
     C                   MOVE      Z_THCPS       WSCPS
     C                   MOVE      Z_THTLS       WSTLS
     C                   MOVE      Z_THEMS       WSEMS
     C                   END                                                     2<-E
     C                   IF        ((WSKNK = 0) AND (WSNAK = *BLANKS))           2<-B
     C                   MOVE      Z_THTINK      WSTINK
     C                   MOVE      Z_THKNK       WSKNK
     C                   MOVE      Z_THNAK       WSNAK
     C                   MOVE      Z_THAD1K      WSAD1K
     C                   MOVE      Z_THPNK       WSPNK
     C                   MOVE      Z_THPSK       WSPSK
     C                   MOVE      Z_THLKK       WSLKK
     C                   END                                                     2<-E
     C                   IF        WSBLK = *BLANKS                               2<-B
     C                   MOVE      Z_THBLK       WSBLK
     C                   END                                                     2<-E
     C                   IF        WSLSNA = *BLANKS                              2<-B
     C                   MOVE      Z_THLSNA      WSLSNA
     C                   END                                                     2<-E
     C                   IF        WSALK = *BLANKS                               2<-B
     C                   MOVE      Z_THALK       WSALK
     C                   END                                                     2<-E
     C                   IF        WSTRM = 0                                     2<-B
     C                   MOVE      Z_THTRM       WSTRM
     C                   END                                                     2<-E
     C                   IF        WSTRMG = 0                                    2<-B
     C                   MOVE      Z_THTRMG      WSTRMG
     C                   END                                                     2<-E
     C                   IF        WSTAID = *BLANKS                              2<-B
     C                   MOVE      Z_THTAID      WSTAID
     C                   MOVE      Z_THTALK      WSTALK
     C                   END                                                     2<-E
     C                   IF        WSTGID = *BLANKS                              2<-B
     C                   MOVE      Z_THTGID      WSTGID
     C                   MOVE      Z_THTGLK      WSTGLK
     C                   END                                                     2<-E
     C                   IF        WSTSD1 = *BLANKS                              2<-B
     C                   MOVE      Z_THTSD1      WSTSD1
     C                   MOVE      Z_THTSD2      WSTSD2
     C                   MOVE      Z_THTSD3      WSTSD3
     C                   MOVE      Z_THTSD4      WSTSD4
     C                   MOVE      Z_THTSD5      WSTSD5
     C                   MOVE      Z_THTSD6      WSTSD6
     C                   MOVE      Z_THTSD7      WSTSD7
     C                   MOVE      Z_THTSD8      WSTSD8
     C                   END                                                     2<-E
     C                   IF        WSTSB = *BLANKS                               2<-B
     C                   MOVE      Z_THTSB       WSTSB
     C                   END                                                     2<-E
     C                   IF        WSKDC = *BLANKS                               2<-B
     C                   MOVE      Z_THKDC       WSKDC
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    UAVD
     C                   MOVE      'A'           KOAUNI
     C     SAMLBK        KLIST
     C                   KFLD                    SMSD
     C                   KFLD                    SMLNR
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYI            1
     C                   MOVE      'N'           DELSYI
     C     FRAT2K        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYB            1
     C     NCTSEHK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     NCTSEH10K     KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UPRO2
     C     NCTSEHKK      KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KTDN
     C     NCTSESTDK     KLIST
     C                   KFLD                    UAVD
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     TRUGDK        KLIST
     C                   KFLD                    WSGFT1
     C                   KFLD                    WSGADK
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     BILLK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     SYPARL1K      KLIST
     C                   KFLD                    WSKNK
     C                   KFLD                    SYPAID
     C                   EVAL      SYPAID = 'TETBS'
     C     KODTSIK       KLIST
     C                   KFLD                    XSIUNI
     C                   KFLD                    WSSG
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    KS2LK
     C*    KODS4K        KLIST
     C*                  KFLD                    XS4UNI
     C*                  KFLD                    WSTRM
     C     TVINMK        KLIST
     C                   KFLD                    YST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     TVIM4K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C                   KFLD                    MAX0D
     C     TVI41K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     NCTSEHKFRI    KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     FRISOL01K     KLIST
     C                   KFLD                    WSKODE            3
     C                   KFLD                    WSEXTR
     C                   MOVEL     '*CN'         WSKODE
     C     FRISOKK1      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C                   KFLD                    WSKODE            3
     C     FRISOL01K2    KLIST
     C                   KFLD                    WSKODE2           3
     C                   KFLD                    WSEXTR
     C                   MOVEL     '*CE'         WSKODE2
     C     FRISOKK2      KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    WSKODE            3
     C     ZNCTSEH1K     KLIST
     C                   KFLD                    Z_THREFF
     C                   KFLD                    Z_THUNIK
      *
     C     *LIKE         DEFINE    THTDN         UTDN
     C     *LIKE         DEFINE    THPRO         UPRO
     C     *LIKE         DEFINE    THPRO         UPRO2
     C     *LIKE         DEFINE    THSG          USG
     C     *LIKE         DEFINE    THWS          UWS
     C     *LIKE         DEFINE    THTARF        WSTARF
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C     WSTDN         PARM      WSTDN         UTDN
     C     UPRO2         PARM                    UPRO
     C     WSSG          PARM                    USG
     C                   PARM                    UTYPE             3
     C                   PARM                    UIE               1
     C     UWS2          PARM      UWS2          UWS
     C                   PARM                    UFLAGG            1 0
      *
     C     'NCTS0100'    CHAIN     SYPTFF                             33
     C                   IF        *IN33
     C                   MOVE      99999999      X_FASE5           8 0
     C                   ELSE
     C                   MOVE      PTFDT         X_FASE5
     C                   END
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
     C                   MOVE      *ZEROS        THAVD
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *BLANKS       BLUR
     C                   MOVE      '0'           UIN27
     C                   MOVE      '0'           UIN34
     C                   MOVE      *ZEROS        THVKB
     C                   MOVE      *BLANKS       U1N07
      *
     C     UTYPE         IFEQ      'CSL'
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      'J'           WSTOLK
     C                   MOVE      'N'           WSTVIN
     C                   MOVE      '1'           UIN34
     C                   MOVE      '014'         U1N07
     C                   CALL      'NCTS012RT'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C     UTYPE         IFEQ      'REL'
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      'J'           WSTOLK
     C                   MOVE      'N'           WSTVIN
     C                   MOVE      '1'           UIN34
     C                   MOVE      '054'         U1N07
     C                   CALL      'NCTS012RT'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C     UTYPE         IFEQ      'NON'
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      'J'           WSTOLK
     C                   MOVE      'N'           WSTVIN
     C                   MOVE      '1'           UIN34
     C                   MOVE      '141'         U1N07
     C                   CALL      'NCTS012RE'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C     UTYPE         IFEQ      'NOT'
     C     NCTSEHK       CHAIN(N)  NCTSEH                             33
     C* N33              IF        THLSUN = *BLANKS
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVEA     '11'          *IN(31)
     C                   EXSR      MOVW2
     C                   GOTO      TAG_NOT1
     C*                  END
     C                   MOVE      'J'           WSTOLK
     C                   MOVE      'N'           WSTVIN
     C                   MOVE      '1'           UIN34
     C                   MOVE      '170'         U1N07
     C                   CALL      'NCTS012RT'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C     UTYPE         IFEQ      'CHG'
     C     NCTSEHK       CHAIN(N)  NCTSEH                             33
     C                   MOVE      THENKL        X_THENKL          1
     C                   END
      *
     C     UTYPE         IFEQ      'PRT'
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C  N31              DO
     C                   MOVE      UWS           THWS
     C                   MOVE      'K'           THST
     C                   MOVE      'J'           THPKL
     C                   MOVE      ' '           TH0035
     C                   UPDATE    NCTSEHR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   END
      *
     C     UPRO2         IFNE      0
     C     NCTSEH10K     SETLL     NCTSEH10
     C     NCTSEH10K     READE     NCTSEH10                               33
     C     *IN33         DOWEQ     '0'
     C     THLSTL        IFGT      0
     C                   MOVE      THTDN         UTDN
     C                   MOVE      THTDN         WSTDN
     C                   MOVE      *ZEROS        UPRO2
     C                   MOVE      'CHG'         UTYPE
     C                   LEAVE
     C                   END
     C     NCTSEH10K     READE     NCTSEH10                               33
     C  N33              ENDDO
     C                   END
      *
     C     UTYPE         COMP      'DSP'                                  27
     C     UTYPE         COMP      'CHG'                                  31
     C     UTYPE         COMP      'CHG'                                  32
     C  N32UTYPE         COMP      'CPY'                                  32
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          KAVD              4 0
     C                   MOVE      WSTDN         KTDN              7 0
     C                   MOVE      *ZEROS        WSTDN
     C                   END
      *
     C     TAG_NOT1      TAG
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        KUNDNR            8 0
     C                   MOVE      'SI'          XSIUNI            2
     C                   MOVE      'S2 '         XS2UNI            3
     C*                  MOVE      'S4 '         XS4UNI            3
     C                   MOVE      ' '           YST               1
     C                   MOVE      '99999999'    MAX0B             8 0
     C                   MOVE      '999999'      MAX0C             6 0
     C                   MOVE      '99'          MAX0D             2 0
     C                   MOVE      'R'           XSR1              1
     C                   MOVE      'N'           USPED             1
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDDT
     C                   MOVE      *ZEROS        WSTRDT
     C                   MOVE      *BLANKS       WSEMC
     C                   MOVE      *ZEROS        THDT
     C                   MOVE      *ZEROS        THDDT
N06  C                   MOVE      *BLANKS       THLIDT
     C                   MOVE      *ZEROS        THTRDT
     C     UIE           COMP      'I'                                    41
      *
     C                   Z-ADD     3             SOANTK            1 0
     C                   MOVE      'AVSENDER'    SOTXT1            8
     C                   MOVE      'MOTTAKER'    SOTXT2            8
     C                   MOVE      'H.ANSVAR'    SOTXT3            8
     C                   MOVE      *BLANKS       SOTXT4            8
     C                   MOVE      *BLANKS       SOTXT5            8
     C                   MOVE      *BLANKS       SOTXT6            8
     C                   MOVE      *BLANKS       SOTXT7            8
     C                   MOVE      *BLANKS       SOTXT8            8
     C                   MOVE      *ZEROS        SOKNR4            8 0
     C                   MOVE      *ZEROS        SOKNR5            8 0
     C                   MOVE      *ZEROS        SOKNR6            8 0
     C                   MOVE      *ZEROS        SOKNR7            8 0
     C                   MOVE      *ZEROS        SOKNR8            8 0
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     UTYPE         IFNE      'NOT'
     C     UAVD          CHAIN(N)  NCTSESTD                           33
     C                   IF        THDDT < 100
     C                   Z-ADD     THDDT         XANTDG
     C                   ELSE
     C                   MOVE      *ZEROS        XANTDG            3 0
     C                   END
     C                   MOVE      *ZEROS        THDDT
N06  C                   MOVE      *BLANKS       THLIDT
      * WSTVIN = J BETYR SKRIVES NÅ
     C                   MOVE      'J'           WSTOLK
     C                   MOVE      'N'           WSTVIN
     C     UTYPE         IFEQ      'CHG'
     C                   MOVE      X_THENKL      WSENKL
     C                   ELSE
     C                   MOVE      THENKL        WSENKL
     C                   END
     C                   END
     C     HEADFK        SETLL     HEADF
     C                   READ      HEADF                                  36
     C                   MOVE      *IN36         UIN36
      *
      * henteventuell externrefkode
      *
     C     FRISOKK1      CHAIN     FRISOK                             33
     C  N33              MOVEL     FSSOK         WSEXTR
     C     THEKST        COMP      'R'                                4444
      *
     C                   ENDSR
      *
      *
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * AVSENDER   ...
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C     WSKNS         ANDGT     0
     C                   MOVE      WSKNS         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
      * MOTTAGER   ...
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C     WSKNK         ANDGT     0
     C                   MOVE      WSKNK         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
      * HOVEDANSVARLIG   ...
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C     WSKNA         ANDGT     0
     C                   MOVE      WSKNA         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
      *
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR            8 0
     C                   PARM                    XSKMOT            8
     C                   PARM                    UFLAGG
     C                   PARM                    DELSYI
      *
     C     SLVISO        ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   MOVEA     '000'         *IN(37)
     C                   MOVEA     '00'          *IN(28)
     C                   MOVE      '0'           *IN35
      *** TEST OM SELGER OPPLYSNING. HVIS DET, SETT 37 PÅ
     C                   MOVE      WSKNS         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        37
      *
      *** TEST OM KJØPER OPPLYSNING. HVIS DET, SETT 38 PÅ
     C                   MOVE      WSKNK         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        38
      *
      *** TEST OM HOVEDANSVALIG OPPLYSNING. HVIS DET, SETT 39 PÅ
     C                   MOVE      WSKNA         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        39
      *** TEST OM FLERE LANDKODER PÅ GARANTIBEGRENSNING
     C     NCTSEHK       SETLL     TRUHGB
     C     NCTSEHK       READE     TRUHGB                                 33
     C  N33              SETON                                        28
      *** TEST OM FLERE FORSEGLINGSLINJER
     C     NCTSEHK       SETLL     TRUHFS
     C     NCTSEHK       READE     TRUHFS                                 33
     C  N33              SETON                                        29
      *** TEST OM FLERE FORSEGLINGSLINJER
     C     NCTSEHK       SETLL     TRUHGN
     C     NCTSEHK       READE     TRUHGN                                 33
     C  N33              SETON                                        35
      *
     C                   ENDSR
      *
