      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/ESOVERS21 MODULE(*LIBL/ESOVERS21 *LIBL/INCGI)
CRTPGM*        ACTGRP(CGI) AUT(*USE)
      *
      *********************************************************************
      * MAIN PROGRAM FLOW
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
     FBRIDF     IF   E           K DISK    USROPN
     FBRPARF    IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FBILLOF    UF   E           K DISK    USROPN
     FBILLOFOS  UF A E           K DISK    USROPN
     FBLV1      IF   E           K DISK    USROPN
     FCCBLV1    IF A E           K DISK    USROPN
     F                                     PREFIX(CC_)
     FSTED2     IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Prototype defintions and standard system API error structure
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      *--------------------------------------------------------------------
      * Variables common to CGI programs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,variables3
      *--------------------------------------------------------------------
      * Variables received from the input string
     D WSUSER          S             10
     D UsrSpcName      s             10
     D WSAVD           S              4
     D WSOPD           S              7
     D WSBLFORM        S              1
     D WSNTBS          S             10
     D WSVESSEL        S             30
     D WSNAA           S             30
     D WSAD1A          S             30
     D WSAD2A          S             30
     D WSAD3A          S             30
     D WSNAM           S             30
     D WSAD1M          S             30
     D WSAD2M          S             30
     D WSAD3M          S             30
     D WSNAN           S             30
     D WSAD1N          S             30
     D WSAD2N          S             30
     D WSAD3N          S             30
     D WSLSSNV         S             25
     D WSLSHNV         S             25
     D WSLOHNV         S             30
     D WSLOSNV         S             30
     D WSREFS          S             20
     D WSFD1           S             40
     D WSFD2           S             40
     D WSFD3           S             40
     D WSPLC           S             25
     D WSPDT           S             15
     D WSGB1           S             35
     D WSGB2           S             35
     D WSTXT1          S            100
     D WSTXT2          S            100
     D WSTXT3          S            100
     D WSTXT4          S            100
     D WSSIDE2         S              1
     D IFSFIL          S             50
     D Dialog          S              1
      * Number of records matching search criteria
      *
     D Lib             s             10
     D Fn              s             10
     D Mbr             s             10
      *
     D Spaces          s             12a   inz('&nbsp;&nbsp;')
      * For xlate mellom Upper Case og Lower Case
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
      *--------------------------------------------------------------------
      * Prolog common to CGI programs
      * -Receive input from the remote browser
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prolog3
      *=====================================================================******
      * MAIN PROCESS LINE
      *=====================================================================******
      * Parse input
     C                   exsr      Parse
      *
     C                   EXSR      INIT
      **
      ** Ved behov for dialog FØR spool kjøres legges den her...
     C     Dialog        IFeq      'J'
     C                   OPEN      HEADF
     C                   OPEN      BILLOF
     C                   OPEN      BILLOFOS
     C                   OPEN      BLV1
     C                   OPEN      CCBLV1
     C                   OPEN      STED2
     C     BILLOFK       CHAIN     HEADF                              33
     C     BILLOFK       CHAIN(N)  BILLOF                             33
     C     BILLOFK       CHAIN(N)  BILLOFOS                           33
     C                   SELECT
     C                   WHEN      BLKDP = 'CCBLD' OR BLKDP = *BLANKS OR
     C                             BLKDP = 'CCBL'
     C                   EVAL      WSBLFORM = 'D'
     C                   WHEN      BLKDP = 'CCBLC'
     C                   EVAL      WSBLFORM = 'C'
     C                   WHEN      BLKDP = 'CCBLO'
     C                   EVAL      WSBLFORM = 'O'
     C                   ENDSL
     C                   EVAL      WSNTBS   = BLNTBS
     C                   EVAL      WSVESSEL = BLNAB
     C                   EVAL      WSNAA    = BLNAA
     C                   EVAL      WSAD1A   = BLAD1A
     C                   EVAL      WSAD2A   = BLAD2A
     C                   EVAL      WSAD3A   = BLAD3A
     C                   EVAL      WSNAM    = BLNAM
     C                   EVAL      WSAD1M   = BLAD1M
     C                   EVAL      WSAD2M   = BLAD2M
     C                   EVAL      WSAD3M   = BLAD3M
     C                   IF        BLNAN = *BLANKS
     C                   EVAL      WSNAN    = BLNAM
     C                   EVAL      WSAD1N   = BLAD1M
     C                   EVAL      WSAD2N   = BLAD2M
     C                   EVAL      WSAD3N   = BLAD3M
     C                   ELSE
     C                   EVAL      WSNAN    = BLNAN
     C                   EVAL      WSAD1N   = BLAD1N
     C                   EVAL      WSAD2N   = BLAD2N
     C                   EVAL      WSAD3N   = BLAD3N
     C                   END
     C                   IF        BLREFS = *BLANKS
     C                   EVAL      WSREFS   = HERFA
     C                   ELSE
     C                   EVAL      WSREFS   = BLREFS
     C                   END
      *
     C                   IF        BLLSSNV = *BLANKS AND BLLSHNV = *BLANKS AND
     C                             BLLOHNV = *BLANKS AND BLLOSNV = *BLANKS
     C     BLLSS         CHAIN     STED2                              33
     C  N33              EVAL      WSLSSNV = ST2NVN
     C   33              EVAL      WSLSSNV = BLLSS
     C     BLLSH         CHAIN     STED2                              33
     C  N33              EVAL      WSLSHNV = ST2NVN
     C   33              EVAL      WSLSHNV = BLLSH
     C     BLLOH         CHAIN     STED2                              33
     C  N33              EVAL      WSLOHNV = ST2NVN
     C   33              EVAL      WSLOHNV = BLLOH
     C     BLLOS         CHAIN     STED2                              33
     C  N33              EVAL      WSLOSNV = ST2NVN
     C   33              EVAL      WSLOSNV = BLLOS
     C                   ELSE
     C                   EVAL      WSLSSNV = BLLSSNV
     C                   EVAL      WSLSHNV = BLLSHNV
     C                   EVAL      WSLOHNV = BLLOHNV
     C                   EVAL      WSLOSNV = BLLOSNV
     C                   END
      *
     C                   IF        BLFD1 = *BLANKS
     C                   EVAL      WSFD1   = HEFR
     C                   ELSE
     C                   EVAL      WSFD1   = BLFD1
     C                   END
     C                   EVAL      WSFD2   = BLFD2
     C                   EVAL      WSFD3   = BLFD3
     C                   IF        BLPLC = *BLANKS
     C     BLLSH         CHAIN     STED2                              33
     C  N33              EVAL      WSPLC = ST2NVN
     C   33              EVAL      WSPLC = BLLSH
     C                   ELSE
     C                   EVAL      WSPLC = BLPLC
     C                   END
     C                   IF        BLPDT = *BLANKS
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   EVAL      WSPDT = %SUBST(WDT:7:2)
     C                   SELECT
     C                   WHEN      %SUBST(WDT:5:2) = '01'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. JANUARY'
     C                   WHEN      %SUBST(WDT:5:2) = '02'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. FEBRUARY'
     C                   WHEN      %SUBST(WDT:5:2) = '03'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. MARCH'
     C                   WHEN      %SUBST(WDT:5:2) = '04'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. APRIL'
     C                   WHEN      %SUBST(WDT:5:2) = '05'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. MAY'
     C                   WHEN      %SUBST(WDT:5:2) = '06'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. JUNE'
     C                   WHEN      %SUBST(WDT:5:2) = '07'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. JULY'
     C                   WHEN      %SUBST(WDT:5:2) = '08'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. AUGUST'
     C                   WHEN      %SUBST(WDT:5:2) = '09'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. SEPTEMBER'
     C                   WHEN      %SUBST(WDT:5:2) = '10'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. OCTOBER'
     C                   WHEN      %SUBST(WDT:5:2) = '11'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. NOVEMBER'
     C                   WHEN      %SUBST(WDT:5:2) = '12'
     C                   EVAL      WSPDT = %TRIM(WSPDT) + '. DESEMBER'
     C                   ENDSL
     C                   EVAL      WSPDT = %TRIM(WSPDT) + ' ' + %SUBST(WDT:1:4)
     C                   ELSE
     C                   EVAL      WSPDT = BLPDT
     C                   END
      *
     C                   IF        BLGB1 = *BLANKS
     C                   EVAL      WSGB1 = HEVS1
     C                   EVAL      WSGB2 = HEVS2
     C                   ELSE
     C                   EVAL      WSGB1 = BLGB1
     C                   EVAL      WSGB2 = BLGB2
     C                   END
     C                   EVAL      WSTXT1 = BLTXT1
     C                   EVAL      WSTXT2 = BLTXT2
     C                   EVAL      WSTXT3 = BLTXT3
     C                   EVAL      WSTXT4 = BLTXT4
      *
     C     BILLOFK       CHAIN     CCBLV1                             33
     C                   IF        *IN33
     C     BILLOFK       CHAIN     BLV1                               33
     C                   DOW       *IN33 = *OFF
     C                   EVAL      CC_BVAVD  = BVAVD
     C                   EVAL      CC_BVOPD  = BVOPD
     C                   EVAL      CC_BVLI   = BVLI
     C                   EVAL      CC_BVSORT = BVSORT
     C                   EVAL      CC_BVMN   = BVMN
     C                   EVAL      CC_BVNT   = BVNT
     C                   EVAL      CC_BVVKT  = BVVKT
     C                   EVAL      CC_BVM3   = BVM3
     C                   EVAL      CC_BVENH  = BVENH
     C                   EVAL      CC_BVKDC  = BVKDC
     C                   WRITE     CCBLV1R
     C     BILLOFK       READE     BLV1                                   33
     C                   ENDDO
     C                   END
      *
     C                   close     HEADF
     C                   close     BILLOF
     C                   close     BILLOFOS
     C                   close     BLV1
     C                   close     CCBLV1
     C                   close     STED2
     C                   exsr      SetSklSpool1
     C                   callp     gethtml(fn:lib:mbr:'/CGITAG/')
     C                   callp     updhtmlvar('USER':WSUSER)
     C                   callp     updhtmlvar('UsrSpcName':UsrSpcName)
     C                   callp     updhtmlvar('WSAVD':WSAVD)
     C                   callp     updhtmlvar('WSOPD':WSOPD)
     C                   if        BLReis <> *blanks
     C                   callp     updHtmlVar('WSREIS':BLREIS)                  HouseB/L (kun outp.)
     C                   else
     C                   callp     updHtmlVar('WSREIS':'_________')             HouseB/L (kun outp.)
     C                   endif
     C                   callp     updhtmlvar('WSBLFORM':WSBLFORM)
     C                   callp     updhtmlvar('WSNTBS':WSNTBS)
     C                   callp     updhtmlvar('WSVESSEL':WSVESSEL)
     C                   callp     updhtmlvar('WSNAA':WSNAA)
     C                   callp     updhtmlvar('WSAD1A':WSAD1A)
     C                   callp     updhtmlvar('WSAD2A':WSAD2A)
     C                   callp     updhtmlvar('WSAD3A':WSAD3A)
     C                   callp     updhtmlvar('WSNAM':WSNAM)
     C                   callp     updhtmlvar('WSAD1M':WSAD1M)
     C                   callp     updhtmlvar('WSAD2M':WSAD2M)
     C                   callp     updhtmlvar('WSAD3M':WSAD3M)
     C                   callp     updhtmlvar('WSNAN':WSNAN)
     C                   callp     updhtmlvar('WSAD1N':WSAD1N)
     C                   callp     updhtmlvar('WSAD2N':WSAD2N)
     C                   callp     updhtmlvar('WSAD3N':WSAD3N)
     C                   callp     updhtmlvar('WSLSSNV':WSLSSNV)
     C                   callp     updhtmlvar('WSLSHNV':WSLSHNV)
     C                   callp     updhtmlvar('WSLOHNV':WSLOHNV)
     C                   callp     updhtmlvar('WSLOSNV':WSLOSNV)
     C                   callp     updhtmlvar('WSREFS':WSREFS)
     C                   callp     updhtmlvar('WSFD1':WSFD1)
     C                   callp     updhtmlvar('WSFD2':WSFD2)
     C                   callp     updhtmlvar('WSFD3':WSFD3)
     C                   callp     updhtmlvar('WSPLC':WSPLC)
     C                   callp     updhtmlvar('WSPDT':WSPDT)
     C                   callp     updhtmlvar('WSTXT1':WSTXT1)
     C                   callp     updhtmlvar('WSTXT2':WSTXT2)
     C                   callp     updhtmlvar('WSTXT3':WSTXT3)
     C                   callp     updhtmlvar('WSTXT4':WSTXT4)
     C                   callp     updhtmlvar('WSGB1':WSGB1)
     C                   callp     updhtmlvar('WSGB2':WSGB2)
     C                   callp     wrtsection('top')
     C                   callp     wrtsection('endhtml')
     C                   else
     C                   OPEN      BILLOF
     C                   OPEN      BILLOFOS
     C     BILLOFK       CHAIN     BILLOF                             33
     C                   IF        *IN33 = *OFF
     C                   IF        WSSIDE2 <> 'J'
     C                   SELECT
     C                   WHEN      WSBLFORM = 'D'
     C                   EVAL      BLKDP = 'CCBLD'
     C                   WHEN      WSBLFORM = 'C'
     C                   EVAL      BLKDP = 'CCBLC'
     C                   WHEN      WSBLFORM = 'O'
     C                   EVAL      BLKDP = 'CCBLO'
     C                   OTHER
     C                   EVAL      BLKDP = 'CCBLD'
     C                   ENDSL
     C                   EVAL      BLNTBS = WSNTBS
     C                   EVAL      BLNAA  = WSNAA
     C                   EVAL      BLAD1A = WSAD1A
     C                   EVAL      BLAD2A = WSAD2A
     C                   EVAL      BLAD3A = WSAD3A
     C                   EVAL      BLNAM  = WSNAM
     C                   EVAL      BLAD1M = WSAD1M
     C                   EVAL      BLAD2M = WSAD2M
     C                   EVAL      BLAD3M = WSAD3M
     C                   EVAL      BLNAN  = WSNAN
     C                   EVAL      BLAD1N = WSAD1N
     C                   EVAL      BLAD2N = WSAD2N
     C                   EVAL      BLAD3N = WSAD3N
     C                   EVAL      BLAD3G = WSREFS
      *
     C     BILLOFK       CHAIN     BILLOFOS                           33
     C                   EVAL      BLNAB  = WSVESSEL
     C                   EVAL      BLREFS = WSREFS
     C                   EVAL      BLFD1  = WSFD1
     C                   EVAL      BLFD2  = WSFD2
     C                   EVAL      BLFD3  = WSFD3
     C                   EVAL      BLPLC  = WSPLC
     C                   EVAL      BLPDT  = WSPDT
     C                   EVAL      BLGB1  = WSGB1
     C                   EVAL      BLGB2  = WSGB2
     C                   EVAL      BLLSSNV = WSLSSNV
     C                   EVAL      BLLSHNV = WSLSHNV
     C                   EVAL      BLLOHNV = WSLOHNV
     C                   EVAL      BLLOSNV = WSLOSNV
     C                   EVAL      BLTXT1 = WSTXT1
     C                   EVAL      BLTXT2 = WSTXT2
     C                   EVAL      BLTXT3 = WSTXT3
     C                   EVAL      BLTXT4 = WSTXT4
     C  N33              UPDATE    BLOSR
     C   33              WRITE     BLOSR
      *
     C                   END
      *
     C                   UPDATE    BILLOFR
     C                   END
      *
     C                   close     BILLOF
     C                   close     BILLOFOS
      *  Kall prog for å generere html-fil eller PDF-fil i IFS.
     C                   MOVE      BLAVD         WSAVD
     C                   MOVE      BLOPD         WSOPD
     C                   SELECT
     C                   WHEN      WSBLFORM = 'C'
     C                   EVAL      XOVL = 'CCBLC'
     C                   WHEN      WSBLFORM = 'D'
     C                   EVAL      XOVL = 'CCBLD'
     C                   WHEN      WSBLFORM = 'O'
     C                   EVAL      XOVL = 'CCBLO'
     C                   OTHER
     C                   EVAL      XOVL = 'CCBLD'
     C                   ENDSL
     C                   IF        XOVERLAY = 'V'
     C                   SELECT
     C                   WHEN      WSBLFORM = 'C'
     C                   EVAL      XOVL = 'CCBBC'
     C                   WHEN      WSBLFORM = 'D'
     C                   EVAL      XOVL = 'CCBBD'
     C                   WHEN      WSBLFORM = 'O'
     C                   EVAL      XOVL = 'CCBBO'
     C                   OTHER
     C                   EVAL      XOVL = 'CCBBO'
     C                   ENDSL
     C                   ENDIF
     C                   EVAL      IFSFil = *BLANKS
     C                   call      'ESOVERS21C'
     C                   parm                    WSAVD
     C                   parm                    WSOPD
     C                   parm                    WSSIDE2
     C                   parm                    BLSG
     C                   parm                    XOVERLAY
     C                   parm                    XOVL              5
     C                   parm                    BIFIRM
     C                   PARM                    IFSFIL
      * Set output skeleton html member name
      *-dummy html for å få kjørt prog                                      ******
      * "bytter ut seg selv" med Html-fil i IFS umiddelbart                 ******
     C                   IF        IFSFIL = *BLANKS
     C                   exsr      SetSklSpool2
     C                   ELSE
     C                   exsr      SetSklSpool
     C                   END
     C                   callp     gethtml(fn:lib:mbr:'/CGITAG/')
     C                   callp     updhtmlvar('IFSFIL':IFSFIL)
     C                   callp     wrtsection('top')
     C                   end
      *------------------                                                   ******
      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      *
     C                   close     BRIDF
     C                   close     BRPARF
     C                   eval      *inlr = *on
     C                   return
      *
      *=====================================================================******
      * Parse input
      *=====================================================================******
     C     Parse         begsr
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      UsrSpcName  = zhbgetvar('UsrSpcName')
     C                   EVAL      WSAVD   = zhbgetvar('WSAVD')
     C                   EVAL      BLAVD   = c2n2(WSAVD)
     C                   EVAL      WSOPD   = zhbgetvar('WSOPD')
     C                   EVAL      BLOPD   = c2n2(WSOPD)
     C                   EVAL      WSBLFORM= zhbgetvar('WSBLFORM')
     C     LC:UC         XLATE     WSBLFORM      WSBLFORM
     C                   EVAL      WSNTBS  = zhbgetvar('WSNTBS')
     C                   EVAL      WSVESSEL= zhbgetvar('WSVESSEL')
     C                   EVAL      WSNAA   = zhbgetvar('WSNAA')
     C                   EVAL      WSAD1A  = zhbgetvar('WSAD1A')
     C                   EVAL      WSAD2A  = zhbgetvar('WSAD2A')
     C                   EVAL      WSAD3A  = zhbgetvar('WSAD3A')
     C                   EVAL      WSNAM   = zhbgetvar('WSNAM')
     C                   EVAL      WSAD1M  = zhbgetvar('WSAD1M')
     C                   EVAL      WSAD2M  = zhbgetvar('WSAD2M')
     C                   EVAL      WSAD3M  = zhbgetvar('WSAD3M')
     C                   EVAL      WSNAN   = zhbgetvar('WSNAN')
     C                   EVAL      WSAD1N  = zhbgetvar('WSAD1N')
     C                   EVAL      WSAD2N  = zhbgetvar('WSAD2N')
     C                   EVAL      WSAD3N  = zhbgetvar('WSAD3N')
     C                   EVAL      WSLSSNV = zhbgetvar('WSLSSNV')
     C                   EVAL      WSLSHNV = zhbgetvar('WSLSHNV')
     C                   EVAL      WSLOHNV = zhbgetvar('WSLOHNV')
     C                   EVAL      WSLOSNV = zhbgetvar('WSLOSNV')
     C                   EVAL      WSREFS  = zhbgetvar('WSREFS')
     C                   EVAL      WSFD1   = zhbgetvar('WSFD1')
     C                   EVAL      WSFD2   = zhbgetvar('WSFD2')
     C                   EVAL      WSFD3   = zhbgetvar('WSFD3')
     C                   EVAL      WSPLC   = zhbgetvar('WSPLC')
     C                   EVAL      WSPDT   = zhbgetvar('WSPDT')
     C                   EVAL      WSTXT1  = zhbgetvar('WSTXT1')
     C                   EVAL      WSTXT2  = zhbgetvar('WSTXT2')
     C                   EVAL      WSTXT3  = zhbgetvar('WSTXT3')
     C                   EVAL      WSTXT4  = zhbgetvar('WSTXT4')
     C                   EVAL      WSGB1   = zhbgetvar('WSGB1')
     C                   EVAL      WSGB2   = zhbgetvar('WSGB2')
     C                   EVAL      WSSIDE2 = zhbgetvar('WSSIDE2')
     C                   eval      Dialog  = zhbgetvar('Dialog')
      *
      *
     C                   endsr
      *=====================================================================******
      * Set html output skeleton member before its read into memory
      *=====================================================================******
     C     SetSklSpool   begsr
     C                   eval      Lib = '*LIBL'
     C                   eval      Fn  = 'HTMLSRC'
     C                   eval      Mbr = 'SPLHTMALL'
     C                   endsr
      *=====================================================================******
      * Set html output skeleton member before its read into memory
      *=====================================================================******
     C     SetSklSpool1  begsr
     C                   eval      Lib = '*LIBL'
     C                   eval      Fn  = 'HTMLSRC'
     C                   eval      Mbr = 'ESOVERS21A'
     C                   endsr
      *=====================================================================******
      * Set html output skeleton member before its read into memory
      *=====================================================================******
     C     SetSklSpool2  begsr
     C                   eval      Lib = '*LIBL'
     C                   eval      Fn  = 'HTMLSRC'
     C                   eval      Mbr = 'ESOVERS21'
     C                   endsr
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
     C                   OPEN      BRIDF
     C     WSUSER        CHAIN     BRIDF                              50
      * En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   CALLB     'INCGI'
     C                   PARM                    BISTDL
     C                   else
      * Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
     C*                  OPEN      BILLOF
     C                   OPEN      BRPARF
      *
     C     BRPARFK       klist
     C                   kfld                    BIBRID
     C                   kfld                    PAKUNR
     c                   kfld                    PAID
     C     BILLOFK       KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
      *
     c                   Eval      PAKUNR = 0
     c                   Eval      PAID   = 'OSOVL'
     C     BRPARFK       Chain     BRPARF                             33
     C                   SELECT
     C                   WHEN      *IN33
     C                   MOVE      'N'           XOVERLAY          1
     C                   WHEN      PAVRDA = 'J' OR PAVRDA = 'j'                 Full overlay
     C                   MOVE      'J'           XOVERLAY
     C                   WHEN      PAVRDA = 'V' OR PAVRDA = 'v'                 Kunn Vannmerke
     C                   MOVE      'V'           XOVERLAY
     C                   OTHER
     C                   MOVE      'N'           XOVERLAY
     C                   ENDSL
      *
     C                   endsr
      *
