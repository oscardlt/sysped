********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 ENDRING KOPI         ...
10XXX * 02 JOV PTF10 auto ogaå av type 4  ...
10XXX * 03 SH  PTF10 også ved ENTRAN testes om dert er noe å skrive
********************************************************************
      *
      *
      **************************************************************
      *** PROGRAM SOM SKRIVER EN TRANSPORTØR-KREDITNOTA          ***
      **************************************************************
      * 70 = INVOICE IN ENGLISH
      * 79 = INVOICE IN GERMAN
      * (N70/N79 = INVOICE IN "HOME-LANGUAGE")
      *
     FWRKTAVR   IF   E           K DISK
     Ftellfa    UF   E           K DISK
     FCUNDC03   IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E             DISK
     FTRAVH     UF   E           K DISK
     FTRAVH3    IF   E           K DISK
     F                                     RENAME(TRAVHR:TRAVH3R)
     FTRAVV2    UF   E           K DISK
     FTRAVV     IF   E           K DISK
     F                                     RENAME(TRAVVR:TRAVVX)
     FFAK3      IF   E           K DISK
     FKOSBU     IF   E           K DISK
     FHEAD11    IF   E           K DISK
     FTURER     IF   E           K DISK
     FTRAN      IF   E           K DISK
     FTRANL01   IF   E           K DISK
     F                                     RENAME(TRANR:TRANR1)
     FFIRM      IF   E           K DISK
     FFIRTR     IF   E           K DISK
     FKOSTT     UF   E           K DISK
     FHESTED    IF   E           K DISK
     FKOSTA     IF   E           K DISK
     FMULTKODT  IF   E           K DISK
     FHODE      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FLEVEL01   IF   E           K DISK
     FSYTR23PF  O    E             PRINTER
     D BR              S             11  2 DIM(10)
     D NE              S             11  2 DIM(10)
     D PR              S              5  2 DIM(10)
     D                 DS
     D  THÅR4                  1      4  0
     D  THÅR                   3      4  0
     D  THMND                  5      6  0
     D  THDAG                  7      8  0
     D  THDATO                 1      8  0
     D                 DS
     D  IDAG1                  1      4  0
     D  IDAG2                  5      6  0
     D  IDAG3                  7      8  0
     D  IDAG                   1      8  0
     D                 DS
     D  XÅMDÅÅ                 1      4  0
     D  XÅMDMM                 5      6  0
     D  XÅMDDD                 7      8  0
     D  XÅMD                   1      8  0
     D                 DS
     D  XDMÅDD                 1      2  0
     D  XDMÅMM                 3      4  0
     D  XDMÅÅÅ                 5      6  0
     D  XDMÅ                   1      6  0
     D                 DS
     D  FR01                   1      5
     D  FR02                   6     10
     D  FR03                  11     15
     D  FR04                  16     20
     D  FR05                  21     25
     D  FR06                  26     30
     D  FR07                  31     35
     D  FR08                  36     40
     D  FR09                  41     45
     D  FR10                  46     50
     D  FR                     1     50
     D                                     DIM(10)
     D                 DS
     D  TI01                   1      5
     D  TI02                   6     10
     D  TI03                  11     15
     D  TI04                  16     20
     D  TI05                  21     25
     D  TI06                  26     30
     D  TI07                  31     35
     D  TI08                  36     40
     D  TI09                  41     45
     D  TI10                  46     50
     D  TI                     1     50
     D                                     DIM(10)
     D                 DS
     D  GMRTNR                 1      8  0
     D  GMKDM                  9      9
     D  GMBRUD                 1      9
     D                 DS
     D  THRTNR                 1      8  0
     D  THKDM                  9      9
     D  NYBRUD                 1      9
     D                 DS
     D  TVTXT                  1     35
     D  TVTXTX                 1     25
     D  TVTXTY                26     35
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                SDS
     D  ZUSER                254    263
     IKUNDR
     I              BANKG                       SYBAGI
     I              POSTG                       SYPOGI
     C*
     C                   EXSR      INIT
     C     UTNR          IFEQ      *ZEROS
     C     UALFA         IFNE      'J'
     C                   EXSR      ALLE
     C                   ELSE
     C                   EXSR      ALLEA
     C                   END
     C                   ELSE
s03  C*                  EXSR      ENTRAN
n03  C     UKOPI         IFNE      'J'
n03  C                   EXSR      ENTRAN0
N03  c                   else
n03  c                   exsr      ENTRAN
N03  c                   end
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     ALLE          BEGSR
     C***********************************************
     C*
     C*------------------------------------------------------*
     C*                                                      *
     C*     FINN ALLE TRANSPORTØRER MED 'R'-RECORD I TRAVH.  *
     C*     ("R" = READY - MERKET )                          *
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""*
     C*
     C                   SETOFF                                       32
     C*
     C     TAG1          TAG
     C     TRAHK1        SETLL     TRAVH
     C                   READ      TRAVH                                  32
     C  N32THST          COMP      'R'                                32
      *
      *
     C* finner transportør
      *
     C     TRANKE        CHAIN     TRAN                               33
      *
     c     *IN(33)       ifeq      '0'
      *
      * ikke mail
      *
     c     arksnd        ifne      'J'
     C  N32              EXSR      ENTRAN
     c                   else
     c     epokey        CHAIN     cundc03                            33
      * 33 på er prinkunde
     C   33uemail        ifeq      'N'
     C  N32              EXSR      ENTRAN
     c                   end
      *N33 på er mailkunde
     C  N33uemail        ifeq      'J'
     C  N32              EXSR      ENTRAN
     c                   end
     c                   end
     c                   end
      *
     C* FLERE TRANSPORTØRER TIL AVREGNING???
     C  N32              ADD       1             YTNR
     C  N32              GOTO      TAG1
     C*
     C                   ENDSR
     C*
      *
     C***********************************************
     C     ALLEA         BEGSR
     C***********************************************
     C* NÅR SORTERT PÅ ALFA
     C     *LOVAL        SETLL     TRANL01
     C                   READ      TRANL01                                94
     C     *IN94         DOWEQ     '0'
     C* VED BESTILLING ALLE - KUN DE SOM SKAL HA KREDITNOTA
     C*  OG KUN DE SOM HAR MINST EN MED STATUS "R" ER FERDIGMELDT
     C     VMINCR        IFEQ      0
     C     VMINCR        OREQ      3
N02  C     VMINCR        OREQ      4
     C                   MOVE      VMTRAN        YTNR
     C     TRAHK1        CHAIN     TRAVH                              94
      *
      * ikke mail
      *
     c     arksnd        ifne      'J'
     C  N94              EXSR      ENTRAN
     c                   else
     c     epokey        CHAIN     cundc03                            33
      * 33 på er prinkunde
     C   33uemail        ifeq      'N'
     C  N94              EXSR      ENTRAN
     c                   end
      *N33 på er mailkunde
     C  N33uemail        ifeq      'J'
     C  N94              EXSR      ENTRAN
     c                   end
     c                   end
      *
     C                   END
     C                   SETOFF                                       94
     C                   READ      TRANL01                                94
     C  N94              END
     C*
     C                   ENDSR
     C*
N03  C***********************************************
N03  C     ENTRAN0       BEGSR
N03  C***********************************************
N03  C*
N03  C*------------------------------------------------------*
N03  C*     SER OM DET ER DATA TIL UTSKRIFT                  *
N03  C*     ("R" = READY - MERKET )                          *
N03  C*""""""""""""""""""""""""""""""""""""""""""""""""""""""*
N03  C*
N03  C                   SETOFF                                       32
N03  C*
N03  C     TRAHK1        SETLL     TRAVH
N03  C                   READ      TRAVH                                  32
N03  C  N32THST          COMP      'R'                                32
N03   *
N03   *
N03  C* finner transportør
N03   *
N03  C     TRANKE        CHAIN     TRAN                               33
N03   *
N03  c     *IN(33)       ifeq      '0'
N03   *
N03   * ikke mail
N03   *
N03  c     arksnd        ifne      'J'
N03  C  N32              EXSR      ENTRAN
N03  c                   else
N03  c     epokey        CHAIN     cundc03                            33
N03   * 33 på er prinkunde
N03  C   33uemail        ifeq      'N'
N03  C  N32              EXSR      ENTRAN
N03  c                   end
N03   *N33 på er mailkunde
N03  C  N33uemail        ifeq      'J'
N03  C  N32              EXSR      ENTRAN
N03  c                   end
N03  c                   end
N03  c                   end
N03   *
N03  C                   ENDSR
     C*
     C*
     C***********************************************
     C     ENTRAN        BEGSR
     C***********************************************
     C                   EXSR      GETTRA
     C                   EXSR      HODESR
     C                   SETOFF                                       94
     C     UKOPI         IFEQ      'J'
     C     KOPHK3        SETLL     TRAVH3
     C     KOPHK3        READE     TRAVH3                                 94
     C                   ELSE
     C     TRAHK2        SETLL     TRAVH
     C     TRAHK2        READE     TRAVH                                  94
     C                   END
     C     *IN94         DOWEQ     '0'
     C* OPPDATER STAUS MM. (78-ON=KUN AVR.SKJEMA, SKAL IKKE OVERFØRES)
     C     UKOPI         IFNE      'J'
     C                   MOVE      'F'           THST
     C   78THTAVD        IFEQ      *ZEROS
     C                   MOVE      ' '           THST
     C                   ELSE
     C                   MOVE      'O'           THST
     C                   END
     C                   MOVE      YKUNDN        THKUNR
     C                   MOVE      XFN           THFAKT
     C                   MOVE      W1PERM        THMND
     C                   MOVE      W1PERÅ        THÅR
     C     W1PERÅ        IFGT      50
     C                   MOVE      19            THCC
     C                   ELSE
     C                   MOVE      20            THCC
     C                   END
     C                   MOVE      IDAG          THDATO
     C                   MOVE      XFFDT         XDMÅ
     C                   EXSR      SNUDT
     C                   MOVE      XÅMD          THDAFF
     C                   MOVE      *ZEROS        THJOUR
     C                   UPDATE    TRAVHR
     C                   END
     C* SKRIV RUNDTURSNR KUN VED 1. POST PR. RUNDTUR (VED N97)
     C     GMRTNR        COMP      THRTNR                                 97
     C* BRUDD PÅ RUNDTUR / MOMSKODE NIVÅ ???
     C     GMRTNR        IFEQ      *ZEROS
     C                   MOVE      THRTNR        GMRTNR
     C                   MOVE      THKDM         GMKDM
     C                   END
     C     GMBRUD        IFNE      NYBRUD
     C                   ADD       1             XANTL
     C                   WRITE     DETTOT
     C                   ADD       1             XANTL
     C                   WRITE     STREK
     C                   MOVE      *ZEROS        XPFNOK
     C                   MOVE      THRTNR        GMRTNR
     C                   MOVE      THKDM         GMKDM
     C                   END
      *
      * THTOT LIGGER MED POSITIVT FORTEGN - SKAL UT TIL KREDIT
      *
     C                   EXSR      DECI
     C                   SUB(H)    THTOT         XPFNOK           13 2
     C                   SUB       THTOT         XTOTAL           13 2
      *
      * HENTER TIL MOMSGRUNNLAG VED ULIK  99999998
      *
     C     THRTNR        IFNE      99999998
     C     THKDM         COMP      'J'                                    34
     C   34              SUB       THTOT         XMVAGR
     C  N34              SUB       THTOT         XMVAFR
     C                   END
     C*
     C* 98 ON - GODSKRIV
     C*
      *
     C     THRTNR        COMP      99999998                               98
     C  N98              DO
     C*
     C* NEXT PAGE ??
     C                   ADD       4             XANTL
     C                   EXSR      NEWPAG
     C     TURERK        CHAIN     TURER                              33
     C* KONVERTER TURDATO TIL LOKALT FORMAT
     C   33              MOVE      *ZEROS        TUDT
     C                   MOVE      TUDT          TUDATO            6 0
     C     FIDTFM        IFNE      3                                            SNU DATO TIL
     C                   CALL      'DATFM3'                                     LOKALT FORMA
     C                   PARM                    FIDTFM
     C                   PARM                    TUDATO
     C                   END
     C* DUPLISERER FELTNAVN FOR Å KUNNE FÅ UTHEVET TRYKK PÅ PRINTERE
     C* SOM IKKE TAKLER PARAMEREN HIGHLIGHT I PRINTERFILE (DIV. OKI MM)
     C                   MOVE      TURUND        XURUND            8 0
     C                   MOVE      TUAVD         XUAVD             4 0
     C                   MOVE      TUPRO         XUPRO             8 0
     C                   MOVE      TUDATO        XUDATO            6 0
     C                   MOVE      TUSDF         XUSDF            20
     C                   MOVE      TUSDT         XUSDT            20
     C* SPESIFISER OPPDRAG MED PÅ TUREN
     C                   EXSR      OPPDRA
     C* HVER TUR - 4 LINJER PÅ UTSKRIFTEN
     C                   WRITE     DET
     C                   WRITE     DET2
     C                   WRITE     DETOF
     C                   WRITE     DETOT
      * DERETTER DIV. VALGFRIE TILLEGG/SPESIFIKASJONER
     C* JUSTERINGSLINJER MED KODE (IKKE BLANK I TVAVES) SKAL SKRIVES
     C     THJUSA        IFNE      *ZEROS
     C                   EXSR      JUSLIN
     C                   END
     C* DERSOM FIRMARECORD SIER AT DETALJER SKAL VISES......
     C     FOPPDR        IFEQ      'J'                                          *GRL.DETALJ
     C     FOPPDR        OREQ      'T'                                          *OGSÅ TREKK.
     C* VIS SAMLET GR.LAG FOR PROV. / SUM EVT. DETALJERT TREKK.
     C* (HVIS IKKE SAMLET ** AVTALT HONORAR*)
     C     TUTAKO        IFEQ      'A'
     C                   ADD       1             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     GRLAVT
     C                   ELSE
     C                   EXSR      GRLAG
     C                   END
     C                   END
     C*
     C                   END
     C* SKRIV DETALJLINJE
     C     UKOPI         IFEQ      'J'
     C     KOPHK3        READE     TRAVH3                                 94
     C                   ELSE
      *
     C   98THTOT         IFNE      *ZEROS
     C     THBUDA        ORNE      *ZEROS
     C                   EXSR      GODSKR
     C                   END
     C     TRAHK2        READE     TRAVH                                  94
     C                   END
     C  N94              END
      *
      * LESELOOP FERDIG..
     C* LEGG UT VERDI FOR SISTE RUNDTUR (RUNDTUR/MOMSKODE)
     C     GMRTNR        IFNE      *ZEROS
     C     GMRTNR        ANDNE     99999998
     C                   WRITE     DETTOT
     C                   ADD       1             XANTL
     C                   WRITE     STREK
     C                   MOVE      *ZEROS        XPFNOK
     C                   END
      *
      *
     C     UKOPI         IFEQ      'J'
     C                   MOVE      *ZEROS        THTAVD
     C                   MOVE      UTNR          THTUNR
     C                   EXSR      GODSKR
     C                   END
     C*
     C* SKRIV BUNNTOTAL PÅ KREDITNOTA
     C                   EXSR      TOTAL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPPDRA        BEGSR
     C***********************************************
     C*
     C* HENT DESTINASJONENE SOM ER BERØRT FRA HEADINGFIL
     C* ANTAR AT EN TUR HAR MAX 10 ULIKE FRA / TILSTEDER
     C                   SETOFF                                       33
     C                   MOVE      *BLANKS       FR
     C                   MOVE      *BLANKS       TI
     C                   MOVE      *ZEROS        NF
     C                   MOVE      *ZEROS        NT
     C     TUPRO         SETLL     HEAD11
     C     TUPRO         READE     HEAD11                                 33
     C     *IN33         DOWEQ     '0'
     C     HESTKE        CHAIN     HESTED                             39
     C     *IN39         IFEQ      '0'
     C  N33              MOVEL     HSFROM        HESDF
     C  N33              MOVEL     HSTO          HESDT
     C  N33              MOVEL     HSVIA1        HESDFF
     C  N33              MOVEL     HSVIA2        HESDVT
     C                   END
     C* FRASTED
     C                   MOVE      HESDFF        HESDX             5
     C     HESDX         IFEQ      *BLANKS
     C                   MOVE      HESDF         HESDX
     C                   END
     C*LEGG UT STED KUN DERSOM DET IKKE FINNES I ARRAY FRA FØR
     C                   SETOFF                                           39
     C     HESDX         LOOKUP    FR                                     39
     C  N39              ADD       1             NF                2 0
     C  N39              MOVE      HESDX         FR(NF)
     C* TILSTED
     C                   MOVE      HESDVT        HESDX             5
     C     HESDX         IFEQ      *BLANKS
     C                   MOVE      HESDT         HESDX
     C                   END
     C*LEGG UT STED KUN DERSOM DET IKKE FINNES I ARRAY FRA FØR
     C                   SETOFF                                           39
     C     HESDX         LOOKUP    TI                                     39
     C  N39              ADD       1             NT                2 0
     C  N39              MOVE      HESDX         TI(NT)
     C     NF            COMP      10                                     33
     C  N33NT            COMP      10                                     33
     C  N33TUPRO         READE     HEAD11                                 33
     C  N33              END
     C*
     C                   ENDSR
     C***********************************************
     C     GODSKR        BEGSR
     C***********************************************
     C*
     C* RUNDTURNR 99999998 ER REKVISISJONER HVOR DENNE TRANSPORTØR ER
     C* DEN UTFØRENDE PART. OG SKAL GODSKRIVES PÅ KREDITNOTA.
     C* SKRIV "HEADING" - SPESIFISER ALLE REKVISISJONER
     C* OPPDATERES MED STATUS OG FAKTURANR SLIK AT EN IKKE FÅR
     C* INNBLANDING AV GAMLE GODSKRIVINGSLINJER
     C*
     C                   ADD       2             XANTL
     C                   EXSR      NEWPAG
     C                   MOVE      'Y'           FØRSTT            1            skriv THEAD
     C                   MOVE      'Y'           FØRSTG            1            skriv GHEAD
     C*
     C     TRAVVK        SETLL     TRAVV2
     C     TRAVVK        READE     TRAVV2                                 95
     C     *IN95         DOWEQ     '0'
      *
      * OPPDATERER VED ORIGINAL
      *
     C     UKOPI         IFNE      'J'
     C                   MOVE      'F'           TVST
      * 78-ON=KUN AVR.SKJEMA, SKAL IKKE OVERFØRES
     C   78              MOVE      'O'           TVST
     C                   MOVE      THFAKT        TVFAKT
     C                   END
      *
     C                   UPDATE    TRAVVR
     C     TVBNRB        CHAIN     KOSBU                              33
     C   33              MOVE      *ZEROS        BUFEDT
     C   33              MOVE      *ZEROS        BUBNR2
     C     BUBNR2        CHAIN     KOSTA                              33
     C   33              MOVE      *ZEROS        KABNR2
     C   33              MOVE      *ZEROS        KABDT
     C*
     C     KABNR2        IFNE      *ZEROS
     C                   MOVE      KABNR2        BUBNR2
     C                   END
     C     BUFEDT        IFEQ      *ZEROS
     C                   MOVE      KABDT         BUFEDT
     C                   END
     C                   MOVE      BUFEDT        BUDATO
     C     FIDTFM        IFNE      3                                            SNU DATO TIL
     C     BUFEDT        ANDNE     *ZEROS
     C                   CALL      'DATFM3'                                     LOKALT FORMA
     C                   PARM                    FIDTFM
     C                   PARM                    BUDATO
     C                   END
     C                   MULT      -1            TVBLL                          SNU.FORTEGN
      *
      * T R E K K
      *
     C* Er det TREKK - momskode fra KOSBU
      * TREKK FOR UTLEGG SOM IKKE ER KNYTTET TIL OPPDRAG
      *
     C     BUTUNR        IFEQ      *ZEROS
     C     BUOPD         ANDEQ     *ZEROS
     C     BUKDM         COMP      'J'                                    34
     C     FØRSTT        IFEQ      'Y'
     C                   WRITE     THEAD
     C                   MOVE      'N'           FØRSTT                         ikke skriv
     C                   END
     C                   ADD       1             XANTL
     C                   EXSR      NEWPAG
     C     TVTXTY        COMP      *BLANKS                            6262
     C                   WRITE     TDET
     C                   ELSE
      *
      * G O D S K R I V N I N G
      *
     C* Er det Godskr. - momskode default J (antar at det er innenlands)
      *
      * TEKST UTSKRIFT GODSKRIVNING SOM UNDERTRANSPORTØR
      *
     C     BUKDM         COMP      'N'                                3434
     C     FØRSTG        IFEQ      'Y'
     C                   WRITE     GHEAD
     C                   MOVE      'N'           FØRSTG                         ikke skriv
     C                   END
     C                   ADD       2             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     GDET
     C                   WRITE     GDET2
     C                   END
      *
      *
     C   34              ADD       TVBLL         XMVAGR
     C  N34              ADD       TVBLL         XMVAFR
      *
      * KOPI AV ALLERDE OVERFØRT BILAG - MANGLER TRAVH-POST
      *
     C     UKOPI         IFEQ      'J'
     C     YYST          ANDEQ     'O'
     C                   ADD(H)    TVBLL         XPFNOK           13 2
     C                   ADD       TVBLL         XTOTAL           13 2
     C                   END
      *
     C     TRAVVK        READE     TRAVV2                                 95
     C  N95              END
      *
      * LESELOOP FERDIG. SKRIV SUMLINJE
      *
     C     FØRSTG        IFEQ      'N'                                          B1
     C     FØRSTT        IFEQ      'Y'                                           B2
     C* Kun Godskrivninger
     C                   WRITE     GDETT
     C                   ELSE                                                    X2
     C* Både Godskrivninger og Trekk
     C                   WRITE     GTDETT
     C                   END                                                     E2
     C                   ELSE                                                   X1
     C* Kun Trekk
     C                   WRITE     TDETT
     C                   END                                                    E1
     C*
     C                   ENDSR
     C***********************************************
     C     JUSLIN        BEGSR
     C***********************************************
     C* MANUELLE JUSTERINGSLINJER SKRIVES DERSOM TVAVES ULIK ' '
     C*
     C*
     C                   MOVE      'G'           YYTYP
     C     TRDETK        SETLL     TRAVV
     C     TRDETK        READE     TRAVV                                  95
     C     *IN95         DOWEQ     '0'
     C                   MULT      -1            TVBLL                          NEG.FORTEGN
     C     TVAVES        IFNE      ' '
     C                   ADD       1             XANTL
     C                   EXSR      NEWPAG
     C     TVBLL         COMP      0                                      50
     C                   WRITE     JUSDET
     C                   END
     C     TRDETK        READE     TRAVV                                  95
     C  N95              END
     C                   ENDSR
     C***********************************************
     C     GRLAG         BEGSR
     C***********************************************
     C* ARRAYELEMENT 1- 9 - GR.LAG - SATS - NETTO FOR ULIKE SATSER
     C* ARRAYELEMENT 10     INNH/UTKJ M.M.
     C                   MOVEA     *ZEROS        BR
     C                   MOVEA     *ZEROS        PR
     C                   MOVEA     *ZEROS        NE
     C                   MOVE      *ZEROS        NN                3 0
     C                   MOVE      'B'           YYTYP
     C     YYTYP         DOWNE     'X'
     C     TRDETK        SETLL     TRAVV
     C     TRDETK        READE     TRAVV                                  95
     C     *IN95         DOWEQ     '0'
     C     YYTYP         IFEQ      'B'                                          *FORDEL "B"
     C     TVPRO         IFEQ      *ZEROS                                        ETTER SATS
     C                   Z-ADD     9             NX                3 0           00 I ELEM.9
     C                   ELSE
     C                   Z-ADD     1             NX                              .....
     C     TVPRO         LOOKUP    PR(NX)                                 60    *FINNES=60ON
     C     *IN60         IFEQ      '0'                                          *FINNES IKKE
     C                   ADD       1             NN
     C     NN            IFLE      8
     C                   MOVE      NN            NX
     C                   ELSE
     C                   Z-ADD     8             NX
     C                   END
     C                   MOVE      TVPRO         PR(NX)
     C                   END
     C                   END
     C                   ELSE                                                   *ALT ANNET
     C                   Z-ADD     10            NX                             *ENN "B" I
     C                   END                                                    *ELEM. 10
     C                   ADD       TVBLLB        BR(NX)
     C                   ADD       TVBLL         NE(NX)
     C     TRDETK        READE     TRAVV                                  95
     C  N95              END
     C*FLERE TYPER SOMSKAL BEHANDLES?? (SUM TREKK)
     C     YYTYP         IFEQ      'B'
     C                   MOVE      'C'           YYTYP
     C* TREKKENE SKAL VISES DETALJERT(HOPP AV LESE LOOP/SKRIV GRUNNLAG)
     C     FOPPDR        IFEQ      'T'
     C                   GOTO      UTGRD
     C                   END
     C                   ELSE
     C     YYTYP         IFEQ      'C'
     C                   MOVE      'D'           YYTYP
     C                   ELSE
     C     YYTYP         IFEQ      'D'
     C                   MOVE      'E'           YYTYP
     C                   ELSE
     C     YYTYP         IFEQ      'E'
     C                   MOVE      'F'           YYTYP
     C                   ELSE
     C     YYTYP         IFEQ      'F'
     C                   MOVE      'G'           YYTYP
     C                   ELSE
     C                   MOVE      'X'           YYTYP
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C* GÅR UT AV LOOP PÅ TYPE X..
     C                   END
     C* SKRIV UT
     C     UTGRD         TAG
     C     1             DO        10            NN
     C     NE(NN)        IFNE      *ZEROS
     C                   ADD       1             XANTL
     C                   EXSR      NEWPAG
     C     NN            COMP      10                                     61
     C                   MOVE      BR(NN)        XGRUNN           11 2
     C                   MOVE      PR(NN)        XSATS             5 2
     C                   MOVE      NE(NN)        XNETTO           11 2
     C                   WRITE     GRLDET
     C                   END
     C                   END
     C* TREKKENE SKAL VISES DETALJERT - FORTSETT LESELOOPEN...
     C     FOPPDR        IFEQ      'T'
     C                   EXSR      TREDET
     C                   END
     C                   ENDSR
      *
     C***********************************************
     C     TREDET        BEGSR
     C***********************************************
     C*
     C                   MOVE      'N'           TRKH              1
     C     YYTYP         DOWNE     'X'
     C     TRDETK        SETLL     TRAVV
     C     TRDETK        READE     TRAVV                                  95
     C     *IN95         DOWEQ     '0'
     C     TRKH          IFEQ      'N'
     C                   ADD       1             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     TRKHEA
     C                   MOVE      'J'           TRKH
     C                   END
     C                   ADD       1             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     TRKDET
     C     TRDETK        READE     TRAVV                                  95
     C  N95              END
     C*FLERE TYPER SOMSKAL BEHANDLES??
     C     YYTYP         IFEQ      'C'
     C                   MOVE      'D'           YYTYP
     C                   ELSE
     C     YYTYP         IFEQ      'D'
     C                   MOVE      'E'           YYTYP
     C                   ELSE
     C     YYTYP         IFEQ      'E'
     C                   MOVE      'F'           YYTYP
     C                   ELSE
     C     YYTYP         IFEQ      'F'
     C                   MOVE      'G'           YYTYP
     C                   ELSE
     C                   MOVE      'X'           YYTYP
     C                   END
     C                   END
     C                   END
     C                   END
     C* GÅR UT AV LOOP PÅ TYPE X..
     C                   END
     C                   ENDSR
      *
     C***********************************************
     C     GETTRA        BEGSR
     C***********************************************
     C*
     C* TRANSPORTØRENS KUNDENR/ HENT NAVN- SPRÅK
     C     TRANKE        CHAIN     TRAN                               33
     C                   MOVE      VMTRKU        YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      BETMAT        YBETMA            1
     C                   MOVE      KUNDNR        YKUNDN            8 0
     C                   MOVE      KNAVN         YNAVN            30
     C                   MOVE      ADR1          YADR1            30
     C                   MOVE      ADR2          YADR2            30
     C* KOMPONER SISTE ADRESSELINJE UTFRA GITT POSTNR/LANGT POSTNR...
     C                   MOVE      *BLANKS       YADR3            35
     C     POSTNR        COMP      0                                      37
     C     SYPOGE        COMP      *BLANKS                                38
     C  N37              MOVEL     POSTNR        YADR3                          *NORSK
     C  N37              MOVEL     ADR3          YADR32           30              POSTNR
     C  N37              MOVE      YADR32        YADR3
     C   37
     CANN38              MOVEL     SYPOGE        YADR3                          *UTENLANDSK
     C   37
     CANN38              MOVE      ADR3          YADR3                            POSTNR
     C   37
     CAN 38              MOVEL     ADR3          YADR3                          *IKKE POSTNR
     C*SPRÅKKODE
     C     SPRAAK        COMP      'E'                                    70
     C     SPRAAK        COMP      'T'                                    79
     C*FORFALLSDATO
     C                   EXSR      BETSR
     C                   ENDSR
     C***********************************************
     C     TOTAL         BEGSR
     C***********************************************
     C     XMVAGR        MULT(H)   FITAXB        XMOMS            13 2
     C     XTOTAL        ADD       XMOMS         XBRUTT
     C* TOTALLINJER
     C                   ADD       3             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     STREK
     C                   WRITE     TOTA0
     C*
     C* MOMSGRUNNLAG +BUNNTOTAL PÅ SKJEMA
     C     XMOMS         IFNE      *ZEROS
     C                   ADD       2             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     TOTA
     C                   END
     C                   ADD       4             XANTL
     C                   EXSR      NEWPAG
     C                   WRITE     TOTC
     c                   exsr      hittil
      * SKRIV VEDLEGG/ARB-LISTE
     C     UVEDL         IFEQ      'J'
     C     UVEDL         OREQ      'J'
     C                   MOVE      XFN           AXFN              7
     C                   CALL      'SYTR12H'
     C                   PARM                    AXFN
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     NEWPAG        BEGSR
     C***********************************************
     C     XANTL         COMP      41                                 88  88
     C   88              DO
     C  N98              Z-ADD     4             XANTL
     C   98              Z-ADD     1             XANTL
     C                   ADD       1             XSIDE
     C                   WRITE     KJØP1
     C                   EXSR      KDTFM1
     C                   WRITE     KJØP
     C                   EXSR      KDTFM1
     C                   END
     C*
     C                   ENDSR
     C*
     C*
     C*
     C***********************************************
     C     HODESR        BEGSR
     C***********************************************
     C     UKOPI         IFEQ      'J'
     C                   MOVE      W1FAKT        XFN
     C                   ELSE
      * VED TRANSP-KODE 3 ER DET "GRUNNLAG FOR FAKTURA" SOM SKRIVES
     C     VMINCR        IFEQ      3
     C                   MOVE      *ZEROS        XFN
     C                   SETON                                        78
     C                   ELSE
     C                   SETOFF                                       78
     C     FIBISE        IFEQ      ' '
     C     FIFIRM        CHAIN     tellfa                             32
     C*
     C  N32              MOVE      FIFNR         XFN               7 0
     C  N32              ADD       1             FIFNR
     C  N32              UPDATE    tellfar
     C                   ELSE
     C     FIBISE        CHAIN     KOSTT                              32
     C  N32              Z-ADD     KTNR          XFN
     C  N32              ADD       1             KTNR
     C  N32              UPDATE    KOSTTR
     C                   END
     C                   END
     C                   END
     C     FAVREG        COMP      'L'                                    77
     C                   EXSR      KDTFM1
     C                   WRITE     KJØP
     C                   EXSR      KDTFM1
     C*
     C                   MOVE      *ZEROS        XPFNOK           13 2
     C                   MOVE      *ZEROS        XTOTAL           13 2
     C                   MOVE      *ZEROS        XMVAGR           13 2
     C                   MOVE      *ZEROS        XMVAFR           13 2
     C                   MOVE      *ZEROS        XMOMS            13 2
     C                   MOVE      *ZEROS        XANTL             2 0
     C                   Z-ADD     1             XSIDE             2 0
     C                   MOVE      *ZEROS        GMRTNR
     C                   MOVE      *BLANKS       GMKDM
      *
      * ARKIVERING
      *
     C     UKOPI         IFNE      'J'
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C     FIFIRM        CHAIN     FIRMARC                            33
     C     *IN33         IFEQ      '0'
     C     'ta'          chain     arktxt                             33
     C     *IN33         IFEQ      '0'
     C     arkjn         andeq     'J'
     c     xfn           andne     *zeros
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      *zeros        ARAVD
     C                   MOVE      *zeros        AROPD
     C                   MOVEL     XFN           ARUNDE
     C                   MOVE      'ta'          ARTYPE
     C                   MOVEL     'TRANSAVR'    ARUSER
     C                   MOVE      ULDT          ARDATE
     C                   MOVE      XULTM         ARTIME
     C                   z-add     YKUNDN        ARKUND
     C                   WRITE     ARKIVR
     C                   END
     C                   END
     C                   END
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     BETSR         BEGSR
     C***********************************************
     C* KUNDENS LANDKODE
     C                   MOVE      *BLANKS       KLKNVN
     C     LKKEY         CHAIN     KODTLKR                            33
     C*
      * Hvis via Lev-reskontro  hen betbet fra leverandør
     C     FAVREG        IFEQ      'L'
     C                   MOVE      VMTRLE        YKN
     C     KUND1K        CHAIN     LEVEL01                            33
     c                   end
     C*** FINNER BETBET OG FORFALLSDATO3
     C     UKOPI         IFEQ      'J'
     C                   MOVE      XFFDT         FFKOPI            6 0
     C                   END
     C                   MOVE      *ZEROS        XFFDT
     C                   MOVE      *BLANKS       BETTXT           30
     C                   CALL      'SYFA20A'
     C                   PARM                    XFFDT
     C                   PARM                    BETTXT
     C                   PARM                    FIFIRM
     C                   PARM                    BETBET
     C*
     C     UKOPI         IFEQ      'J'
     C                   MOVE      FFKOPI        XFFDT             6 0
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      IDAGX         XKDTFM            4 0
     C                   MOVE      UDAY          UDT1              2 0
     C                   MOVE      UMONTH        UDT2              2 0
     C                   MOVE      UYEAR         UDT3              2 0
     C     UKOPI         IFEQ      'J'
     C                   MOVE      THDAG         UDT1              2 0
     C                   MOVE      THMND         UDT2              2 0
     C                   MOVE      THÅR          UDT3              2 0
     C                   END
     C                   EXSR      KDTFMT
     C                   MOVEL     UDT1          IDAGX
     C                   MOVEL     UDT2          XKDTFM            4 0
     C                   MOVE      UDT3          XKDTFM
     C                   MOVE      XKDTFM        IDAGX             6 0
     C*
     C                   MOVE      XFFDT         XKDTFM
     C                   MOVEL     XFFDT         UDT1
     C                   MOVEL     XKDTFM        UDT2
     C                   MOVE      XKDTFM        UDT3
     C                   EXSR      KDTFMT
     C                   MOVEL     UDT1          XFFDT
     C                   MOVEL     UDT2          XKDTFM
     C                   MOVE      UDT3          XKDTFM
     C                   MOVE      XKDTFM        XFFDT
     C                   ENDSR
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     C*
     C*
     C***********************************************
     C     SNUDT         BEGSR
     C***********************************************
     C     XDMÅ          IFEQ      0
     C                   MOVE      *ZEROS        XÅMD
     C                   ELSE
     C                   MOVE      XDMÅDD        XÅMDDD
     C                   MOVE      XDMÅMM        XÅMDMM
     C     XDMÅÅÅ        IFGT      50
     C     XDMÅÅÅ        ADD       1900          XÅMDÅÅ
     C                   ELSE
     C     XDMÅÅÅ        ADD       2000          XÅMDÅÅ
     C                   END
     C                   END
     C                   ENDSR
     C********************************************************************
     C     AVDSR         BEGSR
     C******************************************
     C     KODTAK        CHAIN     KOAR                               33
     C                   MOVE      KOAKNR        YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              DO
     C                   MOVE      KNAVN         XFNAVN           30
     C                   MOVE      ADR1          XFADR1           30
     C                   MOVE      ADR2          XFADR2           30
     C                   MOVE      POSTNR        XFPONR            4 0
     C                   MOVE      ADR3          XFADR3           24
     C                   MOVE      BANKG         XFBANK           15
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DECI          BEGSR
     C***********************************************
     C* TEST FIRMS NUMBER OF DECIMALS
     C*
     C* NO DECIMALS
     C     FIDECI        IFEQ      0
     C                   Z-ADD(H)  THTOT         FABEL0           11 0
     C                   Z-ADD     FABEL0        THTOT
     C                   ELSE
     C* 1 DECIMAL
     C     FIDECI        IFEQ      1
     C                   Z-ADD(H)  THTOT         FABEL1           12 1
     C                   Z-ADD     FABEL1        THTOT
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UUAVD             4            *ALPHA
     C                   PARM                    USG               3            *SIGN
     C                   PARM                    UOWHOD            1            *HODE-FAKTURA
     C                   PARM                    UVEDL             1            *OGSÅ VEDLEGG
     C* TIL SLUTT LEGGES PARAMETRE SOM SKILLER SEG FRA PROG TIL PROG.
     C                   PARM                    UTNR              8 0          *TRANSP
     C                   PARM                    W1PERÅ            2 0          *PERIODEÅR
     C                   PARM                    W1PERM            2 0          *PERIODEMND
     C                   PARM                    UALFA             1            *ALFASORTERT
     C                   PARM                    W1FAKT            7 0          *KOPI AV BILNR
     C                   PARM                    uemail            1            *plukke mailkunder
     C                   MOVE      'N'           UKOPI             1
     C**
     C     UUAVD         IFGT      '0000'
     C     UUAVD         ANDLE     '9999'
     C                   MOVE      UUAVD         KOAAVD                         *NUMERIC
     C                   ELSE
     C                   MOVE      *ZEROS        KOAAVD
     C                   END
     C     UTNR          IFEQ      *ZEROS
     C                   MOVE      UTNR          YTNR              8 0
     C                   ELSE
     C                   MOVE      UTNR          THTNR
     C                   END
     C* KUNDEKEY
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YKN               8 0
     C* KUNDES LANDKODE
     C     LKKEY         KLIST
     C                   KFLD                    YLKUNI
     C                   KFLD                    SYLAND
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    KOAAVD
      *
      * key om mailmotager
      *
     C     EPOKEY        KLIST
     C                   KFLD                    fifirm
     C                   KFLD                    mail30
     C                   KFLD                    VMTRKU
     C*
     C* FOR Å FINNE NESTE TRANSPORTØR
     C     TRAHK1        KLIST
     C                   KFLD                    YYST
     C                   KFLD                    YTNR
     C* FOR READE  PÅ EN FUNNET TRANSPORTØR
     C     TRAHK2        KLIST
     C                   KFLD                    YYST
     C                   KFLD                    THTNR
     C* FOR READE  PÅ ETT BILAG V/KOPI
     C     KOPHK3        KLIST
     C                   KFLD                    YYST
     C                   KFLD                    W1FAKT
     C*
     C     TURERK        KLIST
     C                   KFLD                    THTAVD
     C                   KFLD                    THTUNR
     C     TRAVVK        KLIST
     C                   KFLD                    THTAVD
     C                   KFLD                    THTUNR
     C                   KFLD                    YYTVST            1
     C                   KFLD                    W1FAKT
     C                   MOVE      ' '           YYTVST
     C     TRDETK        KLIST
     C                   KFLD                    THTAVD
     C                   KFLD                    THTUNR
     C                   KFLD                    YYTYP             1
     C     TRANKE        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    THTNR
     C     HODEK         KLIST
     C                   KFLD                    SPRAAK
     C                   KFLD                    KOAAVD
     C     HESTKE        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     c* kall fra arkivering
     c     UOWHOD        IFEQ      'A'
     c                   move      'J'           UOWHOD
     c                   move      'J'           ARKIV             1
     c                   end
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    KOAAVD
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI
     C*HENT STRINGKODE FOR LASER
     C                   Z-ADD     102           KOPLNR
     C     KODTPK        CHAIN     KOPR                               33
     c     arkiv         ifeq      'J'
     c                   move      *blanks       kopfm
     c                   end
     C  N33KOPFM         IFNE      *BLANKS
     C     KOPFM         SETLL     KODTFM
     C     KOPFM         READE     KODTFM                                 33
     C                   END
     C*
     C                   MOVEL     'LK'          YLKUNI            3
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        YKUNDN
     C                   MOVE      'R'           YYST              1
     C*
     C                   MOVE      *ZEROS        IDAG
     C                   READ      FIRM                                   33
     C                   READ      FIRTR                                  33
      *
      *
      * fikser nøkke cundc03
      *
     C     FIFIRM        CHAIN     FIRMARC                            33
     C     *IN33         IFEQ      '0'
     C     'ta'          chain     arktxt                             33
     C     *IN33         IFEQ      '0'
     C     arkjn         andeq     'J'
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   end
     c                   end
     c                   end
      *
     C     W1FAKT        IFNE      *ZEROS
     C     UALFA         IFEQ      'J'
     C                   MOVE      *ON           *IN51
     C                   END
     C                   MOVE      'J'           UKOPI
     C                   EXSR      KOPINI
     C                   END
     C*
     C* SJEKK EVT AVVIKENDE MOMSSATS MOT DATO SAMMENSATT AV PERIODE/ÅR
     C                   MOVE      31            IDAG3
     C     W1PERM        IFEQ      4
     C     W1PERM        OREQ      6
     C     W1PERM        OREQ      9
     C     W1PERM        OREQ      11
     C                   MOVE      30            IDAG3
     C                   ELSE
     C     W1PERM        IFEQ      2
     C                   MOVE      28            IDAG3
     C                   END
     C                   END
     C                   MOVE      W1PERM        IDAG2
     C     W1PERÅ        IFGT      50
     C     W1PERÅ        ADD       1900          IDAG1
     C                   ELSE
     C     W1PERÅ        ADD       2000          IDAG1
     C                   END
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     IDAG          ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAX
     C                   END
     C                   MOVE      FITAX         PRITAX            4 2
     c                   move      fitax         FITAXB            4 4
     C                   MOVE      FICURR        XVAL              3
     C*
     C* AVDELINGENS KUNDENR FOR NAVN/GIRONR
     C                   EXSR      AVDSR
     C* SKRIVE TOPP / BUNNTEKST ???
     C     UOWHOD        IFEQ      'J'
     C                   SETON                                        4446
     C                   ELSE
     C     UOWHOD        IFEQ      'T'
     C                   SETOFF                                       44
     C                   SETON                                        46
     C                   ELSE
     C     UOWHOD        IFEQ      'B'
     C                   SETON                                        44
     C                   SETOFF                                       46
     C                   END
     C                   END
     C                   END
     C* ALLTID EGEN SPRÅKKODE (' ') PÅ TRANSPORTØRHEADING
     C   44
     COR 46              DO
     C     HODEK         CHAIN     HODE                               33
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KOPINI        BEGSR
     C***********************************************
      * FINN AVREGNINGENS STATUS / PERIODE
      * (AVR.STATUS G KAN OGSÅ FINNES MEN KUN I KORT PERIODE)
     C                   MOVE      'F'           YYST
     C                   MOVE      'F'           YYTVST
     C     KOPHK3        CHAIN     TRAVH3                             72
     C  N72THTNR         COMP      UTNR                               7272
     C   72              MOVE      'O'           YYST
     C   72              MOVE      'O'           YYTVST
     C   72KOPHK3        CHAIN     TRAVH3                             72
     C  N72THTNR         COMP      UTNR                               7272
     C     *IN72         IFEQ      *OFF
     C                   MOVE      THÅR          W1PERÅ
     C                   MOVE      THMND         W1PERM
      * FANT INGEN HOVED-POSTER.. -
      * SJEKK GODSKR. UTENOM TUR M/STAT O (DUMMY TRAVH FJERNET I SYKR35)
     C                   ELSE
     C                   MOVE      *ZEROS        THTAVD
     C                   MOVE      UTNR          THTUNR
     C   72TRAVVK        CHAIN     TRAVV2                             72
     C     *IN72         IFEQ      '0'
      * LESELOOP I FAK3 (STATUS O + FAKTNR) FOR Å FINNE PERIODE...
     C                   MOVE      *ZEROS        THDATO
     C                   MOVE      *ZEROS        THDAFF
     C                   MOVE      *ZEROS        W1PERÅ
     C                   MOVE      *ZEROS        W1PERM
     C                   MOVE      'O'           YYST
N01  c     tvbnrb        ifne      *zeros
N01  C     TVBNRB        CHAIN     KOSBU                              40
N01  C  N40              Z-ADD     BUPÅR         W1PERÅ
N01  C  N40              Z-ADD     BUPMN         W1PERM
N01  C                   END
     C     KOPHK3        SETLL     FAK3
     C     KOPHK3        READE     FAK3                                   33
     C   33              MOVE      'T'           YYST
     C   33KOPHK3        SETLL     FAK3
     C   33KOPHK3        READE     FAK3                                   33
     C     *IN33         DOWEQ     '0'
     C                   MOVEL     FAVT          FAVT8             8
     C     FAVT8         IFEQ      'AVREGNIN'
     C     FAVT8         OREQ      '*AVR*DIR'
     C     FAVT8         OREQ      '*AVF*FOR'
     C     FAVT8         OREQ      '*AGD*GOD'
     C     FAVT8         OREQ      '*AGF*GOD'
     C                   MOVE      FAÅR          W1PERÅ
     C                   MOVE      FAMND         W1PERM
     C                   MOVE      FADATO        THDATO
     C                   MOVE      FADAFF        THDAFF
     C                   LEAVE
     C                   END
     C     KOPHK3        READE     FAK3                                   33
     C                   END
     C                   END
     C                   END
     C                   MOVE      'O'           YYST
     C                   ENDSR
     C*
     C***********************************************
     C     HITTIL        BEGSR
     C***********************************************
     c                   move      *zeros        wrfakt
     C                   move      *zeros        UMVAL
     C                   move      *zeros        MMVAL
     C                   move      *zeros        MVAL
     C                   move      *zeros        TOTL
     c                   setoff                                       33
     C                   WRITE     totberh
     C                   CALL      'SYTR23S'
     C                   PARM                    THTNR             8 0          *ALPHA
     C                   PARM                    W1PERÅ            2 0
     C                   PARM                    XFN               7 0
     c     wrfakt        setll     wrktavrr
     c     *in(33)       doweq     '0'
     C                   read      wrktavrr                               33
     c     *in(33)       ifeq      '0'
     C                   ADD       UMVA          UMVAL
     C                   ADD       MMVA          MMVAL
     C                   ADD       MVA           MVAL
     C                   ADD       TOT           TOTL
     C                   WRITE     TOTBERD
     C                   END
     c                   END
     C                   WRITE     TOTBERL
     C                   ENDSR
