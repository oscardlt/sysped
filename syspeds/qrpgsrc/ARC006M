********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 variabel bane      .....
11XXX * 02 SH  PTF11 kan ikke merge ved annet enn .PDF
11XXX * 03 SH  PTF11 øker til 300 dokementer
11XXX * 04 SH  PTF11 BRUDD VED 150 DOKUMENTER
11XXX * 05 SH  PTF11 ikke slå sammen ekstra vedlegg
11XXX * 06 SH  PTF11 dobler kapaitet
********************************************************************
      *
********************************************************************
      * program som slår sammen PDF'er
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
********************************************************************
      *
     Farkepol2  UF   E           K DISK
     D KOMMSTR         C                   CONST('CONCATPDF -
     D                                     INPDF(')
     D KOMMEND         C                   CONST(')')
     D PAR1            C                   CONST('INPDF(')
     D PAR2            C                   CONST('OUTPDF(')
     D PAR3            C                   CONST('JDEBUG(')
      * Definere  hex appostrof
     D Ap              c                   x'7D'
     D                SDS
     D  UUSER                254    263
     C*
     C     *ENTRY        PLIST
s01  C*                  PARM                    DOKMERG          22
n01  C                   PARM                    DOKMERG          40
n04  C                   PARM                    FLERM             1
N04  C                   move      'N'           flerm
     C*
     C                   move      '*NO '        nei               4
s03  C*                  Z-ADD     21000         UCMDL            15 5
s06  C*                  Z-ADD     30000         UCMDL            15 5
n06  C                   Z-ADD     32000         UCMDL            15 5

     C                   Eval      utstreng='CONCATPDF INPDF('
     C                   EXSR      LESPDF
s05  C*    merge         ifeq      'N'
s05  C*                  goto      slutt
s05  c*                  end
      *
      * HVIS FLERE DOKUMENT SLÅ SAMMEN
      *
      *
     C     EPN           IFGT      1
s03  C*                  cat       ') OUTPDF(':0 utstreng      21000
s06  C*                  cat       ') OUTPDF(':0 utstreng      30000
n06  C                   cat       ') OUTPDF(':0 utstreng      60000
     c                   cat       Ap:0          utstreng
     c                   cat       DOKMERG:0     utstreng
     c                   cat       Ap:0          utstreng
     C                   cat       ') JDEBUG(':0 utstreng
     c                   cat       Ap:0          utstreng
     C                   cat       NEI:0         utstreng
     c                   cat       Ap:0          utstreng
     C                   cat       ')':0         utstreng
     c                   movel     utstreng      UCMD
     C                   CALL      'QCMDEXC'                            33
s03  C*                  PARM                    UCMD          21000
S06  C*                  PARM                    UCMD          30000
n06  C                   PARM                    UCMD          32000
     C                   PARM                    UCMDL
     C                   EXSR      OPDPDF
     C                   END
      *
n02  c     slutt         tag
     c                   seton                                        lr
     c                   return
      *
     C***********************************************************************
     C     LESPDF        BEGSR
     C***********************************************************************
      *
      * skriver linker
      *
n04  c                   z-add     0             antall            5 0
s03  c*                  z-add     0             epn               2 0
n03  c                   z-add     0             epn               3 0
     c     uuser         setll     arkepol2
     c     *in(33)       doueq     '1'
     c     uuser         reade(n)  arkepol2                               33
     c     *in(33)       ifeq      '0'
      * dette er reklamevedlegg
N05  c     EPMAIN        andne     'V'
     C     EPBANE        andne     *blanks
      *
      * utelater også ikke PDF'er
      *
N02  C     '.pdf'        SCAN      EPBANE                                 44
N02  C  N44'.PDF'        SCAN      EPBANE                                 44
N05  C     *IN44         IFEQ      '1'
      *
S04  c* N44              move      'N'           merge             1
S04  c* N44              goto      avbryt
s03  c*                  add       1             epn               2 0
n03  c                   add       1             epn
     c     epn           ifeq      1
s03  c*                  move      epbane        epbane1         140
n03  c                   movel     epbane        epbane1         100
     c                   end
     c     epn           ifgt      1
     c                   cat       Ap:1          utstreng
     c                   else
     c                   cat       Ap:0          utstreng
     c                   end
     c                   cat       epbane:0      utstreng
     c                   cat       Ap:0          utstreng
     c                   cat       ' ':0         utstreng
n06  c*    epn           ifgt      149
n06  c     epn           ifgt      299
n04  c                   move      'J'           flerm
n04  c                   goto      avbryt
n04  c                   end
     c                   end
N05  c                   end
     c                   enddo
s02  c*                  endsr
n02  c     avbryt        endsr
      *
     C***********************************************************************
     C     OPDPDF        BEGSR
     C***********************************************************************
      *
      * skriver linker
      *
      *
     c                   setoff                                       33
s03  c*                  z-add     0             epn                 0
n03  c                   z-add     0             epn
      *
      * leser workfil
      *
     c     uuser         setll     arkepol2
      * start do
     c     *in(33)       doueq     '1'
     c     uuser         reade     arkepol2                               33
      * start record lest bane ne blank
     c     *in(33)       ifeq      '0'
N04  c     EPMAIN        andne     'V'
     C     EPBANE        andne     *blanks
     C     EPBANE        andne     dokmerg
N05  C     '.pdf'        SCAN      EPBANE                                 44
N05  C  N44'.PDF'        SCAN      EPBANE                                 44
N05  C     *IN44         IFEQ      '1'
s03  c*                  add       1             epn               2 0
n03  c                   add       1             epn
     c     epbane1       IFEQ      epbane
     c                   EVAL      EPBANE=DOKMERG
     c                   update    arkepor
     c                   ELSE
     c     eptex1        ifeq      *blanks
     c     eptex2        andeq     *blanks
     c                   delete    arkepor
     c                   else
     c                   EVAL      EPBANE=*blanks
     c                   EVAL      EPLINK=*blanks
     c                   EVAL      EPLINE=*blanks
     c                   update    arkepor
     c                   end
     c                   end
      * end   record lest  bane ne blank
s06  c*    epn           ifgt      149
s06  c     epn           ifgt      299
n04  c                   goto      avbryto
n04  c                   end
     c                   end
N05  c                   end
      * end   do
     c                   enddo
s04  c*                  endsr
n04  c     avbryto       endsr
