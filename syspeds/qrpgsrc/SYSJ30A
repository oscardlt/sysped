      *
      ***********************************************************
      *** PROGRAM SKAL BEREGNE FRAKT PÅ NYTT ETTER ENDRING    ***
      ***         AV KURS                                     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 37-99                      ***
      ***********************************************************
      *
     FCDERF     UF   E           K DISK
     FCDERLF01  IF   E           K DISK
     F                                     RENAME(CDERFR:CDERFR1)
     FCDERAF    IF   E           K DISK
     FFAKT      UF   E           K DISK
     FHEADF     IF   E           K DISK
     FBILLOFL8  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FKODTGE    IF   E           K DISK
     C*
     C                   EXSR      INIT
     C*
     C     'J'           SETLL     CDERLF01
     C     START         TAG
     C     'J'           READE     CDERLF01                               33
     C   33              GOTO      SLUTT
     C     CEVAL         IFEQ      FICURR
     C                   GOTO      START
     C                   END
      *
     C                   MOVE      CECDB         YCDB
     C                   MOVE      CEREIS        YREIS
     C                   MOVE      CEDT          YDT
     C                   MOVE      CEVAL         YVAL
     C                   ADD       1             CEDT
     C     VALU1K        CHAIN     VALUL01                            34
     C   34              Z-ADD     1             OMRFAK
     C     CEKRSK        DIV       OMRFAK        XKRSK            11 7
     C     CEKRSS        DIV       OMRFAK        XKRSS            11 7
      *
     C                   MOVE      '99999999'    XDT               8 0
     C     CDERFK        SETLL     CDERF                              34
     C     CDERK2        READE(N)  CDERF                                  34
     C  N34              MOVE      CEDT          XDT
      *
     C     BILL8K        SETLL     BILLOFL8                           34
     C     START2        TAG
     C     BIL8K2        READE     BILLOFL8                               34
     C  N34BLDTA         COMP      XDT                                34
     C   34              DO
     C     CDERKO        CHAIN     CDERF                              34
     C                   MOVE      'N'           CENYR
     C                   EXCEPT    NYCDER
     C                   GOTO      START
     C                   END
      *
     C     HEADFK        CHAIN     HEADF                              35
     C                   MOVE      YVAL          YVAL2             3
     C                   MOVE      HEKNSF        YKNS              8 0
     C     CDEAKS        CHAIN     CDERAF                             35
     C   35              MOVE      *BLANKS       YVAL2
     C   35CDEAKS        CHAIN     CDERAF                             35
     C   35              MOVE      *ZEROS        YKNS
     C   35              MOVE      YVAL          YVAL2
     C   35CDEAKS        CHAIN     CDERAF                             35
     C   35              MOVE      *BLANKS       YVAL2
     C   35CDEAKS        CHAIN     CDERAF                             35
     C  N35CEAPR         IFEQ      0                                            1<-B
     C                   ADD       CEABL         XKRSS
     C                   ELSE                                                   1
     C     CEAPR         DIV       100           XWORK            17 5
     C                   ADD       1             XWORK
     C                   MULT(H)   XWORK         XKRSS
     C                   END                                                    1<-E
     C                   MOVE      YVAL          YVAL2             3
     C                   MOVE      HEKNKF        YKNK              8 0
     C     CDEAKK        CHAIN     CDERAF                             35
     C   35              MOVE      *BLANKS       YVAL2
     C   35CDEAKK        CHAIN     CDERAF                             35
     C   35              MOVE      *ZEROS        YKNK
     C   35              MOVE      YVAL          YVAL2
     C   35CDEAKK        CHAIN     CDERAF                             35
     C   35              MOVE      *BLANKS       YVAL2
     C   35CDEAKK        CHAIN     CDERAF                             35
     C  N35CEAPR         IFEQ      0                                            1<-B
     C                   ADD       CEABL         XKRSK
     C                   ELSE                                                   1
     C     CEAPR         DIV       100           XWORK            17 5
     C                   ADD       1             XWORK
     C                   MULT(H)   XWORK         XKRSK
     C                   END                                                    1<-E
     C     FAKTK         SETLL     FAKT                               35
     C     START3        TAG
     C     FAKTK         READE     FAKT                                   35
     C  N35FAOPKO        IFEQ      ' '                                          1<-B
     C     FAVAL         ANDEQ     YVAL
     C     FASK          IFEQ      'S'                                           2<-B
     C     FASK          OREQ      'K'
     C     FAKDA         IFEQ      'A'                                            3<-B
     C     FAKDA         OREQ      'B'
     C     FAVK          IFNE      'SEA'                                           4<-B
     C     KODGEK        CHAIN     KODTGE                             36
     C  N36              MOVE      KGETYP        FAVK
     C                   END                                                       4<-E
     C     FAVK          IFEQ      'SEA'                                           4<-B
     C     FASK          IFEQ      'S'                                              5<-B
     C     FABELV        MULT(H)   XKRSS         FABELN
     C                   ELSE                                                       5
     C     FABELV        MULT(H)   XKRSK         FABELN
     C                   END                                                        5<-E
     C                   EXCEPT    NYFAK
     C                   GOTO      START3
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C  N35              EXCEPT    DUMFAK
     C  N35              GOTO      START3
      *
     C                   GOTO      START2
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CDERFK        KLIST
     C                   KFLD                    YCDB
     C                   KFLD                    YREIS
     C                   KFLD                    YVAL
     C                   KFLD                    CEDT
     C     CDERK2        KLIST
     C                   KFLD                    YCDB
     C                   KFLD                    YREIS
     C                   KFLD                    YVAL
     C     CDERKO        KLIST
     C                   KFLD                    YCDB              5
     C                   KFLD                    YREIS            14
     C                   KFLD                    YVAL              3
     C                   KFLD                    YDT               8 0
     C     CDEAKK        KLIST
     C                   KFLD                    YKNK
     C                   KFLD                    YVAL2
     C     CDEAKS        KLIST
     C                   KFLD                    YKNS
     C                   KFLD                    YVAL2
     C     BILL8K        KLIST
     C                   KFLD                    YCDB
     C                   KFLD                    YREIS
     C                   KFLD                    YDT
     C     BIL8K2        KLIST
     C                   KFLD                    YCDB
     C                   KFLD                    YREIS
     C     HEADFK        KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     FAKTK         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     KODGEK        KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    FAVK
     C                   MOVE      'GE'          KGEUNI
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YVAL
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
     C*
     OFAKTR     E            DUMFAK
     O          E            NYFAK
     O                       FABELN
     OCDERFR    E            NYCDER
     O                       CENYR
