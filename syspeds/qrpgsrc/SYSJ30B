********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 DECIMAL
********************************************************************
      *
      *
      ***********************************************************
      *** PROGRAM SKAL OMREGNE FRAKT ETTER KURS               ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-99                      ***
      ***********************************************************
      *
N01  FFIRM      IF   E           K DISK
     FCDERF     IF   E           K DISK
     FCDERAF    IF   E           K DISK
     C*
     C                   EXSR      INIT
      *
     C     CDERFK        SETLL     CDERF
     C     CDERK2        READPE    CDERF                                  33
     C   33              Z-ADD     UVKU          CEKRSS
     C   33              Z-ADD     UVKU          CEKRSK
      *
     C     USK           IFEQ      'K'
     C     CEKRSK        DIV       UOMR          XKRS             11 7
     C                   ELSE
     C     CEKRSS        DIV       UOMR          XKRS             11 7
     C                   END
      *
     C                   MOVE      UVAL          YVAL              3
     C                   MOVE      UKN           YKN               8 0
     C     CDEARK        CHAIN     CDERAF                             33
     C   33              MOVE      *BLANKS       YVAL
     C   33CDEARK        CHAIN     CDERAF                             33
     C   33              MOVE      *ZEROS        YKN
     C   33              MOVE      UVAL          YVAL
     C   33CDEARK        CHAIN     CDERAF                             33
     C   33              MOVE      *BLANKS       YVAL
     C   33CDEARK        CHAIN     CDERAF                             33
     C  N33CEAPR         IFEQ      0                                            1<-B
     C                   ADD       CEABL         XKRS
     C                   ELSE                                                   1
     C     CEAPR         DIV       100           XWORK            17 5
     C                   ADD       1             XWORK
     C                   MULT(H)   XWORK         XKRS
     C                   END                                                    1<-E
      *
     C     UBELV         MULT(H)   XKRS          UBELN
N01  C                   EXSR      DECI
      *
     C                   SETON                                        LR
     C                   RETURN
     C*
N01   ***********************************************
N01  C     DECI          BEGSR
N01   ***********************************************
N01   * TEST FIRMS NUMBER OF DECIMALS
N01   *
N01   * NO DECIMALS
N01  C     FIDECI        IFEQ      0
N01  C                   Z-ADD(H)  UBELN         XBEL0            11 0
N01  C                   Z-ADD     XBEL0         UBELN
N01  C                   ELSE
N01   * 1 DECIMAL
N01  C     FIDECI        IFEQ      1
N01  C                   Z-ADD(H)  UBELN         XBEL1            12 1
N01  C                   Z-ADD     XBEL1         UBELN
N01  C                   END
N01  C                   END
N01   *
N01  C                   ENDSR
N01   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CDERFK        KLIST
     C                   KFLD                    UCDB
     C                   KFLD                    UREIS
     C                   KFLD                    UVAL
     C                   KFLD                    UDT8
     C     CDERK2        KLIST
     C                   KFLD                    UCDB
     C                   KFLD                    UREIS
     C                   KFLD                    UVAL
     C     CDEARK        KLIST
     C                   KFLD                    YKN
     C                   KFLD                    YVAL
      *
     C     *ENTRY        PLIST
     C                   PARM                    UCDB              5
     C                   PARM                    UREIS            14
     C                   PARM                    UVAL              3
     C                   PARM                    UDT               6 0
     C                   PARM                    USK               1
     C                   PARM                    UKN               8 0
     C                   PARM                    UBELV            13 2
     C                   PARM                    UBELN            13 2
     C                   PARM                    UVKU              7 4
     C                   PARM                    UOMR              3 0
     C     *LOVAL        SETLL     CDERF
     C                   READ      CDERF                                  33
     C   33              DO
     C     CDEARK        CHAIN     CDERAF                             33
     C   33              SETON                                        LR
     C                   RETURN
     C                   END
N01  C     *LOVAL        SETLL     FIRM
N01  C                   READ      FIRM                                   33
      *
     C     UDT           IFEQ      0
     C                   MOVE      *ZEROS        UDT8              8 0
     C                   ELSE
     C     UDT           IFGT      501231
     C     UDT           ADD       19000000      UDT8
     C                   ELSE
     C     UDT           ADD       20000000      UDT8
     C                   END
     C                   END
      *
     C                   ENDSR
     C*
