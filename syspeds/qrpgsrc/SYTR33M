********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10172 * 01 SH  PTF10 norsk text til Track and trace
********************************************************************
      ***********************************************************
      *** Merke mottatt pÂ terminal                           ***
      ***********************************************************
     FSYTR33MD  CF   E             WORKSTN
     FFIRM      IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FFRISOL01  IF   E           K DISK
     F                                     RENAME(FRISOKR:FRIS1R)
     FDISP      UF   E           K DISK
     FTRACKF    O  A E             DISK
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULTM4                 1      4  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XUL≈≈                 11     14  0
     D                 DS
     D  UL≈≈                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     C                   EXSR      INIT
     C*
     C                   EXFMT     BILDE
     C   12              GOTO      SLUTT
     C*
     c                   EXSR      HOVED
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C***********************************************
     C     HOVED         BEGSR
     C***********************************************
     C*
     C     UEDSNR        IFEQ      *zeros
     c                   move      uavd          FsAvd
     c                   move      uopd          FsOpd
     c                   exsr      ettoppd
     C                   else
     c                   MOVE      *blanks       FSSOK
     c                   MOVEL     UEDSNR        FSSOK
     c     Frisok1K      setll     frisol01
     c     Frisok1K      reade     frisol01                               33
     C     *in33         Doweq     '0'
     c                   exsr      ettoppd
     c     Frisok1K      reade     frisol01                               33
     C                   enddo
     C                   ENDIF
      *
     C                   ENDSR
     C***********************************************
     C     EttOppd       BEGSR
     C***********************************************
     c     DISPKEY       Chain     DISP                               33
     c     *in33         ifeq      '0'
     c     DISTA1        IFEQ      'E'
     c     DISTA1        Oreq      'V'
     c                   move      ' '           DISTA1
     c                   end
     c                   update    DISPR
     c     WSMOTT        IFEQ      'J'
     C     FIURBL        ANDEQ     'J'
     C                   EXSR      TTSR
     C                   END
     c                   end
     C*
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UEDSNR            7 0
     C     DISPKEY       KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     FRISOKK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    FSKODE
     c                   move      'E_S'         FSKODE
     C     FRISOK1K      KLIST
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
      * finn EDI sendingsnr (som binder sammen alle mottatt samtidig...)
     C     UEDSNR        IFEQ      *zeros
     C     FRISOKK       CHAIN     FRISOK                             33
     C     *in33         IFEQ      *Off
     C                   MOVEL     FSSOK         TMPsnr            7
     C                   TESTN                   TMPsnr               34
     C     *IN34         IFEQ      '1'
     C                   MOVE      TMPSNR        UEDSNR                          UTL.POSTNR
     C                   END
     c                   end
     c                   end
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   movel     FIKRTN        FITERM
      *
     C*
     c                   move      *zeros        AntOpd
     C     UEDSNR        IFNE      *zeros
     c                   MOVE      *blanks       FSSOK
     c                   MOVEL     UEDSNR        FSSOK
     c     Frisok1K      setll     frisol01
     c     Frisok1K      reade     frisol01                               33
     C     *in33         Doweq     '0'
     c                   add       1             AntOpd
     c     Frisok1K      reade     frisol01                               33
     C                   enddo
     C                   ELSE
      * OPPDRAGET SELV BLIR ALLTID MERKET...
     c                   Z-ADD     1             AntOpd
     C                   ENDIF
     C                   Move      'J'           WSMOTT
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XUL≈≈         UL≈≈
     C                   MOVE      ULDT          WSDATO
     C                   MOVE      XULTM4        WSTID
     C*
     C                   ENDSR
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
      *
     C                   MOVE      FSAVD         TTAVD
     C                   MOVE      FSOPD         TTOPD
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XUL≈≈         UL≈≈
     C                   MOVE      'TEI'         TTACTI
     C                   MOVE      ULDT          TTDATL
     C                   MOVE      XULTM         TTTIML
     C                   MOVE      WSDATO        TTDATE
     C     WSTID         MULT      100           TTTIME
     C                   MOVEL     ZUSER         TTUSER
     C                   EVAL      TTTEXT = 'Arrived on terminal ' + FITERM
n01  C                   EVAL      TTTEXL = 'Ankommet terminal   ' + FITERM
     C                   MOVEL     FITERM        TTDEPO
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
