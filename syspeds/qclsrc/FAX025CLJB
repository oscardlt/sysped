/* TOLLDEK   BLUEFAX */
             PGM        PARM(&BPARM)
             DCL        VAR(&PRT1) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT3) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FAXTYP) TYPE(*CHAR) LEN(1) VALUE('F')
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VB) TYPE(*CHAR) LEN(1) VALUE(' ') /* +
                          Hvis &VB = 'J',  VALGBILDE              +
                          til bruker. */
             DCL        VAR(&PO) TYPE(*CHAR) LEN(1) VALUE('F') /* +
                          Hvis &PO = 'J',SORT   F=FAX             */
             DCL        VAR(&COVP) TYPE(*CHAR) LEN(8)
             DCL        VAR(&COVL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) VALUE('00') +
                          /* Antall utskrifter. */
             DCL        VAR(&BPARM)    TYPE(*CHAR) LEN(425)
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8) VALUE('00000000')
             DCL        VAR(&NULL5) TYPE(*CHAR) LEN(5) VALUE('00000')
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(21)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&KNAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FBN) TYPE(*CHAR) LEN(3)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&DONAV) TYPE(*CHAR) LEN(12)
             DCL        VAR(&ATTN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
    /* SKRIVER UT FRAKTBREVKOPI           */
    /*                                    */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&FAX) VALUE(%SST(&BPARM 1 21))
             CHGVAR     VAR(&FILEN) VALUE(%SST(&BPARM 22 10))
             CHGVAR     VAR(&PTIME) VALUE(%SST(&BPARM 32 8))
             CHGVAR     VAR(&PDATE) VALUE(%SST(&BPARM 40 8))
             CHGVAR     VAR(&KNAVN) VALUE(%SST(&BPARM 48 30))
             CHGVAR     VAR(&AVD) VALUE(%SST(&BPARM 78 4))
             CHGVAR     VAR(&OPD) VALUE(%SST(&BPARM 82 7))
             CHGVAR     VAR(&KODE) VALUE(%SST(&BPARM 89 1))
             CHGVAR     VAR(&DONAV) VALUE(%SST(&BPARM 90 12))
             CHGVAR     VAR(&CVP1) VALUE(%SST(&BPARM 102 40))
             CHGVAR     VAR(&CVP2) VALUE(%SST(&BPARM 142 40))
             CHGVAR     VAR(&CVP3) VALUE(%SST(&BPARM 182 40))
             CHGVAR     VAR(&CVP4) VALUE(%SST(&BPARM 222 40))
             CHGVAR     VAR(&CVP5) VALUE(%SST(&BPARM 262 40))
             CHGVAR     VAR(&CVP6) VALUE(%SST(&BPARM 302 40))
             CHGVAR     VAR(&CVP7) VALUE(%SST(&BPARM 342 40))
             CHGVAR     VAR(&CVP8) VALUE(%SST(&BPARM 382 40))
             CHGVAR     VAR(&FBN) VALUE(%SST(&BPARM 422 3))
             CHGVAR     VAR(&CVP) VALUE(%SST(&BPARM 425 1))
             CHGVAR     VAR(&ATTN) VALUE(%SST(&CVP2 1 30))
             OVRPRTF    FILE(&FILEN)  DEVTYPE(*SCS) +
                          PAGESIZE(72 83) LPI(6) CPI(10) +
                          FRONTMGN(0.14 0) OVRFLW(72) +
                          FRONTOVL(*LIBL/FSAD38) OUTQ(FAX/FAXOUT) +
                          FORMTYPE(*STD)
             OVRPRTF    FILE(TOLLDEK2) DEVTYPE(*SCS) +
                          PAGESIZE(72 83) LPI(6) CPI(10) +
                          OVRFLW(72) +
                          OUTQ(QPRINT) FORMTYPE(*STD)
             OVRPRTF    FILE(DATALIST) DEVTYPE(*SCS) +
                          PAGESIZE(72 83) LPI(6) CPI(10) +
                          OVRFLW(72) +
                          OUTQ(FAX/FAXOUT) FORMTYPE(*STD)
             OVRDBF     FILE(WFILEIMP) MBR(SADPRT)
             OVRDBF     FILE(WFILEEXP) MBR(SADPRT)

             IF         COND(&KODE = 'I') THEN(DO)
             CALL       PGM(SAD61P) PARM(&FAXTYP &AVD &OPD &PRT1 +
                          &PRT2 &PRT3)
             ENDDO
             IF         COND(&KODE = 'E') THEN(DO)
             CALL       PGM(SAD52P) PARM(&FAXTYP &AVD &OPD &PRT1 +
                          &PRT2 &PRT3)
             ENDDO

             CALL       PGM(FAX017) PARM(&FAX)


             IF         COND(&CVP = 'J') THEN(FAX/SNDFAXSPLF +
                          FILE(&FILEN) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST) RCP((&FAX *N &KNAVN)) +
                          CPGPAG(*DFT) CPGTXT(&CVP1 &CVP2 &CVP3 +
                          &CVP4 &CVP5 &CVP6 &CVP7 &CVP8))
             ELSE       CMD(FAX/SNDFAXSPLF FILE(&FILEN) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST) +
                          RCP((&FAX *N &KNAVN)))


             /* SENDER EVT. DATALISTE              */

             IF         COND(&FAXTYP = ' ') THEN(GOTO CMDLBL(SLUTTN))

             IF         COND(&CVP = 'J') THEN(FAX/SNDFAXSPLF +
                          FILE(DATALIST) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST) RCP((&FAX *N &KNAVN)) +
                          CPGPAG(*DFT) CPGTXT(&CVP1 &CVP2 &CVP3 +
                          &CVP4 &CVP5 &CVP6 &CVP7 &CVP8))
             ELSE       CMD(FAX/SNDFAXSPLF FILE(DATALIST) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST) +
                          RCP((&FAX *N &KNAVN)))

SLUTTN:      CHGVAR     VAR(&KODE) VALUE('O')

             CALL       PGM(FAX013) PARM(&QUSER &QNBR &QJOB +
                          &FAX &DONAV &MAPPE &PTIME &PDATE &KNAVN +
                          &AVD &OPD &TUR &KODE)
    /* */
 SLUTT:      ENDPGM
