********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 Kan sende SDVfil     ...
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL SKRIVE UT GODSJOURNAL                     ***
      **************************************************************
      *
N01  FSYTL02F   O  A E             DISK
     Ftrih05    IF   E           K DISK
     Ftril      IF   E           K DISK
     FMERKNF    IF   E           K DISK
     FGODSJL01  IF   E           K DISK
     FGODSFI    IF   E           K DISK
     FSYTL02FM  CF   E             WORKSTN
     FSYTL02PF  O    E             PRINTER
     FSYTL02P2  O    E             PRINTER OFLIND(*IN66)
     D                 DS
     D  WSGNF                  1     15
     D  WSGNF1                 1      9
     D  WSGNFD                10     12
     D  WSGNF2                13     15
     D                 DS
     D  XXMKOD                 1      5
     D  XXMKO1                 1      2
     D  SLASJ                  3      3
     D  XXMKO2                 4      5
     D                 DS
     D  WSGNT                  1     15
     D  WSGNT1                 1      9
     D  WSGNTD                10     12
     D  WSGNT2                13     15
     D                 DS
     D  GOGN                   1     15
     D  GOGNGM                 1     11
     D  GOGNDG                10     12
     D  GOGNLØ                13     15
     D  GOGNX1                 9     11
     D  GOGNX2                13     15
     D  GOGN13                13     13
     D  GOGN11                15     15
     D                 DS
     D  GOTRDT                 1      8  0
     D  GOTRDÅ                 1      4  0
     D  GOTRDM                 5      6  0
     D  GOTRDD                 7      8  0
     D                 DS
     D  XOTRDT                 1      6  0
     D  XOTRDD                 1      2  0
     D  XOTRDM                 3      4  0
     D  XOTRDÅ                 5      6  0
     D                 DS
     D  GOGRDT                 1      8  0
     D  GOGRDÅ                 1      4  0
     D  GOGRDM                 5      6  0
     D  GOGRDD                 7      8  0
     D                 DS
     D  XOGRDT                 1      6  0
     D  XOGRDD                 1      2  0
     D  XOGRDM                 3      4  0
     D  XOGRDÅ                 5      6  0
     D                 DS
     D  GOLSDT                 1      8  0
     D  GOLSDÅ                 1      4  0
     D  GOLSDM                 5      6  0
     D  GOLSDD                 7      8  0
     D                 DS
     D  XOLSDT                 1      6  0
     D  XOLSDD                 1      2  0
     D  XOLSDM                 3      4  0
     D  XOLSDÅ                 5      6  0
      *
     C     *ENTRY        PLIST
     C                   PARM                    UKOD              5
     C                   PARM                    UKOD2             1
     C                   PARM                    UDATO             6
     C                   PARM                    UDAG              3
N01  C                   PARM                    UEPJN             1
      *
     C     GODKEY        KLIST
     C                   KFLD                    WSGNF
      *
     C                   MOVE      *ZEROS        GOTRDT
     C                   MOVE      *ZEROS        GOGRDT
     C                   MOVE      *ZEROS        GOLSDT
     C                   MOVE      *ZEROS        XOTRDT
     C                   MOVE      *ZEROS        XOGRDT
     C                   MOVE      *ZEROS        XOLSDT
     C                   TIME                    TID               6 0
     C                   MOVE      UDATO         DSCCAA            4
     C                   MOVEL     '20'          DSCCAA
     C                   MOVEL     DSCCAA        WSGNF1
     C                   MOVE      UKOD          WSGNF1
     C                   MOVE      UDAG          WSGNFD
     C     UKOD2         IFNE      ' '
     C                   MOVEL     UKOD2         WSGNF2
     C                   ELSE
     C                   MOVEL     '0'           WSGNF2
     C                   END
     C                   MOVE      '01'          WSGNF2
     C                   MOVEL     DSCCAA        WSGNT1
     C                   MOVE      UKOD          WSGNT1
     C                   MOVE      UDAG          WSGNTD
     C                   MOVE      'G'           WSLITY
     C*
     C     BEVKEY        KLIST
     C                   KFLD                    UKOD
     C                   KFLD                    UKOD2
     C     BEVKEY        CHAIN     GODSFI                             33
     C                   MOVE      GFENH         WSENH
     C                   Z-ADD     08            LINNBR
     C                   Z-ADD     42            POSNBR
     C     START         TAG
     C                   EXFMT     BILDE1
      **  AVSLUTT
     C     *IN03         IFEQ      *ON
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN03
      **
     C                   MOVE      '0'           *IN30
      *
      **  BLANK I TIL-GODSNR (UTOVER BEVILLINGSKODE)--> SAMME SOM FRA
     C     WSGNT2        IFEQ      *BLANKS
     C                   MOVE      WSGNF2        WSGNT2
     C                   ENDIF                                                  <WSGNT
      * IKKE PRINT VED SDV
N01  C     UEPJN         IFNE      'S'
N01  C     WSLITY        ANDEQ     'G'
S01  C*    WSLITY        IFEQ      'G'
     C                   WRITE     HEAD1                                66
     C                   WRITE     HEAD2                                66
     C                   ELSE
     C                   Z-ADD     1             FSIDE             3 0
     C                   WRITE     HEADF1
     C                   WRITE     STREK
     C                   END
     C                   CLEAR                   ANTDET
     C     GODKEY        SETLL     GODSJL01                               39
      *
     C     NYLIN         TAG
     C                   READ      GODSJL01                               39
     C     *IN39         IFEQ      *OFF                                         B1
     C     GOGN          IFGT      WSGNT                                         B2
     C                   GOTO      SLUTT
     C                   ENDIF                                                   E2
      * NORMAL GODSREGISTR. - GRENSEPASS.STEDS SKAL VÆRE BLANK
     C     WSLITY        IFEQ      'G'                                           B2
     C                   ELSE                                                    X2
      * FORHÅNDS-REGISTR. - GRENSEPASS.STEDS SKAL IKKE!! VÆRE BLANK
     C     GOGREN        IFEQ      *BLANKS                                        B3
     C                   GOTO      NYLIN
     C                   END                                                      E3
     C                   END                                                     E2
      * TEST PÅ SIFFER 13..
     C     WSENH         IFNE      *BLANK                                        B2
     C     WSENH         ANDNE     GOGN13
     C                   GOTO      NYLIN
     C                   ENDIF                                                   E2
     C                   MOVE      GOTRDD        XOTRDD
     C                   MOVE      GOTRDM        XOTRDM
     C                   MOVE      GOTRDÅ        XOTRDÅ
     C                   MOVE      GOGRDD        XOGRDD
     C                   MOVE      GOGRDM        XOGRDM
     C                   MOVE      GOGRDÅ        XOGRDÅ
     C                   MOVE      GOLSDD        XOLSDD
     C                   MOVE      GOLSDM        XOLSDM
     C                   MOVE      GOLSDÅ        XOLSDÅ
     C     WSLITY        IFEQ      'G'                                           B2
     C     ANTDET        IFGE      54                                             B3
N01  C     UEPJN         IFNE      'S'
     C                   WRITE     HEAD1                                66
     C                   WRITE     HEAD2                                66
N01  C                   END
     C                   CLEAR                   ANTDET
     C                   END                                                      E3
     C                   EXSR      SRMERK
N01  C     UEPJN         IFNE      'S'
     C                   WRITE     DETALJ                               66
     C                   ADD       1             ANTDET            2 0
N01  C                   ELSE
N01  C                   WRITE     SYTL02FR                             66
N01  C                   END
     C                   ELSE                                                    X2
      * TYPE = F = FORHÅNDSREG
     C     *IN66         IFEQ      *ON                                            B3
N01  C     UEPJN         ANDNE     'S'
     C                   WRITE     FORTS
     C                   ADD       1             FSIDE
     C                   WRITE     HEADF1
     C                   WRITE     STREK
     C                   MOVE      *OFF          *IN66
     C                   END                                                      E3
N01  C     UEPJN         IFNE      'S'
     C                   WRITE     DETALF
     C                   WRITE     DETAL2
N01  C                   ELSE
N01  C                   WRITE     SYTL02FR                             66
N01  C                   END
      * ekstra linje ??? (forh.registr)
     C     GOREI3        IFNE      *BLANKS                                        B3
N01  C     UEPJN         ANDNE     'S'
     C                   WRITE     DETAL3
     C                   ADD       1             ANTDET            2 0
     C                   END                                                      E3
     C     GOREI4        IFNE      *BLANKS                                        B3
N01  C     UEPJN         ANDNE     'S'
     C                   WRITE     DETAL4
     C                   ADD       1             ANTDET            2 0
     C                   END                                                      E3
N01  C     UEPJN         IFNE      'S'
     C                   WRITE     STREK
N01  C                   END                                                     E2
     C                   END                                                     E2
      *
     C                   GOTO      NYLIN
     C                   ENDIF                                                  E1
     C*
     C     SLUTT         TAG
     C* VED FORH.REG. SKRIV BUNN, FOR KVITTERING
     C     WSLITY        IFNE      'G'
N01  C     UEPJN         ANDNE     'S'
     C                   WRITE     BOTTF
     C                   END
     C                   SETON                                        LR
     C***********************************************************
     C     SRMERK        BEGSR
     C***********************************************************
     C                   MOVE      *BLANKS       XXMKOD
     C     KEY           KLIST
     C                   KFLD                    GOGN
     C                   KFLD                    GOTRNR
     C     KEY           SETLL     MERKNF
     C                   SETOFF                                       44
     C     *IN44         DOWEQ     '0'
     C     KEY           READE     MERKNF                                 44
     C     *IN44         IFEQ      '0'
     C     XXMKO1        IFEQ      *BLANKS
     C                   MOVE      GOMKOD        XXMKO1
     C                   ELSE
     C     XXMKO1        IFNE      GOMKOD
     C                   MOVE      '/'           SLASJ
     C                   MOVE      GOMKOD        XXMKO2
     C                   GOTO      UTM
     C                   END
     C                   END
     C                   END
     C                   END
     C     XXMKOD        IFEQ      *BLANKS
     c                   movel     gotrnr        gotr18           18
     C     GOTR18        CHAIN     TRIH05                             45
      *
      * hvis ikke tet sett KO
      *
     c     *in(45)       ifeq      '1'
     C                   MOVE      'KO'          XXMKO1
     C                   GOTO      UTM
     c                   end
      *
      * ikke ferdig tet sett '   '
      *
     c     TIST          ifne      'P'
     C                   GOTO      UTM
     c                   end
      *
      * NIKONF = 1   konform
      *
     c     NIKONF        ifeq      1
     C                   MOVE      'KO'          XXMKO1
     C                   GOTO      UTM
     c                   end
      *
      *   skjekk type merknad i TET
      *
     c     keytet        klist
     c                   kfld                    tiavd
     c                   kfld                    titdn
     c                   setoff                                       44
     c     keytet        setll     tril
     C     *IN44         DOWEQ     '0'
     C     KEYtet        READE     tril                                   44
     C     *IN44         IFEQ      '0'
     c     NVCT          ifeq      'DI'
     c     NVCT          oreq      'NE'
     C     XXMKO1        IFEQ      *BLANKS
     C                   MOVE      NVCT          XXMKO1
     C                   ELSE
     C     XXMKO1        IFNE      NVCT
     C                   MOVE      '/'           SLASJ
     C                   MOVE      NVCT          XXMKO2
     C                   GOTO      UTM
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C     UTM           ENDSR
