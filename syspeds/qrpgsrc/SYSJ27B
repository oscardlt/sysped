********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE BILL OF LADING (DEL)            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01 02 05-11 13 17-26                   ***
      *** LEDIGE INDIKATORER 28 29 31 32 34-93                      ***
      *****************************************************************
      *
     FBILLOF    UF   E           K DISK
     FSTED2     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYSJ27FB  CF   E             WORKSTN INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  BLDTRÅ                 1      4  0
     D  BLDTRM                 5      6  0
     D  BLDTRD                 7      8  0
     D  BLDTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAÅ                 5      6  0
     D  WSDTA                  1      6  0
     D                 DS
     D  BLDTAÅ                 1      4  0
     D  BLDTAM                 5      6  0
     D  BLDTAD                 7      8  0
     D  BLDTA                  1      8  0
     D                 DS
     D  WSDTVD                 1      2  0
     D  WSDTVM                 3      4  0
     D  WSDTVÅ                 5      6  0
     D  WSDTVH                 1      6  0
     D                 DS
     D  BLDTVÅ                 1      4  0
     D  BLDTVM                 5      6  0
     D  BLDTVD                 7      8  0
     D  BLDTVH                 1      8  0
     D                 DS
     D  WSDV2D                 1      2  0
     D  WSDV2M                 3      4  0
     D  WSDV2Å                 5      6  0
     D  WSDVH2                 1      6  0
     D                 DS
     D  BLDV2Å                 1      4  0
     D  BLDV2M                 5      6  0
     D  BLDV2D                 7      8  0
     D  BLDVH2                 1      8  0
     D                UDS
     D  UFIRM                  1      2
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C  N30
     CANN04
     CANN14              Z-ADD     3             LINNBR
     C  N30
     CANN04
     CANN14              Z-ADD     65            POSNBR
     C                   EXFMT     BILDE
     C                   SETOFF                                       30
     C                   MOVEA     '000000'      *IN(94)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C*
     C   12              DO
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      ' '           BLST
     C  N33              UPDATE    BILLOFR
     C                   GOTO      SLUTT
     C                   END
     C*
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START
     C                   END
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C                   EXSR      OPDBL
     C  N03
     CANN15              Z-ADD     0             UFLAGG
     C*
     C     SLUTT         TAG
     C   03              Z-ADD     3             UFLAGG
     C   12              Z-ADD     1             UFLAGG
     C   15              Z-ADD     5             UFLAGG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C*
     C*** TEST AVSENDER.
     C     WSKNA         IFNE      0                                            1<-B
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            99
     C  N99WSNAA         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSAD1A
     C                   MOVE      ADR2          WSAD2A
     C                   MOVE      *BLANKS       WSAD3A
     C     POSTNR        IFEQ      0                                              3<-B
     C                   MOVEL     ADR3          WSAD3A
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3A
     C                   MOVE      ADR3          WSAD3A
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C  N99WSNAA         COMP      *BLANKS                                99
     C   99
     CANN30              MOVE      'SPK0037'     MSGNR
     C   99
     CANN30              SETON                                        30
     C*
     C*** TEST MOTTAKER.
     C     WSKNM         IFNE      0                                            1<-B
     C                   MOVE      WSKNM         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            98
     C  N98WSNAM         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSAD1M
     C                   MOVE      ADR2          WSAD2M
     C                   MOVE      *BLANKS       WSAD3M
     C     POSTNR        IFEQ      0                                              3<-B
     C                   MOVEL     ADR3          WSAD3M
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3M
     C                   MOVE      ADR3          WSAD3M
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C  N98WSNAM         COMP      *BLANKS                                98
     C   98
     CANN30              MOVE      'SPK0038'     MSGNR
     C   98
     CANN30              SETON                                        30
     C*
     C*** TEST NOTIFY
     C     WSKNN         IFNE      0                                            1<-B
     C                   MOVE      WSKNN         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            97
     C  N97WSNAN         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAN
     C                   MOVE      ADR1          WSAD1N
     C                   MOVE      ADR2          WSAD2N
     C                   MOVE      *BLANKS       WSAD3N
     C     POSTNR        IFEQ      0                                              3<-B
     C                   MOVEL     ADR3          WSAD3N
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3N
     C                   MOVE      ADR3          WSAD3N
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C  N97WSNAN         COMP      *BLANKS                                97
     C   97
     CANN30              MOVE      'SPK0134'     MSGNR
     C   97
     CANN30              SETON                                        30
     C*
     C*** TEST LASTEHAVN
     C     WSLSH         CHAIN     STED2                              96
     C   96
     CANN30              MOVE      'SPS0102'     MSGNR
     C   96
     CANN30              SETON                                        30
     C*
     C*** TEST LOSSEHAVN
     C     WSLOH         CHAIN     STED2                              95
     C   95
     CANN30              MOVE      'SPS0104'     MSGNR
     C   95
     CANN30              SETON                                        30
     C*
     C*** TEST CC/PP
     C     WSCP          COMP      ' '                                9494
     C   94WSCP          COMP      'C'                                9494
     C   94WSCP          COMP      'P'                                9494
     C   94
     CANN30              MOVE      'SPC0101'     MSGNR
     C   94
     CANN30              SETON                                        30
     C*
     C   30              EXSR      SETCUR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   94              Z-ADD     11            POSNBR
     C   95              Z-ADD     8             POSNBR
     C   96              Z-ADD     26            POSNBR
     C   97
     COR 98
     COR 99              Z-ADD     6             POSNBR
     C*
     C   94              Z-ADD     14            LINNBR
     C   95              Z-ADD     12            LINNBR
     C   96              Z-ADD     11            LINNBR
     C   97              Z-ADD     8             LINNBR
     C   98              Z-ADD     6             LINNBR
     C   99              Z-ADD     4             LINNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBLW        BEGSR
     C***********************************************
     C                   MOVE      BLKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         WSNAR
     C   33              MOVE      *BLANKS       WSNAR
     C   33              SETOFF                                       33
     C                   MOVE      BLBLNR        WSBLNR
     C                   MOVE      BLKNA         WSKNA
     C                   MOVE      BLNAA         WSNAA
     C                   MOVE      BLAD1A        WSAD1A
     C                   MOVE      BLAD2A        WSAD2A
     C                   MOVE      BLAD3A        WSAD3A
     C                   MOVE      BLKNM         WSKNM
     C                   MOVE      BLNAM         WSNAM
     C                   MOVE      BLAD1M        WSAD1M
     C                   MOVE      BLAD2M        WSAD2M
     C                   MOVE      BLAD3M        WSAD3M
     C                   MOVE      BLKNN         WSKNN
     C                   MOVE      BLNAN         WSNAN
     C                   MOVE      BLAD1N        WSAD1N
     C                   MOVE      BLAD2N        WSAD2N
     C                   MOVE      BLAD3N        WSAD3N
     C                   MOVE      BLLSH         WSLSH
     C                   MOVE      BLLOH         WSLOH
     C                   MOVE      BLCP          WSCP
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBL         BEGSR
     C***********************************************
     C     BLK           CHAIN     BILLOF                             33
     C                   EXSR      MOVWBL
     C  N33              UPDATE    BILLOFR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWBL        BEGSR
     C***********************************************
     C                   MOVE      ' '           BLST
     C                   MOVE      WSBLNR        BLBLNR
     C                   MOVE      WSKNA         BLKNA
     C                   MOVE      WSNAA         BLNAA
     C                   MOVE      WSAD1A        BLAD1A
     C                   MOVE      WSAD2A        BLAD2A
     C                   MOVE      WSAD3A        BLAD3A
     C                   MOVE      WSKNM         BLKNM
     C                   MOVE      WSNAM         BLNAM
     C                   MOVE      WSAD1M        BLAD1M
     C                   MOVE      WSAD2M        BLAD2M
     C                   MOVE      WSAD3M        BLAD3M
     C                   MOVE      WSKNN         BLKNN
     C                   MOVE      WSNAN         BLNAN
     C                   MOVE      WSAD1N        BLAD1N
     C                   MOVE      WSAD2N        BLAD2N
     C                   MOVE      WSAD3N        BLAD3N
     C                   MOVE      WSLSH         BLLSH
     C                   MOVE      WSLOH         BLLOH
     C                   MOVE      WSCP          BLCP
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    UFIRM2
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNA
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNM
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    WSKNN
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
N01   *
N01  C     LINNBR        IFEQ      8
N01  C     POSNBR        ANDGE     6
N01  C     POSNBR        ANDLE     13
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNM
N01  C                   PARM                    UFIRM
N01  C                   PARM                    WSNAM
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      6
N01  C     POSNBR        ANDGE     6
N01  C     POSNBR        ANDLE     13
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNM
N01  C                   PARM                    UFIRM
N01  C                   PARM                    WSNAM
N01  C                   Z-ADD     8             LINNBR
N01  C                   Z-ADD     6             POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      4
N01  C     POSNBR        ANDGE     6
N01  C     POSNBR        ANDLE     13
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    UFIRM
N01  C                   PARM                    WSNAA
N01  C                   Z-ADD     6             LINNBR
N01  C                   Z-ADD     6             POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     POSNBR        IFGE      6
     C     POSNBR        ANDLE     13
     C     LINNBR        IFEQ      4
     C                   MOVE      SOTXT2        YSKMOT            8
     C                   MOVE      WSKNA         YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C     LINNBR        IFEQ      6
     C                   MOVE      SOTXT3        YSKMOT
     C                   MOVE      WSKNM         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C     LINNBR        IFEQ      8
     C                   MOVE      SOTXT4        YSKMOT
     C                   MOVE      WSKNN         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C                   END
     C*
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
     C*
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    UFIRM
     C                   PARM                    YSKKNR
     C                   PARM                    YSKMOT
     C                   PARM                    UFLAGG
     C*
     C     SLVISO        ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      4
     C     LINNBR        OREQ      6
     C     LINNBR        OREQ      8
     C     POSNBR        IFGE      6
     C     POSNBR        ANDLE     13
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     30
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLSH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     8             POSNBR
     C                   Z-ADD     12            LINNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLOH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     11            POSNBR
     C                   Z-ADD     14            LINNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BLK           KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
     C*
     C                   MOVE      UFIRM         UFIRM2            2
S01  C*                  Z-ADD     3             SOANTK            1 0
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        BLDTR
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      *ZEROS        BLDTA
     C                   MOVE      *ZEROS        WSDTVH
     C                   MOVE      *ZEROS        BLDTVH
     C*
     C                   MOVE      'DIV3110'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT1            8
     C                   MOVE      'DIV3159'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C                   MOVE      'DIV3160'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT3            8
     C                   MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C     BLK           CHAIN     BILLOF                             33
     C  N33              DO
     C                   MOVE      'X'           BLST
     C                   UPDATE    BILLOFR
     C                   EXSR      MOVBLW
     C                   EXSR      KDTFMT
     C                   END
     C     BLUR          COMP      'G'                                    27
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BLDTRD        UDT1              2 0
     C                   MOVE      BLDTRM        UDT2              2 0
     C                   MOVE      BLDTRÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   MOVE      BLDTAD        UDT1
     C                   MOVE      BLDTAM        UDT2
     C                   MOVE      BLDTAÅ        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTAD
     C                   MOVE      UDT2          WSDTAM
     C                   MOVE      UDT3          WSDTAÅ
     C*
     C                   MOVE      BLDTVD        UDT1
     C                   MOVE      BLDTVM        UDT2
     C                   MOVE      BLDTVÅ        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTVD
     C                   MOVE      UDT2          WSDTVM
     C                   MOVE      UDT3          WSDTVÅ
     C*
     C                   MOVE      BLDV2D        UDT1
     C                   MOVE      BLDV2M        UDT2
     C                   MOVE      BLDV2Å        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDV2D
     C                   MOVE      UDT2          WSDV2M
     C                   MOVE      UDT3          WSDV2Å
     C*
     C                   ENDSR
     C*
