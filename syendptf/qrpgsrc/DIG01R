     FTURER     IF   E           K DISK
     FSADMOAL1  IF   E           K DISK
     FSADMOTL1  UF A E           K DISK
     FSADMOTL2  IF   E           K DISK    RENAME(SADMOTFR:SADMOTFR2)
     F                                     PREFIX(X_)
     FSADMOML1  UF A E           K DISK
     FSADMOHL1  UF A E           K DISK
     FSADMOHL2  IF   E           K DISK    RENAME(SADMOHFR:SADMOHFR2)
     F                                     PREFIX(Y_)
     FHEAD8     IF   E           K DISK
     FSADH      IF   E           K DISK
     FEDIM4     IF   E           K DISK
     D                 DS
     D  WEHDKH                 1     50
     D  WEHDKH1                1      9    INZ('930923869')
     D  WEHDKH2               10     10    INZ('-')
     D  WEHDKH3               11     14
     D  WEHDKH4               15     15    INZ('-')
     D  WEHDKH5               16     22
     D  WEHDKH6               23     23    INZ('-')
     D  WEHDKH7               24     26    INZ('001')
     D                 DS
     D  WADR1                  1     30
     D  WADR1B                 1      2
     D  WADR4                  4      7
     D  WADR4A1                1      4
     D  WADR4A2                6     30
     D  WADR4B                 4      9
     D  WADR27                 4     30
     D  WADR9                  9     30
     D  WADR9B                11     30
     C                   EXSR      INIT
     C                   EXSR      SADMOT
     C     *IN51         CABEQ     *ON           SLUTT
     C                   EXSR      SADMOM
     C                   EXSR      SADMOH
     C     SLUTT         TAG
     C                   EVAL      *INLR=*ON
      *______________________________________
      * INIT                             INIT
      *""""""""""""""""""""""""""""""""""""""
     C     INIT          BEGSR
     C     *LIKE         DEFINE    TUAVD         UTUAVD
     C     *LIKE         DEFINE    TUPRO         UTUPRO
     C     *LIKE         DEFINE    ETLNRT        WETLNRT
     C     *LIKE         DEFINE    EHLNRH        WEHLNRH
     C     *LIKE         DEFINE    M0068A        WM0068A
     C     *LIKE         DEFINE    MSR           WMSR
     C     TURKEY        KLIST
     C                   KFLD                    UTUAVD
     C                   KFLD                    UTUPRO
     C     HEADFKEY      KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     DIGHKEY       KLIST
     C                   KFLD                    EMLNRT
     C                   KFLD                    EMLNRM
     C     EDIM4KEY      KLIST
     C                   KFLD                    WMSR
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     EDIM4KEYS     KLIST
     C                   KFLD                    WMSR
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    WM0068A
     C     *ENTRY        PLIST
     C                   PARM                    UTUAVD
     C                   PARM                    UTUPRO
     C                   PARM                    USIGN             3
     C                   IF        USIGN=*BLANKS
     C                   EVAL      USIGN='SYS'
     C                   ENDIF
     C                   EVAL      WM0068A=99999999
     C                   EVAL      WMSR='R'
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   ENDSR
      *______________________________________
      * Add/update SADMOTF             SADMOT
      *""""""""""""""""""""""""""""""""""""""
     C     SADMOT        BEGSR
      * Finnes turen? Hvis ikke, avslutt
     C     TURKEY        CHAIN     TURER                              51
     C     *IN51         CABEQ     *ON           SADMOT9
      * Finnes transporten i digitoll? Hvis ikke, lag den
     C     TURKEY        CHAIN     SADMOTL1                           52
     C     *IN52         CABEQ     *OFF          SADMOT9
      * Finn høyeste løpenummer og add med 1
     C                   EVAL      *IN53=*OFF
     C     *LOVAL        SETLL     SADMOTL2
     C     *IN53         DOWEQ     *OFF
     C                   READ      SADMOTL2                               53
     C                   ENDDO
     C                   EVAL      WETLNRT=X_ETLNRT+1
      * Hent mall for avdelingen
     C                   CLEAR                   SADMOTFR
     C                   CLEAR                   SADMOMFR
     C     TUAVD         CHAIN     SADMOAL1
     C                   IF        %FOUND
     C                   ELSE
     C     *LIKE         DEFINE    TUAVD         WTUAVD
     C                   EVAL      WTUAVD=0
     C     WTUAVD        CHAIN     SADMOAL1
     C                   ENDIF
      * Fyll variabler i transport
     C                   EVAL      ETAVD=TUAVD
     C                   EVAL      ETPRO=TUPRO
     C                   EVAL      ETLNRT=WETLNRT
     C                   EVAL      ETDTR=TUDT
     C                   IF        ETDTR=*ZEROS
     C                   MOVE      WDT           ETDTR
     C                   ENDIF
     C                   EVAL      ETSG=USIGN
     C                   EVAL      ETST2='Z'
     C                   EVAL      ETETAD=TUETA
     C                   EVAL      ETSHED=TUETD
     C                   IF        ETETAD=*ZEROS
     C                   CALL      'SYGE20T'
     C                   PARM      'ADD'         Ufunksjon         3
     c                   parm      ETDTR         UDato1            8 0
     c                   parm                    UDato2            8 0
     c                   parm      1             UDager            5 0
     C                   ENDIF
     C                   MOVEL     TUBILN        ETKMRK
     C                   MOVEL     TULKH         ETKLK
     C                   MOVEL     TUTARF        ETCREF
     A*           TUSJA1         8S 0       COLHDG('SJÅFØRNR 1')
     C                   MOVEL     TUSJN1        ETSJAF
     A*           ETEMS         50A         COLHDG('Epostadr/tlf repre.')
     C                   EVAL      ETKNT=TUKNT
     A*           ETRGT         17A         COLHDG('Org.nr transportør')
     C                   MOVEL     TUNAT         ETNAT
     C                   MOVEL     TUAD1T        ETAD1T
     A*           ETPNT          9A         COLHDG('Postnr transportør')
     A*           ETPST         24A         COLHDG('P.sted transortør')
     A*           ETLKT          2A         COLHDG('L.kode transportør')
     A*           ETEMT         50A         COLHDG('Epostadr/tlf trans.')
      * Skriv til transport
     C                   WRITE     SADMOTFR

     C     SADMOT9       ENDSR
      *______________________________________
      * Add/update SADMOMF             SADMOM
      *""""""""""""""""""""""""""""""""""""""
     C     SADMOM        BEGSR
      * Fyll variabler i manifest
     C                   EVAL      EMAVD=TUAVD
     C                   EVAL      EMPRO=TUPRO
     C                   EVAL      EMLNRT=WETLNRT
     C                   EVAL      EMLNRM=1
     C                   MOVE      WDT           EMDTR
     C                   EVAL      EMSG=USIGN
     C                   EVAL      EMST2='Z'
     C                   EVAL      EMVKB=TUTVKT
     C                   EVAL      EMKNT=ETKNT
     C                   EVAL      EMRGT=ETRGT
     C                   MOVEL     TUTARF        EMDKM
     C     EMDKM         CAT       '-':0         EMDKM
     C     EMDKM         CAT       USIGN:0       EMDKM
     C     EMDKM         CAT       WTM:0         EMDKM
     C                   EVAL      EMDKMT='N730'
      * Skriv til manifest
     C                   WRITE     SADMOMFR

     C                   ENDSR
      *______________________________________
      * Add/update SADMOHF             SADMOH
      *""""""""""""""""""""""""""""""""""""""
     C     SADMOH        BEGSR
      * Les alle oppdrag som tilhører turen
     C                   EVAL      *IN53=*OFF
     C     TURKEY        SETLL     HEAD8
     C     TURKEY        READE     HEAD8                                  53
     C     *IN53         DOWEQ     *OFF
     C     HEADFKEY      CHAIN     SADMOHL1                           54
     C                   IF        *IN54
     C     HEADFKEY      CHAIN     SADH
     C                   EXSR      SADMOH2
     C                   ENDIF
     C     TURKEY        READE     HEAD8                                  53
     C                   ENDDO

     C                   ENDSR
      *______________________________________
      * Add/update SADMOHF            SADMOH2
      *""""""""""""""""""""""""""""""""""""""
     C     SADMOH2       BEGSR
      * Finn høyeste løpenummer og add med 1
     C                   EVAL      *IN55=*OFF
     C     DIGHKEY       SETLL     SADMOHL2
     C     *IN55         DOWEQ     *OFF
     C                   READ      SADMOHL2                               55
     C                   ENDDO
     C                   EVAL      WEHLNRH=Y_EHLNRH+1
      * Fyll variabler i house
     C                   CLEAR                   SADMOHFR
     C                   EVAL      EHST2='Z'
     C                   EVAL      EHPRO=TUPRO
     C                   EVAL      EHAVD=TUAVD
     C                   EVAL      EHTDN=HEOPD
     C                   EVAL      EHLNRT=EMLNRT
     C                   EVAL      EHLNRM=EMLNRM
     C                   EVAL      EHLNRH=WEHLNRH
     C                   EVAL      EHCNIN=EMCN
     C                   EVAL      EHVKB=HEVKT
     C                   EVAL      EHNTK=HENT
     C                   EVAL      EHVT='Se SAD'
     C                   EVAL      EHDKHT='N730'
     C                   EVAL      EHPRT='IMMEDIATE_RELEASE_IMPORT'
     C                   EVAL      EHUPR='EXP'
     C                   MOVEL     '999999999'   EHRG
     C                   EVAL      *IN79=*OFF
     C     EDIM4KEYS     SETLL     EDIM4
     C     EDIM4KEY      READPE    EDIM4                                  79
     C                   IF        *IN79=*OFF
     C                   EVAL      EH0068A=M0068A
     C                   EVAL      EH0068B=M0068B
     C                   ENDIF
     C                   EVAL      EHTRTY='CUDE'
     C                   EVAL      EHTRTY2='N820'
     C                   EVAL      EHETYPT='AES_EXPORT'
     C                   EVAL      EHTPPS=2
     C                   EVAL      EHKNS=HEKNS
     C                   MOVEL     HENAS         EHNAS
     C                   MOVEL     HEADS2        EHAD1S
     C                   MOVEL     HELKS         EHLKS
     C                   EVAL      EHPNS='.'
     C                   MOVEL     HEADS3        EHPSS

     C                   EVAL      EHEMST='TE'
     C                   EVAL      EHTPPM=2
     C                   EVAL      EHEMMT='TE'
     C                   EVAL      EHKNM=HEKNK
     C                   MOVEL     SIRG          EHRGM
     C                   MOVEL     HENAK         EHNAM
     C                   MOVEL     HEADK2        EHAD1M
     C                   EVAL      EHLKM='NO'
     C                   MOVEL     HEADK3        WADR1
     C                   MOVEL     WADR4A1       EHPNM
     C                   MOVEL     WADR4A2       EHPSM
     C                   MOVEL     EHRG          WEHDKH1
     C                   MOVEL     HEAVD         WEHDKH3
     C                   MOVEL     HEOPD         WEHDKH5
     C                   EVAL      EHDKH=WEHDKH
     C                   MOVEL     WEHDKH        EHDKH
      * Skriv til house
     C                   WRITE     SADMOHFR

     C                   ENDSR
