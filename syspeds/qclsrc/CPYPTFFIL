             PGM
             DCL        VAR(&FRALIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TILLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PTFLIB) TYPE(*CHAR) LEN(10)
             DCLF       FILE(*LIBL/CPYLIBP) RCDFMT(BILDE01)
/*                                */
/* SENDER BESTILLINGBILDET        */
/*                                */
LOOP1:
             SNDRCVF    DEV(*FILE) RCDFMT(*FILE)
/*                                */
/* AVBRYT PROGRAM VED F3          */
/*                                */
             IF         COND(&IN03 = '1') THEN(GOTO CMDLBL(SLUTT))
/*                                */
/* SLÅR AV FEILINDIKATORER        */
/*                                */
             CHGVAR     VAR(&IN30) VALUE('0')
             CHGVAR     VAR(&IN31) VALUE('1')
             CHGVAR     VAR(&IN32) VALUE('0')
/*                                */
/* ENDRER BIBLIOTEKSLISTE         */
/*                                */
             CHGLIBL    LIBL(&PTFLIB QGPL QGDDM) CURLIB(&PTFLIB)
             MONMSG     MSGID(CPF2110) EXEC(CHGVAR +
                          VAR(&IN32) VALUE('1'))
/*                                */
/* TESTER TASTEDE BIBLIOTEK       */
/*                                */

             CHKOBJ     OBJ(QSYS/&FRALIB) OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801 CPF9810) EXEC(CHGVAR +
                          VAR(&IN30) VALUE('1'))
             CHKOBJ     OBJ(QSYS/&TILLIB) OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801 CPF9810) EXEC(CHGVAR +
                          VAR(&IN31) VALUE('0'))
             CHKOBJ     OBJ(QSYS/&PTFLIB) OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801 CPF9810) EXEC(CHGVAR +
                          VAR(&IN31) VALUE('1'))
             IF         COND(&IN30 = '1' *OR &IN31 = '1' *OR &IN32 = +
                          '1') THEN(GOTO CMDLBL(LOOP1))
/*                                */
/* TØMMER FILBESKRIVESESFIL       */
/*                                */
             DLTF       FILE(&PTFLIB/PTFFIL)
             MONMSG     MSGID(CPF0000)
             DSPFD      FILE(&PTFLIB/*ALL) TYPE(*MBR) +
                          OUTPUT(*OUTFILE) FILEATR(*PF *LF) +
                          OUTFILE(&PTFLIB/PTFFIL)
/*                                */
/* KOPIERER FIL TIL INTERN FIL    */
/*                                */
             CLRPFM     FILE(&PTFLIB/PTFFILI)
             CPYF       FROMFILE(&PTFLIB/PTFFIL) +
                          TOFILE(&PTFLIB/PTFFILI) MBROPT(*REPLACE) +
                          FMTOPT(*MAP *DROP)
SLUTT:       ENDPGM
