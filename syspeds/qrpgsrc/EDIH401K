     FEDIRE1K   UF   E           K DISK
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1   1024
     D                                     DIM(1024)                            Input string
     D  ADS                    1   1024
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1   1024
     D                                     DIM(1024)                            Output string
     D  Z_RDATA                1   1024
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
     C     *ENTRY        PLIST
     C                   PARM                    WMBR             10
      *__________________
      * Define Workfields
      *""""""""""""""""""
     C                   Z-ADD     1             BX                4 0          Index for B
     C                   Z-ADD     0             AXV               4 0          Leftindx A
     C                   Z-ADD     0             AXH               4 0          Rightindx A
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRB                                                  SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR

     C     WMBR          SETLL     EDIRE1K
     C     WMBR          READE     EDIRE1K                                51
     C     *IN51         DOWEQ     '0'

     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     RDATA         ADS
     C                   EVAL      AXV=1
     C                   EVAL      AXH=1024
     C                   EXSR      SRÅ

     C     WMBR          READE     EDIRE1K                                51
     C  N51              END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C                   EVAL      BX=1
     C     AXV           DO        AXH           AXV
     C                   MOVE      A(AXV)        WCHAR
      * Replace
     C                   SELECT
     C     WCHAR         WHENEQ    X'06'
     C                   EVAL      WCHAR='Æ'
     C     WCHAR         WHENEQ    X'15'
     C                   EVAL      WCHAR='Å'
     C     WCHAR         WHENEQ    X'29'
     C                   EVAL      WCHAR='E'
     C     WCHAR         WHENEQ    X'38'
     C                   EVAL      WCHAR='Ø'
     C                   ENDSL
      * Move to output string
     C     WCHAR         IFNE      X'66'
     C                   MOVE      WCHAR         B(BX)
     C                   ADD       1             BX
     C                   ENDIF
     C                   ENDDO
      * Update
     C                   EVAL      RDATA=Z_RDATA
     C                   UPDATE    EDIRER
     C                   ENDSR
