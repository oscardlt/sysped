********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 TILLATE A,B,L PÅ AVGIFTSBEREGNINGSMETODER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11016 * 02 YBC PTF11 KODER FOR OMBEREGNING
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE GJYLDIGE KODER            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07-11 13-24             ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 55-59 61-84 88 ***
      ***                    90 95-97                         ***
      ***********************************************************
      *
     FKODTS1    UF A E           K DISK
     FKODTS2    UF A E           K DISK
     FKODTS3    UF A E           K DISK
     FKODTS4    UF A E           K DISK
     FKODTS5    UF A E           K DISK
     FKODTS6    UF A E           K DISK
     FKODTS7    UF A E           K DISK
     FKODTS8    UF A E           K DISK
     FKODTS9    UF A E           K DISK
     FKODTSA    UF A E           K DISK
     FKODTSB    UF A E           K DISK
     FKODTSC    UF A E           K DISK
     FKODTSD    UF A E           K DISK
     FKODTSE    UF A E           K DISK
N02  FKODTSO    UF A E           K DISK
     FSAD002FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     D                 DS
     D  WSUT                   1     74
     D  XUT                   10     13
     D                 DS
     D  XUT1                   1     74
     D  KS1TYP                 2      3  0
     D  KS1FTX                 7     64
     D                 DS
     D  XUT2                   1     74
     D  KS2LK                  2      3
     D  KS2FTX                 7     61
     D  KS2NAS                65     66
     D  KS2MO                 68     68
     D  KS2PRE                70     70
     D                 DS
     D  XUT3                   1     74
     D  KS3TRT                 2      2  0
     D  KS3FTX                 7     64
     D                 DS
     D  XUT4                   1     74
     D  KS4TRM                 2      3  0
     D  KS4FTX                 7     64
     D                 DS
     D  XUT5                   1     74
     D  KS5TLN                 2      2
     D  KS5FTX                 7     64
     D                 DS
     D  XUT6                   1     74
     D  KS6PRE                 2      2
     D  KS6FTX                 7     63
     D                 DS
     D  XUT7                   1     74
     D  KS7VF                  2      2  0
     D  KS7FTX                 7     64
     D                 DS
     D  XUT8                   1     74
     D  KS8AVG                 2      3
     D  KS8SKV                 5      7
     D  KS8FT2                 9     57
     D  KS8MIL2               59     59
     D  KS8STA                61     61
     D  XSAT1                 63     67
     D  XSAT2                 68     68
     D  XSAT3                 69     70
     D  KS8STY                72     72
     D  KS8ØRE2               74     74
     D                 DS
     D  KS8FTX                 1     52
     D  KS8FT                  1     49
     D  KS8MIL                52     52
     D  KS8ØRE                51     51
     D                 DS
     D  XUT9                   1     74
     D  KS9TYP                 2      3  0
     D  KS9FTXA                7     63
     D  KS9FTXB               70     70
     D                 DS
     D  KS9FTX                 1     58
     D  KS9FTX57               1     57
     D  KS9FTX01              58     58
     D                 DS
     D  XUTA                   1     74
     D  KSAKD                  2      3
     D  KSAFT                  7     36
     D                 DS
     D  XUTB                   1     74
     D  KSBKD                  2      4
     D  KSBFT                  7     66
     D                 DS
     D  XUTC                   1     74
     D  KSCKD                  2      4
     D  KSCFT                  7     66
     D                 DS
     D  XUTD                   1     74
     D  KSDLS                  2      3
     D  KSDTXT                 7     22
     D                 DS
     D  XUTE                   1     74
     D  KSEFYL                 2      3
     D  KSETXT                 7     36
N02  D                 DS
N02  D  XUTO                   1     74
N02  D  KSOKD                  2      5
N02  D  KSOFT                  7     66
     C*
     C                   EXSR      INIT
     C*
     C     ST            TAG
     C                   EXFMT     BILDE01
     C                   SETOFF                                       3089
     C   03              GOTO      SLUTT
     C                   EXSR      TEST1
     C   30              GOTO      ST
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   EXSR      MOVBY
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETMIN
     C     START1        TAG
     C                   EXSR      LESFIL
     C   94              MOVE      *BLANKS       WSUT
     C   94              MOVE      *BLANKS       WSNR
     C  N94              EXSR      UPDFIL
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        14
     C                   ADD       1             ZRECNO
     C                   EXSR      MOVSW
     C                   WRITE     SUBFIL
     C                   EXSR      LESFIL
     C  N94              DO
     C                   EXSR      UPDFIL
     C                   EXSR      MOVSY
     C                   END
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     VAREL4
     C                   GOTO      ST41
     C                   ELSE
     C                   WRITE     BUNN
     C                   END
     C                   SETOFF                                       999830
     C                   EXFMT     SUBCTL
     C*
     C*** AVSLUTT
     C     ST41          TAG
     C   03              GOTO      SLUTT
     C*
     C*** FRISK OPP
     C   05              GOTO      START
     C*
     C*** LAGE NY KODE FOR SAD
     C   06              SETOFF                                       86
     C   06              GOTO      START5
     C*** GO TIL VALGBILDE
     C   12              GOTO      ST
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   SETOFF                                       25
     C                   Z-ADD     YRECNO        ZRECNO
     C  N94              EXSR      SETY
     C  N94              EXSR      LESFIL
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENT
     C   30              GOTO      START3
     C                   END
     C*
     C*** SLETT SAMLASTAVGANG
     C                   SETON                                        86
     C     WSNR          IFEQ      '4'
     C                   EXSR      MOVWSS
     C                   EXSR      WRTWS3
     C  N12              DO
     C                   EXSR      DLPOST
     C                   MOVE      *BLANKS       WSUT
     C                   MOVE      '*DLT'        XUT
     C                   END
     C                   UPDATE    SUBFIL
     C                   GOTO      START3
     C                   END
     C*
     C*** LAGE/ENDRE KODE FOR SAD
     C     START5        TAG
     C                   EXSR      WRTWS1
     C                   SETOFF                                       308785
     C   03              GOTO      SLUTT
     C   12              DO
     C                   MOVE      ' '           WSNR
     C   40              UPDATE    SUBFIL
     C                   SETOFF                                       40
     C                   EXSR      MOVB2
     C                   GOTO      START3
     C                   END
     C                   EXSR      TEST2
     C   30              GOTO      START5
     C                   GOTO      START3
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TEST1         BEGSR
     C***********************************************
     C     WVALG         COMP      '1'                                    41
     C     WVALG         COMP      '2'                                    42
     C     WVALG         COMP      '3'                                    43
     C     WVALG         COMP      '4'                                    44
     C     WVALG         COMP      '5'                                    45
     C     WVALG         COMP      '6'                                    46
     C     WVALG         COMP      '7'                                    47
     C     WVALG         COMP      '8'                                    48
     C     WVALG         COMP      '9'                                    49
     C     WVALG         COMP      'A'                                    50
     C     WVALG         COMP      'B'                                    51
     C     WVALG         COMP      'C'                                    52
     C     WVALG         COMP      'D'                                    53
     C     WVALG         COMP      'E'                                    54
N02  C     WVALG         COMP      'O'                                    55
     C  N41
     CANN42
     CANN43
     CANN44
     CANN45
     CANN46
     CANN47
     CANN48
     CANN49
     CANN53
     CANN54
N02  CANN55
     CANN50
     CANN51
     CANN52              SETON                                        89
     C  N89              DO
     C   41              MOVE      'DIV0003'     MSGNRW
     C   42              MOVE      'DIV0004'     MSGNRW
     C   43              MOVE      'DIV0005'     MSGNRW
     C   44              MOVE      'DIV0006'     MSGNRW
     C   45              MOVE      'DIV0007'     MSGNRW
     C   46              MOVE      'DIV0008'     MSGNRW
     C   47              MOVE      'DIV0009'     MSGNRW
     C   48              MOVE      'DIV0010'     MSGNRW
     C   49              MOVE      'DIV0011'     MSGNRW
     C   50              MOVE      'DIV5016'     MSGNRW
     C   51              MOVE      'JOV0037'     MSGNRW
     C   52              MOVE      'JOV0039'     MSGNRW
     C   53              MOVE      'YBC0106'     MSGNRW
     C   54              MOVE      'YBC0119'     MSGNRW
N02  C   55              MOVE      'YBC2008'     MSGNRW
     C                   END
     C   89              SETON                                            30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TEST2         BEGSR
     C***********************************************
     C                   SELECT
     C     *IN41         WHENEQ    '1'
     C     WS1TYP        COMP      0                                      87
     C  N87WS1FTX        COMP      *BLANKS                                30
     C     *IN42         WHENEQ    '1'
     C     WS2LK         COMP      *BLANKS                                87
     C  N87WS2FTX        COMP      *BLANKS                                30
     C     *IN43         WHENEQ    '1'
     C     WS3TRT        COMP      0                                      87
     C  N87WS3FTX        COMP      *BLANKS                                30
     C     *IN44         WHENEQ    '1'
     C     WS4TRM        COMP      0                                      87
     C  N87WS4FTX        COMP      *BLANKS                                30
     C     *IN45         WHENEQ    '1'
     C     WS5TLN        COMP      *BLANKS                                87
     C  N87WS5FTX        COMP      *BLANKS                                30
     C     *IN46         WHENEQ    '1'
     C     WS6PRE        COMP      *BLANKS                                87
     C  N87WS6FTX        COMP      *BLANKS                                30
     C     *IN47         WHENEQ    '1'
     C     WS7VF         COMP      0                                      87
     C  N87WS7FTX        COMP      *BLANKS                                30
     C     *IN48         WHENEQ    '1'
     C     WS8AVG        COMP      *BLANKS                                87
      * MAN MÅ FØRST REGISTRERE EN AVGIFT MED SEKVENS = BLANK
     C     *IN87         IFEQ      '0'
     C     WS8SKV        ANDNE     *BLANKS
     C     KOS8K2        CHAIN(N)  KODTS8                             33
     C   33              MOVE      '1'           *IN87
     C                   MOVE      'YBC0544'     MSGNR
     C                   ELSE
     C                   MOVE      'DIV0013'     MSGNR
     C                   END
     C  N87WS8FT         COMP      *BLANKS                                30
     C  N87
     CANN30              DO
     C     WS8STY        COMP      ' '                                8585
     C   85WS8STY        COMP      '%'                                8585
     C   85WS8STY        COMP      'P'                                8585
     C   85WS8STY        COMP      'H'                                8585
     C   85WS8STY        COMP      'K'                                8585
     C   85WS8STY        COMP      'M'                                8585
     C   85WS8STY        COMP      'G'                                8585
     C   85WS8STY        COMP      'D'                                8585
     C   85WS8STY        COMP      'T'                                8585
N01  C   85WS8STY        COMP      'A'                                8585
N01  C   85WS8STY        COMP      'B'                                8585
N01  C   85WS8STY        COMP      'L'                                8585
     C                   END
     C     *IN49         WHENEQ    '1'
     C     WS9TYP        COMP      0                                      87
     C  N87WS9FTX        COMP      *BLANKS                                30
     C     *IN50         WHENEQ    '1'
     C     WSAKD         COMP      *BLANKS                                87
     C  N87WSAFT         COMP      *BLANKS                                30
     C     *IN51         WHENEQ    '1'
     C     WSBKD         COMP      *BLANKS                                87
     C  N87WSBFT         COMP      *BLANKS                                30
     C     *IN52         WHENEQ    '1'
     C     WSCKD         COMP      *BLANKS                                87
     C  N87WSCFT         COMP      *BLANKS                                30
     C     *IN53         WHENEQ    '1'
     C     WSDLS         COMP      *BLANKS                                87
     C  N87WSDTXT        COMP      *BLANKS                                30
     C     *IN54         WHENEQ    '1'
     C     WSEFYL        COMP      *BLANKS                                87
     C  N87WSETXT        COMP      *BLANKS                                30
N02  C     *IN55         WHENEQ    '1'
N02  C     WSOKD         COMP      *BLANKS                                87
N02  C  N87WSOFT         COMP      *BLANKS                                30
     C                   ENDSL
     C*
     C   30              MOVE      'SPF0001'     MSGNR
     C   30              SETON                                        86
     C   85              MOVE      'DIV0014'     MSGNR
     C   85
     COR 87              SETON                                        30
     C*
     C  N30              DO
     C   41              EXSR      OPD1
     C   42              EXSR      OPD2
     C   43              EXSR      OPD3
     C   44              EXSR      OPD4
     C   45              EXSR      OPD5
     C   46              EXSR      OPD6
     C   47              EXSR      OPD7
     C   48              EXSR      OPD8
     C   49              EXSR      OPD9
     C   50              EXSR      OPDA
     C   51              EXSR      OPDB
     C   52              EXSR      OPDC
     C   53              EXSR      OPDD
     C   54              EXSR      OPDE
N02  C   55              EXSR      OPDO
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLTST2
     C                   EXSR      MOVSW
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C                   SETOFF                                       40
     C                   EXSR      MOVB2
     C                   END
     C*
     C     SLTST2        ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '2'
     C     XUT           COMP      '*DLT'                                 98
     C   98              GOTO      SLHENT
     C                   EXSR      MOVSWS
     C                   MOVE      ' '           WSNR
     C                   SETON                                        40
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '4'
     C     XUT           COMP      '*DLT'                                 98
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                        30
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVSWS        BEGSR
     C***********************************************
     C                   SELECT
     C     *IN41         WHENEQ    '1'
     C                   MOVE      WSUT          XUT1
     C                   MOVE      KS1TYP        WS1TYP
     C                   MOVE      KS1FTX        WS1FTX
     C     *IN42         WHENEQ    '1'
     C                   MOVE      WSUT          XUT2
     C                   MOVE      KS2LK         WS2LK
     C                   MOVE      KS2FTX        WS2FTX
     C                   MOVE      KS2NAS        WS2NAS
     C                   MOVE      KS2PRE        WS2PRE
     C                   MOVE      KS2MO         WS2MO
     C     *IN43         WHENEQ    '1'
     C                   MOVE      WSUT          XUT3
     C                   MOVE      KS3TRT        WS3TRT
     C                   MOVE      KS3FTX        WS3FTX
     C     *IN44         WHENEQ    '1'
     C                   MOVE      WSUT          XUT4
     C                   MOVE      KS4TRM        WS4TRM
     C                   MOVE      KS4FTX        WS4FTX
     C     *IN45         WHENEQ    '1'
     C                   MOVE      WSUT          XUT5
     C                   MOVE      KS5TLN        WS5TLN
     C                   MOVE      KS5FTX        WS5FTX
     C     *IN46         WHENEQ    '1'
     C                   MOVE      WSUT          XUT6
     C                   MOVE      KS6PRE        WS6PRE
     C                   MOVE      KS6FTX        WS6FTX
     C     *IN47         WHENEQ    '1'
     C                   MOVE      WSUT          XUT7
     C                   MOVE      KS7VF         WS7VF
     C                   MOVE      KS7FTX        WS7FTX
     C     *IN48         WHENEQ    '1'
     C                   MOVE      WSUT          XUT8
     C                   MOVE      KS8STA        WS8STA
     C                   MOVE      KS8AVG        WS8AVG
     C                   MOVE      KS8SKV        WS8SKV
     C                   MOVE      KS8FT2        WS8FT
     C                   MOVE      KS8MIL2       WS8MIL
     C                   MOVEL     XSAT1         WS8SAT
     C                   MOVE      XSAT3         WS8SAT
     C                   MOVE      KS8STY        WS8STY
     C                   MOVE      KS8ØRE2       WS8ØRE
     C     *IN49         WHENEQ    '1'
     C                   MOVE      WSUT          XUT9
     C                   MOVE      KS9TYP        WS9TYP
     C                   MOVE      KS9FTXA       WS9FTX
     C                   MOVE      KS9FTXB       WS9JN
     C     *IN50         WHENEQ    '1'
     C                   MOVE      WSUT          XUTA
     C                   MOVE      KSAKD         WSAKD
     C                   MOVE      KSAFT         WSAFT
     C     *IN51         WHENEQ    '1'
     C                   MOVE      WSUT          XUTB
     C                   MOVE      KSBKD         WSBKD
     C                   MOVE      KSBFT         WSBFT
     C     *IN52         WHENEQ    '1'
     C                   MOVE      WSUT          XUTC
     C                   MOVE      KSCKD         WSCKD
     C                   MOVE      KSCFT         WSCFT
     C     *IN53         WHENEQ    '1'
     C                   MOVE      WSUT          XUTD
     C                   MOVE      KSDLS         WSDLS
     C                   MOVE      KSDTXT        WSDTXT
     C     *IN54         WHENEQ    '1'
     C                   MOVE      WSUT          XUTE
     C                   MOVE      KSEFYL        WSEFYL
     C                   MOVE      KSETXT        WSETXT
N02  C     *IN55         WHENEQ    '1'
N02  C                   MOVE      WSUT          XUTO
N02  C                   MOVE      KSOKD         WSOKD
N02  C                   MOVE      KSOFT         WSOFT
     C                   ENDSL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWSS        BEGSR
     C***********************************************
     C   41              MOVE      WSUT          XUT1
     C   42              MOVE      WSUT          XUT2
     C   43              MOVE      WSUT          XUT3
     C   44              MOVE      WSUT          XUT4
     C   45              MOVE      WSUT          XUT5
     C   46              MOVE      WSUT          XUT6
     C   47              MOVE      WSUT          XUT7
     C   48              MOVE      WSUT          XUT8
     C   48              MOVEL     XSAT1         KS8SAT
     C   48              MOVE      XSAT3         KS8SAT
     C   49              MOVE      WSUT          XUT9
     C   50              MOVE      WSUT          XUTA
     C   51              MOVE      WSUT          XUTB
     C   52              MOVE      WSUT          XUTC
     C   53              MOVE      WSUT          XUTD
     C   54              MOVE      WSUT          XUTE
N02  C   55              MOVE      WSUT          XUTO
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SELECT
     C     *IN41         WHENEQ    '1'
     C                   MOVE      *ZEROS        WS1TYP
     C                   MOVE      *BLANKS       WS1FTX
     C     *IN42         WHENEQ    '1'
     C                   MOVE      *BLANKS       WS2LK
     C                   MOVE      *BLANKS       WS2FTX
     C                   MOVE      *BLANKS       WS2NAS
     C                   MOVE      *BLANKS       WS2PRE
     C                   MOVE      *BLANKS       WS2MO
     C     *IN43         WHENEQ    '1'
     C                   MOVE      *ZEROS        WS3TRT
     C                   MOVE      *BLANKS       WS3FTX
     C     *IN44         WHENEQ    '1'
     C                   MOVE      *ZEROS        WS4TRM
     C                   MOVE      *BLANKS       WS4FTX
     C     *IN45         WHENEQ    '1'
     C                   MOVE      *BLANKS       WS5TLN
     C                   MOVE      *BLANKS       WS5FTX
     C     *IN46         WHENEQ    '1'
     C                   MOVE      *BLANKS       WS6PRE
     C                   MOVE      *BLANKS       WS6FTX
     C     *IN47         WHENEQ    '1'
     C                   MOVE      *ZEROS        WS7VF
     C                   MOVE      *BLANKS       WS7FTX
     C     *IN48         WHENEQ    '1'
     C                   MOVE      *BLANKS       WS8STA
     C                   MOVE      *BLANKS       WS8AVG
     C                   MOVE      *BLANKS       WS8SKV
     C                   MOVE      *BLANKS       WS8FT
     C                   MOVE      *BLANKS       WS8MIL
     C                   MOVE      *ZEROS        WS8SAT
     C                   MOVE      *BLANKS       WS8STY
     C                   MOVE      *BLANKS       WS8ØRE
     C     *IN49         WHENEQ    '1'
     C                   MOVE      *ZEROS        WS9TYP
     C                   MOVE      *BLANKS       WS9FTX
     C                   MOVE      *BLANKS       WS9JN
     C     *IN50         WHENEQ    '1'
     C                   MOVE      *BLANKS       WSAKD
     C                   MOVE      *BLANKS       WSAFT
     C     *IN51         WHENEQ    '1'
     C                   MOVE      *BLANKS       WSBKD
     C                   MOVE      *BLANKS       WSBFT
     C     *IN52         WHENEQ    '1'
     C                   MOVE      *BLANKS       WSCKD
     C                   MOVE      *BLANKS       WSCFT
     C     *IN53         WHENEQ    '1'
     C                   MOVE      *BLANKS       WSDLS
     C                   MOVE      *BLANKS       WSDTXT
     C     *IN54         WHENEQ    '1'
     C                   MOVE      *BLANKS       WSEFYL
     C                   MOVE      *BLANKS       WSETXT
N02  C     *IN51         WHENEQ    '1'
N02  C                   MOVE      *BLANKS       WSOKD
N02  C                   MOVE      *BLANKS       WSOFT
     C                   ENDSL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBY         BEGSR
     C***********************************************
     C   41              MOVE      *ZEROS        YS1TYP            2 0
     C   42              MOVE      *BLANKS       YS2LK             2
     C   43              MOVE      *ZEROS        YS3TRT            1 0
     C   44              MOVE      *ZEROS        YS4TRM            2 0
     C   45              MOVE      *BLANKS       YS5TLN            1
     C   46              MOVE      *BLANKS       YS6PRE            1
     C   47              MOVE      *ZEROS        YS7VF             1 0
     C   48              MOVE      *BLANKS       YS8AVG            2
     C   48              MOVE      *BLANKS       YS8SKV            3
     C   49              MOVE      *ZEROS        YS9TYP            2 0
     C   50              MOVE      *BLANKS       YSAKD             2
     C   51              MOVE      *BLANKS       YSBKD             3
     C   52              MOVE      *BLANKS       YSCKD             3
     C   53              MOVE      *BLANKS       YSDLS             2
     C   54              MOVE      *BLANKS       YSEFYL            2
N02  C   55              MOVE      *BLANKS       YSOKD             4
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVSY         BEGSR
     C***********************************************
     C   41              MOVE      KS1TYP        YS1TYP
     C   42              MOVE      KS2LK         YS2LK
     C   43              MOVE      KS3TRT        YS3TRT
     C   44              MOVE      KS4TRM        YS4TRM
     C   45              MOVE      KS5TLN        YS5TLN
     C   46              MOVE      KS6PRE        YS6PRE
     C   47              MOVE      KS7VF         YS7VF
     C   48              MOVE      KS8AVG        YS8AVG
     C   48              MOVE      KS8SKV        YS8SKV
     C   49              MOVE      KS9TYP        YS9TYP
     C   50              MOVE      KSAKD         YSAKD
     C   51              MOVE      KSBKD         YSBKD
     C   52              MOVE      KSCKD         YSCKD
     C   53              MOVE      KSDLS         YSDLS
     C   54              MOVE      KSEFYL        YSEFYL
N02  C   55              MOVE      KSOKD         YSOKD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPD1          BEGSR
     C***********************************************
     C                   MOVE      WS1TYP        KS1TYP
     C     KODS1K        CHAIN     KODTS1                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD1
     C                   MOVE      WS1UNI        KS1UNI
     C                   MOVE      WS1TYP        KS1TYP
     C                   MOVE      WS1FTX        KS1FTX
     C   60              WRITE     KOS1R
     C  N60              UPDATE    KOS1R
     C*
     C     SLOPD1        ENDSR
     C*
     C***********************************************
     C     OPD2          BEGSR
     C***********************************************
     C                   MOVE      WS2LK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD2
     C                   MOVE      WS2UNI        KS2UNI
     C                   MOVE      WS2LK         KS2LK
     C                   MOVE      WS2FTX        KS2FTX
     C                   MOVE      WS2PRE        KS2PRE
     C                   MOVE      WS2NAS        KS2NAS
     C                   MOVE      WS2MO         KS2MO
     C   60              WRITE     KOS2R
     C  N60              UPDATE    KOS2R
     C*
     C     SLOPD2        ENDSR
     C*
     C***********************************************
     C     OPD3          BEGSR
     C***********************************************
     C                   MOVE      WS3TRT        KS3TRT
     C     KODS3K        CHAIN     KODTS3                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD3
     C                   MOVE      WS3UNI        KS3UNI
     C                   MOVE      WS3TRT        KS3TRT
     C                   MOVE      WS3FTX        KS3FTX
     C   60              WRITE     KOS3R
     C  N60              UPDATE    KOS3R
     C*
     C     SLOPD3        ENDSR
     C*
     C***********************************************
     C     OPD4          BEGSR
     C***********************************************
     C                   MOVE      WS4TRM        KS4TRM
     C     KODS4K        CHAIN     KODTS4                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD4
     C                   MOVE      WS4UNI        KS4UNI
     C                   MOVE      WS4TRM        KS4TRM
     C                   MOVE      WS4FTX        KS4FTX
     C   60              WRITE     KOS4R
     C  N60              UPDATE    KOS4R
     C*
     C     SLOPD4        ENDSR
     C*
     C***********************************************
     C     OPD5          BEGSR
     C***********************************************
     C                   MOVE      WS5TLN        KS5TLN
     C     KODS5K        CHAIN     KODTS5                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD5
     C                   MOVE      WS5UNI        KS5UNI
     C                   MOVE      WS5TLN        KS5TLN
     C                   MOVE      WS5FTX        KS5FTX
     C   60              WRITE     KOS5R
     C  N60              UPDATE    KOS5R
     C*
     C     SLOPD5        ENDSR
     C*
     C***********************************************
     C     OPD6          BEGSR
     C***********************************************
     C                   MOVE      WS6PRE        KS6PRE
     C     KODS6K        CHAIN     KODTS6                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD6
     C                   MOVE      WS6UNI        KS6UNI
     C                   MOVE      WS6PRE        KS6PRE
     C                   MOVE      WS6FTX        KS6FTX
     C   60              WRITE     KOS6R
     C  N60              UPDATE    KOS6R
     C*
     C     SLOPD6        ENDSR
     C*
     C***********************************************
     C     OPD7          BEGSR
     C***********************************************
     C                   MOVE      WS7VF         KS7VF
     C     KODS7K        CHAIN     KODTS7                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD7
     C                   MOVE      WS7UNI        KS7UNI
     C                   MOVE      WS7VF         KS7VF
     C                   MOVE      WS7FTX        KS7FTX
     C   60              WRITE     KOS7R
     C  N60              UPDATE    KOS7R
     C*
     C     SLOPD7        ENDSR
     C*
     C***********************************************
     C     OPD8          BEGSR
     C***********************************************
     C                   MOVE      WS8AVG        KS8AVG
     C                   MOVE      WS8SKV        KS8SKV
     C     KODS8K        CHAIN     KODTS8                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD8
     C                   MOVE      WS8STA        KS8STA
     C                   MOVE      WS8AVG        KS8AVG
     C                   MOVE      WS8SKV        KS8SKV
     C                   MOVE      WS8FT         KS8FT
     C                   MOVE      WS8MIL        KS8MIL
     C                   MOVE      WS8SAT        KS8SAT
     C                   MOVE      WS8STY        KS8STY
     C                   MOVE      WS8ØRE        KS8ØRE
     C   60              WRITE     KOS8R
     C  N60              UPDATE    KOS8R
     C*
     C     SLOPD8        ENDSR
     C*
     C***********************************************
     C     OPD9          BEGSR
     C***********************************************
     C                   MOVE      WS9TYP        KS9TYP
     C     KODS9K        CHAIN     KODTS9                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPD9
     C                   MOVE      WS9UNI        KS9UNI
     C                   MOVE      WS9TYP        KS9TYP
     C                   MOVE      WS9FTX        KS9FTX57
     C                   IF        ((WS9JN <> 'N') AND (WS9JN <> 'J'))
     C                   MOVE      'J'           KS9FTX01
     C                   ELSE
     C                   MOVE      WS9JN         KS9FTX01
     C                   END
     C   60              WRITE     KOS9R
     C  N60              UPDATE    KOS9R
     C*
     C     SLOPD9        ENDSR
     C*
     C***********************************************
     C     OPDA          BEGSR
     C***********************************************
     C                   MOVE      WSAKD         KSAKD
     C     KODSAK        CHAIN     KODTSA                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPDA
     C                   MOVE      WSAKD         KSAKD
     C                   MOVE      WSAFT         KSAFT
     C   60              WRITE     KODTSAR
     C  N60              UPDATE    KODTSAR
     C*
     C     SLOPDA        ENDSR
     C*
     C***********************************************
     C     OPDB          BEGSR
     C***********************************************
     C                   MOVE      WSBKD         KSBKD
     C     KODSBK        CHAIN     KODTSB                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPDB
     C                   MOVE      WSBKD         KSBKD
     C                   MOVE      WSBFT         KSBFT
     C   60              WRITE     KODTSBR
     C  N60              UPDATE    KODTSBR
     C*
     C     SLOPDB        ENDSR
     C*
     C***********************************************
     C     OPDC          BEGSR
     C***********************************************
     C                   MOVE      WSCKD         KSCKD
     C     KODSCK        CHAIN     KODTSC                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPDC
     C                   MOVE      WSCKD         KSCKD
     C                   MOVE      WSCFT         KSCFT
     C   60              WRITE     KODTSCR
     C  N60              UPDATE    KODTSCR
     C*
     C     SLOPDC        ENDSR
     C*
     C***********************************************
     C     OPDD          BEGSR
     C***********************************************
     C                   MOVE      WSDLS         KSDLS
     C     KODSDK        CHAIN     KODTSD                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPDD
     C                   MOVE      WSDLS         KSDLS
     C                   MOVE      WSDTXT        KSDTXT
     C   60              WRITE     KOSDR
     C  N60              UPDATE    KOSDR
     C*
     C     SLOPDD        ENDSR
     C*
     C***********************************************
     C     OPDE          BEGSR
     C***********************************************
     C                   MOVE      WSEFYL        KSEFYL
     C     KODSEK        CHAIN     KODTSE                             60
     C   60
     CAN 40
     CORN60
     CANN40              GOTO      SLOPDE
     C                   MOVE      WSEFYL        KSEFYL
     C                   MOVE      WSETXT        KSETXT
     C   60              WRITE     KOSER
     C  N60              UPDATE    KOSER
     C*
     C     SLOPDE        ENDSR
     C*
N02   ***********************************************
N02  C     OPDO          BEGSR
N02   ***********************************************
N02  C                   MOVE      WSOKD         KSOKD
N02  C     KODSOK        CHAIN     KODTSO                             60
N02  C   60
N02  CAN 40
N02  CORN60
N02  CANN40              GOTO      SLOPDO
N02  C                   MOVE      WSOKD         KSOKD
N02  C                   MOVE      WSOFT         KSOFT
N02  C   60              WRITE     KODTSOR
N02  C  N60              UPDATE    KODTSOR
N02   *
N02  C     SLOPDO        ENDSR
N02   *
     C***********************************************
     C     SETMIN        BEGSR
     C***********************************************
     C   41MIN1          SETLL     KODTS1
     C   42MIN2          SETLL     KODTS2
     C   43MIN3          SETLL     KODTS3
     C   44MIN4          SETLL     KODTS4
     C   45MIN5          SETLL     KODTS5
     C   46MIN6          SETLL     KODTS6
     C   47MIN7          SETLL     KODTS7
     C   48MIN8          SETLL     KODTS8
     C   49MIN9          SETLL     KODTS9
     C   50MINA          SETLL     KODTSA
     C   51MINB          SETLL     KODTSB
     C   52MINC          SETLL     KODTSC
     C   53MIND          SETLL     KODTSD
     C   54MINE          SETLL     KODTSE
N02  C   55MINO          SETLL     KODTSO
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETY          BEGSR
     C***********************************************
     C   41KODS13        SETLL     KODTS1
     C   42KODS23        SETLL     KODTS2
     C   43KODS33        SETLL     KODTS3
     C   44KODS43        SETLL     KODTS4
     C   45KODS53        SETLL     KODTS5
     C   46KODS63        SETLL     KODTS6
     C   47KODS73        SETLL     KODTS7
     C   48KODS83        SETLL     KODTS8
     C   49KODS93        SETLL     KODTS9
     C   50KODSA3        SETLL     KODTSA
     C   51KODSB3        SETLL     KODTSB
     C   52KODSC3        SETLL     KODTSC
     C   53KODSD3        SETLL     KODTSD
     C   54KODSE3        SETLL     KODTSE
N02  C   55KODSO3        SETLL     KODTSO
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESFIL        BEGSR
     C***********************************************
     C   41WS1UNI        READE     KODTS1                                 94
     C   42WS2UNI        READE     KODTS2                                 94
     C   43WS3UNI        READE     KODTS3                                 94
     C   44WS4UNI        READE     KODTS4                                 94
     C   45WS5UNI        READE     KODTS5                                 94
     C   46WS6UNI        READE     KODTS6                                 94
     C   47WS7UNI        READE     KODTS7                                 94
     C   48              READ      KODTS8                                 94
     C   48
     CANN94              DO
     C                   MOVE      KS8FT         KS8FT2
     C                   MOVE      KS8MIL        KS8MIL2
     C                   MOVE      KS8ØRE        KS8ØRE2
     C                   END
     C   49WS9UNI        READE     KODTS9                                 94
     C   49
     CANN94              DO
     C                   MOVE      KS9FTX57      KS9FTXA
     C                   MOVE      KS9FTX01      KS9FTXB
     C                   END
     C   50              READ      KODTSA                                 94
     C   51              READ      KODTSB                                 94
     C   52              READ      KODTSC                                 94
     C   53              READ      KODTSD                                 94
     C   54              READ      KODTSE                                 94
N02  C   55              READ      KODTSO                                 94
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     UPDFIL        BEGSR
     C***********************************************
     C   41              UPDATE    KOS1R
     C   42              UPDATE    KOS2R
     C   43              UPDATE    KOS3R
     C   44              UPDATE    KOS4R
     C   45              UPDATE    KOS5R
     C   46              UPDATE    KOS6R
     C   47              UPDATE    KOS7R
     C   48              UPDATE    KOS8R
     C   49              UPDATE    KOS9R
     C   50              UPDATE    KODTSAR
     C   51              UPDATE    KODTSBR
     C   52              UPDATE    KODTSCR
     C   53              UPDATE    KOSDR
     C   54              UPDATE    KOSER
N02  C   55              UPDATE    KODTSOR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVSW         BEGSR
     C***********************************************
     C   41              MOVE      XUT1          WSUT
     C   42              MOVE      XUT2          WSUT
     C   43              MOVE      XUT3          WSUT
     C   44              MOVE      XUT4          WSUT
     C   45              MOVE      XUT5          WSUT
     C   46              MOVE      XUT6          WSUT
     C   47              MOVE      XUT7          WSUT
     C   48              DO
     C                   MOVEL     KS8SAT        XSAT1
     C                   MOVE      KS8SAT        XSAT3
     C                   MOVE      KS8FT         KS8FT2
     C                   MOVE      KS8MIL        KS8MIL2
     C                   MOVE      KS8ØRE        KS8ØRE2
     C                   MOVE      XUT8          WSUT
     C                   END
     C   49              MOVE      KS9FTX57      KS9FTXA
     C   49              MOVE      KS9FTX01      KS9FTXB
     C   49              MOVE      XUT9          WSUT
     C   50              MOVE      XUTA          WSUT
     C   51              MOVE      XUTB          WSUT
     C   52              MOVE      XUTC          WSUT
     C   53              MOVE      XUTD          WSUT
     C   54              MOVE      XUTE          WSUT
N02  C   55              MOVE      XUTO          WSUT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     WRTWS1        BEGSR
     C***********************************************
     C   41              EXFMT     VARL11
     C   42              EXFMT     VARL21
     C   43              EXFMT     VARL31
     C   44              EXFMT     VARL41
     C   45              EXFMT     VARL51
     C   46              EXFMT     VARL61
     C   47              EXFMT     VARL71
     C   48              EXFMT     VARL81
     C   49              EXFMT     VARL91
     C   50              EXFMT     VARLA1
     C   51              EXFMT     VARLB1
     C   52              EXFMT     VARLC1
     C   53              EXFMT     VARLD1
     C   54              EXFMT     VARLE1
N02  C   55              EXFMT     VARLO1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     WRTWS3        BEGSR
     C***********************************************
     C   41              EXFMT     VARL13
     C   42              EXFMT     VARL23
     C   43              EXFMT     VARL33
     C   44              EXFMT     VARL43
     C   45              EXFMT     VARL53
     C   46              EXFMT     VARL63
     C   47              EXFMT     VARL73
     C   48              EXFMT     VARL83
     C   49              EXFMT     VARL93
     C   50              EXFMT     VARLA3
     C   51              EXFMT     VARLB3
     C   52              EXFMT     VARLC3
     C   53              EXFMT     VARLD3
     C   54              EXFMT     VARLE3
N02  C   55              EXFMT     VARLO3
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLPOST        BEGSR
     C***********************************************
     C   41KODS1K        CHAIN     KODTS1                             33
     C   41
     CANN33              DELETE    KOS1R
     C   42KODS2K        CHAIN     KODTS2                             33
     C   42
     CANN33              DELETE    KOS2R
     C   43KODS3K        CHAIN     KODTS3                             33
     C   43
     CANN33              DELETE    KOS3R
     C   44KODS4K        CHAIN     KODTS4                             33
     C   44
     CANN33              DELETE    KOS4R
     C   45KODS5K        CHAIN     KODTS5                             33
     C   45
     CANN33              DELETE    KOS5R
     C   46KODS6K        CHAIN     KODTS6                             33
     C   46
     CANN33              DELETE    KOS6R
     C   47KODS7K        CHAIN     KODTS7                             33
     C   47
     CANN33              DELETE    KOS7R
     C   48KODS8K        CHAIN     KODTS8                             33
     C   48
     CANN33              DELETE    KOS8R
     C   49KODS9K        CHAIN     KODTS9                             33
     C   49
     CANN33              DELETE    KOS9R
     C   50KODSAK        CHAIN     KODTSA                             33
     C   50
     CANN33              DELETE    KODTSAR
     C   51KODSBK        CHAIN     KODTSB                             33
     C   51
     CANN33              DELETE    KODTSBR
     C   52KODSCK        CHAIN     KODTSC                             33
     C   52
     CANN33              DELETE    KODTSCR
     C   53KODSDK        CHAIN     KODTSD                             33
     C   53
     CANN33              DELETE    KOSDR
     C   54KODSEK        CHAIN     KODTSE                             33
     C   54
     CANN33              DELETE    KOSER
N02  C   55KODSOK        CHAIN     KODTSO                             33
N02  C   55
N02  CANN33              DELETE    KODTSOR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODS1K        KLIST
     C                   KFLD                    WS1UNI
     C                   KFLD                    KS1TYP
     C     KODS2K        KLIST
     C                   KFLD                    WS2UNI
     C                   KFLD                    KS2LK
     C     KODS3K        KLIST
     C                   KFLD                    WS3UNI
     C                   KFLD                    KS3TRT
     C     KODS4K        KLIST
     C                   KFLD                    WS4UNI
     C                   KFLD                    KS4TRM
     C     KODS5K        KLIST
     C                   KFLD                    WS5UNI
     C                   KFLD                    KS5TLN
     C     KODS6K        KLIST
     C                   KFLD                    WS6UNI
     C                   KFLD                    KS6PRE
     C     KODS7K        KLIST
     C                   KFLD                    WS7UNI
     C                   KFLD                    KS7VF
     C     KODS8K        KLIST
     C                   KFLD                    KS8AVG
     C                   KFLD                    KS8SKV
     C     KOS8K2        KLIST
     C                   KFLD                    WS8AVG
     C                   KFLD                    YS8SK2            3
     C     KODS9K        KLIST
     C                   KFLD                    WS9UNI
     C                   KFLD                    KS9TYP
     C     KODSAK        KLIST
     C                   KFLD                    KSAKD
     C     KODSBK        KLIST
     C                   KFLD                    KSBKD
     C     KODSCK        KLIST
     C                   KFLD                    KSCKD
     C     KODSDK        KLIST
     C                   KFLD                    KSDLS
     C     KODSEK        KLIST
     C                   KFLD                    KSEFYL
N02  C     KODSOK        KLIST
N02  C                   KFLD                    KSOKD
     C     MIN1          KLIST
     C                   KFLD                    WS1UNI
     C                   KFLD                    MIN11
     C     MIN2          KLIST
     C                   KFLD                    WS2UNI
     C                   KFLD                    MIN21
     C     MIN3          KLIST
     C                   KFLD                    WS3UNI
     C                   KFLD                    MIN31
     C     MIN4          KLIST
     C                   KFLD                    WS4UNI
     C                   KFLD                    MIN41
     C     MIN5          KLIST
     C                   KFLD                    WS5UNI
     C                   KFLD                    MIN51
     C     MIN6          KLIST
     C                   KFLD                    WS6UNI
     C                   KFLD                    MIN61
     C     MIN7          KLIST
     C                   KFLD                    WS7UNI
     C                   KFLD                    MIN71
     C     MIN8          KLIST
     C                   KFLD                    MIN81
     C     MIN9          KLIST
     C                   KFLD                    WS9UNI
     C                   KFLD                    MIN91
     C     MINA          KLIST
     C                   KFLD                    MINA1
     C     MINB          KLIST
     C                   KFLD                    MINB1
     C     MINC          KLIST
     C                   KFLD                    MINC1
     C     MIND          KLIST
     C                   KFLD                    MIND1
     C     MINE          KLIST
     C                   KFLD                    MINE1
N02  C     MINO          KLIST
N02  C                   KFLD                    MINO1
     C     KODS13        KLIST
     C                   KFLD                    WS1UNI
     C                   KFLD                    YS1TYP
     C     KODS23        KLIST
     C                   KFLD                    WS2UNI
     C                   KFLD                    YS2LK
     C     KODS33        KLIST
     C                   KFLD                    WS3UNI
     C                   KFLD                    YS3TRT
     C     KODS43        KLIST
     C                   KFLD                    WS4UNI
     C                   KFLD                    YS4TRM
     C     KODS53        KLIST
     C                   KFLD                    WS5UNI
     C                   KFLD                    YS5TLN
     C     KODS63        KLIST
     C                   KFLD                    WS6UNI
     C                   KFLD                    YS6PRE
     C     KODS73        KLIST
     C                   KFLD                    WS7UNI
     C                   KFLD                    YS7VF
     C     KODS83        KLIST
     C                   KFLD                    YS8AVG
     C                   KFLD                    YS8SKV
     C     KODS93        KLIST
     C                   KFLD                    WS9UNI
     C                   KFLD                    YS9TYP
     C     KODSA3        KLIST
     C                   KFLD                    YSAKD
     C     KODSB3        KLIST
     C                   KFLD                    YSBKD
     C     KODSC3        KLIST
     C                   KFLD                    YSCKD
     C     KODSD3        KLIST
     C                   KFLD                    YSDLS
     C     KODSE3        KLIST
     C                   KFLD                    YSEFYL
N02  C     KODSO3        KLIST
N02  C                   KFLD                    YSOKD
     C*
     C                   MOVE      'S1 '         WS1UNI            3
     C                   MOVE      'S2 '         WS2UNI            3
     C                   MOVE      'S3  '        WS3UNI            4
     C                   MOVE      'S4 '         WS4UNI            3
     C                   MOVE      'S5  '        WS5UNI            4
     C                   MOVE      'S6  '        WS6UNI            4
     C                   MOVE      'S7  '        WS7UNI            4
     C                   MOVE      'S9 '         WS9UNI            3
     C*
     C                   MOVE      *ZEROS        MIN11             2 0
     C                   MOVE      '  '          MIN21             2
     C                   MOVE      *ZEROS        MIN31             1 0
     C                   MOVE      *ZEROS        MIN41             2 0
     C                   MOVE      ' '           MIN51             1
     C                   MOVE      ' '           MIN61             1
     C                   MOVE      *ZEROS        MIN71             1 0
     C                   MOVE      '  '          MIN81             2
     C                   MOVE      *ZEROS        MIN91             2 0
     C                   MOVE      '  '          MINA1             2
     C                   MOVE      '   '         MINB1             3
     C                   MOVE      '   '         MINC1             3
     C                   MOVE      '  '          MIND1             2
     C                   MOVE      '  '          MINE1             2
N02  C                   MOVE      *BLANKS       MINO1             4
     C*
     C                   MOVE      ','           XSAT2             1
     C*
     C                   ENDSR
     C*
