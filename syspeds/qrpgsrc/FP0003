      *
      ***********************************************************
      *** PROGRAM for  forenklet prosedyre skriver samleliste  **
      ***********************************************************
      *
     FSADH      IF   E           K DISK
     FFPXREF1   IF   E           K DISK
     FFP0003P   O    E             PRINTER OFLIND(*IN90)
      *
     D                UDS
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XDDMM                  7     10  0
     D  XUL≈≈                 11     14  0
     D                 DS
     D  UL≈≈                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     C                   EXSR      INIT
     c                   move      'DDP'         frank             3
     c                   EXSR      SUMDET
     c                   move      *zeros        detsum
     c                   move      '***'         frank             3
     c                   EXSR      SUMDET
     c                   write     ptot
     c                   seton                                        lr
     c                   return
     C*
     C***********************************************
     C     sumdet        BEGSR
     C***********************************************
     c     key           chain     fpxref1                            33
     C     KEYSADf       CHAIN     SADH                               34
     c                   z-add     sibel7        tobel7           11 0
     c                   write     phead
      *
     c                   setoff                                       33
     c     key           setll     fpxref1
     c     *in(33)       doweq     '0'
     c     key           READE     fpxref1                                33
     c     *in(33)       IFEQ      '0'
      *
      * hent antall kolli
      *
     C     KEYSAD        CHAIN     SADH                               34
     c     *in90         ifeq      '1'
     c                   write     phead
     c                   move      '0'           *in90
     c                   end
      *
      * start DDP
      *
     c     frank         ifeq      'DDP'
     c     silv2         ifeq      'DDP'
     c     sibel7        sub       sibel6        toll             11 0
     c                   write     PDET
     c     toll          ifne      *zeros
     c                   write     pdett
     c                   end
     c                   add       sibel7        detsum           11 0
     c                   add       sibel7        totsum           11 0
     c                   end
      *
      * start IKKE DDP
      *
     c                   else
     c     silv2         ifne      'DDP'
     c     sibel7        sub       sibel6        toll             11 0
     c                   write     pdet
     c     toll          ifne      *zeros
     c                   write     pdett
     c                   end
     c                   add       sibel7        detsum           11 0
     c                   add       sibel7        totsum           11 0
     c                   end
     c                   end
     c                   end
     c                   end
     c                   write     ptotd
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *entry        plist
     c                   parm                    uavd              4 0
     c                   parm                    uopd              7 0
      *
     c                   move      'O'           sta               1
     c                   move      uavd          avd               4 0
     c                   move      uopd          opd               7 0
      *
      *
     C     key           KLIST
     C                   KFLD                    sta
     C                   KFLD                    avd
     C                   KFLD                    opd
     C*
     C     keysad        KLIST
     C                   KFLD                    FPAVD
     C                   KFLD                    FPOPD
      *
     C     keysadf       KLIST
     C                   KFLD                    FPAVDH
     C                   KFLD                    FPOPDH
      *
      *
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XUL≈≈         UL≈≈
     C                   ENDSR
     C*
     c* sibel5 = Toll
     c* sibel6 = mva
     c* andre avgifter mÂ beregnes
     c* sibel7 = total
