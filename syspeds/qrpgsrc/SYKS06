      *
      ***********************************************************
      *** PROGRAMMET SKRIVER UT ATTESTASJONSBILAG             ***
      ***********************************************************
      *
     FKOSTA     IF   E           K DISK
     FLEVEL01   IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTG2    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FSYKS06P   O    E             PRINTER
     D                 DS
     D  KFMT1                  1     75
     D  STR                    1     75
     D                                     DIM(75)
     D                 DS
     D  WSBAR                  1     22
     D  BAR                    1     22
     D                                     DIM(22)
     D                 DS
     D  KABDT                  1      8  0
     D  KABDTÅ                 1      4  0
     D  KABDTM                 5      6  0
     D  KABDTD                 7      8  0
     D                 DS
     D  XABDT                  1      6  0
     D  XABDTD                 1      2  0
     D  XABDTM                 3      4  0
     D  XABDTÅ                 5      6  0
     D                 DS
     D  KAFDT                  1      8  0
     D  KAFDTÅ                 1      4  0
     D  KAFDTM                 5      6  0
     D  KAFDTD                 7      8  0
     D                 DS
     D  XAFDT                  1      6  0
     D  XAFDTD                 1      2  0
     D  XAFDTM                 3      4  0
     D  XAFDTÅ                 5      6  0
     D                 DS
     D  KAFFDT                 1      8  0
     D  KAFFDÅ                 1      4  0
     D  KAFFDM                 5      6  0
     D  KAFFDD                 7      8  0
     D                 DS
     D  XAFFDT                 1      6  0
     D  XAFFDD                 1      2  0
     D  XAFFDM                 3      4  0
     D  XAFFDÅ                 5      6  0
     D                 DS
     D  KADTR                  1      8  0
     D  KARDTÅ                 1      4  0
     D  KARDTM                 5      6  0
     D  KARDTD                 7      8  0
     D                 DS
     D  XARDT                  1      6  0
     D  XARDTD                 1      2  0
     D  XARDTM                 3      4  0
     D  XARDTÅ                 5      6  0
     C*
     C                   EXSR      INIT
     C*
     C     UBNR          CHAIN     KOSTA                              33
     C*
     C     *IN33         IFNE      *ON
     C                   MOVE      KABDTD        XABDTD
     C                   MOVE      KABDTM        XABDTM
     C                   MOVE      KABDTÅ        XABDTÅ
     C                   MOVE      KAFDTD        XAFDTD
     C                   MOVE      KAFDTM        XAFDTM
     C                   MOVE      KAFDTÅ        XAFDTÅ
     C                   MOVE      KAFFDD        XAFFDD
     C                   MOVE      KAFFDM        XAFFDM
     C                   MOVE      KAFFDÅ        XAFFDÅ
     C                   MOVE      KARDTD        XARDTD
     C                   MOVE      KARDTM        XARDTM
     C                   MOVE      KARDTÅ        XARDTÅ
     C* VIA RESKONTRO
     C     KALNR         IFNE      *ZEROS
     C                   MOVE      '1'           *IN50
     C     LEVKEY        CHAIN     LEVEL01                            33
     C                   ELSE
     C* DIREKTE HOVEDBOK
     C                   MOVE      '0'           *IN50
     C     GEBKEY        CHAIN     KODTGE                             33
     C     GEBKE2        CHAIN     KODTG2                             33
     C                   END
     C* SETT DIV. INDIKATORE FOR PRINTERFILA
     C     KAMVA         COMP      'F'                                    51
     C     KAMVA         COMP      'P'                                    52
     C     KATAVD        COMP      *ZEROS                             5353
     C                   WRITE     LHEAD
     C                   WRITE     LHEAD2
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UBNRA             7
     C                   PARM                    UARKTY            2
     C                   movel     UBNRA         UBNR              7 0
     c     UARKTY        ifne      *blanks
     c                   movel     UARKTY        Barcode           9
     c                   move      UBNR          Barcode
     c                   move      *on           *in54
     c                   end
     C     LEVKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KALNR
     C     GEBKEY        KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    KAVK
     C                   MOVE      'GE'          KGEUNI
     C     GEBKE2        KLIST
     C                   KFLD                    KG2UNI
     C                   KFLD                    KAVK
     C                   MOVE      'G2'          KG2UNI
     C                   READ      FIRM                                   33
      *
      * foreløpig hardkodet (det mangler printerstyring...)
     C                   move      'SKANS'       KFMKD
     C     KFMKD         CHAIN     KODTFM                             33
     c     *in33         Ifeq      '0'
     c     KFMpos        andne     *zeros
     c                   Move      'ZK'          Type              2
     c                   Move      UBNR          UBNRA             7
     c                   eval      WSBAR = type+%trim(UBNRA)
      * Hvis tegn forran strekkode er * så skal  * også bak....
     c                   move      ' '           Etter
     c     kfmpos        sub       1             N2
     c     N2            ifge      1
     c     str(N2)       andeq     '*'
     c                   move      '*'           Etter             1
     c                   end
      *
     c                   z-add     1             NR                2 0
     c                   z-add     kfmpos        N2                2 0
     c     BAR(NR)       Downe     ' '
     c                   move      BAR(NR)       str(N2)
     c                   add       1             NR
     c                   add       1             N2
     c                   enddo
     c     Etter         ifne      ' '
     c                   move      Etter         str(N2)
     c                   end
     c                   end
     C                   MOVE      *ZEROS        KABDT
     C                   MOVE      *ZEROS        XABDT
     C                   MOVE      *ZEROS        KAFDT
     C                   MOVE      *ZEROS        XAFDT
     C                   MOVE      *ZEROS        KAFFDT
     C                   MOVE      *ZEROS        XAFFDT
     C                   MOVE      *ZEROS        KADTR
     C                   MOVE      *ZEROS        XARDT
     C*
     C                   ENDSR
     C*
