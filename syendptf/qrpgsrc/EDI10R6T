     H Option( *SrcStmt ) DftActGrp( *No ) BndDir( 'QC2LE' ) debug(*yes)
      *__________
      * Variabler
      *""""""""""
     D FILE_i          s               *
     D ErrTxt          s            128a
     D String          s           1000a
     D rc              s             10i 0
     D CmdLine         S            512
     D CmdLen          S             15  5
      *___________
      * Konstanter
      *"""""""""""
     D XML_SE1         c                   '<?xml '
     D XML_SE2         c                   'Envelope'
     D XML_SE3         c                   'tullverket.se/ei/addressing-1'
     D XML_SE4         c                   'icd:0007:2021000969'
     D*XML_SE2         c                   '<S:Envelope'
     D*XML_SE3         c                   'xmlns:ela="http://tullverket.se'
     D*XML_SE2         c                   '<ns0:Transport'
     D*XML_SE3         c                   'domain="Transport'
      *_________________
      * Feildefinisjoner
      *"""""""""""""""""
     D errno           Pr            10i 0

     D strerror        Pr           128a   Varying
      *___________________________
      * IFS Stream file funksjoner
      *"""""""""""""""""""""""""""
     Dopen             Pr              *   ExtProc( '_C_IFS_fopen' )
     D                                 *   Value Options( *String )
     D                                 *   Value Options( *String )

     Dfgets            Pr              *   ExtProc( '_C_IFS_fgets' )
     D                                 *   Value
     D                               10i 0 Value
     D                                 *   Value

     Dfputs            Pr            10i 0 ExtProc( '_C_IFS_fputs' )
     D                                 *   Value Options( *String )
     D                                 *   Value

     Dclose            Pr            10i 0 ExtProc( '_C_IFS_fclose' )
     D                                 *   Value
      *______
      * Input
      *""""""
     C     *ENTRY        PLIST
     C                   parm                    FilNam          256
     C                   parm                    flytt             1
     C                   EVAL      FLYTT = 'N'
      *________________________________________
      * Åpne fil, med tegnkonvertering for jobb
      *""""""""""""""""""""""""""""""""""""""""
     C                   EVAL      FILE_i = open( %TrimR( FilNam ) : 'r' )

     C                   IF        FILE_i = *Null
     C                   ELSE

     C                   IF        fgets( %Addr( String ) : %Size( String )
     C                             : FILE_i ) <> *Null
     C     XML_SE1       SCAN      STRING                                 33
     C                   IF        *IN33
      * Ok, XML-fil
     C     XML_SE2       SCAN      STRING                                 33
     C   33XML_SE3       SCAN      STRING                                 33
     C   33XML_SE4       SCAN      STRING                                 33
     C                   IF        *IN33
     C                   EVAL      FLYTT = 'J'
     C                   ELSE
     C                   DOW       fgets( %Addr( String ) : %Size( String )
     C                             : FILE_i ) <> *Null
     C     XML_SE1       SCAN      STRING                                 33
     C   33XML_SE2       SCAN      STRING                                 33
     C   33XML_SE3       SCAN      STRING                                 33
     C   33XML_SE4       SCAN      STRING                                 33
     C                   IF        *IN33
     C                   EVAL      FLYTT = 'J'
     C                   LEAVE
     C                   ENDIF
     C                   ENDDO

     C                   ENDIF
     C                   ENDIF
     C                   ENDIF

     C                   EVAL      rc = close( FILE_i )
     C                   ENDIF

     C                   EVAL      *INLR = *On
     C                   RETURN

      *_________________
      * Hente feilnummer
      *"""""""""""""""""
     P Errno           B
     D                 PI            10i 0
     D sys_errno       PR              *    ExtProc( '__errno' )

     D Error           S             10i 0  Based( pError ) NoOpt

     C                   EVAL      pError = sys_errno
     C                   RETURN    Error

     P Errno           E
      *________________
      * Hente feiltekst
      *""""""""""""""""
     P Strerror        B
     D                 PI           128a   Varying
     D sys_strerror    PR              *   ExtProc( 'strerror' )
     D                               10i 0 Value

     C                   RETURN    %Str( sys_strerror( Errno ))

     P Strerror        E
