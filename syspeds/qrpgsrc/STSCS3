      *********************************************************************
      *  After compiling this RPG MODULE,
      *  create the related program with the following command:
      *
CRTPG+*  CRTPGM SYSPED/STSCS3 MODULE(*LIBL/STSCS3)
CRTPGM*         ACTGRP(*NEW) AUT(*USE)
      *
      *
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *--------------------------------------------------------------------
      * Data base files
      *--------------------------------------------------------------------
     FBRIDF     IF   E           K DISK    usropn
     FWRKCGI    UF A E           K DISK    usropn
      *--------------------------------------------------------------------
      * Prototype defintions and standard system API error structure
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      *--------------------------------------------------------------------
      * Variables common to CGI programs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,variables3
      *--------------------------------------------------------------------
      * Variables received from the input string
     D WSUSER          s             10
      * andre variabler
     D Fn              s             10
     D Lib             s             10
     D Mbr             s             10
     D Spaces          s             12a   inz('&nbsp;&nbsp;')
      *
     D                 DS
     D  WKey2                  1     30
     D  WDsUser                1     10
     D  WDsCLID               11     30
      *--------------------------------------------------------------------
      * Prolog common to CGI programs
      * -Receive input from the remote browser
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prolog3
      *=====================================================================******
      * MAIN PROCESS LINE
      *=====================================================================******
      * Parse input string
     C                   eval      WSUSER   = zhbgetvar('user')
      *
      * også wrkcgi ligger i sycgi - trenger ikke libl
     C                   open      BRIDF
     C                   open      WRKCGI
      * TØM  wrkcgi for aktuell user
      * winteg alltid 0 / wkey2 = Userid+kolliID
     C     KEY           KLIST
     C                   KFLD                    WINTEG
     C                   KFLD                    WKEY2
     C                   eval      Wkey2 = WSUSER
      *
     C     KEY           SETLL     WRKCGI
     C                   READ      WRKCGI                                 50
     C     *in50         doweq     '0'
     C     WDsUser       CABNE     WSUSER        Utdel
     C                   DELETE    WRKCGIR
     C                   READ      WRKCGI                                 50
     C  N50              ENDDO
     C     UtDel         tag
      *
      * Set html output skeleton member
     C                   eval      Lib = '*LIBL'
     C                   eval      Fn  = 'HTMLSRC'
     c     WSuser        ifeq      'NN'
     C                   eval      Mbr = 'STS01B'
     c                   else
     C                   eval      Mbr = 'STS02'
     c                   end
     C                   callp     gethtml(fn:lib:mbr:'/CGITAG/')
BODY C                   callp     updhtmlvar('BODYCLASS':'class='+BIFARG)
     C                   callp     updhtmlvar('user':WSUSER)
     c     WSuser        ifeq      'NN'
     C                   callp     updhtmlvar('user':spaces)
     c                   end
     C                   callp     updHTMLvar('besk':BIBESK)
     C                   callp     updHTMLvar('kunr':
     C                             %trim(%editc(BIKUNR:'Z')))
     C                   callp     updHTMLvar('sdato':
     C                             %trim(%editw(BIDTV:'    .  .  ')))
     C                   callp     updHTMLvar('stid':
     C                             %trim(%editw(BITIDV:'  .  .  ')))
     C                   callp     updHTMLvar('FEILTXT':spaces)
      *
     C                   callp     wrtsection('all')
     C                   callp     wrtsection('*fini')
      *
     C                   close     BRIDF
     C                   close     WRKCGI
     C                   eval      *inlr = *on
     C                   RETURN
