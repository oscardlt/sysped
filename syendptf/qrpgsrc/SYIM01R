********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 Sendes som epost ikke merket alt
10XXX * 02 SH  PTF10 P/S
10XXX * 03 SH  PTF12 totelendring
10XXX * 04 SH  PTF12 NORMALT DATOFORMAT
10XXX * 05 SH  PTF12 tatt bort dato fra til  nå xls
10XXX * 06 SH  PTF12 rettelse til outq test
********************************************************************
      *
N01  FSYIM01F   UF A E           K DISK
     FSYIM01D   CF   E             WORKSTN
n01   * Finner username
n01   *"""""""""""""""""""""""""""
n01  D                SDS
n01  D  ZUSER                254    263
     D                 DS
s05  D* ZDT                    1      6  0
s05  D* ZDTM                   3      4  0
S04  D* ZDTD                   5      6  0
s05  D* ZDTD                   1      2  0
s05  D*                DS
s05  D* dsdt                   1      8  0
s05  D* DSAAR                  1      4  0
s05  D* dsmnd                  5      6  0
s05  D* dsDAG                  5      6  0
N04  D                 DS
N04  D  DATO                   1      6  0
N04  D  DAG                    1      2  0
N04  D  MND                    3      4  0
N04  D  AAR                    5      6  0
     D                 DS
     D  ZST1                   1      5
     D  ZST01                  1      1
     D  ZST02                  2      2
     D  ZST03                  3      3
     D  ZST04                  4      4
     D  ZST05                  5      5
     D                 DS
     D  ZOT01                  1      2
     D  ZOT02                  3      4
     D  ZOT03                  5      6
     D  ZOT04                  7      8
     D  ZOT05                  9     10
     D  ZOT06                 11     12
     D  ZOT07                 13     14
     D  ZOT08                 15     16
     D  ZOT09                 17     18
     D  ZOT10                 19     20
     D  DSOT                   1     20
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     c                   move      dsot          zot
     C     *in03         ifne      '1'
     C   44              WRITE     SYIM01FR
     C  N44              UPDATE    SYIM01FR
     c                   end
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    *IN03         WIN03
     C     *LIKE         DEFINE    *IN12         WIN12
     C     *LIKE         DEFINE    *IN30         WIN30
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM      ZAVDF         ZAVDF
     C                   PARM      ZAVDT         ZAVDT
     C                   PARM      ZGNF          ZGNF
     C                   PARM      ZGNT          ZGNT
s05  C*                  PARM      ZDTF          ZDTF                           DDMMAA
s05  C*                  PARM      ZDTT          ZDTT                           DDMMAA
     C                   PARM      ZOT           ZOT
     C                   PARM      ZST1          ZST2              5
     C                   PARM      ZUNG          ZUNG
     C                   PARM      ZDEV          ZDEV
     C                   PARM      ZA4           ZA4
     C                   PARM      *IN03         WIN03
     C                   PARM      ZBRUDD        ZBRUDD
     C                   PARM      ZLNRF         ZLNRF
     C                   PARM      ZLNRT         ZLNRT
N01  C                   PARM      EPOST         EPOST
N02  C                   PARM      ZPS           ZPS
      *__________________
      * Output parametrer
      *""""""""""""""""""
S04  C*    PLISTA        PLIST
S04  C*                  PARM      ZDEV          ZDEV
     C*    *IN30         PARM                    WIN30
     C*                  PARM      ZOBJTY        ZOBJTY
     C*                  MOVEL     '*OUTQ'       ZOBJTY           10
      *_____________
      * Init av felt
      *"""""""""""""
N01  C     ZUSER         CHAIN     SYIM01F                            44
     c  N44              move      zot           dsot
     C   44              Z-ADD     0             ZAVDF
     C   44              Z-ADD     9999          ZAVDT
     C                   MOVE      '      '      ZGNF
     C                   MOVE      '      '      ZGNT
s05  C*                  CALL      'SYGE15C'
s05  C*                  PARM                    WDT               8
s05  C*                  PARM                    WTM               6
s05  C*                  MOVE      WDT           DSDT
s05  C*                  MOVE      DSMND         MND
s05  C*                  MOVE      DSAAR         AAR
s05  C*                  MOVE      DSDAG         DAG
s05  C*  44              Z-ADD     010101        ZDTF
s05  C*  44              Z-ADD     311299        ZDTT
S04  C*  44              Z-ADD     010101        ZDTF
S04  C*  44              Z-ADD     051231        ZDTT
S04  C*  44              MOVEL     UYEAR         ZDTF
S04  C*  44              MOVEL     UYEAR         ZDTT
     C   44              MOVE      'N'           ZUNG
     C   44              MOVE      'J'           ZA4
S04  C*  44              MOVEL     '*JOB'        ZDEV
n04  C   44              eval      ZDEV='*JOB'
     C   44              MOVE      'N'           ZBRUDD
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *___________
      * Startbilde
      *"""""""""""
     C     SRB1          TAG
     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     SYIM01DØ
     C                   EXFMT     SYIM01DA
     C                   MOVEA     '00000000'    *IN(30)
     C                   MOVEA     '0000'        *IN(38)
     C     *IN12         IFEQ      '1'
     C                   SETON                                        03
     C                   END
     C     *IN03         CABEQ     '1'           SRB9
      * Avdeling til må vare større en til.
     C     ZAVDF         IFGT      ZAVDT
     C                   MOVE      'SPA0003'     ZMSGNO
     C                   MOVEA     '111'         *IN(30)
     C                   GOTO      SRB1
     C                   END
      * Godsnummer til må vare større en til.
     C     ZGNF          IFGT      ZGNT
     C                   MOVE      'SPG0000'     ZMSGNO
     C                   MOVEA     '10011'       *IN(30)
     C                   GOTO      SRB1
     C                   END
      * Teste dato fra:
s05  C*                  Z-ADD     ZDTF          ZDT
s05  C*    ZDTM          COMP      1                                    30
s05  C* N30ZDTM          COMP      12                                 30
s05  C* N30ZDTD          COMP      1                                    30
s05  C* N30ZDTD          COMP      31                                 30
s05  C*  30              MOVE      'SPD0001'     ZMSGNO
s05  C*  30              MOVE      '1'           *IN35
s05  C*  30              GOTO      SRB1
s05  C* Teste dato TIL:
s05  C*                  Z-ADD     ZDTT          ZDT
s05  C*    ZDTM          COMP      1                                    30
s05  C* N30ZDTM          COMP      12                                 30
s05  C* N30ZDTD          COMP      1                                    30
s05  C* N30ZDTD          COMP      31                                 30
s05  C*  30              MOVE      'SPD0001'     ZMSGNO
s05  C*  30              MOVE      '1'           *IN40
s05  C*  30              GOTO      SRB1
      * Uten nytt godsnummer J/N
     C     ZUNG          IFNE      'J'
     C     ZUNG          IFNE      'N'
     C                   MOVE      'SPG0005'     ZMSGNO
     C                   MOVEA     '10000001'    *IN(30)
     C                   GOTO      SRB1
     C                   END
     C                   END
      * Valid skriverenhet ?
     C     ZDEV          IFNE      '*JOB'
N06  C                   MOVEL     '*OUTQ'       ZOBJTY           10
S04  C*                  CALL      'EDI33C'      PLISTA
n04  C                   EVAL      ZDEVT=ZDEV
N04  C                   CALL      'EDI33C'
n04  C                   PARM                    zdevT            10
N04  C     *IN30         PARM                    WIN30
N04  C                   PARM      ZOBJTY        ZOBJTY
N04  C                   MOVEL     '*OUTQ'       ZOBJTY           10
     C     *IN30         IFEQ      '1'
     C                   MOVE      'SPS0018'     ZMSGNO
     C                   MOVE      '1'           *IN38
     C                   GOTO      SRB1
     C                   END
     C                   END
      * Stående A4
     C     ZA4           IFNE      'J'
     C     ZA4           IFNE      'N'
     C                   MOVE      'DIV1448'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN39
     C                   GOTO      SRB1
     C                   END
     C                   END
      * ZPS
     C     EPOST         IFNE      *BLANKS
     C     ZPS           IFNE      'P'
s05  C*    ZPS           ANDNE     'S'
n05  C     ZPS           ANDNE     'X'
     C                   MOVE      'SHU1430'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN41
     C                   GOTO      SRB1
     C                   END
     C                   END
     C     EPOST         IFEQ      *BLANKS
     C     ZPS           IFNE      ' '
     C                   MOVE      'SHU1431'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN41
     C                   GOTO      SRB1
     C                   END
     C                   END
      * LØPENR FRA-TIL , HVIS BARE FRA ER OPPGITT
     C     ZLNRF         IFNE      ' '
     C     ZLNRT         ANDEQ     ' '
     C                   MOVE      ZLNRF         ZLNRT
     C                   END
      *
     C     SRB9          ENDSR
