             PGM        PARM(&PARM &CVP1 &CVP2 &PRT29 &PT29 &EPOSTJ +
                          &EPOST &FTXT)
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(256)
             DCL        VAR(&PARM2) TYPE(*CHAR) LEN(577)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(160)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(160)
             DCL        VAR(&PRT29) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PT29) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FTXT) TYPE(*CHAR) LEN(900)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAXSYS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&JOBK) TYPE(*CHAR) LEN(1)
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&ATTN) TYPE(*CHAR) LEN(40)
             DCL        VAR(&FYLL) TYPE(*CHAR) LEN(1) VALUE('.') /* +
                          Sette '.' for å få riktig coverpage pga. +
                          faximile */
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&PARM3) TYPE(*CHAR) LEN(687)
             DCLF       FILE(FAXSEN)
/*                      */
/*  E-MAIL              */
/*                      */
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             CHGVAR     VAR(&PARM3) VALUE(&PARM *CAT &CVP1 *CAT +
                          &CVP2 *CAT &ATTN *CAT &EPOST *CAT &FYLL)
             SBMJOB     CMD(CALL PGM(SYSJ69CAJE) PARM(&PARM3)) +
                          JOB(SNDFAXFAKT) JOBD(*USRPRF) +
                          JOBQ(SYJOBQNMAX)
             GOTO       CMDLBL(SLUTT)
             ENDDO
             RCVF       RCDFMT(*FILE)
    /* */
             CHGVAR     VAR(&FAX) VALUE(%SST(&PARM 12 1))
             CHGVAR     VAR(&NAVN) VALUE(%SST(&CVP1 41 30))
             IF         COND(&FAXSYS = 'F') THEN(CHGVAR VAR(&ATTN) +
                          VALUE(%SST(&CVP1 81 40)))
             ELSE       CMD(CHGVAR VAR(&ATTN) VALUE(%SST(&CVP2 41 40)))
             IF         COND(&FAX *EQ 'J') THEN(DO)
             CHGVAR     VAR(&PARM2) VALUE(&PARM *CAT &CVP1 *CAT +
                          &CVP2 *CAT &FYLL)
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*                         */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ69CAJF) PARM(&PARM2 &ATTN)) +
                          JOB(BOOK.BEK) JOBD(*USRPRF) +
                          JOBQ(QFAX/QFAXJOBQ)
             GOTO       CMDLBL(SLUTT)
             ENDDO
    /* SENDER VIA FAX400 */
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ69CAJN) PARM(&PARM2 &FTXT +
                          &ATTN)) JOB(BOOK.BEK) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT) /* N01 */
             GOTO       CMDLBL(SLUTT)
             ENDDO
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ69CAJB) PARM(&PARM2 &ATTN)) +
                          JOB(BOOK.BEK) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             GOTO       CMDLBL(SLUTT)
             ENDDO
             ENDDO
    /* */
             CHGVAR     VAR(&JOBK) VALUE(%SST(&PARM 11 1))
             IF         COND(&JOBK = 'J') THEN(SBMJOB CMD(CALL +
                          PGM(SYSJ69CAJ) PARM(&PARM &PRT29 &PT29 +
                          &NAVN &ATTN)) JOB(BOOK.BEK) JOBD(*USRPRF) +
                          JOBQ(SYJOBQAV))
             ELSE       CMD(CALL PGM(SYSJ69CAJ) PARM(&PARM &PRT29 +
                          &PT29 &NAVN &ATTN))
    /* */
SLUTT:       ENDPGM
