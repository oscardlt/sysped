********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 OPPDRAGSNR I UDS
10XXX * 02 sh  PTF10 arkivering
      * 03 Jov PTF10 skriv barkode for arkiv?? foreløpig hardkodet type ZO
      * 04 JOV Ved bestilling på ETT oppd/EN tur les HEADF/HEAD14 (ikke HEAD2) uavh av sign/dato
      * 05 JOV HEAD14(TUR/AGENT/POS) byttet med HEAD11 (Tur/Pos)
      * 06 sh  ptf arkiv
      * 07 sh  hele avsenderadresse er med i print
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT KJØREKVITTERING              ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-24                            ***
      *** LEDIGE INDIKATORER    31 36-45 51-76 78-87 92-97    ***
      *** IND. 99 SKAL ALLTID VÆRE AV (BETYR ORIGINAL)        ***
      ***********************************************************
      *
n02  FFIRM      IF   E           K DISK
n02  FARKTXT    IF   E           K DISK
n02  FFIRMARC   IF   E           K DISK
n02  FARKIVP    O  A E             DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FKODFRI    IF   E           K DISK
     FHEADF     UF   E           K DISK
     FHEAD2     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD2R)
N04  FHEAD11    IF   E           K DISK
N04  F                                     RENAME(HEADFR:HEAD11R)
     FFREETXT2  IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FHODE      IF   E           K DISK
     FKODTH     IF   E           K DISK
     FFAK2      IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FBILLOF    IF   E           K DISK
     FBLV1LF    IF   E           K DISK
     FBLV2LF    IF   E           K DISK
     FTURER14   IF   E           K DISK
     FSYFK40PF  O    E             PRINTER OFLIND(*IN26)
     FSYFK40P2  O    E             PRINTER OFLIND(*IN25)
     D MN1             S             17    DIM(200)
     D MN2             S             51    DIM(200)
     D                 DS
     D  FS                     1     42
     D                                     DIM(2)
     D  FS1                    1     21
     D  FS2                   22     42
N02  D                SDS
N02  D  ZUSER                254    263
     D                 DS
     D  DFS                    1     10
     D                                     DIM(10)
     D  FSDOKK                 1     10
NRFA D                 DS
NRFA D  HERFA                  1     35
NRFA D  HERFA15                1     15
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
     D  HEFT1C                 1     30
     D                 DS
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  XEDTD                  1      2  0
     D  XEDTM                  3      4  0
     D  XEDTÅ                  5      6  0
     D  XEDTOP                 1      6  0
n02  D                 DS
n02  D  XULTID                 1     14  0
n02  D  XULTM                  1      6  0
n02  D  XULDD                  7      8  0
n02  D  XULMM                  9     10  0
n02  D  XULÅÅ                 11     14  0
n02  D                 DS
n02  D  ULÅÅ                   1      4  0
n02  D  ULMM                   5      6  0
n02  D  ULDD                   7      8  0
n02  D  ULDT                   1      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UDT1                  30     35  0
     D  UPRO                  22     29  0
     D  UHOD                  47     47
     D  UBBS                  48     48
     D  UHOD2                 49     49
     D  UDT2                  64     69  0
N01  D  UOPD                  82     88  0
     D  UGN                  981    995
     C*
     C                   EXSR      INIT
     C*
     C* Via TURnr - rett på uavhengig av SIGN
      *
     C                   SETOFF                                       32
N04  c                   select
N04  c     UOPD          whenne    *zeros
N04  c                   move      UAVD          HEAVD
N04  c                   move      UOPD          HEOPD
N04  c     UPRO          whenne    *zeros
N04  C     UPRO          SETLL     HEAD11
N04  c                   other
     C     HEAD2K        SETLL     HEAD2
N04  c                   endsl
     C     START         TAG
N04  c                   select
N04  c     UOPD          whenne    *zeros
N04  C     HEADFK        CHAIN(N)  HEADF                              32
N04  c     UPRO          whenne    *zeros
N04  C     UPRO          READE     HEAD11                                 32
N04  c                   other
     C     UAVD          READE     HEAD2                                  32
     C  N32USG           IFNE      *BLANKS
     C     USG           COMP      HESG                               3232
     C                   END
N04  c                   endsl
      *
     C   32              GOTO      SLUTT
      *
      * vellykket lest - tillegsfilter ??
     C     HEPK3         IFNE      'J'
N04  c     UOPD          cabne     *zeros        Slutt                          ETT oppdrag
     C                   GOTO      START
     C                   END
     C*
S04  C* Dekket/testet  på annet vis..
S04  C*    UPRO          IFNE      0
S04  C*    UPRO          ANDNE     HEPRO
S04  C*                  GOTO      START
S04  C*                  END
S04  C*    UOPD          IFNE      0
S04  C*    UOPD          ANDNE     HEOPD
S04  C*                  GOTO      START
S04  C*                  END
     C*
     C     UGN           IFNE      *BLANKS
     C     UGN           IFNE      HEGN
     C                   GOTO      START
     C                   END
      * data-sjekk (ikke ved ETT oppdrag /EN tur)
     C     UDT2          IFNE      0
     C     UDT82         ANDGT     HEDTR
N04  C     Uopd          andeq     *zeros
N04  C     Upro          andeq     *zeros
     C                   GOTO      START
     C                   END
     C                   END
     C*
N03   * skriv barkode for arkiv?? foreløpig hardkodet type
N03  c                   movel     HEAVD         AVDOPD           11
N03  c                   move      HEOPD         AVDOPD
N03  c                   movel     'ZP'          SKANBAR
N03  c                   move      AVDOPD        SKANBAR
N03  c     KOPLAS        COMP      'F'                                    55
N03  c  N55KOPLAS        COMP      'P'                                    55
     C*
     C     HEVS2         COMP      *BLANKS                            2727
     C  N27HEGM2         COMP      *BLANKS                            2727
     C*
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C     KOPFM         SETLL     KODTFM
     C     KOPFM         READE     KODTFM                                 98
     C*
     C     START2        TAG
     C                   SETOFF                                       35
     C     HEADFK        CHAIN(N)  HEADF                              3235
     C   32              GOTO      SLUTT
     C   35              DO
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      START2
     C                   END
     C*
     C     HEKNK         COMP      0                                      77
     C  N77KUND1K        CHAIN     CUNDL01                            77
     C  N77DKUND         COMP      'D'                                    77
     C*
     C                   EXSR      KDTFMT
     C     BILLK         CHAIN     BILLOF                             33
      * fra web-oversjø KAN det bli skapt ufullstendige BL-s
     C  N33BLKNR         COMP      *zeros                                 33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *ON           *IN29
     C                   EXSR      SEA
     C                   ELSE
     C                   MOVE      *OFF          *IN29
     C                   EXSR      NOSEA
     C                   END
     C*
     C  N98KOPFM         READE     KODTFM                                 98
     C  N98              GOTO      START2
     C                   ADD       1             XPRANT
N04  c     UOPD          cabne     *zeros        Slutt                          ETT oppdrag
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   MOVE      XPRANT        UPRANT
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     SEA           BEGSR
     C******************************************
     C                   EXSR      BÅTLIN
     C                   MOVE      '0'           *IN25
     C                   MOVE      *ZEROS        XSIDE
     C                   EXSR      UTHDS
     C                   EXSR      BLTXT
     C     HEADFK        CHAIN     HEADF                              32
     C                   MOVE      'P'           HEPK3
     C                   UPDATE    HEADFR
     C                   SETOFF                                       5034
     C                   MOVE      *ZEROS        XSUM             11 2
     C     FAK2K         SETLL     FAK2
     C     STSEA         TAG
     C     FAK2K         READE     FAK2                                   34
     C  N34KODGEK        CHAIN     KODTGE                             34
     C  N34KGEKK         IFEQ      'J'
     C     FAKDA         ANDNE     'K'
     C                   ADD       FABELN        XSUM
     C                   END
     C  N34              GOTO      STSEA
     C                   WRITE     SKJØPB
n06  c     kfmsd         iflt      2
n02  c                   exsr      arkivsr
n06  c                   end
     C*
     C                   ENDSR
     C*
     C******************************************
     C     UTHDS         BEGSR
     C******************************************
     C     *IN25         IFEQ      '1'
     C                   WRITE     SKJØPNYS
     C                   ADD       1             XSIDE
     C                   MOVE      '0'           *IN25
     C                   END
     C     KFMT1         IFNE      *BLANKS
     C                   WRITE     SKJØPHH1
     C                   ELSE
     C     KFMT2         IFNE      *BLANKS
     C                   WRITE     SKJØPHH2
     C                   END
     C                   END
     C                   WRITE     SKJØP
     C*
     C                   ENDSR
     C*
     C******************************************
     C     BÅTLIN        BEGSR
     C******************************************
     C*
     C* HENTE OPPLYSNINGER FRA BÅT-REGISTRER
     C*
     C                   MOVE      *BLANKS       MN1
     C                   MOVE      *BLANKS       MN2
     C     KODFRK        CHAIN     KODTFR                             33
     C   33              MOVE      *BLANKS       KFRNTX
     C     BILLK         CHAIN     BILLOF                             33
     C*
     C     BLOB          CHAIN     CDBOAT                             33
     C   33              MOVE      *BLANKS       XOBN
     C  N33              MOVEL     CBNAB         XOBN
     C     BLLB          CHAIN     CDBOAT                             33
     C   33              MOVE      *BLANKS       XLBN
     C  N33              MOVEL     CBNAB         XLBN
     C     BLLSS         CHAIN     STED2                              33
     C   33              MOVE      *BLANKS       XLSSN
     C  N33              MOVEL     ST2NVN        XLSSN
     C     BLLOS         CHAIN     STED2                              33
     C   33              MOVE      *BLANKS       XLOSN
     C  N33              MOVEL     ST2NVN        XLOSN
     C     BLVH          CHAIN     STED2                              33
     C   33              MOVE      *BLANKS       XVHN
     C  N33              MOVEL     ST2NVN        XVHN
     C*
     C                   SETOFF                                       33
     C*
     C                   ENDSR
     C*
     C******************************************
     C     BLTXT         BEGSR
     C******************************************
     C     BLV1K         SETLL     BLV1LF
     C*
     C     STBLT1        TAG
     C     BLV1K         READE     BLV1LF                                 33
     C  N33              DO
     C     BVVKT         COMP      0                                  8989
     C     BVM3          COMP      0                                  9090
     C   25              EXSR      UTHDS
     C                   WRITE     DETBL1
     C                   GOTO      STBLT1
     C                   END
     C*
     C  N25              WRITE     TOMLIN
     C     BLV2K         SETLL     BLV2LF
     C                   SETOFF                                       33
     C                   Z-ADD     0             N3                3 0
     C     STBLT2        TAG
     C     BLV2K         READE     BLV2LF                                 33
     C  N33BVMN          IFEQ      *BLANKS
     C                   GOTO      STBLT2
     C                   END
     C  N33              ADD       1             N3
     C  N33              MOVE      BVMN          MN1(N3)
     C  N33              GOTO      STBLT2
     C                   MOVE      N3            N4                3 0
     C*
     C     BLV2K         SETLL     BLV2LF
     C                   Z-ADD     0             GVLN              3 0
     C                   Z-ADD     0             GVTY              1 0
     C                   SETOFF                                       33
     C                   Z-ADD     0             N3
     C     STBLT3        TAG
     C     BLV2K         READE     BLV2LF                                 33
     C  N33BVKD          IFNE      'O'
     C     BVKD          ANDNE     'X'
     C     BVKD          ANDNE     'N'
     C                   GOTO      STBLT3
     C                   END
     C  N33              DO
     C     GVLN          COMP      0                                      88
     C   88GVTY          COMP      0                                      88
     C   88              MOVE      BVLI          GVLN
     C   88              MOVE      '1'           GVTY
     C     BVLI          COMP      GVLN                                   88
     C  N88GVTY          DOWLE     4
     C                   ADD       1             N3
     C                   ADD       1             GVTY
     C                   END
     C  N88              MOVE      BVLI          GVLN
     C  N88              MOVE      '1'           GVTY
     C     GVTY          DOWLT     BVLI2
     C                   ADD       1             N3
     C                   ADD       1             GVTY
     C                   END
     C                   ADD       1             GVTY
     C                   ADD       1             N3
     C                   MOVE      BVFT          MN2(N3)
     C                   GOTO      STBLT3
     C                   END
     C*
     C     STBLT4        TAG
     C     N3            IFGT      N4
     C                   MOVE      N3            N4
     C                   END
     C                   Z-ADD     1             N3
     C     N4            DOWGE     N3
     C                   MOVE      MN1(N3)       XMN1
     C                   MOVE      MN2(N3)       XMN2
     C   25              EXSR      UTHDS
     C                   WRITE     DETBL2
     C                   ADD       1             N3
     C                   END
      * MELLOM B.L. OG   MERKN....
      * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE LIK K)
     C                   MOVE      *BLANKS       FRISTX                          FORIGE...
     C                   MOVEA     *BLANKS       FS                              2 STK
     C                   MOVE      *ZEROS        FN                1 0           INDEX
     C                   MOVE      'J'           FSLIN1            1             1.LINJE
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 91
     C     *IN91         DOWEQ     '0'
     C                   SORTA     DFS
     C                   MOVE      '0'           *IN34
     C     DFS(10)       IFNE      ' '
     C     'K'           LOOKUP    DFS                                    34
     C     *IN34         IFEQ      '1'
     C     FSKODE        CHAIN     KODFRI                             34
     C     *IN34         IFEQ      '0'
     C   25              EXSR      UTHDS
      * TEST LEST FRITEKST, SKRIV HVIS ULIK FORIGE KODE EL. 2  LEST.
     C                   EXSR      TSTFSL
     C                   END
     C                   END
     C                   END
     C*
     C  N91HEADFK        READE     FRISOK                                 91
     C                   END
      * HVIS SISTE LESTE ENNÅ IKKE ER SKREVET-PRINT DEN NÅ (28=LEDETXT)
     C     FS(1)         IFNE      *BLANKS
     C     FSLIN1        IFEQ      'J'
     C                   MOVE      *ON           *IN28
     C                   END
     C                   WRITE     DETFS
     C                   END
      *
      * OG UTLEV.FORBEHOLD
     C     HEKFT1        IFEQ      *BLANKS
     C     HEFT1A        ANDNE     *BLANKS
     C   25              EXSR      UTHDS
     C                   WRITE     DETUFB
     C                   END
      *
      *
     C     FREETK        SETLL     FREETXT2                           91
     C     STSFT         TAG
     C     FREETK        READE     FREETXT2                               91
     C  N91
     CAN 25              EXSR      UTHDS
     C  N91              WRITE     DETFRT
     C  N91              GOTO      STSFT
     C*
     C     SLBLT         ENDSR
     C*
     C******************************************
     C     NOSEA         BEGSR
     C******************************************
     C                   SETOFF                                       88
     C  N77TLF           COMP      *BLANKS                            8888
     C                   MOVE      '0'           *IN26
     C                   MOVE      *ZEROS        XSIDE
     C                   EXSR      UTHDL
      * MELLOM HEAD (--> KJØP2) OG MERKN.(KJØP3/4)....
      * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE LIK K)
     C                   MOVE      *BLANKS       FRISTX                          FORIGE...
     C                   MOVEA     *BLANKS       FS                              2 STK
     C                   MOVE      *ZEROS        FN                1 0           INDEX
     C                   MOVE      'J'           FSLIN1            1             1.LINJE
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 91
     C     *IN91         DOWEQ     '0'
     C                   SORTA     DFS
     C                   MOVE      '0'           *IN34
     C     DFS(10)       IFNE      ' '
     C     'K'           LOOKUP    DFS                                    34
     C     *IN34         IFEQ      '1'
     C     FSKODE        CHAIN     KODFRI                             34
     C     *IN34         IFEQ      '0'
     C   26              EXSR      UTHDL
      * TEST LEST FRITEKST, SKRIV HVIS ULIK FORIGE KODE EL. 2  LEST.
     C                   EXSR      TSTFSL
     C                   END
     C                   END
     C                   END
     C*
     C  N91HEADFK        READE     FRISOK                                 91
     C                   END
      * HVIS SISTE LESTE ENNÅ IKKE ER SKREVET-PRINT DEN NÅ (28=LEDETXT)
     C     FS(1)         IFNE      *BLANKS
     C     FSLIN1        IFEQ      'J'
     C                   MOVE      *ON           *IN28
     C                   END
     C                   WRITE     KJØPFS
     C                   END
      *
      * OG UTLEV.FORBEHOLD
     C     HEKFT1        IFEQ      *BLANKS
     C     HEFT1A        ANDNE     *BLANKS
     C   26              EXSR      UTHDL
     C                   WRITE     KJØPUFB
     C                   END
      *
     C                   MOVE      'J'           TXLIN1            1             1.LINJE
     C     FREETK        SETLL     FREETXT2                           91
     C     FRIST         TAG
     C     FREETK        READE     FREETXT2                               91
     C  N91TXLIN1        IFEQ      'J'
     C                   WRITE     KJØP3
     C                   MOVE      'N'           TXLIN1
     C                   END
     C  N91
     CAN 26              EXSR      UTHDL
     C  N91              WRITE     KJØP4
     C  N91              GOTO      FRIST
     C   26              EXSR      UTHDL
     C                   WRITE     KJØP5
     C     HEADFK        CHAIN     HEADF                              32
     C                   MOVE      'P'           HEPK3
     C                   UPDATE    HEADFR
     C                   EXSR      KUNFRA
     C                   WRITE     KJØPB
     C*
n06  c     kfmsd         iflt      2
n02  c                   exsr      arkivsr
n06  c                   end
     C                   ENDSR
     C******************************************
     C     TSTFSL        BEGSR
     C******************************************
     C* INITIER LEDETEKST FØRSTE GANG
     C     FRISTX        IFEQ      *BLANKS
     C                   MOVE      KFSOTX        FRISTX
     C                   END
      * ANTALL SOM ER LEST SIDEN SISTE PRINT..
     C                   ADD       1             FN
      *
      * NY KODE ELLER MER EN 2 LEST,. SKRIV UT FOREGÅENDE POST
     C     FRISTX        IFNE      KFSOTX
     C     FN            ORGT      2
     C     FSLIN1        IFEQ      'J'
     C                   MOVE      *ON           *IN28
     C                   MOVE      'N'           FSLIN1
     C                   END
     C* 29 ON=SEA,   29 OFF=NOSEA
     C   29              WRITE     DETFS
     C  N29              WRITE     KJØPFS
     C* 28 ON = SKRIV LEDETEKST VED NESTE UTSKRIFT
     C     FRISTX        COMP      KFSOTX                             2828
     C                   MOVEA     *BLANKS       FS
     C                   Z-ADD     1             FN
     C                   END
     C*
     C                   MOVE      KFSOTX        FRISTX
     C                   MOVEL     FSSOK         FS(FN)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     UTHDL         BEGSR
     C******************************************
     C     *IN26         IFEQ      '1'
     C                   WRITE     KJØPNYS
     C                   ADD       1             XSIDE
     C                   MOVE      '0'           *IN26
     C                   END
     C     KFMT1         IFNE      *BLANKS
     C                   WRITE     KJØPHH1
     C                   ELSE
     C     KFMT2         IFNE      *BLANKS
     C                   WRITE     KJØPHH2
     C                   END
     C                   END
      * TRANSPORTMODUL - HENT TRM. / LANDKODE MM FRA TUR
     C     HEUR          IFEQ      'H'
     C     HEPRO         ANDNE     *ZEROS
     C     HEPRO         CHAIN     TURER14                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      TULK          HETRI
     C                   MOVE      TUTRMA        HETRM
     C                   MOVE      TUCON1        HETRCN
     C                   MOVE      0             HETRC
     C     TUCON1        IFNE      *BLANKS
     C                   MOVE      1             HETRC
     C     TULKC1        IFNE      *BLANKS
     C                   MOVE      TULKC1        HETRI
     C                   END
     C                   END
     C                   END
     C                   END
     C                   WRITE     KJØP
     C                   WRITE     KJØP1
     C                   WRITE     KJØP2
     C*
     C                   ENDSR
     C*
     C******************************************
     C     KUNFRA        BEGSR
     C******************************************
     C*
     C* SUMMERER FRAKTBELØP PÅ KJØPER
     C*
     C                   SETOFF                                       5034
     C     FAK2K         SETLL     FAK2
     C     STKF          TAG
     C     FAK2K         READE     FAK2                                   34
     C  N34KODGEK        CHAIN     KODTGE                             34
     C  N34KGEKK         IFEQ      'J'
     C     FAKDA         ANDNE     'K'
     C  N50
     CANN26              WRITE     DLINJE
     C  N50              SETON                                        50
     C     FAVT          IFEQ      *BLANKS
     C                   MOVE      KGENOT        FAVT
     C                   END
     C   26              EXSR      UTHDL
     C                   WRITE     DEL
     C                   END
     C  N34              GOTO      STKF
     C   50
     CANN26              WRITE     DLINJE
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    WSPLNR
     C                   MOVE      'P'           WSPUNI            1
     C                   Z-ADD     13            WSPLNR            3 0
     C  N99KODTPK        CHAIN     KODTP                              99
     C*
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXSKKO            1
     C                   MOVE      'K'           XXSKKO
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEAD2K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    USG
     C                   KFLD                    UDT81
     C     BILLK         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     BLV1K         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     BLV2K         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YSK
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    HEKNK
     C     HODEK         KLIST
     C                   KFLD                    YNET
     C                   KFLD                    UAVD
     C     KODTHK        KLIST
     C                   KFLD                    YHUNI
     C                   KFLD                    UAVD
     C     KODGEK        KLIST
     C                   KFLD                    YGEUNI
     C                   KFLD                    FAVK
     C     KODFRK        KLIST
     C                   KFLD                    YFRUNI
     C                   KFLD                    HEFR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UPRANT            2
     C                   MOVE      *ZEROS        XPRANT            2 0
     C*
     C                   SETOFF                                       99
     C                   MOVE      'K'           YSK               1
     C                   MOVE      ' '           YNET              1
     C                   MOVE      'GE'          YGEUNI            2
     C                   MOVE      'FR'          YFRUNI            2
     C                   MOVE      'H'           YHUNI             1
     C     UDT1          IFGT      501231
     C     UDT1          ADD       19000000      UDT81             8 0
     C                   ELSE
     C     UDT1          ADD       20000000      UDT81
     C                   END
     C     UDT2          IFGT      501231
     C     UDT2          ADD       19000000      UDT82             8 0
     C                   ELSE
     C     UDT2          ADD       20000000      UDT82
     C                   END
     C*
     C     KODTHK        CHAIN     KODTH                              33
     C     KOHKK         COMP      'J'                                    46
     C   46HODEK         CHAIN     HODE                               33
     C*
     C     USG           COMP      'ALL'                                  33
     C   33              MOVE      *BLANKS       USG
     C*
     C                   MOVE      'DIV0196'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     78            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    MSGTXT           78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
N02  C                   read      firm                                   33
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      HEDTD         UDT1FM            2 0
     C                   MOVE      HEDTM         UDT2FM            2 0
     C                   MOVE      HEDTÅ         UDT3FM            2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1FM
     C                   PARM                    UDT2FM
     C                   PARM                    UDT3FM
     C                   MOVE      UDT1FM        XEDTD
     C                   MOVE      UDT2FM        XEDTM
     C                   MOVE      UDT3FM        XEDTÅ
     C*
     C                   ENDSR
     C*
     C*
n02  C***********************************************
n02  C     ARKIVSR       BEGSR
n02  C***********************************************
n02  C***********************************************
n02  C                   TIME                    XULTID
n02  C                   MOVE      XULDD         ULDD
n02  C                   MOVE      XULMM         ULMM
n02  C                   MOVE      XULÅÅ         ULÅÅ
n02  C     FIFIRM        CHAIN     FIRMARC                            33
n02  C     *IN33         IFEQ      '0'
n02  C     'kk'          chain     arktxt                             33
n02  C     *IN33         IFEQ      '0'
n02  C     arkjn         andeq     'J'
n02   *
n02  C                   MOVE      FIFIRM        ARFIRM
n02  C                   MOVE      HEAVD         ARAVD
n02  C                   MOVE      HEOPD         AROPD
n02  C                   MOVE      *BLANKS       ARUNDE
n02  C                   MOVE      'kk'          ARTYPE
n02  C                   MOVE      ZUSER         ARUSER
n02  C                   MOVE      ULDT          ARDATE
n02  C                   MOVE      XULTM         ARTIME
n02  C                   MOVE      KUNDNR        ARKUND
n02  C                   WRITE     ARKIVR
n02  C                   END
n02  C                   END
n02  C                   ENDSR
