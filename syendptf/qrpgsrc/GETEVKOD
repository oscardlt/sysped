      *******************************************************
      * Finn rett T&T-kode når det er mange ledd i kjeden
      *******************************************************
      * Tanke var å teste på sammengen FF-HO-VF og hvor i kjende en er/hvilke andre ledd som finnes
      * MEN er det bedre å gå etter HVA som finnes i loggen fra før?(går da etter Mor-oppdrags logg)
      *******************************************************
      * ARC = Arrived Collection place kan bli gjor om til:
      *       AC1 = Ankommet for henting terminal 1
      *       AC2 = Ankommet for henting terminal 2
      * STL = Start Loading kan bli gjor om til:
      *       SL1 = Start Loading terminal 1
      *       SL2 = Start Loading terminal 2
      * TEI = Arrived Terminal kan bli gjor om til:
      *       TI2 = Levert terminal(terminal 2)
      *       TI3 = Levert terminal(terminal 3)..
      * TEU = Departed Terminal kan bli gjor om til:
      *       TU2 = Avgått terminal(terminal 2)
      *       TU3 = Avgått terminal(terminal 2)..
      * ARD = Arrived Destination place kan bli gjor om til:
      *       AD1 = Ankommet for levering terminal 1
      *       AD2 = Ankommet for levering terminal 2
      * STU = Start Unloading kan bli gjor om til:
      *       SU1 = Start Unloadin terminal 1
      *       SU2 = Start Unloadin terminal 2
      *
     D xxACTI2         S              2
     D En_Ni           S              1  0
     D En_Ni_A         S              1
      *
N02  FHEADF     IF   E           K DISK
N02  FTRACKL02  IF   E           K DISK
N02  C     *entry        PLIST
N02  C                   PARM                    UUAVD             4 0
N02  C                   PARM                    UUOPD             7 0
N02  C                   PARM                    henterm          50
N02  C                   PARM                    levterm          50
N02  C                   PARM                    UUACTI            3
      *
N02  C     HEAKEY        KLIST
N02  C                   KFLD                    UUAVD
N02  c                   KFLD                    UUOPD
N02  C     TT02Key       KLIST
N02  C                   KFLD                    TTAVD
N02  c                   KFLD                    TTOPD
N02  C                   KFLD                    TTFBNR
N02  C                   KFLD                    TTACTI
N02  C     TT02KeyE      KLIST
N02  C                   KFLD                    TTAVD
N02  c                   KFLD                    TTOPD
N02  C                   KFLD                    TTFBNR
      *
N02  C     HEAKEY        chain     HEADF
N02  C                   if        %found
N02  C                   if        TROPD0 = *zeros
N02  C                   eval      TTAVD  = HEAVD
N02  C                   eval      TTOPD  = HEOPD
N02  C                   else
N02  C                   eval      TTAVD  = TRAVD0
N02  C                   eval      TTOPD  = TROPD0
N02  C                   endif
      * seperate subrutiner pr tye (selv om de nok vil vøre 90 % like )
     c                   select
     c                   when      UUACTI = 'ARC'
     c                   exsr      ARC_SR
     c                   when      UUACTI = 'STL'
     c                   exsr      STL_SR
     c                   when      UUACTI = 'TEI'
     c                   exsr      TEI_SR
     c                   when      UUACTI = 'TEU'
     c                   exsr      TEU_SR
     c                   when      UUACTI = 'ARD'
     c                   exsr      ARD_SR
     c                   when      UUACTI = 'STU'
     c                   exsr      STU_SR
     c                   when      UUACTI = 'ARC'
     c                   exsr      ARC_SR
     c                   endsl
      *
N02  C                   endif
      *
     C                   EVAL      *INLR=*ON
     c                   return
      *********************************************************
     c     ARC_SR        begsr
      *********************************************************
      * ARC = Arrived Collection place kan bli gjor om til:
      *       AC1 = Ankommet for henting terminal 1
      *       AC2 = Ankommet for henting terminal 2
      *
      * hvis ikke til terminal og ikke koden ikke finns fra før - uendret.
     c                   if        Henterm = *blanks
     c**                 eval      TTACTI = 'ARC'
     c**   TT02Key       chain     TrackL02
     c**                 if        not %found
     c**                 goto      Arc_Ut
     c**                 endif
      * flere forsøk på henting?? ARC kan forekomme flere ganger hvis term er blank
     c                   goto      Arc_Ut
     c                   endif
      *
      * ARC finnes, eller henteterminal er utfylt - sett AC1, AC2, AC3,...
     c                   eval      xxACTI2= 'AC'
     c                   exsr      GetAct1_9
      *
     c     Arc_Ut        endsr
      *
      *********************************************************
     c     STL_SR        begsr
      *********************************************************
      * STL = Start Loading kan bli gjor om til:
      *       SL1 = Start Loading terminal 1
      *       SL2 = Start Loading terminal 2
      *
      * hvis ikke til terminal og ikke koden ikke finns fra før - uendret.
     c                   if        Henterm = *blanks
     c*                  eval      TTACTI = 'STL'
     c*    TT02Key       chain     TrackL02
     c*                  if        not %found
     c*                  goto      Stl_Ut
     c*                  endif
     c                   goto      Stl_Ut
     c                   endif
      *
      * STL finnes, eller henteterminal er utfylt - sett SL1, SL2, SL3,...
     c                   eval      xxACTI2= 'SL'
     c                   exsr      GetAct1_9
      *
     c     Stl_Ut        endsr
      *
      *********************************************************
     c     TEI_SR        begsr
      *********************************************************
      * TEI = Arrived Terminal kan bli gjor om til:
      *       TI2 = Levert terminal(terminal 2)
      *       TI3 = Levert terminal(terminal 3)
      *
      * hvis koden ikke finns fra før - uendret.
     c                   eval      TTACTI = 'TEI'
     c     TT02Key       chain     TrackL02
     c                   if        not %found
     c                   goto      TEI_Ut
     c                   endif
      *
      * TEI finnes, - sett TI1, TI2, TI3,...
     c                   eval      xxACTI2= 'TI'
     c                   exsr      GetAct1_9
      *
     c     TEI_Ut        endsr
      *
      *
      *********************************************************
     c     TEU_SR        begsr
      *********************************************************
      * TEU = Departed Terminal kan bli gjor om til:
      *       TU1 = Avgått terminal(terminal 1)
      *       TU2 = Avgått terminal(terminal 1)
      *
      * hvis koden ikke finns fra før - uendret.
     c                   eval      TTACTI = 'TEU'
     c     TT02Key       chain     TrackL02
     c                   if        not %found
     c                   goto      TEU_Ut
     c                   endif
      *
      * TEI finnes, - sett TI1, TI2, TI3,...
     c                   eval      xxACTI2= 'TU'
     c                   exsr      GetAct1_9
      *
     c     TEU_Ut        endsr
      *
      *********************************************************
     c     ARD_SR        begsr
      *********************************************************
      * ARD = Arrived Destination place kan bli gjor om til:
      *       AD1 = Ankommet for levering terminal 1
      *       AD2 = Ankommet for levering terminal 2
      *
      * hvis ikke til terminal og ikke koden ikke finns fra før - uendret.
     c                   if        Levterm = *blanks
     c**                 eval      TTACTI = 'ARD'
     c**   TT02Key       chain     TrackL02
     c**                 if        not %found
     c**                 goto      Ard_Ut
     c**                 endif
      * flere forsøk på levering?? ARD kan forekomme flere ganger hvis term er blank
     c                   goto      Ard_Ut
     c                   endif
      *
      * Lev.terminal er utfylt - sett AD1, AD2, AD3,...
     c                   eval      xxACTI2= 'AD'
     c                   exsr      GetAct1_9
      *
     c     Ard_Ut        endsr
      *
      *
      *********************************************************
     c     STU_SR        begsr
      *********************************************************
      * STU = Start Unloading kan bli gjor om til:
      *       SU1 = Start Unloadin terminal 1
      *       SU2 = Start Unloadin terminal 2
      *
      * hvis ikke til terminal og ikke koden ikke finns fra før - uendret.
     c                   if        Levterm = *blanks
     c                   goto      Stu_Ut
     c                   endif
      *
      * Lev.terminal er utfylt - sett SU1, SU2, SU3,...
     c                   eval      xxACTI2= 'SU'
     c                   exsr      GetAct1_9
      *
     c     Stu_Ut        endsr
      *
      *
      *
      *
      *********************************************************
     c     GetAct1_9     begsr
      *********************************************************
      * for aktivitet XX1 -> XX9 finn først som ikke finnes fra før
     c                   eval      En_Ni = 1
      * Ved TEI / TEU-> TI/TU.. begynn nummerering på 2 ( TEI / TEU er terminal 1 )
     c                   if        xxACTI2='TI' or xxACTI2='TU'
     c                   eval      En_Ni = 2
     c                   endif
     c                   move      En_Ni         En_Ni_A
     c                   eval      TTACTI = xxACTI2+En_Ni_A
     c     TT02Key       setll     TrackL02
     c     TT02KeyE      reade     TrackL02
     c                   dow       not %eof
     c                   if        %subst(TTACTI:1:2) <> xxACTI2
     c                             or En_Ni = 9
     c                   leave
     c                   endif
     c                   eval      En_Ni = En_Ni + 1
     c                   move      En_Ni         En_Ni_A
     c     TT02KeyE      reade     TrackL02
     c                   enddo
      *
     c                   eval      UUACTI = xxACTI2+En_Ni_A
     c
     c                   endsr
