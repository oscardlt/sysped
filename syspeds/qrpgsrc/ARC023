      *
      ***********************************************************
      *** PROGRAM Som viser opplastet dokumenter              ***
      ***********************************************************
      *
     FBRPARF    IF   E           K DISK
     FZEADL01   IF   E           K DISK
     FZRISOL02  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARC023FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     ZRISOL02K     SETLL     ZRISOL02
     C     ZRISOL02K     READE     ZRISOL02                               94
      *
     C                   DOW       *IN94 = *OFF
     C                   ADD       1             ZRECNO
     c                   ADD       1             WSANT
     C                   EXSR      GENBANE
     C                   WRITE     SUBFIL
     C     ZRISOL02K     READE     ZRISOL02                               94
     C  N94              ENDDO
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      ***
      *
     C                   SETOFF                                       9899
      *
      *** AVSLUTT
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
      *
      *** FRISK OPP
     C   05              GOTO      START
      *
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UREFF            17
     C                   PARM                    UUNIK             9
      *
     C     ZEADL01K      KLIST
     C                   KFLD                    UREFF
     C                   KFLD                    HEUNIK
     C     ZRISOL02K     KLIST
     C                   KFLD                    HEUNIK
     C                   KFLD                    UREFF
     C                   KFLD                    FSKODE
     C     BRPARFK       KLIST
     C                   KFLD                    HEFILE
     C                   KFLD                    PAKUNR
     C                   KFLD                    PAID
      *
     C                   MOVE      UUNIK         HEUNIK
     C                   MOVE      '#VD'         FSKODE
     C                   MOVE      'OLBAN'       PAID
     C     ZEADL01K      CHAIN     ZEADL01                            33
     C     BRPARFK       CHAIN     BRPARF                             33
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     FIFIRM        CHAIN     FIRMARC                            33
      *
     C                   ENDSR
      *
      ***********************************************
     C     GENBANE       BEGSR
      ***********************************************
     C                   MOVEL     FSDOKK        XAN01             1
     C                   IF        XAN01 = '.'
     C                   EVAL      WSTXT = 'Opplastet dokument'
     C                   EVAL      WSLINW = 'http://'
     C                             + %TRIM(ARCPAD)
     C                             + %TRIM(PAVRDA)
     C                             + %TRIM(FSSOK)
     C                             + %TRIM(FSDOKK)
     C                   ELSE
     C                   EVAL      WSTXT = FSSOK
     C                   EVAL      WSLINW = 'http://'
     C                             + %TRIM(ARCPAD)
     C                             + %TRIM(PAVRDA)
     C                             + %TRIM(UUNIK)
     C                             + %TRIM(FSDOKK)
     C                             + %TRIM(FSSOK)
     C                   END
      *
     C                   endsr
      *
