      ***********************************************************
      *** PROGRAM SKAL VISE AVDELINGER/UDISPONERT DISTR.GODS  ***
      ***********************************************************
     FKODTA     IF   E           K DISK
     FHEAD9     IF   E           K DISK
     FSYAV00FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  KOANVN                 1     33
     D  WSANVN                 1     20
     D LDA            UDS
     D  UFIRM                  1      2
     D  UAVDUT                15     18
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      W2KOD         G2KOD             4 0
     C                   MOVE      W2KODT        G2KODT            4 0
     C                   CLEAR                   BUNN
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     KODTAK        SETLL     KODTA
     C     START1        TAG
     C                   READ      KODTA                                  94
      *
     C     *IN94         DOWEQ     '0'
     C     KOAAVD        IFGT      W2KODT
     C                   GOTO      UTLES
     C                   END
     C                   EXSR      GETOPD
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   READ      KODTA                                  94
     C                   END
      *
     C     UTLES         TAG
     C     ZRECNO        IFGT      *ZEROS
     C                   Z-ADD     1             ZRECNO
     C                   END
     C     START3        TAG
     C                   SETOFF                                       9998
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
     C*
     C                   SETOFF                                       9830
     C*** AVSLUTT
     C   03
     COR 12              GOTO      SLUTT
      *** FRISK OPP
     C   05              GOTO      START
      *
     C     W2KOD         IFNE      G2KOD
     C     W2KODT        ORNE      G2KODT
     C                   GOTO      START
     C                   END
      *
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENTSR
     C                   GOTO      START3
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
     C                   SETOFF                                       9192
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '2'
     C                   EXSR      WRKTUR
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '5'
     C                   EXSR      SEOPD
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C     *IN98         IFEQ      '1'
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SEOPD         BEGSR
     C***********************************************
     C                   MOVE      KOAAVD        UAVD              4 0
     C                   MOVE      *ZEROS        UPRO              8 0
     C                   MOVE      'N'           UIMP              1
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'SYEX88C'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   PARM                    UIMP
     C                   PARM                    UFLAGG            1 0
     C*
     C                   ENDSR
     C***********************************************
     C     WRKTUR        BEGSR
     C***********************************************
     C*
     C                   MOVE      KOAAVD        UAVD              4 0
     C                   MOVE      *ZEROS        UPRO              8 0
     C                   MOVE      'N'           UTRAN             1
     C                   MOVE      'N'           UIMP              1
     C                   MOVE      'N'           U10               1
     C                   MOVE      UAVD          UAVDUT
     C                   OUT       *DTAARA
     C                   CALL      'SYEX88'
     C                   PARM                    UIMP
     C                   PARM                    U10
     C                   PARM                    UPRO
     C                   PARM                    UTRAN
     C*
     C                   MOVE      UAVD          UAVDUT
     C                   OUT       *DTAARA
     C                   ENDSR
     C***********************************************
     C     GETOPD        BEGSR
     C***********************************************
     C*
      * SUM UDISPONERTE AVDELINGEN ..
     C                   MOVE      *ZEROS        WSNT              7 0
     C                   MOVE      *ZEROS        WSVKT             7 0
     C                   MOVE      *ZEROS        WSCBM             7 2
     C                   MOVE      *ZEROS        WSNTO             7 0
     C     HEAD9K        SETLL     HEAD9
     C     HEAD9K        READE     HEAD9                                  33
     C     *IN33         DOWEQ     '0'
     C                   ADD       HENT          WSNT
     C                   ADD       HEVKT         WSVKT
     C                   ADD(H)    HEM3          WSCBM
     C                   ADD       1             WSNTO
     C     HEAD9K        READE     HEAD9                                  33
     C                   END
      * SUM UDISPONERTE GRANDTOTAL...
     C                   ADD       WSNT          WTNT              7 0
     C                   ADD       WSVKT         WTVKT             7 0
     C                   ADD       WSCBM         WTCBM             7 2
     C                   ADD       WSNTO         WTNTO             7 0
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEAD9K        KLIST
     C                   KFLD                    KOAAVD
     C                   KFLD                    NULPRO            8 0
     C                   MOVE      *ZEROS        NULPRO
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    W2KOD
      *
     C                   MOVE      'A'           KOAUNI
     C     *DTAARA       DEFINE    *LDA          LDA
      *
INT  C                   Z-ADD     9600          W2KOD
INT  C                   Z-ADD     9699          W2KODT
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
     C*
