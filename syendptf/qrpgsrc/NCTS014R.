      *
      ***********************************************************
      *
      * !!! PROGRAM KOMPILERES MED OVERSTYRER NCTS014PVA/B TIL NCTS014PV !!!
      *                                       NCTS014PFA/B     NCTS014PF
      *     (manuelt eller enklere: call NCTS014CMP hvis det er i SYENDPTF)
      *
      *** PROGRAM SKAL SKRIVE UT EL. TRANSITTERING            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 1-26                             ***
      *** LEDIGE INDIKATORER 31 37 51-95
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 JOV PTF12 akkumuler antall seals fra Item lines
      ***********************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVL03  IF A E           K DISK
     FSYPTFF    IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FNCTSESTD  IF   E           K DISK
     FNCTSEH    UF   E           K DISK
     FNCTSEH06  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR06)
     FTRUHL     IF   E           K DISK
     FNCTSEC    UF   E           K DISK
     FNCTSECAM  IF   E           K DISK
     FNCTSEI    IF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FHEADF     UF   E           K DISK
     FFRISOK    IF   E           K DISK
     FTURER14   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FTARI      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTPUSR  IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FEDIM2     IF   E           K DISK
     FEDIM4     IF   E           K DISK    PREFIX(M4_)
     F                                     RENAME(EDIMR:EDIMR4)
     FNCTS014PFBO    E             PRINTER USROPN
     F                                     RENAME(NCTS014F1:NCTS014FB1)
     F                                     RENAME(NCTS014F2:NCTS014FB2)
     F                                     RENAME(NCTS014F3:NCTS014FB3)
     F                                     RENAME(NCTS014F4:NCTS014FB4)
     F                                     RENAME(NCTS014F5:NCTS014FB5)
     F                                     RENAME(NCTS014F6:NCTS014FB6)
     F                                     RENAME(NCTS014F7:NCTS014FB7)
     FNCTS014PFAO    E             PRINTER USROPN
     FNCTS014PL O    E             PRINTER USROPN
     FNCTS014PVBO    E             PRINTER USROPN
     F                                     RENAME(NCTS014V1:NCTS014VB1)
     F                                     RENAME(NCTS014V2:NCTS014VB2)
     F                                     RENAME(NCTS014VD:NCTS014VBD)
     FNCTS014PVAO    E             PRINTER USROPN
     D UCMD            DS          1024
     D                 DS
     D                 DS
     D  FSSOK                  1     35
     D  FSSO25                 1     25
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(NCTS014PFA) -
     D                                     TOFILE(NCTS014PF) -
     D                                     PRTQLTY(*NLQ) -
     D                                     FNTRSL(300) -
     D                                     OUTQ(')
     D XCMD12          C                   CONST('OVRPRTF -
     D                                     FILE(NCTS014PFB) -
     D                                     TOFILE(NCTS014PF) -
     D                                     PRTQLTY(*NLQ) -
     D                                     FNTRSL(300) -
     D                                     OUTQ(')
     D XCMD13          C                   CONST('OVRPRTF -
     D                                     FILE(NCTS014PVA) -
     D                                     TOFILE(NCTS014PV) -
     D                                     PRTQLTY(*NLQ) -
     D                                     FNTRSL(300) -
     D                                     OUTQ(')
     D XCMD14          C                   CONST('OVRPRTF -
     D                                     FILE(NCTS014PVB) -
     D                                     TOFILE(NCTS014PV) -
     D                                     PRTQLTY(*NLQ) -
     D                                     FNTRSL(300) -
     D                                     OUTQ(')
     D XCMD16          C                   CONST('OVRPRTF -
     D                                     FILE(NCTS014PL) -
     D                                     TOFILE(NCTS014PL) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(70 210) -
     D                                     CPI(10) -
     D                                     OVRFLW(70) -
     D                                     USRDTA(')
     D XCMD21P         C                   CONST('PAGESIZE(70 80) -
     D                                     CPI(10) -
     D                                     OVRFLW(70) -
     D                                     USRDTA(')
     D*XCMD22          C                   CONST('PAGESIZE(70 120) -
     D*                                    CPI(15) -
     D*                                    OVRFLW(65) -
     D XCMD22          C                   CONST('PAGESIZE(108 160) -
     D                                     CPI(20) -
     D                                     LPI(9) -
     D                                     OVRFLW(102) -
     D                                     USRDTA(')
     D*XCMD23          C                   CONST('PAGESIZE(70 120) -
     D*                                    CPI(15) -
     D*                                    OVRFLW(70) -
     D XCMD23          C                   CONST('PAGESIZE(108 160) -
     D                                     CPI(20) -
     D                                     LPI(9) -
     D                                     OVRFLW(102) -
     D                                     USRDTA(')
     D XCMD24          C                   CONST('PAGESIZE(70 80) -
     D                                     CPI(10) -
     D                                     OVRFLW(70) -
     D                                     USRDTA(')
     D XCMD31          C                   CONST(') COPIES(')
     D XCMD41          C                   CONST(') FORMTYPE(')
     D XCMDPDF         C                   CONST('DEVTYPE(')
     D XCMDPDF2        C                   CONST('FRONTOVL(TETN 0.16 0.200)')
     D XCMDPDF3        C                   CONST('FRONTOVL(TSADNO) -
     D                                     FRONTMGN(0.0 0.05)')
     D XCMDPDF3PDF     C                   CONST('FRONTOVL(TSADNO 0.18 0.200)')
     D R401            S             52    DIM(20)
     D R441            S             50    DIM(20)
     D CNR             S             17    DIM(20)
     D DFKD            S             20    DIM(20)
     D                SDS
     D  UUSER                254    263
     D                 DS
     D  THNTTD                 1      1  0
     D  XHNTTD                 1      1
     D                 DS
     D  THNTLL                 1      1  0
     D  XHNTLL                 1      1
     D                 DS
     D  DTWS                   1     10
     D  DTUSER                11     20
     D  DTIN39                21     21
     D  DTDTA                  1    128
     D                 DS
     D  TUDTD                  1      4  0
     D  TUDTM                  5      6  0
     D  TUDTÅ                  7      8  0
     D  TUDT                   1      8  0
     D                 DS
     D  XUDTD                  1      2  0
     D  XUDTM                  3      4  0
     D  XUDTÅ                  5      6  0
     D  XUDT                   1      6  0
     D                 DS
     D  XHGBGU                 1     30
     D  XGU                    1     30
     D                                     DIM(10)
     D                 DS
     D  XFFM1                  1     75
     D  ST1                    1     75
     D                                     DIM(75)
     D                 DS
     D  THTRNR                 1     18
     D  XHTRNR                 1     18
     D  ST2                    1     18
     D                                     DIM(18)
     D                 DS
     D  THCNA                  1     22
     D  XHCNA1                 1     12
     D  XHCNA2                13     22
     D                 DS
     D  THCANR                 1     17
     D  XHCANR1                1      6
     D  XHCANR2                7     12
     D                 DS
     D  TVEXKD                 1      1  0
     D  XTVEXKD                1      1
     D                 DS
     D  TIPMRK                 1    120
     D  TIPMRK_1               1     60
     D  TIPMRK_2              61    120
     D  TIPMRK_11              1     17
     D                 DS
     D  TICTX                  1    120
     D  TICTX_1                1     64
     D  TICTX_11               1     50
     D                 DS
     D  TICCH                  1      6  0
     D  TICCH_A                1      6
     D                 DS
     D  TIPDRF                 1     70
     D  TIPDRF_11              1     50
     D                 DS
     D  TISDRF                 1     70
     D  TISDRF_11              1     50
     D                 DS
     D  TITDRF                 1     70
     D  TITDRF_11              1     50
     D                 DS
     D  TIADRF                 1     70
     D  TIADRF_11              1     50
     D                 DS
     D  TIAITX                 1    120
     D  TIAITX_1               1     70
     D  TIAITX_2              71    120
      *
     C                   MOVEL     'NCTS014RQ'   UDTAQ            10
     C                   MOVEL     '*LIBL'       ULIBL            10
     C                   Z-ADD     128           ULENGT            5 0
     C                   MOVE      *BLANKS       UDTA            128
     C                   Z-SUB     99999         UWAIT             5 0
     C                   Z-ADD     1024          UCMDL            15 5
     C                   BITON     '123457'      GRAAPP            1
     C                   BITOFF    '06'          GRAAPP
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C     START0        TAG
     c     arkiver       ifeq      'J'
     c                   call      'ARC002CLB'
     c                   parm                    artype
     c                   parm                    aruser
     c                   end
     C                   EXSR      INIT
      *
      * SPESIALBEHANDLING VED MANUELL PRINTING
      *
     C     PRTTYP        IFEQ      'M'
     c     prttyp        oreq      'E'
     C                   MOVE      PRTAVD        THAVD
     C                   MOVE      PRTTDN        THTDN
     C     NCTSEHK0      CHAIN(N)  NCTSEH                             30
     C                   EXSR      OVRF
     C     *IN30         IFEQ      '0'
     C                   OPEN      NCTS014PFA
     C                   OPEN      NCTS014PVA
     C                   OPEN      NCTS014PFB
     C                   OPEN      NCTS014PVB
     C                   OPEN      NCTS014PL
     C                   EXSR      PRINT
     C                   CLOSE     NCTS014PFA
     C                   CLOSE     NCTS014PVA
     C                   CLOSE     NCTS014PFB
     C                   CLOSE     NCTS014PVB
     C                   CLOSE     NCTS014PL
     C                   END
     C                   GOTO      SLUTT
     C                   END
      *
      *** LES TOLLDEK. FRA TRUH-REGISTER. OG TEST OM AVDELING ER SAMMEN
      ***   SOM FORRIGE TOLLDEK. HVIS IKKE, HENTES AVDELINGSDATA OG GÅ
      ***   UT PROGRAM FOR Å ORDNE ALLE PRINTERSTYRING (SETT UIN02='1')
      ***   SÅ GÅ TILBAKE TIL PROGRAM.
      *
     C     NCTSEH06K     SETLL     NCTSEH06
     C     START         TAG
     C     NCTSEH06K     READE     NCTSEH06                               30
     C  N30              DO
     C     THAVD         CABNE     UAVD          START0
     C                   EXSR      OVRF
     C                   OPEN      NCTS014PFA
     C                   OPEN      NCTS014PVA
     C                   OPEN      NCTS014PFB
     C                   OPEN      NCTS014PVB
     C                   OPEN      NCTS014PL
     C                   EXSR      PRINT
     C                   CLOSE     NCTS014PFA
     C                   CLOSE     NCTS014PVA
     C                   CLOSE     NCTS014PFB
     C                   CLOSE     NCTS014PVB
     C                   CLOSE     NCTS014PL
      *** FERDIG Å BEHANDLE EN TOLLDEK. OG GÅ TIL NESTE TOLLDEK.
     C                   GOTO      START
     C                   END
      *
     C                   GOTO      START0
     C     SLUTT         TAG
     c     arkiver       ifeq      'J'
     c                   call      'ARC002CLB'
     c                   parm                    artype
     c                   parm                    aruser
     c                   end
     C                   MOVE      '1'           *INLR
      *
      ***********************************************
     C     PRINT         BEGSR
      ***********************************************
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C     PRTTYP        IFEQ      'M'
     C     PRTTYP        OREQ      'E'
     C     NCTSEHK0      CHAIN(N)  NCTSEH                             33
     C                   ELSE
     C     NCTSEHK0      CHAIN     NCTSEH                             33
     C                   END
     C   33              GOTO      SLPRI
     C                   EVAL      ARKIVER = ' '
      *** IND. 32 PÅ BETYR AT DET SKAL KOMME UT UTSKRIFT.
     C     THPKL         COMP      'J'                                    32
     C  N32              GOTO      STPRT1
      *
     C     THWS          IFNE      'TVINR'
      * VENT 2 SEKUNDER I TILFELLE TR011R IKKE REKER Å OPPDATERE TRUH
     C                   Z-ADD     2             USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   END
     C                   MOVE      *BLANKS       XHGBGU
     C                   MOVE      *ZEROS        XN                3 0
      *
     C                   MOVE      THALK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     KS2FTX        XXALKT           17
     C                   ELSE
     C                   MOVE      *BLANKS       XXALKT
     C                   MOVEL     THALK         XXALKT
     C                   END
     C                   MOVE      THBLK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     KS2FTX        XXBLKT           17
     C                   ELSE
     C                   MOVE      *BLANKS       XXBLKT
     C                   MOVEL     THBLK         XXBLKT
     C                   END
     C                   MOVE      '047'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     THDKR         YKODE
     C     TRK01K        CHAIN     TRKODL01                           33
     C                   MOVE      TKTXTN        XHDKR
      *
      *** NÅR VAREPOSTER>1 ELLER CONTAINERE, KOLLI, ... BRUKER MER ENN EN GANG,
      *
N01   * reakkumuler seals (VAR på headernivå)
N01  c                   move      *zeros        sNr               2 0
N01  c                   move      *zeros        THDANT
N01  c                   move      *BLANKS       xxDFKD           25
N01  C     NCTSEHK0      SETLL     NCTSEI
N01  C     NCTSEHK0      READE     NCTSEI                                 33
N01  C     *IN33         DOWEQ     '0'
N01  c                   IF        TIDFKD <> *BLANKS
     c                   eval      snr = %scan(%trim(TIDFKD)+' ':xxDFKD)
N01  c                   IF        Snr = 0                                      fins ikke fra før
N01  C                   EVAL      THDANT = THDANT + 1
N01  C                   EVAL      xxDFKD = %TRIM(xxDFKD)+' '+TIDFKD
N01  C                   ENDIF
N01  C                   ENDIF
N01  C     NCTSEHK0      READE     NCTSEI                                 33
N01  C                   ENDDO
N01  C                   EVAL      THDFKD = %TRIM(xxDFKD)
N01   *
     C     XXALKT        COMP      *BLANKS                                41
     C     XXBLKT        COMP      *BLANKS                                42
     C     THTAID        COMP      *BLANKS                                43
     C     THTALK        COMP      *BLANKS                                44
     C     THOMD         COMP      0                                      46
     C     THDANT        COMP      0                                      47
     C     THBIND        COMP      *BLANKS                                48
     C     THGFT1        COMP      *BLANKS                                49
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     THTSD1        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXT1
     C   34              EVAL      XKTXT1 = THTSD1
     C                   MOVEL     THTSD1        XHTSD1
     C                   MOVEL     THTSD2        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXT2
     C   34              EVAL      XKTXT2 = THTSD2
     C                   MOVEL     THTSD2        XHTSD2
     C                   MOVEL     THTSD3        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXT3
     C   34              EVAL      XKTXT3 = THTSD3
     C                   MOVEL     THTSD3        XHTSD3
     C                   MOVEL     THTSD4        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXT4
     C   34              EVAL      XKTXT4 = THTSD4
     C                   MOVEL     THTSD4        XHTSD4
     C                   MOVEL     THTSD5        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXT5
     C   34              EVAL      XKTXT5 = THTSD5
     C                   MOVEL     THTSD5        XHTSD5
     C                   MOVEL     THTSD6        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXT6
     C   34              EVAL      XKTXT6 = THTSD6
     C                   MOVEL     THTSD6        XHTSD6
     C                   MOVEL     THTSB         YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXTB
     C   34              EVAL      XKTXTB = THTSB
     C                   MOVEL     THTSB         XXTSB
     C                   MOVEL     THCATS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C  N34              MOVEL     TKTXTN        XKTXTC
     C   34              EVAL      XKTXTC = THCATS
     C*    THGBGI        IFEQ      1
     C*                  MOVE      'EU'          XHGBGI
     C*                  ELSE
     C*                  MOVE      '  '          XHGBGI
     C*                  END
      *
     C     XFMPOS        IFNE      0
     C                   Z-ADD     XFMPOS        XN
     C                   MOVE      PFFM1         XFFM1
     C     1             DO        18            X2                3 0
     C                   MOVE      ST2(X2)       ST1(XN)
     C                   ADD       1             XN
     C                   END
     C                   MOVE      XFFM1         PFFM1
     C                   MOVE      PFFM12        XFFM1
     C                   Z-ADD     XFMPOS        XN
     C     1             DO        18            X2
     C                   MOVE      ST2(X2)       ST1(XN)
     C                   ADD       1             XN
     C                   END
     C                   MOVE      XFFM1         PFFM12
     C                   END
      *
     C     XFMPOV        IFNE      0
     C                   Z-ADD     XFMPOV        XN
     C                   MOVE      PVFM1         XFFM1
     C     1             DO        18            X2                3 0
     C                   MOVE      ST2(X2)       ST1(XN)
     C                   ADD       1             XN
     C                   END
     C                   MOVE      XFFM1         PVFM1
     C                   Z-ADD     XFMPOV        XN
     C                   MOVE      PVFM12        XFFM1
     C     1             DO        18            X2                3 0
     C                   MOVE      ST2(X2)       ST1(XN)
     C                   ADD       1             XN
     C                   END
     C                   MOVE      XFFM1         PVFM12
     C                   END
      *
     C                   SELECT
     C     THLSTL        WHENGT    0
     C                   MOVE      '1'           *IN29
     C                   EXSR      PRINT2
     C                   EXSR      PRINT4
     C     THVPOS        WHENLE    1
     C                   MOVE      '0'           *IN29
     C                   EXSR      PRINT2
     C                   OTHER
     C                   MOVE      '0'           *IN29
     C                   EXSR      PRINT3
     C                   ENDSL
      *
      *** OPPDATERE TRUH-/HEAD-REGISTER
     C     STPRT1        TAG
     C  N32              MOVE      'Q'           THST
      * VED THWS<>TVINR OG TH0035=2 --> SENDE TOLLDEK. I TESTPERIODE
     C   32THWS          IFNE      'TVINR'
     C     TH0035        ANDEQ     '2'
     C                   MOVE      'Q'           THST
     C                   ELSE
     C                   MOVE      99999999      M0068A
     C     EDIM2K        SETLL     EDIM2
     C     NCTSEHK0      READPE    EDIM2                                  33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      M1N07 = '045'
     C                   EVAL      THST = 'Z'
     C                   LEAVE
     C                   WHEN      M1N07 = '029'
     C                   EVAL      THST = 'P'
     C                   LEAVE
     C                   WHEN      M1N07 = '028'
     C                   EVAL      THST = 'P'
     C                   LEAVE
     C                   ENDSL
     C     NCTSEHK0      READPE    EDIM2                                  33
     C                   ENDDO
     C                   END
     C                   MOVE      *BLANKS       THWS
     C     PRTTYP        IFNE      'M'
     C     PRTTYP        ANDNE     'E'
     C                   exsr      arkivsr
     C                   EXCEPT    UPDNCTSEH
     C     HEADFK        CHAIN     HEADF                              33
     C  N33              MOVE      'P'           HEPK6
     C  N33              UPDATE    HEADFR
     C                   END
      *
     C     SLPRI         ENDSR
      *
      ***********************************************
     C     PRINT2        BEGSR
      ***********************************************
     C                   move      *blanks       fssok
     C     FRIKEY        CHAIN     FRISOK                             34
     C     NCTSEHK0      SETLL     NCTSEC
     C     NCTSEHK0      READE     NCTSEC                                 33
     C                   Z-ADD     1             TCLN
     C                   EXCEPT    UPDNCTSEC
      *
     C     NCTSEIK       CHAIN     NCTSECAM                           33
     C                   IF        *IN33
     C                   EVAL      TCKNS  = 0
     C                   EVAL      TCNAS  = *BLANKS
     C                   EVAL      TCAD1S = *BLANKS
     C                   EVAL      TCPNS  = *BLANKS
     C                   EVAL      TCPSS  = *BLANKS
     C                   EVAL      TCLKS  = *BLANKS
     C                   EVAL      TCTINS = *BLANKS
     C                   EVAL      TCCPS  = *BLANKS
     C                   EVAL      TCTLS  = *BLANKS
     C                   EVAL      TCEMS  = *BLANKS
     C                   EVAL      TCKNK  = 0
     C                   EVAL      TCNAK  = *BLANKS
     C                   EVAL      TCAD1K = *BLANKS
     C                   EVAL      TCPNK  = *BLANKS
     C                   EVAL      TCPSK  = *BLANKS
     C                   EVAL      TCLKK  = *BLANKS
     C                   EVAL      TCTINK = *BLANKS
     C                   END
     C*    NCTSEIK       CHAIN     NCTSEI                             33
      *
     C     NCTSEIK       CHAIN     NCTSEI                             33
     C                   EXSR      HENTOP
      *
     C                   Z-ADD     1             XSIDEN            3 0
     C                   Z-ADD     1             XSIDET            3 0
     C                   WRITE     NCTS014F1
     C                   WRITE     NCTS014F2
     C                   WRITE     NCTS014F3
     C                   WRITE     NCTS014F5
     C                   WRITE     NCTS014F6
     C                   WRITE     NCTS014F7
      * VED PAPIRBASERT LASTELISTE PRINTES ALLTID RETUR EKSEMPLAR
      * ELLER TEST OM RETUR EKSAMPLAR SKAL PRINTERS
     C  N97THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C     THLSTL        ORGT      0
     C     PRTTYP        ANDNE     'E'
     C                   MOVE      '1'           *IN96
     C                   WRITE     NCTS014FB1
     C                   WRITE     NCTS014FB2
     C                   WRITE     NCTS014FB3
     C                   WRITE     NCTS014FB5
     C                   WRITE     NCTS014FB6
     C                   WRITE     NCTS014FB7
     C                   MOVE      '0'           *IN96
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     PRINT3        BEGSR
      ***********************************************
      *
     C                   EXSR      SJTOTS
      *
      * SKRIV UT FØLGESEDDEL SOM FORSIDE TIL VARELISTE
     C                   Z-ADD     1             XSIDEN            3 0
     C                   WRITE     NCTS014F1
     C                   WRITE     NCTS014F2
     C                   WRITE     NCTS014F4
     C                   WRITE     NCTS014F5
     C                   WRITE     NCTS014F6
     C                   WRITE     NCTS014F7
     C  N97THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C                   MOVE      '1'           *IN96
     C                   WRITE     NCTS014FB1
     C                   WRITE     NCTS014FB2
     C                   WRITE     NCTS014FB4
     C                   WRITE     NCTS014FB5
     C                   WRITE     NCTS014FB6
     C                   WRITE     NCTS014FB7
     C                   MOVE      '0'           *IN96
     C                   END
      *
      * Vareliste heading
     C                   Z-ADD     0             XLN
     C                   Z-ADD     0             XLNI              5 0
     C                   Z-ADD     0             XLINNR            5 0
     C                   Z-ADD     2             XSIDEN
     C                   WRITE     NCTS014V1
     C     THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C                   MOVE      '1'           *IN96
     C                   WRITE     NCTS014VB1
     C                   MOVE      '0'           *IN96
     C                   END
      *
     C     NCTSEHK0      SETLL     NCTSEC
     C     NCTSEHK0      READE     NCTSEC                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XLN
     C                   MOVE      XLN           TCLN
     C                   EXCEPT    UPDNCTSEC
      *
     C     NCTSEIK       CHAIN     NCTSECAM                           33
     C                   IF        *IN33
     C                   EVAL      TCKNS  = 0
     C                   EVAL      TCNAS  = *BLANKS
     C                   EVAL      TCAD1S = *BLANKS
     C                   EVAL      TCPNS  = *BLANKS
     C                   EVAL      TCPSS  = *BLANKS
     C                   EVAL      TCLKS  = *BLANKS
     C                   EVAL      TCTINS = *BLANKS
     C                   EVAL      TCCPS  = *BLANKS
     C                   EVAL      TCTLS  = *BLANKS
     C                   EVAL      TCEMS  = *BLANKS
     C                   EVAL      TCKNK  = 0
     C                   EVAL      TCNAK  = *BLANKS
     C                   EVAL      TCAD1K = *BLANKS
     C                   EVAL      TCPNK  = *BLANKS
     C                   EVAL      TCPSK  = *BLANKS
     C                   EVAL      TCLKK  = *BLANKS
     C                   EVAL      TCTINK = *BLANKS
     C                   END
      *
     C     NCTSEIK       SETLL     NCTSEI
     C     NCTSEIK       READE     NCTSEI                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XLNI
      *
     C                   EXSR      HENTOP
      *
     C                   EXSR      NYSIDE
      *
     C                   WRITE     NCTS014V2
     C     THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C                   WRITE     NCTS014VB2
     C                   END
      *
     C     NCTSEIK       READE     NCTSEI                                 33
     C                   ENDDO
      *
      *
     C     XLNI          IFEQ      THVPOS
     C*                  WRITE     NCTS014VD
     C     THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C                   MOVE      '1'           *IN96
     C*                  WRITE     NCTS014VBD
     C                   MOVE      '0'           *IN96
     C                   END
     C                   END
      *
     C     NCTSEHK0      READE     NCTSEC                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     PRINT4        BEGSR
      ***********************************************
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              DO                                                     1<-B
     C                   MOVE      KNAVN         XKNAVN
     C                   MOVE      ADR1          XKAD1
     C                   MOVE      ADR2          XKAD2
     C                   MOVE      *BLANKS       XKAD3
     C     POSTNR        IFEQ      0                                             2<-B
     C                   MOVEL     ADR3          XKAD3
     C                   ELSE                                                    2
     C                   MOVEL     POSTNR        XKAD3
     C                   MOVE      ADR3          XKAD3
     C                   END                                                     2<-E
     C                   END
     C     THPRO         CHAIN     TURER14                            33
     C                   MOVE      TUDTD         XUDTD
     C                   MOVE      TUDTM         XUDTM
     C                   MOVE      TUDTÅ         XUDTÅ
     C                   MOVE      TUKNA         YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         XANAVN           30
      *
     C     THFMLL        COMP      'J'                                    27
     C                   Z-ADD     0             XLN
     C                   Z-ADD     21            XANTL             2 0
     C                   Z-ADD     1             XSIDE             2 0
     C                   WRITE     NCTS014L1
      *
     C     NCTSEHK0      SETLL     TRUHL
     C     NCTSEHK0      READE     TRUHL                                  33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C     TLTLKU        COMP      'X'                                    28
     C     TRHLK         CHAIN(N)  HEADF                              99
     C     HEVS2         COMP      *BLANKS                                99
     C   99HEGM2         COMP      *BLANKS                                99
     C   99              ADD       1             XANTL
     C  N99              ADD       2             XANTL
     C     TLTXT         COMP      *BLANKS                                98
     C  N98              ADD       1             XANTL
     C     XANTL         IFGE      62                                            2<-B
     C  N99
     CAN 27XANTL         IFEQ      62                                             3<-B
     C                   WRITE     NCTS014L5
     C                   END                                                      3<-E
     C                   WRITE     NCTS014L6
     C                   ADD       1             XSIDE
     C                   WRITE     NCTS014L1
     C                   Z-ADD     22            XANTL
     C  N99              ADD       1             XANTL
     C                   END                                                     2<-E
     C                   ADD       1             XLN
     C                   WRITE     NCTS014L2
     C  N99              WRITE     NCTS014L3
     C  N98              WRITE     NCTS014L4
      *
     C     NCTSEHK0      READE     TRUHL                                  33
     C  N33              ENDDO                                                  1<-E
      *
     C   27XANTL         DOWLE     62                                           1<-B
     C                   WRITE     NCTS014L5
     C                   ADD       1             XANTL
     C                   END                                                    1<-E
     C                   WRITE     NCTS014L6
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYSIDE        BEGSR
      ***********************************************
     C                   ADD       1             XLINNR
     C*    XLINNR        IFGT      9
     C     XLINNR        IFGT      8
     C     THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C                   MOVE      '1'           *IN96
     C*                  WRITE     NCTS014VBD
     C                   MOVE      '0'           *IN96
     C                   END
     C                   Z-ADD     1             XLINNR
     C                   ADD       1             XSIDEN
     C                   WRITE     NCTS014V1
     C     THTET         IFEQ      1
     C     PRTTYP        ANDNE     'E'
     C                   MOVE      '1'           *IN96
     C                   WRITE     NCTS014VB1
     C                   MOVE      '0'           *IN96
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SJTOTS        BEGSR
      ***********************************************
      * FOR HVER POST TRENGES MINST 4 LINJER TIL DATA OG 4 SKILLELINJER.
     C                   MOVE      *ZEROS        XTOTL             5 0
     C                   Z-ADD     2             XSIDET
      *
     C     NCTSEHK0      SETLL     NCTSEC
     C     NCTSEHK0      READE(N)  NCTSEC                                 33
     C     *IN33         DOWEQ     '0'
      *
     C     NCTSEIK       SETLL     NCTSEI
     C     NCTSEIK       READE     NCTSEI                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       8             XTOTL             5 0
     C                   IF        XTOTL > 72
     C                   ADD       1             XSIDET
     C                   Z-ADD     8             XTOTL
     C                   END
     C     NCTSEIK       READE     NCTSEI                                 33
     C  N33              ENDDO
      *
     C     NCTSEHK0      READE(N)  NCTSEC                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     HENTOP        BEGSR
      ***********************************************
     C                   MOVE      '017'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C*                  MOVE      *BLANKS       XVEHT
     C                   MOVEL     TIPTY         YKODE
     C     TRK01K        CHAIN     TRKODL01                           33
     C*                  MOVE      TKTXTN        XVEHT
      *
     C                   SELECT
     C                   WHEN      TIUCR = *BLANKS AND TCUCR = *BLANKS
     C                   EVAL      TIUCR = THUCR
     C                   WHEN      TIUCR = *BLANKS
     C                   EVAL      TIUCR = TCUCR
     C                   ENDSL
     C                   SELECT
     C                   WHEN      TIPDRF = *BLANKS AND TCPDRF = *BLANKS
     C                   EVAL      TIPDRF = THPDRF
     C                   WHEN      TIPDRF = *BLANKS
     C                   EVAL      TIPDRF = TCPDRF
     C                   ENDSL
     C                   SELECT
     C                   WHEN      TISDRF = *BLANKS AND TCSDRF = *BLANKS
     C                   EVAL      TISDRF = THSDRF
     C                   WHEN      TISDRF = *BLANKS
     C                   EVAL      TISDRF = TCSDRF
     C                   ENDSL
     C                   SELECT
     C                   WHEN      TITDRF = *BLANKS AND TCTDRF = *BLANKS
     C                   EVAL      TITDRF = THTDRF
     C                   WHEN      TITDRF = *BLANKS
     C                   EVAL      TITDRF = TCTDRF
     C                   ENDSL
     C                   SELECT
     C                   WHEN      TIADRF = *BLANKS AND TCADRF = *BLANKS
     C                   EVAL      TIADRF = THADRF
     C                   WHEN      TIADRF = *BLANKS
     C                   EVAL      TIADRF = TCADRF
     C                   ENDSL
     C                   SELECT
     C                   WHEN      TIAITX = *BLANKS AND TCAITX = *BLANKS
     C                   EVAL      TIAITX = THAITX
     C                   WHEN      TIAITX = *BLANKS
     C                   EVAL      TIAITX = TCAITX
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    PRTTYP            1
     C                   PARM                    PRTAVD            4
     C                   PARM                    PRTTDN            7
     C     prttyp        comp      'E'                                    50
     C     NCTSEHK0      KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     NCTSEH06K     KLIST
     C                   KFLD                    UWS
     C                   KFLD                    XST
     C                   MOVE      'K'           XST               1
     C     TRHLK         KLIST
     C                   KFLD                    TLAVD2
     C                   KFLD                    TLTDN2
     C     NCTSEIK       KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    TCLI
     C     NCTSESTDK     KLIST
     C                   KFLD                    UAVD
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     HEADFK        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     FRIKEY        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    FSKODE
     C                   MOVE      '*CE'         FSKODE
     C     KODKEY        KLIST
     C                   KFLD                    WOPUNI
     C                   KFLD                    WOPAVD
     C                   KFLD                    WOPLNR
     C     KODKEYU1      KLIST
     C                   KFLD                    THSG
     C                   KFLD                    WOPLNR
     C     KODS2K        KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YKN
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    THAVD
     C     EDIM2K        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    M0068A
     C                   MOVE      99999999      M0068A
      *
     C                   GOTO      STINI2
     C     STINIT        TAG
     C                   CALL      'QRCVDTAQ'
     C                   PARM                    UDTAQ
     C                   PARM                    ULIBL
     C                   PARM                    ULENGT
     C                   PARM                    UDTA
     C                   PARM                    UWAIT
      *
     C                   MOVE      UDTA          DTDTA
     C                   MOVE      DTWS          UWS              10
      *** UIN39=0 -> KOMMER FRA TOLLDE.REGISTRERING    (U4 I S/36)
      *** UIN39=1 -> KOMMER FRA KOMMUNIKASJON
     C                   MOVE      DTIN39        *IN39
     C     STINI2        TAG
     C     PRTTYP        IFEQ      'M'
     C     PRTTYP        OREQ      'E'
     C                   MOVE      PRTAVD        UAVD              4 0
     C                   ELSE
     C     NCTSEH06K     SETLL     NCTSEH06
     C     NCTSEH06K     READE     NCTSEH06                               33
     C   33              GOTO      STINIT
     C                   MOVE      THAVD         UAVD              4 0
     C                   END
     C     NCTSESTDK     CHAIN     NCTSESTD                           33
     C                   MOVE      'P'           WOPUNI
      *
     C                   MOVE      'A'           KOAUNI
     C                   MOVE      'S2 '         KS2UNI
     C                   MOVE      *BLANKS       XTAR              3
     C                   MOVE      *ZEROS        THAVD
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *ZEROS        YKN               8 0
     C     *LIKE         DEFINE    KOPAVD        WOPAVD
     C     *LIKE         DEFINE    KOPUNI        WOPUNI
     C     *LIKE         DEFINE    KOPLNR        WOPLNR
     C                   Z-ADD     0             WOPAVD
     C                   Z-ADD     0             WOPLNR
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
     C                   MOVE      WTM           XTID              6 0
      *
     C                   ENDSR
      ***********************************************
     C     OVRF          BEGSR
      ***********************************************
      *  inger bruker ved arkivering
      *
     C     dtuser        ifeq      *blanks
     C                   eval      dtuser='ARKIV'
     c                   end
     C                   MOVE      '0'           *IN97
      * Printerstyring for hovedark (A)   (ordinær TETN overlay)
     C                   Z-ADD     THAVD         WOPAVD
     C                   Z-ADD     98            WOPLNR
     C     KODKEYU1      CHAIN     KODTPUSR                           33
     C  N33KOPNVN        COMP      '*STD'                                 33
     C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       PFFM1
     C                   MOVE      *BLANKS       PFFM2
     C                   MOVE      *BLANKS       PFFM3
     C                   MOVE      *ZEROS        XFMPOS            3 0
     C                   MOVE      *ZEROS        XFMPOV            3 0
     C     *IN33         IFEQ      '1'
     C                   MOVE      '1'           *IN97
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   MOVE      *BLANKS       KOPTY
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C     KOPFM         READE     KODTFM                                 33
     C     *IN33         IFEQ      '1'
     C     KFMT1         OREQ      *BLANKS
     C                   MOVE      '1'           *IN97
     C                   ELSE
     C                   MOVE      KFMT1         PFFM1
     C                   MOVE      KFMT2         PFFM2
     C                   MOVE      KFMT3         PFFM3
     C                   Z-ADD     KFMPOS        XFMPOS
     C                   END
     C                   ENDIF
     C                   IF        PRTTYP = 'E'
     C                   EVAL      KOPNVN = 'OUTMAIL'
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
      *
      * VED PDF
      *
     C     KOPLAS        IFEQ      'P'
     C     KOPLAS        OREQ      'F'
     C     DTUSER        OREQ      'ARKIV'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     C                   CAT       XCMDPDF2:1    UCMD
     c                   move      *blanks       FMOVL            20
     c                   eval      FMOVL='FRONTMGN(0.14 0.16)'                  PDF(LIKT SAD IMP)
     C                   CAT       FMOVL:1       UCMD
     C                   CAT       XCMD21P:1     UCMD
     C                   seton                                            50
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   END
     C                   CAT       DTUSER:0      UCMD
     C     KOPCOPI       IFEQ      *BLANKS
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XHNTTD:0      UCMD
     C                   end
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPDRAW       ifne      *blanks
     c                   move      *blanks       FDRAW            20
     c                   eval      FDRAW='DRAWER('                              PDF
     C                   CAT       KOPDRAW:0     FDRAW
     C                   CAT       ')':0         FDRAW
     C                   CAT       FDRAW:1       UCMD
     C                   END
     C     KOPCOPI       ifne      *blanks
     c                   move      *blanks       FDCOP            20
     c                   eval      FDCOP='COPIES('                              PDF
     C                   CAT       KOPCOPI:0     FDCOP
     C                   CAT       ')':0         FDCOP
     C                   CAT       FDCOP:1       UCMD
     C                   END
      *OUTBIN(&DRAWUT) utskuff
     C     KOPOUTB       ifne      *blanks
     c                   move      *blanks       FDOUT            20
     c                   eval      FDOUT='OUTBIN('                              PDF
     C                   CAT       KOPOUTB:0     FDOUT
     C                   CAT       ')':0         FDOUT
     C                   CAT       FDOUT:1       UCMD
     C                   END
     C                   CALL      'QCMDEXC'                            34
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      * Printerstyring for hovedark (B)   (ordinær TETN overlay)
     C                   MOVE      *BLANKS       PFFM12
     C                   MOVE      *BLANKS       PFFM22
     C                   MOVE      *BLANKS       PFFM32
     C     *IN33         IFEQ      '0'
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   MOVE      KFMT1         PFFM12
     C                   MOVE      KFMT2         PFFM22
     C                   MOVE      KFMT3         PFFM32
     C                   END
     C                   ENDIF
     C                   IF        PRTTYP = 'E'
     C                   EVAL      KOPNVN = 'OUTMAIL'
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD12        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPLAS        IFEQ      'P'
     C     KOPLAS        OREQ      'F'
     C     DTUSER        OREQ      'ARKIV'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     C                   CAT       XCMDPDF2:1    UCMD
     c                   move      *blanks       FMOVL            20
     c                   eval      FMOVL='FRONTMGN(0.14 0.16)'                  PDF(LIKT SAD IMP)
     C                   CAT       FMOVL:1       UCMD
     C                   CAT       XCMD21P:1     UCMD
     C                   seton                                            50
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   END
     C                   CAT       DTUSER:0      UCMD
     C     KOPCOPI       IFEQ      *BLANKS
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XHNTTD:0      UCMD
     C                   end
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPDRAW       ifne      *blanks
     c                   move      *blanks       FDRAW            20
     c                   eval      FDRAW='DRAWER('                              PDF
     C                   CAT       KOPDRAW:0     FDRAW
     C                   CAT       ')':0         FDRAW
     C                   CAT       FDRAW:1       UCMD
     C                   END
     C     KOPCOPI       ifne      *blanks
     c                   move      *blanks       FDCOP            20
     c                   eval      FDCOP='COPIES('                              PDF
     C                   CAT       KOPCOPI:0     FDCOP
     C                   CAT       ')':0         FDCOP
     C                   CAT       FDCOP:1       UCMD
     C                   END
      *OUTBIN(&DRAWUT) utskuff
     C     KOPOUTB       ifne      *blanks
     c                   move      *blanks       FDOUT            20
     c                   eval      FDOUT='OUTBIN('                              PDF
     C                   CAT       KOPOUTB:0     FDOUT
     C                   CAT       ')':0         FDOUT
     C                   CAT       FDOUT:1       UCMD
     C                   END
     C                   CALL      'QCMDEXC'                            34
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
      * Printerstyring for lasteliste
     C                   Z-ADD     THAVD         WOPAVD
     C                   Z-ADD     95            WOPLNR
     C     KODKEYU1      CHAIN     KODTPUSR                           33
     C  N33KOPNVN        COMP      '*STD'                                 33
     C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       PLFM1            75
     C                   MOVE      *BLANKS       PLFM2            75
     C                   MOVE      *BLANKS       PLFM3            75
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   MOVE      *BLANKS       KOPTY
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   MOVE      KFMT1         PLPFM1
     C                   MOVE      KFMT2         PLPFM2
     C                   MOVE      KFMT3         PLPFM3
     C                   END
     C                   ENDIF
     C                   IF        PRTTYP = 'E'
     C                   EVAL      KOPNVN = 'OUTMAIL'
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD16        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD23:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C     KOPCOPI       IFEQ      *BLANKS
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XHNTLL:0      UCMD
     C                   END
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPDRAW       ifne      *blanks
     c                   move      *blanks       FDRAW            20
     c                   eval      FDRAW='DRAWER('                              PDF
     C                   CAT       KOPDRAW:0     FDRAW
     C                   CAT       ')':0         FDRAW
     C                   CAT       FDRAW:1       UCMD
     C                   END
     C     KOPCOPI       ifne      *blanks
     c                   move      *blanks       FDCOP            20
     c                   eval      FDCOP='COPIES('                              PDF
     C                   CAT       KOPCOPI:0     FDCOP
     C                   CAT       ')':0         FDCOP
     C                   CAT       FDCOP:1       UCMD
     C                   END
      *OUTBIN(&DRAWUT) utskuff
     C     KOPOUTB       ifne      *blanks
     c                   move      *blanks       FDOUT            20
     c                   eval      FDOUT='OUTBIN('                              PDF
     C                   CAT       KOPOUTB:0     FDOUT
     C                   CAT       ')':0         FDOUT
     C                   CAT       FDOUT:1       UCMD
     C                   END
     C                   CALL      'QCMDEXC'                            34
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
      * Printerstyring for vareliste (A)  (ingen overlay)
     C                   Z-ADD     THAVD         WOPAVD
     C                   Z-ADD     99            WOPLNR
     C     KODKEYU1      CHAIN     KODTPUSR                           33
     C  N33KOPNVN        COMP      '*STD'                                 33
     C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       PVFM1            75
     C                   MOVE      *BLANKS       PVFM2            75
     C                   MOVE      *BLANKS       PVFM3            75
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   MOVE      *BLANKS       KOPTY
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   MOVE      KFMT1         PVFM1
     C                   MOVE      KFMT2         PVFM2
     C                   MOVE      KFMT3         PVFM3
     C                   Z-ADD     KFMPOS        XFMPOV
     C                   END
     C                   ENDIF
     C                   IF        PRTTYP = 'E'
     C                   EVAL      KOPNVN = 'OUTMAIL'
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD13        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPLAS        IFEQ      'P'
     C     KOPLAS        OREQ      'F'
     C     DTUSER        OREQ      'ARKIV'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     c                   move      *blanks       FMOVL            20
     c                   eval      FMOVL='FRONTMGN(0.14 0.16)'                  PDF(LIKT SAD IMP)
     C                   CAT       FMOVL:1       UCMD
     C                   CAT       XCMD22:1      UCMD
     C                   seton                                            50
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   CAT       XCMD22:1      UCMD
     C                   END
     C                   CAT       DTUSER:0      UCMD
     C     KOPCOPI       IFEQ      *BLANKS
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XHNTTD:0      UCMD
     C                   END
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPDRAW       ifne      *blanks
     c                   move      *blanks       FDRAW            20
     c                   eval      FDRAW='DRAWER('                              PDF
     C                   CAT       KOPDRAW:0     FDRAW
     C                   CAT       ')':0         FDRAW
     C                   CAT       FDRAW:1       UCMD
     C                   END
     C     KOPCOPI       ifne      *blanks
     c                   move      *blanks       FDCOP            20
     c                   eval      FDCOP='COPIES('                              PDF
     C                   CAT       KOPCOPI:0     FDCOP
     C                   CAT       ')':0         FDCOP
     C                   CAT       FDCOP:1       UCMD
     C                   END
      *OUTBIN(&DRAWUT) utskuff
     C     KOPOUTB       ifne      *blanks
     c                   move      *blanks       FDOUT            20
     c                   eval      FDOUT='OUTBIN('                              PDF
     C                   CAT       KOPOUTB:0     FDOUT
     C                   CAT       ')':0         FDOUT
     C                   CAT       FDOUT:1       UCMD
     C                   END
     C                   CALL      'QCMDEXC'                            34
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
      * Printerstyring for vareliste (B)
     C                   MOVE      *BLANKS       PVFM12           75
     C                   MOVE      *BLANKS       PVFM22           75
     C                   MOVE      *BLANKS       PVFM32           75
     C     *IN33         IFEQ      '0'
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   MOVE      KFMT1         PVFM12
     C                   MOVE      KFMT2         PVFM22
     C                   MOVE      KFMT3         PVFM32
     C                   END
     C                   ENDIF
     C                   IF        PRTTYP = 'E'
     C                   EVAL      KOPNVN = 'OUTMAIL'
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD14        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPLAS        IFEQ      'P'
     C     KOPLAS        OREQ      'F'
     C     DTUSER        OREQ      'ARKIV'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     c                   move      *blanks       FMOVL            20
     c                   eval      FMOVL='FRONTMGN(0.14 0.16)'                  PDF(LIKT SAD IMP)
     C                   CAT       FMOVL:1       UCMD
     C                   CAT       XCMD22:1      UCMD
     C                   seton                                            50
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   CAT       XCMD22:1      UCMD
     C                   END
     C                   CAT       DTUSER:0      UCMD
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPDRAW       ifne      *blanks
     c                   move      *blanks       FDRAW            20
     c                   eval      FDRAW='DRAWER('                              PDF
     C                   CAT       KOPDRAW:0     FDRAW
     C                   CAT       ')':0         FDRAW
     C                   CAT       FDRAW:1       UCMD
     C                   END
     C     KOPCOPI       ifne      *blanks
     c                   move      *blanks       FDCOP            20
     c                   eval      FDCOP='COPIES('                              PDF
     C                   CAT       KOPCOPI:0     FDCOP
     C                   CAT       ')':0         FDCOP
     C                   CAT       FDCOP:1       UCMD
     C                   END
      *OUTBIN(&DRAWUT) utskuff
     C     KOPOUTB       ifne      *blanks
     c                   move      *blanks       FDOUT            20
     c                   eval      FDOUT='OUTBIN('                              PDF
     C                   CAT       KOPOUTB:0     FDOUT
     C                   CAT       ')':0         FDOUT
     C                   CAT       FDOUT:1       UCMD
     C                   END
     C                   CALL      'QCMDEXC'                            34
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   ENDSR
      *=====================================================================
      *  Oppdater arkivfil
      *=====================================================================
     C     arkivsr       begsr
      *=====================================================================
     C                   IF        ARKIVER <> 'X'
      *
     C                   move      'N'           arkiver           1
     C     KEYARK        KLIST
     C                   KFLD                    ARTYPE
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPD
     C                   clear                   arkivr
     C                   MOVE      'te'          ARTYPE
     C                   MOVE      THAVD         ARAVD
     C                   MOVE      THTDN         AROPD
     C     keyark        chain     arkivl03                           33
     C     *IN33         IFEQ      '1'
     C     FIFIRM        CHAIN     FIRMARC                            33
     C     *IN33         IFEQ      '0'
     C     'te'          chain     arktxt                             33
     C     *IN33         IFEQ      '0'
     C     arkjn         andeq     'J'
      *
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      'S'           ARUNDE
     C                   MOVEl     THPRO         ARUNDE
     C                   MOVE      UUSER         ARUSER
     C                   MOVE      WDT           ARDATE
     C                   MOVE      WTM           ARTIME
     C                   MOVE      THKNK         ARKUND
     C     HEADFK        CHAIN(N)  HEADF                              33
     c*    arkund        ifeq      0
     c  N33arkund        ifeq      0
     c                   move      heknk         arkund
     c                   end
     C                   WRITE     ARKIVR
     C                   move      'J'           arkiver           1
     C                   END
     C                   END
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *
      *
     ONCTSEHR   E            UPDNCTSEH
     O                       THST
     O                       THWS
     ONCTSECR   E            UPDNCTSEC
     O                       TCLN
