      *********************************************************************
      * UPLOAD DIREKTE
      *********************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
********************************************************************
     FFRISOL01  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FHEADF     IF   E           K DISK
     FSADH      IF   E           K DISK
     FSAEH      IF   E           K DISK
     FTRIH      IF   E           K DISK
     FTRUH      IF   E           K DISK
     FARCA000Dd CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
      * CURSOR LOKASJON på skjermen totalt
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      * CURSOR LOKASJON AV AKTIV VINDU
     D  WSCLOW               382    383B 0
     D                 DS
     D  DATA                   1     66
     D  DATA1                  4     66
     D  DATA3                  1      3
     D  TG2                    6     14
     D                 DS
     D  STRING                 1     20
     D  WSAVD                  1      4  0
     D  WSOPD                  5     11  0
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS
     D  ARTXT                  1     15
     D  ARTXT1_7               1      7                                         *SPLIT*
     D  ARTXT1_3               1      3                                         *F*
     D                 DS
     D  WSBAR                  1     22
     D  BAR                    1     22
     D                                     DIM(22)
     D  WSBAR05                1     05
     D  WSBAR06                1     06
     D  WSBAR07                1     07
     D  WSBAR08                1     08
     D  WSBAR09                1     09
     D  WSBAR10                1     10
     D  WSBAR11                1     11
     D  WSBAR12                1     12
     D  WSBAR13                1     13
     D  WSBAR14                1     14
     D  WSBAR15                1     15
     D  WSBAR16                1     16
     D  WSBAR17                1     17
     D  WSBAR18                1     18
     D  WSBAR19                1     19
     D  WSBAR20                1     20
     D  WSBAR21                1     21
     D  WSBAR22                1     22
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D  xDATO                  7     14  0
      *
     D                UDS
     D  UFIRM                  3      4
      *
     C                   EXSR      INIT
      *
      *
     c     start         tag
      **
     C                   EXFMT     WINDOW
     C                   setoff                                       30
     C                   setoff                                       707172
     C     WSCLOW        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * avbryt
     C     *IN12         CABEQ     '1'           Slutt                            B2
     c
      * søk type
     c     *in04         IFEQ      '1'
     c                   move      uutype        type
     c                   CALL      'ARCA000B'
     C                   PARM                    TYPE
     C                   goto      start
     c                   end
      * tester type
     C     Type          Chain     arktxt                             33
     c  n33              movel     ARSBAN        SCABAN           40
     c     SCABAN        comp      *blanks                                30
     c     *in30         ifeq      *on
     C                   MOVE      'JOV1509'     MSGNR
     c                   z-add     3             LinNbr
     c                   z-add     9             PosNbr
     c                   seton                                        70
     c                   goto      start
     c                   end
      * tester fri søkevei
     c     wsextr        ifne      *blanks
     C     frikey1       Chain     frisol01                           30
     C   30frikey2       Chain     frisol01                           30
     c     *in30         ifeq      '0'
     C                   move      fsavd         wsavd
     C                   move      fsopd         wsopd
     C                   else
     C                   MOVE      'SHU2065'     MSGNR
     c                   z-add     6             LinNbr
     c                   z-add     13            PosNbr
     c                   seton                                        72
     c                   goto      start
     c                   end
     c                   end
      * tester oppdrag
     C     headfk        Chain     headf                              30
     C   30HEADFK        Chain     SADH                               33
     C   30HEADFK        Chain     SAEH                               33
     C   30HEADFK        Chain     TRIH                               33
     C   30HEADFK        Chain     TRUH                               33
     c     *in30         ifeq      *on
     C                   MOVE      'SPO0001'     MSGNR
     c                   z-add     4             LinNbr
     c                   z-add     13            PosNbr
     c                   seton                                        71
     c                   goto      start
     c                   end
      * Upload  (det MÅ da være BANE knyttet til typen)
     c     *in10         IFEQ      '1'
     c                   exsr      Upload
     c                   goto      slutt
     c                   end
      *
     c                   goto      start
      *
     c*
      *
     C     Slutt         tag
     C                   close     arca000dd
     C                   EVAL      *inlr = *on
     C                   RETURN
     C***********************************************
     C     Upload        BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Laste opp dokument til SYSPED "ar'
     C                             +'kivagent" (1-3 min/ferdig arkivert)'
     C                   EVAL      WebType = 'ESPEA'
     c                   eval      WSBAR = type+%trim(String)
     C                   EVAL      WebSok  = '&dok='+%trim(WSBAR)+
     C                             '&bane='+%trim(SCABAN)
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C                   ENDSR
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          BEGSR
     C     *entry        PLIST
     C                   PARM                    Type              2
      *
      *
     C     frikey1       KLIST
     C                   KFLD                    FRIKOD1           3
     C                   KFLD                    WSEXTR
     c                   move      '*CR'         FRIKOD1
      *
     C     frikey2       KLIST
     C                   KFLD                    FRIKOD2           3
     C                   KFLD                    WSEXTR
     c                   move      '*CE'         FRIKOD2
      *
     C     Headfk        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
      *
     C                   open      arca000dd
      * Foreslå dft 'Z ' - ved søk kommer en da rett på...
     c                   move      type          uutype            2
     c     Type          ifeq      *blanks
     c     Type          oreq      '*T'
     C                   MOVE      'Z '          Type
     c                   endif
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     10            POSNBR
      *
     c                   move      *zeros        wsavd
     c                   move      *zeros        wsopd
      *
     c     *loval        setll     FIRM
     c                   read      FIRM
      *
     C                   ENDSR
      *
