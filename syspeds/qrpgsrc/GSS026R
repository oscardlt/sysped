********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 1. IKKE KRAV PÅ MÅL VED IKKE-FLYSENDING
      *              2. F10 -> HENT VEKT FRA ORDRE TIL BOKS
10172 * 02 SH  PTF10 norsk text til Track and trace
10XXX * 03 YBC PTF10 NYTT PARAMETER VED KALL PÅ GSS031R
********************************************************************
      *
      **************************************************************
      *** PROGRAM for å SKRIVE UT BOKS-SORTERT PAKKSEDDEL - MERKELAPP
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      **************************************************************
     FGSSOLL01  UF   E           K DISK
     FGSSOLF    UF   E           K DISK    RENAME(GSSOLFR:GSSOLFR00)
     FGSSPOF    IF   E           K DISK
     FGSSORF    UF   E           K DISK
     FGSSORL21  IF   E           K DISK    RENAME(GSSORFR:GSSORFR21)
     FGSSLGF    O    E             DISK
     FGSSTRF    UF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FGSSPAF    IF   E           K DISK
     FGSSGDF    IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FGSSSTK    IF   E           K DISK
     FGSSBXF    UF A E           K DISK
     FCUNDL01   IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FVADR      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FGSSRFF    IF   E           K DISK
     FTELL      UF   E           K DISK
     FHEADF     IF A E           K DISK
     FDISP      O  A E             DISK
     FTRACKF    O    E             DISK
     FGSS026P   O    E             PRINTER OFLIND(*IN27)
     F                                     USROPN
     FGSS026PW  O    E             PRINTER OFLIND(*IN26)
     F                                     USROPN
     FGSS026D   CF   E             WORKSTN
     F                                     USROPN
     FGSS026WF  IF A E           K DISK    USROPN
     FLISTE     O    F   36        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D BX              S              3  0 DIM(999)                             INPUT STRING
     D BXV             S              7  1 DIM(999)                             INPUT STRING
     D BXL             S              4  0 DIM(999)                             INPUT STRING
     D BXB             S              4  0 DIM(999)                             INPUT STRING
     D BXH             S              4  0 DIM(999)                             INPUT STRING
     D BXC             S             17    DIM(999)                             OUTPUT STRING
      * BXK er volum fra PO-en (når alt lastet i kasse 999=ikke kasse)
     D BXK             S              5  2 DIM(999)                             OUTPUT STRING
     D BXF             S              1    DIM(999)                             OUTPUT STRING
      * BX3/BXM er M3 /LM fra DDS (når lastet i kasse 901.. =BIL/UNIT)
     D BX3             S              6  3 DIM(999)                             OUTPUT STRING
     D BXM             S              4  2 DIM(999)                             OUTPUT STRING
     D A6              S              1    DIM(6)                               INPUT STRING
     D B6              S              1    DIM(6)                               OUTPUT STRING
     D CN              S             17    DIM(9)                               CONTAINERNR
N01  D VON             S              7  0 DIM(1000)                            ORDRENR
N01  D VCL             S              5  0 DIM(1000)                            ANTALL KOLLI
     D                 DS
     D  DATA                   1     36
     D  DATA1                  4     36
     D  DATA3                  1      3
     D UCMD            DS          1024
     D                 DS
     D XCMD01          C                   CONST('OVRPRTF -
     D                                     FILE(LISTE) -
     D                                     OUTQ(')
     D XCMD02          C                   CONST('PAGESIZE(73 132) -
     D                                     CPI(10) -
     D                                     OVRFLW(73)')
     D XXTXT01         C                   CONST('Printed packinglist (BOX).')
     D XXTXT02         C                   CONST('Packinglist No.')
N02  D XXTXT01L        C                   CONST('Skrevet pakkliste (BOX).')
N02  D XXTXT02L        C                   CONST('Pakkliste Nr.')
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH00,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D XVESSEL         C                   CONST('VESSEL:')
     D XCLIENT         C                   CONST('CLIENT:')
     D XBOX            C                   CONST('BOX-NO:')
     D XVEKT           C                   CONST('WEIGHT:')
     D XMÅL            C                   CONST('DIM:')
     D XCUBE           C                   CONST('CUBE:')
     D XCONTID         C                   CONST('ID:')
     D PARTTXT         C                   CONST('*PARTIAL DELIVERY*')
     D COMMTXT         C                   CONST('COMMENTS........: ')
     D                 DS
     D  XPRE                   1      3
     D  WSBOX                  4      9  0
     D  XBOXID                 1      9
     D                 DS
     D  LANUMA                 1      6  0
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(GSS026P) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(72 120) -
     D                                     CPI(15) -
     D                                     OVRFLW(61)')
     D XCMD31          C                   CONST('OVRPRTF -
     D                                     FILE(GSS026P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*scs) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     OVRFLW(61) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(OUTMAIL) -
     D                                     FORMTYPE(*STD)')
     D                 DS
     D  XTIME                  1     14  0
     D  XTID4                  1      4  0
     D  XDAG                   7      8  0
     D  XMND                   9     10  0
     D  XAAR                  11     14  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  TRDTLÅ                 1      4  0
     D  TRDTLM                 5      6  0
     D  TRDTLD                 7      8  0
     D  TRDTL                  1      8  0
     D                 DS
     D  XTDTLD                 1      2  0
     D  XTDTLM                 3      4  0
     D  XTDTLÅ                 5      6  0
     D  XTDTL                  1      6  0
     D                 DS
     D  TRDTSÅ                 1      4  0
     D  TRDTSM                 5      6  0
     D  TRDTSD                 7      8  0
     D  TRDTS                  1      8  0
     D                 DS
     D  XTDTSD                 1      2  0
     D  XTDTSM                 3      4  0
     D  XTDTSÅ                 5      6  0
     D  XTDTS                  1      6  0
     D                 DS
     D  OLLC                   1     20
     D  XLLC                   1      6
     D                 DS
     D  POCONO                 1     20
     D  XOCONO                 1     14
     D                 DS
     D  ORCLI                  1      5  0
     D  XRCLI                  4      5  0
     D                 DS
     D  TRMFT1                 1     70
     D  XWMFT1                 1     30
     D                 DS
     D  TRMFT2                 1     70
     D  XWMFT2                 1     30
     D                 DS
     D  ORSNM                  1     30
     D  XWSNM                  1     13
     D                 DS
     D  ORDSC                  1     30
     D  XWDSC                  1     16
     D                 DS
     D  ORFT4                  1     30
     D  ORAREA                 1      2
     D  ORLMA                 11     14
     D                 DS
     D  WSNYEV                 1      3
     D  WSPOACK                1      1
     D  WSKLDET                2      2
     D  WSM3LM                 3      3
     D                 DS
     D  TRFT4                  1     70
     D  TRPOACK               70     70
     D  TRKLDET               69     69
     D  TRM3LM                68     68
     D                 DS
     D  OLMN                   1     35
     D  OLMNPRE                1      3
     D  OLMN01                 1      1
     D  OLMN02                 1      2
     D  OLMN03                 3      4
     D  OLMN04                 5     35
     D                 DS
     D  XFT11                  1     10
     D  XFT12                 13     27
     D  WSFT1                  1     70
     D                 DS
     D  XFT21                  1     10
     D  XFT22                 13     19
     D  XFT23                 20     20
     D  XFT24                 21     28
     D  XFT25                 13     27
     D  WSFT2                  1     70
     D                 DS
     D XFT01           C                   CONST('DEL. BY:')
     D XFT02           C                   CONST('TRUCK NO:')
     D XFT03           C                   CONST('AWBNO:')
     D                UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UBIUSI               101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
     D  UFT1                 201    270
     D  UFT2                 271    340
     D  UWCNAM               544    573
     D  UWFAXN               574    588
     D  UWRET                591    596
     D  UWTIME               598    603  0
     D  UWDATE               606    611  0
     D  UCOVP                612    612
     D  UCOV01               613    652
     D  UCOV02               653    692
     D  UCOV03               693    732
     D  UCOV04               733    772
     D  UCOV05               773    812
     D  UCOV06               813    852
     D  UCOV07               853    892
     D  UCOV08               893    932
     D  UEMAIL               933   1002
     D  Uemailj             1003   1003
      *
     C                   EXSR      INIT
      *
     C                   EXSR      FINNBOX
     C                   IF        ((XWEBMAN = 'N') AND (USORT = 'F'))
     C                   EXSR      SORTCONT
     C                   END
      * NÅR *IN60= *On etter finnboks betyr det at boksnr 901,902.. er
      * involvert... lasting av BIL etter BOX-prinsipp (en Box er en BIL).
      *
      * Behandle en og en boks. (dummy neg. nr er sluttflagg)
     C                   MOVE      *BLANKS       XGMLCNR          17
     C                   MOVE      *ZEROS        CTOTBOX
     C                   MOVE      *ZEROS        CTOTVKT
     C                   MOVE      *ZEROS        CTOTM3
     C     1             DO        999           NR
     C   32              IF        ((XGMLCNR<>BXC(NR)) AND (XGMLCNR<>*BLANKS))
     C                   WRITE     GSS026PTC
     C                   MOVE      BXC(NR)       XGMLCNR
     C                   MOVE      *ON           *IN27
     C                   EXSR      OVERFLOW
     C                   MOVE      *ZEROS        CTOTBOX
     C                   MOVE      *ZEROS        CTOTVKT
     C                   MOVE      *ZEROS        CTOTM3
     C                   ELSE
     C                   MOVE      BXC(NR)       XGMLCNR
     C                   END
     C     BX(NR)        IFLT      0
     C                   GOTO      UTBOX
     C                   END
     C     NR            DIV       15            XNR               3 0
     C                   MVR                     XNR
     C                   IF        XNR = 0
     C                   CLOSE     LISTE
     C                   OPEN      LISTE
     C                   END
     C                   ADD       1             CTOTBOX
     C                   EXSR      ENBOX
     C                   END
      *
     C     UTBOX         TAG
      *
      * BUNN-TOTAL...
     C     USORT         IFNE      'P'
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PT
     C                   ELSE
     C                   WRITE     GSS026WT
     C                   END
     C                   IF        WSCONT = 'N'
     C     TRST          IFLT      '2'
     C     UTNO          CHAIN     GSSTRF                             33
     C  N33              MOVE      '2'           TRST
     C  N33              MOVE      XIDAG         TRDTP
     C  N33              UPDATE    GSSTRFR
     C                   MOVE      TRST          USORT
     C                   END
     C                   EXSR      OPDLOGG
     C                   END
      * OPPDATER STATUS PÅ ORDRE MED GAMLE BOXNR
     C                   IF        WSCONT = 'Y'
     C                   EXSR      PRTINV
     C                   ELSE
     C     UTNO          SETLL     GSSORL21
     C     UTNO          READE     GSSORL21                               33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   IF        ORST = '1'                                    2<-B
     C     ORONO         CHAIN     GSSORF                             33
     C  N33              IF        ((TRBCD = *BLANKS) OR                          3<-B
     C                             ((TRLOCF <> *BLANKS) AND
     C                               (TRLOCT <> *BLANKS)))
     C                   MOVE      ORLC2         ORLC3
     C                   MOVE      ORLC          ORLC2
     C                   MOVE      'ONWAY'       ORLC
     C                   MOVE      ORDTL2        ORDTL3
     C                   MOVE      ORDTL         ORDTL2
     C                   MOVE      TRDTL         ORDTL
     C                   END                                                      3<-E
     C  N33              MOVE      '2'           ORST
     C  N33              UPDATE    GSSORFR
     C                   END                                                     2<-E
     C     UTNO          READE     GSSORL21                               33
     C                   ENDDO                                                  1<-E
     C                   END
      *
     C                   END
      *
     C                   IF        XWEBMAN = 'N'
     C                   CLOSE     GSS026P
     C                   ELSE
     C                   CLOSE     GSS026PW
     C                   END
     C     UMOD          IFNE      '5'
     C     UMOD          ANDNE     'W'
     C                   CLOSE     GSS026D
     C                   END
     C     UMOD          IFEQ      '5'
     C                   EXSR      SNDFAX
     C                   END
      *
     C                   IF        USORT = '2'
     C                   EXSR      OPDBOXNR
     C                   END
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *
      *
      ***********************************************
     C     OPDBOXNR      BEGSR
      ***********************************************
     C     UTNO          SETLL     GSSORL21
     C     UTNO          READE     GSSORL21                               33
     C                   DOW       *IN33 = *OFF
     C     ORONO         CHAIN     GSSORF                             33
     C                   MOVE      *ZEROS        ORCLNF
     C                   MOVE      *ZEROS        ORCLNT
      *
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE(N)  GSSOLF                                 33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      ORCLNF = 0
     C                   MOVE      OLBOX         ORCLNF
     C                   WHEN      ((OLBOX <> 0) AND (OLBOX < ORCLNF))
     C                   IF        ORCLNT = 0
     C                   MOVE      ORCLNF        ORCLNT
     C                   END
     C                   MOVE      OLBOX         ORCLNF
     C                   WHEN      OLBOX > ORCLNF
     C                   IF        OLBOX > ORCLNT
     C                   MOVE      OLBOX         ORCLNT
     C                   END
     C                   ENDSL
     C     ORONO         READE(N)  GSSOLF                                 33
     C                   ENDDO
      *
     C                   UPDATE    GSSORFR
     C     UTNO          READE     GSSORL21                               33
     C                   ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     ENBOX         BEGSR
     C***********************************************
      *
     C                   MOVE      BX(NR)        OLBOX
     C                   EXSR      BOXLAPP
     C     BXF(NR)       CABEQ     '*'           SLENBOX
      *
     C     FØRSTE        IFEQ      'J'
     C                   Z-ADD     1             SIDENR
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PA
     C                   ELSE
     C                   WRITE     GSS026WA
     C                   END
     C                   MOVE      'N'           FØRSTE
     C                   MOVEA     '00'          *IN(26)
     C                   END
     C     WSCID         COMP      *BLANKS                            2929
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   EXSR      HENTCLNR
     C                   WRITE     GSS026PA2
     C                   ELSE
     C                   WRITE     GSS026WA2
     C                   END
      *
     c     *IN60         ifeq      '1'
     c                   ADD       900           OLBOX
     C                   END
     C                   MOVE      *ZEROS        WSNT              4 0
     C                   MOVE      *ZEROS        GMLONO            7 0
     C     BOXKEY        SETLL     GSSOLL01                           33
     C     BOXKEY        READE     GSSOLL01                               33
     C                   DOW       *IN33 = *OFF
     C                   IF        OLST <> 'C'
     C                   ADD       1             WSNT
      *
     C   45              IF        GMLONO = OLONO
     C                   GOTO      TAGNESTE
     C                   END
      *
     C     OLONO         CHAIN(N)  GSSORF                             34
      * Kun FØRSTE PO-nummer er i bruk...
     C                   IF        ((XWEBMAN = 'N') OR (WSPOACK = 'Y'))
     C     OLONO         SETLL     GSSPOF
     C     OLONO         READE     GSSPOF                                 34
     C                   ELSE
     C                   MOVE      *BLANKS       POCONO
     C     OLONO         SETLL     GSSRFF
     C     OLONO         READE     GSSRFF                                 34
     C     *IN34         DOWEQ     *OFF
     C                   IF        RFKD = 'CPO'
     C                   MOVEL     RFREF         POCONO
     C                   LEAVE
     C                   END
     C     OLONO         READE     GSSRFF                                 34
     C  N34              ENDDO
     C                   END
      * SKRIV KARTONG-LINJE
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB
     C                   ELSE
     C                   MOVEL     POCONO        XWACKN
     C                   SELECT
     C                   WHEN      WSM3LM = 'L'
     C                   IF        ORLMA = *BLANKS
     C                   MOVE      *ZEROS        XWM3LM
     C                   ELSE
     C                   MOVE      ORLMA         XWM3LM
     C                   END
     C                   WHEN      WSM3LM = 'C'
     C                   Z-ADD     ORVOL         XWM3LM
     C                   OTHER
     C                   Z-ADD     ORWT          XWM3LM
     C                   ENDSL
     C                   MOVE      ORBCD         XAN04             4
     C                   MOVE      XAN04         VADRNR
     C     VADRK         CHAIN     VADR                               34
     C                   IF        *IN34
     C                   EVAL      XWCNM  = '*UNKNOW'
     C                   EVAL      XWCAD1 = *BLANKS
     C                   EVAL      XWCPN  = *BLANKS
     C                   ELSE
     C                   MOVEL     VADRNA        XWCNM
     C                   MOVEL     VADRN1        XWCAD1
     C                   MOVEL     VADRN3        XWCPN
     C                   END
     C                   Z-ADD     ORCLI         XWCLI
     C                   WRITE     GSS026WB
     C                   END
     C     TAGNESTE      TAG
      *
      *Ved 1. forekomst av gitt ordre hent opp tilleggsbeskrivelser
     C     OLONO         IFNE      GMLONO
     C                   EXSR      EXTRA
      * Oppdater status ved FINAL..
     C     USORT         IFNE      'P'
     C     TRST          ANDLT     '2'
     C     OLONO         CHAIN     GSSORF                             34
      * Manifest til Sluttkunde -> NOP = NO Pod recieved
     C  N34ORST2         IFNE      *BLANKS
     C                   MOVEL     'NOP  '       ORST2
     c                   end
     C  N34              IF        ((TRBCD = *BLANKS) OR
     C                             ((TRLOCF <> *BLANKS) AND
     C                               (TRLOCT <> *BLANKS)))
     C                   IF        ORST = '1'
     C                   MOVE      ORLC2         ORLC3
     C                   MOVE      ORLC          ORLC2
     C                   MOVE      'ONWAY'       ORLC
     C                   MOVE      ORDTL2        ORDTL3
     C                   MOVE      ORDTL         ORDTL2
     C                   MOVE      TRDTL         ORDTL
     C                   END
      * Manifest til neste HUB (transit) -> STH Shipped To Hub
     C     ORST2         IFNE      *BLANKS
     C                   MOVEL     'STH  '       ORST2
     c                   end
     C                   END
     C  N34              MOVE      '2'           ORST
     C  N34              UPDATE    GSSORFR
     C  N34              IF        ORST2 <> *BLANKS
     C                   EXSR      TTLOGG
     C                   END
     C                   END
     C                   END
      *
     C                   MOVE      OLONO         GMLONO            7 0
     C                   END
     C                   IF        ((WSCONT = 'Y') AND (OLST = 'L'))
     C                   IF        USORT = 'F'
     C                   MOVE      'C'           OLST
     C                   END
     C                   MOVE      *BLANKS       OLMN
     C                   MOVEL     XCONT         OLMN
     C                   CAT       ':':0         OLMN
     C                   CAT       WSCNR:1       OLMN
     C                   END
     C                   UPDATE    GSSOLFR
     C     BOXKEY        READE     GSSOLL01                               33
     C  N33              ENDDO
      *
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PD
     C                   ELSE
     C                   WRITE     GSS026WD
     C                   END
      *
      * Ved kode P sidebrudd pr kasse, v/kode F - fortløpende
     C     USORT         IFEQ      'P'
     C                   MOVE      'J'           FØRSTE
     C                   END
      * Ved kode F og lasing på bil (kasse 901..) Ett oppdrag pr bil
     C     USORT         IFEQ      'F'
     C     *IN60         ANDEQ     '1'
     C     TRST          ANDLT     '2'
     C                   EXSR      LagTrOpd
     C                   END
      *
     C     SLENBOX       TAG
     C                   ENDSR
      *
      *=====================================================================
      *  HENT KOLLINR
      *=====================================================================
     C     HENTCLNR      begsr
      *
     C                   EVAL      XCLNR = '('
     C                   SELECT
     C                   WHEN      NR < 10
     C                   MOVE      NR            XAN01             1
     C                   CAT       XAN01:0       XCLNR
     C                   WHEN      NR < 100
     C                   MOVE      NR            XAN02             2
     C                   CAT       XAN02:0       XCLNR
     C                   OTHER
     C                   MOVE      NR            XAN03             3
     C                   CAT       XAN03:0       XCLNR
     C                   ENDSL
      *
     C                   CAT       'OF':1        XCLNR
      *
     C                   SELECT
     C                   WHEN      TOTBOX < 10
     C                   MOVE      TOTBOX        XAN01             1
     C                   CAT       XAN01:1       XCLNR
     C                   WHEN      TOTBOX < 100
     C                   MOVE      TOTBOX        XAN02             2
     C                   CAT       XAN02:1       XCLNR
     C                   OTHER
     C                   MOVE      TOTBOX        XAN03             3
     C                   CAT       XAN03:1       XCLNR
     C                   ENDSL
      *
     C                   CAT       ')':0         XCLNR
      *
     C                   endsr
      *
      *=====================================================================
      *  Oppdater loggen
      *=====================================================================
     C     TTLOGG        begsr
      *
     C                   MOVE      UUSER         LGUSER
     C                   MOVE      WDT           LGDT
     C                   MOVE      WTD           LGTID
     C                   Z-ADD     1             LGLN
     C                   MOVEL     'GSS026R'     LGPGM
     C                   Z-ADD     3             LGNIVÅ
     C                   MOVE      WDT           LGHDT
     C                   MOVEL     WTD           LGHTID
     C                   MOVEL     'MAIN'        LGFTYP
     C                   MOVE      ORONO         LGONO
     C                   MOVE      *ZEROS        LGLNO
      *
     C                   EVAL      LGTXT = 'Shipped on way to'
     C                   IF        ORST2 = 'NOP'
     C                   CAT       TRAD1:1       LGTXT
     C                   ELSE
     C                   CAT       TRLOCT:1      LGTXT
     C                   END
     C                   WRITE     GSSLGFR
      *
     C                   endsr
      *
     C***********************************************
     C     LagTrOpd      BEGSR
     C***********************************************
     C                   ADD       WSNT          WSNTT
     C     Opdkey        Chain     Headf                              33
     C     *in33         CABEQ     '1'           EndLagOpd
      * Tildel nytt oppdrnr
     C     HEAVD         CHAIN     TELL                               33
     C   33              move      *zeros        AvdZer            4 0
     C   33AVDZER        CHAIN     TELL                               33
     C     *in33         CABEQ     '1'           EndLagOpd
     C                   MOVE      TEOPDN        HEOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
      * Visse endrede verdier i TRANSPORT-Oppdrag
      * (forutsetter bruk av POSTAL...)
     C                   EVAL      HEST   = ' '
     C                   EVAL      HEUR   = 'H'
     C                   EVAL      HEDTOP = TRDTS
     C                   EVAL      TRSDFD = TRDTS
     C                   EVAL      TRSDTD = TRDTL
     C                   EVAL      HEKDFK = 'X'
     C                   EVAL      TRKNFA = HEKNS
     C                   EVAL      TRKDAK = 'S'
     C                   EVAL      HEHAWB = WSCID
     C                   EVAL      HESDF  = HEADS3
     C                   EVAL      HETRI  = CBLK
     C                   EVAL      HESDT  = HEADK3
     C                   EVAL      HERFA  = UTNO2
     C                   EVAL      HENT   = WSNT
     C                   EVAL      HEVKT  = WSVKT
     C                   EVAL      HEM3   = WSM3
     C                   EVAL      HELM   = WSLM
     C                   MOVEL     BX(NR)        XXUNIT            3
     C                   EVAL      HEVS1  = 'CLL. Unit '+XXUNIT+' ('+HEHAWB+')'
     C                   EVAL      HEVS2  = 'MSC Packing list '+UTNO2
     C                   WRITE     HEADFR
      * Record må finnes i DISP -
     C                   MOVE      HEAVD         DIAVD
     C                   MOVE      HEOPD         DIOPD
     C                   MOVE      HESDF         DISTEF
     C                   MOVE      HESDT         DISTET
     C                   MOVEL     HELKA         DISONF
     C                   MOVEL     HETRI         DISONT
     C                   WRITE     DISPR
      * Burde x-ref avd/opd legges inn i f.eks FRIE SØKEVEIER???
      *
     C     EndLagOpd     ENDSR
      *
     C***********************************************
     C     OVERFLOW      BEGSR
     C***********************************************
     C                   ADD       1             SIDENR
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PA
     C                   WRITE     GSS026PA27
     C                   ELSE
     C                   WRITE     GSS026WA
     C                   WRITE     GSS026WA27
     C                   END
     C                   MOVEA     '00'          *IN(26)
      *
     C                   ENDSR
     C***********************************************
     C     EXTRA         BEGSR
     C***********************************************
      *P.O. NR 2,3,4,5,....
      *......
      *Varebeskrivelse..
     C                   MOVE      *BLANKS       XXPB2            70
     C     OLONO         SETLL     GSSGDF
     C     OLONO         READE     GSSGDF                                 34
     C                   DOW       *IN34 = *OFF
     C                   MOVEL     GDDSC         XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C     OLONO         READE     GSSGDF                                 34
     C  N34              ENDDO
      *
      *KOMMENTARLINJER fra ordren
     C     ORKDL1        IFEQ      'PL'
     C     ORKDL2        OREQ      'PL'
     C     ORKDL3        OREQ      'PL'
     C                   MOVE      *BLANKS       XXPB2            70
     C                   MOVEL     COMMTXT       XXPB2
     C                   MOVEL     ORFT1         ORFT50           50
     C                   MOVE      ORFT50        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C     ORFT2         IFNE      *BLANKS
     C                   MOVE      *BLANKS       XXPB2            70
     C                   MOVEL     ORFT2         ORFT50           50
     C                   MOVE      ORFT50        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C     ORFT3         IFNE      *BLANKS
     C                   MOVE      *BLANKS       XXPB2            70
     C                   MOVEL     ORFT3         ORFT50           50
     C                   MOVE      ORFT50        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C     ORFT4         IFNE      *BLANKS
     C                   MOVE      *BLANKS       XXPB2            70
     C                   MOVEL     ORFT4         ORFT50           50
     C                   MOVE      ORFT50        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C                   END
      *PARTIAL-KODE Beskrivelse..
     C                   MOVE      *BLANKS       XXPB2            70
     C     OLONO         CHAIN     GSSPAF                             34
     C     *IN34         IFEQ      *OFF
     C     PAPKD         ANDEQ     'P'
     C                   MOVEL     PARTTXT       XXPB2
     C                   MOVE      PATXT1        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   MOVE      *BLANKS       XXPB2            70
     C     PATXT2        IFNE      *BLANKS
     C                   MOVE      PATXT2        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C     PATXT3        IFNE      *BLANKS
     C                   MOVE      PATXT3        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C     PATXT4        IFNE      *BLANKS
     C                   MOVE      PATXT4        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C     PATXT5        IFNE      *BLANKS
     C                   MOVE      PATXT5        XXPB2
     C     *IN27         IFEQ      *ON
     C     *IN26         OREQ      *ON
     C                   EXSR      OVERFLOW
     C                   END
     C                   IF        XWEBMAN = 'N'
     C                   WRITE     GSS026PB2
     C                   ELSE
     C                   WRITE     GSS026WB2
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     BOXLAPP       BEGSR
     C***********************************************
      *
     C                   MOVE      *ZEROS        WSVKT
     C                   MOVE      *ZEROS        WSMÅLL
     C                   MOVE      *ZEROS        WSMÅLB
     C                   MOVE      *ZEROS        WSMÅLH
     C                   MOVE      *ZEROS        WSM3
     C                   MOVE      *ZEROS        WSLM
     C                   MOVE      *BLANKS       WSCID
      * HENT VERDIER FRA TIDLIGERE KJØRING...
     C                   MOVEL     BXV(NR)       WSVKT
     C                   MOVE      BXV(NR)       WSVKT
     C                   MOVE      BXL(NR)       WSMÅLL
     C                   MOVE      BXB(NR)       WSMÅLB
     C                   MOVE      BXH(NR)       WSMÅLH
     c     *IN60         IFEQ      '1'
     C                   MOVEL     BX3(NR)       WSM3
     C                   MOVE      BX3(NR)       WSM3
     C                   Z-ADD     WSM3          ZM3
     C                   MOVEL     BXM(NR)       WSLM
     C                   MOVE      BXM(NR)       WSLM
     C                   end
     C                   MOVE      BXC(NR)       WSCID
     C     BXF(NR)       IFEQ      '*'
     C                   Z-ADD     BXK(NR)       ZM3
     C     USORT         IFNE      'P'
     C     TRST          ORGE      '2'
     C                   GOTO      UTBOXL
     C                   END
     C                   GOTO      STBOX01
     C                   END
      *
      * Kun ved kode P skal nye lapper skrives.
     C     USORT         IFNE      'P'
     C     TRST          ORGE      '2'
     C     WSMÅLL        MULT      WSMÅLB        XM3              11 0
     C                   MULT      WSMÅLH        XM3
     C     XM3           DIV(H)    1000000       XM3X              9 3
     C                   ADD       WSVKT         WSVKTT            9 1
     C                   ADD       WSVKT         CTOTVKT
     c     *in60         ifeq      '1'
     C                   ADD       WSM3          WSM3T             7 3
     C                   ADD       WSLM          WSLMT             4 2
     c                   else
     C                   ADD       XM3X          XM3XT             9 3
     C                   ADD       XM3X          CTOTM3
     c                   end
     C                   GOTO      UTBOXL
     C                   END
      *
      *
      *
     C     STRBOX        TAG
      *
     C     UMOD          IFNE      '5'
     C     UMOD          ANDNE     'W'
     C                   IF        WSCID = *BLANKS
     C                   MOVE      WSCNR         WSCID
     C                   END
N01   *
N01  C                   IF        XVKTVALG = ' '
N01  C     UTNO          CHAIN(N)  GSSTRF                             33
N01  C     'AIR'         SCAN      TRDW                                   40
N01  C   40              EVAL      XVKTVALG = 'A'
N01  C  N40              EVAL      XVKTVALG = 'T'
N01  C                   END
N01   *
N01  C                   IF        XVKTVALG <> 'D'
     C                   EXFMT     BILDE
N01  C                   END
     C                   MOVEA     '00000'       *IN(95)
     C                   MOVE      '0'           *IN30
N01   *
N01  C   10              EVAL      XVKTVALG = 'D'
N01  C                   IF        XVKTVALG = 'D'
N01  C                   EXSR      SRHENTVKT
N01  C                   GOTO      STBOX01
N01  C                   END
N01   *
     C     WSVKT         IFEQ      0
     C                   MOVE      '1'           *IN98
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPV0002'     MSGNR
     C                   GOTO      STRBOX
     C                   END
      * *in60 OFF - vanlige boxer - krav om LxBxH
     C     *in60         ifeq      *OFF
     C     WSMÅLL        IFEQ      0
     C                   MOVE      '1'           *IN97
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1818'     MSGNR
     C                   GOTO      STRBOX
     C                   END
     C     WSMÅLB        IFEQ      0
     C                   MOVE      '1'           *IN96
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1819'     MSGNR
     C                   GOTO      STRBOX
     C                   END
     C     WSMÅLH        IFEQ      0
     C                   MOVE      '1'           *IN95
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1820'     MSGNR
     C                   GOTO      STRBOX
     C                   END
     C                   else
      * *in60 ON  - Box er egentlig en BIL- krav om Bil/unitnr
     C     WSCID         IFEQ      *blanks
     C                   MOVE      '1'           *IN94
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV1310'     MSGNR
     C                   GOTO      STRBOX
     C                   END
     C                   END
     C                   END
      *
     C     *in60         ifeq      *OFF
     C     WSMÅLL        MULT      WSMÅLB        XM3
     C                   MULT      WSMÅLH        XM3
     C     XM3           DIV(H)    1000000       XM3X              9 3
     C                   Z-ADD     XM3X          ZM3               6 3
     c                   else
     C                   Z-ADD     WSM3          ZM3               6 3
     c                   end
      *
      * OPPDATER BOKS-VERDIER I OPPDRAGETS NOTIS-BOKK.
     C     STBOX01       TAG
     C                   IF        WSCONT = 'Y'
     C     GSSBXFK       SETLL     GSSBXF
     C     GSSBXFK       READE     GSSBXF                                 33
     C                   ELSE
     C     BXTNO         SETLL     GSSBXF
     C     BXTNO         READE     GSSBXF                                 33
     C                   END
     C     *IN33         DOWEQ     '0'
     C                   IF        WSCONT = 'Y'
     C     GSSBXFK       READE     GSSBXF                                 33
     C                   ELSE
     C     BXTNO         READE     GSSBXF                                 33
     C                   END
     C                   ENDDO
      *
     C                   MOVE      OLBOX         BXBOX
     C                   MOVE      TOTBOX        BXTOT
     C                   Z-ADD     WSVKT         BXVKT
     C                   Z-ADD     WSMÅLL        BXLEN
     C                   Z-ADD     WSMÅLB        BXBRE
     C                   Z-ADD     WSMÅLH        BXHØY
     C                   Z-ADD     ZM3           BXM3
     C                   IF        XCONT = *BLANKS
     C                   MOVEL     WSCID         BXID
     C                   ELSE
     C                   MOVEL     WSCID         BXCN
     C                   END
     C                   Z-ADD     WSLM          BXLM
     C                   WRITE     GSSBXFR
      *
     C     BXF(NR)       CABEQ     '*'           UTBOXL
      *
      * Ikke skriv label når en box er lasting av en BIL
     c     *IN60         CABEQ     '1'           UTBOXL
      *
      * EXECUTE LABEL INIT
     C                   EXSR      SR0001
      * EXECUTE VESSEL, CLIENT, BOX-ID
     C                   EXSR      SR0010
      * EXECUTE WEIGHT
     C                   EXSR      SR0020
      * EXECUTE M3
     C                   EXSR      SR0030
      * EXECUTE CONT.ID
     C                   IF        WSCID <> *BLANKS
     C                   EXSR      SR0040
     C                   END
      * EXECUTE COLLI NO. AS BAR CODES
     C                   EXSR      SR0050
      * EXECUTE END LABEL FORMAT
     C                   EXSR      SREND
      *
     C     UTBOXL        ENDSR
      *
N01   ***********************************************
N01  C     SRHENTVKT     BEGSR
N01   ***********************************************
N01   *
N01   * BOKSEN KAN INNEHOLDER 1. EN ELLER FLERE KOLLI FRA EN ORDRE.
N01   *                       2. KOLLI FRA FLERE ORDRE.
N01  C                   MOVE      *ZEROS        WSVKT
N01  C                   MOVE      *ZEROS        VON
N01  C                   MOVE      *ZEROS        VCL
N01   *
N01   * SUMMERE ANTALL KOLLI FRA HVER ORDRE I DENNE BOKSEN.
N01  C     BOXKEY        SETLL     GSSOLL01                           33
N01  C     BOXKEY        READE(N)  GSSOLL01                               33
N01  C                   DOW       *IN33 = *OFF
N01  C     1             DO        1000          XN5               5 0
N01  C                   SELECT
N01  C                   WHEN      VON(XN5) = 0
N01   * 1. KOLLI FRA DENNE ORDREN FANT. SETT ANTALL = 1.
N01  C                   EVAL      VON(XN5) = OLONO
N01  C                   EVAL      VCL(XN5) = 1
N01  C                   LEAVE
N01  C                   WHEN      VON(XN5) = OLONO
N01   * ANDRE KOLLI FRA DENNE ORDREN FANT. ØKE ANTALL MED 1.
N01  C                   EVAL      VCL(XN5) = VCL(XN5) + 1
N01  C                   LEAVE
N01  C                   ENDSL
N01  C                   ENDDO
N01  C     BOXKEY        READE(N)  GSSOLL01                               33
N01  C                   ENDDO
N01   *
N01   * FINN VEKT TIL BOKSEN.
N01  C     1             DO        1000          XN5               5 0
N01  C                   IF        VON(XN5) = 0
N01  C                   LEAVE
N01  C                   END
N01  C     VON(XN5)      CHAIN(N)  GSSORF                             33
N01  C                   IF        ORCLI = VCL(XN5)
N01   * ALLE KOLLI ER PÅ SAMME BOKS. SUMMERE HELE VEKT AV ORDRE.
N01  C                   EVAL      WSVKT = WSVKT + ORWT
N01  C                   ELSE
N01   * NOEN AV KOLLI ER PÅ DENNE BOKSEN. GJENNOMSNITT VEKT PR KOLLI GANGER MED "PLUKKET" KOLLI.
N01  C                   EVAL(H)   WSVKT = WSVKT + ORWT / ORCLI * VCL(XN5)
N01  C                   END
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
N01   *
      ***********************************************
     C     PRTINV        BEGSR
      ***********************************************
     C                   MOVE      FICURR        WSCUR
     C                   MOVE      UPRT          WSPRT
     C                   MOVE      'N'           WSCOMM
     C     TRMFT1        IFEQ      *BLANKS
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVEL     TRTNO         HEAVD
     C                   MOVE      TRTNO         HEOPD
     C     HEADFK        CHAIN     HEADF                              99
     C                   MOVE      *BLANKS       WSFT1
     C                   MOVE      *BLANKS       WSFT2
     C                   MOVEL     XFT01         XFT11
     C                   MOVE      TRDW          XFT12
     C     HEUR          IFEQ      'A'
     C     HEUR          OREQ      'B'
     C                   MOVEL     XFT02         XFT21
     C                   MOVEL     HEGN          XFT25
     C                   ELSE
     C                   MOVEL     XFT03         XFT21
     C                   MOVEL     HEGN          XFT22
     C                   MOVE      '-'           XFT23
     C                   MOVE      HEGN          XFT24
     C                   END
     C                   ELSE
     C                   MOVE      TRMFT1        WSFT1
     C                   MOVE      TRMFT2        WSFT2
     C                   END
      * CONTAINER
     C                   IF        ((XCONT >= 'C1') AND (XCONT <= 'C9'))
     C                   EVAL      WSFT2 = 'CONTAINER:'
     C                   CAT       WSCNR:2       WSFT2
     C                   END
     C                   IF        XCONT = 'CT'
     C                   EVAL      WSFT2 = 'CONTAINER:'
     C                   CAT       CN(1):2       WSFT2
     C     2             DO        9             XN
     C                   IF        CN(XN) <> *BLANKS
     C                   CAT       ',':0         WSFT2
     C                   CAT       CN(XN):0      WSFT2
     C                   END
     C                   ENDDO
     C                   END
      *
     C     TRBCD         COMP      *BLANKS                                27
     C  N27TRLOCF        COMP      *BLANKS                            2727
     C  N27TRLOCT        COMP      *BLANKS                            2727
      *
     C     STPRTINV      TAG
     C                   EXFMT     WINDOW6
     C                   MOVEA     '000'         *IN(97)
     C   04              DO
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C     WSKNC         PARM      WSKNC         UKNC80            8 0
     C                   PARM                    UFIRM
     C                   PARM                    USØKKN
     C                   GOTO      STPRTINV
     C                   END
     C     WSPRT         COMP      *BLANKS                                99
     C   99              GOTO      STPRTINV
     C     KODVAK        CHAIN     VALUL01                            98
     C   98              GOTO      STPRTINV
     C     WSCOMM        IFEQ      'Y'
     C     WSKNC         ANDNE     0
     C     CUNDL01K2     CHAIN     CUNDL01                            97
     C   97              GOTO      STPRTINV
     C                   END
     C     UTNO          CHAIN     GSSTRF                             33
     C                   MOVE      WSFT1         TRMFT1
     C                   MOVE      WSFT2         TRMFT2
     C                   UPDATE    GSSTRFR
      *
     C                   MOVE      'PRC'         UTYPE             3
     C                   MOVE      WSCPY         UCPY              1
     C                   MOVE      WSKNC         UKNC              8
     C                   MOVEL     XCONT         UPOS1             5
     C                   CALL      'GSS031R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    UPRT
N03  C                   PARM                    UORDTYP           1
     C                   PARM                    WSCUR
     C                   PARM                    UCPY
     C                   PARM                    UFAX
     C                   PARM                    WSCOMM
     C                   PARM                    UKNC
     C                   PARM                    UQJOB
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    UPOS1             5
     C                   PARM                    UPOS2             5
     C                   PARM                    UPOS3             5
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUNDL01K      KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    TRCNO
     C     CUNDL01K3     KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    ORCNO
     C     CUNDL01K2     KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSKNC
     C     KODVAK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSCUR
     C     VADRK         KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    ORCNO
     C                   KFLD                    VADRNR
      *
     C     BOXKEY        KLIST
     C                   KFLD                    UTNO
     C                   KFLD                    OLBOX
     C     OPDKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     GSSBXFK       KLIST
     C                   KFLD                    UTNO
     C                   KFLD                    WSCNR
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO2            11
     C                   PARM                    UPRT             10
     C                   PARM                    UPRT2            10
     C                   PARM                    USORT             1
     C                   PARM                    UFAX              1
     C                   PARM                    UMOD              1
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    UUSER            10
      *
     C                   IF        UMOD = 'M'
     C                   MOVE      UTNO2         UTNO             11 0
     C     UTNO          CHAIN(N)  GSSTRF                             33
     C                   GOTO      STINIT02
     C                   END
      *
     C     UMOD          IFNE      '5'
     C     UMOD          andne     'W'
     C                   OPEN      GSS026D
     C                   END
      *
     C                   MOVE      UTNO2         UTNO
     C                   TIME                    XTIME
     C                   MOVE      XAAR          XIDAGÅ
     C                   MOVE      XMND          XIDAGM
     C                   MOVE      XDAG          XIDAGD
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      FIFIRM        UFIRM
n01  C                   MOVE      ' '           XVKTVALG          1
      *
     C                   SELECT                                                 1<-B
     C                   WHEN      USORT = 'T'                                  1
     C     UTNO          SETLL     GSSOLL01
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
      *
     C                   IF        OLST <> 'C'
     C                   EXFMT     WINDOW3                                        3<-B
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   END                                                      3<-E
     C     1             DO        9             XN                3 0            3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      CN(XN) = *BLANKS
     C                   MOVEL     OLMN04        CN(XN)
     C                   LEAVE
     C                   WHEN      CN(XN) = OLMN04
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
      *
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   ENDDO                                                   2<-E
      *
     C     UTNO          CHAIN     GSSTRF                             33
     C  N33              MOVE      '2'           TRST
     C  N33              MOVE      '2'           TRST
     C  N33              MOVE      XIDAG         TRDTP
     C  N33              UPDATE    GSSTRFR
     C                   MOVE      TRST          USORT
     C     UTNO          SETLL     GSSORL21
     C     UTNO          READE     GSSORL21                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        ORST = '1'                                     3<-B
     C     ORONO         CHAIN     GSSORF                             33
     C  N33              IF        ((TRBCD = *BLANKS) OR                           4<-B
     C                             ((TRLOCF <> *BLANKS) AND
     C                               (TRLOCT <> *BLANKS)))
     C                   MOVE      ORLC2         ORLC3
     C                   MOVE      ORLC          ORLC2
     C                   MOVE      'ONWAY'       ORLC
     C                   MOVE      ORDTL2        ORDTL3
     C                   MOVE      ORDTL         ORDTL2
     C                   MOVE      TRDTL         ORDTL
     C                   END                                                       4<-E
     C  N33              MOVE      '2'           ORST
     C  N33              UPDATE    GSSORFR
     C                   END                                                      3<-E
     C     UTNO          READE     GSSORL21                               33
     C                   ENDDO                                                   2<-E
     C                   MOVE      'CT'          XCONT
     C                   EXSR      PRTINV
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
     C                   WHEN      USORT = 'F'                                  1
     C                   EVAL      WSCONT = 'N'
     C     UTNO          SETLL     GSSOLL01
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        ((OLMN01 = 'C') AND (OLMN03 = ': '))           3<-B
     C                   EVAL      WSCONT = 'Y'
     C                   IF        OLST = 'L'                                      4<-B
     C                   MOVE      OLMN02        XCONT
     C                   MOVEL     OLMN04        WSCNR
     C                   LEAVE
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   ENDDO                                                   2<-E
      *
     C                   OTHER                                                  1
     C     UTNO          SETLL     GSSOLL01
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        ((OLMN01 = 'C') AND (OLMN03 = ': '))           3<-B
     C                   IF        OLST <> 'C'
     C                   EVAL      WSCONT = 'Y'
     C                   LEAVE
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   ENDDO                                                   2<-E
      * FOR DEM SOM BRUKER CONTAINER MÅ NESTE TRE LINJER FJERNES
     C                   IF        WSCONT = ' '
     C                   EVAL      WSCONT = 'N'
     C                   END
      *
     C                   DOW       WSCONT = ' '                                  2<-B
     C                   EXFMT     WINDOW4
     C                   END                                                     2<-E
      *
     C                   MOVE      'N'           XGML              1
     C     UTNO          SETLL     GSSOLL01
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        WSCONT = 'N'                                   3<-B
     C                   IF        OLST = 'C'                                      4<-B
     C                   EXFMT     WINDOW3
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   IF        ((OLMN01 = 'C') AND (OLMN03 = ': '))            4<-B
     C                   IF        XGML = 'N'                                       5-B
     C                   IF        OLST = 'L'                                        6<-B
     C                   MOVE      OLMN02        XCONT             2
     C                   MOVEL     OLMN04        WSCNR
     C                   MOVE      'J'           XGML
     C                   ELSE                                                        6
     C                   IF        OLMN02 > XCONT                                     7<-B
     C                   MOVE      OLMN02        XCONT             2
     C                   MOVEL     OLMN04        WSCNR
     C                   END                                                          7<-E
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   ENDDO                                                   2<-E
      * HENT CONTAINER
     C                   IF        WSCONT = 'Y'                                  2<-B
     C                   IF        XCONT = *BLANKS                                3<-B
     C                   MOVE      'C1'          XCONT
     C                   ELSE                                                     3
     C                   IF        XGML = 'N'                                      4<-B
     C                   MOVE      XCONT         XN01              1 0
     C                   ADD       1             XN01
     C                   MOVE      XN01          XCONT
     C                   MOVE      *BLANKS       WSCNR
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   DOU       WSCNR <> *BLANKS                               3<-B
     C                   EXFMT     WINDOW5
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDSL                                                  1<-E
      *
     C     UTNO          CHAIN(N)  GSSTRF                             33
     C     UMOD          IFEQ      'W'
     C     USORT         ANDEQ     'F'
     C     UMOD          OREQ      'W'
     C     USORT         ANDEQ     'P'
     C     USORT         COMP      'P'                                    31
     C                   MOVE      'J'           XWEBMAN           1
     C                   IF        UPRT = *BLANKS
     C                   MOVE      TRPOACK       WSPOACK
     C                   MOVE      TRKLDET       WSKLDET
     C                   MOVE      TRM3LM        WSM3LM
     C                   ELSE
     C                   MOVEL     UPRT          WSNYEV
     C                   END
     C     WSPOACK       IFEQ      'Y'
     C                   EVAL      XWTXT1 = 'P.O.NO.'
     C                   ELSE
     C                   EVAL      XWTXT1 = 'ACK NO.'
     C                   END
     C     WSKLDET       COMP      'Y'                                4545
     C                   SELECT
     C                   WHEN      WSM3LM = 'L'
     C                   EVAL      XWTXT2 = ' L.METER'
     C                   WHEN      WSM3LM = 'C'
     C                   EVAL      XWTXT2 = '    CUBE'
     C                   OTHER
     C                   EVAL      XWTXT2 = '  WEIGHT'
     C                   ENDSL
     C                   MOVE      *BLANKS       UPRT
     C                   ELSE
     C                   MOVE      'N'           XWEBMAN
     C                   END
      *
     C                   MOVEL     UTNO2         UAVD              4 0
     C                   MOVE      UTNO2         UOPD              7 0
     C                   MOVE      UTNO2         BXTNO
     C                   MOVE      UAVD          HEAVD
     C                   MOVE      UOPD          HEOPD
      *
      * SIKRE 1. "SIDEBRUDD"
     C                   MOVE      'J'           FØRSTE            1
      *
      * OVERSTYRE PRINTERFIL - LISTE
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     UMOD          IFNE      '5'
     C     XCMD11        CAT       UPRT:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   ELSE
     C                   MOVEL     XCMD31        UCMD
     C                   END
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   IF        XWEBMAN = 'N'
     C                   OPEN      GSS026P
     C                   ELSE
     C                   OPEN      GSS026PW
     C                   END
      *
      * OVERSTYRE PRINTERFIL - MERKELAPPER
     C     STINIT02      TAG
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     XCMD01        CAT       UPRT2:0       UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD02:1      UCMD
     C                   CALL      'QCMDEXC'                            55
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   OPEN      LISTE                                55
      *
      * INITIER DIV. KODEFELT FOR MERKELAPPSSKRIVER
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVE      *BLANKS       MSGVAR            7            MESSAGE VARIABEL
     C                   MOVE      '999'         XPRE
      *
      *
     C     TRST          COMP      '2'                                28  28
     C                   MOVE      TRDTLD        XTDTLD
     C                   MOVE      TRDTLM        XTDTLM
     C                   MOVE      TRDTLÅ        XTDTLÅ
     C                   MOVE      TRDTSD        XTDTSD
     C                   MOVE      TRDTSM        XTDTSM
     C                   MOVE      TRDTSÅ        XTDTSÅ
     C     TRFC          CHAIN     GSSFIF                             33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C     TRBCD         CHAIN     CDBOAT                             33
      *
     C                   IF        UMOD = 'M'
     C                   EXSR      SRKOPIBM
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   END
      * ADR-LINJE 3,4,5,6
     C                   SELECT
     C     TRAD6         WHENNE    *BLANKS
     C                   MOVEA     '1111'        *IN(51)
     C     TRAD5         WHENNE    *BLANKS
     C                   MOVEA     '1110'        *IN(51)
     C     TRAD4         WHENNE    *BLANKS
     C                   MOVEA     '1100'        *IN(51)
     C     TRAD3         WHENNE    *BLANKS
     C                   MOVEA     '1000'        *IN(51)
     C                   OTHER
     C                   MOVEA     '0000'        *IN(51)
     C                   ENDSL
      *
      * FRITEKSTLINJE 1,2,3,4
     C     TRKDL1        IFEQ      'PL'
     C     TRKDL2        OREQ      'PL'
     C     TRKDL3        OREQ      'PL'
     C                   SELECT
     C     TRFT4         WHENNE    *BLANKS
     C                   MOVEA     '1111'        *IN(55)
     C     TRFT3         WHENNE    *BLANKS
     C                   MOVEA     '1110'        *IN(55)
     C     TRFT2         WHENNE    *BLANKS
     C                   MOVEA     '1100'        *IN(55)
     C     TRFT1         WHENNE    *BLANKS
     C                   MOVEA     '1000'        *IN(55)
     C                   OTHER
     C                   MOVEA     '0000'        *IN(55)
     C                   ENDSL
     C                   ELSE
     C                   MOVEA     '0000'        *IN(55)
     C                   END
      * LOCATION FRA FØRSTE ORDRE...
     C     UTNO          SETLL     GSSOLL01                           33
     C     UTNO          READE(N)  GSSOLL01                               33
     C     OLONO         CHAIN(N)  GSSORF                             33
     C  N33              MOVE      ORLC          XXLOCF
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTD               6
     C                   MOVEL     WTD           XTID4
      *
     C     UPRT          CHAIN     GSSSTK                             33
     C     *IN33         IFEQ      '0'
     C     STRF05        CHAIN     KODTFM                             33
      * lager stringkoder for skifte av font
     C     stresc        ifne      *blanks
      * ¤1B(¤1B(s0p15h6v0s0b0T'
     c                   move      *blanks       stri03           70
     C     stri03        CAT       stresc:0      stri03
     C     stri03        CAT       '(':0         stri03
     C     stri03        CAT       stresc:0      stri03
     C     stri03        CAT       '(s0p15h6v0':0stri03
     C     stri03        CAT       's0b0T':0     stri03
     c                   end
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     FINNBOX       BEGSR
     C***********************************************
     C                   move      '0'           *IN60
     C                   SETOFF                                       30
      * FINN BOKS-ID-ER I BRUK
     C                   MOVE      *ZEROS        TOTBOX            3 0
     C                   MOVE      *ZEROS        GMBOX             3 0
     C                   MOVE      *ZEROS        NR                3 0
     C                   CLEAR                   BX
     C                   CLEAR                   BXV
     C                   CLEAR                   BXK
     C                   CLEAR                   BXF
     C                   CLEAR                   BX3
     C                   CLEAR                   BXM
     C     UTNO          SETLL     GSSOLL01                           33
     C     UTNO          READE(N)  GSSOLL01                               33
     C                   DOW       *IN33 = *OFF
     C                   IF        OLST <> 'C'
     c     OLBOX         IFGT      900
     c     OLBOX         ANDLT     999
     c                   sub       900           OLBOX
     C                   move      '1'           *IN60
     c                   end
     C     OLST          IFNE      'L'
     C     WSCONT        ANDEQ     'N'
     C                   SETON                                        30
     C                   END
     C     OLBOX         IFEQ      999
     C                   ADD       1             NR
     C                   ADD       1             GMBOX
     C                   Z-ADD     GMBOX         BX(NR)
     C     OLONO         IFNE      GMONO
     C                   Z-ADD     ORWT          BXV(NR)
     C                   Z-ADD     ORVOL         BXK(NR)
     C                   END
     C                   Z-ADD     OLONO         GMONO             7 0
     C                   MOVE      '*'           BXF(NR)
     C                   ELSE
     C     OLBOX         IFNE      GMBOX
     C                   ADD       1             NR
     C                   MOVE      OLBOX         BX(NR)
     C                   END
     C                   MOVE      OLBOX         GMBOX
     C                   END
      *
     C                   END
     C     UTNO          READE(N)  GSSOLL01                               33
     C  N33              ENDDO
      * NOEN UTEN BOX-NR PÅ.....
     C     *IN30         IFEQ      *ON
     C     UMOD          IFNE      '5'
     C                   MOVE      'N'           UFAX
     C                   END
     C     UMOD          IFNE      'W'
     C                   EXFMT     WINDOW1
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C                   END
      * TA VARE PÅ ANTALL - LEGG PÅ "SLUTT-FLAGG"
     C                   MOVE      NR            TOTBOX
     C                   MOVE      NR            TOTBOZ
     C                   ADD       1             NR
     C                   Z-ADD     -1            BX(NR)
     C                   MOVE      *ZEROS        NR                             PGA. GSL/RTM
      *
      * SLETT GAMMEL (VED KJØRING TYPE P) INFO OM BOX-NR, TA VARE PÅ I ARRAY
     C                   MOVE      *ZEROS        ANTFTX            3 0
     C                   CLEAR                   BXL
     C                   CLEAR                   BXB
     C                   CLEAR                   BXH
     C                   CLEAR                   BX3
     C                   CLEAR                   BXM
     C                   CLEAR                   BXC
     C                   MOVE      TOTBOX        TOTBOXA           3
     C                   IF        WSCONT = 'Y'
     C     GSSBXFK       SETLL     GSSBXF
     C     GSSBXFK       READE     GSSBXF                                 33
     C                   ELSE
     C     BXTNO         SETLL     GSSBXF
     C     BXTNO         READE     GSSBXF                                 33
     C                   END
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             ANTFTX
     C     BXBOX         IFLE      900                                          PGA. GSL/RTM
     C     BXGSL         ANDNE     '*'
     C                   ADD       1             NR                             PGA. GSL/RTM
     C                   Z-ADD     BXVKT         BXV(NR)
     C                   Z-ADD     BXLEN         BXL(NR)
     C                   Z-ADD     BXBRE         BXB(NR)
     C                   Z-ADD     BXHØY         BXH(NR)
     C                   Z-ADD     BXM3          BX3(NR)
     C                   IF        BXCN = *BLANKS
     C                   MOVEL     BXID          BXC(NR)
     C                   ELSE
     C                   MOVEL     BXCN          BXC(NR)
     C                   END
     C                   Z-ADD     BXLM          BXM(NR)
     C                   END
     C     USORT         IFEQ      'P'
     C  N28              DELETE    GSSBXFR
     C   28              UPDATE    GSSBXFR
     C                   ELSE
     C                   UPDATE    GSSBXFR
     C                   END
     C                   IF        WSCONT = 'Y'
     C     GSSBXFK       READE     GSSBXF                                 33
     C                   ELSE
     C     BXTNO         READE     GSSBXF                                 33
     C                   END
     C                   ENDDO
      * ANTALL BOX-LINJER I FTX OK??  VED FINAL
     C     USORT         IFNE      'P'
     C     ANTFTX        ANDNE     TOTBOX
     C     UMOD          IFNE      '5'
     C                   MOVE      'N'           UFAX
     C                   END
     C     UMOD          IFNE      'W'
     C                   EXFMT     WINDOW2
     C                   end
     C                   SETON                                        LR
     C                   RETURN
     C                   END
     C                   ENDSR
      *
     C***********************************************
     C     SORTCONT      BEGSR
     C***********************************************
     C                   CALL      'GSS026C2'
     C                   OPEN      GSS026WF
      * SORTER ETTER CONTAINER + BOXNR
     C     1             DO        999           NR
     C                   IF        BX(NR) < 0
     C                   LEAVE
     C                   END
     C     BXC(NR)       CABEQ     *BLANKS       SLSORT
     C                   MOVE      BXC(NR)       GWCONT
     C                   MOVE      BX(NR)        GWBOXN
     C                   MOVE      BXV(NR)       GWVKT
     C                   MOVE      BXL(NR)       GWLEND
     C                   MOVE      BXB(NR)       GWBRED
     C                   MOVE      BXH(NR)       GWHØYD
     C                   MOVE      BXK(NR)       GWM3
     C                   MOVE      BXF(NR)       GWBOXF
     C                   MOVE      BX3(NR)       GWM32
     C                   MOVE      BXM(NR)       GWLM
     C                   WRITE     GSS026WR
     C                   ENDDO
     C                   Z-ADD     0             NR
     C     *LOVAL        SETLL     GSS026WF
     C                   READ      GSS026WF                               33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             NR
     C                   EVAL      BXC(NR) = GWCONT
     C                   EVAL      BX(NR)  = GWBOXN
     C                   EVAL      BXV(NR) = GWVKT
     C                   EVAL      BXL(NR) = GWLEND
     C                   EVAL      BXB(NR) = GWBRED
     C                   EVAL      BXH(NR) = GWHØYD
     C                   EVAL      BXK(NR) = GWM3
     C                   EVAL      BXF(NR) = GWBOXF
     C                   EVAL      BX3(NR) = GWM32
     C                   EVAL      BXM(NR) = GWLM
     C                   READ      GSS026WF                               33
     C                   ENDDO
      *
     C                   MOVE      *ON           *IN32
     C     SLSORT        TAG
     C                   CLOSE     GSS026WF
      *
     C                   ENDSR
      *
     C***********************************************
     C     SRKOPIBM      BEGSR
     C***********************************************
     C                   IF        ((CBNAB = *BLANKS) OR (KNAVN = *BLANKS))
     C                   MOVE      'J'           XHENTBN           1
     C                   ELSE
     C                   MOVE      'N'           XHENTBN
     C                   END
     C                   IF        UPRT = '*ALL'
     C                   MOVE      *BLANKS       XBOXNR            3
     C                   ELSE
     C                   MOVEL     UPRT          XBOXNR
     C                   END
      *
     C                   MOVE      UTNO2         BXTNO
     C                   IF        WSCONT = 'Y'
     C     GSSBXFK       SETLL     GSSBXF
     C     GSSBXFK       READE(N)  GSSBXF                                 33
     C                   ELSE
     C     BXTNO         SETLL     GSSBXF
     C     BXTNO         READE(N)  GSSBXF                                 33
     C                   END
     C                   DOW       *IN33 = '0'
     C                   MOVE      BXBOX         ZOLBOX            3
     C                   IF        ((XBOXNR='   ') OR (XBOXNR=ZOLBOX))
     C                   MOVE      ZOLBOX        OLBOX
     C                   IF        XHENTBN = 'J'
     C     BOXKEY        CHAIN(N)  GSSOLL01                           33
     C     OLONO         CHAIN(N)  GSSORF                             33
     C     ORBCD         CHAIN     CDBOAT                             33
     C     CUNDL01K3     CHAIN     CUNDL01                            33
     C                   END
     C                   MOVE      BXTOT         TOTBOX
     C                   MOVE      BXTOT         NR
     C                   Z-ADD     BXVKT         WSVKT
     C                   Z-ADD     BXLEN         WSMÅLL
     C                   Z-ADD     BXBRE         WSMÅLB
     C                   Z-ADD     BXHØY         WSMÅLH
     C     WSMÅLL        MULT      WSMÅLB        XM3              11 0
     C                   MULT      WSMÅLH        XM3
     C     XM3           DIV(H)    1000000       XM3X              9 3
      *
      * EXECUTE LABEL INIT
     C                   EXSR      SR0001
      * EXECUTE VESSEL, CLIENT, BOX-ID
     C                   EXSR      SR0010
      * EXECUTE WEIGHT
     C                   EXSR      SR0020
      * EXECUTE M3
     C                   EXSR      SR0030
      * EXECUTE CONT.ID
     C*                  IF        WSCID <> *BLANKS
     C*                  EXSR      SR0040
     C*                  END
      * EXECUTE COLLI NO. AS BAR CODES
     C                   EXSR      SR0050
      * EXECUTE END LABEL FORMAT
     C                   EXSR      SREND
      *
     C                   END
      *
     C                   IF        WSCONT = 'Y'
     C     GSSBXFK       SETLL     GSSBXF
     C     GSSBXFK       READE(N)  GSSBXF                                 33
     C                   ELSE
     C     BXTNO         READE(N)  GSSBXF                                 33
     C                   END
     C                   ENDDO
      *
     C                   ENDSR
      *
      *_____________________________________________________
      * EXECUTE LABEL INIT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      * SEND DEFAULT INSTRUCTIONS
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    LISTEA
      *
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE BOX-ID
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * VESSEL
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '650,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XVESSEL       DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '650,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,90,70'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     CBNAB         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * CLIENT
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '575,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XCLIENT       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '575,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KNAVN         DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * BOXNO
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '500,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XBOX          DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '500,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     OLBOX         LANUMA
     C                   MOVE      LANUMA        CHAR6             6
     C                   MOVEA     CHAR6         A6
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B6
     C     A6(X)         DOWEQ     '0'
     C     X             ANDLT     6
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     6
     C                   MOVEA     A6(X)         B6(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B6            DATA1
      *
     C                   CAT       '(':3         DATA1
     C                   Z-ADD     NR            LANUMA
     C                   MOVE      LANUMA        CHAR6             6
     C                   MOVEA     CHAR6         A6
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B6
     C     A6(X)         DOWEQ     '0'
     C     X             ANDLT     6
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     6
     C                   MOVEA     A6(X)         B6(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B6            CHAR6
     C                   CAT       CHAR6:0       DATA1
      *
     C                   CAT       'OF':1        DATA1
      *
     C                   Z-ADD     TOTBOX        LANUMA
     C                   MOVE      LANUMA        CHAR6             6
     C                   MOVEA     CHAR6         A6
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B6
     C     A6(X)         DOWEQ     '0'
     C     X             ANDLT     6
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     6
     C                   MOVEA     A6(X)         B6(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B6            CHAR6
     C                   CAT       CHAR6:1       DATA1
     C                   CAT       ')':0         DATA1
      *
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE VEKT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0020        BEGSR
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '425,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XVEKT         DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '425,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WSVKT         LANUMA
     C                   MOVE      LANUMA        CHAR6             6
     C                   MOVEA     CHAR6         A6
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B6
     C     A6(X)         DOWEQ     '0'
     C     X             ANDLT     6
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     6
     C                   MOVEA     A6(X)         B6(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B6            DATA1
     C                   CAT       ',':0         DATA1
     C                   MOVE      WSVKT         XCHAR1            1
     C                   CAT       XCHAR1:0      DATA1
     C                   CAT       'KG':2        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE MÅL
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0030        BEGSR
      * L X B X H..
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '350,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XMÅL          DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '350,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WSMÅLL        DATA1
     C                   CAT       'X':1         DATA1
     C                   MOVE      WSMÅLB        XCHAR4            4
     C                   CAT       XCHAR4:1      DATA1
     C                   CAT       'X':1         DATA1
     C                   MOVE      WSMÅLH        XCHAR4
     C                   CAT       XCHAR4:1      DATA1
     C                   CAT       'CM':2        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * KUBIKK
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '275,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XCUBE         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '275,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XM3X          LANUMA
     C                   MOVE      LANUMA        CHAR6             6
     C                   MOVEA     CHAR6         A6
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B6
     C     A6(X)         DOWEQ     '0'
     C     X             ANDLT     6
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     6
     C                   MOVEA     A6(X)         B6(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B6            DATA1
     C                   CAT       ',':0         DATA1
     C                   MOVE      XM3X          XCHAR3            3
     C                   CAT       XCHAR3:0      DATA1
     C                   CAT       'M3':2        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE CONTAINER ID
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0040        BEGSR
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XCONTID       DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WSCID         DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE INTERN ORDER NO.
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0050        BEGSR
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,300'      DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE FIELD DEFAULT)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^BY'         DATA
     C                   MOVEL     '4,4:1,15'    DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE INTERLEAVED 2 OF 5)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^B3'         DATA
     C                   MOVEL     'R,N,120,'    DATA1
     C                   CAT       'Y':0         DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED AS BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '995'         DATA1
     C                   CAT       UTNO2:0       DATA1
     C                   MOVE      OLBOX         XAN03             3
     C                   CAT       XAN03:0       DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * SUBROUTINE TO END LABEL FORMAT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    LISTEA
     C                   ENDSR
     C***********************************************
     C     SNDFAX        BEGSR
     C***********************************************
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
      *
     C                   CALL      'GSS015C2'
     C                   PARM                    UCOVP
     C                   PARM                    UQJOB
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    FAXNRP           21
     C                   PARM      'GSS026P'     FILEN            10
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   PARM                    uemail
     C                   PARM      'PACKINGLIST' emne             40
     C                   PARM                    uemailj
      *
      *
     C                   ENDSR
      *
      *=====================================================================
      *  Oppdater loggen
      *=====================================================================
     C     OPDLOGG       begsr
      *
     C                   MOVEL     UTNO          TTAVD
     C                   MOVE      UTNO          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTD           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTD           TTTIML
     C                   MOVE      'PS2'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTTEXT = XXTXT01
     C                   CAT       XXTXT02:10    TTTEXT
     C                   CAT       UTNO2:1       TTTEXT
N02  C                   EVAL      TTTEXl = XXTXT01l
N02  C                   CAT       XXTXT02l:10   TTTEXl
n02  C                   CAT       UTNO2:1       TTTEXl
     C                   WRITE     TRACKFR
      *
     C                   endsr
     OLISTE     E            LISTEA
     O                       DATA
