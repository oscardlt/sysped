/* ********************************************************************    */
/* *    "Agent" som behandler skannede dokumenter i ulike mapper      *    */
/* *    og sender disse videre til arkivsystemet/oppdaterer arkivlogg *    */
/* ********************************************************************    */
/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 JOV PTF10 bygg /sysca/innTKpdf/Annet                         */
/* 10XXX * 02 JOV PTF10 .../KBILAGB = VIA ENDELIG BILAGSNR                 */
/* ********************************************************************    */
             PGM
             DCL        VAR(&ARKJN) TYPE(*CHAR) LEN(1) /* Benyttes +
                          arkiv? */
             DCL        VAR(&DIR) TYPE(*CHAR) LEN(100) /* +
                          Directory/mappe som leses inn */
             DCL        VAR(&PGM) TYPE(*CHAR) LEN(10) /* Program som +
                          skal behandle vellykket lest fil */
/* OM ARKIV IKKE BENYTTES - HOPP UT */
             CALL       PGM(ARC015) PARM(&ARKJN)
             IF         COND(&ARKJN = 'N') THEN(GOTO CMDLBL(SLUTT))

/* STANDARD MAPPESTRUKTUR FINNES IKKE ->  BYGG */
             md '/sysca'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/innTKpdf'
             MONMSG     MSGID(CPFA0A0)
/*N01*/      md '/sysca/innTKpdf/Annet'
/*N01*/      MONMSG     MSGID(CPFA0A0)
             md '/sysca/innTKpdf/error'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/ATTENHET'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/ATTENHET/slett'
             MONMSG     MSGID(CPFA0A0)
/*S01        md '/sysca/ATTENHET/papirsentral' */
/*S01        MONMSG     MSGID(CPFA0A0)         */
             md '/sysca/FRBREV'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/FRBREVPOD'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/KBILAG'
             MONMSG     MSGID(CPFA0A0)
/*N02*/      md '/sysca/KBILAGB'
/*N02*/      MONMSG     MSGID(CPFA0A0)
             md '/sysca/OPPDRAG'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/TUR'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/SS'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/KUNDE'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/LEVE'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/L1BILAG'
             MONMSG     MSGID(CPFA0A0)
             md '/sysca/FRISOK'
             MONMSG     MSGID(CPFA0A0)

/* EYESHARE kostnadsbilag type zu   (NC-spesial)   */
 START:      CHGVAR     VAR(&DIR) VALUE('/eyeshare/tilsysped/bilder')
             CHGVAR     VAR(&PGM) VALUE('ARCA002R')
/*BRING-SPES CALL       PGM(ARCA001R) PARM(&DIR &PGM)   */

/* ORIGINAL FRAKTBREV   fraktbrev    */
             CHGVAR     VAR(&DIR) VALUE('/sysca/FRBREV')
             CHGVAR     VAR(&PGM) VALUE('ARCA003R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)

/* KVITTERTE FRAKTBREV M POD         */
             CHGVAR     VAR(&DIR) VALUE('/sysca/FRBREVPOD')
             CHGVAR     VAR(&PGM) VALUE('ARCA003R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)

/* Kostnadsbilag   */
             CHGVAR     VAR(&DIR) VALUE('/sysca/KBILAG')
             CHGVAR     VAR(&PGM) VALUE('ARCA004R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)

/* N02*/
/* Kostnadsbilag VIA ENDELIG BILAGSNR*/
             CHGVAR     VAR(&DIR) VALUE('/sysca/KBILAGB')
             CHGVAR     VAR(&PGM) VALUE('ARCA004R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)

/* Oppdragsdokument   */
             CHGVAR     VAR(&DIR) VALUE('/sysca/OPPDRAG')
             CHGVAR     VAR(&PGM) VALUE('ARCA005R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)

/* TUR dokument   */
             CHGVAR     VAR(&DIR) VALUE('/sysca/TUR')
             CHGVAR     VAR(&PGM) VALUE('ARCA006R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)
/* SS SHIPSSYSTEM */
             CHGVAR     VAR(&DIR) VALUE('/sysca/SS')
             CHGVAR     VAR(&PGM) VALUE('ARCA007R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)
/* KUNDE dokument */
             CHGVAR     VAR(&DIR) VALUE('/sysca/KUNDE')
             CHGVAR     VAR(&PGM) VALUE('ARCA008R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)
/* LEVERANDØR-DOKUMENT */
             CHGVAR     VAR(&DIR) VALUE('/sysca/LEVE')
             CHGVAR     VAR(&PGM) VALUE('ARCA009R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)
/* L1-DOKUMENT */
             CHGVAR     VAR(&DIR) VALUE('/sysca/L1BILAG')
             CHGVAR     VAR(&PGM) VALUE('ARCA010R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)
/* FRISOK      */
             CHGVAR     VAR(&DIR) VALUE('/sysca/FRISOK')
             CHGVAR     VAR(&PGM) VALUE('ARCA012R')
             CALL       PGM(ARCA001R) PARM(&DIR &PGM)

/* Vent xxx sekunder - ny runde */
/*S02        DLYJOB     DLY(120) */
             DLYJOB     DLY(30)
             GOTO       CMDLBL(START)

 SLUTT:      ENDPGM
