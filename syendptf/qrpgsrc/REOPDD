      *
      ***********************************************************
      *** PROGRAM SKAL SLETTE OPPDRAG FRA KOMPRIMERTE         ***
      ***       HISTORIKKFILER                                ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 06-26                   ***
      *** LEDIGE INDIKATORER 27-50 54-98                      ***
      ***********************************************************
      *
     FHEADDCMP  UF   E           K DISK
     F                                     RENAME(HEADFRCMP:HEADFRCM)
     FHEADFCMP  IF   E           K DISK
     F                                     RENAME(HEADFRCMP:HEADFRCF)
     FFAK2CMP   UF   E           K DISK
     FFAINCMP   UF   E           K DISK
     FREOPDDFM  CF   E             WORKSTN
     F                                     MAXDEV(*FILE)
     F                                     INFDS(FEEDBK)
     D FEEDBK          DS
     D  STATUS           *STATUS
     D                 DS
     D  YDT                    1      8  0
     D  YDT≈                   1      4  0
     D  YDTM                   5      6  0
     D  YDTD                   7      8  0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C   03              GOTO      SLUTT
      * TEST DATO
     C                   MOVE      WSDT          XMM≈≈             4 0
     C                   MOVE      XMM≈≈         U≈≈               2 0
     C                   MOVEL     XMM≈≈         UMM               2 0
     C                   MOVEL     WSDT          UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      99
     C   99
     CORN05              GOTO      START
      *
     C                   SETON                                        98
     C                   EXSR      KDTFMT
     C                   TIME                    WSTDST
     C                   WRITE     BILDE
     C                   READ      REOPDDFM                             9999
     C                   EXSR      KDTFMT
     C                   EXSR      DLHE
     C                   EXSR      DLFI
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     DLHE          BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        YDT
     C     YDT           SETLL     HEADDCMP
     C                   MOVE      UDD           YDTD
     C                   MOVE      UMM           YDTM
     C                   Z-ADD     U≈≈           YDT≈
     C     U≈≈           IFGT      50
     C                   MOVEL     '19'          YDT≈
     C                   ELSE
     C                   MOVEL     '20'          YDT≈
     C                   END
     C     STDHE         TAG
     C                   READ      HEADDCMP                               51
     C  N51HEDTR         IFLE      YDT
     C                   EXSR      DLFK
     C                   DELETE    HEADFRCM
      *
     C                   ADD       1             WSANT
     C                   ADD       1             XANT              3 0
     C     WSANT         IFLE      1000
     C                   MOVEA     '01'          *IN(94)
     C     XANT          COMP      100                                    97
     C                   ELSE
     C                   MOVEA     '10'          *IN(94)
     C     XANT          COMP      1000                                   97
     C                   END
     C     *IN97         IFEQ      *ON
     C                   MOVE      *ZEROS        XANT
     C                   TIME                    WSTDN≈
     C                   WRITE     BILDE
     C                   READ      REOPDDFM                             3333
     C                   END
      *
     C                   GOTO      STDHE
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLFK          BEGSR
     C***********************************************
     C     FAK2K         SETLL     FAK2CMP
     C                   SETOFF                                       52
     C     STDFK         TAG
     C     HEAVD         READE     FAK2CMP                                52
     C  N52HEOPD         COMP      FAOPD                              5252
     C  N52              DO
      *                    EXSR DLFI
     C                   DELETE    FAKTRCMP
     C                   GOTO      STDFK
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLFI          BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        FIFN
     C     FIFN          SETLL     FAINCMP
     C                   SETOFF                                       53
     C     STDFI         TAG
     C                   READ      FAINCMP                                53
     C  N53              DO
     C     HEADFK        CHAIN     HEADFCMP                           52
     C   52              DELETE    FAINRCMP
     C                   GOTO      STDFI
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YSK
     C     FAINK         KLIST
     C                   KFLD                    FAFAKT
      *
     C                   MOVE      ' '           YSK               1
     C                   MOVE      *ZEROS        YDT
      *
     C                   ENDSR
      *
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDT          XDTFMT            4 0
     C                   MOVEL     WSDT          UDT1              2 0
     C                   MOVEL     XDTFMT        UDT2              2 0
     C                   MOVE      XDTFMT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVEL     UDT1          WSDT
     C                   MOVEL     UDT2          XDTFMT
     C                   MOVE      UDT3          XDTFMT
     C                   MOVE      XDTFMT        WSDT
      *
     C                   ENDSR
      *
