      *
      **************************************************************
      *** PROGRAM FOR SPøRRING/VEDLIKEHOLD TOLLAGERBEVILLINGSKODER *
      **************************************************************
      *
     H
     FGODSFI    IF   E           K DISK
     FSYTL03FB  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XULTID                 1     14  0
     D  WSDM                   7     10  0
     D  WSAA                  13     14  0
      * ER MODUL INSTALLERT ?????
     C                   MOVEL     'SYGODS  '    UMODUL           15
     C                   MOVE      '       '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        CABEQ     1             SLUTT
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     *LOVAL        SETLL     GODSFI
     C                   READ      GODSFI                                 94
     C     START2        TAG
     C  N94*IN94         DOWEQ     '0'
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   READ      GODSFI                                 94
     C  N94              END
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C*
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C     YRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   Z-ADD     1             ZRECNO
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
     C*
     C                   SETOFF                                       9830
     C*
     C*** AVSLUTT
     C   03
     COR 12              GOTO      SLUTT
     C*
     C*** FRISK OPP
     C   05              GOTO      START
     C*
     C*** LAGE NY
     C   06              DO
     C                   MOVE      *BLANKS       GFLBKO
     C                   MOVE      *BLANKS       GFENH
     C                   MOVE      '1'           UFUNK
     C                   CALL      'SYTL03'
     C                   PARM                    GFLBKO
     C                   PARM                    GFENH
     C                   PARM                    UFUNK
     C                   GOTO      START
     C                   END
     C*
     C     YRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENT
     C     REFRES        CABEQ     'J'           START
     C                   GOTO      START3
     C                   END
      *
     C     SLUTT         TAG
     C                   MOVE      WSDATO        UDATO             6
     C                   CALL      'SYGE25CL'
     C                   PARM                    UDATO
     C                   PARM                    UDAGPA            3
     C                   MOVE      UDAGPA        UDAGNR            3
     C                   MOVE      UDATO         UUDATO
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      'N'           REFRES            1
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '1'
     C                   MOVE      GFLBKO        UKOD
     C                   MOVE      GFENH         UKOD2             1
     C                   MOVE      WSDATO        UDATO             6
     C                   CALL      'SYGE25CL'
     C                   PARM                    UDATO
     C                   PARM                    UDAGPA            3
     C                   MOVE      UDAGPA        UDAGNR            3
     C                   MOVE      UDATO         UUDATO
     C                   SETON                                        LR
     C                   RETURN
     C                   END
     C  N98WSNR          IFEQ      '2'
     C                   MOVE      '2'           UFUNK
     C                   CALL      'SYTL03'
     C                   PARM                    GFLBKO
     C                   PARM                    GFENH
     C                   PARM                    UFUNK             1
     C     KEY           CHAIN     GODSFI                             33
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '3'
     C                   MOVE      '3'           UFUNK
     C                   CALL      'SYTL03'
     C                   PARM                    GFLBKO
     C                   PARM                    GFENH
     C                   PARM                    UFUNK             1
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   MOVE      'J'           REFRES            1
     C                   GOTO      SLHENT
     C                   END
     C                   END
      *
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
      *
     C     SLHENT        ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    UKOD              5
     C                   PARM                    UKOD2             1
     C                   PARM                    UUDATO            6
     C                   PARM                    UDAGNR            3
     C                   PARM                    UUPDAT            1
     C                   TIME                    XULTID
     C                   MOVE      *ZEROS        WSDATO
     C                   MOVEL     WSDM          WSDATO
     C                   MOVE      WSAA          WSDATO
     C     UUPDAT        COMP      'J'                                    50
     C     KEY           KLIST
     C                   KFLD                    GFLBKO
     C                   KFLD                    GFENH
      *
     C                   WRITE     WINDOWSZ
     C*
     C                   ENDSR
     C*
