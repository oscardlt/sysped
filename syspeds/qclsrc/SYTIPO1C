/* N01 - BEGYNNER Å BRUKE PRN-FIL FOR Å FÅ FASTE KOLONNER   */
             PGM
             DCL        VAR(&INST) TYPE(*CHAR) LEN(1) VALUE('1')
/* INLIBL slik at det kan kjøre fra jobscheduler  */
/*           CALL SYSPED/INLIBL   */
             DLTF       FILE(QTEMP/SYTIRCV)
             MONMSG     MSGID(CPF0000)
             CRTPF      FILE(QTEMP/SYTIRCV) RCDLEN(256) SIZE(100000)
/* Konverter fra PC-tekst-fil, til FLAT tekstfil  */
/* S01       QSYS/CPYFRMSTMF FROMSTMF('/HOME/SYTOLL/POSTNR.TXT') +
                          TOMBR('/QSYS.LIB/QTEMP.LIB/SYTIRCV.FILE/SYT+
                          IRCV.MBR') MBROPT(*REPLACE) CVTDTA(*AUTO) +
                          STMFCODPAG(*PCASCII)  **/
/*N01*/      QSYS/CPYFRMSTMF FROMSTMF('/HOME/SYTOLL/POSTNR.PRN') +
                          TOMBR('/QSYS.LIB/QTEMP.LIB/SYTIRCV.FILE/SYT+
                          IRCV.MBR') MBROPT(*REPLACE) CVTDTA(*AUTO) +
                          STMFCODPAG(*PCASCII)
/* Filen finnes ikke - hopp ut  */
             MONMSG     MSGID(CPFA095) EXEC(DO)
             SNDPGMMSG  MSG('Aktuell txt-fil finnes ikke i IFS +
                          /home/sytoll/   Konvertering IKKE +
                          kjørt!!!') MSGTYPE(*INFO)
             GOTO       CMDLBL(SLUTT)
             ENDDO
/* konverterer  */
/* Inn: SYTIRCV            Ut: PONRNNY */
             CLRPFM     FILE(PONRNNY)

             CALL       PGM(SYTIPO1) PARM(&INST)

 /* MODULEN IKKE INSTALLERT?? ELLER 0 POSTER LEST */
             IF         COND(&INST = '1') THEN(GOTO CMDLBL(SLUTT))
 /* ENDRET FILLAYOUT */
             IF         COND(&INST = '2') THEN(DO)
             SNDPGMMSG  MSG('Formatet på den nedlastede fil stemmer +
                          ikke med din programversjon. Ta +
                          .......... kontakt med SYSTEMA for å få +
                          oppgradert ditt program.)') MSGTYPE(*INFO)
             ENDDO

             OVRPRTF    FILE(LISTE) OUTQ(*JOB)

 /* SLETT UTGÅTTE  */
             CALL       PGM(SYTIPO2)
 /* Oppdater GAMLE KODER, OPPRETT NYE */
             CALL       PGM(SYTIPO3)

 /* TØM ARBEIDSFIL                     */
             CLRPFM     FILE(PONRNNY)

             SNDPGMMSG  MSG('Konvertering av aktuell(e) fil(er) ER +
                          KJØRT. Sjekk utkrift "LISTE".......... +
                          (For hver konvertert fil: EN LISTE for +
                          nye/endrede. EN LISTE for slettede.)') +
                          MSGTYPE(*INFO)

SLUTT:       ENDPGM
