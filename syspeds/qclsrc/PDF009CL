/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers Beskrivelse..........................               */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 YBC PTF10 SYFA55CP                                           */
/* 10XXX * 02 SH  PTF10 OVVERRIDE GJORT OM TIL AFPDS                       */
/* ********************************************************************    */
             PGM        PARM(&IN03 &AVD &TUR &BELJN &DADRJN +
                          &STMF &BANE &BANEC &VISE &INFOP +
                          &CMRBRU &CMR &AGN)
             DCL        VAR(&LPI2) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&CMRBRU) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CMR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CMRN) TYPE(*DEC) LEN(3 0) VALUE(024)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BELJN) TYPE(*CHAR) LEN(1)
             DCL        VAR(&DADRJN) TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN03) TYPE(*LGL) LEN(1) /* Hvis &in03 +
                          på, skal GODSLISTE   være stående. */
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&AGN) TYPE(*CHAR) LEN(8)
             DCL        VAR(&UDSFAX) TYPE(*CHAR) LEN(1) VALUE('J')
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&BANEC) TYPE(*CHAR) LEN(50)
             DCL        VAR(&PRTNA) TYPE(*CHAR) LEN(10) +
                          VALUE('SYFA55PF')
             DCL        VAR(&FILENC) TYPE(*CHAR) LEN(10) +
                          VALUE('SYFA55CP')
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
    /* */
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
    /* */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
/*                                         */
/* EKSTERNDEFINERT PRTF */
/*******************************************************************/
/***             SYFA55PF / SYFA55CP    VED D=DIREKTE    ***********/
/*******************************************************************/
             IF         COND(&INFOP = 'D') THEN(DO)
             OVRPRTF    FILE(SYFA55PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) CPI(15) OVRFLW(64) OUTQ(OUTMAIL) +
                          TOSTMF(&BANE) WSCST(*PDF)
             OVRPRTF    FILE(SYFA55CP) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(72) PAGRTT(0) +
                          FRONTOVL(CM1) OUTQ(OUTMAIL) +
                          TOSTMF(&BANEC) WSCST(*PDF)
             ENDDO
/*******************************************************************/
/***             SYFA55PF / SYFA55CP    INFOPRINT   ****************/
/*******************************************************************/
             IF         COND(&INFOP *NE  'D') THEN(DO)
             OVRPRTF    FILE(SYFA55PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) CPI(15) OVRFLW(64) OUTQ(OUTMAIL)
             OVRPRTF    FILE(SYFA55CP) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(72) PAGRTT(0) +
                          FRONTOVL(CM1) OUTQ(OUTMAIL) HOLD(*YES)
             ENDDO
                          /*N01*/
/*                                         */
             CHGDTAARA  DTAARA(*LDA (30 1)) VALUE(&CMR)
             CHGDTAARA  DTAARA(*LDA (961 1)) VALUE(&CMRBRU)
    /* ----------------------------------------------------------- */
    /* */
    /* ----------------------------------------------------------- */
    /* SKRIVER UT GODSLISTE */

             CALL       PGM(SYFA55) PARM(&AVD &TUR &AGN &BELJN +
                          &UDSFAX &DADRJN)
/*******************************************************************/
/***  RETURNER VED D = DIREKTE                      ****************/
/*******************************************************************/
             IF         COND(&INFOP = 'D') THEN(RETURN)
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&PRTNA) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&PRTNA &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
/*                                       */
/* CMR */
/*                                       */
             RLSSPLF    FILE(&FILENC) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF3309 CPF3303 CPF3322) EXEC(DO)
             GOTO       CMDLBL(SLUTT)
             ENDDO
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILENC) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANEC) ORIENTAT(*V)
             DLTSPLF    FILE(&FILENC) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
                          ENDDO
/*                                       */
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE           */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILENC &QNBR &QUSER &QJOB +
                          &BANEC)
                          ENDDO
/*                                       */
             RMVLIBLE   LIB(MMAIL)
/*                                       */
/*                                         */
/*                                         */
SLUTT:       DLTSPLF    FILE(&PRTNA) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
             DLTSPLF    FILE(FILENC) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
    /* */

             ENDPGM
