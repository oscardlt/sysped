/*  BYTTET GETPR2 MED GETPRN FOR DRAWER OG ANTAL.L KOPIER */
             PGM        PARM(&KOPI)
             DCL        VAR(&DRAWER) TYPE(*CHAR) LEN(7)
             DCL        VAR(&DRAWUT) TYPE(*CHAR) LEN(11)
             DCL        VAR(&COPIES)  TYPE(*CHAR) LEN(6)
             DCL        VAR(&PNAVN)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&LOGO)  TYPE(*CHAR) LEN(9)
             DCL        VAR(&ATYPE) TYPE(*CHAR) LEN(2) VALUE('ae')
             DCL        VAR(&FINS) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&AUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT) TYPE(*CHAR) LEN(10) /* Printernavn +
                          til fakturaer. */
             DCL        VAR(&PT) TYPE(*CHAR) LEN(10) /* Papirtype til +
                          fakturaer. */
             DCL        VAR(&PRT2) TYPE(*CHAR) LEN(10) /* Printernavn +
                          til merkelapp-2. */
             DCL        VAR(&PT2) TYPE(*CHAR) LEN(10) /* Papirtype +
                          til merkelapp-2. */
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
             DCL        VAR(&KOPI) TYPE(*CHAR) LEN(1) /* KOPI-  +
                          utskrifter. */
             DCL        VAR(&UFAX) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&UAVD) TYPE(*CHAR) LEN(4) VALUE('0000')
             DCL        VAR(&UOPD) TYPE(*CHAR) LEN(7) VALUE('0000000')
             DCL        VAR(&LPP) TYPE(*DEC) LEN(3 0) VALUE(72)
             DCL        VAR(&CPI) TYPE(*DEC) LEN(2 0) VALUE(10) /* +
                          Antall tegn pr. tomm. */
             DCL        VAR(&DOC) TYPE(*DEC) LEN(3 0) VALUE(013)
             DCL        VAR(&LPI2) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&LASER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
    /* */
 RTVTIME:    RTVJOBA    USER(&AUSER)
    /* */
             RTVDTAARA  DTAARA(*LDA (701 10)) RTNVAR(&PRT)
             RTVDTAARA  DTAARA(*LDA (711 10)) RTNVAR(&PT)
             RTVDTAARA  DTAARA(*LDA (621 10)) RTNVAR(&PRT2)
             RTVDTAARA  DTAARA(*LDA (631 10)) RTNVAR(&PT2)
    /* */
    /* SJEKKER OM LASER */
    /* */
             RTVDTAARA  DTAARA(*LDA (15 4)) RTNVAR(&AVD)
             CALL       PGM(GETPRN) PARM(&AVD &DOC &PNAVN &FORM +
                          &LASER &LPI2 &DRAWER &COPIES &LOGO &DRAWUT)
             IF         COND(&LASER = 'J') THEN(DO)
             CHGVAR     VAR(&LPP) VALUE('070')
             ENDDO
    /* */
             OVRPRTF    FILE(SYEX40PF) PAGESIZE(&LPP 80) CPI(10) +
                          OVRFLW(&LPP) DRAWER(&DRAWER) +
                          OUTBIN(&DRAWUT) FRONTOVL(&LOGO) +
                          OUTQ(&PRT) FORMTYPE(&PT) COPIES(&COPIES)
             IF         COND(&LASER *NE 'P' *AND &LASER *NE 'F') +
                          THEN(DO)

             OVRPRTF    FILE(SYEX40PF) DEV(&PRT) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) OVRFLW(60) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             ENDDO

    /*                                    */
    /* SLUTT PÅ IKKE PDF                  */
    /*                                    */
    /*                                    */
    /* START FOR PDF DOKUMENTER           */
    /*                                    */

             IF         COND(&LASER = 'P') THEN(DO)
/* */
             OVRPRTF    FILE(SYEX40PF) DEV(&PRT) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) OVRFLW(60) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FNTCHRSET(*LIBL/C0D0GT10 *LIBL/T1V10277) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             ENDDO
    /* SLUTT PÅ PDF                  */

    /* START FOR AFP DOKUMENTER           */
    /*                                    */
             IF         COND(&LASER = 'F') THEN(DO)
             OVRPRTF    FILE(SYEX40PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) FRONTMGN(0.0 0.30) OVRFLW(60) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             ENDDO
    /* SLUTT PÅ AFP                  */

    /*            */
             OVRPRTF    FILE(MERKL2) PAGESIZE(24 50) +
                          CPI(10) OVRFLW(24) OUTQ(&PRT2) FORMTYPE(&PT2)
             OVRMSGF    MSGF(QUSERMSG) TOMSGF(SYMSGF)
             CALL       PGM(SYEX40) PARM(&PRANT &KOPI &UAVD &UOPD +
                          &UFAX)
             SNDPGMMSG  MSG(' ' *BCAT &PRANT *BCAT 'arbeidsordre er +
                          klare til utskrift.' *BCAT &PRT *BCAT ' ') +
                          MSGTYPE(*INFO)
    /* */
             SBMJOB     CMD(CALL PGM(ARC002CL) PARM(&ATYPE &AUSER +
                          &FINS)) JOB(ARKIV) JOBD(*USRPRF) +
                          JOBQ(SYJOBQARK)
             ENDPGM
