/* WORKFIL FOR VEDLEGG   **********************************************    */
/* 01   SJEKKER OM NAS KJØRES                         */
             PGM        PARM(&ATYPE &AUSER &FINS)
             DCL        VAR(&FINS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&ATYPE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&ANTALL) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&ANTALA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&AUSER) TYPE(*CHAR) LEN(10)
/* N03  NAS */
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(14)
             DCLF       FILE(FIRMARC) RCDFMT(*ALL)
             RCVF       DEV(*FILE) RCDFMT(*FILE)
             IF         COND(&ARNAS = 'J') THEN(DO)
             CALL       PGM(SYGE89CLB) PARM(&ARCANE &PARM)
             IF         COND(&PARM = 'Lokal')       THEN(DO)
             SNDMSG     MSG('NASET ER IKKE OPPKOBLET - SYJOBQARK er +
                          HOLDT TILBAKE - Noen må ta aksjon og +
                          koble til NASET') TOMSGQ(*SYSOPR) +
                          MSGTYPE(*INQ) RPYMSGQ(QSYSOPR)
             SNDPGMMSG  MSG('NASET er ikke koblet. Arkivering +
                          stoppet. Aksjon må tas for å restarte +
                          NASET') TOUSR(&AUSER) MSGTYPE(*INQ)
             HLDJOBQ    JOBQ(SYJOBQARK)
                          ENDDO
                          ENDDO
             CALL       PGM(ARC002FA) PARM(&ATYPE &AUSER &ANTALL)
NESTE:       IF         COND(&ANTALL *GT 0) THEN(DO)
             SBMJOB     CMD(CALL PGM(ARC002) PARM(&ATYPE &AUSER +
                          &FINS)) JOB(ARKIV) JOBD(*USRPRF) +
                          JOBQ(SYJOBQARK)
             CHGVAR     VAR(&ANTALL) VALUE(&antall - 1)
             GOTO       CMDLBL(NESTE)
             ENDDO
    /* */
             ENDPGM
