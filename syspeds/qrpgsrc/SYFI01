      *
      ***********************************************************
      *** PROGRAM SKAL FIKSE MIN/MAX PRISER FOR AVTALER       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 07 09 10 13-23                ***
      *** LEDIGE INDIKATORER 27-29 35-39 41-89                ***
      ***********************************************************
      *
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FFRATN     UF   E           K DISK
     FFRAV      IF   E           K DISK
     D WP              S              1    DIM(12)
     D                 DS
     D  FB01                   1      3P 0
     D  FB02                   4      6P 0
     D  FB03                   7      9P 0
     D  FB04                  10     12P 0
     D  FB05                  13     15P 0
     D  FB06                  16     18P 0
     D  FB07                  19     21P 0
     D  FB08                  22     24P 0
     D  FB09                  25     27P 0
     D  FB10                  28     30P 0
     D  FB11                  31     33P 0
     D  FB12                  34     36P 0
     D  FB                     1     36P 0 DIM(12)
     D  FM01                  37     39P 0
     D  FM02                  40     42P 0
     D  FM03                  43     45P 0
     D  FM04                  46     48P 0
     D  FM05                  49     51P 0
     D  FM06                  52     54P 0
     D  FM07                  55     57P 0
     D  FM08                  58     60P 0
     D  FM09                  61     63P 0
     D  FM10                  64     66P 0
     D  FM11                  67     69P 0
     D  FM12                  70     72P 0
     D  FM                    37     72P 0 DIM(12)
     D                 DS
     D  KOWF1                  1      1
     D  KOWF2                  2      2
     D  KOWF3                  3      3
     D  KOWF4                  4      4
     D  KOWF5                  5      5
     D  KOWF6                  6      6
     D  KOWF7                  7      7
     D  KOWF8                  8      8
     D  KOWF9                  9      9
     D  KOWF10                10     10
     D  KOWF11                11     11
     D  KOWF12                12     12
     D  FP                     1     12    DIM(12)
     D                 DS
     D  KOVK1                  1      5  0
     D  KOVK2                  6     10  0
     D  KOVK3                 11     15  0
     D  KOVK4                 16     20  0
     D  KOVK5                 21     25  0
     D  KOVK6                 26     30  0
     D  KOVK7                 31     35  0
     D  KOVK8                 36     40  0
     D  KOVK9                 41     45  0
     D  KOVK10                46     50  0
     D  KOVK11                51     55  0
     D  KOVK12                56     60  0
     D  FIB                    1     60  0 DIM(12)
     D                 DS
     D  FRVK1                  1      5  0
     D  FRVK2                  6     10  0
     D  FRVK3                 11     15  0
     D  FRVK4                 16     20  0
     D  FRVK5                 21     25  0
     D  FRVK6                 26     30  0
     D  FRVK7                 31     35  0
     D  FRVK8                 36     40  0
     D  FRVK9                 41     45  0
     D  FRVK10                46     50  0
     D  FRVK11                51     55  0
     D  FRVK12                56     60  0
     D  FVK                    1     60  0 DIM(12)
     D  FVKX                   1     60
     C*
     C                   EXSR      INIT
     C*
     C     FRATK         SETLL     FRATN
     C                   SETOFF                                       33
     C     START         TAG
     C                   READ      FRATN                                  33
     C   33              GOTO      SLUTT
     C*
     C     FRAVK         CHAIN     FRAV                               34
     C   34              MOVE      *ZEROS        FVK
     C                   EXSR      SRFM
     C                   EXCEPT    UPDFRT
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SRFM          BEGSR
     C***********************************************
     C                   Z-ADD     0             NR                2 0
     C                   MOVE      *BLANKS       WP
     C     NR            DOWLT     FTFAST                                        2<-B
     C                   ADD       1             NR
     C                   MOVE      'F'           WP(NR)
     C                   END                                                     2<-E
     C*
     C     FTPRPR        IFEQ      0                                            1<-B
     C                   MOVE      KOVOMR        FTPRPR
     C                   END                                                    1<-E
     C     FTPRPR        IFEQ      0                                            1<-B
     C                   Z-ADD     1             FTPRPR
     C                   END                                                    1<-E
     C                   Z-ADD     0             YPRIS             5 0
     C                   Z-ADD     1             NR
     C*
     C     FTMM          IFEQ      1                                            1<-B
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FB(NR)        YPRIS
     C                   END                                                     2
     C     FTMIN         IFGT      YPRIS                                         2<-B
     C                   Z-ADD     FTMIN         YPRIS
     C                   END                                                     2
     C*
     C     STMM1         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C     FB(NR)        IFGT      YPRIS                                         2<-B
     C                   Z-ADD     FB(NR)        FM(NR)
     C                   Z-ADD     FB(NR)        YPRIS
     C                   ELSE                                                    2
     C                   Z-ADD     YPRIS         FM(NR)
     C                   END                                                     2
     C                   ELSE                                                    2
     C                   Z-ADD     YPRIS         FM(NR)
     C* AVTALESPESIFIK VEKTINNDELING ???
     C     FVKX          IFEQ      *ZEROS
     C     FIB(NR)       MULT      FB(NR)        WORK              8 0
     C                   ELSE
     C                   MOVE      99999         FVK(12)
     C     FVK(NR)       MULT      FB(NR)        WORK              8 0
     C                   END
     C     WORK          DIV       FTPRPR        YPRIS
     C     YPRIS         IFLT      FM(NR)                                         3<-B
     C                   Z-ADD     FM(NR)        YPRIS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C* AVTALESPESIFIK VEKTINNDELING ???
     C     FVKX          IFEQ      *ZEROS                                        2<-B
     C     FIB(NR)       IFNE      99999                                          3<-B
     C                   ADD       1             NR
     C     NR            IFLE      12                                              4<-B
     C                   GOTO      STMM1
     C                   END                                                       4<-E
     C                   END                                                      3<-B
     C                   ELSE                                                    2
     C     FVK(NR)       IFNE      99999                                          3<-B
     C                   ADD       1             NR
     C     NR            IFLE      12                                              4<-B
     C                   GOTO      STMM1
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*
     C                   END                                                    1<-E
     C*
     C     FTMM          IFEQ      2                                            1<-B
     C*
     C                   Z-ADD     2             N2                2 0
     C     STMM2         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FB(NR)        FM(NR)
     C                   ELSE                                                    2
     C* AVTALESPESIFIK VEKTINNDELING ???
     C     FVKX          IFEQ      *ZEROS
     C     FIB(NR)       MULT      FB(N2)        WORK              8 0
     C                   ELSE
     C     FVK(NR)       MULT      FB(N2)        WORK              8 0
     C                   END
     C     WORK          DIV       FTPRPR        FM(NR)
     C                   END                                                     2<-E
     C* AVTALESPESIFIK VEKTINNDELING ???
     C     FVKX          IFEQ      *ZEROS
     C     FIB(N2)       IFNE      99999
     C                   ADD       1             NR
     C                   ADD       1             N2
     C     N2            IFLT      13
     C                   GOTO      STMM2
     C                   END
     C                   END
     C                   ELSE
     C     FVK(N2)       IFNE      99999
     C                   ADD       1             NR
     C                   ADD       1             N2
     C     N2            IFLT      13
     C                   GOTO      STMM2
     C                   END
     C                   END
     C                   END
     C*
     C                   END                                                    1<-E
     C*
     C     FTKOLL        IFEQ      'X'
     C                   MOVE      *ZEROS        FTPRPR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODTWK        KLIST
     C                   KFLD                    KOWUNI
     C                   KFLD                    KOWAVD
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C     FRATK         KLIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C     FRAVK         KLIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C*
     C                   MOVE      'W'           KOWUNI            1
     C                   MOVE      'V'           KOVUNI            1
     C                   MOVE      *ZEROS        FB
     C                   MOVE      *ZEROS        FM
     C*
     C     KODTWK        SETLL     KODTW
     C                   SETOFF                                       33
     C                   READ      KODTW                                  33
     C     KODTVK        SETLL     KODTV
     C                   SETOFF                                       33
     C                   READ      KODTV                                  33
     C                   MOVE      '99999'       KOVK12
     C*
     C                   ENDSR
     C*
     OFRATR     E            UPDFRT
     O                       FM01
     O                       FM02
     O                       FM03
     O                       FM04
     O                       FM05
     O                       FM06
     O                       FM07
     O                       FM08
     O                       FM09
     O                       FM10
     O                       FM11
     O                       FM12
