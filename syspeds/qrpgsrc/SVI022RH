     FSVIH      IF   E           K DISK
     FSVIF      IF   E           K DISK
     FSVIX      IF   E           K DISK
     FSVIZ      IF   E           K DISK
     FSVTVK     IF   E           K DISK
     FSVTFI     IF   E             DISK
     FSVIHE     O  A E             DISK
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1     70
     D                                     DIM(70)                              Input string
     D  ADS                    1     70
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1     80
     D                                     DIM(80)                              Output string
     D  SVIHE_DTA              1     80
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN154                  1     15  4
     D  ØA154H                 1     11
     D  ØA154D                12     15
     D                 DS
     D  ØA16                   1     16
     D  Ø16                    1     16
     D                                     DIM(16)                              Num edit
      *____________
      * DS for EORI
      *""""""""""""
     D                 DS
     D  WEORI                  1     17
     D  WEORIA                 1      2
     D  WEORIB                 3     17
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SVIH_SYAV     UVIH_SYAV
     C     *LIKE         DEFINE    SVIH_SYOP     UVIH_SYOP
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             7 0
     C                   Z-ADD     80            LEN               5 0
     C                   MOVEL     'EUNOAO  '    TABLE            10
     C*                  MOVEL     'SVGSENO '    TABLE            10
     C                   MOVEL     '*LIBL   '    LIB              10
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                2 0          Index for B
     C                   Z-ADD     0             AXV               2 0          Leftindx A
     C                   Z-ADD     0             AXH               2 0          Rightindx A
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
     C                   EVAL      SVIHE_SYA=UVIH_SYAV
     C                   EVAL      SVIHE_SYO=UVIH_SYOP
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVIH_SYAV
     C                   PARM                    UVIH_SYOP
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     SVIH

      *_____________
      * Huvudsektion
      *"""""""""""""
      * Meddelandeingress
     C                   EXSR      UNH00
      * Meddelandebørjan
     C                   EXSR      BGM00
      * Plats lokaliseringsidentifikation
     C                   EXSR      LOC00
      * Generell indikator
     C                   EXSR      GIS00
      * Referenser
     C                   EXSR      RFF01
      * Transportdetaljer
     C                   EXSR      TDT04
      * Namm och adress, Behørig att begæra klarering
     C                   EXSR      NAD06B
      * Namm och adress, Avsændare
     C                   EXSR      NAD06C
      * Namm och adress, Mottagare (importør)
     C                   EXSR      NAD06D
      * Namm och adress, Deklarant
     C                   EXSR      NAD06F
      * Namm och adress, Ombud
     C                   EXSR      NAD06A
      * Leveransvillkår
     C                   EXSR      TOD07
      * Belopp
     C                   EXSR      MOA08
      * Seksjonskille
     C                   EXSR      UNSD
      *______________
      * Detaljsektion
      *""""""""""""""
      * Skrive ut meldingsvarelinjer til EDIFACT-fil
     C                   EXSR      CST30
      * Seksjonskille
     C                   EXSR      UNSS
      *_____________
      * Summasektion
      *"""""""""""""
      * Meddelandeslut
     C                   EXSR      CNT00
      * Meddelandeslut
     C                   EXSR      UNT00
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_________________
      * Trim left blanks
      *"""""""""""""""""
     C                   MOVEL(P)  ADS           ADS2             70
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS=%TRIML(ADS2)
      *_______________
      * Find positions
      *""""""""""""""""
     C                   EVAL      AXV=1
     C     ' '           CHECKR    ADS           AXH
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WCHAR         IFEQ      ';'                                                      III
     C                   MOVE      ':'           WCHAR
     C                   ENDIF                                                    <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   END                                                     <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I
      * If arrayindex for output array is over 80 Then add a record      I
     C     BX            IFGT      80                                            <-----------II
     C                   WRITE     SVIHER                                                    II
     C                   Z-ADD     1             BX                                          II
     C                   MOVE      *BLANKS       SVIHE_DTA                                   II
     C                   END                                                     <-----------II
      *                                                                  I
     C                   END                                                    <-------------I
      *
     C                   MOVE      'Y'           WCHART
     C                   EVAL      ADS=*BLANKS
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX
     C     BX            IFGT      80                                           <-------------I
     C                   WRITE     SVIHER                                                     I
     C                   Z-ADD     1             BX                                           I
     C                   MOVE      *BLANKS       SVIHE_DTA                                    I
     C                   END                                                    <-------------I
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA16
     C     ØA154D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA154H        ØA16                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA154H        ØA16                                         I
     C                   MOVE      '.    '       ØA16                                         I
     C                   MOVE      ØA154D        ØA16                                         I
     C     Ø16(16)       IFEQ      '0'
     C                   MOVE      ' '           Ø16(16)
     C     Ø16(15)       IFEQ      '0'
     C                   MOVE      ' '           Ø16(15)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        15            ØX                             <-------------I
     C     Ø16(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø16(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandeingress                                  UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVEL     'UNH+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVEL     SVIH_SYAV     W0062            11
     C                   MOVE      SVIH_SYOP     W0062
     C                   MOVEL     W0062         ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVEL     'CUSDEC'      ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEA     ':D:96B:U'    A(1)
     C                   MOVEA     'N:145050'    A(9)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL(P)  WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandebørjan                                   BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='BGM+'+SVIH_MTYP+':::'+SVIH_DEK1+'++'
     C                             + SVIH_DEK2+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontroll totaler                                   CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
      * Antall kolli
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_KOTA
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+11:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kommunikationskontakter, Ombud                    COM06A /
      *////////////////////////////////////////////////////////////
     C     COM06A        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'COM+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationsnummer
     C                   MOVEL     SVIH_OMTL     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskanal kvalificerare
     C                   MOVEL     'TE'          ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kommunikationskontakter, Deklarant                COM06F /
      *////////////////////////////////////////////////////////////
     C     COM06F        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'COM+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationsnummer
     C                   MOVEL     SVIH_DKTL     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskanal kvalificerare
     C                   MOVEL     'TE'          ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Handlæggare, Ombud                                CTA06A /
      *////////////////////////////////////////////////////////////
     C     CTA06A        BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='CTA+AH+:'+%trimr(SVIH_OMHA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Handlæggare, Deklarant                            CTA06F /
      *////////////////////////////////////////////////////////////
     C     CTA06F        BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='CTA+AH+:'+%trimr(SVIH_DKHA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varupostnivå                                       CST30 /
      *////////////////////////////////////////////////////////////
     C     CST30         BEGSR

     C                   ADD       1             W0074
     C                   EVAL      ADS='CST+'+'0'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Andra segment under CST
     C                   EXSR      FTX30
     C                   EXSR      LOC30
     C                   EXSR      MEA30
     C                   EXSR      PAC31
     C                   EXSR      RFF35
     C                   EXSR      DOC37A
     C                   EXSR      DOC37B
     C                   EXSR      GIS40

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fakturanummer                                     DOC37A /
      *////////////////////////////////////////////////////////////
     C     DOC37A        BEGSR
      *
     C     KEYA          SETLL     SVIF                                   20
     C     *IN20         CABEQ     *OFF          DOC378
     C     KEYA          READE     SVIF                                   20
     C     *IN20         DOWEQ     *OFF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'DOC+ZBH:::'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fakturatyp
     C                   MOVEL     SVIF_FATY     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fakturanummer
     C                   MOVEL     SVIF_FATX     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     KEYA          READE     SVIF                                   20
     C                   ENDDO                                                    3<-E
     C                   GOTO      DOC379

      * Fantes ikke i SVIF, bruk info på ærendenivå
     C     DOC378        TAG
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'DOC+ZBH:::'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fakturatyp
     C                   MOVEL     SVIH_FATY     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fakturanummer
     C                   MOVEL     SVIH_FATX     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     DOC379        TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tidigare handlingar (tullid)                      DOC37B /
      *////////////////////////////////////////////////////////////
     C     DOC37B        BEGSR
     C     SVIH_TID3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIH_TID1)+'::'
     C                             + %trimr(SVIH_TID2)+'+'
     C                             + %trimr(SVIH_TID3)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varuslag                                           FTX30 /
      *////////////////////////////////////////////////////////////
     C     FTX30         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varuslag
     C                   MOVEL     SVIH_VASL     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

      *_______________________
      * Særskilda upplysningar
      *"""""""""""""""""""""""
      * Från egen fil
     C                   EXSR      FTX30X
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Godsbeskrivning                                    GDS31 /
      *////////////////////////////////////////////////////////////
     C     GDS31         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'GDS+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Artikkelnummers kvalificerare
     C                   MOVEL     '5'           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS00 /
      *////////////////////////////////////////////////////////////
     C     GIS00         BEGSR
      *__________
      * Container
      *""""""""""
     C     SVIH_CONT     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+%trimr(SVIH_CONT)+':109'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ELSE
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+'0'+':109'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________________________________
      * Avdragsrætt enligt merværdesskattelagen ?
      *""""""""""""""""""""""""""""""""""""""""""
     C     SVIH_MTYP     IFEQ      'OMP'
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+J:AML'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________
      * Kvalitetssækrad ?
      *""""""""""""""""""
     C     1             CHAIN     SVTFI                              23
     C     SVTF_KVAL     IFEQ      'J'
     C     *IN23         ANDEQ     *OFF
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+J:ZKS'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS40 /
      *////////////////////////////////////////////////////////////
     C     GIS40         BEGSR
      *_________________
      * Åtgærdsindikator
      *"""""""""""""""""
     C     SVIH_CALL     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+SVIH_CALL+':Z11'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________
      * Førfarande 37:1
      *""""""""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+1:ZF::'+SVIH_EUP1+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plats/lokaliseringsidentifikation                  LOC00 /
      *////////////////////////////////////////////////////////////
     C     LOC00         BEGSR
      *_____________
      * Godslokalkod
      *"""""""""""""
     C     SVIH_GOLK     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '18'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIH_GOLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
      *________________
      * Avsændningsland
      *""""""""""""""""
     C     SVIH_AVUT     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '35'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIH_AVUT     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plats/lokaliseringsidentifikation                  LOC30 /
      *////////////////////////////////////////////////////////////
     C     LOC30         BEGSR
      *______________
      * Ursprungsland
      *""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '27'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIH_AVUT     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Id av lager
      *""""""""""""
     C     SVIH_LAGI     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     'ZIL'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIH_LAGI     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Typ av lager
     C                   MOVEL     SVIH_LAGT     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '::'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C                   MOVEL     SVIH_LAGL     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Ombud                            NAD06A /
      *////////////////////////////////////////////////////////////
     C     NAD06A        BEGSR
     C     SVIH_OMEO     IFNE      *BLANKS
     C                   EVAL      WEORI=SVIH_OMEO
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+AE+'+%trimr(WEORIB)
     C                             + ':'+%trimr(WEORIA)
     C                             + '+2'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskontakter
     C                   EXSR      CTA06A
     C                   EXSR      COM06A
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Behørig att begæra klarering     NAD06B /
      *////////////////////////////////////////////////////////////
     C     NAD06B        BEGSR
     C     SVIH_KLEO     IFNE      *BLANKS
     C                   EVAL      WEORI=SVIH_KLEO
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+BK+'+%trimr(WEORIB)
     C                             + ':'+%trimr(WEORIA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Avsændare                        NAD06C /
      *////////////////////////////////////////////////////////////
     C     NAD06C        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CZ+++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Navn
     C                   MOVEL     SVIH_AVNA     ADS
     C                   EXSR      SRÅ
      * Adress-1
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     SVIH_AVA1     IFEQ      *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     SVIH_AVA1     ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * Adress-2
     C     SVIH_AVA2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIH_AVA2     ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postadress
     C                   MOVEL     SVIH_AVPA     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postnummer
     C                   MOVEL     SVIH_AVPN     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C                   MOVEL     SVIH_AVLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Mottagare (importør)             NAD06D /
      *////////////////////////////////////////////////////////////
     C     NAD06D        BEGSR
     C                   EVAL      WEORI=SVIH_MOEO
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CN+'+%trimr(WEORIB)
     C                             +':'+%trimr(WEORIA)
     C                             +'++'+%trimr(SVIH_MONA)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adress-1
     C                   EVAL      ADS='+'+%trimr(SVIH_MOA1)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adress-2
     C     SVIH_MOA2     IFNE      *BLANKS
     C                   EVAL      ADS=':'+%trimr(SVIH_MOA2)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postadress
     C                   EVAL      ADS=%trimr(SVIH_MOPA)+'++'+%trimr(SVIH_MOPN)
     C                             + '+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C     SVIH_MOLK     IFEQ      *BLANKS
     C                   MOVEL     'SE'          ADS
     C                   ELSE
     C                   MOVEL     SVIH_MOLK     ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Deklarant                        NAD06F /
      *////////////////////////////////////////////////////////////
     C     NAD06F        BEGSR
     C                   EVAL      WEORI=SVIH_DKEO
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+DT+'+%trimr(WEORIB)
     C                             + ':'+%trimr(WEORIA)
     C                             +'++'+%trimr(SVIH_DKNA)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adress-1
     C                   EVAL      ADS='+'+%trimr(SVIH_DKA1)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adress-2
     C     SVIH_DKA2     IFNE      *BLANKS
     C                   EVAL      ADS=':'+%trimr(SVIH_DKA2)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postadress
     C                   EVAL      ADS=%trimr(SVIH_DKPA)+'++'+%trimr(SVIH_DKPN)
     C                             + '+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C                   MOVEL     SVIH_DKLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskontakter
     C                   EXSR      CTA06F
     C                   EXSR      COM06F
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSD /
      *////////////////////////////////////////////////////////////
     C     UNSD          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVEL     'UNS+D'       ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSS /
      *////////////////////////////////////////////////////////////
     C     UNSS          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVEL     'UNS+S'       ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Valutor, fraktkostnad                             CUX06E /
      *////////////////////////////////////////////////////////////
     C     CUX06E        BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_VUKU
     C                   EXSR      SRNE
     C                   EVAL      ADS='CUX+++'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mått varulinje                                     MEA30 /
      *////////////////////////////////////////////////////////////
     C     MEA30         BEGSR
      *___________
      * Bruttovikt
      *"""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'MEA+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måttapplikations kvalificerare
     C                   MOVEL     'WT+AAB'      ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måttenhetens kvalificerare
     C                   MOVEL     'KGM'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Mått p
     C                   EVAL      ØN154=SVIH_BRUT
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Belopp, huvudnivå                                  MOA08 /
      *////////////////////////////////////////////////////////////
     C     MOA08         BEGSR
      *________________
      * Førsækringssats
      *""""""""""""""""
     C                   IF        SVIH_VUFO > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_VUFO
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+70:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________
      * Annan rabatt
      *"""""""""""""
     C                   IF        SVIH_ANRA > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_ANRA
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+103:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *____________
      * Kassarabatt
      *""""""""""""
     C                   IF        SVIH_KARA > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_KARA
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+142:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________
      * Fraktkostnad
      *"""""""""""""
     C                   IF        SVIH_VUFR > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_VUFR
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+144:'+%trimr(ØAN)+':'
     C                             + %trimr(SVIH_VUVA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EXSR      CUX06E
     C                   ENDIF
      *________________
      * Andra kostnader
      *""""""""""""""""
     C                   IF        SVIH_OVKO > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_OVKO
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+160:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Førpackning                                        PAC31 /
      *////////////////////////////////////////////////////////////
     C     PAC31         BEGSR

     C     KEYA          CHAIN     SVIX                               22
     C  N22SVIX_KOT2     COMP      0                                    2222

     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_KOTA
     C  N22              EVAL      ØN154=SVIX_KOT2
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%trimr(SVIH_KOSL)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Førpackningsidentifikation
     C                   EXSR      PCI32
      * Finns det fler antal och kollislag ?
     C                   EXSR      PAC31X
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Førpackningsidentifikation                         PCI32 /
      *////////////////////////////////////////////////////////////
     C     PCI32         BEGSR
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIH_GODM     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
      *_______
      * Tullid
      *"""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ZTI:'+%trimr(SVIH_TUID)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________________
      * Uppgiftlæmnarens referansnummer
      *""""""""""""""""""""""""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ABE:'+%trimr(SVIH_RFAB)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________________________
      * Ytterligare referensnummer (godsnummer)
      *""""""""""""""""""""""""""""""""""""""""
     C     SVIH_RFAC     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ACD:'+%trimr(SVIH_RFAC)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIH_RFAC2    IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ACD:'+%trimr(SVIH_RFAC2)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________
      * Klareringsenhets id.
      *"""""""""""""""""""""
     C     SVIH_KENH     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+CLU:'+%trimr(SVIH_KENH)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF35 /
      *////////////////////////////////////////////////////////////
     C     RFF35         BEGSR
      *__________
      * Container
      *""""""""""
     C     SVIH_CONT     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIH_CONN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Finns det fler containernr ?
     C                   EXSR      RFF35Z
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens x-tra contanernr                         RFF35Z /
      *////////////////////////////////////////////////////////////
     C     RFF35Z        BEGSR
     C     KEYA          CHAIN     SVIZ                               22
     C     *IN22         IFEQ      *OFF
     C     SVIZ_CON2     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON2)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON3)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON4     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON4)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON5     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON5)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON6     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON6)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON7     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON7)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON8     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON8)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIZ_CON9     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIZ_CON9)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Særskilfda upplysningar .....mer                 FTX30X /
      *////////////////////////////////////////////////////////////
     C     FTX30X        BEGSR

     C     KEYA          CHAIN     SVIX                               22
     C     *IN22         IFEQ      *OFF

      * Rad 1
     C     SVIX_SUK1     IFNE      *BLANKS
     C     SVIX_SUT1     ORNE      *BLANKS

     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+SU++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_SUK1     IFNE      *BLANKS
     C                   MOVEL     SVIX_SUK1     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT1     IFNE      *BLANKS
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT1     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT2     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT3     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT3     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT4     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT4     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT5     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT5     ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Rad 2
     C     SVIX_SUK6     IFNE      *BLANKS
     C     SVIX_SUT6     ORNE      *BLANKS

     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+SU++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_SUK6     IFNE      *BLANKS
     C                   MOVEL     SVIX_SUK6     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT6     IFNE      *BLANKS
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT6     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT7     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT7     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT8     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT8     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT9     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT9     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT10    IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT10    ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Rad 3
     C     SVIX_SUK11    IFNE      *BLANKS
     C     SVIX_SUT11    ORNE      *BLANKS

     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+SU++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_SUK11    IFNE      *BLANKS
     C                   MOVEL     SVIX_SUK11    ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT11    IFNE      *BLANKS
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT11    ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT12    IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT12    ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT13    IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT13    ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT14    IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT14    ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIX_SUT15    IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIX_SUT15    ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Extra kolli antall och slag                       PAC31X /
      *////////////////////////////////////////////////////////////
     C     PAC31X        BEGSR
     C     KEYA          CHAIN     SVIX                               22
     C     *IN22         IFEQ      *OFF
      * Rad 3
     C     SVIX_KOT3     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT3
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS3:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD3     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Rad 4
     C     SVIX_KOT4     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT4
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS4:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD4     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD4     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Rad 5
     C     SVIX_KOT5     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT5
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS5:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD5     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD5     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Rad 6
     C     SVIX_KOT6     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT6
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS6:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD6     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD6     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Rad 7
     C     SVIX_KOT7     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT7
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS7:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD7     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD7     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Rad 8
     C     SVIX_KOT8     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT8
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS8:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD8     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD8     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Rad 9
     C     SVIX_KOT9     IFGT      0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIX_KOT9
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+6+++'+%subst(SVIX_KOS9:1:2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIX_GOD9     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIX_GOD9     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetaljer                                  TDT04 /
      *////////////////////////////////////////////////////////////
     C     TDT04         BEGSR
      *______________________________
      * Typ av inrikes transportmedel
      *""""""""""""""""""""""""""""""
     C     SVIH_TRIN     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+1++'+%trimr(SVIH_TRIN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________________
      * Typ av aktivt transportmedel
      *"""""""""""""""""""""""""""""
     C     SVIH_TRGR     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+11++'+%trimr(SVIH_TRGR)+'+++++:::'
     C                             + ':'+%trimr(SVIH_TRAL)
     C                             + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leveransvillkår                                    TOD07 /
      *////////////////////////////////////////////////////////////
     C     TOD07         BEGSR
     C     SVIH_LEKD     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TOD+5++'+%trimr(SVIH_LEKD)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Ort
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+1+'+%trimr(SVIH_LEOR)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                      UNT00 /
      *////////////////////////////////////////////////////////////
     C     UNT00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'UNT+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall segmenter i meldingen (inkludert UNH og UNT)
     C                   EVAL      ØN154=W0074
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVEL     W0062         ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     BX            IFGT      1
     C                   WRITE     SVIHER
     C                   ENDIF
      *
     C                   ENDSR
