********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 CB  PTF12 Ny variabel
12XXX * 06 YBC PTF12 Filstørrelse økes til 90000
      *********************************************************************
     FHEADF     IF   E           K DISK
     FDKXGH     UF   E           K DISK
     FDKXGD     IF   E           K DISK
     FDKXH      UF   E           K DISK
     FDKXHFV    IF   E           K DISK
     FDKXHK     UF   E           K DISK
     FDKXHFS    IF   E           K DISK
     FDKXHGB    IF   E           K DISK
     FDKXHGN    IF   E           K DISK
     FDKXV      UF   E           K DISK
     FDKXVFV    IF   E           K DISK
     FDKXVAM    IF   E           K DISK
     FDKXVCN    IF   E           K DISK
     FDKXVDK    IF   E           K DISK
     FDKXVFS    IF   E           K DISK
     FDKXVMN    IF   E           K DISK
     FDKXVTD    IF   E           K DISK
     FDKXVVT    IF   E           K DISK
     F*KTVS     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  TS                     1     64
     D                                     DIM(8)                               Transit tollsted
     D  THTSD1                 1      8
     D  THTSD2                 9     16
     D  THTSD3                17     24
     D  THTSD4                25     32
     D  THTSD5                33     40
     D  THTSD6                41     48
     D  THTSD7                49     56
     D  THTSD8                57     64
     D                 DS
     D  FT                     1    350
     D                                     DIM(5)                               Kanselleringsgrunnla
     D  TKFT1                  1     70
     D  TKFT2                 71    140
     D  TKFT3                141    210
     D  TKFT4                211    280
     D  TKFT5                281    350
     D                 DS
     D  THLKR1                 1      2
     D  THLKR2                 3      4
     D  THLKR3                 5      6
     D  THLKR4                 7      8
     D  THLKR5                 9     10
     D  THLKR6                11     12
     D  THLKR7                13     14
     D  THLKR8                15     16
     D  LKR                    1     16    DIM(8)
     D                 DS
     D  THAVD                  1      4  0
     D  THTDN                  5     11  0
     D  X11S                   1     11
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1   2048    DIM(2048)
     D  ADS                    1   2048
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
S05  D* B                      1  10000    DIM(10000)
S05  D* BDS                    1  10000
N05  D* B                      1  30000    DIM(30000)
N05  D* BDS                    1  30000
S06  D* B                      1  60000    DIM(60000)
S06  D* BDS                    1  60000
N06  D  B                      1  90000    DIM(90000)
N06  D  BDS                    1  90000
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN163                  1     16  3
     D  ØA163H                 1     13
     D  ØA163X                 5     13
     D  ØA163D                14     16
     D                 DS
     D  ØA13                   1     13
     D  Ø13                    1     13    DIM(13)
     D                 DS
     D  TVVNT                  1      6  0
     D  X_TVVNT                1     10
     D  X_TVVNT2               7     10
      *//////////////
      *  Hodelogikk /
      *//////////////
      * Initiering av variabler og nøkler
     C                   EXSR      SRA
      * Plukk SAD og send til Tollvesenet
     C                   EXSR      SRC
      *
     C                   MOVE      '1'           *INLR
      *
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    THSGDK        USGDK
     C     *LIKE         DEFINE    THBYTE        UBYTE
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              13
     C                   Z-ADD     0             W0074             7 0
     C                   Z-ADD     0             WORK             15 5
     C                   MOVEL     *BLANKS       UWS              10
     C                   MOVEL     'TVINN'       UWS
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     KEYE          KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    TVLI
     C     HEADFK        KLIST
     C                   KFLD                    TVAVD2
     C                   KFLD                    TVTDN2
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
      *_____________
      * Init av felt
      *"""""""""""""
      * Hente dagens dato og klokkeslett.
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                5 0          Index for B
     C                   Z-ADD     0             AXV               5 0          Leftindx A
     C                   Z-ADD     0             AXH               5 0          Rightindx A
     C                   MOVE      'R'           WDIR              1            Search direction
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
     C                   MOVE      *BLANKS       WCONT             5            Continues
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    U1N07             3
S05  C*                  PARM      BDS           UDATA         10000
S06  C*                  PARM      BDS           UDATA         40000
N06  C                   PARM      BDS           UDATA         90000
      *
     C                   MOVE      UAVD          THAVD
     C                   MOVE      UTDN          THTDN
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Les meldinger                                        SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
      *
     C     U1N07         IFEQ      '014'                                          3<-B
     C     U1N07         OREQ      '015'
     C     KEYA          CHAIN     DKXH                               82
     C     *IN82         IFEQ      '0'                                             4<-B
     C                   MOVE      'A'           THST
     C                   UPDATE    DKXHR
     C                   SELECT                                                     5<-B
     C     U1N07         WHENEQ    '014'
     C                   EXSR      KANSEL
     C     U1N07         WHENEQ    '015'
     C                   EXSR      TRANSI
     C                   ENDSL                                                      5<-E
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     U1N07         IFEQ      '026'                                           4<-B
     C                   MOVEL     THGFT1        TGGNR
     C     TGGNR         CHAIN     DKXGH                              82
     C                   IF        *IN82 = '0'                                      5<-B
     C                   MOVE      'A'           TGST
     C                   UPDATE    DKXGHR
     C                   EXSR      GARANTI
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     KEYA          CHAIN     DKXH                               82
     C                   EVAL      THST='A'
     C                   UPDATE    DKXHR

     C                   ENDSR
      *
      */////////////////////////////////////////////////////////////
      * Send garantis adgangskode til Tollvesnet                   /
      * Her skrive UNH, BGM og UNT segment                         /
      */////////////////////////////////////////////////////////////
     C     GARANTI       BEGSR

     C                   EXSR      UNH00
     C                   EXSR      BGM00G
     C                   EXSR      LOC00G
     C                   EXSR      NAD02G
     C                   EXSR      LIN09G
     C                   EXSR      UNT00

     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Send kansellering til Tollvesnet                           /
      * Her skrive UNH, BGM og UNT segment                         /
      */////////////////////////////////////////////////////////////
     C     KANSEL        BEGSR

     C     KEYA          CHAIN     DKXHK                              82
     C                   MOVE      WDT           TKDT
     C                   UPDATE    DKXHKR

     C                   EXSR      UNH00
     C                   EXSR      BGM00X
     C                   EXSR      LOC00X
     C                   EXSR      DTM00X
     C                   EXSR      FTX00X
     C                   EXSR      NAD06X
     C                   EXSR      UNS00A
     C                   EXSR      UNS00B
     C                   EXSR      UNT00
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Send transittering til Tollvesnet                          /
      * Her skrive UNH, BGM og UNT segment                         /
      */////////////////////////////////////////////////////////////
     C     TRANSI        BEGSR

     C     KEYA          CHAIN     DKXHFV                             33
     C                   IF        *IN33
     C                   MOVE      'N'           XFORHV            1
     C                   CLEAR                   DKXHFVR
     C                   ELSE
     C                   MOVE      'J'           XFORHV
     C                   END

     C                   EXSR      UNH00
     C                   EXSR      BGM00
     C                   EXSR      LOC00
     C                   EXSR      DTM00
     C                   EXSR      GIS00
      * TEST OM VARELINJER HAR FORSKJELLIGE AVSENDER/MOTTAKER
     C                   EXSR      TSTAM
     C                   EXSR      FII00
N04  C                   IF        THVKB <> 0
     C                   EXSR      MEA00
N04  C                   END
     C                   EXSR      EQD00
     C                   EXSR      SEL00
     C                   EXSR      FTX00
     C                   EXSR      RFF01
     C                   EXSR      TDT04
      * TEST OM VARELINJER HAR FORSKJELLIGE AVSENDER/MOTTAKER

     C                   EXSR      NAD06
     C                   EXSR      UNS00A
     C                   EXSR      CST30
     C                   EXSR      UNS00B
     C                   EXSR      CNT00
     C                   EXSR      UNT00

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsstart                                      UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNH+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     X11S          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CUSDEC'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':D:96B:U'    ADS
     C                   SELECT
     C     U1N07         WHENEQ    '014'
     C                   MOVEA     'N:CC014A'    A(9)
     C     U1N07         WHENEQ    '015'
     C                   MOVEA     'N:CC015B'    A(9)
     C     U1N07         WHENEQ    '026'
     C                   MOVEA     'N:CC026A'    A(9)
     C                   ENDSL
     C                   Z-ADD     1             AXV
     C                   Z-ADD     16            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                   BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM+:::'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      * Status
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                     LOC00 /
      *////////////////////////////////////////////////////////////
     C     LOC00         BEGSR
      *________________
      * Avgangstollsted
      *""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+118+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THCATS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      *_____________
      * Avsendesland
      *"""""""""""""
      * Segmentnavn
     C     THALK         IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+35+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLSTL        IFEQ      0
     C                   MOVEL     THALK         ADS
     C                   ELSE
     C                   MOVEL     '--'          ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      *_________________
      * Bestemmelsesland
      *"""""""""""""""""
      * Segmentnavn
     C     THBLK         IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+36+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THBLK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      *____________________
      * Avtalt kontrollsted
      *""""""""""""""""""""
      * Segmentnavn
     C                   IF        ((THENKL = 'N') AND (THENKL = 'J'))
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+26+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TULL'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END

      *__________
      * Lastested
      *""""""""""
     C                   IF        THLASD <> *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+9+'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THLASD
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________
      * SUB Lastested
      *""""""""""
     C                   IF        ((THLAS2 <> *BLANKS) AND (THENKL = 'N'))
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'LOC+26+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THLAS2
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END

     C                   END
      *
      *_________________________
      * Transitteringstollsteder
      *"""""""""""""""""""""""""
     C     1             DO        8             XN                3 0
     C     TS(XN)        IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+50+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TS(XN)        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
      *_________________________________________
      * Dato og tidspunkt for ankomst til grense
      *"""""""""""""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   IF        ((THSIK = 1) AND (XN = 1))
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      THDTA         XAN08             8
     C                   MOVE      THTMA         XAN04             4
     C                   EVAL      ADS = XAN08 + XAN04
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
     C                   END
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
     C                   ENDDO
      *____________________
      * Bestemmelsetollsted
      *""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+45+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTSB         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_____________________
      * Deklarasjonstollsted
      *"""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+91+:'    ADS
     C                   MOVEA     '::'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
N01  C                   IF        THDSTN <> *BLANKS
N01  C                   MOVEL     THDSTN        ADS
N01  C                   Z-ADD     35            AXH
N01  C                   ELSE
     C                   MOVEL     THDST         ADS
     C                   Z-ADD     15            AXH
N01  C                   ENDIF
     C                   Z-ADD     1             AXV
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+++'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THDSK         IFEQ      *BLANKS
     C                   MOVEL     'DA'          ADS
     C                   ELSE
     C                   MOVEL     THDSK         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________
      * Autorisert lagringssted
      *""""""""""""""""""""""""
      * Segmentnavn
     C     THENKL        IFEQ      'J'
     C     THLSD         ANDNE     *BLANKS
     C     THLAS2        ANDEQ     *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'LOC+14++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THLSD
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
N01   *__________
N01   * Lossested
N01   *""""""""""
N01   * Segmentnavn
N01  C                   IF        THLOSD <> *BLANKS
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'LOC+58+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THLOSDSK = *BLANKS
N01  C                   EVAL      ADS = 'DA'
N01  C                   ELSE
N01  C                   EVAL      ADS = THLOSDSK
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = ':::'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     3             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THLOSD
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     35            AXH
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dato                                               DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
      *_________________
      * Deklarasjonsdato
      *"""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+137:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WDT           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________
      * Tidsfrist for kontroll
      *"""""""""""""""""""""""
      * Segmentnavn
     C                   IF        THENKL = 'J'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+268:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDDT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS00 /
      *////////////////////////////////////////////////////////////
     C     GIS00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
      * Container
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THKDC         IFEQ      ' '
     C                   MOVE      '0'           THKDC
     C                   END
     C                   MOVEL     THKDC         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':109'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Segmentnavn
      * W0074  --->  Teller for antall segment
      * Normal eller forenklet prosedyre
     C     THENKL        IFEQ      'J'
     C     THENKL        ANDEQ     'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '1'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':119'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
N01   *
N01   * Sikkerhet
N01   * Segmentnavn
N01  C                   IF        XFORHV = 'J'
N01  C                   IF        THSIK = 1
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'GIS+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     4             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     THSIK         ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = ':187'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     4             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   ENDIF
N01  C                   ENDIF
      *
     C                   ENDSR
N01   *////////////////////////////////////////////////////////////
N01   *  Generell indikator                                 FII00 /
N01   *////////////////////////////////////////////////////////////
N01  C     FII00         BEGSR
N01   * Kommesielt referansenr
N01   * Segmentnavn
N01  C                   IF        ((THKREF <> *BLANKS) AND (XULIKKREF <> 'J'))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'FII+XX++:::::::'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     15            AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THKREF
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     70            AXH
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
N01   *
N01  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mål                                                MEA00 /
      *////////////////////////////////////////////////////////////
     C     MEA00         BEGSR
      *_________________
      * Total Bruttovekt
      *"""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'MEA+WT+A'    ADS
     C                   MOVEA     'AD+KGM:'     A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Bruttovekt
     C                   Z-ADD     THVKB         ØN163
     C                   EXSR      SRNE
     C                   EVAL      ADS = ØAN
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
N01   *////////////////////////////////////////////////////////////
N01   *  Reiserute                                          EQD00 /
N01   *////////////////////////////////////////////////////////////
N01  C     EQD00         BEGSR
N01   *
N01  C     1             DO        8             XN                3 0
N01   *_________
N01   * Landkode
N01   *"""""""""
N01  C                   IF        LKR(XN) <> *BLANKS
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'EQD+CH+:::'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     10            AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = LKR(XN)
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   END
N01   *
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forsegling                                         SEL00 /
      *////////////////////////////////////////////////////////////
     C     SEL00         BEGSR
      *
     C     THDANT        CABEQ     0             SEL099
      *___________
      * Forsegling
      *"""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'SEL+0+::'    ADS
     C                   MOVE      ':'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDFKD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
      *
     C     THDFSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDFSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYA          SETLL     DKXHFS
     C     KEYA          READE     DKXHFS                                 34
     C     *IN34         DOWEQ     '0'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'SEL+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TFDFSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TFDFSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+:::'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TFDFKD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYA          READE     DKXHFS                                 34
     C  N34              ENDDO
      *
     C     SEL099        ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster                                         FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
      *________________________________
      * Dialogspråk ved avgangstollsted
      *""""""""""""""""""""""""""""""""
      * ikke benyttet ennå på SYSPED
      *____________________________
      * Språkkode for følgedokument
      *""""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ALL+'    ADS
     C                   MOVEA     '+++'         A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THSKFD        IFEQ      *BLANKS
     C                   MOVEL     'DA'          ADS
     C                   ELSE
     C                   MOVEL     THSKFD        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *______________________
      * Representens_fullmakt
      *""""""""""""""""""""""
      * Ikke benyttet ennå på SYSPED
      *______________________
      * Kontrollresultat kode
      *""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   IF        THENKL = 'J'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ADO+'    ADS
     C                   MOVEL     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDKR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
N01   *_______________________________
N01   * Transportkostnad betalingsmåte
N01   *"""""""""""""""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        ((THTKBM <> *BLANKS) AND (XULIKTKBM <> 'J'))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'FTX+PAI+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     8             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THTKBM
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
N01   *_____________________________
N01   * Transportens referansenummer
N01   *"""""""""""""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        THTREF <> *BLANKS
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'FTX+ACR+++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     10            AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THTREF
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     35            AXH
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referanser                                         RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
      *____________________
      * Deklarasjons-ID LRN
      *""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+ABE:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Felles referanse, deklarant-ID/dato/sekvensnr.
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTUID        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     22            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Garantitype
      *""""""""""""
      * Segmentnavn
N01   * INGEN GARANTIOPPLYSNING VED RENT FORHÅNDSVARSLING
N01  C                   IF        THDK <> 'SS'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+ABL:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGKD         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PAC02
N01  C                   END
N01   *______________________
N01   * Spesiell omstendighet
N01   *""""""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        THSPOM <> *BLANKS
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'RFF+AMJ:'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     8             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THSPOM
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                  NAD02G /
      *////////////////////////////////////////////////////////////
     C     NAD02G        BEGSR
      *_______________
      * Hovedansvarlig
      *"""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AF+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGTINA        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Garanti referanse                                  PAC02 /
      *////////////////////////////////////////////////////////////
     C     PAC02         BEGSR
     C                   MOVE      THGFT1        XGGFT1           24
     C                   MOVE      THGADK        XGGADK            4
     C                   MOVE      THGBGI        XGGBGI            1 0
     C                   MOVE      THGBGU        XGGBGU            2
     C                   MOVE      THGBL         XGGBL            13 2
     C                   MOVE      THGVK         XGGVK             3
     C     KEYA          SETLL     DKXHGN
     C     STPAC02       TAG
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+1+++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Adgangskode
      *""""""""""""
     C     THGADK        IFNE      *BLANKS
     C     THGKD         OREQ      0
     C     THGKD         OREQ      1
     C     THGKD         OREQ      2
     C     THGKD         OREQ      4
     C     THGKD         OREQ      9
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGADK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C     THGFT2        IFEQ      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   ELSE
     C                   MOVEL     ':::'         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THGFT2        IFEQ      *BLANKS
      *___________________
      * Garantireferansenr
      *"""""""""""""""""""
     C                   MOVEL     THGFT1        ADS
     C                   ELSE
      *_________________________
      * Annen Garantireferansenr
      *"""""""""""""""""""""""""
     C                   MOVEL     THGFT2        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PCI03
      *
     C     KEYA          READE     DKXHGN                                 34
     C                   IF        *IN34 = '0'
     C                   MOVE      TGGFT1        THGFT1
     C                   MOVE      TGGADK        THGADK
     C                   MOVE      TGGBGI        THGBGI
     C                   MOVE      TGGBGU        THGBGU
     C                   GOTO      STPAC02
     C                   END
     C                   MOVE      XGGFT1        THGFT1
     C                   MOVE      XGGADK        THGADK
     C                   MOVE      XGGBGI        THGBGI
     C                   MOVE      XGGBGU        THGBGU
     C                   MOVE      XGGBL         THGBL
     C                   MOVE      XGGVK         THGVK
     C
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Begrensning av garantis gyldighet                  PCI03 /
      *////////////////////////////////////////////////////////////
     C     PCI03         BEGSR
      *__________________________________
      * Begrensning av gyldighet innen EU
      *""""""""""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     THGBGU        IFEQ      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+19+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGBGI        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ELSE
      *____________________________________
      * Begrensning av gyldighet utenfor EU
      *""""""""""""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+28+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THGBGU        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGBGU        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYA          SETLL     DKXHGB
     C     KEYA          READE     DKXHGB                                 34
     C     *IN34         DOWEQ     '0'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+28+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THGBGU        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGGBGU        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     KEYA          READE     DKXHGB                                 34
     C  N34              ENDDO
      *
     C                   END
      *
     C     PCI099        ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetljer                                   TDT04 /
      *////////////////////////////////////////////////////////////
     C     TDT04         BEGSR
      *_________________________
      * Innenlands transportmåte
      *"""""""""""""""""""""""""
N01  C     THTRMI        IFNE      0
N01   * Segmentnavn
N01   * W0074  --->  Teller for antall segment
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'TDT+1++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     THTRMI        WTHTRMI           1 0
N01  C                   MOVEL     WTHTRMI       ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
      *
     C     THTRM         IFNE      0
      *_________________________
      * Transportmåte ved avgang
      *"""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TDT+11++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   Z-ADD     THTRM         ØN163
     C                   EXSR      SRNE
     C                   EVAL      ADS = ØAN
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *____________________________________________
      * Transportmiddel ved grensepassning rubr. 21
      *""""""""""""""""""""""""""""""""""""""""""""
      * Ikke benyttet i SYSPED
      *
     C     THTRM         IFNE      *ZEROS
     C     THTGID        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+++++:::'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________________________________________
      * Transportmidlets identitet ved grensepassning rubr. 21
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTGID        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     27            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________________________________________________________
      * Transportmidlets nasjonalitet ved grensepassning rubr. 21
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C     THTGLK        IFEQ      *BLANKS
     C                   MOVEL     'DK'          ADS
     C                   ELSE
     C                   MOVEL     THTGLK        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTRM         IFEQ      *ZEROS
     C                   EXSR      TPL04A
     C                   END
      *
     C                   END
      *___________________________
      * Transportmiddel ved avgang
      *"""""""""""""""""""""""""""
     C     THTRM         IFNE      5
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TDT+12++'    ADS
     C                   MOVEA     '+++++:::'    A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     16            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________________________________
      * Transportmidlets identitet ved avgang rubr. 18
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTAID        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     27            AXH
     C                   EXSR      SRÅ
      *
     C     THTRM         IFNE      20
     C     THTRM         ANDNE     23
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________________________________
      * Transportmidlets identitet ved avgang rubr. 18
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTALK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     27            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      TPL04B
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transport placement                               TPL04A /
      *////////////////////////////////////////////////////////////
     C     TPL04A        BEGSR
      *____________________________________________________________
      * Språkkode for transportmidlets identitet ved grensepassning
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     THTGSK        IFNE      *BLANKS
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TPL+::::'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTGSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transport placement                               TPL04B /
      *////////////////////////////////////////////////////////////
     C     TPL04B        BEGSR
      *____________________________________________________
      * Språkkode for transportmidlets identitet ved avgang
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     THTASK        IFNE      *BLANKS
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TPL+::::'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTASK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                   NAD06 /
      *////////////////////////////////////////////////////////////
     C     NAD06         BEGSR
      *_______________
      * Hovedansvarlig
      *"""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AF+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTINA        IFNE      *BLANKS                                      1<-B
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINA        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADA1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADA1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKA         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKA         IFEQ      *BLANKS
     C                   MOVEL     'DK'          ADS
     C                   ELSE
     C                   MOVEL     THLKA         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________________
      * Representantnavn
      *"""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AH++'    ADS
     C                   MOVE      '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTARF        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     16            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________
      * Avsender
      *"""""""""
      * Segmentnavn
     C     XULIK         IFEQ      'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CZ+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTINS        IFNE      *BLANKS                                      1<-B
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADS1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADS1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKS         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKS         IFEQ      *BLANKS
     C                   MOVEL     'DK'          ADS
     C                   ELSE
     C                   MOVEL     THLKS         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_________
      * Mottaker
      *"""""""""
      * Segmentnavn
     C     XULIKM        IFEQ      'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CN+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     THTINK        XHTINK            9
     C     THTINK        IFNE      *BLANKS                                      1<-B
     C     XHTINK        ANDNE     *ZEROS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADK1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADK1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKK         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKK         IFEQ      *BLANKS
     C                   MOVEL     'DK'          ADS
     C                   ELSE
     C                   MOVEL     THLKK         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_____________________
      * Autoriserte mottaker
      *"""""""""""""""""""""
     C     THTINK        IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+TD+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
N01   *
N01  C                   IF        XFORHV = 'J'
N01  C                   EXSR      NAD06FV
N01  C                   END
      *
     C                   ENDSR
N01   *////////////////////////////////////////////////////////////
N01   *  Navn og adresser FORHÅNDSVARSLING                NAD06FV /
N01   *////////////////////////////////////////////////////////////
N01  C     NAD06FV       BEGSR
N01   *___________________
N01   * Avsender sikkerhet
N01   *"""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        ((THNASS <> *BLANKS) AND (XULIKS = 'N'))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'NAD+GL+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THTINSS <> *BLANKS                           1<-B
N01  C                   EVAL      ADS = THTINSS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     17            AXH
N01  C                   EXSR      SRÅ
N01  C                   END                                                    1<-E
N01   *
N01  C                   EVAL      ADS = '++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THNASS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THADSS1 = *BLANKS
N01  C                   EVAL      ADS = '.'
N01  C                   ELSE
N01  C                   EVAL      ADS = THADSS1
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THPSSS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     24            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THSKSS = *BLANKS
N01  C                   EVAL      ADS = 'DA'
N01  C                   ELSE
N01  C                   EVAL      ADS = THSKSS
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THPNSS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     9             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THLKSS = *BLANKS
N01  C                   EVAL      ADS = 'DK'
N01  C                   ELSE
N01  C                   EVAL      ADS = THLKSS
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
N01   *
N01   *___________________
N01   * Mottaker sikkerhet
N01   *"""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        ((THNAKS <> *BLANKS) AND (XULIKMS = 'N'))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'NAD+UC+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THTINKS <> *BLANKS                           1<-B
N01  C                   EVAL      ADS = THTINKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     17            AXH
N01  C                   EXSR      SRÅ
N01  C                   END                                                    1<-E
N01   *
N01  C                   EVAL      ADS = '++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THNAKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THADKS1 = *BLANKS
N01  C                   EVAL      ADS = '.'
N01  C                   ELSE
N01  C                   EVAL      ADS = THADKS1
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THPSKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     24            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THSKKS = *BLANKS
N01  C                   EVAL      ADS = 'DA'
N01  C                   ELSE
N01  C                   EVAL      ADS = THSKKS
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THPNKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     9             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THLKKS = *BLANKS
N01  C                   EVAL      ADS = 'DK'
N01  C                   ELSE
N01  C                   EVAL      ADS = THLKKS
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
N01   *____________
N01   * Transportør
N01   *""""""""""""
N01   * Segmentnavn
N01  C                   IF        THNAT <> *BLANKS
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'NAD+GA+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THTINT <> *BLANKS                            1<-B
N01  C                   EVAL      ADS = THTINT
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     17            AXH
N01  C                   EXSR      SRÅ
N01  C                   END                                                    1<-E
N01   *
N01  C                   EVAL      ADS = '++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THNAT
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THADT1 = *BLANKS
N01  C                   EVAL      ADS = '.'
N01  C                   ELSE
N01  C                   EVAL      ADS = THADT1
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THPST
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     24            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THSKT = *BLANKS
N01  C                   EVAL      ADS = 'DA'
N01  C                   ELSE
N01  C                   EVAL      ADS = THSKT
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = THPNT
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     9             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        THLKT = *BLANKS
N01  C                   EVAL      ADS = 'DK'
N01  C                   ELSE
N01  C                   EVAL      ADS = THLKT
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
N01   *
N01  C                   ENDSR
N01   *
      *////////////////////////////////////////////////////////////
      *  Garantinr                                         LIN09G /
      *////////////////////////////////////////////////////////////
     C     LIN09G        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LIN+++'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Garantinr
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGGNR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX11G
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Adgangskode                                       FTX11G /
      *////////////////////////////////////////////////////////////
     C     FTX11G        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ABY++'   ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Gammel adgangskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGAKGM        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+CCI++'   ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Ny adgangskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGAKNY        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TGGNR         SETLL     DKXGD
     C     TGGNR         READE     DKXGD                                  33
     C                   DOW       *IN33 = *OFF
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+AUT++'   ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adgangskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TDAK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     TGGNR         READE     DKXGD                                  33
     C                   ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                     UNS00A /
      *////////////////////////////////////////////////////////////
     C     UNS00A        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNS+D'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varelinjer                                         CST30 /
      *////////////////////////////////////////////////////////////
     C     CST30         BEGSR
     C                   MOVE      *ZEROS        XVN               5 0
     C     KEYA          SETLL     DKXV
     C     KEYA          READE     DKXV                                   33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XVN
     C                   MOVE      XVN           TVLN
     C                   UPDATE    DKXVR
N01  C     KEYE          CHAIN     DKXVFV                             33
N01  C   33              CLEAR                   DKXVFVR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CST+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     XVN           ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
      *
     C     THLSTL        IFEQ      0
      *
     C     TVVNT         IFNE      0
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      * Varenr
     C     TVVNT         IFNE      0
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVVNT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     THDK          IFEQ      'T-'
     C                   MOVE      *BLANKS       ADS
     C     TVVNT         IFEQ      0
     C                   MOVEL     '+++++'       ADS
     C                   ELSE
     C                   MOVEL     '++++'        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Status
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX30
     C     THLSTL        IFEQ      0
     C                   EXSR      LOC30
     C                   EXSR      MEA30
     C                   EXSR      NAD30
N01  C                   EXSR      TDT30
     C                   EXSR      PAC31
     C                   EXSR      RFF35
     C                   END
     C                   EXSR      DOC37
     C                   EXSR      TOD38
     C     THLSTL        IFEQ      0
     C                   EXSR      GIR44
     C                   END
      *
     C     KEYA          READE     DKXV                                   33
     C  N33              ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varebeskrivelse                                    FTX30 /
      *////////////////////////////////////////////////////////////
     C     FTX30         BEGSR
      *
     C     TVVT          IFEQ      *BLANKS
     C*    X_TVVNT       SETLL     DKTVS
     C*                  READ      DKTVS                                  34
     C* N34              MOVEL     DKVS_VATA     XN06              6 0
     C* N34XN06          COMP      TVVNT                              3434
     C* N34              MOVEL     DKVS_TXTK     TVVT
     C                   END
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     KEYE          SETLL     DKXVVT
     C     FTX30A        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+AAA+'    ADS
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVVT          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     48            AXH
     C                   EXSR      SRÅ
      *
     C     TVVTSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVVTSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     FTX30B        TAG
     C     KEYE          READE     DKXVVT                                 34
     C  N34TVVT          IFEQ      *BLANKS
     C                   GOTO      FTX30B
     C                   ELSE
     C                   GOTO      FTX30A
     C                   END
N01   *
N01   * FORHÅNDSVARSLING, KOMMESIELT REFERANSENR
N01   * Segmentnavn
N01  C                   IF        ((XFORHV = 'J') AND (XULIKKREF = 'J'))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'FTX+IND+++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     10            AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        TVKREF = *BLANKS
N01  C                   EVAL      ADS = THKREF
N01  C                   ELSE
N01  C                   EVAL      ADS = TVKREF
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     70            AXH
N01  C                   EXSR      SRÅ
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                     LOC30 /
      *////////////////////////////////////////////////////////////
     C     LOC30         BEGSR
     C     THALK         IFEQ      *BLANKS
      *______________________________________________
      * Avsendesland (Ikke sende ved papirlasteliste)
      *""""""""""""""""""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+35+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVALK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_________________
      * Bestemmelsesland
      *"""""""""""""""""
      * Segmentnavn
     C     THBLK         IFEQ      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+36+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVBLK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mål                                                MEA30 /
      *////////////////////////////////////////////////////////////
     C     MEA30         BEGSR
      *___________
      * Bruttovekt
      *"""""""""""
     C     TVVKTB        IFNE      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'MEA+WT+A'    ADS
     C                   MOVEA     'AB+KGM:'     A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   Z-ADD     TVVKTB        ØN163
     C                   EXSR      SRNE
     C                   EVAL      ADS = ØAN
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *__________
      * Nettovekt
      *""""""""""
     C     TVVKTN        IFNE      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'MEA+WT+A'    ADS
     C                   MOVEA     'AA+KGM:'     A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   Z-ADD     TVVKTN        ØN163
     C                   EXSR      SRNE
     C                   EVAL      ADS = ØAN
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                   NAD30 /
      *////////////////////////////////////////////////////////////
     C     NAD30         BEGSR
      *
     C     XULIK         IFEQ      'J'                                          1<-B
     C     XULIKM        OREQ      'J'
     C     KEYE          CHAIN     DKXVAM                             34
     C     *IN34         IFEQ      '0'                                           2<-B
     C     XULIK         IFEQ      'J'                                            3<-B
     C     TVNAS         ANDEQ     *BLANKS
     C                   MOVE      THTINS        TVTINS
     C                   MOVE      THNAS         TVNAS
     C                   MOVE      THADS1        TVADS1
     C                   MOVE      THPNS         TVPNS
     C                   MOVE      THPSS         TVPSS
     C                   MOVE      THLKS         TVLKS
     C                   MOVE      THSKS         TVSKS
     C                   END                                                      3<-E
     C     XULIKM        IFEQ      'J'                                            3<-B
     C     TVNAK         ANDEQ     *BLANKS
     C                   MOVE      THTINK        TVTINK
     C                   MOVE      THNAK         TVNAK
     C                   MOVE      THADK1        TVADK1
     C                   MOVE      THPNK         TVPNK
     C                   MOVE      THPSK         TVPSK
     C                   MOVE      THLKK         TVLKK
     C                   MOVE      THSKK         TVSKK
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      THTINS        TVTINS
     C                   MOVE      THNAS         TVNAS
     C                   MOVE      THADS1        TVADS1
     C                   MOVE      THPNS         TVPNS
     C                   MOVE      THPSS         TVPSS
     C                   MOVE      THLKS         TVLKS
     C                   MOVE      THSKS         TVSKS
     C                   MOVE      THTINK        TVTINK
     C                   MOVE      THNAK         TVNAK
     C                   MOVE      THADK1        TVADK1
     C                   MOVE      THPNK         TVPNK
     C                   MOVE      THPSK         TVPSK
     C                   MOVE      THLKK         TVLKK
     C                   MOVE      THSKK         TVSKK
      *
     C     TVAVD2        IFNE      0                                              3<-B
     C     HEADFK        CHAIN     HEADF                              34
     C                   MOVE      HENAS         TVNAS
     C                   MOVE      HEADS1        TVADS1
     C                   MOVEL     HEADS3        TVPNS
     C                   MOVEL     HEADS3        TVPSS
     C                   MOVEL     'DA'          TVSKS
     C     HEUR          IFEQ      'B'                                             4<-B
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      'DK'          TVLKS
     C                   ELSE                                                      4
     C                   MOVE      HELKA         TVLKS
     C                   END                                                       4<-E
     C     HEKNS         IFEQ      0                                               4<-B
     C                   MOVE      *BLANKS       TVTINS
     C                   ELSE                                                      4
     C                   MOVE      HEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C     SYFOR9        IFEQ      *ZEROS                                           5<-B
     C                   MOVE      *BLANKS       TVTINS
     C                   ELSE                                                       5
     C                   MOVEL     SYFORE        TVTINS
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   MOVE      HENAK         TVNAK                            3<-E
     C                   MOVE      HEADK1        TVADK1
     C                   MOVEL     HEADK3        TVPNK
     C                   MOVEL     HEADK3        TVPSK
     C                   MOVEL     'DA'          TVSKK
     C     HEUR          IFEQ      'A'                                            3<-B
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVEL     'DK'          TVLKK
     C                   ELSE                                                     3
     C                   MOVEL     HELKA         TVLKK
     C                   END                                                      3<-E
     C     HEKNK         IFEQ      0                                              3<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                     3
     C                   MOVE      HEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C     SYFOR9        IFEQ      *ZEROS                                          4<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                      4
     C                   MOVEL     SYFORE        TVTINK
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     TVADS1        IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     '.'           TVADS1
     C                   END                                                     2<-E
     C     TVADK1        IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     '.'           TVADK1
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N01   *
N01  C     XULIKS        IFEQ      'J'                                          1<-B
N01  C     XULIKMS       OREQ      'J'
N01  C     KEYE          CHAIN     DKXVFV                             34
N01  C     *IN34         IFEQ      '0'                                           2<-B
N01  C                   IF        ((XULIKS = 'J') AND (TVNASS = *BLANKS))        3<-B
N01  C                   IF        ((TVNAS = THNAS) OR (TVNAS = *BLANKS))          4<-B
N01  C                   MOVE      THTINSS       TVTINSS
N01  C                   MOVE      THNASS        TVNASS
N01  C                   MOVE      THADSS1       TVADSS1
N01  C                   MOVE      THPNSS        TVPNSS
N01  C                   MOVE      THPSSS        TVPSSS
N01  C                   MOVE      THLKSS        TVLKSS
N01  C                   MOVE      THSKSS        TVSKSS
N01  C                   END                                                       4<-E
N01  C                   END                                                      3<-E
N01  C                   IF        ((XULIKMS = 'J') AND (TVNAKS = *BLANKS))       3<-B
N01  C                   IF        ((TVNAK = THNAK) OR (TVNAK = *BLANKS))          4<-B
N01  C                   MOVE      THTINKS       TVTINKS
N01  C                   MOVE      THNAKS        TVNAKS
N01  C                   MOVE      THADKS1       TVADKS1
N01  C                   MOVE      THPNKS        TVPNKS
N01  C                   MOVE      THPSKS        TVPSKS
N01  C                   MOVE      THLKKS        TVLKKS
N01  C                   MOVE      THSKKS        TVSKKS
N01  C                   END                                                       4<-E
N01  C                   END                                                      3<-E
N01  C                   ELSE                                                    2
N01  C                   MOVE      THTINS        TVTINS
N01  C                   MOVE      THNAS         TVNAS
N01  C                   MOVE      THADS1        TVADS1
N01  C                   MOVE      THPNS         TVPNS
N01  C                   MOVE      THPSS         TVPSS
N01  C                   MOVE      THLKS         TVLKS
N01  C                   MOVE      THSKS         TVSKS
N01  C                   MOVE      THTINK        TVTINK
N01  C                   MOVE      THNAK         TVNAK
N01  C                   MOVE      THADK1        TVADK1
N01  C                   MOVE      THPNK         TVPNK
N01  C                   MOVE      THPSK         TVPSK
N01  C                   MOVE      THLKK         TVLKK
N01  C                   MOVE      THSKK         TVSKK
N01  C                   END                                                     2<-E
N01  C                   END                                                    1<-E
N01  C     TVADSS1       IFEQ      *BLANKS                                      1<-B
N01  C                   MOVEL     '.'           TVADSS1
N01  C                   END                                                    1<-E
N01  C     TVADKS1       IFEQ      *BLANKS                                      1<-B
N01  C                   MOVEL     '.'           TVADKS1
N01  C                   END                                                    1<-E
      *_________
      * Avsender
      *"""""""""
      * Segmentnavn
     C     XULIK         IFEQ      'J'
     C     TVNAS         ANDNE     *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CZ+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVNAS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVADS1        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPSS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVSKS         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'DA'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVSKS         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPNS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVLKS         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'DK'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVLKS         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_________
      * Mottaker
      *"""""""""
      * Segmentnavn
     C     XULIKM        IFEQ      'J'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CN+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVNAK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVADK1        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPSK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVSKK         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'DA'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVSKK         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPNK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVLKK         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'DK'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVLKK         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   END                                                    1<-E
N01   *
N01  C                   IF        XFORHV = 'J'
N01  C                   EXSR      NAD30FV
N01  C                   END
      *
     C                   ENDSR
N01   *////////////////////////////////////////////////////////////
N01   *  Navn og adresser FORHÅNDSVARSLING                NAD30FV /
N01   *////////////////////////////////////////////////////////////
N01  C     NAD30FV       BEGSR
N01   *
N01  C     XULIKS        IFEQ      'J'                                          1<-B
N01  C     XULIKMS       OREQ      'J'
N01  C     KEYE          CHAIN     DKXVFV                             34
N01  C     *IN34         IFEQ      '0'                                           2<-B
N01  C     XULIKS        IFEQ      'J'                                            3<-B
N01  C     TVNASS        ANDEQ     *BLANKS
N01  C                   MOVE      THTINSS       TVTINSS
N01  C                   MOVE      THNASS        TVNASS
N01  C                   MOVE      THADSS1       TVADSS1
N01  C                   MOVE      THPNSS        TVPNSS
N01  C                   MOVE      THPSSS        TVPSSS
N01  C                   MOVE      THLKSS        TVLKSS
N01  C                   MOVE      THSKSS        TVSKSS
N01  C                   END                                                      3<-E
N01  C     XULIKMS       IFEQ      'J'                                            3<-B
N01  C     TVNAKS        ANDEQ     *BLANKS
N01  C                   MOVE      THTINKS       TVTINKS
N01  C                   MOVE      THNAKS        TVNAKS
N01  C                   MOVE      THADKS1       TVADKS1
N01  C                   MOVE      THPNKS        TVPNKS
N01  C                   MOVE      THPSKS        TVPSKS
N01  C                   MOVE      THLKKS        TVLKKS
N01  C                   MOVE      THSKKS        TVSKKS
N01  C                   END                                                      3<-E
N01  C                   ELSE                                                    2
N01  C                   MOVE      THTINS        TVTINS
N01  C                   MOVE      THNAS         TVNAS
N01  C                   MOVE      THADS1        TVADS1
N01  C                   MOVE      THPNS         TVPNS
N01  C                   MOVE      THPSS         TVPSS
N01  C                   MOVE      THLKS         TVLKS
N01  C                   MOVE      THSKS         TVSKS
N01  C                   MOVE      THTINK        TVTINK
N01  C                   MOVE      THNAK         TVNAK
N01  C                   MOVE      THADK1        TVADK1
N01  C                   MOVE      THPNK         TVPNK
N01  C                   MOVE      THPSK         TVPSK
N01  C                   MOVE      THLKK         TVLKK
N01  C                   MOVE      THSKK         TVSKK
N01  C                   END                                                     2<-E
N01   *
N01  C     TVADSS1       IFEQ      *BLANKS                                       2<-B
N01  C                   MOVEL     '.'           TVADSS1
N01  C                   END                                                     2<-E
N01  C     TVADKS1       IFEQ      *BLANKS                                       2<-B
N01  C                   MOVEL     '.'           TVADKS1
N01  C                   END                                                     2<-E
N01   *___________________
N01   * Avsender sikkerhet
N01   *"""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        ((TVTINSS <> *BLANKS) OR (TVNASS <> *BLANKS))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'NAD+GM+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   MOVEL     TVTINSS       XAN09             9
N01  C                   IF        TVTINSS <> *BLANKS
N01  C*                  EVAL      ADS = TVLKSS + TVTINS
N01  C                   EVAL      ADS = TVTINSS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     17            AXH
N01  C                   EXSR      SRÅ
N01  C                   END                                                      3<-E
N01
N01  C                   IF        TVTINSS = *BLANKS
N01  C                   IF        TVNASS <> *BLANKS
N01  C                   EVAL      ADS = '++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVNASS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVADSS1
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVPSSS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     24            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        TVSKSS = *BLANKS                               3<-B
N01  C                   EVAL      ADS = 'DA'
N01  C                   ELSE                                                     3
N01  C                   EVAL      ADS = TVSKSS
N01  C                   END                                                      3<-E
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVPNSS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     9             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        TVLKS = *BLANKS                                3<-B
N01  C                   EVAL      ADS = 'DK'
N01  C                   ELSE                                                     3
N01  C                   EVAL      ADS = TVLKS
N01  C                   END                                                      3<-E
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
N01   *
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END                                                     2<-E
N01   *___________________
N01   * Mottaker sikkerhet
N01   *"""""""""""""""""""
N01   * Segmentnavn
N01  C                   IF        ((TVTINKS <> *BLANKS) OR (TVNAKS <> *BLANKS))
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'NAD+DP+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     7             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   MOVEL     TVTINKS       XAN09             9
N01  C                   IF        TVTINKS <> *BLANKS
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     TVTINKS       ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     17            AXH
N01  C                   EXSR      SRÅ
N01  C                   END                                                      3<-E
N01   *
N01  C                   IF        TVTINKS = *BLANKS
N01  C                   IF        TVNAKS <> *BLANKS
N01  C                   EVAL      ADS = '++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVNAKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVADKS1
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     30            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVPSKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     24            AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        TVSKKS = *BLANKS                               3<-B
N01  C                   EVAL      ADS = 'DA'
N01  C                   ELSE                                                     3
N01  C                   EVAL      ADS = TVSKKS
N01  C                   END                                                      3<-E
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVPNKS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     9             AXH
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = '+'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   IF        TVLKKS = *BLANKS                               3<-B
N01  C                   EVAL      ADS = 'DK'
N01  C                   ELSE                                                     3
N01  C                   EVAL      ADS = TVLKKS
N01  C                   END                                                      3<-E
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     2             AXH
N01  C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
N01   *
N01   * Slutt segment
N01  C                   MOVE      *BLANKS       ADS
N01  C                   MOVEL     WAPSTR        ADS
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END                                                     2<-E
N01   *
N01  C                   END                                                    1<-E
N01   *
N01  C                   ENDSR
N01   *////////////////////////////////////////////////////////////
N01   *  Farlig gods kode                                   TDT30 /
N01   *////////////////////////////////////////////////////////////
N01  C     TDT30         BEGSR
N01   *
N01  C                   IF        ((XULIKTKBM = 'J') OR (TVFGKD <> *BLANKS))
N01   * Segmentnavn
N01  C                   ADD       1             W0074
N01  C                   EVAL      ADS = 'TDT+10+++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     9             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *_________________________________
N01   * Transportkostnad - betalingsmåte
N01   *"""""""""""""""""""""""""""""""""
N01  C                   IF        XULIKTKBM = 'J'
N01  C                   IF        TVTKBM = *BLANKS
N01  C                   EVAL      ADS = THTKBM
N01  C                   ELSE
N01  C                   EVAL      ADS = TVTKBM
N01  C                   END
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   EXSR      SRÅ
N01  C                   END
N01   *_________________
N01   * Farlig gods kode
N01   *"""""""""""""""""
N01  C                   IF        TVFGKD <> *BLANKS                            1<-B
N01  C                   EVAL      ADS = '++++'
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     4             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01   *
N01  C                   EVAL      ADS = TVFGKD
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     4             AXH
N01  C                   EXSR      SRÅ
N01  C                   END                                                    1<-E
N01   * Slutt segment
N01  C                   EVAL      ADS = WAPSTR
N01  C                   Z-ADD     1             AXV
N01  C                   Z-ADD     1             AXH
N01  C                   MOVE      'N'           WCHART
N01  C                   EXSR      SRÅ
N01  C                   END                                                    1<-E
N01   *
N01  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Pakkning                                           PAC31 /
      *////////////////////////////////////////////////////////////
     C     PAC31         BEGSR
      * //
      * Først linjen
      * //
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+6+++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________
      * Pakktype
      *"""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEH          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ

     C     TVEH          IFNE      'VQ'
N02  C     TVEH          ANDNE     'VS'
     C     TVEH          ANDNE     'VG'
     C     TVEH          ANDNE     'VL'
     C     TVEH          ANDNE     'VY'
     C     TVEH          ANDNE     'VR'
     C     TVEH          ANDNE     'VO'
     C     TVEH          ANDNE     'NE'
N02  C     TVEH          ANDNE     'NF'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVNT          ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     TVEH          IFEQ      'NE'
N02  C     TVEH          OREQ      'NF'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':::'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVNTEH        ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PCI32
      * //
      * Les flere repetitioner fra annen fil
      * //
     C     KEYE          SETLL     DKXVMN
     C                   MOVE      *ZEROS        XANTMN            3 0
     C                   MOVE      TVMN          XTVMN            42
     C                   MOVE      TVMNSK        XTVMNSK           2
     C                   MOVE      TVEH          XTVEH             2
     C                   MOVE      TVNT          XTVNT             5 0
     C                   MOVE      TVNTEH        XTVNTEH           5 0
     C     KEYE          READE     DKXVMN                                 34
     C     *IN34         DOWEQ     *OFF
     C                   ADD       1             XANTMN
     C*                  MOVE      XTVMN         TVMN
     C*                  MOVE      XTVMNSK       TVMNSK
     C*                  MOVE      XTVEH         TVEH
     C*                  MOVE      XTVNT         TVNT
     C*                  MOVE      XTVNTEH       TVNTEH
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+6+++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Pakktype
      *""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEH          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C     TVEH          IFNE      'VQ'
N02  C     TVEH          ANDNE     'VS'
     C     TVEH          ANDNE     'VG'
     C     TVEH          ANDNE     'VL'
     C     TVEH          ANDNE     'VY'
     C     TVEH          ANDNE     'VR'
     C     TVEH          ANDNE     'VO'
     C     TVEH          ANDNE     'NE'
N02  C     TVEH          ANDNE     'NF'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVNT          ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     TVEH          IFEQ      'NE'
N02  C     TVEH          OREQ      'NF'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':::'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVNTEH        ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PCI32

     C     KEYE          READE     DKXVMN                                 34
     C  N34              ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forpakningsidentifikasjon                          PCI32 /
      *////////////////////////////////////////////////////////////
     C     PCI32         BEGSR
      *
     C     TVMN          CABNE     *BLANKS       PCI32A
     C     TVEH          CABEQ     'NE'          PCI32A
N02  C     TVEH          CABEQ     'NF'          PCI32A
     C     TVEH          IFNE      'VQ'
N02  C     TVEH          ANDNE     'VS'
     C     TVEH          ANDNE     'VG'
     C     TVEH          ANDNE     'VL'
     C     TVEH          ANDNE     'VY'
     C     TVEH          ANDNE     'VR'
     C     TVEH          ANDNE     'VO'
     C                   GOTO      PCI32A
     C                   END
     C                   GOTO      PCI32C
     C     PCI32A        TAG
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+28+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMN          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     42            AXH
     C                   EXSR      SRÅ
      *
     C     TVMNSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMNSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

      *
     C     PCI32C        ENDSR
      *////////////////////////////////////////////////////////////
      *  Referanser                                         RFF35 /
      *////////////////////////////////////////////////////////////
     C     RFF35         BEGSR
      *
     C     TVCNR         IFNE      *BLANKS
      *____________
      * Containernr
      *""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+AAQ:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVCNR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYE          SETLL     DKXVCN
     C     KEYE          READE     DKXVCN                                 34
     C     *IN34         DOWEQ     '0'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+AAQ:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVCNR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     19            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYE          READE     DKXVCN                                 34
     C  N34              END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dokumenter                                         DOC37 /
      *////////////////////////////////////////////////////////////
     C     DOC37         BEGSR
     C                   MOVEL     TVEXKD        XTVEXKD           1 0
     C                   MOVEL     TVEXLK        XTVEXLK           2
     C                   MOVEL     TVTLO         XTVTLO            3
     C                   MOVEL     TVMTXT        XTVMTXT          48
     C                   MOVEL     TVMSK         XTVMSK            2
      *
     C     KEYE          SETLL     DKXVTD
     C     TVDK          IFGE      'T2   '
     C     TVDK          ANDLE     'T2999'
     C                   GOTO      DOC37A
     C                   END
     C     TVDK          IFEQ      *BLANKS
     C     THDK          ANDGE     'T2   '
     C     THDK          ANDLE     'T2999'
     C                   GOTO      DOC37A
     C                   END
     C                   GOTO      DOC37C
     C     DOC37A        TAG
      *_______________________
      * Tidligere dokumenttype
      *"""""""""""""""""""""""
      * Segmentnavn
     C     TVTDT         IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DOC+190:'    ADS
     C                   MOVEA     '::'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
      *
     C     TVTDOS        IFEQ      *BLANKS
     C     TVTDO         ANDEQ     *BLANKS
     C     TVTDSK        ANDEQ     *BLANKS
     C                   GOTO      DOC37A2
     C                   ENDIF

     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVTDO         IFNE      *BLANKS
     C     TVTDOS        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDOS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVTDO         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDO         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     TVTDSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
     C     DOC37A2       TAG
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C     DOC37B        TAG
     C     KEYE          READE     DKXVTD                                 34
     C  N34TVTDT         IFEQ      *BLANKS
     C     TVTDR         ANDEQ     *BLANKS
     C                   GOTO      DOC37B
     C                   ELSE
     C                   GOTO      DOC37A
     C                   END
      *
     C     DOC37C        TAG
      *___________________
      * Dokument referanse
      *"""""""""""""""""""
     C     TVDTY         IFNE      *BLANKS
     C     KEYE          SETLL     DKXVDK
      * Segmentnavn
     C     DOC37D        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DOC+916:'    ADS
     C                   MOVEA     '::'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDTY         ADS
     C                   Z-ADD     1             AXV
S03  C*                  Z-ADD     3             AXH
N03  C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDREF        IFNE      *BLANKS
     C     TVDO          OREQ      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDREF        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDO          IFNE      *BLANKS
     C     TVDOSK        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDOSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDO          IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDO          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDREF        IFNE      *BLANKS
     C     TVDO          OREQ      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C     TVDSK         IFEQ      *BLANKS
     C                   MOVEL     'DA'          ADS
     C                   ELSE
     C                   MOVEL     TVDSK         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     DOC37E        TAG
     C     KEYE          READE     DKXVDK                                 34
     C  N34TVDTY         IFEQ      *BLANKS
     C                   GOTO      DOC37E
     C                   ELSE
     C                   GOTO      DOC37D
     C                   END
      *
     C                   END
      *
     C                   MOVEL     XTVEXKD       TVEXKD
     C                   MOVEL     XTVEXLK       TVEXLK
     C                   MOVEL     XTVTLO        TVTLO
     C                   MOVEL     XTVMTXT       TVMTXT
     C                   MOVEL     XTVMSK        TVMSK
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Spesielle merknader                                TOD38 /
      *////////////////////////////////////////////////////////////
     C     TOD38         BEGSR
      *
     C                   IF        ((XVN = 1) AND (THDK <> 'SS'))
     C     KEYA          SETLL     DKXHGN
     C     STTOD38       TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TOD+2'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX38
      *
     C     KEYA          READE     DKXHGN                                 34
     C                   IF        *IN34 = '0'
     C                   MOVE      TGGFT1        THGFT1
     C                   MOVE      TGGADK        THGADK
     C                   MOVE      TGGBGI        THGBGI
     C                   MOVE      TGGBGU        THGBGU
     C                   MOVE      TGGBL         THGBL
     C                   MOVE      TGGVK         THGVK
     C                   GOTO      STTOD38
     C                   END
      *
     C                   END
      *
     C     TVTLO         IFEQ      'DG0'
     C     TVTLO         OREQ      'DG1'
      * Segmentnavn
     C     KEYE          SETLL     DKXVDK
     C     TOD38A        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TOD+2++'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Eksport fra EU
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEXKD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   IF        TVEXLK <> *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Leveringsbetingelser
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEXLK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX38
      *
     C     TOD38B        TAG
     C     KEYE          READE     DKXVDK                                 34
     C  N34TVTLO         IFEQ      'DG0'
     C     TVTLO         OREQ      'DG1'
     C                   GOTO      TOD38A
     C                   ELSE
     C                   GOTO      TOD38B
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tilleggsopplysninger                               FTX38 /
      *////////////////////////////////////////////////////////////
     C     FTX38         BEGSR
     C     TVTLO         IFNE      *BLANKS
     C     TVMTXT        ANDNE     *BLANKS
      *
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ACB+'    ADS
     C                   MOVEL     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTLO         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMTXT        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     48            AXH
     C                   EXSR      SRÅ
      *
     C     TVMSK         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMSK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ELSE
     C                   EXSR      FTX38GAR
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Garanti                                         FTX38GAR /
      *////////////////////////////////////////////////////////////
     C     FTX38GAR      BEGSR
      *
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'FTX+ACB++CAL+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     13            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     THGBL         ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   CAT       THGVK:0       ADS
     C                   CAT       THGFT1:0      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     38            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Følsomme varer                                     GIR44 /
      *////////////////////////////////////////////////////////////
     C     GIR44         BEGSR
      *
     C     TVFVNT        IFGT      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     KEYE          SETLL     DKXVFS
     C     GIR44A        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIR+3+'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVFVNT        ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':AP'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVFV <> *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVFV          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':AP'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     GIR44B        TAG
     C     KEYE          READE     DKXVFS                                 34
     C  N34TVFVNT        IFGT      0
     C                   GOTO      GIR44A
     C                   ELSE
     C                   GOTO      GIR44B
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                     UNS00B /
      *////////////////////////////////////////////////////////////
     C     UNS00B        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNS+S'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontrolltotaler                                    CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
      *_____________
      * Antall kolli
      *"""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+11:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNTK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *___________________
      * Antall lastelister
      *"""""""""""""""""""
     C     THLSTL        IFGT      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+13:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THLSTL        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *__________________
      * Antall forsegling
      *""""""""""""""""""
     C     THDANT        IFGT      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+16:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDANT        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *__________________
      * Antall varelinjer
      *""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+5:'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLSTL        IFEQ      0
     C                   MOVEL     XVN           ADS
     C                   ELSE
     C                   MOVEL     THVPOS        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                      UNT00 /
      *////////////////////////////////////////////////////////////
     C     UNT00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNT+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall segmenter i meldingen (inkludert UNH og UNT)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     W0074         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     X11S          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                  BGM00X /
      *////////////////////////////////////////////////////////////
     C     BGM00X        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM++'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      * Status
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTRNR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     18            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                  BGM00G /
      *////////////////////////////////////////////////////////////
     C     BGM00G        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM++6'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                    LOC00X /
      *////////////////////////////////////////////////////////////
     C     LOC00X        BEGSR
      *________________
      * Avgangstollsted
      *""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+118+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THCATS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                    LOC00G /
      *////////////////////////////////////////////////////////////
     C     LOC00G        BEGSR
      *________________
      * Avgangstollsted
      *""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+119+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGTSD         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dato                                              DTM00X /
      *////////////////////////////////////////////////////////////
     C     DTM00X        BEGSR
      *__________________
      * Kanselleringsdato
      *""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+318:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WDT           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster                                        FTX00X /
      *////////////////////////////////////////////////////////////
     C     FTX00X        BEGSR
      *__________________________
      * Grunnlag for kansellering
      *""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ACD+'    ADS
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     FT(1)         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
      *
     C     2             DO        5             XN                3 0
     C     FT(XN)        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     FT(XN)        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
     C                   END
     C                   END
      *
     C     TKSK          IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TKSK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                  NAD06X /
      *////////////////////////////////////////////////////////////
     C     NAD06X        BEGSR
      *_______________
      * Hovedansvarlig
      *"""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AF+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTINA        IFNE      *BLANKS                                      1<-B
     C     THDKR         ORNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINA        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   ELSE                                                   1
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADA1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADA1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKA         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKA         IFEQ      *BLANKS
     C                   MOVEL     'DK'          ADS
     C                   ELSE
     C                   MOVEL     THLKA         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   END                                                    1<-E
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_________________
      * Trim left blanks
      *"""""""""""""""""
     C                   MOVEL(P)  ADS           ADS2            512
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS=%TRIML(ADS2)
      *_______________
      * Find positions
      *""""""""""""""""
      * Find first non-0 position
     C     WDIR          IFEQ      'L'                                          <-------------I
     C     AXV           DO        AXH           AXV                             <-----------II
     C     A(AXV)        COMP      '0'                                  8383                 II
     C   83              END                                                     <-----------II
      * Find last non-blank position                                     I
     C                   ELSE                                                   <-------------I
      *                                                                  I
     C     SRÅ01         TAG                                                                  I
      *                                                                  I
     C     AXH           IFGT      AXV                                           <-----------II
     C     A(AXH)        IFEQ      *BLANKS                                        <---------III
     C                   SUB       1             AXH                                        III
     C                   GOTO      SRÅ01                                                    III
     C                   END                                                      <---------III
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C                   MOVE      'R'           WDIR
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WDIR          IFEQ      'R'                                            <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   END                                                      <---------III
     C                   END                                                     <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I
      *                                                                  I
     C                   END                                                    <-------------I
      *
     C                   MOVE      'Y'           WCHART
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 13-felt
     C                   MOVE      *ZEROS        ØA13
     C     ØA163D        IFEQ      '000'                                        <-------------I
     C                   MOVE      ØA163H        ØA13                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA163X        ØA13                                         I
     C                   MOVE      '.   '        ØA13                                         I
     C                   MOVE      ØA163D        ØA13                                         I
     C     Ø13(13)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(13)
     C     Ø13(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(12)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        12            ØX                             <-------------I
     C     Ø13(ØX)       IFNE      '0'                                           <-----------II
N01  C                   IF        Ø13(ØX) = '.'                                  <---------III
N01  C                   SUB       1             ØX                                         III
N01  C                   END                                                      <---------III
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø13(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TEST OM VARELINJER HAR FORSKJELLIGE AVSENDER/MOTTAKER    /
      *////////////////////////////////////////////////////////////
     C     TSTAM         BEGSR
     C                   MOVE      'N'           XULIK             1
     C                   MOVE      'N'           XULIKM            1
N01  C                   MOVE      'N'           XULIKS            1
N01  C                   MOVE      'N'           XULIKMS           1
N01  C                   MOVE      'N'           XULIKTKBM         1
N01  C                   MOVE      'N'           XULIKKREF         1
     C     THVPOS        IFGT      1
     C                   MOVE      'J'           X1VP              1
     C     KEYA          SETLL     DKXV
     C     KEYA          READE(N)  DKXV                                   33
     C     *IN33         DOWEQ     '0'
N01   *
     C     KEYE          CHAIN     DKXVAM                             34
     C     *IN34         IFEQ      '0'
     C     TVNAS         IFEQ      *BLANKS
     C                   MOVEL     THNAS         XNAA
     C                   MOVEL     THADS1        XADA1
     C                   ELSE
     C                   MOVEL     TVNAS         XNAA
     C                   MOVEL     TVADS1        XADA1
     C                   END
     C     TVNAK         IFEQ      *BLANKS
     C                   MOVEL     THNAK         XNAM
     C                   MOVEL     THADK1        XADM1
     C                   ELSE
     C                   MOVEL     TVNAK         XNAM
     C                   MOVEL     TVADK1        XADM1
     C                   END
     C                   ELSE
     C     TVAVD2        IFEQ      0
     C                   MOVEL     THNAS         XNAA             30
     C                   MOVEL     THADS1        XADA1            30
     C                   MOVEL     THNAK         XNAM             30
     C                   MOVEL     THADK1        XADM1            30
     C                   ELSE
     C     HEADFK        CHAIN     HEADF                              34
     C                   MOVE      HENAS         XNAA
     C                   MOVE      HEADS1        XADA1
     C                   MOVE      HENAK         XNAM
     C                   MOVE      HEADK1        XADM1
     C                   END
     C                   END
N01   *
N01  C                   IF        XFORHV = 'J'
N01  C     KEYE          CHAIN     DKXVFV                             34
N01  C     *IN34         IFEQ      '0'
N01  C     TVNASS        IFEQ      *BLANKS
N01  C                   MOVEL     THNASS        XNAAS
N01  C                   MOVEL     THADSS1       XADAS1
N01  C                   ELSE
N01  C                   MOVEL     TVNASS        XNAAS
N01  C                   MOVEL     TVADSS1       XADAS1
N01  C                   END
N01  C     TVNAKS        IFEQ      *BLANKS
N01  C                   MOVEL     THNAKS        XNAMS
N01  C                   MOVEL     THADKS1       XADMS1
N01  C                   ELSE
N01  C                   MOVEL     TVNAKS        XNAMS
N01  C                   MOVEL     TVADKS1       XADMS1
N01  C                   END
N01  C                   ELSE
N01  C                   MOVEL     THNASS        XNAAS            30
N01  C                   MOVEL     THADSS1       XADAS1           30
N01  C                   MOVEL     THNAKS        XNAMS            30
N01  C                   MOVEL     THADKS1       XADMS1           30
N01  C                   END
N01  C     TVTKBM        IFEQ      *BLANKS
N01  C                   MOVE      THTKBM        XTKBM             1
N01  C                   ELSE
N01  C                   MOVE      TVTKBM        XTKBM             1
N01  C                   END
N01  C     TVKREF        IFEQ      *BLANKS
N01  C                   MOVE      THKREF        XKREF            70
N01  C                   ELSE
N01  C                   MOVE      TVKREF        XKREF            70
N01  C                   END
N01  C                   END
N01   *
     C     X1VP          IFEQ      'J'
     C                   MOVE      XNAA          X2NAA            30
     C                   MOVE      XADA1         X2ADA1           30
     C                   MOVE      XNAM          X2NAM            30
     C                   MOVE      XADM1         X2ADM1           30
N01  C                   IF        XFORHV = 'J'
N01  C                   MOVE      XNAAS         X2NAAS           30
N01  C                   MOVE      XADAS1        X2ADAS1          30
N01  C                   MOVE      XNAMS         X2NAMS           30
N01  C                   MOVE      XADMS1        X2ADMS1          30
N01  C                   MOVE      XTKBM         X2TKBM            1
N01  C                   MOVE      XKREF         X2KREF           70
N01  C                   END
     C                   MOVE      'N'           X1VP
     C                   END
N01   *
     C     XNAA          IFNE      X2NAA
     C     XADA1         ORNE      X2ADA1
     C                   MOVE      'J'           XULIK
     C                   END
     C     XNAM          IFNE      X2NAM
     C     XADM1         ORNE      X2ADM1
     C                   MOVE      'J'           XULIKM
     C                   END
N01   *
N01  C                   IF        XFORHV = 'J'
N01  C     XNAAS         IFNE      X2NAAS
N01  C     XADAS1        ORNE      X2ADAS1
N01  C                   MOVE      'J'           XULIKS
N01  C                   END
N01  C     XNAMS         IFNE      X2NAMS
N01  C     XADMS1        ORNE      X2ADMS1
N01  C                   MOVE      'J'           XULIKMS
N01  C                   END
N01  C     XTKBM         IFNE      X2TKBM
N01  C                   MOVE      'J'           XULIKTKBM
N01  C                   END
N01  C     XKREF         IFNE      X2KREF
N01  C                   MOVE      'J'           XULIKKREF
N01  C                   END
N01  C                   END
N01   *
     C     KEYA          READE(N)  DKXV                                   33
     C  N33              ENDDO
     C                   END
      *
     C                   ENDSR
