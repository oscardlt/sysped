     H DFTACTGRP(*NO)
      *
      *****************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE KOSTNADFØRING                   ***
      *****************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 RØDT bilagsnr dersom post er RETURNERT (tekst='R*')
10XXX * 02 SH  PTF10 kreditere et bilag  = opsjon K
10XXX * 03 SH  PTF10 tillate statusendring på A/B også
10XXX * 04 SH  PTF10 selektere 1/2 gangsreg
10186 * 05 SH  PTF10 SETTE STATUS 1/2 PÅ KOSTA HVIS 1.GANGSOPPDATERING
10186 * 06 SH  PTF10 kunne krediterer 1. gangsregistrerte
11186 * 07 SH  PTF11 skjerm 132  bredde
11186 * 08 SH  PTF11 vise de med reklamasjon  ind  78
11186 * 09 SH  PTF11 userid
11186 * 10 SH  PTF11 bytt attestasjonskode
11186 * 11 SH  PTF11 2=ENDRE G-MERKET BILAG NÅ TILLATT
11186 * 12 SH  PTF11 sende epost
11186 * 13 SH  PTF11 syks02 parameter signatur
11186 * 14 SH  PTF11 DIV FEIL I SØK
11186 * 15 SH  PTF11 'A' = arkiv
11186 * 16 SH  PTF11 spesiel for vise totenfaktura
11186 * 17 SH  PTF11 statusendring 1.2 gang
12019 * 18 SH  PTF12 Feil parameter ved kall til ARC003
12019 * 19 SH  PTF12 ekstratekst på epostsending ved bytte attestasjonskode
12019 * 20 SH  PTF12 vise om L1 bliag i LNAVN
12019 * 21 SH  PTF12 FEIL 1. ANNEN GANG
12019 * 22 SH  PTF12 kan ikke kreditere status 'K'
12019 * 23 SH  PTF12 seleksjon mnd/aar
12019 * 24 SH  PTF12 kan ikke blanke kreditering med G og signatur *K*
12019 * 25 SH  PTF12 eventuelt i historikk
********************************************************************
      *
      * inkluder div /copy ... for å kunne bruke funskjoner fra CGIDEV2 serviceprog
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
N10  FKODTSF    IF   E           K DISK
N10  FADOBEF    IF   E           K DISK
N09  FSYPARL2   IF   E           K DISK
N08  FKOSTB7    IF   E           K DISK
N02  FKOSTT     UF   E           K DISK
     Faruserf   IF   E           K DISK
     FARKEXT    IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
S10  F*rkivl11  IF   E           K DISK
S10  Farkivl06  IF   E           K DISK
     FLEVEL01   IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKOSTA     IF   E           K DISK
     FKOSTA14   IF   E           K DISK
     F                                     RENAME(KOSTAR:KOST14R)
     FKOSTAOPD  UF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTARO)
     FKOSTA3    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA3R)
     FKOSTA4    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA4R)
     FKOSTA5    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA5R)
     FKOSTA6    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA6R)
     FKOSTA7    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA7R)
     FKOSTA8    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA8R)
     FKOSTA9    IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA9R)
     FKOSTA11   IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA11R)
     FKOSTA12   IF   E           K DISK
     F                                     RENAME(KOSTAR:KOSTA12R)
     FFRISKL01  IF   E           K DISK
     FSYKS21FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *
n10  D BatDta          s            200
n10  D FraFil          s            200
n10  D TilFil          s            200
n10  D FraMappe        s            200
n10  D TilMappe        s            200
n10  D PCMappe         s            200
n10  D PCTemp          s            200
n10  D VBZ             s            200
n10  D VBC             s            200
n10  D STRVBC          s            200
n10  D CPY             s            200
N10  D OPNIEBAT        s            512
N10  D Ubane           s            512
n10  D TilPage         s              1
n10  D AdobePath       s            200
n10  D OldFile         s            200
n10  D PDFfil          s            200
n10  D Tstcmd          s            200
n10  D W2EXMax         s             15
n10  D W2GNMax         s             15
n10  D W2MoVar         s             15    VARYING
      *
     D RX              S              1    DIM(35)
     D SX              S              1    DIM(15)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
N23  D                 DS
N23  D  KAPÅRF                 1      2  0
N23  D  KAPMNF                 3      4  0
N23  D  KAPPER                 1      4  0
N23  D                 DS
N23  D  WSAARF                 1      2  0
N23  D  WSMNDF                 3      4  0
N23  D  WSPERF                 1      4  0
N23  D                 DS
N23  D  WSAART                 1      2  0
N23  D  WSMNDT                 3      4  0
N23  D  WSPERT                 1      4  0
     D                 DS
     D  KABDTÅ                 1      4  0
     D  KABDTM                 5      6  0
     D  KABDTD                 7      8  0
     D  KABDT                  1      8  0
     D                 DS
     D  WSBDTD                 1      2  0
     D  WSBDTM                 3      4  0
     D  WSBDTÅ                 5      6  0
     D  WSBDT                  1      6  0
n07  D                 DS
N07  D  WSFDTD                 1      2  0
N07  D  WSFDTM                 3      4  0
n07  D  WSFDTÅ                 5      6  0
N07  D  WSFDT                  1      6  0
n07  D                 DS
N07  D  KAFDTÅ                 1      4  0
N07  D  KAFDTM                 5      6  0
n07  D  KAFDTD                 7      8  0
N07  D  KAFFDT                 1      8  0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  YDTÅ                   1      4  0
     D  YDTM                   5      6  0
     D  YDTD                   7      8  0
     D  YDT                    1      8  0
     D                 DS
     D  XTIME                  1     14  0
     D  XTM                    1      6  0
     D  XDG                    7      8  0
     D  XMN                    9     10  0
     D  XÅR                   11     14  0
     D                 DS
     D  KADTE                  1      8  0
     D  KAÅRE                  1      4  0
     D  KAMNE                  5      6  0
     D  KADGE                  7      8  0
N01  D                 DS
N01  D  KATXT                  1     35
N01  D   KATXT1_2              1      2
      * PARAMETERSTRENG FOR KALL PÅ SYKS12
     D                 DS
     D  P1DS                   1    256
     D  P1FLAG                 1      1
     D  P1BNR                  2      8  0
     D  P1AVD                  9     12  0
     D  P1TUNR                13     20  0
     D  P1OAVD                21     24  0
     D  P1OPD                 25     31  0
     D  P1BL                  32     44  2
     D                UDS
     D  UUSER                401    410
     D* definere numeriske verdier i alfafelt
     D NUM             C                   CONST('0123456789 ')
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C                   EXSR      LESPOS
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C   88              MOVE      KABNR2        SABNR
     C  N88              MOVE      KABNR         SABNR
N01  c                   exsr      SetSFL
     C                   WRITE     SUBFIL
     C                   EXSR      LESPOS
     C  N94              END
     C                   END
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C     START3        TAG
     C                   SETOFF                                       9998
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     BUNN
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   EXFMT     SUBCTL
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       909830
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE NY
     C     START4        TAG
     C   06              DO
     C                   Z-ADD     1             UFLAGG            1 0
     C                   MOVE      W2BNR         UBNR              7 0
     C                   CALL      'SYKS02S'
     C                   PARM                    UBNR
N13  C                   PARM                    inisg
     C                   PARM                    UFLAGG
     C     UBNR          IFEQ      0
     C                   GOTO      START3
     C                   END
     C                   MOVE      UBNR          WSBNR
     C                   MOVEA     '10000000'    *IN(41)
s08  C*                  MOVEA     '00000000'    *IN(49)
n08  C                   MOVEA     '000000000'   *IN(49)
     C                   GOTO      START
     C                   END
     C*** SØK FRA
     C   08              GOTO      START6
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C  N94XBNR          CHAIN(N)  KOSTAOPD                           33
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      ' '                                          1<-B
     C     W2BNR         ORNE      0
     C     W2ST          ORNE      *BLANKS
     C     W2FNR         ORNE      *BLANKS
     C     W2LNR         ORNE      0
     C     W2DT          ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2NR          IFEQ      ' '                                           2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          IFEQ      '1'                                            3<-B
     C                   MOVE      '1'           *IN06
     C                   MOVE      ' '           W2NR
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2BNR         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0057'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYBIL
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2ST
     C                   MOVE      *BLANKS       W2FNR
     C                   MOVE      *ZEROS        W2LNR
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DT
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
N02  C     KREDIT        IFEQ      'J'
N02  C                   clear                   bilde01
N02  C                   MOVE      KABNR         WSBNR
N02  C                   MOVEA     '10000000'    *IN(41)
s08  C*                  MOVEA     '00000000'    *IN(49)
n08  C                   MOVEA     '000000000'   *IN(49)
N02  C                   MOVE      'G'           WSST
N02  C                   EXSR      TESTB1
N02  C                   GOTO      START
N02  C                   END
     C                   GOTO      START3
     C*
     C*** SØK FRA
     C     START6        TAG
     C  N30
     CANN04              Z-ADD     7             LINNBR
     C                   Z-ADD     41            POSNBR
     C                   EXFMT     BILDE01
     C                   MOVEA     '00000000'    *IN(41)
s08  C*                  MOVEA     '00000000'    *IN(49)
n08  C                   MOVEA     '000000000'   *IN(49)
     C
     C                   MOVEA     '00'          *IN(98)
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDTA
     C                   GOTO      START6
     C                   END
     C                   EXSR      TESTB1
     C   30              GOTO      START6
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
N01  C***********************************************
N01  C     SetSFL        BEGSR
N01  C***********************************************
N01  c     KATXT1_2      comp      'R*'                                   61
N01  c   61KAST          comp      ' '                                    61
N07  C                   EVAL      LNAVN='* Direkte hovedbok'
N07  C     LEVEK         CHAIN     LEVEL01                            98
N20  C                   MOVE      KATXT         L1BIL             4
N20  C  N98L1BIL         IFEQ      '*L1*'
N20  C                   MOVE      L1BIL         LNAVN
N20  C                   END
n08  c     *in57         ifeq      '0'
N08  c                   move      *blanks       kbrekl
N08  c                   setoff                                       78
N08  c     keyre         chain     kostb7                             33
n08  c  N33              seton                                        78
n08  c                   end
N01  c                   endsr
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   MOVE      BNRTYP        TMPTYP            1
     C                   CLEAR                   BILDE01
     C                   MOVE      TMPTYP        BNRTYP
     C                   MOVE      W2BNR         WSBNR
     C                   MOVE      W2FNR         WSFNR
     C                   MOVE      W2LNR         WSLNR
     C                   MOVE      W2ST          WSST
     C                   MOVE      W2DT          WSDT
     C                   MOVE      W2SG          WSSG
      *
     C                   MOVE      ' '           W2NR
     C                   MOVE      *ZEROS        W2BNR
     C                   MOVE      *BLANKS       W2FNR
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2LNR
     C                   MOVE      *ZEROS        W2DT
     C                   MOVE      *BLANKS       W2ST
      *
     C                   MOVEA     '00000000'    *IN(41)
s08  C*                  MOVEA     '00000000'    *IN(49)
n08  C                   MOVEA     '000000000'   *IN(49)
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C                   EXSR      TESTB1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     NYBIL         BEGSR
     C***********************************************
     C* KAN HENTE OPP ENTEN VIA INNREG.NR ELLER VIA ENDELIG B.NR.
     C     W2BNR         CHAIN(N)  KOSTAOPD                           98
     C   98W2BNR         CHAIN     KOSTA14                            98
     C   98              DO
     C                   MOVE      'YBC0058'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    '2'
S10  C                   exsr      VISPDFBROWSER
     C                   EXSR      CHGK
     C     W2NR          WHENEQ    '4'
     C                   EXSR      DLTK
     C     W2NR          WHENEQ    '5'
     C                   EXSR      DSPK
     C     W2NR          WHENEQ    '6'
     C     KAST          IFEQ      ' '
     C     KABDT         IFEQ      0
     C     KAPMN         OREQ      0
     C                   EXSR      CHGK
     C                   ELSE
     C                   EXSR      CHGK2
     C                   END
     C                   ELSE
     C                   EXSR      CHGK2
     C                   END
     C     W2NR          WHENEQ    '7'
     C                   MOVE      KABNR         ABNR              7
     C                   MOVE      KABDT         ABDT              6
     C                   CALL      'SYKS64'
     C                   PARM                    ABNR
     C                   PARM                    ABDT
     C     W2NR          WHENEQ    '8'
     C                   MOVE      'K'           P1FLAG
     C                   Z-ADD     KABNR         P1BNR
     C                   MOVE      *ZEROS        P1AVD
     C                   MOVE      *ZEROS        P1TUNR
     C                   MOVE      *ZEROS        P1OAVD
     C                   MOVE      *ZEROS        P1OPD
     C                   MOVE      *ZEROS        P1BL
     C                   MOVE      P1DS          PARM1           256
     C                   CALL      'SYKS12'
     C                   PARM                    PARM1
     C     W2NR          WHENEQ    '9'
     C                   EXSR      CHGST
      * Skriv Skanner skilleark (typen vil være privat/begynner på Z..)
     C     W2NR          wheneq    'S'
     C                   MOVE      ' '           WSNR
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     KABNR         SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
      * Browse skannet dokument direkte
     C     W2NR          wheneq    'B'
     C                   MOVE      ' '           WSNR
S10  C*                  exsr      ARKIVS
S10  C                   exsr      VISPDFBROWSER
N15   * A= arkiv
N15  C     W2NR          wheneq    'A'
N15  C                   MOVE      ' '           WSNR
N15  C                   exsr      ARKIVS
N10   * Attestasjon
N10  C     W2NR          WHENEQ    'X'
N22  C     KAST          ifeq      ' '
N22  c                   move      'SHU1709'     msgnr
N22  c                   seton                                        30
N22  c                   goto      uthent
N22  c                   end
N10  C     W2ATT         IFEQ      *BLANKS
     c                   move      w2att         wsatt
N10  C     KEYSF         CHAIN     KODTSF                             30
N10  C     *in30         ifeq      '1'
N10  c                   move      'SPS0001'     msgnr
N10  c                   goto      uthent
N10  c                   else
N10  C                   MOVE      W2ATT         wsatt
N10  C                   MOVE      *blanks       w2att
N10  C                   EXSR      ATTSR
N10  C                   END
N10  C                   END
     C                   ENDSL
      *
     C     SLTDN         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      ' '           W2NR
     C  N98              MOVE      *ZEROS        W2BNR
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
s10  C*                  ENDSR
n10  C     uthent        ENDSR
     C*
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     c   57keyreK        setll     kostb7
     C   41
     CAN 88WSBNR         SETLL     KOSTA14
     C   41
     CANN88WSBNR         SETLL     KOSTA
     C   42WSFNR         SETLL     KOSTA3
     C   43WSLNR         SETLL     KOSTA4
     C   44KOSA4K        SETLL     KOSTA4
     C   45KOSA5K        SETLL     KOSTA5
     C   46WSSG          SETLL     KOSTA6
     C   47KOSA6K        SETLL     KOSTA6
     C   48KOSA7K        SETLL     KOSTA7
     C   49KOSA8K        SETLL     KOSTA8
     C   50YDT           SETLL     KOSTA9
     C   51KOS11K        SETLL     KOSTA11
     C   52KOS12K        SETLL     KOSTA12
     C   53FRIKEY        SETLL     FRISKL01
     C   54WSFSOK        SETLL     FRISKL01
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESPOS        BEGSR
     C***********************************************
     C     STLF          TAG
N08  c   57keyrek        reade     kostb7                                 94
n08  c   57
n08  CANN94KBBNR         CHAIN     KOSTA                              94
     C   41
     CANN88              READ      KOSTA                                  94
     C   41
     CAN 88              READ      KOSTA14                                94
     C   42              READ      KOSTA3                                 94
     C   43              DO
     C     STLES1        TAG
     C     WSLNR         READE     KOSTA4                                 94
     C  N94WSSG          IFNE      *BLANKS
     C     WSSG          ANDNE     KASG
     C                   GOTO      STLES1
     C                   END
     C                   END
     C   44              DO
     C     STLES2        TAG
     C     WSLNR         READE     KOSTA4                                 94
     C  N94WSST          COMP      KAST                               9494
     C  N94WSSG          IFNE      *BLANKS
     C     WSSG          ANDNE     KASG
     C                   GOTO      STLES2
     C                   END
     C                   END
     C   45              DO
     C     STLES3        TAG
     C     WSLNR         READE     KOSTA5                                 94
     C  N94WSST          IFNE      '*'
     C     WSST          ANDNE     KAST
     C                   GOTO      STLES3
     C                   END
     C  N94WSSG          IFNE      *BLANKS
     C     WSSG          ANDNE     KASG
     C                   GOTO      STLES3
     C                   END
     C                   END
     C   46WSSG          READE     KOSTA6                                 94
     C   47WSSG          READE     KOSTA6                                 94
     C   47
     CANN94WSST          COMP      KAST                               9494
     C   48WSSG          READE     KOSTA7                                 94
     C   48
     CANN94WSST          IFNE      '*'
S14  C*    WSST          COMP      KAST                               9494
N14  C     WSST          IFNE      KAST
N14  C                   GOTO      STLF
N14  C                   END
     C                   END
     C   49              READ      KOSTA8                                 94
     C   49
     CANN94WSST          IFNE      '*'
S14  C*    WSST          COMP      KAST                               9494
N14  C     WSST          IFNE      KAST
N14  C                   GOTO      STLF
N14  C                   END
     C                   END
     C   50              READ      KOSTA9                                 94
     C   50
     CANN94WSST          IFNE      '*'
S14  C*    WSST          COMP      KAST                               9494
N14  C     WSST          IFNE      KAST
N14  C                   GOTO      STLF
N14  C                   END
     C                   END
     C   51              DO
     C     STLES4        TAG
     C                   READ      KOSTA11                                94
     C  N94WSST          IFNE      '*'
     C     WSST          ANDNE     KAST
     C                   GOTO      STLES4
     C                   END
     C  N94YDT           IFNE      0
     C     KABDT         ANDLT     YDT
     C                   GOTO      STLES4
     C                   END
     C                   END
     C   52              DO
     C     STLES5        TAG
     C                   READ      KOSTA12                                94
     C  N94WSST          IFNE      '*'
     C     WSST          ANDNE     KAST
     C                   GOTO      STLES5
     C                   END
     C  N94YDT           IFNE      0
     C     KABDT         ANDLT     YDT
     C                   GOTO      STLES5
     C                   END
     C                   END
     C   53              DO
     C     STLES6        TAG
     C                   READ      FRISKL01                               94
     C  N94FSSOK         IFGT      CSTXT2
     C                   MOVE      '1'           *IN(94)
     C                   END
     C  N94FSBNR         CHAIN     KOSTA                              94
     C  N94WSST          IFNE      '*'
     C     WSST          ANDNE     KAST
     C                   GOTO      STLES6
     C                   END
     C  N94YDT           IFNE      0
     C     KABDT         ANDLT     YDT
     C                   GOTO      STLES6
     C                   END
     C                   END
     C   54              DO
     C     STLES7        TAG
     C                   READ      FRISKL01                               94
     C     FSKODE        IFGT      WSFSOK
     C                   SETON                                        94
     C                   END
     C  N94FSBNR         CHAIN     KOSTA                              94
     C  N94WSST          IFNE      '*'
     C     WSST          ANDNE     KAST
     C                   GOTO      STLES7
     C                   END
     C  N94YDT           IFNE      0
     C     KABDT         ANDLT     YDT
     C                   GOTO      STLES7
     C                   END
     C                   END
N04  C  N94ws12          ifne      *blanks
N04  c     ws12          andne     kablst
N04  c                   goto      stlf
n04  c                   end
     C*Bilagskommentar er key .. for langt.?
     C     *IN51         IFEQ      '1'
     C     *IN52         OREQ      '1'
     C     KATXT         IFGT      YSTXT2
     C                   MOVE      '1'           *IN(94)
     C                   END
     C                   END
N23  C     *IN94         IFEQ      '0'
N23  C                   MOVE      KAPÅR         KAPÅRF
N23  C                   MOVE      KAPMN         KAPMNF
N23  c     WSPERF        IFNE      *zeros
N23  c     KAPPER        ANDLT     WSPERF
N23  c                   goto      stlf
n23  c                   end
N23  c     WSPERT        IFNE      *zeros
N23  c     KAPPER        ANDGT     WSPERT
N23  c                   goto      stlf
n23  c                   end
N23  c                   end
     C*
     C  N94              DO
     C                   MOVE      KABNR         XBNR              7 0
     C   51
     COR 52              MOVEL     KATXT         WSF01
     C   53
     COR 54              MOVE      FSSOK         WSF01
     C  N51
     CANN52
     CANN53
     CANN54              DO
     C                   MOVE      *BLANKS       WSF01
     C                   MOVEL     KAFNR         WSF01
     C                   MOVE      KAVK          WSF01
     C                   END
     C                   MOVE      KABDTD        WSBDTD
     C                   MOVE      KABDTM        WSBDTM
     C                   MOVE      KABDTÅ        WSBDTÅ
N07  C                   MOVE      KAFDTD        WSFDTD
N07  C                   MOVE      KAFDTM        WSFDTM
N07  C                   MOVE      KAFDTÅ        WSFDTÅ
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
n07  c                   setoff                                       30
n08  c     WSREKL        comp      ' '                                5757
n08  c   57              move      wsrekl        rekode
n08  C   57              GOTO      SLTB1
     C                   MOVE      *ZEROS        YDT
     C     WSBNR         COMP      0                                  4141
     C     BNRTYP        COMP      *BLANK                                 88
     C   41              GOTO      SLTB1
     C     WSFNR         COMP      *BLANKS                            4242
     C   42              GOTO      SLTB1
      *
     C     WSDT          IFNE      0
     C                   MOVE      WSDTD         YDTD
     C                   MOVE      WSDTM         YDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          YDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          YDTÅ
     C                   END
     C     WSST          IFEQ      '*'
     C                   MOVE      ' '           YST
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   END
     C                   END
      *
     C     WSLNR         IFNE      0
     C     LEVE1K        CHAIN     LEVEL01                            98
     C   98              DO
     C                   SETON                                        30
     C                   MOVE      'SPL0029'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLTB1
     C                   END
     C     WSDT          IFEQ      0
     C     WSST          IFEQ      '*'
     C                   SETON                                        43
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   SETON                                        44
     C                   END
     C                   ELSE
     C                   SETON                                        45
     C                   END
     C                   GOTO      SLTB1
     C                   END
     C     WSBKOM        IFNE      *BLANKS
     C                   EXSR      MAX
     C     WSDT          IFEQ      0
     C     WSST          IFEQ      '*'
     C                   SETON                                        51
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   SETON                                        52
     C                   END
     C                   ELSE
     C                   SETON                                        51
     C                   END
     C                   GOTO      SLTB1
     C                   END
     C     WSFSOK        IFNE      *BLANKS
     C     WSFTXT        ANDNE     *BLANKS
     C                   EXSR      MAXSOK
     C     WSDT          IFEQ      0
     C     WSST          IFEQ      '*'
     C                   SETON                                        53
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   SETON                                        53
     C                   END
     C                   ELSE
     C                   SETON                                        53
     C                   END
     C                   GOTO      SLTB1
     C                   END
     C     WSFSOK        IFNE      *BLANKS
     C     WSFTXT        ANDEQ     *BLANKS
     C     WSDT          IFEQ      0
     C     WSST          IFEQ      '*'
     C                   SETON                                        54
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   SETON                                        54
     C                   END
     C                   ELSE
     C                   SETON                                        54
     C                   END
     C                   GOTO      SLTB1
     C                   END
     C     WSSG          IFNE      *BLANKS
     C     WSDT          IFEQ      0
     C     WSST          IFEQ      '*'
     C                   SETON                                        46
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   SETON                                        47
     C                   END
     C                   ELSE
     C                   SETON                                        48
     C                   END
     C                   GOTO      SLTB1
     C                   END
     C     WSDT          IFNE      0
     C                   SETON                                        50
     C                   GOTO      SLTB1
     C                   END
     C     WSST          COMP      *BLANKS                            4949
     C   49              DO
     C     WSST          IFEQ      '*'
     C                   MOVE      ' '           YST
     C                   ELSE
     C                   MOVE      WSST          YST
     C                   END
     C                   MOVE      *ZEROS        YDT
     C                   GOTO      SLTB1
     C                   END
     C*
     C                   MOVE      ' '           YST
     C                   SETON                                        49
     C                   GOTO      START
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     41            POSNBR
     C*
     C     SLTB1         ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      'N'           kredit
     C                   Z-ADD     0             LINNBR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '2'
S10  C                   exsr      VISPDFBROWSER
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGK
     C   98
     COR 12              GOTO      SLHENT
     C                   END
N02  C     WSNR          IFEQ      'K'
N02  C                   MOVE      ' '           WSNR
N02  C                   EXSR      KRED
N02  C   98
N02  COR 12              GOTO      SLHENT
N02  C                   END
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C                   EXSR      DLTK
     C   98
     COR 12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      DSPK
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '6'
     C                   MOVE      ' '           WSNR
     C     KAST          IFEQ      ' '
     C     KABDT         IFEQ      0
     C     KAPMN         OREQ      0
     C                   EXSR      CHGK
     C                   ELSE
     C                   EXSR      CHGK2
     C                   END
     C                   ELSE
     C                   EXSR      CHGK2
     C                   END
     C   98
     COR 12              GOTO      SLHENT
     C                   END
     C* KOBLE FRIE SØKEVEIER
     C     WSNR          IFEQ      '7'
     C                   MOVE      ' '           WSNR
     C                   MOVE      KABNR         ABNR              7
     C                   MOVE      KABDT         ABDT              6
     C                   CALL      'SYKS64'
     C                   PARM                    ABNR
     C                   PARM                    ABDT
     C                   MOVE      '1'           *IN99
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
     C* KOBLE BUDSJETTERTE KOSTNADER (ATTESTERE)
     C     WSNR          IFEQ      '8'
     C                   MOVE      ' '           WSNR
     C                   MOVE      'K'           P1FLAG
     C                   Z-ADD     KABNR         P1BNR
     C                   MOVE      *ZEROS        P1AVD
     C                   MOVE      *ZEROS        P1TUNR
     C                   MOVE      *ZEROS        P1OAVD
     C                   MOVE      *ZEROS        P1OPD
     C                   MOVE      *ZEROS        P1BL
     C                   MOVE      P1DS          PARM1           256
     C                   CALL      'SYKS12'
     C                   PARM                    PARM1
     C                   MOVE      '1'           *IN99
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
      *
     C     WSNR          IFEQ      '9'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGST
     C   98              GOTO      SLHENT
N24  C   99              GOTO      SLHENT
     C                   END
      * Skriv Skanner skilleark (typen vil være privat/begynner på Z..)
     C     WSNR          IFEQ      'S'
     C                   MOVE      ' '           WSNR
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     KABNR         SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   MOVE      '1'           *IN99
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
      * Browse skannet dokument dirtekte
     C     WSNR          IFEQ      'B'
     C                   MOVE      ' '           WSNR
S10  C*                  exsr      ARKIVS
N10  C                   exsr      VISPDFBROWSER
     C                   MOVE      '1'           *IN99
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
N15   * A=Arkiv
N15  C     WSNR          IFEQ      'A'
N15  C                   MOVE      ' '           WSNR
N15  C                   exsr      ARKIVS
N15  C                   MOVE      '1'           *IN99
N15  c                   exsr      SetSFL
N15  C                   UPDATE    SUBFIL
N15  C                   END
N10   * Attestasjon
N22  C     WSNR          IFEQ      'X'
N22  C     KAST          andne     ' '
N22  c                   move      'SHU1709'     msgnr
N22  c                   seton                                        30
N22  c                   goto      slhent
N22  c                   end
N10  C     WSNR          IFEQ      'X'
N10  C     WSATT         ANDNE     *BLANKS
N10  C     KEYSF         CHAIN     KODTSF                             30
N10  C     *in30         ifeq      '1'
N10  c                   move      'SPS0001'     msgnr
N10  c                   goto      slhent
N10  c                   else
N10  C                   EXSR      ATTSR
N10  C                   MOVE      '1'           *IN99
N10  C                   END
N10  C                   END
      *
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGK          BEGSR
     C***********************************************
      *
      * ENDRE BILLAG
      *
     C     KABNR         CHAIN(N)  KOSTAOPD                           98
N11  C     KAST          IFEQ      'G'
N11  C     KABNR         CHAIN     KOSTAOPD                           98
N11  C                   MOVE      ' '           KAST
N21  c     KABLST        ifeq      '1'
N21  c                   move      ' '           KABLST
N21  c                   end
N21  c     KABLST        ifeq      '2'
N21  c                   move      '1'           KABLST
N21  c                   end
N21  C                   EXCEPT    BLAST
N21  C                   END
     C     KAST          COMP      ' '                                9898
     C   98              GOTO      SLCHG
     C                   MOVE      '1'           *IN99
      *
     C                   Z-ADD     2             UFLAGG
     C                   CALL      'SYKS02S'
     C                   PARM                    KABNR
N13  C                   PARM                    KASG
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        IFNE      1
     C     UFLAGG        ANDNE     3
     C     KABNR         CHAIN     KOSTAOPD                           33
     C                   TIME                    XTIME
     C                   MOVE      UUSER         KAUSER
     C                   MOVE      XTM           KATME
     C                   MOVE      XDG           KADGE
     C                   MOVE      XMN           KAMNE
     C                   MOVE      XÅR           KAÅRE
     C                   EXCEPT    OPDST
     C                   END
     C                   MOVE      KABDTD        WSBDTD
     C                   MOVE      KABDTM        WSBDTM
     C                   MOVE      KABDTÅ        WSBDTÅ
N07  C                   MOVE      KAFDTD        WSFDTD
N07  C                   MOVE      KAFDTM        WSFDTM
N07  C                   MOVE      KAFDTÅ        WSFDTÅ
      *
     C     SLCHG         TAG
     C     *IN90         IFEQ      '0'
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
     C*
     C                   ENDSR
      *
N02  C***********************************************
N02  C     KRED          BEGSR
N02  C***********************************************
N02  C     KABNR         CHAIN(N)  KOSTAOPD                           98
      *
      * 1. gangsreg kan krediteres
      *
N06  C     KAST          IFEQ      ' '
N06  C     KABLST        ANDEQ     '1'
N06  C                   Goto      neste
N06  C                   end
N02   *
N02   * status må være O
N02   *
N02  C     KAST          COMP      'O'                                9898
N22  C  N98KAST          COMP      'K'                                    98
N02  C   98              GOTO      SLKRE
N02  C                   MOVE      '1'           *IN99
N02   *
n06  c     neste         tag
N02  C                   MOVE      '1'           *IN30
N02  C                   MOVE      'JOV0385'     MSGNR
N02  C                   Z-ADD     22            LINNBR
N02  C                   Z-ADD     14            POSNBR
N02  C     STBUN2        TAG
N02  C                   EXFMT     BUNNKR
N02  C     *IN12         IFEQ      '1'
N02  C                   GOTO      SLKRE
N02  C                   ENDIF
      *
N02   *
N02   * HENTER BILAGSNUMMER FRA TELLER
N02   *
N02  C     WSBSR         IFNE      ' '
N02  C     WSBNR2        ANDEQ     *ZEROS
N02  C     WSBSR         CHAIN     KOSTT                              33
N02  C   33              Z-ADD     22            LINNBR
N02  C   33              Z-ADD     14            POSNBR
N02  C   33              GOTO      STBUN2
N02  C                   MOVE      KTNR          WSBNR2
N02  C                   ADD       1             KTNR
N02  C                   UPDATE    KOSTTR
N02  C                   ENDIF
N02   *
N02   * TILLATER IKKE 0 I BILAGSNUMMER VED FERDIGMELDING
N02   *
N02  C     WSBNR2        IFEQ      *ZEROS
N02  C                   MOVE      '1'           *IN30
N02  C                   MOVE      'JOV0385'     MSGNR
N02  C                   Z-ADD     22            LINNBR
N02  C                   Z-ADD     40            POSNBR
N02  C                   GOTO      STBUN2
N02  C                   ENDIF
N02   *
N02   * BILASGSNUMMER MÅ IKKE FINNES FRA FØR
N02   *
N02  C     WSBNR2        IFNE      *ZEROS
N02  C     WSBNR2        CHAIN     KOSTA14                            33
N02  C     *IN33         IFEQ      *OFF
N02  C                   MOVE      'JOV0387'     MSGNR
N02  C                   Z-ADD     22            LINNBR
N02  C                   Z-ADD     40            POSNBR
N02  C                   GOTO      STBUN2
N02  C                   ENDIF
N02  C                   ENDIF
N02  C                   MOVE      WSBNR2        UBNR2
N02   *
N02  C                   CALL      'SYKS07'
N02  C                   PARM                    KABNR
N02  C                   PARM                    KABNRN            7 0
N02  C                   PARM                    UBNR2             7 0
N02  C                   PARM                    WSTXT            35
N02  C                   move      UBNR2         kabnr
N02  C                   move      'J'           kredit            1
N02   *
N02   *
N02  C*
N02  C     SLKRE         ENDSR
     C*
     C***********************************************
     C     CHGST         BEGSR
     C***********************************************
     C     KABNR         CHAIN     KOSTAOPD                           98
N24  C  N98KAST          IFEQ      'G'
N24  C     KASG          ANDEQ     '*K*'
N24  c                   move      'SHU1715'     msgnr
N24  c                   seton                                        3099
N24  C                   EXCEPT    BLADUM
N24  c                   goto      utkred
n24  c                   end
     C  N98KAST          IFEQ      'D'
     C     KAST          OREQ      'G'
N03  C     KAST          OREQ      'A'
N03  C     KAST          OREQ      'B'
N17  c     Kast          ifeq      'G'
N17  c     KABLST        ifeq      '1'
N17  c                   move      ' '           KABLST
N17  c                   end
N17  c     KABLST        ifeq      '2'
N17  c                   move      '1'           KABLST
N17  c                   end
N17  c                   end
     C                   MOVE      ' '           KAST
     C                   END
     C  N98              EXCEPT    BLAST
     C  N98              MOVE      '1'           *IN99
      *
     C     *IN90         IFEQ      '0'
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
     C*
s24  C*                  ENDSR
n24  C     utkred        ENDSR
     C*
N10  C***********************************************
N10  C     ATTSR         BEGSR
N10  C***********************************************
N10  C     KABNR         CHAIN     KOSTAOPD                           98
N10  C     *IN98         IFEQ      '0'
N12  C                   move      KASG          FRASG             3
N10  C                   MOVE      '1'           *IN99
N10  C                   MOVE      WSATT         KASG
N12  C                   MOVE      WSATT         TILSG             3
N10  C                   EXCEPT    SETATT
N19  C     FRASG         IFNE      TILSG
N19  C                   eval      text70='Fakt fra: '
N19  c                             +%trim(LNAVN)
N19  C                             +' Beløp: '
N19  c                             +%trim(KAVAL)
N19  C                             +' '
N19  C                             +%trim(%editc(KABL:'3'))
N19  C                             +' FD: '
N19  C                             +%trim(%editw(WSFDT:'  .  .  '))
N12  C                   CALL      'SYGE108'
N12  C                   PARM                    FRASG
N12  C                   PARM                    TILSG
N12  C                   PARM                    TEXT70           70
N12  C                   END
N10  C                   END
N10   *
N10  C     *IN90         IFEQ      '0'
N10  C     XLIN          IFEQ      0
N10  C                   Z-ADD     15            LINNBR
N10  C                   ELSE
N10  C                   Z-ADD     XLIN          LINNBR
N10  C                   END
N10  c                   exsr      SetSFL
N10  C                   UPDATE    SUBFIL
N10  C                   END
N10  C*
N10  C                   ENDSR
N10  C*
     C***********************************************
     C     DLTK          BEGSR
     C***********************************************
     C     KABNR         CHAIN(N)  KOSTAOPD                           98
     C  N98KAST          IFNE      ' '
     C                   SETON                                        98
     C                   END
     C   98              GOTO      SLDLT
     C                   MOVE      '1'           *IN99
      *
     C                   MOVE      KATXT         WSTXT
     C     STDLT         TAG
     C                   EXFMT     BILDE02
     C                   SETOFF                                       30
     C   12              GOTO      SLDLT
     C     WSTXT         IFEQ      *BLANKS
     C                   MOVE      'SPT0045'     MSGNR
     C                   SETON                                        30
     C                   GOTO      STDLT
     C                   END
     C     KABNR         CHAIN     KOSTAOPD                           98
     C                   MOVE      WSTXT         KATXT
     C                   MOVE      'D'           KAST
     C                   TIME                    XTIME
     C                   MOVE      UUSER         KAUSER
     C                   MOVE      XTM           KATME
     C                   MOVE      XDG           KADGE
     C                   MOVE      XMN           KAMNE
     C                   MOVE      XÅR           KAÅRE
     C  N98              EXCEPT    DLTKA
      *
     C     SLDLT         TAG
     C     *IN90         IFEQ      '0'
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
     C*
     C                   WRITE     BUNN
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DSPK          BEGSR
     C***********************************************
     C     KABNR         CHAIN(N)  KOSTAOPD                           33
     C                   MOVE      KAUSER        SUSER            10
     C                   MOVE      KATME         STME              6 0
     C                   MOVE      KADGE         SDTE              6 0
     C                   MOVE      '1'           *IN99
      *
     C                   Z-ADD     5             UFLAGG
     C                   CALL      'SYKS02S'
     C                   PARM                    KABNR
N13  C                   PARM                    KASG
     C                   PARM                    UFLAGG
      *
     C     *IN90         IFEQ      '0'
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGK2         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        UFLAGG
     C     KABNR         CHAIN     KOSTAOPD                           98
     C  N98KAST          IFNE      ' '
N11  C     KAST          ANDNE     'G'
     C                   EXCEPT    OPDST
     C                   Z-ADD     5             UFLAGG
     C                   END
     C   98              GOTO      SLCHG2
     C                   MOVE      '1'           *IN99
      *
     C     UFLAGG        IFEQ      0
     C                   MOVE      'B'           KAST
     C                   EXCEPT    OPDST
     C                   END
     C     VALU1K        CHAIN     VALUL01                            33
     C                   MOVE      KABDT         UBDT              6 0
     C                   MOVE      KABNR2        UBNR2             7 0
     C     KAVKU         DIV       OMRFAK        XFAK              9 6
     C     KABL          MULT(H)   XFAK          UBL              13 2
     C     KAVKU         DIV       OMRFAK        UVKU             10 7
     C                   CALL      'SYKS03'
     C                   PARM                    FIFIRM
     C                   PARM                    KABNR
     C                   PARM                    UBDT
     C                   PARM                    KAPÅR
     C                   PARM                    KAPMN
     C                   PARM                    KAVK
     C                   PARM                    KAVAL
     C                   PARM                    UVKU
     C                   PARM                    KABL
     C                   PARM                    KABLM
     C                   PARM                    KALNR
     C                   PARM                    UBL
     C                   PARM                    KAMVA
     C                   PARM                    UBNR2
     C                   PARM                    UFLAGG
     C                   PARM                    UPARM           512
     C     KAST          IFEQ      'B'
     C     KABNR         CHAIN     KOSTAOPD                           33
     C     UFLAGG        IFEQ      9                                            FERDIGMELDT
     C                   MOVE      'G'           KAST
N05  C     KABLST        IFEQ      '1'
N05  C                   MOVE      '2'           KABLST
N05  C                   END
     C                   ELSE
N05  C     UFLAGG        IFEQ      8
N05  C                   MOVE      'G'           KAST
N05  C                   MOVE      '1'           KABLST
N05  C                   ELSE
     C                   MOVE      ' '           KAST
N05  C                   END
     C                   END
     C                   TIME                    XTIME
     C                   MOVE      UUSER         KAUSER
     C                   MOVE      XTM           KATME
     C                   MOVE      XDG           KADGE
     C                   MOVE      XMN           KAMNE
     C                   MOVE      XÅR           KAÅRE
     C                   MOVE      UBNR2         KABNR2
     C                   EXCEPT    OPDST
     C                   END
     C     UFLAGG        COMP      1                                      12
      *
     C     SLCHG2        TAG
     C     *IN90         IFEQ      '0'
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
N01  c                   exsr      SetSFL
     C                   UPDATE    SUBFIL
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MAX           BEGSR
     C***********************************************
     C                   MOVE      WSBKOM        YSTXT            35
     C                   MOVE      WSBKOM        YSTXT2           35
     C*
     C                   MOVE      '9'           ERSTAT            1
     C*
     C     YSTXT2        IFEQ      *BLANKS
     C                   MOVE      '99999'       YSTXT2
     C                   ELSE
     C                   MOVEL     YSTXT2        REPLA
     C                   EXSR      REPLAC
     C                   MOVEL     REPLA         YSTXT2
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     REPLAC        BEGSR
     C***********************************************
     C* Var ERSTAT må settes til ønsket erstatningsverdi. Eks. 9
     C* Var REPLA må være venstrejustert og returneres med alle
     C* blanke satt lik erstatningverdi
     C* Var NUMOK = '0' hvis bare nummeriske og blanke
     C*           > '0' hvis inneholder noe annet
     C* Var ERSTAT må være en alfa lang
     C*
     C* 1. Sjekker om søkebegrepet er nummerisk
     C     NUM           CHECK     REPLA         NUMOK             1 0
     C* 2. Erstatter blanke med erstatningstegn
     C                   MOVEA     REPLA         RX
     C                   DO        35            NMT               3 0
     C     RX(NMT)       IFEQ      ' '
     C                   MOVEA     ERSTAT        RX(NMT)
     C                   END
     C                   ENDDO
     C                   MOVEA     RX            REPLA            35
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MAXSOK        BEGSR
     C***********************************************
     C                   MOVE      WSFTXT        CSTXT            15
     C                   MOVE      WSFTXT        CSTXT2           15
     C*
     C                   MOVE      '9'           ERST              1
     C*
     C     CSTXT2        IFEQ      *BLANKS
     C                   MOVE      '99999'       CSTXT2
     C                   ELSE
     C                   MOVEL     CSTXT2        REPLA1
     C                   EXSR      REPSOK
     C                   MOVEL     REPLA1        CSTXT2
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     REPSOK        BEGSR
     C***********************************************
     C* Var ERST må settes til ønsket erstatningsverdi. Eks. 9
     C* Var REPLA1 må være venstrejustert og returneres med alle
     C* blanke satt lik erstatningverdi
     C* Var NUMOK = '0' hvis bare nummeriske og blanke
     C*           > '0' hvis inneholder noe annet
     C* Var ERST må være en alfa lang
     C*
     C* 1. Sjekker om søkebegrepet er nummerisk
     C     NUM           CHECK     REPLA1        NUMOK             1 0
     C* 2. Erstatter blanke med erstatningstegn
     C                   MOVEA     REPLA1        SX
     C                   DO        15            MMT               3 0
     C     SX(MMT)       IFEQ      ' '
     C                   MOVEA     ERST          SX(MMT)
     C                   END
     C                   ENDDO
     C                   MOVEA     SX            REPLA1           15
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     48
     C                   MOVE      *BLANKS       UUSNAV           30
     C                   CALL      'SO1LEV'
     C                   PARM                    WSLNR
     C                   PARM                    FIFIRM
     C                   PARM                    UUSNAV
     C                   GOTO      SLSØK
     C                   END
      * BILAGSTEKST
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     75
     C                   CALL      'SYKS52A'
     C                   PARM                    WSBKOM
     C                   GOTO      SLSØK
     C                   END
      * FRIE SØKEVEIER
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     43
     C                   CALL      'SYFA65A'
     C                   PARM                    WSFSOK
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
N08  C     KEYREK        KLIST
N08  C                   KFLD                    REKODE            2
N08  C     KEYRE         KLIST
N08  C                   KFLD                    REKODE            2
N08  C                   KFLD                    KABNR
N08  C                   move      'RS'          rekode
N10  C     KEYSF         KLIST
N10  C                   KFLD                    SFKOD             2
N10  C                   KFLD                    WSATT
N10  C                   move      'SF'          SFKOD
     C     LEVE1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSLNR
N07  C     LEVEK         KLIST
N07  C                   KFLD                    FIFIRM
N07  C                   KFLD                    KALNR
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KAVAL
     C     KOSA4K        KLIST
     C                   KFLD                    WSLNR
     C                   KFLD                    YST               1
     C     KOSA5K        KLIST
     C                   KFLD                    WSLNR
     C                   KFLD                    YDT
     C                   KFLD                    YST
     C     KOSA6K        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    YST
     C     KOSA7K        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    YDT
     C                   KFLD                    YST
     C     KOSA8K        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YDT
     C*
     C                   MOVE      '1'           *IN88
     C*
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        YDT
     C                   MOVE      *ZEROS        WSBDT
N07  C                   MOVE      *ZEROS        WSFDT
     C                   MOVE      *ZEROS        KABDT
     C                   MOVE      *ZEROS        XTIME
     C                   MOVE      *ZEROS        KADTE
s09  C*                  MOVE      '1'           *IN49
     C*
     C     KOS11K        KLIST
     C                   KFLD                    WSBKOM
     C                   KFLD                    YST
     C                   KFLD                    YDT
     C*
     C     KOS12K        KLIST
     C                   KFLD                    WSBKOM
     C                   KFLD                    YDT
     C*
     C     FRIKEY        KLIST
     C                   KFLD                    WSFSOK
     C                   KFLD                    WSFTXT
N23   *  initierer datastrukturer
N23  C                   move      *zeros        kapper
N23  C                   move      *zeros        wsperf
N23  C                   move      *zeros        wspert
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C*
N09  C     parkey        klist
N09  c                   kfld                    syuser
N09  c                   kfld                    sypaid
n09  C                   move      'USRID'       SYPAID
n09  c                   move      uuser         syuser
n09  c     parkey        chain     syparl2                            33
N09  C  N33              movel     syvrda        WSSG
N13  C  N33              movel     syvrda        INISG             3
N09  C  N33              seton                                        47
N09  C   33              seton                                        49
     C*
N10   *
N10  C     arklagk       KLIST
N10  C                   KFLD                    FIFIRM
N10  C                   KFLD                    arklag
N10  C                   z-add     1             oddeve            1 0
N10   * Hent systemverdier som går på åpning av adobe i acrobat mm
N10  c     '          '  chain     ADOBEF                             33
N10  c     UUSER         chain     ADOBEF                             33
N10   * ADUSER        10          COLHDG('BRUKER')
N10   * ADARKM        70          COLHDG('IFS ARKIVMAPPE')
N10   * ADIFTM        70          COLHDG('IFS TEMP-MAPPE - med AS-400 navn'
N10   * ADNETV        70          COLHDG('IFS NETV.S/BANE-
N10   * ADPCTM        70          COLHDG('PC TEMP-MAPPE')
N10   * ADPATH       170          COLHDG('ADOBE-PATH(PGM)')
N10   * ADPAGE         1          COLHDG('PAGE(ÅPNE FRA)')
N10   *
N10  c                   eval      ARTYPE=ADARTY                                Arkivkode Hand.Fakt
N10  C                   eval      FraMappe=ADARKM                              Arkivmappe
N10  C                   eval      TilMappe=ADIFTM                              TilMappe AS/400-navn
N10  C                   eval      PCMappe =ADNETV                              TilM,PCnavn (Z:\...)
N10  C                   eval      PCTemp  =ADPCTM                              PCTempmappe,userHome
N10  C                   eval      AdobePath=ADPATH                             Path til Acr Reader
N10  c                   eval      TilPage = ADPAGE                             Åpne fra side...
      *
     C                   ENDSR
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C                   Z-ADD     0             UAVD2             4 0
     C                   Z-ADD     0             UOPD2             7 0
     C                   MOVEL     'KL:'         ARUNDE           10
     C                   MOVE      KABNR         ARUNDE
     C                   CALL      'ARC003'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
S18  C*                  PARM                    URUNDE
N18  C                   PARM                    ARUNDE
     C                   ENDSR
     C*
N10  c********************************************************
N10  C     VISPDFBROWSER BEGSR
N10   ***********************************************
N10   *
N10  C     ArkZHKey      Klist
N10  c                   kfld                    ARFIRM
N10  c                   kfld                    ARTYPE
N10  c                   kfld                    URUNDE
N10  c*
N10  c                   move      FIFIRM        ARFIRM
N10  c                   move      'ZK'          ARTYPE
N10  C                   MOVEL     'KL:'         URUNDE           10
N10  C                   MOVE      KABNR         URUNDE
N10   *
N10   * hent ip/bane mm..
N10  c     ArkZHkey      chain     ARKIVL06                           33
N16  c     *in33         ifeq      '1'
N16  c                   move      'ET'          ARTYPE
N16  c     ArkZHkey      chain     ARKIVL06                           33
N16  c                   end
N10  c  N33FIFIRM        chain     firmarc                            33
N10  c     *in33         cabeq     '1'           EndPDFbrowser
N25  c     arbhis        ifne      *blanks
N25  c                   eval      arcane=arbhis
N25  c                   end
N10  c     artype        chain     ARKTXT                             33
N10  C     ARKLAG        IFNE      *blanks
N10  c     arklagk       chain     arkext
N10  c                   endif
N10  c                   move      *blanks       Ubane
N10   * direkte - (trenger ikke bat-fil - åpner via html/javascript)
N10   * START PCO/PCCMD
N10  C                   eval      rc = docmd(' +
N10  C                             STRPCO  +
N10  C                             ')
N10   * >page= blir i estkopdf konvertert til #page=
N10  c                   eval      Ubane='http://'+%trim(ARCPAD)+'/sycgip/'
N10  c                             +'estkopdf.pgm?PDF=/'+%trim(ARCANE)
N10  c                             +'/'+%trim(ARLINK)+']page='+ADPAGE
N10  c                   select
N10  c     AdobePath     wheneq    'STDBROWSER'
N10  c                   eval      OPNIEBAT ='start '+%trim(Ubane)
N10  c     AdobePath     wheneq    'IE'
N10  c                   eval      OPNIEBAT ='start iexplore '+%trim(Ubane)
N10  c     AdobePath     wheneq    'CHROME'
N10  c                   eval      OPNIEBAT ='start chrome '+%trim(Ubane)
N10  c                   endsl
N10  C                   CALL      'SAD105CP'
N10  c                   parm                    OPNIEBAT
N10  C
N10  C     EndPDFbrowser ENDSR
N10  C*
     OKOSTARO   E            OPDST
     O                       KAST
     O                       KABNR2
     O                       KAUSER
     O                       KADTE
     O                       KATME
N05  O                       KABLST
     O          E            DLTKA
     O                       KAST
     O                       KATXT
     O                       KAUSER
     O                       KADTE
     O                       KATME
     O          E            BLAST
     O                       KAST
N17  O                       KABLST
N10  O          E            SETATT
N10  O                       KASG
N24  O          E            BLADUM
