********************************************************************
     H DECEDIT(',') debug(*yes)
     FFIRM      IF   E           K DISK
     FKOSBU12   IF   E           K DISK
     FKOSTB     UF   E           K DISK
     FKOSTA1    IF   E           K DISK
      *
     c                   exsr      init
      *
     c
      *
      * HOVEDLØKKE FOR LESING alle åpne kostnadsbilag
      *
     C                   setoff                                       33
     C     kostak        setll     kosta1
     c     *in33         doweq     '0'
     c     kostak        reade     kosta1                                 33
     c     *in33         ifeq      '0'
     c                   exsr      lesb
     C                   end
     C                   END
     c                   seton                                        lr
     c                   return
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     kostak        KLIST
     C                   KFLD                    kast
     C     kostbk        KLIST
     C                   KFLD                    kabnr
     C     KOSBUK        KLIST
     C                   KFLD                    KBAVD
     C                   KFLD                    KBOPD
     C                   read      firm                                   33
     C                   ENDSR
      *
      ***********************************************
     C     LESB          BEGSR
      ***********************************************
      * leser alle konteringslinjer
      *
     C                   setoff                                       36
     C     kostbk        setll     kostb
     c     *in36         doweq     '0'
     c     kostbk        reade     kostb                                  36
     c     *in36         ifeq      '0'
     c     kbavd         andne     *zeros
     c     kbopd         andne     *zeros
     c                   exsr      hentbud
     c                   z-add     nyttbu        kbbuds
     c                   update    kostbr
     C                   end
     C                   END
     c                   endsr
      ***********************************************
     C     hentbud       BEGSR
      ***********************************************
      * leser budsjettposter
      *
     c                   z-add     0             nyttbu           13 2
     C                   setoff                                       35
     C     kosbuk        setll     kosbu12
     c     *in35         doweq     '0'
     c     kosbuk        reade     kosbu12                                35
     c     *in35         ifeq      '0'
     c                   add       bubl          nyttbu
     C                   end
     C                   END
     C                   ENDSR
