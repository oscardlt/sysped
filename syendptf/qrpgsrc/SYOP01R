     H DFTACTGRP(*NO)
      ********************************************************
      *** PROGRAMMET VISER OVERSIKT OVER OPPDRAG MED DIV. VALG
      ********************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 kun en avd, kombinert med fri søkevei funket ikke
10XXX * 02 JOV PTF10 Utvidet logikk ved kall på TURADR
10XXX * 03 JOV PTF10 Filter på vekt og navn avs/mottaker / alle check(RB) fjrenet fysisk i dds
10XXX * 04 SH  PTF10 søke godsmerking
10XXX * 05 JOV PTF10 TURADR kan mottat Agent som innparam.. (0 ved kall herfra )
10XXX * 06 JOV PTF10 Protecte ekstra filer (F2/ind 32 er ON/OFF protect)    ra )
10XXX * 07 JOV PTF10 cursor ved TYPE / kundesøk
10XXX * 08 SH  PTF10 ny parameter sytt01
10XXX * 09 SH  PTF10 sendt fax byttet med sendt epost
10XXX * 10 SH  PTF10 opsjon 53 SEND EPOST FRA ORDRE
10XXX * 11 SH  PTF10 print fraktbrev opsjon 54
10XXX * 12 SH  PTF10 vise alle eposter til oppdrag
10XXX * 13 SH  PTF10 opsjon 22 gir ZH åpnet QFSU/QHF FLYTTET TIL MOVDTA2
10XXX * 14 SH  PTF10 endret til 132 bredt skjembilde
      *
      *-------------------------------------------------------------------
      *
11001 * 15 JOV PTF11 Opt 27 = tilgang til hente-system Inkl SMS til SmartPhone/TKeventGrabber
11001 * 16 SH  PTF11 Opt 60 = send epost av fraktbrev
10XXX * 17 SH  PTF11 ny parameter arc045
10XXX * 18 SH  PTF11 enda en ny parameter arc045
11XXX * 19 YBC PTF11 RETT FEIL I ENDRING 03
11XXX * 20 SH  PTF11 til eposter via cl-program
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
11XXX * 21 SH  PTF12 eventuelt history arkiv
11XXX * 22 JOV PTF12 opt 57 TKeventGrabber SMS
11XXX * 23 SH  PTF12 kan ikke endre ordre på inaktive avdelinger
11XXX * 24 SH  PTF12 google arkiv
********************************************************************
********************************************************************
      * inkluder div /copy ... for å kunne bruke funskjoner fra CGIDEV2 serviceprog
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *********************************************************************
N24  Ffirmgoog  IF   E           K DISK
N14  FSTED2D    IF   E           K DISK
N13  FADOBEF    IF   E           K DISK
N13  FARKTXT    IF   E           K DISK
N13  FARKEXT    IF   E           K DISK
N13  FarkIVL02  IF   E           K DISK
N13  FQ         O  A F  200        DISK    Usropn
N09  Farklogh4  IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FAVSLUTF   IF   E           K DISK
     FAVSLUTL2  IF   E           K DISK
     F                                     RENAME(AVSLUTFR:AVSLUT2)
s09  F*AXQLOG   IF   E           K DISK
     FTURER     IF   E           K DISK    INFDS(DSTURE)
     F                                     USROPN
     FFREETXT   IF   E           K DISK
     FHEADFOPD  UF   E           K DISK    INFDS(DSHEOP)
     F                                     USROPN
     FHEADF     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD0R)
s09  F*AXLOG03  IF   E           K DISK
     FFRISOL01  IF   E           K DISK    INFDS(DSFRIS)
     F                                     USROPN
     FHEAD2     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD2R)
     FHEAD3     IF   E           K DISK    INFDS(DSHE03)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD3R)
     FHEAD4     IF   E           K DISK    INFDS(DSHE04)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD4R)
     FHEAD5     IF   E           K DISK    INFDS(DSHE05)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD5R)
     FHEAD6     IF   E           K DISK    INFDS(DSHE06)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD6R)
     FHEAD7     IF   E           K DISK    INFDS(DSHE07)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD7R)
     FHEAD9     IF   E           K DISK    INFDS(DSHE09)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD9R)
     FHEAD10    IF   E           K DISK    INFDS(DSHE10)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD10R)
     FHEAD12    IF   E           K DISK    INFDS(DSHE12)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD12R)
     FHEAD13    IF   E           K DISK    INFDS(DSHE13)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD13R)
     FHEAD14    IF   E           K DISK    INFDS(DSHE14)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD14R)
     FHEAD15    IF   E           K DISK    INFDS(DSHE15)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD15R)
     FHEAD16    IF   E           K DISK    INFDS(DSHE16)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD16R)
     FHEAD17    IF   E           K DISK    INFDS(DSHE17)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD17R)
     FHEAD18    IF   E           K DISK    INFDS(DSHE18)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD18R)
     FHEAD19    IF   E           K DISK    INFDS(DSHE19)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD19R)
     FHEAD23    IF   E           K DISK    INFDS(DSHE23)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD23R)
     FHEAD24    IF   E           K DISK    INFDS(DSHE24)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD24R)
     FHEAD25    IF   E           K DISK    INFDS(DSHE25)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD25R)
     FHEAD26    IF   E           K DISK    INFDS(DSHE26)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD26R)
     FHEAD27    IF   E           K DISK    INFDS(DSHE27)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD27R)
     FHEAD28    IF   E           K DISK    INFDS(DSHE28)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD28R)
     FHEAD29    IF   E           K DISK    INFDS(DSHE29)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD29R)
     FHEAD30    IF   E           K DISK    INFDS(DSHE30)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD30R)
     FHEAD31    IF   E           K DISK    INFDS(DSHE31)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD31R)
     FHEAD32    IF   E           K DISK    INFDS(DSHE32)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD32R)
     FHEAD34    IF   E           K DISK    INFDS(DSHE34)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD34R)
     FHEADDT    IF   E           K DISK    INFDS(DSHEDT)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEADDTR)
     FHEAD22    IF   E           K DISK    INFDS(DSHE22)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD22R)
N04  FHEAD41    IF   E           K DISK    INFDS(DSHE41)
N04  F                                     USROPN
N04  F                                     RENAME(HEADFR:HEAD41R)
N04  FHEAD42    IF   E           K DISK    INFDS(DSHE42)
N04  F                                     USROPN
N04  F                                     RENAME(HEADFR:HEAD42R)
     FFAIN      IF   E           K DISK    INFDS(DSFAIN)
     F                                     USROPN
     FFAI2      IF   E           K DISK    INFDS(DSFAI2)
     F                                     USROPN
     F                                     RENAME(FAINR:FAI2R)
     FKODTA     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FDISP      IF   E           K DISK
     FLOCL01    IF   E           K DISK    USROPN
     FISUL02    IF   E           K DISK    USROPN
     FFIRM      IF   E             DISK
     FFAK3      IF   E           K DISK
     FFAK8      IF   E           K DISK
     F                                     RENAME(faktr:faktr8)
     FCUNDL01   IF   E           K DISK
     FHUBOL01   IF   E           K DISK
     FFERDL01   IF   E           K DISK
     FSAML1     IF   E           K DISK
N03  FSYPARL1   IF   E           K DISK
     FSYOP01D   CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *
N13  D BatDta          s            200
N13  D FraFil          s            200
N13  D TilFil          s            200
N13  D FraMappe        s            200
N13  D TilMappe        s            200
N13  D PCMappe         s            200
N13  D PCTemp          s            200
N13  D VBZ             s            200
N13  D VBC             s            200
N13  D STRVBC          s            200
N13  D CPY             s            200
N13  D OPNIEBAT        s            512
N13  D Ubane           s            512
N13  D TilPage         s              1
N13  D AdobePath       s            200
N13  D OldFile         s            200
N13  D PDFfil          s            200
N13  D Tstcmd          s            200
N13  D W2EXMax         s             15
N13  D W2GNMax         s             15
N13  D W2MoVar         s             15    VARYING
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D DSTURE          DS
     D  OPTURE                 9      9
     D DSFRIS          DS
     D  OPFRIS                 9      9
     D DSHEOP          DS
     D  OPHEOP                 9      9
     D DSHE03          DS
     D  OPHE03                 9      9
     D DSHE04          DS
     D  OPHE04                 9      9
     D DSHE05          DS
     D  OPHE05                 9      9
     D DSHE06          DS
     D  OPHE06                 9      9
     D DSHE07          DS
     D  OPHE07                 9      9
     D DSHE09          DS
     D  OPHE09                 9      9
     D DSHE10          DS
     D  OPHE10                 9      9
     D DSHE12          DS
     D  OPHE12                 9      9
     D DSHE13          DS
     D  OPHE13                 9      9
     D DSHE14          DS
     D  OPHE14                 9      9
     D DSHE15          DS
     D  OPHE15                 9      9
     D DSHE16          DS
     D  OPHE16                 9      9
     D DSHE17          DS
     D  OPHE17                 9      9
     D DSHE18          DS
     D  OPHE18                 9      9
     D DSHE19          DS
     D  OPHE19                 9      9
     D DSHE23          DS
     D  OPHE23                 9      9
     D DSHE24          DS
     D  OPHE24                 9      9
     D DSHE25          DS
     D  OPHE25                 9      9
     D DSHE26          DS
     D  OPHE26                 9      9
     D DSHE27          DS
     D  OPHE27                 9      9
     D DSHE28          DS
     D  OPHE28                 9      9
     D DSHE29          DS
     D  OPHE29                 9      9
     D DSHE30          DS
     D  OPHE30                 9      9
     D DSHE31          DS
     D  OPHE31                 9      9
     D DSHE32          DS
     D  OPHE32                 9      9
     D DSHE34          DS
     D  OPHE34                 9      9
     D DSHEDT          DS
     D  OPHEDT                 9      9
     D DSHE22          DS
     D  OPHE22                 9      9
N04  D DSHE41          DS
N04  D  OPHE41                 9      9
N04  D DSHE42          DS
N04  D  OPHE42                 9      9
     D DSFAIN          DS
     D  OPFAIN                 9      9
     D DSFAI2          DS
     D  OPFAI2                 9      9
     D                 DS
     D  WSUTL1                 1      2
     D  WSUTL2                 3      4
     D  WSUTL3                 5      6
     D  WSUTL4                 7      8
     D  WSUTL5                 9     10
     D  UTLFBH                 1     10
     D  UB                     1     10
     D                                     DIM(5)
     D                 DS
     D  FIAVD                  1      4  0
     D  HEAVD                  1      4  0
     D                 DS
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  WSDTOD                 1      2  0
     D  WSDTOM                 3      4  0
     D  WSDTOÅ                 5      6  0
     D  WSDTOP                 1      6  0
     D                 DS
     D  WSDT1D                 1      2  0
     D  WSDT1M                 3      4  0
     D  WSDT1Å                 5      6  0
     D  WSDT1W                 1      6  0
     D                 DS
     D  XDT1Å                  1      4  0
     D  XDT1M                  5      6  0
     D  XDT1D                  7      8  0
     D  XSGDT                  1      8  0
     D                 DS
     D  WSDT2D                 1      2  0
     D  WSDT2M                 3      4  0
     D  WSDT2Å                 5      6  0
     D  WSDT2W                 1      6  0
     D                 DS
     D  XDT2Å                  1      4  0
     D  XDT2M                  5      6  0
     D  XDT2D                  7      8  0
     D  XKNDT                  1      8  0
     D                 DS
     D  WSDT4D                 1      2  0
     D  WSDT4M                 3      4  0
     D  WSDT4Å                 5      6  0
     D  WSDT4W                 1      6  0
     D                 DS
     D  XDT4Å                  1      4  0
     D  XDT4M                  5      6  0
     D  XDT4D                  7      8  0
     D  XOTDT                  1      8  0
     D                 DS
     D  WSDT5D                 1      2  0
     D  WSDT5M                 3      4  0
     D  WSDT5Å                 5      6  0
     D  WSDT5W                 1      6  0
     D                 DS
     D  XDT5Å                  1      4  0
     D  XDT5M                  5      6  0
     D  XDT5D                  7      8  0
     D  XHADT                  1      8  0
     D                 DS
     D  WSDT6D                 1      2  0
     D  WSDT6M                 3      4  0
     D  WSDT6Å                 5      6  0
     D  WSDT6W                 1      6  0
     D                 DS
     D  XDT6Å                  1      4  0
     D  XDT6M                  5      6  0
     D  XDT6D                  7      8  0
     D  XCODT                  1      8  0
     D                 DS
     D  WSDT7D                 1      2  0
     D  WSDT7M                 3      4  0
     D  WSDT7Å                 5      6  0
     D  WSDT7W                 1      6  0
     D                 DS
     D  XDT7Å                  1      4  0
     D  XDT7M                  5      6  0
     D  XDT7D                  7      8  0
     D  XFRTID                 1      8  0
     D                 DS
     D  WSDT9D                 1      2  0
     D  WSDT9M                 3      4  0
     D  WSDT9Å                 5      6  0
     D  WSDT9W                 1      6  0
     D                 DS
     D  XDT9Å                  1      4  0
     D  XDT9M                  5      6  0
     D  XDT9D                  7      8  0
     D  XDTDTD                 1      8  0
     D                 DS
     D  WSDT8D                 1      2  0
     D  WSDT8M                 3      4  0
     D  WSDT8Å                 5      6  0
     D  WSDT8W                 1      6  0
     D                 DS
     D  XDT8Å                  1      4  0
     D  XDT8M                  5      6  0
     D  XDT8D                  7      8  0
     D  XFRIDT                 1      8  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAÅ                 5      6  0
     D  WSDTAW                 1      6  0
     D                 DS
     D  XDTAÅ                  1      4  0
     D  XDTAM                  5      6  0
     D  XDTAD                  7      8  0
     D  XRFADT                 1      8  0
     D                 DS
     D  HEHAWB                 1      9
     D  HEHAW6                 4      9
     D                 DS
     D  HEPOS1                 1      7
     D  WSPOS1                 1      4
     D                 DS
     D  HEGN                   1     15
     D  HEGN2                 12     15
     D  HEGN3                  5      7
     D  HEGN4                  8     15
     D                 DS
     D  HEALT                  1     15
     D  HEALT1                 1      3
     D  HEALT2                 4     11
     D                 DS
     D  WSRFA                  1     15
     D  WSRFA35                1     35
     D                 DS
     D  WSGN                   1     15
     D  WSGNA                  1      4
     D  WSGNB                  5     15
     D                 DS
     D  DSTID                  1     14  0
     D  DSCENT                11     14  0
     D                 DS
     D  FSSOK                  1     35
     D  FSSNDN                 3     17
     D  FSSNDX                17     17
      * PARAMETERSTRENG FOR KALL PÅ SYKS12
     D                 DS
     D  P1DS                   1    256
     D  P1FLAG                 1      1
     D  P1BNR                  2      8  0
     D  P1AVD                  9     12  0
     D  P1TUNR                13     20  0
     D  P1OAVD                21     24  0
     D  P1OPD                 25     31  0
     D  P1BL                  32     44  2
      *____________________________________________________________
      * Definisjon av parameterlisten som brukes ved kall av SM220R
      * (automatisk booking via linje). TdV IS må være installert
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
      * AUTTRM = '1' ---> automatisk sending uten å se ekstra bildet
      * AUTTRM = annet ---> visning av ekstra bildet med opplysninger
      * OBS. Finnes det syntax feil vises ekstra bildet uansett
     D  AUTTRM                 1      1
     D  AUTPID                 2     18
     D  AUTALN                19     21
     D  AUTAWB                22     29
     D  AUTINF                 1     29
     D                 DS           115
     D QTXT2           C                   CONST(' * ADVARSEL * FAKTUR-
     D                                     ABEREGNING ER IKKE A-
     D                                     KTIV I DELSYSTEM SY4-
     D                                     00SBS. Be dataansvar-
     D                                     lig om å starte fakt-
     D                                     uraberegning !')
N03   * For xlate mellom Upper Case og Lower Case
N03  D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
N03  D                                     UVWXYZÆØÅ')
N03  D LC              C                   CONST('abcdefghijklmnopqrst-
N03  D                                     uvwxyzæøå')
N03  D HenMot          s             12    VARYING
      *___________________
      * DS for System Data
      *"""""""""""""""""""
S13  D*               SDS
N13  D                 DS
     D  WJOB                 244    253
     D  WUSER                254    263
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
      *
     C                   EXSR      INIT
     C     USTAC1        IFEQ      'OP'
     C                   GOTO      BG21
     C                   END
      *
     C     BG2           TAG
     C   41              MOVE      *ZEROS        WSOPD
     C                   EXSR      KDTFM1
     C                   TIME                    DSTID            14 0
     C                   MOVE      DSCENT        WSGNA
     C                   EXFMT     BILDE02
     C                   EXSR      KDTFM1
     C                   MOVEA     '000'         *IN(97)
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '0'           *IN(58)
     C                   MOVEA     '0'           *IN(39)
N04  C                   MOVEA     '0'           *IN(67)
      *
N06  C     *in02         IFEQ      '1'
N06  C     *IN32         IFEQ      '1'
N06  C                   MOVE      '0'           *IN32
N06  C                   ELSE
N06  C                   MOVE      '1'           *IN32
N06  C                   END
N06  C                   GOTO      BG2
N06  C                   END
      *
     C   03              GOTO      SLUTT
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
      *
      * TEST DEPARTMENT IF CHANGED
      *
     C     WSAVD         IFNE      *ZEROS
     C     WSAVD         ANDNE     WSAVDO
     C                   EXSR      BYAVD
     C   30              MOVE      'SPA0001'     MSGNR
     C   30              GOTO      BG2
     C                   END
     C   04              DO
     C     LINNBR        IFEQ      12
     C                   EXSR      SØKKUN
     C                   Z-ADD     53            POSNBR
     C                   GOTO      BG2
     C                   ELSE
     C                   EXSR      SØKDTA
     C                   GOTO      BG2
     C                   END
     C                   END
     C     *IN20         IFEQ      '1'
     C     *IN21         OREQ      '1'
     C                   EXSR      SFSR
     C                   GOTO      BG2
     C                   ENDIF
     C     *IN22         IFEQ      '1'
     C                   EXSR      SRLOGG
     C                   GOTO      BG2
     C                   ENDIF
     C     *IN23         IFEQ      '1'
     C                   EXSR      SFVR
     C                   GOTO      BG2
     C                   ENDIF
     C   24              DO
     C                   EXSR      CMDFT1
     C                   GOTO      BG2
     C                   END
      *
     C     BG21          TAG
     C                   EXSR      TESTB2
     C   30              GOTO      BG2
     C   43WSDT1W        IFEQ      999999
     C     UTLFBH        CABNE     *BLANKS       BG2
     C                   END
      *
     C                   MOVE      *ZEROS        XMSG12
     C                   MOVE      *ZEROS        XMSG13
     C                   EXSR      CMDFT2
     C                   EXSR      OPSJON
     C     START         TAG
     C                   MOVE      '1'           *IN(93)
     C                   EXSR      KDTFM1
     C                   WRITE     SUBCTL
     C                   EXSR      KDTFM1
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        WSNR
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
N03  c                   move      *zeros        LestRec           9 0
     C                   EXSR      LESREC
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        8
     C                   ADD       1             ZRECNO
     C                   EXSR      MOVDTA
     C     TRFA11        COMP      *BLANKS                            8989
     C  N89TRFA21        COMP      *BLANKS                            8989
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     ST21          TAG
     C                   EXSR      LESREC
     C  N94              END
     C                   END
     C  N94              MOVE      HEAVD         XAVDGM            4 0
     C  N94              MOVE      HEOPD         XOPDGM            7 0
      *
     C     START3        TAG
     C  N30              Z-ADD     6             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     UUR           IFEQ      'C'
     C                   MOVE      *ON           *IN63
     C                   ELSE
     C                   MOVE      *OFF          *IN63
     C                   ENDIF
     C     UUR           IFEQ      'A'
     C                   MOVE      *ON           *IN64
     C                   ELSE
     C                   MOVE      *OFF          *IN64
     C                   ENDIF
     C     UUR           IFEQ      'B'
     C                   MOVE      *ON           *IN65
     C                   ELSE
     C                   MOVE      *OFF          *IN65
     C                   ENDIF
     C     UUR           IFEQ      'D'
     C                   MOVE      *ON           *IN66
     C                   ELSE
     C                   MOVE      *OFF          *IN66
     C                   ENDIF
     C     MSGNR         IFEQ      'JOV0278'
     C                   MOVE      '1'           *IN30
     C                   ENDIF
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXSR      KDTFM1
     C                   EXFMT     SUBCTL
     C                   EXSR      KDTFM1
     C                   END
      *
      *   AVSLUTT
      *
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C                   MOVEA     '00'          *IN(95)
      *
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTOP1
     C                   GOTO      START3
     C                   END
     C   08              DO
     C                   MOVE      *ZEROS        XMSG11
     C                   EXSR      CMDFT2
     C                   Z-ADD     GMLIN         LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      BG2
     C                   END
     C   10              DO
     C                   EXSR      CHGTUR
     C                   GOTO      START
     C                   END
     C   11              DO
     C                   EXSR      UTLFB
     C                   GOTO      START
     C                   END
     C   14
     COR 15              DO
     C                   EXSR      BYTTMD
     C                   GOTO      START3
     C                   END
     C   16              DO
     C                   EXSR      CRTOP2
     C                   GOTO      START
     C                   END
      *
      * F20 - PLUKK FRA INNGÅENDE EDI..
     C   20              DO
     C     UUR           IFEQ      'A'
     C     UUR           OREQ      'B'
     C     UUR           OREQ      'C'
     C     UUR           OREQ      'D'
     C                   EXSR      PLUKOM
     C                   GOTO      START
     C                   END
     C                   END
      * PLUKK FRA TDVS-AWB
     C   21              DO
     C     UUR           IFEQ      'C'
     C                   EXSR      PLUAWB
     C     PFLAGG        IFEQ      'N'
     C                   GOTO      START3
     C                   END
     C                   MOVE      *ON           *IN90
     C                   EXSR      CHGOPD
     C                   GOTO      START3
     C                   END
     C                   END
     C     *IN22         IFEQ      '1'
     C     UUR           ANDEQ     'B'
     C                   EXSR      HURTIG
     C                   GOTO      START3
     C                   ENDIF
     C   23              DO
     C                   EXSR      OPSJON
     C                   GOTO      START3
     C                   END
     C   24              DO
     C                   EXSR      CMDFT2
     C                   GOTO      START3
     C                   END
      *
      *   BLA VIDERE
      *
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C  N94OPHEOP        IFNE      '1'
     C                   OPEN      HEADFOPD
     C                   END
     C  N94HEGMLK        CHAIN(N)  HEADFOPD                           25
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     WSAVDA        IFNE      UAVD
     C     WSSGA         ORNE      USG
     C                   EXSR      TESTB0
     C   30              GOTO      START3
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2OPD         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2PRO         ORNE      0
     C     W2RFA         ORNE      *BLANKS
     C     W2FN          ORNE      0
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          COMP      1                                      06
     C  N06W2NR          COMP      11                                     16
     C   06
     COR 16              DO                                                       3<-B
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAVDA
     C                   MOVE      W2AVD         WSAVDO
     C                   MOVE      W2AVD         UAVD
     C                   MOVE      W2AVD         XAVD
     C                   MOVE      W2AVD         WSAVD
     C                   END                                                       4<-E
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2OPD         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0039'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYOPT
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTOP
     C                   MOVE      *ZEROS        W2PRO
     C                   MOVE      *BLANKS       W2RFA
     C                   MOVE      *ZEROS        W2FN
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C     W2AVD         IFNE      0                                             2<-B
     C                   MOVE      W2AVD         WSAVD
     C                   MOVE      W2AVD         XAVD
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HHENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SELECT
     C     USTAC3        WHENEQ    'OP'
     C                   MOVE      USTAC2        UTILMD
     C                   MOVE      *BLANKS       USTAC3
     C     USTAC2        WHENEQ    'OP'
     C                   MOVE      USTAC1        UTILMD
     C                   MOVE      *BLANKS       USTAC2
     C                   ENDSL
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     BYTTMD        BEGSR
      ***********************************************
     C     STBMD         TAG
      * TIL B/L
     C   14              DO                                                     1<-B
     C                   MOVE      'BL'          UTILMD
     C                   SELECT                                                  2<-B
     C     USTAC1        WHENEQ    'BL'
     C                   MOVE      *BLANKS       USTAC3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'BL'
     C                   MOVE      *BLANKS       USTAC3
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'OP'
     C                   MOVE      'BL'          USTAC3
     C                   CALL      'SYSJ80R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'OP'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C                   END                                                      3<-E
     C                   OTHER
     C                   MOVE      'BL'          USTAC2
     C                   CALL      'SYSJ80R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'OP'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      '0'           *IN14
     C                   MOVE      '1'           *IN15
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      * TIL BOOKING
     C   15              DO                                                     1<-B
     C                   MOVE      'BK'          UTILMD
     C                   SELECT                                                  2<-B
     C     USTAC1        WHENEQ    'BK'
     C                   MOVE      *BLANKS       USTAC3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'BK'
     C                   MOVE      *BLANKS       USTAC3
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'OP'
     C                   MOVE      'BK'          USTAC3
     C                   CALL      'SYSJ81R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'OP'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C                   END                                                      3<-E
     C                   OTHER
     C                   MOVE      'BK'          USTAC2
     C                   CALL      'SYSJ81R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'OP'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      '1'           *IN14
     C                   MOVE      '0'           *IN15
     C                   GOTO      STBMD
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
     C     SLBMD         ENDSR
      *
      ***********************************************
     C     MOVDTA        BEGSR
      ***********************************************
     C     HEUR          IFEQ      'H'
     C     FREETK        CHAIN     DISP                               33
     C                   MOVE      DISTEF        HESDF
     C                   MOVE      DISTET        HESDT
     C                   MOVE      DIDATF        HEDTOP
     C                   END
     C                   EXSR      KDTFM2
     C     HESGM         COMP      *BLANKS                            2727
     C* N51              MOVE      HERFA         HEALT
     C  N51              MOVEL     HERFA         HEALT
     C   51              MOVE      *BLANKS       HEALT
     C   51              MOVEL     HEHAWB        HEALT
     C   52              MOVEL     HETRCN        HEALT
     C   53FSKODE        IFEQ      'IFB'
     C     FSSNDX        ANDNE     ' '
     C                   MOVEL     FSSNDN        HEALT
     C                   ELSE
     C                   MOVEL     FSSOK         HEALT
     C                   END
     C   56              MOVEL     HESAML        HEALT
     C     HEUR          IFEQ      'D'
     C                   MOVE      HESAML        HEALT
     C                   END
N04  C   67              MOVEL     HEGM1         HEALT
N13  c                   exsr      movdta2
     C     FREETK        CHAIN     FERDL01                            33
     C  N33              MOVE      'K'           HEST
     C     *IN33         IFEQ      '1'
     C     FREETK        CHAIN     SAML1                              33
     C  N33              MOVE      'C'           HEST
     C                   END
     C     HENT          IFGT      99999
     C                   MOVE      '99999'       WSNT
     C                   ELSE
     C                   MOVE      HENT          WSNT
     C                   END
     C     HEVKT         IFGT      9999999
     C                   MOVE      '9999999'     WSVKT
     C                   ELSE
     C                   MOVE      HEVKT         WSVKT
     C                   END
     C     HEM3          IFGT      99.99
     C                   MOVE      '9999'        WSM3
     C                   ELSE
     C                   Z-ADD(H)  HEM3          WSM3
     C                   END
     C     HELM          IFGT      99.99
     C                   MOVE      '9999'        WSLM
     C                   ELSE
     C                   Z-ADD     HELM          WSLM
     C                   END
      *
     C  N94              EXSR      MOVWS2
      *
     C                   ENDSR
N13   ***********************************************
N13  C     MOVDTA2       BEGSR
N13   ***********************************************
n13  C                   MOVE      ' '           QFSU
n13  C     FREETK        CHAIN     arklogh4                           33
n13  C  N33              MOVE      'E'           QFSU
n13  C                   MOVE      ' '           QHF
N13  c     ArkZHkey      chain     ARKIVL02                           33
n13  C  N33              MOVE      'H'           QHF
n13  C                   ENDSR
      *
      ***********************************************
     C     SØKKUN        BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       USØKNV           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKN
     C                   PARM                    UFIRM
     C                   PARM                    USØKNV           30
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB0        BEGSR
      ***********************************************
     C     KODAKA        CHAIN     KODTA                              96
     C     *IN96         IFEQ      '1'
     C                   MOVE      'SPA0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   END
     C     KODSKA        CHAIN     KODTSF                             95
     C     *IN95         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   MOVE      'SPS0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   END
      *
     C     *IN30         IFEQ      '0'
     C                   MOVE      WSAVDA        UAVD
     C                   MOVE      WSSGA         USG
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB2        BEGSR
      ***********************************************
     C     WSAVD         COMP      *ZEROS                                 40
      *
     C     WSFN          COMP      *ZEROS                             4141
     C   41              GOTO      STTB22
     C     WSOPD         COMP      *ZEROS                             4242
     C   42              GOTO      STTB22
     C     WSSG          COMP      *BLANKS                            4343
     C   43              GOTO      STTB21
     C     WSGNB         COMP      *BLANKS                            4444
     C   44              GOTO      STTB22
      *
      * kundnummer tester
      *
     C     WSKN          IFNE      0
     C     WSTYPE        COMP      'A '                                   50
     C   50              GOTO      STTB21
     C     WSTYPE        COMP      'KF'                                   46
     C   46              GOTO      STTB21
     C     WSTYPE        COMP      'SF'                                   45
     C   45              GOTO      STTB21
     C     WSTYPE        COMP      'K '                                   55
     C   55              GOTO      STTB21
     C     WSTYPE        COMP      'S '                                   54
     C   54              GOTO      STTB21
     C                   SETON                                        3097
s07  C*                  Z-ADD     13            LINNBR
s07  C*                  Z-ADD     30            POSNBR
N07  C                   Z-ADD     12            LINNBR
N07  C                   Z-ADD     43            POSNBR
     C                   MOVE      'SPT0048'     MSGNR
     C                   GOTO      SLTB2
     C                   END
      *
      * kundenummer slutt
      *
     C     WSDT9W        COMP      *zeros                             3939
     C   39              GOTO      STTB21
N04  C     WSGM1         COMP      *BLANKS                            6767
N04  C   67              GOTO      STTB22
     C     WSOT          COMP      *BLANKS                            4747
     C   47              GOTO      STTB21
     C     WSRFA         COMP      *BLANKS                            4848
     C   48              GOTO      STTB21
     C     WSPRO         COMP      *ZEROS                             4949
     C   49              GOTO      STTB22
     C     WSHAWB        COMP      *BLANKS                            5151
     C   51              GOTO      STTB21
     C     WSCONT        COMP      *BLANKS                            5252
     C   52              GOTO      STTB21
     C     WSFRI1        COMP      *BLANKS                            5353
     C   53              GOTO      STTB21
     C     WSSAML        COMP      *BLANKS                            5656
     C   56              GOTO      STTB22
     C     WSSDF         COMP      *BLANKS                            5858
     C   58              GOTO      STTB21
      *
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'DIV0064'     MSGNR
     C                   GOTO      SLTB2
      *
     C     STTB21        TAG
     C                   EXSR      FLYTDT
      *
     C     STTB22        TAG
     C                   Z-ADD     WSGNÅR        WSGNÅ4            4 0
     C     WSGNÅR        IFNE      0
     C                   MOVE      WSGNÅR        WSGNÅ4
     C     WSGNÅR        IFGT      50
     C                   ADD       1900          WSGNÅ4
     C                   ELSE
     C                   ADD       2000          WSGNÅ4
     C                   END
     C                   END
     C   41              MOVE      WSFN          XFN1              6 0
     C   41              Z-ADD     8             GMLIN             3 0
     C   42              Z-ADD     9             GMLIN
     C   43              Z-ADD     10            GMLIN
     C   44              Z-ADD     11            GMLIN
     C   45
     COR 46
     COR 50
     COR 54
     COR 55              Z-ADD     12            GMLIN
N04  C   67              Z-ADD     13            GMLIN
     C   47              Z-ADD     14            GMLIN
     C   48              Z-ADD     15            GMLIN
     C   49              Z-ADD     16            GMLIN
     C   51              Z-ADD     17            GMLIN
     C   52              Z-ADD     18            GMLIN
     C   53              Z-ADD     20            GMLIN
     C   40              Z-ADD     1             XAVD
     C   40              Z-ADD     9999          XAVD2
     C  N40              MOVE      WSAVD         XAVD
     C  N40              MOVE      WSAVD         XAVD2
      *
     C     SLTB2         ENDSR
      *
      ***********************************************
     C     NYSØK         BEGSR
      ***********************************************
     C                   MOVE      WSAVD         XAVD3             4 0
     C                   CLEAR                   BILDE02
     C                   TIME                    DSTID            14 0
     C                   MOVE      DSCENT        WSGNA
     C                   MOVE      XAVD3         WSAVD
     C     W2AVD         IFEQ      0
     C     WSAVD         IFEQ      0
     C                   MOVE      UAVD          WSAVD
     C                   END
     C                   ELSE
     C                   MOVE      W2AVD         WSAVD
     C                   END
     C     W2OPD         IFNE      0                                            1<-B
     C                   MOVE      W2OPD         WSOPD
     C                   ELSE                                                   1
     C     W2SG          IFNE      *BLANKS                                       2<-B
     C                   MOVE      W2SG          WSSG
     C                   MOVE      W2DTOP        WSDT1W
     C                   ELSE                                                    2
     C     W2PRO         IFNE      0                                              3<-B
     C                   MOVE      W2PRO         WSPRO
     C                   ELSE                                                     3
     C     W2RFA         IFNE      *BLANKS                                         4<-B
     C                   MOVE      W2RFA         WSRFA
     C                   ELSE                                                      4
     C                   MOVE      W2FN          WSFN
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTOP
     C                   MOVE      *ZEROS        W2PRO
     C                   MOVE      *BLANKS       W2RFA
     C                   MOVE      *ZEROS        W2FN
      *
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   EXSR      TESTB2
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYOPT         BEGSR
      ***********************************************
N13  C                   MOVE      'N'           opt22             1
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          W2AVD
     C                   END
     C     WRK2K         CHAIN     HEADF                              98
     C   98              DO
     C                   MOVE      'SPO0001'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   MOVE      '1'           *IN90
      *
N13  C     W2NR          IFEQ      22
N13  C                   MOVE      'J'           opt22             1
N13  C                   exsr      vispdfstr
N13  c                   z-add     2             w2nr
N13  C                   end
     C                   SELECT
     C     W2NR          WHENEQ    2
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'C'
     C     HEST          ANDNE     'U'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'K'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLOPT
     C                   ELSE
     C     HEADOK        CHAIN     AVSLUTF                            33
     C   33HEPRO         IFNE      *ZEROS
     C     HEPRO         CHAIN     AVSLUTL2                           33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      'SHU0579'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDIF                                                   E2
     C                   END
     C                   EXSR      CHGOPD
     C     W2NR          WHENEQ    3
     C                   EXSR      CPYOPD
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPOPD
     C     W2NR          WHENEQ    6
     C                   EXSR      DSPTUR
     C     W2NR          WHENEQ    7
     C                   EXSR      WRKFV
     C     W2NR          WHENEQ    8
     C                   EXSR      WRKFT
     C     W2NR          WHENEQ    9
s09  C*                  EXSR      DSPFAX
n09  C                   EXSR      DSPEPO
     C     W2NR          WHENEQ    12
     C     HEST          IFEQ      'S'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLOPT
     C                   ELSE
     C     HEADOK        CHAIN     AVSLUTF                            33
     C   33HEPRO         IFNE      *ZEROS
     C     HEPRO         CHAIN     AVSLUTL2                           33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      'SHU0579'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDIF                                                   E2
     C                   END
     C                   EXSR      CHGFAK
     C     W2NR          WHENEQ    13
     C                   EXSR      WRKSAD
     C     W2NR          WHENEQ    14
     C                   EXSR      WRKMRK
     C     W2NR          WHENEQ    17
     C                   EXSR      DSPISO
     C     W2NR          WHENEQ    19
     C                   EXSR      MANIFSR
     C     W2NR          WHENEQ    21
     C                   EXSR      BUDSR
     C     W2NR          WHENEQ    25
     C                   EXSR      WRKTT
     C     W2NR          WHENEQ    26
     C                   EXSR      WRKTTT
N15  C     W2NR          WHENEQ    27
N15  C                   EXSR      WRKHEN
     C     W2NR          WHENEQ    29
     C                   EXSR      DSPTVI
     C     W2NR          WHENEQ    50
     C                   EXSR      DOKUME
     C     W2NR          WHENEQ    51
     C                   EXSR      ARKIVS
     C     W2NR          WHENEQ    52
     C                   EXSR      PRTSKILL
N10  C     W2NR          WHENEQ    53
N10  C                   EXSR      SENDEP
N16  C     W2NR          WHENEQ    60
N16  C                   EXSR      SENDEPF
N11  C     W2NR          WHENEQ    54
N11  C                   EXSR      FRAKTBR
     C     W2NR          WHENEQ    55
     C                   EXSR      DSPWEB
     C     W2NR          WHENEQ    56
      * 56 = SENDE E-POST BRUKER SOM LAGET WEB-OPPDRAG
     C                   EXSR      SNDEPW
N22  C     W2NR          WHENEQ    57                                           sms -TKeventGrabber
N22  C                   EXSR      TKEVENT
     C                   OTHER
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDSL
      *
     C     SLOPT         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2OPD
      *
     C                   ENDSR
      *
      ***********************************************
     C     HHENT         BEGSR
      ***********************************************
N13  C                   MOVE      'N'           opt22             1
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              MOVE      '0'           *IN98
     C                   MOVE      '0'           *IN99
     C                   GOTO      SLHENT
     C                   END
      *
     C     ZRECNO        DIV       8             LINNBR
     C                   MVR                     XLIN              1 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     21            LINNBR
     C                   ELSE
     C     XLIN          MULT      2             LINNBR
     C                   ADD       5             LINNBR
     C                   END
N13  C     WSNR          IFEQ      22
N13  C     QHF           ANDEQ     'H'
N13  C                   MOVE      'J'           opt22             1
N13  C                   exsr      vispdfstr
N13  c                   z-add     2             wsnr
N13  C                   end
      *
     C                   SELECT
      * Endre
     C     WSNR          WHENEQ    2
      * Endre, sikre at status er "fersk"
     C     OPHEOP        IFNE      '1'
     C                   OPEN      HEADFOPD
     C                   END
     C     HEADOK        CHAIN(N)  HEADFOPD                           33
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'C'
     C     HEST          ANDNE     'U'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'K'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   ELSE
     C     HEADOK        CHAIN     AVSLUTF                            33
     C   33HEPRO         IFNE      *ZEROS
     C     HEPRO         CHAIN     AVSLUTL2                           33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      'SHU0579'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   ENDIF                                                   E2
     C                   END
N23  C     *IN98         IFEQ      '0'
N23  C     KODTAK        CHAIN     KODTA                              98
N23  C   98              MOVE      'SHU1845'     MSGNR
N23  c                   end
     C   98              EXSR      UPDSBF
     C   98              GOTO      SLHENT
     C                   EXSR      CHGOPD
      * Kopi
     C     WSNR          WHENEQ    3
     C                   EXSR      CPYOPD
     C     WSNR          WHENEQ    5
     C                   EXSR      DSPOPD
     C     WSNR          WHENEQ    6
     C                   EXSR      DSPTUR
     C     WSNR          WHENEQ    7
     C                   EXSR      WRKFV
     C     WSNR          WHENEQ    8
     C                   EXSR      WRKFT
     C     WSNR          WHENEQ    9
s09  C*                  EXSR      DSPFAX
n09  C                   EXSR      DSPEPO
     C     WSNR          WHENEQ    10
     C     FITDVI        IFEQ      'J'
     C     HEUR          IFEQ      'D'
     C     HEUR          OREQ      'E'
     C     HEUR          OREQ      'C'
     C                   EXSR      WRKTDV
     C                   ELSE
     C                   MOVE      '1'           *IN98
     C                   MOVE      'BBA0114'     MSGNR
     C                   ENDIF
     C                   ELSE
     C                   MOVE      '1'           *IN98
     C                   MOVE      'BBA0035'     MSGNR
     C                   ENDIF
     C                   EXSR      UPDSBF
     C                   GOTO      SLHENT
      *
     C     WSNR          WHENEQ    12
     C     HEST          IFEQ      'S'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   ELSE
     C     HEADOK        CHAIN     AVSLUTF                            33
     C   33HEPRO         IFNE      *ZEROS
     C     HEPRO         CHAIN     AVSLUTL2                           33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      'SHU0579'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   ENDIF                                                   E2
     C                   END
     C   98              EXSR      UPDSBF
     C   98              GOTO      SLHENT
     C                   EXSR      CHGFAK
     C     WSNR          WHENEQ    13
     C                   EXSR      WRKSAD
     C     WSNR          WHENEQ    14
     C                   EXSR      WRKMRK
     C     WSNR          WHENEQ    17
     C                   EXSR      DSPISO
     C     WSNR          WHENEQ    19
     C                   EXSR      MANIFSR
     C     WSNR          WHENEQ    21
     C                   EXSR      BUDSR
     C     WSNR          WHENEQ    25
     C                   EXSR      WRKTT
     C     WSNR          WHENEQ    26
     C                   EXSR      WRKTTT
N15  C     WSNR          WHENEQ    27
N15  C                   EXSR      WRKHEN
     C     WSNR          WHENEQ    29
     C                   EXSR      DSPTVI
     C     WSNR          WHENEQ    33
     C                   EXSR      INTEDI
     C     WSNR          WHENEQ    41
     C                   EXSR      TDVLOG
     C     WSNR          WHENEQ    50
     C                   EXSR      DOKUME
     C     WSNR          WHENEQ    51
     C                   EXSR      ARKIVS
     C     WSNR          WHENEQ    52
     C                   EXSR      PRTSKILL
N10  C     WSNR          WHENEQ    53
N10  C                   EXSR      SENDEP
N16  C     WSNR          WHENEQ    60
N16  C                   EXSR      SENDEPF
N10  C     WSNR          WHENEQ    54
N10  C                   EXSR      FRAKTBR
     C     WSNR          WHENEQ    55
     C                   EXSR      DSPWEB
     C     WSNR          WHENEQ    56
      * 56 = SENDE E-POST BRUKER SOM LAGET WEB-OPPDRAG
     C                   EXSR      SNDEPW
N22  C     WSNR          WHENEQ    57                                           sms -TKeventGrabber
N22  C                   EXSR      TKEVENT
     C                   OTHER
     C                   MOVE      '1'           *IN98
     C                   EXSR      UPDSBF
     C                   GOTO      SLHENT
     C                   ENDSL
     C                   MOVE      '1'           *IN99
      *
     C                   END
      *
     C     SLHENT        TAG
     C   98MSGNR         IFEQ      *BLANKS
     C                   MOVE      'DIV0012'     MSGNR
     C                   END
     C   98              MOVE      '1'           *IN30
     C  N30              Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     FLYTDT        BEGSR
      ***********************************************
     C   43              DO
     C                   SELECT
     C     WSDT1W        WHENEQ    0
     C                   MOVE      *ZEROS        XSGDT
     C     WSDT1W        WHENEQ    999999
     C                   MOVE      '99999999'    XSGDT
     C                   OTHER
     C                   MOVE      WSDT1D        XDT1D
     C                   MOVE      WSDT1M        XDT1M
     C     WSDT1Å        IFGT      50
     C     WSDT1Å        ADD       1900          XDT1Å
     C                   ELSE
     C     WSDT1Å        ADD       2000          XDT1Å
     C                   END
     C                   ENDSL
     C                   END
     C   45
     COR 46
     COR 50
     COR 54
     COR 55              DO
     C     WSDT2W        IFEQ      0
     C                   MOVE      *ZEROS        XKNDT
     C                   ELSE
     C                   MOVE      WSDT2D        XDT2D
     C                   MOVE      WSDT2M        XDT2M
     C     WSDT2Å        IFGT      50
     C     WSDT2Å        ADD       1900          XDT2Å
     C                   ELSE
     C     WSDT2Å        ADD       2000          XDT2Å
     C                   END
     C                   END
     C                   END
     C   47              DO
     C     WSDT4W        IFEQ      0
     C                   MOVE      *ZEROS        XOTDT
     C                   ELSE
     C                   MOVE      WSDT4D        XDT4D
     C                   MOVE      WSDT4M        XDT4M
     C     WSDT4Å        IFGT      50
     C     WSDT4Å        ADD       1900          XDT4Å
     C                   ELSE
     C     WSDT4Å        ADD       2000          XDT4Å
     C                   END
     C                   END
     C                   END
      *
     C   51              DO
     C     WSDT5W        IFEQ      0
     C                   MOVE      *ZEROS        XHADT
     C                   ELSE
     C                   MOVE      WSDT5D        XDT5D
     C                   MOVE      WSDT5M        XDT5M
     C     WSDT5Å        IFGT      50
     C     WSDT5Å        ADD       1900          XDT5Å
     C                   ELSE
     C     WSDT5Å        ADD       2000          XDT5Å
     C                   END
     C                   END
     C                   END
     C   52              DO
     C     WSDT6W        IFEQ      0
     C                   MOVE      *ZEROS        XCODT
     C                   ELSE
     C                   MOVE      WSDT6D        XDT6D
     C                   MOVE      WSDT6M        XDT6M
     C     WSDT6Å        IFGT      50
     C     WSDT6Å        ADD       1900          XDT6Å
     C                   ELSE
     C     WSDT6Å        ADD       2000          XDT6Å
     C                   END
     C                   END
     C                   END
     C   58              DO
     C     WSDT7W        IFEQ      0
     C                   MOVE      *ZEROS        XFRTID
     C                   ELSE
     C                   MOVE      WSDT7D        XDT7D
     C                   MOVE      WSDT7M        XDT7M
     C     WSDT7Å        IFGT      50
     C     WSDT7Å        ADD       1900          XDT7Å
     C                   ELSE
     C     WSDT7Å        ADD       2000          XDT7Å
     C                   END
     C                   END
     C                   END
     C*
     C   39              DO
     C     WSDT9W        IFEQ      0
     C                   MOVE      *ZEROS        XDTDTD
     C                   ELSE
     C                   MOVE      WSDT9D        XDT9D
     C                   MOVE      WSDT9M        XDT9M
     C     WSDT9Å        IFGT      50
     C     WSDT9Å        ADD       1900          XDT9Å
     C                   ELSE
     C     WSDT9Å        ADD       2000          XDT9Å
     C                   END
     C                   END
     C                   END
     C*
     C   48              DO
     C     WSDTAW        IFEQ      0
     C                   MOVE      *ZEROS        XRFADT
     C                   ELSE
     C                   MOVE      '1'           *IN40
     C                   MOVE      WSDTAD        XDTAD
     C                   MOVE      WSDTAM        XDTAM
     C     WSDTAÅ        IFGT      50
     C     WSDTAÅ        ADD       1900          XDTAÅ
     C                   ELSE
     C     WSDTAÅ        ADD       2000          XDTAÅ
     C                   END
     C                   END
     C                   END
      *
     C*
     C   53              DO
     C     WSDT8W        IFEQ      0
     C                   MOVE      *ZEROS        XFRIDT
     C                   ELSE
     C                   MOVE      WSDT8D        XDT8D
     C                   MOVE      WSDT8M        XDT8M
     C     WSDT8Å        IFGT      50
     C     WSDT8Å        ADD       1900          XDT8Å
     C                   ELSE
     C     WSDT8Å        ADD       2000          XDT8Å
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
      *
      ***********************************************
     C     SETKEY        BEGSR
      ***********************************************
     C                   EXSR      OPENF
     C   41
     CANN40FAI2K         SETLL     FAI2
     C   41
     CAN 40WSFN          SETLL     FAIN
     C   42
     CANN40HEADFK        SETLL     HEADF
     C   42
     CAN 40WSOPD         SETLL     HEAD23
     C   43WSDT1W        IFEQ      999999
     C     WSAVD         ANDNE     0
     C     HEAD2K        SETGT     HEAD2
     C                   ELSE
     C  N40HEAD2K        SETLL     HEAD2
     C   40HEA24K        SETLL     HEAD24
     C                   END
     C   44
     CANN40HEAD3K        SETLL     HEAD3
     C   44
     CAN 40WSGN          SETLL     HEAD18
     C   45
     CANN40HKNKEY        SETLL     HEAD4
     C   45
     CAN 40HKNK2         SETLL     HEAD27
     C   46
     CANN40HKNKEY        SETLL     HEAD5
     C   46
     CAN 40HKNK2         SETLL     HEAD28
     C   47
     CANN40HEAD6K        SETLL     HEAD6
     C   47
     CAN 40HEA30K        SETLL     HEAD30
     C   48
     CANN40HEAD7K        SETLL     HEAD7
     C   48
     CAN 40HEAD17K       SETLL     HEAD17
     C   49
     CANN40HEAD9K        SETLL     HEAD9
     C   49
     CAN 40HEA14K        SETLL     HEAD14
     C   50
     CANN40HKNKEY        SETLL     HEAD10
     C   50
     CAN 40HKNK2         SETLL     HEAD29
     C   51
     CANN40HEA12K        SETLL     HEAD12
     C   51
     CAN 40HEA31K        SETLL     HEAD31
     C   52
     CANN40HEA13K        SETLL     HEAD13
     C   52
     CAN 40HEA32K        SETLL     HEAD32
     C   53FRIS1K        SETLL     FRISOL01
     C   54
     CANN40HKNKEY        SETLL     HEAD15
     C   54
     CAN 40HKNK2         SETLL     HEAD25
     C   55
     CANN40HKNKEY        SETLL     HEAD16
     C   55
     CAN 40HKNK2         SETLL     HEAD26
     C   56WSSAML        SETLL     HEAD19
      *
     C   58HEA34K        SETLL     HEAD34
     C   40
     CAN 39HEADTK        SETLL     HEADDT
     C  N40
     CAN 39HEA22K        SETLL     HEAD22
N04  C  N40
N04  CAN 67HEA41K        SETLL     HEAD41
N04  C   40
N04  CAN 67HEA42K        SETLL     HEAD42
     C                   ENDSR
      *
      ***********************************************
     C     OPENF         BEGSR
      ***********************************************
     C   41
     CAN 40OPFAIN        IFNE      '1'
     C                   OPEN      FAIN
     C                   END
     C   41
     CANN40OPFAI2        IFNE      '1'
     C                   OPEN      FAI2
     C                   END
     C   42
     CAN 40OPHE23        IFNE      '1'
     C                   OPEN      HEAD23
     C                   END
     C   43
     CAN 40OPHE24        IFNE      '1'
     C                   OPEN      HEAD24
     C                   END
     C   44
     CANN40OPHE03        IFNE      '1'
     C                   OPEN      HEAD3
     C                   END
     C   44
     CAN 40OPHE18        IFNE      '1'
     C                   OPEN      HEAD18
     C                   END
     C*  45      OPHE04    IFNE '1'
     C   45
     CANN40OPHE04        IFNE      '1'
     C                   OPEN      HEAD4
     C                   END
     C   45
     CAN 40OPHE27        IFNE      '1'
     C                   OPEN      HEAD27
     C                   END
     C   46
     CANN40OPHE05        IFNE      '1'
     C                   OPEN      HEAD5
     C                   END
     C   46
     CAN 40OPHE28        IFNE      '1'
     C                   OPEN      HEAD28
     C                   END
     C   47
     CANN40OPHE06        IFNE      '1'
     C                   OPEN      HEAD6
     C                   END
     C   47
     CAN 40OPHE30        IFNE      '1'
     C                   OPEN      HEAD30
     C                   END
     C   48
     CANN40OPHE07        IFNE      '1'
     C                   OPEN      HEAD7
     C                   END
     C   48
     CAN 40OPHE17        IFNE      '1'
     C                   OPEN      HEAD17
     C                   END
     C   49
     CANN40OPHE09        IFNE      '1'
     C                   OPEN      HEAD9
     C                   END
     C   49
     CAN 40OPHE14        IFNE      '1'
     C                   OPEN      HEAD14
     C                   END
     C   50
     CANN40OPHE10        IFNE      '1'
     C                   OPEN      HEAD10
     C                   END
     C   50
     CAN 40OPHE29        IFNE      '1'
     C                   OPEN      HEAD29
     C                   END
     C   51
     CANN40OPHE12        IFNE      '1'
     C                   OPEN      HEAD12
     C                   END
     C   51
     CAN 40OPHE31        IFNE      '1'
     C                   OPEN      HEAD31
     C                   END
     C   52
     CANN40OPHE13        IFNE      '1'
     C                   OPEN      HEAD13
     C                   END
     C   52
     CAN 40OPHE32        IFNE      '1'
     C                   OPEN      HEAD32
     C                   END
     C   58OPHE34        IFNE      '1'
     C                   OPEN      HEAD34
     C                   END
     C   40
     CAN 39OPHEDT        IFNE      '1'
     C                   OPEN      HEADDT
     C                   END
     C  N40
     CAN 39OPHE22        IFNE      '1'
     C                   OPEN      HEAD22
     C                   END
N04  C   67
N04  CANN40OPHE41        IFNE      '1'
N04  C                   OPEN      HEAD41
N04  C                   END
N04  C   67
N04  CAN 40OPHE42        IFNE      '1'
N04  C                   OPEN      HEAD42
     C                   END
     C   53OPFRIS        IFNE      '1'
     C                   OPEN      FRISOL01
     C                   END
     C   54
     CANN40OPHE15        IFNE      '1'
     C                   OPEN      HEAD15
     C                   END
     C   54
     CAN 40OPHE25        IFNE      '1'
     C                   OPEN      HEAD25
     C                   END
     C   55OPHE16        IFNE      '1'
     C                   OPEN      HEAD16
     C                   END
     C   55
     CAN 40OPHE26        IFNE      '1'
     C                   OPEN      HEAD26
     C                   END
     C   56OPHE19        IFNE      '1'
     C                   OPEN      HEAD19
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     LESREC        BEGSR
      ***********************************************
     C     STLF          TAG
N03  C     MAXLES        ifne      *zeros
N03  C     LestRec       andgt     Maxles
N03  c                   move      *on           *in94
N03  c                   move      *on           *in30
N03  C                   MOVE      'JOV1524'     MSGNR
N03  c                   goto      UtLes
N03  C                   endif
      *
     C   41
     CANN40              READ      FAI2                                   94
     C   41
     CAN 40              READ      FAIN                                   94
     C   42
     CANN40              READ      HEADF                                  94
     C   42
     CAN 40              READ      HEAD23                                 94
     C   43WSDT1W        IFEQ      999999
     C     WSAVD         ANDNE     0
     C                   READP     HEAD2                                  94
     C                   ELSE
     C  N40              READ      HEAD2                                  94
     C   40WSSG          READE     HEAD24                                 94
     C                   END
     C   44
     CANN40              READ      HEAD3                                  94
     C   44
     CAN 40              READ      HEAD18                                 94
     C   45
     CANN40              READ      HEAD4                                  94
     C   45
     CAN 40WSKN          READE     HEAD27                                 94
     C   46
     CANN40              READ      HEAD5                                  94
     C   46
     CAN 40WSKN          READE     HEAD28                                 94
     C   47
     CANN40              READ      HEAD6                                  94
     C   47
     CAN 40WSOT          READE     HEAD30                                 94
     C   48
     CANN40              READ      HEAD7                                  94
     C   48
     CAN 40              READ      HEAD17                                 94
     C   49
     CANN40              READ      HEAD9                                  94
     C   49
     CAN 40WSPRO         READE     HEAD14                                 94
     C   50
     CANN40              READ      HEAD10                                 94
     C   50
     CAN 40WSKN          READE     HEAD29                                 94
     C   51
     CANN40              READ      HEAD12                                 94
     C   51
     CAN 40              READ      HEAD31                                 94
     C   52
     CANN40              READ      HEAD13                                 94
     C   52
     CAN 40              READ      HEAD32                                 94
     C   53WSFRI1        READE     FRISOL01                               94
     C   54
     CANN40              READ      HEAD15                                 94
     C   54
     CAN 40WSKN          READE     HEAD25                                 94
     C   55
     CANN40              READ      HEAD16                                 94
     C   55
     CAN 40WSKN          READE     HEAD26                                 94
     C   56              READ      HEAD19                                 94
     C   58he34k2        reade     head34                                 94
     C   40
     CAN 39              read      headDT                                 94
     C  N40
     CAN 39XAVD          reade     head22                                 94
N04  C  N40
N04  CAN 67XAVD          reade     head41                                 94
N04  C   40
N04  CAN 67              read      head42                                 94
      *
N03  c                   add       1             LestRec
      * TEST MOT ÅR VED GODSNR ER UAVH. AV 40/N40...
     C   44
     CANN94WSGNÅR        IFNE      0
     C     WSGNÅ4        ANDNE     HEDTÅ
     C                   GOTO      STLF
     C                   END
      *
      * SPESIELL AVDELING ER VALGT
      *
     C  N40
     CANN94              DO
     C  N53HEAVD         COMP      WSAVD                              9494
      * må lese videre ved fra til sted hvis avdeling er feil
     C  N53
     CAN 58
     CAN 94              goto      stlf
n01  c     *in53         ifeq      '1'
n01  c     FSavd         andne     WSAVD
n01  C                   goto      stlf
n01  c                   end
     C   43
     CANN94HESG          COMP      WSSG                               9494
     C   45
     CANN94HEKNSF        COMP      WSKN                               9494
     C   46
     CANN94HEKNKF        COMP      WSKN                               9494
     C   47
     CANN94HEOT          COMP      WSOT                               9494
     C   49
     CANN94HEPRO         COMP      WSPRO                              9494
     C   50
     CANN94HEKNA         COMP      WSKN                               9494
     C   54
     CANN94HEKNS         COMP      WSKN                               9494
     C   55
     CANN94HEKNK         COMP      WSKN                               9494
      * HEAD19=SAMLASTNR HAR IKKE AVD. VIS KUN EXAKT MATCH I RETT AVD.
     C   56
     CANN94HESAML        COMP      WSSAML                             9494
     C   56
     CANN94WSAVD         IFNE      HEAVD
     C                   GOTO      STLF
     C                   ENDIF
      *
     C                   END                                                    end  do(kun en avd)
      *
      * SØK ALLE AVDELINGER
      *
N03   * Navn i Hente / leverings adresse..
S19  C*    WSHNAV        Ifne      *blanks
N19  C  N94WSHNAV        Ifne      *blanks
N03  C     WSLNAV        orne      *blanks
N03  c                   exsr      TstHenLev
N03  c     HLExclude     cabeq     'Y'           STLF
N03  c                   end
N03   **  TEST MOT VEKT OVER / UNDER  (FRA OG MED/TIL OG MED)
N03  C     WSVKTO        IFNE      *ZEROS
N03  C     HEVKT         ANDLT     WSVKTO
N03  C                   GOTO      STLF
N03  C                   END
N03  C     WSVKTU        IFNE      *ZEROS
N03  C     HEVKT         ANDGT     WSVKTU
N03  C                   GOTO      STLF
N03  C                   END
      *
     C   53
     CANN94FRIKEY        CHAIN     HEADF                              59
     C   53
     CANN94
     CAN 59              GOTO      STLF
     C   41
     CANN94              DO
     C   41              MOVE      FIOPD         WSOPD
     C     HEADFF        CHAIN     HEADF                              59
     C   59              GOTO      STLF
     C     FAK8KE        chain     fak8                               59
     C   59              GOTO      STLF
     c  N59              do
     c     fakda         ifeq      'K'
     c     wskost        ifne      'X'
     c                   goto      stlf
     c                   end
     c                   else
     c     wskost        ifeq      'X'
     c                   goto      stlf
     c                   end
     c                   end
     c                   end
     C                   END
      *
     C  N94              IF        *IN48
     C     HEUR          IFEQ      'H'
     C     FREETK        CHAIN     DISP                               33
     C                   MOVE      DIDATF        HEDTOP
     C                   END
     C     XRFADT        CABGT     HEDTOP        STLF
     C                   END
     C   51
     CANN94XHADT         CABGT     HEDTR         STLF
     C   52
     CANN94XCODT         CABGT     HEDTR         STLF
     C  N94              IF        *IN53
     C     HEUR          IFEQ      'H'
     C     FREETK        CHAIN     DISP                               33
     C                   MOVE      DIDATF        HEDTOP
     C                   END
     C     XFRIDT        CABGT     HEDTOP        STLF
     C                   END
      *
     C  N94UTLFBH        IFNE      *BLANKS
     C     HEKF          IFNE      *BLANKS
     C     HEKFT1        ANDEQ     *BLANKS
     C     1             DO        5             XN                1 0
     C     UB(XN)        IFNE      *BLANKS
     C     UB(XN)        CABEQ     '*A'          SLUTB
     C     UB(XN)        CABEQ     HEKF          SLUTB
     C                   END
     C                   END
     C                   GOTO      STLF
     C     SLUTB         TAG
     C                   ELSE
     C                   GOTO      STLF
     C                   END
     C                   END
      *
     C     FREETK        SETLL     FREETXT
     C                   SETOFF                                       2988
     C     FREETK        READE     FREETXT                                29
     C  N29              SETON                                            88
      *
n14  C                   move      *blanks       hesdft
n14  C                   move      *blanks       hesdtt
n14  c                   move      helka         tillan
n14  c                   move      filand        fralan
n14  c     heur          ifeq      'A'
n14  c     heur          oreq      'C'
n14  c     heur          oreq      'F'
n14  c                   move      helka         fralan
n14  c                   move      filand        tillan
n14  c                   end
n14  C     WSSDFK        CHAIN     STED2D                             33
n14  C  N33              movel     st2nvn        hesdft
n14  C     WSSDTK        CHAIN     STED2D                             33
n14  C  N33              movel     st2nvn        hesdtt
      *
N03  c     UtLes         tag
     C                   ENDSR
      *
N03
N03  C***********************************************
N03  C     TstHenLev     BEGSR
N03  C***********************************************
N03  c                   MOVE      'Y'           HLExclude         1
N03   * TEST Hentenavn utfylt - ikke match hopp ut (med Y i HLExclude )
N03  c     WSHnav        Ifne      *blanks
N03  C     ' '           CHECKR(E) WSHNAV        NUX               2 0
N03  C                   EVAL      %len(HenMot)= NUX
N03  C     NUX           SUBST     WSHNAV:1      HenMot
N03  C     LC:UC         XLATE     HENAS         TSTSCAN30        30
N03  C     HenMot        SCAN      TSTSCAN30                              33
N03  c     *IN33         CaBEQ     *OFF          UtTstHL
N03  C                   end
N03   * TEST Lev.navn utfylt - ikke match hopp ut (med Y i HLExclude )
N03  c     WSLnav        Ifne      *blanks
N03  C     ' '           CHECKR(E) WSLNAV        NUX               2 0
N03  C                   EVAL      %len(HenMot)= NUX
N03  C     NUX           SUBST     WSLNAV:1      HenMot
N03  C     LC:UC         XLATE     HENAK         TSTSCAN30
N03  C     HenMot        SCAN      TSTSCAN30                              33
N03  c     *IN33         CaBEQ     *OFF          UtTstHL
N03  C                   end
N03   * Overlevde begge tester - skal IKKE ekskluderes
N03  c                   MOVE      'N'           HLExclude
N03  C     UtTstHL       ENDSR
      ***********************************************
     C     MOVWS2        BEGSR
      ***********************************************
     C                   MOVE      HEAVD         XAVD
     C                   MOVEL     HENAS         WSSELG
     C                   MOVEL     HENAK         WSKJØP
      * SPØRT PÅ FAKT.NR SOM IKKE ER SIST UTFØRTE PÅ HVERKEN K/S-SIDE
      * VIS DET PÅ K.SIDA
     C                   MOVE      FIFN          XFNFM
     C                   MOVE      'O'           FAOPKO
     C     FAKT3K        SETLL     FAK3                               33
     C     FAKT3K        READE     FAK3                                   33
     C     *IN33         IFEQ      '1'                                           2<-B
     C                   MOVE      'T'           FAOPKO
     C     FAKT3K        SETLL     FAK3                               33
     C     FAKT3K        READE     FAK3                                   33
     C     *IN33         IFEQ      '1'                                            3<-B
     C                   MOVE      'F'           FAOPKO
     C     FAKT3K        SETLL     FAK3                               33
     C     FAKT3K        READE     FAK3                                   33
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C     XFNFM         IFEQ      0                                             2<-B
     C                   MOVE      '1'           *IN33
     C                   MOVE      *ZEROS        FAKUNR
     C                   ELSE                                                    2
     C                   MOVE      '0'           *IN33
     C                   END                                                     2<-E
      *
     C  N33CUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         XNAFM
     C   33              MOVE      *BLANKS       XNAFM
     C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
     C     HEGN2         IFNE      *BLANKS
     C                   MOVE      HEGN          HEGN11
     C                   ELSE
     C                   MOVEL     HEGN          HEGN11
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     CMDFT1        BEGSR
      ***********************************************
     C                   SELECT
     C     XMSG11        WHENEQ    0
     C                   ADD       1             XMSG11            1 0
     C                   MOVE      'DIV0020'     MSGF11
     C                   MOVE      'DIV0032'     MSGF12
     C                   MOVE      'BBA0038'     MSGF13
     C     XMSG11        WHENEQ    1
     C                   Z-ADD     0             XMSG11
     C                   MOVE      'BBA0039'     MSGF11
     C                   MOVE      'BBA0040'     MSGF12
     C                   MOVE      'BBA0046'     MSGF13
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     CMDFT2        BEGSR
      ***********************************************
     C                   SELECT
     C     XMSG13        WHENEQ    0
     C                   ADD       1             XMSG13            1 0
     C                   MOVE      'DIV0020'     MSGF31
     C                   MOVE      'DIV0021'     MSGF32
     C                   MOVE      'DIV0022'     MSGF33
      *
     C     XMSG13        WHENEQ    1
     C     UUR           IFNE      'A'
     C     UUR           ANDNE     'B'
     C     UUR           ANDNE     'C'
     C     *IN35         ANDEQ     '0'
     C                   Z-ADD     0             XMSG13
     C                   ELSE
     C                   ADD       1             XMSG13
     C                   ENDIF
     C                   MOVE      'DIV0023'     MSGF31
     C                   MOVE      'YBC0034'     MSGF32
     C                   MOVE      'YBC0033'     MSGF33
      *
     C     XMSG13        WHENEQ    2
     C                   Z-ADD     0             XMSG13
     C                   MOVE      'DIV0000'     MSGF32
     C     UUR           IFEQ      'A'
     C                   MOVE      'YBC0059'     MSGF31
     C                   MOVE      'BBA0128'     MSGF32
     C                   ELSE
     C     UUR           IFEQ      'B'
     C                   MOVE      'BBA0128'     MSGF31
     C                   MOVE      'CBA0160'     MSGF32
     C                   ELSE
     C     UUR           IFEQ      'C'
     C                   MOVE      'BBA0128'     MSGF31                          F20=IMP EDI
     C                   MOVE      'JOV1194'     MSGF32                          F21=IMP AWB
     C                   ELSE
     C     UUR           IFEQ      'D'
     C                   MOVE      'BBA0128'     MSGF31                          F20=IMP EDI
     C                   ELSE
     C                   MOVE      'CBA0160'     MSGF31
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C     *IN35         IFEQ      '1'
     C                   MOVE      'YBC0724'     MSGF31
     C                   MOVE      'YBC0732'     MSGF32
     C                   MOVE      'DIV0000'     MSGF33
     C                   ELSE
     C  N49              MOVE      'DIV0000'     MSGF33
     C   49              MOVE      'YBC0565'     MSGF33
     C                   ENDIF
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPSJON        BEGSR
      ***********************************************
     C                   SELECT
     C     XMSG12        WHENEQ    0
     C                   ADD       1             XMSG12            1 0
     C                   MOVE      'YBC0031'     MSGF21
     C     XMSG12        WHENEQ    1
     C                   ADD       1             XMSG12
     C                   MOVE      'YBC0032'     MSGF21
     C     XMSG12        WHENEQ    2
     C                   ADD       1             XMSG12
     C                   MOVE      'YBC0042'     MSGF21
     C     XMSG12        WHENEQ    3
     C                   ADD       1             XMSG12
     C                   MOVE      'SHU0819'     MSGF21
     C     XMSG12        WHENEQ    4
     C                   ADD       1             XMSG12
     C                   MOVE      'YBC0637'     MSGF21
     C     XMSG12        WHENEQ    5
     C                   ADD       1             XMSG12
     C                   MOVE      'CBA0330'     MSGF21
     C     XMSG12        WHENEQ    6
s11  C*                  Z-ADD     0             XMSG12
n11  c                   add       1             XMSG12
     C                   MOVE      'JOV1357'     MSGF21
n11  C     XMSG12        WHENEQ    7
n11  C                   Z-ADD     0             XMSG12
     C                   MOVE      'SHU1392'     MSGF21
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SFSR          BEGSR
      ***********************************************
     C                   OPEN      LOCL01                               91
     C  N91              OPEN      ISUL02                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFSR99
     C                   ENDIF
      * Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       AUTINF
     C     *IN20         IFEQ      '1'                                          <AUTOMATISK
     C                   MOVE      '1'           AUTTRM
     C                   ELSE                                                   <MED BILDE
     C                   MOVE      ' '           AUTTRM
     C                   ENDIF
     C  N99
     CAN 99WWUSER        CHAIN     LOCL01                             90
     C                   MOVE      WAIRLI        AUTALN                         <AIRLINE
     C                   MOVE      WAWBNO        AUTAWB                         <AWB
     C                   MOVE      *BLANKS       AUTPID                         <ADRESSE
     C     WAIRCD        IFNE      *BLANKS
     C     WAIRCD        CHAIN     ISUL02                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     ISPART        AUTPID
     C                   ELSE
     C                   MOVE      ' '           AUTTRM
     C                   ENDIF
     C                   ENDIF
      * Programmet venter på svar i et vist antall sekunder.
      * Kommer ikke svaret fortsetter pgm.
     C                   CALL      'SM200C2'
     C                   PARM                    AUTINF
      *
      *
     C     SFSR99        TAG
     C                   CLOSE     LOCL01                               91
     C                   CLOSE     ISUL02                               91
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRLOGG        BEGSR
      ***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      XXLOGG
     C                   ENDIF
      * Kaller på logg program
     C                   CALL      'SM040C'
      *
     C     XXLOGG        TAG
     C                   CLOSE     LOCL01                               91
     C                   ENDSR
      *
      ***********************************************
     C     SFVR          BEGSR
      ***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFVR99
     C                   ENDIF
      * Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       CUTINF           29
      * Programmet venter på svar i et vist antall sekunder.
      * Kommer ikke svaret fortsetter pgm.
     C                   CALL      'SM250C2'
     C                   PARM                    CUTINF
      *
     C     SFVR99        TAG
     C                   CLOSE     LOCL01                               91
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
n14  C     WSSDFK        KLIST
n14  C                   KFLD                    fralan            2
n14  C                   KFLD                    HESDF
n14  C     WSSDTK        KLIST
n14  C                   KFLD                    tillan            2
n14  C                   KFLD                    HESDT
      *
s09  C*    LOGKEY        KLIST
s09  C*                  KFLD                    LOJONR
s09  C*                  KFLD                    FASTKO            2
s09  C*                  MOVE      '00'          FASTKO
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADOK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEGMLK        KLIST
     C                   KFLD                    XAVDGM
     C                   KFLD                    XOPDGM
     C     HEADFK        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOPD
     C     HEDKNY        KLIST
     C                   KFLD                    UAVD2
     C                   KFLD                    UOPD2
     C     FRIKEY        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     HEADFF        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     FAK8KE        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C                   KFLD                    FIFN
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2OPD
     C     HEAD2K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XSGDT
     C     HEA24K        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    XSGDT
     C     HEAD3K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSGN
     C     HKNKEY        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSKN
     C                   KFLD                    XKNDT
     C     HKNK2         KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    XKNDT
     C     HEAD6K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOT
     C                   KFLD                    XOTDT
     C     HEA30K        KLIST
     C                   KFLD                    WSOT
     C                   KFLD                    XOTDT
     C     HEAD7K        KLIST
     C                   KFLD                    XAVD
     C*                  KFLD                    WSRFA
     C                   KFLD                    WSRFA35
     C     HEAD9K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSPRO
     C                   KFLD                    XKNA
     C     HEA14K        KLIST
     C                   KFLD                    WSPRO
     C                   KFLD                    XKNA
     C     HEA12K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSHAWB
     C                   KFLD                    XHADT
     C     HEAD17K       KLIST
     C*                  KFLD                    WSRFA
     C                   KFLD                    WSRFA35
     C                   KFLD                    XRFADT
     C     HEA31K        KLIST
     C                   KFLD                    WSHAWB
     C                   KFLD                    XHADT
     C     HEA13K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSCONT
     C                   KFLD                    XCODT
     C     HEA32K        KLIST
     C                   KFLD                    WSCONT
     C                   KFLD                    XCODT
     C     HEA34K        KLIST
     C                   KFLD                    WSSDF
     C                   KFLD                    WSSDT
     C                   KFLD                    XFRTID
     C     HE34K2        KLIST
     C                   KFLD                    WSSDF
     C                   KFLD                    WSSDT
     C     HEADTK        KLIST
     C                   KFLD                    XDTDTD
     C     HEA22K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XDTDTD
N04  C     HEA41K        KLIST
N04  C                   KFLD                    XAVD
N04  C                   KFLD                    WSGM1
N04  C     HEA42K        KLIST
N04  C                   KFLD                    WSGM1
     C     FRIS1K        KLIST
     C                   KFLD                    WSFRI1
     C                   KFLD                    WSFRI2
     C                   KFLD                    XFRIDT
     C     FAI2K         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSFN
     C     KODTAK        KLIST
     C                   KFLD                    XKAUNI
     C                   KFLD                    WSAVD
     C     KODAKA        KLIST
     C                   KFLD                    XKAUNI
     C                   KFLD                    WSAVDA
     C     KODSKA        KLIST
     C                   KFLD                    XSFUNI
     C                   KFLD                    WSSGA
     C     FAKT3K        KLIST
     C                   KFLD                    FAOPKO
     C                   KFLD                    XFNFM
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    FAKUNR
N03  C     SYPARKEY      KLIST
N03  C                   KFLD                    SYKUNR
N03  C                   KFLD                    SYPAID
N13  C     ArkZHKey      Klist
N13  c                   kfld                    ARSTAT
N13  c                   kfld                    HEAVD
N13  c                   kfld                    HEOPD
N13  c                   kfld                    ARTYPE
N13   *
N13  C     arklagk       KLIST
N13  C                   KFLD                    UFIRM
N13  C                   KFLD                    arklag
N13  c                   move      'A'           ARSTAT
N13  c
      *
     C     *ENTRY        PLIST
     C                   PARM                    UUR               1
     C                   PARM                    USTAC1            2
     C                   PARM                    USTAC2            2
     C                   PARM                    USTAC3            2
     C                   PARM                    UTILMD            2
      *
N13  c                   eval      wuser=psdsusrnam
N13  c                   eval      wjob=psdsjobnam
     C     UUR           COMP      'A'                                    28
     C                   SELECT
     C     UUR           WHENEQ    'A'
     C                   MOVE      'YBC0067'     MSGHNR
     C     UUR           WHENEQ    'B'
     C                   MOVE      'YBC0068'     MSGHNR
     C     UUR           WHENEQ    'C'
     C                   MOVE      'YBC0069'     MSGHNR
     C     UUR           WHENEQ    'D'
     C                   MOVE      'YBC0070'     MSGHNR
     C     UUR           WHENEQ    'E'
     C                   MOVE      'YBC0071'     MSGHNR
     C     UUR           WHENEQ    'F'
     C                   MOVE      'YBC0072'     MSGHNR
     C                   MOVE      '1'           *IN35
     C     UUR           WHENEQ    'G'
     C                   MOVE      'YBC0073'     MSGHNR
     C                   MOVE      '1'           *IN35
     C                   ENDSL
     C                   MOVE      *ZEROS        XAVD              4 0
     C                   MOVE      *ZEROS        XSGDT
     C                   MOVE      *ZEROS        XKNDT
     C                   MOVE      *ZEROS        XOTDT
     C                   MOVE      *ZEROS        XHADT
     C                   MOVE      *ZEROS        XCODT
     C                   MOVE      *ZEROS        XFRTID
     C                   MOVE      *ZEROS        XDTDTD
     C                   MOVE      *ZEROS        XRFADT
     C                   MOVE      *ZEROS        XFRIDT
     C                   MOVE      *ZEROS        WSDT8W
     C                   MOVE      *ZEROS        XKNA              8 0
     C                   MOVE      '9999'        XAVD2             4 0
     C                   MOVE      9999999       XFN               6 0
     C                   MOVE      9999999       XOPD              7 0
     C                   MOVE      '999'         XSG               3
     C                   MOVEL     '99999999'    XGN              11
     C                   MOVE      '999'         XGN              11
     C                   MOVE      '99999999'    XKN               8 0
     C                   MOVE      '99'          XOT               2
     C                   MOVEL     '99999999'    XRFA             15
     C                   MOVE      '9999999'     XRFA             15
     C                   MOVE      '99999999'    XPRO              8 0
     C                   MOVE      'A'           XKAUNI            1
     C                   MOVE      'SF'          XSFUNI            2
     C                   MOVE      *ZEROS        HEAVD
     C                   MOVE      *ZEROS        WSDT1W
     C                   MOVE      *ZEROS        WSDT2W
     C                   MOVE      *ZEROS        WSDT4W
     C                   MOVE      *ZEROS        WSDT5W
     C                   MOVE      *ZEROS        WSDT6W
     C                   MOVE      *ZEROS        WSDT7W
     C                   MOVE      *ZEROS        WSDT9W
     C                   MOVE      *ZEROS        WSDTAW
     C                   MOVE      'CHG'         XTYPE             3
     C                   MOVE      'E'           XKODE             1
     C                   MOVE      *BLANKS       UTLFBH
      *
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UAVD          WSAVDA
     C                   EXSR      BYAVD
     C                   MOVE      USG           WSSG
     C                   MOVE      USG           WSSGA
     C                   MOVE      '999999'      WSDT1W
      *
     C                   MOVEL     WUSER         WWUSER           17
     C                   MOVE      *BLANK        PFLAGG            1
      *
     C                   READ      FIRM                                   90
     C                   READ      FIRMARC                                90
     C                   MOVE      'J'           ARKIV             1
      * maxrecords i leseloop (pga filetr i les..)
N03  C                   Move      *zeros        MAXLES
N03  C                   Move      *zeros        SYKUNR
N03  C                   move      'MXOFI'       SYPAID
N03  C     SyParKey      CHAIN     SYPARL1                            33
N03  c  N33              z-add     SYVRDN        MAXLES            9 0
N06   * Default = protect ekstra filer
N06  C                   MOVE      '1'           *IN32
      *
     C                   EXSR      CMDFT1
      * IS INVOICE CALCULATION ACTIVE IN SY400SBS ?
     C                   CALL      'SY400ACT'
     C                   PARM      'INVCALC'     WNAME            10
     C                   PARM                    WACT              1
      * NOT ACTIVE, SEND BREAK MESSAGE TO USER
     C     WACT          IFEQ      'N'
     C                   MOVE      X'7D'         WAPO              1
     C                   MOVEL(P)  'SNDBRKMS'    QCMDA           151
     C     QCMDA         CAT       'G MSG(':0    QCMDA
     C     QCMDA         CAT       WAPO:0        QCMDA
     C     QCMDA         CAT       QTXT2:0       QCMDA
     C     QCMDA         CAT       WAPO:0        QCMDA
     C     QCMDA         CAT       ') TOMS':0    QCMDA
     C     QCMDA         CAT       'GQ(':0       QCMDA
     C     QCMDA         CAT       WJOB:0        QCMDA
     C     QCMDA         CAT       ')':0         QCMDA
     C                   Z-ADD     151           QCMDL            15 5
     C                   CALL      'QCMDEXC'
     C                   PARM                    QCMDA
     C                   PARM                    QCMDL
     C                   ENDIF
      * IS THERE ANY RECORDS FOR USER IN "HURTIGBOOKING" ?
     C     UUR           IFEQ      'B'
     C     WUSER         CHAIN     HUBOL01                            90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     'JOV0278'     MSGNR
     C                   ENDIF
     C                   ENDIF
      *
N13   *
N13  c     WUSER         chain     ADOBEF                             33
N13  c   33'          '  chain     ADOBEF                             33
N13  C                   move      *blanks       opniebat        512
N13  C                   move      *blanks       adobepath       200
N13  C                   move      *blanks       ubane           512
N13  c                   eval      ARTYPE=ADARTY                                Arkivkode Hand.Fakt
N13  C                   eval      AdobePath=ADPATH                             Path til Acr Reader
N13  c                   eval      ARTYPE=ADARTY                                Arkivkode Hand.Fakt
N13  C                   eval      FraMappe=ADARKM                              Arkivmappe
N13  C                   eval      TilMappe=ADIFTM                              TilMappe AS/400-navn
N13  C                   eval      PCMappe =ADNETV                              TilM,PCnavn (Z:\...)
N13  C                   eval      PCTemp  =ADPCTM                              PCTempmappe,userHome
N13  C                   eval      AdobePath=ADPATH                             Path til Acr Reader
N13  c                   eval      TilPage = ADPAGE                             Åpne fra side...
N24  C* Benyttes google arkiv
N24  c     FIFIRM        chain     firmgoog
N24  C                   if        %found(FIRMGOOG) and GOBUID <> *blanks
N24  C                   move      'J'           GCarkivJN         1
N24  C                   endif
      *
     C                   ENDSR
      *
      ***********************************************
     C     KDTFM1        BEGSR
      ***********************************************
     C                   MOVE      WSDT1D        UDT1              2 0
     C                   MOVE      WSDT1M        UDT2              2 0
     C                   MOVE      WSDT1Å        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT1D
     C                   MOVE      UDT2          WSDT1M
     C                   MOVE      UDT3          WSDT1Å
      *
     C                   MOVE      WSDT2D        UDT1
     C                   MOVE      WSDT2M        UDT2
     C                   MOVE      WSDT2Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT2D
     C                   MOVE      UDT2          WSDT2M
     C                   MOVE      UDT3          WSDT2Å
      *
     C                   MOVE      WSDT4D        UDT1
     C                   MOVE      WSDT4M        UDT2
     C                   MOVE      WSDT4Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT4D
     C                   MOVE      UDT2          WSDT4M
     C                   MOVE      UDT3          WSDT4Å
      *
     C                   MOVE      WSDT5D        UDT1
     C                   MOVE      WSDT5M        UDT2
     C                   MOVE      WSDT5Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT5D
     C                   MOVE      UDT2          WSDT5M
     C                   MOVE      UDT3          WSDT5Å
      *
     C                   MOVE      WSDT6D        UDT1
     C                   MOVE      WSDT6M        UDT2
     C                   MOVE      WSDT6Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT6D
     C                   MOVE      UDT2          WSDT6M
     C                   MOVE      UDT3          WSDT6Å
      *
     C                   ENDSR
      *
      ***********************************************
     C     KDTFM2        BEGSR
      ***********************************************
     C                   MOVE      HEDTD         UDT1
     C                   MOVE      HEDTM         UDT2
     C                   MOVE      HEDTÅ         UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDTOD
     C                   MOVE      UDT2          WSDTOM
     C                   MOVE      UDT3          WSDTOÅ
      *
     C                   ENDSR
      *
      ***********************************************
     C     KDTFMT        BEGSR
      ***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
      *
     C                   ENDSR
      *
      *************************************************
     C     BYAVD         BEGSR
      *************************************************
      *
      * NEW DEPARTMENT SELECTED
      *
     C     KODTAK        CHAIN     KODTA                              30
     C   30              GOTO      UTBY
     C                   MOVE      WSAVD         WSAVDO            4 0
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
      *
     C     UTBY          ENDSR
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
      *
      * signatur
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     31
     C                   CALL      'SYFA14B'
     C                   PARM                    WSavd
     C                   Z-ADD     28            POSNBR
     C                   Z-ADD     8             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
      * signatur
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     30
     C                   move      'P'           sgpluk            1
     C                   CALL      'SYFA60'
     C                   PARM                    sgpluk
     C                   PARM                    WSSG
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      * OPPDRAGSTYPE
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     29
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOT
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * FRIE SØKEVEIER
     C     LINNBR        IFEQ      20
     C                   CALL      'SYFA65A'
     C                   PARM                    WSFRI1
     C                   Z-ADD     33            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     CRTOP1        BEGSR
      ***********************************************
     C                   MOVE      UUR           HEUR
     C                   MOVE      'CR1'         UTYPE             3
     C                   MOVE      UAVD          UAVD2
     C                   MOVE      *ZEROS        UOPD2
     C                   MOVE      USG           USG2              3
      *
     C                   EXSR      WRKOPD
     C                   EXSR      VISOPD
      *
     C                   ENDSR
      *
      ***********************************************
     C     CRTOP2        BEGSR
      ***********************************************
     C                   MOVE      'CR2'         UTYPE             3
     C                   MOVE      UAVD          UAVD2
     C                   MOVE      *ZEROS        UOPD2
     C                   MOVE      USG           USG2
      *
     C                   EXSR      WRKOPD
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKOPD        BEGSR
      ***********************************************
     C                   MOVE      ' '           UKODE             1
     C                   MOVE      ' '           UDUMMY            1
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          UAVDNY            4 0
     C                   MOVE      UUR           HEUR
     C                   ELSE
     C                   MOVE      *ZEROS        UAVDNY
     C                   END
      *
     C                   SELECT
      * LAND IMPORT
     C     HEUR          WHENEQ    'A'
     C                   CALL      'SYFA10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE             1
     C                   PARM                    UDUMMY            1
     C                   PARM                    UAVDNY
      * LAND EXPORT
     C     HEUR          WHENEQ    'B'
     C                   CALL      'SYEX10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY
     C                   PARM                    UAVDNY
      * FLY IMPORT
     C     HEUR          WHENEQ    'C'
     C                   CALL      'SYFI10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY            1
     C                   PARM                    UAVDNY
      * FLY EXPORT
     C     HEUR          WHENEQ    'D'
     C                   CALL      'SYEF10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY            1
     C                   PARM                    UAVDNY
      * FLY INNLAND
     C     HEUR          WHENEQ    'E'
     C                   CALL      'SYIN10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * SJØ IMPORT
     C     HEUR          WHENEQ    'F'
     C                   CALL      'SYSJ10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * SJØ EXPORT
     C     HEUR          WHENEQ    'G'
     C                   CALL      'SYSE10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * BÅT
     C     HEUR          WHENEQ    'S'
      * FRA LAND EXPORT
     C     UUR           IFEQ      'B'
     C                   CALL      'SYEX10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY
     C                   PARM                    UAVDNY
     C                   ENDIF                                                  <UUR
      * FRA FLY EXPORT
     C     UUR           IFEQ      'D'
     C                   CALL      'SYEF10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
     C                   ENDIF                                                  <UUR
      * FRA SJØ EXPORT
     C     UUR           IFEQ      'G'
     C                   CALL      'SYSE10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
     C                   ENDIF                                                  <UUR
     C                   ENDSL
      *
     C     UAVD2         IFNE      0
     C     UTYPE         ANDNE     'CPY'
     C                   MOVE      UAVD2         UAVD
     C                   MOVE      UAVD2         WSAVDA
     C                   END
     C     USG2          IFNE      *BLANKS
     C     UTYPE         ANDNE     'CHG'
     C     UTYPE         ANDNE     'CPY'
     C                   MOVE      USG2          USG
     C                   MOVE      USG2          WSSGA
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISOPD        BEGSR
      ***********************************************
     C     UAVD2         IFNE      0                                            1<-B
     C     UOPD2         ANDNE     0
     C     HEDKNY        CHAIN     HEADF                              33
     C  N33              DO                                                      2<-B
     C                   EXSR      KDTFM2
     C     HESGM         COMP      *BLANKS                            2727
     C* N51              MOVE      HERFA         HEALT
     C  N51              MOVEL     HERFA         HEALT
     C   51              MOVE      *BLANKS       HEALT
     C   51              MOVEL     HEHAWB        HEALT
     C   52              MOVEL     HETRCN        HEALT
     C   53FSKODE        IFEQ      'IFB'
     C     FSSNDX        ANDNE     ' '
     C                   MOVEL     FSSNDN        HEALT
     C                   ELSE
     C                   MOVEL     FSSOK         HEALT
     C                   END
     C     HEUR          IFEQ      'D'                                            3<-B
     C                   MOVE      HERFA         HEALT
     C                   MOVE      HEHAW6        HEALT
     C                   END                                                      3<-E
N04  C   67              MOVEL     HEGM1         HEALT
N13  c                   exsr      movdta2
     C                   MOVEL     HENAS         WSSELG
     C                   MOVEL     HENAK         WSKJØP
     C     UTYPE         IFNE      'CHG'                                          3<-B
     C     UTYPE         ANDNE     'CHF'
     C                   ADD       1             XRECNO
     C                   MOVE      XRECNO        ZRECNO
     C     TRFA11        COMP      *BLANKS                            8989
     C  N89TRFA21        COMP      *BLANKS                            8989
     C                   WRITE     SUBFIL
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGOPD        BEGSR
      ***********************************************
     C                   MOVE      'CHG'         UTYPE             3
     C                   MOVE      HEAVD         UAVD2
     C                   MOVE      HEOPD         UOPD2
     C                   MOVE      USG           USG2
      *
     C     OPHEOP        IFNE      '1'
     C                   OPEN      HEADFOPD
     C                   END
      *
     C     HEADOK        CHAIN     HEADFOPD                           33
     C                   MOVE      HEST          XST               1
     C     HEST          IFNE      'C'
     C     HEST          ANDNE     'U'
     C                   MOVE      ' '           HEST
     C                   END
     C                   EXCEPT    NYOPDS
      *
     C                   EXSR      WRKOPD
     C  N90              EXSR      VISOPD
      *
     C     HEADOK        CHAIN     HEADFOPD                           33
     C     XST           IFEQ      'U'                                          1<-B
     C     HEOT          ANDNE     *BLANKS
     C                   MOVE      ' '           HEST
     C                   ELSE                                                   1
     C                   MOVE      XST           HEST
     C                   END                                                    1<-E
     C                   EXCEPT    NYOPDS
      *
     C  N90              EXSR      UPDSBF
      *
      *
N13  c     opt22         ifeq      'J'
N13  c     Oldfile       ifne      *blanks
N13  c     AdobePath     ifne      'IE'
N13  c     AdobePath     andne     'STDBROWSER'
N13  c     AdobePath     andne     'CHROME'
N13  c     AdobePath     andne     'LINK'
N13  C                   exsr      ClosePDF
N13  c                   else
N13  C                   exsr      ClBROWSPDF
N13  c                   endif
N13  c                   endif
N13  c                   endif
N13   *
     C                   ENDSR
      *
      ***********************************************
     C     CPYOPD        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      'CPY'         UTYPE             3
     C                   MOVE      HEAVD         UAVD2
     C                   MOVE      HEOPD         UOPD2
     C                   MOVE      USG           USG2
      *
     C                   EXSR      WRKOPD
     C  N90              EXSR      VISOPD
      *
     C                   ENDSR
      *
      ***********************************************
     C     DSPOPD        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   CALL      'SYFM21A'
     C                   PARM                    UFIRM
     C                   PARM      HEAVD         UAVD2             4 0
     C                   PARM      HEOPD         UOPD2             7 0
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      0
     C                   EXSR      DSPFAK
     C                   END
      *
     C     HESGM         COMP      *BLANKS                            2727
N13  c                   exsr      movdta2
      *
     C                   ENDSR
      ***********************************************
     C     DSPWEB        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   EVAL      Overskr = 'Se SYSPED oppdrag på WEB (eSped) '
     C                   EVAL      WebType = 'ESPEO'
     C                   move      HEAVD         HEAVDA            4
     C                   move      HEOPD         HEOPDA            7
     C                   EVAL      WebSok  = '&heavd='+HEAVDA+
     C                             '&heopd='+HEOPDA
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C     HESGM         COMP      *BLANKS                            2727
N13  c                   exsr      movdta2
      *
     C                   ENDSR
      *
      ***********************************************
     C     SNDEPW        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
      *
     C                   MOVE      HEAVD         UAVD4             4
     C                   MOVE      HEOPD         UOPD4             7
     C                   CALL      'SYTR33CW'
     C                   PARM                    UAVD4
     C                   PARM                    UOPD4
      *
     C     HESGM         COMP      *BLANKS                            2727
N13  c                   exsr      movdta2
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGTUR        BEGSR
      ***********************************************
     C                   MOVE      'CHG'         UTYPE             3
     C                   MOVE      UAVD          UAVD2
     C                   Z-ADD     -1            UOPD2
     C                   MOVE      USG           USG2
     C                   EXSR      WRKOPD
      *
     C                   ENDSR
      *
      ***********************************************
     C     DSPTUR        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C     TURKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEPRO
     C     OPTURE        IFNE      '1'
     C                   OPEN      TURER
     C                   END
     C     TURKEY        CHAIN     TURER                              33
     C  N33              DO
     C                   MOVE      'J'           USPØR             1
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SYEX88A'
     C                   PARM                    UFIRM
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   PARM                    USPØR
     C                   PARM                    UIMP
     C                   PARM                    UFLAGG            1 0
     C                   END
      *
N13  c                   exsr      movdta2
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKFV         BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      *ZEROS        OTIKU1            8 0
     C                   MOVE      *ZEROS        OTIKU2            8 0
     C     HEADOK        CHAIN     HEADF                              33
     c                   move      HEKNSF        OTIKU1
     C     HEKNKF        IFNE      *zeros
     C     HEKNKF        andne     HEKNSF
     C     OTIKU1        ifeq      *zeros
     C                   MOVE      HEKNKF        OTIKU1
     C                   else
     C                   MOVE      HEKNKF        OTIKU2
     C                   end
     C                   END
     C                   CALL      'SYFA64'
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKMRK        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      HEAVD         PAVD2             4
     C                   MOVE      HEOPD         POPD2             7
     C                   CALL      'SYFA94R'
     C                   PARM                    PAVD2
     C                   PARM                    POPD2
      *
     C                   ENDSR
      ***********************************************
     C     MANIFSR       BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      HEPRO         XXPRO             8
N05  C                   move      '00000000'    XXAGE             8
N02  C                   MOVE      ' '           XXFUNK            1
     C                   CALL      'TURADR'
     C                   PARM                    XXPRO
N05  C                   PARM                    XXAGE
N02  c                   PARM                    XXFUNK
N02  c     XXFUNK        IFEQ      'L'
N02  C                   MOVE      ' '           XXFUNK            1
N02  C                   CALL      'TURADRL'
N02  C                   PARM                    XXPRO                          Husk gjeldende TUR
N02  c                   PARM                    XXFUNK
N02  c                   endif
      *
     C                   ENDSR
      ***********************************************
     C     BUDSR         BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      'O'           P1FLAG
     C                   MOVE      *ZEROS        P1BNR
     C                   MOVE      *ZEROS        P1AVD
     C                   MOVE      *ZEROS        P1TUNR
     C                   MOVE      HEAVD         P1OAVD
     C                   MOVE      HEOPD         P1OPD
     C                   MOVE      *ZEROS        P1BL
     C                   MOVE      P1DS          PARM1           256
     C                   CALL      'SYKS12'
     C                   PARM                    PARM1
     C                   ENDSR
      *
      *
      ***********************************************
     C     WRKFT         BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   PARM                    UFLAGG
      *
N13  c                   exsr      movdta2
      *
     C                   ENDSR
      *
      ***********************************************
s09  C*    DSPFAX        BEGSR
n09  C     DSPEPO        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
S09  C*    FREETK        CHAIN     FAXLOG03                           33
n09  C     FREETK        CHAIN     ARKLOGH4                           33
     C  N33              DO
n09  C                   MOVE      EPUNIK        UUNIK             9 0
s12  C*                  CALL      'ARC013'
s20  C*                  CALL      'ARC012'
n20  C                   CALL      'ARC012CLD'
s12  C*                  PARM                    UUNIK
n12  c                   PARM                    epavd
n12  C                   PARM                    epopd
s09  C*                  MOVE      'J'           FINS
s09  C*                  CALL      'FAXDSP'
s09  C*                  PARM                    LODOCN
s09  C*                  PARM                    LOMAPP
s09  C*                  PARM                    FINS              1
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     DSPFAK        BEGSR
      ***********************************************
     C                   CALL      'SYFM21B'
     C                   PARM                    UFIRM
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   PARM                    UFLAGG
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGFAK        BEGSR
      ***********************************************
     C                   MOVE      'CHF'         UTYPE             3
     C                   MOVE      HEAVD         UAVD2
     C                   MOVE      HEOPD         UOPD2
     C                   MOVE      USG           USG2
      *
     C     OPHEOP        IFNE      '1'
     C                   OPEN      HEADFOPD
     C                   END
      *
     C     HEADOK        CHAIN     HEADFOPD                           33
     C                   MOVE      HEST          XST               1
     C                   MOVE      ' '           HEST
     C                   EXCEPT    NYOPDS
      *
     C                   EXSR      WRKOPD
     C  N90              EXSR      VISOPD
      *
     C     HEADOK        CHAIN     HEADFOPD                           33
     C                   MOVE      XST           HEST
     C                   EXCEPT    NYOPDS
      *
     C  N90              EXSR      UPDSBF
      *
     C                   ENDSR
      *
      ***********************************************
     C     DSPISO        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   CALL      'SYIS10A'
     C                   PARM                    UFIRM
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   PARM                    UTNO2             8 0
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKTT         BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
      * TRACK&TRACE ER BETALBART PRODUKT - HAR DE LISSENS??
     C     MODOK         IFNE      'J'
     C                   MOVEL     'TRACK&TR'    UMODUL           15
     C                   MOVE      'ACE    '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      UTTT
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
      *
     C                   Z-ADD     1             UFLAGG
n08  C                   z-add     0             UTTUR             8 0
     C                   CALL      'SYTT01CL'
     C                   PARM      HEAVD         UTTAVD            4 0
     C                   PARM      HEOPD         UTTOPD            7 0
n08  C                   PARM                    UTTUR
     C                   PARM                    UFLAGG
      *
     C     UTTT          ENDSR
      *
      ***********************************************
     C     WRKTTT        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
      * TRACK&TRACE ER BETALBART PRODUKT - HAR DE LISSENS??
     C     MODOK         IFNE      'J'
     C                   MOVEL     'TRACK&TR'    UMODUL           15
     C                   MOVE      'ACE    '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      UTTTT
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
      *
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYTT02CL'
     C                   PARM      HEAVD         UTTAVD            4 0
     C                   PARM      HEOPD         UTTOPD            7 0
     C                   PARM                    UFLAGG
      *
     C     UTTTT         ENDSR
      *
N15   ***********************************************
N15  C     WRKHEN        BEGSR
N15   ***********************************************
N15  C  N90              EXSR      UPDSBF
N15  C                   Z-ADD     1             UFLAGG
N15  C                   CALL      'SYTR33H'
N15  C                   PARM      HEAVD         UTTAVD            4 0
N15  C                   PARM      HEOPD         UTTOPD            7 0
N15   *
N15  C                   ENDSR
      *
     C***********************************************
     C     DSPTVI        BEGSR
     C***********************************************
     C                   MOVE      '4'           WIN03             1
     C                   IF        *IN90
     C                   MOVE      W2AVD         UAVD3             4 0
     C                   MOVE      W2OPD         UOPD3             7 0
     C                   ELSE
     C                   MOVE      HEAVD         UAVD3
     C                   MOVE      HEOPD         UOPD3
     C                   END
     C                   CALL      'SAD003'
     C                   PARM                    UAVD3
     C                   PARM                    UOPD3
     C                   PARM                    WIN03
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     INTEDI        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
      * TRACK&TRACE ER BETALBART PRODUKT - HAR DE LISSENS??
     C     IEDIOK        IFNE      'J'
     C                   MOVEL     'SNDINTED'    UMODUL           15
     C                   MOVE      'I      '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      UTIEDI
     C                   END
     C                   MOVE      'J'           IEDIOK            1
     C                   END
      *
     C                   MOVE      HEAVD         IEAVD             4
     C                   MOVE      HEOPD         IEOPD             7
     C                   CALL      'IE011C'
     C                   PARM                    IEAVD
     C                   PARM                    IEOPD
      *
     C     UTIEDI        ENDSR
      *
      ***********************************************
     C     UPDSBF        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        WSNR
     C     HESGM         COMP      *BLANKS                            2727
     C     FREETK        SETLL     FREETXT
     C                   SETOFF                                       2988
     C     FREETK        READE     FREETXT                                29
     C  N29              SETON                                            88
     C     FREETK        CHAIN     FERDL01                            33
     C  N33              MOVE      'K'           HEST
     C     *IN33         IFEQ      '1'
     C     FREETK        CHAIN     SAML1                              33
     C  N33              MOVE      'C'           HEST
     C                   END
     C     TRFA11        COMP      *BLANKS                            8989
     C  N89TRFA21        COMP      *BLANKS                            8989
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKSAD        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C     HEUR          IFEQ      'A'
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   CALL      'SAD061CL'
     C                   PARM      HEAVD         SIAVD             4 0
     C                   PARM      HEOPD         SITDN             7 0
     C                   PARM      HESG          SISG              3
     C                   PARM                    XTYPE             3
     C                   PARM                    UMODE             1
     C                   CALL      'SAD61P01'
     C                   PARM                    UPRT1            10
     C                   PARM                    UPRT2            10
     C                   PARM                    UPRT3            10
     C                   ELSE
     C     HEUR          IFEQ      'B'
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   CALL      'SAD052CL'
     C                   PARM      HEAVD         SEAVD             4 0
     C                   PARM      HEOPD         SETDN             7 0
     C                   PARM      HESG          SESG              3
     C                   PARM                    XKODE
     C                   PARM                    XTYPE
     C                   CALL      'SAD52P01'
     C                   PARM                    UPRT1            10
     C                   PARM                    UPRT2            10
     C                   PARM                    UPRT3            10
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     PLUAWB        BEGSR
      ***********************************************
     C                   CALL      'TDV01R'
     C                   PARM                    USG
     C                   PARM                    UAVD
     C                   PARM                    HEOPD
     C                   PARM                    PFLAGG
     C                   ENDSR
      ***********************************************
     C     WRKTDV        BEGSR
      ***********************************************
      * Sending av singel fraktbrev (eksport/innland) som FWB til agent
      * sending av house AWB som AZB til agent er tillatt bare for
      * flyoppdrag
     C                   Z-ADD     HEAVD         PAVD              4 0
     C                   CALL      'TDV20R'
     C                   PARM                    PAVD
     C                   PARM                    HEOPD
     C                   PARM                    WDUM1             3
     C                   PARM                    WDUM2             3 0
     C                   ENDSR
      ***********************************************
     C     PLUKOM        BEGSR
      ***********************************************
     C                   CALL      'SYOP21R'
     C                   PARM                    UUR
      *
     C                   ENDSR
      ***********************************************
     C     HURTIG        BEGSR
      ***********************************************
     C                   MOVE      'N'           HUPLUK            1
     C                   MOVE      *BLANKS       HUDATA          218
     C                   CALL      'SYHU10'
     C                   PARM                    HUPLUK
     C                   PARM                    HUDATA
     C                   ENDSR
      *
      ***********************************************
     C     UTLFB         BEGSR
      ***********************************************
     C                   CALL      'SYFO03R'
     C                   PARM      WSPRO         UPRO              8 0
      *
     C                   ENDSR
      ***********************************************
     C     TDVLOG        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C     FITDVI        IFEQ      'J'
      *
     C                   MOVE      *BLANKS       UAWBNO           12
     C                   SELECT
     C     HEUR          WHENEQ    'C'
     C                   MOVEL(P)  HEALT1        UAWBNO
     C     UAWBNO        CAT       '-':0         UAWBNO
     C     UAWBNO        CAT       HEALT2:0      UAWBNO
     C     HEUR          WHENEQ    'D'
     C                   MOVEL(P)  HEGN3         UAWBNO
     C     UAWBNO        CAT       '-':0         UAWBNO
     C     UAWBNO        CAT       HEGN4:0       UAWBNO
     C     HEUR          WHENEQ    'E'
     C                   MOVEL(P)  HEGN3         UAWBNO
     C     UAWBNO        CAT       '-':0         UAWBNO
     C     UAWBNO        CAT       HEGN4:0       UAWBNO
     C                   ENDSL
      *
     C     UAWBNO        IFNE      *BLANKS
     C                   CALL      'SM043C'
     C                   PARM                    UAWBNO
     C                   ENDIF
      *
     C                   ENDIF
     C  N90              EXSR      VISOPD
      *
     C                   ENDSR
      ***********************************************
     C     DOKUME        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   CALL      'SYOPDO'
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   ENDSR
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   CALL      'ARC003'
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   PARM                    URUNDE           10
     C                   ENDSR
      *
n10   ***********************************************
n10  C     SENDEP        BEGSR
n10   ***********************************************
n10  C  N90              EXSR      UPDSBF
n10  c                   move      heavd         epavd             4 0
n10  c                   move      heopd         epopd             7 0
n10  c                   move      'E'           ukode
n10  C                   CALL      'ARC045'
n10  C                   PARM                    epAVD
n10  C                   PARM                    epOPD
n10  C                   parm                    kunul             8 0
n17  C                   PARM                    UKODE             1
n18  C                   PARM                    EMNE             80
n10  C                   endsr
n22   ***********************************************
n22  C     TKEVENT       BEGSR
n22   ***********************************************
n22   * send sms med TKeventfrabber-lenke
n22  C  N90              EXSR      UPDSBF
n22  c                   move      heavd         epavd             4 0
n22  c                   move      heopd         epopd             7 0
n22  C                   CALL      'SYTR33H'
n22  C                   PARM                    epAVD
n22  C                   PARM                    epOPD
n22  C                   endsr
n16   ***********************************************
n16  C     SENDEPF       BEGSR
n16   ***********************************************
n16   * send epost av fraktbrev evt generer
n16  C  N90              EXSR      UPDSBF
n16  c                   move      heavd         epavd             4 0
n16  c                   move      heopd         epopd             7 0
n16  C                   CALL      'SYGE72'
n16  C                   PARM                    epAVD
n16  C                   PARM                    epOPD
n16  C                   endsr
n11   ***********************************************
n11  C     fraktbr       BEGSR
n11   ***********************************************
n11  C  N90              EXSR      UPDSBF
n11  C                   MOVE      HEAVD         PAVD2             4
n11  C                   MOVE      HEOPD         POPD2             7
n11  C                   MOVE      *ZEROS        PTUR2             8
n11  C                   CALL      'SYFA12CLD'
n11  C                   PARM                    PAVD2
n11  C                   PARM                    POPD2
n11  C                   PARM                    PTUR2
n11  C                   endsr
      ***********************************************
     C     PRTSKILL      BEGSR
      ***********************************************
     C  N90              EXSR      UPDSBF
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     HEAVD         SCASTR9          11
     C                   MOVE      HEOPD         SCASTR9
     C                   MOVEL     SCASTR9       SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   ENDSR
      *
N13   ***********************************************
N13  C     VISPDFSTR     BEGSR
N13   ***********************************************
N24  c                   IF        GCarkivJN='J'
N24   * forsøk nedlasting fra google - vellukket = bytt verdiene for bane og lenke
N24  C                   exsr      goog
N24  C                   if        uok = 'J'
N24   * gotmpf inneholde slash foran/bak (esk: /asp/tmp/) mens arcanr er uten (eks: asp/a38 )
N24  c     ' '           scan      gotmpf100     nr                2 0          Eks Nr = 10
N24  c                   eval      gotmpf100=%subst(gotmpf100:2:Nr-3)           Eks :2:7)->asp/a38
N24  C                   eval      arcane = gotmpf100
N24  C                   eval      arlink = arlenke
N24  C                   endif
N24  C                   endif
N13   ***** Ett og bare ett ZH.dokument
N13  c     ArkZHkey      chain     ARKIVL02                           33
N13  c     *in33         ifeq      '0'
N22  c     arbhis        ifne      *blanks
N22  c                   eval      arcane=arbhis
N22  c                   end
N13  C                   move      *blanks       Oldfile
N13  c                   eval      Oldfile = ARLINK
N13  c     AdobePath     ifne      'IE'
N13  c     AdobePath     andne     'STDBROWSER'
N13  c     AdobePath     andne     'CHROME'
N13  c     AdobePath     andne     'LINK'
N13  c                   exsr      VisPdfa
N13  c                   else
N13  c                   exsr      VisPdf
N13  c                   endif
N13  c                   endif
N13  c                   endsr
      *
N13   ***********************************************
N13  C     VISPDF        BEGSR
N13   ***********************************************
N13   *
N13   *
N13   *
N13   *
N13   * hent ip/bane mm..
N13  c     ArkZHkey      chain     ARKIVL02                           33
N13  c     *in33         ifeq      '0'
N13  c  N33UFIRM         chain     firmarc                            33
N13  c     *in33         cabeq     '1'           EndPDFbrowser
N13  c     artype        chain     ARKTXT                             33
N13  C     ARKLAG        IFNE      *blanks
N13  c     arklagk       chain     arkext
N13  c                   endif
N13  c                   move      *blanks       Ubane
N22  c     arbhis        ifne      *blanks
N22  c                   eval      arcane=arbhis
N22  c                   end
N13   * bevisst valg via LINK (f.eks har ikke tilgang til sharet nettverksstasjon pga security)
N13  c     AdobePath     ifeq      'LINK'
N13  c                   eval      Ubane='http://'+%trim(ARCPAD)+'/'
N13  c                             +%trim(ARCANE)+'/'+%trim(ARLINK)
N13  c                   Movel     UBANE         HFLINK
N13  C                   EXFMT     VISLINK
N13  c                   goto      EndPDFbrowser
N13  c                   endif
N13   * >page= blir i estkopdf konvertert til #page=
N13  c                   eval      Ubane='http://'+%trim(ARCPAD)+'/sycgip/'
N13  c                             +'estkopdf.pgm?PDF=/'+%trim(ARCANE)
N13  c                             +'/'+%trim(ARLINK)+']page='+ADPAGE
N13  c                   select
N13  c     AdobePath     wheneq    'STDBROWSER'
N13  c                   eval      OPNIEBAT ='start '+%trim(Ubane)
N13  c     AdobePath     wheneq    'IE'
N13  c                   eval      OPNIEBAT ='start iexplore '+%trim(Ubane)
N13  c     AdobePath     wheneq    'CHROME'
N13  c                   eval      OPNIEBAT ='start chrome '+%trim(Ubane)
N13  c                   endsl
N13  C                   CALL      'SAD105CP'
N13  c                   parm                    OPNIEBAT
N13  c                   end
N13  C
N13  C     EndPDFbrowser ENDSR
N13   ***********************************************
N13  C     VISPDFA       BEGSR
N13   ***********************************************
N13   * 1) Finn fil/kopier til temporær IFS-mappe med nettverks-stasjons-tilgang
N13   * 2) Bygg VBscriptfil (USER+OPN.VBS) i samme temporære mappe
N13   * 3) Kopier VBscript-fila til mappe på lokal PC som user har tilgang til(%USERPROFILE%='Home')
N13   *          (i Wind.7 oppfattes kjøring av VBS fra remote mappe som risiko - kopi=workaroud)
N13   * 4) Kjør VBscriptet
N13   *(  5) Filnavn huskes i variabel OldFile - gjøres rett etter denne SR, for å kalle ClosePDF )
N13   *
N13  c     ArkZHkey      chain     ARKIVL02                           33
N13  c     *in33         cabeq     '1'           EndPDFA
N22  c     arbhis        ifne      *blanks
N22  c                   eval      arcane=arbhis
N22  c                   end
N13   *
N13  c                   Eval      Frafil= %trim(FraMappe)+ARLINK
N13  c                   Eval      Tilfil= %trim(TilMappe)+ARLINK
N13  c                   Eval      PDFfil= %trim(PCMappe) +ARLINK
N13   *
N13  C                   eval      rc = docmd(' +
N13  C                             cpy obj("'+%trim(Frafil)+'")'
N13  C                             +' toobj("'+%trim(Tilfil)+'")'
N13  c                             +' replace(*YES) +
N13  c                             ')
N13   * lage bat-fil med åpningskommando
N13  C                   eval      rc = docmd(' +
N13  C                             dltf FILE(QTEMP/Q)  +
N13  C                             ')
N13   *
N13  C                   eval      rc = docmd(' +
N13  C                             CRTPF FILE(QTEMP/Q) RCDLEN(200) +
N13  C                             ')
N13  C                   OPEN      Q
N13   *
N13  c                   eval      BatDta='adobePath = CHR(34) & "'
N13  c                             + %trim(AdobePath) +'" & CHR(34)'
N13  C                   EXCEPT    QData
N13  c                   eval      BatDta='newFilePath = CHR(34) & "'
N13  c                             + %trim(PDFfil) +'" & CHR(34)'
N13  C                   EXCEPT    QData
N13  c                   eval      BatDta='page = "' + %trim(TilPage)+'"'
N13  C                   EXCEPT    QData
N13   /free
N13       eval BatDta='set WshShell = WScript.CreateObject("WScript.Shell")';
N13       EXCEPT QData;
N13       eval BatDta='WshShell.Run( adobePath & " /A " & CHR(34) &'
N13                  +'"page=" & page & CHR(34)   & newFilePath)';
N13       EXCEPT QData;
N13
N13     //eval BatDta='WScript.Sleep 100';
N13     //EXCEPT QData;
N13
N13     //eval BatDta='WshShell.AppActivate("Sesjon B - [24 x 80]")';
N13     //EXCEPT QData;
N13   /end-free
N13   *
N13  C                   close     Q
N13   * kopier AS-fil streamfil
N13  C                   eval      rc = docmd(' +
N13  C                             CPYTOSTMF  +
N13  C                             FROMMBR("/QSYS.LIB/QTEMP.LIB/Q.FILE/Q.MBR") +
N13  C                             TOSTMF("' +
N13  C                             %trim(TilMappe)+%trim(WUSER)+
N13  C                             'OPN.VBS") STMFOPT(*REPLACE) +
N13  C                             CVTDTA(*AUTO) STMFCODPAG(*PCASCII) +
N13  C                             ENDLINFMT(*CRLF) +
N13  C                             ')
N13  C                   eval      rc = docmd(' +
N13  c                             CHGAUT OBJ("' +
N13  C                             %trim(TilMappe)+%trim(WUSER)+
N13  C                             'OPN.VBS") USER(*PUBLIC) DTAAUT(*RWX) ' +
N13  C                             'OBJAUT(*ALL)')
N13   * Hjelpevariabler for å forenkle PCO-kommandoene
N13  C                   EVAL      VBZ  =%trim(PCMappe)+%trim(WUSER)
N13  c                             +'OPN.VBS'
N13  C                   EVAL      VBC  ='"'+%trim(PCTemp)+%trim(WUSER)
N13  c                             +'.VBS"'
N13   * kommando for copy av fil til lokal disk/home, samt for å kjøre VBscript
N13  C                   EVAL      CPY  = '"copy '+%trim(VBZ)+' '+%trim(VBC)+'"'
N13  c                   eval      STRVBC = '"cscript ' +%trim(VBC)+'"'
N13   * START PCO/PCCMD
N13  C                   eval      rc = docmd(' +
N13  C                             STRPCO  +
N13  C                             ')
N13   *
N13   ******* EKS: CPY   = "copy Z:\JOVOOPN.VBS "%USERPROFILE%\JOVO.VBS""
N13  C                   CALL      'SAD105CP'
N13  c                   parm                    CPY
N13  C
N13   ******* EKS: STRVBC= "cscript "%USERPROFILE%\JOVO.VBS""
N13  C                   CALL      'SAD105CP'
N13  c                   parm                    STRVBC
N13   *
N13  C     EndPDFA       ENDSR
N13   ***********************************************
N13  C     ClosePDF      BEGSR
N13   ***********************************************
N13   * 1) Bygg VBscriptfil (USER+CL.VBS) i temporær IFS-mappe med nettv-stasj-tilgang
N13   * 2) Kopier VBscript-fila til mappe på lokal PC som user har tilgang til(%USERPROFILE%='Home')
N13   *          (i Wind.7 oppfattes kjøring av VBS fra remote mappe som risiko - kopi=workaroud)
N13   * 3) Kjør VBscriptet
N13  C                   eval      rc = docmd(' +
N13  C                             dltf FILE(QTEMP/Q)  +
N13  C                             ')
N13   *
N13  C                   eval      rc = docmd(' +
N13  C                             CRTPF FILE(QTEMP/Q) RCDLEN(200) +
N13  C                             ')
N13  C                   OPEN      Q
N13   *
N13  c                   eval      BatDta='oldFileName = "' + %trim(OldFile)+'"'
N13  C                   EXCEPT    QData
N13   /free
N13       eval BatDta='set WshShell = WScript.CreateObject("WScript.Shell")';
N13       EXCEPT QData;
N13
N13       eval BatDta='If (WshShell.AppActivate'
N13                  +'(oldFileName & " - Adobe Reader") = true) Then';
N13       EXCEPT QData;
N13
N13       eval BatDta='WScript.Sleep 100';
N13       EXCEPT QData;
N13
N13       eval BatDta='WshShell.SendKeys "^w"';
N13       EXCEPT QData;
N13
N13       eval BatDta='End If';
N13       EXCEPT QData;
N13
N13   /end-free
N13   *
N13  C                   close     Q
N13   * kopier AS-fil streamfil
N13  C                   eval      rc = docmd(' +
N13  C                             CPYTOSTMF  +
N13  C                             FROMMBR("/QSYS.LIB/QTEMP.LIB/Q.FILE/Q.MBR") +
N13  C                             TOSTMF("' +
N13  C                             %trim(TilMappe)+%trim(PSDSUSRNAM)+
N13  C                             'CL.VBS") STMFOPT(*REPLACE) +
N13  C                             CVTDTA(*AUTO) STMFCODPAG(*PCASCII) +
N13  C                             ENDLINFMT(*CRLF) AUT(*FILE) +
N13  C                             ')
N13  C                   eval      rc = docmd(' +
N13  c                             CHGAUT OBJ("' +
N13  C                             %trim(TilMappe)+%trim(PSDSUSRNAM)+
N13  C                             'CL.VBS") USER(*PUBLIC) DTAAUT(*RWX) ' +
N13  C                             'OBJAUT(*ALL)')
N13   *
N13   * Hjelpevariabler for å forenkle PCO-kommandoene
N13  C                   EVAL      VBZ  =%trim(PCMappe)+%trim(PSDSUSRNAM)
N13  c                             +'CL.VBS'
N13  C                   EVAL      VBC  ='"'+%trim(PCTemp)+%trim(PSDSUSRNAM)
N13  c                             +'.VBS"'
N13   * kommando for copy av fil til lokal disk/home, samt for å kjøre VBscript
N13  C                   EVAL      CPY  = '"copy '+%trim(VBZ)+' '+%trim(VBC)+'"'
N13  c                   eval      STRVBC = '"cscript ' +%trim(VBC)+'"'
N13   * START PCO/PCCMD
N13  C                   eval      rc = docmd(' +
N13  C                             STRPCO  +
N13  C                             ')
N13   *
N13   ******* EKS: CPY   = "copy Z:\JOVOCL.VBS "%USERPROFILE%\JOVO.VBS""
N13  C                   CALL      'SAD105CP'
N13  c                   parm                    CPY
N13  C
N13   ******* EKS: STRVBC= "cscript "%USERPROFILE%\JOVO.VBS""
N13  C                   CALL      'SAD105CP'
N13  c                   parm                    STRVBC
N13   *
N13  C     EndClPDF      ENDSR
N13   ***********************************************
N13  C     ClBROWSPDF    BEGSR
N13   ***********************************************
N13  c                   move      *blanks       Ubane
N13   * bevisst valg via LINK - da må brukeren stenge selv....
N13  c     AdobePath     ifeq      'LINK'
N13  c                   goto      EndCLBrowser
N13  c                   endif
N13   * direkte borser via PDF - close = sende blank i parameter PDF
N13   * START PCO/PCCMD
N13  C                   eval      rc = docmd(' +
N13  C                             STRPCO  +
N13  C                             ')
N13   *
N13  c                   eval      Ubane='http://'+%trim(ARCPAD)+'/sycgip/'
N13  c                             +'estkopdf.pgm?PDF='
N13  c                   select
N13  c     AdobePath     wheneq    'STDBROWSER'
N13  c                   eval      OPNIEBAT ='start '+%trim(Ubane)
N13  c     AdobePath     wheneq    'IE'
N13  c                   eval      OPNIEBAT ='start iexplore '+%trim(Ubane)
N13  c     AdobePath     wheneq    'CHROME'
N13  c                   eval      OPNIEBAT ='start chrome '+%trim(Ubane)
N13  c                   endsl
N13  C                   CALL      'SAD105CP'
N13  c                   parm                    OPNIEBAT
N13  C
N13  C     EndCLBrowser  ENDSR
N24   ****************************************************************************
N24  c     goog          begsr
N24   ****************************************************************************
N24  c                   eval      gotmpf100=gotmpf
N24  c                   eval      arlenke=arlink
N24  C     '.'           SCAN      arlenke                                44
N24  c  N44arlenke       CAT       '.pdf':0      arlenke
N24  c                   call      'ARC99WSD1'
N24  c                   parm                    gobuid           10
N24  c                   parm                    gotmpf100       100
N24  c                   parm                    arlenke          60
N24  c                   parm                    uNewFile         60
N24  c                   parm                    uok               1
N24  C                   endsr
     C*
     C*
     OQ         EADD         Qdata
     OHEADFR    E            NYOPDS
     O                       HEST
N13  OQ         EADD         Qdata
N13  O                       BatDta             200
