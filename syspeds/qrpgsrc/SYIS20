      *
      ***************************************************************
      *** BESTILLING AV RAPPORTER                                 ***
      ***                                                         ***
      *** PROGRAMMERT AV TORE BRÅSTAD, SYSTEMA A/S, JANUAR 1994   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01-99                                ***
      ***************************************************************
      *
     FFIRM      IF   E           K DISK
     FSYIS20D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D*
     D* DS FOR POSISJONERING AV CURSOR
     D*
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     C*
     C                   READ      FIRM                                   50
     C*
     C     START         TAG
     C*
     C                   EXFMT     BILDE01
     C                   SETOFF                                       303132
     C                   SETOFF                                       33
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C     *IN03         IFEQ      '1'
     C                   GOTO      SLUTT
     C                   END
     C*
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C*
     C                   IF        WSOPG <> 0
     C                   MOVE      '1'           UFLG
     C                   MOVE      WSOPG         UOPG
     C                   EXSR      SNDJOB
     C                   END
     C*
     C                   IF        WSTRA <> 0
     C                   MOVE      '2'           UFLG
     C                   MOVE      WSTRA         UTRF
     C                   EXSR      SNDJOB
     C                   END
     C*
     C     WSOPT         IFNE      *BLANKS
     C                   MOVE      '3'           UFLG
     C                   MOVE      WSOPT         UOPT
     C                   EXSR      SNDJOB
     C                   END
     C*
     C     WSUNI         IFNE      *BLANKS
     C                   MOVE      '4'           UFLG
     C                   MOVEL     WSUNI         UUNT
     C                   EXSR      SNDJOB
     C                   END
      *
     C     WSSAKN        IFNE      0
     C                   MOVE      '5'           UFLG
     C                   MOVEL     WSSAKN        USAKN
     C                   EXSR      SNDJOB
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     36
     C                   MOVE      *BLANKS       USSOKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    SSOPG             8 0
     C                   PARM                    FIFIRM
     C                   PARM                    USSOKN           30
     C                   MOVE      *ZEROS        WSOPG
     C                   MOVE      *ZEROS        WSTRA
     C                   MOVE      *BLANKS       WSOPT
     C                   MOVE      *BLANKS       WSUNI
     C                   MOVEL     SSOPG         WSOPG
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     36
     C                   CALL      'SYTR04A'
     C                   PARM                    UTRANS            8 0
     C                   MOVE      *ZEROS        WSOPG
     C                   MOVE      *ZEROS        WSTRA
     C                   MOVE      *BLANKS       WSOPT
     C                   MOVE      *BLANKS       WSUNI
     C                   MOVEL     UTRANS        WSTRA
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     30
     C                   CALL      'SYFI10C'
     C                   PARM                    UOTYK             2
     C                   MOVE      *ZEROS        WSOPG
     C                   MOVE      *ZEROS        WSTRA
     C                   MOVE      *BLANKS       WSOPT
     C                   MOVE      *BLANKS       WSUNI
     C                   MOVE      UOTYK         WSOPT
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     32
     C                   CALL      'SYIS14'
     C                   PARM                    UUNI              4
     C                   MOVE      *ZEROS        WSOPG
     C                   MOVE      *ZEROS        WSTRA
     C                   MOVE      *BLANKS       WSOPT
     C                   MOVE      *BLANKS       WSUNI
     C                   MOVE      UUNI          WSUNI
     C                   GOTO      SLSØK
     C                   END
     C*
     C     SLSØK         ENDSR
     C*
     C***************************************************************
     C*
     C     SNDJOB        BEGSR
     C*
     C     WSOPG         IFEQ      0
     C     WSTRA         ANDEQ     0
     C     WSOPT         ANDEQ     *BLANKS
     C     WSUNI         ANDEQ     *BLANKS
     C     WSSAKN        ANDEQ     0
     C                   MOVE      'TBR0181'     MSGNR
     C                   SETON                                        3031
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   GOTO      START
     C                   END
     C*
     C     WSFDAT        IFEQ      *ZEROS
     C     WSSAKN        ANDEQ     0
     C                   MOVE      'TBR0182'     MSGNR
     C                   SETON                                        3032
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     24            POSNBR
     C                   GOTO      START
     C                   END
     C*
     C     WSTDAT        IFEQ      *ZEROS
     C     WSSAKN        ANDEQ     0
     C                   MOVE      'TBR0182'     MSGNR
     C                   SETON                                        3033
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     48            POSNBR
     C                   GOTO      START
     C                   END
     C*
     C                   MOVE      WSFDAT        UFDAT
     C                   MOVE      WSTDAT        UTDAT
     C                   CALL      'SYIS31'
     C                   PARM                    UOPG              8
     C                   PARM                    UTRF              8
     C                   PARM                    UOPT              2
     C                   PARM                    UUNT              4
     C                   PARM                    UFDAT             6
     C                   PARM                    UTDAT             6
     C                   PARM                    UFLG              1
     C                   PARM                    USAKN             7
     C*
     C                   ENDSR
