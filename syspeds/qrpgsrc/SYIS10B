      *
      ***************************************************************
      *** VEDLIKEHOLD AV AVVIKSREGISTER                           ***
      ***                                                         ***
      *** PROGRAMMERT AV TORE BRÅSTAD, SYSTEMA A/S, JANUAR 1994   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      ***************************************************************
      *
     FTELLGE    UF A E           K DISK
     FISOFL1    UF A E           K DISK
     FISOFL8    UF   E           K DISK    RENAME(ISOFR:ISOFR08)
     FISOLFL1   UF   E           K DISK
     FISOSAKF   UF A E           K DISK
     FKODTFT    IF   E           K DISK
     FHEADF     IF   E           K DISK
     FTURER14   IF   E           K DISK
     FDISP      IF   E           K DISK
     FUNITL01   IF   E           K DISK
     FISOKDA    IF   E           K DISK
     FISOKDT    IF   E           K DISK
     FISOKDP    IF   E           K DISK
     FISOKDR    IF   E           K DISK
     FISOKDS    IF   E           K DISK
     FISOFWRK   O  A E           K DISK    USROPN
     FBRPARF    IF   E           K DISK
     FSYIS10BD  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
      *
      * DS FOR POSISJONERING AV CURSOR
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *
      * DS FOR DATOFORMATERING
      *
     D                 DS
     D  ISFADA                 1      8  0
     D  ISADAÅ                 1      4  0
     D  ISADAM                 5      6  0
     D  ISADAD                 7      8  0
     D                 DS
     D  WSSADA                 1      6  0
     D  WSADAD                 1      2  0
     D  WSADAM                 3      4  0
     D  WSADAÅ                 5      6  0
     D                 DS
     D  ISFAND                 1      8  0
     D  ISANDÅ                 1      4  0
     D  ISANDM                 5      6  0
     D  ISANDD                 7      8  0
     D                 DS
     D  WSSAND                 1      6  0
     D  WSANDD                 1      2  0
     D  WSANDM                 3      4  0
     D  WSANDÅ                 5      6  0
     D                 DS
     D  ISFMDA                 1      8  0
     D  ISMDAÅ                 1      4  0
     D  ISMDAM                 5      6  0
     D  ISMDAD                 7      8  0
     D                 DS
     D  WSSMDA                 1      6  0
     D  WSMDAD                 1      2  0
     D  WSMDAM                 3      4  0
     D  WSMDAÅ                 5      6  0
     D                 DS
     D  ISFLDA                 1      8  0
     D  ISLDAÅ                 1      4  0
     D  ISLDAM                 5      6  0
     D  ISLDAD                 7      8  0
     D                 DS
     D  WSSLDA                 1      6  0
     D  WSLDAD                 1      2  0
     D  WSLDAM                 3      4  0
     D  WSLDAÅ                 5      6  0
     D                 DS
     D  ISFGDA                 1      8  0
     D  ISGDAÅ                 1      4  0
     D  ISGDAM                 5      6  0
     D  ISGDAD                 7      8  0
     D                 DS
     D  WSSGDA                 1      6  0
     D  WSGDAD                 1      2  0
     D  WSGDAM                 3      4  0
     D  WSGDAÅ                 5      6  0
     D                 DS
     D  ISFRDA                 1      8  0
     D  ISRDAÅ                 1      4  0
     D  ISRDAM                 5      6  0
     D  ISRDAD                 7      8  0
     D                 DS
     D  WSSRDA                 1      6  0
     D  WSRDAD                 1      2  0
     D  WSRDAM                 3      4  0
     D  WSRDAÅ                 5      6  0
     D                 DS
     D  ISFFDA                 1      8  0
     D  ISFDAÅ                 1      4  0
     D  ISFDAM                 5      6  0
     D  ISFDAD                 7      8  0
     D                 DS
     D  WSSFDA                 1      6  0
     D  WSFDAD                 1      2  0
     D  WSFDAM                 3      4  0
     D  WSFDAÅ                 5      6  0
     D                 DS
     D  ISFSDA                 1      8  0
     D  ISSDAÅ                 1      4  0
     D  ISSDAM                 5      6  0
     D  ISSDAD                 7      8  0
     D                 DS
     D  WSSSDA                 1      6  0
     D  WSSDAD                 1      2  0
     D  WSSDAM                 3      4  0
     D  WSSDAÅ                 5      6  0
     D                 DS
     D  ISFUDA                 1      8  0
     D  ISUDAÅ                 1      4  0
     D  ISUDAM                 5      6  0
     D  ISUDAD                 7      8  0
     D                 DS
     D  WSSUDA                 1      6  0
     D  WSUDAD                 1      2  0
     D  WSUDAM                 3      4  0
     D  WSUDAÅ                 5      6  0
     D                 DS
     D  ISSDA                  1      8  0
     D  ISDAÅ                  1      4  0
     D  ISDAM                  5      6  0
     D  ISDAD                  7      8  0
     D                 DS
     D  WDATO1                 1      6  0
     D  W1DAD                  1      2  0
     D  W1DAM                  3      4  0
     D  W1DAÅ                  5      6  0
     D                 DS
     D  WDATO2                 1      6  0
     D  W2DAD                  1      2  0
     D  W2DAM                  3      4  0
     D  W2DAÅ                  5      6  0
     D                 DS
     D  WDATO3                 1      6  0
     D  W3DAD                  1      2  0
     D  W3DAM                  3      4  0
     D  W3DAÅ                  5      6  0
     D                 DS
     D  WDATO4                 1      6  0
     D  W4DAD                  1      2  0
     D  W4DAM                  3      4  0
     D  W4DAÅ                  5      6  0
     D                 DS
     D  WDATO5                 1      6  0
     D  W5DAD                  1      2  0
     D  W5DAM                  3      4  0
     D  W5DAÅ                  5      6  0
     D                 DS
     D  WDATO6                 1      6  0
     D  W6DAD                  1      2  0
     D  W6DAM                  3      4  0
     D  W6DAÅ                  5      6  0
     D                SDS
     D  UUSER                254    263
      *
     C                   EXSR      INIT
      *
      * NY POST
      *
     C     START1        TAG
     C     TEST          IFEQ      '1'
     C                   IF        UTNO = 0
     C                   EXSR      SRHENT
     C                   ELSE
     C                   EXSR      SRHENT2
     C                   END
     C                   ENDIF                                                  <TEST=1
     C                   IF        WSSST = ' '
     C                   EVAL      WSSST = '1'
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     11            POSNBR
      *
     C     START2        TAG
     C     TEST          IFEQ      '1'
     C                   MOVE      *OFF          *IN51
     C                   EXFMT     BILDE01
     C                   SETOFF                                       30
     C                   MOVEA     '000'         *IN(70)
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDTA
     C                   GOTO      START2
     C                   ENDIF                                                  <*IN04
     C     *IN12         IFEQ      '1'
     C                   MOVE      '12'          UFLAGG
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN12
     C                   EXSR      SØKPAR
     C   30              GOTO      START2
     C                   EXSR      SØKART
     C   30              GOTO      START2
     C                   EXSR      SØKANS
     C   30              GOTO      START2
     C                   EXSR      SØKRTY
     C   30              GOTO      START2
     C                   EXSR      SØKFRI
     C   30              GOTO      START2
     C                   EXSR      TSTUSR
     C   30              GOTO      START2
      * ISO-MODUL ER BETALBART PRODUKT - HAR DE LISSENS??
     C     MODOK         IFNE      'J'
     C                   MOVEL     'SYISO   '    UMODUL           15
     C                   MOVE      '       '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      START2
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
      * AVSLUTT
     C     *IN03         IFEQ      '1'
     C                   MOVE      '03'          UFLAGG
     C                   EXSR      MOVWSD
     C                   EXSR      NYPOST
     C                   WRITE     ISOFR
     C                   EXSR      ISOSAK
     C                   MOVE      ISSAKN        USAKSNR
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN03
      * AVSLUTT MED UTSKRIFT
     C     *IN06         IFEQ      '1'
     C                   MOVE      '03'          UFLAGG
     C                   EXSR      MOVWSD
     C                   CALL      'SYIS10BC'
     C                   OPEN      ISOFWRK
     C                   WRITE     ISFWRK
     C                   CLOSE     ISOFWRK
     C                   MOVE      ISFAVD        WSAVD             4
     C                   MOVE      ISFOPD        WSOPD             7
     C                   MOVE      ISFLOP        WSLOP             3
     C                   MOVE      ISSAKN        WSSAKN            7
     C                   CALL      'SYIS30'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSLOP
     C                   PARM                    WSSAKN
     C                   PARM                    UFLG
     C     UFLG          IFEQ      '07'
     C                   MOVE      '  '          UFLG
     C                   GOTO      START2
     C                   ENDIF                                                  <UFLG
     C                   EXSR      NYPOST
     C                   WRITE     ISOFR
     C                   EXSR      ISOSAK
     C                   MOVE      ISSAKN        USAKSNR
     C                   IF        *IN07
     C                   MOVE      'CRT'         UTYPE             3
     C                   CALL      'SYIS10D'
     C                   PARM                    USAKSNR
     C                   PARM                    UTYPE
     C                   END
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN06
      * AVBRYT
     C     *IN12         IFEQ      '1'
     C                   MOVE      '12'          UFLAGG
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN12
     C                   GOTO      START2
     C                   ENDIF                                                  <TEST=1
      *
      * ENDRE POST
      *
     C     TEST          IFEQ      '2'
     C                   IF        USAKSNR = 0
     C     ISOKY2        CHAIN     ISOFR                              35
     C                   ELSE
     C     USAKSNR       CHAIN     ISOFL8                             35
     C                   END
     C                   EXSR      HEDFIL
     C     WSSBIL        IFEQ      *BLANKS
     C                   EXSR      TURFIL
     C                   END
     C     WSSUNT        IFEQ      *BLANKS
     C                   EXSR      UNIFIL
     C                   END
     C                   EXSR      MOVDWS
     C                   EXSR      SØKPAR
     C                   EXSR      SØKART
     C                   EXSR      SØKANS
     C                   EXSR      SØKRTY
     C                   EXSR      SØKFRI
     C                   END                                                    <TEST=2
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     11            POSNBR
     C     START3        TAG
     C     TEST          IFEQ      '2'
     C                   MOVE      *OFF          *IN51
     C                   EXFMT     BILDE01
     C                   SETOFF                                       30
     C                   MOVEA     '000'         *IN(70)
      * SØK KODER
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDTA
     C                   GOTO      START3
     C                   END                                                    <*IN04
      * AVBRYT
     C     *IN12         IFEQ      '1'
     C                   MOVE      '12'          UFLAGG
     C                   IF        USAKSNR = 0
     C                   UPDATE    ISOFR
     C                   ELSE
     C                   UPDATE    ISOFR08
     C                   END
     C                   GOTO      SLUTT
     C                   END                                                    <*IN12
      *
     C                   EXSR      SØKPAR
     C   30              GOTO      START3
     C                   EXSR      SØKART
     C   30              GOTO      START3
     C                   EXSR      SØKANS
     C   30              GOTO      START3
     C                   EXSR      SØKRTY
     C   30              GOTO      START3
     C                   EXSR      SØKFRI
     C   30              GOTO      START3
     C                   EXSR      TSTUSR
     C   30              GOTO      START3
     C     WSSBIL        IFEQ      *BLANKS
     C                   EXSR      TURFIL
     C                   END
     C     WSSUNT        IFEQ      *BLANKS
     C                   EXSR      UNIFIL
     C                   END
      * AVSLUTT
     C     *IN03         IFEQ      '1'
     C                   MOVE      '03'          UFLAGG
     C                   EXSR      MOVWSD
     C                   IF        USAKSNR = 0
     C                   UPDATE    ISOFR
     C                   ELSE
     C                   UPDATE    ISOFR08
     C                   END
     C                   EXSR      ISOSAK
     C                   GOTO      SLUTT
     C                   END                                                    <*IN03
      * AVSLUTT MED UTSKRIFT
     C     *IN06         IFEQ      '1'
     C                   MOVE      '03'          UFLAGG
     C                   EXSR      MOVWSD
     C                   CALL      'SYIS10BC'
     C                   OPEN      ISOFWRK
     C                   WRITE     ISFWRK
     C                   CLOSE     ISOFWRK
     C                   MOVE      ISFAVD        WSAVD
     C                   MOVE      ISFOPD        WSOPD
     C                   MOVE      ISFLOP        WSLOP
     C                   MOVE      ISSAKN        WSSAKN
     C                   CALL      'SYIS30'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSLOP
     C                   PARM                    WSSAKN
     C                   PARM                    UFLG
     C     UFLG          IFEQ      '07'
     C                   MOVE      '  '          UFLG
     C                   GOTO      START3
     C                   END                                                    <UFLG
     C                   IF        USAKSNR = 0
     C                   UPDATE    ISOFR
     C                   ELSE
     C                   UPDATE    ISOFR08
     C                   END
     C                   EXSR      ISOSAK
     C                   GOTO      SLUTT
     C                   END                                                    <*IN06
      * TILLEGGS INFO
     C                   IF        *IN07
     C                   MOVE      'CHG'         UTYPE             3
     C                   CALL      'SYIS10D'
     C                   PARM                    USAKSNR
     C                   PARM                    UTYPE
     C                   GOTO      START3
     C                   END
      * VIS SAKSGANG
     C     *IN08         IFEQ      '1'
     C                   EXSR      SAKGNG
     C                   GOTO      START3
     C                   ENDIF                                                  <*IN08
      * FERDIGMELDE
     C     *IN10         IFEQ      '1'
     C                   EXSR      FERDIM
     C   03              GOTO      SLUTT
     C                   GOTO      START3
     C                   ENDIF                                                  <*IN08
      *
     C                   GOTO      START3
     C                   END                                                    <TEST=2
      *
      * SLETTE POST
      *
     C     TEST          IFEQ      '4'
     C                   SETON                                        80
     C                   IF        USAKSNR = 0
     C     ISOKY2        CHAIN     ISOFR                              35
     C                   ELSE
     C     USAKSNR       CHAIN     ISOFL8                             35
     C                   END
     C                   EXSR      HEDFIL
     C                   EXSR      MOVDWS
     C                   EXSR      HNTDAT
     C                   MOVE      *ON           *IN51
     C                   EXFMT     BILDE01
     C                   SETOFF                                       80
      * AVSLUTT UTEN SLETTING
     C     *IN03         IFEQ      '1'
     C                   UPDATE    ISOFR
     C                   MOVE      '05'          UFLAGG
     C                   GOTO      SLUTT
     C                   END                                                    <*IN03
      * AVSLUTT UTEN SLETTING
     C     *IN12         IFEQ      '1'
     C                   UPDATE    ISOFR
     C                   MOVE      '12'          UFLAGG
     C                   GOTO      SLUTT
     C                   END                                                    <*IN12
      * BEKREFTE PÅ SLETTING
     C     *IN23         IFEQ      '1'
     C                   IF        USAKSNR = 0
     C                   DELETE    ISOFR
     C                   ELSE
     C                   MOVE      'S'           ISST
     C                   MOVE      'J'           ISSLUT
     C                   UPDATE    ISOFR08
     C                   END
     C                   EXSR      ISOSAK
     C     ISSAKN        SETLL     ISOLFL1
     C     ISSAKN        READE     ISOLFL1                                33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    ISOLFR
     C     ISSAKN        READE     ISOLFL1                                33
     C                   ENDDO
     C                   GOTO      SLUTT
     C                   END                                                    <*IN23
     C                   END                                                    <TEST=4
      *
      * VISE POST
      *
     C     START5        TAG
     C     TEST          IFEQ      '5'
     C                   IF        USAKSNR = 0
     C     ISOKY2        CHAIN(N)  ISOFR                              35
     C                   ELSE
     C     USAKSNR       CHAIN(N)  ISOFL8                             35
     C                   END
     C                   EXSR      HEDFIL
     C                   EXSR      MOVDWS
     C                   EXSR      HNTDAT
     C                   MOVE      *ON           *IN51
     C                   EXFMT     BILDE01
      * AVSLUTT
     C     *IN03         IFEQ      '1'
     C                   MOVE      '05'          UFLAGG
     C                   GOTO      SLUTT
     C                   END                                                    <*IN03
      * AVSLUTT MED UTSKRIFT
     C     *IN06         IFEQ      '1'
     C                   CALL      'SYIS10BC'
     C                   OPEN      ISOFWRK
     C                   WRITE     ISFWRK
     C                   CLOSE     ISOFWRK
     C                   MOVE      ISFAVD        WSAVD
     C                   MOVE      ISFOPD        WSOPD
     C                   MOVE      ISFLOP        WSLOP
     C                   MOVE      ISSAKN        WSSAKN
     C                   CALL      'SYIS30'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSLOP
     C                   PARM                    WSSAKN
     C                   PARM                    UFLG
     C     UFLG          IFEQ      '07'
     C                   MOVE      '  '          UFLG
     C                   GOTO      START5
     C                   END                                                    <UFLG
     C                   MOVE      '05'          UFLAGG
     C                   GOTO      SLUTT
     C                   END                                                    <*IN06
      * TILLEGGS INFO
     C                   IF        *IN07
     C                   MOVE      'DSP'         UTYPE             3
     C                   CALL      'SYIS10D'
     C                   PARM                    USAKSNR
     C                   PARM                    UTYPE
     C                   GOTO      START5
     C                   END
      * AVBRYT
     C     *IN12         IFEQ      '1'
     C                   MOVE      '12'          UFLAGG
     C                   GOTO      SLUTT
     C                   END                                                    <*IN12
     C                   END                                                    <TEST=5
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     ISOSAK        BEGSR
      ***********************************************
      * SLETT SAKSGANG VED SLETTING AV EN ISO-POST
     C                   Z-ADD     ISFLOP        WSSLOP
     C                   MOVE      *ZEROS        WSSNR             2 0
     C     SAKKEY        SETLL     ISOSAKF
     C     ISOST1        TAG
     C     SAKKEE        READE     ISOSAKF                                81
     C     *IN81         IFEQ      *OFF
     C     TEST          IFEQ      '4'
     C                   DELETE    ISOSAKFR
     C                   ENDIF                                                  <TEST=4
     C                   GOTO      ISOST1
     C                   ELSE
     C                   ADD       1             ISSNR
     C                   ENDIF                                                  <*IN81
     C                   Z-ADD     ISFAVD        ISAVD
     C                   Z-ADD     ISFOPD        ISOPD
     C                   Z-ADD     ISFLOP        ISLOP
     C     TEST          IFEQ      '1'
     C                   Z-ADD     ISFRDA        ISSDA
     C                   MOVEL     ISFRSI        ISSSI
     C                   WRITE     ISOSAKFR
     C                   ENDIF                                                  <TEST=1
      * VED ENDRING LEGGES DET UT SIGNATUR/DATO I LOGGEN HVIS DET ER EN ANNEN
      * SIGNATUR ENN SISTE BRUKTE.
     C     TEST          IFEQ      '2'
     C     ISFSSI        IFNE      ISSSI
     C                   Z-ADD     ISFSDA        ISSDA
     C                   MOVEL     ISFSSI        ISSSI
     C                   WRITE     ISOSAKFR
     C                   ENDIF                                                  <ISFSSI
     C                   ENDIF                                                  <TEST=2
     C                   ENDSR
      *
      ***********************************************
     C     SAKGNG        BEGSR
      ***********************************************
      * VIS SAKSGANG. MAX 6.
     C                   CLEAR                   VINDU1
     C                   MOVE      *ZEROS        ANTSUB            2 0
     C                   MOVE      *ZEROS        ANTSID            2 0
     C                   MOVE      *ZEROS        WSSNRF            2 0
     C                   MOVE      *ZEROS        WSSNR             2 0
     C     SAKST1        TAG
     C     SAKKEY        SETLL     ISOSAKF
     C                   MOVEA     '111111'      *IN(81)
     C                   MOVE      ' '           WPLUSS
      *
     C     SAKKEE        READE     ISOSAKF                                81
     C     *IN81         IFEQ      *OFF
     C                   Z-ADD     ISSNR         WSSNR
     C                   MOVE      ISDAD         W1DAD
     C                   MOVE      ISDAM         W1DAM
     C                   MOVE      ISDAÅ         W1DAÅ
     C                   MOVEL     ISSSI         WSIGN1
     C                   ADD       1             ANTSUB
     C                   ADD       1             ANTSID
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN81
      *
     C     SAKKEE        READE     ISOSAKF                                82
     C     *IN82         IFEQ      *OFF
     C                   MOVE      ISDAD         W2DAD
     C                   MOVE      ISDAM         W2DAM
     C                   MOVE      ISDAÅ         W2DAÅ
     C                   MOVEL     ISSSI         WSIGN2
     C                   ADD       1             ANTSUB
     C                   ADD       1             ANTSID
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN82
      *
     C     SAKKEE        READE     ISOSAKF                                83
     C     *IN83         IFEQ      *OFF
     C                   MOVE      ISDAD         W3DAD
     C                   MOVE      ISDAM         W3DAM
     C                   MOVE      ISDAÅ         W3DAÅ
     C                   MOVEL     ISSSI         WSIGN3
     C                   ADD       1             ANTSUB
     C                   ADD       1             ANTSID
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN83
      *
     C     SAKKEE        READE     ISOSAKF                                84
     C     *IN84         IFEQ      *OFF
     C                   MOVE      ISDAD         W4DAD
     C                   MOVE      ISDAM         W4DAM
     C                   MOVE      ISDAÅ         W4DAÅ
     C                   MOVEL     ISSSI         WSIGN4
     C                   ADD       1             ANTSUB
     C                   ADD       1             ANTSID
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN84
      *
     C     SAKKEE        READE     ISOSAKF                                85
     C     *IN85         IFEQ      *OFF
     C                   MOVE      ISDAD         W5DAD
     C                   MOVE      ISDAM         W5DAM
     C                   MOVE      ISDAÅ         W5DAÅ
     C                   MOVEL     ISSSI         WSIGN5
     C                   ADD       1             ANTSUB
     C                   ADD       1             ANTSID
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN85
      *
     C     SAKKEE        READE     ISOSAKF                                86
     C     *IN86         IFEQ      *OFF
     C                   MOVE      ISDAD         W6DAD
     C                   MOVE      ISDAM         W6DAM
     C                   MOVE      ISDAÅ         W6DAÅ
     C                   MOVEL     ISSSI         WSIGN6
     C                   ADD       1             ANTSUB
     C                   ADD       1             ANTSID
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN86
      *
     C     SAKKEE        READE     ISOSAKF                                87
     C     *IN87         IFEQ      *OFF
     C                   MOVE      '+'           WPLUSS
     C                   Z-ADD     ISSNR         WSSNR
     C     SAKKEE        READPE    ISOSAKF                                87
     C                   GOTO      SAKVIN
     C                   ELSE
     C                   MOVE      ' '           WPLUSS
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <*IN87
      *
     C     SAKVIN        TAG
     C                   EXFMT     VINDU1
      *
     C     *IN25         IFEQ      *ON
     C     WPLUSS        IFEQ      '+'
     C                   MOVE      *ZEROS        ANTSID
     C                   GOTO      SAKST1
     C                   ELSE
     C                   GOTO      SAKVIN
     C                   ENDIF                                                  <WPLUSS
     C                   ENDIF                                                  <*IN25
      *
     C     *IN26         IFEQ      *ON
     C     ANTSUB        IFLE      6
     C                   GOTO      SAKVIN
     C                   ELSE
     C     ANTSID        IFLT      6
     C     WSSNR         SUB       6             WSSNR
     C                   ELSE
     C     WSSNR         SUB       12            WSSNR
     C                   ENDIF                                                  <ANTSID
     C                   MOVE      *ZEROS        ANTSID
     C                   GOTO      SAKST1
     C                   ENDIF                                                  <ANTSUB
     C                   ENDIF                                                  <*IN26
      *
     C                   ENDSR
      *
      ***********************************************
     C     FERDIM        BEGSR
      ***********************************************
     C                   IF        ((WSSFSI = *BLANKS) AND (WSSKOS = 0))
     C                   EVAL      XBEKR = 'N'
     C                   EXFMT     BEKREFT
     C                   IF        XBEKR = 'J'
     C                   GOTO      STFM
     C                   ELSE
     C                   GOTO      SLFM
     C                   END
     C                   END
      *
     C     STFM          TAG
     C                   EXSR      MOVWSD
     C                   IF        USAKSNR = 0
     C                   UPDATE    ISOFR
     C                   EVAL      USAKSNR = ISSAKN
     C                   ELSE
     C                   UPDATE    ISOFR08
     C                   END
     C                   EXSR      ISOSAK
     C     USAKSNR       CHAIN     ISOFL8                             35
     C                   MOVE      'F'           ISST
     C                   MOVE      'J'           ISSLUT
     C                   UPDATE    ISOFR08
     C                   MOVE      '1'           *IN03
      *
     C     SLFM          ENDSR
      *
      ***********************************************
     C     SRHENT        BEGSR
      ***********************************************
      *
     C     DISKEY        CHAIN     DISPR                              31
     C     *IN31         IFEQ      '0'
     C                   Z-ADD     DITUAV        ISFTUA
     C                   Z-ADD     DITUR         WSSTUN
     C                   MOVEL     DISONF        ISFFLA
     C                   MOVEL     DISONT        ISFTLA
     C                   END
      *
     C                   EXSR      HEDFIL
      * endringer og flytting av linjer  start
     C     HEUR          IFEQ      'H'
     C                   MOVE      TRSDFD        ISFADA
     C                   MOVE      TRSDTD        ISFAND
     C                   MOVE      TRSDFK        WSSADK
     C                   MOVE      TRSDTK        WSSANK
     C                   ELSE
     C                   MOVE      HEDTOP        ISFADA
     C                   MOVE      HEDTOP        ISFAND
     C                   END
     C                   MOVE      ISADAD        WSADAD
     C                   MOVE      ISADAM        WSADAM
     C                   MOVE      ISADAÅ        WSADAÅ
      *
     C                   MOVE      ISANDD        WSANDD
     C                   MOVE      ISANDM        WSANDM
     C                   MOVE      ISANDÅ        WSANDÅ
      *
      * endringer og flytting av linjer  slutt
     C                   EXSR      TURFIL
      *
     C                   EXSR      UNIFIL
      *
     C                   MOVE      UDAY          WSRDAD
     C                   MOVE      UMONTH        WSRDAM
     C                   MOVE      UYEAR         WSRDAÅ
     C                   MOVE      WSSRDA        WSSSDA
     C                   MOVEL     UUSER         WSSRSI
     C                   MOVEL     UUSER         WSSSSI
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRHENT2       BEGSR
      ***********************************************
      *
     C     UTNO          CHAIN     TURER14                            31
     C                   Z-ADD     TUAVD         ISFTUA
     C                   Z-ADD     TUPRO         WSSTUN
     C                   MOVEL     TULK          ISFFLA
     C                   MOVEL     TUSONT        ISFTLA
      *
     C                   MOVE      TUDT          ISFADA
     C                   MOVE      TUDTT         ISFAND
     C                   MOVEL     TUTM          WSSADK
     C                   MOVEL     TUTMT         WSSANK
     C                   MOVE      ISADAD        WSADAD
     C                   MOVE      ISADAM        WSADAM
     C                   MOVE      ISADAÅ        WSADAÅ
      *
     C                   MOVE      ISANDD        WSANDD
     C                   MOVE      ISANDM        WSANDM
     C                   MOVE      ISANDÅ        WSANDÅ
      *
     C                   Z-ADD     TUKNT         WSSTRF
     C                   MOVEL     TUBILN        WSSBIL
     C                   Z-ADD     TUKNT2        WSSTRF
     C                   MOVEL     TUBILN        WSSBIL
     C                   MOVEL     TUHENG        WSSHEN
     C                   Z-ADD     TUSJA1        WSSS1N
     C                   MOVEL     TUSJN1        WSSS1T
     C                   Z-ADD     TUSJA2        WSSS2N
     C                   MOVEL     TUSJN2        WSSS2T
      *
     C                   EXSR      UNIFIL
      *
     C                   MOVE      UDAY          WSRDAD
     C                   MOVE      UMONTH        WSRDAM
     C                   MOVE      UYEAR         WSRDAÅ
     C                   MOVE      WSSRDA        WSSSDA
     C                   MOVEL     UUSER         WSSRSI
     C                   MOVEL     UUSER         WSSSSI
      *
     C                   ENDSR
      *
      ***********************************************
     C     HEDFIL        BEGSR
      ***********************************************
      *
     C                   MOVEA     '00000000'    *IN(61)
     C     HEDKEY        CHAIN     HEADFR                             33
     C     *IN33         IFEQ      '0'
     C     HEUR          COMP      'A'                                    61    LAND IMPORT
     C                   Z-ADD     HEPRO         WSSTUN
     C   61              Z-ADD     HEKNT         WSSTRF
     C   61              MOVEL     HEHAWB        WSSBIL
     C     HEUR          COMP      'B'                                    62    LAND EKSPORT
     C     HEUR          COMP      'C'                                    63    FLY IMPORT
     C     HEUR          COMP      'D'                                    64    FLY EKSPORT
     C     HEUR          COMP      'E'                                    65    FLY INNLAND
     C     HEUR          COMP      'F'                                    66    SJØ IMPORT
     C     HEUR          COMP      'G'                                    67    SJØ EKSPORT
     C     HEUR          COMP      'H'                                    68    TRANSPORTMOD
     C   68              MOVE      TRKNFA        WSSOPG
     C                   END
     C                   Z-ADD     HEKNS         WSSAVS
     C                   MOVEL     HENAS         WSSATT
     C                   Z-ADD     HEKNK         WSSMOT
     C                   MOVEL     HENAK         WSSMTT
     C                   MOVEL     HEOT          WSSOPT
      *
     C                   ENDSR
      *
      ***********************************************
     C     TURFIL        BEGSR
      ***********************************************
      *
     C     WSSTUN        IFNE      *ZEROS
     C     WSSTUN        CHAIN     TURERR                             33
     C     *IN33         IFEQ      *OFF
     C     HEUR          IFEQ      'B'
     C                   Z-ADD     TUKNT         WSSTRF
     C                   MOVEL     TUBILN        WSSBIL
     C                   ENDIF                                                  <HEUR=B
     C     HEUR          IFEQ      'H'
     C                   Z-ADD     TUKNT2        WSSTRF
     C                   MOVEL     TUBILN        WSSBIL
     C                   MOVEL     TUHENG        WSSHEN
     C                   Z-ADD     TUSJA1        WSSS1N
     C                   MOVEL     TUSJN1        WSSS1T
     C                   Z-ADD     TUSJA2        WSSS2N
     C                   MOVEL     TUSJN2        WSSS2T
     C                   ENDIF                                                  <HEUR=H
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     UNIFIL        BEGSR
      ***********************************************
      *
     C     WSSBIL        CHAIN     UNITR                              33
     C  N33              MOVEL     UNUNTY        WSSUNT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKPAR        BEGSR
      ***********************************************
      * TEST STATUS
     C     WSSST         CHAIN     ISKDSR                             70
     C                   IF        *IN70
     C                   MOVE      'YBC1931'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     78            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLSPAR
     C                   END
      *
     C     WSSPFO        IFEQ      *BLANKS
     C*                  MOVE      *BLANKS       WSSPFT
     C*                  MOVEL     'EGEN'        WSSPFT
     C                   ELSE
     C     WSSPFO        CHAIN     ISKDTR                             70
     C     *IN70         IFEQ      '0'
     C*                  MOVE      *BLANKS       WSSPFT
     C*                  MOVEL     TTEXT         WSSPFT
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     54            POSNBR
     C                   ELSE
     C                   MOVE      'TBR0161'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C     SLSPAR        ENDSR
      *
      ***********************************************
     C     HNTDAT        BEGSR
      ***********************************************
      *
     C     WSSPFO        IFEQ      *BLANKS
     C                   ELSE
     C     WSSPFO        CHAIN     ISKDTR                             70
     C     *IN70         IFEQ      '0'
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKART        BEGSR
      ***********************************************
      *
     C     ISOKDAK1      CHAIN     ISKDAR                             71
     C   71ISOKDAK2      CHAIN     ISKDAR                             71
     C     *IN71         IFEQ      '0'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   ELSE
     C                   MOVE      'TBR0162'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     31            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKANS        BEGSR
      ***********************************************
      *
     C     WSSANS        CHAIN     ISKDPR                             72
     C     *IN72         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSANT
     C                   MOVEL     PTEXT         WSSANT
     C     *IN04         IFEQ      *ON
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ELSE
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   ENDIF                                                  <*IN04
     C                   ELSE
     C                   MOVE      'TBR0163'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKRTY        BEGSR
      ***********************************************
      *
     C                   IF        WSSRTY <> *BLANKS
     C     WSSRTY        CHAIN     ISKDRR                             73
     C     *IN73         IFEQ      '0'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     66            POSNBR
     C                   ELSE
     C                   MOVE      'YBC1930'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKFRI        BEGSR
      ***********************************************
      *
     C     WSSFK1        IFNE      *BLANKS
     C                   Z-ADD     1             XLN
     C                   MOVEL     WSSFK1        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFK1
     C                   EVAL      WSSAV1 = KFTFTX
     C                   ADD       1             XLN
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   EVAL      WSSAV2 = KFTFTX
     C                   ADD       1             XLN
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   EVAL      WSSAV3 = KFTFTX
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ENDIF
     C                   ENDIF
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   END
      *
     C     WSSFK2        IFNE      *BLANKS
     C                   Z-ADD     1             XLN
     C                   MOVEL     WSSFK2        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFK2
     C                   EVAL      WSSAV2 = KFTFTX
     C                   ADD       1             XLN
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   EVAL      WSSAV3 = KFTFTX
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ENDIF
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   END
      *
     C     WSSFK3        IFNE      *BLANKS
     C                   Z-ADD     1             XLN
     C                   MOVEL     WSSFK3        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFK2
     C                   EVAL      WSSAV2 = KFTFTX
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   END
      *
      *
     C     WSSFR1        IFNE      *BLANKS
     C                   Z-ADD     1             XLN               1 0
     C                   MOVEL     WSSFR1        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFR1
     C                   MOVE      *BLANKS       WSSKO1
     C                   MOVEL     KFTFTX        WSSKO1
     C                   ADD       1             XLN
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSKO2
     C                   MOVEL     KFTFTX        WSSKO2
     C                   ADD       1             XLN
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSKO3
     C                   MOVEL     KFTFTX        WSSKO3
     C                   ADD       1             XLN
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSKO4
     C                   MOVEL     KFTFTX        WSSKO4
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   END
      *
     C     WSSFR2        IFNE      *BLANKS
     C                   Z-ADD     1             XLN               1 0
     C                   MOVEL     WSSFR2        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFR2
     C                   MOVE      *BLANKS       WSSKO2
     C                   MOVEL     KFTFTX        WSSKO2
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   ENDIF                                                  <WSSFR2
      *
     C     WSSFR3        IFNE      *BLANKS
     C                   Z-ADD     1             XLN
     C                   MOVEL     WSSFR3        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFR3
     C                   MOVE      *BLANKS       WSSKO3
     C                   MOVEL     KFTFTX        WSSKO3
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   ENDIF                                                  <WSSFR3
      *
     C     WSSFR4        IFNE      *BLANKS
     C                   Z-ADD     1             XLN
     C                   MOVEL     WSSFR4        WSKF
     C     KODKEY        CHAIN     KODTFTR                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSSFR4
     C                   MOVE      *BLANKS       WSSKO4
     C                   MOVEL     KFTFTX        WSSKO4
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   ELSE
     C                   MOVE      'TBR0194'     MSGNR
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLFRI
     C                   ENDIF
     C                   ENDIF                                                  <WSSFR4
      *
     C     SLFRI         ENDSR
      *
      ***********************************************
     C     TSTUSR        BEGSR
      ***********************************************
      *
      * TEST BRUKER-ID SOM SAKEN SKAL SENDES
     C                   IF        ((WSUSRS <> *BLANKS) AND (WSUSRS <> WSSSSI))
     C     BRPARFK       CHAIN     BRPARF                             30
     C                   IF        *IN30 = *OFF
     C     PAVRDA        COMP      'J'                                3030
     C   30PAVRDA        COMP      'j'                                3030
     C                   END
     C                   IF        *IN30
     C                   MOVE      'YBC1936'     MSGNR
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     70            POSNBR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVDWS        BEGSR
      ***********************************************
      *
     C                   Z-ADD     ISFLOP        WSSLOP
     C                   IF        ISFTUN <> 0
     C                   Z-ADD     ISFTUN        WSSTUN
     C                   END
     C                   Z-ADD     ISFTRF        WSSTRF
     C                   MOVEL     ISFBIL        WSSBIL
     C                   MOVEL     ISFHEN        WSSHEN
     C                   Z-ADD     ISFS1N        WSSS1N
     C                   MOVEL     ISFS1T        WSSS1T
     C                   Z-ADD     ISFS2N        WSSS2N
     C                   MOVEL     ISFS2T        WSSS2T
     C                   Z-ADD     ISFOPG        WSSOPG
     C                   MOVE      ISADAD        WSADAD                         AVGANGSDATO
     C                   MOVE      ISADAM        WSADAM
     C                   MOVE      ISADAÅ        WSADAÅ
     C                   Z-ADD     ISFADK        WSSADK
     C                   MOVE      ISANDD        WSANDD                         ANKOMSTDATO
     C                   MOVE      ISANDM        WSANDM
     C                   MOVE      ISANDÅ        WSANDÅ
     C                   Z-ADD     ISFANK        WSSANK
     C                   MOVEL     ISFPFO        WSSPFO
     C                   MOVEL     ISFAVA        WSSAVA
     C                   Z-ADD     ISFSKL        WSSSKL
     C                   Z-ADD     ISFSKG        WSSSKG
     C                   Z-ADD     ISFSLM        WSSSLM
     C                   Z-ADD     ISFSM3        WSSSM3
     C                   MOVE      ISMDAD        WSMDAD                         MOTTATT DATO
     C                   MOVE      ISMDAM        WSMDAM
     C                   MOVE      ISMDAÅ        WSMDAÅ
     C                   Z-ADD     ISFMKL        WSSMKL
     C                   MOVE      ISLDAD        WSLDAD                         LEVERT DATO
     C                   MOVE      ISLDAM        WSLDAM
     C                   MOVE      ISLDAÅ        WSLDAÅ
     C                   Z-ADD     ISFLKL        WSSLKL
     C                   MOVEL     ISFAV1        WSSAV1
     C                   MOVEL     ISFAV2        WSSAV2
     C                   MOVEL     ISFAV3        WSSAV3
     C                   MOVEL     ISFANS        WSSANS
     C                   MOVEL     ISFKO1        WSSKO1
     C                   MOVEL     ISFKO2        WSSKO2
     C                   MOVEL     ISFKO3        WSSKO3
     C                   MOVEL     ISFKO4        WSSKO4
     C                   MOVE      ISRDAD        WSRDAD                         REG.DATO
     C                   MOVE      ISRDAM        WSRDAM
     C                   MOVE      ISRDAÅ        WSRDAÅ
     C                   MOVEL     ISFRSI        WSSRSI
     C                   MOVE      ISSDAD        WSSDAD                         SISTE
     C                   MOVE      ISSDAM        WSSDAM                         SAKSBEH.DATO
     C                   MOVE      ISSDAÅ        WSSDAÅ
     C                   MOVEL     ISFSSI        WSSSSI
     C                   MOVE      ISGDAD        WSGDAD                         GODSJ.DATO
     C                   MOVE      ISGDAM        WSGDAM
     C                   MOVE      ISGDAÅ        WSGDAÅ
     C     WSSGDA        COMP      0                                  40
     C                   MOVE      ISFGSI        WSSGSI
     C                   MOVE      ISFDAD        WSFDAD                         1. GJENNOM-
     C                   MOVE      ISFDAM        WSFDAM                         FØRINGSDATO
     C                   MOVE      ISFDAÅ        WSFDAÅ
     C     WSSFDA        COMP      0                                  41
     C                   MOVE      ISFFSI        WSSFSI
     C                   MOVE      ISUDAD        WSUDAD                         GJENNOM-
     C                   MOVE      ISUDAM        WSUDAM                         FØRINGSDATO
     C                   MOVE      ISUDAÅ        WSUDAÅ
     C     WSSUDA        COMP      0                                  42
     C                   MOVE      ISFUSI        WSSUSI
     C                   Z-ADD     ISFKOS        WSSKOS
     C                   MOVEL     ISFOPT        WSSOPT
     C                   MOVEL     ISFUNT        WSSUNT
      *
     C                   MOVE      ISSAKN        WSSSAK
     C                   IF        WSSRSI = *BLANKS
     C                   MOVEL     ISUSRR        WSSRSI
     C                   END
     C                   IF        WSSSSI = *BLANKS
     C                   MOVEL     ISUSRS        WSSSSI
     C                   END
     C                   MOVEL     ISKRAV        WSSKRA
     C                   MOVEL     ISFORV        WSSFOR
     C                   MOVEL     ISINT         WSSINT
     C                   MOVEL     ISRTYP        WSSRTY
     C                   MOVEL     ISFN          WSSFN
     C                   MOVEL     ISKRNO        WSSKRN
     C                   MOVEL     ISST          WSSST
     C                   IF        WSSST = ' '
     C                   EVAL      WSSST = '1'
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWSD        BEGSR
      ***********************************************
     C                   Z-ADD     WSSLOP        ISFLOP
     C                   Z-ADD     WSSTUN        ISFTUN
     C                   Z-ADD     WSSTRF        ISFTRF
     C                   MOVEL     WSSBIL        ISFBIL
     C                   MOVEL     WSSHEN        ISFHEN
     C                   Z-ADD     WSSS1N        ISFS1N
     C                   MOVEL     WSSS1T        ISFS1T
     C                   Z-ADD     WSSS2N        ISFS2N
     C                   MOVEL     WSSS2T        ISFS2T
     C                   Z-ADD     WSSOPG        ISFOPG
     C                   MOVE      WSADAD        ISADAD                         AVGANGSDATO
     C                   MOVE      WSADAM        ISADAM
     C                   SELECT
     C                   WHEN      WSSADA = 0
     C                   MOVE      *ZEROS        ISADAÅ
     C                   WHEN      WSADAÅ > 50
     C     WSADAÅ        ADD       1900          ISADAÅ
     C                   OTHER
     C     WSADAÅ        ADD       2000          ISADAÅ
     C                   ENDSL
     C                   Z-ADD     WSSADK        ISFADK
     C                   MOVE      WSANDD        ISANDD                         ANKOMSTDATO
     C                   MOVE      WSANDM        ISANDM
     C                   SELECT
     C                   WHEN      WSSAND = 0
     C                   MOVE      *ZEROS        ISANDÅ
     C                   WHEN      WSANDÅ > 50
     C     WSANDÅ        ADD       1900          ISANDÅ
     C                   OTHER
     C     WSANDÅ        ADD       2000          ISANDÅ
     C                   ENDSL
     C                   Z-ADD     WSSANK        ISFANK
     C                   MOVEL     WSSPFO        ISFPFO
     C                   MOVEL     WSSAVA        ISFAVA
     C                   Z-ADD     WSSSKL        ISFSKL
     C                   Z-ADD     WSSSKG        ISFSKG
     C                   Z-ADD     WSSSLM        ISFSLM
     C                   Z-ADD     WSSSM3        ISFSM3
     C                   MOVE      WSMDAD        ISMDAD                         MOTTATT DATO
     C                   MOVE      WSMDAM        ISMDAM
     C                   SELECT
     C                   WHEN      WSSMDA = 0
     C                   MOVE      *ZEROS        ISMDAÅ
     C                   WHEN      WSMDAÅ > 50
     C     WSMDAÅ        ADD       1900          ISMDAÅ
     C                   OTHER
     C     WSMDAÅ        ADD       2000          ISMDAÅ
     C                   ENDSL
     C                   Z-ADD     WSSMKL        ISFMKL
     C                   MOVE      WSLDAD        ISLDAD                         LEVERT DATO
     C                   MOVE      WSLDAM        ISLDAM
     C                   SELECT
     C                   WHEN      WSSLDA = 0
     C                   MOVE      *ZEROS        ISLDAÅ
     C                   WHEN      WSLDAÅ > 50
     C     WSLDAÅ        ADD       1900          ISLDAÅ
     C                   OTHER
     C     WSLDAÅ        ADD       2000          ISLDAÅ
     C                   ENDSL
     C                   Z-ADD     WSSLKL        ISFLKL
     C                   MOVEL     WSSAV1        ISFAV1
     C                   MOVEL     WSSAV2        ISFAV2
     C                   MOVEL     WSSAV3        ISFAV3
     C                   MOVEL     WSSANS        ISFANS
     C                   MOVEL     WSSKO1        ISFKO1
     C                   MOVEL     WSSKO2        ISFKO2
     C                   MOVEL     WSSKO3        ISFKO3
     C                   MOVEL     WSSKO4        ISFKO4
     C                   MOVE      WSRDAD        ISRDAD                         REG.DATO
     C                   MOVE      WSRDAM        ISRDAM
     C                   SELECT
     C                   WHEN      WSSRDA = 0
     C                   MOVE      *ZEROS        ISRDAÅ
     C                   WHEN      WSRDAÅ > 50
     C     WSRDAÅ        ADD       1900          ISRDAÅ
     C                   OTHER
     C     WSRDAÅ        ADD       2000          ISRDAÅ
     C                   ENDSL
     C                   MOVEL     WSSRSI        ISFRSI
     C                   MOVE      WSGDAD        ISGDAD                         GODKJ.DATO
     C                   MOVE      WSGDAM        ISGDAM
     C                   SELECT
     C                   WHEN      WSSGDA = 0
     C                   MOVE      *ZEROS        ISGDAÅ
     C                   WHEN      WSGDAÅ > 50
     C     WSGDAÅ        ADD       1900          ISGDAÅ
     C                   OTHER
     C     WSGDAÅ        ADD       2000          ISGDAÅ
     C                   ENDSL
     C                   MOVEL     WSSGSI        ISFGSI
     C                   MOVE      WSFDAD        ISFDAD                         1. GJENNOM-
     C                   MOVE      WSFDAM        ISFDAM                         FØRINGSDATO
     C                   SELECT
     C                   WHEN      WSSFDA = 0
     C                   MOVE      *ZEROS        ISFDAÅ
     C                   WHEN      WSFDAÅ > 50
     C     WSFDAÅ        ADD       1900          ISFDAÅ
     C                   OTHER
     C     WSFDAÅ        ADD       2000          ISFDAÅ
     C                   ENDSL
     C                   MOVEL     WSSFSI        ISFFSI
     C                   MOVE      WSUDAD        ISUDAD                         GJENNOM-
     C                   MOVE      WSUDAM        ISUDAM                         FØRINGSDATO
     C                   SELECT
     C                   WHEN      WSSUDA = 0
     C                   MOVE      *ZEROS        ISUDAÅ
     C                   WHEN      WSUDAÅ > 50
     C     WSUDAÅ        ADD       1900          ISUDAÅ
     C                   OTHER
     C     WSUDAÅ        ADD       2000          ISUDAÅ
     C                   ENDSL
     C                   MOVEL     WSSUSI        ISFUSI
     C                   Z-ADD     WSSKOS        ISFKOS
     C                   MOVEL     WSSOPT        ISFOPT
     C                   MOVEL     WSSUNT        ISFUNT
     C                   MOVE      UDAY          ISSDAD                         SISTE
     C                   MOVE      UMONTH        ISSDAM                         SAKSBEH.DATO
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          ISSDAÅ
     C                   ELSE
     C     UYEAR         ADD       2000          ISSDAÅ
     C                   END
     C*                  MOVEL     USIG          ISFSSI
     C                   MOVEL     UUSER         ISFSSI
     C                   MOVEL     WSSRTY        ISRTYP
     C                   MOVEL     WSSFN         ISFN
     C                   MOVEL     WSSKRN        ISKRNO
     C                   MOVEL     WSSST         ISST
     C     WSSST         CHAIN     ISKDSR                             70
     C                   IF        SSLUTT = 'J'
     C                   MOVE      'J'           ISSLUT
     C                   ELSE
     C                   MOVE      ' '           ISSLUT
     C                   END
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WSSKRA        ISKRAV
     C                   MOVE      WSSFOR        ISFORV
     C                   MOVE      WSSINT        ISINT
     C                   IF        WSUSRS = *BLANKS
     C                   MOVE      UUSER         ISUSRS
     C                   ELSE
     C                   MOVEL     WSUSRS        ISUSRS
     C                   END
     C                   MOVE      WTM           ISFSTM
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYPOST        BEGSR
      ***********************************************
     C                   CALL      'SYIS10C'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    NUMM
     C                   Z-ADD     NUMM          WSSLOP
     C                   Z-ADD     NUMM          ISFLOP
      *
     C                   MOVE      'M'           ISRM
     C                   Z-ADD     UAVD          ISFAVD
     C                   Z-ADD     UOPD          ISFOPD
     C                   MOVE      UUSER         ISUSRR
     C                   MOVE      WTM           ISFRTM
     C                   MOVE      UUSER         ISUSRS
     C                   MOVE      WTM           ISFSTM
     C     'ISOSAKSN'    CHAIN     TELLGE                             33
     C                   IF        *IN33
     C                   MOVEL     'ISOSAKSN'    GECO
     C                   Z-ADD     10002         GENO
     C                   WRITE     TELLGER
     C                   Z-ADD     10001         ISSAKN
     C                   ELSE
     C                   MOVE      GENO          ISSAKN
     C                   ADD       1             GENO
     C                   UPDATE    TELLGER
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * STATUS
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDEQ     78
     C                   MOVE      *BLANKS       UFLG
     C                   CALL      'SYIS17'
     C                   PARM                    UKODE3            1
     C                   PARM                    UFLG              2
     C     UFLG          IFNE      '03'
     C                   MOVEL     UKODE3        WSSST
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * POSTTYPE
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     15
     C                   MOVE      *BLANKS       UFLG
     C                   CALL      'SYIS15'
     C                   PARM                    UKODE
     C                   PARM                    UFLG              2
     C     UFLG          IFNE      '03'
     C                   MOVEL     UKODE         WSSPFO
     C                   EXSR      SØKPAR
     C   30              GOTO      SLSØK
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVVIKETS ART
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     31
     C     POSNBR        ANDLE     35
     C                   MOVE      *BLANKS       UFLG
     C                   CALL      'SYIS12'
     C                   PARM                    WSSPFO
     C                   PARM                    UKODE
     C                   PARM                    UFLG              2
     C     UFLG          IFNE      '03'
     C                   MOVEL     UKODE         WSSAVA
     C                   EXSR      SØKART
     C   30              GOTO      SLSØK
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * REKLAMASJONSTYPE
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   MOVE      *BLANKS       UFLG
     C                   CALL      'SYIS16'
     C                   PARM                    UKODE2            2
     C                   PARM                    UFLG              2
     C     UFLG          IFNE      '03'
     C                   MOVEL     UKODE2        WSSRTY
     C                   EXSR      SØKRTY
     C   30              GOTO      SLSØK
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     66            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * ANSVARLIG PART
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     54
     C                   MOVE      *BLANKS       UFLG
     C                   CALL      'SYIS13'
     C                   PARM                    UKODE
     C                   PARM                    UFLG              2
     C     UFLG          IFNE      '03'
     C                   MOVEL     UKODE         WSSANS
     C                   EXSR      SØKANS
     C   30              GOTO      SLSØK
     C                   END
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * ÅRSAK 1
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   MOVEL     WSKF          WSSFK1
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * ÅRSAK 2
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   MOVEL     WSKF          WSSFK2
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * ÅRSAK 3
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   MOVEL     WSKF          WSSFK3
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TILTAK 1
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   MOVEL     WSKF          WSSFR1
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF
     C                   MOVEL     WSKF          WSSFR2
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF
     C                   MOVEL     WSKF          WSSFR3
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     1             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF
     C                   MOVEL     WSKF          WSSFR4
     C                   EXSR      SØKFRI
     C   30              GOTO      SLSØK
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    USAKSNR           7 0
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UTNO              8 0
     C                   PARM                    USIG              3
     C                   PARM                    USSLOP            3 0
     C                   PARM                    TEST              1
     C                   PARM                    UFLAGG            2
      *
     C     DISKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
      *
     C     TURKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSSTUN
      *
     C     HEDKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
      *
     C     HTRKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
      *
     C     ISOKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
      *
     C     ISOKY2        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    USSLOP
      *
     C     ISOKY3        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    WSSLOP
      *
     C     KODKEY        KLIST
     C                   KFLD                    WSKF
     C                   KFLD                    XLN
      *
     C     SAKKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    WSSLOP
     C                   KFLD                    WSSNR
      *
     C     SAKKEE        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    WSSLOP
      *
     C     ISOKDAK1      KLIST
     C                   KFLD                    WSSPFO
     C                   KFLD                    WSSAVA
     C     ISOKDAK2      KLIST
     C                   KFLD                    B_WSSPFO          5
     C                   KFLD                    WSSAVA
      *
     C     BRPARFK       KLIST
     C                   KFLD                    WSUSRS
     C                   KFLD                    PAKUNR
     C                   KFLD                    PAID
     C                   MOVEL     'ISOW'        PAID
      *
     C                   Z-ADD     0             NUMM              4 0
     C                   MOVE      *BLANKS       UKODE             5
     C                   MOVE      *ZEROS        WSSADA
     C                   MOVE      *ZEROS        WSSAND
     C                   MOVE      *ZEROS        WSSMDA
     C                   MOVE      *ZEROS        WSSLDA
     C                   MOVE      *ZEROS        WSSGDA
     C                   MOVE      *ZEROS        WSSRDA
     C                   MOVE      *ZEROS        WSSFDA
     C                   MOVE      *ZEROS        WSSSDA
     C                   MOVE      *ZEROS        WSSUDA
      *
     C                   ENDSR
      *
