********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10019 * 01 YBC PTF10 FLERE PARAMETRE FOR OVERSJÿ-SYSTEM
10019 * 02 JOV PTF10 init av filvariable (i DS) i fall ikke treff
10227 * 03 JOV PTF10 fiks kortdato   / fjernet 1 = hent
      * 04 JOV PTF10 LOGGFÿR DATOENDRINGER I TRACKF / OPPDATER TILBAKE TIL HEADF
      * 05 JOV PTF10 REASON ved endring av beskyttet dato+hensynta endring til 0 (ikke blank i opd.)
10XXX * 06 JOV PTF10 F23 GJELDER OGS≈ FOR OVERSJÿ-MODULS
      * 07 jov PTF10 Init av GM-fleter flytte uten qannen merking (.. digit or sign..-feil)
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 08 YBC PTF12 OPPDATER HEDTOP
12XXX * 09 YBC PTF12 nytte bel fo JUSTERT ETA (uten Â overskrive opprinnelig)
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED TRACK & TRACING TIDSFÿLGINH***
      ***********************************************************
      *
     FTRACKT    UF A E           K DISK
S04  F*EADF     IF   E           K DISK
N04  FHEADF     UF   E           K DISK
N01  FBILLOF    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FDISP      UF   E           K DISK
     FSYTT02FM  CF   E             WORKSTN
     D                 DS
     D  WSETDD                 1      6  0
     D  WSEDD                  1      2  0
     D  WSEDM                  3      4  0
     D  WSED≈                  5      6  0
     D                 DS
     D  TXETDD                 1      8  0
     D  TXED≈                  1      4  0
     D  TXEDM                  5      6  0
     D  TXEDD                  7      8  0
     D                 DS
     D  WSETAD                 1      6  0
     D  WSEAD                  1      2  0
     D  WSEAM                  3      4  0
     D  WSEA≈                  5      6  0
     D                 DS
     D  TXETAD                 1      8  0
     D  TXEA≈                  1      4  0
     D  TXEAM                  5      6  0
     D  TXEAD                  7      8  0
N09   ** Justert ETA uten Â ebndre opprinnelig
N09  D                 DS
N09  D  WSETAD2                1      6  0
N09  D  WSEAD2                 1      2  0
N09  D  WSEAM2                 3      4  0
N09  D  WSEA≈2                 5      6  0
N09  D                 DS
N09  D  TXETAD2                1      8  0
N09  D  TXEA≈2                 1      4  0
N09  D  TXEAM2                 5      6  0
N09  D  TXEAD2                 7      8  0
      **
     D                 DS
     D  WSATDD                 1      6  0
     D  WSADD                  1      2  0
     D  WSADM                  3      4  0
     D  WSAD≈                  5      6  0
     D                 DS
     D  TXATDD                 1      8  0
     D  TXAD≈                  1      4  0
     D  TXADM                  5      6  0
     D  TXADD                  7      8  0
     D                 DS
     D  WSATAD                 1      6  0
     D  WSAAD                  1      2  0
     D  WSAAM                  3      4  0
     D  WSAA≈                  5      6  0
     D                 DS
     D  TXATAD                 1      8  0
     D  TXAA≈                  1      4  0
     D  TXAAM                  5      6  0
     D  TXAAD                  7      8  0
     D                 DS
     D  WSEX1D                 1      6  0
     D  WSE1D                  1      2  0
     D  WSE1M                  3      4  0
     D  WSE1≈                  5      6  0
     D                 DS
     D  TXEX1D                 1      8  0
     D  TXE1≈                  1      4  0
     D  TXE1M                  5      6  0
     D  TXE1D                  7      8  0
     D                 DS
     D  WSEX2D                 1      6  0
     D  WSE2D                  1      2  0
     D  WSE2M                  3      4  0
     D  WSE2≈                  5      6  0
     D                 DS
     D  TXEX2D                 1      8  0
     D  TXE2≈                  1      4  0
     D  TXE2M                  5      6  0
     D  TXE2D                  7      8  0
N01  D                 DS
N01  D  WSOS01                 1      6  0
N01  D  WSOS01D                1      2  0
N01  D  WSOS01M                3      4  0
N01  D  WSOS01≈                5      6  0
N01  D                 DS
N01  D  TXOS01                 1      8  0
N01  D  TXOS01≈                1      4  0
N01  D  TXOS01M                5      6  0
N01  D  TXOS01D                7      8  0
N01  D                 DS
N01  D  WSOS02                 1      6  0
N01  D  WSOS02D                1      2  0
N01  D  WSOS02M                3      4  0
N01  D  WSOS02≈                5      6  0
N01  D                 DS
N01  D  TXOS02                 1      8  0
N01  D  TXOS02≈                1      4  0
N01  D  TXOS02M                5      6  0
N01  D  TXOS02D                7      8  0
N01  D                 DS
N01  D  WSOS03                 1      6  0
N01  D  WSOS03D                1      2  0
N01  D  WSOS03M                3      4  0
N01  D  WSOS03≈                5      6  0
N01  D                 DS
N01  D  TXOS03                 1      8  0
N01  D  TXOS03≈                1      4  0
N01  D  TXOS03M                5      6  0
N01  D  TXOS03D                7      8  0
N01  D                 DS
N01  D  WSOS04                 1      6  0
N01  D  WSOS04D                1      2  0
N01  D  WSOS04M                3      4  0
N01  D  WSOS04≈                5      6  0
N01  D                 DS
N01  D  TXOS04                 1      8  0
N01  D  TXOS04≈                1      4  0
N01  D  TXOS04M                5      6  0
N01  D  TXOS04D                7      8  0
N01  D                 DS
N01  D  WSOS05                 1      6  0
N01  D  WSOS05D                1      2  0
N01  D  WSOS05M                3      4  0
N01  D  WSOS05≈                5      6  0
N01  D                 DS
N01  D  TXOS05                 1      8  0
N01  D  TXOS05≈                1      4  0
N01  D  TXOS05M                5      6  0
N01  D  TXOS05D                7      8  0
N01  D                 DS
N01  D  WSOS06                 1      6  0
N01  D  WSOS06D                1      2  0
N01  D  WSOS06M                3      4  0
N01  D  WSOS06≈                5      6  0
N01  D                 DS
N01  D  TXOS06                 1      8  0
N01  D  TXOS06≈                1      4  0
N01  D  TXOS06M                5      6  0
N01  D  TXOS06D                7      8  0
N01  D                 DS
N01  D  WSOS07                 1      6  0
N01  D  WSOS07D                1      2  0
N01  D  WSOS07M                3      4  0
N01  D  WSOS07≈                5      6  0
N01  D                 DS
N01  D  TXOS07                 1      8  0
N01  D  TXOS07≈                1      4  0
N01  D  TXOS07M                5      6  0
N01  D  TXOS07D                7      8  0
      *
     C                   EXSR      INIT
      * ta vare pÂ opprinnelig dato 6 lang (oppr kl er alt bevart - a la GMETDK )
N05  c                   move      WSEX1D        GMEX1D6           6 0
N05  c                   move      WSEX2D        GMEX2D6           6 0
N05  c                   move      WSATDD        GMATDD6           6 0
N05  c                   move      WSATAD        GMATAD6           6 0
N05  c                   if        WsEX1D<>0 or WsEX2D <>0 or
N05  c                             WsATDD<>0 or WsATAD<>0
N05  c                   move      *on           *in55                          vis F23-txt
N05  c                   endif
      *
     C     START         TAG
N01  C                   IF        XOS = 'N'
N05  C                   MoveA     '0000'        *IN(51)
N05  C     *IN23         ifne      '1'
N05  C     GMEX1D        comp      *zeros                             51
N05  C     GMEX2D        comp      *zeros                             52
N05  C     GMATDD        comp      *zeros                             53
N05  C     GMATAD        comp      *zeros                             54
N05  C                   endif
     C                   EXFMT     BILDE
S06  C*    *IN23         cabeq     '1'           Start
N01  C                   ELSE
N01  C                   EXFMT     BILDE02
N01  C                   END
N06  C     *IN23         cabeq     '1'           Start
     C                   MOVEA     '00000000'    *IN(92)
S01  C*                  MOVEA     '0000'        *IN(88)
N01  C                   MOVEA     '0000000'     *IN(85)
N09  C                   MOVEA     '00'          *IN(83)
N05  c                   move      *off          *in56                          cursor i TXT ?
     C                   MOVE      '0'           *IN30
      *
     C   03
     COR 12              GOTO      SLUTT
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
      *
     C     TRTK          CHAIN     TRACKT                             33
     C                   EXSR      MOVWST
     C     *IN33         IFEQ      '0'
     C                   UPDATE    TRACKTR
     C                   ELSE
N04  c                   Move      UAVD          TXAVD
N04  c                   Move      UOPD          TXOPD
     C                   WRITE     TRACKTR
     C                   END
      *
     C     TXATAD        IFNE      0
N04  C*    HEADFK        CHAIN     HEADF                              33
N04  C     HEADFK        CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '0'
     C     HEUR          ANDEQ     'H'
     C     HEPRO         ANDNE     *ZEROS
     C     HEADFK        CHAIN     DISP                               33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'C'           DISTA1
     C                   UPDATE    DISPR
     C                   END
     C                   END
     C                   END
N04   * CHANGED DATES?
N04  C                   EXSR      TSTCHD
      *
     C     SLUTT         TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
N05   * endring av beskyttede datoer uten Â angi tekst..
N05  c                   if        GMATDD6<>0 and WSTXT=*blanks
N05  c                   if        GMATDD6<>WSATDD
N05  c                             or GMATDK <>WSATDK
N05  c                   move      *on           *in23                          ≈pent
N05  c                   move      *on           *in56                          cursor
N05  c                   move      *on           *in30
N05  c                   goto      SLTB
N05  c                   endif
N05  c                   endif
N05  c                   if        GMATAD6<>0 and WSTXT=*blanks
N05  c                   if        GMATAD6<>WSATAD
N05  c                             or GMATAK <>WSATAK
N05  c                   move      *on           *in23                          ≈pent
N05  c                   move      *on           *in56                          cursor
N05  c                   move      *on           *in30
N05  c                   goto      SLTB
N05  c                   endif
N05  c                   endif
N05  c                   if        GMEX1D6<>0 and WSTXT=*blanks
N05  c                   if        GMEX1D6<>WSEX1D
N05  c                             or GMEX1K <>WSEX1K
N05  c                   move      *on           *in23                          ≈pent
N05  c                   move      *on           *in56                          cursor
N05  c                   move      *on           *in30
N05  c                   goto      SLTB
N05  c                   endif
N05  c                   endif
N05  c                   if        GMEX2D6<>0 and WSTXT=*blanks
N05  c                   if        GMEX2D6<>WSEX2D
N05  c                             or GMEX2K <>WSEX2K
N05  c                   move      *on           *in23                          ≈pent
N05  c                   move      *on           *in56                          cursor
N05  c                   move      *on           *in30
N05  c                   goto      SLTB
N05  c                   endif
N05  c                   endif
      *
S03  C*    WSATAD        IFEQ      1
N03  C     WSATAD        IFEQ      -1
     C                   MOVE      WSETAD        WSATAD
     C     WSATAK        IFEQ      *ZEROS
     C                   MOVE      WSETAK        WSATAK
     C                   END
     C                   END
     C     WSATAD        IFNE      0
N03  C     WSATAD        IFLE      9999
N03  C                   MOVE      WSATAD        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSATAD
N03  C                   ENDIF
     C                   MOVE      WSAAD         UDD               2 0
     C                   MOVE      WSAAM         UMM               2 0
     C                   MOVE      WSAA≈         U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      99
     C   99              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSATAK        IFNE      0
     C                   MOVEL     WSATAK        XTIME             2 0
     C                   MOVE      WSATAK        XMIN              2 0
     C     XTIME         COMP      24                                 98
     C  N98XMIN          COMP      60                                 98  98
     C   98              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
s03  C*    WSATDD        IFEQ      1
N03  C     WSATDD        IFEQ      -1
     C                   MOVE      WSETDD        WSATDD
     C     WSATDK        IFEQ      *ZEROS
     C                   MOVE      WSETDK        WSATDK
     C                   END
     C                   END
     C     WSATDD        IFNE      0
N03  C     WSATDD        IFLE      9999
N03  C                   MOVE      WSATDD        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSATDD
N03  C                   ENDIF
     C                   MOVE      WSADD         UDD               2 0
     C                   MOVE      WSADM         UMM               2 0
     C                   MOVE      WSAD≈         U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      97
     C   97              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSATDK        IFNE      0
     C                   MOVEL     WSATDK        XTIME             2 0
     C                   MOVE      WSATDK        XMIN              2 0
     C     XTIME         COMP      24                                 96
     C  N96XMIN          COMP      60                                 96  96
     C   96              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSETAD        IFNE      0
N03  C     WSETAD        IFLE      9999
N03  C                   MOVE      WSETAD        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSETAD
N03  C                   ENDIF
     C                   MOVE      WSEAD         UDD               2 0
     C                   MOVE      WSEAM         UMM               2 0
     C                   MOVE      WSEA≈         U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      95
     C   95              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSETAK        IFNE      0
     C                   MOVEL     WSETAK        XTIME             2 0
     C                   MOVE      WSETAK        XMIN              2 0
     C     XTIME         COMP      24                                 94
     C  N94XMIN          COMP      60                                 94  94
     C   94              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSETDD        IFNE      0
N03  C     WSETDD        IFLE      9999
N03  C                   MOVE      WSETDD        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSETDD
N03  C                   ENDIF
     C                   MOVE      WSEDD         UDD               2 0
     C                   MOVE      WSEDM         UMM               2 0
     C                   MOVE      WSED≈         U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      93
     C   93              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSETDK        IFNE      0
     C                   MOVEL     WSETDK        XTIME             2 0
     C                   MOVE      WSETDK        XMIN              2 0
     C     XTIME         COMP      24                                 92
     C  N92XMIN          COMP      60                                 92  92
     C   92              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
N09   * Justert ETA (uten Â endre original ETA)
N09  C     WSETAD2       IFNE      0
N09  C     WSETAD2       IFLE      9999
N09  C                   MOVE      WSETAD2       TSTDAT            6 0
N09  C                   CALL      'TESTDATK'
N09  C                   PARM                    TSTDAT
N09  C                   MOVE      TSTDAT        WSETAD2
N09  C                   ENDIF
N09  C                   MOVE      WSEAD2        UDD               2 0
N09  C                   MOVE      WSEAM2        UMM               2 0
N09  C                   MOVE      WSEA≈2        U≈≈               2 0
N09  C                   CALL      'TESTDATO'
N09  C                   PARM                    UDD
N09  C                   PARM                    UMM
N09  C                   PARM                    U≈≈
N09  C                   PARM                    UFLAGG
N09  C     UFLAGG        COMP      1                                      84
N09  C   84              MOVE      '1'           *IN30
N09  C   30              GOTO      SLTB
N09  C                   END
N09   *
N09  C     WSETAK2       IFNE      0
N09  C                   MOVEL     WSETAK2       XTIME             2 0
N09  C                   MOVE      WSETAK2       XMIN              2 0
N09  C     XTIME         COMP      24                                 83
N09  C  N83XMIN          COMP      60                                 83  92
N09  C   83              MOVE      '1'           *IN30
N09  C   30              GOTO      SLTB
N09  C                   END
N09   ***
      *
N01  C                   IF        XOS = 'N'
N01   *
     C     WSEX1D        IFNE      0
N03  C     WSEX1D        IFLE      9999
N03  C                   MOVE      WSEX1D        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSEX1D
N03  C                   ENDIF
     C                   MOVE      WSE1D         UDD               2 0
     C                   MOVE      WSE1M         UMM               2 0
     C                   MOVE      WSE1≈         U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      91
     C   91              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSEX1K        IFNE      0
     C                   MOVEL     WSEX1K        XTIME             2 0
     C                   MOVE      WSEX1K        XMIN              2 0
     C     XTIME         COMP      24                                 90
     C  N90XMIN          COMP      60                                 90  90
     C   90              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSEX2D        IFNE      0
N03  C     WSEX2D        IFLE      9999
N03  C                   MOVE      WSEX2D        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSEX2D
N03  C                   ENDIF
     C                   MOVE      WSE2D         UDD               2 0
     C                   MOVE      WSE2M         UMM               2 0
     C                   MOVE      WSE2≈         U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      89
     C   89              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
      *
     C     WSEX2K        IFNE      0
     C                   MOVEL     WSEX2K        XTIME             2 0
     C                   MOVE      WSEX2K        XMIN              2 0
     C     XTIME         COMP      24                                 88
     C  N88XMIN          COMP      60                                 88  88
     C   88              MOVE      '1'           *IN30
     C   30              GOTO      SLTB
     C                   END
N01   *
N01  C                   ELSE
N01   * KLAR FRA LEVERANDÿR
N01  C                   IF        WSOS01 <> 0
N03  C     WSOS01        IFLE      9999
N03  C                   MOVE      WSOS01        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS01
N03  C                   ENDIF
N01  C                   MOVE      WSOS01D       UDD               2 0
N01  C                   MOVE      WSOS01M       UMM               2 0
N01  C                   MOVE      WSOS01≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      91
N01  C   91              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * SHIPPING FRIST
N01  C                   IF        WSOS02 <> 0
N03  C     WSOS02        IFLE      9999
N03  C                   MOVE      WSOS02        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS02
N03  C                   ENDIF
N01  C                   MOVE      WSOS02D       UDD               2 0
N01  C                   MOVE      WSOS02M       UMM               2 0
N01  C                   MOVE      WSOS02≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      90
N01  C   90              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * SHIPPING VINDU FRA
N01  C                   IF        WSOS04 <> 0
N03  C     WSOS04        IFLE      9999
N03  C                   MOVE      WSOS04        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS04
N03  C                   ENDIF
N01  C                   MOVE      WSOS04D       UDD               2 0
N01  C                   MOVE      WSOS04M       UMM               2 0
N01  C                   MOVE      WSOS04≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      89
N01  C   89              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * SHIPPING VINDU TIL
N01  C                   IF        WSOS05 <> 0
N03  C     WSOS05        IFLE      9999
N03  C                   MOVE      WSOS05        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS05
N03  C                   ENDIF
N01  C                   MOVE      WSOS05D       UDD               2 0
N01  C                   MOVE      WSOS05M       UMM               2 0
N01  C                   MOVE      WSOS05≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      88
N01  C   88              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * TEST VINDU
N01  C                   IF        ((WSOS04 <> 0) OR (WSOS05 <> 0))
N01  C                   EVAL      TXOS04D = WSOS04D
N01  C                   EVAL      TXOS04M = WSOS04M
N01  C                   EVAL      TXOS04≈ = 2000 + WSOS04≈
N01  C                   EVAL      TXOS05D = WSOS05D
N01  C                   EVAL      TXOS05M = WSOS05M
N01  C                   EVAL      TXOS05≈ = 2000 + WSOS05≈
N01  C     TXOS04        COMP      TXOS05                             89
N01  C   89              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * ANKOMST FRIST
N01  C                   IF        WSOS03 <> 0
N03  C     WSOS03        IFLE      9999
N03  C                   MOVE      WSOS03        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS03
N03  C                   ENDIF
N01  C                   MOVE      WSOS03D       UDD               2 0
N01  C                   MOVE      WSOS03M       UMM               2 0
N01  C                   MOVE      WSOS03≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      87
N01  C   87              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * ANKOMST VINDU FRA
N01  C                   IF        WSOS06 <> 0
N03  C     WSOS06        IFLE      9999
N03  C                   MOVE      WSOS06        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS06
N03  C                   ENDIF
N01  C                   MOVE      WSOS06D       UDD               2 0
N01  C                   MOVE      WSOS06M       UMM               2 0
N01  C                   MOVE      WSOS06≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      86
N01  C   86              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * ANKOMST VINDU TIL
N01  C                   IF        WSOS07 <> 0
N03  C     WSOS07        IFLE      9999
N03  C                   MOVE      WSOS07        TSTDAT            6 0
N03  C                   CALL      'TESTDATK'
N03  C                   PARM                    TSTDAT
N03  C                   MOVE      TSTDAT        WSOS07
N03  C                   ENDIF
N01  C                   MOVE      WSOS07D       UDD               2 0
N01  C                   MOVE      WSOS07M       UMM               2 0
N01  C                   MOVE      WSOS07≈       U≈≈               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    UDD
N01  C                   PARM                    UMM
N01  C                   PARM                    U≈≈
N01  C                   PARM                    UFLAGG
N01  C     UFLAGG        COMP      1                                      85
N01  C   85              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   * TEST VINDU
N01  C                   IF        ((WSOS06 <> 0) OR (WSOS07 <> 0))
N01  C                   EVAL      TXOS06D = WSOS06D
N01  C                   EVAL      TXOS06M = WSOS06M
N01  C                   EVAL      TXOS06≈ = 2000 + WSOS06≈
N01  C                   EVAL      TXOS07D = WSOS07D
N01  C                   EVAL      TXOS07M = WSOS07M
N01  C                   EVAL      TXOS07≈ = 2000 + WSOS07≈
N01  C     TXOS06        COMP      TXOS07                             86
N01  C   86              MOVE      '1'           *IN30
N01  C   30              GOTO      SLTB
N01  C                   END
N01   *
N01  C                   END
      *
     C     SLTB          TAG
     C   30              MOVE      'YBC0647'     MSGNR
N05  C   56              MOVE      'JOV1605'     MSGNR
     C                   ENDSR
      *
     C***********************************************
     C     MOVWST        BEGSR
     C***********************************************
     C     WSETDD        IFEQ      0
     C                   MOVE      *ZEROS        TXETDD
     C                   ELSE
     C                   MOVE      WSEDD         TXEDD
     C                   MOVE      WSEDM         TXEDM
     C     WSED≈         IFGT      50
     C     WSED≈         ADD       1900          TXED≈
     C                   ELSE
     C     WSED≈         ADD       2000          TXED≈
     C                   END
     C                   END
     C                   MOVE      WSETDK        TXETDK
     C     WSETAD        IFEQ      0
     C                   MOVE      *ZEROS        TXETAD
     C                   ELSE
     C                   MOVE      WSEAD         TXEAD
     C                   MOVE      WSEAM         TXEAM
     C     WSEA≈         IFGT      50
     C     WSEA≈         ADD       1900          TXEA≈
     C                   ELSE
     C     WSEA≈         ADD       2000          TXEA≈
     C                   END
     C                   END
     C                   MOVE      WSETAK        TXETAK
N09   * Justert ETA uten Â endre opprinnelig (endret = kode M Manuell)
N09  C     WSETAD2       IFEQ      0
N09  C                   MOVE      *ZEROS        TXETAD2
N09  C                   ELSE
N09  C                   MOVE      WSEAD2        TXEAD2
N09  C                   MOVE      WSEAM2        TXEAM2
N09  C     WSEA≈2        IFGT      50
N09  C     WSEA≈2        ADD       1900          TXEA≈2
N09  C                   ELSE
N09  C     WSEA≈2        ADD       2000          TXEA≈2
N09  C                   END
N09  C                   END
N09  C                   MOVE      WSETAK2       TXETAK2
N09  c                   if        TXETAD2 <> GMETAD2 or
N09  c                             TXETAK2 <> GMETAK2
N09  c                   eval      TXETA2K = 'M'                                kode M = Manuell
N09  c                   endif
      *
     C     WSATDD        IFEQ      0
     C                   MOVE      *ZEROS        TXATDD
     C                   ELSE
     C                   MOVE      WSADD         TXADD
     C                   MOVE      WSADM         TXADM
     C     WSAD≈         IFGT      50
     C     WSAD≈         ADD       1900          TXAD≈
     C                   ELSE
     C     WSAD≈         ADD       2000          TXAD≈
     C                   END
     C                   END
     C                   MOVE      WSATDK        TXATDK
     C     WSATAD        IFEQ      0
     C                   MOVE      *ZEROS        TXATAD
     C                   ELSE
     C                   MOVE      WSAAD         TXAAD
     C                   MOVE      WSAAM         TXAAM
     C     WSAA≈         IFGT      50
     C     WSAA≈         ADD       1900          TXAA≈
     C                   ELSE
     C     WSAA≈         ADD       2000          TXAA≈
     C                   END
     C                   END
     C                   MOVE      WSATAK        TXATAK
N01   *
N01  C                   IF        XOS = 'N'
      *
     C     WSEX1D        IFEQ      0
     C                   MOVE      *ZEROS        TXEX1D
     C                   ELSE
     C                   MOVE      WSE1D         TXE1D
     C                   MOVE      WSE1M         TXE1M
     C     WSE1≈         IFGT      50
     C     WSE1≈         ADD       1900          TXE1≈
     C                   ELSE
     C     WSE1≈         ADD       2000          TXE1≈
     C                   END
     C                   END
     C                   MOVE      WSEX1K        TXEX1K
     C     WSEX2D        IFEQ      0
     C                   MOVE      *ZEROS        TXEX2D
     C                   ELSE
     C                   MOVE      WSE2D         TXE2D
     C                   MOVE      WSE2M         TXE2M
     C     WSE2≈         IFGT      50
     C     WSE2≈         ADD       1900          TXE2≈
     C                   ELSE
     C     WSE2≈         ADD       2000          TXE2≈
     C                   END
     C                   END
     C                   MOVE      WSEX2K        TXEX2K
N01   *
N01  C                   ELSE
N01   *
N01  C                   IF        WSOS01 = 0
N01  C                   EVAL      TXOS01 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS01D = WSOS01D
N01  C                   EVAL      TXOS01M = WSOS01M
N01  C                   EVAL      TXOS01≈ = 2000 + WSOS01≈
N01  C                   END
N01  C                   IF        WSOS02 = 0
N01  C                   EVAL      TXOS02 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS02D = WSOS02D
N01  C                   EVAL      TXOS02M = WSOS02M
N01  C                   EVAL      TXOS02≈ = 2000 + WSOS02≈
N01  C                   END
N01  C                   IF        WSOS03 = 0
N01  C                   EVAL      TXOS03 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS03D = WSOS03D
N01  C                   EVAL      TXOS03M = WSOS03M
N01  C                   EVAL      TXOS03≈ = 2000 + WSOS03≈
N01  C                   END
N01  C                   IF        WSOS04 = 0
N01  C                   EVAL      TXOS04 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS04D = WSOS04D
N01  C                   EVAL      TXOS04M = WSOS04M
N01  C                   EVAL      TXOS04≈ = 2000 + WSOS04≈
N01  C                   END
N01  C                   IF        WSOS05 = 0
N01  C                   EVAL      TXOS05 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS05D = WSOS05D
N01  C                   EVAL      TXOS05M = WSOS05M
N01  C                   EVAL      TXOS05≈ = 2000 + WSOS05≈
N01  C                   END
N01  C                   IF        WSOS06 = 0
N01  C                   EVAL      TXOS06 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS06D = WSOS06D
N01  C                   EVAL      TXOS06M = WSOS06M
N01  C                   EVAL      TXOS06≈ = 2000 + WSOS06≈
N01  C                   END
N01  C                   IF        WSOS07 = 0
N01  C                   EVAL      TXOS07 = 0
N01  C                   ELSE
N01  C                   EVAL      TXOS07D = WSOS07D
N01  C                   EVAL      TXOS07M = WSOS07M
N01  C                   EVAL      TXOS07≈ = 2000 + WSOS07≈
N01  C                   END
N01   *
N01  C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVTWS        BEGSR
     C***********************************************
     C                   MOVE      TXEDD         WSEDD
     C                   MOVE      TXEDM         WSEDM
     C                   MOVE      TXED≈         WSED≈
     C                   MOVE      TXETDK        WSETDK
     C                   MOVE      TXEAD         WSEAD
     C                   MOVE      TXEAM         WSEAM
     C                   MOVE      TXEA≈         WSEA≈
     C                   MOVE      TXETAK        WSETAK
N09  C                   MOVE      TXEAD2        WSEAD2
N09  C                   MOVE      TXEAM2        WSEAM2
N09  C                   MOVE      TXEA≈2        WSEA≈2
N09  C                   MOVE      TXETAK2       WSETAK2
     C                   MOVE      TXADD         WSADD
     C                   MOVE      TXADM         WSADM
     C                   MOVE      TXAD≈         WSAD≈
     C                   MOVE      TXATDK        WSATDK
     C                   MOVE      TXAAD         WSAAD
     C                   MOVE      TXAAM         WSAAM
     C                   MOVE      TXAA≈         WSAA≈
     C                   MOVE      TXATAK        WSATAK
S06  C*                  IF        XOS = 'N'
     C                   MOVE      TXE1D         WSE1D
     C                   MOVE      TXE1M         WSE1M
     C                   MOVE      TXE1≈         WSE1≈
     C                   MOVE      TXEX1K        WSEX1K
     C                   MOVE      TXE2D         WSE2D
     C                   MOVE      TXE2M         WSE2M
     C                   MOVE      TXE2≈         WSE2≈
     C                   MOVE      TXEX2K        WSEX2K
S06  C*                  ELSE
N01  C                   MOVE      TXOS01D       WSOS01D
N01  C                   MOVE      TXOS01M       WSOS01M
N01  C                   MOVE      TXOS01≈       WSOS01≈
N01  C                   MOVE      TXOS02D       WSOS02D
N01  C                   MOVE      TXOS02M       WSOS02M
N01  C                   MOVE      TXOS02≈       WSOS02≈
N01  C                   MOVE      TXOS03D       WSOS03D
N01  C                   MOVE      TXOS03M       WSOS03M
N01  C                   MOVE      TXOS03≈       WSOS03≈
N01  C                   MOVE      TXOS04D       WSOS04D
N01  C                   MOVE      TXOS04M       WSOS04M
N01  C                   MOVE      TXOS04≈       WSOS04≈
N01  C                   MOVE      TXOS05D       WSOS05D
N01  C                   MOVE      TXOS05M       WSOS05M
N01  C                   MOVE      TXOS05≈       WSOS05≈
N01  C                   MOVE      TXOS06D       WSOS06D
N01  C                   MOVE      TXOS06M       WSOS06M
N01  C                   MOVE      TXOS06≈       WSOS06≈
N01  C                   MOVE      TXOS07D       WSOS07D
N01  C                   MOVE      TXOS07M       WSOS07M
N01  C                   MOVE      TXOS07≈       WSOS07≈
S06  C*                  END
      *
N04  c                   Move      TXETDD        GMETDD            8 0
N04  c                   Move      TXETDK        GMETDK            4 0
N04  c                   Move      TXETAD        GMETAD            8 0
N04  c                   Move      TXETAK        GMETAK            4 0
N09  C                   MOVE      TXETAD2       GMETAD2           8 0
N09  C                   MOVE      TXETAK2       GMETAK2           4 0
N04  c                   Move      TXATDD        GMATDD            8 0
N04  c                   Move      TXATDK        GMATDK            4 0
N04  c                   Move      TXATAD        GMATAD            8 0
N04  c                   Move      TXATAK        GMATAK            4 0
N04  c                   Move      TXEX1D        GMEX1D            8 0
N04  c                   Move      TXEX1K        GMEX1K            4 0
N04  c                   Move      TXEX2D        GMEX2D            8 0
N04  c                   Move      TXEX2K        GMEX2K            4 0
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB          BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSETDD
     C                   MOVE      *ZEROS        WSETAD
N09  C                   MOVE      *ZEROS        WSETAD2
     C                   MOVE      *ZEROS        WSATDD
     C                   MOVE      *ZEROS        WSATAD
     C                   MOVE      *ZEROS        WSEX1D
     C                   MOVE      *ZEROS        WSEX2D
N01  C                   MOVE      *ZEROS        WSOS01
N01  C                   MOVE      *ZEROS        WSOS02
N01  C                   MOVE      *ZEROS        WSOS03
N01  C                   MOVE      *ZEROS        WSOS04
N01  C                   MOVE      *ZEROS        WSOS05
N01  C                   MOVE      *ZEROS        WSOS06
N01  C                   MOVE      *ZEROS        WSOS07
      *
     C                   ENDSR
      *
N04  C***********************************************
N04  C     TSTCHD        BEGSR
N04  C***********************************************
N05  C                   Movel     WSTXT         WSTEXT           70
N04   * endring loggf¯res for alle muduler, men tilbakef¯res til oppdrag kun ved TRModul.
N04  C     HEADFK        CHAIN(N)  HEADF                              33
N04  C                   SETON                                        34
N04  c                   IF        HEUR = 'H'
N04  C                   IF        GMETDD<>TXETDD OR GMETDK<>TXETDK
N04  C                             OR GMETAD<>TXETAD OR GMETAK<>TXETAK
N04  C                             OR GMATDD<>TXATDD OR GMATDK<>TXATDK
N04  C                             OR GMATAD<>TXATAD OR GMATAK<>TXATAK
N04  C     HEADFK        CHAIN     HEADF                              34
N04  C                   ENDIF
N04  C                   ENDIF
N04  C* Endret ETD?? Oppdatere oppdrag kun dersom ATD ikke oppgitt
N04  C                   IF        GMETDD<>TXETDD OR GMETDK<>TXETDK
N04  C                   CALL      'SYTTCHD'
N04  C                   PARM                    UAVD
N04  C                   PARM                    UOPD
N04  C                   PARM      'CHD'         UACTI             3
N04  C                   PARM      'ETD'         UTYP             20
N04  C                   PARM      'ETD'         UTYPE            20
N04  C                   PARM      GMETDD        UGMDAT            8 0
N04  C                   PARM      GMETDK        UGMTID            4 0
N04  C                   PARM      TXETDD        UNYDAT            8 0
N04  C                   PARM      TXETDK        UNYTID            4 0
N05  C                   PARM      WSTEXT        UTEXT            70
s05  C*                  IF        TXATDD=0
N05  C                   IF        TXATDD=0 and TXETDD<>0                       IKKE endr. til BLANK
N04  C                   MOVE      TXETDD        TRSDFD
N04  C                   MOVE      TXETDK        TRSDFK
N04  C                   ENDIF
N04  C                   ENDIF
N04   *
N04  C* Endret ETA?? Oppdatere oppdrag kun dersom ATA ikke oppgitt
N04  C                   IF        GMETAD<>TXETAD OR GMETAK<>TXETAK
N04  C                   CALL      'SYTTCHD'
N04  C                   PARM                    UAVD
N04  C                   PARM                    UOPD
N04  C                   PARM      'CHD'         UACTI
N04  C                   PARM      'ETA'         UTYP
N04  C                   PARM      'ETA'         UTYPE
N04  C                   PARM      GMETAD        UGMDAT
N04  C                   PARM      GMETAK        UGMTID
N04  C                   PARM      TXETAD        UNYDAT
N04  C                   PARM      TXETAK        UNYTID
N05  C                   PARM      WSTEXT        UTEXT            70
s05  C*                  IF        TXATAD=0
N05  C                   IF        TXATAD=0 and TXETAD<>0                       IKKE endr. til BLANK
N04  C                   MOVE      TXETAD        TRSDTD
N04  C                   MOVE      TXETAK        TRSDTK
N04  C                   ENDIF
N04  C                   ENDIF
N04   *
N04  C                   IF        GMATDD<>TXATDD OR GMATDK<>TXATDK
N04  C                   CALL      'SYTTCHD'
N04  C                   PARM                    UAVD
N04  C                   PARM                    UOPD
N04  C                   PARM      'CHD'         UACTI
N04  C                   PARM      'ATD'         UTYP
N04  C                   PARM      'ATD'         UTYPE
N04  C                   PARM      GMATDD        UGMDAT
N04  C                   PARM      GMATDK        UGMTID
N04  C                   PARM      TXATDD        UNYDAT
N04  C                   PARM      TXATDK        UNYTID
N05  C                   PARM      WSTEXT        UTEXT            70
N05  C                   IF        TXATDD<>0                                    IKKE endr. til BLANK
N04  C                   MOVE      TXATDD        TRSDFD
N04  C                   MOVE      TXATDK        TRSDFK
N05  C                   else
N05  C                   MOVE      TXETDD        TRSDFD                         Reset til estmated
N05  C                   MOVE      TXETDK        TRSDFK
N05  C                   ENDIF
N04  C                   ENDIF
N04   *
N04  C                   IF        GMATAD<>TXATAD OR GMATAK<>TXATAK
N04  C                   CALL      'SYTTCHD'
N04  C                   PARM                    UAVD
N04  C                   PARM                    UOPD
N04  C                   PARM      'CHD'         UACTI
N04  C                   PARM      'ATA'         UTYP
N04  C                   PARM      'ATA'         UTYPE
N04  C                   PARM      GMATAD        UGMDAT
N04  C                   PARM      GMATAK        UGMTID
N04  C                   PARM      TXATAD        UNYDAT
N04  C                   PARM      TXATAK        UNYTID
N05  C                   PARM      WSTEXT        UTEXT            70
N05  C                   IF        TXATAD<>0                                    IKKE endr. til BLANK
N04  C                   MOVE      TXATAD        TRSDTD
N04  C                   MOVE      TXATAK        TRSDTK
N05  C                   else
N05  C                   MOVE      TXETAD        TRSDTD                         Reset til estmated
N05  C                   MOVE      TXETAK        TRSDTK
N05  C                   ENDIF
N04  C                   ENDIF
N08   *
N08   * Oppdragsdato - i utg.pkt sett avs.dato men  Fra utland til NO = Import
N08  C                   IF        TRSDFD <> 0
N08  C                   EVAL      HEDTOP = TRSDFD
N08  C                   END
N08  C                   IF        HELKA <> FILAND and HETRI = FILAND
N08  C                             AND TRSDTD <> 0
N08  C                   EVAL      HEDTOP = TRSDTD
N08  C                   END
N04   *
N04  C  N34              UPDATE    HEADFR
N04   *
N04  C                   IF        GMEX1D<>TXEX1D OR GMEX1K<>TXEX1K
N05  C*                  eval      UTYP = 'Ekstradato 1'
N05  C*                  eval      UTYPE= 'Extra date 1'
N05  C                   eval      UTYP = 'PO-dato'
N05  C                   eval      UTYPE= 'PO date'
N04  C                   CALL      'SYTTCHD'
N04  C                   PARM                    UAVD
N04  C                   PARM                    UOPD
N04  C                   PARM      'CHD'         UACTI
N04  C                   PARM                    UTYP
N04  C                   PARM                    UTYPE
N04  C                   PARM      GMEX1D        UGMDAT
N04  C                   PARM      GMEX1K        UGMTID
N04  C                   PARM      TXEX1D        UNYDAT
N04  C                   PARM      TXEX1K        UNYTID
N05  C                   PARM      WSTEXT        UTEXT            70
N04  C                   endif
N04   *
N04  C                   IF        GMEX2D<>TXEX2D OR GMEX2K<>TXEX2K
N05  C*                  eval      UTYP = 'Ekstradato 2'
N05  C*                  eval      UTYPE= 'Extra date 2'
N05  C                   eval      UTYP = 'Ready for pick up '
N05  C                   eval      UTYPE= 'Ready for pick up '
N04  C                   CALL      'SYTTCHD'
N04  C                   PARM                    UAVD
N04  C                   PARM                    UOPD
N04  C                   PARM      'CHD'         UACTI
N04  C                   PARM                    UTYP
N04  C                   PARM                    UTYPE
N04  C                   PARM      GMEX2D        UGMDAT
N04  C                   PARM      GMEX2K        UGMTID
N04  C                   PARM      TXEX2D        UNYDAT
N04  C                   PARM      TXEX2K        UNYTID
N05  C                   PARM      WSTEXT        UTEXT            70
N04  C                   endif
N04  C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     TRTK          KLIST
S02  C*                  KFLD                    TXAVD
S02  C*                  KFLD                    TXOPD
N02  C                   KFLD                    UAVD
N02  C                   KFLD                    UOPD
     C                   KFLD                    TXFBNR
      *
     C     *ENTRY        PLIST
     C     TXAVD         PARM                    UAVD              4 0
     C     TXOPD         PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     FIURBL        IFNE      'J'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
N01   *
N01  C     HEADFK        CHAIN     BILLOF                             33
N01  C                   IF        *IN33
N01  C                   MOVE      'N'           XOS               1
N01  C                   ELSE
N01  C                   MOVE      'J'           XOS
N01  C                   END
      *
N02  c                   clear                   TRACKTR
     C     UFLAGG        COMP      1                                  5050      50*ON=sp¯rring
     C                   WRITE     WINDOWSZ
     C     TRTK          CHAIN(N)  TRACKT                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      MOVTWS
     C                   ELSE
     C                   EXSR      MOVB
     C                   END
N07   * Move til GM..-verdier  flyttet til MOVTWS uten annen merking (...digit or sign-feil)
      *
     C                   ENDSR
      *
