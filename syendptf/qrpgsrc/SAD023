      * kompilering       ovrdbf SAEHOPD  SAEH
      *                   ovrdbf SAEHO2   SAEH
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10006 * 02 sh  PTF10 *cr til *ce
10XXX * 03 YBC PTF10 VIS LØPENR UTEN FØRST TO TALL AV ÅR
10XXX * 04 CB  PTF10 HENT EXTREF ETTER ENDRING
10XXX * 05 sh  PTF10 søk sekvensnummer og dato
10XXX * 06 YBC PTF10 KUN VIS OPPDRAG MED SAMMMEN START-REF.
10XXX * 07 YBC PTF10 SØKING PÅ ALLE AVDELINGER BRUKER EGNE FILER
10XXX * 08 SH  PTF10 feil tollnr ved ny sad.
10XXX * 09 jov PTF10 Opsjon 55 = se på (oppdraget) på web
10XXX * 10 jov PTF10 underscore status ved epost
10XXX * 11 YBC PTF10 UTVIDER TIL 27X132, INGEN MERKING
10XXX * 12 YBC PTF10 OPSJON 18 = NOTISBLOKK
10330 * 13 YBC PTF10 OPSJON 31 = ARBEID MED NCTS
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11007 * 14 YBC PTF11 VIS J/N PÅ OM EPOST ER SENDT TIL KUNDE
11016 * 15 YBC PTF11 OPSJON 12 = OMBEREGNING
11XXX * 16 YBC PTF11 MULIG Å SKRIVE UT VED STATUS=M
11XXX * 17 YBC PTF11 IKKE OPS. 2 NÅR OMBEREGNING ER STARTET.
11XXX * 18 YBC PTF11 VIS LØPENR FOR OMBEREGNING
11XXX * 19 YBC PTF11 OPSJON 16 PRINTE OMBEREGNING
11XXX * 20 YBC PTF11 HENT OMBEREGNING INFOR.
11XXX * 21 YBC PTF11 OMBEREGNING VED STATUS=P OG IKKE SENDT FØR
11XXX * 22 YBC PTF11 SØK OGSÅ GJELDER OMBEREGING
11XXX * 23 YBC PTF11 IKKE VISE OPPDRAG TO GANGER
11109 * 24 YBC PTF11 OMBEREGNING PÅ OMBEREGNING
11XXX * 25 YBC PTF11 VIS RIKTIG LØPENR VED MANUELL OMB UTEN SENDING TIL TVINN
11XXX * 26 SH  PTF11 VIS FRI SØKEVEI
11184 * 27 YBC PTF11 EKSP.ENHET MED SØKING AV LØPENR
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12050 * 28 YBC PTF12 Søk oppdrag via fakturanr, merking/container/underst.
12073 * 29 SH  PTF12 Vis om epost er sendt
12077 * 30 SH  PTF12 OMKJØRING TIL emma  xml opsjon 88/89
12082 * 31 YBC PTF12 VED STATUS P SJEKK OM LØPENR ER LIK MED ORIGINAL FORTOLLING
12082 * 32 JOV PTF12 feil i skillear -(oppd 5 -> 7 )
12082 * 33 sh  PTF12 også vise dataliste
12XXX * 34 YBC PTF12 SAEH10B ER SAMME SOM SAEH9. BYTTES TIL SAEH9
12107 * 35 YBC PTF12 SØK OMBERGNING VIA STATUS
12xXX * 36 SH  PTF12 OPSJON 25 = T&T
12XXX * 37 SH  PTF12 søke sekvens
12201 * 38 YBC PTF12 CONTAINERNR I EGEN FIL
12201 * 39 SH  PTF12 SØK FORETAKSNUMMER
12248 * 40 YBC PTF12 VEKT, KOLLI ER UTVIDET.
12255 * 41 YBC PTF12 F13 = oppgjør av midlertidig import til ordinær utførsel
12XXX * 42 JOV PTF12 Tik ikke med avd/oppd ved kall på SYFA64
12251 * 43 SH  PTF12 gjør om opsjon 22 til https
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SPØRRE PÅ TOLLDEKLARASJONER (EKSPORT)  ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-14 17-24             ***
      *** LEDIGE INDIKATORER 29 31 32 34 35 37-40 52-89 95    ***
      ***********************************************************
      *
N29  Farklogh4  IF   E           K DISK
N10  FCUNDC03   IF A E           K DISK
N05  FEDIM7     IF   E           K DISK    RENAME(EDIMR:EDIMR7)
N16  FEDIM2     IF   E           K DISK    RENAME(EDIMR:EDIMR2)
     FFRISOK    IF   E           K DISK
     FFRISOL01  IF   E           K DISK    RENAME(FRISOKR:FRISOK9)
N41  FSTANDI    IF   E           K DISK    PREFIX(IM_)
N41  FSADH      IF   E           K DISK    PREFIX(IM_)
N41  FSAEHMOL1  IF   E           K DISK
     FSAEH      IF   E           K DISK
N15  FSAEHOM    IF   E           K DISK    RENAME(SAEHR:SAEHROM)
N15  FSAEHO2    IF   E           K DISK    RENAME(SAEHR:SAEHRO2)
N15  F                                     PREFIX(O2_)
     FSAEHOPD   IF   E           K DISK    RENAME(SAEHR:SAEHROPD)
     FSAEH1     IF   E           K DISK    RENAME(SAEHR:SAEH1R)
N07  FSAEH1B    IF   E           K DISK    RENAME(SAEHR:SAEH1BR)
     FSAEH2     IF   E           K DISK    RENAME(SAEHR:SAEH2R)
N07  FSAEH2B    IF   E           K DISK    RENAME(SAEHR:SAEH2BR)
     FSAEH3     IF   E           K DISK    RENAME(SAEHR:SAEH3R)
N07  FSAEH3B    IF   E           K DISK    RENAME(SAEHR:SAEH3BR)
     FSAEH4     IF   E           K DISK    RENAME(SAEHR:SAEH4R)
N07  FSAEH4B    IF   E           K DISK    RENAME(SAEHR:SAEH4BR)
     FSAEH5     IF   E           K DISK    RENAME(SAEHR:SAEH5R)
     FSAEH5B    IF   E           K DISK    RENAME(SAEHR:SAEH5BR)
N27  FSAEH12    IF   E           K DISK    RENAME(SAEHR:SAEH12R)
N27  FSAEH12B   IF   E           K DISK    RENAME(SAEHR:SAEH12BR)
     FSAEH6     IF   E           K DISK    RENAME(SAEHR:SAEH6R)
     FSAEH6B    IF   E           K DISK    RENAME(SAEHR:SAEH6BR)
     FSAEH10    IF   E           K DISK    RENAME(SAEHR:SAEH10R)
S34  F*SAEH10B   IF   E           K DISK    RENAME(SAEHR:SAEH10BR)
N34  FSAEH9     IF   E           K DISK    RENAME(SAEHR:SAEH9R)
N39  FSAEH13    IF   E           K DISK    RENAME(SAEHR:SAEH13R)
N39  FSAEH13B   IF   E           K DISK    RENAME(SAEHR:SAEH13BR)
N35  FSAEH14    IF   E           K DISK    RENAME(SAEHR:SAEH14R)
N35  FSAEH14B   IF   E           K DISK    RENAME(SAEHR:SAEH14BR)
     FSAEH17    IF   E           K DISK    RENAME(SAEHR:SAEH17R)
N07  FSAEH17B   IF   E           K DISK    RENAME(SAEHR:SAEH17BR)
N28  FSAEFNJL1  IF   E           K DISK    RENAME(SAEHR:SAEHRJ1)
N28  F                                     RENAME(SADFR:SAEFRJ1)
N28  FSAEFNJL2  IF   E           K DISK    RENAME(SAEHR:SAEHRJ2)
N28  F                                     RENAME(SADFR:SAEFRJ2)
S38  F*AEMNJL1  IF   E           K DISK    RENAME(SAEVR1:SAEVRJ11)
S38  F*                                    RENAME(SAEVR2:SAEVRJ12)
S38  F*                                    RENAME(SAEVR3:SAEVRJ13)
S38  F*                                    RENAME(SAEVR4:SAEVRJ14)
S38  F*                                    RENAME(SAEVR5:SAEVRJ15)
S38  F*                                    RENAME(SAEVR6:SAEVRJ16)
S38  F*                                    RENAME(SAEVR7:SAEVRJ17)
S38  F*AEMNJL2  IF   E           K DISK    RENAME(SAEVR1:SAEVRJ21)
S38  F*                                    RENAME(SAEVR2:SAEVRJ22)
S38  F*                                    RENAME(SAEVR3:SAEVRJ23)
S38  F*                                    RENAME(SAEVR4:SAEVRJ24)
S38  F*                                    RENAME(SAEVR5:SAEVRJ25)
S38  F*                                    RENAME(SAEVR6:SAEVRJ26)
S38  F*                                    RENAME(SAEVR7:SAEVRJ27)
N38  FSAEVCNL1  IF   E           K DISK    PREFIX(CN_)
N38  FSAEVCNL2  IF   E           K DISK    RENAME(SAEVCNR:SAEVCNR2)
N38  F                                     PREFIX(CN_)
     FSTANDE    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTP     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FFIRMPDF   IF   E           K DISK
     FFIRMARC   IF   E           K DISK
N12  FFREETXT   IF   E           K DISK
S30  F*RACKL02  IF   E           K DISK
n30  FTRACKL02  IF A E           K DISK
     FSAD023FM  CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
N01  F                                     INFDS(FBAREA)
N43  Ffirmgoog  IF   E           K DISK
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
N30  D                 DS
N30  D  XULTID                 1     14  0
N30  D  XULTM                  1      6  0
N30  D  XULDD                  7      8  0
N30  D  XULMM                  9     10  0
N30  D  XULÅÅ                 11     14  0
N30  D                 DS
N30  D  ULÅÅ                   1      4  0
N30  D  ULMM                   5      6  0
N30  D  ULDD                   7      8  0
N30  D  ULDT                   1      8  0
N30  D                SDS
N30  D  UUSR                 254    263
     D                 DS
     D  XDTDD                  1      2  0
     D  XDTMM                  3      4  0
     D  XDTÅÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
EV5  D  XDTÅÅ2                 1      4  0
EV5  D  XDTMM2                 5      6  0
EV5  D  XDTDD2                 7      8  0
EV5  D  XDT                    1      8  0
     D                 DS
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTSÅ                  5      6  0
     D  WSDTS                  1      6  0
     D                 DS
EV5  D  XDTSÅ2                 1      4  0
EV5  D  XDTSM2                 5      6  0
EV5  D  XDTSD2                 7      8  0
EV5  D  XDTS                   1      8  0
     D                 DS
     D  XDTKD                  1      2  0
     D  XDTKM                  3      4  0
     D  XDTKÅ                  5      6  0
     D  WSDTK                  1      6  0
     D                 DS
EV5  D  XDTKÅ2                 1      4  0
EV5  D  XDTKM2                 5      6  0
EV5  D  XDTKD2                 7      8  0
EV5  D  XDTK                   1      8  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTTÅ                  5      6  0
     D  WSDTT                  1      6  0
     D                 DS
EV5  D  XDTTÅ2                 1      4  0
EV5  D  XDTTM2                 5      6  0
EV5  D  XDTTD2                 7      8  0
EV5  D  XDTT                   1      8  0
N39  D                 DS
N39  D  XDTRD                  1      2  0
N39  D  XDTRM                  3      4  0
N39  D  XDTRÅ                  5      6  0
N39  D  WSDTRG                 1      6  0
N39  D                 DS
N39  D  XDTRÅ2                 1      4  0
N39  D  XDTRM2                 5      6  0
N39  D  XDTRD2                 7      8  0
N39  D  XDTRG                  1      8  0
N05  D                 DS
N05  D  XSSD                   1      2  0
N05  D  XSSM                   3      4  0
N05  D  XSSÅ                   5      6  0
N05  D  WSSEKD                 1      6  0
N05  D                 DS
N05  D  XSSÅ2                  1      4  0
N05  D  XSSM2                  5      6  0
N05  D  XSSD2                  7      8  0
N05  D  XSEKDT                 1      8  0
     D                 DS
EV5  D  SEDTÅ                  1      4  0
EV5  D  SEDTM                  5      6  0
EV5  D  SEDTD                  7      8  0
EV5  D  SEDT                   1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSDT2                  1      6  0
     D                 DS
S40  D* SEVKB                  1      9  0
S40  D* WSVKB                  4      9  0
N40  D  SEVKB                  1     11  0
N40  D  SEVKB09                3     11  0
N40  D  WSVKB                  6     11  0
     D                 DS
     D  WSGN15                 1     15
     D  WSAAR                  1      4
     D  WSGN                   5     15
     D                 DS
     D  SENAK                  1     30
S18  D* WSNAK                  1     30
N18  D  WSNAK                  1     26
     D                 DS
s05  D* SETLL                  1     10
S03  D* XSETLL                 1      8
s05  D* XSETLL                 3     10
N15  D                 DS
N15  D  O2_SEDTA               1      4  0
N15  D  O2_SEDTM               5      6  0
N15  D  O2_SEDTD               7      8  0
N15  D  O2_SEDT                1      8  0
N15  D                 DS
N15  D  WSDTD3                 1      2  0
N15  D  WSDTM3                 3      4  0
N15  D  WSDTA3                 5      6  0
N15  D  WSDT3                  1      6  0
N28  D                 DS
N28  D  SEAVD                  1      4  0
N28  D  SFAVD                  1      4  0
N28  D  SVAVD                  1      4  0
N28  D                 DS
N28  D  SETDN                  1      7  0
N28  D  SFOPDN                 1      7  0
N28  D  SVTDN                  1      7  0
N28  D                 DS
N28  D  SEFIF                  1     17
N28  D  SFTXT                  1     17
N28  D                 DS
N28  D  SEFID                  1      8  0
N28  D  SFDT                   1      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     C*
     C                   EXSR      INIT
     C     *IN28         IFEQ      '0'
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      '1'           *IN27
     C                   MOVE      '1'           *IN41
     C                   END
     C*
     C     START0        TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
     C*
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START0
     C                   END
     C*
     C                   EXSR      TESTB1
     C   30              GOTO      START0
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
N10  c                   move      *zeros        LestRec           9 0
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        19
N15  C                   EVAL      O2_SETDN = SETDN * -1
N15  C     SAEHO2K       CHAIN     SAEHO2                             33
N15  C                   IF        *IN33
N15  C                   EVAL      O2_SEST = *BLANKS
N15  C                   EVAL      O2_SEMF = *BLANKS
N18  C                   EVAL      O2_SETLL = *BLANKS
N15  C                   EVAL      WSDT3   = 0
N15  C                   ELSE
N15  C                   EVAL      WSDTD3  = O2_SEDTD
N15  C                   EVAL      WSDTM3  = O2_SEDTM
N15  C                   MOVE      O2_SEDTA      WSDTA3
S25  C*                  IF        O2_SEST <> 'P' OR O2_SEMF = *BLANKS
N25  C                   IF        O2_SETLL = SETLL
N18  C                   EVAL      O2_SETLL = *BLANKS
N18  C                   END
N15  C                   END
      * HVIS CARGO LINK REFERANSE ISTEDEN FOR MOTTAKERNAVN
     C     FRIKEY        CHAIN     FRISOK                             39
     C     *IN39         IFEQ      *OFF
S28  C*                  EVAL      WSNAK = FSSOK
N28  C  N34
N28  CANN35              EVAL      WSNAK = FSSOK
     C                   ENDIF
     C                   ADD       1             ZRECNO
n05  c                   move      setll         xsetll
n05  c   38              moveL     M0068A        xsetll
n05  c                   move      setle         xsetle
n05  c   38              move      M0068B        xsetle
N10  c                   exsr      tstMail
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECN2            5 0
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
N31  C  N94              MOVE      SEAVD         XAVDFF            4 0
N31  C  N94              MOVE      SETDN         XTDNFF            7 0
     C  N94              END
     C                   END
     C*
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C  N27              DO
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
     C*
     C*** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTSAD
     C                   GOTO      START3
     C                   END
N01  C   08              EXSR      SETCUR
     C   08              GOTO      START0
N41  C   13              DO
N41  C                   EXSR      SROPPGJ
N41  C                   IF        *IN45
N41  C                   GOTO      START
N41  C                   ELSE
N41  C                   GOTO      START3
N41  C                   END
N41  C                   ENDDO
     C   15              DO
     C                   MOVE      *BLANKS       W3PRT1
     C                   MOVE      *BLANKS       W3PRT2
     C                   MOVE      *BLANKS       W3PRT3
     C                   CALL      'SAD52P01'
     C                   PARM                    W3PRT1
     C                   PARM                    W3PRT2
     C                   PARM                    W3PRT3
     C                   GOTO      START3
     C                   END
     C   16              DO
     C                   EXSR      CRTSA2
     C                   GOTO      START
     C                   END
     C*  F23 FLERE OPSJONER
     C     *IN23         IFEQ      '1'
     C     *IN77         IFEQ      '1'
     C                   SETOFF                                       77
     C                   ELSE
     C                   SETON                                        77
     C                   END
     C                   GOTO      START3
     C                   END
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
N31  C  N94SAEFFK        CHAIN     SAEHOPD                            33
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2TDN         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2DTT         ORNE      0
     C     W2TLL         ORNE      *BLANKS
     C     W2ST          ORNE      *BLANKS
     C     W2MI          ORNE      *BLANKS
     C     W2GN          ORNE      *BLANKS
N35  C     W2STOMB       ORNE      *BLANKS
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     *IN28         IFEQ      '0'                                            3<-B
     C     W2NR          COMP      1                                      06
     C     W2NR          COMP      11                                     16
     C   06
     COR 16              DO
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     W2TDN         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0046'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYTDN
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TLL
     C                   MOVE      *BLANKS       W2ST
N35  C                   MOVE      *BLANKS       W2STOMB
     C                   MOVE      *BLANKS       W2MI
     C                   MOVE      *BLANKS       W2GN
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C                   GOTO      START3
     C*
     C     SLUTT         TAG
     C     WSAAVD        IFNE      0
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C     WSSG          IFNE      *BLANKS
     C                   MOVE      WSSG          USG
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
N10
N10  C***********************************************
N10  C     TstMail       BEGSR
N10  C***********************************************
N10  c                   move      *off          *in50
N10  c     SEST          ifeq      'P'
N10  c     SEKNK         andne     *zeros
N10  c     MailKey       chain     CUNDC03                            33
N10  c  N33              move      *on           *in50                          Mottar mail
N10  c                   endif
N10  c                   move      *IN50         Xin50             1
N12   *
N12  C     SAEHKO        SETLL     FREETXT
N12  C     SAEHKO        READE     FREETXT                                33
N12  C  N33              SETON                                            36
N12  C   33              SETOFF                                           36
N12  C                   MOVE      *IN36         XIN36             1
N12   *
s29  C*                  EVAL      WSEPJN = ' '
s29  C*    TRACKL02K     CHAIN     TRACKL02                           33
s29  C*                  DOW       *IN33 = *OFF
s29  C*    'custdec'     SCAN      TTTEXT                                 33
s29  C*                  IF        *IN33
s29  C*                  EVAL      WSEPJN = 'J'
s29  C*                  LEAVE
s29  C*                  END
s29  C*    TRACKL02K     READE     TRACKL02                               33
s29  C*                  ENDDO
N14   *
n29   *
n29   * se om epost  er sendt
n29   *
n29  C                   EVAL      WSEPJN = ' '
n29  C     SAEHKO        CHAIN     arklogh4                           33
n29  C  N33              MOVE      'E'           WSEPJN
n29   *
N10  c                   endsr
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   MOVE      *IN28         XIN28             1
     C                   CLEAR                   BILDE01
     C                   MOVE      XIN28         *IN28
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           WSAAR
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          WSAAVD
     C                   ELSE
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C     W2TDN         IFNE      0                                            1<-B
     C                   MOVE      W2TDN         WSTDN
     C                   ELSE                                                   1
     C     W2SG          IFNE      *BLANKS                                       2<-B
     C                   MOVE      W2SG          WSSG
     C                   MOVE      W2DTT         WSDTT
     C                   ELSE                                                    2
     C     W2DTT         IFNE      0                                              3<-B
     C                   MOVE      W2DTT         WSDT
     C                   ELSE                                                     3
     C     W2TLL         IFNE      *BLANKS                                         4<-B
     C                   MOVE      W2TLL         WSTLL
     C                   ELSE                                                      4
     C     W2ST          IFNE      *BLANKS                                          5<-B
     C                   MOVE      W2ST          WSST
     C                   ELSE                                                       5
N35  C     W2STOMB       IFNE      *BLANKS                                          5A<-B
N35  C                   MOVE      W2STOMB       WSSTOMB
N35  C                   ELSE                                                       5A
     C     W2MI          IFNE      *BLANKS                                           6<-B
     C                   MOVE      W2MI          WSMI
     C                   ELSE                                                        6
     C                   MOVE      W2AAR         WSAAR
     C                   MOVE      W2GN          WSGN
     C                   END                                                         6<-E
N35  C                   END                                                        5A<-E
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2TDN
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TLL
     C                   MOVE      *BLANKS       W2ST
N35  C                   MOVE      *BLANKS       W2STOMB
     C                   MOVE      *BLANKS       W2MI
     C                   MOVE      *BLANKS       W2GN
      *
     C                   MOVEA     '0000'        *IN(96)
     C                   EXSR      TESTB1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     NYTDN         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          W2AVD
     C                   END
     C     WRK2K         CHAIN     SAEHOPD                            98
     C   98              DO
     C                   MOVE      'YBC0047'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    2
     C     *IN28         ANDEQ     '0'
     C                   EXSR      CHGSAD
     C     W2NR          WHENEQ    3
     C     *IN28         ANDEQ     '0'
     C                   EXSR      CPYSAD
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPSAD
     C     W2NR          WHENEQ    6
     C                   EXSR      PRTSAD
N26  C     W2NR          WHENEQ    7
N26  C                   EXSR      VISFRIS
     C     W2NR          WHENEQ    8
     C                   EXSR      FAXSAD
     C     W2NR          WHENEQ    9
     C                   EXSR      DSPTVI
     C                   ENDSL
      *
     C     SLTDN         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2TDN
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C     *IN28         IFEQ      '0'                                            3<-B
     C                   SELECT
     C     WSNR          WHENEQ    2
     C                   MOVE      '1'           *IN99
     C                   EXSR      CHGSAD
     C     WSNR          WHENEQ    3
     C                   MOVE      '1'           *IN99
     C                   EXSR      CPYSAD
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPSAD
     C     WSNR          WHENEQ    6
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSAD
N26  C     WSNR          WHENEQ    7
N26  C                   MOVE      '1'           *IN99
N26  C                   EXSR      VISFRIS
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      FAXSAD
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
N15  C     WSNR          WHENEQ    12
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      TESTB2
N15  C                   IF        *IN30
N15  C                   UPDATE    SUBFIL
N15  C                   GOTO      SLHENT
N15  C                   END
N15  C                   EXSR      CHGOMB
N15  C     WSNR          WHENEQ    15
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      DSPOMB
N19  C     WSNR          WHENEQ    16
N19  C                   MOVE      '1'           *IN99
N19  C                   EXSR      PRTOMB
N24  C     WSNR          WHENEQ    17
N24  C                   MOVE      '1'           *IN99
N24  C                   EXSR      ANGOMB
      *
n32   * wsnr = 19  VIS EPOST
n32   *
n32  C     WSNR          WHENEQ    19
n32  C     WSEPJN        IFEQ      'E'
n32  C                   EXSR      DSPEPO
n32  c                   else
n32  C                   MOVE      '1'           *IN30
n32  C                   MOVE      'SHU1729'     MSGNR
n32  C                   MOVE      *ZEROS        WSNR
N32  C                   MOVE      XIN50         *IN50
n32  C                   MOVE      XIN36         *IN36
n32  C                   UPDATE    SUBFIL
n32  C                   GOTO      SLHENT
n32  c                   end
      *
N12  C     WSNR          WHENEQ    18
N12  C                   EXSR      WRKFT
     C     WSNR          WHENEQ    22
N43  C     FIFIRM        CHAIN     FIRMGOOG                           30
     C     FIFIRM        CHAIN     FIRMARC                            30
     C     FIFIRM        CHAIN     FIRMPDF                            30
     C                   MOVE      '1'           *IN99
     C   30              MOVE      'SHU0830'     MSGNR
     C   30              MOVE      *ZEROS        WSNR
N10  C   30              MOVE      XIN50         *IN50
N12  C   30              MOVE      XIN36         *IN36
     C   30              UPDATE    SUBFIL
     C   30              GOTO      SLHENT
     C                   EXSR      PDFSAD
N36  C     WSNR          WHENEQ    25
N36  C                   MOVE      '1'           *IN99
N36  C                   EXSR      SRTT
     C     WSNR          WHENEQ    31
N13  C                   MOVE      '1'           *IN99
N13  C                   EXSR      WRKNCTS
     C     WSNR          WHENEQ    52
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSKILL
     C     WSNR          WHENEQ    51
     C                   MOVE      '1'           *IN99
     C                   EXSR      arkivs
N09  C     WSNR          WHENEQ    55
N09  C                   MOVE      '1'           *IN99
N09  C                   EXSR      DSPWEB
      * resending av XML
      *
N30  C     WSNR          WHENEQ    88
N30  C     SEST          IFEQ      'P'
N30  c                   move      'N'           xmlstat           1
N30  C                   setoff                                       33
N30  c     Mailkey       setll     CUNDC03
N30  C     *in33         doweq     '0'
N30  c     MailKey       reade     CUNDC03                                33
N30  c     *in33         ifeq      '0'
N30  c     clive         andeq     'X'
N30  c     CFAX          andne     *blanks
N30  c                   move      'J'           xmlstat
N30  C                   MOVE      '1'           *IN99
N30  C                   seton                                        33
N30  C                   EXSR      XMLSR
N30  c                   endif
N30  c                   enddo
N30  c     xmlstat       ifeq      'N'
N30  C                   MOVE      '1'           *IN30
N30  C                   MOVE      'SHU1714'     MSGNR
N30  C                   MOVE      *ZEROS        WSNR
N30  C                   MOVE      XIN50         *IN50
N30  C                   MOVE      XIN36         *IN36
N30  C                   UPDATE    SUBFIL
N30  C                   GOTO      SLHENT
N30  C                   END
N30  C                   END
N30   * slutt 88
      *       89 omberegning til emma
N30  C     WSNR          WHENEQ    89
N30  C     SEST          IFEQ      'P'
N30  C     O2_SETLL      andne     *blanks
N30  c                   move      'N'           xmlstat           1
N30  C                   setoff                                       33
N30  c     Mailkey       setll     CUNDC03
N30  C     *in33         doweq     '0'
N30  c     MailKey       reade     CUNDC03                                33
N30  c     *in33         ifeq      '0'
N30  c     clive         andeq     'X'
N30  c     CFAX          andne     *blanks
N30  c                   move      'J'           xmlstat
N30  C                   MOVE      '1'           *IN99
N30  C                   seton                                        33
N30  C                   EXSR      XMLSR
N30  c                   endif
N30  c                   enddo
N30  c     xmlstat       ifeq      'N'
N30  C                   MOVE      '1'           *IN30
N30  C                   MOVE      'SHU1714'     MSGNR
N30  C                   MOVE      *ZEROS        WSNR
N30  C                   MOVE      XIN50         *IN50
N30  C                   MOVE      XIN36         *IN36
N30  C                   UPDATE    SUBFIL
N30  C                   GOTO      SLHENT
N30  C                   END
N30  C                   END
N30   * slutt 89
     C                   ENDSL
     C                   ELSE                                                     3
     C                   SELECT
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPSAD
     C     WSNR          WHENEQ    6
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSAD
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      FAXSAD
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
N15  C     WSNR          WHENEQ    15
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      DSPOMB
N19  C     WSNR          WHENEQ    16
N19  C                   MOVE      '1'           *IN99
N19  C                   EXSR      PRTOMB
     C     WSNR          WHENEQ    22
N43  C     FIFIRM        CHAIN     FIRMGOOG                           30
     C     FIFIRM        CHAIN     FIRMARC                            30
     C     FIFIRM        CHAIN     FIRMPDF                            30
     C                   MOVE      '1'           *IN99
     C   30              MOVE      'SHU0830'     MSGNR
     C   30              MOVE      *ZEROS        WSNR
N10  C   30              MOVE      XIN50         *IN50
N12  C   30              MOVE      XIN36         *IN36
     C   30              UPDATE    SUBFIL
     C   30              GOTO      SLHENT
     C                   EXSR      PDFSAD
N36  C     WSNR          WHENEQ    25
N36  C                   MOVE      '1'           *IN99
N36  C                   EXSR      SRTT
     C     WSNR          WHENEQ    52
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSKILL
     C     WSNR          WHENEQ    51
     C                   MOVE      '1'           *IN99
     C                   EXSR      arkivs
N09  C     WSNR          WHENEQ    55
N09  C                   MOVE      '1'           *IN99
N09  C                   EXSR      DSPWEB
     C                   ENDSL
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNK
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNS
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      11
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNK
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     55            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      12
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     55            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
N01   ***********************************************
N01  C     SETCUR        BEGSR
N01   ***********************************************
N01  C                   Z-ADD     35            POSNBR
N01  C                   SELECT
N01  C                   WHEN      WFSSOK <> *BLANKS
N01  C                   Z-ADD     8             LINNBR
N01  C                   WHEN      WSDT   <> 0
N01  C                   Z-ADD     9             LINNBR
N01  C                   WHEN      WSTDN  <> 0
N01  C                   Z-ADD     10            LINNBR
N01  C                   WHEN      WSKNK  <> 0
N01  C                   Z-ADD     11            LINNBR
N01  C                   WHEN      WSKNS  <> 0
N01  C                   Z-ADD     12            LINNBR
N01  C                   WHEN      WSSG   <> *BLANKS
N01  C                   Z-ADD     13            LINNBR
N01  C                   WHEN      WSTLL  <> *BLANKS
N01  C                   Z-ADD     14            LINNBR
N01  C                   WHEN      WSGN   <> *BLANKS
E27  C                   Z-ADD     16            LINNBR
N01  C                   WHEN      WSST   <> *BLANKS
E27  C                   Z-ADD     17            LINNBR
N35  C                   WHEN      WSSTOMB <> *BLANKS
N35  C                   Z-ADD     17            LINNBR
N35  C                   Z-ADD     60            POSNBR
N01  C                   WHEN      WSMI   <> *BLANKS
E27  C                   Z-ADD     18            LINNBR
N01  C                   OTHER
N01  C                   Z-ADD     8             LINNBR
N01  C                   ENDSL
N01   *
N01  C                   ENDSR
N01   *
     C***********************************************
     C     DSPSAD        BEGSR
     C***********************************************
     C                   CALL      'SAD023A'
S28  C*                  PARM                    SEAVD
S28  C*                  PARM                    SETDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGSAD        BEGSR
     C***********************************************
     C                   MOVE      'CHG'         XTYPE             3
N17  C                   IF        WSDT3 = 0
     C                   CALL      'SAD052CL'
     C                   PARM      SEAVD         XAVD
     C                   PARM      SETDN         XTDN
     C                   PARM                    SESG
     C                   PARM                    UKODE
     C                   PARM                    XTYPE
N17  C                   END
     C     SAEHKO        CHAIN     SAEHOPD                            33
N04  C     FRIKEY        CHAIN     FRISOK                             39
N04  C     *IN39         IFEQ      *OFF
N04  C                   EVAL      WSNAK = FSSOK
N04  C                   ENDIF
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CPYSAD        BEGSR
     C***********************************************
     C                   MOVE      'CPY'         XTYPE             3
     C     *LIKE         DEFINE    SEAVD         XAVD
     C     *LIKE         DEFINE    SETDN         XTDN
     C                   MOVE      SEAVD         XAVD
     C                   MOVE      SETDN         XTDN
     C                   CALL      'SAD052CL'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    UKODE
     C                   PARM                    XTYPE
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C     XTDN          IFNE      0
     C     XAVD          IFNE      SEAVD
     C     XTDN          ORNE      SETDN
     C     SAEHKC        CHAIN     SAEHOPD                            33
N04  C     FRIKEY        CHAIN     FRISOK                             39
N04  C     *IN39         IFEQ      *OFF
N04  C                   EVAL      WSNAK = FSSOK
N04  C                   ENDIF
     C                   MOVE      SEDTD         WSDTD2
     C                   MOVE      SEDTM         WSDTM2
     C                   MOVE      SEDTÅ         WSDTÅ2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
n05  c                   move      setll         xsetll
n05  c   38              moveL     M0068A        xsetll
n05  c                   move      setle         xsetle
n05  c   38              move      M0068B        xsetle
N10  c                   exsr      tstMail
     C                   WRITE     SUBFIL
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CRTSAD        BEGSR
     C***********************************************
     C                   MOVE      'CRT'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'SAD052CL'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    UKODE
     C                   PARM                    XTYPE
     C     XAVD          IFNE      0
     C     XTDN          ANDNE     0
     C     SAEHKC        CHAIN     SAEHOPD                            33
     C  N33              DO
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
N04  C     FRIKEY        CHAIN     FRISOK                             39
N04  C     *IN39         IFEQ      *OFF
N04  C                   EVAL      WSNAK = FSSOK
N04  C                   ENDIF
     C                   MOVE      SEDTD         WSDTD2
     C                   MOVE      SEDTM         WSDTM2
     C                   MOVE      SEDTÅ         WSDTÅ2
n08  c                   move      setll         xsetll
n08  c                   move      setle         xsetle
N24  C                   EVAL      WSEPJN   = *BLANKS
N24  C                   EVAL      O2_SEMF  = *BLANKS
N24  C                   EVAL      O2_SEST  = *BLANKS
N24  C                   EVAL      O2_SETLL = *BLANKS
N24  C                   EVAL      WSDT3    = 0
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
N10  c                   exsr      tstMail
     C                   WRITE     SUBFIL
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CRTSA2        BEGSR
     C***********************************************
     C                   MOVE      'CR2'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'SAD052CL'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    UKODE
     C                   PARM                    XTYPE
      *
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRTSAD        BEGSR
     C***********************************************
N16  C                   IF        SEST = 'M'
N16  C     SAEHKO        CHAIN     EDIM2                              33
N16  C                   DOW       *IN33 = *OFF
N16  C                   IF        M1001='830' AND MSR='R' AND M1N07<>'DFI'
N16  C                   LEAVE
N16  C                   END
N16  C     SAEHKO        READE     EDIM2                                  33
N16  C                   ENDDO
N16  C   33              EVAL      SEST = ' '
N16  C                   END
N16   *
     C     SEST          IFEQ      ' '
     C     SEST          OREQ      'P'
     C     SEST          OREQ      'U'
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    SEAVD
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI
     C                   Z-ADD     91            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      KOPNVN        W3PRT1
     C                   Z-ADD     92            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      KOPNVN        W3PRT2
     C                   Z-ADD     93            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      KOPNVN        W3PRT3
     C                   EXFMT     BILDE02
     C   12              GOTO      SLPRT
     C                   MOVE      'PRT'         XTYPE             3
     C     *IN28         IFEQ      '1'
     C                   CALL      'SAD052CO'
S28  C*                  PARM                    SEAVD
S28  C*                  PARM                    SETDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
     C                   PARM                    USG
     C                   PARM                    UKODE
     C                   PARM                    XTYPE
     C                   MOVE      'H'           PRTTYP            1
     C                   CALL      'SAD52P'
     C                   PARM                    PRTTYP            1
     C                   PARM                    PRTAVD            4
     C                   PARM                    PRTTDN            7
     C                   PARM                    W3PRT1
     C                   PARM                    W3PRT2
     C                   PARM                    W3PRT3
     C     SAEHKO        CHAIN     SAEHOPD                            33
     C                   ELSE
     C                   CALL      'SAD052CL'
S28  C*                  PARM                    SEAVD
S28  C*                  PARM                    SETDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
     C                   PARM                    USG
     C                   PARM                    UKODE
     C                   PARM                    XTYPE
     C     SAEHKO        CHAIN     SAEHOPD                            33
     C                   CALL      'SAD52P01'
     C                   PARM                    W3PRT1
     C                   PARM                    W3PRT2
     C                   PARM                    W3PRT3
     C                   END
     C     SLPRT         TAG
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
N19   ***********************************************
N19  C     PRTOMB        BEGSR
N19   ***********************************************
N19  C     O2_SEST       IFEQ      'P'
N19  C                   MOVE      'P'           KOPUNI
N19  C                   Z-ADD     91            KOPLNR
N19  C     KODTPK        CHAIN     KODTP                              33
N19  C                   MOVE      KOPNVN        W3PRT1
N19  C                   Z-ADD     92            KOPLNR
N19  C     KODTPK        CHAIN     KODTP                              33
N19  C                   MOVE      KOPNVN        W3PRT2
N19  C                   Z-ADD     93            KOPLNR
N19  C     KODTPK        CHAIN     KODTP                              33
N19  C                   MOVE      KOPNVN        W3PRT3
N19  C                   EXFMT     BILDE02
N19  C   12              GOTO      SLPRTOMB
N19  C                   MOVE      'PRT'         XTYPE             3
N19  C                   EVAL      SETDN = SETDN * -1
N19  C     *IN28         IFEQ      '1'
N19  C                   CALL      'SAD052CO'
S28  C*                  PARM                    SEAVD
S28  C*                  PARM                    SETDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
N19  C                   PARM                    USG
N19  C                   PARM                    UKODE
N19  C                   PARM                    XTYPE
N19  C                   MOVE      'H'           PRTTYP            1
N19  C                   CALL      'SAD52P'
N19  C                   PARM                    PRTTYP            1
N19  C                   PARM                    PRTAVD            4
N19  C                   PARM                    PRTTDN            7
N19  C                   PARM                    W3PRT1
N19  C                   PARM                    W3PRT2
N19  C                   PARM                    W3PRT3
N19  C                   EVAL      SETDN = SETDN * -1
N19  C     SAEHKO        CHAIN     SAEHOPD                            33
N19  C                   ELSE
N19  C                   CALL      'SAD052CL'
S28  C*                  PARM                    SEAVD
S28  C*                  PARM                    SETDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
N19  C                   PARM                    USG
N19  C                   PARM                    UKODE
N19  C                   PARM                    XTYPE
N19  C                   EVAL      SETDN = SETDN * -1
N19  C     SAEHKO        CHAIN     SAEHOPD                            33
N19  C                   CALL      'SAD52P01'
N19  C                   PARM                    W3PRT1
N19  C                   PARM                    W3PRT2
N19  C                   PARM                    W3PRT3
N19  C                   END
N19  C     SLPRTOMB      TAG
N19  C                   END
N19  C  N90              MOVE      *ZEROS        WSNR
N19  C  N90              MOVE      XIN50         *IN50
N19  C  N90              MOVE      XIN36         *IN36
N19  C  N90              UPDATE    SUBFIL
N19   *
N19  C                   ENDSR
N19   *
     C***********************************************
     C     DSPTVI        BEGSR
     C***********************************************
     C                   MOVE      '1'           WIN03             1
     C                   CALL      'SAD003'
S28  C*                  PARM      SEAVD         SEAVD
S28  C*                  PARM      SETDN         SETDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
     C                   PARM                    WIN03
     C     WIN03         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
N12   ***********************************************
N12  C     WRKFT         BEGSR
N12   ***********************************************
N12  C                   Z-ADD     0             UFLAGG
N12  C                   CALL      'SYFA31CL'
N12  C                   PARM      SEAVD         UAVD2
N12  C                   PARM      SETDN         UOPD2
N12  C                   PARM                    UFLAGG
N12   *
N12  C  N90              MOVE      *ZEROS        WSNR
N12  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
N12  C  N90              UPDATE    SUBFIL
N12   *
N12  C                   ENDSR
N12   *
N15   ***********************************************
N15  C     DSPOMB        BEGSR
N15   ***********************************************
N15  C                   Z-ADD     SEAVD         XAVD
N15  C                   Z-SUB     SETDN         O2_SETDN
N15  C     SAEHO2K       CHAIN     SAEHO2                             33
N15  C                   IF        *IN33 = *OFF
N15  C                   Z-SUB     SETDN         XTDN
N15  C                   CALL      'SAD023A'
N15  C                   PARM                    XAVD
N15  C                   PARM                    XTDN
N15  C                   PARM                    UFLAGG            1 0
S25  C*                  IF        O2_SEST <> 'P'
N25  C                   IF        O2_SETLL = SETLL
N20  C                   EVAL      O2_SETLL = *BLANKS
N20  C                   END
N15  C                   END
N15  C  N90              MOVE      *ZEROS        WSNR
N15  C  N90              MOVE      XIN50         *IN50
N15  C  N90              MOVE      XIN36         *IN36
N15  C  N90              UPDATE    SUBFIL
N15   *
N15  C                   ENDSR
N15   *
N15   ***********************************************
N15  C     CHGOMB        BEGSR
N15   ***********************************************
N15  C                   IF        SEDTG <> *BLANKS AND SETLL <> *BLANKS
N15  C                   MOVE      'OMB'         XTYPE             3
N15  C                   Z-ADD     SEAVD         XAVD
N15  C                   Z-SUB     SETDN         XTDN
N15  C                   Z-SUB     SETDN         O2_SETDN
N15  C     SAEHO2K       CHAIN     SAEHO2                             33
N15  C                   IF        *IN33 OR O2_SEST = ' ' OR O2_SEST = 'M' OR
N21  C                             O2_SEST = 'Q' OR
N21  C                             O2_SEST = 'P' AND O2_SEMF = *BLANKS
N31  C                             OR O2_SEST = 'P' AND O2_SETLL = SETLL
S21  C*                            O2_SEST = 'Q'
N15  C                   CALL      'SAD052COM'
N15  C                   PARM                    XAVD
N15  C                   PARM                    XTDN
N15  C                   PARM                    USG
N15  C                   PARM                    XTYPE
N24  C                   ELSE
N24  C                   IF        (O2_SEST = 'P' AND O2_SEMF <> *BLANKS)
N24  C                             OR (O2_SEST = 'Z' AND O2_SEMF <> *BLANKS)
N24  C                   EVAL      WSNYOMB = 'N'
N24  C                   EVAL      WSSOMB  = 'J'
N24  C                   EXFMT     BNYOMB
N24  C                   IF        WSNYOMB = 'J'
N24  C                   IF        WSSOMB = 'J'
N24  C                   MOVE      'NYS'         XTYPE             3
N24  C                   ELSE
N24  C                   MOVE      'NYO'         XTYPE
N24  C                   END
N24  C                   CALL      'SAD052COM'
N24  C                   PARM                    XAVD
N24  C                   PARM                    XTDN
N24  C                   PARM                    USG
N24  C                   PARM                    XTYPE
N24  C                   END
N24  C                   END
N15  C                   END
N15  C                   END
N15   *
N15  C                   EVAL      O2_SETDN = SETDN * -1
N15  C     SAEHO2K       CHAIN     SAEHO2                             33
N15  C                   IF        *IN33
N15  C                   EVAL      O2_SEMF = *BLANKS
N15  C                   EVAL      O2_SEST = *BLANKS
N15  C                   EVAL      WSDT3   = 0
N15  C                   ELSE
S25  C*                  IF        O2_SEST <> 'P'
N25  C                   IF        O2_SETLL = SETLL
N20  C                   EVAL      O2_SETLL = *BLANKS
N24  C                   END
N15  C                   EVAL      WSDTD3  = O2_SEDTD
N15  C                   EVAL      WSDTM3  = O2_SEDTM
N15  C                   MOVE      O2_SEDTA      WSDTA3
N15  C                   END
N15  C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N15  C     FRIKEY        CHAIN     FRISOK                             39
N15  C     *IN39         IFEQ      *OFF
N15  C                   EVAL      WSNAK = FSSOK
N15  C                   ENDIF
N15  C  N90              MOVE      *ZEROS        WSNR
N15  C  N90              MOVE      XIN50         *IN50
N15  C  N90              MOVE      XIN36         *IN36
N15  C  N90              UPDATE    SUBFIL
N15   *
N15  C                   ENDSR
N15   *
N24   ***********************************************
N24  C     ANGOMB        BEGSR
N24   ***********************************************
N24  C                   IF        SEDTG <> *BLANKS AND SETLL <> *BLANKS
N24  C                   MOVE      'NYA'         XTYPE             3
N24  C                   Z-ADD     SEAVD         XAVD
N24  C                   Z-SUB     SETDN         XTDN
N24  C                   Z-SUB     SETDN         O2_SETDN
N24  C     SAEHO2K       CHAIN     SAEHO2                             33
N24  C  N33              IF        (O2_SEST = ' ' OR O2_SEST = 'M')
N24  C                             AND O2_SETLL = SETLL
N24  C                   CALL      'SAD054'
N24  C                   PARM                    XAVD
N24  C                   PARM                    XTDN
N24  C                   PARM                    USG
N24  C                   PARM                    XTYPE
N24  C                   END
N24  C                   END
N24   *
N24  C                   EVAL      O2_SETDN = SETDN * -1
N24  C     SAEHO2K       CHAIN     SAEHO2                             33
N24  C                   IF        *IN33
N24  C                   EVAL      O2_SEMF = *BLANKS
N24  C                   EVAL      O2_SEST = *BLANKS
N24  C                   EVAL      WSDT3   = 0
N24  C                   ELSE
S25  C*                  IF        O2_SEST <> 'P'
N25  C                   IF        O2_SETLL = SETLL
N24  C                   EVAL      O2_SETLL = *BLANKS
N24  C                   END
N24  C                   EVAL      WSDTD3  = O2_SEDTD
N24  C                   EVAL      WSDTM3  = O2_SEDTM
N24  C                   MOVE      O2_SEDTA      WSDTA3
N24  C                   END
N24  C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N24  C     FRIKEY        CHAIN     FRISOK                             39
N24  C     *IN39         IFEQ      *OFF
N24  C                   EVAL      WSNAK = FSSOK
N24  C                   ENDIF
N24  C  N90              MOVE      *ZEROS        WSNR
N24  C  N90              MOVE      XIN50         *IN50
N24  C  N90              MOVE      XIN36         *IN36
N24  C  N90              UPDATE    SUBFIL
N24   *
N24  C                   ENDSR
N24   *
     C***********************************************
     C     PDFSAD        BEGSR
     C***********************************************
     C                   MOVE      SEAVD         AAVD              4
     C                   MOVE      SETDN         ATDN              7
     C                   MOVE      'E'           TDTYP             1
     C                   move      *blanks       ubane            50
     C                   move      *blanks       updf
N33  C                   move      *blanks       ubane2           50
N33  C                   move      *blanks       updf2           152
s33  c*                  movel     'http://'     updf             70
S43  c*                  movel     'http://'     updf            152
N43  c                   movel     'https://'    updf            152
S43  C*    updf          CAT       pdipad:0      updf
N43  C     updf          CAT       ARCPAD:0      updf
N43  c     gotmpf        ifeq      *blanks
     C     updf          CAT       '/':0         updf
     C     updf          CAT       pdbane:0      updf
     C     updf          CAT       '/':0         updf
N43  c                   else
N43  C     updf          CAT       gotmpf:0      updf
N43  c                   end
     C     updf          CAT       aavd:0        updf
     C     updf          CAT       atdn:0        updf
N33  C                   eval      updf2=updf
     C     updf          CAT       'si':0        updf
N33  C     updf2         CAT       'dt':0        updf2
     C     updf          CAT       '.pdf':0      updf
N33  C     updf2         CAT       '.pdf':0      updf2
N43  c     gotmpf        ifeq      *blanks
     C                   movel     '/'           ubane
     C     ubane         CAT       pdbane:0      ubane
     C     ubane         CAT       '/':0         ubane
N43  c                   else
N43  C     ubane         CAT       gotmpf:0      ubane
N43  c                   end
     C     ubane         CAT       aavd:0        ubane
     C     ubane         CAT       atdn:0        ubane
N33  c                   eval      ubane2=ubane
     C     ubane         CAT       'si':0        ubane
N33  C     ubane2        CAT       'dt':0        ubane2
     C     ubane         CAT       '.pdf':0      ubane
N33  C     ubane2        CAT       '.pdf':0      ubane2
s33  c*                  move      'J'           vise
s33  C*                  CALL      'PDF001CL'
n33  C                   CALL      'PDF001CLD'
     C                   PARM                    AAVD
     C                   PARM                    ATDN
     C                   PARM                    TDTYP
     C                   PARM                    updf
     C                   PARM                    ubane
n33  C                   PARM                    updf2
n33  C                   PARM                    ubane2
s33  C*                  parm                    vise              1
s33  C*                  parm                    finst             1
s33  C*                  parm                    finst             1
s33  C*                  parm                    ARCINF            1
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              update    subfil
     C                   CALL      'ARC003'
     C                   PARM      SEAVD         UAVD2             4 0
     C                   PARM      SETDN         UOPD2             7 0
     C                   PARM                    URUNDE           10
     C                   ENDSR
N09
      *
N30   ***********************************************
N30  C     XMLSR         BEGSR
N30   ***********************************************
N30  C                   MOVE      SEAVD         AAVD
N30  C                   MOVE      SETDN         ATDN
N30  c     wsnr          ifeq      89
N30  c                   z-sub     setdn         setdnm            7 0
N30  C                   MOVE      SETDNM        ATDN
N30  c                   end
N30  C                   MOVE      'E'           TDTYP             1
N30  C  N90              move      *zeros        wsnr
N30  C  N90              MOVE      XIN50         *IN50
N30  C  N90              MOVE      XIN36         *IN36
N30  C  N90              update    subfil
N30  C                   CALL      'PDF001CL3'
N30  C                   PARM                    AAVD
N30  C                   PARM                    ATDN
N30  C                   PARM                    TDTYP
N30  C                   EXSR      TTSR
N30  C                   ENDSR
N30   ************************************************************
N30  C     TTSR          begsr
N30   ************************************************************
N30  c                   clear                   trackfr
N30   * skriver til track & trace
N30  C                   eval      tttext='Re-Transferred XML of custdec to:'
N30  C     tttext        cat       CFAX:1        tttext
N30  C                   move      CCOMPN        tttext
N30  C                   eval      tttexl='Re-Overført XML av tolldek til:'
N30  C     tttexl        cat       CFAX:1        tttexl
N30  C                   move      CCOMPN        tttexl
N30  C                   MOVE      'XML'         TTACTI
N30   * OPPDRAG OPPRETTET (POST I FIL TRACKF)
N30  C                   MOVE      AAVD          TTAVD
N30  C                   MOVE      ATDN          TTOPD
N30  C                   TIME                    XULTID
N30  C                   MOVE      XULDD         ULDD
N30  C                   MOVE      XULMM         ULMM
N30  C                   MOVE      XULÅÅ         ULÅÅ
N30  C                   MOVE      ULDT          TTDATE
N30  C                   MOVE      XULTM         TTTIME
N30  C                   MOVE      TTDATE        TTDATL
N30  C                   MOVE      TTTIME        TTTIML
N30  C                   MOVE      UUSR          TTUSER
N30  C                   MOVEL     SENAS         TTNAME
N30  C                   WRITE     TRACKFR
N30  C                   ENDSR
N09   ***********************************************
N09  C     DSPWEB        BEGSR
N09   ***********************************************
N09  C  N90              move      *zeros        wsnr
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
N09  C  N90              update    subfil
N09  C                   EVAL      Overskr = 'Se SYSPED oppdrag på WEB (eSped) '
N09  C                   EVAL      WebType = 'ESPEO'
N09  C                   move      SEAVD         HEAVDA            4
N09  C                   move      SETDN         HEOPDA            7
N09  C                   EVAL      WebSok  = '&heavd='+HEAVDA+
N09  C                             '&heopd='+HEOPDA
N09  C                   CALL      'WEBLINKR'
N09  C                   PARM                    Overskr          40
N09  C                   PARM                    WebType           5
N09  C                   PARM                    WebSok           50
N09  C                   ENDSR
N13   ***********************************************
N13  C     WRKNCTS       BEGSR
N13   ***********************************************
N13  C                   IF        SEST = 'P' OR SEST = 'U'
N13  C                   IF        SEDTG <> *BLANKS AND SETLL <> *BLANKS
N13  C                   MOVE      'CRT'         XTYPE             3
N13  C                   MOVE      'I'           UIE               1
N13  C                   CALL      'TR011C'
N13  C                   PARM      SEAVD         XAVD
N13  C                   PARM      SETDN         XTDN
N13  C                   PARM                    UPRO              8 0
N13  C                   PARM                    SESG
N13  C                   PARM                    XTYPE
N13  C                   PARM                    UIE
N13  C                   PARM                    UFLAGG            1 0
N13  C                   END
N13  C                   END
N13  C  N90              MOVE      *ZEROS        WSNR
N13  C  N90              MOVE      XIN50         *IN50
N13  C  N90              MOVE      XIN36         *IN36
N13  C  N90              UPDATE    SUBFIL
N13   *
N13  C                   ENDSR
N13   *
N36   ***********************************************
N36  C     SRTT          BEGSR
N36   ***********************************************
N36  C  N90              MOVE      *ZEROS        WSNR
N36  C  N90              MOVE      XIN50         *IN50
N36  C  N90              MOVE      XIN36         *IN36
N36  C  N90              UPDATE    SUBFIL
N36   * T&T å oppdragsnivå.
N36  C                   Z-ADD     1             TTFLAG            1 0
N36  C                   CALL      'SYTT01CL'
N36  C                   PARM      SEAVD         U_AVD             4 0
N36  C                   PARM      SETDN         U_TDN             7 0
N36  C                   PARM                    NULPRO            8 0
N36  C                   PARM                    TTFLAG
N36  C                   ENDSR
      ***********************************************
     C     PRTSKILL      BEGSR
      ***********************************************
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C                   MOVE      '  '          SCATYP            2
s32  C*                  MOVEL     SEAVD         SCASTR9           9
s32  C*                  MOVE      SETDN         SCASTR9           9
N32  C                   MOVEL     SEAVD         SCASTR9          11
N32  C                   MOVE      SETDN         SCASTR9          11
     C                   MOVEL     SCASTR9       SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KOANVN
     C     WSAAVD        IFNE      0
     C     WSTDN         ORNE      0
     C     WSAAVD        CHAIN     STANDE                             99
     C  N99KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB1
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C*
s05  C*                  MOVEA     '000000000'   *IN(41)
n05  C                   MOVEA     '000000000000'*IN(38)
n39  C                   MOVEA     '0'           *IN(37)
N35  C                   MOVEA     '0'           *IN(51)
N28  C                   MOVEA     '00'          *IN(34)
     C*
N27  C                   MOVE      WSTLE         WSTLEA            6
     C     WFSSOK        comp      *BLANKS                            4040
N06  C   40              EVAL      WFSSOKMAX = %TRIM(WFSSOK)
N06  C                             + '9999999999999999999999999999999999'
     C   40              GOTO      STTB1
     C     WSDT          COMP      *ZEROS                             4141
     C   41              GOTO      STTB1
     C     WSTDN         COMP      *ZEROS                             4242
     C   42              GOTO      STTB1
     C     WSKNK         COMP      *ZEROS                             4343
     C   43              GOTO      STTB1
     C     WSKNS         COMP      *ZEROS                             4444
     C   44              GOTO      STTB1
     C     WSSG          COMP      *BLANKS                            4545
     C   45              GOTO      STTB1
     C     WSTLL         COMP      *BLANKS                            4646
     C   46              GOTO      STTB1
     C     WSGN          COMP      *BLANKS                            4747
     C   47              GOTO      STTB1
     C     WSST          COMP      *BLANKS                            4949
     C   49              GOTO      STTB1
N35  C     WSSTOMB       COMP      *BLANKS                            5151
N35  C   51              GOTO      STTB1
     C     WSMI          COMP      *BLANKS                            4848
     C   48              GOTO      STTB1
N05  C     WSSEKV        COMP      0                                  38
n05  C   38WSSEKD        COMP      0                                  38
n05  C   38              GOTO      STTB1
n39  C     WSRG          COMP      *BLANKS                            3737
n39  C   37              eval      koanvn='Foretaksnr:'
n39  C   37koanvn        cat       wsrg:1        koanvn
n39  C   37              GOTO      STTB1
N28  C     WSFN          COMP      *BLANKS                            3535
N28  C   35              GOTO      STTB1
N28  C     WSMRK         COMP      *BLANKS                            3434
N28  C   34              GOTO      STTB1
     C*
     C                   MOVE      'DIV0064'     MSGNR
     C                   SETON                                        3098
     C                   GOTO      SLTB1
     C*
     C     STTB1         TAG
     C   43              MOVE      WSKNK         KUNDNR
     C   43KUNDK         CHAIN     CUNDL01                            97
     C   97              MOVE      'SPK0035'     MSGNR
     C   44              MOVE      WSKNS         KUNDNR
     C   44KUNDK         CHAIN     CUNDL01                            96
     C   96
     CANN97              MOVE      'SPK0035'     MSGNR
     C   97
     COR 96              SETON                                        30
     C*
     C     SLTB1         ENDSR
     C*
N15   ***********************************************
N15  C     TESTB2        BEGSR
N15   ***********************************************
N15  C                   IF        (SEST<>'P' AND SEST<>'U' AND SEST<>' ') OR
N15  C                             SEDTG = *BLANKS OR SETLL = *BLANKS OR
N15  C                             (O2_SEST <> ' ' AND O2_SEST <> 'M' AND
N24  C                              O2_SEST <> 'Z' AND
N21  C                              O2_SEST <> 'Q' AND O2_SEST <> 'P' )
S24  C*                            OR (O2_SEST = 'P' AND O2_SEMF <> *BLANKS)
S21  C*                             O2_SEST <> 'Q')
N15  C                   MOVE      '1'           *IN30
N15  C                   MOVE      'YBC2011'     MSGNR
N15  C                   MOVE      *ZEROS        WSNR
N15  C                   MOVE      XIN50         *IN50
N15  C                   MOVE      XIN36         *IN36
N15  C                   GOTO      SLTB2
N15  C                   END
N15   *
N15   *
N15  C     SLTB2         ENDSR
N15   *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C   41              DO
NV5  C     WSDT          IFEQ      0
NV5  C                   MOVE      *ZEROS        XDT
NV5  C                   ELSE
     C                   MOVE      XDTDD         XDTDD2
     C                   MOVE      XDTMM         XDTMM2
SV5  C*                    MOVE XDTÅÅ     XDTÅÅ2
NV5  C     XDTÅÅ         IFGT      50
NV5  C     XDTÅÅ         ADD       1900          XDTÅÅ2
NV5  C                   ELSE
NV5  C     XDTÅÅ         ADD       2000          XDTÅÅ2
NV5  C                   END
NV5  C                   END
     C                   END
     C   43              DO
NV5  C                   SELECT
NV5  C     WSDTK         WHENEQ    0
NV5  C                   MOVE      *ZEROS        XDTK
NV5  C                   OTHER
     C                   MOVE      XDTKD         XDTKD2
     C                   MOVE      XDTKM         XDTKM2
SV5  C*                    MOVE XDTKÅ     XDTKÅ2
NV5  C     XDTKÅ         IFGT      50
NV5  C     XDTKÅ         ADD       1900          XDTKÅ2
NV5  C                   ELSE
NV5  C     XDTKÅ         ADD       2000          XDTKÅ2
NV5  C                   END
NV5  C                   ENDSL
     C                   END
     C   44              DO
NV5  C     WSDTS         IFEQ      0
NV5  C                   MOVE      *ZEROS        XDTS
NV5  C                   ELSE
     C                   MOVE      XDTSD         XDTSD2
     C                   MOVE      XDTSM         XDTSM2
SV5  C*                    MOVE XDTSÅ     XDTSÅ2
NV5  C     XDTSÅ         IFGT      50
NV5  C     XDTSÅ         ADD       1900          XDTSÅ2
NV5  C                   ELSE
NV5  C     XDTSÅ         ADD       2000          XDTSÅ2
NV5  C                   END
NV5  C                   END
     C                   END
     C   45              DO
NV5  C     WSDTT         IFEQ      0
NV5  C                   MOVE      *ZEROS        XDTT
NV5  C                   ELSE
     C     WSDTT         IFEQ      999999
     C                   MOVE      99999999      XDTT
     C                   ELSE
     C                   MOVE      XDTTD         XDTTD2
     C                   MOVE      XDTTM         XDTTM2
SV5  C*                    MOVE XDTTÅ     XDTTÅ2
NV5  C     XDTTÅ         IFGT      50
NV5  C     XDTTÅ         ADD       1900          XDTTÅ2
NV5  C                   ELSE
NV5  C     XDTTÅ         ADD       2000          XDTTÅ2
NV5  C                   END
     C                   END
NV5  C                   END
     C                   END
     C*
N05  C   38              DO
N05  C     WSSEKD        IFEQ      0
N05  C                   MOVE      *ZEROS        XSEKDT
N05  C                   ELSE
N05  C                   MOVE      XSSD          XSSD2
N05  C                   MOVE      XSSM          XSSM2
N05  C     XSSÅ          IFGT      50
N05  C     XSSÅ          ADD       1900          XSSÅ2
N05  C                   ELSE
N05  C     XSSÅ          ADD       2000          XSSÅ2
N05  C                   END
N05  C                   END
N05  C                   END
N39  C   37              DO
N39  C     WSDTRG        IFEQ      0
N39  C                   MOVE      *ZEROS        XDTRG
N39  C                   ELSE
N39  C                   MOVE      XDTRD         XDTRD2
N39  C                   MOVE      XDTRM         XDTRM2
N39  C     XDTRÅ         IFGT      50
N39  C     XDTRÅ         ADD       1900          XDTRÅ2
N39  C                   ELSE
N39  C     XDTRÅ         ADD       2000          XDTRÅ2
N39  C                   END
N39  C                   END
N39  C                   END
     C*
     C     WSAAVD        IFEQ      0
S07  C*                  Z-ADD     1             YAVD              4 0
     C                   EXSR      MINSAL
     C                   ELSE
     C                   EXSR      MINSAE
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MINSAE        BEGSR
     C***********************************************
      * SET KEY NÅR SØK KUN I EN !!!!  AVDELING
n05  C   38edim7k        SETLL     edim7
     C   40FR1KEY        SETLL     FRISOL01
     C   41SAEH1K        SETLL     SAEH1
     C   42SAEHK         SETLL     SAEH
     C   43SAEH2K        SETLL     SAEH2
     C   44SAEH3K        SETLL     SAEH3
     C   45WSDTT         IFEQ      999999
     C     SAEH4K        SETGT     SAEH4
     C                   ELSE
     C     SAEH4K        SETLL     SAEH4
     C                   END
N27  C   46              IF        WSTLEA = *ZEROS
     C   46SAEH5K        SETLL     SAEH5
N27  C                   ELSE
N27  C     SAEH12K       SETLL     SAEH12
N27  C                   END
     C   47SAEH6K        SETLL     SAEH6
     C   48SAEH7K        SETLL     SAEH17
     C   49SAEH0K        SETLL     SAEH10
N35  C   51SAEH14K       SETLL     SAEH14
N39  C   37SAEH13K       SETLL     SAEH13
N28  C   35SAEFNJL1K     SETLL     SAEFNJL1
S38  C*  34SAEMNJL1K     SETLL     SAEMNJL1
N38  C   34SAEVCNL1K     SETLL     SAEVCNL1
N38  C   34              EVAL      SETDN = 0
N38  C   34              MOVE      *BLANKS       X_MRK            17
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MINSAL        BEGSR
     C***********************************************
      * SET KEY NÅR SØK I ALLE !!  AVDELINGER
n05  C   38edim7k        SETLL     edim7
     C   40FR1KEY        SETLL     FRISOL01
S07  C*  41SAEA1K        SETLL     SAEH1
S07  C*  43SAEA2K        SETLL     SAEH2
S07  C*  44SAEA3K        SETLL     SAEH3
N07  C   41SAEA1K        SETLL     SAEH1B
N07  C   43SAEA2K        SETLL     SAEH2B
N07  C   44SAEA3K        SETLL     SAEH3B
     C   45WSDTT         IFEQ      999999
S07  C*    SAEA4K        SETGT     SAEH4
N07  C     SAEA4K        SETGT     SAEH4B
     C                   ELSE
S07  C*    SAEA4K        SETLL     SAEH4
N07  C     SAEA4K        SETLL     SAEH4B
     C                   END
N27  C   46              IF        WSTLEA = *ZEROS
     C   46WSTLL         SETLL     SAEH5B
N27  C                   ELSE
N27  C     SAEH12BK      SETLL     SAEH12B
N27  C                   END
     C   47WSGN15        SETLL     SAEH6B
S07  C*  48SAEA7K        SETLL     SAEH17
S07  C*  49SAEA0K        SETLL     SAEH10
N07  C   48SAEA7K        SETLL     SAEH17B
S34  C*  49SAEA0K        SETLL     SAEH10B
N34  C   49SAEA0K        SETLL     SAEH9
N35  C   51SAEA14K       SETLL     SAEH14B
N39  C   37SAEH13BK      SETLL     SAEH13B
N28  C   35WSFN          SETLL     SAEFNJL2
S38  C*  34WSMRK         SETLL     SAEMNJL2
N38  C   34WSMRK         SETLL     SAEVCNL2
N38  C   34              EVAL      SEAVD = 0
N38  C   34              EVAL      SETDN = 0
N38  C   34              EVAL      X_MRK = *BLANKS
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
      * LES REC NÅR SØK KUN I EN !!!!  AVDELING
     C     STLREC        TAG
N05   * sekvens i EDIM
N05  C     *IN38         IFEQ      '1'
N05  C     LESNYSE1      TAG
N05  C                   SETOFF                                       33
N05  C                   READ      EDIM7                                  94
N05  C  N94SADEDIM       CHAIN     SAEH                               33
N05  C   33              GOTO      LESNYSE1
N05  C  N94WSAAVD        CABNE     MAVD          LESNYSE1
N05  C     EDIM7K2       SETGT     EDIM7
N05  C                   END
     C     *IN40         IFEQ      '1'
     C     LESNYFRI      TAG
     C                   SETOFF                                       33
     C     FR1KEYE       READE     FRISOL01                               94
N06  C  N94WFSSOKMAX     COMP      FSSOK                                94
     C  N94SADHFRI       CHAIN     SAEH                               33
     C   33              GOTO      LESNYFRI
     C                   END
     C   41WSAAVD        READE     SAEH1                                  94
     C   42WSAAVD        READE     SAEH                                   94
     C   43WSAAVD        READE     SAEH2                                  94
     C   43
     CANN94WSKNK         COMP      SEKNK                              9494
     C   44WSAAVD        READE     SAEH3                                  94
     C   44
     CANN94WSKNS         COMP      SEKNS                              9494
     C   45WSDTT         IFEQ      999999
     C     WSAAVD        READPE    SAEH4                                  94
     C  N94WSSG          COMP      SESG                               9494
     C                   ELSE
     C     WSAAVD        READE     SAEH4                                  94
     C  N94WSSG          COMP      SESG                               9494
     C                   END
N27  C   46              IF        WSTLEA = *ZEROS
     C   46WSAAVD        READE     SAEH5                                  94
N27  C                   ELSE
N27  C     SAEH12K2      READE     SAEH12                                 94
N27  C                   END
     C   47WSAAVD        READE     SAEH6                                  94
     C   48SAEH7K        READE     SAEH17                                 94
     C   49SAEH0K        READE     SAEH10                                 94
n39  C   37SAEH13KE      READE     SAEH13                                 94
N35  C   51SAEH14K       READE     SAEH14                                 94
N28  C   35WSAAVD        READE     SAEFNJL1                               94
N28  C   35              IF        *IN94 = *OFF
N28  C                   EVAL      X_FN = SEFIF
N28  C                   MOVE      SEFID         X_FN             26
N28  C     SAEHKO        CHAIN     SAEH                               33
N28  C                   EVAL      WSNAK = X_FN
N28  C                   END
S38  C*  34WSAAVD        READE     SAEMNJL1                               94
N38  C   34WSAAVD        READE     SAEVCNL1                               94
N38  C   34              DOW       *IN94 = *OFF
N38  C                   IF        CN_SVTDN <> SETDN OR CN_SVCNR <> X_MRK
N38  C                   EVAL      SETDN = CN_SVTDN
N38  C                   EVAL      X_MRK = CN_SVCNR
N38  C                   LEAVE
N38  C                   END
N38  C     WSAAVD        READE     SAEVCNL1                               94
N38  C                   ENDDO
N28  C   34              IF        *IN94 = *OFF
S38  C*                  EVAL      X_MRK = SVMRK
N28  C     SAEHKO        CHAIN     SAEH                               33
N28  C                   EVAL      WSNAK = X_MRK
N28  C                   END
N23   *
N23  C  N94
N37  CANN38
N27  CANN46
N35  CANN51
N23  CANN42              IF        SETDN < 0
N23  C                   GOTO      STLREC
N23  C                   END
N23   *
     C  N94              DO
S18  C*    SETDN         CABLT     0             STLREC
S22  C* N46SETDN         CABLT     0             STLREC
N22  C  N41
N22  CANN45
N22  CANN46
N35  CANN51
N22  CANN49SETDN         CABLT     0             STLREC
S22  C*  46              IF        SETDN < 0
N22  C   41
N22  COR 45
N22  COR 46
N35  COR 51
N37  COR 38
N22  COR 49              IF        SETDN < 0
N18  C                   EVAL      SETDN = SETDN * -1
N18  C     SAEHKO        CHAIN     SAEH                               33
N18  C                   END
     C                   MOVE      SEDTD         WSDTD2
     C                   MOVE      SEDTM         WSDTM2
     C                   MOVE      SEDTÅ         WSDTÅ2
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESRAL        BEGSR
     C***********************************************
      * LES REC NÅR SØK I ALLE !!  AVDELINGER
     C     STLRAL        TAG
N05   * sekvens i EDIM
N05  C     *IN38         IFEQ      '1'
N05  C     LESNYSE2      TAG
N05  C                   SETOFF                                       33
N05  C                   READ      EDIM7                                  94
N05  C  N94SADEDIM       CHAIN     SAEH                               33
N05  C   33              GOTO      LESNYSE2
N05  C     EDIM7K2       SETGT     EDIM7
N05  C                   END
     C     *IN40         IFEQ      '1'
     C     LESNYFR2      TAG
     C                   SETOFF                                       33
     C     FR1KEYE       READE     FRISOL01                               94
N06  C  N94WFSSOKMAX     COMP      FSSOK                                94
     C  N94SADHFRI       CHAIN     SAEH                               33
     C   33              GOTO      LESNYFR2
     C                   END
S07  C*  41YAVD          READE     SAEH1                                  94
N07  C   41              READ      SAEH1B                                 94
S07  C*  43YAVD          READE     SAEH2                                  94
S07  C*  43
S07  C*NN94WSKNK         COMP      SEKNK                              9494
N07  C   43WSKNK         READE     SAEH2B                                 94
S07  C*  44YAVD          READE     SAEH3                                  94
S07  C*  44
S07  C*NN94WSKNS         COMP      SEKNS                              9494
N07  C   44WSKNS         READE     SAEH3B                                 94
     C   45WSDTT         IFEQ      999999
S07  C*    YAVD          READPE    SAEH4                                  94
S07  C* N94WSSG          COMP      SESG                               9494
N07  C     WSSG          READPE    SAEH4B                                 94
     C                   ELSE
S07  C*    YAVD          READE     SAEH4                                  94
S07  C* N94WSSG          COMP      SESG                               9494
N07  C     WSSG          READE     SAEH4B                                 94
     C                   END
N27  C   46              IF        WSTLEA = *ZEROS
     C   46              READ      SAEH5B                                 94
N27  C                   ELSE
N27  C     WSTLEA        READE     SAEH12B                                94
N27  C                   END
     C   47              READ      SAEH6B                                 94
S07  C*  48SAEA7K        READE     SAEH17                                 94
N07  C   48SAEA7K        READE     SAEH17B                                94
S07  C*  49SAEA0K        READE     SAEH10                                 94
S34  C*  49SAEA0K        READE     SAEH10B                                94
N34  C   49SAEA0K        READE     SAEH9                                  94
N35  C   51WSSTOMB       READE     SAEH14B                                94
N28  C   35              READ      SAEFNJL2                               94
N39  C   37WSRG          READE     SAEH13B                                94
N28  C   35              IF        *IN94 = *OFF
N28  C                   EVAL      X_FN = SEFIF
N28  C                   MOVE      SEFID         X_FN             26
N28  C     SAEHKO        CHAIN     SAEH                               33
N28  C                   EVAL      WSNAK = X_FN
N28  C                   END
S38  C*  34              READ      SAEMNJL2                               94
N38  C   34              READ      SAEVCNL2                               94
N38  C   34              DOW       *IN94 = *OFF
N38  C                   IF        SVAVD <> SEAVD OR SVTDN <> SETDN
N38  C                             OR CN_SVCNR <> X_MRK
N38  C                   EVAL      SETDN = CN_SVTDN
N38  C                   EVAL      X_MRK = CN_SVCNR
N38  C                   LEAVE
N38  C                   END
N38  C                   READ      SAEVCNL2                               94
N38  C                   ENDDO
N28  C   34              IF        *IN94 = *OFF
S38  C*                  MOVE      SVMRK         X_MRK            28
N28  C     SAEHKO        CHAIN     SAEH                               33
N28  C                   EVAL      WSNAK = X_MRK
N28  C                   END
     C  N94              DO
S35  C* N46SETDN         CABLT     0             STLRAL
N35  C  N46
N37  CanN38
N35  CANN51SETDN         CABLT     0             STLRAL
S35  C*  46              IF        SETDN < 0
N35  C   46
N37  Cor 38
N35  COR 51              IF        SETDN < 0
N18  C                   EVAL      SETDN = SETDN * -1
N18  C     SAEHKO        CHAIN     SAEH                               33
N18  C                   END
     C                   MOVE      SEDTD         WSDTD2
     C                   MOVE      SEDTM         WSDTM2
     C                   MOVE      SEDTÅ         WSDTÅ2
     C                   END
S07  C*  94YAVD          IFLT      9999
S07  C*    *IN46         ANDNE     '1'
S07  C*    *IN47         ANDNE     '1'
S07  C*                  ADD       1             YAVD
S07  C*    YAVD          SETLL     STANDE
S07  C*                  SETOFF                                       33
S07  C*                  READ      STANDE                                 33
S07  C* N33              DO
S07  C*                  MOVE      SEAVD         YAVD
S07  C*                  EXSR      MINSAL
S07  C*                  SETOFF                                       94
S07  C*                  GOTO      STLRAL
S07  C*                  END
S07  C*                  END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
N05  C     EDIM7K        KLIST
N05  C                   KFLD                    XSEKDT
N05  C                   KFLD                    WSSEKV
N05  C     EDIM7K2       KLIST
N05  C                   KFLD                    M0068A
N05  C                   KFLD                    M0068B
n05  C     SADEDIM       KLIST
n05  C                   KFLD                    MAVD
n05  C                   KFLD                    MTDN
     C     SAEHK         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTDN
     C     SAEHKO        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
N15  C     SAEHO2K       KLIST
N15  C                   KFLD                    SEAVD
N15  C                   KFLD                    O2_SETDN
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2TDN
     C     SAEHKC        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     SAEH1K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    XDT
     C     SAEH2K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     SAEH3K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     SAEH4K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     SAEH5K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTLL
     C     SAEH6K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSGN15
     C     SAEH7K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSMI
     C     SAEH0K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSST
N27  C     SAEH12K       KLIST
N27  C                   KFLD                    WSAAVD
N27  C                   KFLD                    WSTLEA
N27  C                   KFLD                    WSTLL
N27  C     SAEH12K2      KLIST
N27  C                   KFLD                    WSAAVD
N27  C                   KFLD                    WSTLEA
N27  C     SAEH12BK      KLIST
N27  C                   KFLD                    WSTLEA
N27  C                   KFLD                    WSTLL
N35  C     SAEH14K       KLIST
N35  C                   KFLD                    WSAAVD
N35  C                   KFLD                    WSSTOMB
N39  C     SAEH13K       KLIST
N39  C                   KFLD                    WSAAVD
N39  C                   KFLD                    WSRG
N39  C                   KFLD                    XDTRG
N39  C     SAEH13KE      KLIST
N39  C                   KFLD                    WSAAVD
N39  C                   KFLD                    WSRG
N39  C     SAEH13BK      KLIST
N39  C                   KFLD                    WSRG
N39  C                   KFLD                    XDTRG
N28  C     SAEFNJL1K     KLIST
N28  C                   KFLD                    WSAAVD
N28  C                   KFLD                    WSFN
S38  C*    SAEMNJL1K     KLIST
N38  C     SAEVCNL1K     KLIST
N28  C                   KFLD                    WSAAVD
N28  C                   KFLD                    WSMRK
     C     KUNDK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    XUNIK
     C                   KFLD                    WSAAVD
     C     SAEA1K        KLIST
S07  C*                  KFLD                    YAVD
     C                   KFLD                    XDT
     C     SAEA2K        KLIST
S07  C*                  KFLD                    YAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     SAEA3K        KLIST
S07  C*                  KFLD                    YAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     SAEA4K        KLIST
S07  C*                  KFLD                    YAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
S07  C*    SAEA5K        KLIST
S07  C*                  KFLD                    YAVD
S07  C*                  KFLD                    WSTLL
S07  C*    SAEA6K        KLIST
S07  C*                  KFLD                    YAVD
S07  C*                  KFLD                    WSGN15
     C     SAEA7K        KLIST
S07  C*                  KFLD                    YAVD
     C                   KFLD                    WSMI
     C     SAEA0K        KLIST
S07  C*                  KFLD                    YAVD
     C                   KFLD                    WSST
N35  C     SAEA14K       KLIST
N35  C                   KFLD                    WSSTOMB
N31  C     SAEFFK        KLIST
N31  C                   KFLD                    XAVDFF
N31  C                   KFLD                    XTDNFF
     C*
     C     SADHFRI       KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     FRIKEY        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    WSKODE
     C     FR1KEY        KLIST
     C                   KFLD                    WSKODE
     C                   KFLD                    WFSSOK
     C     FR1KEYE       KLIST
     C                   KFLD                    WSKODE
N10  c     MailKey       klist
N10  c                   kfld                    FIFIRM
N10  c                   kfld                    ITYPE            30
N10  c                   kfld                    SEKNK
N10  c                   eval      ITYPE = '*SAD EKSPORT'
N14  C     TRACKL02K     klist
N14  C                   KFLD                    SEAVD
N14  C                   KFLD                    SETDN
N14  C                   kfld                    TTFBNR
N14  C                   kfld                    TTACTI
N14  C                   EVAL      TTACTI = 'EMA'
     C     *ENTRY        PLIST
      * UKODE = S  -->  SPØRRING
      * UKODE = E  -->  EKSPORT
     C                   PARM                    UKODE             1
     C                   PARM                    UTDN              7 0
      *
     C     UKODE         COMP      'S'                                    28
     C                   MOVE      'A'           XUNIK             1
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      'AVSENDER'    SOTXT1            8
S01  C*                  MOVE      'MOTTAKER'    SOTXT2            8
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
N05  C                   MOVE      *ZEROS        WSSEKD
N06  C                   MOVE      *BLANKS       WFSSOKMAX        35
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        WSDTK
     C                   MOVE      *ZEROS        WSDTT
N39  C                   MOVE      *ZEROS        WSDTRG
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      *ZEROS        XDTS
     C                   MOVE      *ZEROS        XDTK
     C                   MOVE      *ZEROS        XDTT
N39  C                   MOVE      *ZEROS        XDTRG
     C                   MOVE      *ZEROS        SEDT
     C                   MOVE      *ZEROS        WSDT2
     C     *LIKE         DEFINE    FSKODE        WSKODE
s02  C*                  MOVEL     '*CR'         WSKODE
n02  C                   MOVEL     '*CE'         WSKODE
      *
     C                   MOVE      UAVD          WSAAVD
     C     KODTAK        CHAIN     KODTA                              30
     C     *IN28         IFEQ      '0'
     C                   MOVE      USG           WSSG
     C                   MOVE      '999999'      WSDTT
     C                   SETON                                        45
     C                   END
     C*
     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           WSAAR
     C                   MOVEL     WDT           W2AAR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FAXSAD        BEGSR
     C***********************************************
     C                   CALL      'FAX025B'
S28  C*                  PARM      seAVD         seAVD
S28  C*                  PARM      seTDN         seTDN
N28  C                   PARM      SEAVD         U_AVD             4 0
N28  C                   PARM      SETDN         U_TDN             7 0
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
N26  C***********************************************
N26  C     VISFRIS       BEGSR
N26  C***********************************************
N26  C                   Z-ADD     0             UFLAGG
N26  C                   CALL      'SYFA64'
S28  C*                  PARM                    SEAVD
S28  C*                  PARM                    SETDN
s42  C*                  PARM                    U_AVD             4 0
s42  C*                  PARM                    U_TDN             7 0
N42  C                   PARM      SEAVD         U_AVD             4 0
N42  C                   PARM      SETDN         U_TDN             7 0
N26  C                   PARM                    OTIKU1            8 0
N26  C                   PARM                    OTIKU2            8 0
N26  C  N90              MOVE      *ZEROS        WSNR
N26  C  N90              UPDATE    SUBFIL
N26  C                   ENDSR
N26  C*
n29   ***********************************************
n29  C     DSPEPO        BEGSR
n29   ***********************************************
n29  C                   CALL      'ARC012CLD'
N29  C                   PARM      SEAVD         U_AVD             4 0
N29  C                   PARM      SETDN         U_TDN             7 0
N29  C  N90              MOVE      *ZEROS        WSNR
N29  C  N90              UPDATE    SUBFIL
n29   *
n29  C                   ENDSR
N41   ***********************************************
N41  C     SROPPGJ       BEGSR
N41   ***********************************************
N41  C     SADHK         KLIST
N41  C                   KFLD                    WSAVOPG
N41  C                   KFLD                    WSOPOPG
N41  C                   EVAL      WSAVOPG = 0
N41  C                   EVAL      WSOPOPG = 0
N41  C                   MOVEA     '00'          *IN(98)
N41  C                   MOVE      '0'           *IN30
N41   *
N41  C     STSROPPGJ     TAG
N41  C                   EXFMT     BOPPGJ
N41  C                   MOVEA     '00'          *IN(98)
N41  C                   MOVE      '0'           *IN30
N41  C                   EVAL      XMSG = *BLANKS
N41  C     *IN12         CABEQ     *ON           SLSROPPGJ
N41   *
N41  C     WSAVOPG       CHAIN     STANDI                             99
N41  C                   IF        *IN99
N41  C                   EVAL      XMSG = 'Oppgitt avdeling er ugyldig.'
N41  C                   EVAL      *IN30 = *ON
N41  C                   GOTO      STSROPPGJ
N41  C                   END
N41  C     SADHK         CHAIN     SADH                               98
N41  C                   IF        *IN98 = *OFF AND
N41  C                             (IM_SIDP < 50 OR IM_SIDP > 57 OR             IKKE MIDLERTIDIG IMP
N41  C                              IM_SIST <> 'P' AND IM_SIST <> 'U' OR        FEIL STATUS
N41  C                              IM_SITLL = *BLANKS)                         IKKE FERDIGFORTOLLET
N41  C                   EVAL      *IN98 = *ON
N41  C                   END
N41  C                   IF        *IN98
N41  C                   EVAL      XMSG = 'Oppgitt oppdrag finnes ikke.'
N41  C                   EVAL      *IN30 = *ON
N41  C                   GOTO      STSROPPGJ
N41  C                   END
N41  C     SADHK         CHAIN     SAEHMOL1                           33
N41  C                   IF        *IN33 = *OFF
N41  C                   EVAL      XMSG = 'Oppgjør er allerede laget. '
N41  C                             + %TRIM(%EDITC(SEAVD:'Z')) + '/'
N41  C                             + %TRIM(%EDITC(SETDN:'Z'))
N41  C                   EVAL      *IN98 = *ON
N41  C                   EVAL      *IN30 = *ON
N41  C                   GOTO      STSROPPGJ
N41  C                   END
N41   *
N41  C                   EVAL      XTYPE  = 'OPG'
N41  C                   EVAL      XAVD   = WSAVOPG
N41  C                   EVAL      XTDN   = WSOPOPG
N41  C                   CALL      'SAD052CL'
N41  C                   PARM                    XAVD
N41  C                   PARM                    XTDN
N41  C                   PARM                    USG
N41  C                   PARM                    UKODE
N41  C                   PARM                    XTYPE
N41   *
N41  C                   MOVEA     '000000000000'*IN(38)
N41  C                   MOVE      '0'           *IN37
N41  C                   MOVE      '0'           *IN51
N41  C                   MOVEA     '00'          *IN(34)
N41  C                   MOVE      '1'           *IN45
N41  C                   EVAL      WSDTT = 999999
N41  C                   EVAL      XDTT  = 99999999
N41   *
N41  C     SLSROPPGJ     ENDSR
N41   *
