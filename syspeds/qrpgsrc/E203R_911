     FEDIS      UF   E           K DISK
     FEUNB      UF   E           K DISK
     FEDIMC     UF   E           K DISK
     FEUNH      UF   E           K DISK
     FEDIJ2     IF   E           K DISK
     FEDII      IF   E           K DISK
     FECMSG1    IF   E           K DISK
     FECNI911   IF   E           K DISK
     FECNT911   IF   E           K DISK
     FECOM911   IF   E           K DISK
     FECPI911   IF   E           K DISK
     FECTA911   IF   E           K DISK
     FECUX911   IF   E           K DISK
     FEDGS911   IF   E           K DISK
     FEDIM911   IF   E           K DISK
     FEDOC911   IF   E           K DISK
     FEDTM911   IF   E           K DISK
     FEEQA911   IF   E           K DISK
     FEEQD911   IF   E           K DISK
     FEEQN911   IF   E           K DISK
     FEFTX911   IF   E           K DISK
     FEGDS911   IF   E           K DISK
     FEGID911   IF   E           K DISK
     FEGOR911   IF   E           K DISK
     FELOC911   IF   E           K DISK
     FEMEA911   IF   E           K DISK
     FEMOA911   IF   E           K DISK
     FENAD911   IF   E           K DISK
     FEPCD911   IF   E           K DISK
     FEPCI911   IF   E           K DISK
     FEPIA911   IF   E           K DISK
     FEPRI911   IF   E           K DISK
     FEQTY911   IF   E           K DISK
     FERFF911   IF   E           K DISK
     FERNG911   IF   E           K DISK
     FESEL911   IF   E           K DISK
     FESGP911   IF   E           K DISK
     FETCC911   IF   E           K DISK
     FETDT911   IF   E           K DISK
     FETMD911   IF   E           K DISK
     FETMP911   IF   E           K DISK
     FETOD911   IF   E           K DISK
     FETPL911   IF   E           K DISK
     FETSR911   IF   E           K DISK
     FEDISE     O  A E             DISK
     D A               S              1    DIM(70)
     D B               S              1    DIM(80)
     D TABA            S              1    DIM(32) CTDATA PERRCD(1) ASCEND
     D TABB            S              1    DIM(32) ALT(TABA)
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)
      *____________
      * DS for Dato
      *""""""""""""
     D                 DS
     D  WTIME                  1     14  0
     D  WTM                    1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D                 DS
     D  WDT                    1      8  0
     D  WÅ                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
     D                 DS
     D  WUMN                   1      9  0
     D  ZGN0                  10     11  0
     D  ZGN1                  12     13  0
     D  ZGN2                  14     15  0
     D  ZGN3                  16     17  0
     D  ZGN4                  18     19  0
     D  ZGN5                  20     21  0
     D  ZGN6                  22     23  0
     D  ZGN7                  24     25  0
     D  ZGN8                  26     27  0
     D  ZREPB0                28     31  0
     D  ZREPC0                32     35  0
     D  ZREPD0                36     39  0
     D  ZREPE0                40     43  0
     D  ZREPF0                44     47  0
     D  ZREPG0                48     51  0
     D  ZREPH0                52     55  0
     D  ZREPI0                56     59  0
     D  ZREPC1                60     63  0
     D  ZREPD1                64     67  0
     D  ZREPE1                68     71  0
     D  ZREPF1                72     75  0
     D  ZREPG1                76     79  0
     D  ZREPH1                80     83  0
     D  ZREPI1                84     87  0
     D  ZREPD2                88     91  0
     D  ZREPE2                92     95  0
     D  ZREPF2                96     99  0
     D  ZREPG2               100    103  0
     D  ZREPH2               104    107  0
     D  ZREPI2               108    111  0
     D  ZREPE3               112    115  0
     D  ZREPF3               116    119  0
     D  ZREPG3               120    123  0
     D  ZREPH3               124    127  0
     D  ZREPI3               128    131  0
     D  ZREPF4               132    135  0
     D  ZREPG4               136    139  0
     D  ZREPH4               140    143  0
     D  ZREPI4               144    147  0
     D  ZREPG5               148    151  0
     D  ZREPH5               152    155  0
     D  ZREPI5               156    159  0
     D  ZREPH6               160    163  0
     D  ZREPI6               164    167  0
     D  ZREPI7               168    171  0
     IEDIMR
     I              MMN                         TVIMMN
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EXSR      SRC
     C                   EXSR      SRD
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *__________________
      * Define workfields
      *""""""""""""""""""
     C     *LIKE         DEFINE    SSN           WSN
     C     *LIKE         DEFINE    S0036         W0036
     C     *LIKE         DEFINE    JCLFE         WCLFE
     C                   MOVE      *BLANKS       WCLFE
     C     *LIKE         DEFINE    MST           WST
     C                   MOVE      '+'           WST
     C     *LIKE         DEFINE    MVEN          WVEN
     C                   MOVE      *BLANKS       WVEN
     C     *LIKE         DEFINE    UIN           WUIN
     C     *LIKE         DEFINE    INNETW        WNNETW
     C     *LIKE         DEFINE    SSR           WSR
     C                   MOVE      'S'           WSR
     C                   MOVE      '0'           ECFLAG            1
     C                   MOVE      *BLANKS       W0004            35
     C                   MOVE      *BLANKS       W0010            35
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             6 0
     C                   Z-ADD     0             AX                2 0
     C                   Z-ADD     1             BX                2 0
     C                   Z-ADD     0             AXV               2 0
     C                   Z-ADD     0             AXH               2 0
     C                   MOVE      'R'           WDIR              1
     C                   MOVE      *BLANKS       WCHAR             1
     C                   MOVE      'Y'           WCHART            1
     C                   MOVE      *BLANKS       WCONT             5
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
     C                   MOVE      '0'           *IN39
     C                   MOVE      '1'           *IN32
     C     *LIKE         DEFINE    DMN           ZMN
      *____________
      * Define keys
      *""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WSN
     C     KEYUNB        KLIST
     C                   KFLD                    WUIN
     C     KEYUNH        KLIST
     C                   KFLD                    WUMN
     C     KEYB          KLIST
     C                   KFLD                    SSR
     C                   KFLD                    WST
     C                   KFLD                    WVEN
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    S0035
     C     KEYC          KLIST
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    WCLFE
     C     KEYMS0        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN0
     C     KEYMS1        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN1
     C                   KFLD                    ZREPB0
     C     KEYMS2        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN2
     C                   KFLD                    ZREPC0
     C                   KFLD                    ZREPC1
     C     KEYMS3        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN3
     C                   KFLD                    ZREPD0
     C                   KFLD                    ZREPD1
     C                   KFLD                    ZREPD2
     C     KEYMS4        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN4
     C                   KFLD                    ZREPE0
     C                   KFLD                    ZREPE1
     C                   KFLD                    ZREPE2
     C                   KFLD                    ZREPE3
     C     KEYMS5        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN5
     C                   KFLD                    ZREPF0
     C                   KFLD                    ZREPF1
     C                   KFLD                    ZREPF2
     C                   KFLD                    ZREPF3
     C                   KFLD                    ZREPF4
     C     KEYMS6        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN6
     C                   KFLD                    ZREPG0
     C                   KFLD                    ZREPG1
     C                   KFLD                    ZREPG2
     C                   KFLD                    ZREPG3
     C                   KFLD                    ZREPG4
     C                   KFLD                    ZREPG5
     C     KEYMS7        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN7
     C                   KFLD                    ZREPH0
     C                   KFLD                    ZREPH1
     C                   KFLD                    ZREPH2
     C                   KFLD                    ZREPH3
     C                   KFLD                    ZREPH4
     C                   KFLD                    ZREPH5
     C                   KFLD                    ZREPH6
     C     KEYMS8        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN8
     C                   KFLD                    ZREPI0
     C                   KFLD                    ZREPI1
     C                   KFLD                    ZREPI2
     C                   KFLD                    ZREPI3
     C                   KFLD                    ZREPI4
     C                   KFLD                    ZREPI5
     C                   KFLD                    ZREPI6
     C                   KFLD                    ZREPI7
     C     KEYMSG        KLIST
     C                   KFLD                    WSR
     C                   KFLD                    U0065
     C                   KFLD                    U0054
     C                   KFLD                    M0010
     C                   KFLD                    M0004
      *__________________________
      * Retreive System Date/Time
      *""""""""""""""""""""""""""
     C                   TIME                    WTIME
     C                   Z-ADD     WÅÅ           WÅ
     C                   Z-ADD     WDD           WD
     C                   Z-ADD     WMM           WM
      *_________________
      * Input parameters
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     WSN           PARM                    WSN
     C                   Z-ADD     WSN           WUIN
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start of file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *___________________________________
      * Get data from interchange log file
      *"""""""""""""""""""""""""""""""""""
     C     KEYA          CHAIN     EDIS                               81
     C     KEYUNB        CHAIN     EUNB                               81
     C                   Z-ADD     0             W0036
     C                   MOVEL     U0004         W0004
     C                   MOVEL     U0010         W0010
     C     W0010         CHAIN     EDII                               20
     C                   MOVEL     INNETW        WNNETW
      *_________________
      * Move member name
      *"""""""""""""""""
     C                   EVAL      SEMBR=SMBR
     C                   SELECT
      *___________________
      * Create JCL for NIT
      *"""""""""""""""""""
     C     WNNETW        WHENEQ    '1'
      *
     C                   MOVE      'F'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   ENDSL
      *________________
      * Add UNB-segment
      *""""""""""""""""
     C                   EXSR      UNB
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Read message log                                     SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
     C     KEYB          CHAIN     EDIMC                              8182
     C                   Z-ADD     TVIMMN        WUMN
     C     *IN81         DOWEQ     '0'
     C  N81
     CANN82KEYUNH        CHAIN     EUNH                               8384
     C     *IN83         IFEQ      '0'
     C     M0065         ANDEQ     'IFCSUM'
     C                   Z-ADD     SSN           MSN
     C                   MOVE      'A'           MST
     C                   Z-ADD     WDT           MDT
     C                   Z-ADD     WTM           MTM
     C                   ADD       1             W0036
     C                   EXSR      SRCA
     C                   Z-ADD     WUIN          UIN
     C                   UPDATE    EDIMR
     C                   UPDATE    UNHR
      * Oppslag i ECMSG for å se om det skal sendes en og en melding
      * eller akumuleres opp på vanlig måte.
     C     ECFLAG        IFEQ      '0'
     C     KEYMSG        CHAIN     ECMSG1                             90
     C     *IN90         IFEQ      *ON
     C                   MOVE      *BLANK        ECSEND
     C                   ENDIF
     C                   MOVE      '1'           ECFLAG
      * Forlater løkken hvis det skal sendes en og en melding.
     C     ECSEND        IFNE      *BLANKS
     C                   LEAVE
     C                   ENDIF
     C                   ENDIF
      *
     C                   ENDIF
     C     KEYB          READE     EDIMC                                8281
     C                   Z-ADD     TVIMMN        WUMN
     C  N81              END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  End of interchange                                   SRD /
      *////////////////////////////////////////////////////////////
     C     SRD           BEGSR
     C                   Z-ADD     W0036         S0036
     C                   MOVE      W0036         U0036
      *____________________
      * Interchange trailer
      *""""""""""""""""""""
     C                   EXSR      UNZ
      *____________________________
      * Update interchange log file
      *""""""""""""""""""""""""""""
     C                   MOVE      'A'           SST
     C                   UPDATE    EDISR
     C                   UPDATE    UNBR
      *___________________
      * Create JCL for NIT
      *"""""""""""""""""""
     C     WNNETW        IFEQ      '1'
     C                   MOVE      'E'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   END
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Add segments                                           SRCA
      */////////////////////////////////////////////////////////////
     C     SRCA          BEGSR
     C                   EXSR      UNH
     C                   EXSR      BGM
      *
     C                   EXSR      MOA00
     C                   EXSR      FTX00
     C                   EXSR      CNT00
     C                   EXSR      RFF01
     C                   EXSR      GOR02
     C                   EXSR      TCC04
     C                   EXSR      TDT05
     C                   EXSR      EQD13
     C                   EXSR      CNI15
      *
     C                   EXSR      UNT
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CNI GROUP:15                                       CNI15 /
      *////////////////////////////////////////////////////////////
     C     CNI15         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     15            ZGN0
     C     KEYMS0        SETLL     ECNI911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECNI911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      CNI
     C                   Z-ADD     CREP0         ZREPB0
     C                   EXSR      MOA15
     C                   EXSR      FTX15
     C                   EXSR      LOC16
     C                   EXSR      TOD17
     C                   EXSR      RFF18
     C                   EXSR      GOR19
     C                   EXSR      CPI21
     C                   EXSR      TCC22
     C                   EXSR      TDT23
     C                   EXSR      NAD25
     C                   EXSR      GID31
     C                   EXSR      EQD49
      *
     C     KEYMS0        READE     ECNI911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CNT GROUP:00                                       CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     ECNT911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECNT911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      CNT
      *
     C     KEYMS0        READE     ECNT911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  COM GROUP:08                                       COM08 /
      *////////////////////////////////////////////////////////////
     C     COM08         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     8             ZGN2
     C     KEYMS2        SETLL     ECOM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ECOM911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      COM
      *
     C     KEYMS2        READE     ECOM911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  COM GROUP:26                                       COM26 /
      *////////////////////////////////////////////////////////////
     C     COM26         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     26            ZGN3
     C     KEYMS3        SETLL     ECOM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ECOM911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      COM
      *
     C     KEYMS3        READE     ECOM911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CPI GROUP:21                                       CPI21 /
      *////////////////////////////////////////////////////////////
     C     CPI21         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     21            ZGN1
     C     KEYMS1        SETLL     ECPI911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ECPI911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      CPI
     C                   Z-ADD     CREP0         ZREPC0
     C                   Z-ADD     CREP1         ZREPC1
     C*                    EXSR CUX21
     C                   EXSR      LOC21
     C                   EXSR      MOA21
      *
     C     KEYMS1        READE     ECPI911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CPI GROUP:30                                       CPI30 /
      *////////////////////////////////////////////////////////////
     C     CPI30         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     30            ZGN2
     C     KEYMS2        SETLL     ECPI911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ECPI911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      CPI
     C                   Z-ADD     CREP0         ZREPD0
     C                   Z-ADD     CREP1         ZREPD1
     C                   Z-ADD     CREP2         ZREPD2
      *
     C     KEYMS2        READE     ECPI911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:08                                       CTA08 /
      *////////////////////////////////////////////////////////////
     C     CTA08         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     ECTA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ECTA911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      CTA
     C                   Z-ADD     CREP0         ZREPC0
     C                   Z-ADD     CREP1         ZREPC1
     C                   EXSR      COM08
      *
     C     KEYMS1        READE     ECTA911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:10                                       CTA10 /
      *////////////////////////////////////////////////////////////
     C     CTA10         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     10            ZGN2
     C     KEYMS2        SETLL     ECTA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ECTA911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      CTA
     C                   Z-ADD     CREP0         ZREPD0
     C                   Z-ADD     CREP1         ZREPD1
     C                   Z-ADD     CREP2         ZREPD2
     C*                    EXSR COM10
      *
     C     KEYMS2        READE     ECTA911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:26                                       CTA26 /
      *////////////////////////////////////////////////////////////
     C     CTA26         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     26            ZGN2
     C     KEYMS2        SETLL     ECTA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ECTA911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      CTA
     C                   Z-ADD     CREP0         ZREPD0
     C                   Z-ADD     CREP1         ZREPD1
     C                   Z-ADD     CREP2         ZREPD2
     C                   EXSR      COM26
      *
     C     KEYMS2        READE     ECTA911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:45                                       CTA45 /
      *////////////////////////////////////////////////////////////
     C     CTA45         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     45            ZGN3
     C     KEYMS3        SETLL     ECTA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ECTA911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      CTA
     C                   Z-ADD     CREP0         ZREPE0
     C                   Z-ADD     CREP1         ZREPE1
     C                   Z-ADD     CREP2         ZREPE2
     C                   Z-ADD     CREP3         ZREPE3
     C*                    EXSR COM45
      *
     C     KEYMS3        READE     ECTA911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:99                                       CTA99 /
      *////////////////////////////////////////////////////////////
     C     CTA99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ECTA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ECTA911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      CTA
      *
     C     KEYMS8        READE     ECTA911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CUX GROUP:99                                       CUX99 /
      *////////////////////////////////////////////////////////////
     C     CUX99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ECUX911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ECUX911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      CUX
      *
     C     KEYMS8        READE     ECUX911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DGS GROUP:44                                       DGS44 /
      *////////////////////////////////////////////////////////////
     C     DGS44         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     44            ZGN2
     C     KEYMS2        SETLL     EDGS911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDGS911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DGS
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
     C                   EXSR      FTX44
     C                   EXSR      CTA45
     C                   EXSR      MEA46
     C                   EXSR      SGP47
      *
     C     KEYMS2        READE     EDGS911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DIM GROUP:07                                       DIM07 /
      *////////////////////////////////////////////////////////////
     C     DIM07         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     7             ZGN1
     C     KEYMS1        SETLL     EDIM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDIM911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      DIM
     C                   Z-ADD     DREP0         ZREPC0
     C                   Z-ADD     DREP1         ZREPC1
     C                   EXSR      EQN07
      *
     C     KEYMS1        READE     EDIM911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DIM GROUP:35                                       DIM35 /
      *////////////////////////////////////////////////////////////
     C     DIM35         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     35            ZGN2
     C     KEYMS2        SETLL     EDIM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDIM911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DIM
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
     C*                    EXSR EQN35
      *
     C     KEYMS2        READE     EDIM911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DIM GROUP:99                                       DIM99 /
      *////////////////////////////////////////////////////////////
     C     DIM99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     EDIM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     EDIM911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      DIM
      *
     C     KEYMS8        READE     EDIM911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DOC GROUP:03                                       DOC03 /
      *////////////////////////////////////////////////////////////
     C     DOC03         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     3             ZGN1
     C     KEYMS1        SETLL     EDOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDOC911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      DOC
     C                   Z-ADD     DREP0         ZREPC0
     C                   Z-ADD     DREP1         ZREPC1
      *
     C     KEYMS1        READE     EDOC911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DOC GROUP:11                                       DOC11 /
      *////////////////////////////////////////////////////////////
     C     DOC11         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     11            ZGN2
     C     KEYMS2        SETLL     EDOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DOC
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
      *
     C     KEYMS2        READE     EDOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DOC GROUP:20                                       DOC20 /
      *////////////////////////////////////////////////////////////
     C     DOC20         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     20            ZGN2
     C     KEYMS2        SETLL     EDOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DOC
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
      *
     C     KEYMS2        READE     EDOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DOC GROUP:27                                       DOC27 /
      *////////////////////////////////////////////////////////////
     C     DOC27         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     27            ZGN2
     C     KEYMS2        SETLL     EDOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DOC
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
      *
     C     KEYMS2        READE     EDOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DOC GROUP:38                                       DOC38 /
      *////////////////////////////////////////////////////////////
     C     DOC38         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     38            ZGN2
     C     KEYMS2        SETLL     EDOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DOC
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
      *
     C     KEYMS2        READE     EDOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:01                                       DTM01 /
      *////////////////////////////////////////////////////////////
     C     DTM01         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     1             ZGN1
     C     KEYMS1        SETLL     EDTM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDTM911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS1        READE     EDTM911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:05                                       DTM05 /
      *////////////////////////////////////////////////////////////
     C     DTM05         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     5             ZGN1
     C     KEYMS1        SETLL     EDTM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDTM911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS1        READE     EDTM911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:16                                       DTM16 /
      *////////////////////////////////////////////////////////////
     C     DTM16         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     16            ZGN2
     C     KEYMS2        SETLL     EDTM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS2        READE     EDTM911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:18                                       DTM18 /
      *////////////////////////////////////////////////////////////
     C     DTM18         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     18            ZGN2
     C     KEYMS2        SETLL     EDTM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS2        READE     EDTM911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:37                                       DTM37 /
      *////////////////////////////////////////////////////////////
     C     DTM37         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     37            ZGN3
     C     KEYMS3        SETLL     EDTM911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EDTM911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS3        READE     EDTM911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQA GROUP:14                                       EQA14 /
      *////////////////////////////////////////////////////////////
     C     EQA14         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     14            ZGN1
     C     KEYMS1        SETLL     EEQA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EEQA911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      EQA
     C                   Z-ADD     EREP0         ZREPC0
     C                   Z-ADD     EREP1         ZREPC1
      *
     C     KEYMS1        READE     EEQA911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQA GROUP:52                                       EQA52 /
      *////////////////////////////////////////////////////////////
     C     EQA52         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     53            ZGN2
     C     KEYMS2        SETLL     EEQA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EEQA911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      EQA
     C                   Z-ADD     EREP0         ZREPD0
     C                   Z-ADD     EREP1         ZREPD1
     C                   Z-ADD     EREP2         ZREPD2
     C*                    EXSR EQN52
      *
     C     KEYMS2        READE     EEQA911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQD GROUP:13                                       EQD13 /
      *////////////////////////////////////////////////////////////
     C     EQD13         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     13            ZGN0
     C     KEYMS0        SETLL     EEQD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EEQD911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      EQD
     C                   Z-ADD     EREP0         ZREPB0
     C                   EXSR      EQA14
      *
     C     KEYMS0        READE     EEQD911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQD GROUP:49                                       EQD49 /
      *////////////////////////////////////////////////////////////
     C     EQD49         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     49            ZGN1
     C     KEYMS1        SETLL     EEQD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EEQD911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      EQD
     C                   Z-ADD     EREP0         ZREPC0
     C                   Z-ADD     EREP1         ZREPC1
     C                   EXSR      TCC50
     C                   EXSR      NAD51
     C                   EXSR      EQA52
      *
     C     KEYMS1        READE     EEQD911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQN GROUP:06                                       EQN06 /
      *////////////////////////////////////////////////////////////
     C     EQN06         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     6             ZGN2
     C     KEYMS2        SETLL     EEQN911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EEQN911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      EQN
      *
     C     KEYMS2        READE     EEQN911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQN GROUP:07                                       EQN07 /
      *////////////////////////////////////////////////////////////
     C     EQN07         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     7             ZGN2
     C     KEYMS2        SETLL     EEQN911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EEQN911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      EQN
      *
     C     KEYMS2        READE     EEQN911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQN GROUP:34                                       EQN34 /
      *////////////////////////////////////////////////////////////
     C     EQN34         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     34            ZGN3
     C     KEYMS3        SETLL     EEQN911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EEQN911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      EQN
      *
     C     KEYMS3        READE     EEQN911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:00                                       FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EFTX911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EFTX911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS0        READE     EFTX911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:05                                       FTX05 /
      *////////////////////////////////////////////////////////////
     C     FTX05         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     5             ZGN1
     C     KEYMS1        SETLL     EFTX911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS1        READE     EFTX911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:15                                       FTX15 /
      *////////////////////////////////////////////////////////////
     C     FTX15         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     15            ZGN1
     C     KEYMS1        SETLL     EFTX911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS1        READE     EFTX911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:33                                       FTX33 /
      *////////////////////////////////////////////////////////////
     C     FTX33         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     33            ZGN3
     C     KEYMS3        SETLL     EFTX911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS3        READE     EFTX911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:44                                       FTX44 /
      *////////////////////////////////////////////////////////////
     C     FTX44         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     44            ZGN3
     C     KEYMS3        SETLL     EFTX911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS3        READE     EFTX911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GDS GROUP:33                                       GDS33 /
      *////////////////////////////////////////////////////////////
     C     GDS33         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     33            ZGN2
     C     KEYMS2        SETLL     EGDS911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EGDS911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      GDS
     C                   Z-ADD     GREP0         ZREPD0
     C                   Z-ADD     GREP1         ZREPD1
     C                   Z-ADD     GREP2         ZREPD2
     C                   EXSR      FTX33
      *
     C     KEYMS2        READE     EGDS911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GID GROUP:31                                       GID31 /
      *////////////////////////////////////////////////////////////
     C     GID31         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     31            ZGN1
     C     KEYMS1        SETLL     EGID911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EGID911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      GID
     C                   Z-ADD     GREP0         ZREPC0
     C                   Z-ADD     GREP1         ZREPC1
     C                   EXSR      NAD32
     C                   EXSR      GDS33
     C                   EXSR      MEA34
     C                   EXSR      DIM35
     C                   EXSR      PCI37
     C                   EXSR      DOC38
     C                   EXSR      TPL39
     C                   EXSR      SGP41
     C                   EXSR      TCC43
     C                   EXSR      DGS44
      *
     C     KEYMS1        READE     EGID911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GOR GROUP:02                                       GOR02 /
      *////////////////////////////////////////////////////////////
     C     GOR02         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     2             ZGN0
     C     KEYMS0        SETLL     EGOR911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EGOR911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      GOR
     C                   Z-ADD     GREP0         ZREPB0
     C                   EXSR      DOC03
      *
     C     KEYMS0        READE     EGOR911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GOR GROUP:19                                       GOR19 /
      *////////////////////////////////////////////////////////////
     C     GOR19         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     19            ZGN1
     C     KEYMS1        SETLL     EGOR911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EGOR911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      GOR
     C                   Z-ADD     GREP0         ZREPC0
     C                   Z-ADD     GREP1         ZREPC1
     C                   EXSR      DOC20
      *
     C     KEYMS1        READE     EGOR911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:05                                       LOC05 /
      *////////////////////////////////////////////////////////////
     C     LOC05         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     5             ZGN1
     C     KEYMS1        SETLL     ELOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS1        READE     ELOC911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:16                                       LOC16 /
      *////////////////////////////////////////////////////////////
     C     LOC16         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     ELOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      LOC
     C                   Z-ADD     LREP0         ZREPC0
     C                   Z-ADD     LREP1         ZREPC1
     C                   EXSR      DTM16
      *
     C     KEYMS1        READE     ELOC911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:17                                       LOC17 /
      *////////////////////////////////////////////////////////////
     C     LOC17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     ELOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ELOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS2        READE     ELOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:21                                       LOC21 /
      *////////////////////////////////////////////////////////////
     C     LOC21         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     21            ZGN2
     C     KEYMS2        SETLL     ELOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ELOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS2        READE     ELOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:25                                       LOC25 /
      *////////////////////////////////////////////////////////////
     C     LOC25         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     25            ZGN2
     C     KEYMS2        SETLL     ELOC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ELOC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS2        READE     ELOC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:06                                       MEA06 /
      *////////////////////////////////////////////////////////////
     C     MEA06         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     6             ZGN1
     C     KEYMS1        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EMEA911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      MEA
     C                   Z-ADD     MREP0         ZREPC0
     C                   Z-ADD     MREP1         ZREPC1
     C                   EXSR      EQN06
      *
     C     KEYMS1        READE     EMEA911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:34                                       MEA34 /
      *////////////////////////////////////////////////////////////
     C     MEA34         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     34            ZGN2
     C     KEYMS2        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMEA911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      MEA
     C                   Z-ADD     MREP0         ZREPD0
     C                   Z-ADD     MREP1         ZREPD1
     C                   Z-ADD     MREP2         ZREPD2
     C                   EXSR      EQN34
      *
     C     KEYMS2        READE     EMEA911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:40                                       MEA40 /
      *////////////////////////////////////////////////////////////
     C     MEA40         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     40            ZGN3
     C     KEYMS3        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EMEA911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      MEA
     C                   Z-ADD     MREP0         ZREPE0
     C                   Z-ADD     MREP1         ZREPE1
     C                   Z-ADD     MREP2         ZREPE2
     C                   Z-ADD     MREP3         ZREPE3
      *
     C     KEYMS3        READE     EMEA911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:42                                       MEA42 /
      *////////////////////////////////////////////////////////////
     C     MEA42         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     42            ZGN3
     C     KEYMS3        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EMEA911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      MEA
     C                   Z-ADD     MREP0         ZREPE0
     C                   Z-ADD     MREP1         ZREPE1
     C                   Z-ADD     MREP2         ZREPE2
     C                   Z-ADD     MREP3         ZREPE3
      *
     C     KEYMS3        READE     EMEA911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:46                                       MEA46 /
      *////////////////////////////////////////////////////////////
     C     MEA46         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     46            ZGN3
     C     KEYMS3        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EMEA911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      MEA
     C                   Z-ADD     MREP0         ZREPE0
     C                   Z-ADD     MREP1         ZREPE1
     C                   Z-ADD     MREP2         ZREPE2
     C                   Z-ADD     MREP3         ZREPE3
      *
     C     KEYMS3        READE     EMEA911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:48                                       MEA48 /
      *////////////////////////////////////////////////////////////
     C     MEA48         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     48            ZGN4
     C     KEYMS4        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EMEA911                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      MEA
     C                   Z-ADD     MREP0         ZREPF0
     C                   Z-ADD     MREP1         ZREPF1
     C                   Z-ADD     MREP2         ZREPF2
     C                   Z-ADD     MREP3         ZREPF3
     C                   Z-ADD     MREP4         ZREPF4
      *
     C     KEYMS4        READE     EMEA911                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:99                                       MEA99 /
      *////////////////////////////////////////////////////////////
     C     MEA99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     EMEA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     EMEA911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS8        READE     EMEA911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MOA GROUP:00                                       MOA00 /
      *////////////////////////////////////////////////////////////
     C     MOA00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EMOA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EMOA911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      MOA
      *
     C     KEYMS0        READE     EMOA911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MOA GROUP:15                                       MOA15 /
      *////////////////////////////////////////////////////////////
     C     MOA15         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     15            ZGN1
     C     KEYMS1        SETLL     EMOA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EMOA911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      MOA
      *
     C     KEYMS1        READE     EMOA911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MOA GROUP:21                                       MOA21 /
      *////////////////////////////////////////////////////////////
     C     MOA21         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     21            ZGN2
     C     KEYMS2        SETLL     EMOA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMOA911                                53
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      MOA
      *
     C     KEYMS2        READE     EMOA911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:09                                       NAD09 /
      *////////////////////////////////////////////////////////////
     C     NAD09         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     9             ZGN1
     C     KEYMS1        SETLL     ENAD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ENAD911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      NAD
     C                   Z-ADD     NREP0         ZREPC0
     C                   Z-ADD     NREP1         ZREPC1
     C                   EXSR      CTA10
     C                   EXSR      DOC11
     C                   EXSR      TCC12
      *
     C     KEYMS1        READE     ENAD911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:25                                       NAD25 /
      *////////////////////////////////////////////////////////////
     C     NAD25         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     25            ZGN1
     C     KEYMS1        SETLL     ENAD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ENAD911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      NAD
     C                   Z-ADD     NREP0         ZREPC0
     C                   Z-ADD     NREP1         ZREPC1
     C                   EXSR      LOC25
     C                   EXSR      CTA26
     C                   EXSR      DOC27
     C                   EXSR      TCC28
     C                   EXSR      RFF29
     C                   EXSR      CPI30
      *
     C     KEYMS1        READE     ENAD911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:32                                       NAD32 /
      *////////////////////////////////////////////////////////////
     C     NAD32         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     32            ZGN2
     C     KEYMS2        SETLL     ENAD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ENAD911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      NAD
     C                   Z-ADD     NREP0         ZREPD0
     C                   Z-ADD     NREP1         ZREPD1
     C                   Z-ADD     NREP2         ZREPD2
      *
     C     KEYMS2        READE     ENAD911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:51                                       NAD51 /
      *////////////////////////////////////////////////////////////
     C     NAD51         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     51            ZGN2
     C     KEYMS2        SETLL     ENAD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ENAD911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      NAD
     C                   Z-ADD     NREP0         ZREPD0
     C                   Z-ADD     NREP1         ZREPD1
     C                   Z-ADD     NREP2         ZREPD2
      *
     C     KEYMS2        READE     ENAD911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PCD GROUP:99                                       PCD99 /
      *////////////////////////////////////////////////////////////
     C     PCD99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     EPCD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     EPCD911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      PCD
      *
     C     KEYMS8        READE     EPCD911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PCI GROUP:37                                       PCI37 /
      *////////////////////////////////////////////////////////////
     C     PCI37         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     37            ZGN2
     C     KEYMS2        SETLL     EPCI911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EPCI911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      PCI
     C                   Z-ADD     NREP0         ZREPD0
     C                   Z-ADD     NREP1         ZREPD1
     C                   Z-ADD     NREP2         ZREPD2
     C                   EXSR      RFF37
     C                   EXSR      DTM37
      *
     C     KEYMS2        READE     EPCI911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PIA GROUP:99                                       PIA99 /
      *////////////////////////////////////////////////////////////
     C     PIA99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     EPIA911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     EPIA911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      PIA
      *
     C     KEYMS8        READE     EPIA911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PRI GROUP:99                                       PRI99 /
      *////////////////////////////////////////////////////////////
     C     PRI99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     EPRI911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     EPRI911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      PRI
      *
     C     KEYMS8        READE     EPRI911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:99                                       QTY99 /
      *////////////////////////////////////////////////////////////
     C     QTY99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     EQTY911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     EQTY911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS8        READE     EQTY911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:01                                       RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     1             ZGN0
     C     KEYMS0        SETLL     ERFF911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ERFF911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPB0
     C                   EXSR      DTM01
      *
     C     KEYMS0        READE     ERFF911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:18                                       RFF18 /
      *////////////////////////////////////////////////////////////
     C     RFF18         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     18            ZGN1
     C     KEYMS1        SETLL     ERFF911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPC0
     C                   Z-ADD     RREP1         ZREPC1
     C                   EXSR      DTM18
      *
     C     KEYMS1        READE     ERFF911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:24                                       RFF24 /
      *////////////////////////////////////////////////////////////
     C     RFF24         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     24            ZGN2
     C     KEYMS2        SETLL     ERFF911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ERFF911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPD0
     C                   Z-ADD     RREP1         ZREPD1
     C                   Z-ADD     RREP2         ZREPD2
      *
     C     KEYMS2        READE     ERFF911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:29                                       RFF29 /
      *////////////////////////////////////////////////////////////
     C     RFF29         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     29            ZGN2
     C     KEYMS2        SETLL     ERFF911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ERFF911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPD0
     C                   Z-ADD     RREP1         ZREPD1
     C                   Z-ADD     RREP2         ZREPD2
      *
     C     KEYMS2        READE     ERFF911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:33                                       RFF33 /
      *////////////////////////////////////////////////////////////
     C     RFF33         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     33            ZGN3
     C     KEYMS3        SETLL     ERFF911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ERFF911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      RFF
      *
     C     KEYMS3        READE     ERFF911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:37                                       RFF37 /
      *////////////////////////////////////////////////////////////
     C     RFF37         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     37            ZGN3
     C     KEYMS3        SETLL     ERFF911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ERFF911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      RFF
      *
     C     KEYMS3        READE     ERFF911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RNG GROUP:99                                       RNG99 /
      *////////////////////////////////////////////////////////////
     C     RNG99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ERNG911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ERNG911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      RNG
      *
     C     KEYMS8        READE     ERNG911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SEL GROUP:99                                       SEL99 /
      *////////////////////////////////////////////////////////////
     C     SEL99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ESEL911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ESEL911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      SEL
      *
     C     KEYMS8        READE     ESEL911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SGP GROUP:41                                       SGP41 /
      *////////////////////////////////////////////////////////////
     C     SGP41         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     41            ZGN2
     C     KEYMS2        SETLL     ESGP911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ESGP911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      SGP
     C                   Z-ADD     SREP0         ZREPD0
     C                   Z-ADD     SREP1         ZREPD1
     C                   Z-ADD     SREP2         ZREPD2
     C                   EXSR      MEA42
      *
     C     KEYMS2        READE     ESGP911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SGP GROUP:47                                       SGP47 /
      *////////////////////////////////////////////////////////////
     C     SGP47         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     47            ZGN3
     C     KEYMS3        SETLL     ESGP911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ESGP911                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      SGP
     C                   Z-ADD     SREP0         ZREPE0
     C                   Z-ADD     SREP1         ZREPE1
     C                   Z-ADD     SREP2         ZREPE2
     C                   Z-ADD     SREP3         ZREPE3
     C                   EXSR      MEA48
      *
     C     KEYMS3        READE     ESGP911                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SGP GROUP:99                                       SGP99 /
      *////////////////////////////////////////////////////////////
     C     SGP99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ESGP911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ESGP911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      SGP
      *
     C     KEYMS8        READE     ESGP911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TCC GROUP:04                                       TCC04 /
      *////////////////////////////////////////////////////////////
     C     TCC04         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     4             ZGN0
     C     KEYMS0        SETLL     ETCC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETCC911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      TCC
     C                   Z-ADD     TREP0         ZREPB0
      *
     C     KEYMS0        READE     ETCC911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TCC GROUP:12                                       TCC12 /
      *////////////////////////////////////////////////////////////
     C     TCC12         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     12            ZGN2
     C     KEYMS2        SETLL     ETCC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETCC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TCC
     C                   Z-ADD     TREP0         ZREPD0
     C                   Z-ADD     TREP1         ZREPD1
     C                   Z-ADD     TREP2         ZREPD2
      *
     C     KEYMS2        READE     ETCC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TCC GROUP:22                                       TCC22 /
      *////////////////////////////////////////////////////////////
     C     TCC22         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     22            ZGN1
     C     KEYMS1        SETLL     ETCC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETCC911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      TCC
     C                   Z-ADD     TREP0         ZREPC0
     C                   Z-ADD     TREP1         ZREPC1
      *
     C     KEYMS1        READE     ETCC911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TCC GROUP:28                                       TCC28 /
      *////////////////////////////////////////////////////////////
     C     TCC28         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     28            ZGN2
     C     KEYMS2        SETLL     ETCC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETCC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TCC
     C                   Z-ADD     TREP0         ZREPD0
     C                   Z-ADD     TREP1         ZREPD1
     C                   Z-ADD     TREP2         ZREPD2
      *
     C     KEYMS2        READE     ETCC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TCC GROUP:43                                       TCC43 /
      *////////////////////////////////////////////////////////////
     C     TCC43         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     43            ZGN2
     C     KEYMS2        SETLL     ETCC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETCC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TCC
     C                   Z-ADD     TREP0         ZREPD0
     C                   Z-ADD     TREP1         ZREPD1
     C                   Z-ADD     TREP2         ZREPD2
      *
     C     KEYMS2        READE     ETCC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TCC GROUP:50                                       TCC50 /
      *////////////////////////////////////////////////////////////
     C     TCC50         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     50            ZGN2
     C     KEYMS2        SETLL     ETCC911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETCC911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TCC
     C                   Z-ADD     TREP0         ZREPD0
     C                   Z-ADD     TREP1         ZREPD1
     C                   Z-ADD     TREP2         ZREPD2
      *
     C     KEYMS2        READE     ETCC911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TDT GROUP:05                                       TDT05 /
      *////////////////////////////////////////////////////////////
     C     TDT05         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     5             ZGN0
     C     KEYMS0        SETLL     ETDT911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETDT911                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      TDT
     C                   Z-ADD     TREP0         ZREPB0
     C                   EXSR      LOC05
     C                   EXSR      DTM05
     C                   EXSR      FTX05
     C                   EXSR      MEA06
     C                   EXSR      DIM07
     C                   EXSR      CTA08
     C                   EXSR      NAD09
      *
     C     KEYMS0        READE     ETDT911                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TDT GROUP:23                                       TDT23 /
      *////////////////////////////////////////////////////////////
     C     TDT23         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     23            ZGN1
     C     KEYMS1        SETLL     ETDT911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETDT911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      TDT
     C                   Z-ADD     TREP0         ZREPC0
     C                   Z-ADD     TREP1         ZREPC1
      *
     C     KEYMS1        READE     ETDT911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TMD GROUP:99                                       TMD99 /
      *////////////////////////////////////////////////////////////
     C     TMD99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ETMD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ETMD911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      TMD
      *
     C     KEYMS8        READE     ETMD911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TMP GROUP:99                                       TMP99 /
      *////////////////////////////////////////////////////////////
     C     TMP99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ETMP911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ETMP911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      TMP
      *
     C     KEYMS8        READE     ETMP911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TOD GROUP:17                                       TOD17 /
      *////////////////////////////////////////////////////////////
     C     TOD17         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     17            ZGN1
     C     KEYMS1        SETLL     ETOD911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETOD911                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      TOD
     C                   Z-ADD     TREP0         ZREPC0
     C                   Z-ADD     TREP1         ZREPC1
     C                   EXSR      LOC17
      *
     C     KEYMS1        READE     ETOD911                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TPL GROUP:39                                       TPL39 /
      *////////////////////////////////////////////////////////////
     C     TPL39         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     39            ZGN2
     C     KEYMS2        SETLL     ETPL911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETPL911                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TPL
     C                   Z-ADD     TREP0         ZREPD0
     C                   Z-ADD     TREP1         ZREPD1
     C                   Z-ADD     TREP2         ZREPD2
     C                   EXSR      MEA40
      *
     C     KEYMS2        READE     ETPL911                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TPL GROUP:99                                       TPL99 /
      *////////////////////////////////////////////////////////////
     C     TPL99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ETPL911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ETPL911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      TPL
      *
     C     KEYMS8        READE     ETPL911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TSR GROUP:99                                       TSR99 /
      *////////////////////////////////////////////////////////////
     C     TSR99         BEGSR
     C                   MOVE      '0'           *IN59
     C     KEYMS8        SETLL     ETSR911                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS8        READE     ETSR911                                59
     C     *IN59         DOWEQ     '0'
      *
     C                   EXSR      TSR
      *
     C     KEYMS8        READE     ETSR911                                59
     C  N59              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_______________
      * Find positions
      *""""""""""""""""
      * Find first non-0 position
     C     WDIR          IFEQ      'L'
     C     AXV           DO        AXH           AXV
     C     A(AXV)        COMP      '0'                                  8383
     C   83              END
      * Find last non-blank position                                     I
     C                   ELSE
      *                                                                  I
     C     SRÅ01         TAG
      *                                                                  I
     C     AXH           IFGT      AXV
     C     A(AXH)        IFEQ      *BLANKS
     C                   SUB       1             AXH
     C                   GOTO      SRÅ01
     C                   END
     C                   END
     C                   END
     C                   MOVE      'R'           WDIR
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV
     C                   MOVE      A(AXV)        WCHAR
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'
     C     WDIR          IFEQ      'R'
     C     WCHAR         IFEQ      ';'
     C                   MOVE      ':'           WCHAR
     C                   ENDIF
     C     WCHAR         COMP      WAPSTR                                 83
     C  N83WCHAR         COMP      '+'                                    83
     C  N83WCHAR         COMP      ':'                                    83
     C  N83WCHAR         COMP      '?'                                    83
     C   83              EXSR      SRÅA
     C                   END
     C                   END
      * Convert character                                                I
     C     WCHAR         LOOKUP    TABA          TABB                     83
     C     *IN83         IFEQ      '1'
     C                   MOVE      TABB          WCHAR
     C                   ENDIF
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)
     C                   ADD       1             BX
      * If arrayindex for output array is over 80 Then add a record      I
     C     BX            IFGT      80
     C                   MOVEA     B             SDATA
     C                   WRITE     EDISER
     C                   Z-ADD     1             BX
     C                   MOVE      *BLANKS       B
     C                   END
      *                                                                  I
     C                   END
      *
     C                   MOVE      'Y'           WCHART
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX
     C     BX            IFGT      80
     C                   MOVEA     B             SDATA
     C                   WRITE     EDISER
     C                   Z-ADD     1             BX
     C                   MOVE      *BLANKS       B
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leftjustify numerical fields                        SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * MOve correct value into Alfa 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'
     C                   MOVE      ØA152H        ØA12
     C                   ELSE
     C                   MOVEL     ØA152X        ØA12
     C                   MOVE      ',  '         ØA12
     C                   MOVE      ØA152D        ØA12
     C                   END
      * Scan from left and find first num over 0
     C     1             DO        11            ØX
     C     Ø12(ØX)       IFNE      '0'
     C                   GOTO      SRNE1
     C                   END
     C                   END
     C     SRNE1         TAG
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
      /COPY QEDSRC,BGM_O
      /COPY QEDSRC,UNB_O
      /COPY QEDSRC,UNH_O
      /COPY QEDSRC,UNT_O
      /COPY QEDSRC,UNZ_O
      /COPY QEDSRC,CNI_O_911
      /COPY QEDSRC,CNT_O_911
      /COPY QEDSRC,COM_O_911
      /COPY QEDSRC,CPI_O_911
      /COPY QEDSRC,CTA_O_911
      /COPY QEDSRC,CUX_O_911
      /COPY QEDSRC,DGS_O_911
      /COPY QEDSRC,DIM_O_911
      /COPY QEDSRC,DOC_O_911
      /COPY QEDSRC,DTM_O_911
      /COPY QEDSRC,EQA_O_911
      /COPY QEDSRC,EQD_O_911
      /COPY QEDSRC,EQN_O_911
      /COPY QEDSRC,FTX_O_911
      /COPY QEDSRC,GDS_O_911
      /COPY QEDSRC,GID_O_911
      /COPY QEDSRC,GOR_O_911
      *COPY QEDSRC,HAN_O_911
      /COPY QEDSRC,LOC_O_911
      /COPY QEDSRC,MEA_O_911
      /COPY QEDSRC,MOA_O_911
      /COPY QEDSRC,NAD_O_911
      /COPY QEDSRC,PCD_O_911
      /COPY QEDSRC,PCI_O_911
      /COPY QEDSRC,PIA_O_911
      /COPY QEDSRC,PRI_O_911
      /COPY QEDSRC,QTY_O_911
      /COPY QEDSRC,RFF_O_911
      /COPY QEDSRC,RNG_O_911
      /COPY QEDSRC,SEL_O_911
      /COPY QEDSRC,SGP_O_911
      /COPY QEDSRC,TCC_O_911
      /COPY QEDSRC,TDT_O_911
      /COPY QEDSRC,TMD_O_911
      /COPY QEDSRC,TMP_O_911
      /COPY QEDSRC,TOD_O_911
      /COPY QEDSRC,TPL_O_911
      /COPY QEDSRC,TSR_O_911
** TABA/TABB
ÅA
øO
ÆE
ØO
aA
bB
cC
dD
eE
fF
gG
hH
iI
jJ
kK
lL
mM
nN
oO
pP
qQ
rR
sS
tT
uU
vV
wW
xX
yY
zZ
æE
åA
