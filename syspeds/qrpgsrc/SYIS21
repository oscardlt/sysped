********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF9 99999999 = ALLE
********************************************************************
      *
OBS!! * Det er "IKKE lov" Â bruke kode E (ENDRING) i margen.
      *
      ***************************************************************
      *** BESTILLING AV RAPPORTER                                 ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01-99                                ***
      ***************************************************************
      *
     FISOFL2    IF   E           K DISK
     FISOFL3    IF   E           K DISK
     F                                     RENAME(ISOFR:ISOFR3)
     FISOFL4    IF   E           K DISK
     F                                     RENAME(ISOFR:ISOFR4)
     FISOFL5    IF   E           K DISK
     F                                     RENAME(ISOFR:ISOFR5)
     FISOFL8    IF   E           K DISK    RENAME(ISOFR:ISOFR8)
     FISOKDA    IF   E           K DISK
     FISOKDT    IF   E           K DISK
     FISOKDP    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FTRAN      IF   E           K DISK
     FSYIS20PF  O    E             PRINTER
     D AR1             S              1    DIM(8)
     D AR2             S              1    DIM(8)
      *
      * DS FOR DATOFORMATERING
      *
     D                 DS
     D  ISFADA                 1      8  0
     D  ISADA≈                 1      4  0
     D  ISADAM                 5      6  0
     D  ISADAD                 7      8  0
     D                 DS
     D  PRTADA                 1      6  0
     D  PRADAD                 1      2  0
     D  PRADAM                 3      4  0
     D  PRADA≈                 5      6  0
     D                 DS
     D  ISFAND                 1      8  0
     D  ISAND≈                 1      4  0
     D  ISANDM                 5      6  0
     D  ISANDD                 7      8  0
     D                 DS
     D  PRTAND                 1      6  0
     D  PRANDD                 1      2  0
     D  PRANDM                 3      4  0
     D  PRAND≈                 5      6  0
     D                 DS
     D  ISFMDA                 1      8  0
     D  ISMDA≈                 1      4  0
     D  ISMDAM                 5      6  0
     D  ISMDAD                 7      8  0
     D                 DS
     D  PRTMDA                 1      6  0
     D  PRMDAD                 1      2  0
     D  PRMDAM                 3      4  0
     D  PRMDA≈                 5      6  0
     D                 DS
     D  ISFLDA                 1      8  0
     D  ISLDA≈                 1      4  0
     D  ISLDAM                 5      6  0
     D  ISLDAD                 7      8  0
     D                 DS
     D  PRTLDA                 1      6  0
     D  PRLDAD                 1      2  0
     D  PRLDAM                 3      4  0
     D  PRLDA≈                 5      6  0
     D                 DS
     D  ISFGDA                 1      8  0
     D  ISGDA≈                 1      4  0
     D  ISGDAM                 5      6  0
     D  ISGDAD                 7      8  0
     D                 DS
     D  PRTGDA                 1      6  0
     D  PRGDAD                 1      2  0
     D  PRGDAM                 3      4  0
     D  PRGDA≈                 5      6  0
     D                 DS
     D  ISFRDA                 1      8  0
     D  ISRDA≈                 1      4  0
     D  ISRDAM                 5      6  0
     D  ISRDAD                 7      8  0
     D                 DS
     D  PRTRDA                 1      6  0
     D  PRRDAD                 1      2  0
     D  PRRDAM                 3      4  0
     D  PRRDA≈                 5      6  0
     D                 DS
     D  ISFFDA                 1      8  0
     D  ISFDA≈                 1      4  0
     D  ISFDAM                 5      6  0
     D  ISFDAD                 7      8  0
     D                 DS
     D  PRTFDA                 1      6  0
     D  PRFDAD                 1      2  0
     D  PRFDAM                 3      4  0
     D  PRFDA≈                 5      6  0
     D                 DS
     D  ISFUDA                 1      8  0
     D  ISUDA≈                 1      4  0
     D  ISUDAM                 5      6  0
     D  ISUDAD                 7      8  0
     D                 DS
     D  PRTUDA                 1      6  0
     D  PRUDAD                 1      2  0
     D  PRUDAM                 3      4  0
     D  PRUDA≈                 5      6  0
     D                 DS
     D  YDATOF                 1      8  0
     D  YDF≈≈                  1      4  0
     D  YDFMM                  5      6  0
     D  YDFDD                  7      8  0
     D                 DS
     D  YDATOT                 1      8  0
     D  YDT≈≈                  1      4  0
     D  YDTMM                  5      6  0
     D  YDTDD                  7      8  0
     D                 DS
     D  XDATO                  1      6  0
     D  XDTDD                  1      2  0
     D  XDTMM                  3      4  0
     D  XDT≈≈                  5      6  0
      *
     C     *ENTRY        PLIST
     C                   PARM                    UOPG              8
     C                   PARM                    UTRF              8
     C                   PARM                    UOPT              2
     C                   PARM                    UUNT              4
     C                   PARM                    UFDAT             6
     C                   PARM                    UTDAT             6
     C                   PARM                    UFLG              1
     C                   PARM                    USAKN             7
     C                   PARM                    UANTSI            2
      *
     C                   Z-ADD     0             ANTSID            2 0
     C                   MOVE      USAKN         XSAKN             7 0
      *
     C                   READ      FIRMR                                  20
      *
     C     ISOF2K        KLIST
     C                   KFLD                    WSOPG             8 0
     C                   KFLD                    YDATOF
     C     ISOF3K        KLIST
     C                   KFLD                    WSTRF             8 0
     C                   KFLD                    YDATOF
     C     ISOF4K        KLIST
     C                   KFLD                    WSOPT             2
     C                   KFLD                    YDATOF
     C     ISOF5K        KLIST
     C                   KFLD                    WSUNT             4
     C                   KFLD                    YDATOF
     C     ISOKDAK1      KLIST
     C                   KFLD                    ISFPFO
     C                   KFLD                    ISFAVA
     C     ISOKDAK2      KLIST
     C                   KFLD                    X_ISFPFO          5
     C                   KFLD                    ISFAVA
      *
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ISFOPG
      *
     C     HEDKEY        KLIST
     C                   KFLD                    ISFAVD
     C                   KFLD                    ISFOPD
      *
     C     TRNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ISFTRF
      *
     C                   MOVE      UFDAT         XDATO
     C                   MOVE      XDTDD         YDFDD
     C                   MOVE      XDTMM         YDFMM
     C     XDT≈≈         IFGT      50
     C     XDT≈≈         ADD       1900          YDF≈≈
     C                   ELSE
     C     XDT≈≈         ADD       2000          YDF≈≈
     C                   END
     C                   MOVE      UTDAT         XDATO
     C                   MOVE      XDTDD         YDTDD
     C                   MOVE      XDTMM         YDTMM
     C     XDT≈≈         IFGT      50
     C     XDT≈≈         ADD       1900          YDT≈≈
     C                   ELSE
     C     XDT≈≈         ADD       2000          YDT≈≈
     C                   END
      *
     C                   SELECT
     C     XSAKN         WHENNE    0
     C     XSAKN         CHAIN     ISOFL8                             33
     C     UFLG          WHENEQ    '1'
S01  C*    UOPG          COMP      '*'                                161615
N01  C     UOPG          COMP      '99999999'                         161615
     C   15              Z-ADD     0             WSOPG
     C*  16                EXSR CHKNUM
     C   16              MOVE      UOPG          WSOPG
     C     ISOF2K        SETLL     ISOFL2
     C   15              READ      ISOFL2                                 33
     C   16WSOPG         READE     ISOFL2                                 33
     C     UFLG          WHENEQ    '2'
S01  C*    UTRF          COMP      '*'                                161615
N01  C     UTRF          COMP      '99999999'                         161615
     C   15              Z-ADD     0             WSTRF
     C*  16                EXSR CHKNUM
     C   16              MOVE      UTRF          WSTRF
     C     ISOF3K        SETLL     ISOFL3
     C   15              READ      ISOFL3                                 33
     C   16WSTRF         READE     ISOFL3                                 33
     C     UFLG          WHENEQ    '3'
     C     UOPT          COMP      '*'                                161615
     C   15              MOVE      *BLANKS       WSOPT
     C   16              MOVE      UOPT          WSOPT
     C     ISOF4K        SETLL     ISOFL4
     C   15              READ      ISOFL4                                 33
     C   16WSOPT         READE     ISOFL4                                 33
     C                   OTHER
     C     UUNT          COMP      '*'                                161615
     C   15              MOVE      *BLANKS       WSUNT
     C   16              MOVE      UUNT          WSUNT
     C     ISOF5K        SETLL     ISOFL5
     C   15              READ      ISOFL5                                 33
     C   16WSUNT         READE     ISOFL5                                 33
     C                   ENDSL
      *
     C     START         TAG
      *
     C     *IN33         DOWEQ     '0'
      *
     C     ISFADA        IFLE      YDATOT
     C     ISFADA        ANDGE     YDATOF
     C     XSAKN         ORNE      0
     C                   EXSR      CLRSCR
     C                   EXSR      FORMAT
     C                   WRITE     RPT1
     c                   add       1             antsid
     C                   END
      *
     C                   SELECT
     C     XSAKN         WHENNE    0
     C                   EVAL      *IN33 = *ON
     C     UFLG          WHENEQ    '1'
     C   15              READ      ISOFL2                                 33
     C   16WSOPG         READE     ISOFL2                                 33
     C     UFLG          WHENEQ    '2'
     C   15              READ      ISOFL3                                 33
     C   16WSTRF         READE     ISOFL3                                 33
     C     UFLG          WHENEQ    '3'
     C   15              READ      ISOFL4                                 33
     C   16WSOPT         READE     ISOFL4                                 33
     C                   OTHER
     C   15              READ      ISOFL5                                 33
     C   16WSUNT         READE     ISOFL5                                 33
     C                   ENDSL
      *
     C  N33              ENDDO
      *
     C                   MOVE      ANTSID        UANTSI
     C                   SETON                                        LR
     C                   RETURN
      ***************************************************************
      *
     C     FORMAT        BEGSR
      *
     C     ISFPFO        IFEQ      *BLANKS
     C                   MOVEL     'EGEN'        PRTPFT
     C                   ELSE
     C     ISFPFO        CHAIN     ISKDTR                             11
     C                   MOVEL     TTEXT         PRTPFT
     C                   END
     C*    ISFAVA        CHAIN     ISKDAR                             11
     C     ISOKDAK1      CHAIN     ISKDAR                             11
     C   11ISOKDAK2      CHAIN     ISKDAR                             11
     C                   MOVEL     ATEXT         PRTAVT
     C     ISFANS        CHAIN     ISKDPR                             11
     C                   MOVEL     PTEXT         PRTANT
     C*
     C     ISFOPG        IFNE      0
     C     KUNKEY        CHAIN     KUNDR                              12
     C                   Z-ADD     ISFOPG        PRTOPN
     C                   MOVEL     KNAVN         PRTOPT
     C                   END
     C*
     C     TRNKEY        CHAIN     TRANR                              13
     C                   Z-ADD     ISFTRF        PRTTRN
     C                   MOVEL     VMNAVN        PRTTRF
     C     KUTRAK        KLIST
     C                   KFLD                    VMFIRM
     C                   KFLD                    VMTRKU
     C     KUTRAK        CHAIN     CUNDL01                            14
     C                   MOVE      ADR1          PRTTA1
     C     POSTNR        IFNE      *ZEROS
     C                   MOVEL     POSTNR        PRTTA3           30
     C                   MOVE      ADR3          PRTTA3
     C                   MOVEL     PRTTA3        PRTTA2
     C                   ELSE
     C                   MOVEL     SYPOGE        PRTTA2
     C                   MOVE      ADR3          PRTTA2
     C                   END
     C*
     C     HEDKEY        CHAIN     HEADFR                             14
     C                   MOVEL     HENAS         PRTAS1
     C                   MOVEL     HEADS3        PRTAS2
     C                   MOVEL     HENAK         PRTMO1
     C                   MOVEL     HEADK3        PRTMO2
     C                   MOVEL     HEVS1         PRTGDS
     C                   Z-ADD     HENT          PRTGKL
     C                   Z-ADD     HEVKT         PRTGKG
     C                   Z-ADD     HELM          PRTGLM
     C                   Z-ADD     HEM3          PRTGM3
     C*
     C                   Z-ADD     ISSAKN        PRTSAK
     C                   Z-ADD     ISFAVD        PRTAVD
     C                   Z-ADD     ISFOPD        PRTOPD
     C                   Z-ADD     ISFTUN        PRTTUN
     C                   MOVEL     ISFBIL        PRTBIL
     C                   MOVEL     ISFHEN        PRTHEN
     C                   MOVEL     ISFS1T        PRTS1T
     C                   MOVE      ISADAD        PRADAD
     C                   MOVE      ISADAM        PRADAM
     C                   MOVE      ISADA≈        PRADA≈
     C                   Z-ADD     ISFADK        PRTADK
     C                   MOVE      ISANDD        PRANDD
     C                   MOVE      ISANDM        PRANDM
     C                   MOVE      ISAND≈        PRAND≈
     C                   Z-ADD     ISFANK        PRTANK
     C                   Z-ADD     ISFSKL        PRTSKL
     C                   Z-ADD     ISFSKG        PRTSKG
     C                   Z-ADD     ISFSLM        PRTSLM
     C                   Z-ADD     ISFSM3        PRTSM3
     C                   MOVE      ISMDAD        PRMDAD
     C                   MOVE      ISMDAM        PRMDAM
     C                   MOVE      ISMDA≈        PRMDA≈
     C                   Z-ADD     ISFMKL        PRTMKL
     C                   MOVE      ISLDAD        PRLDAD
     C                   MOVE      ISLDAM        PRLDAM
     C                   MOVE      ISLDA≈        PRLDA≈
     C                   Z-ADD     ISFLKL        PRTLKL
     C                   MOVEL     ISFAV1        PRTAV1
     C                   MOVEL     ISFAV2        PRTAV2
     C                   MOVEL     ISFAV3        PRTAV3
     C                   MOVEL     ISFKO1        PRTKO1
     C                   MOVEL     ISFKO2        PRTKO2
     C                   MOVEL     ISFKO3        PRTKO3
     C                   MOVEL     ISFKO4        PRTKO4
     C                   MOVE      ISRDAD        PRRDAD
     C                   MOVE      ISRDAM        PRRDAM
     C                   MOVE      ISRDA≈        PRRDA≈
     C                   MOVEL     ISFRSI        PRTRSI
     C                   MOVE      ISGDAD        PRGDAD
     C                   MOVE      ISGDAM        PRGDAM
     C                   MOVE      ISGDA≈        PRGDA≈
     C                   MOVEL     ISFGSI        PRTGSI
     C                   MOVE      ISFDAD        PRFDAD
     C                   MOVE      ISFDAM        PRFDAM
     C                   MOVE      ISFDA≈        PRFDA≈
     C                   MOVEL     ISFFSI        PRTFSI
     C                   MOVE      ISUDAD        PRUDAD
     C                   MOVE      ISUDAM        PRUDAM
     C                   MOVE      ISUDA≈        PRUDA≈
     C                   MOVEL     ISFUSI        PRTUSI
     C                   Z-ADD     ISKRAV        PRTKRA
     C                   Z-ADD     ISFORV        PRTFOR
     C                   Z-ADD     ISFKOS        PRTKOS
     C*
     C                   ENDSR
     C***************************************************************
     C*
     C     CLRSCR        BEGSR
     C*
     C                   MOVEL     *BLANKS       PRTPFT
     C                   MOVEL     *BLANKS       PRTAVT
     C                   MOVEL     *BLANKS       PRTANT
     C                   MOVEL     *BLANKS       PRTBIL
     C                   MOVEL     *BLANKS       PRTHEN
     C                   MOVEL     *BLANKS       PRTS1T
     C                   MOVEL     *BLANKS       PRTAV1
     C                   MOVEL     *BLANKS       PRTAV2
     C                   MOVEL     *BLANKS       PRTAV3
     C                   MOVEL     *BLANKS       PRTKO1
     C                   MOVEL     *BLANKS       PRTKO2
     C                   MOVEL     *BLANKS       PRTKO3
     C                   MOVEL     *BLANKS       PRTKO4
     C                   MOVEL     *BLANKS       PRTRSI
     C                   MOVEL     *BLANKS       PRTGSI
     C                   MOVEL     *BLANKS       PRTFSI
     C                   MOVEL     *BLANKS       PRTUSI
     C                   MOVEL     *BLANKS       PRTOPT
     C                   MOVEL     *BLANKS       PRTAS1
     C                   MOVEL     *BLANKS       PRTAS2
     C                   MOVEL     *BLANKS       PRTMO1
     C                   MOVEL     *BLANKS       PRTMO2
     C                   MOVEL     *BLANKS       PRTGDS
     C                   MOVEL     *BLANKS       PRTTA1
     C                   MOVEL     *BLANKS       PRTTA2
     C                   MOVEL     *BLANKS       PRTTRF
     C                   Z-ADD     *ZEROS        PRTSAK
     C                   Z-ADD     *ZEROS        PRTAVD
     C                   Z-ADD     *ZEROS        PRTOPD
     C                   Z-ADD     *ZEROS        PRTTUN
     C                   Z-ADD     *ZEROS        PRTOPN
     C                   Z-ADD     *ZEROS        PRTADA
     C                   Z-ADD     *ZEROS        PRTADK
     C                   Z-ADD     *ZEROS        PRTAND
     C                   Z-ADD     *ZEROS        PRTANK
     C                   Z-ADD     *ZEROS        PRTSKL
     C                   Z-ADD     *ZEROS        PRTSKG
     C                   Z-ADD     *ZEROS        PRTSLM
     C                   Z-ADD     *ZEROS        PRTSM3
     C                   Z-ADD     *ZEROS        PRTMDA
     C                   Z-ADD     *ZEROS        PRTMKL
     C                   Z-ADD     *ZEROS        PRTLDA
     C                   Z-ADD     *ZEROS        PRTLKL
     C                   Z-ADD     *ZEROS        PRTRDA
     C                   Z-ADD     *ZEROS        PRTGDA
     C                   Z-ADD     *ZEROS        PRTFDA
     C                   Z-ADD     *ZEROS        PRTUDA
     C                   Z-ADD     *ZEROS        PRTKRA
     C                   Z-ADD     *ZEROS        PRTFOR
     C                   Z-ADD     *ZEROS        PRTKOS
     C                   Z-ADD     *ZEROS        PRTGKL
     C                   Z-ADD     *ZEROS        PRTGKG
     C                   Z-ADD     *ZEROS        PRTGLM
     C                   Z-ADD     *ZEROS        PRTGM3
     C*
     C                   ENDSR
     C***********************************************
     C*
     C     CHKNUM        BEGSR
     C*
     C                   MOVE      *OFF          *IN91
     C                   Z-ADD     8             ∆X                1 0
     C                   Z-ADD     8             ∆Y                1 0
     C                   MOVEA     *BLANKS       AR1
     C                   MOVEA     *BLANKS       AR2
     C                   MOVEA     UOPG          AR1
     C*          WRK       CABEQ*BLANKS   CHK99          92
     C* POSISJONER TIL SISTE TEGN I FELTET
     C     AR1(∆X)       DOWEQ     *BLANK
     C                   SUB       1             ∆X
     C                   END
     C* ERSTATT BLANK MED NULL OG SJEKK OM DET BARE ER TALL
     C     ∆X            DOWGT     0
     C     AR1(∆X)       IFEQ      *BLANK
     C                   MOVE      '0'           AR1(∆X)
     C                   END
     C     AR1(∆X)       IFGE      '0'
     C     AR1(∆X)       ANDLE     '9'
     C                   MOVE      AR1(∆X)       AR2(∆Y)
     C                   SUB       1             ∆X
     C                   SUB       1             ∆Y
     C                   ELSE                                                   <AR1,∆X
     C* FELTET INNEHOLDER IKKE BARE TALL. 91 BLIR SATT P≈
     C                   MOVE      *ON           *IN91
     C                   GOTO      CHK99
     C                   END                                                    <AR1,∆X
     C                   END                                                    <∆X
     C* FYLL OPP RESTEN AV FELTET MED NULL
     C     ∆Y            DOWGT     0
     C                   MOVE      '0'           AR2(∆Y)
     C                   SUB       1             ∆Y
     C                   ENDDO
     C*
     C                   MOVEA     AR2           UOPG
     C*
     C     CHK99         ENDSR
