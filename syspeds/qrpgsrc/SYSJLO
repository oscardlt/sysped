********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SÿK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL HENTE OPPLYSNINGER FOR ≈ SKRIVE        ***
      ***               LOP-LISTE                             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05-26                      ***
      *** LEDIGE INDIKATORER 27-29 31 34-61                   ***
      ***********************************************************
      *
     FCUNDL01   IF   E           K DISK
     FMULTKODT  IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FSYSJLOFM  CF   E             WORKSTN INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSAVD1                 1      4  0
     D  WSAVD2                 5      8  0
     D  WSAVD3                 9     12  0
     D  WSAVD4                13     16  0
     D  WSAVD5                17     20  0
     D  AVD                    1     20  0 DIM(5)
     D  AVD2                   1     20
     D                 DS
     D  WSTR1                  1      4
     D  WSTR2                  5      8
     D  WSTR3                  9     12
     D  WSTR4                 13     16
     D  WSTR5                 17     20
     D  TR                     1     20    DIM(5)
     D  TR2                    1     20
     D                 DS
     D  WSOT1                  1      2
     D  WSOT2                  3      4
     D  WSOT3                  5      6
     D  WSOT4                  7      8
     D  WSOT5                  9     10
     D  OT                     1     10    DIM(5)
     D  OT2                    1     10
     D                 DS
     D  WSCO1                  1      2
     D  WSCO2                  3      4
     D  WSCO3                  5      6
     D  WSCO4                  7      8
     D  WSCO5                  9     10
     D  CO                     1     10    DIM(5)
     D  CO2                    1     10
     D                 DS
     D  WSLB1                  1      5
     D  WSLB2                  6     10
     D  WSLB3                 11     15
     D  WSLB4                 16     20
     D  WSLB5                 21     25
     D  LB                     1     25    DIM(5)
     D  LB2                    1     25
     D                 DS
     D  WSOB1                  1      5
     D  WSOB2                  6     10
     D  WSOB3                 11     15
     D  WSOB4                 16     20
     D  WSOB5                 21     25
     D  OB                     1     25    DIM(5)
     D  OB2                    1     25
     D                 DS
     D  WSKNR1                 1      8  0
     D  WSKNR2                 9     16  0
     D  WSKNR3                17     24  0
     D  WSKNR4                25     32  0
     D  WSKNR5                33     40  0
     D  KN                     1     40  0 DIM(5)
     D  KN2                    1     40
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDT≈                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  WSDTTD                 1      2  0
     D  WSDTTM                 3      4  0
     D  WSDTT≈                 5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  XDT≈                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  XDTT≈                  1      4  0
     D  XDTTM                  5      6  0
     D  XDTTD                  7      8  0
     D  XDTT                   1      8  0
     D                 DS
     D  WS≈RF                  1      2  0
     D  WSUKEF                 3      4  0
     D  WS≈RT                  5      6  0
     D  WSUKET                 7      8  0
     D  WS≈U                   1      8
     D                 DS
     D  XF≈U                   1      6  0
     D  XFU≈≈                  1      4  0
     D  XFUKE                  5      6  0
     D                 DS
     D  XT≈U                   1      6  0
     D  XTU≈≈                  1      4  0
     D  XTUKE                  5      6  0
     D                UDS
     D  UFIRM                  1      2
     D  YAVDUU                15     18  0
     D  USG2                  19     21
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000000'    *IN(68)
     C                   MOVEA     '000000'      *IN(62)
     C                   SETOFF                                       30
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   04              DO
     C                   EXSR      SÿKDTA
     C                   GOTO      START
     C                   END
     C*
     C* TESTER DATA P≈ BILDE
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C*
     C                   EXSR      MOVDTA
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     TESTB         BEGSR
     C******************************************
     C     KODSFK        CHAIN     KOSFR                              99
     C   99              DO
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'SPS0001'     MSGNR
     C                   SETON                                        30
     C                   END
     C*
     C                   MOVE      WSDT≈         U≈≈               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      98
     C   98
     CANN30              DO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   END
     C*
     C  N98WSDTT         IFEQ      0
     C                   MOVE      WSDT          WSDTT
     C                   ELSE
     C                   MOVE      WSDTT≈        U≈≈               2 0
     C                   MOVE      WSDTTM        UMM               2 0
     C                   MOVE      WSDTTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      98
     C   98
     CANN30              DO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     37            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   END
     C     *IN98         IFEQ      '0'
     C                   MOVE      WSDTD         XDTD
     C                   MOVE      WSDTM         XDTM
     C     WSDT≈         IFGT      50
     C     WSDT≈         ADD       1900          XDT≈
     C                   ELSE
     C     WSDT≈         ADD       2000          XDT≈
     C                   END
     C                   MOVE      WSDTTD        XDTTD
     C                   MOVE      WSDTTM        XDTTM
     C     WSDTT≈        IFGT      50
     C     WSDTT≈        ADD       1900          XDTT≈
     C                   ELSE
     C     WSDTT≈        ADD       2000          XDTT≈
     C                   END
     C     XDTT          IFLT      XDT
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        3098
     C                   END
     C                   END
     C                   END
     C*
     C*
     C     WSSORT        COMP      1                                    97
     C  N97WSSORT        COMP      8                                  97
     C   97
     CANN30              DO
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'SPS0112'     MSGNR
     C                   SETON                                        30
     C                   END
     C   30              GOTO      SLTB
     C*
     C     WSSORT        IFEQ      1                                            1<-B
     C                   SETOFF                                       32
     C     1             DO        5             XN                2 0            3<-B
     C     AVD(XN)       IFNE      0                                               4<-B
     C                   MOVE      AVD(XN)       YAVD              4 0
     C     KODTVK        CHAIN     KOVR                               33
     C  N32              DO                                                         5<-B
     C  N33KODTWK        CHAIN     KOWR                               33
     C  N33              Z-ADD     36            YPLNR             3 0
     C  N33KODTPK        CHAIN     KOPR                               33
     C  N33              MOVE      KOPNVN        UPRT36
     C  N33              MOVE      KOPTY         UPT36
     C                   SETON                                        32
     C                   END                                                        5<-E
     C   33
     CANN30              DO                                                         5<-B
     C                   MOVE      'SPA0001'     MSGNR
     C                   Z-ADD     11            LINNBR
     C     XN            MULT      10            POSNBR
     C     POSNBR        ADD       18            POSNBR
     C                   SETON                                        30
     C                   END                                                        5<-E
     C   3397            SUB       XN            X2                2 0
     C   33              MOVE      '1'           *IN(X2)
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C*                    END                              2<-E
     C                   END                                                    1<-E
     C*
     C     WSSORT        IFEQ      3                                            1<-B
     C     WSUKEF        COMP      1                                    90
     C  N90WSUKEF        COMP      53                                 90
     C   90              DO                                                      2<-B
     C                   MOVE      'SPU0101'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   SETON                                        30
     C                   END                                                     2<-E
     C  N90WSUKET        IFEQ      0                                             2<-B
     C                   MOVE      WSUKEF        WSUKET
     C                   MOVE      WS≈RF         WS≈RT
     C                   ELSE                                                    2
     C     WS≈RF         IFGT      50
     C     WS≈RF         ADD       1900          XFU≈≈
     C                   ELSE
     C     WS≈RF         ADD       2000          XFU≈≈
     C                   END
     C                   MOVE      WSUKEF        XFUKE
     C     WS≈RT         IFGT      50
     C     WS≈RT         ADD       1900          XTU≈≈
     C                   ELSE
     C     WS≈RT         ADD       2000          XTU≈≈
     C                   END
     C                   MOVE      WSUKET        XTUKE
     C     XT≈U          COMP      XF≈U                                 90
     C   90              DO                                                       3<-B
     C                   MOVE      'SPU0102'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   SETON                                        30
     C                   END                                                      3<-E
     C     WSUKET        COMP      53                                 89
     C   89              DO                                                       3<-B
     C                   MOVE      'SPU0101'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   SETON                                        30
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     WSSORT        IFEQ      4                                            1<-B
     C     1             DO        5             XN                2 0            3<-B
     C     OT(XN)        IFNE      *BLANKS                                         4<-B
     C                   MOVE      OT(XN)        YOT               2
     C     KODOTK        CHAIN     KOOTYR                             33
     C   33
     CANN30              DO                                                         5<-B
     C                   MOVE      'SPO0001'     MSGNR
     C                   Z-ADD     14            LINNBR
     C     XN            MULT      10            POSNBR
     C     POSNBR        ADD       18            POSNBR
     C                   SETON                                        30
     C                   END                                                        5<-E
     C   3389            SUB       XN            X2                2 0
     C   33              MOVE      '1'           *IN(X2)
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C*                    END                              2<-E
     C                   END                                                    1<-E
     C*
     C     WSSORT        IFEQ      5                                            1<-B
     C     1             DO        5             XN                2 0            3<-B
     C     CO(XN)        IFNE      *BLANKS                                         4<-B
     C                   MOVE      CO(XN)        YKD4              2
     C     YKD4          CHAIN     CDCON4                             33
     C   33
     CANN30              DO                                                         5<-B
     C                   MOVE      'SPC0103'     MSGNR
     C                   Z-ADD     15            LINNBR
     C     XN            MULT      10            POSNBR
     C     POSNBR        ADD       18            POSNBR
     C                   SETON                                        30
     C                   END                                                        5<-E
     C   3384            SUB       XN            X2                2 0
     C   33              MOVE      '1'           *IN(X2)
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C*                    END                              2<-E
     C                   END                                                    1<-E
     C*
     C     WSSORT        IFEQ      6                                            1<-B
     C     1             DO        5             XN                2 0            3<-B
     C     LB(XN)        IFNE      *BLANKS                                         4<-B
     C                   MOVE      LB(XN)        YBK               5
     C     YBK           CHAIN     CDBOAT                             33
     C   33
     CANN30              DO                                                         5<-B
     C                   MOVE      'SPB0104'     MSGNR
     C                   Z-ADD     16            LINNBR
     C     XN            MULT      10            POSNBR
     C     POSNBR        ADD       18            POSNBR
     C                   SETON                                        30
     C                   END                                                        5<-E
     C   3379            SUB       XN            X2                2 0
     C   33              MOVE      '1'           *IN(X2)
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C*                    END                              2<-E
     C                   END                                                    1<-E
     C*
     C     WSSORT        IFEQ      7                                            1<-B
     C     1             DO        5             XN                2 0            3<-B
     C     OB(XN)        IFNE      *BLANKS                                         4<-B
     C                   MOVE      OB(XN)        YBK               5
     C     YBK           CHAIN     CDBOAT                             33
     C   33
     CANN30              DO                                                         5<-B
     C                   MOVE      'SPB0104'     MSGNR
     C                   Z-ADD     17            LINNBR
     C     XN            MULT      10            POSNBR
     C     POSNBR        ADD       18            POSNBR
     C                   SETON                                        30
     C                   END                                                        5<-E
     C   3374            SUB       XN            X2                2 0
     C   33              MOVE      '1'           *IN(X2)
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C*                    END                              2<-E
     C                   END                                                    1<-E
     C*
     C     WSSORT        IFEQ      8                                            1<-B
     C     1             DO        5             XN                2 0           2<-B
     C     KN(XN)        IFNE      0                                              3<-B
     C                   MOVE      KN(XN)        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33
     CANN30              DO                                                        4<-B
     C                   MOVE      'SPK0137'     MSGNR
     C                   Z-ADD     18            LINNBR
     C     XN            MULT      10            POSNBR
     C     POSNBR        ADD       18            POSNBR
     C                   SETON                                        30
     C                   END                                                       4<-E
     C   3369            SUB       XN            X2                2 0
     C   33              MOVE      '1'           *IN(X2)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     WSKKN         IFNE      0
     C                   MOVE      WSKKN         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            63
     C   63
     CANN30              DO
     C                   MOVE      'SPK0001'     MSGNR
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   SETON                                        30
     C                   END
     C     WSKKD         COMP      *BLANKS                                62
     C   62
     CANN30              DO
     C                   MOVE      'YBC0541'     MSGNR
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     38            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     MOVDTA        BEGSR
     C***********************************************
     C                   MOVE      WSSG          USG               3
     C                   MOVE      XDT           UDT               8
     C                   MOVE      XDTT          UDTT              8
     C                   MOVE      WSSORT        USORT             1
     C                   MOVE      AVD2          UAVD             20
     C                   MOVE      TR2           UTR              20
     C                   MOVE      WS≈U          U≈U               8
     C                   MOVE      OT2           UOT              10
     C                   MOVE      CO2           UCO              10
     C                   MOVE      KN2           UKN              40
     C                   MOVE      LB2           ULB              25
     C                   MOVE      OB2           UOB              25
     C                   MOVE      WSKKN         UKKN              8
     C                   MOVE      WSKKD         UKKD              2
     C                   MOVE      WSRGF         URGF              2
     C                   MOVE      WSRGT         URGT              2
     C*
     C     WSPRT         IFNE      *BLANKS
     C                   MOVE      WSPRT         UPRT36
     C                   END
     C     UPRT36        IFEQ      *BLANKS
     C                   Z-ADD     36            YPLNR             3 0
     C     KODTP2        CHAIN     KOPR                               33
     C  N33              MOVE      KOPNVN        UPRT36
     C  N33              MOVE      KOPTY         UPT36
     C   33              MOVEL     'QPRINT '     UPRT36
     C                   END
     C     UPT36         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT36
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SÿKKUN        BEGSR
     C***********************************************
S01  C*                  MOVE      WSKNR1        UKNR1             8 0
S01  C*                  MOVE      WSKNR2        UKNR2             8 0
S01  C*                  MOVE      WSKNR3        UKNR3             8 0
S01  C*                  MOVE      WSKNR4        UKNR4             8 0
S01  C*                  MOVE      WSKNR5        UKNR5             8 0
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    UFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    UKNR1
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    UKNR2
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    UKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    UKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    UKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
S01  C*                  MOVE      UKNR1         WSKNR1
S01  C*                  MOVE      UKNR2         WSKNR2
S01  C*                  MOVE      UKNR3         WSKNR3
S01  C*                  MOVE      UKNR4         WSKNR4
S01  C*                  MOVE      UKNR5         WSKNR5
N01   *
N01  C     LINNBR        IFEQ      18
N01  C     POSNBR        ANDGE     68
N01  C     POSNBR        ANDLE     75
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR5
N01  C                   PARM                    UFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     19            LINNBR
N01  C                   Z-ADD     28            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      18
N01  C     POSNBR        ANDGE     58
N01  C     POSNBR        ANDLE     65
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR4
N01  C                   PARM                    UFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     68            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      18
N01  C     POSNBR        ANDGE     48
N01  C     POSNBR        ANDLE     55
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR3
N01  C                   PARM                    UFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     58            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      18
N01  C     POSNBR        ANDGE     38
N01  C     POSNBR        ANDLE     45
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR2
N01  C                   PARM                    UFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     48            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      18
N01  C     POSNBR        ANDGE     28
N01  C     POSNBR        ANDLE     35
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR1
N01  C                   PARM                    UFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     38            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SÿKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG
     C*
     C     LINNBR        IFEQ      14                                           1<-B
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     69
     C     POSNBR        SUB       17            XN
     C     XN            DIV       10            XN
     C                   MOVE      OT(XN)        UOT2              2
     C                   CALL      'SYFI10C'
     C                   PARM                    UOT2
     C                   MOVE      UOT2          OT(XN)
     C     POSNBR        IFGE      68                                            2<-B
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   ELSE                                                    2
     C                   ADD       10            POSNBR
     C                   END                                                     2<-E
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
     C*
     C     LINNBR        IFEQ      15                                           1<-B
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     69
     C     POSNBR        SUB       17            XN
     C     XN            DIV       10            XN
     C                   MOVE      CO(XN)        UCO2              2
     C                   CALL      'SYSJ02X'
     C                   PARM                    UCO2
     C                   MOVE      UCO2          CO(XN)
     C     POSNBR        IFGE      68                                            2<-B
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   ELSE                                                    2
     C                   ADD       10            POSNBR
     C                   END                                                     2<-E
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
     C*
     C     LINNBR        IFEQ      16                                           1<-B
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     72
     C     POSNBR        SUB       17            XN
     C     XN            DIV       10            XN
     C                   MOVE      LB(XN)        ULB2              5
     C                   CALL      'SYSJ11A'
     C                   PARM                    ULB2
     C                   MOVE      ULB2          LB(XN)
     C     POSNBR        IFGE      68                                            2<-B
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   ELSE                                                    2
     C                   ADD       10            POSNBR
     C                   END                                                     2<-E
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
     C*
     C     LINNBR        IFEQ      17                                           1<-B
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     72
     C     POSNBR        SUB       17            XN
     C     XN            DIV       10            XN
     C                   MOVE      OB(XN)        UOB2              5
     C                   CALL      'SYSJ11A'
     C                   PARM                    UOB2
     C                   MOVE      UOB2          OB(XN)
     C     POSNBR        IFGE      68                                            2<-B
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   ELSE                                                    2
     C                   ADD       10            POSNBR
     C                   END                                                     2<-E
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
     C*
     C     LINNBR        IFEQ      18
     C     POSNBR        OREQ      28
     C     POSNBR        OREQ      75
     C                   EXSR      SÿKKUN
     C                   GOTO      SLSÿK
     C                   END
     C*
     C     LINNBR        IFEQ      19                                           1<-B
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     35
     C                   MOVE      *BLANKS       USÿKNV           30
     C                   MOVE      WSKKN         UKKN8             8 0
     C                   CALL      'SOEKKUN'
     C                   PARM                    UKKN8
     C                   PARM                    UFIRM
     C                   PARM                    USÿKNV
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
      *
     C     LINNBR        IFEQ      20                                           1<-B
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     29
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSRGF
     C                   PARM                    USPED
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
      *
     C     LINNBR        IFEQ      20                                           1<-B
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSRGT
     C                   PARM                    USPED
     C                   GOTO      SLSÿK
     C                   END                                                    1<-E
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSÿK         ENDSR
     C*
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    WSSG
     C     KODOTK        KLIST
     C                   KFLD                    YOTUNI
     C                   KFLD                    YOT
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI
     C                   KFLD                    YAVD
     C                   KFLD                    YPLNR
     C     KODTP2        KLIST
     C                   KFLD                    YPUNI
     C                   KFLD                    YAVDUU
     C                   KFLD                    YPLNR
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    YAVD
     C     KODTVK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    YAVD
     C*
     C*===============================================
     C     *ENTRY        PLIST
     C                   PARM                    UIN01             1
     C                   PARM                    USG
     C                   PARM                    UDT
     C                   PARM                    UDTT
     C                   PARM                    USORT
     C                   PARM                    UAVD
     C                   PARM                    UTR
     C                   PARM                    U≈U
     C                   PARM                    UOT
     C                   PARM                    UCO
     C                   PARM                    ULB
     C                   PARM                    UOB
     C                   PARM                    UKN
     C                   PARM                    UKKN
     C                   PARM                    UKKD
     C                   PARM                    URGF
     C                   PARM                    URGT
     C                   PARM                    UPRT36           10
     C                   PARM                    UPT36            10
     C*===============================================
     C*
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      'OTY'         YOTUNI            3
     C                   MOVE      'P'           YPUNI             1
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      USG2          WSSG
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        AVD2
     C                   MOVE      *BLANKS       TR2
     C                   MOVE      *ZEROS        WS≈U
     C                   MOVE      UYEAR         WS≈RF
     C                   MOVE      UYEAR         WS≈RT
     C                   MOVE      *BLANKS       OT2
     C                   MOVE      *BLANKS       CO2
     C                   MOVE      *BLANKS       LB2
     C                   MOVE      *BLANKS       OB2
     C                   MOVE      *ZEROS        KN2
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     28            POSNBR
     C*
S01  C*                  Z-ADD     5             SOANTK            1 0
S01  C*                  MOVE      'DIV3707'     XMSGNR            7            MELDING-ID
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIV≈
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     8             XMSGL             4 0          LENGDE P≈ MELDING
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      '1'           SOTXT1
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*                  MOVE      '2'           SOTXT2
S01  C*                  MOVEL     XMSG          SOTXT3            8
S01  C*                  MOVE      '3'           SOTXT3
S01  C*                  MOVEL     XMSG          SOTXT4            8
S01  C*                  MOVE      '4'           SOTXT4
S01  C*                  MOVEL     XMSG          SOTXT5            8
S01  C*                  MOVE      '5'           SOTXT5
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    HENTMS        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    XMSG             62
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDT≈         UDT3              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTD         UDT1              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT3          WSDT≈
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT1          WSDTD
     C*
     C                   ENDSR
     C*
