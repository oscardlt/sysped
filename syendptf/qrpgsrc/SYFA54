********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 02 SH  PTF10 innført strekkode mm....
10XXX * 03 SH  PTF10 til arkiv
10XXX * 04 JOV PTF10 HESDL var falt ut i V10
10172 * 05 SH  PTF10 track and trace
10172 * 06 SH  PTF10 espeduser
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 07 YBC PTF11 KOL. 118-120 KAN IKKE BENYTTES
10172 * 08 SH  PTF11 sikring barkode
10172 * 09 SH  PTF11 *SYNYTMS*  HERFA
10172 * 10 SH  PTF11 rettelse arkiv
      * %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10172 * 11 SH  PTF12 KOMMER IKKE HODETEKST
10172 * 12 JOV PTF12 hopp over spredn-fr.berv med kode O = oppdraget
10172 * 13 SH  PTF12 sikre strekkode
      * 14 JOV PTF12 SKRIV OGSÅ G-LINJER + GODSMERKE 1/2
********************************************************************
      *
      * UTSKRIFT AV LASTELISTE
      *
n05  FTRACKF    O  A E           K DISK
n03  FARKTXT    IF   E           K DISK
n03  FFIRMARC   IF   E           K DISK
n03  FARKIVP    O  A E             DISK
n03  FFIRM      IF   E           K DISK
N02  FSYPARL1   IF   E           K DISK
N02  FDOKUF     IF   E           K DISK
     FHESTED    IF   E           K DISK
     FHODE      IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FFREETXT2  IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTH     IF   E           K DISK
     FHEAD11    IF   E           K DISK
     FTURER     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FKODFRI    IF   E           K DISK
     FSYFA54PF  O    E             PRINTER OFLIND(*IN90)
     D HO              S             80    DIM(7)
     D HE              S             80    DIM(7)
     D HT              S             80    DIM(7)
s11  D*HP              S             80    DIM(7)
     D KNA             S              8  0 DIM(40)
n11  D                 DS
N11  D HP                      1    560    DIM(7)
N11  D  HP1                    1     80
N11  D  HP2                   81    160
N11  D  HP3                  161    240
N11  D  HP4                  241    320
N11  D  HP5                  321    400
N11  D  HP6                  401    480
N11  D  HP7                  481    560
     D                 DS
     D  DFS                    1     10
     D                                     DIM(10)
     D  FSDOKK                 1     10
n04  D                 DS
n04  D  HESDL                  1     20
n04  D  HESDL2                 1     15
n02  D                 DS
n02  D  HXSNDN                 1     20
n02  D  HXSNDNB                1     20
N02  D                 DS
N02  D  STR                    1     75
N02  D                                     DIM(75)
N02  D  KFMT1                  1     75
n02  D                 DS
n02  D  HEAVDOPD               1     12
n02  D  HEAVDOPDB              1     12
n02  D    HEAVDA               1      4
n02  D     Strek               5      5    INZ('/')
n02  D    HEOPDA               6     12                                         OBS! ER alt 7 lang!!
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
     D  HEFT1C                 1     30
     D                 DS
     D  HESDF                  1      5
     D  HESDF2                 1      5
     D                 DS
     D  HESDT                  1      5
     D  HESDT2                 1      5
     D                 DS
     D  HEKDL                  1     15
     D  HEKDL2                 1     15
     D                 DS
     D  UDATO1                 1      6  0
     D  UDT1D                  1      2  0
     D  UDT1M                  3      4  0
     D  UDT1Å                  5      6  0
     D                 DS
     D  WDT                    1      8
     D  WDTÅ                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  TUETD                  1      8  0
     D  TUETDÅ                 1      4  0
     D  TUETDM                 5      6  0
     D  TUETDD                 7      8  0
     D                 DS
     D  XETD                   1      6  0
     D  XETDD                  1      2  0
     D  XETDM                  3      4  0
     D  XETDÅ                  5      6  0
     D                 DS
     D  TUETA                  1      8  0
     D  TUETAÅ                 1      4  0
     D  TUETAM                 5      6  0
     D  TUETAD                 7      8  0
     D                 DS
     D  XETA                   1      6  0
     D  XETAD                  1      2  0
     D  XETAM                  3      4  0
     D  XETAÅ                  5      6  0
     D                 DS
     D  HENAS                  1     30
E07  D  HENAS28                1     28
     D                 DS
     D  HENAK                  1     30
E07  D  HENAK27                1     27
N07  D                 DS
N07  D  HEADS1                 1     30
N07  D  HEADS128               1     28
N07  D                 DS
N07  D  HEADK1                 1     30
N07  D  HEADK127               1     27
N07  D                 DS
N07  D  HEADS2                 1     30
N07  D  HEADS228               1     28
N07  D                 DS
N07  D  HEADK2                 1     30
N07  D  HEADK227               1     27
N07  D                 DS
N07  D  HEADS3                 1     30
N07  D  HEADS328               1     28
N07  D                 DS
N07  D  HEADK3                 1     30
N07  D  HEADK327               1     27
n03  D                 DS
n03  D  XULTID                 1     14  0
n03  D  XULTM                  1      6  0
n03  D  XULDD                  7      8  0
n03  D  XULMM                  9     10  0
n03  D  XULÅÅ                 11     14  0
n03  D                 DS
n03  D  ULÅÅ                   1      4  0
n03  D  ULMM                   5      6  0
n03  D  ULDD                   7      8  0
n03  D  ULDT                   1      8  0
     D                SDS
     D  ZUSER                254    263
     D                UDS
s03  D* FIRMA                  3      4
     D  WAVDUU                15     18  0
     D  WTUR                  22     29  0
N06  D  INS2                 126    155                                         (se syfa55)
     D  PRANT                231    233  0
     D  BRUDDA               961    961
      *
N02  C     *ENTRY        PLIST
N02  C                   PARM                    ULASER            1
N03  C                   READ      FIRM                                   33
     C     ULASER        COMP      'P'                                    80
     C  N80ULASER        COMP      'F'                                    80
N03  C  N80ULASER        COMP      'A'                                    80
      *
     C                   MOVE      *ZEROS        ANTOPD            3 0
     C                   MOVE      WAVDUU        WAVD              4 0
     C                   MOVE      *ZEROS        XETD
     C                   MOVE      *ZEROS        XETA
     C*
     C                   EXSR      GETMSB
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXSKKO            1
     C                   MOVE      'L'           XXSKKO
     C     HESTK         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
N02  C     DOKKey        KLIST
N02  C                   KFLD                    DFRI
N02  C                   KFLD                    HEAVD
N02  C                   KFLD                    HEOPD
N02  C                   move      'F'           DFRI
N02  C     IFBKey        KLIST
N02  C                   KFLD                    HEAVD
N02  C                   KFLD                    HEOPD
N02  C                   KFLD                    IFBKODE
N02  C                   move      'IFB'         IFBKODE           3
     C*
N02  C     BarKey        KLIST
N02  C                   KFLD                    XXPAKN            8 0
N02  C                   KFLD                    XXPAID            5
N02  C                   movel     'LOSBA'       XXPAID
N02  c     BarKey        chain     SYPARL1                            33
N02  C  N33              MOVEL     SYVRDA        LOSBA             1
N02  C                   move      'L'           BarLR             1
N02  C* SKRIV TURNR SOM STREK-KODE?
N02  C     KFMPOS        ifne      *ZEROS
N02  C                   MOVE      KFMPOS        NN                2 0
N02  C                   MOVE      WTUR          AUPRO             8
N02  C                   MOVEA     AUPRO         STR(NN)
N02  C                   END
N08  C                   MOVE      WTUR          AUPRO             8
      * HENT STRINGKODE
     C                   Z-ADD     20            WTSKRN            3 0
     C                   MOVE      WAVDUU        LOSAV2            4 0
     C                   CALL      'SYGE01'
     C                   PARM                    LOSAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C     WOPFM         IFNE      *BLANKS
     C     WOPFM         CHAIN     KODTFM                             33
     C                   END
     C*
     C*
     C* FINNER OM AVDELING HAR AVRUNDING
     C*
     C*
     C     KOVKEY        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C                   MOVE      'V'           KOVUNI
     C                   MOVE      WAVDUU        KOVAVD
     C     KOVKEY        CHAIN     KODTV                              33
     C                   MOVE      KOVAVR        FIRAVR            1
     C*
     C* FINNER OM AVDELING HAR HEADING
     C*
     C*
     C     KOHKEY        KLIST
     C                   KFLD                    KOHUNI
     C                   KFLD                    KOHAVD
     C                   MOVEL     'H'           KOHUNI
     C                   MOVE      WAVDUU        KOHAVD
     C     KOHKEY        CHAIN     KODTH                              33
     C     KOHLAS        COMP      'J'                                    06
     C*
     C   06              EXSR      HOSR
     C*
     C                   MOVE      *ZEROS        PRANT
     C                   MOVE      *ZEROS        POSNR             3 0
     C                   MOVE      *BLANKS       WDT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM               6
     C                   MOVE      WDTD          UDT1D
     C                   MOVE      WDTM          UDT1M
     C                   MOVE      WDTÅ          UDT1Å
     C                   MOVE      WTM           TID
n06   * Fra PDA - ta Userid fra UDS  (låner INS2 fra CMR)
n06  C     ZUSER         IFEQ      'QTMHHTTP'
n06  C                   MOVEL     INS2          PDAUSR           10
n06  C                   END
     C*
     C* HENTER OPPLYSNINGER FRA TURREGISTER
     C*
     C     TUKEY         KLIST
     C                   KFLD                    TUAVD
     C                   KFLD                    TUPRO
     C*
     C                   MOVE      WAVD          TUAVD
     C                   MOVE      WTUR          TUPRO
     C     TUKEY         CHAIN     TURER                              60
     C   60              MOVE      *BLANKS       TUTARF
     C   60              MOVE      *BLANKS       TUBILN
     C   60              MOVE      *BLANKS       TUHENG
     C   60              MOVE      *BLANKS       TUNAT
     C  N60              IF        TUSG = 'WEB'
     C                   MOVE      *ON           *IN45
     C                   MOVE      TUETDD        XETDD
     C                   MOVE      TUETDM        XETDM
     C                   MOVE      TUETDÅ        XETDÅ
     C                   MOVE      TUETAD        XETAD
     C                   MOVE      TUETAM        XETAM
     C                   MOVE      TUETAÅ        XETAÅ
     C                   EXSR      HOSR
     C                   END
     C*
     C* HENTER OPPLYSNINGER FRA KUNDEREGISTER
     C* VELGER DERMED SPRÅK HEADING
     C*
     C     KUNKEY        KLIST
s03  C*                  KFLD                    FIRMA
n03  C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C*
     C  N60              MOVE      TUKNA         KUNDNR
     C  N60KUNKEY        CHAIN     CUNDL01                            60
     C   60              MOVE      *BLANKS       KNAVN
     C*
     C*
     C* HENTER OPPLYSNINGER FRA HEADINGREGISTER
     C* GÅR I LØKKE PÅ ALLE AVDELINGER
     C                   MOVE      KOVAVD        HEAVD
     C                   MOVE      WTUR          HEPRO
     C                   MOVE      *BLANKS       HEPOS1
     C     BRUDDA        IFEQ      'J'
     C                   EXSR      BRUSR
     C                   ELSE
     C                   EXSR      LES
     C     ANTOPD        IFGT      *ZEROS
     C                   Z-ADD     1             PRANT
     C                   WRITE     PTOT
n03  C     ulaser        ifne      'A'
n03  c                   exsr      arkivsr
n05  c                   exsr      ttsr
     C                   END
     C                   END
     C*
     C                   END
     C*
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     LES           BEGSR
     C******************************************
     C*
     C     WTUR          SETLL     HEAD11
     C*
     C     STL           TAG
     C                   SETOFF                                       33
     C     WTUR          READE     HEAD11                                 33
     C   33              GOTO      SLLES
     C*
     C* GÅR TIL NESTE AVDELING VED IKKE FLERE TURER
     C*
     C*
     C* GÅR TIL OPPDRAG HVIS STATUS = S
     C*
     C     BRUDDA        IFEQ      'J'
     C     HEKNA         IFNE      AGENT
     C                   GOTO      STL
     C                   END
     C                   END
     C*
     C     HEST          IFEQ      'S'
     C                   GOTO      STL
     C                   END
     C                   MOVE      HEAVD         WAVD
     C                   EXSR      PRINT
     C                   GOTO      STL
     C*
     C     SLLES         TAG
     C                   ENDSR
     C******************************************
     C     BRUSR         BEGSR
     C******************************************
     C*
     C* FINNER ALLE AGENTER
     C*
     C                   Z-ADD     1             NA                2 0
     C*
     C     WTUR          SETLL     HEAD11
     C*
     C     STBRU         TAG
     C                   SETOFF                                       33
     C     WTUR          READE     HEAD11                                 33
     C   33              GOTO      SLBRU
     C*
     C* GÅR TIL NESTE AVDELING VED IKKE FLERE TURER
     C*
     C*
     C* GÅR TIL OPPDRAG HVIS STATUS = S
     C*
     C     HEST          IFEQ      'S'
     C                   GOTO      STBRU
     C                   END
     C*
     C     HEKNA         LOOKUP    KNA                                    44
     C  N44              MOVE      HEKNA         KNA(NA)
     C  N44              ADD       1             NA
     C                   GOTO      STBRU
     C*
     C     SLBRU         TAG
     C*
     C* KALLER LESRUTINEN FOR ALLE AGENTER
     C*
     C                   Z-ADD     1             NA
     C                   DO        40
     C     KNA(NA)       IFNE      0
     C                   Z-ADD     KNA(NA)       AGENT             8 0
     C*
     C  N60              MOVE      KNA(NA)       KUNDNR
     C  N60KUNKEY        CHAIN     CUNDL01                            60
     C   60              MOVE      *BLANKS       KNAVN
     C                   Z-ADD     0             NR
     C                   Z-ADD     0             POSNR
     C*
     C                   EXSR      LES
     C     ANTOPD        IFGT      *ZEROS
     C                   Z-ADD     1             PRANT
     C                   WRITE     PTOT
n03  C     ulaser        ifne      'A'
n03  c                   exsr      arkivsr
n03  C                   END
     C                   END
     C                   END
     C                   ADD       1             NA
     C                   END
     C                   ENDSR
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C*
     C   90              WRITE     HEAD0
     C   90              MOVE      '0'           *IN90
     C     NR            IFEQ      *ZEROS
     C                   WRITE     HEAD0
     C                   END
     C                   ADD       1             NR                5 0
     C                   ADD       1             POSNR
     C     HEKDL         COMP      *BLANKS                            7777
     C     FIRAVR        IFNE      'J'
     C                   EXSR      OMREGN
     C                   ELSE
     C                   Z-ADD     HEFBV         BVEKT
     C                   END
     C     HESTK         CHAIN     HESTED                             33
     C  N33              MOVEL     HSFROM        HESDF
     C  N33              MOVEL     HSTO          HESDT
N09  C* fikser referanse avs/mot
N09  C                   MOVE      HERFA         XXRFA
N09  C     HEUR          IFEQ      'H'
N09  C     TRKDFF        ANDEQ     'K'
N09  C     HERFK         ANDNE     *blanks
N09  C                   MOVEL     HERFK         XXRFA
N09  C                   end
N09  C     XXRFA         comp      *blanks                            9494
     C                   WRITE     DET
      * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE LIK L)
     C     HESTK         SETLL     FRISOK
     C     HESTK         READE     FRISOK                                 91
     C     *IN91         DOWEQ     '0'
     C                   SORTA     DFS
     C     DFS(10)       IFNE      ' '
     C     'L'           LOOKUP    DFS                                    91
     C     *IN91         IFEQ      '1'
     C     FSKODE        CHAIN     KODFRI                             91
     C     *IN91         IFEQ      '0'
     C   90              WRITE     HEAD0
     C   90              MOVE      '0'           *IN90
     C                   WRITE     DETFS
     C                   END
     C                   END
     C                   END
     C*
     C     HESTK         READE     FRISOK                                 91
     C                   END
      *
      * OG UTLEV.FORBEHOLD
     C     HEKFT1        IFEQ      *BLANKS
     C     HEFT1A        ANDNE     *BLANKS
     C                   WRITE     DETUFB
     C                   END
      *
     C* SKRIVER FRIE LINJER
N14  C                   MOVE      'L'           XXSKKO
N14  C     FRIST0        TAG
     C     FREETK        SETLL     FREETXT2
     C     FRIST         TAG
     C     FREETK        READE     FREETXT2                               91
     C  N91
     CAN 90              WRITE     HEAD0
     C  N91
     CAN 90              MOVE      '0'           *IN90
     C  N91              WRITE     DET2
     C  N91              GOTO      FRIST
N14   * skriv også kode G
N14  c                   if        XXSKKO='L'
N14  c                   eval      XXSKKO='G'
N14  c                   GOTO      FRIST0
N14  c                   endif
      * Barcode pr fraktbrev ??
n02  c     LOSBA         Ifeq      'J'                                          alle fbr (el av-opd)
n02  c     LOSBA         oreq      'O'                                          O=kun Avd-Oppdrnr.
n02  c     *IN80         andeq     *ON
N02  c                   exsr      BarCode
N02  c                   end
     C                   WRITE     DET3
      *
     C                   ADD       1             ANTOPD
     C                   ADD       HEVKT         TVEKT             9 0
     C                   ADD       HENT          TANTAL            7 0
     C                   ADD       BVEKT         TBVEKT            9 0
     C                   ENDSR
     C*
     C******************************************
     C     OMREGN        BEGSR
     C******************************************
     C*
     C* FORHØYER VEKTBEREGNING - UNDER 1000 KG TIL NÆRMESTE  10 KG
     C* ELLERS TIL NÆRM. 100 KG
     C*
     C*
     C     HEFBV         IFLT      1000                                         *VEKT UNDER 1000 KG
     C     HEFBV         ADD       9             BVEKT             9 0           -rund opp til nærm-
     C                   MOVE      '0'           BVEKT                            este 10.
     C                   ELSE                                                   *VEKT LIK/OVER 1000.
     C     HEFBV         ADD       99            BVEKT                            10 eller mer: rund
     C                   MOVE      '00'          BVEKT                            til nærmeste 100kg
     C                   END                                                     ..?) ER LIK 1
     C*                                                    *SÅ SANT PRIS IKKE
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETMSB        BEGSR
     C***********************************************
     C* GETS MSGMEMBERS
     C*
     C                   MOVE      'PRI0001'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR001           25
     C*
     C*
     C                   MOVE      'PRI0002'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR002           12
     C*
     C                   MOVE      'PRI0003'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR003            8
     C*
     C                   MOVE      'PRI0004'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR004            8
     C*
     C                   MOVE      'PRI0005'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR005           12
     C*
     C                   MOVE      'PRI0006'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR006            8
     C*
     C                   MOVE      'PRI0007'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR007           15
     C*
     C                   MOVE      'PRI0008'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR008           12
     C*
     C                   MOVE      'PRI0009'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     120           XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR009          120
     C*
     C                   MOVE      'PRI0010'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR010           11
     C*
     C                   MOVE      'PRI0011'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR011            8
     C*
     C                   MOVE      'PRI0012'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR012           24
     C*
     C                   MOVE      'PRI0013'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR013           14
     C*
     C                   MOVE      'PRI0014'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR014           17
     C*
     C                   MOVE      'PRI0015'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR015           15
     C*
     C                   MOVE      'YBC0491'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          YBC491           24
     C*
     C                   MOVE      'JOV0690'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV690            7
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETTXT        BEGSR
     C***********************************************
     C                   Z-ADD     3             XLEVEL            1 0
     C                   Z-ADD     0             XRETUR            1 0
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG            120
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HOSR          BEGSR
     C***********************************************
     C*
     C* HENTER HODEOPPLYSNINGER  FOR DOKUMENTET
     C*
     C     HOKEY         KLIST
     C                   KFLD                    HONET
     C                   KFLD                    HOAVD
     C                   MOVEL     ' '           HONET
     C                   MOVE      WAVDUU        HOAVD
     C     HOKEY         CHAIN     HODE                               33
     C  N33              MOVE      HOHT1         HO(1)
     C  N33              MOVE      HOHT2         HO(2)
     C  N33              MOVE      HOHT3         HO(3)
     C  N33              MOVE      HOHT4         HO(4)
     C  N33              MOVE      HOHT5         HO(5)
     C  N33              MOVE      HOHT6         HO(6)
     C  N33              MOVE      HOHT7         HO(7)
     C                   MOVE      'T'           HONET
     C     HOKEY         CHAIN     HODE                               33
     C  N33              MOVE      HOHT1         HT(1)
     C  N33              MOVE      HOHT2         HT(2)
     C  N33              MOVE      HOHT3         HT(3)
     C  N33              MOVE      HOHT4         HT(4)
     C  N33              MOVE      HOHT5         HT(5)
     C  N33              MOVE      HOHT6         HT(6)
     C  N33              MOVE      HOHT7         HT(7)
     C   33              MOVE      HO            HT
     C                   MOVEL     'E'           HONET
     C     HOKEY         CHAIN     HODE                               33
     C  N33              MOVE      HOHT1         HE(1)
     C  N33              MOVE      HOHT2         HE(2)
     C  N33              MOVE      HOHT3         HE(3)
     C  N33              MOVE      HOHT4         HE(4)
     C  N33              MOVE      HOHT5         HE(5)
     C  N33              MOVE      HOHT6         HE(6)
     C  N33              MOVE      HOHT7         HE(7)
     C   33              MOVE      HO            HE
     C***
     C                   IF        TUSG = 'WEB'
     C                   EVAL      SPRAAK = 'E'
     C                   END
     C     SPRAAK        COMP      'E'                                    70
     C     SPRAAK        COMP      'T'                                    79
     C     SPRAAK        IFEQ      'E'
     C                   MOVE      HE            HP
     C                   ELSE
     C     SPRAAK        IFEQ      'T'
     C                   MOVE      HT            HP
     C                   ELSE
     C                   MOVE      HO            HP
     C                   END
     C                   END
     C                   ENDSR
      *
N02  C******************************************
N02  C     Barcode       BEGSR
N02  C******************************************
N02   * Barcode pr fr.brev - enten far tr.modul innland(kun ett) eller dokuf/frisok
N02  C                   movea     '000'         *in(91)
n02  c     LOSBA         Ifeq      'J'
N02  c     HXSNDN        ifeq      *blanks
N02  c     DokKey        chain     DOKUF                              91
N12   * Første Fb staus 'O' ?? = Oppdragstotal??
N12  c  n91              if        DFST = 'O'
N12  c     DokKey        reade     DOKUF                                  91
N12  c                   endif
n08  c  n91df1004        ifne      *blanks
n13  c                   movel     df1004        df1004b          17
n13  C                   testn                   DF1004B              44
n13  c     *in44         ifeq      '1'
s08  c* n91              eval      HXSNDN = '401' + DF1004
s08  c* n91              move      *on           *in92
n08  c                   eval      HXSNDN = '401' + DF1004
n08  c                   move      *on           *in92
n13  c                   end
n08  c                   end
     c     HXSNDN        ifeq      *blanks
     c     IFBKey        chain     FRISOK                             91
n08  c  n91fssok         ifne      *blanks
n13  c                   movel     fssok         df1004b          17
n13  C                   testn                   DF1004B              44
n13  c     *in44         ifeq      '1'
s08  c* n91              eval      HXSNDN = '401' + FSSOK
s08  c* n91              move      *on           *in93
n08  c                   eval      HXSNDN = '401' + FSSOK
n08  c                   move      *on           *in93
n13  c                   end
n08  c                   end
N02  c                   end
N02  c                   end
n02  c                   else
N02  c                   eval      HXSNDN = *blanks
N02  c                   end
N02   *
N02  c     NextBar       tag
n02  C     HXsndn        ifne      *blanks
N02  c     BarLR         ifeq      'L'
N02  c                   write     BarLeft
N02  c                   else
N02  c                   write     BarRight
N02  c                   end
n02  c                   else
N02  c                   move      HEAVD         HEAVDA
N02  c                   move      *zeros        HEOPDA
N02  c                   move      HEOPD         HEOPDA
N02  c     BarLR         ifeq      'L'
n02  c                   write     BarLeftO
N02  c                   else
N02  c                   write     BarRightO
N02  c                   end
N02  c                   end
N02  c*
n02  c     BarLR         ifeq      'L'
N02  c                   move      'R'           BarLR
N02  c                   else
N02  c                   move      'L'           BarLR
N02  c                   end
n02   * spredning?
N02  c     *in91         ifeq      *off
N02  c     *in92         ifeq      *on
N02  c     DokKey        reade     DOKUF                                  91
N02  c  n91              eval      HXSNDN = '401' + DF1004
N02  c  n91              write     BarSpace
n02  c  n91              goto      NextBar
N02  c                   end
N02  c     *in93         ifeq      *on
N02  c     IFBKey        reade     FRISOK                                 91
N02  c  n91              eval      HXSNDN = '401' + FSSOK
n02  c  n91              write     BarSpace
N02  c  n91              goto      NextBar
N02  c                   end
N02  c                   end
N02   *
N02  C*
n02  C                   ENDSR
N02  C*
n03  C***********************************************
n03  C     ARKIVSR       BEGSR
n03  C***********************************************
n03  C***********************************************
n03  C                   TIME                    XULTID
n03  C                   MOVE      XULDD         ULDD
n03  C                   MOVE      XULMM         ULMM
n03  C                   MOVE      XULÅÅ         ULÅÅ
n03  C     FIFIRM        CHAIN     FIRMARC                            33
n03  C     *IN33         IFEQ      '0'
n03  C     'la'          chain     arktxt                             33
n03  C     *IN33         IFEQ      '0'
n03  C     arkjn         andeq     'J'
n03   *
n03  C                   MOVE      FIFIRM        ARFIRM
s10  C*                  MOVE      *zeros        ARAVD
n10  C                   MOVE      tuavd         ARAVD
n03  C                   MOVE      *zeros        AROPD
n03  C                   MOVEL     Wtur          ARUNDE
n03  C                   MOVE      'la'          ARTYPE
n03  C                   MOVE      ZUSER         ARUSER
n03  C                   MOVE      ULDT          ARDATE
n03  C                   MOVE      XULTM         ARTIME
n03  C                   MOVE      TUKNT         ARKUND
n03  C                   WRITE     ARKIVR
n03  C                   END
n03  C                   END
n03  C                   ENDSR
n05  C***********************************************
n05  C     TTSR          BEGSR
n05  C***********************************************
n05  c                   move      tuavd         ttavd
n05  c                   move      tupro         tttur
n05  c                   move      *zeros        ttopd
n05  C                   MOVE      'LOA'         TTACTI
n05  C                   MOVE      ULDT          TTDATE
n05  C                   MOVE      XULTM         TTTIME
n05  C                   MOVE      TTDATE        TTDATL
n05  C                   MOVE      TTTIME        TTTIML
n05  C                   MOVEL     ZUSER         TTUSER
n05  C     TUKNT2        IFNE      *ZEROS
n05  C                   MOVEL     TUKNT2        TUKNT
n05  C                   End
n05  C                   EVAL      TTTEXT = 'Loadinglist printed, Transp: '
n05  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n05  C                   EVAL      TTTEXL = 'Lasteliste skrevet Transp: '
n05  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n05  C     HEKNA         IFNE      *ZEROS
n05  C                   MOVEL     ' Agent: '    XXTEXT           16
n05  C                   MOVE      '        '    XXTEXT
n05  C                   MOVE      HEKNA         XXTEXT
n05  C                   MOVE      XXTEXT        TTTEXT
n05  C                   MOVE      XXTEXT        TTTEXL
n05  C                   END
n05  C                   WRITE     TRACKFR
n05  C     UTTT          TAG
n05  C                   ENDSR
