     FSNDDST    O  A E             DISK
     FTRAN      IF   E           K DISK
     FDOKUF     IF   E           K DISK
     Ffirm      IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FHEAD4rmt  IF   E           K DISK
     FHEAD5rmt  IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF5)
     FHEAD6rmt  IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF6)
     FHEAD7rmt  IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF7)
     FHEAD8rmt  IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF8)
     D*
     D TABELL          S              2  0 DIM(50) CTDATA PERRCD(1) ASCEND
     D TABTXT          S             78    DIM(50) ALT(TABELL)
     D*
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D*
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D*
     D                 DS
     D  HEavd                  1      4  0
     D  sl1                    5      5
     D  HEopd                  6     12  0
     D  sl2                   13     13
     D  hesg                  14     16
     d  intref                 1     16
     D*
     D                 DS
     D  dsdato                 1      6  0
     D  dsdag                  1      2  0
     D  dsmnd                  3      4  0
     D  dsaar                  5      6  0
     D*
     D                 DS
     D  fidato                 1      8  0
     D  ficcc                  1      2  0
     D  fiaar                  3      4  0
     D  fimnd                  5      6  0
     D  fidag                  7      8  0
     D                 DS
     D  DF1004                 1     35
     D  dfSNDN                 1     17
     D*
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     D*
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
      *
      *
     C                   MOVE      '1'           *INLR
      **************************************************************
     C     SRA           BEGSR
      **************************************************************
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    QTYPE             3
     C                   PARM                    QVALUE           15
     C                   PARM                    TCPJN             1
     C                   PARM                    uutype            2
     C                   PARM                    uukund            8
     C                   PARM                    uudato            6
     C     TRANKE        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    DFTRAN
     C     DOKUKE        KLIST
     C                   KFLD                    DOKKOD            1
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    DFFBNR
     C                   move      'F'           dokkod
     c                   z-add     1             DFFBNR
     c     keyfri        klist
     c                   kfld                    heavd
     c                   kfld                    heopd
     c                   kfld                    fskode
     c     keyhee        klist
     c                   kfld                    kundnr            8 0
     c     keyhea        klist
     c                   kfld                    kundnr            8 0
     c                   kfld                    hedato            8 0
     c                   move      uukund        kundnr
     c                   move      uudato        dsdato
     c                   move      20            ficcc
     c                   move      dsaar         fiaar
     c                   move      dsmnd         fimnd
     c                   move      dsdag         fidag
     c                   move      fidato        hedato
     c                   move      '/'           sl1
     c                   move      '/'           sl2
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   READ      FIRM                                   33
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRB                                                  SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     c***************************************************************
     c* skriver heading info
     c*
     c                   z-add     1             xx
     C     1             DO        26            XX                2 0
     c                   move      *blanks       rdata
     C     xx            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
     c     uutype        comp      'SF'                                   54
     c     uutype        comp      'KF'                                   55
     c     uutype        comp      'S '                                   56
     c     uutype        comp      'K '                                   57
     c     uutype        comp      'A '                                   58
     c   54keyhea        setll     head4rmt
     c   55keyhea        setll     head5rmt
     c   56keyhea        setll     head6rmt
     c   57keyhea        setll     head7rmt
     c   58keyhea        setll     head8rmt
     c     *in(30)       doweq     '0'
     c   54keyhee        reade     head4rmt                               30
     c   55keyhee        reade     head5rmt                               30
     c   56keyhee        reade     head6rmt                               30
     c   57keyhee        reade     head7rmt                               30
     c   58keyhee        reade     head8rmt                               30
     c     *in(30)       ifeq      '0'
     c                   z-add     27            xx
     C                   DO        9
     c                   move      *blanks       rdata
     C     xx            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   add       1             xx
     C                   END
     c*
     c                   exsr      srb2
     c                   move      *blanks       test
     c                   movel     hedtop        test             35
     c                   exsr      src
     c*
     c*
     c                   move      *blanks       test
     c                   movel     henas         test
     c                   exsr      src
     c*
     c*
     c                   move      *blanks       test
     c                   movel     henak         test
     c                   exsr      src
     c*
     c                   move      'ORD'         fskode
     c     keyfri        chain     frisok                             55
     c*
     c                   move      *blanks       test
     c  n55              movel     fssok         test
     c                   exsr      src
     c*
     c*
     c                   move      *blanks       test
     C                   Z-ADD     HEnt          ØN152
     C                   EXSR      SRNE
     c                   movel     Øan           test
     c                   exsr      srr
     c*
     c*
     c                   move      *blanks       test
     C                   Z-ADD     HEVKT         ØN152
     C                   EXSR      SRNE
     c                   movel     Øan           test
     c                   exsr      srr
     c*
     c*
     c                   move      *blanks       test
     C                   Z-ADD     HEm3          ØN152
     C                   EXSR      SRNE
     c                   movel     Øan           test
     c                   exsr      srr
     c*
     c*
     c                   move      *blanks       test
     c                   movel     hegn          test
     c                   exsr      src
      *
      *
     c                   move      *blanks       nygn             40
     C     DOKUKE        CHAIN     DOKUF                              55
     C  N55DFTRAN        IFNE      *ZEROS
     C     TRANKE        CHAIN     TRAN                               34
     C     *IN(34)       IFEQ      '0'
     C     VMINTP        ANDNE     *BLANKS
     C     NYGN          CAT       VMINTP:1      NYGN
     C     NYGN          CAT       DFSNDN:0      NYGN
     C                   ELSE
     C     NYGN          CAT       DFSNDN:1      NYGN
     C                   END
     C                   ELSE
     C     NYGN          CAT       DFSNDN:1      NYGN
     C                   END
     c                   movel     nygn          test
     c                   exsr      src
     c*
     c*
     C                   MOVE      *BLANKS       RDATA
     C     25            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       TAbtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
     c                   end
     c*
     c* skriver bunnlinje
     c*
     C                   MOVE      *BLANKS       RDATA
     C     43            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   endsr
     c*
     c***********************************************************
     c     srb2          begsr
     c***********************************************************
     C                   MOVE      *BLANKS       RDATA
     C     36            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C     37            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * variabel
     C                   MOVE      *BLANKS       RDATA
     c                   movel     '"*'          rdata
     c     rdata         cat       intref:0      rdata
     C     38            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       TAbtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     C                   MOVE      *BLANKS       RDATA
     C     39            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       TAbtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   endsr
     c*
     c***********************************************************
     c     src           begsr
     c***********************************************************
     c*
     c* med left-justering
     c*
     C                   MOVE      *BLANKS       RDATA
     C     40            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * variabel
     C                   MOVE      *BLANKS       RDATA
     c                   movel     test          rdata
     C     42            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       TAbtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   endsr
     c*
     c***********************************************************
     c     srr           begsr
     c***********************************************************
     c*
     c* med right-juystering
     c*
     C                   MOVE      *BLANKS       RDATA
     C     44            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * variabel
     C                   MOVE      *BLANKS       RDATA
     c                   movel     test          rdata
     C     42            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       TAbtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   endsr
      *////////////////////////////////////////////////////////////
      *  Leftjustify numerical fields                        SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * MOve correct value into Alfa 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      ',  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C                   END                                                    <-------------I
      * Scan from left and find first num over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
**
01<table border="1" cellspacing="1">
02<tr>
03<th valign="middle" align="center" bgcolor="#EEEEEE"><font
04 size="1" face="Arial" color="#000080">Details</font></th>
05<th valign="middle" align="center" bgcolor="#EEEEEE"><font
06face="Arial" size="1" color="#000080">Ref.NO</font></th>
07<th valign="middle" align="center" bgcolor="#EEEEEE"><font
08face="Arial" size="1" color="#000080">Date</font></th>
09<th valign="middle" align="center" bgcolor="#EEEEEE"><font
10face="Arial" size="1" color="#000080">Shipper</font></th>
11<th valign="middle" align="center" bgcolor="#EEEEEE"><font
12face="Arial" size="1" color="#000080">Consignee</font></th>
13<th valign="middle" align="center" bgcolor="#EEEEEE"><font
14size="1" face="Arial" color="#000080">Order</font></th>
15<th valign="middle" align="center" bgcolor="#EEEEEE"><font
16face="Arial" size="1" color="#000080">No/pcs</font></th>
17<th valign="middle" align="center" bgcolor="#EEEEEE"><font
18face="Arial" size="1" color="#000080">Weight</font></th>
19<th valign="middle" align="center" bgcolor="#EEEEEE"><font
20face="Arial" size="1" color="#000080">M3</font></th>
21<th valign="middle" align="center" bgcolor="#EEEEEE"><font
22face="Arial" size="1" color="#000080">Bill.NO</font></th>
23<th valign="middle" align="center" bgcolor="#EEEEEE"><font
24face="Arial" size="1" color="#000080">Inb.bil</font></th>
25</tr>
26<tr>
27<form METHOD="POST" ACTION=
28"http://www.tw.infofab.no/cgi-bin/sydb/w32db.cgi" target="_Top">
29<td valign="middle" align="center">
30<font face="Arial" size="2">
31<input TYPE="HIDDEN" NAME="DBID" VALUE="Systema">
32<input type=hidden name="QTYPE" value="ord">
33<input type=hidden NAME="as_frisoek." VALUE="ord">
34<input type="SUBMIT" value="Send" name="send" style="font-family:
35Arial; font-size: 8pt"></font></td>
36<td valign="middle" align="center"><font face="Arial" size="2">
37<input NAME="QVALUE" maxlength="15" size="15" value=
38" style="font-family:
39Arial; font-size: 8pt"></font></td></form>
40<td valign="middle" align="left"><font face="Arial" size="1">
41DATO/avsen/mottag/ordre/antall/vekt/kubikk/godsnr
42</font></td>
43</tr></table>
44<td valign="middle" align="right"><font face="Arial" size="1">
