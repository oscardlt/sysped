      ***********************************************************
      *** KONTOLL-RUTINER FOR SLETTING AV ET OPPDRAG          ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 Varselvindu
10XXX * 02 JOV PTF11 kall fra web
********************************************************************
     FFAK2      IF   E           K DISK
     F*YFA93FB  CF   E             WORKSTN
N02  FSYFA93FB  CF   E             WORKSTN USROPN
      *
     C     *ENTRY        PLIST
     C                   PARM                    WSAVD             4 0
     C                   PARM                    WSOPD             7 0
     C                   PARM                    SLETTE            1
N02  c                   if        SLETTE = 'W'
N02  c                   move      'J'           FraWeb            1
N02  c                   else
N02  C                   OPEN      SYFA93FB
N02  c                   endif
      *
     C                   MOVE      'J'           SLETTE
      *
     C     KEYFA2        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
      *
      * Fakt.linjer som tilsier ikke lov å overføre / varsel?
     C                   MOVE      *BLANKS       FINNES            1
     C                   MOVE      *ZEROS        KOSTNA           13 2
     C                   MOVE      *ZEROS        FAKTUR           13 2
     C     KEYFA2        SETLL     FAK2
     C     KEYFA2        READE     FAK2                                   33
     C     *IN33         DOWEQ     '0'
      * Noe finnes overført. Går det sum i 0???
     C     FAOPKO        IFGE      'O'
     C                   MOVE      'X'           FINNES
     C     FAKDA         IFEQ      'K'
     C                   ADD       FABELN        KOSTNA
     C                   ELSE
     C                   ADD       FABELN        FAKTUR
     C                   END
     C                   ELSE
      * Fakturert men ennå ikke overført, IKKE tillatt.
     C     FAOPKO        IFEQ      'F'
     C     FAOPKO        OREQ      'G'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV0576'     MSGNR
     C                   MOVE      'N'           SLETTE
N02  c                   if        FraWeb <> 'J'
N01  C                   EXFMT     WINDOW
N02  c                   endif
     C                   GOTO      SLUTT
     C                   END
     C                   END
     C     KEYFA2        READE     FAK2                                   33
     C                   END
      *
     C* OVERFØRT FAKTURABELØP ULIK 0, IKKE TILLATT
     C     FAKTUR        IFNE      *ZEROS
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV0574'     MSGNR
     C                   MOVE      'N'           SLETTE
N02  c                   if        FraWeb <> 'J'
N01  C                   EXFMT     WINDOW
N02  c                   endif
     C                   GOTO      SLUTT
     C                   END
     C* OVERFØRT FAKTURABELØP ULIK 0, IKKE TILLATT
     C     KOSTNA        IFNE      *ZEROS
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV0575'     MSGNR
     C                   MOVE      'N'           SLETTE
N02  c                   if        FraWeb <> 'J'
N01  C                   EXFMT     WINDOW
N02  c                   endif
     C                   GOTO      SLUTT
     C                   END
      *
     C* HVIS DET FINNES LINJER TIL REGNSKAP - VARSEL. MÅ KVITTERE F23
     c     START9        TAG
     C     FINNES        IFNE      ' '
N02  c                   if        FraWeb = 'J'
N02  C                   MOVE      'N'           SLETTE
N02  C                   GOTO      SLUTT
N02  c                   endif
     C     *IN23         IFEQ      '0'
     C     *IN12         ANDEQ     '0'
     C                   MOVE      'DIV0000'     MSGNR
N01  C                   EXFMT     WINDOW
     C                   GOTO      START9
     C                   END
     C     *IN23         IFEQ      '1'
     C                   MOVE      'J'           SLETTE
     C                   END
     C     *IN12         IFEQ      '1'
     C                   MOVE      'N'           SLETTE
     C                   END
     C                   END
      *
     C*
     C     SLUTT         TAG
N02  c                   if        FraWeb <> 'J'
N02  C                   CLOSE     SYFA93FB
N02  c                   endif
     C                   MOVE      *ON           *INLR
     C                   RETURN
