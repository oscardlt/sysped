********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      ************************************************************
      *** FLYTTE RATER TIL JUSTERINGSSSYSTEM                   ***
      ************************************************************
      *
     FKODTA     IF   E           K DISK
     FKUIPRL01  IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FFRATN     UF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYSA51FM  CF   E             WORKSTN INFDS(FBAREA)
     D WP              S              1    DIM(12)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  ZNUMB                  1     11  2
     D  ZNUMBB                 9     11  2
     D                 DS
     D  FRVK1                  1      5  0
     D  FRVK2                  6     10  0
     D  FRVK3                 11     15  0
     D  FRVK4                 16     20  0
     D  FRVK5                 21     25  0
     D  FRVK6                 26     30  0
     D  FRVK7                 31     35  0
     D  FRVK8                 36     40  0
     D  FRVK9                 41     45  0
     D  FRVK10                46     50  0
     D  FRVK11                51     55  0
     D  FRVK12                56     60  0
     D  FVK                    1     60  0
     D                                     DIM(12)
     D  FVKX                   1     60
     D                 DS
     D  FB01                   1      3P 0
     D  FB02                   4      6P 0
     D  FB03                   7      9P 0
     D  FB04                  10     12P 0
     D  FB05                  13     15P 0
     D  FB06                  16     18P 0
     D  FB07                  19     21P 0
     D  FB08                  22     24P 0
     D  FB09                  25     27P 0
     D  FB10                  28     30P 0
     D  FB11                  31     33P 0
     D  FB12                  34     36P 0
     D  FB                     1     36P 0
     D                                     DIM(12)
     D  FBX                    1     36
     D                 DS
     D  FM01                   1      3P 0
     D  FM02                   4      6P 0
     D  FM03                   7      9P 0
     D  FM04                  10     12P 0
     D  FM05                  13     15P 0
     D  FM06                  16     18P 0
     D  FM07                  19     21P 0
     D  FM08                  22     24P 0
     D  FM09                  25     27P 0
     D  FM10                  28     30P 0
     D  FM11                  31     33P 0
     D  FM12                  34     36P 0
     D  FM                     1     36P 0
     D                                     DIM(12)
     D  FMX                    1     36
     D                 DS
     D  V01                    1      1
     D  V02                    2      2
     D  V03                    3      3
     D  V04                    4      4
     D  V05                    5      5
     D  V06                    6      6
     D  V07                    7      7
     D  V08                    8      8
     D  V09                    9      9
     D  V10                   10     10
     D  V11                   11     11
     D  V12                   12     12
     D  V13                   13     13
     D  V14                   14     14
     D  V15                   15     15
     D  V16                   16     16
     D  V                      1     16
     D                                     DIM(16)
     D                 DS
     D  NYDATO                 1      6  0
     D  NYDAG                  1      2  0
     D  NYMND                  3      4  0
     D  NYÅR                   5      6  0
     D                 DS
     D  FTDT                   1      8  0
     D  FTÅR                   1      4  0
     D  FTMND                  5      6  0
     D  FTDAG                  7      8  0
     D                 DS
     D  WAGEDA                 1      6  0
     D  WAGED                  1      2  0
     D  WAGEM                  3      4  0
     D  WAGEÅ                  5      6  0
     D                 DS
     D  WAGED2                 1      8  0
     D  WAGE2Å                 1      4  0
     D  WAGE2M                 5      6  0
     D  WAGE2D                 7      8  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C*
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKSR
     C                   GOTO      START
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
     C*
     C   05              EXSR      JUSTER
     C*
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     TESTB         BEGSR
     C******************************************
     C*
     C*  Only customer no...
     C     WAFRKU        IFNE      99999999
     C     WAFRKU        ANDNE     0
     C     KUND1K        CHAIN     CUNDL01                            92
     C   92              MOVE      'SPK0001'     MSGNR
     C   92              SETON                                        30
     C   92              GOTO      SLTB
     C                   END
     C* From destination
     C     WAFRFR        IFNE      '*ALL '
     C     WAFRFR        CHAIN     STED2                              94
     C   94              MOVE      'SPS0012'     MSGNR
     C   94              SETON                                        30
     C   94              GOTO      SLTB
     C                   END
     C*
     C* To - destination
     C     WAFRTI        IFNE      '*ALL '
     C     WAFRTI        CHAIN     STED2                              93
     C   93              MOVE      'SPS0013'     MSGNR
     C   93              SETON                                        30
     C   93              GOTO      SLTB
     C                   END
     C*
     C* Expire date
     C     WAGEDA        IFNE      0
     C                   MOVE      WAGEÅ         UÅÅ               2 0
     C                   MOVE      WAGEM         UMM               2 0
     C                   MOVE      WAGED         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C   89              MOVE      'SPD0001'     MSGNR
     C   89              SETON                                        30
     C   89              GOTO      SLTB
     C                   END
     C*
     C     SLTB          ENDSR
      *
     C***********************************************
     C     SØKSR         BEGSR
     C***********************************************
     C     LINNBR        IFEQ      8
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WAFRKU
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WAFRKU
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01   *
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      8
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WAFRKU
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     9             LINNBR
N01  C                   Z-ADD     35            POSNBR
N01  C                   END
     C                   END
     C*
     C* FRASTED
     C* IKKE VED POSTNUMMERLOGIKK
     C*
     C  N53LINNBR        IFEQ      9
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     39
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WAFRFR
     C                   PARM                    UNVN             30
     C                   PARM                    WAFRFL
     C                   END
     C*
     C* IKKE VED POSTNUMMERLOGIKK
     C*
     C  N53LINNBR        IFEQ      10
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     39
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WAFRTI
     C                   PARM                    UNVN             30
     C                   PARM                    WAFRTL
     C                   END
     C*     FRA
     C   53LINNBR        IFEQ      9
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     39
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WAFRFR
     C                   PARM                    UNVN             30
     C                   PARM                    WAFRFL
     C                   END
     C*     TIL
     C   53LINNBR        IFEQ      10
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     39
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WAFRTI
     C                   PARM                    UNVN             30
     C                   PARM                    WAFRTL
     C                   END
      *
      * OPPDRAGSTYPE
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     36
     C                   CALL      'SYFI10C'
     C                   PARM                    WAFROT
     C                   END
      *
      * FRANKATUR
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     37
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    WAFRLE
     C                   PARM                    USPED
     C                   END
     C*
     C*
     C                   ENDSR
     C*
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C*
     C* D= TIL DRIFTSBASE
     C*
     C* Key for customer file
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WAFRKU
     C* Key for UTELATTE KUNDER
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    FTKNR
     C*
     C                   READ      FIRM                                   33
     C*
     C*
     C                   MOVE      'DIV0000'     MSGNR
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C                   MOVE      *ZEROS        WAGEDA
     C                   MOVE      *ZEROS        WAGED2
     C                   MOVE      *ZEROS        NYDATO
     C                   MOVE      *ZEROS        FTDT
     C                   MOVE      *ZEROS        FVK
     C     1             DO        16            NX                2 0
     C                   MOVE      'X'           V(NX)
     C                   END
     C*
     C                   MOVEL     '*ALL'        WAFRFR
     C                   MOVEL     '*A'          WAFRFL
     C                   MOVEL     '*ALL'        WAFRTI
     C                   MOVEL     '*A'          WAFRTL
     C                   MOVEL     '*A'          WAFROT
     C                   MOVEL     '*AL'         WAFRLE
S01  C*                  EXSR      HMSG
     C                   MOVE      'A'           XAUNI             1
     C*
     C                   READ      KODTA                                  33
     C     KOAPOS        COMP      'J'                                    53
     C                   ENDSR
S01  C***********************************************
S01  C*    HMSG          BEGSR
S01  C***********************************************
S01  C*                  MOVE      'DIV2094'     XMSGNR            7            MELDING-ID
S01  C*                  EXSR      HMSG2
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV2095'     XMSGNR
S01  C*                  EXSR      HMSG2
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*
S01  C*                  ENDSR
S01  C*
S01  C***********************************************
S01  C*    HMSG2         BEGSR
S01  C***********************************************
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIVÅ
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     132           XMSGL             4 0          LENGDE PÅ MELDING
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    XMSG            132
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C*
     C* Format expiredate for agreed prices
     C     WAGEDA        IFNE      *ZEROS
     C                   MOVE      WAGED         UDT1              2 0
     C                   MOVE      WAGEM         UDT2              2 0
     C                   MOVE      WAGEÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WAGED
     C                   MOVE      UDT2          WAGEM
     C                   MOVE      UDT3          WAGEÅ
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     JUSTER        BEGSR
     C***********************************************
     C     FRATKE        KLIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C*
     C     WAGEDA        IFEQ      0
     C                   MOVE      *ZEROS        WAGED2
     C                   ELSE
     C                   MOVE      WAGED         WAGE2D
     C                   MOVE      WAGEM         WAGE2M
     C     WAGEÅ         IFGT      50
     C     WAGEÅ         ADD       1900          WAGE2Å
     C                   ELSE
     C     WAGEÅ         ADD       2000          WAGE2Å
     C                   END
     C                   END
     C                   Z-ADD     1             KUNDE1            8 0
     C*
     C     WAFRKU        IFNE      99999999
     C     WAFRKU        SETLL     FRATN
     C                   ELSE
     C     KUNDE1        SETLL     FRATN
     C                   END
     C                   SETOFF                                       33
     C     *IN33         DOWEQ     '0'
     C     WAFRKU        IFNE      99999999
     C     WAFRKU        READE     FRATN                                  33
     C                   ELSE
     C                   READ      FRATN                                  33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   EXSR      TESTAV
     C  N34              DO
     C                   EXSR      CHGPRI
     C                   END
     C                   END
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     CHGPRI        BEGSR
     C***********************************************
     C*
     C                   MOVEA     '0000'        *IN(27)
     C                   Z-ADD     1             ZMULT
     C                   MOVE      WAFRPR        ZDESIM            4 4
     C* rent prosenttrekk
     C     WAFRPM        IFEQ      '-'
     C                   SUB       ZDESIM        ZMULT             7 6
     C                   ELSE
     C* opphev tidligere økning på xx %
     C     WAFRPM        IFEQ      'M'
     C                   ADD       ZDESIM        ZMULT
     C     1             DIV(H)    ZMULT         ZMULT
     C                   ELSE
     C* rent prosent tillegg
     C                   ADD       ZDESIM        ZMULT
     C                   END
     C                   END
     C* Is rounding procedure to be called (code 2 and 3) -> 29 On
     C                   MOVE      WAFRAV        ZKODE             1 0
     C     ZKODE         COMP      2                                  29  29
     C* The prices in the record read is to be raised
     C     V(13)         IFEQ      'X'
     C  N29FTMIN         MULT(H)   ZMULT         FTMIN
     C   29FTMIN         MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMIN
     C                   END
     C*
     C     V(14)         IFEQ      'X'
     C  N29FTMAX1        MULT(H)   ZMULT         FTMAX1
     C   29FTMAX1        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX1
     C                   END
     C*
     C     V(15)         IFEQ      'X'
     C  N29FTMAX2        MULT(H)   ZMULT         FTMAX2
     C   29FTMAX2        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX2
     C                   END
     C*
     C     V(16)         IFEQ      'X'
     C  N29FTMAX3        MULT(H)   ZMULT         FTMAX3
     C   29FTMAX3        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX3
     C                   END
     C*
     C                   Z-ADD     1             NR                2 0
     C     NR            DOWLE     12
     C     V(NR)         IFEQ      'X'
     C  N29FB(NR)        MULT(H)   ZMULT         FB(NR)
     C   29FB(NR)        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FB(NR)
     C                   END
     C                   ADD       1             NR
     C                   END
     C* MINMAX KODE ...
     C     FTMM          IFNE      0
     C                   EXSR      SRFM
     C                   END
     C*
     C                   ADD       1             ANTFLY
     C*
     C     NYDATO        IFNE      *ZEROS
     C     NYÅR          IFGT      50
     C     NYÅR          ADD       1900          FTÅR
     C                   ELSE
     C     NYÅR          ADD       2000          FTÅR
     C                   END
     C                   MOVE      NYMND         FTMND
     C                   MOVE      NYDAG         FTDAG
     C                   END
     C                   UPDATE    FRATR
     C* FLERE...?
     C*
     C                   ENDSR
     C***********************************************
     C     TESTAV        BEGSR
     C***********************************************
     C                   SETOFF                                       34
     C*
     C     WAFRFR        IFNE      '*ALL '
     C     WAFRFR        ANDNE     FTFRA
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C*
     C*
     C     WAFRFL        IFNE      '*A'
     C     FTFRA         CHAIN     STED2                              37
     C     WAFRFL        IFNE      ST2LK
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C                   END
     C*
     C     WAFRTI        IFNE      '*ALL '
     C     WAFRTI        ANDNE     FTTIL
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C*
     C*
     C     WAFRTL        IFNE      '*A'
     C     FTTIL         CHAIN     STED2                              37
     C     WAFRTL        IFNE      ST2LK
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C                   END
     C*
     C*
     C     WAFROT        IFNE      '*A'
     C     WAFROT        ANDNE     FTOPDT
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C*
     C*
     C     WAFRLE        IFNE      '*AL'
     C     WAFRLE        ANDNE     FTFRAN
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C*
     C     WAGEDA        IFNE      *ZEROS
     C     FTDT          ANDGT     WAGED2
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C* UTELATTE KUNDER
     C     FTKNR         IFNE      0
     C     KUNKEY        CHAIN     KUIPRL01                           88
     C  N88              SETON                                        34
     C                   GOTO      UTT
     C* Prosent av brutto .. ikke endring.
     C     FTKODE        IFEQ      'P'
     C                   SETON                                        34
     C                   GOTO      UTT
     C                   END
     C                   END
     C     UTT           ENDSR
     C*
     C***********************************************
     C     ROUND         BEGSR
     C***********************************************
     C* Param. = ZKODE (1,2,3,4)  = Roundingcode
     C*          ZNUMB workfield 11 long 2 digits
     C*         (ZNUMBB) is the 3 last pos. of ZNUMB (via Data Struct.)
     C*
     C* Code 2 = To nearest  5
     C     ZKODE         IFEQ      2                                            B1
     C     ZNUMBB        IFLT      2.50                                           B2
     C                   MOVE      '000'         ZNUMB
     C                   ELSE
     C     ZNUMBB        IFGE      2.50                                             B3
     C     ZNUMBB        ANDLE     7.49
     C                   MOVE      '500'         ZNUMB
     C                   ELSE
     C                   ADD       10            ZNUMB
     C                   MOVE      '000'         ZNUMB
     C                   END                                                        E3
     C                   END                                                      E2
     C* Code 3 = To nearest 10
     C                   ELSE
     C     ZNUMBB        IFGE      5.00                                           B2
     C                   ADD       10            ZNUMB
     C                   END                                                      E2
     C                   MOVE      '000'         ZNUMB
     C                   END                                                    E1
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     SRFM          BEGSR
     C***********************************************
      *
     C                   Z-ADD     0             NR                2 0
     C                   MOVE      *BLANKS       WP
     C     NR            DOWLT     FTFAST                                        1<-B
     C                   ADD       1             NR
     C                   MOVE      'F'           WP(NR)
     C                   END                                                     1<-E
     C     FTPRPR        IFEQ      0                                            1<-B
     C                   Z-ADD     100           FTPRPR
     C                   END                                                    1<-E
     C                   Z-ADD     0             YPRIS             5 0
     C                   Z-ADD     1             NR
      *
     C     FTMM          IFEQ      1                                            1<-B
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FB(NR)        YPRIS
     C                   END                                                     2
     C     FTMIN         IFGT      YPRIS                                         2<-B
     C                   Z-ADD     FTMIN         YPRIS
     C                   END                                                     2
      *
     C     STMM1         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C     FB(NR)        IFGT      YPRIS                                         2<-B
     C                   Z-ADD     FB(NR)        FM(NR)
     C                   Z-ADD     FB(NR)        YPRIS
     C                   ELSE                                                    2
     C                   Z-ADD     YPRIS         FM(NR)
     C                   END                                                     2
     C                   ELSE                                                    2
     C                   Z-ADD     YPRIS         FM(NR)
     C                   MOVE      99999         FVK(12)
     C     FVK(NR)       MULT      FB(NR)        WORK              8 0
     C     FTKOLL        IFEQ      'L'
     C     FTKOLL        OREQ      'M'
     C     WORK          DIV(H)    100           YPRIS
     C                   ELSE
     C     WORK          DIV       FTPRPR        YPRIS
     C                   END
     C     YPRIS         IFLT      FM(NR)                                         3<-B
     C                   Z-ADD     FM(NR)        YPRIS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      * AVTALESPESIFIK VEKTINNDELING ???
     C     FVK(NR)       IFNE      99999                                          3<-B
     C                   ADD       1             NR
     C     NR            IFLE      12                                              4<-B
     C                   GOTO      STMM1
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C                   END                                                    1<-E
      *
     C     FTMM          IFEQ      2                                            1<-B
      *
     C                   Z-ADD     2             N2                2 0
     C     STMM2         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FB(NR)        FM(NR)
     C                   ELSE                                                    2
      * AVTALESPESIFIK VEKTINNDELING ???
     C     FVK(NR)       MULT      FB(N2)        WORK              8 0
     C     FTKOLL        IFEQ      'L'
     C     FTKOLL        OREQ      'M'
     C     WORK          DIV(H)    100           FM(NR)
     C                   ELSE
     C     WORK          DIV       FTPRPR        FM(NR)
     C     FM(NR)        IFEQ      *ZEROS
     C                   Z-ADD     FTMAX3        FM(NR)
     C                   END
     C                   END
     C                   END                                                     2<-E
     C     FVK(N2)       IFNE      99999
     C     N2            ANDNE     12
     C                   ADD       1             NR
     C                   ADD       1             N2
     C                   GOTO      STMM2
     C                   END
      *
     C                   END                                                    1<-E
      *
     C     FTKOLL        IFEQ      'X'
     C                   MOVE      *ZEROS        FTPRPR
     C                   END
      *
     C                   ENDSR
      *
      *
