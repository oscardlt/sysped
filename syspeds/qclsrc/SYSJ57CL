/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 YBC PTF10 POSISJONER ETTER OPPDRAGSNR UTVIDELSE              */
/* ********************************************************************    */
             PGM        PARM(&PARM &CVP1 &CVP2 &PRT29 &PT29 &FTXT)
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(256)
             DCL        VAR(&PARM2) TYPE(*CHAR) LEN(577)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(160)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(160)
             DCL        VAR(&PRT29) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PT29) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FTXT) TYPE(*CHAR) LEN(900)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAXSYS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&JOBK) TYPE(*CHAR) LEN(1)
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&FYLL) TYPE(*CHAR) LEN(1) VALUE('.') /* +
                          Sette '.' for å få riktig coverpage pga. +
                          faximile */
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCLF       FILE(FAXSEN)
             RCVF       RCDFMT(*FILE)
    /* */
             CHGVAR     VAR(&FAX) VALUE(%SST(&PARM 14 1))
             IF         COND(&FAX *EQ 'J') THEN(DO)
             CHGVAR     VAR(&PARM2) VALUE(&PARM *CAT &CVP1 *CAT +
                          &CVP2 *CAT &FYLL)
/*                      */
/*  E-MAIL              */
/*                      */
/*S01        CHGVAR     VAR(&EPOSTJ) VALUE(%SST(&PARM 64 1)) */
/*N01*/      CHGVAR     VAR(&EPOSTJ) VALUE(%SST(&PARM 66 1))
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ57CLJE) PARM(&PARM2)) +
                          JOB(SNDFAXFAKT) JOBD(*USRPRF) +
                          JOBQ(SYJOBQNMAX)
             GOTO       CMDLBL(SLUTT)
             ENDDO
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*                         */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ57CLJF) PARM(&PARM2)) +
                          JOB(FAXBOOK) JOBD(*USRPRF) +
                          JOBQ(QFAX/QFAXJOBQ)
             GOTO       CMDLBL(SLUTT)
             ENDDO
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ57CLJN) PARM(&PARM2 &FTXT)) +
                          JOB(FAXBOOK) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             GOTO       CMDLBL(SLUTT)
             ENDDO
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ57CLJB) PARM(&PARM2)) +
                          JOB(FAXBOOK) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             GOTO       CMDLBL(SLUTT)
             ENDDO
             ENDDO
    /* */
/*S01        CHGVAR     VAR(&JOBK) VALUE(%SST(&PARM 11 1))       */
/*N01*/      CHGVAR     VAR(&JOBK) VALUE(%SST(&PARM 13 1))
             IF         COND(&JOBK = 'J') THEN(SBMJOB CMD(CALL +
                          PGM(SYSJ57CLJ) PARM(&PARM &PRT29 &PT29)) +
                          JOB(BOOKING) JOBD(*USRPRF) JOBQ(SYJOBQAV))
             ELSE       CMD(CALL PGM(SYSJ57CLJ) PARM(&PARM &PRT29 +
                          &PT29))
    /* */
SLUTT:       ENDPGM
