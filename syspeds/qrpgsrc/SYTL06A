      ***********************************************************
      *** bestill merknadsjournal                             ***
      ***                                                     ***
     FGODSAF    IF   E           K DISK
     FGODSFI    IF   E           K DISK
     FSYTL06FA  CF   E             WORKSTN
      ***********************************************************
     D                 DS
     D  UGN                    1     15
     D  UGN01                  1      4
     D  UGN02                  5      9
     D  UGN03                 10     12
     D  UGN04                 13     15
     D                 DS
     D  UUAVDA                 1      4
     D  UUAVD1                 1      1
     D  UUAVD2                 2      2
     D  UUAVD3                 3      3
     D  UUAVD4                 4      4
     D                 DS
     D  DSTID                  1     14  0
     D  DSDAG                  7      8  0
     D  DSMND                  9     10  0
     D  DSAAR                 13     14  0
     D  DSCCAA                11     14  0
     D                 DS
     D  UDMA                   1      6  0
     D  UDAG                   1      2  0
     D  UMND                   3      4  0
     D  UAAR                   5      6  0
     D                UDS
     D  UUAVD                 15     18
      *______________________
      * Initiering
      *""""""""""""""""""""""
     C                   EXSR      INIT
      *___________________________
      *
     c     START         tag
     C                   EXFMT     BILDE01
     C   03              GOTO      ENDPGM
      *
     C     *IN(10)       IFNE      '1'
     C     WSDANY        IFNE      *ZEROS
     C                   EXSR      BYTTDA
     C                   END
     C                   GOTO      START
     C                   END
     C                   EXSR      PRINT
      *
     C     ENDPGM        TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C                   WRITE     WINDOWSZ
      *
     C                   MOVE      'D'           WSKODE
     c                   move      *zeros        wslbko
     C                   TIME                    DSTID
     C                   MOVE      DSAAR         UAAR
     C                   MOVE      DSMND         UMND
     C                   MOVE      DSDAG         UDAG
     c                   move      dsccaa        wsaar
      * FØRSTE GANG TILORDNER UDATE
     C     UDATO         IFEQ      *BLANKS
     C                   MOVE      UDMA          UDATO
     C                   MOVE      UDMA          WSDANY
     C                   END
      *
     C                   MOVE      'N'           FLELBK
     C     *LOVAL        SETLL     GODSFI
     C                   READ      GODSFI                                 33
     C                   READ      GODSFI                                 33
     C   33              MOVE      GFLBKO        UULBKO
     C   33              MOVE      GFENH         UUENH
     C   33              EXSR      BYTTDA
      *
      * KALLER INITIERING VED FLER ENN 1 LAGERKODE
      *
     C     *IN33         IFEQ      '0'
      *
      * SKJEKKER OM AVDELING HAR LÅS BEVILNINGSKODE
      *
     C                   EXSR      TESTAV
     C     AVDLAS        IFEQ      'J'
     C                   MOVE      GFLBKO        UULBKO
     C                   MOVE      GFENH         UUENH
     C                   EXSR      BYTTDA
     C                   ELSE
     C                   MOVE      'J'           FLELBK            1
     C                   MOVE      *BLANKS       UULBKO            5
     C                   MOVE      *BLANKS       UUENH             1
     C                   MOVE      'N'           UUPDAT            1
      *
      * HENTER BEVILNINGSKODE OG DAGNR
      *
     C                   CALL      'SYTL03B'
     C                   PARM                    UULBKO
     C                   PARM                    UUENH
     C                   PARM                    UDATO             6
     C                   PARM                    UDAGNR            3
     C                   PARM                    UUPDAT            1
      * retur uten valg
     C     UULBKO        ifeq      *blanks
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   END
     C                   END
      *
      *
      *
      *
      *
     C     BEVKEY        KLIST
     C                   KFLD                    UULBKO
     C                   KFLD                    UUENH
      *
      *
     C     AVDKEY        KLIST
     C                   KFLD                    AVDTES
      *
     c     uuenh         ifne      ' '
     c                   movel     gfenh         wslope
     c                   end
     c     udagnr        ifne      *blanks
     C                   MOVE      UDAGNR        WSDAGN
     c                   else
     c                   move      *zeros        wsdagn
     c                   end
     c     uulbko        ifne      *blanks
     C                   MOVE      Uulbko        WSlbko
     c                   else
     c                   move      *zeros        wslbko
     c                   end
     C                   ENDSR
      *
     C***********************************************
     C     TESTAV        BEGSR
     C***********************************************
      *
      * SKJEKKER OM LÅST AVDELING TIL BEVILNINGSKODE
      *
     C                   MOVE      'N'           AVDLAS            1
     C                   MOVE      UUAVD         UUAVDA
     C                   MOVE      UUAVDA        AVDTES            4
     C     AVDKEY        CHAIN     GODSAF                             33
      * XER FRA POS 1 -> 2
     C   33              MOVE      'X'           UUAVD1
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33AVDKEY        CHAIN     GODSAF                             33
     C   33              MOVE      'X'           UUAVD2
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33AVDKEY        CHAIN     GODSAF                             33
     C   33              MOVE      'X'           UUAVD3
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33AVDKEY        CHAIN     GODSAF                             33
      * XER FRA POS 3 -> 4
     C   33              MOVE      UUAVD         UUAVDA
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33              MOVE      'X'           UUAVD4
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33AVDKEY        CHAIN     GODSAF                             33
     C   33              MOVE      'X'           UUAVD3
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33AVDKEY        CHAIN     GODSAF                             33
     C   33              MOVE      'X'           UUAVD2
     C   33              MOVE      UUAVDA        AVDTES            4
     C   33AVDKEY        CHAIN     GODSAF                             33
     C  N33              MOVE      'J'           AVDLAS
     C                   ENDSR
      *
     C***********************************************
     C     BYTTDA        BEGSR
     C***********************************************
      *
      *
      * LOGIKK VED DATOBYTTE
      *
     C                   MOVE      WSDANY        UDATO             6
     C                   CALL      'SYGE25CL'
     C                   PARM                    UDATO
     C                   PARM                    UDAGNR            3
     C                   MOVE      UDATO         WSDATO            6 0
     C                   MOVE      UDAGNR        WSDAGN
     C                   ENDSR
      *
      *
      ***********************************************
     C     PRINT         BEGSR
      ***********************************************
     C                   MOVE      WSAAR         UGN01
     C                   MOVE      WSLBKO        UGN02
     C                   MOVE      WSDAGN        UGN03
     C                   MOVE      WSLOPE        UGN04
     C                   CALL      'SYTL06CL'
     C                   PARM                    UGN
     C                   PARM                    WSKODE
     c                   endsr
