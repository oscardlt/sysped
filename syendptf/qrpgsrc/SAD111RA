     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FHEAD14    IF   E           K DISK
     FSADH      IF   E           K DISK
     FSADKMCL1  IF A E           K DISK
     D                 DS
     D  MCTRF                  1     70
     D  MCTRF_35               1     35
     D                SDS
     D  UUSR                 254    263
      *
     C                   EXSR      INIT
      *
     C     UPRO          SETLL     HEAD14
     C     UPRO          READE     HEAD14                                 33
      *
     C                   DOW       *IN33 = *OFF
     C     SADKMCL1K     CHAIN     SADKMCL1                           33
     C                   IF        *IN33
     C                   EXSR      SROPD
     C                   END
     C     UPRO          READE     HEAD14                                 33
     C                   ENDDO
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     SROPD         BEGSR
      ***********************************************
      *
     C     SADHK         CHAIN     SADH                               33
      *
     C                   IF        *IN33
     C                   CLEAR                   SADKMCFR
      * Consignment
     C                   EVAL      MCPRO  = HEPRO
     C                   EVAL      MCUUID = UUUID
     C                   EVAL      MCAVD  = HEAVD
     C                   EVAL      MCTDN  = HEOPD
      * KJØPER
     C                   EVAL      MCKNK  = SIKNK
     C                   IF        SIKNK = 0
     C                   EVAL      MCNAK  = SINAK
     C                   EVAL      MCRGK  = SIRG
     C                   EVAL      MCADK1 = SIADK1
     C                   EVAL      MCADK2 = SIADK2
     C                   EVAL      MCPNK  = SIADK3
     C                   EVAL      MCLKK  = 'NO'
     C                   ELSE
     C     CUNDL01KK     CHAIN     CUNDL01                            33
     C                   EVAL      MCNAK  = KNAVN
     C                   EVAL      MCRGK  = SYRG
     C                   EVAL      MCADK1 = ADR1
     C                   EVAL      MCADK2 = ADR2
     C                   IF        POSTNR = 0
     C                   EVAL      MCPNK  = SYPOGE
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      MCLKK  = 'NO'
     C                   ELSE
     C                   EVAL      MCLKK  = SYLAND
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        MCPNK
     C                   EVAL      MCLKK  = 'NO'
     C                   END
     C                   EVAL      MCCPK  = KPERS
     C                   SELECT
     C                   WHEN      SYEPOS <> *BLANKS
     C                   EVAL      MCCMK  = SYEPOS
     C                   EVAL      MCCMKT = 'EM'
     C                   WHEN      TLF <> *BLANKS
     C                   EVAL      MCCMK  = TLF
     C                   EVAL      MCCMKT = 'TE'
     C                   ENDSL
     C                   END
      * SELGER
     C                   EVAL      MCKNS  = SIKNS
     C                   IF        SIKNS = 0
     C                   EVAL      MCNAS  = SINAS
     C                   EVAL      MCADS1 = SIADS1
     C                   EVAL      MCADS2 = SIADS2
     C                   EVAL      MCPNS  = SIADS3
     C                   EVAL      MCLKS  = HELKA
     C                   ELSE
     C     CUNDL01KS     CHAIN     CUNDL01                            33
     C                   EVAL      MCNAS  = KNAVN
     C                   EVAL      MCRGS  = SYRG
     C                   EVAL      MCADS1 = ADR1
     C                   EVAL      MCADS2 = ADR2
     C                   IF        POSTNR = 0
     C                   EVAL      MCPNS  = SYPOGE
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      MCLKS  = 'NO'
     C                   ELSE
     C                   EVAL      MCLKS  = SYLAND
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        MCPNS
     C                   EVAL      MCLKS  = 'NO'
     C                   END
     C                   EVAL      MCCPS  = KPERS
     C                   SELECT
     C                   WHEN      SYEPOS <> *BLANKS
     C                   EVAL      MCCMS  = SYEPOS
     C                   EVAL      MCCMST = 'EM'
     C                   WHEN      TLF <> *BLANKS
     C                   EVAL      MCCMS  = TLF
     C                   EVAL      MCCMST = 'TE'
     C                   ENDSL
     C                   END
      *
     C                   EVAL      MCTYPE = '11'
     C                   EVAL      MCVAL  = SIVAL3
     C                   EVAL      MCLKA  = SILKA
      *
     C                   WRITE     SADKMCFR
      *
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     CUNDL01KS     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    SIKNS
     C     CUNDL01KK     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    SIKNK
     C     SADKMCL1K     KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     SADHK         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UPRO              8 0
     C                   PARM                    UUUID            36
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
