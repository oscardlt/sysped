      *
      ***************************************************************
      *** PROGRAM SKAL SETTE FRA/TILSTED M.M. AUTOMATISK          ***
      ***************************************************************
      *
     FTURER     UF   E           K DISK
     FHEAD11    IF   E           K DISK
     FDISP      IF   E           K DISK
     FSTED2D    IF   E           K DISK
     D                 DS
     D  DIDATF                 1      8  0
     D  DIFAAR                 1      4  0
     D  DIFMND                 5      6  0
     D  DIFDAG                 7      8  0
     D  DITIMF                 9     12  0
     D  DIFRA                  1     12  0
     D                 DS
     D  DIDATT                 1      8  0
     D  DITAAR                 1      4  0
     D  DITMND                 5      6  0
     D  DITDAG                 7      8  0
     D  DITIMT                 9     12  0
     D  DITIL                  1     12  0
     D                 DS
     D  MINDT                  1     12  0
     D  MINDAT                 1      8  0
     D  MINAAR                 1      4  0
     D  MINMND                 5      6  0
     D  MINDAG                 7      8  0
     D  MINTIM                 9     12  0
     D  MINSTE                13     17
     D  MINSON                18     22
     D                 DS
     D  MAXDT                  1     12  0
     D  MAXDAT                 1      8  0
     D  MAXAAR                 1      4  0
     D  MAXMND                 5      6  0
     D  MAXDAG                 7      8  0
     D  MAXTIM                 9     12  0
     D  MAXSTE                12     17
     D  MAXSON                18     22
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UPRO              8 0
     C*
     C                   EXSR      MINMAX
     C                   EXSR      OPPDAT
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     MINMAX        BEGSR
     C***********************************************
     C     DISKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVE      *ZEROS        MINDT
     C                   MOVEL     '99999999'    MINDT
     C                   MOVE      *ZEROS        MAXDT
     C*
     C     UPRO          SETLL     HEAD11
     C     UPRO          READE     HEAD11                                 33
     C     *IN33         DOWEQ     '0'
     C     DISKEY        CHAIN     DISP                               34
     C     *IN34         IFNE      '1'
     C     DIFRA         IFLT      MINDT
     C                   MOVE      DIFRA         MINDT
     C                   MOVE      DISTEF        MINSTE
     C                   MOVE      DISONF        MINSON
     C                   END
     C     DITIL         IFGT      MAXDT
     C                   MOVE      DITIL         MAXDT
     C                   MOVE      DISTET        MAXSTE
     C                   MOVE      DISONT        MAXSON
     C                   END
     C                   END
     C     UPRO          READE     HEAD11                                 33
     C                   END
     C* Ved TRmodul innland innland ikke sett dato - sikre NO->NO for momskoden.
     c     HXSNDN        ifne      *blanks
     c                   move      *zeros        MINDT
     c                   move      *zeros        MAXDT
     c                   movel     'NO'          MINSON
     c                   movel     'NO'          MAXSON
     c                   end
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPPDAT        BEGSR
     C***********************************************
     C     FRAKEY        KLIST
     C                   KFLD                    YYLKF             2
     C                   KFLD                    TUSTEF
     C     TILKEY        KLIST
     C                   KFLD                    YYLKT             2
     C                   KFLD                    TUSTET
     C     TURKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UPRO
     C     TURKEY        CHAIN     TURER                              50
     C     *IN50         IFNE      '1'
     C* MINUMUM = FRA
     C     MINDAT        IFNE      99999999
     C     MINDAT        andne     *zeros
     C                   MOVE      MINDAT        TUDT
     C                   MOVE      MINTIM        TUTM
     C                   END
     C                   MOVE      MINSTE        TUSTEF
     C                   MOVE      MINSON        TUSONF
     C                   MOVEL     TUSONF        YYLKF
     C     FRAKEY        CHAIN     STED2D                             33
     C                   MOVEL     ST2NVN        TUSDF
     C*
     C*
     C* MAXIMUM = TIL
     C     MAXDAT        Ifne      *zeros
     C                   MOVE      MAXDAT        TUDTT
     C                   MOVE      MAXTIM        TUTMT
     c                   end
     C                   MOVE      MAXSTE        TUSTET
     C                   MOVE      MAXSON        TUSONT
     C                   MOVEL     TUSONT        YYLKT
     C     TILKEY        CHAIN     STED2D                             33
     C                   MOVEL     ST2NVN        TUSDT
     C*
     C                   UPDATE    TURERR
     C                   END
     C*
     C                   ENDSR
