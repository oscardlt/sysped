********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 BÅTKODE=*ALL -> ENDELIG TRIP MED ULIKE BÅTER
10XXX * 02 YBC PTF10 FEILRETTING PÅ ENDRING 1
10XXX * 03 YBC PTF10 LOGG ENDRINGER
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED TURENSINNHOLD
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01-03 05-09 11-22 24-26
      *** LEDIGE INDIKATORER 31 32 34-87
      **************************************************************
      *
     FGSSTRF    UF A E           K DISK
     FGSSTWL02  UF A E           K DISK
     FBRPARL2   IF   E           K DISK
     FGSSORL02  UF   E           K DISK
     FGSSORL21  UF   E           K DISK
     F                                     RENAME(GSSORFR:GSSORF21)
     FGSSOLF    UF   E           K DISK
     FGSSCGF    IF   E           K DISK
     FGSSFIF    IF   E           K DISK
N03  FGSSLGTF   O  A E             DISK
     FCDBOAT    IF   E           K DISK
     FKODTFT    IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FHEADF     UF A E           K DISK
     FTELL      UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FGSS021D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
EV5  D  HEDTÅ                  1      4  0
EV5  D  HEDTM                  5      6  0
EV5  D  HEDTD                  7      8  0
NV5  D  HEDTOP                 1      8  0
SV5  D*                                       1   60XHEDT
     D                 DS
EV5  D  TRDTPÅ                 1      4  0
EV5  D  TRDTPM                 5      6  0
EV5  D  TRDTPD                 7      8  0
EV5  D  TRDTP                  1      8  0
     D                 DS
     D  WSDTPD                 1      2  0
     D  WSDTPM                 3      4  0
     D  WSDTPÅ                 5      6  0
     D  WSDTP                  1      6  0
     D                 DS
EV5  D  TRDTIÅ                 1      4  0
EV5  D  TRDTIM                 5      6  0
EV5  D  TRDTID                 7      8  0
EV5  D  TRDTI                  1      8  0
     D                 DS
     D  WSDTID                 1      2  0
     D  WSDTIM                 3      4  0
     D  WSDTIÅ                 5      6  0
     D  WSDTI                  1      6  0
     D                 DS
EV5  D  TRDTLÅ                 1      4  0
EV5  D  TRDTLM                 5      6  0
EV5  D  TRDTLD                 7      8  0
EV5  D  TRDTL                  1      8  0
     D                 DS
     D  WSDTLD                 1      2  0
     D  WSDTLM                 3      4  0
     D  WSDTLÅ                 5      6  0
     D  WSDTL                  1      6  0
     D                 DS
EV5  D  TRDTSÅ                 1      4  0
EV5  D  TRDTSM                 5      6  0
EV5  D  TRDTSD                 7      8  0
EV5  D  TRDTS                  1      8  0
     D                 DS
     D  WSDTSD                 1      2  0
     D  WSDTSM                 3      4  0
     D  WSDTSÅ                 5      6  0
     D  WSDTS                  1      6  0
NV5  D                 DS
NV5  D  XTIME                  1     14  0
NV5  D  XDAG                   7      8  0
NV5  D  XMND                   9     10  0
NV5  D  XAAR                  11     14  0
     D                 DS
     D  WSTNO                  1     11  0
     D  HEAVD                  1      4  0
     D  HEOPD                  5     11  0
     D                UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UBIAVD                15     18  0
     D  USG                   19     21
     D  UUSID                101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
N03  D                SDS
N03  D  UUSER                254    263
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C  N30
     CAN 27
     CANN04              Z-ADD     3             LINNBR
     C  N30
     CANN27
     CANN04              Z-ADD     5             LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   EXFMT     GSS021DA
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '0000'        *IN(88)
     C                   MOVE      '0'           *IN30
      *
     C   12              GOTO      SLUTT
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
     C   06HEOPD         IFEQ      0
     C                   MOVE      HEAVD         TEAVD
     C                   CLEAR                   HEADFR
     C                   MOVE      TEAVD         HEAVD
     C     TEAVD         CHAIN     TELL                               33
     C  N33              DO
     C                   MOVE      TEOPDN        HEOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   MOVE      'U'           HEST
     C                   MOVE      USG           HESG
     C                   MOVE      'S'           HEUR
SV5  C*                    MOVE UYEAR     HEDTÅ
SV5  C*                    MOVE UMONTH    HEDTM
SV5  C*                    MOVE UDAY      HEDTD
SV5  C*                    MOVE XHEDT     HEDTR
NV5  C                   TIME                    XTIME
NV5  C                   MOVE      XAAR          HEDTÅ
NV5  C                   MOVE      XMND          HEDTM
NV5  C                   MOVE      XDAG          HEDTD
NV5  C                   MOVE      HEDTOP        HEDTR
     C                   MOVE      *ZEROS        HEHAWB
     C                   WRITE     HEADFR
     C                   END
     C                   GOTO      START
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
     C                   EXSR      UPDTR
      *
     C   10              DO
     C                   MOVE      '0'           *IN99
     C     STPRT         TAG
     C                   EXFMT     GSS021DX
     C                   MOVE      '0'           *IN99
     C   12              GOTO      START
     C     WSPRT         COMP      *BLANKS                                99
     C   99              GOTO      STPRT
      *
     C                   MOVE      UTYPE         UTYPE2            3
     C     UTYPE         IFEQ      'EDT'
     C                   MOVE      'CPY'         UTYPE
     C                   ELSE
     C                   MOVE      'PRT'         UTYPE
     C                   END
     C                   MOVE      TRCNO         UCNO2             8
     C                   MOVE      TRTNO         UTNO2            11
      *
     C     WSFAX         IFEQ      'Y'
     C                   CALL      'GSS034C'
     C                   PARM                    UCNO2
     C                   PARM                    UUTFAX            1
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    UVALK             3
     C                   PARM                    UMOD              1
     C                   PARM                    UCOMM             1
     C                   PARM                    UKNC              8
     C     UUTFAX        CABEQ     'J'           STPRT2
     C                   GOTO      STPRT
     C                   END
      *
     C     WSCPY         IFEQ      0
     C                   Z-ADD     1             WSCPY
     C                   END
     C                   MOVE      WSCPY         UCPY              1
      *
     C                   CALL      'GSS022R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    UCPY
     C                   PARM                    WSPRT
     C                   PARM                    WSFAX
      *
     C     STPRT2        TAG
     C                   MOVE      UTYPE2        UTYPE
     C                   MOVE      '1'           WSST
     C                   GOTO      SLUTT
     C                   END
      *
     C   23              DO
     C     TRTNO         SETLL     GSSORL21                           33
     C     TRTNO         READE     GSSORL21                               33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      '2'           ORST
     C     TRBCD         IFEQ      *BLANKS
     C     TRLOCF        ORNE      *BLANKS
     C                   MOVE      ORLC2         ORLC3
     C                   MOVE      ORLC          ORLC2
     C                   MOVE      'ONWAY'       ORLC
     C                   MOVE      ORDTL2        ORDTL3
     C                   MOVE      ORDTL         ORDTL2
     C                   MOVE      TRDTL         ORDTL
     C                   END
     C                   UPDATE    GSSORF21
     C     TRTNO         READE     GSSORL21                               33
     C  N33              ENDDO
     C                   MOVE      '2'           WSST
     C                   GOTO      SLUTT
     C                   END
      *
     C                   CALL      'GSS023R'
     C                   PARM                    UTNO
     C                   PARM                    UTYPE
     C                   PARM                    UMODE
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      1
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     UTNO          IFNE      0
     C     UTNO          CHAIN     GSSTRF                             33
     C     TRST          IFEQ      'X'
     C                   MOVE      WSST          TRST
     C                   END
     C  N33              UPDATE    GSSTRFR
     C                   END
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
     C***********************************************
     C     SØKUNR        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSCNO
     C                   PARM      UFIRM         UFIRM2            2
     C                   PARM                    USØKKN           30
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C   27              DO
     C     HEADFK        CHAIN(N)  HEADF                              99
     C     *IN99         IFEQ      '1'
     C                   MOVE      'GSS0051'     MSGNR
     C                   ELSE
     C     WSTNO         CHAIN(N)  GSSTRF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      '1'           *IN99
     C                   MOVE      'YBC0566'     MSGNR
     C                   END
     C                   END
     C     *IN99         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C  N99WSAD1         IFEQ      *BLANKS
     C     WSAD2         ANDEQ     *BLANKS
     C     HEUR          ANDNE     'S'
     C                   MOVE      HENAK         WSAD1
     C                   MOVE      HEADK1        WSAD2
     C                   MOVE      HEADK2        WSAD3
     C                   MOVE      HEADK3        WSAD4
     C                   MOVE      *BLANKS       WSAD5
     C                   MOVE      *BLANKS       WSAD6
     C                   END
     C                   END
      *
     C     WSBCD         IFNE      *BLANKS
N01  C     WSBCD         ANDNE     '*ALL'
     C     WSLCF         OREQ      *BLANKS
N01  C     WSBCD         ANDNE     '*ALL'
     C     WSLCT         OREQ      *BLANKS
N01  C     WSBCD         ANDNE     '*ALL'
     C     WSBCD         CHAIN     CDBOAT                             98
     C  N30*IN98         IFEQ      '1'                                          1<-B
     C                   MOVE      'GSS0032'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   ELSE                                                   1
     C                   MOVE      CBNAB         WSBNM
     C                   MOVE      CBKN          WSCNO
     C     CUND1K        CHAIN     CUNDL01                            97
     C   97
     CANN30              MOVE      'GSS0028'     MSGNR
     C  N97UBICGR        IFNE      *BLANKS                                       2<-B
     C     WSCNO         CHAIN     GSSCGF                             97
     C  N97CGCG          COMP      UBICGR                             9797
     C   97
     CANN30              MOVE      'GSS0029'     MSGNR
     C                   END                                                     2<-E
     C  N97UBICNO        IFNE      0                                             2<-B
     C     UBICNO        ANDNE     WSCNO
     C                   MOVE      '1'           *IN97
     C  N30              MOVE      'GSS0030'     MSGNR
     C                   END                                                     2<-E
     C   97
     CANN30              DO
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C  N97              MOVE      KNAVN         WSCNM
     C                   END                                                    1<-E
     C                   ELSE
     C                   MOVE      *BLANKS       WSBNM
     C                   END
      *
     C     WSFC          CHAIN     GSSFIF                             96
     C   96
     CANN30              DO
     C                   MOVE      'GSS0052'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C  N96              MOVE      FINM          WSFNM
      *
     C     WSAD1         COMP      *BLANKS                                95
     C   95
     CANN30              DO
     C                   MOVE      'GSS0053'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
      *
     C                   MOVE      WSDTLÅ        UÅÅ               2 0
     C                   MOVE      WSDTLM        UMM               2 0
     C                   MOVE      WSDTLD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      94
     C   94
     CANN30              DO
     C                   MOVE      'GSS0039'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
      *
     C                   MOVE      WSDTSÅ        UÅÅ               2 0
     C                   MOVE      WSDTSM        UMM               2 0
     C                   MOVE      WSDTSD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      93
     C   93
     CANN30              DO
     C                   MOVE      'GSS0054'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
      *
     C     WSLCF         IFNE      *BLANKS
     C     WSLCT         ORNE      *BLANKS
N01  C     WSBCD         OREQ      '*ALL'
     C     WSLCF         CHAIN     STED2                              91
     C   91
     CANN30              DO
S01  C*                  MOVE      'SPS0001'     MSGNR
N01  C                   MOVE      'SPS0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
S02  C*    WSLCF         CHAIN     STED2                              90
N01  C     WSBCD         IFNE      '*ALL'
N02  C     WSLCT         ORNE      *BLANKS
N02  C     WSLCT         CHAIN     STED2                              90
     C   90
     CANN30              DO
S01  C*                  MOVE      'SPS0001'     MSGNR
N01  C                   MOVE      'SPS0013'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   END
N02  C                   END
     C                   END
      *
     C     WSOT          IFNE      *BLANKS
     C     WSFR          ORNE      *BLANKS
     C     KODOTK        CHAIN     KODTOTY                            89
     C   89
     CANN30              DO
     C                   MOVE      'SPO0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   END
     C     KODFRK        CHAIN     KODTFR                             88
     C   88
     CANN30              DO
     C                   MOVE      'SPF0006'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     73            LINNBR
     C                   Z-ADD     73            POSNBR
     C                   END
     C                   END
      *
     C     WSFTCD        IFNE      *BLANKS
     C                   MOVE      '1'           *IN92
     C     KODF1K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN92
     C  N33              MOVEL     KFTFTX        WSFT1
     C   33              MOVE      *BLANKS       WSFT1
     C     KODF2K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN92
     C  N33              MOVEL     KFTFTX        WSFT2
     C   33              MOVE      *BLANKS       WSFT2
     C     KODF3K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN92
     C  N33              MOVEL     KFTFTX        WSFT3
     C   33              MOVE      *BLANKS       WSFT3
     C     KODF4K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN92
     C  N33              MOVEL     KFTFTX        WSFT4
     C   33              MOVE      *BLANKS       WSFT4
     C  N92              MOVE      *BLANKS       WSFTCD
     C   92
     CANN30              DO
     C                   MOVE      'GSS0035'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     UPDTR         BEGSR
     C***********************************************
     C                   MOVEA     '01'          *IN(27)
      *
     C                   MOVE      WSTNO         UTNO
     C     UTNO          CHAIN     GSSTRF                             33
     C                   MOVE      UTNO          TRTNO
     C     UTYPE         IFNE      'EDT'
     C     UTYPE         ANDNE     'DSP'
     C                   MOVE      'X'           TRST
     C                   END
      *
     C                   IF        UTYPE = 'EDT'
     C                   SELECT
      * FRA "FINAL" TIL "TRANSIT"
     C                   WHEN      ((TRBCD <> *BLANKS) AND (WSBCD = *BLANKS))
     C                   EXSR      UPDORD
      * FRA "TRANSIT" TIL "FINAL"
     C                   WHEN      (((WSBCD <> *BLANKS) AND
     C                               (TRBCD = *BLANKS)) AND
     C                               (WSLCT = *BLANKS))
     C                   EXSR      UPDORD2
      * FRA "TRANSIT" TIL "FINAL"
     C                   WHEN      ((TRLOCT <> *BLANKS) AND (WSLCT = *BLANKS))
     C                   EXSR      UPDORD2
      * FRA "FINAL" TIL "TRANSIT"
     C                   WHEN      ((WSLCT <> *BLANKS) AND (TRLOCT = *BLANKS))
     C                   EXSR      UPDORD
     C                   ENDSL
     C                   END
      *
N03  C                   IF        *IN33 = *OFF
N03  C                   EXSR      SRLOG
N03  C                   END
     C                   MOVE      WSCNO         TRCNO
     C                   MOVE      WSFC          TRFC
     C                   MOVE      WSBCD         TRBCD
     C                   MOVE      WSAD1         TRAD1
     C                   MOVE      WSAD2         TRAD2
     C                   MOVE      WSAD3         TRAD3
     C                   MOVE      WSAD4         TRAD4
     C                   MOVE      WSAD5         TRAD5
     C                   MOVE      WSAD6         TRAD6
     C                   MOVE      TRDTL         XRDTL             8 0
     C                   MOVE      WSDTLD        TRDTLD
     C                   MOVE      WSDTLM        TRDTLM
     C                   MOVE      WSDTLÅ        TRDTLÅ
NV5  C     WSDTLÅ        IFGT      50
NV5  C                   MOVEL     '19'          TRDTLÅ
NV5  C                   ELSE
NV5  C                   MOVEL     '20'          TRDTLÅ
NV5  C                   END
     C                   MOVE      WSTML         TRTML
     C                   MOVE      WSDTSD        TRDTSD
     C                   MOVE      WSDTSM        TRDTSM
     C                   MOVE      WSDTSÅ        TRDTSÅ
NV5  C     WSDTSÅ        IFGT      50
NV5  C                   MOVEL     '19'          TRDTSÅ
NV5  C                   ELSE
NV5  C                   MOVEL     '20'          TRDTSÅ
NV5  C                   END
     C                   MOVE      WSDW          TRDW
     C                   MOVE      WSFTCD        TRFTCD
     C                   MOVE      WSFT1         TRFT1
     C                   MOVE      WSFT2         TRFT2
     C                   MOVE      WSFT3         TRFT3
     C                   MOVE      WSFT4         TRFT4
NV5  C                   MOVE      WSKDL1        TRKDL1
NV5  C                   MOVE      WSKDL2        TRKDL2
NV5  C                   MOVE      WSKDL3        TRKDL3
     C                   MOVE      WSLCF         TRLOCF
     C                   MOVE      WSLCT         TRLOCT
     C                   MOVE      WSOT          TROT
     C                   MOVE      WSFR          TRFR
     C                   MOVE      WSRTNG        TRRTNG
     C   33              WRITE     GSSTRFR
     C  N33              UPDATE    GSSTRFR
      *
     C     HEADFK        CHAIN     HEADF                              33
     C     HEUR          IFEQ      'S'
     C                   MOVE      TRCNO         HEKNS
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         HENAS
     C                   MOVE      ADR1          HEADS1
     C                   MOVE      ADR2          HEADS2
     C                   MOVE      *BLANKS       HEADS3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          HEADS3
     C                   ELSE
     C                   MOVEL     POSTNR        HEADS3
     C                   MOVE      ADR3          HEADS3
     C                   END
     C                   MOVE      TRAD1         HENAK
     C                   MOVE      TRAD2         HEADK1
     C                   MOVE      TRAD3         HEADK2
     C                   MOVE      TRAD4         HEADK3
     C     TRLOCF        IFNE      *BLANKS
     C                   MOVE      TRLOCF        HESDF
     C                   MOVE      TRLOCT        HESDT
     C                   END
     C     TROT          IFNE      *BLANKS
     C                   MOVE      TROT          HEOT
     C                   MOVE      TRFR          HEFR
     C                   END
     C                   END
     C                   UPDATE    HEADFR
      *
     C     TRTNO         CHAIN     GSSTWL02                           33
     C                   IF        *IN33
     C                   Z-ADD     HEKNA         PAVRDN
     C     BRPARL2K      CHAIN     BRPARL2                            33
     C                   IF        *IN33 = *OFF
     C                   EVAL      TWST   = ' '
     C                   EVAL      TWTYP  = 'G'
     C                   EVAL      TWTNO  = TRTNO
     C                   EVAL      TWLC   = HESDF
     C                   EVAL      TWUSR  = PABRID
     C                   EVAL      TWCURC = *BLANKS
     C                   EVAL      TWFT1  = *BLANKS
     C                   EVAL      TWFT2  = *BLANKS
     C                   WRITE     GSSTWFR
     C                   END
     C                   ELSE
     C                   IF        TWTYP  = 'G'
     C                   EVAL      TWLC   = HESDF
     C                   END
     C                   UPDATE    GSSTWFR
     C                   END
      *
      * SJEKK OM DET ER NOEN ORDRE SOM ER ALLEREDE PLUKKET.
     C     GSOR2K        SETLL     GSSORL02                           33
     C     GSOR2K        READE     GSSORL02                               33
     C     *IN33         DOWEQ     '0'
     C     ORTNO         IFEQ      0
     C                   MOVE      TRTNO         ORTNO
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE     GSSOLF                                 34
     C     *IN34         DOWEQ     '0'
     C                   MOVE      TRTNO         OLTNO
     C                   UPDATE    GSSOLFR
     C     ORONO         READE     GSSOLF                                 34
     C  N34              ENDDO
     C                   END
     C                   UPDATE    GSSORFR
     C     GSOR2K        READE     GSSORL02                               33
     C  N33              END
      *
     C     UTYPE         IFEQ      'EDT'
     C     TRDTL         ANDNE     XRDTL
     C     TRBCD         IFEQ      *BLANKS
     C     TRLOCF        ORNE      *BLANKS
     C     TRLOCT        ORNE      *BLANKS
     C     TRTNO         SETLL     GSSORL21                           33
     C     TRTNO         READE     GSSORL21                               33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      TRDTL         ORDTL
     C                   UPDATE    GSSORF21
     C     TRTNO         READE     GSSORL21                               33
     C  N33              ENDDO
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     UPDORD        BEGSR
      ***********************************************
     C     TRTNO         SETLL     GSSORL21                           33
     C     TRTNO         READE     GSSORL21                               33
     C                   DOW       *IN33 = *OFF
     C                   IF        ORLC <> 'ONWAY'
     C                   EVAL      ORLC3  = ORLC2
     C                   EVAL      ORLC2  = ORLC
     C                   EVAL      ORLC   = 'ONWAY'
     C                   EVAL      ORDTL3 = ORDTL2
     C                   EVAL      ORDTL2 = ORDTL
     C                   EVAL      ORDTL  = 20000000
     C                             + WSDTLÅ * 10000
     C                             + WSDTLM * 100
     C                             + WSDTLD
     C                   END
     C                   UPDATE    GSSORF21
     C     TRTNO         READE     GSSORL21                               33
     C                   ENDDO
     C                   MOVE      *OFF          *IN33
      *
     C                   ENDSR
      *
      ***********************************************
     C     UPDORD2       BEGSR
      ***********************************************
     C     TRTNO         SETLL     GSSORL21                           33
     C     TRTNO         READE     GSSORL21                               33
     C                   DOW       *IN33 = *OFF
     C                   IF        ORLC = 'ONWAY'
     C                   EVAL      ORLC   = ORLC2
     C                   EVAL      ORLC2  = ORLC3
     C                   EVAL      ORLC3  = *BLANKS
     C                   EVAL      ORDTL  = ORDTL2
     C                   EVAL      ORDTL2 = ORDTL3
     C                   EVAL      ORDTL3 = 0
     C                   END
     C                   UPDATE    GSSORF21
     C     TRTNO         READE     GSSORL21                               33
     C                   ENDDO
     C                   MOVE      *OFF          *IN33
      *
     C                   ENDSR
      *
     C***********************************************
     C     GETTR         BEGSR
     C***********************************************
     C     UTNO          CHAIN     GSSTRF                             33
     C                   MOVE      TRTNO         WSTNO
     C                   MOVE      TRST          WSST
     C  N29              MOVE      'X'           TRST
     C                   UPDATE    GSSTRFR
     C                   MOVE      TRCNO         WSCNO
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         WSCNM
     C                   MOVE      TRFC          WSFC
     C     WSFC          CHAIN     GSSFIF                             33
     C                   MOVE      FINM          WSFNM
     C                   MOVE      TRBCD         WSBCD
     C     WSBCD         CHAIN     CDBOAT                             33
     C                   MOVE      CBNAB         WSBNM
     C                   MOVE      TRAD1         WSAD1
     C                   MOVE      TRAD2         WSAD2
     C                   MOVE      TRAD3         WSAD3
     C                   MOVE      TRAD4         WSAD4
     C                   MOVE      TRAD5         WSAD5
     C                   MOVE      TRAD6         WSAD6
     C                   MOVE      TRDTPÅ        WSDTPÅ
     C                   MOVE      TRDTPM        WSDTPM
     C                   MOVE      TRDTPD        WSDTPD
     C                   MOVE      TRDTIÅ        WSDTIÅ
     C                   MOVE      TRDTIM        WSDTIM
     C                   MOVE      TRDTID        WSDTID
     C                   MOVE      TRDTLÅ        WSDTLÅ
     C                   MOVE      TRDTLM        WSDTLM
     C                   MOVE      TRDTLD        WSDTLD
     C                   MOVE      TRTML         WSTML
     C                   MOVE      TRDTSÅ        WSDTSÅ
     C                   MOVE      TRDTSM        WSDTSM
     C                   MOVE      TRDTSD        WSDTSD
     C                   MOVE      TRDW          WSDW
     C                   MOVE      TRFTCD        WSFTCD
     C                   MOVE      TRFT1         WSFT1
     C                   MOVE      TRFT2         WSFT2
     C                   MOVE      TRFT3         WSFT3
     C                   MOVE      TRFT4         WSFT4
NV5  C                   MOVE      TRKDL1        WSKDL1
NV5  C                   MOVE      TRKDL2        WSKDL2
NV5  C                   MOVE      TRKDL3        WSKDL3
     C                   MOVE      TRLOCF        WSLCF
     C                   MOVE      TRLOCT        WSLCT
     C                   MOVE      TROT          WSOT
     C                   MOVE      TRFR          WSFR
     C                   MOVE      TRRTNG        WSRTNG
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG            1 0
      *
     C     UBICNO        IFEQ      0
     C     UBICGR        ANDEQ     *BLANKS
     C     WSTNO         ANDEQ     0
     C     LINNBR        ANDEQ     3
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     30
     C                   MOVE      'S'           UTYPES            1
     C     *LIKE         DEFINE    HEAVD         UAVD
     C     *LIKE         DEFINE    HEOPD         UOPD
     C     *LIKE         DEFINE    HESG          USG2
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C     HEAVD         PARM      HEAVD         UAVD
     C     HEOPD         PARM      HEOPD         UOPD
     C                   PARM                    USG2
     C                   GOTO      SLSØK
     C                   END
      *
     C     UBICNO        IFEQ      0
     C     UBICGR        ANDEQ     *BLANKS
     C     LINNBR        ANDEQ     6
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   EXSR      SØKUNR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     24
     C                   CALL      'GSS004R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSFC
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     24
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSBCD
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     51
     C                   CALL      'SOEKVADR'
     C                   PARM      UFIRM         UFIRM2            2
     C                   PARM                    WSCNO
     C                   PARM                    WSAD1
     C                   PARM                    WSAD2
     C                   PARM                    WSAD3
     C                   PARM                    WSAD4
     C                   PARM                    ULK               2
     C                   PARM                    UADRNR            5
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     26
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULKA
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLCF
     C                   PARM                    UNVN             30
     C                   PARM                    ULKA              2
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     33
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULKA
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLCT
     C                   PARM                    UNVN             30
     C                   PARM                    ULKA              2
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOT
     C                   Z-ADD     57            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     73
     C     POSNBR        ANDLE     75
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFR
     C                   PARM                    USPED
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     23
     C                   CALL      'SYFI10I'
     C                   PARM                    WSFTCD
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'GSS0013'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
N03   ***********************************************
N03  C     SRLOG         BEGSR
N03   ***********************************************
N03  C                   CALL      'SYGE15C'
N03  C                   PARM                    WDT               8
N03  C                   PARM                    WTM               6
N03  C                   MOVE      WDT           TLDT
N03  C                   MOVE      WTM           TLTID
N03  C                   MOVE      WDT           TLHDT
N03  C                   MOVE      WTM           TLHTID
N03  C                   EVAL      TLUSER = UUSER
N03  C                   EVAL      TLPGM  = 'GSS021R'
N03  C                   EVAL      TLLEV  = 0
N03  C                   EVAL      TLFTYP = '*CHG'
N03  C                   EVAL      TLTNO  = TRTNO
N03  C                   IF        WSBCD  <> TRBCD
N03  C                   EVAL      TLTXT  = 'Vessel code is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSBCD)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRBCD)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSFC   <> TRFC
N03  C                   EVAL      TLTXT  = 'Company code is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSFC)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRFC)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSAD1  <> TRAD1
N03  C                   EVAL      TLTXT  = 'Address 1 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSAD1)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRAD1)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSAD2  <> TRAD2
N03  C                   EVAL      TLTXT  = 'Address 2 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSAD2)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRAD2)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSAD3  <> TRAD3
N03  C                   EVAL      TLTXT  = 'Address 3 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSAD3)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRAD3)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSAD4  <> TRAD4
N03  C                   EVAL      TLTXT  = 'Address 4 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSAD4)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRAD4)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSAD5  <> TRAD5
N03  C                   EVAL      TLTXT  = 'Address 5 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSAD5)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRAD5)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSAD6  <> TRAD6
N03  C                   EVAL      TLTXT  = 'Address 6 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSAD6)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRAD6)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   EVAL      XNR08 = 20000000 + WSDTLÅ * 10000
N03  C                             + WSDTLM * 100 + WSDTLD
N03  C                   IF        XNR08  <> TRDTL
N03  C                   EVAL      TLTXT  = 'Delivery date is changed.'
N03  C                   EVAL      TLNGM  = TRDTL
N03  C                   EVAL      TLNNY  = XNR08
N03  C                   EVAL      TLAGM  = *BLANKS
N03  C                   EVAL      TLANY  = *BLANKS
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   EVAL      XNR08 = 20000000 + WSDTSÅ * 10000
N03  C                             + WSDTSM * 100 + WSDTSD
N03  C                   IF        XNR08  <> TRDTS
N03  C                   EVAL      TLTXT  = 'Dispatch date is changed.'
N03  C                   EVAL      TLNGM  = TRDTS
N03  C                   EVAL      TLNNY  = XNR08
N03  C                   EVAL      TLAGM  = *BLANKS
N03  C                   EVAL      TLANY  = *BLANKS
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSDW   <> TRDW
N03  C                   EVAL      TLTXT  = 'Delivery way is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSDW)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRDW)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSFT1  <> TRFT1
N03  C                   EVAL      TLTXT  = 'Freetext 1 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSFT1)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRFT1)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSFT2  <> TRFT2
N03  C                   EVAL      TLTXT  = 'Freetext 2 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSFT2)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRFT2)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSFT3  <> TRFT3
N03  C                   EVAL      TLTXT  = 'Freetext 3 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSFT3)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRFT3)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSFT4  <> TRFT4
N03  C                   EVAL      TLTXT  = 'Freetext 4 is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSFT4)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRFT4)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSOT   <> TROT
N03  C                   EVAL      TLTXT  = 'Order type is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSOT)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TROT)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSFR   <> TRFR
N03  C                   EVAL      TLTXT  = 'Frankatur is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSFR)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRFR)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSLCF  <> TRLOCF
N03  C                   EVAL      TLTXT  = 'Location from is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSLCF)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRLOCF)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03  C                   IF        WSLCT  <> TRLOCT
N03  C                   EVAL      TLTXT  = 'Location to is changed.'
N03  C                   EVAL      TLNGM  = 0
N03  C                   EVAL      TLNNY  = 0
N03  C                   EVAL      TLAGM  = 'From ' + %trim(WSLCT)
N03  C                   EVAL      TLANY  = 'To ' + %trim(TRLOCT)
N03  C                   WRITE     GSSLGTFR
N03  C                   END
N03   *
N03  C                   ENDSR
N03   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSCNO
     C     GSOR2K        KLIST
     C                   KFLD                    YST
     C                   KFLD                    TRBCD
     C     *LIKE         DEFINE    ORST          YST
     C                   MOVE      '1'           YST
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     KODF1K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN1              1 0
     C                   Z-ADD     1             XLN1
     C     KODF2K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN2              1 0
     C                   Z-ADD     2             XLN2
     C     KODF3K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN3              1 0
     C                   Z-ADD     3             XLN3
     C     KODF4K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN4              1 0
     C                   Z-ADD     4             XLN4
     C     KODOTK        KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    WSOT
     C                   MOVE      'OTY'         KO1UNI
     C     KODFRK        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    WSFR
     C                   MOVE      'FR'          KFRUNI
     C     BRPARL2K      KLIST
     C                   KFLD                    PAVRDN
     C                   KFLD                    PAID
     C                   EVAL      PAID = 'SSAGT'
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO             11 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UMODE             1
      *
     C                   CLEAR                   GSS021DA
     C                   CLEAR                   GSSTRFR
     C     WSPRT         IFEQ      *BLANKS
     C                   MOVE      UBIPRT        WSPRT
     C                   END
N03  C                   MOVE      *ZEROS        XNR08             8 0
     C                   Z-ADD     1             WSCPY
     C                   MOVE      '1'           UMOD              1
     C                   MOVE      'N'           WSFAX
     C                   MOVE      *ZEROS        WSDTP
     C                   MOVE      *ZEROS        TRDTP
     C                   MOVE      *ZEROS        WSDTL
     C                   MOVE      *ZEROS        TRDTL
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        TRDTS
NV5  C                   MOVE      *ZEROS        WSDTI
NV5  C                   MOVE      *ZEROS        TRDTI
     C     UTYPE         COMP      'CRT'                                  27
     C     UTYPE         COMP      'CHG'                                  28
     C  N28UTYPE         COMP      'EDT'                                  28
     C     UTYPE         COMP      'DSP'                                  29
     C   28
     COR 29              EXSR      GETTR
     C   27              DO
     C                   MOVE      UBICNO        WSCNO
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      UBIFC         WSFC
     C     WSFC          CHAIN     GSSFIF                             33
     C                   MOVE      FINM          WSFNM
     C                   MOVE      UBIAVD        HEAVD
     C                   IF        UTNO <> 0
     C                   MOVE      UTNO          WSTNO
     C                   END
     C                   END
      *
     C                   ENDSR
      *
