*****F**************************************************************
      * reorg varelinjer
      * RETTINGER I DETTE PROGRAM:
PTFnrF*Sek Sig Vers Beskrivelse...........................
"""""F*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11008F* 01
*****F**************************************************************
      *
      ***********************************************************
      *** PROGRAM sletter en linje og reorg varelinjer        ***
      *** INDICATORS  01 - 26 FUNCTION  / ROLL KEYS           ***
      *** INDICATORS USED                                     ***
      ***********************************************************
      *
     FDOKUFVG   UF A E           K DISK
     FDOKUFV    UF   E           K DISK
     FDOKUFM    UF   E           K DISK
     FDOKUFVF   UF   E           K DISK
      *
     C                   EXSR      INIT
     C                   EXSR      DELLIN
     C                   EXSR      DEL0
     C                   EXSR      DEL
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFBNR             3 0
     C                   PARM                    ULINR             2 0
     C*--------------------------------------------------------------
     C* DEFINE KEY FOR DOKUFV
     C*--------------------------------------------------------------
     C     KEYFV         KLIST
     C                   KFLD                    UFRI
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
     C                   KFLD                    ULINR
     C     KEYFVE        KLIST
     C                   KFLD                    UFRI
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
     C     KEYFM         KLIST
     C                   KFLD                    UFRI
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
     C                   KFLD                    ULINR
     C                   MOVE      'F'           UFRI              1
     C     KEYFME        KLIST
     C                   KFLD                    UFRI
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
     C     KEYFVF        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
     C                   KFLD                    ULINR
     C     KEYFVFE       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
      *
     C                   ENDSR
     C*
     C***********************************************
     C     DEL           BEGSR
     C***********************************************
     C*  DOKUFV
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFV         SETLL     DOKUFV
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVE        READE     DOKUFV                                 33
     C     *IN(33)       IFEQ      '0'
     C                   Z-add     ULINRS        FVLINR
     c                   update    dokufvr
     c                   add       1             ULINRS
     c                   endif
     c                   enddo
      *
     C*  DOKUFM
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFM         SETLL     DOKUFM
     C     *IN(33)       DOWEQ     '0'
     C     KEYFME        READE     DOKUFM                                 33
     C     *IN(33)       IFEQ      '0'
      * øker linjenummer bare hvis jeg leser neste
     c     fmlinr        ifne      fmlinrf
     c     fmlinrf       andne     0
     c                   add       1             ULINRS
     c                   end
     C                   Z-add     ULINRS        FMLINR
     c                   update    dokufmr
     c                   move      fmlinr        fmlinrf           2 0
     c                   endif
     c                   enddo
      *
      *
     C*  DOKUFVF
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFVF        SETLL     DOKUFVF
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVFE       READE     DOKUFVF                                33
     C     *IN(33)       IFEQ      '0'
     c     fflinr        ifne      fflinrf
     c     fflinrf       andne     0
     c                   add       1             ULINRS
     c                   end
     c                   z-add     ULINRS        fflinr
     c                   update    dokufvfr
     c                   move      fflinr        fflinrf           2 0
     c                   endif
     c                   enddo
      *
     C*  DOKUFVG
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFVF        SETLL     DOKUFVG
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVFE       READE     DOKUFVG                                33
     C     *IN(33)       IFEQ      '0'
     c     fglinr        ifne      fglinrf
     c     fglinrf       andne     0
     c                   add       1             ULINRS
     c                   end
     c                   z-add     ULINRS        fglinr
     c                   update    dokufvgr
     c                   move      fglinr        fglinrf           2 0
     c                   add       1             ULINRS
     c                   endif
     c                   enddo
     C                   ENDSR                                                  <*IN11
     C*
     C***********************************************
     C     DELLIN        BEGSR
     C***********************************************
      * sletter ønsket linje nummer
      *
     C*  DOKUFV
     C     KEYFV         CHAIN     DOKUFV                             33
     c  N33              delete    dokufvr
      *
     C*  DOKUFM
     c                   setoff                                       33
     C     KEYFM         SETLL     DOKUFM
     C     *IN(33)       DOWEQ     '0'
     C     KEYFM         READE     DOKUFM                                 33
     C     *IN(33)       IFEQ      '0'
     c                   delete    dokufmr
     c                   endif
     c                   enddo
      *
      *
     C*  DOKUFVF
     c                   setoff                                       33
     C     KEYFVF        SETLL     DOKUFVF
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVF        READE     DOKUFVF                                33
     C     *IN(33)       IFEQ      '0'
     c                   update    dokufvfr
     c                   add       1             ULINRS
     c                   endif
     c                   enddo
      *
     C*  DOKUFVG
     c                   setoff                                       33
     C     KEYFVF        SETLL     DOKUFVG
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVF        READE     DOKUFVG                                33
     C     *IN(33)       IFEQ      '0'
     c                   update    dokufvgr
     c                   endif
     c                   enddo
     C                   ENDSR                                                  <*IN11
     C***********************************************
     C     DEL0          BEGSR
     C***********************************************
     C* SLETTER LINJER I DOKUFM/DOKUFVF SOM IKKE HAR TILHØRENDE DOKUFV
      *
      *
     C     KEYFVT1       KLIST
     C                   KFLD                    UFRI
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     C     KEYFVT2       KLIST
     C                   KFLD                    UFRI
     C                   KFLD                    FFAVD
     C                   KFLD                    FFOPD
     C                   KFLD                    FFFBNR
     C                   KFLD                    FFLINR
     C*  DOKUFM
     c                   setoff                                       33
     C     KEYFME        SETLL     DOKUFM
     C     *IN(33)       DOWEQ     '0'
     C     KEYFME        READE     DOKUFM                                 33
     C     *IN(33)       IFEQ      '0'
      * SJEKK OM I DOKUFV
     c     KEYFVT1       CHAIN(N)  DOKUFV                             34
     C   34              DELETE    DOKUFMR
     c                   endif
     c                   enddo
      *
      *
     C*  DOKUFVF
     c                   setoff                                       33
     C     KEYFVFE       SETLL     DOKUFVF
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVFE       READE     DOKUFVF                                33
     C     *IN(33)       IFEQ      '0'
     c     KEYFVT2       CHAIN(N)  DOKUFV                             34
     C   34              DELETE    DOKUFVFR
     c                   endif
     C                   ENDDO
     C                   ENDSR
