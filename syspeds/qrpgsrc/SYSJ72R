     FZILLOF    UF   E           K DISK
     FZLV1      UF A E           K DISK
     D A               S             17    DIM(9)                               BVMN
     D B               S              5P 0 DIM(9)                               BVNT
     D C               S             25    DIM(9)                               BVVS
     D D               S              9P 0 DIM(9)                               BVVKT
     D E               S              9P 3 DIM(9)                               BVM3
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
     C     *ENTRY        PLIST
     C                   PARM                    UNIK1             9 0
     C                   PARM                    UNIK2             9 0
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
      *_____________
      * Init av felt
      *"""""""""""""
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Flytt                                                SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR

      *_____________
      * Slett ZILLOF
      *"""""""""""""
     C     UNIK2         CHAIN     ZILLOF                             33
     C                   DELETE    BILLOFR
      *___________
      * Slett ZLV1
      *"""""""""""
     C     UNIK2         SETLL     ZLV1
     C     UNIK2         READE     ZLV1                                   33
     C     *IN33         DOWEQ     *OFF
     C                   Z-ADD     BLAVD         BVAVD
     C                   Z-ADD     BLOPD         BVOPD
     C                   DELETE    BLV1R
     C                   ADD       1             X                 1 0
     C                   MOVEL     BVMN          A(X)
     C                   Z-ADD     BVNT          B(X)
     C                   MOVEL     BVVS          C(X)
     C                   Z-ADD     BVVKT         D(X)
     C                   Z-ADD     BVM3          E(X)
     C     UNIK2         READE     ZLV1                                   33
     C  N33              ENDDO
      *______________________
      * Høyeste linjenummer ?
      *""""""""""""""""""""""
     C     UNIK1         SETLL     ZLV1
     C     UNIK1         READE     ZLV1                                   33
     C     *IN33         DOWEQ     *OFF
     C     UNIK1         READE     ZLV1                                   33
     C  N33              ENDDO
      *_____________
      * Legg in ZLV1
      *"""""""""""""
     C                   Z-ADD     0             X
     C                   DO        9             X
     C     A(X)          IFEQ      *BLANKS
     C                   GOTO      SRB9
     C                   ENDIF
     C                   ADD       1             BVLI
     C                   ADD       1             BVSORT
     C                   MOVEL     A(X)          BVMN
     C                   Z-ADD     B(X)          BVNT
     C                   MOVEL     C(X)          BVVS
     C                   Z-ADD     D(X)          BVVKT
     C                   Z-ADD     E(X)          BVM3
     C                   WRITE     BLV1R
     C                   ENDDO
     C     SRB9          ENDSR
