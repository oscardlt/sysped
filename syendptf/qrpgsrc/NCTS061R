********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12333 * 01 CB  PTF12 Set på *INLR
      *              Rename felter fra chain vedr. kontroll av duplikat mrn-nr.
12350 * 02 CB  PTF12 Syntaxkontroll av MRN-NR
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED EL.TRANSIT HOVED-OPPLYSNING***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05 06 08 09 11 13 16 18-26
      *** LEDIGE INDIKATORER 28 29 35 38-78
      ***        INDIKATOR   27 PÅ = SPØRRING                 ***
      ***        INDIKATOR   34 BRUKES FOR TVINN              ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
      *
     FFRATXT    IF   E           K DISK
     FSYPROD    IF   E           K DISK
     FNCTSIH    UF A E           K DISK
     FNCTSIH05  IF   E           K DISK    RENAME(NCTSIHR:NCTSIHR5)
N01  F                                     PREFIX(X_)
     FNCTSIV    IF A E           K DISK
     FNCTSISTD  UF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FEDIM1     UF   E           K DISK
     FEDIM4     IF   E           K DISK
     F                                     RENAME(EDIMR:EDIMR4)
     FKODTSI    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FNCTS061D  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRA                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  TIDTRA                 1      4  0
     D  TIDTRM                 5      6  0
     D  TIDTRD                 7      8  0
     D  TIDTR                  1      8  0
     D                 DS
     D  WSDTFD                 1      2  0
     D  WSDTFM                 3      4  0
     D  WSDTFA                 5      6  0
     D  WSDTF                  1      6  0
     D                 DS
     D  TIDTFA                 1      4  0
     D  TIDTFM                 5      6  0
     D  TIDTFD                 7      8  0
     D  TIDTF                  1      8  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAA                 5      6  0
     D  WSDTA                  1      6  0
     D                 DS
     D  TIDTAC                 1      2  0
     D  TIDTAA                 3      4  0
     D  TIDTAM                 5      6  0
     D  TIDTAD                 7      8  0
     D  TIDTA                  1      8  0
     D                 DS
     D  WSTMA                  1      4  0
     D  WSTMAH                 1      2  0
     D  WSTMAM                 3      4  0
     D                 DS
     D  TITMA                  1      6  0
     D  TITMAH                 1      2  0
     D  TITMAM                 3      4  0
     D  TITMAS                 5      6  0
     D                 DS
     D  XIDAGA                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  XIDAG2D                1      2  0
     D  XIDAG2M                3      4  0
     D  XIDAG2A                5      6  0
     D  XIDAG2                 1      6  0
     D                 DS
     D  WSGN                   1     35
     D  WSGN1                  1      4
     D  WSGN2                  5      9
     D  WSGN3                 10     12
     D  WSGN4                 13     15
      *
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  TIAVD                  1      4  0
     D  TITDN                  5     11  0
     D  UIN27                 12     12
     D  UIN34                 13     13
     D  UIN36                 14     14
     D  U1N07                 15     17
     D  UWS2                  18     27
     D  UPARM2                 1    128
      *
     C                   OPEN      NCTS061D
     C                   EXSR      INIT
     C     UTYPE         CABEQ     'DSP'         START1
      *...............................................
      * BILDE-1 INNLESING AV OPDNR./TARIFFØR OSV.
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C  N30
     CANN31              Z-ADD     10            LINNBR
     C  N30
     CAN 31              Z-ADD     9             LINNBR
     C  N30UTYPE         IFEQ      'CPY'
     C                   Z-ADD     13            LINNBR
     C                   END
     C  N30              Z-ADD     34            POSNBR
     C  N30WSSG          IFEQ      *BLANKS
     C                   Z-ADD     9             LINNBR
     C                   END
     C                   EXFMT     NC061D01
     C                   MOVEA     '00'          *IN(98)
     C                   SETOFF                                       3095
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START
     C                   END
     C   12              GOTO      SLUTT
      *
     C     START1        TAG
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C   04UFLAGG        CABEQ     1             START
      *
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *ZEROS        TITDN
     C                   END
      *===============================================
      *
      *...............................................
      * BILDE-2 INNLESING AV HOVED OPPLYSNINGER AV SAD
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START2        TAG
     C  N30              Z-ADD     3             LINNBR
     C  N30              IF        WSGN2 = *BLANKS OR WSGN4 <> *BLANKS
     C  N30              Z-ADD     13            POSNBR
     C                   END
     C     ST21          TAG
      *
     C                   EXSR      TSTOPL
      *
     C                   EXFMT     NC061D02
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '00000000000' *IN(77)
     C                   SETOFF                                       30
      *
      *  04 = SØK AVSENDER/MOTTAKER/HOVEDANSVARLIG
     C   04              DO
     C                   EXSR      SOKDT2
     C                   GOTO      ST21
     C                   END
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START2
     C                   END
      *
      *  10 = SE OPPLYSNIGER OM GODKJENNELSE FRA TOLLVESENET (KUN KOMMUNIKASJON)
     C   10              DO
     C                   EXSR      VISTOL
     C                   GOTO      START2
     C                   END
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL TR061D01
     C   12              DO
     C     UTYPE         IFNE      'DSP'
     C     NCTSIHK       CHAIN     NCTSIH                             33
     C                   MOVE      ' '           TIST
     C  N33              UPDATE    NCTSIHR
     C                   END
     C     UTYPE         IFEQ      'CR2'
     C                   MOVE      *ZEROS        WSTDN
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      SLUTT
     C                   END
     C                   END
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START2
     C                   END
      *
     C     UTYPE         IFEQ      'DSP'
     C                   GOTO      START3
     C                   END
      *
      * ----------- T E S T   B I L D E 0 2 ----------
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      *
      * ----- INGEN FEIL HITTIL     OPPDATER TRUH -----
     C                   EXSR      OPDNCTS
      *
      *===============================================
      *
     C     START3        TAG
     C                   EXSR      TOTRV
     C   12              GOTO      START2
     C     UTYPE         IFEQ      'CR2'
     C     *IN17         OREQ      '1'
     C                   MOVE      *ZEROS        WSTDN
     C  N03              DO
     C                   MOVE      *ZEROS        TITDN
     C                   MOVE      *BLANKS       WSTRNR
     C                   MOVE      *BLANKS       WSGN
     C                   GOTO      START2
     C                   END
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     *IN12         IFEQ      '1'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     0             UFLAGG
     C                   END
     C                   CLOSE     NCTS061D
N01  C                   EVAL      *INLR=*ON
     C                   RETURN
      *
     C***********************************************
     C     SOKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * GODSREGISTRERING
     C     LINNBR        IFEQ      3
     C     LINNBR        OREQ      4
     C     POSNBR        IFLT      47
     C                   MOVEL     'SYGODS  '    PRODNA           15
     C     PRODNA        CHAIN     SYPROD                             33
     C  N33PRINST        IFEQ      'J'
     C                   MOVE      'P'           UPLUKK            1
     C                   MOVEL     WSGN          XXXGN            15
     C                   MOVEL     *BLANKS       XXXMOT           15
     C                   MOVEL     WSTRNR        XXXMRN           18
     C                   CALL      'SYTL01CL'
     C                   PARM                    UPLUKK
     C                   PARM                    XXXGN
     C                   PARM                    XXXMOT
     C                   PARM                    XXXMRN
     C     XXXGN         IFNE      *BLANKS
     C                   MOVEL     XXXGN         WSGN
     C                   MOVEL     XXXMRN        WSTRNR
     C     WSTRNR        IFEQ      *blanks
     C                   Z-ADD     4             LINNBR
     C                   ELSE
     C                   Z-ADD     5             LINNBR
     C                   ENDIF
     C                   Z-ADD     13            POSNBR
     C                   END
     C                   GOTO      SLSOK
     C                   END
     C                   END
     C                   END
      * Forenklet prosedyre
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     13
     C                   MOVE      '027'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSSPR         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSPR
     C                   Z-ADD     43            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Hendelses flagg
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     43
     C     POSNBR        ANDLE     43
     C                   MOVE      '027'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSIFLG        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSIFLG
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Autorisasjonstype
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     31
     C                   MOVE      '236'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSATYP        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSATYP
     C                   Z-ADD     38            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Destinasjons tollsted
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      '106'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSTSBA        UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSBA
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Trader
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNTA
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Språkkode
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKTA        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSKTA
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Lokasjonstype
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     13
     C                   MOVE      '347'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSLCTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLCTY
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Qualifier of identification
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     23
     C                   MOVE      '326'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSQID         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSQID
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * UN LOCODE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     39
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSD          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSD
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Tollsted
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTS          UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTS
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Trader
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNE
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Landkode til økonomi operatør
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKE
     C                   PARM                    USPED
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Landkode til økonomi operatør (postadresse)
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     50
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKE2
     C                   PARM                    USPED
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSOK         ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *** TEST AVDELING
     C     UAVD          CHAIN(N)  NCTSISTD                           95
     C  N95              DO
     C                   MOVE      *BLANKS       TIST
     C                   MOVE      *ZEROS        TITDN
     C                   END
     C   95              DO
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTB1
     C                   END
      *** TEST TARIFFØR
     C     KODSIK        CHAIN     KOSIR                              99
     C   99              DO
     C                   MOVE      'SPS0001'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END
      *
      *** TEST OM TASTET TOLLDEKNR. ER RIKTIG
      * WSTDN = 0  --> HENT STANDARD SAD-OPPLYSNINGER
     C     UTYPE         IFEQ      'CPY'                                        1<-B
     C     NCTSIHKK      CHAIN(N)  NCTSIH                             33
     C                   ELSE                                                   1
     C     WSTDN         IFNE      0                                             2<-B
     C     NCTSIHK       CHAIN     NCTSIH                             33
     C  N33UTYPE         IFEQ      'DSP'                                          3<-B
     C                   UPDATE    NCTSIHR
     C                   GOTO      STTB1
     C                   END                                                      3<-E
      * TIST = ' ' --> ÅPEN TRANSITTERING
      *        'A' --> HOLD PÅ Å SENDE UT
      *        'B' --> SENDT TIL IBM
      *        'C' --> SENDT TIL TOLLVESENET
      *        'E' --> HOLD PÅ Å BLI ENDRET
      *        'M' --> FEILMELDING FRA TOLLVESENET
      *        'P' --> TRANSITTERING AVSLUTTET
      *        'K' --> VENT PÅ Å BLI UTSKREVET
      *        'Q' --> I UTGÅENDE POSTKASSE
      *        'U' --> HAR FÅTT LOSSETILLATELSE
     C  N33TIST          IFNE      ' '                                            3<-B
     C     TIST          ANDNE     'M'
     C     TIST          COMP      'P'                                9898
     C   98TIST          COMP      'Q'                                9898
     C                   END                                                      3<-E
     C  N33
     CANN98TIST          IFEQ      'A'                                            3<-B
     C     TIWS          COMP      UWS                                9898
     C                   END                                                      3<-E
      *
     C  N33
     CANN98              DO                                                       3<-B
     C                   EXSR      TSTM
     C   98              UPDATE    NCTSIHR
     C   98              GOTO      SLTB1
     C                   END                                                      3<-E
     C  N33
     CANN98              MOVE      'E'           TIST
     C  N33              UPDATE    NCTSIHR
      *
     C   98              DO                                                       3<-B
     C                   MOVE      'SPT0028'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * TEST OM DET SKAL SENDES PÅ TVINN  (34 ON = DENNE SENDES TVINN)
     C     WSTOLK        COMP      'J'                                    34
      *
     C  N30
     CAN 33              MOVE      WSTDN         UTDN
      *
      *** FLYTT DATA FRA FIL-VARIABLER TIL WS-VARIABLER
     C     STTB1         TAG
     C  N30              EXSR      MOVW2
      *
     C     SLTB1         ENDSR
      *
      ***********************************************
     C     TSTM          BEGSR
      ***********************************************
      *
      * Test om det finnes sending i "postkasse"
     C     TVINMK        SETGT     EDIM1
     C     STTSTM        TAG
     C     TVINMK        READPE    EDIM1                                  98
     C  N98MSR           IFEQ      'S'
     C     M1001         ANDEQ     'TEI'
     C     M1N07         ANDEQ     '007'
     C   10              DELETE    EDIMR
     C   10              GOTO      SLTSTM
     C                   UPDATE    EDIMR
     C                   MOVE      'SPT0043'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   ELSE
     C                   UPDATE    EDIMR
     C                   GOTO      STTSTM
     C                   END
      *
      * Test om det har fått "lossetillatelse"/"transittering avslutt"
     C     TVIM4K        SETLL     EDIM4                              98
     C     STTST2        TAG
     C     TVI41K        READPE    EDIM4                                  98
     C  N98MST           IFEQ      'D'
     C     M1001         ORNE      'TEI'
     C                   GOTO      STTST2
     C                   ELSE
     C     M1N07         IFEQ      '043'
     C     M1N07         OREQ      '025'
     C     M1N07         OREQ      '057'
     C     M1225         ANDEQ     '044'
     C     M1225         OREQ      '044'
     C     M1N07         ANDEQ     '999'
     C                   MOVE      'YBC1762'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   END
     C                   END
     C                   MOVE      '0'           *IN98
      *
     C     SLTSTM        ENDSR
      *
      ***********************************************
     C     TESTB2        BEGSR
      ***********************************************
     C     WSGN          COMP      *BLANKS                                99
     C   99              MOVE      'YBC1764'     MSGNR
     C   99              SETON                                        30
      *
     C     WSTRNR        COMP      *BLANKS                                98
     C  N98              MOVEL     WSTRNR        XAN01             1
     C  N98XAN01         IFLT      '0'
     C     XAN01         ORGT      '9'
     C                   MOVE      *ON           *IN99
     C                   END
     C
     C  N98WSTRNR        CHAIN     NCTSIH05                           33
     C  N98
     CANN33WSTDN         IFEQ      0
     C     WSTDN         ORNE      TITDN
     C                   MOVE      '1'           *IN98
     C                   END
     C  N98              MOVE      WSTRNR        XAN01             1
     C  N98XAN01         COMP      *BLANKS                                98
     C* N98              EVAL      XAN01 = %SUBST(WSTRNR:17:1)
     C* N98              IF        XAN01 <> 'J' AND XAN01 <> 'K' AND
     C*                            XAN01 <> 'L' AND XAN01 <> 'M'
     C*                  EVAL      *IN98 = *ON
     C*                  END
     C   98
     CANN30              MOVE      'YBC1763'     MSGNR
     C   98              SETON                                        30
N02   * test syntax på MRN-nr
N02  C                   IF        *IN30=*OFF
N02  C                   IF        *IN98=*OFF
N02  C                   IF        WSTRNR <> *BLANKS
N02  C                   CALL      'NCTSMRNCHK'
N02  C                   PARM                    WSTRNR
N02  C                   PARM                    UOK               1
N02  C                   IF        UOK='N'
N02  C                   EVAL      *IN30=*ON
N02  C                   EVAL      *IN98=*ON
N02  C                   MOVE      'CBA0500'     MSGNR
N02  C                   Z-ADD     4             LINNBR
N02  C                   Z-ADD     13            POSNBR
N02  C                   ENDIF
N02  C                   ENDIF
N02  C                   ENDIF
N02  C                   ENDIF
      * TEST ANKOMSTDATO
     C                   CALL      'TESTDATO'
     C                   PARM      WSDTAD        UDD               2 0
     C                   PARM      WSDTAM        UMM               2 0
     C                   PARM      WSDTAA        UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      97
     C                   IF        *IN97 = *OFF
     C                   EVAL      TIDTAC = 20
     C                   EVAL      TIDTAA = WSDTAA
     C                   EVAL      TIDTAM = WSDTAM
     C                   EVAL      TIDTAD = WSDTAD
      * ANKOMSTDATO KAN IKKE VÆRE SENERE ENN DAGENSDATO
     C     TIDTA         COMP      XIDAG                              97
     C                   END
     C   97
     CANN30              MOVE      'SPD0001'     MSGNR
     C   97              EVAL      *IN30 = *ON
      * TEST ANKOMSTTID
     C                   IF        WSTMAH > 23 OR WSTMAM > 59
     C                   EVAL      *IN96 = *ON
     C  N30              MOVE      'YBC2230'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
      * TEST AUTORISASJONSTYPE
     C     WSATYP        IFNE      *BLANKS
     C     WSSPR         OREQ      1
     C                   MOVE      '236'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSATYP        YKODE
     C     TRK01K        CHAIN     TRKODL01                           95
     C   95
     CANN30              MOVE      'YBC2221'     MSGNR
     C   95              SETON                                        30
     C                   END
      * TEST PÅ AUTORISASJONSREFERENSENR
     C     WSSPR         IFEQ      1
     C     WSAREF        COMP      *BLANKS                                94
     C   94
     CANN30              MOVE      'YBC2231'     MSGNR
     C   94              SETON                                        30
     C                   END
      *
      * TEST PÅ COTROLL TOLLSTED
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSBA        YKODE
     C     TRK01K        CHAIN     TRKODL01                           93
     C   93
     CANN30              MOVE      'YBC0811'     MSGNR
     C   93              SETON                                        30
      * Test trader
     C     WSKNTA        IFNE      0                                            1<-B
     C                   MOVE      WSKNTA        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            92
     C     *IN92         IFEQ      '1'                                           2<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE                                                    2
     C                   IF        WSTINTA = *BLANKS                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINTA = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINTA = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINTA = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNATA = KNAVN
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * Test org.nr til trader
     C     WSTINTA       IFEQ      *BLANKS
     C                   EVAL      *IN91 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'YBC2222'     MSGNR
     C                   END
      *
     C     WSSKTA        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKTA        YKODE
     C     TRK01K        CHAIN     TRKODL01                           90
     C   90
     CANN30              MOVE      'YBC0810'     MSGNR
     C   90              SETON                                        30
     C                   END
      *
     C                   MOVE      '347'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLCTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           89
     C   89
     CANN30              MOVE      'YBC2223'     MSGNR
     C   89              SETON                                        30
      *
     C                   MOVE      '326'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSQID         YKODE
     C     TRK01K        CHAIN     TRKODL01                           88
     C   88
     CANN30              MOVE      'YBC2224'     MSGNR
     C   88              SETON                                        30
      *
     C     WSKNE         IFNE      0                                            1<-B
     C                   MOVE      WSKNE         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            84
     C     *IN84         IFEQ      '1'                                           2<-B
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE                                                    2
     C                   IF        WSTINE = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINE = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINE = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINE = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
      *
     C                   EVAL      WSADE1 = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNE  = *BLANKS
     C                   MOVEL     POSTNR        WSPNE
     C                   ELSE                                                     3
     C                   EVAL      WSPNE  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSE  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKE  = SYLAND
     C                   END                                                      3<-E
     C                   IF        WSCPE = *BLANKS                                3<-B
     C                   EVAL      WSCPE  = KPERS
     C                   END                                                      3<-E
     C                   IF        WSTLE = *BLANKS                                3<-B
     C                   EVAL      WSTLE  = TLF
     C                   END                                                      3<-E
     C                   IF        WSEME = *BLANKS                                3<-B
     C                   EVAL      WSEME  = SYEPOS
     C                   END                                                      3<-E
      *
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   SELECT                                                 1<-B
     C                   WHEN      WSQID = 'Y'                                  1
     C     WSANR         COMP      *BLANKS                                87
     C   87
     CANN30              MOVE      'YBC2232'     MSGNR
     C   87              SETON                                        30
      *
     C                   WHEN      WSQID = 'U'                                  1
     C                   MOVE      '244'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSD          YKODE
     C     TRK01K        CHAIN     TRKODL01                           86
     C   86
     CANN30              MOVE      'YBC2225'     MSGNR
     C   86              SETON                                        30
      *
     C                   WHEN      WSQID = 'V'                                  1
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTS          YKODE
     C     TRK01K        CHAIN     TRKODL01                           85
     C   85
     CANN30              MOVE      'YBC0810'     MSGNR
     C   85              SETON                                        30
      * Økonomi operatør
     C                   WHEN      WSQID = 'X'                                  1
     C     WSTINE        IFEQ      *BLANKS                                       2<-B
     C                   EVAL      *IN83 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'YBC2226'     MSGNR
     C                   END
      *                                                                          2<-E
     C                   WHEN      WSQID = 'Z'                                  1
     C     WSADE1        IFEQ      *BLANKS                                       2<-B
     C                   EVAL      *IN82 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'YBC2227'     MSGNR
     C                   END                                                     2<-E
      *
     C     WSPNE         IFEQ      *BLANKS                                       2<-B
     C                   EVAL      *IN81 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'YBC2228'     MSGNR
     C                   END                                                     2<-E
      *
     C     WSPSE         IFEQ      *BLANKS                                       2<-B
     C                   EVAL      *IN80 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'YBC2229'     MSGNR
     C                   END                                                     2<-E
      *
     C                   MOVE      WSLKE         KS2LK
     C     KODS2K        CHAIN     KODTS2                             79
     C   79
     CANN30              MOVE      'SPL0001'     MSGNR
     C   79              SETON                                        30
      *
     C                   WHEN      WSQID = 'T'                                  1
     C     WSADE2        IFEQ      *BLANKS                                       2<-B
     C                   EVAL      *IN78 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'YBC2227'     MSGNR
     C                   END                                                     2<-E
      *
     C     WSLKE2        IFNE      *BLANKS                                       2<-B
     C                   MOVE      WSLKE2        KS2LK
     C     KODS2K        CHAIN     KODTS2                             78
     C   77
     CANN30              MOVE      'SPL0001'     MSGNR
     C   77              SETON                                        30
     C                   END                                                     2<-E
      *
     C                   WHEN      WSQID = 'W'                                  1
      *
     C                   ENDSL                                                  1<-E
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETCUR        BEGSR
      ***********************************************
     C   77              Z-ADD     16            LINNBR
     C   77              Z-ADD     49            POSNBR
     C   78              Z-ADD     16            LINNBR
     C   78              Z-ADD     13            POSNBR
     C   79              Z-ADD     15            LINNBR
     C   79              Z-ADD     56            POSNBR
     C   80              Z-ADD     15            LINNBR
     C   80              Z-ADD     31            POSNBR
     C   81              Z-ADD     15            LINNBR
     C   81              Z-ADD     13            POSNBR
     C   82              Z-ADD     14            LINNBR
     C   82              Z-ADD     13            POSNBR
     C   83              Z-ADD     13            LINNBR
     C   83              Z-ADD     22            POSNBR
     C   84              Z-ADD     13            LINNBR
     C   84              Z-ADD     13            POSNBR
     C   85              Z-ADD     12            LINNBR
     C   85              Z-ADD     13            POSNBR
     C   86              Z-ADD     11            LINNBR
     C   86              Z-ADD     23            POSNBR
     C   87              Z-ADD     10            LINNBR
     C   87              Z-ADD     39            POSNBR
     C   88              Z-ADD     10            LINNBR
     C   88              Z-ADD     23            POSNBR
     C   89              Z-ADD     10            LINNBR
     C   89              Z-ADD     13            POSNBR
     C   90              Z-ADD     8             LINNBR
     C   90              Z-ADD     77            POSNBR
     C   91              Z-ADD     8             LINNBR
     C   91              Z-ADD     83            POSNBR
     C   92              Z-ADD     8             LINNBR
     C   92              Z-ADD     13            POSNBR
     C   93              Z-ADD     7             LINNBR
     C   93              Z-ADD     13            POSNBR
     C   94              Z-ADD     6             LINNBR
     C   94              Z-ADD     38            POSNBR
     C   95              Z-ADD     6             LINNBR
     C   95              Z-ADD     28            POSNBR
     C   96              Z-ADD     4             LINNBR
     C   96              Z-ADD     70            POSNBR
     C   97              Z-ADD     4             LINNBR
     C   97              Z-ADD     63            POSNBR
     C   98              Z-ADD     4             LINNBR
     C   98              Z-ADD     13            POSNBR
     C   99              Z-ADD     3             LINNBR
     C   99              Z-ADD     13            POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVW2         BEGSR
      ***********************************************
     C                   MOVE      TITDN         WSTDN
     C     KODSIK        CHAIN     KOSIR                              33
     C                   MOVE      KSINAV        WSTARF
     C                   MOVE      TITRNR        WSTRNR
     C                   MOVE      TIGN          WSGN
     C                   IF        WSGN2 <> *BLANKS AND WSGN3 = *BLANKS
      * HENT DAGNR
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM
     C                   MOVE      WDT           XIDAG
     C                   MOVE      XIDAGA        XIDAG2A
     C                   MOVE      XIDAGM        XIDAG2M
     C                   MOVE      XIDAGD        XIDAG2D
     C                   MOVE      XIDAG2        UDATO             6
     C                   CALL      'SYGE25CL'
     C                   PARM                    UDATO
     C                   PARM                    UDAGPA            3
     C                   MOVE      XIDAGA        WSGN1
     C                   MOVE      UDAGPA        WSGN3
     C                   Z-ADD     25            POSNBR
     C                   END
     C                   IF        TIDTA = 0 OR TIDTA = 20000000
     C                   MOVE      WDT           TIDTA
     C                   END
     C                   MOVE      TIDTAD        WSDTAD
     C                   MOVE      TIDTAM        WSDTAM
     C                   MOVE      TIDTAA        WSDTAA
     C                   MOVE      TITMAH        WSTMAH
     C                   MOVE      TITMAM        WSTMAM
     C                   MOVE      TISPR         WSSPR
     C                   MOVE      TIIFLG        WSIFLG
     C                   MOVE      TIATYP        WSATYP
     C                   MOVE      TIAREF        WSAREF
     C                   MOVE      TITSBA        WSTSBA
     C                   MOVE      TIKNTA        WSKNTA
     C                   MOVE      TINATA        WSNATA
     C                   MOVE      TITINTA       WSTINTA
     C                   MOVE      TISKTA        WSSKTA
     C                   MOVE      TILCTY        WSLCTY
     C                   MOVE      TIQID         WSQID
     C                   MOVE      TIANR         WSANR
     C                   MOVE      TIAID         WSAID
     C                   MOVE      TISD          WSSD
     C                   MOVE      TITS          WSTS
     C                   MOVE      TIKNE         WSKNE
     C                   MOVE      TITINE        WSTINE
     C                   MOVE      TIADE1        WSADE1
     C                   MOVE      TIPNE         WSPNE
     C                   MOVE      TIPSE         WSPSE
     C                   MOVE      TILKE         WSLKE
     C                   MOVE      TIADE2        WSADE2
     C                   MOVE      TIPNE2        WSPNE2
     C                   MOVE      TILKE2        WSLKE2
     C                   MOVE      TICPE         WSCPE
     C                   MOVE      TITLE         WSTLE
     C                   MOVE      TIEME         WSEME
     C*                    MOVE TIWS      WSWS
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVNCTS       BEGSR
      ***********************************************
     C                   MOVE      UAVD          TIAVD
     C                   MOVE      WSTDN         TITDN
     C                   MOVE      WSSG          TISG
     C                   MOVE      WSDTAD        TIDTAD
     C                   MOVE      WSDTAM        TIDTAM
     C                   MOVE      WSDTAA        TIDTAA
     C                   MOVE      20            TIDTAC
     C                   MOVE      WSTMAH        TITMAH
     C                   MOVE      WSTMAM        TITMAM
     C                   MOVE      *ZEROS        TITMAS
     C                   MOVE      WSTRNR        TITRNR
     C                   MOVE      WSGN          TIGN
     C                   MOVE      WSSPR         TISPR
     C                   MOVE      WSIFLG        TIIFLG
     C                   MOVE      WSATYP        TIATYP
     C                   MOVE      WSAREF        TIAREF
     C                   MOVE      WSTSBA        TITSBA
     C                   MOVE      WSKNTA        TIKNTA
     C                   MOVE      WSNATA        TINATA
     C                   MOVE      WSTINTA       TITINTA
     C                   MOVE      WSSKTA        TISKTA
     C                   MOVE      WSLCTY        TILCTY
     C                   MOVE      WSQID         TIQID
     C                   MOVE      WSANR         TIANR
     C                   MOVE      WSAID         TIAID
     C                   MOVE      WSSD          TISD
     C                   MOVE      WSTS          TITS
     C                   MOVE      WSKNE         TIKNE
     C                   MOVE      WSTINE        TITINE
     C                   MOVE      WSADE1        TIADE1
     C                   MOVE      WSPNE         TIPNE
     C                   MOVE      WSPSE         TIPSE
     C                   MOVE      WSLKE         TILKE
     C                   MOVE      WSADE2        TIADE2
     C                   MOVE      WSPNE2        TIPNE2
     C                   MOVE      WSLKE2        TILKE2
     C                   MOVE      WSCPE         TICPE
     C                   MOVE      WSTLE         TITLE
     C                   MOVE      WSEME         TIEME
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVNCTS2      BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       TIDK
     C                   MOVE      *ZEROS        TIDTG
     C                   MOVE      *ZEROS        TISECU
     C                   MOVE      *ZEROS        TIRDIN
     C                   MOVE      *BLANKS       TITSB
     C                   MOVE      *BLANKS       TITINH
     C                   MOVE      *BLANKS       TITIRH
     C                   MOVE      *BLANKS       TINAH
     C                   MOVE      *BLANKS       TIAD1H
     C                   MOVE      *BLANKS       TIPNH
     C                   MOVE      *BLANKS       TIPSH
     C                   MOVE      *BLANKS       TILKH
     C                   MOVE      *BLANKS       TITINT
     C                   MOVE      *ZEROS        TISTLO
     C                   MOVE      *BLANKS       TIBLK
     C                   MOVE      *ZEROS        TIKDC
     C                   MOVE      *BLANKS       TITMIN
     C                   MOVE      *ZEROS        TIVKB
     C                   MOVE      *BLANKS       TITINS
     C                   MOVE      *BLANKS       TINAS
     C                   MOVE      *BLANKS       TIAD1S
     C                   MOVE      *BLANKS       TIPNS
     C                   MOVE      *BLANKS       TIPSS
     C                   MOVE      *BLANKS       TILKS
     C                   MOVE      *BLANKS       TITINK
     C                   MOVE      *BLANKS       TINAK
     C                   MOVE      *BLANKS       TIAD1K
     C                   MOVE      *BLANKS       TIPNK
     C                   MOVE      *BLANKS       TIPSK
     C                   MOVE      *BLANKS       TILKK
     C                   MOVE      *BLANKS       TICNR
     C                   MOVE      *ZEROS        TIDANT
     C                   MOVE      *BLANKS       TIDFKD
     C                   MOVE      *ZEROS        TIGINR
     C                   MOVE      *ZEROS        TITRM
     C                   MOVE      *BLANKS       TITAID
     C                   MOVE      *BLANKS       TITALK
     C                   MOVE      *BLANKS       TIPDTY
     C                   MOVE      *BLANKS       TIPDRF
     C                   MOVE      *BLANKS       TIPDIN
     C                   MOVE      *BLANKS       TISDTY
     C                   MOVE      *BLANKS       TISDRF
     C                   MOVE      *BLANKS       TISDIN
     C                   MOVE      *BLANKS       TITDTY
     C                   MOVE      *BLANKS       TITDRF
     C                   MOVE      *BLANKS       TIADTY
     C                   MOVE      *BLANKS       TIADRF
     C                   MOVE      *BLANKS       TIAICD
     C                   MOVE      *BLANKS       TIAITX
      *
     C                   MOVE      *ZEROS        NIVKB
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDNCTS       BEGSR
      ***********************************************
     C     WSTDN         IFEQ      0
     C     UAVD          CHAIN     NCTSISTD                           33
     C                   MOVE      TITDN         WSTDN
     C                   ADD       1             TITDN
     C                   UPDATE    NCTSISTDR
     C                   END
      *
     C     NCTSIHK       CHAIN     NCTSIH                             33
     C                   EXSR      MOVNCTS
      *
     C                   MOVE      'E'           TIST
     C   33              DO
     C                   MOVE      UAVD          TIAVD
     C                   MOVE      WSTDN         TITDN
     C                   MOVE      WSSG          TISG
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           TIDTR
     C                   MOVE      TIDTRD        WSDTRD
     C                   MOVE      TIDTRM        WSDTRM
     C                   MOVE      TIDTRA        WSDTRA
     C                   MOVE      *ZEROS        TIDTF
     C                   EXSR      MOVNCTS2
     C     UTYPE         IFEQ      'CPY'
     C     KAVD          ANDNE     0
     C                   EXSR      CPYNCTSV
     C                   MOVE      *ZEROS        KAVD
     C                   END
     C                   WRITE     NCTSIHR
      *
     C                   END
     C  N33              UPDATE    NCTSIHR
      *
     C                   ENDSR
      *
      ***********************************************
     C     CPYNCTSV      BEGSR
      ***********************************************
     C     NCTSIHKK      SETLL     NCTSIV
     C     NCTSIHKK      READE     NCTSIV                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      TIAVD         TVAVD
     C                   MOVE      TITDN         TVTDN
     C                   WRITE     NCTSIVR
     C     NCTSIHKK      READE     NCTSIV                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     TOTRV         BEGSR
      ***********************************************
      *
     C                   MOVE      *IN34         UIN34
     C                   MOVE      *IN27         UIN27
     C                   CALL      'NCTS062R'
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      2                                      17
     C     UFLAGG        COMP      3                                      03
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISTOL        BEGSR
      ***********************************************
      *________________________
      * Call på eksternt CL-pgm
      *""""""""""""""""""""""""
     C                   MOVE      '3'           WIN03             1
     C                   CALL      'SAD003'
     C                   PARM      TIAVD         UAVD
     C                   PARM      TITDN         UTDN
     C                   PARM                    WIN03
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYI            1
     C                   MOVE      'M'           DELSYI
     C     FRAT2K        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYB            1
     C     NCTSIHK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     NCTSIHKK      KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KTDN
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODSIK        KLIST
     C                   KFLD                    XSIUNI
     C                   KFLD                    WSSG
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    KS2LK
     C     TVINMK        KLIST
     C                   KFLD                    YST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     TVIM4K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C                   KFLD                    MAX0D
     C     TVI41K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
      *
     C     *LIKE         DEFINE    TITDN         UTDN
     C     *LIKE         DEFINE    TISG          USG
     C     *LIKE         DEFINE    TIWS          UWS
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C     WSTDN         PARM      WSTDN         UTDN
     C     WSSG          PARM                    USG
     C                   PARM                    UTYPE             3
     C     UWS2          PARM      UWS2          UWS
     C                   PARM                    UFLAGG            1 0
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
      *
     C                   MOVE      *ZEROS        TIAVD
     C                   MOVE      *ZEROS        TITDN
     C                   MOVE      '0'           UIN27
     C                   MOVE      '0'           UIN34
     C                   MOVE      *BLANKS       U1N07
     C                   MOVE      *BLANKS       UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
      *
     C     UTYPE         COMP      'DSP'                                  27
     C     UTYPE         COMP      'CHG'                                  31
     C     UTYPE         COMP      'CHG'                                  32
     C  N32UTYPE         COMP      'CPY'                                  32
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          KAVD              4 0
     C                   MOVE      WSTDN         KTDN              7 0
     C                   MOVE      *ZEROS        WSTDN
     C                   END
      *
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        KUNDNR            8 0
     C                   MOVE      'SI'          XSIUNI            2
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      ' '           YST               1
     C                   MOVE      '99999999'    MAX0B             8 0
     C                   MOVE      '999999'      MAX0C             6 0
     C                   MOVE      '99'          MAX0D             2 0
     C                   MOVE      'R'           XSR1              1
     C                   MOVE      'N'           USPED             1
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        TIDTR
     C                   MOVE      *ZEROS        WSDTF
     C                   MOVE      *ZEROS        TIDTF
      *
     C                   Z-ADD     1             SOANTK            1 0
     C                   MOVE      'TRADER  '    SOTXT1            8
     C                   MOVE      *BLANKS       SOTXT2            8
     C                   MOVE      *BLANKS       SOTXT3            8
     C                   MOVE      *BLANKS       SOTXT4            8
     C                   MOVE      *BLANKS       SOTXT5            8
     C                   MOVE      *BLANKS       SOTXT6            8
     C                   MOVE      *BLANKS       SOTXT7            8
     C                   MOVE      *BLANKS       SOTXT8            8
     C                   MOVE      *ZEROS        SOKNR2            8 0
     C                   MOVE      *ZEROS        SOKNR3            8 0
     C                   MOVE      *ZEROS        SOKNR4            8 0
     C                   MOVE      *ZEROS        SOKNR5            8 0
     C                   MOVE      *ZEROS        SOKNR6            8 0
     C                   MOVE      *ZEROS        SOKNR7            8 0
     C                   MOVE      *ZEROS        SOKNR8            8 0
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     UAVD          CHAIN(N)  NCTSISTD                           33
      *
     C                   MOVE      'J'           WSTOLK
     C*                  MOVE      TIENKL        WSENKL
     C                   MOVE      *IN36         UIN36
      *
     C                   ENDSR
      *
      *
      ***********************************************
     C     VISOPL        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * TRADER
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C     WSKNTA        ANDGT     0
     C                   MOVE      WSKNTA        XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
      *
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR            8 0
     C                   PARM                    XSKMOT            8
     C                   PARM                    UFLAGG
     C                   PARM                    DELSYI
      *
     C     SLVISO        ENDSR
      *
      ***********************************************
     C     TSTOPL        BEGSR
      ***********************************************
     C                   MOVE      '0'           *IN37
      *** TEST OM NÆRINGSLIV OPPLYSNING. HVIS DET, SETT 37 PÅ
     C                   MOVE      WSKNTA        FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        37
      *
     C                   ENDSR
      *
