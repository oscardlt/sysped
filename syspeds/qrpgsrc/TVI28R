********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 PRINTERSTYRING BRUKERNIVÅ
********************************************************************
N01  FKODTPUSR  IF   E           K DISK
     FKODTP     IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FSADH      IF   E           K DISK
     FSAEH      IF   E           K DISK
     FEDIM      IF   E           K DISK
     FTVINF     IF   E           K DISK
     FTVINME    O    E             PRINTER OFLIND(*IN51)
     F                                     USROPN
     D UCMD            DS          1024
     D                 DS
     D XCMD01          C                   CONST('OVRPRTF -
     D                                     FILE(TVINME) -
     D                                     OUTQ(')
     D XCMD02          C                   CONST('PAGESIZE(72 80) -
     D                                     CPI(10) -
     D                                     OVRFLW(66)')
     D                 DS
     D  SISG                   1      3
     D  SESG                   1      3
     D                 DS
     D  SIFT4                  1     45
     D  SIFT4A                 1      6
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRINIT
     C                   EXSR      SRHOVE
     C                   SETON                                        LR
      *
      *
      *////////////////////////////////////////////////////////////
      *  Initiering                                        SRINIT /
      *////////////////////////////////////////////////////////////
     C     SRINIT        BEGSR
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UTYPE             4
     C                   PARM                    UMN               9 0
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     FRIKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    WSKODE
s01  C*                  move      '*CR'         WSKODE            3
     C     KEYSH         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     KEYTF         KLIST
     C                   KFLD                    UMN
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI
N01  C     KODKEYU1      KLIST
N01  C                   KFLD                    SISG
N01  C                   KFLD                    KOPLNR
     C     UTYPE         IFEQ      'SADI'
     C                   Z-ADD     87            KOPLNR
N01  C                   move      '*CR'         WSKODE            3
     C     KEYSH         CHAIN     SADH                               33
     C                   ELSE
     C                   Z-ADD     97            KOPLNR
N01  C                   move      '*CE'         WSKODE            3
     C     KEYSH         CHAIN     SAEH                               33
     C                   END
     C                   MOVE      *BLANKS       FSSOK
     C     FRIKEY        CHAIN     FRISOK                             33
     C     KEYTF         CHAIN     EDIM                               33
      *___________________
      * Initiere faste nøkkelfelt
      *_________________
     C                   MOVE      '0'           *IN38
N01  C     KODKEYU1      CHAIN     KODTPUSR                           33
S01  C*    KODTPK        CHAIN     KOPR                               33
n01  C   33KODTPK        CHAIN     KOPR                               33
     C  N33KOPFM         IFNE      *BLANKS
     C     KOPFM         SETLL     KODTFM
     C     KOPFM         READE     KODTFM                                 33
     C                   END
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     XCMD01        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD02:1      UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Skriv ut melding                                  SRHOVE /
      *////////////////////////////////////////////////////////////
     C     SRHOVE        BEGSR
      * SAD IMPORT- MELDING OM FORHÅNDSFORTOLLING ENTEN PÅ PRINT ELLER SMS
     C     UTYPE         IFEQ      'SADI'
     C     SIFT4A        IFEQ      'FORH:J'
     C     SIFT4A        OREQ      'Forh:J'
     C     SIFT4A        OREQ      'FORH:B'
     C     SIFT4A        OREQ      'Forh:B'
     C                   IF        ((M0068C = 1) AND (M1N07 = 'DME'))
     C                   MOVE      MAVD          ELKAVD            4
     C                   MOVE      MTDN          ELKTDN            7
     C                   MOVE      MMN           ELKMN             9
     C                   CALL      'TVI28FC'
     C                   PARM                    ELKAVD
     C                   PARM                    ELKTDN
     C                   PARM                    ELKMN
     C                   END
     C                   END
     C                   END
     C                   OPEN      TVINME
     C                   MOVE      '1'           *IN51
     C     KEYTF         SETLL     TVINF
     C     KEYTF         READE     TVINF                                  33
     C  N33              MOVE      'J'           XPRT              1
     C     *IN33         DOWEQ     '0'
     C     *IN51         IFEQ      '1'
     C                   WRITE     TVINMEA
     C                   SETOFF                                       51
     C                   END
     C     F0078B        COMP      *BLANKS                                41
     C     F0078C        COMP      *BLANKS                                42
     C     F0078D        COMP      *BLANKS                                43
     C     F0078E        COMP      *BLANKS                                44
     C                   WRITE     TVINMEB
     C     KEYTF         READE     TVINF                                  33
     C  N33              ENDDO
     C     XPRT          IFEQ      'J'
     C                   WRITE     TVINMEØ
     C                   END
     C                   CLOSE     TVINME
      *
     C                   ENDSR
