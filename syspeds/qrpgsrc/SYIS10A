********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 VELG RIKTIG SAKSNR
********************************************************************
      *
      *****************************************************************
      *    VEDLIKEHOLD AV AVVIKSRAPPORT (FORVALGSBILDE)
      *
      *****************************************************************
      *** PROGRAMMERT AV TORE BR≈STAD, SYSTEMA A/S, JANUAR 1994   *****
      *****************************************************************
      *
     FISOFL1    IF   E           K DISK
     FISOFL7    IF   E           K DISK    RENAME(ISOFR:ISOFR07)
     FHEADF     IF   E           K DISK
     FSYIS10AD  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     D                UDS
     D  USIG                  19     21
      *
      * DS FOR DATOFORMATERING
      *
     D W1SRDA          DS
     D  WSR≈≈                  1      2  0
     D  WSRMM                  3      4  0
     D  WSRDD                  5      6  0
     D WSRDAT          DS
     D  WSS≈≈                  1      2  0
     D  WSSMM                  3      4  0
     D  WSSDD                  5      6  0
      *
     C                   MOVE      *BLANKS       TEST              1
     C                   MOVE      *BLANKS       UFLAGG            2
      *
     C     ISOKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UTNO              8 0
      *
     C                   IF        UTNO = 0
     C     ISOKEY        CHAIN     HEADF                              30
     C     ISOKEY        CHAIN     ISOFR                              30
     C   30              IF        HEPRO > 0
     C     HEPRO         CHAIN     ISOFL7                             30
     C                   END
     C                   ELSE
     C     UTNO          CHAIN     ISOFL7                             30
     C                   END
      *
     C                   IF        *IN30
     C                   MOVE      '1'           TEST
     C                   Z-ADD     0             USSLOP
     C                   CALL      'SYIS10B'
     C                   PARM                    UFIRM
     C                   PARM                    USAKSNR           7 0
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UTNO
     C                   PARM                    USIG
     C                   PARM                    USSLOP            3 0
     C                   PARM                    TEST
     C                   PARM                    UFLAGG
     C                   END
      *
     C                   EXSR      FRASR
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     FRASR         BEGSR
      ***********************************************
     C     STTUR         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      ****************
      * Fyll Subfile *
      ****************
      * LES ALLE POSTER MED OPPDRAGSNR
     C                   IF        UTNO = 0
     C     ISOKEY        SETLL     ISOFR
     C     ISOKEY        READE     ISOFR                                  94
     C                   ELSE
     C     UTNO          SETLL     ISOFL7
     C     UTNO          READE     ISOFL7                                 94
     C                   END
      *
     C                   DOW       *IN94 = *OFF
     C                   EXSR      SRMOV1
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   IF        UTNO = 0
     C     ISOKEY        READE     ISOFR                                  94
     C                   ELSE
     C     UTNO          READE     ISOFL7                                 94
     C                   END
     C                   ENDDO
      *
     C                   IF        UTNO = 0
      * LES ALLE POSTER MED TURNR
     C     HEPRO         SETLL     ISOFL7
     C     HEPRO         READE     ISOFL7                                 94
     C                   DOW       *IN94 = *OFF
     C                   EXSR      SRMOV1
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     HEPRO         READE     ISOFL7                                 94
     C                   ENDDO
      *
     C                   END
      *
     C                   IF        ZRECNO > 1
     C                   Z-ADD     1             ZRECNO
     C                   END
      *
     C     NYTXX         TAG
     C                   MOVE      ZRECNO        XRECNO            4 0
     C     STTUR3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   SETON                                        80
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
     C   12              GOTO      UT
     C   03              GOTO      UT
     C     *IN06         IFEQ      '1'
     C                   MOVE      '1'           TEST
     C                   Z-ADD     0             USSLOP
     C                   MOVE      *ZEROS        USAKSNR
     C                   CALL      'SYIS10B'
     C                   PARM                    UFIRM
     C                   PARM                    USAKSNR
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UTNO
     C                   PARM                    USIG
     C                   PARM                    USSLOP
     C                   PARM                    TEST
     C                   PARM                    UFLAGG
     C                   GOTO      STTUR
     C                   END
      *
     C     LESNT         TAG
     C     ZRECNO        CABEQ     0             UT
     C                   EXSR      HHENT
     C     UFLAGG        IFEQ      '05'
     C                   GOTO      UT
     C                   ELSE
     C                   GOTO      STTUR
     C                   END
      *
     C     UT            ENDSR
      *
      ***********************************************
     C     SRMOV1        BEGSR
      ***********************************************
     C                   MOVEL     ISST          WSST
     C     ISST          COMP      'F'                                    41
     C                   MOVEL     ISSAKN        WSSAKN
     C                   MOVEL     ISFTUN        WSSTUN
     C                   MOVEL     ISFAVD        WSSAVD
     C                   MOVEL     ISFOPD        WSSOPD
     C                   MOVEL     ISFLOP        WSSLOP
     C                   MOVEL     ISFPFO        WSSPFO
     C                   MOVEL     ISFAVA        WSSAVA
     C                   MOVEL     ISFANS        WSSANS
     C                   MOVEL     ISFAV1        WSS≈RS
     C                   MOVE      ISFRDA        W1SRDA
     C                   Z-ADD     WSR≈≈         WSSDD
     C                   Z-ADD     WSRMM         WSSMM
     C                   Z-ADD     WSRDD         WSS≈≈
     C                   MOVE      WSRDAT        WSSREG
      *
     C                   ENDSR
      *
      ***********************************************
     C     HHENT         BEGSR
      ***********************************************
     C                   MOVEA     '00'          *IN(91)
     C                   SETOFF                                       9830
     C     *IN98         DOWEQ     '0'
     C     *IN80         ANDEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '2'
     C     WSST          ANDNE     'F'
     C                   MOVE      '2'           TEST
     C                   Z-ADD     WSSLOP        USSLOP
     C                   IF        WSSAVD = 0
S01  C*                  Z-ADD     WSSAKN        USAKSNR
N01  C                   MOVE      ISSAKN        USAKSNR
     C                   ELSE
S01  C*                  Z-ADD     0             USAKSNR
N01  C                   Z-ADD     WSSAKN        USAKSNR
     C                   END
S01  C*                  MOVE      ISSAKN        USAKSNR
     C                   CALL      'SYIS10B'
     C                   PARM                    UFIRM
     C                   PARM                    USAKSNR
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UTNO2             8 0
     C                   PARM                    USIG
     C                   PARM                    USSLOP
     C                   PARM                    TEST
     C                   PARM                    UFLAGG
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C  N98WSNR          IFEQ      '4'
     C     WSSAVD        ANDNE     0
     C     WSST          ANDNE     'F'
     C                   MOVE      '4'           TEST
     C                   Z-ADD     WSSLOP        USSLOP
S01  C*                  MOVE      ISSAKN        USAKSNR
N01  C                   Z-ADD     WSSAKN        USAKSNR
     C                   CALL      'SYIS10B'
     C                   PARM                    UFIRM
     C                   PARM                    USAKSNR
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UTNO2
     C                   PARM                    USIG
     C                   PARM                    USSLOP
     C                   PARM                    TEST
     C                   PARM                    UFLAGG
     C                   SUB       1             ZRECNO
     C                   MOVE      ' '           WSNR
     C                   END
      *
     C  N98WSNR          IFEQ      '5'
     C                   MOVE      '5'           TEST
     C                   Z-ADD     WSSLOP        USSLOP
     C                   IF        WSSAVD = 0
S01  C*                  Z-ADD     WSSAKN        USAKSNR
N01  C                   MOVE      ISSAKN        USAKSNR
     C                   ELSE
S01  C*                  Z-ADD     0             USAKSNR
N01  C                   Z-ADD     WSSAKN        USAKSNR
     C                   END
     C                   CALL      'SYIS10B'
     C                   PARM                    UFIRM
     C                   PARM                    USAKSNR
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UTNO2
     C                   PARM                    USIG
     C                   PARM                    USSLOP
     C                   PARM                    TEST
     C                   PARM                    UFLAGG
     C                   SUB       1             ZRECNO
     C                   MOVE      ' '           WSNR
     C                   END
     C                   END
      *
     C     UTHENT        ENDSR
      *
