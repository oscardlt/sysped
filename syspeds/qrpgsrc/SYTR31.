      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE/SPÿRRE FRITEKST TIL OPPD. ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07-11 13-24             ***
      *** LEDIGE INDIKATORER 29 31 32 35-39 41-89 95-97       ***
      *** IND. 27 P≈ = SPÿRRING   27 AV = VEDLIKEHOLD         ***
      *** IND. 28 P≈ = KUN ENDRING VED VEDLIKEHOLD            ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
  XXX * 01 JOV PTF11 bedret switch mellom lest/ulest
11175 * 02 YBC VIS ALLE LINJER OG 27X132 BILDE. INGEN MERKING
********************************************************************
      *
     FFREETUR1  UF A E           K DISK
     FFRTIND2   IF   E           K DISK
     F                                     RENAME(FREETURR:FRTINDR)
     FKODTA     IF   E           K DISK
     FTURER     IF   E           K DISK
     FKODTFT    IF   E           K DISK
     FSYTR31FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D WF              S              6  0 DIM(20)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDT≈                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDM≈DD                 1      2  0
     D  XDM≈MM                 3      4  0
     D  XDM≈≈≈                 5      6  0
     D  XDM≈                   1      6  0
     D                 DS
     D  X≈MD≈≈                 1      4  0
     D  X≈MDMM                 5      6  0
     D  X≈MDDD                 7      8  0
     D  X≈MD                   1      8  0
     D                 DS
     D  FRTDT≈                 1      4  0
     D  FRTDTM                 5      6  0
     D  FRTDTD                 7      8  0
     D  FRTDT                  1      8  0
     D                 DS
     D  XIDAG≈                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  WSTX01                 1     70
     D  WSTX02                71    140
     D  WSTX03               141    210
     D  WSTX04               211    280
     D  WSTX05               281    350
     D  WSTX06               351    420
     D  WSTX07               421    490
     D  WSTX08               491    560
     D  WSTX09               561    630
     D  WSTX10               631    700
     D  WSTX11               701    770
     D  WSTX12               771    840
     D  WSTX13               841    910
     D  WSTX14               911    980
     D  WSTX15               981   1050
     D  WSTX16              1051   1120
     D  WSTX17              1121   1190
     D  WSTX18              1191   1260
     D  WSTX19              1261   1330
     D  WSTX20              1331   1400
     D  WSTX21              1401   1470
     D  WSTX22              1471   1540
     D  WSTX23              1541   1610
     D  WT                     1   1610    DIM(23) ASCEND
     D                 DS
     D  WKOD01                 1      1
     D  WKOD02                 2      2
     D  WKOD03                 3      3
     D  WKOD04                 4      4
     D  WKOD05                 5      5
     D  WKOD06                 6      6
     D  WKOD07                 7      7
     D  WKOD08                 8      8
     D  WKOD09                 9      9
     D  WKOD10                10     10
     D  WKOD11                11     11
     D  WKOD12                12     12
     D  WKOD13                13     13
     D  WKOD14                14     14
     D  WKOD15                15     15
     D  WKOD16                16     16
     D  WKOD17                17     17
     D  WKOD18                18     18
     D  WKOD19                19     19
     D  WKOD20                20     20
     D  WKOD21                21     21
     D  WKOD22                22     22
     D  WKOD23                23     23
     D  WK                     1     23    DIM(23) ASCEND
     D                 DS
     D  WKO001                 1      2
     D  WKO002                 3      4
     D  WKO003                 5      6
     D  WKO004                 7      8
     D  WKO005                 9     10
     D  WKO006                11     12
     D  WKO007                13     14
     D  WKO008                15     16
     D  WKO009                17     18
     D  WKO010                19     20
     D  WKO011                21     22
     D  WKO012                23     24
     D  WKO013                25     26
     D  WKO014                27     28
     D  WKO015                29     30
     D  WKO016                31     32
     D  WKO017                33     34
     D  WKO018                35     36
     D  WKO019                37     38
     D  WKO020                39     40
     D  WKO021                41     42
     D  WKO022                43     44
     D  WKO023                45     46
     D  WKO                    1     46    DIM(23) ASCEND
     D  WKOTST                 1     46
     D                 DS
     D  YDT≈                   1      4  0
     D  YDTM                   5      6  0
     D  YDTD                   7      8  0
     D  YDT                    1      8  0
     C*
     C                   EXSR      INIT
     C   03              GOTO      SLUTT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     FRTKI         SETLL     FRTIND2
     C     FRTKI         READE     FRTIND2                                94
     C  N27FÿRSTE        IFNE      'N'
     C   94              SETON                                        06
     C   94              GOTO      LAGE
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        51
     C  N27
     CANN28FRTDT         COMP      XIDAG                                  28
     C                   ADD       1             ZRECNO
     C                   MOVEL     FRTTXT        WSTXT
     C                   MOVE      FRTKOD        WSKODE
     C                   MOVE      FRTDTD        WSDTD
     C                   MOVE      FRTDTM        WSDTM
     C                   MOVE      FRTDT≈        WSDT≈
     C                   EXSR      KDTFMT
     C                   MOVE      FRTDT         XDT               8 0
     C                   MOVE      FRTKOD        XKOD              1
N01  c                   setoff                                       8182
N01  C                   if        FRTKOD='P' and FRTLES=' '
N01  c                   seton                                        82
N01  c                   endif
     C                   WRITE     SUBFIL
     C     ST21          TAG
     C     FRTKI         READE     FRTIND2                                94
     C  N94FRTDT         IFEQ      XDT
     C     FRTKOD        ANDEQ     XKOD
     C                   MOVE      FRTKOD        XKOD              1
     C                   GOTO      ST21
     C                   END
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C*
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       999830
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE
     C     LAGE          TAG
     C   06              DO
     C                   MOVE      'N'           FÿRSTE            1
     C                   Z-ADD     1             WSSIDE
     C                   MOVE      UYEAR         WSDT≈
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      WSDT          XDM≈
     C                   EXSR      SNUDT
     C                   MOVE      X≈MD          YDT
     C                   EXSR      KDTFMT
     C                   MOVE      *BLANKS       WT
     C                   MOVE      *ZEROS        WF
     C                   MOVE      *BLANKS       WK
     C                   MOVE      *BLANKS       WKO
     C                   SETOFF                                       40
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START5
     C                   END
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTS
     C   03              GOTO      SLUTT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C   05
     COR 12              GOTO      START
     C                   GOTO      START3
     C*
     C*** LAGE
     C     START5        TAG
     C                   MOVE      'N'           PDALIN            1
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C   04              DO
     C*
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   Z-ADD     0             UFLAGG
     C     LINNBR        IFGT      2
     C     LINNBR        IFLT      23
     C     LINNBR        SUB       2             SS                2 0
     C                   MOVE      WSKF          WKO(SS)
     C                   END
     C                   END
     C                   GOTO      START5
     C                   END
     C                   SETOFF                                       9030
     C   10WSSIDE        IFEQ      5
     C                   GOTO      START5
     C                   ELSE
     C     BLAN70        LOOKUP    WT                                 33
     C   33              ADD       1             WSSIDE
     C   33              EXSR      MOVFRW
     C                   GOTO      START5
     C                   END
     C  N12              DO
     C                   EXSR      TESTB1
     C     FREE          IFEQ      'N'
     C  N03              GOTO      START
     C                   ELSE
     C                   GOTO      START5
     C                   END
     C                   END
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C  N03              GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      'N'           FREE              1
     C     WKOTST        IFNE      *BLANKS
     C                   MOVE      'J'           FREE
     C                   EXSR      FIXKOD
     C                   END
     C                   Z-ADD     1             XN                2 0
     C     XN            DOWLE     20
     C     WT(XN)        IFNE      *BLANKS
     C                   GOTO      STTB1
     C                   END
     C                   ADD       1             XN
     C                   END
     C                   SETON                                        9030
     C                   MOVE      'SPT0040'     MSGNR
     C                   GOTO      SLTB1
     C*
     C     STTB1         TAG
     C     WSDTD         IFEQ      UDAY
     C     WSDTM         ANDEQ     UMONTH
     C     WSDT≈         ANDEQ     UYEAR
     C                   SETON                                        28
     C                   END
     C     WSSIDE        SUB       1             YLI
     C     YLI           MULT      20            YLI
     C     WSSIDE        IFEQ      1
     C                   SETOFF                                       33
     C                   ELSE
     C                   SETON                                        33
     C                   END
     C                   Z-ADD     1             XN
     C                   ADD       1             YLI
     C     XN            DOWLE     20
     C     FRTK          CHAIN     FREETUR1                           34
     C     WT(XN)        IFEQ      *BLANKS
     C  N34              DELETE    FREETURR
     C                   ELSE
     C                   MOVE      UAVD          FRTAVD
     C                   MOVE      UTUR          FRTTUR
     C                   MOVE      YDT           FRTDT
     C                   MOVE      YLI           FRTLI
     C                   MOVE      WT(XN)        FRTTXT
     C                   MOVE      WK(XN)        FRTKOD
     C  N34              UPDATE    FREETURR
     C   34              WRITE     FREETURR
     C  N33              DO
     C                   MOVEL     WT(XN)        WSTXT
     C                   MOVEL     WK(XN)        WSKODE
     C   40              UPDATE    SUBFIL
     C   40ZRECNO        CHAIN     SUBFIL                             34
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   SETON                                        33
     C                   END
     C                   END
     C                   ADD       1             XN
     C                   ADD       1             YLI
     C                   END
     C*
     C     SLTB1         ENDSR
     C*
     C***********************************************
     C     HENTS         BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       17            LINNBR
     C                   MVR                     XLIN              4 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     17            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGST
     C   12              GOTO      SLHENT
     C                   END
      *
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTST
     C                   MOVE      '1'           *IN05
     C                   MOVE      'N'           FÿRSTE
     C                   MOVE      ZRECNO        XRECN2            4 0
     C                   GOTO      SLHENT
     C                   END
      *
     C   27WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGST
     C   12              GOTO      SLHENT
     C                   END
      * sett/ulest
N01  C     WSNR          IFEQ      'L'
N01  C     WSNR          oreq      'U'
N01  C     WSkode        IFEQ      'P'
N01  C                   EXSR      LestUlest
N01  C                   SETON                                        LR
N01  C                   return
N01  C                   end
N01  C                   MOVE      ' '           WSNR
N01  C                   UPDATE    SUBFIL
N01  C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     4             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGST         BEGSR
     C***********************************************
     C                   EXSR      KDTFMT
     C                   MOVE      *BLANK        XKOD              1
     C                   MOVE      WSDT          XDM≈
     C                   EXSR      SNUDT
     C                   MOVE      X≈MD          YDT
     C                   MOVE      *BLANK        YKOD              1
     C                   EXSR      KDTFMT
     C                   SETON                                        40
     C                   Z-ADD     1             WSSIDE
     C                   EXSR      MOVFRW
     C*
     C                   SETON                                        99
     C     STCHG         TAG
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C   04              DO
     C*
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   Z-ADD     0             UFLAGG
     C     LINNBR        IFGT      2
     C     LINNBR        IFLT      23
     C     LINNBR        SUB       2             SS                2 0
     C                   MOVE      WSKF          WKO(SS)
     C                   END
     C                   END
     C                   GOTO      START5
     C                   END
     C                   SETOFF                                       9030
     C   12              GOTO      UTSRSH
     C   10WSSIDE        IFEQ      5
     C                   GOTO      STCHG
     C                   ELSE
     C     BLAN70        LOOKUP    WT                                 33
     C   33              ADD       1             WSSIDE
     C   33              EXSR      MOVFRW
     C                   GOTO      STCHG
     C                   END
     C  N27              EXSR      TESTB1
     C     FREE          IFEQ      'J'
     C                   GOTO      STCHG
     C                   END
     C   30              GOTO      STCHG
     C*
     C                   UPDATE    SUBFIL
     C     XLIN          IFEQ      0
     C                   Z-ADD     17            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C*
     C     UTSRSH        TAG
     C     PDALIN        IFEQ      'J'
     C                   Move      'L'           WSPDST
     C                   EXFMT     PDAWIN
     C     FRTKDel       SETLL     FREETUR1
     C     FRTKDel       READE     FREETUR1                               33
     C     *in33         doweq     '0'
     C     FRTKOD        ifeq      'P'
     C     WSPDST        ifeq      'L'
     C                   MOVE      'X'           FRTLES
     C                   else
     C                   move      ' '           FRTLES
     C                   end
     C                   end
     c                   update    freeTURR
     C     FRTKDel       READE     FREETUR1                               33
     C                   END
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     MOVFRW        BEGSR
     C***********************************************
     C                   MOVE      'N'           PDALIN            1
     C                   Z-ADD     2             POSNBR
     C     WSSIDE        MULT      20            XN2               3 0
     C                   MOVE      *BLANKS       WT
     C                   MOVE      *ZEROS        WF
     C                   MOVE      *BLANKS       WK
     C                   MOVE      *BLANKS       WKO
     C                   SETOFF                                       33
     C     XN2           SUB       19            YLI
     C     FRTK          SETLL     FREETUR1
     C     STMFW         TAG
     C     UAVD          READE     FREETUR1                               33
     C  N33              UPDATE    FREETURR
     C  N33UTUR          COMP      FRTTUR                             3333
     C  N33YDT           COMP      FRTDT                              3333
     C  N33XN2           COMP      FRTLI                                33
     C  N33FRTLI         SUB       XN2           XN
     C  N33              ADD       20            XN
     C  N33              MOVE      FRTTXT        WT(XN)
     C  N33              MOVE      FRTKOD        WK(XN)
     C  N33XN            ADD       3             LINNBR
     C  N33FRTKOD        IFEQ      'P'
     C                   MOVE      'J'           PDALIN            1
     C                   END
     C  N33              GOTO      STMFW
     C                   EXSR      TESTFA
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     TURKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTUR
     C     FRTK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTUR
     C                   KFLD                    YDT
     C                   KFLD                    YLI
     C     FRTKDel       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTUR
     C                   KFLD                    YDT
     C     FRTKI         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTUR
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTUR              8 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      0                                  2727
     C     UAVD          IFEQ      *ZEROS
     C     STTUR         TAG
     C                   EXFMT     BILDE00
     C  N03TURKEY        CHAIN     TURER                              30
     C   30
     CANN03              GOTO      STTUR
     C                   END
     C*
     C                   MOVE      *ZEROS        X≈MD
     C                   MOVE      *ZEROS        XDM≈
     C                   MOVE      *ZEROS        XIDAG
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        YLI               2 0
     C                   MOVE      *ZEROS        YDT               8 0
     C                   MOVE      *ZEROS        YKOD              1
     C                   MOVE      *ZEROS        YKOD2             1
     C                   MOVE      *BLANKS       BLAN70           70
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        FRTDT
     C                   MOVE      UDAY          XIDAGD
     C                   MOVE      UMONTH        XIDAGM
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          XIDAG≈
     C                   ELSE
     C     UYEAR         ADD       2000          XIDAG≈
     C                   END
     C     KODTAK        CHAIN     KODTA                              33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDT≈         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDT≈
     C*
     C                   ENDSR
     C******************************************************************
     C     FIXKOD        BEGSR
     C******************************************************************
     C     KODFTK        KLIST
     C                   KFLD                    WSKF              2
     C                   KFLD                    XLN               1 0
     C                   Z-ADD     1             XN
     C*
     C     XN            DOWLT     20
     C     WKO(XN)       IFNE      '  '
     C                   MOVE      WKO(XN)       WSKF
     C                   MOVE      *BLANKS       WKO(XN)
     C*** HENTE FRITEKSTER
     C                   Z-ADD     1             XLN               1 0
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44              MOVEL     KFTFTX        WT(XN)
     C*
     C     XN            IFLT      20
     C                   ADD       1             XN
     C                   ADD       1             XLN
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44              MOVEL     KFTFTX        WT(XN)
     C*
     C     XN            IFLT      20
     C                   ADD       1             XN
     C                   ADD       1             XLN
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44              MOVEL     KFTFTX        WT(XN)
     C*
     C     XN            IFLT      20
     C                   ADD       1             XN
     C                   ADD       1             XLN
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44              MOVEL     KFTFTX        WT(XN)
     C                   END
     C                   END
     C                   END
     C                   END
     C                   ADD       1             XN
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     TESTFA        BEGSR
     C***********************************************
     C     WF(1)         COMP      *ZEROS                             51
     C     WF(2)         COMP      *ZEROS                             52
     C     WF(3)         COMP      *ZEROS                             53
     C     WF(4)         COMP      *ZEROS                             54
     C     WF(5)         COMP      *ZEROS                             55
     C     WF(6)         COMP      *ZEROS                             56
     C     WF(7)         COMP      *ZEROS                             57
     C     WF(8)         COMP      *ZEROS                             58
     C     WF(9)         COMP      *ZEROS                             59
     C     WF(10)        COMP      *ZEROS                             60
     C     WF(11)        COMP      *ZEROS                             61
     C     WF(12)        COMP      *ZEROS                             62
     C     WF(13)        COMP      *ZEROS                             63
     C     WF(14)        COMP      *ZEROS                             64
     C     WF(15)        COMP      *ZEROS                             65
     C     WF(16)        COMP      *ZEROS                             66
     C     WF(17)        COMP      *ZEROS                             67
     C     WF(18)        COMP      *ZEROS                             68
     C     WF(19)        COMP      *ZEROS                             69
     C     WF(20)        COMP      *ZEROS                             70
     C                   ENDSR
     C***********************************************
     C     SNUDT         BEGSR
     C***********************************************
     C                   MOVE      XDM≈DD        X≈MDDD
     C                   MOVE      XDM≈MM        X≈MDMM
     C     XDM≈≈≈        IFGT      50
     C     XDM≈≈≈        ADD       1900          X≈MD≈≈
     C                   ELSE
     C     XDM≈≈≈        ADD       2000          X≈MD≈≈
     C                   END
     C                   ENDSR
N01  C***********************************************
N01  C     LestUlest     BEGSR
N01  C***********************************************
N01  C                   MOVE      WSDTD         YDTD
N01  C                   MOVE      WSDTM         YDTM
N01  C     WSDT≈         IFGT      50
N01  C     WSDT≈         ADD       1900          YDT≈
N01  C                   ELSE
N01  C     WSDT≈         ADD       2000          YDT≈
N01  C                   END
N01  C     FRTKDel       SETLL     FREETUR1
N01  C     FRTKDel       READE     FREETUR1                               33
N01  C     *in33         doweq     '0'
N01  C     FRTKOD        ifeq      'G'
N01  C     FRTKOD        oreq      'P'
N01  C     WSNR          ifeq      'L'
N01  C                   MOVE      'X'           FRTLES
N01  C                   else
N01  C                   MOVE      ' '           FRTLES
N01  C                   end
N01  C                   end
N01  c                   update    FREETURR
N01  C     FRTKDel       READE     FREETUR1                               33
N01  C                   END
N01  C                   ENDSR
     C***********************************************
     C     DLTST         BEGSR
     C***********************************************
     C                   MOVE      WSDTD         YDTD
     C                   MOVE      WSDTM         YDTM
     C     WSDT≈         IFGT      50
     C     WSDT≈         ADD       1900          YDT≈
     C                   ELSE
     C     WSDT≈         ADD       2000          YDT≈
     C                   END
     C                   SETOFF                                       34
      * slett linjer med gitt kode/dato
     C     FRTKDel       SETLL     FREETUR1
     C     FRTKDel       READE     FREETUR1                               34
     C     *IN34         DOWEQ     '0'
     c     FRTKOD        IFEQ      WSKODE
     C                   DELETE    FREETURR
     c                   END
     C     FRTKDel       READE     FREETUR1                               34
     C  N34              END
     C                   ENDSR
      *
