/* SENDE CMR-FRAKTBREV PÅ EMAIL       */
             PGM        PARM(&AVD &OPD &STMF &BANE &VISE &LAND &INFOP)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&LAND) TYPE(*CHAR) LEN(2)
    /* SKRIVER UT FRAKTBREVKOPI           */
    /*                                    */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
/*           SKJEKK OM PDF FINNES FRA FØR  */
             OVRPRTF    FILE(QSYSPRT) OUTQ(OUTMAIL)
             DSPLNK     OBJ(&BANE) OUTPUT(*PRINT) OBJTYPE(*STMF) +
                          DETAIL(*NAME) DSPOPT(*USER)
             MONMSG     MSGID(CPFA0A9) EXEC(GOTO CMDLBL(VIDERE))
             DLTSPLF    FILE(QSYSPRT) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             IF         COND(&VISE = 'J') THEN(DO)
             CALL       PGM(PDF001) PARM(&STMF)
             ENDDO
             RETURN
VIDERE:      CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
             CHGDTAARA  DTAARA(*LDA (22 8)) VALUE('00000000')
             CHGDTAARA  DTAARA(*LDA (100 1)) VALUE('F')
             CHGDTAARA  DTAARA(*LDA (101 7)) VALUE(&OPD)
             CHGDTAARA  DTAARA(*LDA (108 30)) +
                          VALUE('000000000000000000000000000000')
             CHGDTAARA  DTAARA(*LDA (138 29)) +
                          VALUE('0000000000000000000')
             CHGDTAARA  DTAARA(*LDA (209 8)) VALUE('00000000')
             CHGDTAARA  DTAARA(*LDA (231 3)) VALUE('000')

    /* ORDNER PRINTER FOR CMR       */
/******************************************************************/
/*              SYEX43P   CMR                **********************/
/******************************************************************/
             IF         COND(&INFOP = 'D') THEN(OVRPRTF +
                        FILE(SYEX43P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(70 85) LPI(6) CPI(10) +
                          OVRFLW(70) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF))
                          ELSE CMD(OVRPRTF +
                        FILE(SYEX43P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(70 85) LPI(6) CPI(10) +
                          OVRFLW(70) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD))
/******************************************************************/
/*              CMRBREV                      **********************/
/******************************************************************/
             OVRPRTF    FILE(CMRBREV) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(70 85) LPI(6) CPI(10) +
                          OVRFLW(70) FRONTOVL(CM1) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD)
/**********************************************************************/
/*               KALLER PRINTPROGRAM    *******************************/
/**********************************************************************/
             CALL       PGM(SYEX43)
/******************************************************************/
/*           RETURNER VED DIREKTE            **********************/
/******************************************************************/
             IF         COND(&INFOP = 'D') THEN(RETURN)
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE          */
/* UTEN INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'N') THEN(DO)
             IF         COND(&LAND = 'NO') THEN(DO)
             CVTSPLFPDF SPLF(SYEX43P) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
             IF         COND(&LAND = 'EU') THEN(DO)
             CVTSPLFPDF SPLF(CMRBREV) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
                          ENDDO
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE           */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'J') THEN(DO)
             IF         COND(&LAND = 'NO') THEN(DO)
             CHGVAR     VAR(&FILEN) VALUE('SYEX43P')
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
             IF         COND(&LAND = 'EU') THEN(DO)
             CHGVAR     VAR(&FILEN) VALUE('CMRBREV')
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             IF         COND(&VISE = 'J') THEN(DO)
             CALL       PGM(PDF001) PARM(&STMF)
             ENDDO
             DLTSPLF    FILE(SYEX43P) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
             DLTSPLF    FILE(CMRBREV) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
    /* */

/*                                       */
    /* */
 SLUTT:      ENDPGM
