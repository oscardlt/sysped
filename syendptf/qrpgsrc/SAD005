      * kompilering       ovrdbf SADHOPD  SADH
      *                   ovrdbf SADHO2   SADH
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 02 YBC PTF10 VIS LØPENR UTEN FØRST TO TALL AV ÅR
10XXX * 03 CB  PTF10 HENT EXTERN REFERANSE ETTER ENDRING AV DEKL.
10XXX * 04 sh  PTF10 søke på versjonsnummer ind 38
10XXX * 05 YBC PTF10 KUN VIS OPPDRAG MED SAMMMEN START-REF.
10XXX * 06 YBC PTF10 SØKING PÅ ALLE AVDELINGER BRUKER EGNE FILER
10XXX * 07 SH  PTF10 SØKING PÅ FORETAKSNUMMER
10XXX * 08 jov PTF10 Opsjon 55 = se på (oppdraget) på web
10XXX * 09 jov PTF10 F02 = arb med ufortollede
10XXX * 10 jov PTF10 Filter på satus ved søk via signatur(OG annet) - cursor-plassering i TESTB1
10XXX * 11 YBC PTF10 UTVIDER TIL 27X132, INGEN MERKING
10XXX * 12 YBC PTF10 OPSJON 18 = NOTISBLOKK
10XXX * 13 JOV PTF10 OPSJON 25 = T&T
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11007 * 14 YBC PTF11 VIS J/N PÅ OM EPOST ER SENDT TIL KUNDE
11016 * 15 YBC PTF11 OPSJON 12 = OMBEREGNING
11XXX * 16 YBC PTF11 MULIG Å SKRIVE UT VED STATUS=M
11XXX * 17 YBC PTF11 IKKE OPS. 2 NÅR OMBEREGNING ER STARTET.
11XXX * 18 YBC PTF11 VIS LØPENR FOR OMBEREGNING
11XXX * 19 YBC PTF11 OPSJON 16 PRINTE OMBEREGNING
11XXX * 20 YBC PTF11 HENT OMBEREGNING INFOR.
11XXX * 21 YBC PTF11 OMBEREGNING VED STATUS=P OG IKKE SENDT FØR
11XXX * 22 YBC PTF11 SØK OGSÅ GJELDER OMBEREGING
11XXX * 23 SH  PTF11 Feilretting i rubrikk vis uferdige
11XXX * 24 YBC PTF11 IKKE VISE OPPDRAG TO GANGER
11108 * 25 YBC PTF11 OMBEREGNING PÅ OMBEREGNING
11XXX * 26 YBC PTF11 VIS RIKTIG LØPENR VED MANUELL OMB UTEN SENDING TIL TVINN
11XXX * 27 SH  PTF11 VIS FRI SØKEVEI
11183 * 28 YBC PTF11 EKSP.ENHET MED SØKING AV LØPENR
11183 * 29 SH  PTF12 FORENKLET PROSEDYRE INDIKATOR 76
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12050 * 30 YBC PTF12 Søk oppdrag via fakturanr, merking/container/underst.
12148 * 31 SH  PTF12 OMSENDE XML TIL EMMA OPSJON 88
12072 * 32 SH  PTF12 Vis om epost er sendt
12078 * 33 SH  PTF12 opson 89 sende omberegning til emma
12083 * 34 YBC PTF12 VED STATUS P SJEKK OM LØPENR ER LIK MED ORIGINAL FORTOLLING
12082 * 35 sh  PTF12 også vise dataliste
12XXX * 36 YBC PTF12 SADH10B ER SAMME SOM SADH9. BYTTES TIL SADH9
12106 * 37 YBC PTF12 SØK OMBERGNING VIA STATUS
12135 * 38 YBC PTF12 SØK VIA KUNDENAVN
XXXXX * 39 SH  PTF12 søke sekvens dato omberegning
12200 * 40 YBC PTF12 CONTAINERNR I EGEN FIL
12200 * 41 SH  PTF12 søk fri søkevei indikator 52
12251 * 42 YBC PTF12 Opsjon 13 = oppgjør av midlertidig import til ordinær
12251 * 43 SH  PTF12 gjør om opsjon 22 til https
12312 * 44 CB  PTF12 Oppdragstype fra HEADF
12361 * 45 CB  PTF12 Test og status='1' ved oppfölging TAD (O)
      *
      ***********************************************************
      *** PROGRAM SKAL SPØRRE PÅ TOLLDEKLARASJONER            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-14 17-24             ***
      *** LEDIGE INDIKATORER 29 31 32       52-75 78-89       ***
      ***********************************************************
      *
N43  Ffirmgoog  IF   E           K DISK
N32  Farklogh4  IF   E           K DISK
N04  FEDIM7     IF   E           K DISK    RENAME(EDIMR:EDIMR7)
     FSADH      IF   E           K DISK
N42  FSADHMO    IF   E           K DISK    PREFIX(M0_)
N15  FSADHOM    IF   E           K DISK    RENAME(SADHR:SADHROM)
N15  FSADHO2    IF   E           K DISK    RENAME(SADHR:SADHRO2)
N15  F                                     PREFIX(O2_)
     FSADHOPD   IF   E           K DISK    RENAME(SADHR:SADHROPD)
     FSADH1     IF   E           K DISK    RENAME(SADHR:SADH1R)
N06  FSADH1B    IF   E           K DISK    RENAME(SADHR:SADH1BR)
     FSADH2     IF   E           K DISK    RENAME(SADHR:SADH2R)
N06  FSADH2B    IF   E           K DISK    RENAME(SADHR:SADH2BR)
N07  FSADH13    IF   E           K DISK    RENAME(SADHR:SADH13R)
N07  FSADH13B   IF   E           K DISK    RENAME(SADHR:SADH13BR)
     FSADH3     IF   E           K DISK    RENAME(SADHR:SADH3R)
N06  FSADH3B    IF   E           K DISK    RENAME(SADHR:SADH3BR)
     FSADH4     IF   E           K DISK    RENAME(SADHR:SADH4R)
N06  FSADH4B    IF   E           K DISK    RENAME(SADHR:SADH4BR)
     FSADH5     IF   E           K DISK    RENAME(SADHR:SADH5R)
     FSADH5B    IF   E           K DISK    RENAME(SADHR:SADH5BR)
N28  FSADH12    IF   E           K DISK    RENAME(SADHR:SADH12R)
N28  FSADH12B   IF   E           K DISK    RENAME(SADHR:SADH12BR)
     FSADH6     IF   E           K DISK    RENAME(SADHR:SADH6R)
     FSADH6B    IF   E           K DISK    RENAME(SADHR:SADH6BR)
     FSADH7     IF   E           K DISK    RENAME(SADHR:SADH7R)
N06  FSADH7B    IF   E           K DISK    RENAME(SADHR:SADH7BR)
     FSADH10    IF   E           K DISK    RENAME(SADHR:SADH10R)
S36  F*SADH10B   IF   E           K DISK    RENAME(SADHR:SADH10BR)
N36  FSADH9     IF   E           K DISK    RENAME(SADHR:SADH9R)
N37  FSADH14    IF   E           K DISK    RENAME(SADHR:SADH14R)
N37  FSADH14B   IF   E           K DISK    RENAME(SADHR:SADH14BR)
N30  FSADFNJL1  IF   E           K DISK    RENAME(SADHR:SADHRJ1)
N30  F                                     RENAME(SADFR:SADFRJ1)
N30  FSADFNJL2  IF   E           K DISK    RENAME(SADHR:SADHRJ2)
N30  F                                     RENAME(SADFR:SADFRJ2)
S40  F*ADMNJL1  IF   E           K DISK    RENAME(SADVR1:SADVRJ11)
S40  F*                                    RENAME(SADVR2:SADVRJ12)
S40  F*                                    RENAME(SADVR3:SADVRJ13)
S40  F*                                    RENAME(SADVR4:SADVRJ14)
S40  F*                                    RENAME(SADVR5:SADVRJ15)
S40  F*                                    RENAME(SADVR6:SADVRJ16)
S40  F*                                    RENAME(SADVR7:SADVRJ17)
S40  F*                                    RENAME(SADWR:SADWRJ1)
S40  F*ADMNJL2  IF   E           K DISK    RENAME(SADVR1:SADVRJ21)
S40  F*                                    RENAME(SADVR2:SADVRJ22)
S40  F*                                    RENAME(SADVR3:SADVRJ23)
S40  F*                                    RENAME(SADVR4:SADVRJ24)
S40  F*                                    RENAME(SADVR5:SADVRJ25)
S40  F*                                    RENAME(SADVR6:SADVRJ26)
S40  F*                                    RENAME(SADVR7:SADVRJ27)
S40  F*                                    RENAME(SADWR:SADWRJ2)
N40  FSADVCNL1  IF   E           K DISK    PREFIX(CN_)
N40  FSADVCNL2  IF   E           K DISK    RENAME(SADVCNR:SADVCNR2)
c40  F                                     PREFIX(CN_)
     FSTANDI    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTP     IF   E           K DISK
     FFIRMPDF   IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FEDIM2     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
N10  FSYPARL1   IF   E           K DISK
N10  FCUNDC03   IF A E           K DISK
s31  F*RACKL02  IF   E           K DISK
N31  FTRACKL02  IF A E           K DISK
     FSAD005FM  CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
N01  F                                     INFDS(FBAREA)
     FFRISOK    IF   E           K DISK
     FFRISOL01  IF   E           K DISK    RENAME(FRISOKR:FRISOK9)
N12  FFREETXT   IF   E           K DISK
N44  FHEADF     IF   E           K DISK    PREFIX(Y)
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
N31  D                 DS
N31  D  XULTID                 1     14  0
N31  D  XULTM                  1      6  0
N31  D  XULDD                  7      8  0
N31  D  XULMM                  9     10  0
N31  D  XULÅÅ                 11     14  0
N31  D                 DS
N31  D  ULÅÅ                   1      4  0
N31  D  ULMM                   5      6  0
N31  D  ULDD                   7      8  0
N31  D  ULDT                   1      8  0
N31  D                SDS
N31  D  UUSR                 254    263
     D                 DS
     D  XDTDD                  1      2  0
     D  XDTMM                  3      4  0
     D  XDTÅÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
EV5  D  XDTÅÅ2                 1      4  0
EV5  D  XDTMM2                 5      6  0
EV5  D  XDTDD2                 7      8  0
EV5  D  XDT                    1      8  0
     D                 DS
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTSÅ                  5      6  0
     D  WSDTS                  1      6  0
     D                 DS
EV5  D  XDTSÅ2                 1      4  0
EV5  D  XDTSM2                 5      6  0
EV5  D  XDTSD2                 7      8  0
EV5  D  XDTS                   1      8  0
     D                 DS
     D  XDTKD                  1      2  0
     D  XDTKM                  3      4  0
     D  XDTKÅ                  5      6  0
     D  WSDTK                  1      6  0
     D                 DS
EV5  D  XDTKÅ2                 1      4  0
EV5  D  XDTKM2                 5      6  0
EV5  D  XDTKD2                 7      8  0
EV5  D  XDTK                   1      8  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTTÅ                  5      6  0
     D  WSDTT                  1      6  0
     D                 DS
EV5  D  XDTTÅ2                 1      4  0
EV5  D  XDTTM2                 5      6  0
EV5  D  XDTTD2                 7      8  0
EV5  D  XDTT                   1      8  0
N07  D                 DS
N07  D  XDTRD                  1      2  0
N07  D  XDTRM                  3      4  0
N07  D  XDTRÅ                  5      6  0
N07  D  WSDTRG                 1      6  0
N07  D                 DS
N07  D  XDTRÅ2                 1      4  0
N07  D  XDTRM2                 5      6  0
N07  D  XDTRD2                 7      8  0
N07  D  XDTRG                  1      8  0
N04  D                 DS
N04  D  XSSD                   1      2  0
N04  D  XSSM                   3      4  0
N04  D  XSSÅ                   5      6  0
N04  D  WSSEKD                 1      6  0
N04  D                 DS
N04  D  XSSÅ2                  1      4  0
N04  D  XSSM2                  5      6  0
N04  D  XSSD2                  7      8  0
N04  D  XSEKDT                 1      8  0
     D                 DS
EV5  D  SIDTÅ                  1      4  0
EV5  D  SIDTM                  5      6  0
EV5  D  SIDTD                  7      8  0
EV5  D  SIDT                   1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSDT2                  1      6  0
N15  D                 DS
N15  D  O2_SIDTA               1      4  0
N15  D  O2_SIDTM               5      6  0
N15  D  O2_SIDTD               7      8  0
N15  D  O2_SIDT                1      8  0
N15  D                 DS
N15  D  WSDTD3                 1      2  0
N15  D  WSDTM3                 3      4  0
N15  D  WSDTA3                 5      6  0
N15  D  WSDT3                  1      6  0
     D                 DS
     D  WSGN15                 1     15
     D  WSAAR                  1      4
     D  WSGN                   5     15
     D                 DS
     D  SINAK                  1     30
S18  D* WSNAK                  1     30
N18  D  WSNAK                  1     26
N30  D                 DS
N30  D  SIAVD                  1      4  0
N30  D  SFAVD                  1      4  0
N30  D  SVAVD                  1      4  0
N30  D  SWAVD                  1      4  0
N30  D                 DS
N30  D  SITDN                  1      7  0
N30  D  SFOPDN                 1      7  0
N30  D  SVTDN                  1      7  0
N30  D  SWTDN                  1      7  0
N30  D                 DS
N30  D  SIFIF                  1     17
N30  D  SFTXT                  1     17
N30  D                 DS
N30  D  SIFID                  1      8  0
N30  D  SFDT                   1      8  0
N30  D                 DS
N30  D  SVMRK                  1     17
N30  D  SWUNNR                 1     17
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
N38   * For xlate mellom Upper Case og Lower Case
N38  D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
N38  D                                     UVWXYZÆØÅ')
N38  D LC              C                   CONST('abcdefghijklmnopqrst-
N38  D                                     uvwxyzæøå')
N38  D AvsMot          s             12    VARYING
     C*
     C                   EXSR      INIT
     C     *IN28         IFEQ      '0'
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      '1'           *IN27
     C                   MOVE      '1'           *IN41
     C                   END
     C*
     C     START0        TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
     C*
N38  C                   IF        *IN02
N38  C                   IF        *IN32
N38  C                   EVAL      *IN32 = *OFF
N38  C                   ELSE
N38  C                   EVAL      *IN32 = *ON
N38  C                   END
N38  C                   GOTO      START0
N38  C                   END
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START0
     C                   END
     C*
     C                   EXSR      TESTB1
     C   30              GOTO      START0
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
N10  c                   move      *zeros        LestRec           9 0
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        19
N15  C                   EVAL      O2_SITDN = SITDN * -1
N15  C     SADHO2K       CHAIN     SADHO2                             33
N15  C                   IF        *IN33
N15  C                   EVAL      O2_SIST = *BLANKS
N15  C                   EVAL      O2_SIMF = *BLANKS
N18  C                   EVAL      O2_SITLL = *BLANKS
N15  C                   EVAL      WSDT3   = 0
N15  C                   ELSE
N15  C                   EVAL      WSDTD3  = O2_SIDTD
N15  C                   EVAL      WSDTM3  = O2_SIDTM
N15  C                   MOVE      O2_SIDTA      WSDTA3
S26  C*                  IF        O2_SIST <> 'P' OR O2_SIMF = *BLANKS
N26  C                   IF        O2_SITLL = SITLL
N18  C                   EVAL      O2_SITLL = *BLANKS
N18  C                   END
N15  C                   END
      * kunderef REFERANSE ISTEDEN FOR MOTTAKERNAVN
     C     FRIKEY        CHAIN     FRISOK                             39
     C     *IN39         IFEQ      *OFF
S30  C*                  EVAL      WSNAK = FSSOK
N30  C  N34
N30  CANN35FSSOK         CAT       WSNAK:1       WSNAK100        100
CB   C  N34
CB   CANN35              MOVEL     WSNAK100      WSNAK
     C                   ENDIF
     C                   ADD       1             ZRECNO
n04  c                   move      sitll         xsitll
n04  c   38              moveL     M0068A        xsitll
n04  c                   move      sitle         xsitle
n04  c   38              move      M0068B        xsitle
N10  c                   exsr      tstMail
N44   * hent oppdragstype fra HEADF
N44  C     SADHKO        CHAIN     HEADF
N44  C                   IF        %FOUND(HEADF)
N44  C                   EVAL      HEOT=YHEOT
N44  C                   ELSE
N44  C                   EVAL      HEOT=*BLANKS
N44  C                   ENDIF
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECN2            5 0
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
     C  N94              MOVE      SIAVD         XAVDFF            4 0
     C  N94              MOVE      SITDN         XTDNFF            7 0
     C  N94              END
     C                   END
     C*
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     BUNN
     C     ZRECNO        IFEQ      0
     C  N27              DO
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   EXFMT     SUBCTL
     C                   END
     C*
     C*** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
N09  C   02              DO
N09  C                   call      'SAD105'
N09  C                   GOTO      START3
N09  C                   END
     C   06              DO
     C                   EXSR      CRTSAD
     C                   GOTO      START3
     C                   END
N01  C   08              EXSR      SETCUR
     C   08              GOTO      START0
     C   15              DO
     C                   MOVE      *BLANKS       W3PRT1
     C                   MOVE      *BLANKS       W3PRT2
     C                   MOVE      *BLANKS       W3PRT3
     C                   CALL      'SAD61P01'
     C                   PARM                    W3PRT1
     C                   PARM                    W3PRT2
     C                   PARM                    W3PRT3
     C                   GOTO      START3
     C                   END
     C   16              DO
     C                   EXSR      CRTSA2
     C                   GOTO      START
     C                   END
     C*  F23 FLERE OPSJONER
     C     *IN23         IFEQ      '1'
     C     *IN77         IFEQ      '1'
     C                   SETOFF                                       77
     C                   ELSE
     C                   SETON                                        77
     C                   END
     C                   GOTO      START3
     C                   END
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C  N94SADFFK        CHAIN     SADHOPD                            33
N30  C   35              EVAL      WSNAK = X_FN
N30  C   34              EVAL      WSNAK = X_MRK
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2TDN         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2DTT         ORNE      0
     C     W2TLL         ORNE      *BLANKS
     C     W2ST          ORNE      *BLANKS
     C     W2MI          ORNE      *BLANKS
     C     W2GN          ORNE      *BLANKS
N37  C     W2STOMB       ORNE      *BLANKS
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     *IN28         IFEQ      '0'                                            3<-B
     C     W2NR          COMP      1                                      06
     C     W2NR          COMP      11                                     16
     C   06
     COR 16              DO
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     W2TDN         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0046'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYTDN
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TLL
     C                   MOVE      *BLANKS       W2ST
N37  C                   MOVE      *BLANKS       W2STOMB
     C                   MOVE      *BLANKS       W2MI
     C                   MOVE      *BLANKS       W2GN
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
N29  C     sfp           IFEQ      'J'
N29  c                   goto      start
N29  c                   end
     C                   END
     C                   GOTO      START3
     C*
     C     SLUTT         TAG
     C     WSAAVD        IFNE      0
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C     WSSG          IFNE      *BLANKS
     C                   MOVE      WSSG          USG
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
N10
N10  C***********************************************
N10  C     TstMail       BEGSR
N10  C***********************************************
N10  c                   move      *off          *in50
N10  c     SIST          ifeq      'P'
N10  c     SIKNK         andne     *zeros
N10  c     MailKey       chain     CUNDC03                            33
N10  c  N33              move      *on           *in50                          Mottar mail
N10  c                   endif
N10  c                   move      *IN50         Xin50             1
N12   *
N12  C     SADHKO        SETLL     FREETXT
N12  C     SADHKO        READE     FREETXT                                33
N12  C  N33              SETON                                            36
N12  C   33              SETOFF                                           36
N12  C                   MOVE      *IN36         XIN36             1
N12   *
s32  C*                  EVAL      WSEPJN = ' '
s32  C*    TRACKL02K     CHAIN     TRACKL02                           33
s32  C*                  DOW       *IN33 = *OFF
s32  C*    'custdec'     SCAN      TTTEXT                                 33
s32  C*                  IF        *IN33
s32  C*                  EVAL      WSEPJN = 'J'
s32  C*                  LEAVE
s32  C*                  END
s32  C*    TRACKL02K     READE     TRACKL02                               33
s32  C*                  ENDDO
N14   *
n32   *
n32   * se om epost  er sendt
n32   *
s32  C                   EVAL      WSEPJN = ' '
n32  C     SADHKO        CHAIN     arklogh4                           33
n32  C  N33              MOVE      'E'           WSEPJN
n32   *
N10  c                   endsr
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   MOVE      *IN28         XIN28             1
     C                   CLEAR                   BILDE01
     C                   MOVE      XIN28         *IN28
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           WSAAR
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          WSAAVD
     C                   ELSE
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C     W2TDN         IFNE      0                                            1<-B
     C                   MOVE      W2TDN         WSTDN
     C                   ELSE                                                   1
     C     W2SG          IFNE      *BLANKS                                       2<-B
     C                   MOVE      W2SG          WSSG
     C                   MOVE      W2DTT         WSDTT
     C                   ELSE                                                    2
     C     W2DTT         IFNE      0                                              3<-B
     C                   MOVE      W2DTT         WSDT
     C                   ELSE                                                     3
     C     W2TLL         IFNE      *BLANKS                                         4<-B
     C                   MOVE      W2TLL         WSTLL
     C                   ELSE                                                      4
     C     W2ST          IFNE      *BLANKS                                          5<-B
     C                   MOVE      W2ST          WSST
     C                   ELSE                                                       5
N37  C     W2STOMB       IFNE      *BLANKS                                          5A<-B
N37  C                   MOVE      W2STOMB       WSSTOMB
N37  C                   ELSE                                                       5A
     C     W2MI          IFNE      *BLANKS                                           6<-B
     C                   MOVE      W2MI          WSMI
     C                   ELSE                                                        6
     C                   MOVE      W2AAR         WSAAR
     C                   MOVE      W2GN          WSGN
     C                   END                                                         6<-E
N37  C                   END                                                        5A<-E
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2TDN
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TLL
     C                   MOVE      *BLANKS       W2ST
N37  C                   MOVE      *BLANKS       W2STOMB
     C                   MOVE      *BLANKS       W2MI
     C                   MOVE      *BLANKS       W2GN
      *
     C                   MOVEA     '0000'        *IN(96)
     C                   EXSR      TESTB1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     NYTDN         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          W2AVD
     C                   END
     C     WRK2K         CHAIN     SADHOPD                            98
     C   98              DO
     C                   MOVE      'YBC0047'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    2
     C     *IN28         ANDEQ     '0'
     C     UMODE         IFNE      'F'
     C     SIST          IFEQ      'F'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU1056'     MSGNR
     C                   GOTO      SLTDN
     C                   END
      * ved forenklet fortolling skal ikke edilogg finnes
     c                   ELSE
     c     sadhko        chain     edim2                              33
     c     *IN(33)       ifeq      '0'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU1057'     MSGNR
     C                   GOTO      SLTDN
     C                   end
     C                   END
      * kan ikke gå inn på normale oppdrag fra dummy
     C     UMODE         IFEQ      'F'
     C     SIST          andne     'F'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU1073'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   EXSR      CHGSAD
     C     W2NR          WHENEQ    3
     C     *IN28         ANDEQ     '0'
     C                   EXSR      CPYSAD
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPSAD
     C     W2NR          WHENEQ    6
     C                   EXSR      PRTSAD
S31  C*    WSNR          WHENEQ    7
N31  C     W2NR          WHENEQ    7
N27  C                   EXSR      VISFRIS
     C     W2NR          WHENEQ    8
     C                   EXSR      FAXSAD
     C     W2NR          WHENEQ    9
     C                   EXSR      DSPTVI
     C                   ENDSL
      *
     C     SLTDN         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2TDN
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
N29  C                   MOVE      'N'           SFP               1
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C     *IN28         IFEQ      '0'                                            3<-B
     C                   SELECT
     C     WSNR          WHENEQ    2
     C                   MOVE      '1'           *IN99
     C     UMODE         IFNE      'F'
     C     SIST          IFEQ      'F'
N17  C     WSDT3         ORNE      0
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU1056'     MSGNR
     C                   MOVE      *ZEROS        WSNR
N10  C                   MOVE      XIN50         *IN50
N12  C                   MOVE      XIN36         *IN36
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   END
      * ved forenklet fortolling skal ikke edilogg finnes
     c                   ELSE
     c     sadhko        chain     edim2                              33
     c     *IN(33)       ifeq      '0'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU1057'     MSGNR
     C                   MOVE      *ZEROS        WSNR
N10  C                   MOVE      XIN50         *IN50
N12  C                   MOVE      XIN36         *IN36
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   end
     C                   END
      * kan ikke gå inn på normale oppdrag fra dummy
     C     UMODE         IFEQ      'F'
     C     SIST          andne     'F'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU1073'     MSGNR
     C                   MOVE      *ZEROS        WSNR
N10  C                   MOVE      XIN50         *IN50
N12  C                   MOVE      XIN36         *IN36
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   END
     C                   EXSR      CHGSAD
     C     WSNR          WHENEQ    3
     C                   MOVE      '1'           *IN99
     C                   EXSR      CPYSAD
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPSAD
     C     WSNR          WHENEQ    6
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSAD
N27  C     WSNR          WHENEQ    7
N27  C                   MOVE      '1'           *IN99
N27  C                   EXSR      VISFRIS
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      FAXSAD
N15  C     WSNR          WHENEQ    12
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      TESTB2
N15  C                   IF        *IN30
N15  C                   UPDATE    SUBFIL
N15  C                   GOTO      SLHENT
N15  C                   END
N15  C                   EXSR      CHGOMB
N42  C     WSNR          WHENEQ    13
N42  C                   MOVE      '1'           *IN99
N42  C                   EXSR      OPPGJSAD
N15  C     WSNR          WHENEQ    15
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      DSPOMB
N19  C     WSNR          WHENEQ    16
N19  C                   MOVE      '1'           *IN99
N19  C                   EXSR      PRTOMB
N25  C     WSNR          WHENEQ    17
N25  C                   MOVE      '1'           *IN99
N25  C                   EXSR      ANGOMB
N29  C     WSNR          WHENEQ    76
N29  C     UMODE         IFEQ      'F'
N29  C                   MOVE      'J'           SFP               1
N29  C                   MOVE      '1'           *IN99
N29  C                   EXSR      SLETTFP
N29  C                   END
      *
n32   * wsnr = 19  VIS EPOST
n32   *
n32  C     WSNR          WHENEQ    19
n32  C     WSEPJN        IFEQ      'E'
n32  C                   EXSR      DSPEPO
n32  c                   else
n32  C                   MOVE      '1'           *IN30
n32  C                   MOVE      'SHU1729'     MSGNR
n32  C                   MOVE      *ZEROS        WSNR
N32  C                   MOVE      XIN50         *IN50
n32  C                   MOVE      XIN36         *IN36
n32  C                   UPDATE    SUBFIL
n32  C                   GOTO      SLHENT
n32  c                   end
      *
      *
N12  C     WSNR          WHENEQ    18
N12  C                   EXSR      WRKFT
     C     WSNR          WHENEQ    22
N43  C     FIFIRM        CHAIN     FIRMGOOG                           30
     C     FIFIRM        CHAIN     FIRMARC                            30
     C     FIFIRM        CHAIN     FIRMPDF                            30
     C                   MOVE      '1'           *IN99
     C   30              MOVE      'SHU0830'     MSGNR
     C   30              MOVE      *ZEROS        WSNR
N10  C   30              MOVE      XIN50         *IN50
N12  C   30              MOVE      XIN36         *IN36
     C   30              UPDATE    SUBFIL
     C   30              GOTO      SLHENT
     C                   EXSR      PDFSAD
N13  C     WSNR          WHENEQ    25
N13  C                   MOVE      '1'           *IN99
N13  C                   EXSR      SRTT
     C     WSNR          WHENEQ    52
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSKILL
     C     WSNR          WHENEQ    51
     C                   MOVE      '1'           *IN99
     C                   EXSR      arkivs
N08  C     WSNR          WHENEQ    55
N08  C                   MOVE      '1'           *IN99
N08  C                   EXSR      DSPWEB
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
      * resending av XML
      *
N31  C     WSNR          WHENEQ    88
N31  C     SIST          IFEQ      'P'
N31  c                   move      'N'           xmlstat           1
N31  C                   setoff                                       33
N31  c     Mailkey       setll     CUNDC03
N31  C     *in33         doweq     '0'
N31  c     MailKey       reade     CUNDC03                                33
N31  c     *in33         ifeq      '0'
N31  c     clive         andeq     'X'
N31  c     CFAX          andne     *blanks
N31  c                   move      'J'           xmlstat
N31  C                   MOVE      '1'           *IN99
N31  C                   seton                                        33
N31  C                   EXSR      XMLSR
N31  c                   endif
N31  c                   enddo
N31  c     xmlstat       ifeq      'N'
N31  C                   MOVE      '1'           *IN30
N31  C                   MOVE      'SHU1714'     MSGNR
N31  C                   MOVE      *ZEROS        WSNR
N31  C                   MOVE      XIN50         *IN50
N31  C                   MOVE      XIN36         *IN36
N31  C                   UPDATE    SUBFIL
N31  C                   GOTO      SLHENT
N31  C                   END
N31  C                   END
N31   * slutt 88
      * resending av omberegnet xml til emma 89
      *
N33  C     WSNR          WHENEQ    89
N33  C     SIST          IFEQ      'P'
N33  C     O2_SITLL      andne     *blanks
N33  c                   move      'N'           xmlstat           1
N33  C                   setoff                                       33
N33  c     Mailkey       setll     CUNDC03
N33  C     *in33         doweq     '0'
N33  c     MailKey       reade     CUNDC03                                33
N33  c     *in33         ifeq      '0'
N33  c     clive         andeq     'X'
N33  c     CFAX          andne     *blanks
N33  c                   move      'J'           xmlstat
N33  C                   MOVE      '1'           *IN99
N33  C                   seton                                        33
N33  C                   EXSR      XMLSR
N33  c                   endif
N33  c                   enddo
N33  c     xmlstat       ifeq      'N'
N33  C                   MOVE      '1'           *IN30
N33  C                   MOVE      'SHU1714'     MSGNR
N33  C                   MOVE      *ZEROS        WSNR
N33  C                   MOVE      XIN50         *IN50
N33  C                   MOVE      XIN36         *IN36
N33  C                   UPDATE    SUBFIL
N33  C                   GOTO      SLHENT
N33  C                   END
N33  C                   END
N33   * slutt 89
     C                   ENDSL
     C                   ELSE                                                     3
     C                   SELECT
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPSAD
     C     WSNR          WHENEQ    6
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSAD
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      FAXSAD
N15  C     WSNR          WHENEQ    15
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      DSPOMB
N19  C     WSNR          WHENEQ    16
N19  C                   MOVE      '1'           *IN99
N19  C                   EXSR      PRTOMB
     C     WSNR          WHENEQ    22
N43  C     FIFIRM        CHAIN     FIRMGOOG                           30
     C     FIFIRM        CHAIN     FIRMARC                            30
     C     FIFIRM        CHAIN     FIRMPDF                            30
     C                   MOVE      '1'           *IN99
     C   30              MOVE      'SHU0830'     MSGNR
     C   30              MOVE      *ZEROS        WSNR
N10  C   30              MOVE      XIN50         *IN50
N12  C   30              MOVE      XIN36         *IN36
     C   30              UPDATE    SUBFIL
     C   30              GOTO      SLHENT
     C                   EXSR      PDFSAD
     C     WSNR          WHENEQ    52
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTSKILL
N13  C     WSNR          WHENEQ    25
N13  C                   MOVE      '1'           *IN99
N13  C                   EXSR      SRTT
     C     WSNR          WHENEQ    51
     C                   MOVE      '1'           *IN99
     C                   EXSR      arkivs
N08  C     WSNR          WHENEQ    55
N08  C                   MOVE      '1'           *IN99
N08  C                   EXSR      DSPWEB
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
     C                   ENDSL
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNS
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNK
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      11
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     55            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      12
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNK
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     55            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
N01   ***********************************************
N01  C     SETCUR        BEGSR
N01   ***********************************************
N01  C                   Z-ADD     35            POSNBR
N01  C                   SELECT
N01  C                   WHEN      WFSSOK <> *BLANKS
N01  C                   Z-ADD     8             LINNBR
N01  C                   WHEN      WSDT   <> 0
N01  C                   Z-ADD     9             LINNBR
N01  C                   WHEN      WSTDN  <> 0
N01  C                   Z-ADD     10            LINNBR
N01  C                   WHEN      WSKNS  <> 0
N01  C                   Z-ADD     11            LINNBR
N01  C                   WHEN      WSKNK  <> 0
N01  C                   Z-ADD     12            LINNBR
N01  C                   WHEN      WSSG   <> *BLANKS
N01  C                   Z-ADD     13            LINNBR
N01  C                   WHEN      WSTLL  <> *BLANKS
N01  C                   Z-ADD     14            LINNBR
N01  C                   WHEN      WSGN   <> *BLANKS
E28  C                   Z-ADD     16            LINNBR
N01  C                   WHEN      WSST   <> *BLANKS
E28  C                   Z-ADD     17            LINNBR
N37  C                   WHEN      WSSTOMB <> *BLANKS
N37  C                   Z-ADD     17            LINNBR
N37  C                   Z-ADD     60            POSNBR
N01  C                   WHEN      WSMI   <> *BLANKS
E28  C                   Z-ADD     18            LINNBR
N01  C                   OTHER
N01  C                   Z-ADD     8             LINNBR
N01  C                   ENDSL
N01   *
N01  C                   ENDSR
N01   *
     C***********************************************
     C     DSPSAD        BEGSR
     C***********************************************
     C                   CALL      'SAD005A'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGSAD        BEGSR
     C***********************************************
     C                   MOVE      'CHG'         XTYPE             3
     C                   CALL      'SAD061CL'
     C                   PARM      SIAVD         XAVD
     C                   PARM      SITDN         XTDN
     C                   PARM                    SISG
     C                   PARM                    XTYPE
     C                   PARM                    UMODE
     C     SADHKO        CHAIN     SADHOPD                            33
     C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N03  C     FRIKEY        CHAIN     FRISOK                             39
N03  C     *IN39         IFEQ      *OFF
N03  C                   EVAL      WSNAK = FSSOK
N03  C                   ENDIF
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CPYSAD        BEGSR
     C***********************************************
     C                   MOVE      'CPY'         XTYPE             3
     C     *LIKE         DEFINE    SIAVD         XAVD
     C     *LIKE         DEFINE    SITDN         XTDN
     C                   MOVE      SIAVD         XAVD
     C                   MOVE      SITDN         XTDN
     C                   CALL      'SAD061CL'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UMODE
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C     XTDN          IFNE      0
     C     XAVD          IFNE      SIAVD
     C     XTDN          ORNE      SITDN
     C     SADHKC        CHAIN     SADHOPD                            33
     C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N03  C     FRIKEY        CHAIN     FRISOK                             39
N03  C     *IN39         IFEQ      *OFF
N03  C                   EVAL      WSNAK = FSSOK
N03  C                   ENDIF
     C                   MOVE      SIDTD         WSDTD2
     C                   MOVE      SIDTM         WSDTM2
     C                   MOVE      SIDTÅ         WSDTÅ2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
N10  c                   exsr      tstMail
     C                   WRITE     SUBFIL
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
N42   ***********************************************
N42  C     OPPGJSAD      BEGSR
N42   ***********************************************
N42  C     SADHKO        CHAIN     SADHMO                             33
N42  C                   IF        SIDP >= 50 AND SIDP <= 58
N42  C                             AND SITLL <> *BLANKS
N42  C                             OR *IN33 = *OFF
N42  C                   MOVE      'OPG'         XTYPE
N42  C                   MOVE      SIAVD         XAVD
N42  C                   MOVE      SITDN         XTDN
N42  C                   CALL      'SAD061CL'
N42  C                   PARM                    XAVD
N42  C                   PARM                    XTDN
N42  C                   PARM                    USG
N42  C                   PARM                    XTYPE
N42  C                   PARM                    UMODE
N42  C                   ELSE
N42  C                   EVAL      XAVD = 0
N42  C                   EVAL      XTDN = 0
N42  C                   END
N42  C  N90              MOVE      *ZEROS        WSNR
N42  C  N90              MOVE      XIN50         *IN50
N42  C  N90              MOVE      XIN36         *IN36
N42  C  N90              UPDATE    SUBFIL
N42  C     XTDN          IFNE      0
N42  C     XAVD          IFNE      SIAVD
N42  C     XTDN          ORNE      SITDN
N42  C     SADHKC        CHAIN     SADHOPD                            33
N42  C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N42  C     FRIKEY        CHAIN     FRISOK                             39
N42  C     *IN39         IFEQ      *OFF
N42  C                   EVAL      WSNAK = FSSOK
N42  C                   ENDIF
N42  C                   MOVE      SIDTD         WSDTD2
N42  C                   MOVE      SIDTM         WSDTM2
N42  C                   MOVE      SIDTÅ         WSDTÅ2
N42  C                   ADD       1             XRECN2
N42  C                   MOVE      XRECN2        ZRECNO
N42  C                   exsr      tstMail
N42  C                   WRITE     SUBFIL
N42  C                   END
N42  C                   END
N42   *
N42  C                   ENDSR
N42   *
     C***********************************************
     C     CRTSAD        BEGSR
     C***********************************************
     C                   MOVE      'CRT'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'SAD061CL'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UMODE
     C     XAVD          IFNE      0
     C     XTDN          ANDNE     0
     C     SADHKC        CHAIN     SADHOPD                            33
     C  N33              DO
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
     C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N03  C     FRIKEY        CHAIN     FRISOK                             39
N03  C     *IN39         IFEQ      *OFF
N03  C                   EVAL      WSNAK = FSSOK
N03  C                   ENDIF
     C                   MOVE      SIDTD         WSDTD2
     C                   MOVE      SIDTM         WSDTM2
     C                   MOVE      SIDTÅ         WSDTÅ2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
n04  c                   move      sitll         xsitll
n04  c   38              movel     M0068A        xsitll
n04  c                   move      sitle         xsitle
n04  c   38              move      M0068B        xsitle
N25  C                   EVAL      WSEPJN   = *BLANKS
N25  C                   EVAL      O2_SIMF  = *BLANKS
N25  C                   EVAL      O2_SIST  = *BLANKS
N25  C                   EVAL      O2_SITLL = *BLANKS
N25  C                   EVAL      WSDT3    = 0
N10  c                   exsr      tstMail
     C                   WRITE     SUBFIL
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CRTSA2        BEGSR
     C***********************************************
     C                   MOVE      'CR2'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'SAD061CL'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UMODE
      *
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRTSAD        BEGSR
     C***********************************************
N16  C                   IF        SIST = 'M'
N16  C     SADHKO        CHAIN     EDIM2                              33
N16  C                   DOW       *IN33 = *OFF
N16  C                   IF        M1001='929' AND MSR='R' AND M1N07<>'DFI'
N16  C                   LEAVE
N16  C                   END
N16  C     SADHKO        READE     EDIM2                                  33
N16  C                   ENDDO
N16  C   33              EVAL      SIST = ' '
N16  C                   END
N16   *
     C     SIST          IFEQ      ' '
     C     SIST          OREQ      'P'
     C     SIST          OREQ      'U'
     C     SIST          OREQ      'F'
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    SIAVD
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI
     C                   Z-ADD     81            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      KOPNVN        W3PRT1
     C                   Z-ADD     82            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      KOPNVN        W3PRT2
     C                   Z-ADD     83            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      KOPNVN        W3PRT3
     C                   EXFMT     BILDE02
     C   12              GOTO      SLPRT
     C                   MOVE      'PRT'         XTYPE             3
     C     *IN28         IFEQ      '1'
     C                   CALL      'SAD061CO'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UMODE
     C                   MOVE      'H'           PRTTYP            1
     C                   CALL      'SAD61P'
     C                   PARM                    PRTTYP            1
     C                   PARM                    PRTAVD            4
     C                   PARM                    PRTTDN            7
     C                   PARM                    W3PRT1
     C                   PARM                    W3PRT2
     C                   PARM                    W3PRT3
     C     SADHKO        CHAIN     SADHOPD                            33
     C                   ELSE
     C                   CALL      'SAD061CL'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UMODE
     C     SADHKO        CHAIN     SADHOPD                            33
     C                   CALL      'SAD61P01'
     C                   PARM                    W3PRT1
     C                   PARM                    W3PRT2
     C                   PARM                    W3PRT3
     C                   END
     C     SLPRT         TAG
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
N19   ***********************************************
N19  C     PRTOMB        BEGSR
N19   ***********************************************
N19  C     O2_SIST       IFEQ      'P'
N34  C     O2_SIST       OREQ      ' '
N15  C                   Z-SUB     SITDN         O2_SITDN
N34  C     SADHO2K       CHAIN     SADHO2                             33
N34  C                   IF        *IN33 = *OFF
N19  C                   MOVE      'P'           KOPUNI
N19  C                   Z-ADD     81            KOPLNR
N19  C     KODTPK        CHAIN     KODTP                              33
N19  C                   MOVE      KOPNVN        W3PRT1
N19  C                   Z-ADD     82            KOPLNR
N19  C     KODTPK        CHAIN     KODTP                              33
N19  C                   MOVE      KOPNVN        W3PRT2
N19  C                   Z-ADD     83            KOPLNR
N19  C     KODTPK        CHAIN     KODTP                              33
N19  C                   MOVE      KOPNVN        W3PRT3
N19  C                   EXFMT     BILDE02
N19  C   12              GOTO      SLPRTOMB
N19  C                   MOVE      'PRT'         XTYPE             3
N19  C                   EVAL      SITDN = SITDN * -1
N19  C     *IN28         IFEQ      '1'
N19  C                   CALL      'SAD061CO'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
N19  C                   PARM                    USG
N19  C                   PARM                    XTYPE
N19  C                   PARM                    UMODE
N19  C                   MOVE      'H'           PRTTYP            1
N19  C                   CALL      'SAD61P'
N19  C                   PARM                    PRTTYP            1
N19  C                   PARM                    PRTAVD            4
N19  C                   PARM                    PRTTDN            7
N19  C                   PARM                    W3PRT1
N19  C                   PARM                    W3PRT2
N19  C                   PARM                    W3PRT3
N19  C                   EVAL      SITDN = SITDN * -1
N19  C     SADHKO        CHAIN     SADHOPD                            33
N19  C                   ELSE
N19  C                   CALL      'SAD061CL'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
N19  C                   PARM                    USG
N19  C                   PARM                    XTYPE
N19  C                   PARM                    UMODE
N19  C                   EVAL      SITDN = SITDN * -1
N19  C     SADHKO        CHAIN     SADHOPD                            33
N19  C                   CALL      'SAD61P01'
N19  C                   PARM                    W3PRT1
N19  C                   PARM                    W3PRT2
N19  C                   PARM                    W3PRT3
N19  C                   END
N19  C     SLPRTOMB      TAG
N34  C                   END
N19  C                   END
N19  C  N90              MOVE      *ZEROS        WSNR
N19  C  N90              MOVE      XIN50         *IN50
N19  C  N90              MOVE      XIN36         *IN36
N19  C  N90              UPDATE    SUBFIL
N19   *
N19  C                   ENDSR
N19   *
     C***********************************************
     C     DSPTVI        BEGSR
     C***********************************************
     C                   MOVE      '0'           WIN03             1
     C                   CALL      'SAD003'
S30  C*                  PARM      SIAVD         SIAVD
S30  C*                  PARM      SITDN         SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
     C                   PARM                    WIN03
     C     WIN03         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C*
N15   ***********************************************
N15  C     DSPOMB        BEGSR
N15   ***********************************************
N15  C                   Z-ADD     SIAVD         XAVD
N15  C                   Z-SUB     SITDN         O2_SITDN
N15  C     SADHO2K       CHAIN     SADHO2                             33
N15  C                   IF        *IN33 = *OFF
N15  C                   Z-SUB     SITDN         XTDN
N15  C                   CALL      'SAD005A'
N15  C                   PARM                    XAVD
N15  C                   PARM                    XTDN
N15  C                   PARM                    UFLAGG            1 0
S26  C*                  IF        O2_SIST <> 'P'
N26  C                   IF        O2_SITLL = SITLL
N20  C                   EVAL      O2_SITLL = *BLANKS
N20  C                   END
N15  C                   END
N15  C  N90              MOVE      *ZEROS        WSNR
N15  C  N90              MOVE      XIN50         *IN50
N15  C  N90              MOVE      XIN36         *IN36
N15  C  N90              UPDATE    SUBFIL
N15   *
N15  C                   ENDSR
N15   *
N15   ***********************************************
N15  C     CHGOMB        BEGSR
N15   ***********************************************
N15  C                   IF        SIDTG <> *BLANKS AND SITLL <> *BLANKS
N15  C                   MOVE      'OMB'         XTYPE             3
N15  C                   Z-ADD     SIAVD         XAVD
N15  C                   Z-SUB     SITDN         XTDN
N15  C                   Z-SUB     SITDN         O2_SITDN
N15  C     SADHO2K       CHAIN     SADHO2                             33
N15  C                   IF        *IN33 OR O2_SIST = ' ' OR O2_SIST = 'M' OR
N21  C                             O2_SIST = 'Q' OR
N21  C                             O2_SIST = 'P' AND O2_SIMF = *BLANKS
N34  C                             OR O2_SIST = 'P' AND O2_SITLL = SITLL
S21  C*                            O2_SIST = 'Q'
N15  C                   CALL      'SAD061COM'
N15  C                   PARM                    XAVD
N15  C                   PARM                    XTDN
N15  C                   PARM                    USG
N15  C                   PARM                    XTYPE
N15  C                   PARM                    UMODE
N25  C                   ELSE
N25  C                   IF        (O2_SIST = 'P' AND O2_SIMF <> *BLANKS)
N25  C                             OR (O2_SIST = 'Z' AND O2_SIMF <> *BLANKS)
N25  C                   EVAL      WSNYOMB = 'N'
N25  C                   EVAL      WSSOMB  = 'J'
N25  C                   EXFMT     BNYOMB
N25  C                   IF        WSNYOMB = 'J'
N25  C                   IF        WSSOMB = 'J'
N25  C                   MOVE      'NYS'         XTYPE             3
N25  C                   ELSE
N25  C                   MOVE      'NYO'         XTYPE
N25  C                   END
N25  C                   CALL      'SAD061COM'
N25  C                   PARM                    XAVD
N25  C                   PARM                    XTDN
N25  C                   PARM                    USG
N25  C                   PARM                    XTYPE
N25  C                   PARM                    UMODE
N25  C                   END
N25  C                   END
N15  C                   END
N15  C                   END
N15   *
N15  C                   EVAL      O2_SITDN = SITDN * -1
N15  C     SADHO2K       CHAIN     SADHO2                             33
N15  C                   IF        *IN33
N15  C                   EVAL      O2_SIMF = *BLANKS
N15  C                   EVAL      O2_SIST = *BLANKS
N15  C                   EVAL      WSDT3   = 0
N15  C                   ELSE
S26  C*                  IF        O2_SIST <> 'P'
N26  C                   IF        O2_SITLL = SITLL
N20  C                   EVAL      O2_SITLL = *BLANKS
N25  C                   END
N15  C                   EVAL      WSDTD3  = O2_SIDTD
N15  C                   EVAL      WSDTM3  = O2_SIDTM
N15  C                   MOVE      O2_SIDTA      WSDTA3
N15  C                   END
N15  C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N15  C     FRIKEY        CHAIN     FRISOK                             39
N15  C     *IN39         IFEQ      *OFF
N15  C                   EVAL      WSNAK = FSSOK
N15  C                   ENDIF
N15  C  N90              MOVE      *ZEROS        WSNR
N15  C  N90              MOVE      XIN50         *IN50
N15  C  N90              MOVE      XIN36         *IN36
N15  C  N90              UPDATE    SUBFIL
N15   *
N15  C                   ENDSR
N15   *
N25   ***********************************************
N25  C     ANGOMB        BEGSR
N25   ***********************************************
N25  C                   IF        SIDTG <> *BLANKS AND SITLL <> *BLANKS
N25  C                   MOVE      'NYA'         XTYPE             3
N25  C                   Z-ADD     SIAVD         XAVD
N25  C                   Z-SUB     SITDN         XTDN
N25  C                   Z-SUB     SITDN         O2_SITDN
N25  C     SADHO2K       CHAIN     SADHO2                             33
N25  C  N33              IF        (O2_SIST = ' ' OR O2_SIST = 'M')
N25  C                             AND O2_SITLL = SITLL
N25  C                   CALL      'SAD064'
N25  C                   PARM                    XAVD
N25  C                   PARM                    XTDN
N25  C                   PARM                    USG
N25  C                   PARM                    XTYPE
N25  C                   END
N25  C                   END
N25   *
N25  C                   EVAL      O2_SITDN = SITDN * -1
N25  C     SADHO2K       CHAIN     SADHO2                             33
N25  C                   IF        *IN33
N25  C                   EVAL      O2_SIMF = *BLANKS
N25  C                   EVAL      O2_SIST = *BLANKS
N25  C                   EVAL      WSDT3   = 0
N25  C                   ELSE
S26  C*                  IF        O2_SIST <> 'P'
N26  C                   IF        O2_SITLL = SITLL
N25  C                   EVAL      O2_SITLL = *BLANKS
N25  C                   END
N25  C                   EVAL      WSDTD3  = O2_SIDTD
N25  C                   EVAL      WSDTM3  = O2_SIDTM
N25  C                   MOVE      O2_SIDTA      WSDTA3
N25  C                   END
N25  C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
N25  C     FRIKEY        CHAIN     FRISOK                             39
N25  C     *IN39         IFEQ      *OFF
N25  C                   EVAL      WSNAK = FSSOK
N25  C                   ENDIF
N25  C  N90              MOVE      *ZEROS        WSNR
N25  C  N90              MOVE      XIN50         *IN50
N25  C  N90              MOVE      XIN36         *IN36
N25  C  N90              UPDATE    SUBFIL
N25   *
N25  C                   ENDSR
N25   *
     C***********************************************
     C     FAXSAD        BEGSR
     C***********************************************
     C                   CALL      'FAX025B'
S30  C*                  PARM      SIAVD         SIAVD
S30  C*                  PARM      SITDN         SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
N29  C***********************************************
N29  C     SLETTFP       BEGSR
N29  C***********************************************
N29  C                   CALL      'SAD005FP'
S30  C*                  PARM      SIAVD         SIAVD
S30  C*                  PARM      SITDN         SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
N29  C  N90              MOVE      *ZEROS        WSNR
N29  C  N90              MOVE      XIN50         *IN50
N29  C  N90              MOVE      XIN36         *IN36
N29  C  N90              UPDATE    SUBFIL
N29  C*
N29  C                   ENDSR
N12   ***********************************************
N12  C     WRKFT         BEGSR
N12   ***********************************************
N12  C                   Z-ADD     0             UFLAGG
N12  C                   CALL      'SYFA31CL'
N12  C                   PARM      SIAVD         UAVD2
N12  C                   PARM      SITDN         UOPD2
N12  C                   PARM                    UFLAGG
N12   *
N12  C  N90              MOVE      *ZEROS        WSNR
N12  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
N12  C  N90              UPDATE    SUBFIL
N12   *
N12  C                   ENDSR
N12   *
     C***********************************************
     C     PDFSAD        BEGSR
     C***********************************************
     C                   MOVE      SIAVD         AAVD              4
     C                   MOVE      SITDN         ATDN              7
     C                   MOVE      'I'           TDTYP             1
     C                   move      *blanks       ubane            50
     C                   move      *blanks       updf
N35  C                   move      *blanks       ubane2           50
N35  C                   move      *blanks       updf2           152
s35  c*                  movel     'http://'     updf             70
n35  c*                  movel     'http://'     updf            152
N43  c                   movel     'https://'    updf            152
s43  C*    updf          CAT       pdipad:0      updf
N43  C     updf          CAT       ARCPAD:0      updf
N43  c     gotmpf        ifeq      *blanks
     C     updf          CAT       '/':0         updf
     C     updf          CAT       pdbane:0      updf
     C     updf          CAT       '/':0         updf
N43  c                   else
N43  C     updf          CAT       gotmpf:0      updf
N43  c                   end
     C     updf          CAT       aavd:0        updf
     C     updf          CAT       atdn:0        updf
N35  C                   eval      updf2=updf
     C     updf          CAT       'si':0        updf
N35  C     updf2         CAT       'dt':0        updf2
     C     updf          CAT       '.pdf':0      updf
N35  C     updf2         CAT       '.pdf':0      updf2
N43  c     gotmpf        ifeq      *blanks
     C                   movel     '/'           ubane
     C     ubane         CAT       pdbane:0      ubane
     C     ubane         CAT       '/':0         ubane
N43  c                   else
N43  C     ubane         CAT       gotmpf:0      ubane
N43  c                   end
     C     ubane         CAT       aavd:0        ubane
     C     ubane         CAT       atdn:0        ubane
N35  c                   eval      ubane2=ubane
     C     ubane         CAT       'si':0        ubane
N35  C     ubane2        CAT       'dt':0        ubane2
     C     ubane         CAT       '.pdf':0      ubane
N35  C     ubane2        CAT       '.pdf':0      ubane2
s35  c*                  move      'J'           vise
s35  C*                  CALL      'PDF001CL'
n35  C                   CALL      'PDF001CLD'
     C                   PARM                    AAVD
     C                   PARM                    ATDN
     C                   PARM                    TDTYP
     C                   PARM                    updf
     C                   PARM                    ubane
n35  C                   PARM                    updf2
n35  C                   PARM                    ubane2
s35  C*                  parm                    vise              1
s35  C*                  parm                    finst             1
s35  C*                  parm                    finst             1
s35  C*                  parm                    ARCINF            1
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C*
     C                   ENDSR
      ***********************************************
     C     SRTT          BEGSR
      ***********************************************
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
      * T&T å oppdragsnivå.
     C                   Z-ADD     1             TTFLAG            1 0
     C                   CALL      'SYTT01CL'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
     C                   PARM                    NULPRO            8 0
     C                   PARM                    TTFLAG
     C                   ENDSR
      ***********************************************
     C     PRTSKILL      BEGSR
      ***********************************************
     C  N90              MOVE      *ZEROS        WSNR
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     SIAVD         SCASTR9          11
     C                   MOVE      SITDN         SCASTR9
     C                   MOVEL     SCASTR9       SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   ENDSR
     C*
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
     C  N90              update    subfil
     C                   CALL      'ARC003'
     C                   PARM      SIAVD         UAVD2             4 0
     C                   PARM      SITDN         UOPD2             7 0
     C                   PARM                    URUNDE           10
     C                   ENDSR
      *
N31   ***********************************************
N31  C     XMLSR         BEGSR
N31   ***********************************************
N31  C                   MOVE      SIAVD         AAVD
N31  C                   MOVE      SITDN         ATDN
N33  c     wsnr          ifeq      89
N33  c                   z-sub     sitdn         sitdnm            7 0
N33  C                   MOVE      SiTDNM        ATDN
N33  c                   end
N31  C                   MOVE      'I'           TDTYP             1
N31  C  N90              move      *zeros        wsnr
N31  C  N90              MOVE      XIN50         *IN50
N31  C  N90              MOVE      XIN36         *IN36
N31  C  N90              update    subfil
N31  C                   CALL      'PDF001CL3'
N31  C                   PARM                    AAVD
N31  C                   PARM                    ATDN
N31  C                   PARM                    TDTYP
N31  C                   EXSR      TTSR
N31  C                   ENDSR
N31   ************************************************************
N31  C     TTSR          begsr
N31   ************************************************************
N31  c                   clear                   trackfr
N31   * skriver til track & trace
N31  C                   eval      tttext='Re-Transferred XML of custdec to:'
N31  C     tttext        cat       CFAX:1        tttext
N31  C                   move      CCOMPN        tttext
N31  C                   eval      tttexl='Re-Overført XML av tolldek til:'
N31  C     tttexl        cat       CFAX:1        tttexl
N31  C                   move      CCOMPN        tttexl
N31  C                   MOVE      'XML'         TTACTI
N31   * OPPDRAG OPPRETTET (POST I FIL TRACKF)
N31  C                   MOVE      AAVD          TTAVD
N31  C                   MOVE      ATDN          TTOPD
N31  C                   TIME                    XULTID
N31  C                   MOVE      XULDD         ULDD
N31  C                   MOVE      XULMM         ULMM
N31  C                   MOVE      XULÅÅ         ULÅÅ
N31  C                   MOVE      ULDT          TTDATE
N31  C                   MOVE      XULTM         TTTIME
N31  C                   MOVE      TTDATE        TTDATL
N31  C                   MOVE      TTTIME        TTTIML
N31  C                   MOVE      UUSR          TTUSER
N31  C                   MOVEL     SINAK         TTNAME
N31  C                   WRITE     TRACKFR
N31  C                   ENDSR
N08
N08   ***********************************************
N08  C     DSPWEB        BEGSR
N08   ***********************************************
N08  C  N90              move      *zeros        wsnr
N10  C  N90              MOVE      XIN50         *IN50
N12  C  N90              MOVE      XIN36         *IN36
N08  C  N90              update    subfil
N08  C                   EVAL      Overskr = 'Se SYSPED oppdrag på WEB (eSped) '
N08  C                   EVAL      WebType = 'ESPEO'
N08  C                   move      SIAVD         HEAVDA            4
N08  C                   move      SITDN         HEOPDA            7
N08  C                   EVAL      WebSok  = '&heavd='+HEAVDA+
N08  C                             '&heopd='+HEOPDA
N08  C                   CALL      'WEBLINKR'
N08  C                   PARM                    Overskr          40
N08  C                   PARM                    WebType           5
N08  C                   PARM                    WebSok           50
N08  C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KOANVN
     C     WSAAVD        IFNE      0
     C     WSTDN         ORNE      0
     C     WSAAVD        CHAIN     STANDI                             99
     C  N99KODTAK        CHAIN     KODTA                              99
N10  C   99              Z-ADD     4             LINNBR
N10  C   99              Z-ADD     26            POSNBR
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB1
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C*
s04  C*                  MOVEA     '000000000'   *IN(41)
n04  C                   MOVEA     '000000000000'*IN(38)
n07  C                   MOVEA     '0'           *IN(37)
s41  C*                  MOVEA     '0'           *IN(51)
N41  C                   MOVEA     '00'          *IN(51)
N30  C                   MOVEA     '00'          *IN(34)
     C*
N41  C     WSFRI1        comp      *blanks                            5252
N41  C   52              GOTO      STTB1
N28  C                   MOVE      WSTLE         WSTLEA            6
     C     WFSSOK        comp      *BLANKS                            4040
N05  C   40              EVAL      WFSSOKMAX = %TRIM(WFSSOK)
N05  C                             + '9999999999999999999999999999999999'
     C   40              GOTO      STTB1
     C     WSDT          COMP      *ZEROS                             4141
     C   41              GOTO      STTB1
     C     WSTDN         COMP      *ZEROS                             4242
     C   42              GOTO      STTB1
     C     WSKNS         COMP      *ZEROS                             4343
     C   43              GOTO      STTB1
     C     WSKNK         COMP      *ZEROS                             4444
     C   44              GOTO      STTB1
     C     WSSG          COMP      *BLANKS                            4545
     C   45              GOTO      STTB1
     C     WSGN          COMP      *BLANKS                            4747
     C   47              GOTO      STTB1
     C     WSTLL         COMP      *BLANKS                            4646
     C   46WSTLL         IFEQ      '*'
     C                   MOVE      *BLANKS       WSTLL
     C                   END
     C   46              GOTO      STTB1
     C     WSST          COMP      *BLANKS                            4949
     C   49              GOTO      STTB1
N37  C     WSSTOMB       COMP      *BLANKS                            5151
N37  C   51              GOTO      STTB1
     C     WSMI          COMP      'I'                                    48
     C   48              GOTO      STTB1
N04  C     WSSEKV        COMP      0                                  38
n04  C   38WSSEKD        COMP      0                                  38
n04  C   38              GOTO      STTB1
n07  C     WSRG          COMP      *BLANKS                            3737
n07  C   37              eval      koanvn='Foretaksnr:'
n07  C   37koanvn        cat       wsrg:1        koanvn
n07  C   37              GOTO      STTB1
N30  C     WSFN          COMP      *BLANKS                            3535
N30  C   35              GOTO      STTB1
N30  C     WSMRK         COMP      *BLANKS                            3434
N30  C   34              GOTO      STTB1
     C*
     C                   MOVE      'DIV0064'     MSGNR
     C                   SETON                                        3098
N10  C                   Z-ADD     9             LINNBR
N10  C                   Z-ADD     35            POSNBR
     C                   GOTO      SLTB1
     C*
     C     STTB1         TAG
     C   43              MOVE      WSKNS         KUNDNR
     C   43KUNDK         CHAIN     CUNDL01                            97
     C   97              MOVE      'SPK0035'     MSGNR
     C   44              MOVE      WSKNK         KUNDNR
     C   44KUNDK         CHAIN     CUNDL01                            96
     C   96
     CANN97              MOVE      'SPK0035'     MSGNR
     C   97
     COR 96              SETON                                        30
N10  C   96              Z-ADD     12            LINNBR
N10  C   96              Z-ADD     35            POSNBR
N10  C   97              Z-ADD     11            LINNBR
N10  C   97              Z-ADD     35            POSNBR
N10   * ved filter på staus regnes * som blank
N10  c                   move      WSSGST        TstSGST           1
N10  C     WSSGST        Ifeq      '*'                                          * = blank
N10  c                   move      ' '           TstSGST
N10  c                   endif
     C*
     C     SLTB1         ENDSR
     C*
N15   ***********************************************
N15  C     TESTB2        BEGSR
N15   ***********************************************
N15  C                   IF        (SIST<>'P' AND SIST<>'U' AND SIST<>' ') OR
N15  C                             SIDTG = *BLANKS OR SITLL = *BLANKS OR
N15  C                             (O2_SIST <> ' ' AND O2_SIST <> 'M' AND
N25  C                              O2_SIST <> 'Z' AND
N21  C                              O2_SIST <> 'Q' AND O2_SIST <> 'P' )
S25  C*                            OR (O2_SIST = 'P' AND O2_SIMF <> *BLANKS)
S21  C*                             O2_SIST <> 'Q')
N15  C                   MOVE      '1'           *IN30
N15  C                   MOVE      'YBC2011'     MSGNR
N15  C                   MOVE      *ZEROS        WSNR
N15  C                   MOVE      XIN50         *IN50
N15  C                   MOVE      XIN36         *IN36
N15  C                   GOTO      SLTB2
N15  C                   END
N15   *
N15   *
N15  C     SLTB2         ENDSR
N15   *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C   41              DO
NV5  C     WSDT          IFEQ      0
NV5  C                   MOVE      *ZEROS        XDT
NV5  C                   ELSE
     C                   MOVE      XDTDD         XDTDD2
     C                   MOVE      XDTMM         XDTMM2
SV5  C*                    MOVE XDTÅÅ     XDTÅÅ2
NV5  C     XDTÅÅ         IFGT      50
NV5  C     XDTÅÅ         ADD       1900          XDTÅÅ2
NV5  C                   ELSE
NV5  C     XDTÅÅ         ADD       2000          XDTÅÅ2
NV5  C                   END
NV5  C                   END
     C                   END
     C   43              DO
NV5  C                   SELECT
NV5  C     WSDTS         WHENEQ    0
NV5  C                   MOVE      *ZEROS        XDTS
NV5  C                   OTHER
     C                   MOVE      XDTSD         XDTSD2
     C                   MOVE      XDTSM         XDTSM2
SV5  C*                    MOVE XDTSÅ     XDTSÅ2
NV5  C     XDTSÅ         IFGT      50
NV5  C     XDTSÅ         ADD       1900          XDTSÅ2
NV5  C                   ELSE
NV5  C     XDTSÅ         ADD       2000          XDTSÅ2
NV5  C                   END
NV5  C                   ENDSL
     C                   END
     C   44              DO
NV5  C     WSDTK         IFEQ      0
NV5  C                   MOVE      *ZEROS        XDTK
NV5  C                   ELSE
     C                   MOVE      XDTKD         XDTKD2
     C                   MOVE      XDTKM         XDTKM2
SV5  C*                    MOVE XDTKÅ     XDTKÅ2
NV5  C     XDTKÅ         IFGT      50
NV5  C     XDTKÅ         ADD       1900          XDTKÅ2
NV5  C                   ELSE
NV5  C     XDTKÅ         ADD       2000          XDTKÅ2
NV5  C                   END
NV5  C                   END
     C                   END
     C   45              DO
NV5  C     WSDTT         IFEQ      0
NV5  C                   MOVE      *ZEROS        XDTT
NV5  C                   ELSE
     C     WSDTT         IFEQ      999999
     C                   MOVE      99999999      XDTT
     C                   ELSE
     C                   MOVE      XDTTD         XDTTD2
     C                   MOVE      XDTTM         XDTTM2
SV5  C*                    MOVE XDTTÅ     XDTTÅ2
NV5  C     XDTTÅ         IFGT      50
NV5  C     XDTTÅ         ADD       1900          XDTTÅ2
NV5  C                   ELSE
NV5  C     XDTTÅ         ADD       2000          XDTTÅ2
NV5  C                   END
     C                   END
NV5  C                   END
     C                   END
N04  C   38              DO
N04  C     WSSEKD        IFEQ      0
N04  C                   MOVE      *ZEROS        XSEKDT
N04  C                   ELSE
N04  C                   MOVE      XSSD          XSSD2
N04  C                   MOVE      XSSM          XSSM2
NV5  C     XSSÅ          IFGT      50
N04  C     XSSÅ          ADD       1900          XSSÅ2
N04  C                   ELSE
N04  C     XSSÅ          ADD       2000          XSSÅ2
N04  C                   END
N04  C                   END
N04  C                   END
N07  C   37              DO
N07  C     WSDTRG        IFEQ      0
N07  C                   MOVE      *ZEROS        XDTRG
N07  C                   ELSE
N07  C                   MOVE      XDTRD         XDTRD2
N07  C                   MOVE      XDTRM         XDTRM2
N07  C     XDTRÅ         IFGT      50
N07  C     XDTRÅ         ADD       1900          XDTRÅ2
N07  C                   ELSE
N07  C     XDTRÅ         ADD       2000          XDTRÅ2
N07  C                   END
N07  C                   END
N07  C                   END
     C*
     C     WSAAVD        IFEQ      0
S06  C*                  Z-ADD     1             YAVD              4 0
     C                   EXSR      MINSAL
     C                   ELSE
     C                   EXSR      MINSAD
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MINSAD        BEGSR
     C***********************************************
      * SET KEY NÅR SØK KUN I EN !!!!  AVDELING
n04  C   38edim7k        SETLL     edim7
     C   40FR1KEY        SETLL     FRISOL01
N41  C   52FRIKEYNY      SETGT     FRISOL01
     C   41SADH1K        SETLL     SADH1
     C   42SADHK         SETLL     SADH
     C   43SADH3K        SETLL     SADH3
     C   44SADH2K        SETLL     SADH2
     C   45WSDTT         IFEQ      999999
     C     SADH4K        SETGT     SADH4
     C                   ELSE
     C     SADH4K        SETLL     SADH4
     C                   END
N28  C   46              IF        WSTLEA = *ZEROS
     C   46SADH5K        SETLL     SADH5
N28  C                   ELSE
N28  C     SADH12K       SETLL     SADH12
N28  C                   END
     C   47SADH6K        SETLL     SADH6
     C   48SADH7K        SETLL     SADH7
     C   49SADH0K        SETLL     SADH10
N37  C   51SADH14K       SETLL     SADH14
N07  C   37SADH13K       SETLL     SADH13
N30  C   35SADFNJL1K     SETLL     SADFNJL1
S40  C*  34SADMNJL1K     SETLL     SADMNJL1
N40  C   34SADVCNL1K     SETLL     SADVCNL1
N40  C   34              EVAL      SITDN = 0
N40  C   34              EVAL      SVMRK = *BLANKS
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MINSAL        BEGSR
     C***********************************************
      * SET KEY NÅR SØK I ALLE !!  AVDELINGER
n04  C   38edim7k        SETLL     edim7
     C   40FR1KEY        SETLL     FRISOL01
N41  C   52FRIKEYNY      SETGT     FRISOL01
S06  C*  41SADA1K        SETLL     SADH1
S06  C*  43SADA3K        SETLL     SADH3
S06  C*  44SADA2K        SETLL     SADH2
S06  C*  45WSDTT         IFEQ      999999
S06  C*    SADA4K        SETGT     SADH4
S06  C*                  ELSE
S06  C*    SADA4K        SETLL     SADH4
S06  C*                  END
N06  C   41SADA1K        SETLL     SADH1B
N06  C   43SADA3K        SETLL     SADH3B
N06  C   44SADA2K        SETLL     SADH2B
N06  C   45WSDTT         IFEQ      999999
N06  C     SADA4K        SETGT     SADH4B
N06  C                   ELSE
N06  C     SADA4K        SETLL     SADH4B
N06  C                   END
N28  C   46              IF        WSTLEA = *ZEROS
     C   46WSTLL         SETLL     SADH5B
N28  C                   ELSE
N28  C     SADH12BK      SETLL     SADH12B
N28  C                   END
     C   47WSGN15        SETLL     SADH6B
S06  C*  48SADA7K        SETLL     SADH7
S06  C*  49SADA0K        SETLL     SADH10
N06  C   48SADA7K        SETLL     SADH7B
S36  C*  49SADA0K        SETLL     SADH10B
N36  C   49SADA0K        SETLL     SADH9
N37  C   51SADA14K       SETLL     SADH14B
N07  C   37SADH13BK      SETLL     SADH13B
N30  C   35WSFN          SETLL     SADFNJL2
S40  C*  34WSMRK         SETLL     SADMNJL2
N40  C   34WSMRK         SETLL     SADVCNL2
N40  C   34              EVAL      SIAVD = 0
N40  C   34              EVAL      SITDN = 0
N40  C   34              EVAL      SVMRK = *BLANKS
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
      * NÅR KUN EN AVD.....
     C     STTLL         TAG
N10   *
N10  C     MAXLES        ifne      *zeros
N10  C     LestRec       andgt     Maxles
N10  c                   move      *on           *in94
N10  c                   move      *on           *in30
N10  C                   MOVE      'JOV1524'     MSGNR
N10  c                   goto      UtLes
N10  C                   endif
      *
N04   * sekvens i EDIM
N04  C     *IN38         IFEQ      '1'
N04  C     LESNYSE1      TAG
N04  C                   SETOFF                                       33
N04  C                   READ      EDIM7                                  94
N04  C  N94SADEDIM       CHAIN     SADH                               33
N04  C   33              GOTO      LESNYSE1
N04  C  N94WSAAVD        CABNE     MAVD          LESNYSE1
N04  C     EDIM7K2       SETGT     EDIM7
N04  C                   END
N41  C     LESNYFRI2     TAG
N41  c     *in52         ifeq      '1'
N41  c     FRIKEYNY      READPE    FRISOL01                               94
N41  c     *in94         ifeq      '0'
N41  C  N94SADHFRI       CHAIN     SADH                               33
N41  C   33              GOTO      LESNYFRI2
N41  C                   GOTO      UTLES
N41  C                   END
N41  C                   END
     C     *IN40         IFEQ      '1'
     C     LESNYFRI      TAG
     C                   SETOFF                                       33
     C     FR1KEYE       READE     FRISOL01                               94
N05  C  N94WFSSOKMAX     COMP      FSSOK                                94
     C  N94SADHFRI       CHAIN     SADH                               33
     C   33              GOTO      LESNYFRI
     C                   END
     C   41WSAAVD        READE     SADH1                                  94
     C   42WSAAVD        READE     SADH                                   94
     C   43WSAAVD        READE     SADH3                                  94
     C   43
     CANN94WSKNS         COMP      SIKNS                              9494
     C   44WSAAVD        READE     SADH2                                  94
     C   44
     CANN94WSKNK         COMP      SIKNK                              9494
     C   45WSDTT         IFEQ      999999
     C     WSAAVD        READPE    SADH4                                  94
     C  N94WSSG          COMP      SISG                               9494
     C                   ELSE
     C     WSAAVD        READE     SADH4                                  94
     C  N94WSSG          COMP      SISG                               9494
     C                   END
N28  C   46              IF        WSTLEA = *ZEROS
     C   46WSAAVD        READE     SADH5                                  94
N28  C                   ELSE
N28  C     SADH12K2      READE     SADH12                                 94
N28  C                   END
     C   47WSAAVD        READE     SADH6                                  94
     C   48SADH7K        READE     SADH7                                  94
     C   49SADH0K        READE     SADH10                                 94
N37  C   51SADH14K       READE     SADH14                                 94
     C   37SADH13KE      READE     SADH13                                 94
N30  C   35WSAAVD        READE     SADFNJL1                               94
N30  C   35              IF        *IN94 = *OFF
N30  C                   EVAL      X_FN = SIFIF
N30  C                   MOVE      SIFID         X_FN             26
N30  C     SADHKO        CHAIN     SADH                               33
N30  C                   EVAL      WSNAK = X_FN
N30  C                   END
S40  C*  34WSAAVD        READE     SADMNJL1                               94
N40  C   34WSAAVD        READE     SADVCNL1                               94
N40  C   34              DOW       *IN94 = *OFF
N40  C                   IF        CN_SVTDN <> SITDN OR CN_SVCNR <> SVMRK
N40  C                   EVAL      SITDN = CN_SVTDN
N40  C                   EVAL      SVMRK = CN_SVCNR
N40  C                   LEAVE
N40  C                   END
N40  C     WSAAVD        READE     SADVCNL1                               94
N40  C                   ENDDO
N30  C   34              IF        *IN94 = *OFF
N30  C                   EVAL      X_MRK = SVMRK
N30  C     SADHKO        CHAIN     SADH                               33
N30  C                   EVAL      WSNAK = X_MRK
N30  C                   END
N38   *
N38  C  N94              IF        WSANAV <> *BLANKS OR WSMNAV <> *BLANKS
N38  C                   EXSR      TSTAVSMOT
N38  C     AMExclude     cabeq     'Y'           STTLL
N38  C                   END
N24   *
N24  C  N94
N39  CANN38
N28  CANN46
N37  CANN51
N24  CANN42              IF        SITDN < 0
N24  C                   GOTO      LESNYFRI
N24  C                   END
N24   *
     C  N94              DO
S18  C*    SITDN         CABLT     0             STTLL
S22  C* N46SITDN         CABLT     0             STTLL
N22  C  N41
N39  CANN38
N22  CANN45
N22  CANN46
N37  CANN51
N22  CANN49SITDN         CABLT     0             STTLL
S22  C*  46              IF        SITDN < 0
N22  C                   MOVE      'N'           XSADOMB           1
N22  C                   MOVE      ' '           XSADOMBST         1
N22  C   41
N39  COR 38
N22  COR 45
N22  COR 46
N37  COR 51
N22  COR 49              IF        SITDN < 0
N22  C                   EVAL      XSADOMB = 'J'
N22  C                   EVAL      XSADOMBST = SIST
N18  C                   EVAL      SITDN = SITDN * -1
N18  C     SADHKO        CHAIN     SADH                               33
N18  C                   END
     C                   MOVE      SIDTD         WSDTD2
     C                   MOVE      SIDTM         WSDTM2
     C                   MOVE      SIDTÅ         WSDTÅ2
N10  c                   add       1             LestRec
     C     WSTLL         IFEQ      '*'
     C     SITLL         ANDNE     *BLANKS
     C                   GOTO      STTLL
     C                   END
N10   * filter på status (Normalt knyttet knyttet til signatur-søk, men KAN kombineres med annet..)
N10  C     WSSGST        ifne      ' '
N22  C     XSADOMB       ANDEQ     'N'
N10  C     SIST          andne     TstSGST
N22  C     WSSGST        ORNE      ' '
N22  C     XSADOMB       ANDEQ     'J'
N22  C     XSADOMBST     ANDNE     TstSGST
N10  C                   GOTO      STTLL
N10  C                   END
N10   * kun uferdige ALLe (blank status/men løpnr = ferdig, Ruckattest regisytrert...)
N10  C     WSKUF         IFeq      'U'
N10  C     SIST          Ifeq      'S'
N22  C     XSADOMB       ANDEQ     'N'
N10  C*    SIST          oreq      'P'
N10  C*    SIST          oreq      'U'
N10  C     SITLL         ORNE      *BLANKS                                      LØPENR ER FÅTT
N22  C     XSADOMB       ANDEQ     'N'
N22  C     XSADOMB       OREQ      'J'
N22  C     XSADOMBST     ANDEQ     'P'
N22  C     XSADOMB       OREQ      'J'
N22  C     XSADOMBST     ANDEQ     'Z'
N10  C                   GOTO      STTLL
N10  C                   END
N10  C*    SIST          Ifeq      ' '
N10  C*    SITLL         andne     *blanks                                      eksternfortollet??
N10  C*                  GOTO      STTLL
N10  C*                  END
N10  C                   END
N10   * kun uferdige som VENTER på handling Handling
N10  C     WSKUF         IFeq      'O'
N10  C     SIST          ifne      'M'
N10  C     SIST          andne     'D'
N10  C     SIST          andne     'V'
N45  C     SIST          andne     '1'
N22  C     XSADOMB       ANDEQ     'N'
N22  C     XSADOMB       OREQ      'J'
N22  C     XSADOMBST     ANDNE     'M'
N22  C     XSADOMBST     ANDNE     'D'
N45  c                   add       1             LestRec
N10  C                   GOTO      STTLL
N10  C                   END
N10  C                   END
      *
     C                   END
     C*
S10  C*                  ENDSR
N10  C     UtLes         ENDSR
     C*
     C***********************************************
     C     LESRAL        BEGSR
     C***********************************************
      * NÅR PÅ TVERS AV ALLE AVDELINGER
     C     STLRAL        TAG
N10   *
N10  C     MAXLES        ifne      *zeros
N10  C     LestRec       andgt     Maxles
N10  c                   move      *on           *in94
N10  c                   move      *on           *in30
N10  C                   MOVE      'JOV1524'     MSGNR
N10  c                   goto      UtLesA
N10  C                   endif
      *
N04   * sekvens i EDIM
N04  C     *IN38         IFEQ      '1'
N04  C     LESNYSE2      TAG
N04  C                   SETOFF                                       33
N04  C                   READ      EDIM7                                  94
N04  C  N94SADEDIM       CHAIN     SADH                               33
N04  C   33              GOTO      LESNYSE2
N04  C     EDIM7K2       SETGT     EDIM7
N04  C                   END
N41  c     lesnyfri3     tag
N41  c     *in52         ifeq      '1'
N41  c     FRIKEYNY      READPE    FRISOL01                               94
N41  c     *in94         ifeq      '0'
N41  C     SADHFRI       CHAIN     SADH                               33
N41  C   33              GOTO      LESNYFRI3
N41  C                   GOTO      UTLESA
N41  C                   END
N41  C                   END
      * fri søkevei
     C     *IN40         IFEQ      '1'
     C     LESNYFR2      TAG
     C                   SETOFF                                       33
     C     FR1KEYE       READE     FRISOL01                               94
N05  C  N94WFSSOKMAX     COMP      FSSOK                                94
     C  N94SADHFRI       CHAIN     SADH                               33
     C   33              GOTO      LESNYFR2
     C                   END
S06  C*  41YAVD          READE     SADH1                                  94
N06  C   41              READ      SADH1B                                 94
S06  C*  43YAVD          READE     SADH3                                  94
S06  C*  43
S06  C*NN94WSKNS         COMP      SIKNS                              9494
N06  C   43WSKNS         READE     SADH3B                                 94
S06  C*  44YAVD          READE     SADH2                                  94
S06  C*  44
S06  C*NN94WSKNK         COMP      SIKNK                              9494
N06  C   44WSKNK         READE     SADH2B                                 94
     C   45WSDTT         IFEQ      999999
S06  C*    YAVD          READPE    SADH4                                  94
S06  C* N94WSSG          COMP      SISG                               9494
N06  C     WSSG          READPE    SADH4B                                 94
     C                   ELSE
S06  C*    YAVD          READE     SADH4                                  94
S06  C* N94WSSG          COMP      SISG                               9494
N06  C     WSSG          READE     SADH4B                                 94
     C                   END
N28  C   46              IF        WSTLEA = *ZEROS
     C   46              READ      SADH5B                                 94
N28  C                   ELSE
N28  C     WSTLEA        READE     SADH12B                                94
N28  C                   END
     C   47              READ      SADH6B                                 94
S06  C*  48SADA7K        READE     SADH7                                  94
N06  C   48WSMI          READE     SADH7B                                 94
S06  C*  49SADA0K        READE     SADH10                                 94
S36  C*  49WSST          READE     SADH10B                                94
N36  C   49WSST          READE     SADH9                                  94
N37  C   51WSSTOMB       READE     SADH14B                                94
N07  C   37WSRG          READE     SADH13B                                94
N30  C   35              READ      SADFNJL2                               94
N30  C   35              IF        *IN94 = *OFF
N30  C                   EVAL      X_FN = SIFIF
N30  C                   MOVE      SIFID         X_FN             26
N30  C     SADHKO        CHAIN     SADH                               33
N30  C                   EVAL      WSNAK = X_FN
N30  C                   END
S40  C*  34              READ      SADMNJL2                               94
N40  C   34              READ      SADVCNL2                               94
N40  C   34              DOW       *IN94 = *OFF
N40  C                   IF        SVAVD <> SIAVD OR SVTDN <> SITDN
N40  C                             OR CN_SVCNR <> SVMRK
N40  C                   EVAL      SITDN = CN_SVTDN
N40  C                   EVAL      SVMRK = CN_SVCNR
N40  C                   LEAVE
N40  C                   END
N40  C                   READ      SADVCNL2                               94
N40  C                   ENDDO
N30  C   34              IF        *IN94 = *OFF
N30  C                   MOVE      SVMRK         X_MRK            17
N30  C     SADHKO        CHAIN     SADH                               33
N30  C                   EVAL      WSNAK = X_MRK
N30  C                   END
N38   *
N38  C  N94              IF        WSANAV <> *BLANKS OR WSMNAV <> *BLANKS
N38  C                   EXSR      TSTAVSMOT
N38  C     AMExclude     cabeq     'Y'           STLRAL
N38  C                   END
     C  N94              DO
S37  C* N46SITDN         CABLT     0             STLRAL
N37  C  N46
N39  CanN38
N37  CANN51SITDN         CABLT     0             STLRAL
S37  C*  46              IF        SITDN < 0
N37  C   46
N37  COR 38
N37  COR 51              IF        SITDN < 0
N18  C                   EVAL      SITDN = SITDN * -1
N18  C     SADHKO        CHAIN     SADH                               33
N18  C                   END
N10  c                   add       1             LestRec
     C                   MOVE      SIDTD         WSDTD2
     C                   MOVE      SIDTM         WSDTM2
     C                   MOVE      SIDTÅ         WSDTÅ2
     C     WSTLL         IFEQ      '*'
     C     SITLL         ANDNE     *BLANKS
     C                   GOTO      STLRAL
     C                   END
N10   * filter på status (Normalt knyttet knyttet til signatur-søk, men KAN kombineres med annet..)
N10  C     WSSGST        Ifne      ' '
N10  C     SIST          andne     TstSGST
N10  C                   GOTO      STLRAL
N10  C                   END
N10   * kun uferdige ALLe
N10  C     WSKUF         IFeq      'U'
N10  C     SIST          Ifeq      'S'
N10  C*    SIST          oreq      'P'
N10  C*    SIST          oreq      'U'
S23  C*    SITLL         andne     *blanks                                      eksternfortollet??
N23  C     SITLL         orne      *blanks                                      eksternfortollet??
N10  C                   GOTO      STLRAL
N10  C                   END
N10  C*    SIST          Ifeq      ' '
N10  C*    SITLL         andne     *blanks                                      eksternfortollet??
N10  C*                  GOTO      STLRAL
N10  C*                  END
N10  C                   END
N10   * kun uferdige som VENTER på handling Handling
N10  C     WSKUF         IFeq      'O'
N10  C     SIST          ifne      'M'
N10  C     SIST          andne     'D'
N10  C     SIST          andne     'V'
N45  C     SIST          andne     '1'
N45  c                   add       1             LestRec
N10  C                   GOTO      STLRAL
N10  C                   END
N10  C                   END
     C                   END
S06  C*  94YAVD          IFLT      9999
S06  C*    *IN46         ANDNE     '1'
S06  C*    *IN47         ANDNE     '1'
S06  C*                  ADD       1             YAVD
S06  C*    YAVD          SETLL     STANDI
S06  C*                  SETOFF                                       33
S06  C*                  READ      STANDI                                 33
S06  C* N33              DO
S06  C*                  MOVE      SIAVD         YAVD
S06  C*                  EXSR      MINSAL
S06  C*                  SETOFF                                       94
S06  C*                  GOTO      STLRAL
S06  C*                  END
S06  C*                  END
     C*
S10  C*                  ENDSR
N10  C     UtLesA        ENDSR
     C*
N37   ***********************************************
N37  C     TstAvsMot     BEGSR
N37   ***********************************************
N37  c                   MOVE      'Y'           AMExclude         1
N37   * TEST Hentenavn utfylt - ikke match hopp ut (med Y i HLExclude )
N37  C                   IF        WSANAV <> *BLANKS
N37  C     ' '           CHECKR(E) WSANAV        NUX               2 0
N37  C                   EVAL      %len(AvsMot)= NUX
N37  C     NUX           SUBST     WSANAV:1      AvsMot
N37  C     LC:UC         XLATE     SINAS         TSTSCAN30        30
N37  C     AvsMot        SCAN      TSTSCAN30                              33
N37  c     *IN33         CaBEQ     *OFF          UtTstAM
N37  C                   end
N37   * TEST Lev.navn utfylt - ikke match hopp ut (med Y i HLExclude )
N37  C                   IF        WSMNAV <> *BLANKS
N37  C     ' '           CHECKR(E) WSMNAV        NUX               2 0
N37  C                   EVAL      %len(AvsMot)= NUX
N37  C     NUX           SUBST     WSMNAV:1      AvsMot
N37  C     LC:UC         XLATE     SINAK         TSTSCAN30
N37  C     AvsMot        SCAN      TSTSCAN30                              33
N37  c     *IN33         CaBEQ     *OFF          UtTstAM
N37  C                   end
N37   * Overlevde begge tester - skal IKKE ekskluderes
N37  C                   MOVE      'N'           AMExclude
N37   *
N37  C     UtTstAM       ENDSR
N37   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SADHK         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTDN
     C     SADHKO        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
N15  C     SADHO2K       KLIST
N15  C                   KFLD                    SIAVD
N15  C                   KFLD                    O2_SITDN
     C     SADFFK        KLIST
     C                   KFLD                    XAVDFF
     C                   KFLD                    XTDNFF
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2TDN
     C     SADHKC        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     SADH1K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    XDT
     C     SADH2K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
N28  C     SADH12K       KLIST
N28  C                   KFLD                    WSAAVD
N28  C                   KFLD                    WSTLEA
N28  C                   KFLD                    WSTLL
N28  C     SADH12K2      KLIST
N28  C                   KFLD                    WSAAVD
N28  C                   KFLD                    WSTLEA
N28  C     SADH12BK      KLIST
N28  C                   KFLD                    WSTLEA
N28  C                   KFLD                    WSTLL
N07  C     SADH13K       KLIST
N07  C                   KFLD                    WSAAVD
N07  C                   KFLD                    WSRG
N07  C                   KFLD                    XDTRG
N07  C     SADH13KE      KLIST
N07  C                   KFLD                    WSAAVD
N07  C                   KFLD                    WSRG
N07  C     SADH13BK      KLIST
N07  C                   KFLD                    WSRG
N07  C                   KFLD                    XDTRG
N30  C     SADFNJL1K     KLIST
N30  C                   KFLD                    WSAAVD
N30  C                   KFLD                    WSFN
S40  C*    SADMNJL1K     KLIST
N40  C     SADVCNL1K     KLIST
N30  C                   KFLD                    WSAAVD
N30  C                   KFLD                    WSMRK
     C     SADH3K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     SADH4K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     SADH5K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTLL
     C     SADH6K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSGN15
     C     SADH7K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSMI
N04  C     EDIM7K        KLIST
N04  C                   KFLD                    XSEKDT
N04  C                   KFLD                    WSSEKV
N04  C     EDIM7K2       KLIST
N04  C                   KFLD                    M0068A
N04  C                   KFLD                    M0068B
     C     SADH0K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSST
N37  C     SADH14K       KLIST
N37  C                   KFLD                    WSAAVD
N37  C                   KFLD                    WSSTOMB
     C     KUNDK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    XUNIK
     C                   KFLD                    WSAAVD
     C     SADA1K        KLIST
S06  C*                  KFLD                    YAVD
     C                   KFLD                    XDT
     C     SADA2K        KLIST
S06  C*                  KFLD                    YAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     SADA3K        KLIST
S06  C*                  KFLD                    YAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     SADA4K        KLIST
S06  C*                  KFLD                    YAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
S06  C*    SADA5K        KLIST
S06  C*                  KFLD                    YAVD
S06  C*                  KFLD                    WSTLL
     C     SADA7K        KLIST
S06  C*                  KFLD                    YAVD
     C                   KFLD                    WSMI
     C     SADA0K        KLIST
S06  C*                  KFLD                    YAVD
     C                   KFLD                    WSST
N37  C     SADA14K       KLIST
N37  C                   KFLD                    WSSTOMB
     C     SADHFRI       KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
n04  C     SADEDIM       KLIST
n04  C                   KFLD                    MAVD
n04  C                   KFLD                    MTDN
     C     FRIKEY        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    WSKODE
N41  C     FRIKEYNY      KLIST
N41  C                   KFLD                    WSFRI1
N41  C                   KFLD                    WSFRI2
     C     FR1KEY        KLIST
     C                   KFLD                    WSKODE
     C                   KFLD                    WFSSOK
     C     FR1KEYE       KLIST
     C                   KFLD                    WSKODE
N10  c     MailKey       klist
N10  c                   kfld                    FIFIRM
N10  c                   kfld                    ITYPE            30
N10  c                   kfld                    SIKNK
N10  c                   eval      ITYPE = '*SAD IMPORT'
N14  C     TRACKL02K     klist
N14  C                   KFLD                    SIAVD
N14  C                   KFLD                    SITDN
N14  C                   kfld                    TTFBNR
N14  C                   kfld                    TTACTI
N14  C                   EVAL      TTACTI = 'EMA'
      *
     C     *ENTRY        PLIST
     C     *IN28         PARM                    UIN28             1
     C                   PARM                    UMODE             1
      * IN28 = 0 ER ARBEIDE MED   1=SPØRRING
      *F= forenklet prosedyre
     c     UMODE         IFEQ      'F'
N29  C                   SETON                                        76
     c   28              move      'SHU1053'     HEAMSG
     c  N28              move      'SHU1052'     HEAMSG
     c                   else
     c   28              move      'SHU1051'     HEAMSG
     c  N28              move      'SHU1050'     HEAMSG
     c                   end
     C*
     C                   MOVE      'A'           XUNIK             1
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
N04  C                   MOVE      *ZEROS        WSSEKD
N05  C                   MOVE      *BLANKS       WFSSOKMAX        35
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        WSDTK
     C                   MOVE      *ZEROS        WSDTT
N07  C                   MOVE      *ZEROS        WSDTRG
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      *ZEROS        XDTS
     C                   MOVE      *ZEROS        XDTK
     C                   MOVE      *ZEROS        XDTT
N07  C                   MOVE      *ZEROS        XDTRG
     C                   MOVE      *ZEROS        SIDT
     C                   MOVE      *ZEROS        WSDT2
N37   * Default = protect ekstra filer
N37  C                   MOVE      '1'           *IN32
      *
     C     *LIKE         DEFINE    FSDTOP        WFSDTO
     C     *LIKE         DEFINE    FSKODE        WSKODE
     C                   MOVEL     '*CR'         WSKODE
     C                   MOVE      UAVD          WSAAVD
     C     KODTAK        CHAIN     KODTA                              30
     C     *IN28         IFEQ      '0'
     C     UMODE         IFEQ      'F'
     C                   MOVE      'F'           WSST
     C                   SETON                                        49
     C                   ELSE
     C                   MOVE      USG           WSSG
     C                   MOVE      '999999'      WSDTT
     C                   SETON                                        45
     C                   END
     C                   END
N10   * maxrecords i leseloop (pga filetr i les..)
N10  C     SYPARKEY      KLIST
N10  C                   KFLD                    SYKUNR
N10  C                   KFLD                    SYPAID
N10  C                   z-add     5000          MAXLES
N10  C                   Move      *zeros        SYKUNR
N10  C                   move      'MXOFI'       SYPAID
N10  C     SyParKey      CHAIN     SYPARL1                            33
N10  c  N33              z-add     SYVRDN        MAXLES            9 0
      *
     C*
     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           WSAAR
     C                   MOVEL     WDT           W2AAR
     C*
S01  C*                  MOVE      'DIV1915'     XMSGNR            7
S01  C*                  Z-ADD     3             XLEVEL            1 0
S01  C*                  Z-ADD     0             XRETUR            1 0
S01  C*                  Z-ADD     8             XMSGL             4 0
S01  C*                  EXSR      GETTXT
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV1916'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      GETTXT
S01  C*                  MOVEL     XMSG          SOTXT2            8
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETTXT        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR            7
     C                   PARM                    XMSG            120
     C                   PARM                    XLEVEL            1 0
     C                   PARM                    XRETUR            1 0
     C                   PARM                    XMSGL             4 0
     C*
     C                   ENDSR
     C*
     C*
N27  C***********************************************
N27  C     VISFRIS       BEGSR
N27  C***********************************************
N27  C                   Z-ADD     0             UFLAGG
N27  C                   CALL      'SYFA64'
S30  C*                  PARM                    SIAVD
S30  C*                  PARM                    SITDN
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
N27  C                   PARM                    OTIKU1            8 0
N27  C                   PARM                    OTIKU2            8 0
N27  C  N90              MOVE      *ZEROS        WSNR
N27  C  N90              UPDATE    SUBFIL
N27  C                   ENDSR
N27  C*
n32   ***********************************************
n32  C     DSPEPO        BEGSR
n32   ***********************************************
n32  C                   CALL      'ARC012CLD'
N30  C                   PARM      SIAVD         U_AVD             4 0
N30  C                   PARM      SITDN         U_TDN             7 0
N32  C  N90              MOVE      *ZEROS        WSNR
N32  C  N90              UPDATE    SUBFIL
n32   *
n32  C                   ENDSR
