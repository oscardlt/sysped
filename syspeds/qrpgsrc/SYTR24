      *
      **************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE ANSATTE                      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24             ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-88 95-97       ***
      **************************************************************
      *
     FDRIV      UF A E           K DISK
     FSYTR24FM  CF   E             WORKSTN
     D                 DS
     D  X≈MD                   1      8  0
     D  X≈MD≈≈                 1      4  0
     D  X≈MDMM                 5      6  0
     D  X≈MDDD                 7      8  0
     D                 DS
     D  XDM≈                   1      6  0
     D  XDM≈≈≈                 1      2  0
     D  XDM≈MM                 3      4  0
     D  XDM≈DD                 5      6  0
     C     B1            TAG
     C                   EXFMT     BILDE1
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C   04              DO
     C                   CALL      'SYTR18'
     C                   PARM                    DRANSA
     C                   END
     C     WSKODE        IFNE      'N'
     C     WSKODE        ANDNE     'E'
     C     WSKODE        ANDNE     'F'
     C                   GOTO      B1
     C                   END
     C     DRANSA        CHAIN(N)  DRIV                               33
     C   33WSKODE        IFEQ      'E'
     C     WSKODE        OREQ      'F'
     C                   GOTO      B1
     C                   END
     C  N33WSKODE        IFEQ      'N'
     C                   GOTO      B1
     C                   END
     C  N33              EXSR      MOVFW
     C   33              EXSR      MOVBL
     C     B2            TAG
     C                   EXFMT     BILDE2
     C   03              EXSR      OPPDAT
     C   03              GOTO      B1
     C   12              GOTO      B1
     C                   GOTO      B2
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C******************************************************
     C     OPPDAT        BEGSR
     C******************************************************
     C   33              EXSR      MOVWF
     C   33              WRITE     DRIVR
     C  N33DRANSA        CHAIN     DRIV                               44
     C  N33
     CANN44              EXSR      MOVWF
     C  N33
     CANN44              UPDATE    DRIVR
     C                   ENDSR
     C******************************************************
     C     MOVFW         BEGSR
     C******************************************************
     C                   MOVE      DRNAVN        WSNAVN
     C                   MOVE      DRADR1        WSADR1
     C                   MOVE      DRADR2        WSADR2
     C                   MOVE      DRADR3        WSADR3
     C                   MOVE      DRALFA        WSALFA
     C                   MOVE      DRADAT        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSADAT
     C                   MOVE      DRSDAT        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSDAT
     C                   MOVE      DRSE1K        WSSE1K
     C                   MOVE      DRSE1D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE1D
     C                   MOVE      DRSE2K        WSSE2K
     C                   MOVE      DRSE2D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE2D
     C                   MOVE      DRSE3K        WSSE3K
     C                   MOVE      DRSE3D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE3D
     C                   MOVE      DRSE4K        WSSE4K
     C                   MOVE      DRSE4D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE4D
     C                   MOVE      DRSE5K        WSSE5K
     C                   MOVE      DRSE5D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE5D
     C                   MOVE      DRSE6K        WSSE6K
     C                   MOVE      DRSE6D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE6D
     C                   MOVE      DRSE7K        WSSE7K
     C                   MOVE      DRSE7D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE7D
     C                   MOVE      DRSE8K        WSSE8K
     C                   MOVE      DRSE8D        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSSE8D
     C                   MOVE      DRPASN        WSPASN
     C                   MOVE      DRPASD        X≈MD
     C                   EXSR      SNUDT1
     C                   MOVE      XDM≈          WSPASD
     C                   MOVE      DRTLF         WSTLF
     C                   MOVE      DRFRIT        WSFRIT
     C                   ENDSR
     C******************************************************
     C     MOVBL         BEGSR
     C******************************************************
     C                   MOVE      *BLANKS       WSNAVN
     C                   MOVE      *BLANKS       WSADR1
     C                   MOVE      *BLANKS       WSADR2
     C                   MOVE      *BLANKS       WSADR3
     C                   MOVE      *BLANKS       WSALFA
     C                   MOVE      *ZEROS        WSADAT
     C                   MOVE      *ZEROS        WSSDAT
     C                   MOVE      *BLANKS       WSSE1K
     C                   MOVE      *ZEROS        WSSE1D
     C                   MOVE      *BLANKS       WSSE2K
     C                   MOVE      *ZEROS        WSSE2D
     C                   MOVE      *BLANKS       WSSE3K
     C                   MOVE      *ZEROS        WSSE3D
     C                   MOVE      *BLANKS       WSSE4K
     C                   MOVE      *ZEROS        WSSE4D
     C                   MOVE      *BLANKS       WSSE5K
     C                   MOVE      *ZEROS        WSSE5D
     C                   MOVE      *BLANKS       WSSE6K
     C                   MOVE      *ZEROS        WSSE6D
     C                   MOVE      *BLANKS       WSSE7K
     C                   MOVE      *ZEROS        WSSE7D
     C                   MOVE      *BLANKS       WSSE8K
     C                   MOVE      *ZEROS        WSSE8D
     C                   MOVE      *BLANKS       WSPASN
     C                   MOVE      *ZEROS        WSPASD
     C                   MOVE      *BLANKS       WSTLF
     C                   MOVE      *BLANKS       WSFRIT
     C                   ENDSR
     C******************************************************
     C     MOVWF         BEGSR
     C******************************************************
     C                   MOVE      WSNAVN        DRNAVN
     C                   MOVE      WSADR1        DRADR1
     C                   MOVE      WSADR2        DRADR2
     C                   MOVE      WSADR3        DRADR3
     C                   MOVE      WSALFA        DRALFA
     C                   MOVE      WSADAT        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRADAT
     C                   MOVE      WSSDAT        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSDAT
     C                   MOVE      WSSE1K        DRSE1K
     C                   MOVE      WSSE1D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE1D
     C                   MOVE      WSSE2K        DRSE2K
     C                   MOVE      WSSE2D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE2D
     C                   MOVE      WSSE3K        DRSE3K
     C                   MOVE      WSSE3D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE3D
     C                   MOVE      WSSE4K        DRSE4K
     C                   MOVE      WSSE4D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE4D
     C                   MOVE      WSSE5K        DRSE5K
     C                   MOVE      WSSE5D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE5D
     C                   MOVE      WSSE6K        DRSE6K
     C                   MOVE      WSSE6D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE6D
     C                   MOVE      WSSE7K        DRSE7K
     C                   MOVE      WSSE7D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE7D
     C                   MOVE      WSSE8K        DRSE8K
     C                   MOVE      WSSE8D        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRSE8D
     C                   MOVE      WSPASN        DRPASN
     C                   MOVE      WSPASD        XDM≈
     C                   EXSR      SNUDT2
     C                   MOVE      X≈MD          DRPASD
     C                   MOVE      WSTLF         DRTLF
     C                   MOVE      WSFRIT        DRFRIT
     C                   ENDSR
     C******************************************************
     C     SNUDT1        BEGSR
     C******************************************************
     C                   MOVE      X≈MDDD        XDM≈DD
     C                   MOVE      X≈MDMM        XDM≈MM
     C                   MOVE      X≈MD≈≈        XDM≈≈≈
     C                   ENDSR
     C******************************************************
     C     SNUDT2        BEGSR
     C******************************************************
     C     XDM≈          IFEQ      0
     C                   MOVE      *ZEROS        X≈MD
     C                   ELSE
     C                   MOVE      XDM≈DD        X≈MDDD
     C                   MOVE      XDM≈MM        X≈MDMM
     C     XDM≈≈≈        IFEQ      50
     C     XDM≈≈≈        ADD       1900          X≈MD≈≈
     C                   ELSE
     C     XDM≈≈≈        ADD       2000          X≈MD≈≈
     C                   END
     C                   END
     C                   ENDSR
