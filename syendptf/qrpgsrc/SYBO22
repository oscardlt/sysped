********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12229 * 01 YBC PTF12 LAG EHF PÅ FAKTURA SOM VAR LAGET FOR EHF-SETTING PÅ KUNDE.
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT KOPI AV BORDEREAU            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 31 32 35 38 51-56 58-69    ***
      ***                    74-78 80-87 89-99                ***
      ***********************************************************
      *
     FHEADF     IF   E           K DISK
     FFAIN      IF   E           K DISK
     FFAK3      IF   E           K DISK
N01  FXMLUFL2   IF   E           K DISK
N01  FCUNDL01   IF   E           K DISK
N01  FFIRM      IF   E           K DISK
     FSYBO22FM  CF   E             WORKSTN
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UDT                   30     35  0
     D  UHOD                  47     47
     D  UBBS                  48     48
     D  WSFN1                101    107  0
     D  WSFN2                108    114  0
     D  WSFN3                115    121  0
     D  WSFN4                122    128  0
     D  WSFN5                129    135  0
     D  WSFN6                136    142  0
     D  WSFN7                143    149  0
     D  WSFN8                150    156  0
     D  WSFN9                157    163  0
     D  WSFN10               164    170  0
     D  WSFN11               171    177  0
     D  WSFN12               178    184  0
     D  WSFN13               185    191  0
     D  WSFN14               192    198  0
     D  WSFN15               199    205  0
     D  WSFN16               206    212  0
     D  WSFN17               213    219  0
     D  WSFN18               220    226  0
     D  WSFN19               227    233  0
     D  WSFN20               234    240  0
     D  WSFN21               241    247  0
     D  WSFN22               248    254  0
     D  WSFN23               255    261  0
     D  WSFN24               262    268  0
     D  WSFN25               269    275  0
     D  WSFN26               276    282  0
     D  WSFN27               283    289  0
     D  WSFN28               290    296  0
     D  WSFN29               297    303  0
     D  WSFN30               304    310  0
     D  WF                   101    310  0
     D                                     DIM(30)
     D  UGN                  981    995
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     C                   SETOFF                                       30
     C   03              MOVE      *ZEROS        WF
     C   03              GOTO      SLUTT
     C                   EXSR      TEST
     C   30              GOTO      START
     C*
     C     SLUTT         TAG
N01  C                   IF        *IN03 = *OFF AND WSEHF = 'J'
N01  C                   EVAL      UEHF = '-1'
N01  C                   ELSE
N01  C                   EVAL      UEHF = '00'
N01  C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TEST          BEGSR
     C***********************************************
     C                   Z-ADD     1             XN                2 0
     C                   SETOFF                                       70
     C                   MOVE      *BLANKS       UGN
     C*
     C     WSFRA         IFNE      *ZEROS
     C                   MOVE      WSFRA         YFN
     C     FAINK         CHAIN     FAIN                               30
     C  N30HEADFK        CHAIN     HEADF                              30
     C   30              SETON                                        70
     C   30              MOVE      'SPF0026'     MSGNR
     C   30              GOTO      SLTB
     C*
     C                   EXSR      TESTFA
     C   30              SETON                                        70
N01  C   30              IF        MSGNR = *BLANKS
     C   30              MOVE      'SHU0512'     MSGNR
N01  C                   END
     C   30              GOTO      SLTB
     C*FRA MÅ VÆRE MINDRE ENN TIL NUMMER
     C     WSFRA         IFGE      WSTIL
     C                   SETON                                        7030
     C                   MOVE      'SHU0513'     MSGNR
     C   30              GOTO      SLTB
     C                   END
     C*
     C* TEST VELLYKKET
     C*
     C                   MOVE      WSFRA         WSFN1
     C                   MOVE      WSTIL         WSFN2
     C                   MOVEL     '*FRATIL'     UGN
     C                   GOTO      SLTB
     C                   END
     C     XN            DOWLE     30
     C     WF(XN)        IFNE      0
     C                   Z-ADD     WF(XN)        YFN
     C     FAINK         CHAIN     FAIN                               30
     C  N30HEADFK        CHAIN     HEADF                              30
     C   30              MOVE      'SPF0026'     MSGNR
     C   30              GOTO      SLTB
     C*
     C* TESTER AT TASTET FAKTURANUMMER IKKE ER KOSTNADSBILAG
     C*
     C                   EXSR      TESTFA
N01  C   30              IF        MSGNR = *BLANKS
     C   30              MOVE      'SHU0310'     MSGNR
N01  C                   END
     C   30              GOTO      SLTB
     C                   END
     C                   ADD       1             XN
     C                   END
     C*
     C     SLTB          ENDSR
     C*
     C*
     C***********************************************
     C     TESTFA        BEGSR
     C***********************************************
N01  C                   EVAL      MSGNR = *BLANKS
     C*
     C                   MOVE      'O'           GLSTAT
     C                   SETOFF                                       33
     C     FAK3KC        SETLL     FAK3
     C     ST1           TAG
     C     FAK3KC        READE     FAK3                                   33
     C  N33FAKDA         COMP      'K'                                    30
     C  N33
     CAN 30              GOTO      ST1
     C  N33              GOTO      CONTC
     C                   MOVE      'F'           GLSTAT
     C                   SETOFF                                       33
     C     FAK3KC        SETLL     FAK3
     C     ST2           TAG
     C     FAK3KC        READE     FAK3                                   33
     C  N33FAKDA         COMP      'K'                                    30
     C  N33
     CAN 30              GOTO      ST2
     C  N33              GOTO      CONTC
     C                   MOVE      'G'           GLSTAT
     C                   SETOFF                                       33
     C     FAK3KC        SETLL     FAK3
     C     ST3           TAG
     C     FAK3KC        READE     FAK3                                   33
     C  N33FAKDA         COMP      'K'                                    30
     C  N33
     CAN 30              GOTO      ST3
N01   *
N01  C     CONTC         TAG
N01  C  N30              IF        WSEHF = 'J'
N01  C     YFN           CHAIN     XMLUFL2                            30
N01  C                   IF        *IN30 = *OFF
N01  C                   EVAL      *IN30 = *ON
N01  C                   MOVE      'YBC2068'     MSGNR
N01  C                   ELSE
N01  C     CUNDL01K      CHAIN     CUNDL01                            30
N01  C  N30SYFR06        COMP      'J'                                3030
N01  C                   IF        *IN30
N01  C                   MOVE      'YBC2067'     MSGNR
N01  C                   END
N01  C                   END
N01  C                   END
N01   *
N01  C                   ENDSR
S01  C*    CONTC         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C     BORD          PARM      BORD          BORD              1
     C                   PARM                    UEHF              2
     C     FAINK         KLIST
     C                   KFLD                    YFN
     C     FAK3KC        KLIST
     C                   KFLD                    GLSTAT            1
     C                   KFLD                    YFN
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
N01  C     CUNDL01K      KLIST
N01  C                   KFLD                    FIFIRM
N01  C                   KFLD                    FAKUNR
     C*
     C                   MOVE      *ZEROS        WF
     C     BORD          IFEQ      '1'
     C                   ELSE
     C                   END
N01   *
N01  C     *LOVAL        SETLL     FIRM
N01  C                   READ      FIRM                                   33
N01   *
     C                   ENDSR
     C*
