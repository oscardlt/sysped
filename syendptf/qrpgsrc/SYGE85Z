      * Slett / reorg varelinjer   - Blåkopi av  SYGE85 men her for Z-filer
*****F**************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnrF*Sek Sig Vers Beskrivelse...........................
"""""F*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
*****F**************************************************************
      *
      ***********************************************************
      *** PROGRAM sletter en linje og reorg varelinjer        ***
      *** INDICATORS  01 - 26 FUNCTION  / ROLL KEYS           ***
      *** INDICATORS USED                                     ***
      ***********************************************************
      *
     FZOKUFV2   UF   E           K DISK
     FZOKUFM2   UF   E           K DISK
     FZOKUFVF2  UF   E           K DISK
      *
     C                   EXSR      INIT
     C                   EXSR      DELLIN
     C                   EXSR      DEL0
     C                   EXSR      DEL
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UUNIK             9 0
     C                   PARM                    UFBNR             3 0
     C                   PARM                    ULINR             2 0
     C*--------------------------------------------------------------
     C* DEFINE KEY FOR ZOKUFV2
     C*--------------------------------------------------------------
     C     KEYFV         KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UFBNR
     C                   KFLD                    ULINR
     C     KEYFVE        KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UFBNR
     C     KEYFM         KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UFBNR
     C                   KFLD                    ULINR
     C     KEYFME        KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UFBNR
     C     KEYFVF        KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UFBNR
     C                   KFLD                    ULINR
     C     KEYFVFE       KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UFBNR
      *
     C                   ENDSR
     C*
     C***********************************************
     C     DEL           BEGSR
     C***********************************************
     C*  ZOKUFV2
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFV         SETLL     ZOKUFV2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVE        READE     ZOKUFV2                                33
     C     *IN(33)       IFEQ      '0'
     C                   Z-add     ULINRS        FVLINR
     c                   update    dokufvr
     c                   add       1             ULINRS
     c                   endif
     c                   enddo
      *
     C*  ZOKUFM2
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFM         SETLL     ZOKUFM2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFME        READE     ZOKUFM2                                33
     C     *IN(33)       IFEQ      '0'
      * øker linjenummer bare hvis jeg leser neste
     c     fmlinr        ifne      fmlinrf
     c     fmlinrf       andne     0
     c                   add       1             ULINRS
     c                   end
     C                   Z-add     ULINRS        FMLINR
     c                   update    dokufmr
     c                   move      fmlinr        fmlinrf           2 0
     c                   endif
     c                   enddo
      *
      *
     C*  ZOKUFVF2
     c                   setoff                                       33
     c                   MOVE      ULINR         ULINRS            2 0
     C     KEYFVF        SETLL     ZOKUFVF2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVFE       READE     ZOKUFVF2                               33
     C     *IN(33)       IFEQ      '0'
     c     fflinr        ifne      fflinrf
     c     fflinrf       andne     0
     c                   add       1             ULINRS
     c                   end
     c                   z-add     ULINRS        fflinr
     c                   update    dokufvfr
     c                   move      fflinr        fflinrf           2 0
     c                   endif
     c                   enddo
      *
     C                   ENDSR                                                  <*IN11
     C*
     C***********************************************
     C     DELLIN        BEGSR
     C***********************************************
      * sletter ønsket linje nummer
      *
     C*  ZOKUFV2
     C     KEYFV         CHAIN     ZOKUFV2                            33
     c  N33              delete    dokufvr
      *
     C*  ZOKUFM2
     c                   setoff                                       33
     C     KEYFM         SETLL     ZOKUFM2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFM         READE     ZOKUFM2                                33
     C     *IN(33)       IFEQ      '0'
     c                   delete    dokufmr
     c                   endif
     c                   enddo
      *
      *
     C*  ZOKUFVF2
     c                   setoff                                       33
     C     KEYFVF        SETLL     ZOKUFVF2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVF        READE     ZOKUFVF2                               33
     C     *IN(33)       IFEQ      '0'
     c                   update    dokufvfr
     c                   add       1             ULINRS
     c                   endif
     c                   enddo
      *
     C                   ENDSR                                                  <*IN11
     C***********************************************
     C     DEL0          BEGSR
     C***********************************************
     C* SLETTER LINJER I ZOKUFM2 /ZOKUFVF2 SOM IKKE HAR TILHØRENDE ZOKUFV2
      *
      *
     C     KEYFVT1       KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     C     KEYFVT2       KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    FFFBNR
     C                   KFLD                    FFLINR
     C*  ZOKUFM2
     c                   setoff                                       33
     C     KEYFME        SETLL     ZOKUFM2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFME        READE     ZOKUFM2                                33
     C     *IN(33)       IFEQ      '0'
      * SJEKK OM I ZOKUFV2
     c     KEYFVT1       CHAIN(N)  ZOKUFV2                            34
     C   34              DELETE    DOKUFMR
     c                   endif
     c                   enddo
      *
      *
     C*  ZOKUFVF2
     c                   setoff                                       33
     C     KEYFVFE       SETLL     ZOKUFVF2
     C     *IN(33)       DOWEQ     '0'
     C     KEYFVFE       READE     ZOKUFVF2                               33
     C     *IN(33)       IFEQ      '0'
     c     KEYFVT2       CHAIN(N)  ZOKUFV2                            34
     C   34              DELETE    DOKUFVFR
     c                   endif
     C                   ENDDO
     C                   ENDSR
