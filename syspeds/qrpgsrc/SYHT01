     FSYHT01FM  CF   E             WORKSTN
     FKUFAST    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FFAKT      IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FHEADDT    IF   E           K DISK
     FSTAWRK    UF A E           K DISK
     D                 DS
     D  OCSB01                 1      9  2
     D  OCSB02                10     18  2
     D  OCSB03                19     27  2
     D  OCSB04                28     36  2
     D  OCSB05                37     45  2
     D  OCSB06                46     54  2
     D  OCSB07                55     63  2
     D  OCSB08                64     72  2
     D  OCSB09                73     81  2
     D  OCSB10                82     90  2
     D  B                      1     90  2
     D                                     DIM(10)
     D                 DS
     D  OCSK01                 1      2
     D  OCSK02                 6      7
     D  OCSK03                11     12
     D  OCSK04                16     17
     D  OCSK05                21     22
     D  OCSK06                26     27
     D  OCSK07                31     32
     D  OCSK08                36     37
     D  OCSK09                41     42
     D  OCSK10                46     47
     D  A                      1     50
     D                                     DIM(10) ASCEND
     D                 DS
     D  DSTID                  1     14  0
     D  DSDAG                  7      8  0
     D  DSMND                  9     10  0
     D  DSAAR                 11     14  0
     D                 DS
     D  OCSUDA                 1      8  0
     D  OCSAAR                 1      4  0
     D  OCSMND                 5      6  0
     D  OCSDAG                 7      8  0
     D                 DS
     D  DATOFR                 1      8  0
     D  WSFAAR                 1      4  0
     D  WSFMND                 5      6  0
     D  WSFDAG                 7      8  0
     D                 DS
     D  DATOTI                 1      8  0
     D  WSTAAR                 1      4  0
     D  WSTMND                 5      6  0
     D  WSTDAG                 7      8  0
     C* KGEIE
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE1
     C   03              GOTO      SLUTT
     C*
     C     WSFAAR        IFEQ      *ZEROS
     C     WSFMND        OREQ      *ZEROS
     C     WSFDAG        OREQ      *ZEROS
     C     WSTAAR        OREQ      *ZEROS
     C     WSTMND        OREQ      *ZEROS
     C     WSTDAG        OREQ      *ZEROS
     C                   GOTO      START
     C                   END
     C                   EXSR      LESH
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*******************************************************
     C     LESH          BEGSR
     C*******************************************************
      * LESER HEADF PÅ OPPDRAGSDATO
     C     HEKEY         KLIST
     C                   KFLD                    HEDTOP
     C                   MOVE      DATOFR        HEDTOP
     C     HEKEY         SETLL     HEADDT
     C     *IN34         DOWEQ     '0'
     C                   READ      HEADDT                                 34
     C  N34HEDTOP        COMP      DATOTI                             34
     C     *IN34         IFEQ      '0'
     C                   EXSR      LESD
     C                   END
     C                   END
     C                   ENDSR
     C*******************************************************
     C     LESD          BEGSR
     C*******************************************************
      * LESER FAKTURAENE PÅ OPPDRAGET
     C     FAKEY         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   SETOFF                                       33
     C     FAKEY         SETLL     FAKT
     C     *IN33         DOWEQ     '0'
     C     FAKEY         READE     FAKT                                   33
     C     *IN33         IFEQ      '0'
     C     FAOPKO        ANDGT     'D'
     C                   EXSR      SUM
     C                   END
     C                   END
     C                   ENDSR
     C*******************************************************
     C     SUM           BEGSR
     C*******************************************************
     C     KEYGE         CHAIN     KODTGE                             39
     C                   MOVE      DATOFR        OCSFRA
     C                   MOVE      DATOTI        OCSTIL
     C                   MOVEA     *ZEROS        B
     C                   MOVE      *ZEROS        OCSTOT
     C                   MOVEL     KGEIE         FA05              5
     C                   Z-ADD     1             NR
     C     FA05          LOOKUP    A(NR)                                  35
     C                   MOVE      FAKUNR        OCSKU
     C     OCSKEY        KLIST
     C                   KFLD                    OCSFI
     C                   KFLD                    OCSKU
     C     NR            IFGT      0
     C     NR            ANDLT     11
      *
     C     OCSKEY        CHAIN     STAWRK                             36
     C                   ADD       FABELN        B(NR)
     C                   ADD       FABELN        OCSTOT
     C  N36              UPDATE    STAWRKR
     C   36              WRITE     STAWRKR
     C                   END
     C                   ENDSR
     C*******************************************************
     C     INIT          BEGSR
     C*******************************************************
     C     *ENTRY        PLIST
     C                   PARM                    EPOST            70
     C                   MOVE      ' DEFN'       KFKOD
     C     KEYGE         KLIST
     C                   KFLD                    GETYP
     C                   KFLD                    FAVK
     C                   MOVE      'GE'          GETYP             2
     C     KUKEY         KLIST
     C                   KFLD                    KFTYPI
     C                   MOVEL     'GRITYPE'     KFTYPI           10
     C*
     C                   TIME                    DSTID            14 0
     C                   MOVE      DSAAR         WSFAAR
     C                   MOVE      DSAAR         WSTAAR
     C                   MOVE      *ZEROS        WSFDAG
     C                   MOVE      *ZEROS        WSFMND
     C                   MOVE      *ZEROS        WSTDAG
     C                   MOVE      *ZEROS        WSTMND
     C                   MOVE      DSAAR         OCSAAR
     C                   MOVE      DSMND         OCSMND
     C                   MOVE      DSDAG         OCSDAG
     C                   Z-ADD     0             NR                2 0
     C     KUKEY         SETLL     KUFAST
     C     *IN33         DOWEQ     '0'
     C     KUKEY         READE     KUFAST                                 33
     C     *IN33         IFEQ      '0'
     C     KFKOD         ANDNE     ' DEFN'
     C                   ADD       1             NR
     C                   MOVE      KFKOD         A(NR)
     C                   END
     C                   END
     C                   SORTA     A
     C                   READ      FIRM                                   33
     C                   MOVE      FIFIRM        OCSFI
     C                   ENDSR
     C*
