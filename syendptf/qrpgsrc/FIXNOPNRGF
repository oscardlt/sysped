********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12147 * 01 SH  PTF12 syge111 ENDRET TIL FLERE FELT I FIL
********************************************************************
     FNopnrPts  ip   F 1024        DISK
     FNOPNRGFP  o    e             DISK
     D                 DS
N01  D  dtafld                 1  54000
N01  D                                     DIM(180)
     D                 DS
     D  ZDEC                   1      7  6
     D  ZDEC6                  2      7
     D  ZHEL                  11     22  0
     D                 DS
     D  A                      1     79
     D                                     DIM(79)
     D                 DS
     D  B                      1     18
     D                                     DIM(18)
     INopnrPts  NC  01
     I                                  1    4  Dta1_4
     I                                  1 1024  DATAINN
      *
     c                   if        Dta1_4 <> 'poin'
     c                   exsr      DETSR
     c                   endif
      *
      **************************************************************
     C     DETSR         BEGSR
      **************************************************************
      *
      * Kaller eksternt program og legger felt i array
      *
     c*                  add       1             AntRecTmp         9 0
n01  C                   MOVEL     DATAINN       UDATA          4096
n01  C                   MOVEL     *BLANKS       UARRA         54000
     C                   MOVE      ','           SKILLET           1
     C                   CALL      'SYGE111'
     C                   PARM                    SKILLET
     C                   PARM                    UDATA
     C                   PARM                    UARRA
     c                   movea     uarra         dtafld
      *
      * tøm
      *
     C                   CLEAR                   NOPNFPR
      *
      *
      *
      * felt 1 postnr
      *
     C                   MOVEA     dtafld(1)     A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          PTID
      * felt 2 bredde
      *
     C                   MOVEA     dtafld(2)     A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          PTBRE
      * felt 3 lengde
      *
     C                   MOVEA     dtafld(3)     A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          PTLEN
      *
      * felt 1 postnr
      *
     C                   MOVEA     dtafld(4)     A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          NOPONR
      *skriv til utfil
     C                   WRITE     NOPNFPR
      * TMP
     c*                  if        AntRecTmp >50
     c*                  eval      *INLR=*ON
     c*                  endif
      *
     C                   ENDSR
      *
     c*****************************************
     c     getnum        begsr
     c*****************************************
     C                   MOVE      *ZEROS        ZHEL
     C                   MOVE      *ZEROS        ZDEC
     C                   MOVE      *ZEROS        B
     C                   Z-ADD     1             AX                2 0
     C                   Z-ADD     1             BX                2 0
      * Get Integer
     C     A(AX)         DOWGE     '0'
     C     ZHEL          MULT      10            ZHEL
     C                   MOVE      A(AX)         ZHEL
     C                   ADD       1             AX
     C                   ENDDO
      * Decimal point ?
     C     A(AX)         IFEQ      '.'
     C     A(AX)         OREQ      ','
     C                   ADD       1             AX
     C     A(AX)         DOWGE     '0'
     C                   MOVE      A(AX)         B(BX)
     C                   ADD       1             AX
     C                   ADD       1             BX
     C                   ENDDO
     C                   MOVEA     B             ZDEC6
     C                   ENDIF
      * Concatenate
     C                   Z-ADD     ZHEL          ZNUM             18 6
     C                   ADD       ZDEC          ZNUM
     C                   ENDSR
     c
