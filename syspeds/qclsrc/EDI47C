/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 JOV PTF10 OGSÅ TKOMTEGNS BACKUPMAPPE                         */
/* 10XXX * 01 JOV PTF10 OGSÅ TKOMTEGNS BACKUPMAPPE                         */
/* 11XXX * 03 SH  PTF11 FLEKSIBELT ANTALL DAGER                            */
/* 11XXX * 04 SH  PTF12 LEGGER '/' FORAN LIBFX  FOR Å SIKRE                */
/* 11XXX * 04 SH  PTF12 RIKTIG MAPPE HVIS BUKER HAR MAPPE PÅ BRUKERID      */
/* ********************************************************************    */
             PGM
             /*_____________________*/
             /* Deklarere Variabler */
             /*"""""""""""""""""""""*/
             DCL        VAR(&LIBF) TYPE(*CHAR) LEN(10)
/*S04        DCL        VAR(&LIBFX) TYPE(*CHAR) LEN(11)  */
/*N04*/      DCL        VAR(&LIBFX) TYPE(*CHAR) LEN(12)
             DCL        VAR(&TIL1) TYPE(*CHAR) LEN(100) VALUE('  ')
             DCL        VAR(&TIL2) TYPE(*CHAR) LEN(100) VALUE('  ')
             DCL        VAR(&TIL3) TYPE(*CHAR) LEN(100) VALUE('  ')
             DCL        VAR(&TIL4) TYPE(*CHAR) LEN(100) VALUE('  ')
/* 03        DCL        VAR(&DAGER) TYPE(*CHAR) LEN(5) VALUE('00007') */
             DCL        VAR(&DAGER) TYPE(*CHAR) LEN(5)
             DCLF       FILE(EDII) RCDFMT(*ALL)
             /*___________________*/
             /* Hent filbibliotek */
             /*"""""""""""""""""""*/
             RTVDTAARA  DTAARA(EDIDTA (171 10)) RTNVAR(&LIBF)
/* N03 */    RTVDTAARA  DTAARA(EDIDTA (202 5))  RTNVAR(&DAGER)
/*______________*/
/* LES PARTSFIL */
/*""""""""""""""*/
READ:        RCVF       DEV(*FILE) RCDFMT(*FILE)
                         MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(EXIT))
/*______________*/
/* ER DET *IFS  */
/*""""""""""""""*/
             IF         COND(&INTCRD *NE '*IFS') THEN(DO)
             IF         COND(&INTCLL *NE '*IFS') THEN(DO)
             GOTO       CMDLBL(READ)
             ENDDO
             ENDDO
             /*_____________________*/
             /* Lag katalogstruktur */
             /*"""""""""""""""""""""*/
/*S04        CHGVAR     VAR(&LIBFX) VALUE(&LIBF *TCAT 'X')  */
/*N04*/      CHGVAR     VAR(&LIBFX) VALUE('/' *TCAT &LIBF *TCAT 'X')
             CHGVAR     VAR(&TIL1) VALUE(&LIBFX *TCAT '/' +
                          *TCAT &INID *TCAT '/EDIRE/BACKUP')
             CHGVAR     VAR(&TIL2) VALUE(&LIBFX *TCAT '/' +
                          *TCAT &INID *TCAT '/EDIRE1K/BACKUP')
             CHGVAR     VAR(&TIL3) VALUE(&LIBFX *TCAT '/' +
                          *TCAT &INID *TCAT '/EDISE/BACKUP')
             CHGVAR     VAR(&TIL4) VALUE(&LIBFX *TCAT '/' +
                          *TCAT &INID *TCAT '/EDISE1K/BACKUP')
             /*_______________________________________*/
             /* TØM BACKUP-FOLDER  ELDRE ENN 7 DAGER  */
             /*"""""""""""""""""""""""""""""""""""""""*/
             /*  EDIRE/BACKUP                         */
             CALL       PGM(REOIFSR) PARM(&TIL1 &DAGER)
             /*  EDIRE1K/BACKUP                       */
             CALL       PGM(REOIFSR) PARM(&TIL2 &DAGER)
             /*  EDISE/BACKUP                         */
             CALL       PGM(REOIFSR) PARM(&TIL3 &DAGER)
             /*  EDISE1K/BACKUP                       */
             CALL       PGM(REOIFSR) PARM(&TIL4 &DAGER)
             GOTO       CMDLBL(READ)
             /*_______________________________________*/
             /* TAR DERETTER TOLLVESENETS MAPPE       */
             /* FOR 7 DAGERS BACKUP                   */
             /*"""""""""""""""""""""""""""""""""""""""*/
/*S04        CHGVAR     VAR(&TIL1) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDIRE/BACKUP')      */
/*S04        CHGVAR     VAR(&TIL2) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDIRE1K/BACKUP')    */
/*S04        CHGVAR     VAR(&TIL3) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDISE/BACKUP')      */
/*S04        CHGVAR     VAR(&TIL4) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDISE1K/BACKUP')    */
 EXIT:       CHGVAR     VAR(&TIL1) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDIRE/BACKUP') /* *N04* */
 /*N04*/     CHGVAR     VAR(&TIL2) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDIRE1K/BACKUP')
/*N04*/      CHGVAR     VAR(&TIL3) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDISE/BACKUP')
/*N04*/      CHGVAR     VAR(&TIL4) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDISE1K/BACKUP')
             /*_______________________________________*/
             /* TØM BACKUP-FOLDER  ELDRE ENN 7 DAGER  */
             /*"""""""""""""""""""""""""""""""""""""""*/
             CALL       PGM(REOIFSR) PARM(&TIL1 &DAGER)
             CALL       PGM(REOIFSR) PARM(&TIL2 &DAGER)
             CALL       PGM(REOIFSR) PARM(&TIL3 &DAGER)
             CALL       PGM(REOIFSR) PARM(&TIL4 &DAGER)
             /*_______________________________________*/
             /* TAR DERETTER TOLLVESENETS MAPPE       */
             /* TEMP-MAPPE                            */
             /*"""""""""""""""""""""""""""""""""""""""*/
/*S04        CHGVAR     VAR(&TIL1) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDIRE/TEMP/*')      */
/*S04        CHGVAR     VAR(&TIL2) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDIRE1K/TEMP/*')    */
/*S04        CHGVAR     VAR(&TIL3) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDISE/TEMP/*')      */
/*S04        CHGVAR     VAR(&TIL4) VALUE(&LIBF +      */
/*S04                     *TCAT '/EDISE1K/TEMP/*')    */
             CHGVAR     VAR(&TIL1) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDIRE/TEMP/*') /*N04*/
             CHGVAR     VAR(&TIL2) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDIRE1K/TEMP/*') /*N04*/
             CHGVAR     VAR(&TIL3) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDISE/TEMP/*') /*N04*/
             CHGVAR     VAR(&TIL4) VALUE('/' *TCAT &LIBF *TCAT +
                          '/EDISE1K/TEMP/*') /*N04*/
             /*_______________________________________*/
             /* TØM TEMP - FOLDER  ELDRE ENN 7 DAGER  */
             /*"""""""""""""""""""""""""""""""""""""""*/
             DEL        OBJLNK(&TIL1)
             MONMSG     MSGID(CPF0000)
             DEL        OBJLNK(&TIL2)
             MONMSG     MSGID(CPF0000)
             DEL        OBJLNK(&TIL3)
             MONMSG     MSGID(CPF0000)
             DEL        OBJLNK(&TIL4)
             MONMSG     MSGID(CPF0000)
 /* FLYTTET TIL REOIFSCL */
 /*S01       CHGVAR     VAR(&TIL1) VALUE('/SYSPEDDEV/TKSIGNTMP/BACKUP')      */
 /*S01       CALL       PGM(REOIFSR) PARM(&TIL1 &DAGER)                      */
             ENDPGM
