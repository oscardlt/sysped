********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10024 * 02 YBC PTF10 FORHOLD BRUTTO/NETTO VEKT
10XXX * 03 YBC PTF10 IKKE HENT VAREBESKRIVELSE FRA TARIFF-REG FOR TILLEGGSLINJE
10XXX * 04 YBC PTF10 VED ENDRING KAN MAN FJERNE FF-AVGIFT
10318 * 05 YBC PTF10 VEKT ER ENDRET FRA 5.0 TIL 12.3
      *              VAREBESKRIVELSE ER ØKT FRA 15A TIL 30A
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11016 * 06 YBC PTF11 OMBEREGNING
11XXX * 07 YBC PTF11 IKKE HENT VAREBESKRIVELSE FRA SOKTARI
11XXX * 08 YBC PTF11 GODTA TIDLIGST TARIFF NÅR OPPRINNELIG TARIFF ER SLETTET
      *              VED OMBEREGNING
11138 * 09 YBC PTF11 VIS STATUS PÅ FEILMELDING FRA TVINN.
11176 * 10 YBC PTF11 TILLEGGSLINJER MED SAMME POST
11186 * 11 YBC PTF11 VIS TOTAL VEKT OG SUM AV LINJEVEKT
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12017 * 12 YBC PTF12 Kalkulator på fakturabeløp, vekt
12XXX * 13 YBC PTF12 SETT RITKIG KODE FOR NY ELLER ENDRING
12XXX * 14 YBC PTF12 HENT REFERANSEKODE VED ENDRING
12XXX * 15 YBC PTF12 Beregn vekt etter faktor fra første side
12064 * 16 YBC PTF12 FLERE BELØP ER ENDRET FOR Å TA STØRRE VERDI
12XXX * 17 YBC PTF12 SET UF11/UF21 TIL N VED START
12XXX * 18 YBC PTF12 F12 tilbake til oversikts bilde
12XXX * 19 YBC PTF12 OPPRINNELSESLAND
12112 * 20 YBC PTF12 Sjekk om negativ verdi etter kalkulator, evt. endre til positiv
12XXX * 21 YBC PTF12 FEILRETTING PÅ ENDRING 08. OPPDATERING FØR LESING
12185 * 22 YBC PTF12 Containernr med ehnetskode = 'CONT'
12186 * 23 YBC PTF12 TEST PÅ CONTAINERNR
12201 * 24 YBC PTF12 CONTAINER ER I EGEN FIL
12226 * 25 YBC PTF12 Ikke endre felt på omberegning hvis det kan endre samslåing
12230 * 26 YBC PTF12 Preferanse
12242 * 27 YBC PTF12 Hent containernr fra BL
12248 * 28 YBC PTF12 VEKT, KOLLI ER UTVIDET.
12258 * 29 YBC PTF12 Nytt felt for VF-kode fra og med 01.12.2021
12278 * 30 YBC PTF12 Opprinnelseslandkode oppgis ved prosedyre=34 og fylkekode=91
12282 * 31 YBC PTF12 4 SIFFER PROSEDYRE OG 2 SIFFER TRANSAKSJONSTYPE
12295 * 32 YBC PTF12 Krav å sende opprinnelsesland ved DFO (innstikk)
12301 * 33 CB  PTF12 TOTAL BRUTTOVEKT MED DESIMALER
********************************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
N29  FSYPTFF    IF   E           K DISK
N22  FSAEH      IF   E           K DISK
N02  FSAEHTL    IF   E           K DISK
     FSAEV      UF A E           K DISK
     FSAEV4     IF   E           K DISK    RENAME(SAEVR:SAEV4R)
N24  FSAEVCN    UF A E           K DISK
     FSADAVGE   IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTSE    IF   E           K DISK
     FKODTSC    IF   E           K DISK
N26  FSYPARL1   IF   E           K DISK
     FTARI      UF   E           K DISK
S07  F*SOKTARI2  IF   E           K DISK
     FSAD052FU  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
      *
N23  D XAN07           S              7
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UUR                   12     12
     D  UWS                   13     22
     D  UTVIN                 23     23
      *** UIN28 = '1' -> PROSEDYRE = 0, 20, 80 (UTGÅR 04.2000!!)
     D  UIN28                 24     24
      *** UIN34 = '1' -> SENDES PÅ TVINN
     D  UIN34                 25     25
      *** UIN36 = '1' -> I SAD400
     D  UIN36                 26     26
     D  UBEL1                 28     40  2
S28  D* UVKB                  41     49  0
     D  UDP                   50     51  0
     D  UKNK                  52     59  0
S31  D* UTST                  60     60  0
     D  UPRE                  61     61
     D  UZUNIK                62     70  0
     D  UZREFF                71     87
     D  W2VSUM                88    100  2
     D  W2DIFF               101    113  2
     D  ULI                  114    118  0
     D  UNYZF                119    119
N32  D  UIN08                120    120
     D  USEDT                121    128  0
      * OBS! HUSK INITIERE ALLE FELTER PÅ SAD052
S28  D* W2VKB                129    141  3
S28  D* W2VDIF               142    154  3
S33  D* UVKB                 129    139  0
N28  D  W2VKB                140    154  3
N28  D  W2VDIF               155    169  3
N31  D  UTST                 170    171  0
N33  D  UVKB                 172    185  3
S11  D* UPARM1                 1    128
N11  D  UPARM1                 1    512
     D                 DS
     D  UPARM2                 1    512
     D  UTFLAG                 1      1  0
     D  UTVLI                  2      6  0
     D  UTTOP1                 7     23
     D  UTCRE1                24     26
      * ledig 27 - 54
     D  UF11                  55     55
     D  UF21                  56     56
     D  UIN37                 57     57
     D  UIN39                 58     58
     D  UIN60                 59     59
     D  XXPRE                 60     60
S05  D* UTTOP2                61     77
S05  D* UTCRE2                78     80
S05  D* UTTOP3                81     97
S05  D* UTCRE3                98    100
S05  D* UTTOP4               101    117
S05  D* UTCRE4               118    120
S05  D* UTTOP5               121    137
S05  D* UTCRE5               138    140
N05  D  UTTOP2                61     77
N05  D  UTCRE2                78     80
N05  D  UTTOP3                81     97
N05  D  UTCRE3                98    100
N05  D  UTTOP4               101    117
N05  D  UTCRE4               118    120
N05  D  UTTOP5               121    137
N05  D  UTCRE5               138    140
N22  D  UTTOP6               141    157
N22  D  UTCRE6               158    160
N22  D  UTTOP7               161    177
N22  D  UTCRE7               178    180
N22  D  UTTOP8               181    197
N22  D  UTCRE8               198    200
N22  D  UTTOP9               201    217
N22  D  UTCRE9               218    220
N22  D  UTTOP10              221    237
N22  D  UTCRE10              238    240
N22  D  UTFT                 241    436    DIM(7)
N22  D  UTEH                 437    464    DIM(7)
     D                 DS
S05  D* W2FT01                 1     17
S05  D* W2FT02                18     34
S05  D* W2FT03                35     51
S05  D* W2FT04                52     68
S05  D* W2FT05                69     85
S05  D* W2FT06                86    102
S05  D* W2FT07               103    119
S05  D* VFT                    1    136    DIM(8)
N05  D  W2FT01                 1     28
N05  D  W2FT02                29     56
N05  D  W2FT03                57     84
N05  D  W2FT04                85    112
N05  D  W2FT05               113    140
N05  D  W2FT06               141    168
N05  D  W2FT07               169    196
N05  D  VFT                    1    308    DIM(11)
     D                 DS
S28  D* W2NT01                 1      6  0
S28  D* W2NT02                 7     12  0
S28  D* W2NT03                13     18  0
S28  D* W2NT04                19     24  0
S28  D* W2NT05                25     30  0
S28  D* W2NT06                31     36  0
S28  D* W2NT07                37     42  0
S05  D* VNT                    1     48  0 DIM(8)
S28  D* VNT                    1     66  0 DIM(11)
N28  D  W2NT01                 1      9  0
N28  D  W2NT02                10     18  0
N28  D  W2NT03                19     27  0
N28  D  W2NT04                28     36  0
N28  D  W2NT05                37     45  0
N28  D  W2NT06                46     54  0
N28  D  W2NT07                55     63  0
N28  D  VNT                    1     99  0 DIM(11)
     D                 DS
     D  W2EH01                 1      4
     D  W2EH02                 5      8
     D  W2EH03                 9     12
     D  W2EH04                13     16
     D  W2EH05                17     20
     D  W2EH06                21     24
     D  W2EH07                25     28
S05  D* VEH                    1     32    DIM(8)
N05  D  VEH                    1     44    DIM(11)
     D                 DS
S05  D* W2VT01                 1     15
S05  D* W2VT02                16     30
S05  D* W2VT03                31     45
S05  D* W2VT04                46     60
S05  D* W2VT05                61     75
S05  D* W2VT06                76     90
S05  D* W2VT07                91    105
S05  D* VVT                    1    120
S05  D*                                    DIM(8)
N05  D  W2VT01                 1     30
N05  D  W2VT02                31     60
N05  D  W2VT03                61     90
N05  D  W2VT04                91    120
N05  D  W2VT05               121    150
N05  D* W2VT06               151    180
N05  D* W2VT07               181    210
N05  D  VVT                    1    330    DIM(11)
     D                 DS
     D  W2TOP1                 1     17
     D  W2TOP2                18     34
     D  W2TOP3                35     51
     D  W2TOP4                52     68
     D  W2TOP5                69     85
N05  D  W2TOP6                86    102
N05  D  W2TOP7               103    119
N05  D  W2TOP8               120    136
N05  D  W2TOP9               137    153
N05  D  W2TOP10              154    170
S05  D* TOP                    1    136    DIM(8)
N05  D  TOP                    1    187    DIM(11)
     D                 DS
     D  W2CRE1                 1      3
     D  W2CRE2                 4      6
     D  W2CRE3                 7      9
     D  W2CRE4                10     12
     D  W2CRE5                13     15
N05  D  W2CRE6                16     18
N05  D  W2CRE7                19     21
N05  D  W2CRE8                22     24
N05  D  W2CRE9                25     27
N05  D  W2CRE10               28     30
S05  D* TCR                    1     24    DIM(8)
N05  D  TCR                    1     33    DIM(11)
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  SVFT                   1    224    DIM(8)
     D                 DS
S28  D* SVNT01                 1      6  0
S28  D* SVNT02                 7     12  0
S28  D* SVNT03                13     18  0
S28  D* SVNT04                19     24  0
S28  D* SVNT05                25     30  0
S28  D* SVNT06                31     36  0
S28  D* SVNT07                37     42  0
S28  D* SVNT                   1     48  0 DIM(8)
N28  D  SVNT01                 1      9  0
N28  D  SVNT02                10     18  0
N28  D  SVNT03                19     27  0
N28  D  SVNT04                28     36  0
N28  D  SVNT05                37     45  0
N28  D  SVNT06                46     54  0
N28  D  SVNT07                55     63  0
N28  D  SVNT                   1     72  0 DIM(8)
     D                 DS
     D  SVEH01                 1      4
     D  SVEH02                 5      8
     D  SVEH03                 9     12
     D  SVEH04                13     16
     D  SVEH05                17     20
     D  SVEH06                21     24
     D  SVEH07                25     28
     D  SVEH                   1     32    DIM(8)
     D                 DS
     D  SVVT01                 1     30
     D  SVVT02                31     60
     D  SVVT03                61     90
     D  SVVT04                91    120
     D  SVVT05               121    150
     D  SVVT                   1    240    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  SVTOP                  1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  SVTCR                  1     33    DIM(11)
      *
     C                   EXSR      INIT
      *
     C                   MOVE      *ZEROS        XXLN              5 0
     C     START0        TAG
     C     XENDRE        IFEQ      'J'
     C                   EXSR      HENTSV
N04  C                   MOVE      'J'           XENDRING          1
     C                   ELSE
     C                   EXSR      MOVB2
N04  C                   MOVE      'N'           XENDRING
     C                   END
      *
     C     START         TAG
     C  N30
     CANN04              Z-ADD     5             LINNBR
     C  N30
     CANN04              Z-ADD     2             POSNBR
N25  C   28
N25  CANN30
N25  CANN04              Z-ADD     14            POSNBR
     C                   EXFMT     BILDE
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '000000'      *IN(86)
S24  C*                  MOVEA     '00000000000' *IN(75)
N24  C                   MOVEA     '000000000000'*IN(74)
N29  C                   MOVE      '0'           *IN73
     C                   MOVE      '0'           *IN(30)
      *
     C   12              GOTO      SLUTT
      *
     C   11              MOVE      'J'           UF11
     C   21              MOVE      'J'           UF21
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
      *** F9  ---> SETTE IND. 39 PÅ/AV FOR Å MERKERE KALKULATOR PÅ/AV
     C*** F15 ---> SETTE IND. 37 PÅ/AV FOR Å AUTOKOPIERE TILLEGGSOPPL.
     C   09
     COR 15              DO
     C                   EXSR      SETIND
     C                   GOTO      START
     C                   END
      *
     C   25              DO
     C                   ADD       1             XXLN
     C     SAEVK4        SETLL     SAEV4
     C     SAEHK         READE     SAEV4                                  33
     C                   IF        *IN33
     C                   SUB       1             XXLN
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      SVLI          UTVLI
     C                   MOVE      SVLN          XXLN
     C                   MOVE      'J'           XENDRE
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   END
      *
     C   26              DO
     C                   SUB       1             XXLN
     C     SAEVK4        SETGT     SAEV4
     C     SAEHK         READPE    SAEV4                                  33
     C                   IF        *IN33
     C                   ADD       1             XXLN
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      SVLN          XXLN
     C     SAEVK4        SETLL     SAEV4
     C     SAEHK         READE     SAEV4                                  33
     C                   MOVE      SVLI          UTVLI
     C                   MOVE      'J'           XENDRE
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   END
      *
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
N04  C                   MOVE      'J'           XENDRING          1
     C  N05XENDRE        CABEQ     'N'           START
      *
     C                   EXSR      OPDSAD
N24   *
N24  C                   IF        SEKDC = '1' AND *IN18 = '1'
N24  C                   MOVE      '1'           UTYPE
N24  C                   CALL      'SAD058'
N24  C                   PARM      SVAVD         UAVDCN            4 0
N24  C                   PARM      SVTDN         UTDNCN            7 0
N24  C                   PARM      SVLI          ULICN             5 0
N24  C     W2CNR         PARM      W2CNR         UCNR             17
N24  C                   PARM                    UTYPE             1
N24  C                   END
N24   *
S13  C*                  MOVE      'J'           XNY               1
     C     UBEL1         SUB       W2VSUM        W2DIFF
N11  C     UVKB          SUB       W2VKB         W2VDIF
     C     W2DIFF        CABEQ     0             SLUTT
     C     XENDRE        IFEQ      'N'
     C                   EXSR      MOVB2
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     XNY           IFEQ      'J'
     C                   Z-ADD     9             UTFLAG
     C                   ELSE
N18  C     *IN12         IFEQ      *ON
     C                   Z-ADD     1             UTFLAG
N18  C                   ELSE
N18  C                   Z-ADD     0             UTFLAG
N18  C                   END
     C                   END
     C                   MOVE      UPARM1        UPAR11
     C                   MOVE      UPARM2        UPAR21
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     SETIND        BEGSR
     C***********************************************
      *
      *** F9  ---> KALKULATOR PÅ/AV. BEHOLD FELLESOPPLYSNIGER PÅ LINJE
      ***          TOLLVERDI, BRUTTO- OG NETTO-VEKT SKAL REGISTRERES
      *            BENYTT INDIKATOR 39   39 PÅ -> KALKULATOR PÅ
     C     *IN09         IFEQ      '1'
     C     *IN39         IFEQ      '1'
     C                   MOVE      '0'           *IN39
     C                   ELSE
     C                   MOVE      '1'           *IN39
     C                   END
     C                   END
      *
      *** F15 ---> AUTO KOPIERING AV TILLEGGS OPPLYSNIGER
      *            BENYTT INDIKATOR 37   37 PÅ -> AUTO KOPIERING
     C     *IN15         IFEQ      '1'
     C     *IN37         IFEQ      '1'
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
N26   *
N26  C                   SELECT
N26  C                   WHEN      USEDT < 20200501                             INGEN PREFERANSE
N26  C                   EVAL      W2PRE = *BLANKS
N26  C                   WHEN      W2PRE <> 'N' AND W2PRE <> ' '                PREFERANSE
N26  C     1             DO        10            XN                3 0
N26  C                   SELECT
N26  C                   WHEN      TCR(XN) = 'SER'
N26  C                   LEAVE
N26  C                   WHEN      TCR(XN) = *BLANKS
N26  C                   EVAL      TCR(XN) = 'SER'
N26  C                   EVAL      TOP(XN) = X_SYVRDA
N26  C                   LEAVE
N26  C                   ENDSL
N26  C                   ENDDO
N26  C                   ENDSL
      *
      *** XSTK = 'J' ---> KREVE Å GI MENGDE.
     C                   MOVE      ' '           XSTK              1
      *** TESTE OM INNTASTET TARIFFNR. ER RIKTIG.
     C                   TESTN                   W2VNTI               33
     C   33              MOVE      W2VNTI        W2VNT
     C  N33              MOVE      '99999999'    W2VNT
     C     W2VNTI        IFEQ      *BLANKS
     C                   MOVE      *ZEROS        W2VNT
     C                   END
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   98
N08  C                   MOVE      'N'           XTARIFFOK         1
N08  C  N98              IF        UTDN < 0
N08  C                   MOVE      'J'           XTARIFFOK
N08  C                   END
     C     *IN98         DOWEQ     '0'
     C     TADATO        IFLE      USEDT
N01  C     TADTS         ANDEQ     0
N01  C     TADATO        ORLE      USEDT
N01  C     TADTS         ANDGE     USEDT
     C                   LEAVE
     C                   ELSE
     C                   UPDATE    TARIR
     C                   END
     C     TARIK         READPE    TARI                                   98
     C  N98              ENDDO
S21  C*  98              IF        UTDN < 0 AND XTARIFFOK = 'J'
S21  C*                  EVAL      *IN98 = *OFF
S21  C*                  END
     C  N98
     CAN 13VVT(1)        IFNE      *BLANKS
S05  C*                  MOVE      VVT(1)        TAALFA
N05  C                   EVAL      TAALFA = VVT(1)
     C                   END
     C  N98              UPDATE    TARIR
N21  C   98              IF        UTDN < 0 AND XTARIFFOK = 'J'
N21  C                   EVAL      *IN98 = *OFF
N21  C                   END
      *
     C  N98W2AVT         IFEQ      ' '
N04  C     XENDRING      ANDNE     'J'
     C     W2VNT         SETLL     SADAVGE
     C     W2VNT         READE     SADAVGE                                33
     C     *IN33         DOWEQ     '0'
     C     AGDTF         IFLE      USEDT
     C     AGDTT         ANDGT     USEDT
     C                   LEAVE
     C                   END
     C     W2VNT         READE     SADAVGE                                33
     C  N33              ENDDO
     C  N33              MOVE      'X'           W2AVT
     C                   END
     C  N98              MOVE      TASTK         XSTK
     C   98              SETON                                        30
      *
      *** TEST OPPRINNELSESFYLKE (/LAND HVIS UTENLANSKE TRANSIT VARER)
     C     UDP           IFNE      2
     C     UDP           ANDNE     4
     C     UDP           ANDNE     18
     C     UDP           ANDNE     81
     C     UDP           ANDNE     90
     C     W2FYL         CHAIN     KODTSE                             99
     C   99
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   MOVE      'YBC0120'     MSGNR
     C                   END
     C                   ELSE
     C     KODS2K        CHAIN     KODTS2                             99
     C   99
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   MOVE      'JOV1017'     MSGNR
     C                   END
     C                   END
      *
      *** F11/21-> BEREGNE VEKT ETTER ANDEL AV BRUTTO VEKT. ANDELNØKKEL
      ***          ER TOLLVERDI/FAKTURASUM.
     C     UF11          IFEQ      'J'
     C     UF21          OREQ      'J'
     C     W2BELT        IFEQ      0
     C     UBEL1         OREQ      0
     C  N30              DO
     C                   SETON                                        3097
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      'SPV0017'     MSGNR
     C                   END
     C                   ELSE
     C     W2BELT        DIV(H)    UBEL1         XWORK            16 5
     C     XWORK         MULT(H)   UVKB          W2VKTB                 3333
     C   33              Z-ADD     1             W2VKTB
S02  C*    W2VKTB        MULT(H)   0,9           W2VKTN
N02  C     W2VKTB        MULT(H)   SEFVK         W2VKTN
     C                   END
     C                   END
      *
      *** TEST VEKT
     C  N30W2VKTB        IFLE      0
     C     W2VKTN        IFLE      0
     C                   SETON                                        3097
     C                   Z-ADD     5             LINNBR
E16  C                   Z-ADD     30            POSNBR
     C                   MOVE      'SPV0016'     MSGNR
     C                   ELSE
S15  C*    W2VKTN        MULT(H)   1,1           W2VKTB
N15  C     W2VKTN        DIV(H)    SEFVK         W2VKTB
     C                   END
     C                   ELSE
     C     W2VKTN        IFEQ      0
S02  C*    W2VKTB        MULT(H)   0,9           W2VKTN
N02  C     W2VKTB        MULT(H)   SEFVK         W2VKTN
     C                   END
     C     W2VKTB        IFLT      W2VKTN
     C                   SETON                                        3097
     C                   Z-ADD     5             LINNBR
E16  C                   Z-ADD     30            POSNBR
     C                   MOVE      'JOV1095'     MSGNR
     C                   END
     C                   END
      *
     C     XSTK          IFEQ      'J'
     C     W2NTM         ANDEQ     0
     C                   SETON                                        9630
     C                   END
N19   *
N19  C                   IF        W2FYL = '91'
N32  C                             OR UIN08 = '1' AND XIDAG >= 20230801
N19  C                   SELECT
N19  C                   WHEN      W2LK = 'NO'
N32  C                             AND UIN08 <> '1'
N19  C                   MOVE      '1'           *IN75
N19  C                   WHEN      W2LK <> *BLANKS
N30  C                             OR W2FYL = '91' AND SEDP = 34
N19  C     KODS2KOPP     CHAIN     KODTS2                             75
N19  C                   ENDSL
N19  C                   IF        *IN75
N19  C                   Z-ADD     5             LINNBR
S30  C*                  Z-ADD     89            POSNBR
N30  C                   Z-ADD     95            POSNBR
N19  C                   MOVE      'CBA0400'     MSGNR
N19  C  N30              MOVE      '1'           *IN30
N19  C                   END
N19  C                   ELSE
N19  C                   EVAL      W2LK = *BLANKS
N19  C                   END
N29   *
N29  C                   IF        XVF = 'J'
N29  C                   IF        W2VF = ' '
N29  C                   MOVE      '1'           *IN73
N29  C                   Z-ADD     5             LINNBR
N29  C                   Z-ADD     100           POSNBR
N29  C                   MOVE      'YBC2125'     MSGNR
N29  C  N30              MOVE      '1'           *IN30
N29  C                   END
N29  C                   END
      *
     C  N30W2AVT         IFEQ      'X'                                          1<-B
     C     W2AVTP        IFEQ      0                                             2<-B
     C     W2AVTS        OREQ      *BLANKS
     C                   MOVE      *BLANKS       XAGSKV            3
     C                   MOVE      *ZEROS        XAGSAT            5 3
     C     W2VNT         SETLL     SADAVGE
     C     LESSAT        TAG
     C     W2VNT         READE     SADAVGE                                33
     C     *IN33         IFEQ      '0'                                            3<-B
     C     AGDTF         IFGT      USEDT                                           4<-B
     C     AGDTT         ORLE      USEDT
     C                   GOTO      LESSAT
     C                   END                                                       4<-E
     C     AGAKTK        IFNE      'I'                                             4<-B
     C     AGKD          ANDEQ     XXPRE
     C     XAGSAT        IFEQ      0                                                5<-B
     C                   MOVE      AGSKV         XAGSKV
     C                   MOVE      AGSATS        XAGSAT
     C                   ELSE                                                       5
     C                   MOVE      *BLANKS       XAGSKV
     C                   MOVE      *ZEROS        XAGSAT
     C                   CALL      'SAD052D'
     C     W2VNT         PARM      W2VNT         UVNTS             8 0
     C                   PARM                    XAGSKV
     C                   PARM                    XAGSAT
     C                   PARM                    XXPRE
     C                   PARM      USEDT         USEDT2            8 0
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   GOTO      LESSAT
     C                   END                                                      3<-E
     C     XAGSAT        IFNE      0                                              3<-B
     C                   MOVE      XAGSAT        W2AVTP
     C                   MOVE      XAGSKV        W2AVTS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *** 37 PÅ AUTODUP
     C   37W2TOP1        IFEQ      *BLANKS
     C                   MOVEL     UTTOP1        W2TOP1
     C                   MOVE      UTCRE1        W2CRE1
     C                   MOVEL     UTTOP2        W2TOP2
     C                   MOVE      UTCRE2        W2CRE2
     C                   MOVEL     UTTOP3        W2TOP3
     C                   MOVE      UTCRE3        W2CRE3
     C                   MOVEL     UTTOP4        W2TOP4
     C                   MOVE      UTCRE4        W2CRE4
     C                   MOVEL     UTTOP5        W2TOP5
     C                   MOVE      UTCRE5        W2CRE5
N22  C                   MOVEL     UTTOP6        W2TOP6
N22  C                   MOVE      UTCRE6        W2CRE6
N22  C                   MOVEL     UTTOP7        W2TOP7
N22  C                   MOVE      UTCRE7        W2CRE7
N22  C                   MOVEL     UTTOP8        W2TOP8
N22  C                   MOVE      UTCRE8        W2CRE8
N22  C                   MOVEL     UTTOP9        W2TOP9
N22  C                   MOVE      UTCRE9        W2CRE9
N22  C                   MOVEL     UTTOP10       W2TOP10
N22  C                   MOVE      UTCRE10       W2CRE10
     C                   END
N26   *
N26  C                   MOVE      *BLANKS       X_MSGNR           7
      *
      *** TEST KODE FOR DOKUMENT/SERTIFIKAT
     C     *IN34         IFEQ      '1'                                          1<-B
S05  C*    1             DO        5             XN                1 0           2<-B
N05  C     1             DO        10            XN                3 0           2<-B
     C     TCR(XN)       IFNE      *BLANKS                                        3<-B
     C     TCR(XN)       CHAIN     KODTSC                             33
N26  C  N33              IF        TCR(XN) = 'SER' AND W2PRE = 'N'                 4<-B
N26   *** PREFERANSE N KAN IKKE HA SERTIFIKAT SAMTIDIG
N26  C                   EVAL      *IN33 = *ON
N26  C                   EVAL      X_MSGNR = 'YBC2080'
N26  C                   END                                                       4<-E
     C     *IN33         IFEQ      '1'                                             4<-B
      * INNTASTET KODE ER UGYLDIG
     C     XN            MULT      2             X2                3 0
     C     96            SUB       X2            X2
     C                   MOVE      '1'           *IN(X2)
     C                   SETON                                        30
     C                   ELSE                                                      4
     C     TOP(XN)       IFEQ      *BLANKS                                          5<-B
      * TEKSTEN ER IKKE OPPGITT
     C     XN            MULT      2             X2                3 0
     C     97            SUB       X2            X2
     C                   MOVE      '1'           *IN(X2)
     C                   SETON                                        30
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C  N30TOP(XN)       IFNE      *BLANKS                                        3<-B
     C     TCR(XN)       ANDEQ     *BLANKS
      * KODE ER IKKE OPPGITT
     C     XN            MULT      2             X2                3 0
     C     96            SUB       X2            X2
     C                   MOVE      '1'           *IN(X2)
     C                   SETON                                        30
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N23   *
N23  C                   IF        *IN30 = *OFF                                 1<-B
N23  C     1             DO        7             XN                              2<-B
N23  C                   IF        VEH(XN) = 'CONT' OR VEH(XN) = 'C.'             3<-B
N24  C                   EVAL      VEH(XN) = *BLANKS
N24  C                   END                                                      3<-E
N24  C                   ENDDO                                                   2<-E
N27  C                   IF        *IN21 = *OFF AND *IN22 = *OFF
N24  C                   IF        SEKDC = '1' AND *IN18 = *OFF                  2<-B
N24  C                             OR SEKDC = '1' AND W2CNR <> *BLANKS
N23  C                   EXSR      SRTSTCONT
S24  C*                  IF        *IN30                                           4<-B
S24  C*                  LEAVE
S24  C*                  END                                                       4<-E
N27  C                   END
N23  C                   END                                                      3<-E
S24  C*                  ENDDO                                                   2<-E
N23  C                   END                                                    1<-E
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
N05  C   76              Z-ADD     19            LINNBR
N05  C   76              Z-ADD     70            POSNBR
N05  C   76              MOVE      'SPC0006'     MSGNR
N05  C   77              Z-ADD     19            LINNBR
N05  C   77              Z-ADD     46            POSNBR
N05  C   77              MOVE      'DIV1954'     MSGNR
N05  C   78              Z-ADD     19            LINNBR
N05  C   78              Z-ADD     30            POSNBR
N05  C   78              MOVE      'SPC0006'     MSGNR
N05  C   79              Z-ADD     19            LINNBR
N05  C   79              Z-ADD     6             POSNBR
N05  C   79              MOVE      'DIV1954'     MSGNR
N05  C   80              Z-ADD     18            LINNBR
N05  C   80              Z-ADD     70            POSNBR
N05  C   80              MOVE      'SPC0006'     MSGNR
N05  C   81              Z-ADD     18            LINNBR
N05  C   81              Z-ADD     46            POSNBR
N05  C   81              MOVE      'DIV1954'     MSGNR
N05  C   82              Z-ADD     18            LINNBR
N05  C   82              Z-ADD     30            POSNBR
N05  C   82              MOVE      'SPC0006'     MSGNR
N05  C   83              Z-ADD     18            LINNBR
N05  C   83              Z-ADD     6             POSNBR
N05  C   83              MOVE      'DIV1954'     MSGNR
N05  C   84              Z-ADD     17            LINNBR
N05  C   84              Z-ADD     70            POSNBR
N05  C   84              MOVE      'SPC0006'     MSGNR
N05  C   85              Z-ADD     17            LINNBR
N05  C   85              Z-ADD     46            POSNBR
N05  C   85              MOVE      'DIV1954'     MSGNR
E05  C   86              Z-ADD     17            LINNBR
E05  C   86              Z-ADD     30            POSNBR
     C   86              MOVE      'SPC0006'     MSGNR
E05  C   87              Z-ADD     17            LINNBR
E05  C   87              Z-ADD     6             POSNBR
     C   87              MOVE      'DIV1954'     MSGNR
E05  C   88              Z-ADD     16            LINNBR
E05  C   88              Z-ADD     70            POSNBR
     C   88              MOVE      'SPC0006'     MSGNR
E05  C   89              Z-ADD     16            LINNBR
E05  C   89              Z-ADD     46            POSNBR
     C   89              MOVE      'DIV1954'     MSGNR
E05  C   90              Z-ADD     16            LINNBR
E05  C   90              Z-ADD     30            POSNBR
     C   90              MOVE      'SPC0006'     MSGNR
E05  C   91              Z-ADD     16            LINNBR
E05  C   91              Z-ADD     6             POSNBR
     C   91              MOVE      'DIV1954'     MSGNR
E05  C   92              Z-ADD     15            LINNBR
E05  C   92              Z-ADD     70            POSNBR
     C   92              MOVE      'SPC0006'     MSGNR
E05  C   93              Z-ADD     15            LINNBR
E05  C   93              Z-ADD     46            POSNBR
     C   93              MOVE      'DIV1954'     MSGNR
     C   94              Z-ADD     15            LINNBR
     C   94              Z-ADD     30            POSNBR
     C   94              MOVE      'SPC0006'     MSGNR
     C   95              Z-ADD     15            LINNBR
     C   95              Z-ADD     6             POSNBR
     C   95              MOVE      'DIV1954'     MSGNR
N26  C                   IF        X_MSGNR = 'YBC2080' AND MSGNR = 'SPC0006'
N26  C                   EVAL      MSGNR = 'YBC2080'
N26  C                   END
     C   96
     CANN97
     CANN99              Z-ADD     5             LINNBR
     C   96
     CANN97
S30  C*NN99              Z-ADD     60            POSNBR
N30  CANN99              Z-ADD     64            POSNBR
     C   96
     CANN97
     CANN99              MOVE      'SPN0016'     MSGNR
     C   98
     CANN99              Z-ADD     5             LINNBR
     C   98
     CANN99              Z-ADD     5             POSNBR
     C   98
     CANN99              MOVE      'SPT0033'     MSGNR
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENTSV        BEGSR
     C***********************************************
      *
     C     SAEVK         CHAIN(N)  SAEV                               33
     C     *IN33         IFEQ      '0'                                          1<-B
N06  C                   MOVE      SVNYL         XSVNYL            1
N06  C                   EVAL      *IN28 = *OFF
N06  C                   IF        UTDN < 0 AND SVNYL = ' '
N06  C                   EVAL      *IN28 = *ON
N06  C                   END
     C                   MOVE      SVLN          XXLN              5 0
     C                   MOVE      SVVNT         W2VNT
     C                   MOVE      SVVNT         W2VNTI
     C                   MOVE      SVFYL         W2FYL
N19  C                   MOVE      SVLK          W2LK
N26  C                   MOVE      SVPRE         W2PRE
N29  C                   MOVE      SVVF          W2VF
     C                   MOVE      SVBELT        W2BELT
     C                   MOVE      SVVKTB        W2VKTB
     C                   MOVE      SVVKTN        W2VKTN
S05  C*                  IF        SVNTM < 0
S05  C*                  EVAL      W2NTM = SVNTM * -100
S05  C*                  ELSE
     C                   EVAL      W2NTM = SVNTM
S05  C*                  END
     C                   MOVE      SVAVT         W2AVT
     C                   MOVE      SVAVTS        W2AVTS
     C                   MOVE      SVAVTP        W2AVTP
     C                   MOVEA     SVFT          VFT
N22  C                   MOVEA     SVFT          UTFT
     C                   MOVEA     SVNT          VNT
     C                   MOVEA     SVEH          VEH
N22  C                   MOVEA     SVEH          UTEH
     C                   MOVEA     SVVT          VVT
     C                   MOVEA     SVTOP         TOP
N14  C                   MOVEA     SVTCR         TCR
     C                   END                                                    1<-E
N24   *
N24  C                   EVAL      *IN36 = *OFF
N24  C     SAEVK         CHAIN(N)  SAEVCN                             33
N24  C                   IF        *IN33 = *OFF
N24  C                   EVAL      W2CNR = SVCNR
N24  C     SAEVK         READE(N)  SAEVCN                                 33
N24  C  N33              EVAL      *IN36 = *ON                                  FLERE CONTAINER
N24  C                   END
      *
      * DET FINNES FLERE LINJER ENN FULL MODULS TILLATER.
     C     SLHENT        TAG
     C     UTFLAG        IFEQ      5
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSAD        BEGSR
     C***********************************************
      *
      * OPPDATER HOVEDLINJE
     C     XENDRE        IFEQ      'J'
     C     SAEVK         CHAIN     SAEV                               33
     C                   ELSE
     C                   MOVE      '1'           *IN33
     C                   END
     C                   Z-ADD     1             XN
     C                   EXSR      MOVWSV
      * INITIERER ANTALL TILLLEGGSLINJER
     C     *LIKE         DEFINE    SVREFL        XREFL
     C                   MOVE      *ZEROS        XREFL
     C                   MOVE      *ZEROS        SVREFL
     C     *IN33         IFEQ      '1'
N06  C                   EVAL      SVNYL = XSVNYL
N02  C                   MOVE      SVLI          SVLN
     C                   WRITE     SAEVR
N13  C                   MOVE      'J'           XNY               1
     C                   ELSE
     C                   UPDATE    SAEVR
N13  C                   MOVE      'N'           XNY
     C                   END
N27   *
N27  C                   IF        *IN21 OR *IN22
N27   * Hent containernr fra BL
N27  C                   CALL      'SAD052BL'
N27  C                   PARM      SVAVD         UBLAVD            4 0
N27  C                   PARM      SVTDN         UBLTDN            7 0
N27  C                   PARM      SVLI          UBLLI             5 0
N27  C     SAEVK         CHAIN(N)  SAEVCN                             33
N27  C  N33              EVAL      W2CNR = SVCNR
N27  C                   END
N27   *
     C                   MOVE      SVLI          XLI               5 0
N02  C                   MOVE      SVLN          XXLN              5 0
     C     W2TOP1        IFNE      *BLANKS
     C                   MOVEL     W2TOP1        UTTOP1
     C                   END
     C     W2CRE1        IFNE      *BLANKS
     C                   MOVE      W2CRE1        UTCRE1
     C                   END
     C     W2TOP2        IFNE      *BLANKS
     C                   MOVEL     W2TOP2        UTTOP2
     C                   END
     C     W2CRE2        IFNE      *BLANKS
     C                   MOVE      W2CRE2        UTCRE2
     C                   END
     C     W2TOP3        IFNE      *BLANKS
     C                   MOVEL     W2TOP3        UTTOP3
     C                   END
     C     W2CRE3        IFNE      *BLANKS
     C                   MOVE      W2CRE3        UTCRE3
     C                   END
     C     W2TOP4        IFNE      *BLANKS
     C                   MOVEL     W2TOP4        UTTOP4
     C                   END
     C     W2CRE4        IFNE      *BLANKS
     C                   MOVE      W2CRE4        UTCRE4
     C                   END
     C     W2TOP5        IFNE      *BLANKS
     C                   MOVEL     W2TOP5        UTTOP5
     C                   END
     C     W2CRE5        IFNE      *BLANKS
     C                   MOVE      W2CRE5        UTCRE5
     C                   END
N22  C     W2TOP6        IFNE      *BLANKS
N22  C                   MOVEL     W2TOP6        UTTOP6
N22  C                   END
N22  C     W2CRE6        IFNE      *BLANKS
N22  C                   MOVE      W2CRE6        UTCRE6
N22  C                   END
N22  C     W2TOP7        IFNE      *BLANKS
N22  C                   MOVEL     W2TOP7        UTTOP7
N22  C                   END
N22  C     W2CRE7        IFNE      *BLANKS
N22  C                   MOVE      W2CRE7        UTCRE7
N22  C                   END
N22  C     W2TOP8        IFNE      *BLANKS
N22  C                   MOVEL     W2TOP8        UTTOP8
N22  C                   END
N22  C     W2CRE8        IFNE      *BLANKS
N22  C                   MOVE      W2CRE8        UTCRE8
N22  C                   END
N22  C     W2TOP9        IFNE      *BLANKS
N22  C                   MOVEL     W2TOP9        UTTOP9
N22  C                   END
N22  C     W2CRE9        IFNE      *BLANKS
N22  C                   MOVE      W2CRE9        UTCRE9
N22  C                   END
N22  C     W2TOP10       IFNE      *BLANKS
N22  C                   MOVEL     W2TOP10       UTTOP10
N22  C                   END
N22  C     W2CRE10       IFNE      *BLANKS
N22  C                   MOVE      W2CRE10       UTCRE10
N22  C                   END
N24   *
N24  C     SAEVK         CHAIN     SAEVCN                             33
N24  C                   IF        SEKDC = '1'
N24  C                   EVAL      SVCNR = W2CNR
N24  C                   IF        *IN33
N24  C                   WRITE     SAEVCNR
N24  C                   ELSE
N24  C                   UPDATE    SAEVCNR
N24  C                   END
N24  C                   ELSE
N24  C  N33              DELETE    SAEVCNR
N24  C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWSV        BEGSR
     C***********************************************
     C     *IN33         IFEQ      '1'
     C                   CLEAR                   SAEVR
     C                   MOVE      UAVD          SVAVD
     C                   MOVE      UTDN          SVTDN
     C                   ADD       1             ULI
     C                   MOVE      ULI           SVLI
     C                   END
     C                   MOVE      UAVD          SVAVD
     C                   MOVE      UTDN          SVTDN
     C   21
     COR 22              MOVE      'B'           SV01
     C  N21
     CANN22              MOVE      ' '           SV01
     C                   MOVE      W2VNT         SVVNT
     C                   MOVE      W2FYL         SVFYL
N19  C                   MOVE      W2LK          SVLK
N26  C                   MOVE      W2PRE         SVPRE
N29  C                   MOVE      W2VF          SVVF
     C                   MOVE      W2AVT         SVAVT
     C                   MOVE      W2AVTS        SVAVTS
     C                   MOVE      W2AVTP        SVAVTP
     C     XN            IFEQ      1
     C                   SUB       SVBELT        W2VSUM
     C                   ADD       W2BELT        W2VSUM
N11  C                   SUB       SVVKTB        W2VKB
N11  C                   ADD       W2VKTB        W2VKB
     C                   MOVE      W2BELT        SVBELT
     C                   MOVE      W2VKTB        SVVKTB
     C                   MOVE      W2VKTN        SVVKTN
S05  C*                  IF        W2NTM > 9999999
S05  C*                  EVAL      SVNTM = W2NTM / 100 * -1
S05  C*                  ELSE
     C                   MOVE      W2NTM         SVNTM
S05  C*                  END
     C                   ELSE
     C                   MOVE      *ZEROS        SVBELT
     C                   MOVE      *ZEROS        SVVKTB
     C                   MOVE      *ZEROS        SVVKTN
     C                   MOVE      *ZEROS        SVNTM
     C                   END
     C                   MOVEA     VFT(XN)       SVFT
     C                   MOVEA     VNT(XN)       SVNT
     C                   MOVEA     VEH(XN)       SVEH
     C                   MOVEA     VVT(XN)       SVVT
     C     SVVT01        IFEQ      *BLANKS
N03  C     XN            ANDEQ     1
S05  C*                  MOVE      TAALFA        SVVT
S07  C*    SVVNT         CHAIN     SOKTARI2                           34
S07  C* N34              EVAL      SVVT = BESKR1
S07  C*  34              EVAL      SVVT = TAALFA
S07  C                   EVAL      SVVT01 = TAALFA
     C                   MOVE      *BLANKS       TAALFA
     C                   ELSE
     C     SVVT01        IFEQ      TAALFA
     C                   MOVE      *BLANKS       TAALFA
     C                   END
     C                   END
     C                   MOVEA     TOP           SVTOP
     C                   MOVEA     TCR           SVTCR
N09  C                   MOVE      ' '           SVERR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
N06  C                   EVAL      *IN28 = *OFF
N06  C                   IF        UTDN < 0
N06  C                   EVAL      XSVNYL = 'J'
N06  C                   ELSE
N06  C                   EVAL      XSVNYL = ' '
N06  C                   END
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *BLANKS       W2VNTI
     C                   MOVE      *BLANKS       W2FYL
N19  C                   MOVE      *BLANKS       W2LK
N26  C                   IF        USEDT < 20200501
N26  C                   MOVE      ' '           W2PRE
N26  C                   ELSE
N26  C                   IF        W2PRE = ' '
N26  C                   MOVE      'N'           W2PRE
N26  C                   END
N26  C                   END
N29  C                   MOVE      SEVF          W2VF
     C                   MOVE      *BLANKS       W2AVT
     C                   MOVE      *ZEROS        W2AVTP
     C                   MOVE      *BLANKS       W2AVTS
      *
     C     W2DIFF        IFGT      0
     C                   Z-ADD     W2DIFF        W2BELT
     C                   ELSE
     C                   MOVE      *ZEROS        W2BELT
     C                   END
     C                   MOVE      *ZEROS        W2VKTB
     C                   MOVE      *ZEROS        W2VKTN
     C                   MOVE      *ZEROS        W2NTM
     C                   MOVE      *BLANKS       VFT
     C                   MOVE      *ZEROS        VNT
     C                   MOVE      *BLANKS       VEH
N22  C                   IF        SEKDC = '1'
S24  C*                  MOVEA     UTFT          VFT
S24  C*                  MOVEA     UTEH          VEH
N24  C                   EVAL      W2CNR = UTFT(1)
N22  C                   END
     C                   MOVE      *BLANKS       VVT
N26  C                   IF        W2PRE = ' ' OR W2PRE = 'N'
     C  N37              MOVE      *BLANKS       TOP
     C  N37              MOVE      *BLANKS       TCR
N26  C                   ELSE
N26  C     1             DO        11            XN                3 0
N26  C                   IF        TCR(XN) <> 'SER'
N26  C                   EVAL      TOP(XN) = *BLANKS
N26  C                   EVAL      TCR(XN) = *BLANKS
N26  C                   END
N26  C                   ENDDO
N26  C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     2
     C     POSNBR        ANDLE     3
     C     UDP           IFNE      2
     C     UDP           ANDNE     4
     C     UDP           ANDNE     18
     C     UDP           ANDNE     81
     C     UDP           ANDNE     90
     C                   CALL      'SAD052H'
     C                   PARM                    W2FYL
     C                   ELSE
     C                   MOVE      'N'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    W2FYL
     C                   PARM                    USPED
     C                   END
     C                   Z-ADD     5             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     5
     C     POSNBR        ANDLE     12
     C                   CALL      'SAD062A'
     C                   PARM                    W2VNTI
     C*    USEDT         PARM                    USEDT2            8 0
     C                   PARM      USEDT         USEDT2            8 0
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
N12   * KALKULATOR VERDI
N12  C     LINNBR        IFEQ      5
N12  C     POSNBR        ANDGE     14
N12  C     POSNBR        ANDLE     25
N12  C                   Z-ADD     W2BELT        UNU133           13 3
N12  C                   CALL      'SYGE11'
N12  C                   PARM                    UNU133
N20  C                   IF        UNU133 < 0
N20  C                   Z-SUB(H)  UNU133        W2BELT
N20  C                   ELSE
N12  C                   Z-ADD(H)  UNU133        W2BELT
N20  C                   end
E16  C                   Z-ADD     30            POSNBR
N12  C                   GOTO      SLSØK
N12  C                   END
N12   * KALKULATOR BRUTTOVEKT
N12  C     LINNBR        IFEQ      5
E16  C     POSNBR        ANDGE     30
S28  C*    POSNBR        ANDLE     42
N28  C     POSNBR        ANDLE     44
N12  C                   Z-ADD     W2VKTB        UNU133           13 3
N12  C                   CALL      'SYGE11'
N12  C                   PARM                    UNU133
N20  C                   IF        UNU133 < 0
N20  C                   Z-SUB(H)  UNU133        W2VKTB
N20  C                   ELSE
N12  C                   Z-ADD(H)  UNU133        W2VKTB
N20  C                   END
S28  C*                  Z-ADD     45            POSNBR
N28  C                   Z-ADD     47            POSNBR
N12  C                   GOTO      SLSØK
N12  C                   END
N12   * KALKULATOR NETTOVEKT
N12  C     LINNBR        IFEQ      5
S28  C*    POSNBR        ANDGE     45
S28  C*    POSNBR        ANDLE     57
N28  C     POSNBR        ANDGE     47
N28  C     POSNBR        ANDLE     61
N12  C                   Z-ADD     W2VKTN        UNU133           13 3
N12  C                   CALL      'SYGE11'
N12  C                   PARM                    UNU133
N20  C                   IF        UNU133 < 0
N20  C                   Z-SUB(H)  UNU133        W2VKTN
N20  C                   ELSE
N12  C                   Z-ADD(H)  UNU133        W2VKTN
N20  C                   END
S28  C*                  Z-ADD     60            POSNBR
N28  C                   Z-ADD     64            POSNBR
N12  C                   GOTO      SLSØK
N12  C                   END
N12   * KALKULATOR ANNEN ENHET
N12  C     LINNBR        IFEQ      5
S28  C*    POSNBR        ANDGE     60
S28  C*    POSNBR        ANDLE     68
N28  C     POSNBR        ANDGE     64
N28  C     POSNBR        ANDLE     74
N12  C                   Z-ADD     W2NTM         UNU133           13 3
N12  C                   CALL      'SYGE11'
N12  C                   PARM                    UNU133
N20  C                   IF        UNU133 < 0
N20  C                   Z-SUB(H)  UNU133        W2NTM
N20  C                   ELSE
N12  C                   Z-ADD(H)  UNU133        W2NTM
N20  C                   END
S28  C*                  Z-ADD     71            POSNBR
N28  C                   Z-ADD     77            POSNBR
N12  C                   GOTO      SLSØK
N12  C                   END
      *
     C     LINNBR        IFEQ      5
S28  C*    POSNBR        ANDGE     68
S28  C*    POSNBR        ANDLE     70
N28  C     POSNBR        ANDGE     89
N28  C     POSNBR        ANDLE     91
     C                   MOVE      'FF'          UAVGKD            2
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    UAVGKD
     C                   PARM                    W2AVTS
     C                   PARM                    UMOD
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
N16   *
N16  C     LINNBR        IFEQ      5
S28  C*    POSNBR        ANDGE     83
S28  C*    POSNBR        ANDLE     85
N28  C     POSNBR        ANDGE     80
N28  C     POSNBR        ANDLE     87
N16  C                   MOVE      'FF'          UAVGKD            2
N16  C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
N16  C                   CALL      'SAD061O'
N16  C                   PARM                    UAVGKD
N16  C                   PARM                    W2AVTS
N16  C                   PARM                    UMOD
N16  C                   Z-ADD     7             LINNBR
N16  C                   Z-ADD     6             POSNBR
N16  C                   GOTO      SLSØK
N16  C                   END
N19   *
N19  C     LINNBR        IFEQ      5
S28  C*    POSNBR        ANDGE     89
S28  C*    POSNBR        ANDLE     90
N28  C     POSNBR        ANDGE     95
N28  C     POSNBR        ANDLE     96
N19  C                   MOVE      'N'           USPED             1
N19  C                   CALL      'SYFI10L'
N19  C                   PARM                    W2LK
N19  C                   PARM                    USPED
S26  C*                  Z-ADD     7             LINNBR
S26  C*                  Z-ADD     6             POSNBR
S28  C*                  Z-ADD     92            POSNBR
N28  C                   Z-ADD     98            POSNBR
N19  C                   GOTO      SLSØK
N19  C                   END
N26   *
N26  C     LINNBR        IFEQ      5
S28  C*    POSNBR        ANDEQ     92
N28  C     POSNBR        ANDEQ     98
N26  C                   CALL      'SAD061N'
N26  C                   PARM                    W2PRE
N26  C                   Z-ADD     7             LINNBR
N26  C                   Z-ADD     6             POSNBR
N26  C                   GOTO      SLSØK
N26  C                   END
N12   *
N12  C     LINNBR        IFGE      7
N12  C     LINNBR        ANDLE     13
N12  C     POSNBR        ANDGE     35
S28  C*    POSNBR        ANDLE     40
N28  C     POSNBR        ANDLE     43
N12  C     LINNBR        SUB       6             XN
N12  C                   Z-ADD     VNT(XN)       UNU133           13 3
N12  C                   CALL      'SYGE11'
N12  C                   PARM                    UNU133
N20  C                   IF        UNU133 < 0
N20  C                   Z-SUB(H)  UNU133        VNT(XN)
N20  C                   ELSE
N12  C                   Z-ADD(H)  UNU133        VNT(XN)
N20  C                   END
S28  C*                  Z-ADD     42            POSNBR
N28  C                   Z-ADD     45            POSNBR
N12  C                   GOTO      SLSØK
N12  C                   END
N28   *
N28  C     LINNBR        IFGE      7
N28  C     LINNBR        ANDLE     13
N28  C     POSNBR        ANDGE     45
N28  C     POSNBR        ANDLE     48
N28  C                   EVAL      XN = (LINNBR - 7) + 1
N28  C                   EVAL      UENH = VEH(XN)
N28  C                   CALL      'SAD052F'
N28  C                   PARM                    UENH              4
N28  C                   EVAL      VEH(XN) = UENH
N28  C                   SELECT
N28  C                   WHEN      LINNBR <= 11
N28  C                   Z-ADD     50            POSNBR
N28  C                   WHEN      LINNBR = 12
N28  C                   Z-ADD     13            LINNBR
N28  C                   Z-ADD     6             POSNBR
N28  C                   WHEN      SEKDC = '1'
N28  C                   Z-ADD     59            POSNBR
N28  C                   OTHER
N28  C                   Z-ADD     15            LINNBR
N28  C                   Z-ADD     6             POSNBR
N28  C                   ENDSL
N28  C                   GOTO      SLSØK
N28  C                   END
      *
     C     LINNBR        IFGE      15
     C     LINNBR        ANDLE     19
S05  C*    POSNBR        ANDGE     30
N05  C     POSNBR        IFGE      30
     C     POSNBR        ANDLE     32
N05  C     POSNBR        ORGE      70
N05  C     POSNBR        ANDLE     72
S05  C*    LINNBR        SUB       14            XN
N05  C                   EVAL      XN = (LINNBR - 15) * 2 + 1
N05  C                   IF        POSNBR >= 70 AND POSNBR <= 72
N05  C                   EVAL      XN = XN + 1
N05  C                   END
     C                   MOVE      TCR(XN)       UCREF             3
     C                   MOVE      'N'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    UCREF
     C                   PARM                    UIMP
     C                   MOVE      UCREF         TCR(XN)
S05  C*    LINNBR        IFLT      19
S05  C*                  ADD       1             LINNBR
S05  C*                  Z-ADD     6             POSNBR
S05  C*                  END
N05  C                   SELECT
N05  C                   WHEN      POSNBR >= 30 AND POSNBR <= 32
N05  C                   Z-ADD     46            POSNBR
N05  C                   OTHER
N05  C                   Z-ADD     6             POSNBR
N05  C                   IF        LINNBR < 19
N05  C                   ADD       1             LINNBR
N05  C                   END
N05  C                   ENDSL
     C                   GOTO      SLSØK
N05  C                   END
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SAEHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SAEVK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    UTVLI
     C     SAEVK4        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    XXLN
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    W2FYL
N19  C     KODS2KOPP     KLIST
N19  C                   KFLD                    XS2UNI
N19  C                   KFLD                    W2LK
N26  C     SYPARL1K      KLIST
N26  C                   KFLD                    SEKNK
N26  C                   KFLD                    X_SYPAID
     C     TARIK         KLIST
     C                   KFLD                    W2VNT
     C                   KFLD                    X2TAR
     C     TARIKM        KLIST
     C                   KFLD                    W2VNT
     C                   KFLD                    X2TAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
      *
     C     *ENTRY        PLIST
S11  C*    UPARM1        PARM                    UPAR11          128
N11  C     UPARM1        PARM                    UPAR11          512
     C     UPARM2        PARM                    UPAR21          512
      *
     C                   OPEN      SAD052FU
     C                   CLEAR                   BILDE
     C                   MOVE      UPAR11        UPARM1
     C                   MOVE      UPAR21        UPARM2
N17  C                   EVAL      UF11 = 'N'
N17  C                   EVAL      UF21 = 'N'
N29   *
N29  C     'TVI00010'    CHAIN     SYPTFF                             33
N29  C                   IF        *IN33
N29  C                   MOVE      'J'           XVF               1
N29  C                   ELSE
N29  C                   IF        PTFDT < USEDT
N29  C                   MOVE      'J'           XVF
N29  C                   ELSE
N29  C                   MOVE      'N'           XVF
N29  C                   END
N29  C                   END
N29   *
N32  C                   CALL      'SYGE15C'
N32  C                   PARM                    WDT               8
N32  C                   PARM                    WTM               6
N32  C                   MOVE      WDT           XIDAG             8 0
N32   *
     C     UTVLI         IFGT      0
     C                   MOVE      'J'           XENDRE            1
     C                   MOVE      '1'           *IN27
     C                   ELSE
     C                   MOVE      'N'           XENDRE
     C                   MOVE      '0'           *IN27
     C                   END
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      *BLANKS       X2TAR             3
     C                   MOVE      'N'           XNY               1
      *
     C                   MOVE      'DIV1954'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     78            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT1            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1955'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     78            XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT2            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
      *
     C                   MOVE      UIN34         *IN34
     C                   MOVE      UIN37         *IN37
     C                   MOVE      UIN39         *IN39
      * IN60 PÅ --> SJØ-DEKLARASJON
     C                   MOVE      UIN60         *IN60
N22  C     SAEHK         CHAIN     SAEH                               33
N02  C     SAEHK         CHAIN     SAEHTL                             33
N02  C   33              Z-ADD     0.9           SEFVK
N33  C                   IF        SEVKB143=*ZEROS
N33  C                   EVAL      SEVKB143=SEVKB
N33  C                   ENDIF
N26   *
N26  C     *LIKE         DEFINE    SYPAID        X_SYPAID
N26  C     *LIKE         DEFINE    SYVRDA        X_SYVRDA
N26  C                   EVAL      X_SYPAID = 'GKEKS'
N26  C     SYPARL1K      CHAIN     SYPARL1                            33
N26  C  N33              EVAL      X_SYVRDA = SYVRDA
      *
     C                   ENDSR
      *
N23   ***********************************************
N23  C     SRTSTCONT     BEGSR
N23   ***********************************************
N23  C                   SELECT
E24  C                   WHEN      W2CNR = *BLANKS OR                           MANGLE CONTAINERNR
E24  C                             %SUBST(W2CNR:14:4) <> *BLANKS                FOR LANG CONTAINER
N23  C                   EVAL      *IN30 = *ON
E24  C                   WHEN      %SUBST(W2CNR:1:1) < 'A' AND                  FØRSTE 4 <> A-Z
E24  C                             %SUBST(W2CNR:1:1) > 'Z' OR
E24  C                             %SUBST(W2CNR:2:1) < 'A' AND
E24  C                             %SUBST(W2CNR:2:1) > 'Z' OR
E24  C                             %SUBST(W2CNR:3:1) < 'A' AND
E24  C                             %SUBST(W2CNR:3:1) > 'Z' OR
E24  C                             %SUBST(W2CNR:4:1) < 'A' AND
E24  C                             %SUBST(W2CNR:4:1) > 'Z'
N23  C                   EVAL      *IN30 = *ON
N23  C                   OTHER
N23   *
N23  C                   SELECT
E24  C                   WHEN      %SUBST(W2CNR:5:1) = ' ' OR                   FORMAT AAAA 123456 7
E24  C                             %SUBST(W2CNR:5:1) = '-'
E24  C                   EVAL      XAN07 = %SUBST(W2CNR:6:6)
E24  C                             + %SUBST(W2CNR:13:1)
E24  C                   WHEN      %SUBST(W2CNR:12:6) <> *BLANKS                FOR LANG CONTAINER
N23  C                   EVAL      *IN30 = *ON
N23  C                   OTHER                                                  FORMAT AAAA1234567
E24  C                   EVAL      XAN07 = %SUBST(W2CNR:5:7)
N23  C                   ENDSL
N23   *
N23  C     1             DO        7             XN3               3 0          TEST OM TALL
N23  C                   IF        %SUBST(XAN07:XN3:1) < '0' OR
N23  C                             %SUBST(XAN07:XN3:1) > '9'
N23  C                   EVAL      *IN30 = *ON                                  FEIL: IKKE TALL
N23  C                   LEAVE
N23  C                   END
N23   *
N23  C                   ENDDO
N23  C                   ENDSL
N23   *
N23  C                   IF        *IN30
S24  C*    XN            ADD       6             LINNBR
S24  C*                  Z-ADD     6             POSNBR
N24  C                   Z-ADD     13            LINNBR
E24  C                   Z-ADD     59            POSNBR
N23  C                   MOVE      'YBC2030'     MSGNR
N23  C                   ELSE
E24  C                   IF        %SUBST(W2CNR:5:1) = ' ' OR                   FORMAT AAAA 123456 7
E24  C                             %SUBST(W2CNR:5:1) = '-'
E24  C                   EVAL      UCONNR = %SUBST(W2CNR:1:4)
E24  C                             + %SUBST(W2CNR:6:6)
E24  C                             + %SUBST(W2CNR:13:1)
N23  C                   ELSE
N23  C                   EVAL      UCONNR = W2CNR
N23  C                   END
N23  C                   CALL      'SYGE124'
N23  C                   PARM                    UCONNR           11
N23  C                   PARM                    UCTLSIF           1
N23  C                   PARM                    UOK               1
N23  C                   IF        UOK <> 'J'
N23  C                   EVAL      *IN30 = *ON
S24  C*    XN            ADD       6             LINNBR
S24  C*                  Z-ADD     6             POSNBR
N24  C                   Z-ADD     13            LINNBR
E24x C                   Z-ADD     59            POSNBR
N23  C                   MOVE      'YBC2031'     MSGNR
N23  C                   END
N23  C                   END
N23   *
N23  C                   ENDSR
N23   *
