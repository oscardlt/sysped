      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE levs geb/sign             ***
      ***********************************************************
      *
     FKONTL01   IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FLEVEL02   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FNAVLEV    UF A E           K DISK
     FSYNA03FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     LEVE2K        SETLL     LEVEL02
     C     START1        TAG
     C     FIFIRM        READE     LEVEL02                                94
     c  N94aktkod        ifeq      'I'
     c  N94              goto      start1
     c                   end
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        17
     C                   ADD       1             ZRECNO
     C     NAVKEY        CHAIN(N)  NAVLEV                             99
     C   99              EXSR      MOVB1
     C                   WRITE     SUBFIL
     c     startn        tag
     C     FIFIRM        READE     LEVEL02                                94
     c  N94aktkod        ifeq      'I'
     c  N94              goto      startn
     c                   end
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** SØK FRA
     C   08              GOTO      START6
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENT
     C                   GOTO      START3
     C                   END
     C*
     C*** SØK FRA
     C     START6        TAG
     C                   EXFMT     VAREL2
     C   03              GOTO      SLUTT
     c   12              goto      start3
     c                   move      sonv          sonv0
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     c                   setoff                                       307172
     c                   setoff                                       737475
     c                   setoff                                       7677
     C*
     C* TEST konto
     C*
     c     wskon1        ifne      *zeros
     c                   move      wskon1        wskon
     C     keykon        chain     kontl01                            72
     c     *in72         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto 2
     C*
     c     wskon2        ifne      *zeros
     c                   move      wskon2        wskon
     C     keykon        chain     kontl01                            73
     c     *in73         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto 3
     C*
     c     wskon3        ifne      *zeros
     c                   move      wskon3        wskon
     C     keykon        chain     kontl01                            74
     c     *in74         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto 4
     C*
     c     wskon4        ifne      *zeros
     c                   move      wskon4        wskon
     C     keykon        chain     kontl01                            75
     c     *in75         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto 5
     C*
     c     wskon5        ifne      *zeros
     c                   move      wskon5        wskon
     C     keykon        chain     kontl01                            76
     c     *in76         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto 6
     C*
     c     wskon6        ifne      *zeros
     c                   move      wskon6        wskon
     C     keykon        chain     kontl01                            77
     c     *in77         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto 7
     C*
     c     wskon7        ifne      *zeros
     c                   move      wskon7        wskon
     C     keykon        chain     kontl01                            78
     c     *in78         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST konto  8
     C*
     c     wskon8        ifne      *zeros
     c                   move      wskon8        wskon
     C     keykon        chain     kontl01                            79
     c     *in79         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C*
     C* TEST signaturt
     C*
     c  N30wssg          ifne      *blanks
     C     keysg         chain     kodtsf                             71
     c     *in71         ifeq      '1'
     c                   seton                                        30
     c                   end
     c                   end
      *
     C  N30              EXSR      MOVWCC
     C*
     C     STTB1         TAG
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C                   MOVEA     '0'           *IN(98)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     c     *in98         ifeq      '0'
      *
      * endring
      *
     C     WSNR          IFEQ      '2'
     C                   EXSR      MOVCCW
     c     FEIL          TAG
     C                   EXFMT     VARELI
      * 12 = avbryt
     C   12              DO
     C                   UPDATE    SUBFIL
     C                   GOTO      START3
     C                   END
      * test gyldighet
     C                   EXSR      TESTB1
     c   30              goto      feil
     C*
     C                   UPDATE    SUBFIL
     C                   MOVE      ' '           WSNR
     C                   END
     C                   seton                                        98
     C                   END
      *
     C                   END
     C*
     C     SLHENT        ENDSR
     C*
     C***********************************************
     C     MOVWCC        BEGSR
     C***********************************************
     C     NAVKEY        CHAIN     NAVLEV                             99
     C                   MOVE      WSKON1        NAVKO1
     C                   MOVE      WSKON2        NAVKO2
     C                   MOVE      WSKON3        NAVKO3
     C                   MOVE      WSKON4        NAVKO4
     C                   MOVE      WSKON5        NAVKO5
     C                   MOVE      WSKON6        NAVKO6
     C                   MOVE      WSKON7        NAVKO7
     C                   MOVE      WSKON8        NAVKO8
     C                   MOVE      WSAVD1        NAVAV1
     C                   MOVE      WSAVD2        NAVAV2
     C                   MOVE      WSAVD3        NAVAV3
     C                   MOVE      WSAVD4        NAVAV4
     C                   MOVE      WSAVD5        NAVAV5
     C                   MOVE      WSAVD6        NAVAV6
     C                   MOVE      WSAVD7        NAVAV7
     C                   MOVE      WSAVD8        NAVAV8
     C                   MOVE      WSBAR1        NAVBA1
     C                   MOVE      WSBAR2        NAVBA2
     C                   MOVE      WSBAR3        NAVBA3
     C                   MOVE      WSBAR4        NAVBA4
     C                   MOVE      WSBAR5        NAVBA5
     C                   MOVE      WSBAR6        NAVBA6
     C                   MOVE      WSBAR7        NAVBA7
     C                   MOVE      WSBAR8        NAVBA8
     C                   MOVE      WSPRO1        NAVPR1
     C                   MOVE      WSPRO2        NAVPR2
     C                   MOVE      WSPRO3        NAVPR3
     C                   MOVE      WSPRO4        NAVPR4
     C                   MOVE      WSPRO5        NAVPR5
     C                   MOVE      WSPRO6        NAVPR6
     C                   MOVE      WSPRO7        NAVPR7
     C                   MOVE      WSPRO8        NAVPR8
     C                   MOVE      WSSG          NAVSG
     C   99              WRITE     NAVLEVR
     C  N99              UPDATE    NAVLEVR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVCCW        BEGSR
     C***********************************************
     C                   MOVE      NAVSG         WSSG
     C                   MOVE      NAVKO1        WSKON1
     C                   MOVE      NAVKO2        WSKON2
     C                   MOVE      NAVKO3        WSKON3
     C                   MOVE      NAVKO4        WSKON4
     C                   MOVE      NAVKO5        WSKON5
     C                   MOVE      NAVKO6        WSKON6
     C                   MOVE      NAVKO7        WSKON7
     C                   MOVE      NAVKO8        WSKON8
     C                   MOVE      NAVAV1        WSAVD1
     C                   MOVE      NAVAV2        WSAVD2
     C                   MOVE      NAVAV3        WSAVD3
     C                   MOVE      NAVAV4        WSAVD4
     C                   MOVE      NAVAV5        WSAVD5
     C                   MOVE      NAVAV6        WSAVD6
     C                   MOVE      NAVAV7        WSAVD7
     C                   MOVE      NAVAV8        WSAVD8
     C                   MOVE      NAVBA1        WSBAR1
     C                   MOVE      NAVBA2        WSBAR2
     C                   MOVE      NAVBA3        WSBAR3
     C                   MOVE      NAVBA4        WSBAR4
     C                   MOVE      NAVBA5        WSBAR5
     C                   MOVE      NAVBA6        WSBAR6
     C                   MOVE      NAVBA7        WSBAR7
     C                   MOVE      NAVBA8        WSBAR8
     C                   MOVE      NAVPR1        WSPRO1
     C                   MOVE      NAVPR2        WSPRO2
     C                   MOVE      NAVPR3        WSPRO3
     C                   MOVE      NAVPR4        WSPRO4
     C                   MOVE      NAVPR5        WSPRO5
     C                   MOVE      NAVPR6        WSPRO6
     C                   MOVE      NAVPR7        WSPRO7
     C                   MOVE      NAVPR8        WSPRO8
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       NAVSG
     C                   MOVE      *ZEROS        NAVKO1
     C                   MOVE      *ZEROS        NAVKO2
     C                   MOVE      *ZEROS        NAVKO3
     C                   MOVE      *ZEROS        NAVKO4
     C                   MOVE      *ZEROS        NAVKO5
     C                   MOVE      *ZEROS        NAVKO6
     C                   MOVE      *ZEROS        NAVKO7
     C                   MOVE      *ZEROS        NAVKO8
     C                   MOVE      *ZEROS        NAVAV1
     C                   MOVE      *ZEROS        NAVAV2
     C                   MOVE      *ZEROS        NAVAV3
     C                   MOVE      *ZEROS        NAVAV4
     C                   MOVE      *ZEROS        NAVAV5
     C                   MOVE      *ZEROS        NAVAV6
     C                   MOVE      *ZEROS        NAVAV7
     C                   MOVE      *ZEROS        NAVAV8
     C                   MOVE      *ZEROS        NAVBA1
     C                   MOVE      *ZEROS        NAVBA2
     C                   MOVE      *ZEROS        NAVBA3
     C                   MOVE      *ZEROS        NAVBA4
     C                   MOVE      *ZEROS        NAVBA5
     C                   MOVE      *ZEROS        NAVBA6
     C                   MOVE      *ZEROS        NAVBA7
     C                   MOVE      *ZEROS        NAVBA8
     C                   MOVE      *ZEROS        NAVPR1
     C                   MOVE      *ZEROS        NAVPR2
     C                   MOVE      *ZEROS        NAVPR3
     C                   MOVE      *ZEROS        NAVPR4
     C                   MOVE      *ZEROS        NAVPR5
     C                   MOVE      *ZEROS        NAVPR6
     C                   MOVE      *ZEROS        NAVPR7
     C                   MOVE      *ZEROS        NAVPR8
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     c     keykon        klist
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKON             5 0
     c     keysg         klist
     C                   KFLD                    KODESG
     C                   KFLD                    WSSG
     c                   move      'SF'          KODESG            2
     C     NAVKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    LEVNR
     C     LEVE2K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    SONV0            10
     C*
     C                   READ      FIRM                                   99
     C*
     C                   ENDSR
     C*
