     H DFTACTGRP(*NO) BNDDIR('BASE64')

      /copy qrpglesrc,ifsio_h
      /copy base64_h

     D fd              s             10i 0
     d filnam          s            256A   varying
     d Input64         s          32000A   Inz varying
     d Result          s          65535A   Inz varying
     D outlen          S             10I 0
      *
     C     *entry        PLIST
     C                   PARM                    Filename        100
     C                   PARM                    Base64Inp     32000
      /free
        Input64= %trim(%subst(Base64Inp:23));
        filnam = '/syspeddev/signatur/'+%trim(Filename);

            fd = open(filnam
                     : O_CREAT + O_WRONLY + O_CCSID
                     : S_IRUSR + S_IWUSR + S_IRWXU + S_IROTH + S_IXOTH
                     : 819 );
            %len(Result) = %len(Result:*MAX);

            outlen = base64_decode( %addr(input64 : *DATA)
                                  : %len(input64)
                                  : %addr(result : *DATA)
                                  : %len(Result) );
            %len(Result) = outlen;

            callp write(fd : %addr(result:*DATA) : outlen);
            callp close(fd);
            return;
      /end-free
