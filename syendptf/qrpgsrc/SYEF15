********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 to MC priser       .....
10XXX * 02 CB  PTF10 Flere parameter til TDV Booking
      * 03 SH  PTF10 MINIMUM HAR NÅ 2 DESIMALER PÅ SECURITU FUEL OG WAR
      * 04 SH  PTF10 SAMORDNES SUM OPR VARELINJE LIK SOM HAWB
11022 * 05 CB  PTF11 støtte for eAWB
11051 * 06 CB  PTF11 Other Customs Information
11051 * 07 SH  PTF11 Fri kode fuel surcharge
11051 * 08 sh  PTF11 5 nye linjer side 2
********************************************************************
      ***************************************************************
      *** VEDLIKEHOLD AV MAWB-SAMLAST                             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01 02 06-11 13-26                    ***
      *** LEDIGE INDIKATORER 27-29 31 37-86 90-98                 ***
      ***************************************************************
     FAIRSONE   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FDOKOTHM   UF A E           K DISK
     FKODTFS    IF   E           K DISK
     FKODTSEC   IF   E           K DISK
     FDOKEQM    UF A E           K DISK
     FDOKEM     UF A E           K DISK
     FHEAD19    IF   E           K DISK
     FSAMLB     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTPB    IF   E           K DISK
     FKODTFC    IF   E           K DISK
     FKODTWAR   IF   E           K DISK
     FAIRLDL1   IF   E           K DISK
     FFFR01L    IF   E           K DISK    USROPN
     FFFA01L    IF   E           K DISK    USROPN
     FLOGL05    IF   E           K DISK    USROPN
     FRATCDF    IF   E           K DISK
     FSYEF15FM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D MSG             S             62    DIM(7) CTDATA PERRCD(1)
     D NAV             S              3    DIM(12) CTDATA PERRCD(1)
     D WHØ             S              5  0 DIM(11)
     D WLE             S              5  0 DIM(11)
     D WBR             S              5  0 DIM(11)
     D WAN             S              5  0 DIM(11)
     D UHØ             S              5    DIM(11)
     D ULE             S              5    DIM(11)
     D UBR             S              5    DIM(11)
     D UAN             S              5    DIM(11)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XRFA                   1     15
     D  WSSD                   1      3
     D  WSLNR                  4      6  0
     D  SAMLNO                 1      6
     D  XBLANK                 7     15
     D                 DS
     D  IA                     1     30  2
     D                                     DIM(6)
     D  KPFIN                  1      5  2
     D  KPFI45                 6     10  2
     D  KPFI10                11     15  2
     D  KPFI30                16     20  2
     D  KPFI50                21     25  2
     D  KPFI1                 26     30  2
     D                 DS
     D  XVS                    1     25
     D  XAN                    1      3  0
     D  XTG1                   4      4
     D  XHØ                    5      7  0
     D  XTG2                   8      8
     D  XLE                    9     11  0
     D  XTG3                  12     12
     D  XBR                   13     15  0
     D                 DS
     D  WSINFA                 1     71
     D  XINFA1                 1      2
     D  XINFA2                 3     71
     D                 DS
     D  KA                     1     24
     D                                     DIM(6)
     D  WSNT1                  1      4
     D  WSNT2                  5      8
     D  WSNT3                  9     12
     D  WSNT4                 13     16
     D  WSNT5                 17     20
     D  WSNT6                 21     24
     D                 DS
     D  KA1                    1     24
     D                                     DIM(6)
     D  DFNT1                  1      4
     D  DFNT2                  5      8
     D  DFNT3                  9     12
     D  DFNT4                 13     16
     D  DFNT5                 17     20
     D  DFNT6                 21     24
     D                 DS
     D  VE                     1     42  1
     D                                     DIM(6)
     D  WSVKT1                 1      7  1
     D  WSVKT2                 8     14  1
     D  WSVKT3                15     21  1
     D  WSVKT4                22     28  1
     D  WSVKT5                29     35  1
     D  WSVKT6                36     42  1
     D                 DS
     D  VE1                    1     42  1
     D                                     DIM(6)
     D  DFVKT1                 1      7  1
     D  DFVKT2                 8     14  1
     D  DFVKT3                15     21  1
     D  DFVKT4                22     28  1
     D  DFVKT5                29     35  1
     D  DFVKT6                36     42  1
     D                 DS
     D  RA                     1      6
     D                                     DIM(6)
     D  WSRC1                  1      1
     D  WSRC2                  2      2
     D  WSRC3                  3      3
     D  WSRC4                  4      4
     D  WSRC5                  5      5
     D  WSRC6                  6      6
     D                 DS
     D  RA1                    1      6
     D                                     DIM(6)
     D  DFRC1                  1      1
     D  DFRC2                  2      2
     D  DFRC3                  3      3
     D  DFRC4                  4      4
     D  DFRC5                  5      5
     D  DFRC6                  6      6
     D                 DS
     D  IT                     1     24
     D                                     DIM(6)
     D  WSCOM1                 1      4
     D  WSCOM2                 5      8
     D  WSCOM3                 9     12
     D  WSCOM4                13     16
     D  WSCOM5                17     20
     D  WSCOM6                21     24
     D                 DS
     D  IT1                    1     24
     D                                     DIM(6)
     D  DFCOM1                 1      4
     D  DFCOM2                 5      8
     D  DFCOM3                 9     12
     D  DFCOM4                13     16
     D  DFCOM5                17     20
     D  DFCOM6                21     24
     D                 DS
     D  FV                     1     42  1
     D                                     DIM(6)
     D  WSFBV1                 1      7  1
     D  WSFBV2                 8     14  1
     D  WSFBV3                15     21  1
     D  WSFBV4                22     28  1
     D  WSFBV5                29     35  1
     D  WSFBV6                36     42  1
     D                 DS
     D  FV1                    1     42  1
     D                                     DIM(6)
     D  DFFBV1                 1      7  1
     D  DFFBV2                 8     14  1
     D  DFFBV3                15     21  1
     D  DFFBV4                22     28  1
     D  DFFBV5                29     35  1
     D  DFFBV6                36     42  1
     D                 DS
     D  MI                     1      6
     D                                     DIM(6)
     D  WSRK1                  1      1
     D  WSRK2                  2      2
     D  WSRK3                  3      3
     D  WSRK4                  4      4
     D  WSRK5                  5      5
     D  WSRK6                  6      6
     D                 DS
     D  MI1                    1      6
     D                                     DIM(6)
     D  DFRK1                  1      1
     D  DFRK2                  2      2
     D  DFRK3                  3      3
     D  DFRK4                  4      4
     D  DFRK5                  5      5
     D  DFRK6                  6      6
     D                 DS
     D  PR                     1     48  2
     D                                     DIM(6)
     D  WSRPR1                 1      8  2
     D  WSRPR2                 9     16  2
     D  WSRPR3                17     24  2
     D  WSRPR4                25     32  2
     D  WSRPR5                33     40  2
     D  WSRPR6                41     48  2
     D                 DS
     D  PR1                    1     48  2
     D                                     DIM(6)
     D  DFRPR1                 1      8  2
     D  DFRPR2                 9     16  2
     D  DFRPR3                17     24  2
     D  DFRPR4                25     32  2
     D  DFRPR5                33     40  2
     D  DFRPR6                41     48  2
     D                 DS
     D  BE                     1     60  2
     D                                     DIM(6)
     D  WSBLT1                 1     10  2
     D  WSBLT2                11     20  2
     D  WSBLT3                21     30  2
     D  WSBLT4                31     40  2
     D  WSBLT5                41     50  2
     D  WSBLT6                51     60  2
     D                 DS
     D  BE1                    1     60  2
     D                                     DIM(6)
     D  DFBLT1                 1     10  2
     D  DFBLT2                11     20  2
     D  DFBLT3                21     30  2
     D  DFBLT4                31     40  2
     D  DFBLT5                41     50  2
     D  DFBLT6                51     60  2
     D                 DS
     D  VA                     1    250
     D                                     DIM(10)
     D  WSVS1                  1     25
     D  WSVS2                 26     50
     D  WSVS3                 51     75
     D  WSVS4                 76    100
     D  WSVS5                101    125
     D  WSVS6                126    150
     D  WSVS7                151    175
     D  WSVS8                176    200
     D  WSVS9                201    225
     D  WSVS10               226    250
     D                 DS
     D  VA1                    1    250
     D                                     DIM(10)
     D  DFVS1                  1     25
     D  DFVS2                 26     50
     D  DFVS3                 51     75
     D  DFVS4                 76    100
     D  DFVS5                101    125
     D  DFVS6                126    150
     D  DFVS7                151    175
     D  DFVS8                176    200
     D  DFVS9                201    225
     D  DFVS10               226    250
     D                 DS
     D  SMSDF                  1      3
     D  WSSDF                  1      3
     D                 DS
     D  HESDT                  1      5
     D  WSSDT                  1      3
     D                 DS
     D  HEKNT                  1      8  0
     D  HEKNF                  6      8  0
      *____________________________________________________________
      * Definisjon av parameterlisten som brukes ved kall av SM220R
      * (automatisk booking via linje). TdV IS må være installert
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
      * AUTTRM = '1' ---> automatisk sending uten å se ekstra bildet
      * AUTTRM = annet ---> visning av ekstra bildet med opplysninger
      * OBS. Finnes det syntax feil vises ekstra bildet uansett
     D  AUTTRM                 1      1
     D  AUTPID                 2     18
     D  AUTALN                19     21  0
     D  AUTAWB                22     29  0
     D  AUTORI                30     32
     D  AUTDES                33     35
     D  AUTSDC                36     36
     D  AUTNPI                37     40  0
     D  AUTWCD                41     41
     D  AUTWGH                42     50  1
     D  AUTTPI                51     54  0
     D  AUTMAN                55     69
     D  AUTPAR                70     72
     D  AUTPCD                73     89
     D  AUTPAI                90     92
     D  AUTOFD                93     94
     D  AUTCOD                95     96
     D  AUTRAI                97     99
      * First Flight Detail
     D  AUTCAR               100    101
     D  AUTFLN               102    106
     D  AUTDAY               107    108  0
     D  AUTMND               109    111
     D  AUTDEP               112    114
     D  AUTARR               115    117
     D  AUTSPC               118    119
     D  AUTAID               120    133
      * Second Flight Detail
     D  AU2CAR               134    135
     D  AU2FLN               136    140
     D  AU2DAY               141    142  0
     D  AU2MND               143    145
     D  AU2DEP               146    148
     D  AU2ARR               149    151
     D  AU2SPC               152    153
     D  AU2AID               154    167
     D  AU2                  134    167
      * Third Flight Detail
     D  AU3CAR               168    169
     D  AU3FLN               170    174
     D  AU3DAY               175    176  0
     D  AU3MND               177    179
     D  AU3DEP               180    182
     D  AU3ARR               183    185
     D  AU3SPC               186    187
     D  AU3AID               188    201
     D  AU3                  168    201
      * Special Handling codes (parameter values)
     D  AUSPE1               202    204
     D  AUSP11               202    202
     D  AUSP12               203    203
     D  AUSP13               204    204
     D  AUSPE2               205    207
     D  AUSP21               205    205
     D  AUSP22               206    206
     D  AUSP23               207    207
      * Future Dimensions Information
      * Instead used to Volume
     D  AUDIM                208    240
      * Volume and Volume Measurements
     D  AUVOL                208    218
     D  AUVOLM               219    220
      * Shipment Reference Information
     D  AUTREF               221    234
     D  AUTSI1               235    246
     D  AUTSI2               247    258
N02   * 09. Product Information
N02  D  AU093                301    301
N02   * 12. Customer Identification
N02  D  AU1222               302    315
N02  D  AU1224               316    322  0
N02  D  AU1226               323    326  0
N02  D  AU1228               327    329
N02  D  AU1242               330    364
N02  D  AU1252               365    382
      *
     D  AUTINF                 1    512
      *
     D                 DS
     D  SMMAWB                 1     11  0
     D  SMMAW3                 1      3
     D  SMMAW8                 4     11  0
     D                 DS
     D  WSROB1                 1      7
     D  WSRO21                 1      2
     D  WSRO41                 3      7
     D                 DS
     D  WSROB2                 1      7
     D  WSRO22                 1      2
     D  WSRO42                 3      7
     D                 DS
     D  WSROB3                 1      7
     D  WSRO23                 1      2
     D  WSRO43                 3      7
     D                 DS
     D  WREF2                  1     12
     D  WREF2A                 1      3
     D  WREF2B                 4      4
     D  WREF2C                 5     12
     D                 DS
     D  FLIG                   1      6
     D  FAA                    1      1
     D  FAB                    2      2
     D  FBA                    3      3
     D  FBB                    4      4
     D  FBC                    5      5
     D  FCC                    6      6
     D                 DS            11
     D NUM             C                   CONST(' 0123456789')
     D                 DS
     D  WW112                  1     11  2
     D                 DS
     D  DSDAT                  1      8  0
     D  DSAAR                  1      4  0
     D  DSMND                  5      6  0
     D  DSDAG                  7      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
      *___________________
      * DS for System Data
      *"""""""""""""""""""
     D                SDS
     D  WUSER                254    263
      *
     C                   EXSR      INIT
     C                   EXSR      UTCMDL
      *
      * DIRECTLY CALLED
      *
     C     WSSD          IFNE      *BLANKS
     C                   MOVE      'Y'           DIRCAL            1
     C                   GOTO      NEXTS
     C                   END
      *
     C     START         TAG
     C                   EXFMT     BILDE01
     C   03              GOTO      SLUTT
     C     NEXTS         TAG
     C     SAMLBK        CHAIN     SAMLB                              99
     C   99              GOTO      START
      *
     C     DOKEMK        CHAIN     DOKEM                              33
     C                   EXSR      MOVW
     C                   EXSR      TESTB
      *
     C     START2        TAG
      *
      *
      * GEBYR:    EXPORT TERMINAL = MO
      *
     C                   EXSR      SRMO
      *
      *
      * GEBYR:    SECURITY CHARGE = SC
      *
     C                   SETOFF                                       66
     C     KODSCK        SETLL     KODTSEC
     C     *in66         doweq     '0'
     C     KODSCK        READE     KODTSEC                                66
     C     *IN66         IFEQ      *OFF
     C                   MOVEL     KFCOTH        WO1331
      * SJEKK GYLDIGHETSDATO
     C     KFCTIL        IFEQ      *ZEROS
     C                   MOVE      99999999      KFCTIL
     C                   END
     C     HEDTOP        IFLE      KFCTIL
     C     HEDTOP        ANDGE     KFCFRA
     C                   EXSR      BEREGN
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
      *
      * GEBYR:    WAR RISK SURCHARGE
      *
     C                   SETOFF                                       66
     C     KODSCK        SETLL     KODTWAR
     C     *in66         doweq     '0'
     C     KODSCK        READE     KODTWAR                                66
     C     *IN66         IFEQ      *OFF
      * SJEKK GYLDIGHETSDATO
     C     KFCTIL        IFEQ      *ZEROS
     C                   MOVE      99999999      KFCTIL
     C                   END
     C     HEDTOP        IFLE      KFCTIL
     C     HEDTOP        ANDGE     KFCFRA
     C                   MOVEL     KFCOTH        WO1331
     C                   EXSR      BEREGN
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
      *
      *
      * GEBYR:    FUEL SUR CHARGE = MY
      *
s07  C*                  MOVEL     'MY'          WO1331
     C                   move      'N'           BERFC             1
     C                   movel     SMSD          WSSDA5            5
     C     WSSDA5        CHAIN     STED2                              73
     C  N73KEYSON        chain     airsone                            73
     C  N73              MOVEL     AIRSON        XXSONE            2
     C   73              MOVE      *blanks       XXSONE            2
     c     xxsone        ifne      *blanks
     C                   movel     xxsone        yfcun2
     C                   else
     C                   move      'FC'          yfcun2
     C                   end
     c     nyfc          tag
     C                   SETOFF                                       66
     C     KODFCK        SETLL     KODTFC
     C     *in66         doweq     '0'
     C     KODFCK        READE     KODTFC                                 66
     C     *IN66         IFEQ      *OFF
      * SJEKK GYLDIGHETSDATO
     C     KFCTIL        IFEQ      *ZEROS
     C                   MOVE      99999999      KFCTIL
     C                   END
     C     HEDTOP        IFLE      KFCTIL
     C     HEDTOP        ANDGE     KFCFRA
n07  C                   MOVEL     KFCOTH        WO1331
     C                   EXSR      BEREGN
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
      * ny løkke på standardtabell uten sone
     C     YFCUN2        ifne      'FC'
     c     berfc         andeq     'N'
     c                   move      'FC'          YFCUN2
     c                   setoff                                       66
     c                   goto      nyfc
     c                   end
      *
      * SUMMER OTHER CHARGES
      *
     C                   EXSR      SUMOTH
      *
     C                   EXFMT     BILDE02
     C                   SETOFF                                       30
     C     FITDVI        IFEQ      'J'
     C     SMMAW3        ANDNE     *BLANKS
     C     WSCMN         ANDEQ     'J'
     C     *IN03         IFEQ      *ON
      * SJEKK OM AWB NUMMERET ER BOOKET VIA TDV IS.
     C                   MOVEL     'FFR'         WWMSID           17
     C                   MOVEL     SMMAW3        WREF2A
     C                   MOVEL     '-'           WREF2B
     C                   MOVEL     SMMAW8        WREF2C
     C     LOGKY         SETLL     LOGL05                                 90
     C     *IN90         IFEQ      *OFF                                         <IKKE FUNNET
     C                   EXSR      SFFR
     C                   ENDIF                                                  <*IN90
     C                   ENDIF                                                  <*IN03
     C                   ENDIF                                                  <FITDVI
     C                   MOVE      *BLANKS       WREF2
      *
      * GETS CURSORPOSITION
      *
     C     WSCLOC        DIV       256           LINNBR            3 0
     C                   MVR                     POSNBR            3 0
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     *IN04         IFEQ      '1'
     C     POSNBR        IFEQ      15
     C     LINNBR        ANDGE     13
     C     POSNBR        ANDLE     18
     C                   EXSR      SRF4RC
     C                   GOTO      START2
     C                   ELSE
      *  SEARCH CUSTOMER
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSCONR
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      START2
     C                   END
     C                   ENDIF
     C   12DIRCAL        IFEQ      ' '
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      SLUTT
     C                   END
     C     *IN20         IFEQ      '1'
     C     *IN21         OREQ      '1'
     C     *IN22         OREQ      '1'
     C     FITDVI        IFNE      'J'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      START2
     C                   ENDIF
     C                   ENDIF
      *
      * SEND BOOKING VIA TDV IS
      *
     C     *IN20         IFEQ      '1'
     C     *IN21         OREQ      '1'
     C                   EXSR      SFFR
     C                   GOTO      START2
     C                   END
      *
      * KALL PÅ TDVIS LOGGFUNKSJON (SM040C)
      *
     C     *IN22         IFEQ      '1'
     C                   EXSR      VLOG
     C                   GOTO      START2
     C                   END
     C   10              DO
     C                   MOVE      'Q'           YRIQ              1
     C     DOKEQK        CHAIN     DOKEQM                             36
     C  N36              UPDATE    DOKEQMR
     C  N36              EXSR      MOVDQW
N05  C     F10TAG        TAG
     C                   EXFMT     BILDE03
N05  C     *IN04         IFEQ      '1'
N05  C                   EXSR      SOKDTA2
N05  C                   GOTO      F10TAG
N05  C                   ENDIF
     C  N12              EXSR      OPDDOQ
     C                   GOTO      START2
     C                   END
      *
      * WORK WITH OTHER CHARGES
      *
     C   11              DO
     C                   MOVE      WSLNR         PLNR              3 0
     C                   CALL      'SYEF10OM'
     C                   PARM                    WSSD
     C                   PARM                    PLNR
     C                   PARM                    UFLAGG            1 0
     C                   EXSR      SUMOTH
     C                   GOTO      START2
     C                   ENDDO
N06   * Other Customs Information
N06  C   13              DO
N06  C                   MOVE      WSLNR         PLNR
N06  C                   CALL      'SYEF10IM'
N06  C                   PARM                    WSSD
N06  C                   PARM                    PLNR
N06  C                   PARM                    UFLAGG
N06  C                   GOTO      START2
N06  C                   ENDDO
      *
      * F24=FLERE TASTER
      *
     C     *IN24         IFEQ      '1'
     C                   EXSR      UTCMDL
     C                   GOTO      START2
     C                   END
      *
     C   05              EXSR      MOVW
     C                   EXSR      TESTB
     C   30
     CORN03              GOTO      START2
      *
     C                   EXSR      OPDDOK
     C     DIRCAL        IFEQ      ' '
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     DIRCAL        IFEQ      ' '
     C                   MOVE      WSSD          WSSDA
     C                   MOVE      WSLNR         WSLNRA
     C                   END
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     MOVDQW        BEGSR
      ***********************************************
     C                   MOVE      DQNA          WSNA
     C                   MOVE      DQAD1         WSAD1
     C                   MOVE      DQAD2         WSAD2
     C                   MOVE      DQAD3         WSAD3
     C                   MOVE      DQAD4         WSAD4
     C                   MOVEL     DQINFD        WSINFD
     C                   MOVE      DQINF3        WSINF3
     C                   MOVE      DQINF4        WSINF4
     C                   MOVE      DQINF5        WSINF5
     C                   MOVE      DQINF6        WSINF6
     C                   MOVE      DQINF7        WSINF7
     C                   MOVE      DQINF8        WSINF8
     C                   MOVE      DQINF9        WSINF9
     C                   MOVE      DQVS11        WSVS11
     C                   MOVE      DQVS12        WSVS12
     C                   MOVE      DQVS13        WSVS13
N08  C                   MOVE      DQVS14        WSVS14
N08  C                   MOVE      DQVS15        WSVS15
N08  C                   MOVE      DQVS16        WSVS16
N08  C                   MOVE      DQVS17        WSVS17
N08  C                   MOVE      DQVS18        WSVS18
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDDOQ        BEGSR
      ***********************************************
     C     DOKOKE        KLIST
     C                   KFLD                    WSSD
     C                   KFLD                    WSLNR
     C     DOKEQK        KLIST
     C                   KFLD                    YRIQ
     C                   KFLD                    WSSD
     C                   KFLD                    WSLNR
     C     DOKEQK        CHAIN     DOKEQM                             36
      *
     C   36              DO
     C                   MOVE      YRIQ          DQRI
     C                   MOVE      WSSD          DQSLD
     C                   MOVE      WSLNR         DQSLNR
     C                   END
      *
     C                   MOVE      ' '           DQST
     C                   MOVE      WSNA          DQNA
     C                   MOVE      WSAD1         DQAD1
     C                   MOVE      WSAD2         DQAD2
     C                   MOVE      WSAD3         DQAD3
     C                   MOVE      WSAD4         DQAD4
     C                   MOVEL     WSINFD        DQINFD
     C                   MOVE      WSINF3        DQINF3
     C                   MOVE      WSINF4        DQINF4
     C                   MOVE      WSINF5        DQINF5
     C                   MOVE      WSINF6        DQINF6
     C                   MOVE      WSINF7        DQINF7
     C                   MOVE      WSINF8        DQINF8
     C                   MOVE      WSINF9        DQINF9
     C                   MOVE      WSVS11        DQVS11
     C                   MOVE      WSVS12        DQVS12
     C                   MOVE      WSVS13        DQVS13
N08  C                   MOVE      WSVS14        DQVS14
N08  C                   MOVE      WSVS15        DQVS15
N08  C                   MOVE      WSVS16        DQVS16
N08  C                   MOVE      WSVS17        DQVS17
N08  C                   MOVE      WSVS18        DQVS18
      *
     C   36              WRITE     DOKEQMR
     C  N36              UPDATE    DOKEQMR
      *
     C                   ENDSR
      *
      ******************************************
     C     TESTB         BEGSR
      ******************************************
      *
      * TESTER BILDE NUMMER 2
      *
      * COLOADER
     C                   SETOFF                                       89
     C     WSCONR        IFNE      *ZEROS
     C                   MOVE      WSCONR        YKN
     C     KUND1K        CHAIN     CUNDL01                            89
     C  N89              MOVE      KNAVN         WSCONA
     C   89              SETON                                        30
     C   30              MOVE      'SPK0001'     MSGNR
     C   30              GOTO      SLFB
     C                   END
     C                   MOVE      *ZEROS        WSBLT
     C                   MOVE      *ZEROS        WSNTT
     C                   MOVE      *ZEROS        WSVKTT
     C                   MOVE      *ZEROS        WSFTOT
      * Sjekker om det finnes rater innlagt på gjeldende strekning.
     C                   Z-ADD     WSFSN         WSFLY
     C     AIRRAT        SETLL     AIRLDL1                                96
     C     *IN96         IFEQ      *OFF
      * Prøver så med flyselskap 0
     C                   Z-ADD     0             WSFLY
     C     AIRRAT        SETLL     AIRLDL1                                96
     C                   ENDIF
     C     *IN96         IFEQ      *ON                                          <RATE FUNNET
     C     WWPR1         ANDEQ     PR(1)
     C     WWBE1         ANDEQ     BE(1)
     C     WWRA1         IFEQ      'B'
     C     RA(1)         ANDNE     'B'
     C     WSRK1         ORNE      WWRK1
     C     RA(1)         OREQ      'B'
     C     WWRA1         ANDNE     'B'
     C                   MOVE      *BLANKS       IT(1)
     C                   Z-ADD     0             PR(1)
     C                   Z-ADD     0             BE(1)
     C                   Z-ADD     2             XN2               2 0
     C     RA(1)         IFNE      'B'
     C                   ENDIF
     C                   DO        5
     C                   EXSR      NULLVA
     C                   ADD       1             XN
     C                   ENDDO
     C                   ENDIF
     C                   ENDIF
     C                   MOVE      RA(1)         WWRA1             1
     C                   MOVE      WSRK1         WWRK1             1
     C                   Z-ADD     PR(1)         WWPR1             8 2
     C                   Z-ADD     BE(1)         WWBE1            10 2
     C                   Z-ADD     1             XN                2 0
     C     XN            DOWLE     6
     C                   EXSR      TESTVA
     C                   ADD       1             XN
     C   30              GOTO      SLFB
     C                   END
      *
     C                   MOVEA     '0000'        *IN(92)
     C     WSCMN         IFEQ      'J'
     C     WSROB1        IFEQ      *BLANKS
     C                   MOVE      *ON           *IN92
     C                   MOVE      *ON           *IN30
     C                   MOVE      'BBA0062'     MSGNR
     C                   ENDIF
     C     WSROA2        IFNE      *BLANKS
     C     WSROB2        ORNE      *BLANKS
     C     WSROC2        ORNE      *ZEROS
     C     WSROA2        IFEQ      *BLANKS
     C                   MOVE      *ON           *IN93
     C                   MOVE      *ON           *IN30
     C                   MOVE      'BBA0062'     MSGNR
     C                   ENDIF
     C                   ENDIF
     C     WSROA3        IFNE      *BLANKS
     C     WSROB3        ORNE      *BLANKS
     C     WSROC3        ORNE      *ZEROS
     C     WSROA3        IFEQ      *BLANKS
     C                   MOVE      *ON           *IN94
     C                   MOVE      *ON           *IN30
     C                   MOVE      'BBA0062'     MSGNR
     C                   ENDIF
     C                   ENDIF
     C     WSROB1        IFNE      *BLANKS
     C                   MOVEL     WSROB1        FLIG
     C                   Z-ADD     1             FLIGNR            1 0
     C                   EXSR      FLIGTS
     C                   ENDIF
     C     WSROB2        IFNE      *BLANKS
     C                   MOVEL     WSROB2        FLIG
     C                   Z-ADD     2             FLIGNR
     C                   EXSR      FLIGTS
     C                   ENDIF
     C     WSROB3        IFNE      *BLANKS
     C                   MOVEL     WSROB3        FLIG
     C                   Z-ADD     3             FLIGNR
     C                   EXSR      FLIGTS
     C                   ENDIF
     C                   ENDIF                                                  <WSCMN
     C     SLFB          ENDSR
      *
      ******************************************
     C     TESTVA        BEGSR
      ******************************************
      *
      * FLYTTER VEKT TIL FRAKTBEREGNINGSVEKT
      * IKKE VED RATECLASS X
      *
     C     FV(XN)        IFEQ      0
     C                   Z-ADD     VE(XN)        FV(XN)
     C                   END
      * SKJEKKER OM PRIS ER INNLAGT I TABELL
     C     BE(XN)        IFEQ      0
     C     PR(XN)        ANDEQ     0
     C     KODPBK        CHAIN     KODTPB                             32
     C   32              SETOFF                                       8788
     C   32              GOTO      STTV
      *
     C                   END
      *
     C     STTV          TAG
     C                   MOVEL     KA(XN)        XKA               1
      *
      * TESTER VARELINJENE PÅ BILDET
      *
     C     XN            IFEQ      1
     C     PR(XN)        IFEQ      0
     C     RA(1)         IFEQ      'B'
     C                   MOVE      WSFSN         WSFSNQ
     C                   EXSR      FINNRP
     C     PR(XN)        IFEQ      *ZEROS
     C     BE(XN)        ANDEQ     *ZEROS
     C                   MOVE      *ZEROS        WSFSNQ
     C                   EXSR      FINNRP
     C                   END
     C  N34              GOTO      STTV2
     C                   END
     C                   END
     C                   ENDIF
      *
     C     RA(XN)        IFNE      *BLANKS
     C     RA(XN)        SETLL     RATCDF                                 90
     C     *IN90         IFEQ      *OFF                                         <IKKE FUNNET
     C                   MOVE      *ON           *IN30
     C                   MOVE      'BBA0098'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   END
     C                   END
      *
      * FINNER RATER HVIS IKKE NOEN KODE ER TASTET
      *
     C     PR(XN)        IFEQ      0                                             2<-B
     C     XN            ANDEQ     1
     C     RA(XN)        IFEQ      'M'                                            3<-B
     C     RA(XN)        OREQ      'Q'
     C     RA(XN)        OREQ      'N'
     C     RA(XN)        OREQ      ' '
     C                   MOVE      WSFSN         WSFSNQ
     C                   EXSR      FINNRP
     C     PR(XN)        IFEQ      *ZEROS
     C     BE(XN)        ANDEQ     *ZEROS
     C                   MOVE      *ZEROS        WSFSNQ
     C                   EXSR      FINNRP
     C                   END
     C  N34              GOTO      STTV2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      * Bruker gammelt ratesystem hvis ikke funnet noe på det nye.
      * Regner ut totalen på hver enkelt ratelinje
     C     PR(XN)        IFGT      0
     C     FV(XN)        ANDGT     0
     C     BE(XN)        ANDEQ     *ZEROS
     C     RA(XN)        IFEQ      'N'
     C     RA(XN)        OREQ      'Q'
     C     RA(XN)        OREQ      'K'
     C     RA(XN)        OREQ      'C'
     C     FV(XN)        MULT      PR(XN)        XWORK
     C                   Z-ADD(H)  XWORK         BE(XN)
     C                   ENDIF
     C     RA(XN)        IFEQ      'B'
     C     RA(XN)        OREQ      'M'
     C                   Z-ADD     PR(XN)        XWORK
     C                   Z-ADD(H)  XWORK         BE(XN)
     C                   ENDIF
     C     RA(XN)        IFEQ      'R'
     C     RA(XN)        OREQ      'S'
     C     FV(XN)        MULT      PR(XN)        XWORK
     C                   Z-ADD(H)  XWORK         BE(XN)
     C                   ENDIF
     C     RA(XN)        IFEQ      'X'
     C     RA(XN)        OREQ      'E'
     C     RA(XN)        OREQ      'U'
     C     RA(XN)        OREQ      'Y'
     C                   Z-ADD     BE(XN)        XWORK
     C                   ENDIF
     C                   ELSE                                                   <BE,XN
     C                   Z-ADD     BE(XN)        XWORK
     C                   ENDIF                                                  <BE,XN
      *
N04  C     WSVAL         COMP      FICURR                                 36
S04  C*    FIDECI        IFEQ      0                                              3<-B
N04  C   36FIDECI        IFEQ      0                                              3<-B
     C     XWORK         ADD       0.50          BE(XN)
     C                   MOVE      '00'          BE(XN)
N04  C                   ELSE
S04  C*                  END                                                      3<-E
     C     FIDECI        IFEQ      1                                              3<-B
     C     XWORK         ADD       0.05          BE(XN)
     C                   MOVE      '0'           BE(XN)
     C                   END                                                      3<-E
S04  C*    FIDECI        IFEQ      2                                              3<-B
S04  C*                  Z-ADD     XWORK         BE(XN)
     C                   END                                                      3<-E
      * ----------------------------------------------------
      * RATE COMBINATION POINT OG TEKSTLINJER ER SPESIELLE LINJER SOM
      * ER LOVLIGE PÅ LINJENE 2 -6 SJEKKES HER. ER DET EN AV DISSE TO
      * TYPER LINJER HOPPES DET OVER RESTEN AV DISSE TESTENE.
     C     XN            IFGT      1
     C     KA(XN)        IFEQ      *BLANKS
     C     VE(XN)        ANDEQ     *ZEROS
     C     RA(XN)        ANDEQ     *BLANKS
     C     FV(XN)        ANDEQ     *ZEROS
     C     PR(XN)        ANDEQ     *ZEROS
     C     BE(XN)        ANDEQ     *ZEROS
     C     VA(XN)        ANDNE     *BLANKS
     C                   GOTO      STTV2
     C                   ENDIF
     C     KA(XN)        IFNE      *BLANKS
     C     NUM           CHECK     KA(XN)        NUMCHK            1 0
     C     NUMCHK        IFGT      0
      * Da er det IKKE bare tall og blanke i dette feltet.
      * Hvis gross weight er null skal dette tolkes som
      * Rate Combination Point linje.
     C     VE(XN)        IFEQ      0
     C                   GOTO      STTV2
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Alle andre typer skal ha med rate class code.
     C     KA(XN)        IFNE      *BLANKS
     C     VE(XN)        ORNE      *ZEROS
     C     IT(XN)        ORNE      *BLANKS
     C     FV(XN)        ORNE      *ZEROS
     C     PR(XN)        ORNE      *ZEROS
     C     BE(XN)        ORNE      *ZEROS
     C     RA(XN)        SETLL     RATCDF                                 90
     C     *IN90         IFEQ      *OFF                                         <IKKE FUNNET
     C                   SETON                                        30
     C                   MOVE      'BBA0106'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF
      * TESTER INNHOLDET AV RATELINJE 1. DET ER SPESIELLE REGLER FOR
      * DENNE LINJEN.
     C     XN            IFEQ      1
     C     RA(XN)        IFEQ      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'DIV1127'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   END
      * FØRSTE RATELINJE MÅ VÆRE EN AV DISSE
     C     RA(XN)        IFNE      'M'
     C     RA(XN)        ANDNE     'N'
     C     RA(XN)        ANDNE     'Q'
     C     RA(XN)        ANDNE     'B'
     C     RA(XN)        ANDNE     'C'
     C     RA(XN)        ANDNE     'R'
     C     RA(XN)        ANDNE     'S'
     C     RA(XN)        ANDNE     'U'
     C                   SETON                                        30
     C                   MOVE      'BBA0099'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   END
     C     RA(XN)        IFEQ      'M'
     C     RA(XN)        OREQ      'N'
     C     RA(XN)        OREQ      'Q'
     C     RA(XN)        OREQ      'B'
     C     KA(XN)        IFEQ      *BLANKS
     C     VE(XN)        OREQ      *ZEROS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C     VA(XN)        OREQ      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0100'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C     IT(XN)        IFNE      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0101'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(XN)        IFEQ      'C'
     C     KA(XN)        IFEQ      *BLANKS
     C     VE(XN)        OREQ      *ZEROS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C     VA(XN)        OREQ      *BLANKS
     C     IT(XN)        OREQ      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0102'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(XN)        IFEQ      'U'
     C     KA(XN)        IFEQ      *BLANKS
     C     VE(XN)        OREQ      *ZEROS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C     VA(XN)        OREQ      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0100'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C                   ENDIF                                                  <XN
      * GENERELLE TESTER FOR RATELINJENE 1 - 6.
     C     RA(XN)        IFEQ      'N'
     C     RA(XN)        OREQ      'Q'
     C     VE(XN)        IFEQ      *ZEROS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C                   SETON                                        30
     C                   MOVE      'BBA0109'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C     IT(XN)        IFNE      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0101'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(XN)        IFEQ      'M'
     C     RA(XN)        OREQ      'C'
     C     RA(XN)        OREQ      'U'
     C     VE(XN)        IFEQ      *ZEROS
     C     KA(XN)        OREQ      *BLANKS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C                   SETON                                        30
     C                   MOVE      'BBA0100'     MSGNR
     C     RA(XN)        IFEQ      'C'
     C                   MOVE      'BBA0102'     MSGNR
     C                   ENDIF
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C     RA(XN)        IFEQ      'M'
     C     IT(XN)        ANDNE     *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0101'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C     RA(XN)        IFEQ      'C'
     C     IT(XN)        ANDEQ     *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0107'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(XN)        IFEQ      'B'
     C     VE(XN)        IFEQ      *ZEROS
     C     KA(XN)        OREQ      *BLANKS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C     VA(XN)        OREQ      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0100'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C     IT(XN)        IFNE      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0101'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(1)         IFEQ      'B'
     C     RA(2)         ANDNE     'K'
     C                   SETON                                        30
     C                   MOVE      'BBA0108'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C     RA(XN)        IFEQ      'K'
     C     RA(XN)        OREQ      'E'
     C     VE(XN)        IFNE      *ZEROS
     C     KA(XN)        ORNE      *BLANKS
     C     IT(XN)        ORNE      *BLANKS
     C     FV(XN)        OREQ      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C                   SETON                                        30
     C                   MOVE      'BBA0103'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(XN)        IFEQ      'X'
     C     VA(XN)        IFEQ      *BLANKS
     C     KA(XN)        ORNE      *BLANKS
     C     PR(XN)        ORNE      *ZEROS
     C     BE(XN)        ORNE      *ZEROS
     C                   SETON                                        30
     C                   MOVE      'BBA0104'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
     C     RA(XN)        IFEQ      'Y'
     C     FV(XN)        IFEQ      *ZEROS
     C     KA(XN)        ORNE      *BLANKS
     C     VE(XN)        ORNE      *ZEROS
     C     PR(XN)        OREQ      *ZEROS
     C     BE(XN)        OREQ      *ZEROS
     C     IT(XN)        ORNE      *BLANKS
     C                   SETON                                        30
     C                   MOVE      'BBA0105'     MSGNR
     C     XN            ADD       12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLTV
     C                   ENDIF
     C                   ENDIF                                                  <RA,XN
      *
     C     STTV2         TAG
     C                   ADD       BE(XN)        WSBLT
     C     XKA           IFNE      'R'
     C     NUM           CHECK     KA(XN)        NUMCHK
     C     NUMCHK        IFEQ      0
     C                   MOVE      KA(XN)        XKAKA             4 0
     C                   ADD       XKAKA         WSNTT
     C                   ENDIF
     C                   END
      *
     C                   ADD       VE(XN)        WSVKTT
     C                   ADD       FV(XN)        WSFTOT
      *
     C     SLTV          ENDSR
      *
      ******************************************
     C     NULLVA        BEGSR
      ******************************************
      *
      * BLANKER UT VARELINJENE
      *
     C                   MOVE      *ZEROS        VE(XN2)
     C                   MOVE      *BLANKS       RA(XN2)
     C                   MOVE      *ZEROS        FV(XN2)
     C                   MOVE      *ZEROS        PR(XN2)
     C                   MOVE      *ZEROS        BE(XN2)
     C                   MOVE      *BLANKS       IT(XN2)
     C                   MOVE      *BLANKS       MI(XN2)
      *
     C                   ENDSR
      *
      ******************************************
     C     FINNRP        BEGSR
      ******************************************
      * HELE RUTINEN ER ERSTATTET MED NY FRA SYEF10B
      * MED NY BEHANDLING AV RATELINJENE.
      * Sjekker først om Priority eller B + K skal hentes fra
      * gammelt ratesystem.
     C     *IN32         IFEQ      *OFF                                         <GAMMELT FINNS
     C     *IN96         ANDEQ     *OFF                                         <IKKE NYTT
     C     BE(1)         IFEQ      0
     C     PR(1)         ANDEQ     0
     C     RA(1)         ANDEQ     'B'
     C     WSRK1         IFEQ      'D'
      * PRIORITY RATE
     C                   Z-ADD     KPBBPR        PR(1)
     C                   Z-ADD     KPBBPR        BE(1)
     C                   MOVE      'K'           RA(2)
     C                   Z-ADD     KPBRPR        PR(2)
     C                   Z-ADD     FV(1)         FV(2)
     C     KPBRPR        MULT      FV(2)         XWORK
     C                   Z-ADD     XWORK         BE(2)
     C                   ELSE
      * B+K RATE
     C                   Z-ADD     KPBBAN        PR(1)
     C                   Z-ADD     KPBBAN        BE(1)
     C                   MOVE      'K'           RA(2)
     C                   Z-ADD     KPBRAN        PR(2)
     C                   Z-ADD     FV(1)         FV(2)
     C     KPBRAN        MULT      FV(2)         XWORK
     C                   Z-ADD     XWORK         BE(2)
     C                   ENDIF                                                  <WSRK1
     C                   ENDIF                                                  <BE,1
     C                   ENDIF                                                  <*IN32
      *
      * VED B/P I RATE HENTES BASIC/PRIORITY-PRIS
      * KODEN GÅR TIL NØKKELBEGREP
      * HVIS IKKE GÅR RC TIL NØKKELBEGREP
     C                   MOVE      RA(1)         YRCOD
     C     WSRK1         IFEQ      'D'
     C                   MOVE      'P'           YRCOD             1
     C                   ENDIF
      * NORMALT GÅR FRAKTBEREGNINGSVEKT INN I NØKKELBEGREP
      * VED B/P I RATE LIGGER PRIS PÅ 99999 KILO
     C                   Z-ADD(H)  FV(XN)        YRWEI
     C     YRCOD         IFEQ      'B'
     C     YRCOD         OREQ      'P'
     C                   Z-ADD     99999         YRWEI
     C                   END
      *
     C     STFIRP        TAG
     C     AIRL1K        SETLL     AIRLDL1                            34
     C     STFIR2        TAG
     C     AIR1K1        READE     AIRLDL1                                34
      *
      * GJELDER HAWB VED SAMLAST
      *
      * CCPP-KODE B BETYR BEGGE FRANKATURER
      * SJEKKER FØRST AKTUELL CC/PP DERETTER KODE B
      *
      *
      * VED B/P MÅ SAMME KODE VÆRE FUNNET I PRISTABELL
      *
     C  N34YRCOD         IFEQ      'B'
     C     YRCOD         OREQ      'P'
     C     YRCOD         IFNE      AIRCOD
     C     XN            IFEQ      1
     C                   MOVE      *BLANK        RA(2)
     C                   ENDIF
     C                   GOTO      STFIR2
     C                   END
     C                   END
      *
      * VED N/Q MÅ SAMME KODE VÆRE FUNNET I PRISTABELL
      *
     C  N34YRCOD         IFEQ      'N'
     C     YRCOD         OREQ      'Q'
     C     AIRCOD        IFNE      'N'
     C     AIRCOD        ANDNE     'Q'
     C                   GOTO      STFIR2
     C                   END
     C                   END
      *
      * VED KODE M BENYTTES MINIMUMSPRIS UANSETT
      *
     C  N34YRCOD         IFEQ      'M'                                          1<-B
     C                   MOVE      *ZEROS        PR(XN)
     C                   Z-ADD(H)  AIRGRN        BE(XN)
     C                   MOVE      'M'           RA(XN)
     C                   Z-ADD     AIRGRN        PR(XN)
     C                   GOTO      UTFRA
     C                   ELSE                                                   1
      *
      * ELLERS BENYTTES FUNNET KILOPRIS
      *
     C     YRCOD         IFEQ      'B'
     C     AIRCOD        ANDEQ     'B'
     C     YRCOD         OREQ      'P'
     C     AIRCOD        ANDEQ     'P'
     C                   Z-ADD     AIRAWB        PR(2)
     C                   ELSE
     C     YRCOD         IFEQ      'N'
     C     YRCOD         OREQ      'Q'
     C     YRCOD         OREQ      *BLANK
     C     AIRCOD        IFEQ      'N'
     C     AIRCOD        OREQ      'Q'
     C                   Z-ADD     AIRAWB        PR(1)
     C                   MOVE      AIRCOD        RA(1)
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C     AIRAWB        MULT      FV(XN)        XWORK
      *
      * VED B/P PLUSSES PÅ GRUNNLAG
      *
     C     YRCOD         IFEQ      ' '
     C     AIRCOD        IFEQ      'B'
     C     AIRCOD        OREQ      'P'
     C                   MOVE      AIRCOD        YRCOD
     C     AIRCOD        IFEQ      'P'
     C                   MOVE      'P'           MI(1)
     C                   ENDIF
     C                   END
     C                   END
      *
     C     YRCOD         IFEQ      'P'                                           2<-B
     C     YRCOD         OREQ      'B'
     C                   Z-ADD(H)  XWORK         BE(2)
     C                   Z-ADD(H)  AIRGRN        BE(1)
     C                   Z-ADD(H)  AIRGRN        PR(1)
     C                   Z-ADD     FV(1)         FV(2)
     C                   MOVE      'K'           RA(2)
     C                   MOVE      'B'           RA(1)
     C                   Z-ADD     AIRAWB        PR(2)
     C     XWORK         ADD(H)    AIRGRN        ÆBELØP           13 2
     C                   ELSE                                                    2
      *
      * HVIS IKKE SJEKKES OM MINDRE ENN MINIMUMSPRIS
      *
     C     XN            IFEQ      1
     C     YRCOD         IFEQ      *BLANK
     C     YRCOD         OREQ      'N'
     C     YRCOD         OREQ      'Q'
     C     AIRCOD        IFEQ      'N'
     C     AIRCOD        OREQ      'Q'
     C     XWORK         IFLT      AIRGRN                                         3<-B
     C                   Z-ADD(H)  AIRGRN        BE(XN)
     C                   MOVE      'M'           RA(XN)
     C                   Z-ADD(H)  AIRGRN        PR(XN)
     C                   GOTO      UTFRA
     C                   ELSE                                                     3
     C     YRCOD         IFEQ      ' '                                             4<-B
     C                   MOVE      AIRCOD        RA(XN)
     C                   END                                                       4<-E
     C                   Z-ADD(H)  XWORK         BE(XN)
     C                   Z-ADD(H)  XWORK         ÆBELØP
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END
     C                   END
     C                   END
      *
      * HVIS IKKE VEKTGRUPPE ER 99999  SKJEKKER PRIS I NESTE VEKTINT
      *
     C     AIRWEI        IFNE      99999                                         2<-B
     C     AIRWEI        ADD       1             YRWEI
     C     LESQ          TAG
     C     AIR1K1        READE     AIRLDL1                                34
     C     *IN34         IFEQ      *OFF
     C     AIRCOD        IFEQ      'B'
     C     AIRCOD        OREQ      'P'
     C                   GOTO      LESQ
     C                   ENDIF
     C                   ENDIF
      * GJELDER HAWB
     C  N34AIRCOD        IFNE      'M'                                            3<-B
     C     AIRAWB        MULT      YRWEI         XWORK
     C     YRCOD         IFEQ      'P'                                             4<-B
     C     YRCOD         OREQ      'B'
     C     XWORK         ADD(H)    AIRGRN        XBELØP           13 2
     C                   ELSE                                                      4
     C     XWORK         IFLT      AIRGRN                                           5<-B
     C                   Z-ADD(H)  AIRGRN        XBELØP
     C                   ELSE                                                       5
     C                   Z-ADD(H)  XWORK         XBELØP
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C     XBELØP        IFLT      ÆBELØP                                          4<-B
     C                   MOVE      AIRCOD        RA(1)
     C     XN            IFEQ      1
     C                   Z-ADD     YRWEI         FV(XN)
     C                   Z-ADD     XBELØP        BE(XN)
     C                   Z-ADD     AIRAWB        PR(XN)
     C                   ENDIF
      *                    ENDIF
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     WSVAL         COMP      FICURR                                 34
     C   34FIDECI        IFEQ      0                                             2<-B
     C                   ADD       0.50          BE(XN)
     C                   MOVE      '00'          BE(XN)
     C                   ELSE                                                    2
     C     FIDECI        IFEQ      1                                              3<-B
     C                   ADD       0.05          BE(XN)
     C                   MOVE      '0'           BE(XN)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   SETOFF                                       34
     C                   END                                                    1<-E
      *
     C     UTFRA         ENDSR
      *
      ***********************************************
     C     MOVW          BEGSR
      ***********************************************
      *
      * HENTER SAMLASTER
      *
     C                   MOVEL     SMMAWB        WSFSN
     C                   MOVE      SMKNS         YKN
     C     KUND1K        CHAIN     CUNDL01                            34
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      KNAVN         WSNA
     C                   MOVE      ADR1          WSAD1
     C                   MOVE      ADR2          WSAD2
     C                   MOVE      *BLANKS       WSAD3
     C     POSTNR        IFNE      0
     C                   MOVE      ADR3          WSAD3
     C                   MOVEL     POSTNR        WSAD3
     C                   ELSE
     C                   MOVEL     ADR3          WSAD3
     C                   END
      *
      * COLOADER
      *
     C     DFXX3A        IFNE      *BLANKS
     C     DFXX3A        ANDNE     *ZEROS
     C                   MOVE      DFXX3A        YKN
     C                   MOVE      DFXX3A        WSCONR
     C     KUND1K        CHAIN     CUNDL01                            34
     C  N34              MOVE      KNAVN         WSCONA
     C                   END
      *
      * LESER ALLE OPPDRAG OG SUMMERER
      *
     C                   MOVEL     XRFA          YRFA             15
     C     SAMLNO        SETLL     HEAD19
     C                   SETOFF                                       34
     C                   MOVE      *ZEROS        XTANT             4 0
     C                   MOVE      *ZEROS        XTM3              7 3
     C                   MOVE      *BLANKS       KA
     C                   MOVE      *ZEROS        VE
     C                   MOVE      *BLANKS       RA
     C                   MOVE      *BLANKS       IT
     C                   MOVE      *ZEROS        FV
     C                   MOVE      *BLANKS       MI
     C                   MOVE      *ZEROS        PR
     C                   MOVE      *ZEROS        BE
     C                   MOVE      *BLANKS       VA
     C                   DO
     C     STSUM         TAG
     C     SAMLNO        READE     HEAD19                                 34
     C     *IN34         IFEQ      '0'
      *
      * SUMMERER KUN HVIS STATUS ULIK 'S'
      *
     C     HEST          IFEQ      'S'
     C                   GOTO      STSUM
     C                   END
      *
      * SUMMERER OPPDRAG
      *
     C                   ADD       HENT          XTANT
     C                   ADD       HEVKT         VE(1)
     C                   ADD       HEM3          XTM3
     C     UTX10         IFEQ      *BLANKS
     C     *IN33         IFEQ      '1'
     C     *IN05         OREQ      '1'
     C                   EXSR      MALVKT
     C                   END
     C                   END
     C                   GOTO      STSUM
     C                   END
      *
      * SLUTTBEREGNING
      *
     C     XTM3          MULT(H)   167           XTM3V             7 1
     C     XTM3V         IFGT      VE(1)
     C                   Z-ADD     XTM3V         FV(1)
     C                   END
     C                   MOVE      XTANT         KA(1)
     C                   END
      *
      * N33 = FINNES FRA FØR
      *
     C  N33              DO
     C                   MOVE      DFSDF         WSSDF
     C                   MOVE      DFCCPP        WSCCPP
     C                   MOVE      DFINF1        WSINF1
     C                   MOVE      DFINF2        WSINF2
     C                   MOVE      DFROA1        WSROA1
     C                   MOVE      DFROB1        WSROB1
     C                   MOVE      DFROC1        WSROC1
     C                   MOVE      DFROA2        WSROA2
     C                   MOVE      DFROB2        WSROB2
     C                   MOVE      DFROC2        WSROC2
     C                   MOVE      DFROA3        WSROA3
     C                   MOVE      DFROB3        WSROB3
     C                   MOVE      DFROC3        WSROC3
     C                   Z-ADD     DFETD1        WFETD1
     C                   Z-ADD     DFETA1        WFETA1
     C                   Z-ADD     DFEDA1        WFEDA1
     C                   Z-ADD     DFETD2        WFETD2
     C                   Z-ADD     DFETA2        WFETA2
     C                   Z-ADD     DFEDA2        WFEDA2
     C                   Z-ADD     DFETD3        WFETD3
     C                   Z-ADD     DFETA3        WFETA3
     C                   Z-ADD     DFEDA3        WFEDA3
     C                   MOVE      DFVAL         WSVAL
     C                   MOVE      DFDVCA        WSDVCA
     C                   MOVE      DFDVCU        WSDVCU
     C                   MOVE      DFBELF        WSBELF
     C                   MOVE      DFINFA        WSINFA
     C                   MOVE      DFINFB        WSINFB
     C                   MOVEL     DFINFC        WSINFC
     C                   MOVE      DFTOLS        WSTOLS
N05  C                   EVAL      WSSPH1=DFSPH1
N05  C                   EVAL      WSSPH2=DFSPH2
N05  C                   EVAL      WSSPH3=DFSPH3
N05  C                   EVAL      WSSPH4=DFSPH4
N05  C                   EVAL      WSSPH5=DFSPH5
N05  C                   EVAL      WSSPH6=DFSPH6
N05  C                   EVAL      WSSPH7=DFSPH7
N05  C                   EVAL      WSSPH8=DFSPH8
N05  C                   EVAL      WSSPH9=DFSPH9
      *
      * 05=NY OVERFØRING
      *
     C     *IN05         IFEQ      '0'
     C                   MOVE      KA1           KA
     C                   MOVE      VE1           VE
     C                   MOVE      FV1           FV
     C                   END
     C                   MOVE      RA1           RA
     C                   MOVE      IT1           IT
     C                   MOVE      MI1           MI
     C                   MOVE      PR1           PR
     C                   MOVE      BE1           BE
     C                   MOVE      VA1           VA
     C                   MOVE      DFNTT         WSNTT
     C                   MOVE      DFVKTT        WSVKTT
     C                   MOVE      DFBLT         WSBLT
     C                   MOVE      DFKDDC        WSKDDC
     C                   MOVE      DFBLDC        WSBLDC
     C                   MOVE      DFBLA         WSBLA
     C                   MOVE      DFBLAV        WSBLAV
     C                   MOVE      DFFT          WSFT
     C                   MOVE      DFCMN         WSCMN
     C     FITDVI        IFEQ      'J'
     C                   MOVE      'J'           WSCMN
     C                   ELSE
     C                   MOVE      'N'           WSCMN
     C                   ENDIF
     C                   MOVE      DFRC1         WWRA1
     C                   MOVE      DFRK1         WWRK1
     C                   END
      *
      * 33=NY SAMLAST
      *
     C   33              DO
     C                   MOVE      'PP'          WSCCPP
     C                   MOVE      *BLANKS       WSINF1
     C                   MOVE      *BLANKS       WSINF2
     C                   MOVE      SMROA1        WSROA1
     C                   MOVEl     SMROB1        WSROB1
     C                   MOVE      SMROC1        WSROC1
     C                   MOVE      SMROA2        WSROA2
     C                   MOVEl     SMROB2        WSROB2
     C                   MOVE      SMROC2        WSROC2
     C                   MOVE      SMROA3        WSROA3
     C                   MOVEl     SMROB3        WSROB3
     C                   MOVE      SMROC3        WSROC3
     C                   Z-ADD     SMETD1        WFETD1
     C                   Z-ADD     SMETA1        WFETA1
     C                   Z-ADD     SMEDA1        WFEDA1
     C                   Z-ADD     SMETD2        WFETD2
     C                   Z-ADD     SMETA2        WFETA2
     C                   Z-ADD     SMEDA2        WFEDA2
     C                   Z-ADD     SMETD3        WFETD3
     C                   Z-ADD     SMETA3        WFETA3
     C                   Z-ADD     SMEDA3        WFEDA3
     C                   MOVE      FICURR        WSVAL
     C                   MOVEL     'NVD   '      WSDVCA
     C                   MOVEL     'NVD   '      WSDVCU
     C                   MOVE      *BLANKS       WSINFA
     C                   MOVE      *BLANKS       WSINFB
     C                   MOVE      *BLANKS       WSINFC
     C                   MOVEL     MSG(1)        WSINFA
     C                   MOVEL     MSG(2)        WSINFB
     C                   MOVEL     MSG(4)        VA(1)
     C                   MOVEL     MSG(5)        VA(2)
     C                   MOVEL     UTX3          VA(3)
     C                   MOVEL     UTX4          VA(4)
     C                   MOVEL     UTX5          VA(5)
     C                   MOVEL     UTX6          VA(6)
     C                   MOVEL     UTX7          VA(7)
     C                   MOVEL     UTX8          VA(8)
     C                   MOVEL     UTX9          VA(9)
     C                   MOVEL     UTX10         VA(10)
     C                   MOVE      *BLANKS       WSTOLS
     C                   MOVE      *ZEROS        WSNTT
     C                   MOVE      *ZEROS        WSVKTT
     C                   Z-ADD     0             WSFTOT            7 1
     C                   MOVE      *ZEROS        WSBLT
     C                   MOVE      ' '           WSKDDC
     C                   MOVE      *ZEROS        WSBLDC
     C                   MOVE      *ZEROS        WSBLA
     C                   MOVE      *ZEROS        WSBLAV
     C                   MOVE      *BLANKS       WSFT
     C                   MOVE      *BLANKS       WSCONA
     C                   MOVE      *ZEROS        WSCONR
N05  C                   EVAL      WSSPH1=*BLANKS
N05  C                   EVAL      WSSPH2=*BLANKS
N05  C                   EVAL      WSSPH3=*BLANKS
N05  C                   EVAL      WSSPH4=*BLANKS
N05  C                   EVAL      WSSPH5=*BLANKS
N05  C                   EVAL      WSSPH6=*BLANKS
N05  C                   EVAL      WSSPH7=*BLANKS
N05  C                   EVAL      WSSPH8=*BLANKS
N05  C                   EVAL      WSSPH9=*BLANKS
     C     FITDVI        IFEQ      'J'
     C                   MOVE      'J'           WSCMN
     C                   ELSE
     C                   MOVE      'N'           WSCMN
     C                   ENDIF
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     OPDDOK        BEGSR
      ***********************************************
     C     DOKEMK        CHAIN     DOKEM                              33
      *  NY...
     C   33              DO
     C                   MOVE      YRI           DFRI
     C                   MOVE      WSSD          DFSD
     C                   MOVE      WSLNR         DFLNR
     C                   END
      *  NY/GAMMEL....
     C                   MOVE      WSCONR        DFXX3A
     C                   MOVE      WSSDF         DFSDF
     C                   MOVE      USG           DFSG
     C                   MOVE      WSCCPP        DFCCPP
     C                   MOVE      WSINF1        DFINF1
     C                   MOVE      WSINF2        DFINF2
     C                   MOVE      WSFSN         DFFSN
     C                   MOVE      WSROA1        DFROA1
     C                   MOVE      WSROB1        DFROB1
     C                   MOVE      WSROC1        DFROC1
     C                   MOVE      WSROA2        DFROA2
     C                   MOVE      WSROB2        DFROB2
     C                   MOVE      WSROC2        DFROC2
     C                   MOVE      WSROA3        DFROA3
     C                   MOVE      WSROB3        DFROB3
     C                   MOVE      WSROC3        DFROC3
     C                   Z-ADD     WFETD1        DFETD1
     C                   Z-ADD     WFETA1        DFETA1
     C                   Z-ADD     WFEDA1        DFEDA1
     C                   Z-ADD     WFETD2        DFETD2
     C                   Z-ADD     WFETA2        DFETA2
     C                   Z-ADD     WFEDA2        DFEDA2
     C                   Z-ADD     WFETD3        DFETD3
     C                   Z-ADD     WFETA3        DFETA3
     C                   Z-ADD     WFEDA3        DFEDA3
     C                   MOVE      WSVAL         DFVAL
     C                   MOVE      WSDVCA        DFDVCA
     C                   MOVE      WSDVCU        DFDVCU
     C                   MOVE      WSBELF        DFBELF
     C                   MOVE      WSINFA        DFINFA
     C                   MOVE      WSINFB        DFINFB
     C                   MOVEL     WSINFC        DFINFC
     C                   MOVE      KA            KA1
     C                   MOVE      VE            VE1
     C                   MOVE      RA            RA1
     C                   MOVE      IT            IT1
     C                   MOVE      FV            FV1
     C                   MOVE      MI            MI1
     C                   MOVE      PR            PR1
     C                   MOVE      BE            BE1
     C                   MOVE      VA            VA1
     C                   MOVE      WSNTT         DFNTT
     C                   MOVE      WSVKTT        DFVKTT
     C                   MOVE      WSBLT         DFBLT
     C                   MOVE      WSKDDC        DFKDDC
     C                   MOVE      WSBLDC        DFBLDC
     C                   MOVE      WSBLA         DFBLA
     C                   MOVE      WSBLAV        DFBLAV
     C                   MOVE      WSFT          DFFT
     C                   MOVE      WSCMN         DFCMN
     C                   MOVE      WSTOLS        DFTOLS
N05  C                   EVAL      DFSPH1=WSSPH1
N05  C                   EVAL      DFSPH2=WSSPH2
N05  C                   EVAL      DFSPH3=WSSPH3
N05  C                   EVAL      DFSPH4=WSSPH4
N05  C                   EVAL      DFSPH5=WSSPH5
N05  C                   EVAL      DFSPH6=WSSPH6
N05  C                   EVAL      DFSPH7=WSSPH7
N05  C                   EVAL      DFSPH8=WSSPH8
N05  C                   EVAL      DFSPH9=WSSPH9
      *
     C   33              WRITE     DOKEMR
     C  N33              UPDATE    DOKEMR
      *
     C                   ENDSR
      ***********************************************
     C     SFFR          BEGSR
      ***********************************************
     C                   OPEN      FFR01L                               91
     C  N91              OPEN      FFA01L                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFFR99
     C                   ENDIF
      * Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       AUTINF                         <AUTOMATISK
     C     *IN20         IFEQ      '1'                                          <AUTOMATISK
     C                   MOVE      '1'           AUTTRM
     C                   ELSE                                                   <MED BILDE
     C                   MOVE      ' '           AUTTRM
     C                   ENDIF
     C     WREF2         IFNE      *BLANKS
     C                   MOVE      '3'           AUTTRM
     C                   ENDIF
     C                   MOVEL     WSRO21        AUTPID                         <ADRESSE
     C                   Z-ADD     WSFSN         AUTALN                         <AIRLINE
     C     SMMAWB        IFNE      *ZEROS
     C                   Z-ADD     SMMAW8        AUTAWB                         <AWB
     C                   ENDIF
     C                   MOVEL     WSSDF         AUTORI                         <ORIGIN AIRPORT
     C                   MOVEL     SMSD          AUTDES                         <DEST. AIRPORT
     C                   MOVE      'T'           AUTSDC                         <SHIP.DESC.CODE
     C                   Z-ADD     WSNTT         AUTNPI                         <NO. OF PIECES
     C                   MOVE      'K'           AUTWCD                         <WEIGHT CODE
     C                   Z-ADD     WSVKTT        AUTWGH                         <WEIGHT
     C                   Z-ADD     0             AUTTPI                         <T.NO.PIECES
     C     XTM3          IFNE      *ZEROS
     C                   Z-ADD(H)  XTM3          WW112
     C                   MOVEL     WW112         AUVOL
     C                   ELSE
     C                   MOVEL     *BLANKS       AUVOL
     C                   ENDIF
     C                   MOVEL     WSVS1         AUTMAN                         <MANIFEST DESC
     C                   MOVEL     *BLANKS       AUTPAR                         <PART ID
     C                   MOVEL     *BLANKS       AUTPCD                         <PART CODE
     C                   MOVEL     *BLANKS       AUTPAI                         <PART AIRPORT
     C                   MOVEL     *BLANKS       AUTRAI                         <REQ.AIRPORT
     C                   MOVEL     *BLANKS       AUTOFD                         <REQ.OFFICE
     C                   MOVEL     *BLANKS       AUTCOD                         <REQ.COMPANY
      *
     C                   MOVE      WSRO21        AUTCAR                         <CARRIER
     C                   MOVEL     WSRO41        AUTFLN                         <FLIGHT NO.
     C                   Z-ADD     WSROC1        AUTDAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AUTMND
     C                   MOVEL     WSSDF         AUTDEP                         <DEP.AIRPORT
     C                   MOVEL     WSROA1        AUTARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AUTSPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AUTAID                         <ALLOTMENT ID.
      *
     C     WSROB2        IFNE      *BLANKS
     C                   MOVE      WSRO22        AU2CAR                         <CARRIER
     C                   MOVEL     WSRO42        AU2FLN                         <FLIGHT NO.
     C                   Z-ADD     WSROC2        AU2DAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ
     C     AU2DAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AU2MND
     C                   MOVEL     WSROA1        AU2DEP                         <DEP.AIRPORT
     C                   MOVEL     WSROA2        AU2ARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AU2SPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AU2AID                         <ALLOTMENT ID.
     C                   ENDIF
      *
     C     WSROB3        IFNE      *BLANKS
     C                   MOVE      WSRO23        AU3CAR                         <CARRIER
     C                   MOVEL     WSRO43        AU3FLN                         <FLIGHT NO.
     C                   Z-ADD     WSROC3        AU3DAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ
     C     AU3DAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AU3MND
     C                   MOVEL     WSROA2        AU3DEP                         <DEP.AIRPORT
     C                   MOVEL     WSROA3        AU3ARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AU3SPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AU3AID                         <ALLOTMENT ID.
     C                   ENDIF
     C     WSRK1         IFEQ      'P'
     C                   MOVEL     'P  '         AUSPE1
     C                   ENDIF
      * Eventuell logikk for nye felt i bookingen (SRI)
     C                   MOVE      *BLANKS       AUTREF
     C                   MOVE      *BLANKS       AUTSI1
     C                   MOVE      *BLANKS       AUTSI2
N02   * 09. Product Information
N02  C                   MOVE      *BLANKS       AU093
N02   * 12. Customer Identification
N02  C                   MOVE      *BLANKS       AU1222
N02  C                   Z-ADD     0             AU1224
N02  C                   Z-ADD     0             AU1226
N02  C                   MOVE      *BLANKS       AU1228
N02  C                   MOVE      *BLANKS       AU1242
N02  C                   MOVE      *BLANKS       AU1252
      * Programmet venter på svar i et vist antall sekunder.
      * Kommer ikke svaret fortsetter man uten å vite det.
     C                   MOVEL     WAN           UAN
     C                   MOVEL     WBR           UBR
     C                   MOVEL     WLE           ULE
     C                   MOVEL     WHØ           UHØ
     C                   CALL      'SM220C2'
     C                   PARM                    AUTINF
     C                   PARM                    AUTREC            9 0
     C                   PARM                    UAN
     C                   PARM                    UBR
     C                   PARM                    ULE
     C                   PARM                    UHØ
      *
      * Routingen på fraktbrevbildet skal oppdateres hvis flyselskapet
      * svarer med en annen routing enn det som var ønsket.
      *
     C                   Z-ADD     0             ZZ
     C     AUTREC        SETLL     FFR03R
     C     AUTREC        READE     FFR03R                                 90
     C     *IN90         DOWEQ     '0'
     C     ZZ            ANDLE     3
     C                   ADD       1             ZZ
      * F035 = 'NA' --> Godtar alternativ flight om nødvendig
     C     F035          IFEQ      'NA'
      *
      * Hvis svaret ikke har kommet finnes det ingen poster i FFA03R
      *
     C                   Z-ADD     0             YY                1 0
     C     AUTREC        SETLL     FFA03R
     C     AUTREC        READE     FFA03R                                 90
     C     *IN90         DOWEQ     '0'
     C     YY            ANDLE     3
     C                   ADD       1             YY
     C     B0331         IFEQ      F0331
     C     B0331         ANDEQ     F0331
      *
      * Har funnet det tilhørende svaret til den forespurte
      * "Flight Detail". Oppdaterer fraktbrevbildet hvis "Consigment"
      * er booket på en annen flight enn det som var ønsket.
      *
      * B035 = 'KK' --> Booking er bekreftet
      *
     C     B035          IFEQ      'KK'
     C                   MOVEL     'BBA0036'     MSGNR
     C                   MOVE      *ON           *IN30
     C     ZZ            IFEQ      1
     C                   MOVEL     B0332         WSROA1
     C                   MOVEL     B0311         WSRO21
     C                   MOVEL     B0312         WSRO41
     C                   Z-ADD     B0314         WSROC1
     C                   ENDIF                                                  <ZZ=1
     C     ZZ            IFEQ      2
     C                   MOVEL     B0332         WSROA2
     C                   MOVEL     B0311         WSRO22
     C                   MOVEL     B0312         WSRO42
     C                   Z-ADD     B0314         WSROC2
     C                   ENDIF                                                  <ZZ=2
     C     ZZ            IFEQ      3
     C                   MOVEL     B0332         WSROA3
     C                   MOVEL     B0311         WSRO23
     C                   MOVEL     B0312         WSRO43
     C                   Z-ADD     B0314         WSROC3
     C                   ENDIF                                                  <ZZ=2
     C                   ENDIF                                                  <B035
     C                   ENDIF                                                  <B0331
     C     AUTREC        READE     FFA03R                                 90
     C                   ENDDO                                                  <READE,FFA03R
      *
     C                   ENDIF
     C     AUTREC        READE     FFR03R                                 90
     C                   ENDDO                                                  <READE,FFR03R
      *
     C     SFFR99        TAG
     C                   CLOSE     FFR01L                               91
     C                   CLOSE     FFA01L                               91
      *
     C                   ENDSR
      *
      ***********************************************
     C     VLOG          BEGSR
      ***********************************************
      *
     C                   CALL      'SM040C'
      *
     C     VLOG99        ENDSR
      ***********************************************
     C     UTCMDL        BEGSR
      ***********************************************
     C                   SELECT
     C     XCMD          WHENEQ    0
     C                   MOVE      'DIV0020'     MSGLN1
     C                   MOVE      'SHU0014'     MSGLN2
     C                   MOVE      'DIV0021'     MSGLN3
     C                   ADD       1             XCMD
     C     XCMD          WHENEQ    1
     C                   MOVE      'DIV0024'     MSGLN1
     C                   MOVE      'BBA0033'     MSGLN2
     C                   MOVE      'BBA0034'     MSGLN3
     C                   ADD       1             XCMD
N06  C     XCMD          WHENEQ    2
N06  C                   MOVE      'CBA0410'     MSGLN1
N06  C                   MOVE      'DIV0029'     MSGLN3
N06  C                   ADD       1             XCMD
     C                   OTHER
     C                   MOVE      'BBA0040'     MSGLN1
     C                   MOVE      'DIV2131'     MSGLN2
s18  C*                  MOVE      'CBA0320'     MSGLN2                         22
n18  C                   MOVE      'CBA0320'     MSGLN3                         22
     C                   Z-ADD     0             XCMD              1 0
     C                   ENDSL
      *
     C                   ENDSR
      *
      ******************************************
     C     FLIGTS        BEGSR
      ******************************************
      *
      * SJEKKER FLIGHT NUMMERETS SYNTAX
      *
     C     FLIGNR        IFEQ      1
      * Carrier code must exist but flight number may be blank
     C     FAA           IFNE      *BLANKS
     C     FBA           ANDEQ     *BLANK
     C     FBB           ANDEQ     *BLANK
     C     FBC           ANDEQ     *BLANK
     C     FCC           ANDEQ     *BLANK
     C                   GOTO      FLIG99
     C                   ENDIF
     C                   ELSE
      * Carrier code and flight number may be blank
     C     FLIG          IFEQ      *BLANKS
     C     FAA           ORNE      ' '
     C     FBA           ANDEQ     *BLANK
     C     FBB           ANDEQ     *BLANK
     C     FBC           ANDEQ     *BLANK
     C     FCC           ANDEQ     *BLANK
     C                   GOTO      FLIG99
     C                   ENDIF
     C                   ENDIF
      *
     C                   MOVE      '0'           FLIERR
     C                   MOVE      '0'           FLIERR            1
     C                   SELECT
     C     FBA           WHENLT    '0'
     C     FBA           ORGT      '9'
     C                   MOVE      '1'           FLIERR
     C     FBB           WHENLT    '0'
     C     FBB           ORGT      '9'
     C                   MOVE      '1'           FLIERR
     C     FBC           WHENLT    '0'
     C     FBC           ORGT      '9'
     C                   MOVE      '1'           FLIERR
     C     FCC           WHENLT    'A'
     C     FCC           ORGT      'Z'
     C     FCC           IFLT      '0'
     C     FCC           ORGT      '9'
     C     FCC           IFNE      *BLANKS
     C                   MOVE      '1'           FLIERR
     C                   ENDIF
     C                   ENDIF
     C                   ENDSL
     C     FLIERR        IFEQ      '1'
     C                   MOVE      *ON           *IN30
     C                   MOVE      'BBA0094'     MSGNR
     C                   SELECT
     C     FLIGNR        WHENEQ    1
     C                   MOVE      *ON           *IN92
     C     FLIGNR        WHENEQ    2
     C                   MOVE      *ON           *IN93
     C     FLIGNR        WHENEQ    3
     C                   MOVE      *ON           *IN94
     C                   ENDSL
     C                   ENDIF
      *
     C     FLIG99        TAG
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KEYSON        KLIST
     C                   KFLD                    WSFSN
     C                   KFLD                    ST2LK
     C                   KFLD                    ST2KOD
     C     KEYLK         KLIST
     C                   KFLD                    LKUNI
     C                   KFLD                    HELKA
     C                   MOVEL     'LK'          LKUNI             3
     C     KODFSK        KLIST
     C                   KFLD                    YFSUNI
     C                   KFLD                    WSFSN
     C                   MOVE      'FS'          YFSUNI            2
     C     KODFCK        KLIST
     C                   KFLD                    YFCUN2            2
     C                   KFLD                    WSFSN
     C                   MOVE      'FC'          YFCUNI            2
     C                   MOVE      'FC'          YFCUN2            2
     C     KODSCK        KLIST
     C                   KFLD                    YFCUNI
     C                   KFLD                    WSFSN
     C                   MOVE      'FC'          YFCUNI            2
     C     DOKEMK        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    WSSD
     C                   KFLD                    WSLNR
     C     SAMLBK        KLIST
     C                   KFLD                    WSSD
     C                   KFLD                    WSLNR
     C     HEAD7K        KLIST
     C                   KFLD                    SMPRO
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    YKN
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C     KODPBK        KLIST
     C                   KFLD                    YPBUNI
     C                   KFLD                    SMSD
     C     AIRL1K        KLIST
     C                   KFLD                    WSFSNQ
     C                   KFLD                    WSSDF
     C                   KFLD                    SMSD
     C                   KFLD                    WSRK1
     C                   KFLD                    YRWEI             5 0
     C     AIR1K1        KLIST
     C                   KFLD                    WSFSNQ            3 0
     C                   KFLD                    WSSDF
     C                   KFLD                    SMSD
     C                   KFLD                    WSRK1
     C     LOGKY         KLIST
     C                   KFLD                    WREF2
     C                   KFLD                    WWMSID
     C     AIRRAT        KLIST
     C                   KFLD                    WSFLY             3 0
     C                   KFLD                    WSSDF
     C                   KFLD                    SMSD
     C                   KFLD                    WSRK1
      *
     C     OTHKEY        KLIST
     C                   KFLD                    WSSD
     C                   KFLD                    WSLNR
     C                   KFLD                    WO1331
     C     *LIKE         DEFINE    DO1331        WO1331
     C                   MOVEL     'MY'          WO1331
      *
     C     *ENTRY        PLIST
     C                   PARM                    WSSDA             3
     C                   PARM                    WSLNRA            3
     C                   MOVE      WSSDA         WSSD
     C                   MOVE      WSLNRA        WSLNR
     C                   MOVE      'M'           YRI               1
     C                   MOVE      'FR'          YFRUNI            2
     C                   MOVE      'J01'         YJ1UNI            3
     C                   MOVE      'J02'         YJ2UNI            3
     C                   MOVE      'J03'         YJ3UNI            3
     C                   MOVE      'J04'         YJ4UNI            3
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'AR'          YARUNI            2
     C                   MOVE      'PB'          YPBUNI            2
     C                   MOVE      'PF'          YPFUNI            2
     C                   MOVE      '/'           XTG1
     C                   MOVE      'x'           XTG2
     C                   MOVE      'x'           XTG3
     C                   MOVE      *BLANKS       XBLANK
     C                   Z-ADD     0             XWORK            15 4
      *
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        YKN               8 0
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         WSNAS
      *
     C     UFIRM         CHAIN     FIRM                               33
     C     FITDVI        IFEQ      'J'
     C                   OPEN      LOGL05                               99
     C                   ENDIF
     C                   MOVE      'B'           YRCCP             1
     C                   MOVEA     *ZEROS        WAN
     C                   MOVEA     *ZEROS        WBR
     C                   MOVEA     *ZEROS        WLE
     C                   MOVEA     *ZEROS        WHØ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Prompt Rate Class Codes                                  /
      *////////////////////////////////////////////////////////////
     C     SRF4RC        BEGSR
      * Call to searchprogram
     C                   MOVE      'P'           PLUKK
     C                   CALL      'SYFA74'
     C                   PARM                    PLUKK             1
     C                   PARM                    WRCCDE            1
     C     WRCCDE        IFNE      *BLANKS
     C                   SELECT
     C     LINNBR        WHENEQ    13
     C                   MOVE      WRCCDE        RA(1)
     C     LINNBR        WHENEQ    14
     C                   MOVE      WRCCDE        RA(2)
     C     LINNBR        WHENEQ    15
     C                   MOVE      WRCCDE        RA(3)
     C     LINNBR        WHENEQ    16
     C                   MOVE      WRCCDE        RA(4)
     C     LINNBR        WHENEQ    17
     C                   MOVE      WRCCDE        RA(5)
     C     LINNBR        WHENEQ    18
     C                   MOVE      WRCCDE        RA(6)
     C                   ENDSL
     C                   ENDIF
     C                   ENDSR
     C***********************************************
     C     BEREGN        BEGSR
     C***********************************************
     C     WSFBV1        IFEQ      *ZEROS
     C                   MOVE      WSVKT1        WSFBV1
     C                   END
      *
      * AUTOMATISK BEREGNING AV GEBYR MOT CARRIER
      *
     C                   CLEAR                   DSDAT
     C                   MOVE      UYEAR         DSAAR
     C                   MOVEL     '20'          DSAAR
     C                   MOVE      UMONTH        DSMND
     C                   MOVE      UDAY          DSDAG
      * SJEKK MINIMUMSVEKT AKTUELL VEKT
     C     KFCSTA        IFNE      'F'
     C     KFCSTA        ANDNE     '+'
     C     KFCSTA        ANDNE     'M'
     C     KFCVKT        IFEQ      'A'
     C     WSVKTT        ANDLT     KFCMIN
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <KFCVKT
      * SJEKK MINIMUMSVEKT FRAKTBEREGNINGSVEKT
     C     KFCVKT        IFEQ      'C'
     C     WSFTOT        ANDLT     KFCMIN
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <KFCVKT
     C                   ENDIF                                                  <KFCVKT
     C     KEYLK         CHAIN     KODTLK                             37
      * SJEKK LANDKODE - INCLUDE
     C     KFCIO1        IFEQ      'I'
     C     HELKA         IFNE      KFCLK1
     C     HELKA         ANDNE     KFCLK2
     C     HELKA         ANDNE     KFCLK3
     C     HELKA         ANDNE     KFCLK4
     C     HELKA         ANDNE     KFCLK5
     C     KLKLK2        ANDNE     KFCLK1
     C     KLKLK2        ANDNE     KFCLK2
     C     KLKLK2        ANDNE     KFCLK3
     C     KLKLK2        ANDNE     KFCLK4
     C     KLKLK2        ANDNE     KFCLK5
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <HELKA
     C                   ENDIF                                                  <KFCIO1
      * SJEKK LANDKODE - OMIT
     C     KFCIO1        IFEQ      'O'
     C     HELKA         IFEQ      KFCLK1
     C     HELKA         OREQ      KFCLK2
     C     HELKA         OREQ      KFCLK3
     C     HELKA         OREQ      KFCLK4
     C     HELKA         OREQ      KFCLK5
     C     KLKLK2        OREQ      KFCLK1
     C     KLKLK2        OREQ      KFCLK2
     C     KLKLK2        OREQ      KFCLK3
     C     KLKLK2        OREQ      KFCLK4
     C     KLKLK2        OREQ      KFCLK5
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <HELKA
     C                   ENDIF                                                  <KFCIO1
      * SJEKK GYLDIGHETSDATO
     C     KFCTIL        IFEQ      *ZEROS
     C                   MOVE      99999999      KFCTIL
     C                   END
     C     DSDAT         IFLE      KFCTIL
     C     DSDAT         ANDGE     KFCFRA
      * SJEKK OM FAST PRIS
     C     KFCSTA        IFEQ      'F'
     C                   Z-ADD     KFCMIN        WSCARR
     C                   ELSE
      * SJEKK FRAKTBEREGNINGSVEKT ELLER AKTUELL VEKT
     C     KFCVKT        IFEQ      'A'
     C     WSVKTT        MULT      KFCAVG        WSCARR            9 2
     C                   ELSE
     C     WSFTOT        MULT      KFCAVG        WSCARR
     C                   ENDIF                                                  <DFCVKT
     C     KFCSTA        IFEQ      '+'
     C                   ADD       KFCMIN        WSCARR
     C                   END
N03  C     KFCMIN        DIV       100           KFCMIND           7 2
     C     KFCSTA        IFEQ      'M'
S03  C*    WSCARR        ANDLT     KFCMIN
N03  C     WSCARR        ANDLT     KFCMIND
S03  C*                  Z-ADD     KFCMIN        WSCARR
N03  C                   Z-ADD     KFCMIND       WSCARR
     C                   END
     C                   ENDIF                                                  <DFCVKT
     C     WSCCPP        IFEQ      'CC'
     C                   MOVE      'C'           WSKDDC
     C                   ENDIF                                                  <WSCCPP
     C     WSCCPP        IFEQ      'PP'
     C                   MOVE      'P'           WSKDDC
     C                   ENDIF                                                  <WSCCPP
      * OPPDATER EGEN FIL MED OTHER CHARGES
      *
     C                   EXSR      OPDOTH
     C                   ENDIF                                                  <DSDAT
     C     FSCSL         ENDSR
      *
     C***********************************************
     C     OPDOTH        BEGSR
     C***********************************************
      *
      * OPPDATERER ANDRE GEBYRER
      *
     C                   move      'J'           BERFC             1
     C     OTHKEY        CHAIN     DOKOTHM                            66
     C     *IN66         IFEQ      *OFF
     C     DO1333        ANDGT     0
     C                   DELETE    DOKOTR
     C                   MOVE      *ON           *IN66
     C                   ENDIF
     C     *IN66         IFEQ      *ON
     C                   CLEAR                   DOKOTR
     C                   MOVE      WSSD          DOSD
     C                   MOVE      WSLNR         DOLNR
     C                   MOVEL     WO1331        DO1331
      * SKJEKK COLLECT PREPAID
     C     WSCCPP        IFEQ      'CC'
     C                   MOVEL     'C'           DO1322
     C                   ELSE
     C     WSCCPP        IFEQ      'PP'
     C                   MOVEL     'P'           DO1322
     C                   ENDIF                                                  <WSCCPP
     C                   ENDIF                                                  <WSCCPP
      *
     C                   MOVEL     'C'           DO1332
     C                   Z-ADD     WSCARR        DO1333
     C     DO1333        ifne      *zeros
     C                   WRITE     DOKOTR
     C                   end
     C                   ENDIF
     C                   ENDSR
     C***********************************************
     C     SRMO          BEGSR
     C***********************************************
      *
      * AUTOMATISK BEREGNING AV MISCELLANOUS DUE ISSUING CARRIER
      *
      * Henter DATA FRA FLYSELSKAP
     C     KODFSK        CHAIN     KODTFS                             37
     C     *IN37         IFEQ      '0'
N01  C     KFSMCO        IFNE      0
N01  C     WSFTOT        ANDGT     KFSMCO
N01  C                   Z-ADD     KFSMC2        WSCARR
N01  C                   ELSE
     C                   Z-ADD     KFSMC         WSCARR            9 2
N01  C                   END
      *
      * OPPDATER EGEN FIL MED OTHER CHARGES
     C                   MOVEL     'CH'          WO1331
      *
     C                   EXSR      OPDOTH
     C                   ENDIF
     C                   ENDSR
     C***********************************************
     C     SUMOTH        BEGSR
     C***********************************************
     C                   Z-ADD     0             WSBLDC
      *
      * SUMMER OTHER CHARGES DUE CARRIER
      *
     C     DOKOKE        SETLL     DOKOTHM
     C     DOKOKE        READE(N)  DOKOTHM                                66
     C     *IN66         DOWEQ     *OFF
      *
     C     DO1332        IFEQ      'C'
     C                   ADD       DO1333        WSBLDC
     C                   ENDIF
      *
     C     DOKOKE        READE(N)  DOKOTHM                                66
     C  N66              ENDDO
     C                   ENDSR
     C***********************************************
     C     MALVKT        BEGSR
     C***********************************************
     C                   CALL      'SYEF15V'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    UTX1             25
     C                   PARM                    UTX2             25
     C                   PARM                    UTX3             25
     C                   PARM                    UTX4             25
     C                   PARM                    UTX5             25
     C                   PARM                    UTX6             25
     C                   PARM                    UTX7             25
     C                   PARM                    UTX8             25
     C                   PARM                    UTX9             25
     C                   PARM                    UTX10            25
     C                   ENDSR
N05   ***********************************************
N05  C     SOKDTA2       BEGSR
N05  C     WSCLOC        DIV       256           LINNBR2
N05  C                   MVR                     POSNBR2
N05  C     LINNBR2       IFEQ      23
N05  C     POSNBR2       ANDGE     35
N05  C     POSNBR2       ANDLE     67

N05  C                   CALL      'SYFAKDA'
N05  C                   PARM      'AIRSPH'      WFTYP1           10
N05  C                   PARM                    UUPDAT            1
N05  C                   PARM      *BLANKS       WFKOD1            5

N05  C     WFKOD1        IFNE      *BLANKS
N05  C                   SELECT
N05  C     POSNBR2       WHENEQ    35
N05  C                   MOVEL     WFKOD1        WSSPH1
N05  C     POSNBR2       WHENEQ    39
N05  C                   MOVEL     WFKOD1        WSSPH2
N05  C     POSNBR2       WHENEQ    43
N05  C                   MOVEL     WFKOD1        WSSPH3
N05  C     POSNBR2       WHENEQ    47
N05  C                   MOVEL     WFKOD1        WSSPH4
N05  C     POSNBR2       WHENEQ    51
N05  C                   MOVEL     WFKOD1        WSSPH5
N05  C     POSNBR2       WHENEQ    55
N05  C                   MOVEL     WFKOD1        WSSPH6
N05  C     POSNBR2       WHENEQ    59
N05  C                   MOVEL     WFKOD1        WSSPH7
N05  C     POSNBR2       WHENEQ    63
N05  C                   MOVEL     WFKOD1        WSSPH8
N05  C     POSNBR2       WHENEQ    67
N05  C                   MOVEL     WFKOD1        WSSPH9
N05  C                   ENDSL
N05  C                   ENDIF

N05  C                   ENDIF
N05  C                   ENDSR
      *
      * S08  TATT UT TABELL  (VG)
**  TABELL (MSG)
SEE EXTENSION LIST                                                     >
ENCLOSURE                                                              >
CONSOLIDATION                                                          >
*CONSOLIDATION AS PER                                                  >
ATTACHED MANIFEST*                                                     >
**    TABELL  (NAV)  ENDRING 03
JAN
FEB
MAR
APR
MAY
JUN
JUL
AUG
SEP
OCT
NOV
DEC
