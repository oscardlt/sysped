             PGM
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FIL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MBR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OK) TYPE(*LGL) LEN(1)
             DCL        VAR(&SSN) TYPE(*DEC) LEN(9 0)
             DCL        VAR(&SST) TYPE(*CHAR) LEN(1) VALUE(B)
             DCL        VAR(&NETW) TYPE(*CHAR) LEN(1) VALUE('4')
             DCL        VAR(&IIDS) TYPE(*CHAR) LEN(35)
             DCL        VAR(&IIDR) TYPE(*CHAR) LEN(35)
             DCL        VAR(&STRTIME) TYPE(*CHAR) LEN(6)
             DCL        VAR(&ENDTIME) TYPE(*CHAR) LEN(6)
             DCL        VAR(&QTIME) TYPE(*CHAR) LEN(6)
             DCL        VAR(&FROMUSR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&FROMADR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&TOUSR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&TOADR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&NBRCURRCD) TYPE(*DEC) LEN(10 0)

             RTVDTAARA  DTAARA(EDIDTA (154 6)) RTNVAR(&STRTIME)
             IF         COND(&STRTIME *EQ *IMMED) THEN(GOTO +
                          CMDLBL(START))
             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&QTIME)
             IF         COND(&STRTIME *LE &QTIME) THEN(GOTO +
                          CMDLBL(START))
             DLYJOB     RSMTIME(&STRTIME)

 START:      RTVDTAARA  DTAARA(EDIDTA (160 6)) RTNVAR(&ENDTIME)
             IF         COND(&ENDTIME *NE *NONE) THEN(DO)
             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&QTIME)
             IF         COND(&ENDTIME *LT &QTIME) THEN(GOTO +
                          CMDLBL(END))
             ENDDO

             CALL       PGM(EDI30C4) PARM('SYEDIUSR')
             CALL       PGM(E063R) PARM(&NETW)
             DLYJOB     DLY(30)

 START2:     CALL       PGM(EDI07R) PARM(&OK &LIB &FIL &MBR &SSN +
                          &NETW &IIDS &IIDR)
             IF         COND(&OK *EQ '1') THEN(DO)
             DLYJOB     DLY(30)
             GOTO       CMDLBL(START)
             ENDDO
             DLTF       FILE(QTEMP/Q)
             MONMSG     MSGID(CPF0000)
             CRTPF      FILE(QTEMP/Q) RCDLEN(80)
             MONMSG     MSGID(CPF0000)

             CPYF       FROMFILE(&LIB/&FIL) TOFILE(QTEMP/Q) +
                          MBROPT(*REPLACE) INCCHAR(SEMBR 1 *EQ +
                          &MBR) FMTOPT(*NOCHK)
             CALL       PGM(EDI10R) PARM(&SSN &FROMUSR &FROMADR +
                          &TOUSR &TOADR)
             SNDNETF    FILE(QTEMP/Q) TOUSRID((&TOUSR &TOADR)) +
                          MBR(*FIRST) TOTYPE(*FROMFILE) CLASS(A) +
                          FORMAT(*V) PTY(*NORMAL)
             RTVMBRD    FILE(QTEMP/Q) MBR(*FIRST) NBRCURRCD(&NBRCURRCD)
             CALL       PGM(EDI06R) PARM(&SSN &SST &NBRCURRCD)
             GOTO       CMDLBL(START2)

 END:        ENDPGM
