      *********************************************************************
      *********************************************************************
CRTPG+*  CRTPGM SYSPED/WSGOTID MODULE(*LIBL/WSGOTID
CRTPGM*         *LIBL/INCGI) ACTGRP(*NEW) AUT(*USE)
      *********************************************************************
      * MAIN PROGRAM FLOW
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *--------------------------------------------------------------------
     FBRIDF     IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *--------------------------------------------------------------------
     D WSUSER          S             10
     D XMLstring       S          32000
     D ORIGIN          s            256A
     D DESTIN          s            256A
     D SECONDS         s             11  0
     D RESULT          s              3
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prolog3
      *--------------------------------------------------------------------
      *
      * Parse input
     C                   eval      WSUSER  = zhbgetvar('USER')
     C                   eval      Origin  = zhbgetvar('ORIGIN')
     C                   eval      Destin  = zhbgetvar('DESTIN')
      *
     C                   OPEN      BRIDF
     C     WSUSER        CHAIN     BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
     C                   CLOSE     BRIDF
      * Hent XML output-dok/ skriv top + linjer
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/WS_XML.html':
     C                             '/CGITAG/')
      *
     C                   callp     wrtsection('top')
     C                   call      'ESTK12A'
     C                   parm                    ORIGIN
     C                   parm                    DESTIN
     C                   parm                    SECONDS
     C                   parm                    RESULT
      *
      /free
        XMLstring='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');
        XMLstring='<getGoogleTime>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');
        XMLstring='<seconds>'+%trim(%editc(SECONDS:'Z'))+'</seconds>'
                 +'<result>'+%trim(RESULT)+'</result>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');
        XMLstring='</getGoogleTime>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');
      /end-free
      *
     C     SLUTT         TAG
     C                   callp     wrtsection('*fini')
     C                   eval      *inlr = *on
     C                   return
