     H DFTACTGRP(*NO) BNDDIR('HTTPAPI')

     FUUIDF     IF   E             DISK
     FQSYSPRT   O    F  132        PRINTER OFLIND(*INOF)

      /copy qrpglesrc,httpapi_h
      /copy qrpglesrc,ifsio_h

     D TimeSt          s               z                                        z=Timestamfield
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0

     D Add_LogonHead   PR
     D   Header                    1024A   varying
     D   UserData                      *   value


     D msg             s             50A
     D rc              s             10I 0
     D url             s          32767A   varying
     D PrintLine       s            132A
     D filename        s             45A   varying
      *

     C     *entry        Plist
     c                   parm                    Uuuid            36
     c                   parm                    Ufilename        45

      /free
        chain 1 uuidf;
        if not %found;
          ipadr = 'gm.systema.no';
          ipport = '8443';
        endif;

        http_debug(*ON);
        *inlr = *on;

        if ipport = *blanks;
          url = %trim(ipprot) + '://' + %trim(ipadr);
        else;
          url = %trim(ipprot) + '://' + %trim(ipadr) + ':' + %trim(ipport);
        endif;
        url = %trim(url) + '/syjservicestn-expft'
              + '/getManifestStatus.do?user=SYSTEMA&id=' + %trim(Uuuid);
        filename = http_tempfile() + '.json';
        rc = http_url_get( url : filename );
        if (rc <> 1);
           PrintLine = http_error();
           except;
           unlink(filename);
           return;
        endif;

        // flytt til ut-parameter hvis
        eval Ufilename=filename;

        return;
      /end-free

     OQSYSPRT   E
     O                       PrintLine          132


      *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * HTTPAPI will call this (because we set it with http_xproc)
      * just before sending the HTTP headers to the remote server.
      * This procedure lets us add any header we like to the
      * HTTP request.
      *
      * In this example, I'll use it to supply the LogonHead
      * This way, I can supply a HEADER     that's up to
      * 1024 characters long.
      *
      * NOTE: Make sure you leave off the SOAPAction header on the
      *       HTTP_url_post_xml, above, otherwise you'll send two
      *       of them¤
      *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     P Add_LogonHead   B
     D Add_LogonHead   PI
     D   Header                    1024A   varying
     D   UserData                      *   value
      /free
         Header = 'Accept: application/json'
                + x'0d25'
                + 'api_key:'
                + ' 84a6816a08c305460ad7783fcf1964a18c1e1fff'
                + x'0d25';
      /end-free
     P                 E
