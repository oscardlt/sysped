********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 shV PTF11 prik endriinger             0
********************************************************************
      * Hevold...
      * OBS!  IKKE %-GEBYR MEN ORDINÆRT B=BRUTTO  - pris i USD...
      * PÅ ALLE KUNDER SOM HAR GITTE GEBYRKODER (F.EKS FRA) I AVTALEN
*OBS  * Linjer med *OBS  i margen vil være kundespesifike!!!
     FPRIK2     UF A E           K DISK
     F*RLK      O  A E             DISK
     F*RGE      O  A E             DISK
*OBS C                   MOVE      'BAI'         OILGEB            3            OLJETILLEGG
      *
     C     KEY           KLIST
     C                   KFLD                    GMKNR
     C                   KFLD                    GMAVTN
     C                   KFLD                    GMLNR
     C     *LIKE         DEFINE    PKKNR         GMKNR
     C     *LIKE         DEFINE    PKAVTN        GMAVTN
     C     *LIKE         DEFINE    PKLNR         GMLNR
      *
     C     '00000001'    SETLL     PRIK2
     C                   READ      PRIK2                                  33
     C     *IN33         DOWEQ     '0'
*OBS C     PKGEBY        IFEQ      'SEA'
*OBS C     PKGEBY        OREQ      'SJI'
     C     PKAVTT        IFEQ      'T'
     C     PKAVTT        OREQ      'P'
     C     PKAVTT        OREQ      'B'
     C                   EXSR      ADDGEB
     C                   END
     C                   END
     C                   READ      PRIK2                                  33
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      ***************************************
     C     ADDGEB        BEGSR
      ***************************************
      * FINN HØYESTE LNR PÅ DENNE AVTALE, LEGG TIL 1
     C                   MOVE      PKKNR         GMKNR
     C                   MOVE      PKAVTN        GMAVTN
     C                   Z-ADD     9999          GMLNR
     C     KEY           SETLL     PRIK2
     C                   READP     PRIK2                                  34
     C  N34              Z-ADD     PKLNR         GMLNR
     C   34              MOVE      *ZEROS        GMLNR
      * INITIER FASTE FELT..
     C                   CLEAR                   PRIKR
     C                   MOVE      GMKNR         PKKNR
     C                   MOVE      GMAVTN        PKAVTN
     C                   MOVE      'B'           PKAVTT
     C                   MOVE      *ZEROS        PKINT
*OBS C                   MOVE      'N'           PKMVA
     C                   Z-ADD     GMLNR         PKLNR
      * FØRST OLJE-TILLEGG (DIESELTILLEG / BAF)
      *  NORMAL LCL - UNTATT VISSE...  TAB 1 = LCL, 2 = FCL
     C                   ADD       1             PKLNR
*OBS?C                   MOVE      '1'           PKTNR
     C                   MOVE      OILGEB        PKGEBY
     C                   MOVE      'USD'         PKFVAL
*OBS C                   MOVE      'I'           PKFRIO
*OBS C                   MOVE      'FOB'         PKFR01
*OBS C                   MOVE      'EXW'         PKFR02
*OBS C                   MOVE      'O'           PKOTIO
*OBS C                   MOVE      'I1'          PKOT01
*OBS C                   MOVE      'I2'          PKOT02
*OBS C                   MOVE      'O'           PKLKIO
*OBS C                   MOVE      'IN'          PKLK01
     C                   WRITE     PRIKR
      *
s01  C*                  CLEAR                   PRGER
s01  C*                  MOVE      PKKNR         APKKNR
s01  C*                  MOVE      PKAVTN        APKAVT
s01  C*                  MOVE      PKLNR         APKLNR
s01  C*                  MOVE      'F2'          PKOT03
s01  C*                  MOVE      'K2'          PKOT04
s01  C*                  MOVE      'A2'          PKOT05
s01  C*                  WRITE     PRGER
s01  C*
s01  C*                  CLEAR                   PRLKR
s01  C*                  MOVE      PKKNR         BPKKNR
s01  C*                  MOVE      PKAVTN        BPKAVT
s01  C*                  MOVE      PKLNR         BPKLNR
*OBS C                   MOVE      'PK'          PKLK02
*OBS C                   MOVE      'BD'          PKLK03
*OBS C                   MOVE      'LK'          PKLK04
*OBS C                   MOVE      'US'          PKLK05
*OBS C                   MOVE      'JP'          PKLK06
s01S C*                  WRITE     PRLKR
      * TAB 2 =  FCL
     C                   ADD       1             PKLNR
*OBS?C                   MOVE      '2'           PKTNR
     C                   WRITE     PRIKR
      *
S01  C*                  CLEAR                   PRGER
s01  C*                  MOVE      PKKNR         APKKNR
s01  C*                  MOVE      PKAVTN        APKAVT
s01  C*                  MOVE      PKLNR         APKLNR
     C                   MOVE      'F1'          PKOT03
*OBS C                   MOVE      'K1'          PKOT04
*OBS C                   MOVE      'A1'          PKOT05
s01  C*                  WRITE     PRGER
s01  C*                  MOVE      PKLNR         BPKLNR
s01  C*                  WRITE     PRLKR
      *
      *  JAPAN  LCL -              ..  TAB 3 = LCL, 5 = FCL
     C                   ADD       1             PKLNR
*OBS?C                   MOVE      '3'           PKTNR
*OBS C                   MOVE      'I'           PKLKIO
*OBS C                   MOVE      'JP'          PKLK01
     C                   WRITE     PRIKR
      *
s01  C*                  CLEAR                   PRGER
s01  C*                  MOVE      PKKNR         APKKNR
s01  C*                  MOVE      PKAVTN        APKAVT
s01  C*                  MOVE      PKLNR         APKLNR
*OBS C                   MOVE      'F2'          PKOT03
*OBS C                   MOVE      'K2'          PKOT04
*OBS C                   MOVE      'A2'          PKOT05
s01  C*                  WRITE     PRGER
      * TAB 5 =  FCL
     C                   ADD       1             PKLNR
*OBS?C                   MOVE      '5'           PKTNR
     C                   WRITE     PRIKR
s01  C*                  CLEAR                   PRGER
s01  C*                  MOVE      PKKNR         APKKNR
s01  C*                  MOVE      PKAVTN        APKAVT
s01  C*                  MOVE      PKLNR         APKLNR
*OBS C                   MOVE      'F1'          PKOT03
*OBS C                   MOVE      'K1'          PKOT04
*OBS C                   MOVE      'A1'          PKOT05
s01  C*                  WRITE     PRGER
      *
      *
      *  INDIA PAKISTAN MM..       ..  TAB 4 = LCL, 6 = FCL
     C                   ADD       1             PKLNR
*OBS?C                   MOVE      '4'           PKTNR
*OBS C                   MOVE      'I'           PKLKIO
*OBS C                   MOVE      'IN'          PKLK01
     C                   WRITE     PRIKR
      *
s01  C*                  CLEAR                   PRGER
s01  C*                  MOVE      PKKNR         APKKNR
S01  C*                  MOVE      PKAVTN        APKAVT
s01  C*                  MOVE      PKLNR         APKLNR
*OBS C                   MOVE      'F2'          PKOT03
*OBS C                   MOVE      'K2'          PKOT04
*OBS C                   MOVE      'A2'          PKOT05
S01  C*                  WRITE     PRGER
      *
s01  C*                  CLEAR                   PRLKR
s01  C*                  MOVE      PKKNR         BPKKNR
s01  C*                  MOVE      PKAVTN        BPKAVT
s01  C*                  MOVE      PKLNR         BPKLNR
*OBS C                   MOVE      'PK'          PKLK02
*OBS C                   MOVE      'BD'          PKLK03
*OBS C                   MOVE      'LK'          PKLK04
S01  C*                  WRITE     PRLKR
      * TAB 6 =  FCL
     C                   ADD       1             PKLNR
*OBS?C                   MOVE      '6'           PKTNR
     C                   WRITE     PRIKR
s01  C*                  CLEAR                   PRGER
s01  C*                  MOVE      PKKNR         APKKNR
s01  C*                  MOVE      PKAVTN        APKAVT
s01  C*                  MOVE      PKLNR         APKLNR
*OBS C                   MOVE      'F1'          PKOT03
*OBS C                   MOVE      'K1'          PKOT04
*OBS C                   MOVE      'A1'          PKOT05
S01  C*                  WRITE     PRGER
S01  C*                  MOVE      PKLNR         BPKLNR
S01  C*                  WRITE     PRLKR
      *
      *
     C     ENDTAG        TAG
      * SETT KEY FORBI DENNE KUNDE/AVTNR
     C                   Z-ADD     9999          GMLNR
     C     KEY           SETLL     PRIK2
      *
     C                   ENDSR
      *
