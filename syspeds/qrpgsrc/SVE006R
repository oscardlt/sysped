********************************************************************
      *  TDS  EXPORT, Skriv ut huvudark
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 KOPLAS F (AFP) ER LIKEVERDIG MED P
10XXX * 02 CB  PTF10 Feil ved concat av rubrikk 44
10170 * 03 CB  PTF10 Legg ut oppdragsnummer i ARKIVP
11078 * 04 CB  PTF11 R35 och 38 nu alfa
********************************************************************
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FarkivP    O  A E           K DISK
     FSVEH      IF   E           K DISK
     FSVEV      IF   E           K DISK
     FSVEVA2    IF   E           K DISK
     FSVEF      IF   E           K DISK
     FSVE006F   UF A E           K DISK
     FSVE006F2  UF A E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E             DISK
     FKODTA     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSVTHA     IF   E           K DISK
     FSVE006P   O    E             PRINTER USROPN
     FFRISOK    IF   E           K DISK
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN154                  1     15  4
     D  ØA154H                 1     11
     D  ØA154X                 7     11
     D  ØA154D                12     15
     D                 DS
     D  ØA10                   1     10
     D  Ø10                    1     10
     D                                     DIM(10)                              Num edit
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVEHASYAV         4
     C                   PARM                    UVEHASYOP         7
     C                   PARM                    CALLTYP           1
     C                   MOVE      UVEHASYAV     UVEH_SYAV
     C                   MOVE      UVEHASYOP     UVEH_SYOP
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SVEH_SYAV     UVEH_SYAV
     C     *LIKE         DEFINE    SVEH_SYOP     UVEH_SYOP
     C     *LIKE         DEFINE    KOPUNI        UOPUNI
     C     *LIKE         DEFINE    KOPAVD        UOPAVD
     C     *LIKE         DEFINE    KOPLNR        UOPLNR
     C     *LIKE         DEFINE    KFMSD         UFMSD
     C     *LIKE         DEFINE    KOAUNI        WKOAUNI
     C     *LIKE         DEFINE    FSKODE        WSKODE
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVEH_SYAV
     C                   KFLD                    UVEH_SYOP
     C     KEYP          KLIST
     C                   KFLD                    UOPUNI
     C                   KFLD                    UOPAVD
     C                   KFLD                    UOPLNR
     C     KEYF          KLIST
     C                   KFLD                    KOPFM
     C                   KFLD                    UFMSD
     C     KEY006        KLIST
     C                   KFLD                    UVEH_SYAV
     C                   KFLD                    UVEH_SYOP
     C                   KFLD                    SVEVA_ABK
     C     KEYVX         KLIST
     C                   KFLD                    SVEV_SYAV
     C                   KFLD                    SVEV_SYOP
     C                   KFLD                    SVEV_SYLI
     C     KEYKODTA      KLIST
     C                   KFLD                    WKOAUNI
     C                   KFLD                    SVEH_SYAV
     C     KEYCUND       KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     FRIKEY        KLIST
     C                   KFLD                    SVEH_SYAV
     C                   KFLD                    SVEH_SYOP
     C                   KFLD                    WSKODE
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C                   EVAL      UOPUNI='P'
     C                   EVAL      UOPAVD=UVEH_SYAV
     C                   EVAL      UOPLNR=251
     C                   EVAL      UFMSD=1
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD           1024
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   EVAL      WKOAUNI='A'
     C                   MOVEL     '*CR'         WSKODE
      *______________________________________
      * Hente firmaopplysninger fra spedisjon
      *""""""""""""""""""""""""""""""""""""""
     C                   READ      FIRM
      *_____________________
      * Hente printerstyring
      *"""""""""""""""""""""
     C     KEYP          CHAIN     KODTP
     C     KEYF          CHAIN     KODTFM
      *_______________
      * Printerstyring
      *"""""""""""""""
      * Printerstyring ikke ved arkiv
     C     calltyp       ifne      'A'
     C     koplas        andne     'P'
N01  C     koplas        andne     'F'
     C                   OPEN      SVE006P
     C                   EVAL      UCMD='OVRPRTF FILE(SVE006P) OUTQ('
     C     UCMD          CAT       KOPNVN:0      UCMD
     C     UCMD          CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     c                   end
      * PDF vdirekte
     C     KOPLAS        IFEQ      'P'
N01  C     KOPLAS        oreq      'F'
s01  C*    calltyp       andne     'A'
N01  C     calltyp       ifne      'A'
     C                   CALL      'SVE006C'
     C                   PARM                    KOPNVN
     C                   OPEN      SVE006P
N01  c                   end
     C                   END
      * arkiv
     C     calltyp       ifeq      'A'
     C                   CALL      'SVE006CA'
     C                   OPEN      SVE006P
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     SVEH

      *_________
      * Huvudark
      *"""""""""
      * Hur många varuposter finnes ?
     C                   EVAL      WRUBR5=0
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVEV
     C     KEYA          READE     SVEV                                   52
     C     *IN52         DOWEQ     *OFF
     C                   ADD       1             WRUBR5
     C     KEYA          READE     SVEV                                   52
     C                   ENDDO
      * 1 Varupost
     C                   IF        WRUBR5<2
     C                   EXSR      SRBA
     C                   ENDIF
      * Flera varuposter
     C                   IF        WRUBR5>1
     C                   EXSR      SRBB
     C                   ENDIF
      * Finns fakturor ? Skriv då ut !
     C     KEYA          CHAIN     SVEF                               52
     C     *IN52         IFEQ      *OFF
     C                   CALL      'SVE008R'
     C                   PARM                    UVEHASYAV
     C                   PARM                    UVEHASYOP
     C                   PARM                    CALLTYP
     C                   EVAL      SVEH_FATX='Diverse se lista'
     C                   ENDIF
      * In med Fakturaupplysningar i rubrik 44 om det finns plats
     C                   SELECT
     C     WRUBR44A      WHENEQ    *BLANKS
     C     SVEH_FATY     CAT       SVEH_FATX:1   WRUBR44A
     C     WRUBR44B      WHENEQ    *BLANKS
     C     SVEH_FATY     CAT       SVEH_FATX:1   WRUBR44B
     C     WRUBR44C      WHENEQ    *BLANKS
     C     SVEH_FATY     CAT       SVEH_FATX:1   WRUBR44C
     C     WRUBR44D      WHENEQ    *BLANKS
     C     SVEH_FATY     CAT       SVEH_FATX:1   WRUBR44D
     C     WRUBR44E      WHENEQ    *BLANKS
     C     SVEH_FATY     CAT       SVEH_FATX:1   WRUBR44E
     C                   ENDSL
      * Kundereferanse
     C     FRIKEY        CHAIN     FRISOK                             39
     C  N39              MOVEL     FSSOK         WVEH_XREF

      * Skriv huvudark
     C     KEYKODTA      CHAIN     KODTA
     C     KEYCUND       CHAIN     CUNDL01
     C                   EVAL      WVEH_OMOR=ADR3
     C                   EVAL      WVEH_OMF1=KNAVN
     C                   EVAL      WVEH_OMF2=KNAVN
     C     SVEH_OMHA     CAT       SVEH_OMTL:1   WVEH_HATL
     C                   EVAL      *IN65=*OFF
     C     SVEH_MTYP     IFEQ      'UGE'
     C                   MOVEL     SVEH_TUID     WVEH_TUID
     C                   MOVE      SVEH_SYDT     WVEH_SYDT
     C                   EVAL      *IN65=*ON
     C                   ENDIF
     C                   WRITE     SVE006PA
     C     calltyp       ifeq      'C'
     C                   EXSR      ARKSR
     C                   end
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varuposter, en                                      SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
      * Delete av gamla arbetsposter i arbetsfil 2
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVE006F2
     C     KEYA          READE     SVE006F2                               52
     C     *IN52         DOWEQ     *OFF
     C                   DELETE    SVE006F2R
     C     KEYA          READE     SVE006F2                               52
     C                   ENDDO
      * R31 Godsmærkning från sida 1
     C                   EVAL      SVE006F2_A=SVEH_SYAV
     C                   EVAL      SVE006F2_O=SVEH_SYOP
     C                   EVAL      SVE006F2_T=SVEV_GODM
     C                   WRITE     SVE006F2R
      * R31 Godsmærkning
     C     SVEV_GOD2     IFNE      *BLANKS
     C                   EVAL      SVE006F2_T=SVEV_GOD2
     C                   WRITE     SVE006F2R
     C                   ENDIF
     C     SVEV_GOD3     IFNE      *BLANKS
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      SVE006F2_T=SVEV_GOD3
     C                   WRITE     SVE006F2R
     C                   ENDIF
     C     SVEV_GOD4     IFNE      *BLANKS
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      SVE006F2_T=SVEV_GOD4
     C                   WRITE     SVE006F2R
     C                   ENDIF
     C     SVEV_GOD5     IFNE      *BLANKS
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      SVE006F2_T=SVEV_GOD5
     C                   WRITE     SVE006F2R
     C                   ENDIF
      * R31 Antall och varuslag från sida 1
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      ØN154=SVEH_KOTA
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_KOSL:1   SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_VASL:1   SVE006F2_T
     C                   WRITE     SVE006F2R
      * R31 Antall och varuslag
     C     SVEV_KOT2     IFNE      0
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      ØN154=SVEV_KOT2
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_KOS2:1   SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_VAS2:1   SVE006F2_T
     C                   WRITE     SVE006F2R
     C                   ENDIF

     C     SVEV_KOT3     IFNE      0
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      ØN154=SVEV_KOT3
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_KOS3:1   SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_VAS3:1   SVE006F2_T
     C                   WRITE     SVE006F2R
     C                   ENDIF

     C     SVEV_KOT4     IFNE      0
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      ØN154=SVEV_KOT4
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_KOS4:1   SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_VAS4:1   SVE006F2_T
     C                   WRITE     SVE006F2R
     C                   ENDIF

     C     SVEV_KOT5     IFNE      0
     C                   EVAL      SVE006F2_T=*BLANKS
     C                   EVAL      ØN154=SVEV_KOT5
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_KOS5:1   SVE006F2_T
     C     SVE006F2_T    CAT       SVEV_VAS5:1   SVE006F2_T
     C                   WRITE     SVE006F2R
     C                   ENDIF

      * Læs arbetsfil och lægg ut till fælt i printerfil R31
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVE006F2
     C     KEYA          READE     SVE006F2                               52
     C     *IN52         DOWEQ     *OFF
      * R31 rad 1
     C                   IF        WRUBR31A=*BLANKS
     C                   EVAL      WRUBR31A=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 2
     C                   IF        WRUBR31B=*BLANKS
     C                   EVAL      WRUBR31B=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 3
     C                   IF        WRUBR31C=*BLANKS
     C                   EVAL      WRUBR31C=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 4
     C                   IF        WRUBR31D=*BLANKS
     C                   EVAL      WRUBR31D=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 5
     C                   IF        WRUBR31E=*BLANKS
     C                   EVAL      WRUBR31E=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 6
     C                   IF        WRUBR31F=*BLANKS
     C                   EVAL      WRUBR31F=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 7
     C                   IF        WRUBR31G=*BLANKS
     C                   EVAL      WRUBR31G=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF
      * R31 rad 8
     C                   IF        WRUBR31H=*BLANKS
     C                   EVAL      WRUBR31H=SVE006F2_T
     C                   GOTO      SRBA1
     C                   ENDIF

     C     SRBA1         TAG

     C     KEYA          READE     SVE006F2                               52
     C                   ENDDO
      * R33
     C                   MOVEL     SVEV_VATA     WRUBR33A
     C                   MOVE      SVEV_VATA     WRUBR33B
     C                   EVAL      WRUBR33C=SVEV_VATI
     C                   EVAL      WRUBR34=SVEV_ULKD
S04  C*                  EVAL      WRUBR35=SVEV_BRUT
N04  C                   EVAL      ØN154=SVEV_BRUT
N04  C                   EXSR      SRNE
N04  C                   MOVEL     ØAN           WRUBR35
     C                   EVAL      WRUBR37A=SVEV_EUP1
     C                   MOVEL     SVEV_EUP2     WRUBR37B
S04  C*                  EVAL      WRUBR38=SVEV_NETO
N04  C                   EVAL      ØN154=SVEV_NETO
N04  C                   EXSR      SRNE
N04  C                   MOVEL     ØAN           WRUBR38
     C                   EVAL      WRUBR41=SVEV_ANKV
     C                   EVAL      WRUBR44A=SVEV_SUKO
N02  C     WRUBR44A      CAT       SVEV_SUTX:1   WRUBR44A
     C                   EVAL      WRUBR46=SVEV_STVA
     C                   IF        SVEV_STVA > 0
     C                   EVAL      WRUBR46=SVEV_STVA
     C                   ELSE
     C                   EVAL      WRUBR46=SVEV_FABL
     C                   ENDIF
      * Finnes extra R44 ?     Kun 3 av 10 får plass
     C     SVEV_SUT2     IFNE      *BLANKS
     C                   MOVEL     SVEV_SUT2     WRUBR44C
     C                   ENDIF
     C     SVEV_SUT3     IFNE      *BLANKS
     C                   MOVEL     SVEV_SUT3     WRUBR44D
     C                   ENDIF
     C     SVEV_SUT4     IFNE      *BLANKS
     C                   MOVEL     SVEV_SUT4     WRUBR44E
     C                   ENDIF
      * Hæmta avgifter
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVEVA2
     C     KEYA          READE     SVEVA2                                 52
     C     *IN52         DOWEQ     *OFF
      * Avgift-1
     C                   IF        WRUBR47A1=*BLANKS
     C                   EVAL      WRUBR47A1=SVEVA_ABK
     C                   EVAL      WRUBR47B1=SVEVA_ABG
     C                   EVAL      WRUBR47C1=SVEVA_ABS
     C                   EVAL      WRUBR47D1=SVEVA_ABB
     C                   ADD       WRUBR47D1     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-2
     C                   IF        WRUBR47A2=*BLANKS
     C                   EVAL      WRUBR47A2=SVEVA_ABK
     C                   EVAL      WRUBR47B2=SVEVA_ABG
     C                   EVAL      WRUBR47C2=SVEVA_ABS
     C                   EVAL      WRUBR47D2=SVEVA_ABB
     C                   ADD       WRUBR47D2     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-3
     C                   IF        WRUBR47A3=*BLANKS
     C                   EVAL      WRUBR47A3=SVEVA_ABK
     C                   EVAL      WRUBR47B3=SVEVA_ABG
     C                   EVAL      WRUBR47C3=SVEVA_ABS
     C                   EVAL      WRUBR47D3=SVEVA_ABB
     C                   ADD       WRUBR47D3     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-4
     C                   IF        WRUBR47A4=*BLANKS
     C                   EVAL      WRUBR47A4=SVEVA_ABK
     C                   EVAL      WRUBR47B4=SVEVA_ABG
     C                   EVAL      WRUBR47C4=SVEVA_ABS
     C                   EVAL      WRUBR47D4=SVEVA_ABB
     C                   ADD       WRUBR47D4     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-5
     C                   IF        WRUBR47A5=*BLANKS
     C                   EVAL      WRUBR47A5=SVEVA_ABK
     C                   EVAL      WRUBR47B5=SVEVA_ABG
     C                   EVAL      WRUBR47C5=SVEVA_ABS
     C                   EVAL      WRUBR47D5=SVEVA_ABB
     C                   ADD       WRUBR47D5     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-6
     C                   IF        WRUBR47A6=*BLANKS
     C                   EVAL      WRUBR47A6=SVEVA_ABK
     C                   EVAL      WRUBR47B6=SVEVA_ABG
     C                   EVAL      WRUBR47C6=SVEVA_ABS
     C                   EVAL      WRUBR47D6=SVEVA_ABB
     C                   ADD       WRUBR47D6     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-7
     C                   IF        WRUBR47A7=*BLANKS
     C                   EVAL      WRUBR47A7=SVEVA_ABK
     C                   EVAL      WRUBR47B7=SVEVA_ABG
     C                   EVAL      WRUBR47C7=SVEVA_ABS
     C                   EVAL      WRUBR47D7=SVEVA_ABB
     C                   ADD       WRUBR47D7     WRUBR47S
     C                   GOTO      SRBA2
     C                   ENDIF
      * Avgift-8
     C                   IF        WRUBR47A8=*BLANKS
     C                   EVAL      WRUBR47A8=SVEVA_ABK
     C                   EVAL      WRUBR47B8=SVEVA_ABG
     C                   EVAL      WRUBR47C8=SVEVA_ABS
     C                   EVAL      WRUBR47D8=SVEVA_ABB
     C                   ADD       WRUBR47D8     WRUBR47S
     C                   ENDIF

     C     SRBA2         TAG

     C     KEYA          READE     SVEVA2                                 52
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varuposter, flera                                   SRBB /
      *////////////////////////////////////////////////////////////
     C     SRBB          BEGSR
      * Skriv ut varuposter på egen lista
     C                   CALL      'SVE007R'
     C                   PARM                    UVEHASYAV
     C                   PARM                    UVEHASYOP
     C                   PARM                    CALLTYP
      * Delete av gamla arbetsposter i arbetsfil
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVE006F
     C     KEYA          READE     SVE006F                                52
     C     *IN52         DOWEQ     *OFF
     C                   DELETE    SVE006FR
     C     KEYA          READE     SVE006F                                52
     C                   ENDDO
      * Summera avgifter och lægg ut i arbetsfil
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVEVA2
     C     KEYA          READE     SVEVA2                                 52
     C     *IN52         DOWEQ     *OFF

     C     KEY006        CHAIN     SVE006F                            53
     C                   IF        *IN53
     C                   EVAL      SVE006F_A=SVEVA_SAV
     C                   EVAL      SVE006F_O=SVEVA_SOP
     C                   EVAL      SVE006F_K=SVEVA_ABK
     C                   EVAL      SVE006F_B=SVEVA_ABB
     C                   WRITE     SVE006FR
     C                   ELSE
     C                   ADD       SVEVA_ABB     SVE006F_B
     C                   UPDATE    SVE006FR
     C                   ENDIF

     C     KEYA          READE     SVEVA2                                 52
     C                   ENDDO
      * Læs arbetsfil och lægg ut till fælt i printerfil
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVE006F
     C     KEYA          READE     SVE006F                                52
     C     *IN52         DOWEQ     *OFF
      * Avgift-1
     C                   IF        WRUBR47A1=*BLANKS
     C                   EVAL      WRUBR47A1=SVE006F_K
     C                   EVAL      WRUBR47D1=SVE006F_B
     C                   ADD       WRUBR47D1     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-2
     C                   IF        WRUBR47A2=*BLANKS
     C                   EVAL      WRUBR47A2=SVE006F_K
     C                   EVAL      WRUBR47D2=SVE006F_B
     C                   ADD       WRUBR47D2     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-3
     C                   IF        WRUBR47A3=*BLANKS
     C                   EVAL      WRUBR47A3=SVE006F_K
     C                   EVAL      WRUBR47D3=SVE006F_B
     C                   ADD       WRUBR47D3     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-4
     C                   IF        WRUBR47A4=*BLANKS
     C                   EVAL      WRUBR47A4=SVE006F_K
     C                   EVAL      WRUBR47D4=SVE006F_B
     C                   ADD       WRUBR47D4     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-5
     C                   IF        WRUBR47A5=*BLANKS
     C                   EVAL      WRUBR47A5=SVE006F_K
     C                   EVAL      WRUBR47D5=SVE006F_B
     C                   ADD       WRUBR47D5     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-6
     C                   IF        WRUBR47A6=*BLANKS
     C                   EVAL      WRUBR47A6=SVE006F_K
     C                   EVAL      WRUBR47D6=SVE006F_B
     C                   ADD       WRUBR47D6     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-7
     C                   IF        WRUBR47A7=*BLANKS
     C                   EVAL      WRUBR47A7=SVE006F_K
     C                   EVAL      WRUBR47D7=SVE006F_B
     C                   ADD       WRUBR47D7     WRUBR47S
     C                   GOTO      SRBB1
     C                   ENDIF
      * Avgift-8
     C                   IF        WRUBR47A8=*BLANKS
     C                   EVAL      WRUBR47A8=SVE006F_K
     C                   EVAL      WRUBR47D8=SVE006F_B
     C                   ADD       WRUBR47D8     WRUBR47S
     C                   ENDIF

     C     SRBB1         TAG

     C     KEYA          READE     SVE006F                                52
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA10
     C     ØA154D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA154H        ØA10                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA154X        ØA10                                         I
     C                   MOVE      ',    '       ØA10                                         I
     C                   MOVE      ØA154D        ØA10                                         I
     C     Ø10(10)       IFEQ      '0'
     C                   MOVE      ' '           Ø10(10)
     C     Ø10(9)        IFEQ      '0'
     C                   MOVE      ' '           Ø10(9)
N04  C     Ø10(8)        IFEQ      '0'
N04  C                   MOVE      ' '           Ø10(8)
N04  C                   END
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        9             ØX                             <-------------I
     C     Ø10(ØX)       IFNE      '0'                                           <-----------II
N04  C     Ø10(ØX)       IFEQ      ','                                           <-----------II
N04  C                   SUB       1             ØX
N04  C                   ENDIF                                                   <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø10(ØX)       ØAN
      *
     C                   ENDSR
      ***********************************************
     C     ARKSR         BEGSR
      ***********************************************
      *
      * SKRIV TIL ARKIV
      *
      * SKAL DOKUMENT ARKIVERES
      *
     C                   MOVE      'SE'          ARTYPE
     C     FIFIRM        CHAIN     FIRMARC                            34
     C  N34ARTYPE        CHAIN     ARKTXT                             34
     C     *IN(34)       IFEQ      '0'
     C     arkjn         andeq     'J'
      *
     C                   z-add     SVEH_AVKN     ARKUND
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      UVEH_SYAV     ARAVD
S03  C*                  MOVE      *zeros        AROPD
N03  C                   MOVE      UVEH_SYOP     AROPD
     C                   MOVE      ULDT          ARDATE
     C                   MOVE      XULTM         ARTIME
     C                   MOVE      ZUSER         ARUSER
     C                   MOVE      UVEH_SYOP     ARUNDE
     C                   movel     'SE:'         ARUNDE
     C                   WRITE     ARKIVR
      *_________________________
      * Aktivera arkivfunktionen  FJERNES SENERE
      *"""""""""""""""""""""""""
     C     SVEH_SYSG     CHAIN     SVTHA
     C                   CALL      'ARC002CLB'
     C                   PARM      'SE'          WATYPE            2
     C                   PARM                    ARUSER
     C                   END
     C                   ENDSR
