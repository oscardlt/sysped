N01  FEDIM      UF   E           K DISK
     FDKIH      IF   E           K DISK
     FDKEH      IF   E           K DISK
     FERFF96B   IF   E           K DISK
     FEGIS96B   IF   E           K DISK
      *________________________
      * DS for decimal handling
      *""""""""""""""""""""""""
     D                 DS
     D  WMN2                   1      9  0
      */////////////
      * MAIN LOGIC /
      */////////////
      *___________
      * Initiering
      *"""""""""""
     C                   EXSR      INIT
      *________
      * CONVERT
      *""""""""
     C  N51              EXSR      SRA

     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *                                                      INIT /
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      * Define workfields
     C     *LIKE         DEFINE    MMN           ZMN
     C     *LIKE         DEFINE    DKIH_SYAV     WKIH_SYAV
     C     *LIKE         DEFINE    DKIH_SYOP     WKIH_SYOP
      * Init workfields
     C     *ENTRY        PLIST
     C                   PARM                    WMN1              9
     C                   MOVEL     WMN1          WMN2
     C                   Z-ADD     WMN2          ZMN
      * Definiere Nøkkler
     C     DKIH_KEY      KLIST
     C                   KFLD                    WKIH_SYAV
     C                   KFLD                    WKIH_SYOP
      * Get msg
S01  C*    ZMN           CHAIN     EDIM                               51
N01  C     ZMN           CHAIN(N)  EDIM                               51
N01  C     ZMN           CHAIN(N)  ERFF96B                            54
N01  C     ZMN           CHAIN(N)  EGIS96B                            55

     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * Vilken typ av svar ?                                  SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Finnes ærendet ?
      *"""""""""""""""""
     C                   MOVEL     R1154         WKIH_SYAV
     C     7             SUBST     R1154:5       M0062B            7
     C                   MOVE      M0062B        WKIH_SYOP
     C                   EVAL      *IN52=*ON
     C     DKIH_KEY      CHAIN     DKIH                               51
N02  C   51DKIH_KEY      CHAIN     DKEH                               52
N01  C     *IN51         IFEQ      *ON
N01  C     *IN52         ANDEQ     *ON
N01  C                   GOTO      SRA9
N01  C                   ENDIF
N01   * Oppdater med riktig kode i EDIM
N01  C     ZMN           CHAIN     EDIM                               53
N01  C                   IF        *IN53=*OFF
N01  C  N51              EVAL      M1N07='DKI'
N01  C  N52              EVAL      M1N07='DKE'
N01  C                   EVAL      MAVD=WKIH_SYAV
N01  C                   EVAL      MTDN=WKIH_SYOP
N01  C                   SELECT
N01  C     G7365         WHENEQ    '1'
N01  C                   EVAL      M1225='RES'
N01  C     G7365         WHENEQ    '2'
N01  C                   EVAL      M1225='FEL'
N01  C                   ENDSL
N01  C                   UPDATE    EDIMR
N01  C                   ENDIF
      * Vilken typ av svar ?
     C                   SELECT

     C*    M1001         WHENEQ    'KVT'
     C*                  CALL      'DKG141R'
     C*                  PARM                    WMN1
     C     G7365         WHENEQ    '1'
     C                   CALL      'DKG142R'
     C                   PARM                    WMN1
     C     G7365         WHENEQ    '2'
     C                   CALL      'DKG143R'
     C                   PARM                    WMN1

     C                   ENDSL

     C     SRA9          TAG

     C                   ENDSR
