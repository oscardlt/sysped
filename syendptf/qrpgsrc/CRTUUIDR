**free
CTL-OPT OPTION(*NOSRCSTMT)

    DCL-PR CRTUUIDR EXTPGM('CRTUUIDR');
    PUUID CHAR(36);
    END-PR;

    DCL-PR GENUUID EXTPROC('_GENUUID');
    UUID_TEMPLATE POINTER VALUE;
    END-PR;

    DCL-PR CVTHC EXTPROC('CVTHC');
    RESULT CHAR(65534) OPTIONS(*VARSIZE);
    SOURCE CHAR(32767) OPTIONS(*VARSIZE);
    RESULTSIZE INT(10) VALUE;
    END-PR;

    DCL-PI CRTUUIDR;
    PUUID CHAR(36);
    END-PI;

    DCL-DS UUID_TEMPLATE;
    UTBYTPRV UNS(10) INZ( %SIZE(UUID_TEMPLATE));
    UTBYTAVL UNS(10);
    VERSION CHAR(1) INZ(X'04');
    *N CHAR(7) INZ( *ALLX'00' );
    UUID CHAR(16);
    REPLY CHAR(1);
    END-DS;


    DCL-C UPPER 'ABCDEF';
    DCL-C LOWER 'ABCDEF';
    DCL-S STR CHAR(32);

    GENUUID( %ADDR( UUID_TEMPLATE ));
    CVTHC(STR:UUID:%SIZE(STR));
    PUUID = %XLATE(UPPER:LOWER:%SUBST(STR:1:8) + '-'
    + %SUBST(STR:9:4) + '-'
    + %SUBST(STR:13:4) + '-'
    + %SUBST(STR:17:4) + '-'
    + %SUBST(STR:21:12));
    *INLR = *ON;
