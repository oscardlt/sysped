     FDKTKD     UF A E           K DISK
     FEDIRE1K   IF   E           K DISK
      *//////////////
      *  Main logic /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EVAL      *INLR=*ON
      *////////////////////////////////////////////////////////////
      *  INZ                                                  SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
     C     *entry        PLIST
     C                   PARM                    UMBR             10
      *_____________
      * Define key's
      *"""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    DKKD_TYP
     C                   KFLD                    DKKD_KD
     C     KEYB          KLIST
     C                   KFLD                    DKKD_TYP
     C                   KFLD                    XDKKD_KD
     C     *LIKE         DEFINE    DKKD_KD       XDKKD_KD
      *
     C                   EVAL      DKKD_TYP = '005'
     C                   MOVE      *ZEROS        XLEN              3 0
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Calculate formats                                    SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *
     C     UMBR          SETLL     EDIRE1K
     C     UMBR          READE     EDIRE1K                                33
     C                   MOVE      'N'           XSLETTET          1

     C                   DOW       *IN33 = *OFF
      *
     C                   SELECT
     C                   WHEN      %SUBST(RDATA:2:1) >= '0' AND
     C                             %SUBST(RDATA:2:1) <= '9' AND
     C                             %SUBST(RDATA:3:1) >= '0' AND
     C                             %SUBST(RDATA:3:1) <= '9'
      * Slett gamle typer først
     C                   IF        XSLETTET = 'N'
     C                   EVAL      XDKKD_KD = %SUBST(RDATA:1:1)
     C     KEYB          SETLL     DKTKD
     C     DKKD_TYP      READE     DKTKD                                  33
     C                   DOW       *IN33 = *OFF
     C                   IF        XDKKD_KD <> %SUBST(DKKD_KD:1:1)
     C                   UPDATE    DKTKDR
     C                   EVAL      *IN33 = *ON
     C                   LEAVE
     C                   END
     C                   DELETE    DKTKDR
     C     DKKD_TYP      READE     DKTKD                                  33
     C                   ENDDO
     C                   EVAL      XSLETTET = 'J'
     C                   END
      *
     C                   EVAL      DKKD_KD = %SUBST(RDATA:1:4)
     C     ';'           SCAN      RDATA:6       XPOS              3 0    33
     C   33              EVAL      XLEN = XPOS - 6
     C  N33              EVAL      XLEN = 256
     C                   IF        XLEN > 256
     C                   EVAL      XLEN = 256
     C                   END
     C     6             DO        20            XSTR              3 0
     C                   IF        %SUBST(RDATA:XSTR:1) <> '"'
     C                   LEAVE
     C                   END
     C                   EVAL      XLEN = XLEN - 1
     C                   ENDDO
     C                   EVAL      DKKD_TXT = %SUBST(RDATA:XSTR:XLEN)
     C                   EVAL      DKKD_KD2 = *BLANKS
     C                   EVAL      DKKD_KD3 = *BLANKS
     C                   WRITE     DKTKDR
      *
     C                   ENDSL
      *
     C     UMBR          READE     EDIRE1K                                33
     C                   ENDDO

     C                   ENDSR
