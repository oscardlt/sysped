      ************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE DEFAULT VERDI TET-IMPORT   ***
      ************************************************************
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FDKTKD     IF   E           K DISK
     FEDII      IF   E           K DISK
     FDKNSTD    UF A E           K DISK
     FDKXKODL01 IF   E           K DISK
     FDKX053D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  TIDTÅ                  1      4  0
     D  TIDTM                  5      6  0
     D  TIDTD                  7      8  0
     D  TIDT                   1      8  0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
     C                   IF        MODE = 'E'
     C                   MOVE      UAVD          WSAAVD
     C                   GOTO      STARTB
     C                   END
      *
     C     START         TAG
     C                   EXFMT     DKX053D1
     C   03              GOTO      SLUTT
     C     STARTB        TAG
     C     KODTAK        CHAIN     KODTA                              99
     C   99              GOTO      START
     C                   EXSR      HENT
      *
     C     START2        TAG
     C                   EXFMT     DKX053D2
     C                   MOVEA     '000'         *IN(97)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      *
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     13            POSNBR
     C     START3        TAG
     C                   EXFMT     DKX053D3
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '000'         *IN(89)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START3
     C                   END
     C   12              GOTO      START2
      *
     C                   EXSR      TESTB3
     C   30              GOTO      START3
     C                   EXSR      OPDTRS
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C     WSAAVD        CHAIN(N)  DKNSTD                             60
     C     *IN60         IFEQ      '1'
     C                   EXSR      MOVEB
     C                   ELSE
     C                   EXSR      MOVEW
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSTDN         COMP      0                                    9999
     C   99
     CANN30              MOVE      'SPT0023'     MSGNR
     C   99              SETON                                        30
      *
     C     W0004         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN98
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
      *
     C     W0010         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN97
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
     C     WSGNSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSGNSK        YKODE
     C     DKK01K        CHAIN     DKXKODL01                          99
     C   99
     CANN30              MOVE      'DKX0810'     MSGNR
     C   99              SETON                                        30
     C                   END
      *
     C*    WSALK         IFNE      *BLANKS
     C*                  MOVEL     WSALK         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              98
     C*  98
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  98              SETON                                        30
     C*                  END
      *
      * TEST PÅ AVTALT LAGRINGSSTED (IND.97)
      *
     C     WSALSS        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSALSS        YKODE
     C     DKK01K        CHAIN     DKXKODL01                          96
     C   96
     CANN30              MOVE      'DKX0810'     MSGNR
     C   96              SETON                                        30
     C                   END
      * TEST PÅ GODKJENT LAGRINGSSTED (IND.95)
      * TEST PÅ COTROLL TOLLSTED (IND.94)
      *
     C*    WSTSB         IFNE      *BLANKS
     C*                  MOVE      '106'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSTSB         YKODE
     C*    DKK01K        CHAIN     DKXKODL01                          93
     C*  93
     C*NN30              MOVE      'DKX0811'     MSGNR
     C*  93              SETON                                        30
     C*                  END
      *
     C*    WSSKB         IFNE      *BLANKS
     C*                  MOVE      '012'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSSKB         YKODE
     C*    DKK01K        CHAIN     DKXKODL01                          92
     C*  92
     C*NN30              MOVE      'DKX0810'     MSGNR
     C*  92              SETON                                        30
     C*                  END
      *
     C     WSKN          IFNE      0
     C                   MOVE      WSKN          KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            91
     C     *IN91         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   IF        WSTIN = *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTIN = 'SE' + SYFORE
     C                   ELSE
     C                   EVAL      WSTIN = SYLAND + SYFORE
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTIN = EORI
     C                   ENDSL
     C                   END
     C                   MOVE      KNAVN         WSNA
     C                   MOVE      ADR1          WSAD1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPN
     C                   MOVEL     POSTNR        WSPN
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPN
     C                   END
     C                   MOVE      ADR3          WSPS
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLK
     C                   END
     C                   END
     C                   END
      *
     C*    WSLK          IFNE      *BLANKS
     C*                  MOVEL     WSLK          DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              90
     C*  90
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  90              SETON                                        30
     C*                  END
      *
     C*    WSSK          IFNE      *BLANKS
     C*                  MOVE      '012'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSSK          YKODE
     C*    DKK01K        CHAIN     DKXKODL01                          89
     C*  89
     C*NN30              MOVE      'DKX0810'     MSGNR
     C*  89              SETON                                        30
     C*                  END
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   89              Z-ADD     18            LINNBR
     C   89              Z-ADD     32            POSNBR
     C   90              Z-ADD     18            LINNBR
     C   90              Z-ADD     13            POSNBR
     C   91              Z-ADD     13            LINNBR
     C   91              Z-ADD     13            POSNBR
     C   92              Z-ADD     11            LINNBR
     C   92              Z-ADD     38            POSNBR
     C   93              Z-ADD     11            LINNBR
     C   93              Z-ADD     13            POSNBR
     C   94              Z-ADD     9             LINNBR
     C   94              Z-ADD     13            POSNBR
     C   95              Z-ADD     8             LINNBR
     C   95              Z-ADD     13            POSNBR
     C   96              Z-ADD     7             LINNBR
     C   96              Z-ADD     77            POSNBR
     C   97              Z-ADD     7             LINNBR
     C   97              Z-ADD     13            POSNBR
     C   98              Z-ADD     5             LINNBR
     C   98              Z-ADD     13            POSNBR
     C   99              Z-ADD     4             LINNBR
     C   99              Z-ADD     62            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVEW         BEGSR
     C***********************************************
     C                   MOVE      TITDN         WSTDN
     C                   MOVE      TIDTD         WSDTD
     C                   MOVE      TIDTM         WSDTM
     C                   MOVE      TIDTÅ         WSDTÅ
     C                   MOVE      TIENKL        WSENKL
     C                   MOVE      TITRNR        WSTRNR
     C                   MOVE      TIGN          WSGN
     C                   MOVE      TIGNSK        WSGNSK
     C                   MOVE      TIALSK        WSALSK
     C                   MOVE      TIALS         WSALS
     C                   MOVE      TIALSS        WSALSS
     C                   MOVE      TIGLSK        WSGLSK
     C                   MOVE      TIACTS        WSACTS
     C                   MOVE      TISKB         WSSKB
     C                   MOVE      TITSB         WSTSB
     C                   MOVE      TIKN          WSKN
     C                   MOVE      TINA          WSNA
     C                   MOVE      TIAD1         WSAD1
     C                   MOVE      TIPN          WSPN
     C                   MOVE      TIPS          WSPS
     C                   MOVE      TILK          WSLK
     C                   MOVE      TISK          WSSK
     C                   MOVE      TITIN         WSTIN
     C                   MOVE      S0004         W0004
     C                   MOVE      S0010         W0010
     C                   MOVE      S0026         W0026
     C                   MOVE      S0035         W0035
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVEB         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      'N'           WSENKL
     C                   MOVE      *BLANKS       WSTRNR
     C                   MOVE      *BLANKS       WSGN
     C                   MOVE      *BLANKS       WSGNSK
     C                   MOVE      *BLANKS       WSALSK
     C                   MOVE      *BLANKS       WSALS
     C                   MOVE      *BLANKS       WSALSS
     C                   MOVE      *BLANKS       WSGLSK
     C                   MOVE      *BLANKS       WSACTS
     C                   MOVE      *BLANKS       WSSKB
     C                   MOVE      *BLANKS       WSTSB
     C                   MOVE      *ZEROS        WSKN
     C                   MOVE      *BLANKS       WSNA
     C                   MOVE      *BLANKS       WSAD1
     C                   MOVE      *BLANKS       WSPN
     C                   MOVE      *BLANKS       WSPS
     C                   MOVE      *BLANKS       WSLK
     C                   MOVE      *BLANKS       WSSK
     C                   MOVE      *BLANKS       WSTIN
     C                   MOVE      *BLANKS       W0004
     C                   MOVE      *BLANKS       W0010
     C                   MOVE      *BLANKS       W0026
     C                   MOVE      *BLANKS       W0035
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDTRS        BEGSR
     C***********************************************
     C     WSAAVD        CHAIN     DKNSTD                             60
     C                   EXSR      MOVETR
     C   60              WRITE     DKNSTDR
     C  N60              UPDATE    DKNSTDR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVETR        BEGSR
     C***********************************************
     C                   MOVE      WSAAVD        TIAVD
     C                   MOVE      WSTDN         TITDN
     C                   MOVE      UDAY          TIDTD
     C                   MOVE      UMONTH        TIDTM
     C     UYEAR         ADD       2000          TIDTÅ
     C                   MOVE      WSENKL        TIENKL
     C                   MOVE      WSTRNR        TITRNR
     C                   MOVE      WSGN          TIGN
     C                   MOVE      WSGNSK        TIGNSK
     C                   MOVE      WSALSK        TIALSK
     C                   MOVE      WSALS         TIALS
     C                   MOVE      WSALSS        TIALSS
     C                   MOVE      WSGLSK        TIGLSK
     C                   MOVE      WSACTS        TIACTS
     C                   MOVE      WSSKB         TISKB
     C                   MOVE      WSTSB         TITSB
     C                   MOVE      WSKN          TIKN
     C                   MOVE      WSNA          TINA
     C                   MOVE      WSAD1         TIAD1
     C                   MOVE      WSPN          TIPN
     C                   MOVE      WSPS          TIPS
     C                   MOVE      WSLK          TILK
     C                   MOVE      WSSK          TISK
     C                   MOVE      WSTIN         TITIN
     C                   MOVE      W0004         S0004
     C                   MOVE      W0010         S0010
     C                   MOVE      W0026         S0026
     C                   MOVE      W0035         S0035
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * SPRÅKKODE TIL GODSNR
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     62
     C     POSNBR        ANDLE     63
     C                   MOVE      '012'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSGNSK        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGNSK
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVSENDERSLANDKODE
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     14
     C*                  CALL      'DKT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSALK = UKD
     C*                  END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      * SÖK AVTALT LAGRINGSSTED
      *
      * SPRÅKKODE TIL AVTALT LAGRINGSSTED
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSALSS        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGNSK
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * FREMLEGGELSES TOLLSTED
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSB         UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSB
     C                   Z-ADD     38            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE VED BESTEMMELSESTED
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     38
     C     POSNBR        ANDLE     39
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKB         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSKB
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * NÄRINGSLIV
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKN
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL NÄRINSLIV
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     13
     C*                  CALL      'DKT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLK = UKD
     C*                  END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL NÄRINGSLIV
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSK          UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSK
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    MODE              1
      *
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     DKK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C*    DKTKDK        KLIST
     C*                  KFLD                    DKKD_IE
     C*                  KFLD                    DKKD_TYP
     C*                  KFLD                    DKKD_KD
      *
     C                   MOVE      'A'           WSAUNI            1
     C*                  MOVE      'GCY'         DKKD_TYP
     C*                  MOVE      'A'           DKKD_IE
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        TIDT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   30
      *
     C                   ENDSR
      *
