/*  BYTTET GETPR2 MED GETPRN FOR DRAWER OG ANTAL.L KOPIER */
/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 11XXX * 01 YBC PTF11 *AFPDS PÅ DEVTYPE. INGEN MERKING                   */
/* ********************************************************************    */
             PGM
             DCL        VAR(&DRAWER) TYPE(*CHAR) LEN(7)
             DCL        VAR(&DRAWUT) TYPE(*CHAR) LEN(11)
             DCL        VAR(&COPIES)  TYPE(*CHAR) LEN(6)
             DCL        VAR(&PNAVN)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&LOGO)  TYPE(*CHAR) LEN(9)
             DCL        VAR(&ATYPE) TYPE(*CHAR) LEN(2) VALUE('kk')
             DCL        VAR(&FINS) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&AUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT) TYPE(*CHAR) LEN(10) /* Printernavn +
                          til fakturaer. */
             DCL        VAR(&PT) TYPE(*CHAR) LEN(10) /* Papirtype til +
                          fakturaer. */
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
             DCL        VAR(&MSGTXT) TYPE(*CHAR) LEN(12) /* +
                          Meldingtekst */

             DCL        VAR(&LASER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&FAKT) TYPE(*DEC) LEN(3 0) VALUE(013) /* KJ.KVITT */
             DCL        VAR(&LPI2) TYPE(*DEC) LEN(2 0)
    /* */
 RTVTIME:    RTVJOBA    USER(&AUSER)
             RTVDTAARA  DTAARA(*LDA (861 10)) RTNVAR(&PRT)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PT)
             RTVDTAARA  DTAARA(*LDA (15 4)) RTNVAR(&AVD)
             CALL       PGM(GETPRN) PARM(&AVD &FAKT &PNAVN &FORM +
                          &LASER &LPI2 &DRAWER &COPIES &LOGO &DRAWUT)

             IF         COND(&LASER *NE 'P') THEN(DO)

             OVRPRTF    FILE(SYFK40PF) DEV(&PRT) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) OVRFLW(60) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             OVRPRTF    FILE(SYFK40P2) DEV(&PRT) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) OVRFLW(57) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             ENDDO

    /*                                    */
    /* SLUTT PÅ IKKE PDF                  */
    /*                                    */
    /*                                    */
    /* START FOR PDF DOKUMENTER           */
    /*                                    */

             IF         COND(&LASER = 'P') THEN(DO)
/* */
             OVRPRTF    FILE(SYFK40PF) DEV(&PRT) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) OVRFLW(60) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FNTCHRSET(*LIBL/C0D0GT10 *LIBL/T1V10277) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             OVRPRTF    FILE(SYFK40P2) DEV(&PRT) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) OVRFLW(57) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&COPIES)
             ENDDO
    /* SLUTT PÅ PDF                  */

    /* START FOR AFP DOKUMENTER           */
    /*                                    */
             IF         COND(&LASER = 'F') THEN(DO)
             OVRPRTF    FILE(SYFK40PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) FRONTMGN(0.0 0.30) OVRFLW(60) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&PT) +
                          COPIES(&COPIES)
             OVRPRTF    FILE(SYFK40P2) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) FRONTMGN(0.0 0.10) OVRFLW(57) +
                          DRAWER(&DRAWER) OUTBIN(&DRAWUT) +
                          FRONTOVL(&LOGO) OUTQ(&PRT) FORMTYPE(&COPIES)
             ENDDO
    /* SLUTT PÅ AFP                  */

    /*            */
             OVRMSGF    MSGF(QUSERMSG) TOMSGF(SYMSGF)
             CALL       PGM(SYFA40) PARM(&PRANT)
             CHGVAR     VAR(&MSGTXT) VALUE(&PRANT *CAT &PRT)
             SNDPGMMSG  MSGID(DIV0228) MSGF(SYMSGF) MSGDTA(&MSGTXT)
             SBMJOB     CMD(CALL PGM(ARC002CL) PARM(&ATYPE &AUSER +
                          &FINS)) JOB(ARKIV) JOBD(*USRPRF) +
                          JOBQ(SYJOBQARK)
             ENDPGM
