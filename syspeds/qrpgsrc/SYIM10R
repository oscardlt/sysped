********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 ta med sader uten headf oppdrag
10XXX * 02 SH  PTF10 ta med lagerkode
10XXX * 03 SH  PTF10 ta bort punktum
10XXX * 04 SH  PTF11 emnerubrikk 70 lang
10XXX * 05 SH  PTF11 nye felt
10XXX * 06 SH  PTF11 feil indikator brukt i PTF 05
********************************************************************
      **************************************************************
      *** PROGRAM for utskrift av tollagerregnskap               ***
      **************************************************************
N05  FTURER14   IF   E           K DISK
     FSAEH6B    IF   E           K DISK
N01  FSADH6B    IF   E           K DISK
N01  F                                     RENAME(SADHR:SADHR6)
     FCUNDL01   IF   E           K DISK
     FHEAD18    IF   E           K DISK
N01  FHEADF     IF   E           K DISK
N01  F                                     RENAME(HEADFR:HEADFRF)
     FSADH      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYIM10P   O    E             PRINTER OFLIND(*IN02)
     FSYIM10F   O  a E             DISK
     FSYIM10D   CF   E             WORKSTN
     D                 DS
     D  WSGNFR                 1     15
     D  WSGNFA                 1      4
     D  WSGNFB                 5      9
     D  WSGNFC                10     12
     D  WSGNFD                13     15
     D                 DS
     D  hegn                   1     15
     D  hegn16                 1     16
N01  D                 DS
N01  D  sirg                   1     11
N01  D  sirg1011              10     11
N01  D                 DS
N01  D  syrg                   1     14
N01  D  syrg1011              10     11
     D                 DS
     D  WSGNTI                 1     15
     D  WSGNTA                 1      4
     D  WSGNTB                 5      9
     D  WSGNTC                10     12
     D  WSGNTD                13     15
     D                 DS
     D  DSTID                  1     14  0
     D  DSCENT                11     14  0
     D                 DS
     D  Z                      1     20
     D                                     DIM(10)
     D  ZOT01                  1      2
     D  ZOT02                  3      4
     D  ZOT03                  5      6
     D  ZOT04                  7      8
     D  ZOT05                  9     10
     D  ZOT06                 11     12
     D  ZOT07                 13     14
     D  ZOT08                 15     16
     D  ZOT09                 17     18
     D  ZOT10                 19     20
      *_____
      * Init
      *"""""
     C*
     C     *ENTRY        PLIST
     C                   PARM                    EPOST            70
     C                   PARM                    UIN01             1
s04  C*                  PARM                    COV01            40
n04  C                   PARM                    COV01            70
     C                   PARM                    COV02            40
     C                   PARM                    COV03            40
     C                   PARM                    COV04            40
     C                   PARM                    COV05            40
     C                   PARM                    COV06            40
     C                   PARM                    COV07            40
     C                   PARM                    COV08            40
     C                   PARM                    WSPRIN           10
     c                   parm                    wssdv             1
     C*
s03  c*                  move      '.'           hegn16
     C                   TIME                    DSTID            14 0
     C                   MOVE      DSCENT        WSGNFA
     C                   MOVE      DSCENT        WSGNTA
     C*
     C                   READ      FIRM                                   34
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   SETOFF                                       303536
     C                   SETOFF                                       37
     C   04              DO
     C                   EXSR      SØKUNR
     C                   GOTO      START
     C                   END
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C     WSKUND        IFNE      *ZEROS
     C                   MOVE      WSKUND        KUNDNR
     C     KUNKEY        CHAIN     CUNDL01                            35
     C                   MOVE      KNAVN         KNAVNS
     C   35              MOVE      'SPK0001'     MSGNR
     C   35              SETON                                        30
     C   35              GOTO      START
     C                   END
      *
      * EPOSTADRESSE MÅ TASTES
      *
     C     EPOST         IFEQ      *BLANKS
     C     WSPRIN        ANDEQ     *BLANKS
     C                   SETON                                        36
     C                   MOVE      'SHU0723'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C                   END
      *
      * TESTER GODSNUMMER
      *
     C     WSGNFR        IFGT      WSGNTI
     C                   SETON                                        37
     C                   MOVE      'SHU0724'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C                   END
     C  N10              GOTO      START
     C*
     C     EPOST         IFNE      *BLANKS
     C                   MOVE      ' '           FUNK
     C                   CALL      'EPOCVP'
s04  C*                  PARM                    COV01            40
n04  C                   PARM                    COV01            70
     C                   PARM                    COV02            40
     C                   PARM                    COV03            40
     C                   PARM                    COV04            40
     C                   PARM                    COV05            40
     C                   PARM                    COV06            40
     C                   PARM                    COV07            40
     C                   PARM                    COV08            40
     C                   PARM                    FUNK              1
     C     FUNK          CABEQ     'A'           START
     C                   END
     C*
     c     wssdv         ifne      'J'
     C                   WRITE     HEAD
     c                   end
     C                   EXSR      PRINT
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      *-------------------------------------------------------
     C     PRINT         BEGSR
      *-------------------------------------------------------
      *
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     FRAKEY        KLIST
     C                   KFLD                    WSGNFR
     C     SADKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C*                  SORTA     Z
     C     FRAKEY        SETLL     HEAD18
     C     *IN33         DOWEQ     '0'
     C     NESTE         TAG
     C                   READ      HEAD18                                 33
     C  N33WSGNTI        COMP      HEGN                                 33
      *
      * brudd godsnummer
      *
N01  C   33              EVAL      HEGN='999999999999999'
N01  C     FORIGE        IFNE      *BLANKS
N01  C     FORIGE        ANDNE     HEGN
N01  C                   EXSR      PRINT2
N01  C                   MOVE      *BLANKS       FORIGE
N01  C                   READP     HEAD18                                 33
N01  C                   READ      HEAD18                                 33
     C  N33WSGNTI        COMP      HEGN                                 33
N01  C                   END
     C  N33ZOT01         IFNE      '  '
     C     HEOT          LOOKUP    Z                                      44
     C   44              GOTO      NESTE
     C                   END
      *
     C     *IN33         IFEQ      '0'
N01  C
     C     *IN02         IFEQ      '1'
     C     WSSDV         ANDNE     'J'
     C                   WRITE     HEAD2
     C                   SETOFF                                       02
     C                   END
N01  C                   CLEAR                   sadhr
N01  C                   MOVE      *blanks       sirg9
     C     SADKEY        CHAIN     SADH                               34
      * har ikke SAD
     C     *IN34         IFEQ      '1'
     C                   MOVE      HEKNK         KUNDNR
     C                   MOVE      HETLL         SITLL
     C                   MOVE      HETLE         SITLE
     C                   MOVE      *BLANKS       SIDTG
     C                   MOVEL     'IKKE SAD'    SIDTG
     C                   Z-ADD     HENT          ANT               5 0
     C                   Z-ADD     HEVKT         VEKT              7 0
N05  C                   MOVE      *BLANKS       SITRID
N05  C                   MOVEL     HEHAWB        SITRID
N05  C                   MOVE      'N'           XTUR              1
N05  C     HEUR          IFEQ      'H'
N05  C     HEPRO         andne     *zeros
N05  C     HEPRO         CHAIN     TURER14                            97
N05  C                   move      TUTRMA        HETRM
N05  c                   endif
N05  C     HETRM         IFNE      0
N05  C                   Z-ADD     HETRM         SITRM
N05  C* VED TRANSPORTMÅTE 16 HENTES TOLLSTED FRA TURER
N05  C                   MOVE      'N'           XTUR              1
N05  C     HETRM         IFEQ      16
N05  C     HEPRO         CHAIN     TURER14                            97
N05  C  N97              MOVE      'J'           XTUR
N05  C                   ELSE
N05  C     HEPRO         IFNE      0
S06  C*    HEPRO         CHAIN     TURER14                            33
S06  C* N33              MOVE      'J'           XTUR
N06  C     HEPRO         CHAIN     TURER14                            98
N06  C  N98              MOVE      'J'           XTUR
N05  C                   END
N05  C                   END
N05  C                   END
N05  C                   MOVE      HETRC         SIKDC
N05  C                   IF        XTUR = 'N'
N05  C                   MOVE      HETRI         SILKT
N05  C                   ELSE
N05  C     TULK          IFNE      *BLANKS
N05  C                   EVAL      SILKT  = TULK
N05  C                   ELSE
N05  C                   MOVE      HETRI         SILKT
N05  C                   ENDIF
N05  C     TUBILN        IFNE      *BLANKS
N05  C                   EVAL      SITRID = TUBILN
N05  C                   ENDIF
N05  C                   END
     C                   ELSE
      * har SAD
     C                   MOVE      SISG          HESG
     C                   Z-ADD     SINTK         ANT
     C                   Z-ADD     SIVKB         VEKT
     C                   MOVE      SIKNK         KUNDNR
     C                   END
     C     KUNKEY        CHAIN     CUNDL01                            35
      *
      * flytt hvis har ikke sad
      *
     C     *IN34         IFEQ      '1'
     C  N35              MOVE      KNAVN         SINAK
     C  N35              MOVE      *BLANKS       SIADK3
     C  N35              MOVEL     POSTNR        SIADK3
     C  N35              MOVE      ADR3          SIADK3
     C   35              MOVE      HENAK         SINAK
     C   35              MOVE      HEADK3        SIADK3
     C                   END
      * obs personnummer ikke til print
     C     *IN(34)       ifeq      '0'
     C     SIRG1011      IFEQ      *BLANKS
     C                   MOVEL     SIRG          SIRG9
     C                   else
     C  N35SYRG1011      IFEQ      *blanks
     C                   MOVEL     SYRG          SIRG9
     C                   END
     C                   END
     C                   END
      *
      * EVENTUELL SELEKTERING PÅ KUNDE
      *
     C     KUNDNR        IFNE      WSKUND
     C     WSKUND        ANDNE     *ZEROS
     C                   GOTO      NESTE
     C                   END
      *
     c     wssdv         ifne      'J'
     C                   WRITE     DET
     c                   else
     c                   write     syim10fr
     c                   end
     C     SITLL         IFEQ      *ZEROS
     C     SITLL         OREQ      *BLANKS
     C                   EXSR      EXPO
     C                   END
N01  C                   MOVE      SIGN          FORIGE           15
     C                   END
     C                   END
     C                   ENDSR
      *
N01   *-------------------------------------------------------
N01  C     PRINT2        BEGSR
N01   *-------------------------------------------------------
N01  C     HEAKEY        KLIST
N01  C                   KFLD                    SIAVD
N01  C                   KFLD                    SITDN
N01  C                   SETOFF                                       33
     C                   MOVE      *BLANKS       HEOT
N01  C     FORIGE        SETLL     SADH6B
N01  C     *IN33         DOWEQ     '0'
N01  C     NESTE2        TAG
N01  C     FORIGE        READE     SADH6B                                 33
N01  C  N33WSGNTI        COMP      SIGN                                 33
N01   *
N01  C     *IN33         IFEQ      '0'
N01  C     *IN02         IFEQ      '1'
N01  C     WSSDV         ANDNE     'J'
N01  C                   WRITE     HEAD2
N01  C                   SETOFF                                       02
N01  C                   END
N01  C     HEAKEY        CHAIN     HEADF                              34
N01  C  N34              GOTO      NESTE2
N01   * obs personnummer ikke til print
N01  C                   MOVE      *blanks       SIRG9
N01  C     SIRG1011      IFEQ      *BLANKS
N01  C                   MOVEL     SIRG          SIRG9
N01  C                   end
N01  C                   MOVE      SIKNK         KUNDNR
N01  C                   Z-ADD     SINTK         ANT               5 0
N01  C                   Z-ADD     SIVKB         VEKT              7 0
N01  C                   MOVE      SIAVD         HEAVD
N01  C                   MOVE      SITDN         HEOPD
N01  C                   MOVE      SISG          HESG
N01  C                   MOVEL     SIGN          HEGN
N01  C                   MOVEL     SIPOS         HEPOS1
N01  C     KUNKEY        CHAIN     CUNDL01                            35
N01  C  N35              MOVE      KNAVN         SINAK
N01  C   35              MOVE      HENAK         SINAK
N01   *
N01   * EVENTUELL SELEKTERING PÅ KUNDE
N01   *
N01  C     KUNDNR        IFNE      WSKUND
N01  C     WSKUND        ANDNE     *ZEROS
N01  C                   GOTO      NESTE2
N01  C                   END
N01   *
N01  c     wssdv         ifne      'J'
N01  C                   WRITE     DET
N01  c                   else
N01  c                   write     syim10fr
N01  c                   end
N01  C                   END
N01  C                   END
N01  C                   ENDSR
     C*******************************************************
     C     EXPO          BEGSR
     C*******************************************************
     C                   SETOFF                                       34
     C                   MOVEL     '*REKSPOR'    HEGNN
     C                   MOVE      'TERT*  '     HEGNN
     C     HEGN          SETLL     SAEH6B
     C     *IN34         DOWEQ     '0'
      *
      *
     C     HEGN          READE     SAEH6B                                 34
     C     *IN34         IFEQ      '0'
      * Overflow ?
     C     *IN02         IFEQ      '1'
     c     wssdv         andne     'J'
     C                   WRITE     HEAD2
     C                   MOVE      '0'           *IN02
     C                   END
     C                   MOVE      SEKNS         KUNDNR
     C                   MOVE      SENAS         SINAK
     C                   MOVE      SETLE         SITLE
     C                   MOVE      SETLL         SITLL
     C                   MOVE      SEDTG         SIDTG
     C                   Z-ADD     SENTK         ANT
     C                   Z-ADD     SEVKB         VEKT
     C                   Z-ADD     SEAVD         HEAVD
     C                   Z-ADD     SETDN         HEOPD
     C                   MOVE      SESG          HESG
     c     wssdv         ifne      'J'
     C                   WRITE     DET
     c                   else
     c                   write     syim10fr
     c                   end
     C                   END
     C                   END
     C                   ENDSR
     C***********************************************
     C     SØKUNR        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKUND
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C*
     C                   ENDSR
     C*
