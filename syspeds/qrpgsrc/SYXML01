********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 LENGDE PÅ PARAMETRE VED KALL PÅ SYXML01K
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SENDE XML-FAKTURA                      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-49 51-99                ***
      ***********************************************************
     FFIRM      IF   E           K DISK
     FXMLUFL1   UF   E           K DISK
     FXMLTILP   O  A E           K DISK    USROPN
     FECMSG     IF   E           K DISK    USROPN
     FKODWL01   IF   E           K DISK    USROPN
     FKODTA     IF   E           K DISK    USROPN
     FKODTGE    IF   E           K DISK    USROPN
     FKODTG2    IF   E           K DISK    USROPN
     FKODTLK    IF   E           K DISK    USROPN
     FKODTFR    IF   E           K DISK    USROPN
     FKODTOTY   IF   E           K DISK    USROPN
     FCUNDL01   IF   E           K DISK    USROPN
     FCUNDC01   IF   E           K DISK    USROPN
     FCUNDC03   IF   E           K DISK    USROPN
     F                                     RENAME(CUNDCR:CUNDCR03)
     F                                     PREFIX(C3_)
     FFAIN      IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FFAK8      IF   E           K DISK    USROPN
     FFRISOK    IF   E           K DISK    USROPN
     FKODFRI    IF   E           K DISK    USROPN
     FFREETXT2  IF   E           K DISK
     FARKIVL02  IF   E           K DISK    USROPN
     FARKTXT    IF   E           K DISK    USROPN
     FARKEXT    IF   E           K DISK    USROPN
     FFIRMARC   IF   E           K DISK    USROPN
     FKOFAST    IF   E           K DISK    USROPN
     FEDIC      UF A E             DISK    USROPN
     FEDIS      O  A E             DISK    USROPN
     FEDIM      O  A E             DISK    USROPN
     FEDISE     O  A E             DISK    USROPN
     D TABLITEN        S              1    DIM(26) CTDATA PERRCD(1) ASCEND
     D TABSTOR         S              1    DIM(26) ALT(TABLITEN)
     D TXT             S             80    DIM(260) CTDATA PERRCD(1)
     D TXT01           S             80    DIM(3) CTDATA PERRCD(1)
     D NCTXT           S             80    DIM(002) CTDATA PERRCD(1)
     D VEDL            S             70    DIM(900)
     D                 DS
     D  XTXT05                 1      5
     D  XT05                   1      5    DIM(5)
     D                 DS
     D  XTXT40                 1     40
     D  XT40                   1     40    DIM(40)
     D                 DS
     D  XTXT801                1     80
     D  XT801                  1     80    DIM(80)
     D                 DS
     D  XTXT802                1     80
     D  XT802                  1     80    DIM(80)
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  XMBR                   1     10
     D  XMBRA                  1      1
     D  XMBRB                  2     10S 0
     D                 DS
     D  WDT                    1      8
     D  WDTÅ                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  WTM                    1      6
     D  WTMH                   1      2
     D  WTMM                   3      4
     D  WTMS                   5      6
     D                 DS
     D  HEAVD                  1      4  0
     D  XXSTREKK1              5      5
     D  HEOPD                  6     12  0
     D  XXSTREKK2             13     13
     D  HESG                  14     16
     D  SYSPEDREF              1     16
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTOPÅ                1      4
     D  HEDTOPM                5      6
     D  HEDTOPD                7      8
     D                 DS
     D  FADATO                 1      8  0
     D  FADATOÅ                1      4
     D  FADATOM                5      6
     D  FADATOD                7      8
     D                 DS
     D  FADAFF                 1      8  0
     D  FADAFFÅ                1      4
     D  FADAFFM                5      6
     D  FADAFFD                7      8
     D                 DS
     D  SYKT8                  1      8
     D  SYFR02                 1      1
     D  SYKT7                  2      7
     D  SYKONT                 2      8  0
     D                 DS
     D  XMLT1                  1     44  2 DIM(11)
     D  XFMS01                 1      4  2
     D  XFMS02                 5      8  2
     D  XFMS03                 9     12  2
     D  XFMS04                13     16  2
     D  XFMS05                17     20  2
     D  XFMS06                21     24  2
     D  XFMS07                25     28  2
     D  XFMS08                29     32  2
     D  XFMS09                33     36  2
     D  XFMS10                37     40  2
     D  XFMS11                41     44  2
     D                 DS
     D  XMLT2                  1     33    DIM(11)
     D  XFMV01                 1      3
     D  XFMV02                 4      6
     D  XFMV03                 7      9
     D  XFMV04                10     12
     D  XFMV05                13     15
     D  XFMV06                16     18
     D  XFMV07                19     21
     D  XFMV08                22     24
     D  XFMV09                25     27
     D  XFMV10                28     30
     D  XFMV11                31     33
     D                 DS
     D  XMLT3                  1    143  2 DIM(11)
     D  XFMGN1                 1     13  2
     D  XFMGN2                14     26  2
     D  XFMGN3                27     39  2
     D  XFMGN4                40     52  2
     D  XFMGN5                53     65  2
     D  XFMGN6                66     78  2
     D  XFMGN7                79     91  2
     D  XFMGN8                92    104  2
     D  XFMGN9               105    117  2
     D  XFMGNA               118    130  2
     D  XFMGNB               131    143  2
     D                 DS
     D  XMLT4                  1    143  2 DIM(11)
     D  XFMGV1                 1     13  2
     D  XFMGV2                14     26  2
     D  XFMGV3                27     39  2
     D  XFMGV4                40     52  2
     D  XFMGV5                53     65  2
     D  XFMGV6                66     78  2
     D  XFMGV7                79     91  2
     D  XFMGV8                92    104  2
     D  XFMGV9               105    117  2
     D  XFMGVA               118    130  2
     D  XFMGVB               131    143  2
     D                 DS
     D  FSDOKK                 1     10
     D  DFS                    1     10    DIM(10)
     D                 DS
     D  SYRG                   1     14
     D  SYRG9                  1      9
     D                 DS
     D  NCTXT1                 1     15
     D  NCT1                   1     15    DIM(15)
     D                 DS
     D  NCTXT2                 1     10
     D  NCT2                   1     10    DIM(10)
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C     XMLUFL1K      SETLL     XMLUFL1
     C     XMLUFL1K      READE     XMLUFL1                                50
     C   50              GOTO      SLUTT
     C                   MOVE      'N'           XSINGEL           1
      *
     C                   EXSR      SRINIT
     C                   EXSR      SRBYGGF
      *
     C                   EXSR      SRSTART
     C                   DOW       *IN50 = *OFF
     C                   EXSR      SREMSG
     C                   IF        XFSAML = 'J'
     C                   LEAVE
     C                   END
     C                   MOVE      'J'           XSINGEL
     C     START2        TAG
     C     XMLUFL1K      READE     XMLUFL1                                50
     C  N50              IF        XFSAML = 'J'
     C                   UPDATE    XMLUFFR
     C                   GOTO      START2
     C                   END
     C  N50              ENDDO
     C                   EXSR      SRSLUTT
     C                   IF        ((*IN50 = *OFF) OR (XSINGEL = 'J'))
     C                   EXSR      SRCLOSE
     C                   END
     C                   EXSR      SRSEND
     C  N50              GOTO      START
     C     XSINGEL       CABEQ     'J'           START
      *
     C     SLUTT         TAG
     C                   IF        XXTYPE = 'POST'
     C                   EVAL      XXTYPE = 'POSTK'
     C                   GOTO      START
     C                   END
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SRINIT        BEGSR
      ***********************************************
     C                   OPEN      ECMSG
     C                   OPEN      KODWL01
     C                   OPEN      KODTA
     C                   OPEN      KODTGE
     C                   OPEN      KODTG2
     C                   OPEN      KODTFR
     C                   OPEN      KODTOTY
     C                   OPEN      KODTLK
     C                   OPEN      CUNDL01
     C                   OPEN      CUNDC01
     C                   OPEN      CUNDC03
     C                   OPEN      FAIN
     C                   OPEN      HEADF
     C                   OPEN      FAK8
     C                   OPEN      FRISOK
     C                   OPEN      KODFRI
     C                   OPEN      ARKIVL02
     C                   OPEN      ARKTXT
     C                   OPEN      ARKEXT
     C                   OPEN      FIRMARC
     C                   OPEN      KOFAST
     C                   OPEN      EDIC
     C                   OPEN      EDIS
     C                   OPEN      EDIM
     C                   OPEN      EDISE
      *
     C     ECMSGK        CHAIN     ECMSG                              33
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
      *
     C                   MOVE      XFKN          XXKN              8 0
     C                   MOVE      *BLANKS       XXA80            80
     C                   MOVE      *ZEROS        XNPOS             3 0
     C                   MOVE      *BLANKS       XMBR
     C                   MOVE      'F'           XMBRA
     C                   MOVE      CSN           XMBRB
     C                   MOVE      XMBR          SEMBR
     C                   MOVE      *BLANKS       SDATA
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM
      *
     C                   EVAL      S0004 = ECIIDI
     C                   EVAL      S0010 = ECIIDC
     C                   EVAL      S0020 = SEMBR
     C                   EVAL      S0036 = 0
     C                   EVAL      S0026 = 'XML-INV. POST'
     C                   EVAL      SSN   = CSN
     C                   EVAL      SSR   = 'S'
     C                   EVAL      SST   = 'X'
     C                   MOVE      WDT           SDT
     C                   MOVE      WTM           STM
     C                   EVAL      SLIB  = '*LIBL'
     C                   EVAL      SFILE = 'EDISE'
     C                   EVAL      SMBR  = SEMBR
     C                   EVAL      SMBRS  = 0
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRBYGGF       BEGSR
      ***********************************************
     C                   CALL      'SYXML01B'
     C                   OPEN      XMLTILP
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSTART       BEGSR
      ***********************************************
     C                   EVAL      SDATA = TXT(001)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(002)
     C                   CAT       '>':0         SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(004)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(005)
     C                   EXSR      TILFIL
      * Orginator
     C                   EVAL      SDATA = TXT(006)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(008)
     C                   CAT       S0004:0       SDATA
     C                   CAT       TXT(009):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(010)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(013)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(014):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(007)
     C                   EXSR      TILFIL
      * Recipient (alltid Posten)
     C                   EVAL      SDATA = TXT(015)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(008)
     C                   CAT       S0010:0       SDATA
     C                   CAT       TXT(009):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(011)
     C                   CAT       'eFaktura':0  SDATA
     C                   CAT       TXT(012):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(013)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(014):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(016)
     C                   EXSR      TILFIL
      * InterchangeID
     C                   EVAL      SDATA = TXT(017)
     C                   CAT       SEMBR:0       SDATA
     C                   CAT       TXT(018):0    SDATA
     C                   EXSR      TILFIL
      * InterchangeTime
     C                   EVAL      SDATA = TXT(019)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(021)
     C                   CAT       'year="':1    SDATA
     C                   CAT       WDTÅ:0        SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       WDTM:0        SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       WDTD:0        SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       WDTÅ:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTM:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTD:0        SDATA
     C                   CAT       TXT(022):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(023)
     C                   CAT       'hour="':1    SDATA
     C                   CAT       WTMH:0        SDATA
     C                   CAT       '" minute="':0SDATA
     C                   CAT       WTMM:0        SDATA
     C                   CAT       '" second="':0SDATA
     C                   CAT       WTMS:0        SDATA
     C                   CAT       '" fraction':0SDATA
     C                   CAT       '="050">':0   SDATA
     C                   CAT       WTMH:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMM:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMS:0        SDATA
     C                   CAT       TXT(024):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(020)
     C                   EXSR      TILFIL
      * ReceiptNotificationRequest
     C                   EVAL      SDATA = TXT(253)
     C                   CAT       'YES':0       SDATA
     C                   CAT       TXT(254):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREMSG        BEGSR
      ***********************************************
     C                   MOVE      XFFN          FIFN
     C     FIFN          SETLL     FAIN
     C                   EXSR      HENTOPD
      * eMessage start
     C                   EVAL      SDATA = TXT(025)
     C                   EXSR      TILFIL
      * MessageType
     C                   EVAL      SDATA = TXT(027)
     C                   CAT       'Invoice':0   SDATA
     C                   CAT       TXT(028):0    SDATA
     C                   EXSR      TILFIL
      * MessageVersion
     C                   EVAL      SDATA = TXT(029)
     C                   CAT       'PS-14':0     SDATA
     C                   CAT       TXT(030):0    SDATA
     C                   EXSR      TILFIL
      * DokumentType
     C                   EVAL      SDATA = TXT(031)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(033)
     C                   IF        XFFK = 'F'
     C                   CAT       '380':0       SDATA
     C                   ELSE
     C                   CAT       '381':0       SDATA
     C                   END
     C                   CAT       TXT(034):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(035)
     C                   IF        XFFK = 'F'
     C                   CAT       'FAKTURA':0   SDATA
     C                   ELSE
     C                   CAT       'KREDITNOTA':0SDATA
     C                   END
     C                   CAT       TXT(036):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(032)
     C                   EXSR      TILFIL
      * MessageReferance
     C                   EXSR      OPDEDIM
      *
     C                   EVAL      SDATA = TXT(037)
     C                   MOVE      MMN           XXA09             9
     C                   CAT       XXA09:0       SDATA
     C                   CAT       TXT(38):0     SDATA
     C                   EXSR      TILFIL
      * MessageOriginator
     C                   EVAL      SDATA = TXT(039)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(008)
     C     KODTAKX       CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        KUNDNR
     C                   Z-ADD     20000000      KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   CAT       '932725967':0 SDATA
     C                   MOVE      '982813085'   NCV06             9
     C                   CAT       TXT(009):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(010)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(013)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(014):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(040)
     C                   EXSR      TILFIL
      * MessageRecipient
     C                   EVAL      SDATA = TXT(041)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(008)
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C  N33              DOW       FAOPKO = 'D'
     C     FAK8K         READE     FAK8                                   33
     C                   ENDDO
     C                   MOVE      FAKUNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   CAT       SYRG:0        SDATA
     C                   CAT       TXT(009):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(011)
     C                   CAT       'CAP':0       SDATA
     C                   CAT       TXT(012):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(013)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(014):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(042)
     C                   EXSR      TILFIL
      * FormatOption
     C                   EVAL      SDATA = TXT(255)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(257)
     C                   EXSR      TILFIL
     C                   IF        XFSAML = 'J'
     C                   EVAL      C3_CTYPE = '*XML FAKTURA SAM'
     C                   ELSE
     C                   EVAL      C3_CTYPE = '*XML FAKTURA SIN'
     C                   END
     C     CUNDC03K      CHAIN     CUNDC03                            33
     C  N33              DOW       C3_CPHONE <> 'POST'
     C     CUNDC03K      READE     CUNDC03                                33
     C  N33              ENDDO
     C  N33C3_CMOBIL     COMP      'EDI'                              3333
     C  N33              MOVE      'EDI'         XAN03             3
     C   33              MOVE      'PRT'         XAN03
     C                   EVAL      SDATA = TXT(259)
     C                   CAT       'name="':1    SDATA
     C                   CAT       'Channel"':0  SDATA
     C                   CAT       'value="':1   SDATA
     C                   CAT       XAN03:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       TXT(260):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(258)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(256)
     C                   EXSR      TILFIL
      * ProcessInstructions
     C                   EVAL      SDATA = TXT(236)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(238)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(240)
     C                   CAT       'value="':1   SDATA
     C                   IF        XFSAML = 'N'
     C                   IF        XFFK = 'F'
     C                   IF        ((SPRAAK = *BLANKS) OR (SPRAAK = 'NO'))
     C                   CAT       '38001NO"':0  SDATA
     C                   ELSE
     C                   CAT       '38001E"':0   SDATA
     C                   END
     C                   ELSE
     C                   IF        ((SPRAAK = *BLANKS) OR (SPRAAK = 'NO'))
     C                   CAT       '38101NO"':0  SDATA
     C                   ELSE
     C                   CAT       '38101E"':0   SDATA
     C                   END
     C                   END
     C                   ELSE
     C                   IF        ((SPRAAK = *BLANKS) OR (SPRAAK = 'NO'))
     C                   CAT       '38006NO"':0  SDATA
     C                   ELSE
     C                   CAT       '38006E"':0   SDATA
     C                   END
     C                   END
     C                   CAT       'name="Lay':1 SDATA
     C                   CAT       'outId"/>':0  SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(239)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(237)
     C                   EXSR      TILFIL
      * MessageAttachments
     C                   EXSR      SREATTACH
      * MessageContant start
     C                   EVAL      SDATA = TXT(043)
     C                   EXSR      TILFIL
      *
     C                   MOVE      *ZEROS        XXANTOPD          5 0
     C     STSREMSG1     TAG
     C     HEADFK        CHAIN     HEADF                              33
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C  N33              DOW       FAOPKO = 'D'
     C     FAK8K         READE     FAK8                                   33
     C  N33              ENDDO
     C                   IF        *IN33
     C                   EXSR      HENTOPD
     C   33              GOTO      SLSREMSG1
     C                   GOTO      STSREMSG1
     C                   END
     C                   IF        FAVAL = *BLANKS
     C                   EVAL      FAVAL = FICURR
     C                   END
      * Invoice start
     C                   EXSR      SREINVST
      *
     C                   IF        XFSAML = 'N'
     C                   EXSR      SRDET
     C                   ELSE
     C                   EXSR      SRDETS
     C                   END
      * Invoice slutt
     C                   EXSR      SREINVSL
      *
      * MessageContant slutt
     C     SLSREMSG1     TAG
     C                   EVAL      SDATA = TXT(044)
     C                   EXSR      TILFIL
      * eMessage slutt
     C                   EVAL      SDATA = TXT(026)
     C                   EXSR      TILFIL
      * Oppdater XMLUFF
     C                   MOVE      'C'           XFST
     C                   MOVE      WDT           XFDTS
     C                   MOVE      WTM           XFTDS
     C                   UPDATE    XMLUFFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREATTACH     BEGSR
      ***********************************************
     C                   MOVE      'N'           XATTA             1
     C                   MOVE      *BLANKS       VEDL
      *
     C     STATTACH1     TAG
     C     ARKIVL02K     SETLL     ARKIVL02
     C     STATTACH2     TAG
     C     ARKIVL02K     READE     ARKIVL02                               33
      *
     C  N331             DO        900           XN03              3 0
     C                   SELECT
     C                   WHEN      VEDL(XN03) = *BLANKS
     C                   EVAL      VEDL(XN03) = ARLINK
     C                   LEAVE
     C                   WHEN      VEDL(XN03) = ARLINK
     C                   GOTO      STATTACH2
     C                   ENDSL
     C                   ENDDO
      *
     C                   IF        *IN33 = *OFF                                 1<-B
     C     XATTA         CABEQ     'J'           STATTACH3
     C                   MOVE      'J'           XATTA
      * MessegeAttachments start
     C                   EVAL      SDATA = TXT(222)
     C                   EXSR      TILFIL
      * AttachmentIdicator
     C                   EVAL      SDATA = TXT(247)
     C                   CAT       'YES':0       SDATA
     C                   CAT       TXT(248):0    SDATA
     C                   EXSR      TILFIL
      * Attachment start
     C                   EVAL      SDATA = TXT(224)
     C                   CAT       'type="ZIP':1 SDATA
     C                   CAT       'ARCHIVE">':0 SDATA
     C                   EXSR      TILFIL
      * AttachmentNumber
     C                   EVAL      SDATA = TXT(226)
     C                   CAT       '1':0         SDATA
     C                   CAT       TXT(227):0    SDATA
     C                   EXSR      TILFIL
      * CopyIndicator
     C                   EVAL      SDATA = TXT(228)
     C                   CAT       'NO':0        SDATA
     C                   CAT       TXT(229):0    SDATA
     C                   EXSR      TILFIL
      * AttachmentType
     C                   EVAL      SDATA = TXT(230)
     C                   CAT       'applicati':0 SDATA
     C                   CAT       'on/pdf':0    SDATA
     C                   CAT       TXT(231):0    SDATA
     C                   EXSR      TILFIL
      * AttachmentName
     C                   EVAL      SDATA = TXT(232)
     C                   MOVE      *BLANKS       XAN20            20
     C                   CAT       XMBR:0        SDATA
     C                   CAT       '.pdf':0      SDATA
     C                   CAT       TXT(233):0    SDATA
     C                   EXSR      TILFIL
      * Attachment slutt
     C                   IF        XFSAML <> 'J'
     C                   EVAL      SDATA = TXT(225)
     C                   EXSR      TILFIL
     C                   END
      *
     C                   MOVE      *ZEROS        XN032             3 0
S01  C*                  MOVE      *BLANKS       XDOK1            70
S01  C*                  MOVE      *BLANKS       XDOK2            70
S01  C*                  MOVE      *BLANKS       XKAT             70
N01  C                   MOVE      *BLANKS       XDOK1           120
N01  C                   MOVE      *BLANKS       XDOK2           120
N01  C                   MOVE      *BLANKS       XKAT            120
     C                   IF        XXTYPE = 'POSTK'
     C                   EVAL      XKAT = '/TILPOSTEN/TESTER'
     C                   ELSE
     C                   EVAL      XKAT = '/TILPOSTEN/'
     C                   END
     C                   CAT       XMBR:0        XKAT
     C     STATTACH3     TAG
     C                   DOU       *IN33                                         2<-B
      * Kopier vedlegg til katalog TILPOSTEN/VEDLEGG
     C     ARTYPE        CHAIN     ARKTXT                             33
     C                   IF        ARKLAG = *BLANKS
     C     ARFIRM        CHAIN     FIRMARC                            33
     C                   ELSE
     C     ARKEXTK       CHAIN     ARKEXT                             33
     C                   END
     C                   MOVEL     ARCANE        XAN01             1
     C                   IF        XAN01 = '/'
     C                   EVAL      XDOK1 = ARCANE
     C                   ELSE
     C                   EVAL      XDOK1 = '/' + %TRIM(ARCANE)
     C                   END
     C                   CAT       '/':0         XDOK1
     C                   CAT       ARLINK:0      XDOK1
     C                   EVAL      XDOK2 = XKAT
     C                   CAT       '/':0         XDOK2
     C                   MOVEL     FIFN          XFNAN             7
     C                   CAT       XFNAN:0       XDOK2
     C                   CAT       '_':0         XDOK2
     C                   ADD       1             XN032
     C                   MOVE      XN032         XAN03             3
     C                   CAT       XAN03:0       XDOK2
     C                   CAT       '.pdf':0      XDOK2
     C                   CALL      'SYXML01K'
     C                   PARM                    XKAT
     C                   PARM                    XDOK1
     C                   PARM                    XDOK2
      *
     C     STATTACH4     TAG
     C     ARKIVL02K     READE     ARKIVL02                               33
      *
     C  N331             DO        900           XN03              3 0
     C                   SELECT
     C                   WHEN      VEDL(XN03) = *BLANKS
     C                   EVAL      VEDL(XN03) = ARLINK
     C                   LEAVE
     C                   WHEN      VEDL(XN03) = ARLINK
     C                   GOTO      STATTACH4
     C                   ENDSL
     C                   ENDDO
      *
     C  N33              ENDDO                                                   2<-E
      * MessegeAttachments slutt
     C                   IF        XFSAML <> 'J'
     C                   EVAL      SDATA = TXT(223)
     C                   EXSR      TILFIL
     C                   END
      *
     C                   EXSR      HENTOPD
     C  N33              GOTO      STATTACH1
     C     FIFN          SETLL     FAIN
     C                   EXSR      HENTOPD
      *
     C                   ELSE                                                   1
     C                   EXSR      HENTOPD
     C  N33              GOTO      STATTACH1
      *
     C                   END                                                    1<-E
      *
     C                   IF        ((XFSAML = 'J') AND (XATTA = 'J'))
     C                   EVAL      SDATA = TXT(225)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(223)
     C                   EXSR      TILFIL
     C                   END
      *
     C     FIFN          SETLL     FAIN
     C                   EXSR      HENTOPD
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREINVST      BEGSR
      ***********************************************
      * Invoice start
     C                   EVAL      SDATA = TXT(045)
     C                   EXSR      TILFIL
      * InvoiceDates
     C                   EVAL      SDATA = TXT(047)
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(049)
     C                   CAT       'year="':1    SDATA
     C                   CAT       FADATOÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       FADATOM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       FADATOD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       FADATOÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADATOM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADATOD:0     SDATA
     C                   CAT       TXT(050):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(051)
     C                   CAT       'year="':1    SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       TXT(052):0    SDATA
     C                   EXSR      TILFIL
      * OrderDate
     C                   IF        XFSAML = 'N'
     C                   EVAL      SDATA = TXT(210)
     C                   CAT       'year="':1    SDATA
     C                   CAT       HEDTOPÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       HEDTOPM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       HEDTOPD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       HEDTOPÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       HEDTOPM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       HEDTOPD:0     SDATA
     C                   CAT       TXT(211):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      *
     C                   EVAL      SDATA = TXT(048)
     C                   EXSR      TILFIL
      * InvoiceReferance start
     C                   EVAL      SDATA = TXT(053)
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(055)
     C                   MOVE      FIFN          XXA07             7
     C                   CAT       XXA07:0       SDATA
     C                   CAT       TXT(056):0    SDATA
     C                   EXSR      TILFIL
      * Kontraktnummer i RequisitionNo
     C                   EVAL      SDATA = TXT(218)
     C                   CAT       '4600005889':0SDATA
     C                   CAT       TXT(219):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   IF        XFSAML = 'N'
     C                   MOVE      *BLANKS       XÅRSPO           30
     C                   EXSR      SREINVREF
     C                   ELSE
      * Års PO i BuyerOrderNo
     C     CUNDC01K      SETLL     CUNDC01
     C     CUNDC01K      READE     CUNDC01                                33
     C                   DOW       *IN33 = *OFF
     C                   IF        CTYPE = '*PO*'
     C                   LEAVE
     C                   END
     C     CUNDC01K      READE     CUNDC01                                33
     C  N33              ENDDO
     C                   IF        *IN33
     C                   EVAL      CCONTA = 'INGEN ÅRS PO'
     C                   END
     C                   EVAL      SDATA = TXT(216)
     C                   CAT       CCONTA:0      SDATA
     C                   CAT       TXT(217):0    SDATA
     C                   EXSR      TILFIL
     C                   MOVE      ADR1          XÅRSPO           30
     C                   END
      * InvoiceReferance slutt
     C                   EVAL      SDATA = TXT(054)
     C                   EXSR      TILFIL
      *
     C                   IF        XFFK = 'K'
     C                   GOTO      STPARTIES
     C                   END
      * PaymentInfo start
     C                   EVAL      SDATA = TXT(057)
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(059)
     C                   CAT       XFBB:0        SDATA
     C                   CAT       TXT(060):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(061)
     C                   CAT       XFBBT:0       SDATA
     C                   CAT       TXT(062):0    SDATA
     C                   EXSR      TILFIL
      * PaymentAccountInfo start
     C                   EVAL      SDATA = TXT(063)
     C                   EXSR      TILFIL
      * AccountNumber
     C                   EVAL      SDATA = TXT(065)
     C                   CAT       XFKT:0        SDATA
     C                   CAT       TXT(066):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   IF        ((XFVAL <> *BLANKS) AND (XFVAL <> 'NOK'))
      * Swiftcode
     C                   EVAL      SDATA = TXT(243)
     C                   CAT       'NDEANOKK':0  SDATA
     C                   CAT       TXT(244):0    SDATA
     C                   EXSR      TILFIL
      * IBANcode
     C                   EVAL      SDATA = TXT(245)
     C                   IF        XFVAL = 'EUR'
     C                   CAT       'NO81602604':0SDATA
     C                   CAT       '47362':0     SDATA
     C                   ELSE
     C                   CAT       'NO47601004':0SDATA
     C                   CAT       '41430':0     SDATA
     C                   END
     C                   CAT       TXT(246):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   END
      *
      * BankName
     C                   EVAL      SDATA = TXT(220)
     C                   CAT       'HANDELS':0   SDATA
     C                   CAT       'BANKEN':0    SDATA
     C                   CAT       TXT(221):0    SDATA
     C                   EXSR      TILFIL
      * PaymentAccountInfo slutt
     C                   EVAL      SDATA = TXT(064)
     C                   EXSR      TILFIL
      * PaymentDueDate
     C                   EVAL      SDATA = TXT(67)
     C                   CAT       'year="':1    SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       TXT(068):0    SDATA
     C                   EXSR      TILFIL
      * PaymentAmount
     C                   EVAL      SDATA = TXT(069)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   Z-ADD     XFTOT         ØN152
     C                   MOVE      'J'           XBELØP            1
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(070):0    SDATA
     C                   EXSR      TILFIL
      * Kid
     C                   EVAL      SDATA = TXT(071)
     C                   CAT       XFKID:0       SDATA
     C                   CAT       TXT(072):0    SDATA
     C                   EXSR      TILFIL
      * CheckDigit
     C*                  Z-ADD     21            XN
     C*                  EVAL      SDATA = XFKID
     C*                  DOW       XN > 1
     C*                  IF        A80(XN) <> ' '
     C*                  MOVE      A80(XN)       XXA01             1
     C*                  LEAVE
     C*                  END
     C*                  EVAL      XN = XN - 1
     C*                  ENDDO
     C*                  EVAL      SDATA = TXT(073)
     C*                  CAT       XXA01:0       SDATA
     C*                  CAT       TXT(074):0    SDATA
     C*                  EXSR      TILFIL
      * PaymentInfo slutt
     C                   EVAL      SDATA = TXT(058)
     C                   EXSR      TILFIL
      *
     C                   IF        XFSAML = 'N'
     C                   EXSR      SRDELIVERY
     C                   END
      *
      * Parties
     C     STPARTIES     TAG
     C                   EXSR      SRPARTST
     C                   MOVE      'H'           XNIVÅ             1
     C                   EXSR      SRPART1
     C                   IF        XFSAML = 'N'
     C                   EXSR      SRPART2
     C                   END
     C                   EXSR      SRPARTSL
      * Summery
     C                   EXSR      SRSUM
      * FreeText
     C                   IF        XFSAML = 'N'
     C                   EXSR      SRFRTEKST
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREINVSL      BEGSR
      ***********************************************
      * Invoice slutt
     C                   EVAL      SDATA = TXT(046)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREINVREF     BEGSR
      ***********************************************
      * BuyerOrderNo
     C                   EVAL      SDATA = TXT(216)
     C                   MOVE      'PO '         XFSKODE
     C     FRISOKK       CHAIN     FRISOK                             33
     C                   IF        *IN33 = *OFF
     C                   CAT       FSSOK:0       SDATA
     C                   ELSE
     C                   MOVE      'N'           NCV01             1
     C                   IF        ((HEUR = 'C') OR (HEUR = 'D'))
     C                   MOVEL     HEGM1         NCV02             2
     C                   IF        ((NCV02 = 'PO') OR (NCV02 > '00'))
     C                   IF        NCV02 = 'PO'
     C                   Z-ADD     3             NCV04             3 0
     C                   ELSE
     C                   Z-ADD     1             NCV04             3 0
     C                   END
     C                   MOVEL     HEGM1         NCTXT1
     C     NCV04         DO        15            NCV03             3 0
     C                   IF        ((NCT1(NCV03)>='0') AND (NCT1(NCV03)<='9'))
     C                   LEAVE
     C                   END
     C                   ENDDO
     C                   IF        NCV03 < 7
     C                   MOVE      'J'           NCV01
     C                   MOVEA     NCT1(NCV03)   NCT2(1)
     C                   CAT       NCTXT2:0      SDATA
     C                   ELSE
     C                   CAT       HERFA:0       SDATA
     C                   END
     C                   ELSE
     C                   EVAL      XTXT801 = HERFA
     C                   Z-ADD     25            XN53              3 0
     C                   CAT       XTXT802:0     SDATA
     C                   END
     C                   ELSE
     C                   EVAL      XTXT801 = HERFA
     C                   Z-ADD     25            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   END
     C                   END
     C                   CAT       TXT(217):0    SDATA
     C                   EXSR      TILFIL
      * DispatchAdviceNo
     C                   IF        NCV01 = 'J'
     C                   IF        HEGM2 <> *BLANKS
     C                   EVAL      SDATA = TXT(201)
     C                   EVAL      XTXT801 = HEGM2
     C                   Z-ADD     25            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(202):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   ELSE
     C                   IF        HEGM1 <> *BLANKS
     C                   EVAL      SDATA = TXT(201)
     C                   EVAL      XTXT801 = HEGM1
     C                   Z-ADD     25            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   IF        HEGM2 <> *BLANKS
     C                   CAT       ',':0         SDATA
     C                   EVAL      XTXT801 = HEGM2
     C                   Z-ADD     25            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   END
     C                   CAT       TXT(202):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   END
      * OtherReferance start
     C                   EVAL      SDATA = TXT(183)
     C                   EXSR      TILFIL
      * Oppdragstype
     C     KODTOTYK      CHAIN     KODTOTY                            33
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Oppd':1SDATA
     C                   CAT       'ragsType">':0SDATA
     C                   CAT       HEOT:0        SDATA
     C                   CAT       ',':0         SDATA
     C                   IF        SPRAAK = ' '
     C                   EVAL      XTXT801 = KO1NTX
     C                   Z-ADD     39            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   ELSE
     C                   EVAL      XTXT801 = KO1ETX
     C                   Z-ADD     39            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   END
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Godsnr
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Gods':1SDATA
     C                   CAT       'nr">':0      SDATA
     C                   CAT       HEGN:0        SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Posisjon
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Posi':1SDATA
     C                   CAT       'sjon">':0    SDATA
     C                   CAT       HEPOS1:0      SDATA
     C                   IF        HEPOS2 <> 0
     C                   CAT       '/':0         SDATA
     C                   Z-ADD     HEPOS2        ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   END
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Turnr
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Turn':1SDATA
     C                   CAT       'r">':0       SDATA
     C                   IF        HEPRO = 0
     C                   CAT       '0':0         SDATA
     C                   ELSE
     C                   MOVE      HEPRO         XAN08             8
     C                   CAT       XAN08:0       SDATA
     C                   END
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Rundturnr
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Rund':1SDATA
     C                   CAT       'turnr">':0   SDATA
     C                   IF        TRRUND = 0
     C                   CAT       '0':0         SDATA
     C                   ELSE
     C                   MOVE      TRRUND        XAN08             8
     C                   END
     C                   CAT       XAN08:0       SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Laste/lossested
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Last':1SDATA
     C                   CAT       '/lossested':0SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      XTXT801 = HESDL
     C                   Z-ADD     30            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Andre referanser
     C                   MOVE      'CR1'         XFSKODE
     C                   EXSR      SROREF
     C                   MOVE      'CR2'         XFSKODE
     C                   EXSR      SROREF
     C                   MOVE      'IFB'         XFSKODE
     C                   EXSR      SROREF
      * Vekt
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Weig':1SDATA
     C                   CAT       'ht">':0      SDATA
     C                   Z-ADD     HEVKT         ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Fraktberegningsvekt
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="':1    SDATA
     C                   CAT       'Freight':0   SDATA
     C                   CAT       'Weight">':0  SDATA
     C                   Z-ADD     HEFBV         ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Kubikk
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Cubi':1SDATA
     C                   CAT       'c">':0       SDATA
     C                   Z-ADD(H)  HEM3          ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Lastemeter
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Load':1SDATA
     C                   CAT       'ingmeter">':0SDATA
     C                   Z-ADD(H)  HELM          ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Antall
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Piec':1SDATA
     C                   CAT       'es">':0      SDATA
     C                   Z-ADD     HENT          ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * Beskrivelse
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Good':1SDATA
     C                   CAT       'sDesc1">':0  SDATA
     C                   EVAL      XTXT801 = HEVS1
     C                   Z-ADD     34            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(185)
     C                   CAT       'type="Good':1SDATA
     C                   CAT       'sDesc2">':0  SDATA
     C                   EVAL      XTXT801 = HEVS2
     C                   Z-ADD     34            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      * OtherReferance slutt
     C                   EVAL      SDATA = TXT(184)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROREF        BEGSR
      ***********************************************
     C                   SORTA     DFS
     C     DFS(10)       CABEQ     ' '           SLSROREF
     C     'F'           LOOKUP    DFS                                    33
     C     *IN33         CABEQ     *OFF          SLSROREF
      *
      * Andre referanser
     C                   EVAL      SDATA = TXT(185)
     C     XFSKODE       CHAIN     KODFRI                             33
     C                   CAT       'type="':1    SDATA
     C                   EVAL      XTXT801 = KFSOTX
     C                   Z-ADD     40            XN53              3 0
     C                   MOVE      'J'           XSINGEL
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       '">':0        SDATA
     C     FRISOKK       CHAIN     FRISOK                             33
     C                   IF        *IN33 = *OFF
     C                   EVAL      XTXT801 = KFSOTX
     C                   Z-ADD     45            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   ELSE
     C                   GOTO      SLSROREF
     C                   END
      * SETT BLANK PÅ MSISTE 12 TEGN FOR Å HINDRE </Reference> UTE AV LINJE
     C                   MOVE      '            'SDATA
     C                   CAT       TXT(186):0    SDATA
     C                   EXSR      TILFIL
      *
     C     SLSROREF      TAG
     C                   ENDSR
      *
      ***********************************************
     C     SRDELIVERY    BEGSR
      ***********************************************
      * DeliveryInfo start
     C                   EVAL      SDATA = TXT(075)
     C                   EXSR      TILFIL
      * DeliveryTermsCode
     C                   EVAL      SDATA = TXT(077)
     C                   CAT       HEFR:0        SDATA
     C                   CAT       TXT(078):0    SDATA
     C                   EXSR      TILFIL
      * DeliveryTermsText
     C     KODTFRK       CHAIN     KODTFR                             33
     C                   EVAL      SDATA = TXT(079)
     C                   IF        SPRAAK = ' '
     C                   EVAL      XTXT801 = KFRNTX
     C                   Z-ADD     38            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   ELSE
     C                   EVAL      XTXT801 = KFRTTX
     C                   Z-ADD     38            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   END
     C                   CAT       TXT(080):0    SDATA
     C                   EXSR      TILFIL
      * DeliveryMethodCode
     C                   EVAL      SDATA = TXT(081)
     C                   SELECT
     C                   WHEN      ((HEUR >= 'C') AND (HEUR <= 'E'))
     C                   CAT       'FLY':0       SDATA
     C                   WHEN      ((HEUR = 'F') OR (HEUR = 'G'))
     C                   CAT       'BÅT':0       SDATA
     C                   OTHER
     C                   CAT       'BIL':0       SDATA
     C                   ENDSL
     C                   CAT       TXT(082):0    SDATA
     C                   EXSR      TILFIL
      * DeliveryMethodText
     C                   IF        HEHAWB <> *BLANKS
     C                   EVAL      SDATA = TXT(083)
     C                   EVAL      XTXT801 = HEHAWB
     C                   Z-ADD     9             XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(084):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      *
     C                   IF        HETRCN <> *BLANKS
      * OtherDeliveryInfo start
     C                   EVAL      SDATA = TXT(206)
     C                   EXSR      TILFIL
      * Containernr
     C                   EVAL      SDATA = TXT(208)
     C                   CAT       'type="Cont':1SDATA
     C                   CAT       'ainerNr">':0 SDATA
     C                   EVAL      XTXT801 = HETRCN
     C                   Z-ADD     27            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(209):0    SDATA
     C                   EXSR      TILFIL
      * OtherDeliveryInfo start
     C                   EVAL      SDATA = TXT(207)
     C                   EXSR      TILFIL
     C                   END
      * DeliveryInfo slutt
     C                   EVAL      SDATA = TXT(076)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRPARTST      BEGSR
      ***********************************************
      * Parties start
     C                   EVAL      SDATA = TXT(085)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRPARTSL      BEGSR
      ***********************************************
      * Parties slutt
     C                   EVAL      SDATA = TXT(86)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRPART1       BEGSR
      ***********************************************
      * Factoring
     C                   IF        XNIVÅ = 'H'
     C                   Z-ADD     20000000      KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   EVAL      SDATA = NCTXT(001)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(107)
     C                   EVAL      XTXT801 = KNAVN
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(108):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(109)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(111)
     C                   EVAL      XTXT801 = ADR1
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(112):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(113)
     C                   EVAL      XTXT801 = ADR2
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(114):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(115)
     C                   EVAL      XTXT801 = ADR3
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(116):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(117)
     C                   MOVE      POSTNR        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(118):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(110)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = NCTXT(002)
     C                   EXSR      TILFIL
     C                   END
      * Invoicer start
     C                   EVAL      SDATA = TXT(087)
     C                   EXSR      TILFIL
      *
     C                   IF        ((XFSAML = 'N') OR (XNIVÅ = 'L'))
     C     KODTAK        CHAIN     KODTA                              33
     C                   ELSE
     C     KODTAKX       CHAIN     KODTA                              33
     C                   END
     C                   MOVE      KOAKNR        KUNDNR
     C                   MOVE      'N'           XSENDKN           1
     C                   Z-ADD     20000000      KUNDNR
     C                   MOVE      '982813085'   NCV06             9
     C                   EXSR      SRHENTK
      * Contact start
     C                   EVAL      SDATA = TXT(089)
     C                   EXSR      TILFIL
      * Reference
     C                   IF        ((XFSAML = 'N') OR (XNIVÅ = 'L'))
     C                   EVAL      SDATA = TXT(091)
     C                   CAT       SYSPEDREF:0   SDATA
     C                   CAT       TXT(092):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * Email
     C*                  IF        SYEPOS <> *BLANKS
     C                   IF        ((SYEPOS <> *BLANKS) OR (XNIVÅ = 'H'))
     C                   EVAL      SDATA = TXT(093)
     C                   CAT       SYEPOS:0      SDATA
     C                   CAT       TXT(094):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * Phone
     C                   IF        ((TLF <> *BLANKS) OR (XNIVÅ = 'H'))
     C                   EVAL      SDATA = TXT(095)
     C                   CAT       TLF:0         SDATA
     C                   CAT       TXT(096):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * Fax
     C                   IF        ((TFAXNR <> *BLANKS) OR (XNIVÅ = 'H'))
     C                   EVAL      SDATA = TXT(097)
     C                   EVAL      XTXT801 = TFAXNR
     C                   Z-ADD     25            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(098):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * Contact slutt
     C                   EVAL      SDATA = TXT(090)
     C                   EXSR      TILFIL
      * Invoicer slutt
     C                   EVAL      SDATA = TXT(088)
     C                   EXSR      TILFIL
      * Invoicee start
     C                   EVAL      SDATA = TXT(121)
     C                   EXSR      TILFIL
      *
     C                   MOVE      FAKUNR        KUNDNR
     C                   MOVE      'J'           XSENDKN
     C                   MOVE      *BLANKS       NCV06
     C                   EXSR      SRHENTK
      * Contact start
     C                   EVAL      SDATA = TXT(089)
     C                   EXSR      TILFIL
      * Refereces
     C                   EVAL      SDATA = TXT(091)
     C                   CAT       TXT(092):0    SDATA
     C                   EXSR      TILFIL
      * Contact slutt
     C                   EVAL      SDATA = TXT(090)
     C                   EXSR      TILFIL
      * Invoicee slutt
     C                   EVAL      SDATA = TXT(122)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRPART2       BEGSR
      ***********************************************
      * Supplier start
     C                   EVAL      SDATA = TXT(123)
     C                   EXSR      TILFIL
      *
     C                   IF        HEKNS = 0
     C                   EXSR      SRHENTKS
     C                   ELSE
     C                   MOVE      HEKNS         KUNDNR
     C                   MOVE      'J'           XSENDKN
     C                   MOVE      *BLANKS       NCV06
     C                   EXSR      SRHENTK
      *
     C                   END
      * Supplier slutt
     C                   EVAL      SDATA = TXT(124)
     C                   EXSR      TILFIL
      * Buyer start
     C                   EVAL      SDATA = TXT(125)
     C                   EXSR      TILFIL
      *
     C                   IF        HEKNK = 0
     C                   MOVE      'N'           XDELIVERY         1
     C                   EXSR      SRHENTKK
     C                   ELSE
     C                   MOVE      HEKNK         KUNDNR
     C                   MOVE      'J'           XSENDKN
     C                   MOVE      *BLANKS       NCV06
     C                   EXSR      SRHENTK
     C                   END
      *
     C                   IF        ((XFSAML = 'N') OR (XNIVÅ = 'L'))
     C     NCKEY01       CHAIN     FRISOK                             33
     C                   IF        *IN33 = *OFF
      * Contact start
     C                   EVAL      SDATA = TXT(089)
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(091)
     C                   EVAL      XTXT801 = FSSOK
     C                   Z-ADD     45            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(092):0    SDATA
     C                   EXSR      TILFIL
      * Contact slutt
     C                   EVAL      SDATA = TXT(090)
     C                   EXSR      TILFIL
     C                   END
     C                   END
      * Buyer slutt
     C                   EVAL      SDATA = TXT(126)
     C                   EXSR      TILFIL
      * Delivery start
     C                   EVAL      SDATA = TXT(127)
     C                   EXSR      TILFIL
      *
     C                   MOVE      'J'           XDELIVERY
     C                   EXSR      SRHENTKK
      * Delivery slutt
     C                   EVAL      SDATA = TXT(128)
     C                   EXSR      TILFIL
      * OtherParty start
     C                   EVAL      SDATA = TXT(129)
     C                   CAT       'type="Pick':1SDATA
     C                   CAT       'upAdr">':0   SDATA
     C                   EXSR      TILFIL
      * Pickup
     C                   EXSR      SRHENTKS
      * OtherParty slutt
     C                   EVAL      SDATA = TXT(130)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRHENTK       BEGSR
      ***********************************************
     C     CUNDL01K      CHAIN     CUNDL01                            33
      *
     C                   IF        (((SYRG9 <> *ZEROS) AND (SYRG9 <> *BLANKS))
     C                               OR (KUNDNR = 20000000))
     C                   EVAL      SDATA = TXT(101)
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(103)
     C                   IF        NCV06 = *BLANKS
     C                   CAT       SYRG:0        SDATA
     C                   ELSE
     C                   CAT       NCV06:0       SDATA
     C                   END
     C                   CAT       TXT(104):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(105)
     C                   CAT       'NO':0        SDATA
     C                   IF        KUNDNR = 20000000
     C                   CAT       '982813085':0 SDATA
     C                   ELSE
     C                   CAT       SYRG:0        SDATA
     C                   END
     C                   CAT       'MVA':0       SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   IF        XSENDKN = 'J'
     C                   EVAL      SDATA = TXT(204)
     C                   Z-ADD     KUNDNR        ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(205):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      *
     C                   EVAL      SDATA = TXT(102)
     C                   EXSR      TILFIL
     C                   END
      *
     C                   EVAL      SDATA = TXT(107)
     C                   EVAL      XTXT801 = KNAVN
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(108):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(109)
     C                   EXSR      TILFIL
     C                   IF        ((ADR1 <> *BLANKS) AND (ADR1 <> XÅRSPO))
     C                   EVAL      SDATA = TXT(111)
     C                   EVAL      XTXT801 = ADR1
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(112):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      SDATA = TXT(113)
     C                   EVAL      XTXT801 = ADR2
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(114):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        ADR3 <> *BLANKS
     C                   EVAL      SDATA = TXT(115)
     C                   EVAL      XTXT801 = ADR3
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(116):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        POSTNR <> 0
     C                   EVAL      SDATA = TXT(117)
     C                   MOVE      POSTNR        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(118):0    SDATA
     C                   EXSR      TILFIL
     C                   ELSE
     C                   IF        SYPOGE <> *BLANKS
     C                   EVAL      SDATA = TXT(117)
     C                   CAT       SYPOGE:0      SDATA
     C                   CAT       TXT(118):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   END
     C                   EVAL      SDATA = TXT(119)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       FILAND:0      SDATA
     C                   MOVE      FILAND        KLKLK
     C                   ELSE
     C                   CAT       SYLAND:0      SDATA
     C                   MOVE      SYLAND        KLKLK
     C                   END
     C                   CAT       TXT(120):0    SDATA
     C                   EXSR      TILFIL
      * CountryName
     C                   IF        XNIVÅ = 'H'
     C                   EVAL      SDATA = TXT(241)
     C     KODTLKK       CHAIN     KODTLK                             33
     C                   EVAL      XTXT801 = KLKNVN
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(242):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      *
     C                   EVAL      SDATA = TXT(110)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRHENTKS      BEGSR
      ***********************************************
     C                   EVAL      SDATA = TXT(107)
     C                   EVAL      XTXT801 = HENAS
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(108):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(109)
     C                   EXSR      TILFIL
     C                   IF        HEADS1 <> *BLANKS
     C                   EVAL      SDATA = TXT(111)
     C                   EVAL      XTXT801 = HEADS1
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(112):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        HEADS2 <> *BLANKS
     C                   EVAL      SDATA = TXT(113)
     C                   EVAL      XTXT801 = HEADS2
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(114):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        HEADS3 <> *BLANKS
     C                   EVAL      SDATA = TXT(115)
     C                   EVAL      XTXT801 = HEADS3
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(116):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(117)
     C                   MOVEL     HEADS3        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(118):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   EVAL      SDATA = TXT(110)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRHENTKK      BEGSR
      ***********************************************
     C                   EVAL      SDATA = TXT(107)
     C                   EVAL      XTXT801 = HENAK
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(108):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(109)
     C                   EXSR      TILFIL
     C                   IF        HEADK1 <> *BLANKS
     C                   EVAL      SDATA = TXT(111)
     C                   EVAL      XTXT801 = HEADK1
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(112):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        HEADK2 <> *BLANKS
     C                   EVAL      SDATA = TXT(113)
     C                   EVAL      XTXT801 = HEADK2
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(114):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   IF        HEADK3 <> *BLANKS
     C                   EVAL      SDATA = TXT(115)
     C                   EVAL      XTXT801 = HEADK3
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(116):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(117)
     C                   MOVEL     HEADK3        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(118):0    SDATA
     C                   EXSR      TILFIL
     C                   END
     C                   EVAL      SDATA = TXT(110)
     C                   EXSR      TILFIL
      *
     C                   IF        XDELIVERY = 'J'
      * Contact start
     C                   EVAL      SDATA = TXT(089)
     C                   EXSR      TILFIL
      * Lossested/lastested
     C                   EVAL      SDATA = TXT(091)
     C                   EVAL      XTXT801 = HESDL
     C                   Z-ADD     27            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(092):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   IF        HEKDPL <> ' '
      * OtherContactInfo start
     C                   EVAL      SDATA = TXT(212)
     C                   EXSR      TILFIL
      * Produktkode
     C                   EVAL      SDATA = TXT(214)
     C                   CAT       'type="Prod':1SDATA
     C                   CAT       'uktKode">':0 SDATA
     C                   CAT       HEKDPL:0      SDATA
     C                   CAT       TXT(215):0    SDATA
     C                   EXSR      TILFIL
      * OtherContactInfo slutt
     C                   EVAL      SDATA = TXT(213)
     C                   EXSR      TILFIL
     C                   END
      * Contact slutt
     C                   EVAL      SDATA = TXT(090)
     C                   EXSR      TILFIL
      *
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSUM         BEGSR
      ***********************************************
      * Summary start
     C                   EVAL      SDATA = TXT(131)
     C                   EXSR      TILFIL
      *
     C                   MOVE      *ZEROS        XXMVAT           13 2
     C     1             DO        11            XN01              3 0
     C                   IF        XMLT1(XN01) > 0
     C                   IF        XMLT2(XN01) = *BLANKS
     C                   EVAL      XMLT2(XN01) = FICURR
     C                   END
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT3(XN01)/100
     C                   ELSE
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT4(XN01)/100
     C                   END
     C                   END
     C                   ENDDO
     C     XFTOT         SUB       XXMVAT        XX0MVAGR         13 2
      * Taxes start
     C                   EVAL      SDATA = TXT(133)
     C                   EXSR      TILFIL
      *
     C                   MOVE      *ZEROS        XXMVA            13 2
     C     1             DO        11            XN01
     C                   IF        XMLT1(XN01) > 0
      * Tax start
     C                   EVAL      SDATA = TXT(135)
     C                   EXSR      TILFIL
      * TaxType
     C                   EVAL      SDATA = TXT(137)
     C                   CAT       'VAT':0       SDATA
     C                   CAT       TXT(138):0    SDATA
     C                   EXSR      TILFIL
      * TaxBase
     C                   EVAL      SDATA = TXT(139)
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL      ØN152 = XMLT3(XN01)
     C                   ELSE
     C                   EVAL      ØN152 = XMLT4(XN01)
     C                   END
     C                   SUB       ØN152         XX0MVAGR
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(140):0    SDATA
     C                   EXSR      TILFIL
      * TaxPercent
     C                   EVAL      SDATA = TXT(141)
     C                   EVAL      ØN152 = XMLT1(XN01)
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(142):0    SDATA
     C                   EXSR      TILFIL
      * TaxAmount
     C                   EVAL      SDATA = TXT(143)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XMLT2(XN01):0 SDATA
     C                   CAT       '">':0        SDATA
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL      ØN152 = XMLT3(XN01) * XMLT1(XN01) / 100
     C                   ELSE
     C                   EVAL      ØN152 = XMLT4(XN01) * XMLT1(XN01) / 100
     C                   END
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(144):0    SDATA
     C                   EXSR      TILFIL
      * Tax slutt
     C                   EVAL      SDATA = TXT(136)
     C                   EXSR      TILFIL
      *
     C                   END
     C                   ENDDO
      * TaxFree
     C                   EVAL      SDATA = TXT(135)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(137)
     C                   CAT       'VAT':0       SDATA
     C                   CAT       TXT(138):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(139)
     C                   EVAL      ØN152 = XX0MVAGR
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(140):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(141)
     C                   CAT       '0':0         SDATA
     C                   CAT       TXT(142):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(143)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       '0':0         SDATA
     C                   CAT       TXT(144):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(136)
     C                   EXSR      TILFIL
      * Taxes slutt
     C                   EVAL      SDATA = TXT(134)
     C                   EXSR      TILFIL
      * TotalTax
     C                   EVAL      SDATA = TXT(145)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXMVAT
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(146):0    SDATA
     C                   EXSR      TILFIL
      * TotalExclTaxes
     C                   EVAL      SDATA = TXT(147)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XFTOT - XXMVAT
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(148):0    SDATA
     C                   EXSR      TILFIL
      * TotalInclTax
     C                   EVAL      SDATA = TXT(149)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XFTOT
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(150):0    SDATA
     C                   EXSR      TILFIL
      * Summary slutt
     C                   EVAL      SDATA = TXT(132)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRFRTEKST     BEGSR
      ***********************************************
      * Sjekk om det finnes frisøkeveier eller fritekst
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        (((((FSKODE <> *BLANKS) AND
     C                                 (FSKODE <> 'PO ')) AND
     C                                 (FSKODE <> 'CR1')) AND
     C                                 (FSKODE <> 'CR2')) AND
     C                                 (FSKODE <> 'IFB'))
     C                   IF        FSSOK <> *BLANKS
     C                   SORTA     DFS
     C                   MOVE      '0'           *IN34
     C     DFS(10)       IFNE      ' '
     C     FASK          LOOKUP    DFS                                    34
     C  N34'B'           LOOKUP    DFS                                    33
     C   34              LEAVE
     C                   END
     C                   END
     C                   END
     C     HEADFK        READE     FRISOK                                 33
     C  N33              ENDDO
     C     *IN33         CABEQ     *OFF          STSRFRT1
     C     FREETK        SETLL     FREETXT2
     C     FREETK        READE     FREETXT2                               33
     C     *IN33         CABEQ     *ON           SLSRFRT
      *
     C     STSRFRT1      TAG
      * FreeText start
     C                   EVAL      SDATA = TXT(151)
     C                   EXSR      TILFIL
      *
      * Frisøkevei legges til FREETEXT
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   IF        (((((FSKODE <> *BLANKS) AND                   2<-B
     C                                 (FSKODE <> 'PO ')) AND
     C                                 (FSKODE <> 'CR1')) AND
     C                                 (FSKODE <> 'CR2')) AND
     C                                 (FSKODE <> 'IFB'))
     C                   IF        FSSOK <> *BLANKS
     C                   SORTA     DFS
     C                   MOVE      '0'           *IN34
     C     DFS(10)       IFNE      ' '                                            3<-B
     C     FASK          LOOKUP    DFS                                    34
     C  N34'B'           LOOKUP    DFS                                    33
     C                   IF        *IN34                                           4<-B
      * Text start
     C                   EVAL      SDATA = TXT(153)
     C                   EXSR      TILFIL
      * Frisøkevei
     C     FSKODE        CHAIN     KODFRI                             34
     C                   EVAL      SDATA = TXT(155)
     C                   CAT       'name="':1    SDATA
     C                   CAT       'HEAD"':0     SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = 'value="'
     C                   EVAL      XTXT801 = KFSOTX
     C                   Z-ADD     40            XN53              3 0
     C                   MOVE      'J'           XSINGEL
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       '/':0         SDATA
     C                   EVAL      XTXT801 = FSSOK
     C                   Z-ADD     45            XN53              3 0
     C                   MOVE      'J'           XSINGEL
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   MOVE      SDATA         XAN03             3
     C                   IF        XAN03 = *BLANKS
     C                   CAT       '"/>':0       SDATA
     C                   ELSE
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = '"/>'
     C                   END
     C                   EXSR      TILFIL
      * Text slutt
     C                   EVAL      SDATA = TXT(154)
     C                   EXSR      TILFIL
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END
     C                   END                                                     2<-E
     C     HEADFK        READE     FRISOK                                 33
     C  N33              ENDDO                                                  1<-E
      *
      *
     C     FREETK        SETLL     FREETXT2
     C     FREETK        READE     FREETXT2                               33
      *
     C                   DOW       *IN33 = *OFF
     C                   IF        FRTKOD = FASK
      * Text start
     C                   EVAL      SDATA = TXT(153)
     C                   EXSR      TILFIL
      * Fritekst
     C                   EVAL      SDATA = TXT(155)
     C                   CAT       'name="':1    SDATA
     C                   CAT       'HEAD"':0     SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = 'value="'
     C                   EVAL      XTXT801 = FRTTXT
     C                   Z-ADD     80            XN53              3 0
     C                   MOVE      'J'           XSINGEL
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   MOVE      SDATA         XAN03             3
     C                   IF        XAN03 = *BLANKS
     C                   CAT       '"/>':0       SDATA
     C                   ELSE
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = '"/>'
     C                   END
     C                   EXSR      TILFIL
      * Text slutt
     C                   EVAL      SDATA = TXT(154)
     C                   EXSR      TILFIL
     C                   end
      *
     C     FREETK        READE     FREETXT2                               33
     C  N33              ENDDO
      *
      * FreeText slutt
     C                   EVAL      SDATA = TXT(152)
     C                   EXSR      TILFIL
      *
     C     SLSRFRT       TAG
     C                   ENDSR
      *
      ***********************************************
     C     SRDET         BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XXBEL            13 2
      * Details start
     C                   EVAL      SDATA = TXT(157)
     C                   EXSR      TILFIL
      * DetailNumber
     C                   EVAL      SDATA = TXT(159)
     C                   CAT       '1':0         SDATA
     C                   CAT       TXT(160):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   MOVE      *ZEROS        XXLINNR           5 0
     C     STLIN         TAG
      * LineDetails start
     C                   EVAL      SDATA = TXT(161)
     C                   EXSR      TILFIL
      * LineNumber
     C                   EVAL      SDATA = TXT(163)
     C                   ADD       1             XXLINNR
     C                   EVAL      ØN152 = XXLINNR
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(164):0    SDATA
     C                   EXSR      TILFIL
      * ProductDetails start
     C                   EVAL      SDATA = TXT(165)
     C                   EXSR      TILFIL
      * SupplierProductCode
     C                   EVAL      SDATA = TXT(167)
     C                   CAT       FAVK:0        SDATA
     C                   CAT       TXT(168):0    SDATA
     C                   EXSR      TILFIL
      * SupplierProductText
     C                   EVAL      SDATA = TXT(169)
     C                   EVAL      XTXT801 = FAVT
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C     KODTGEK       CHAIN     KODTGE                             33
     C     KODTG2K       CHAIN     KODTG2                             33
     C                   IF        FAVT <> *BLANKS
     C                   CAT       ',':0         SDATA
     C                   END
     C                   SELECT
     C                   WHEN      SPRAAK = 'E'
     C                   EVAL      XTXT801 = KGEENT
     C                   WHEN      SPRAAK = 'T'
     C                   EVAL      XTXT801 = KG2TYT
     C                   OTHER
     C                   EVAL      XTXT801 = KGENOT
     C                   ENDSL
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   MOVE      XAN22BLANK    SDATA
     C                   CAT       TXT(170):0    SDATA
     C                   EXSR      TILFIL
      * ProductDetails slutt
     C                   EVAL      SDATA = TXT(166)
     C                   EXSR      TILFIL
      * Quantities start
     C                   EVAL      SDATA = TXT(171)
     C                   EXSR      TILFIL
      * QuantitiyOrdered
     C                   EVAL      SDATA = TXT(173)
     C                   CAT       'qtyType="':1 SDATA
     C                   CAT       'PCE">1':0    SDATA
     C                   CAT       TXT(174):0    SDATA
     C                   EXSR      TILFIL
      * QuantitiyDeliveried
     C                   EVAL      SDATA = TXT(175)
     C                   CAT       'qtyType="':1 SDATA
     C                   CAT       'PCE">1':0    SDATA
     C                   CAT       TXT(176):0    SDATA
     C                   EXSR      TILFIL
      * Quantities slutt
     C                   EVAL      SDATA = TXT(172)
     C                   EXSR      TILFIL
      * PriceDetails start
     C                   EVAL      SDATA = TXT(187)
     C                   EXSR      TILFIL
     C                   IF        FAVAL = FICURR
     C                   EVAL      XXBEL = FABELN
     C                   ELSE
     C                   EVAL      XXBEL = FABELV
     C                   END
      *
      * LineTotTaxBase
     C                   EVAL      SDATA = TXT(191)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXBEL
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(192):0    SDATA
     C                   EXSR      TILFIL
      * TaxPercent
     C                   EVAL      SDATA = TXT(193)
     C                   SELECT
     C                   WHEN      FAKDM = 'N'
     C                   EVAL      MVAAVI = 0
     C                   WHEN      FAKDM = 'J'
     C                   EVAL      MVAAVI = FITAX * 100
     C                   OTHER
     C     KODWL01K      CHAIN     KODWL01                            33
     C   33              EVAL      MVAAVI = 0
     C                   END
     C                   EVAL      ØN152 = MVAAVI
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(194):0    SDATA
     C                   EXSR      TILFIL
      * LineTotTax
     C                   EVAL      SDATA = TXT(195)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      XXMVA = XXBEL * MVAAVI / 100
     C                   EVAL      ØN152 = XXMVA
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(196):0    SDATA
     C                   EXSR      TILFIL
      * LineTotExclTax
     C                   EVAL      SDATA = TXT(197)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXBEL
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(198):0    SDATA
     C                   EXSR      TILFIL
      * LineTotInclTax
     C                   EVAL      SDATA = TXT(199)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXBEL + XXMVA
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(200):0    SDATA
     C                   EXSR      TILFIL
      * PriceDetails slutt
     C                   EVAL      SDATA = TXT(188)
     C                   EXSR      TILFIL
      * LineDetails slutt
     C                   EVAL      SDATA = TXT(162)
     C                   EXSR      TILFIL
     C     FAK8K         READE     FAK8                                   33
     C  N33              GOTO      STLIN
      * Details slutt
     C                   EVAL      SDATA = TXT(158)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRDETS        BEGSR
      ***********************************************
     C     STSRDETS      TAG
     C                   MOVE      *ZEROS        XXBEL            13 2
     C                   ADD       1             XXANTOPD          5 0
      * Details start
     C                   EVAL      SDATA = TXT(203)
     C                   Z-ADD     XXANTOPD      ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       '">':0        SDATA
     C                   EXSR      TILFIL
      * DetailNumber
     C                   EVAL      SDATA = TXT(159)
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(160):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   EXSR      SREINVST2
     C                   EXSR      SRDET
     C                   EXSR      SREINVSL2
      * Details slutt
     C                   EVAL      SDATA = TXT(158)
     C                   EXSR      TILFIL
      *
     C                   EXSR      HENTOPD
     C                   IF        *IN33 = *OFF
     C     STSRDETS1     TAG
     C     HEADFK        CHAIN     HEADF                              33
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C  N33              DOW       FAOPKO = 'D'
     C     FAK8K         READE     FAK8                                   33
     C  N33              ENDDO
     C                   IF        *IN33
     C                   EXSR      HENTOPD
     C   33              GOTO      SLSRDETS
     C                   GOTO      STSRDETS1
     C                   END
     C                   IF        FAVAL = *BLANKS
     C                   EVAL      FAVAL = FICURR
     C                   END
     C                   GOTO      STSRDETS
     C                   END
      *
     C     SLSRDETS      ENDSR
      *
      ***********************************************
     C     SREINVST2     BEGSR
      ***********************************************
      * Invoice start
     C                   EVAL      SDATA = TXT(045)
     C                   EXSR      TILFIL
      * InvoiceDates
     C                   EVAL      SDATA = TXT(047)
     C                   EXSR      TILFIL
      * OrderDate
     C                   EVAL      SDATA = TXT(210)
     C                   CAT       'year="':1    SDATA
     C                   CAT       HEDTOPÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       HEDTOPM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       HEDTOPD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       HEDTOPÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       HEDTOPM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       HEDTOPD:0     SDATA
     C                   CAT       TXT(211):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   EVAL      SDATA = TXT(048)
     C                   EXSR      TILFIL
      * InvoiceReferance start
     C                   EVAL      SDATA = TXT(053)
     C                   EXSR      TILFIL
      *
     C                   EXSR      SREINVREF
      * InvoiceReferance slutt
     C                   EVAL      SDATA = TXT(054)
     C                   EXSR      TILFIL
      *
     C                   EXSR      SRDELIVERY
      *
      * Parties
     C                   EXSR      SRPARTST
     C                   MOVE      'L'           XNIVÅ             1
     C                   EXSR      SRPART1
     C                   EXSR      SRPART2
     C                   EXSR      SRPARTSL
      * Summery
     C                   EXSR      SRSUM2
      * FreeText
     C                   EXSR      SRFRTEKST
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREINVSL2     BEGSR
      ***********************************************
      * Invoice slutt
     C                   EVAL      SDATA = TXT(046)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSUM2        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XOPBEL           13 2
     C                   MOVE      *ZEROS        XOPMVGR          13 2
     C                   MOVE      *ZEROS        XOPMVA           13 2
     C                   MOVE      *OFF          *IN33
      * Summer oppdragtotal
     C                   DOW       *IN33 = *OFF
     C                   IF        ((XFVAL = FICURR) OR (XFVAL <> FAVAL))
     C                   ADD       FABELN        XOPBEL
     C                   IF        FAKDM = 'J'
     C                   ADD       FABELN        XOPMVGR
     C                   END
     C                   ELSE
     C                   ADD       FABELV        XOPBEL
     C                   IF        FAKDM = 'J'
     C                   ADD       FABELV        XOPMVGR
     C                   END
     C                   END
     C     FAK8K         READE     FAK8                                   33
     C  N33              DOW       FAOPKO = 'D'
     C     FAK8K         READE     FAK8                                   33
     C  N33              ENDDO
     C  N33              ENDDO
     C                   EVAL      XOPMVA = XOPMVGR * XMLT1(1) / 100
     C                   Z-ADD     XOPBEL        XXOP0MVAGR       13 2
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
      *
      * Summary start
     C                   EVAL      SDATA = TXT(131)
     C                   EXSR      TILFIL
      * Taxes start
     C                   EVAL      SDATA = TXT(133)
     C                   EXSR      TILFIL
      *
      * Tax start
     C                   EVAL      SDATA = TXT(135)
     C                   EXSR      TILFIL
      * TaxType
     C                   EVAL      SDATA = TXT(137)
     C                   CAT       'VAT':0       SDATA
     C                   CAT       TXT(138):0    SDATA
     C                   EXSR      TILFIL
      * TaxBase
     C                   EVAL      SDATA = TXT(139)
     C                   EVAL      ØN152 = XOPMVGR
     C                   SUB       XOPMVGR       XXOP0MVAGR       13 2
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(140):0    SDATA
     C                   EXSR      TILFIL
      * TaxPercent
     C                   EVAL      SDATA = TXT(141)
     C                   EVAL      ØN152 = XMLT1(1)
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(142):0    SDATA
     C                   EXSR      TILFIL
      * TaxAmount
     C                   EVAL      SDATA = TXT(143)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XOPMVA
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(144):0    SDATA
     C                   EXSR      TILFIL
      * Tax slutt
     C                   EVAL      SDATA = TXT(136)
     C                   EXSR      TILFIL
      * TaxFree
     C                   EVAL      SDATA = TXT(135)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(137)
     C                   CAT       'VAT':0       SDATA
     C                   CAT       TXT(138):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(139)
     C                   EVAL      ØN152 = XXOP0MVAGR
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(140):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(141)
     C                   CAT       '0':0         SDATA
     C                   CAT       TXT(142):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(143)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       '0':0         SDATA
     C                   CAT       TXT(144):0    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(136)
     C                   EXSR      TILFIL
      * Taxes slutt
     C                   EVAL      SDATA = TXT(134)
     C                   EXSR      TILFIL
      * TotalTax
     C                   EVAL      SDATA = TXT(145)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XOPMVA
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(146):0    SDATA
     C                   EXSR      TILFIL
      * TotalExclTaxes
     C                   EVAL      SDATA = TXT(147)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XOPBEL
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(148):0    SDATA
     C                   EXSR      TILFIL
      * TotalInclTax
     C                   EVAL      SDATA = TXT(149)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XOPBEL + XOPMVA
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(150):0    SDATA
     C                   EXSR      TILFIL
      * Summary slutt
     C                   EVAL      SDATA = TXT(132)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSLUTT       BEGSR
      ***********************************************
      * PostenInterChange
     C                   EVAL      SDATA = TXT(003)
     C                   EXSR      TILFIL
      *
      * Oppdater EDIS
     C                   WRITE     EDISR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRCLOSE       BEGSR
      ***********************************************
     C                   CLOSE     ECMSG
     C                   CLOSE     KODWL01
     C                   CLOSE     KODTA
     C                   CLOSE     KODTGE
     C                   CLOSE     KODTG2
     C                   CLOSE     KODTFR
     C                   CLOSE     KODTOTY
     C                   CLOSE     KODTLK
     C                   CLOSE     CUNDL01
     C                   CLOSE     CUNDC01
     C                   CLOSE     CUNDC03
     C                   CLOSE     FAIN
     C                   CLOSE     HEADF
     C                   CLOSE     FAK8
     C                   CLOSE     FRISOK
     C                   CLOSE     KODFRI
     C                   CLOSE     ARKIVL02
     C                   CLOSE     ARKTXT
     C                   CLOSE     ARKEXT
     C                   CLOSE     FIRMARC
     C                   CLOSE     KOFAST
     C                   CLOSE     EDIC
     C                   CLOSE     EDIS
     C                   CLOSE     EDIM
     C                   CLOSE     EDISE
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSEND        BEGSR
      ***********************************************
     C                   CLOSE     XMLTILP
     C                   IF        XXTYPE = 'POSTK'
     C                   MOVE      'J'           UKOPIFAKT         1
     C                   ELSE
     C                   MOVE      'N'           UKOPIFAKT
     C                   END
     C                   CALL      'SYXML01S'
     C                   PARM                    SEMBR
     C                   PARM                    UKOPIFAKT
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDEDIM       BEGSR
      ***********************************************
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EVAL      M0004 = S0004
     C                   EVAL      M0010 = S0010
     C                   MOVEL     CMN           M0062
     C                   EVAL      M0065 = 'INVXML'
     C                   MOVEL     XFFN          M0068
     C                   IF        XFFK = 'F'
     C                   MOVEL     '380'         M1001
     C                   ELSE
     C                   MOVEL     '381'         M1001
     C                   END
     C                   MOVEL     XFFN          M1004
     C                   IF        XFSAML = 'N'
     C                   MOVE      'SIN'         M1225
     C                   ELSE
     C                   MOVE      'SAM'         M1225
     C                   END
     C                   EVAL      MSN = SSN
     C                   EVAL      MMN = CMN
     C                   EVAL      MSR = 'S'
     C                   EVAL      MST = 'C'
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   IF        XFSAML = 'N'
     C                   EVAL      MAVD = FIAVD
     C                   EVAL      MTDN = FIOPD
     C                   ELSE
     C                   EVAL      MAVD = 0
     C                   EVAL      MTDN = 0
     C                   END
     C                   WRITE     EDIMR
      *
     C                   EVAL      S0036 = S0036 + 1
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
     C                   IF        ØN152 < 0
     C                   MOVE      '-'           XAN01             1
     C                   Z-SUB     ØN152         ØN152
     C                   ELSE
     C                   MOVE      ' '           XAN01
     C                   END
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C     XBELØP        ANDEQ     'N'                                                        I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      '.  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C     XBELØP        IFEQ      'N'
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   END
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       XXA12            12
     C     Ø12(ØX)       IFEQ      '.'
     C                   SUB       1             ØX
     C                   END
     C                   MOVEA     Ø12(ØX)       XXA12
     C                   IF        XAN01 = '-'
     C                   EVAL      ØAN = XAN01
     C                   CAT       XXA12:0       ØAN
     C                   ELSE
     C                   EVAL      ØAN = XXA12
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     TILFIL        BEGSR
      ***********************************************
     C                   WRITE     EDISER
      *
     C                   MOVE      SDATA         XTPDTA
     C                   WRITE     XMLTILPR
      *
     C                   ENDSR
      *
      ***********************************************
     C     KNVST         BEGSR
      ***********************************************
     C     XN53          SUB       4             XN54              3 0
     C     XN53          SUB       5             XN55              3 0
     C     XN53          SUB       6             XN56              3 0
     C                   Z-ADD     0             XN52              3 0
     C                   MOVE      *BLANKS       XTXT802
     C     1             DO        80            XN51              3 0
     C                   IF        (((((XT801(XN51) = '&') OR
     C                                 (XT801(XN51) = '"')) OR
     C                                 (XT801(XN51) = XAPS)) OR
     C                                 (XT801(XN51) = '<')) OR
     C                                 (XT801(XN51) = '>'))
     C                   IF        XN52 < XN53
     C                   ADD       1             XN52
     C                   SELECT
     C                   WHEN      XT801(XN51) = '&'
     C                   IF        XN51 < XN55
     C                   MOVEA     '&amp;'       XT802(XN52)
     C                   ADD       4             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = '"'
     C                   IF        XN51 < 75
     C                   IF        XSINGEL = 'J'
     C                   MOVEA     '&apos;'      XT802(XN52)
     C                   ELSE
     C                   MOVEA     '&quot;'      XT802(XN52)
     C                   END
     C                   ADD       5             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = XAPS
     C                   IF        XN51 < XN56
     C                   MOVEA     '&apos;'      XT802(XN52)
     C                   ADD       5             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = '>'
     C                   IF        XN51 < XN54
     C                   MOVEA     '&gt;'        XT802(XN52)
     C                   ADD       3             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = '<'
     C                   IF        XN51 < XN54
     C                   MOVEA     '&lt;'        XT802(XN52)
     C                   ADD       3             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   ENDSL
     C                   END
     C                   ELSE
     C                   IF        XN52 < XN53
     C                   ADD       1             XN52
     C                   MOVE      XT801(XN51)   XT802(XN52)
     C                   ELSE
     C                   LEAVE
     C                   END
     C                   END
     C                   ENDDO
     C                   MOVE      'N'           XSINGEL           1
      *
     C                   ENDSR
      *
      ***********************************************
     C     HENTOPD       BEGSR
      ***********************************************
     C     STHENTOPD     TAG
     C     FIFN          READE     FAIN                                   33
     C                   IF        *IN33 = *OFF
     C     FAK8K         CHAIN     FAK8                               33
     C     STHENTOPD2    TAG
     C  N33FAKDA         COMP      'K'                                    33
     C  N33FASK          IFNE      'S'
     C     FASK          ANDNE     'K'
     C     FASK          ANDNE     'X'
     C     FAK8K         READE     FAK8                                   33
     C  N33              GOTO      STHENTOPD2
     C                   END
     C   33              GOTO      STHENTOPD
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     XMLUFL1K      KLIST
     C                   KFLD                    XXST
     C                   KFLD                    FIFIRM
     C                   KFLD                    XXTYPE
     C     ECMSGK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ECCNO
     C                   KFLD                    ECSR
     C                   KFLD                    EC0065
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     FAK8K         KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C                   KFLD                    FIFN
     C     KODWL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    MOMSTW
     C                   KFLD                    FAKDM
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    FIAVD
     C     KODTAKX       KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    XFAVD
     C     KODTGEK       KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    FAVK
     C     KODTG2K       KLIST
     C                   KFLD                    KG2UNI
     C                   KFLD                    FAVK
     C     KODTFRK       KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    HEFR
     C     KODTOTYK      KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    HEOT
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     CUNDC01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    FAKUNR
     C     CUNDC03K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    C3_CTYPE
     C                   KFLD                    FAKUNR
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FASK
     C                   KFLD                    FIFN
     C     FRISOKK       KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XFSKODE           3
      *
     C     ARKIVL02K     KLIST
     C                   KFLD                    ARSTAT
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C                   KFLD                    ARTYPE
     C                   MOVE      'zu'          ARTYPE
     C                   MOVE      'A'           ARSTAT
     C     ARKEXTK       KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ARKLAG
     C     KOFASTK       KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    XTXT05
     C                   MOVEL     'XMLVLTYPE'   KFTYP
     C     KODTLKK       KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    KLKLK
     C     NCKEY01       KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    NCV05             3
     C                   MOVE      'KON'         NCV05
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVE      *BLANKS       XAN22BLANK       22
     C                   MOVE      ' '           XXST              1
     C                   MOVE      'POST '       XXTYPE            5
     C                   MOVE      'A'           KOAUNI
     C                   MOVEL     'GE'          KGEUNI
     C                   MOVEL     'G2'          KG2UNI
     C                   MOVEL     'LK'          KLKUNI
     C                   MOVEL     'FR'          KFRUNI
     C                   MOVEL     'OTY'         KO1UNI
     C                   MOVE      'PO '         XFSKODE
     C                   MOVEL     'S'           ECSR
     C                   MOVEL     'INVXML'      EC0065
     C                   MOVE      '/'           XXSTREKK1
     C                   MOVE      '/'           XXSTREKK2
     C                   BITON     '123457'      XAPS              1
     C                   BITOFF    '06'          XAPS
      *
     C                   ENDSR
      *
** TAB
aA
bB
cC
dD
eE
fF
gG
hH
iI
jJ
kK
lL
mM
nN
oO
pP
qQ
rR
sS
tT
uU
vV
wW
xX
yY
zZ
** TXT
<?xml version="1.0" encoding="ISO-8859-1" ?>                                    001
<PostenInterchange                                                              002
</PostenInterchange>                                                            003
<InterchangeType>PostenInterchange</InterchangeType>                            004
<Version>1.4-rev3</Version>                                                     005
<Originator>                                                                    006
</Originator>                                                                   007
<Address>                                                                       008
</Address>                                                                      009
<SubAddress/>                                                                   010
<SubAddress>                                                                    011
</SubAddress>                                                                   012
<AddressQualifier>                                                              013
</AddressQualifier>                                                             014
<Recipient>                                                                     015
</Recipient>                                                                    016
<InterchangeId>                                                                 017
</InterchangeId>                                                                018
<InterchangeTime>                                                               019
</InterchangeTime>                                                              020
<Date                                                                           021
</Date>                                                                         022
<Time                                                                           023
</Time>                                                                         024
<eMessage>                                                                      025
</eMessage>                                                                     026
<MessageType>                                                                   027
</MessageType>                                                                  028
<MessageVersion>                                                                029
</MessageVersion>                                                               030
<DocumentType>                                                                  031
</DocumentType>                                                                 032
<DocumentCode>                                                                  033
</DocumentCode>                                                                 034
<DocumentDescriptiveName>                                                       035
</DocumentDescriptiveName>                                                      036
<MessageReference>                                                              037
</MessageReference>                                                             038
<MessageOriginator>                                                             039
</MessageOriginator>                                                            040
<MessageRecipient>                                                              041
</MessageRecipient>                                                             042
<MessageContent>                                                                043
</MessageContent>                                                               044
<Invoice>                                                                       045
</Invoice>                                                                      046
<InvoiceDates>                                                                  047
</InvoiceDates>                                                                 048
<InvoiceDate                                                                    049
</InvoiceDate>                                                                  050
<DueDate                                                                        051
</DueDate>                                                                      052
<InvoiceReferences>                                                             053
</InvoiceReferences>                                                            054
<InvoiceNo>                                                                     055
</InvoiceNo>                                                                    056
<PaymentInfo>                                                                   057
</PaymentInfo>                                                                  058
<PaymentTermsCode>                                                              059
</PaymentTermsCode>                                                             060
<PaymentTermsText>                                                              061
</PaymentTermsText>                                                             062
<PaymentAccountInfo>                                                            063
</PaymentAccountInfo>                                                           064
<AccountNumber>                                                                 065
</AccountNumber>                                                                066
<PaymentDueDate                                                                 067
</PaymentDueDate>                                                               068
<PaymentAmount                                                                  069
</PaymentAmount>                                                                070
<KID>                                                                           071
</KID>                                                                          072
<CheckDigit>                                                                    073
</CheckDigit>                                                                   074
<DeliveryInfo>                                                                  075
</DeliveryInfo>                                                                 076
<DeliveryTermsCode>                                                             077
</DeliveryTermsCode>                                                            078
<DeliveryTermsText>                                                             079
</DeliveryTermsText>                                                            080
<DeliveryMethodCode>                                                            081
</DeliveryMethodCode>                                                           082
<DeliveryMethodText>                                                            083
</DeliveryMethodText>                                                           084
<Parties>                                                                       085
</Parties>                                                                      086
<Invoicer>                                                                      087
</Invoicer>                                                                     088
<Contact>                                                                       089
</Contact>                                                                      090
<Reference>                                                                     091
</Reference>                                                                    092
<Email>                                                                         093
</Email>                                                                        094
<Phone>                                                                         095
</Phone>                                                                        096
<Fax>                                                                           097
</Fax>                                                                          098
<WebAddress>                                                                    099
</WebAddress>                                                                   100
<Identifications>                                                               101
</Identifications>                                                              102
<CompanyRegNo>                                                                  103
</CompanyRegNo>                                                                 104
<CompanyVATNo>                                                                  105
</CompanyVATNo>                                                                 106
<Name>                                                                          107
</Name>                                                                         108
<PostalAddress>                                                                 109
</PostalAddress>                                                                110
<Address1>                                                                      111
</Address1>                                                                     112
<Address2>                                                                      113
</Address2>                                                                     114
<City>                                                                          115
</City>                                                                         116
<PostCode>                                                                      117
</PostCode>                                                                     118
<CountryCode>                                                                   119
</CountryCode>                                                                  120
<Invoicee>                                                                      121
</Invoicee>                                                                     122
<Supplier>                                                                      123
</Supplier>                                                                     124
<Buyer>                                                                         125
</Buyer>                                                                        126
<Delivery>                                                                      127
</Delivery>                                                                     128
<OtherParty                                                                     129
</OtherParty>                                                                   130
<Summary>                                                                       131
</Summary>                                                                      132
<Taxes>                                                                         133
</Taxes>                                                                        134
<Tax>                                                                           135
</Tax>                                                                          136
<TaxType>                                                                       137
</TaxType>                                                                      138
<TaxBase>                                                                       139
</TaxBase>                                                                      140
<TaxPercent>                                                                    141
</TaxPercent>                                                                   142
<TaxAmount                                                                      143
</TaxAmount>                                                                    144
<TotalTax                                                                       145
</TotalTax>                                                                     146
<TotalExclTax                                                                   147
</TotalExclTax>                                                                 148
<TotalInclTax                                                                   149
</TotalInclTax>                                                                 150
<FreeText>                                                                      151
</FreeText>                                                                     152
<Text>                                                                          153
</Text>                                                                         154
<FTComplexParameter                                                             155
</FTComplexParameter>                                                           156
<Details>                                                                       157
</Details>                                                                      158
<DetailNumber>                                                                  159
</DetailNumber>                                                                 160
<LineDetails>                                                                   161
</LineDetails>                                                                  162
<LineNumber>                                                                    163
</LineNumber>                                                                   164
<ProductDetails>                                                                165
</ProductDetails>                                                               166
<SupplierProductCode>                                                           167
</SupplierProductCode>                                                          168
<SupplierProductText>                                                           169
</SupplierProductText>                                                          170
<Quantities>                                                                    171
</Quantities>                                                                   172
<QuantityOrdered                                                                173
</QuantityOrdered>                                                              174
<QuantityDelivered                                                              175
</QuantityDelivered>                                                            176
<LineDates>                                                                     177
</LineDates>                                                                    178
<OtherDates>                                                                    179
</OtherDates>                                                                   180
<LineReferences>                                                                181
</LineReferences>                                                               182
<OtherReferences>                                                               183
</OtherReferences>                                                              184
<Reference                                                                      185
</Reference>                                                                    186
<PriceDetails>                                                                  187
</PriceDetails>                                                                 188
<Price                                                                          189
</Price>                                                                        190
<LineTotTaxBase                                                                 191
</LineTotTaxBase>                                                               192
<TaxPercent>                                                                    193
</TaxPercent>                                                                   194
<LineTotTax                                                                     195
</LineTotTax>                                                                   196
<LineTotExclTax                                                                 197
</LineTotExclTax>                                                               198
<LineTotInclTax                                                                 199
</LineTotInclTax>                                                               200
<DispatchAdviceNo>                                                              201
</DispatchAdviceNo>                                                             202
<Details GroupLevel="                                                           203
<CompanyPartyNo>                                                                204
</CompanyPartyNo>                                                               205
<OtherDeliveryInfo>                                                             206
</OtherDeliveryInfo>                                                            207
<DeliveryInfo                                                                   208
</DeliveryInfo>                                                                 209
<OrderDate                                                                      210
</OrderDate>                                                                    211
<OtherContactInfo>                                                              212
</OtherContactInfo>                                                             213
<ContactInfo                                                                    214
</ContactInfo>                                                                  215
<BuyerOrderNo>                                                                  216
</BuyerOrderNo>                                                                 217
<RequisitionNo>                                                                 218
</RequisitionNo>                                                                219
<BankName>                                                                      220
</BankName>                                                                     221
<MessageAttachments>                                                            222
</MessageAttachments>                                                           223
<Attachment                                                                     224
</Attachment>                                                                   225
<AttachmentNumber>                                                              226
</AttachmentNumber>                                                             227
<CopyIndicator>                                                                 228
</CopyIndicator>                                                                229
<AttachmentType>                                                                230
</AttachmentType>                                                               231
<AttachmentName>                                                                232
</AttachmentName>                                                               233
<CustomContent>                                                                 234
</CustomContent>                                                                235
<ProcessInstructions>                                                           236
</ProcessInstructions>                                                          237
<Instruction>                                                                   238
</Instruction>                                                                  239
<PIValueParameter                                                               240
<CountryName>                                                                   241
</CountryName>                                                                  242
<Swiftcode>                                                                     243
</Swiftcode>                                                                    244
<IBANcode>                                                                      245
</IBANcode>                                                                     246
<AttachmentIndicator>                                                           247
</AttachmentIndicator>                                                          248
<AttachmentLocation>                                                            249
</AttachmentLocation>                                                           250
<AttachmentArchive>                                                             251
</AttachmentArchive>                                                            252
<ReceiptNotificationRequest>                                                    253
</ReceiptNotificationRequest>                                                   254
<FormatOptions>                                                                 255
</FormatOptions>                                                                256
<Option>                                                                        257
</Option>                                                                       258
<FOValueParameter                                                               259
</FOValueParameter>                                                             260
** TXT01
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"                          001
 xsi:noNamespaceSchemaLocation="D:\Bruker\Dok\Format\PostenInterchange-Complete-002
PS14C-rev3.xsd">                                                                003
** NCTXT
<Factoring>                                                                     001
</Factoring>                                                                    002
