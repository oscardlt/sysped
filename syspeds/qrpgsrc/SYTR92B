      *
      ************************************************************
      *** FINNER DATO/RUNDTURNR.                               ***
      ************************************************************
     FTURER2    IF   E           K DISK
     FTURER4    IF   E           K DISK
     F                                     RENAME(TURERR:TUR4)
     FTURER13   IF   E           K DISK
     F                                     RENAME(TURERR:TUR13)
     FXTUR      O    E           K DISK
      *
     D                 DS
     D  TURACC                 1      2  0
     D  TURAAR                 3      4  0
     D  TURMND                 5      6  0
     D  TURCÅM                 1      6  0
     D                 DS
     D  XFCC                   1      2  0
     D  XFÅR                   3      4  0
     D  XFMN                   5      6  0
     D  XFCÅM                  1      6  0
     D                 DS
     D  XTCC                   1      2  0
     D  XTÅR                   3      4  0
     D  XTMN                   5      6  0
     D  XTCÅM                  1      6  0
     D                 DS
     D  FDATO                  1      8  0
     D  FDTC                   1      2  0
     D  FDTÅ                   3      4  0
     D  FDTM                   5      6  0
     D  FDTD                   7      8  0
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UIN01             1
     C                   PARM                    WBILNR           10
     C                   PARM                    WBILKD            3
     C                   PARM                    ZTRAN             8
     C                   PARM                    ZFPER             4
     C                   PARM                    ZTPER             4
     C*
     C                   MOVE      ZTRAN         WTRAN             8 0
     C*
     C     FINN          KLIST
     C                   KFLD                    WBILNR
     C                   KFLD                    FDATO
     C     FINN2         KLIST
     C                   KFLD                    WBILKD
     C                   KFLD                    FDTC
     C                   KFLD                    FDTÅ
     C                   KFLD                    FDTD
     C     FINN3         KLIST
     C                   KFLD                    WTRAN
     C                   KFLD                    FDTC
     C                   KFLD                    FDTÅ
     C                   KFLD                    FDTD
     C*
     C     *LIKE         DEFINE    TURUND        XRUND
     C                   EXSR      LAGPER
     C*
     C                   SELECT
     C     WBILNR        WHENNE    *BLANKS
     C     FINN          SETLL     TURER2
     C     WBILNR        READE     TURER2                                 10
     C     *IN10         DOWEQ     '0'
     C                   EXSR      BEHDL
     C                   Z-ADD     TURUND        XRUND
     C     WBILNR        READE     TURER2                                 10
     C  N10              ENDDO
      *
     C     WBILKD        WHENNE    *BLANKS
     C     FINN2         SETLL     TURER13
     C     FINN2         READE     TURER13                                10
     C     *IN10         DOWEQ     '0'
     C                   EXSR      BEHDL
     C                   Z-ADD     TURUND        XRUND
     C     FINN2         READE     TURER13                                10
     C  N10              END
     C*
     C     WTRAN         WHENNE    0
     C     FINN3         SETLL     TURER4
     C     FINN3         READE     TURER4                                 10
     C     *IN10         DOWEQ     '0'
     C                   EXSR      BEHDL
     C                   Z-ADD     TURUND        XRUND
     C     FINN3         READE     TURER4                                 10
     C  N10              END
      *
     C                   ENDSL
     C*
     C                   SETON                                        LR
     C                   RETURN
     C*
     C********************************************************
     C     LAGPER        BEGSR
     C********************************************************
     C                   MOVE      ZFPER         XFÅR
     C                   MOVEL     ZFPER         XFMN
     C     XFÅR          IFGT      50
     C                   MOVE      19            XFCC
     C                   ELSE
     C                   MOVE      20            XFCC
     C                   END
     C                   MOVE      ZTPER         XTÅR
     C                   MOVEL     ZTPER         XTMN
     C     XTÅR          IFGT      50
     C                   MOVE      19            XTCC
     C                   ELSE
     C                   MOVE      20            XTCC
     C                   END
     C*
     C     XFMN          IFEQ      1
     C     XFCÅM         SUB       89            FDATO
     C                   ELSE
     C     XFCÅM         SUB       1             FDATO
     C                   END
     C                   MULT      100           FDATO
     C                   MOVE      '01'          FDATO
     C*
     C     XTMN          IFEQ      12
     C     XTCÅM         ADD       89            TDATO             8 0
     C                   ELSE
     C     XTCÅM         ADD       1             TDATO
     C                   END
     C                   MULT      100           TDATO
     C                   SELECT
     C     XTMN          WHENEQ    2
     C                   MOVE      '28'          TDATO
     C     XTMN          WHENEQ    4
     C     XTMN          OREQ      6
     C     XTMN          OREQ      9
     C     XTMN          OREQ      11
     C                   MOVE      '30'          TDATO
     C                   OTHER
     C                   MOVE      '31'          TDATO
     C                   ENDSL
     C*
     C                   ENDSR
     C*
     C********************************************************
     C     BEHDL         BEGSR
     C********************************************************
     C     TURUND        IFNE      0
     C     TURUND        ANDNE     XRUND
     C     TURCÅM        ANDGE     XFCÅM
     C     TURCÅM        ANDLE     XTCÅM
     C                   Z-ADD     TURUND        WRUND
     C                   WRITE     XTURR
     C                   END
     C*
     C                   ENDSR
     C*
