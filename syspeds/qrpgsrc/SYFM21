      *
      **************************************************************
      *** PROGRAM SKAL SPØRRE PÅ OPPDRAG                         ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER    06 07 10 11 13-23                ***
      *** LEDIGE INDIKATORER 28-29 31 32 34-38       60-86 95 96 ***
      **************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Fri søkevei / datofilter funket kun på første poster
10XXX * 02 SH  PTF10 ARCA-FEIL
      * 03 JOV PTF10 Ekstra filter innført, alle CHECK(RB) fjjernet fysisk i DDS
10XXX * 04 SH  PTF10 søke godsmerking
10XXX * 05 JOV PTF10 Cursorplassering etter flytt av TYPE ved kundesøk
10XXX * 06 JOV PTF10 Protecte ekstra filer (F2/ind 32 er ON/OFF protect)    ra )
10XXX * 07 SH  PTF10 Ny parametre   SYTT01
10XXX * 08 JOV PTF10 div DDS-endringer i subfil - TYPE gjeninnført
10XXX * 09 SH  PTF10 innført dato
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 10 JOV PTF11 Søk på kolli/id (godsmerke fra DOKUFM)(indikator 79-frigjort (e.krav/ rød vekt)
11XXX * 11 YBC PTF11 SETT QFSU PÅ SAMME MÅTE UANSETT HVOR KOMMER FRA
11018 * 12 CB  PTF11 Viste ikke AREF i SUBFIL
11018 * 13 SH  PTF11 nullstiller kundenummer ved F4
11018 * 14 SH  PTF11 LOOPER
      *
     FFIRMARC   IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFAXQLOG   IF   E           K DISK
     FTURER     IF   E           K DISK
     FFREETXT   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FFAXLOG03  IF   E           K DISK
     FFRISOL01  IF   E           K DISK
     FFAK8      IF   E           K DISK
     FHEAD2     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD2R)
     FHEAD3     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD3R)
     FHEAD4     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD4R)
     FHEAD5     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD5R)
     FHEAD6     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD6R)
     FHEAD7     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD7R)
     FHEAD9     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD9R)
     FHEAD10    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD10R)
     FHEAD12    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD12R)
     FHEAD13    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD13R)
     FHEAD14    IF   E           K DISK    INFDS(DSHE14)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD14R)
     FHEAD15    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD15R)
     FHEAD16    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD16R)
     FHEAD17    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD17R)
     FHEAD18    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD18R)
     FHEAD19    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD19R)
     FHEAD22    IF   E           K DISK    INFDS(DSHE22)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD22R)
     FHEAD23    IF   E           K DISK    INFDS(DSHE23)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD23R)
     FHEAD24    IF   E           K DISK    INFDS(DSHE24)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD24R)
     FHEAD25    IF   E           K DISK    INFDS(DSHE25)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD25R)
     FHEAD26    IF   E           K DISK    INFDS(DSHE26)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD26R)
     FHEAD27    IF   E           K DISK    INFDS(DSHE27)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD27R)
     FHEAD28    IF   E           K DISK    INFDS(DSHE28)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD28R)
     FHEAD29    IF   E           K DISK    INFDS(DSHE29)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD29R)
     FHEAD30    IF   E           K DISK    INFDS(DSHE30)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD30R)
     FHEAD31    IF   E           K DISK    INFDS(DSHE31)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD31R)
     FHEAD32    IF   E           K DISK    INFDS(DSHE32)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD32R)
     FHEAD34    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD34R)
     FHEAD39    IF   E           K DISK    INFDS(DSHE39)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD39R)
     FHEADDT    IF   E           K DISK    INFDS(DSHEDT)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEADDTR)
N04  FHEAD41    IF   E           K DISK    INFDS(DSHE41)
N04  F                                     USROPN
N04  F                                     RENAME(HEADFR:HEAD41R)
N04  FHEAD42    IF   E           K DISK    INFDS(DSHE42)
N04  F                                     USROPN
N04  F                                     RENAME(HEADFR:HEAD42R)
     FFAIN      IF   E           K DISK
     FFAI2      IF   E           K DISK
     F                                     RENAME(FAINR:FAI2R)
     FDOKUFM1   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FDISP      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FLOCL01    IF   E           K DISK    USROPN
     FISUL02    IF   E           K DISK    USROPN
N03  FSYPARL1   IF   E           K DISK
     FSYFM21FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
NRFA D                 DS
NRFA D  HERFA                  1     35
NRFA D  HERFA15                1     15
NRFA D                 DS
NRFA D  WSRFA35                1     35
NRFA D  WSRFA                  1     15
     D                 DS
     D  FN                     1      7
     D                                     DIM(7)
     D  XFNFMA                 1      7
      * tilleggsgebyrer
n04  D                 DS
n04  D  HESTN1                 1      1
n04  D  HESTN2                 2      2
n04  D  HESTN3                 3      3
n04  D  HESTN4                 4      4
n04  D  HESTN5                 5      5
n04  D  WTGX                   1      5
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  FIAVD                  1      4  0
     D  HEAVD                  1      4  0
     D                 DS
     D  LODOCN                 1     12
     D  LODOC8                 1      8
     D                 DS
     D  FSSOK                  1     35
     D  FSSNDN                 3     17
     D  FSSNDX                17     17
     D                 DS
EV5  D  HEDTÅ                  1      4  0
EV5  D  HEDTM                  5      6  0
EV5  D  HEDTD                  7      8  0
EV5  D  HEDTOP                 1      8  0
EV5  D                 DS
EV5  D  WSDTOD                 1      2  0
EV5  D  WSDTOM                 3      4  0
EV5  D  WSDTOÅ                 5      6  0
EV5  D  WSDTOP                 1      6  0
     D                 DS
     D  WSDT1D                 1      2  0
     D  WSDT1M                 3      4  0
     D  WSDT1Å                 5      6  0
     D  WSDT1W                 1      6  0
     D                 DS
EV5  D  XDT1Å                  1      4  0
EV5  D  XDT1M                  5      6  0
EV5  D  XDT1D                  7      8  0
EV5  D  XSGDT                  1      8  0
     D                 DS
     D  WSDT2D                 1      2  0
     D  WSDT2M                 3      4  0
     D  WSDT2Å                 5      6  0
     D  WSDT2W                 1      6  0
     D                 DS
EV5  D  XDT2Å                  1      4  0
EV5  D  XDT2M                  5      6  0
EV5  D  XDT2D                  7      8  0
EV5  D  XKNDT                  1      8  0
     D                 DS
     D  WSDT4D                 1      2  0
     D  WSDT4M                 3      4  0
     D  WSDT4Å                 5      6  0
     D  WSDT4W                 1      6  0
     D                 DS
EV5  D  XDT4Å                  1      4  0
EV5  D  XDT4M                  5      6  0
EV5  D  XDT4D                  7      8  0
EV5  D  XOTDT                  1      8  0
     D                 DS
     D  WSDT5D                 1      2  0
     D  WSDT5M                 3      4  0
     D  WSDT5Å                 5      6  0
     D  WSDT5W                 1      6  0
     D                 DS
EV5  D  XDT5Å                  1      4  0
EV5  D  XDT5M                  5      6  0
EV5  D  XDT5D                  7      8  0
EV5  D  XHADT                  1      8  0
     D                 DS
     D  WSDT6D                 1      2  0
     D  WSDT6M                 3      4  0
     D  WSDT6Å                 5      6  0
     D  WSDT6W                 1      6  0
     D                 DS
EV5  D  XDT6Å                  1      4  0
EV5  D  XDT6M                  5      6  0
EV5  D  XDT6D                  7      8  0
EV5  D  XCODT                  1      8  0
     D                 DS
     D  WSDT7D                 1      2  0
     D  WSDT7M                 3      4  0
     D  WSDT7Å                 5      6  0
     D  WSDT7W                 1      6  0
     D                 DS
     D  XDT7Å                  1      4  0
     D  XDT7M                  5      6  0
     D  XDT7D                  7      8  0
     D  XFRTID                 1      8  0
     D                 DS
     D  WSDT8D                 1      2  0
     D  WSDT8M                 3      4  0
     D  WSDT8Å                 5      6  0
     D  WSDT8W                 1      6  0
     D                 DS
     D  XDT8Å                  1      4  0
     D  XDT8M                  5      6  0
     D  XDT8D                  7      8  0
     D  XFRIDT                 1      8  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAÅ                 5      6  0
     D  WSDTAW                 1      6  0
     D                 DS
     D  XDTAÅ                  1      4  0
     D  XDTAM                  5      6  0
     D  XDTAD                  7      8  0
     D  XRFADT                 1      8  0
     D                 DS
     D  HEHAWB                 1      9
     D  HEHAW6                 4      9
     D                 DS
     D  HEGN                   1     15
     D  HEGN2                 12     15
     D                 DS
     D  HEGNN                  1     15
     D  HEGNN2                12     15
     D                 DS
     D  WSGN                   1     15
     D  WSGNA                  1      4
     D  WSGNB                  5     15
     D                 DS
     D  WSPOSS                 1      8
     D  WSPSSA                 1      3
     D  WSPSSB                 4      8
     D                 DS
     D  HEPOS1                 1      7
     D  HEPO1A                 1      3
     D  HEPO1B                 4      7
     D                 DS
     D  DSTID                  1     14  0
     D  DSCENT                11     14  0
      *____________________________________________________________
      * Definisjon av parameterlisten som brukes ved kall av SM220R
      * (automatisk booking via linje). TdV IS må være installert
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
      * AUTTRM = '1' ---> automatisk sending uten å se ekstra bildet
      * AUTTRM = annet ---> visning av ekstra bildet med opplysninger
      * OBS. Finnes det syntax feil vises ekstra bildet uansett
     D  AUTTRM                 1      1
     D  AUTPID                 2     18
     D  AUTALN                19     21
     D  AUTAWB                22     29
     D  AUTINF                 1     29
     D DSHE14          DS
     D  OPHE14                 9      9
     D DSHE22          DS
     D  OPHE22                 9      9
     D DSHE23          DS
     D  OPHE23                 9      9
     D DSHE24          DS
     D  OPHE24                 9      9
     D DSHE25          DS
     D  OPHE25                 9      9
     D DSHE26          DS
     D  OPHE26                 9      9
     D DSHE27          DS
     D  OPHE27                 9      9
     D DSHE28          DS
     D  OPHE28                 9      9
     D DSHE29          DS
     D  OPHE29                 9      9
     D DSHE30          DS
     D  OPHE30                 9      9
     D DSHE31          DS
     D  OPHE31                 9      9
     D DSHE32          DS
     D  OPHE32                 9      9
     D DSHE35          DS
     D  OPHE35                 9      9
     D DSHE39          DS
     D  OPHE39                 9      9
     D DSHEDT          DS
     D  OPHEDT                 9      9
N04  D DSHE41          DS
N04  D  OPHE41                 9      9
N04  D DSHE42          DS
N04  D  OPHE42                 9      9
      *___________________
      * DS for System Data
      *"""""""""""""""""""
     D                SDS
     D  WUSER                254    263
N03   * For xlate mellom Upper Case og Lower Case
N03  D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
N03  D                                     UVWXYZÆØÅ')
N03  D LC              C                   CONST('abcdefghijklmnopqrst-
N03  D                                     uvwxyzæøå')
N03  D HenMot          s             12    VARYING
     C*
     C                   EXSR      INIT
     C*
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     28            POSNBR
     C*
     C   03              GOTO      SLUTT
     C     BG2           TAG
     C   41              MOVE      *ZEROS        WSOPD
     C                   EXSR      KDTFM1
     C                   EXFMT     BILDE02
     C                   EXSR      KDTFM1
     C                   MOVEA     '000'         *IN(97)
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '0000'        *IN(57)
N04  C                   MOVEA     '0'           *IN(67)
     C*
      *
N06  C     *in02         IFEQ      '1'
N06  C     *IN32         IFEQ      '1'
N06  C                   MOVE      '0'           *IN32
N06  C                   ELSE
N06  C                   MOVE      '1'           *IN32
N06  C                   END
N06  C                   GOTO      BG2
N06  C                   END
     C*
     C   12
     COR 03              GOTO      SLUTT
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
     C*
     C* TEST DEPARTMENT IF CHANGED
     C*
     C     WSAVD         IFNE      *ZEROS
     C     WSAVD         ANDNE     WSAVDO
     C                   EXSR      BYAVD
     C   30              MOVE      'SPA0001'     MSGNR
     C   30              GOTO      BG2
     C                   END
     C   04              DO
     C     LINNBR        IFEQ      12
     C                   EXSR      SØKKUN
S05  C*                  Z-ADD     53            POSNBR
S05  C                   Z-ADD     43            POSNBR
     C                   GOTO      BG2
     C                   ELSE
     C                   EXSR      SØKDTA
     C                   GOTO      BG2
     C                   END
     C                   END
     C     *IN19         IFEQ      '1'
     C                   EXSR      EASY
     C                   GOTO      BG2
     C                   ENDIF
     C     *IN20         IFEQ      '1'
     C     *IN21         OREQ      '1'
     C                   EXSR      SFSR
     C                   GOTO      BG2
     C                   ENDIF
     C     *IN22         IFEQ      '1'
     C                   EXSR      SRLOGG
     C                   GOTO      BG2
     C                   ENDIF
     C     *IN23         IFEQ      '1'
     C                   EXSR      SFVR
     C                   GOTO      BG2
     C                   ENDIF
     C   24              DO
     C                   EXSR      CMDT2
     C                   GOTO      BG2
     C                   END
     C*
     C                   EXSR      TESTB2
     C   30              GOTO      BG2
NV5   *
NV5  C     WSGNÅR        IFEQ      0
NV5  C                   MOVE      *ZEROS        WSGNÅ4
NV5  C                   ELSE
NV5  C     WSGNÅR        IFGT      50
NV5  C     WSGNÅR        ADD       1900          WSGNÅ4            4 0
NV5  C                   ELSE
NV5  C     WSGNÅR        ADD       2000          WSGNÅ4
NV5  C                   END
NV5  C                   END
     C*
     C                   MOVE      '0'           XIN08             1
     C                   MOVE      '0'           XIN09             1
     C   08              MOVE      '1'           XIN08
     C     *IN08         IFEQ      '1'
     C     WSOPD         ANDNE     *ZEROS
     C                   GOTO      BG4
     C                   END
     C   09              MOVE      '1'           XIN09
     C     *IN09         IFEQ      '1'
     C     WSOPD         IFNE      *ZEROS
     C     WSFN          ORNE      *ZEROS
     C                   GOTO      BG5
     C                   END
     C                   END
     C                   MOVE      *ZEROS        EXAKT             2 0
     C*
     C     START         TAG
N03  c                   move      *zeros        LestRec           9 0
     C                   MOVE      '1'           *IN93
     C                   EXSR      KDTFM1
     C                   WRITE     SUBCTL
     C                   EXSR      KDTFM1
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C                   EXSR      LESREC
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        8
     C                   ADD       1             ZRECNO
     C     HEUR          IFEQ      'H'
     C     FREETK        CHAIN     DISP                               89
     C                   MOVE      DISTEF        HESDF
     C                   MOVE      DISTET        HESDT
EV5  C                   MOVE      DIDATF        HEDTOP
     C                   END
     C                   EXSR      KDTFM2
     C     HESGM         COMP      *BLANKS                            2727
S12  C* N51              MOVE      HERFA         HEALT
N12  C  N51              MOVE      HERFA15       HEALT
     C   51              MOVE      *BLANKS       HEALT
     C   51              MOVEL     HEHAWB        HEALT
     C   52              MOVEL     HETRCN        HEALT
     C   53FSKODE        IFEQ      'IFB'
     C     FSSNDX        ANDNE     ' '
     C                   MOVEL     FSSNDN        HEALT
     C                   ELSE
     C                   MOVEL     FSSOK         HEALT
     C                   END
     C   56              MOVEL     HESAML        HEALT
     C  N53HEUR          IFEQ      'D'
     C                   MOVE      HESAML        HEALT
     C                   MOVE      HEHAW6        HEALT
     C                   END
     C   57              MOVEL     FMMRK1        HEALT
     C   57              MOVE      FMMRK1        TMPMRK           20
     C   57              MOVEL     TMPMRK        WSGNND
      *
     C   59              MOVEL     HXSNDN        HEALT                          15 første
     C   59              MOVE      HXSNDN        TMPMRK5           5             5 siste
     C   59              MOVE      *blanks       WSGNND
     C   59              MOVEL     TMPMRK5       WSGNND
N04  C   67              MOVEL     HEGM1         HEALT
     C     FREETK        CHAIN     FAXLOG03                           87
     C                   MOVE      ' '           QFSU
     C  N87LOGKEY        CHAIN     FAXQLOG                            33
     C  N87
     CAN 33              DO
     C     LOFAXN        IFEQ      'MAIL'
     C                   MOVE      'E'           QFSU
     C                   else
     C                   MOVE      'I'           QFSU
     C                   END
     C                   END
     C     TRFA11        COMP      *BLANKS                            8989
     C  N89TRFA21        COMP      *BLANKS                            8989
     C                   WRITE     SUBFIL
     C     ST21          TAG
     C                   EXSR      LESREC
     C  N94              EXSR      MOVDT1
     C  N94              END
     C                   END
      *
      * KUN 1 POST...SOM MATCHER 100 %  -  DIREKTE HVIS F8/F9
     C     EXAKT         IFEQ      1                                             KUN 1
     C     XIN08         IFEQ      '1'
     C                   MOVE      HEAVD         UAVD
     C                   MOVE      HEOPD         UOPD
     C                   GOTO      BG4
     C                   END
     C     XIN09         IFEQ      '1'
     C                   MOVE      HEAVD         UAVD
     C                   MOVE      HEOPD         UOPD
     C                   GOTO      BG5
     C                   END
     C                   END
     C*
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   WRITE     NYVARE
     C                   GOTO      ST41
     C                   END
     C*          START4    TAG
     C                   EXSR      KDTFM1
     C                   WRITE     SUBCTL
     C                   EXSR      KDTFM1
     C*
     C*** AVSLUTT
     C     ST41          TAG
     C                   EXFMT     BUNN
     C                   SETOFF                                       9830
     C   01              Z-ADD     GMLIN         LINNBR
     C   01              Z-ADD     28            POSNBR
     C   01              GOTO      BG2
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C   12              Z-ADD     GMLIN         LINNBR
     C   12              Z-ADD     28            POSNBR
     C   12              GOTO      BG2
     C   24              EXSR      CMDFT1
     C   24              GOTO      START3
     C   23
     CANN28              EXSR      CMDF23
     C   23              GOTO      START3
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94              EXSR      MOVDT2
     C                   GOTO      START2
     C                   END
     C   26              GOTO      ST41
     C*
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HHENT
     C   98              GOTO      START3
     C                   END
     C*
     C     WSNR          IFEQ      '5 '
     C     WSNR          OREQ      ' 5'
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C                   EXSR      UPDSBF
     C*
     C     BG4           TAG
     C                   EXSR      UTOPD
     C   01              Z-ADD     GMLIN         LINNBR
     C   01              Z-ADD     28            POSNBR
     C   01              GOTO      BG2
s06  C*  02              GOTO      BG2
     C   03              GOTO      SLUTT
     C   12XIN08         IFEQ      '1'
     C                   Z-ADD     GMLIN         LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      BG2
     C                   ELSE
     C                   Z-ADD     GMLIN         LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      START3
     C                   END
     C                   END
     C     WSNR          IFEQ      '6 '
     C     WSNR          OREQ      ' 6'
     C                   EXSR      VISTUR
     C                   EXSR      UPDSBF
     C                   GOTO      START
     C                   END
     C*
     C     WSNR          IFEQ      '7 '
     C     WSNR          OREQ      ' 7'
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C                   CALL      'SYFA64'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    KUNDNU            8 0
     C                   PARM                    KUNDNU            8 0
     C                   EXSR      UPDSBF
     C                   MOVE      ' '           WSNR
     C                   MOVE      *BLANKS       WSNR
     C                   GOTO      START
     C                   END
     C*
     C     WSNR          IFEQ      '8 '
     C     WSNR          OREQ      ' 8'
     C                   EXSR      VISFRE
     C                   EXSR      UPDSBF
     C                   GOTO      START
     C                   END
     C     WSNR          IFEQ      'T '
     C     WSNR          OREQ      ' T'
     C     WSNR          OREQ      '25'
     C                   EXSR      VISTT
     C                   EXSR      UPDSBF
     C                   MOVE      *BLANKS       WSNR
     C                   GOTO      START
     C                   END
     C     WSNR          IFEQ      'A '
     C     WSNR          OREQ      ' A'
     C     WSNR          OREQ      '26'
     C                   EXSR      VISTTT
     C                   EXSR      UPDSBF
     C                   MOVE      ' '           WSNR
     C                   GOTO      START
     C                   END
     C*
     C     WSNR          IFEQ      '9 '
     C     WSNR          OREQ      ' 9'
     C                   EXSR      VISFAX
     C                   EXSR      UPDSBF
     C  N30              GOTO      START
     C   30              GOTO      START3
     C                   END
     C     WSNR          IFEQ      '50'
     C                   EXSR      DOKUME
     C                   EXSR      UPDSBF
     C                   GOTO      START3
     C                   END
     C     WSNR          IFEQ      '51'
     C                   EXSR      ARKIVS
     C                   EXSR      UPDSBF
     C                   GOTO      START3
     C                   END
     C     WSNR          IFEQ      '52'
     C     WSNR          OREQ      'S '
     C     WSNR          OREQ      ' S'
     C                   EXSR      PRTSKILL
     C                   EXSR      UPDSBF
     C                   GOTO      START3
     C                   END
     C     WSNR          IFEQ      '55'
     C     WSNR          OREQ      'W '
     C     WSNR          OREQ      ' W'
     C                   EXSR      DSPWEB
     C                   EXSR      UPDSBF
     C                   GOTO      START3
     C                   END
     C*
     C     BG5           TAG
     C                   EXSR      UTFAKT
     C   01              Z-ADD     GMLIN         LINNBR
     C   01              Z-ADD     28            POSNBR
     C   01              GOTO      BG2
s06  C*  02              Z-ADD     GMLIN         LINNBR
s06  C*  02              Z-ADD     28            POSNBR
s06  C*  02              GOTO      BG2
     C   12XIN09         IFEQ      '1'
     C                   Z-ADD     GMLIN         LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      BG2
     C                   ELSE
     C                   GOTO      START3
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
N13  c                   move      *zeros        wskn
     C                   MOVE      *BLANKS       USØKNV           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKN
     C                   PARM                    FIFIRM
     C                   PARM                    USØKNV           30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     UTOPD         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   CALL      'SYFM21A'
     C                   PARM                    FIFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      2                                      02
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      9                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     UTFAKT        BEGSR
     C***********************************************
     C                   CALL      'SYFM21B'
     C                   PARM                    FIFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      2                                      02
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      9                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
N10   * sendinsgsnr oppgitt i fri søkevei ifb med 20 lang (skannet)
N10  C                   IF        WSFRI1='IFB' and %subst(WSFRI2:1:3)='401'
N10  C                             and  %subst(WSFRI2:20:1)<>' '
N10  C                             and  %subst(WSFRI2:21:1)= ' '
N10  C                   eval      WSFRI2=%subst(WSFRI2:4:17)
N10  C                   ENDIF
      * GJORT FRA BUNNEN VILLE DET VÆRE MYE MER NATURLIG Å BEHANDLE
      * F8 VED OPPD-NR / FAKTNR PÅ LIK LINJE MED F8 OG ANDRE VALG....
     C   08              DO
     C     WSOPD         IFNE      *ZEROS
     C                   GOTO      STTB2
     C                   END
     C                   END
     C   09              DO
     C     WSFN          IFNE      *ZEROS
     C     WSOPD         ORNE      *ZEROS
     C                   GOTO      STTB2
     C                   END
     C                   END
     C*
     C     WSAVD         COMP      *ZEROS                                 40
     C*
N09  C     WSDT9W        IFNE      *zeros
N09  C                   SETON                                        4360
N09  C                   MOVE      WSDT9W        WSDT1W
N09  C                   GOTO      STTB21
N09  C                   end
     C     WSFN          COMP      *ZEROS                             4141
     C   41              GOTO      STTB22
     C     WSOPD         COMP      *ZEROS                             4242
     C   42              GOTO      STTB22
     C     WSSG          COMP      *BLANKS                            4343
     C   43WSSG          COMP      '*'                                    60
     C   43
     CANN60WSSG          COMP      '*AL'                                  60
     C   43
     CANN60WSSG          COMP      'ALL'                                  60
     C   43              GOTO      STTB21
     C     WSGNB         COMP      *BLANKS                            4444
     C   44              GOTO      STTB22
     C     WSKN          IFNE      0
     C     WSTYPE        COMP      'A '                                   50
     C   50              GOTO      STTB21
     C     WSTYPE        COMP      'KF'                                   46
     C   46              GOTO      STTB21
     C     WSTYPE        COMP      'SF'                                   45
     C   45              GOTO      STTB21
     C     WSTYPE        COMP      'K '                                   55
     C   55              GOTO      STTB21
     C     WSTYPE        COMP      'S '                                   54
     C   54              GOTO      STTB21
     C                   SETON                                        3097
s05  C*                  Z-ADD     13            LINNBR
s05  C*                  Z-ADD     30            POSNBR
n05  C                   Z-ADD     12            LINNBR
n05  C                   Z-ADD     43            POSNBR
     C                   MOVE      'SPT0048'     MSGNR
     C                   GOTO      SLTB2
     C                   END
N04  C     WSGM1         COMP      *BLANKS                            6767
N04  C   67              GOTO      STTB22
     C     WSOT          COMP      *BLANKS                            4747
     C   47              GOTO      STTB21
     C     WSRFA         COMP      *BLANKS                            4848
     C   48              GOTO      STTB21
     C     WSPRO         COMP      *ZEROS                             4949
     C   49              GOTO      STTB22
     C     WSHAWB        COMP      *BLANKS                            5151
     C   51              GOTO      STTB21
     C     WSCONT        COMP      *BLANKS                            5252
     C   52              GOTO      STTB21
     C     WSFRI1        COMP      *BLANKS                            5353
     C   53              GOTO      STTB21
     C     WSSAML        COMP      *BLANKS                            5656
     C   56              GOTO      STTB22
     C     WSMRK1        COMP      *BLANKS                            5757
     C     *IN57         IFEQ      *ON
     C                   MOVEL     WSMRK1        WSMR13            3
     C                   MOVEL     WSMRK1        WSMRK120         20
     C     WSMR13        IFEQ      '401'
     C     WSMR13        OREQ      '402'
     C                   MOVEA     '001'         *IN(57)                         =SETT 59
     C                   GOTO      STTB22
     C                   END
     C                   END
     C   57              GOTO      STTB22
     C     WSSDF         COMP      *BLANKS                            5858
     C   58              GOTO      STTB21
     C*
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'DIV0064'     MSGNR
     C                   GOTO      SLTB2
     C*
     C     STTB2         TAG
     C                   SETOFF                                       40
     C* DIREKTE OPPDRAG
     C*
     C   08              DO
     C     WSOPD         IFNE      *ZEROS
     C                   MOVE      WSAVD         XAVD
     C     HEADFK        CHAIN     HEADF                              98
     C   98              SETON                                        30
     C   98              Z-ADD     9             LINNBR
     C   98              Z-ADD     28            POSNBR
     C   98              MOVE      'DIV0066'     MSGNR
     C   98              GOTO      SLTB2
     C                   SETON                                        42
     C                   END
     C                   END
     C*
     C*DIREKTE FAKTURA
     C*
     C   09              DO
     C     WSFN          IFNE      *ZEROS
     C     WSOPD         ORNE      *ZEROS
     C     WSFN          IFEQ      0
     C                   MOVE      '0'           *IN99
     C                   MOVE      WSAVD         XAVD
     C                   ELSE
     C     WSFN          CHAIN     FAIN                               99
     C  N99              MOVE      FIAVD         XAVD
     C  N99              MOVE      FIOPD         WSOPD
     C                   END
     C  N99HEADFK        CHAIN     HEADF                              99
     C   99              SETON                                        30
     C   99              Z-ADD     28            POSNBR
     C   99WSFN          IFEQ      0
     C                   Z-ADD     9             LINNBR
     C                   MOVE      'DIV0066'     MSGNR
     C                   MOVEA     '10'          *IN(98)
     C                   GOTO      SLTB2
     C                   ELSE
     C                   Z-ADD     8             LINNBR
     C                   MOVE      'DIV0065'     MSGNR
     C                   GOTO      SLTB2
     C                   END
     C                   SETON                                        41
     C                   END
     C                   END
     C*
     C*
     C                   MOVE      HEAVD         UAVD
     C                   MOVE      WSOPD         UOPD
     C                   GOTO      STTB22
     C*
     C     STTB21        TAG
     C                   EXSR      FLYTDT
     C*
     C     STTB22        TAG
     C   41              MOVE      WSFN          XFN1              7 0
     C   41              Z-ADD     8             GMLIN
     C   42              Z-ADD     9             GMLIN
     C   43              Z-ADD     10            GMLIN
     C   44              Z-ADD     11            GMLIN
     C   45
     COR 46
     COR 50
     COR 54
     COR 55              Z-ADD     12            GMLIN
      * DE 3 NESTE LINJER ØKT MED 1
N04  C   67              Z-ADD     13            GMLIN
     C   47              Z-ADD     14            GMLIN
     C   48              Z-ADD     15            GMLIN
     C   49              Z-ADD     16            GMLIN
     C   51              Z-ADD     17            GMLIN
     C   52              Z-ADD     18            GMLIN
     C   53              Z-ADD     20            GMLIN
     C   40              Z-ADD     1             XAVD
     C   40              Z-ADD     9999          XAVD2
     C  N40              MOVE      WSAVD         XAVD
     C  N40              MOVE      WSAVD         XAVD2
     C*
     C     SLTB2         ENDSR
     C*
     C***********************************************
     C     HHENT         BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98
     CAN 28WSNR          IFEQ      '2 '
     C     WSNR          OREQ      ' 2'
     C                   MOVE      'E'           UTYPE
     C                   MOVE      HEAVD         UAVDE
     C                   MOVE      HEOPD         UOPDE
     C                   MOVE      HESG          USGE
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N98
     CAN 28WSNR          IFEQ      '3 '
     C     WSNR          OREQ      ' 3'
     C                   MOVE      'K'           UTYPE
     C                   MOVE      HEAVD         UAVDE
     C                   MOVE      HEOPD         UOPDE
     C                   MOVE      HESG          USGE
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N98WSNR          IFEQ      '5 '
     C     WSNR          OREQ      ' 5'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '6 '
     C     WSNR          OREQ      ' 6'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '7 '
     C     WSNR          OREQ      ' 7'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '8 '
     C     WSNR          OREQ      ' 8'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '9 '
     C     WSNR          OREQ      ' 9'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      'T '
     C     WSNR          OREQ      ' T'
     C     WSNR          OREQ      '25'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      'A '
     C     WSNR          OREQ      ' A'
     C     WSNR          OREQ      '26'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '50'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '51'
     C     ARKIV         ANDEQ     'J'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '52'
     C     WSNR          OREQ      'S '
     C     WSNR          OREQ      ' S'
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '55'
     C     WSNR          OREQ      'W '
     C     WSNR          OREQ      ' W'
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FLYTDT        BEGSR
     C***********************************************
     C   43              DO
NV5  C     WSDT1W        IFEQ      0
NV5  C                   MOVE      *ZEROS        XSGDT
NV5  C                   ELSE
     C                   MOVE      WSDT1D        XDT1D
     C                   MOVE      WSDT1M        XDT1M
SV5  C*                    MOVE WSDT1Å    XDT1Å
NV5  C     WSDT1Å        IFGT      50
NV5  C     WSDT1Å        ADD       1900          XDT1Å
NV5  C                   ELSE
NV5  C     WSDT1Å        ADD       2000          XDT1Å
NV5  C                   END
NV5  C                   END
     C                   END
     C   45
     COR 46
     COR 50
     COR 54
     COR 55              DO
NV5  C     WSDT2W        IFEQ      0
NV5  C                   MOVE      *ZEROS        XKNDT
NV5  C                   ELSE
     C                   MOVE      WSDT2D        XDT2D
     C                   MOVE      WSDT2M        XDT2M
SV5  C*                    MOVE WSDT2Å    XDT2Å
NV5  C     WSDT2Å        IFGT      50
NV5  C     WSDT2Å        ADD       1900          XDT2Å
NV5  C                   ELSE
NV5  C     WSDT2Å        ADD       2000          XDT2Å
NV5  C                   END
NV5  C                   END
     C                   END
     C   47              DO
NV5  C     WSDT4W        IFEQ      0
NV5  C                   MOVE      *ZEROS        XOTDT
NV5  C                   ELSE
     C                   MOVE      WSDT4D        XDT4D
     C                   MOVE      WSDT4M        XDT4M
SV5  C*                    MOVE WSDT4Å    XDT4Å
NV5  C     WSDT4Å        IFGT      50
NV5  C     WSDT4Å        ADD       1900          XDT4Å
NV5  C                   ELSE
NV5  C     WSDT4Å        ADD       2000          XDT4Å
NV5  C                   END
NV5  C                   END
     C                   END
     C   51              DO
NV5  C     WSDT5W        IFEQ      0
NV5  C                   MOVE      *ZEROS        XHADT
NV5  C                   ELSE
     C                   MOVE      WSDT5D        XDT5D
     C                   MOVE      WSDT5M        XDT5M
SV5  C*                    MOVE WSDT5Å    XDT5Å
NV5  C     WSDT5Å        IFGT      50
NV5  C     WSDT5Å        ADD       1900          XDT5Å
NV5  C                   ELSE
NV5  C     WSDT5Å        ADD       2000          XDT5Å
NV5  C                   END
NV5  C                   END
     C                   END
     C   52              DO
NV5  C     WSDT6W        IFEQ      0
NV5  C                   MOVE      *ZEROS        XCODT
NV5  C                   ELSE
     C                   MOVE      WSDT6D        XDT6D
     C                   MOVE      WSDT6M        XDT6M
SV5  C*                    MOVE WSDT6Å    XDT6Å
NV5  C     WSDT6Å        IFGT      50
NV5  C     WSDT6Å        ADD       1900          XDT6Å
NV5  C                   ELSE
NV5  C     WSDT6Å        ADD       2000          XDT6Å
NV5  C                   END
NV5  C                   END
     C                   END
     C   58              DO
     C     WSDT7W        IFEQ      0
     C                   MOVE      *ZEROS        XFRTID
     C                   ELSE
     C                   MOVE      WSDT7D        XDT7D
     C                   MOVE      WSDT7M        XDT7M
     C     WSDT7Å        IFGT      50
     C     WSDT7Å        ADD       1900          XDT7Å
     C                   ELSE
     C     WSDT7Å        ADD       2000          XDT7Å
     C                   END
     C                   END
     C                   END
      *
      *
     C   48              DO
     C     WSDTAW        IFEQ      0
     C                   MOVE      *ZEROS        XRFADT
     C                   ELSE
     C                   MOVE      '1'           *IN40
     C                   MOVE      WSDTAD        XDTAD
     C                   MOVE      WSDTAM        XDTAM
     C     WSDTAÅ        IFGT      50
     C     WSDTAÅ        ADD       1900          XDTAÅ
     C                   ELSE
     C     WSDTAÅ        ADD       2000          XDTAÅ
     C                   END
     C                   END
     C                   END
     C*
     C   53              DO
     C     WSDT8W        IFEQ      0
     C                   MOVE      *ZEROS        XFRIDT
     C                   ELSE
     C                   MOVE      WSDT8D        XDT8D
     C                   MOVE      WSDT8M        XDT8M
     C     WSDT8Å        IFGT      50
     C     WSDT8Å        ADD       1900          XDT8Å
     C                   ELSE
     C     WSDT8Å        ADD       2000          XDT8Å
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C                   EXSR      OPENF
     C   41
     CANN40FAI2K         SETLL     FAI2
     C   41
     CAN 40WSFN          SETLL     FAIN
     C   42
     CANN40HEADFK        SETLL     HEADF
     C   42
     CAN 40WSOPD         SETLL     HEAD23
     C     *IN60         IFEQ      '0'
     C   43
     CANN40HEAD2K        SETLL     HEAD2
     C   43
     CAN 40HEA24K        SETLL     HEAD24
     C                   ELSE
     C   43
     CANN40HEA22K        SETLL     HEAD22
     C   43
     CAN 40HEADTK        SETLL     HEADDT
     C                   END
     C   44
     CANN40HEAD3K        SETLL     HEAD3
     C   44
     CAN 40WSGN          SETLL     HEAD18
     C   45
     CANN40HKNKEY        SETLL     HEAD4
     C   45
     CAN 40HKNK2         SETLL     HEAD27
     C   46
     CANN40HKNKEY        SETLL     HEAD5
     C   46
     CAN 40HKNK2         SETLL     HEAD28
     C   47
     CANN40HEAD6K        SETLL     HEAD6
     C   47
     CAN 40HEA30K        SETLL     HEAD30
     C   48
     CANN40HEAD7K        SETLL     HEAD7
     C   48
     CAN 40HEAD17K       SETLL     HEAD17
     C   49
     CANN40HEAD9K        SETLL     HEAD9
     C   49
     CAN 40HEA14K        SETLL     HEAD14
     C   50
     CANN40HKNKEY        SETLL     HEAD10
     C   50
     CAN 40HKNK2         SETLL     HEAD29
     C   51
     CANN40HEA12K        SETLL     HEAD12
     C   51
     CAN 40HEA31K        SETLL     HEAD31
     C   52
     CANN40HEA13K        SETLL     HEAD13
     C   52
     CAN 40HEA32K        SETLL     HEAD32
     C   53FRIS1K        SETLL     FRISOL01
     C   54
     CANN40HKNKEY        SETLL     HEAD15
     C   54
     CAN 40HKNK2         SETLL     HEAD25
     C   55
     CANN40HKNKEY        SETLL     HEAD16
     C   55
     CAN 40HKNK2         SETLL     HEAD26
     C   56WSSAML        SETLL     HEAD19
     C   57WSMRK1        SETLL     DOKUFM1
     C   58HEA34K        SETLL     HEAD34
     C   59WSMRK120      SETLL     HEAD39
     C*
N04  C  N40
N04  CAN 67HEA41K        SETLL     HEAD41
N04  C   40
N04  CAN 67HEA42K        SETLL     HEAD42
     C                   ENDSR
     C*
      ***********************************************
     C     OPENF         BEGSR
      ***********************************************
     C   42
     CAN 40OPHE23        IFNE      '1'
     C                   OPEN      HEAD23
     C                   END
     C     *IN60         IFEQ      '0'
     C   43
     CAN 40OPHE24        IFNE      '1'
     C                   OPEN      HEAD24
     C                   END
     C                   ELSE
     C   43
     CANN40OPHE22        IFNE      '1'
     C                   OPEN      HEAD22
     C                   END
     C   43
     CAN 40OPHEDT        IFNE      '1'
     C                   OPEN      HEADDT
     C                   END
     C                   END
     C   45
     CAN 40OPHE27        IFNE      '1'
     C                   OPEN      HEAD27
     C                   END
     C   46
     CAN 40OPHE28        IFNE      '1'
     C                   OPEN      HEAD28
     C                   END
     C   47
     CAN 40OPHE30        IFNE      '1'
     C                   OPEN      HEAD30
     C                   END
     C   49
     CAN 40OPHE14        IFNE      '1'
     C                   OPEN      HEAD14
     C                   END
     C   50
     CAN 40OPHE29        IFNE      '1'
     C                   OPEN      HEAD29
     C                   END
     C   51
     CAN 40OPHE31        IFNE      '1'
     C                   OPEN      HEAD31
     C                   END
     C   52
     CAN 40OPHE32        IFNE      '1'
     C                   OPEN      HEAD32
     C                   END
     C   54
     CAN 40OPHE25        IFNE      '1'
     C                   OPEN      HEAD25
     C                   END
     C   55
     CAN 40OPHE26        IFNE      '1'
     C                   OPEN      HEAD26
     C                   END
     C   59OPHE39        IFNE      '1'
     C                   OPEN      HEAD39
     C                   END
N04  C   67
N04  CANN40OPHE41        IFNE      '1'
N04  C                   OPEN      HEAD41
N04  C                   END
N04  C   67
N04  CAN 40OPHE42        IFNE      '1'
N04  C                   OPEN      HEAD42
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
     C     STLF          TAG
      *
N03  C     MAXLES        ifne      *zeros
N03  C     LestRec       andgt     Maxles
N03  c                   move      *on           *in94
N03  c                   move      *on           *in30
N03  C                   MOVE      'JOV1524'     MSGNR
N03  c                   goto      UtLes
N03  C                   endif
      *
     C   41
     CANN40              READ      FAI2                                   94
     C   41
     CAN 40              READ      FAIN                                   94
     C   42
     CANN40              READ      HEADF                                  94
     C   42
     CAN 40              READ      HEAD23                                 94
     C     *IN60         IFEQ      '0'
     C   43
     CANN40              READ      HEAD2                                  94
     C   43
     CAN 40WSSG          READE     HEAD24                                 94
     C                   ELSE
     C   43
     CANN40              READ      HEAD22                                 94
     C   43
     CAN 40              READ      HEADDT                                 94
     C                   END
     C   44
     CANN40              READ      HEAD3                                  94
     C   44
     CAN 40              READ      HEAD18                                 94
     C   45
     CANN40              READ      HEAD4                                  94
     C   45
     CAN 40WSKN          READE     HEAD27                                 94
     C   46
     CANN40              READ      HEAD5                                  94
     C   46
     CAN 40WSKN          READE     HEAD28                                 94
     C   47
     CANN40              READ      HEAD6                                  94
     C   47
     CAN 40WSOT          READE     HEAD30                                 94
     C   48
     CANN40              READ      HEAD7                                  94
     C                   IF        XRFADT = 0
     C   48
     CAN 40              READ      HEAD17                                 94
     C                   ELSE
     C   48
     C*N 40WSRFA         READE     HEAD17                                 94
     CAN 40WSRFA35       READE     HEAD17                                 94
     C                   END
     C   49
     CANN40              READ      HEAD9                                  94
     C   49
     CAN 40WSPRO         READE     HEAD14                                 94
     C   50
     CANN40              READ      HEAD10                                 94
     C   50
     CAN 40WSKN          READE     HEAD29                                 94
     C   51
     CANN40              READ      HEAD12                                 94
     C   51
     CAN 40              READ      HEAD31                                 94
     C   52
     CANN40              READ      HEAD13                                 94
     C   52
     CAN 40              READ      HEAD32                                 94
     C   53WSFRI1        READE     FRISOL01                               94
     C   54
     CANN40              READ      HEAD15                                 94
     C   54
     CAN 40WSKN          READE     HEAD25                                 94
     C   55
     CANN40              READ      HEAD16                                 94
     C   55
     CAN 40WSKN          READE     HEAD26                                 94
     C   56              READ      HEAD19                                 94
     C   57              READ      DOKUFM1                                94
     C   58HE34K2        READE     HEAD34                                 94
     C   59              READ      HEAD39                                 94
N04  C  N40
N04  CAN 67XAVD          reade     head41                                 94
N04  C   40
N04  CAN 67              read      head42                                 94
      *
N03  c                   add       1             LestRec
      * GODSNR-KUN FOR ÅR... TESTER UAVNSETT LIKT 40/N40...
     C   44
     CANN94WSGNÅ4        IFNE      0
     C     WSGNÅ4        ANDNE     HEDTÅ
     C                   GOTO      STLF
     C                   END
     C*
     C* SPESIELL AVDELING ER VALGT (= 40 OFF)
     C*
     C  N40
     CANN94              DO
     C  N53
     CANN58HEAVD         COMP      WSAVD                              9494
     C   43
     CANN94
     CANN60HESG          COMP      WSSG                               9494
     C   45
     CANN94HEKNSF        COMP      WSKN                               9494
     C   46
     CANN94HEKNKF        COMP      WSKN                               9494
     C   47
     CANN94HEOT          COMP      WSOT                               9494
     C   49
     CANN94HEPRO         COMP      WSPRO                              9494
     C   50
     CANN94HEKNA         COMP      WSKN                               9494
     C   54
     CANN94HEKNS         COMP      WSKN                               9494
     C   55
     CANN94HEKNK         COMP      WSKN                               9494
      * HEAD19=SAMLASTNR HAR IKKE AVD. VIS KUN EXAKT MATCH I RETT AVD.
     C   56
     CANN94HESAML        COMP      WSSAML                             9494
     C   56
     CANN94WSAVD         IFNE      HEAVD
     C                   GOTO      STLF
     C                   END
     C   57
     CANN94WSAVD         IFNE      FMAVD
     C                   GOTO      STLF
     C                   END
     C   53
     CANN94WSAVD         IFNE      FSAVD
     C                   GOTO      STLF
     C                   END
     C   58
     CANN94WSAVD         IFNE      HEAVD
     C                   GOTO      STLF
     C                   END
     C                   END
     C*
     C* SØK ALLE AVDELINGER  (= 40 ON)
     C*
     C*
N03   * Navn i Hente / leverings adresse..
N14  C     *IN94         IFEQ      '0'
N03  C     WSHNAV        Ifne      *blanks
N03  C     WSLNAV        orne      *blanks
N03  c                   exsr      TstHenLev
N03  c     HLExclude     cabeq     'Y'           STLF
N03  c                   end
N03   **  TEST MOT VEKT OVER / UNDER  (FRA OG MED/TIL OG MED)
N03  C     WSVKTO        IFNE      *ZEROS
N03  C     HEVKT         ANDLT     WSVKTO
N03  C                   GOTO      STLF
N03  C                   END
N03  C     WSVKTU        IFNE      *ZEROS
N03  C     HEVKT         ANDGT     WSVKTU
N03  C                   GOTO      STLF
N03  C                   END
N14  C                   END
     C*
     C   53
     CANN94FRIKEY        CHAIN     HEADF                              34
     C   53
     CANN94
     CAN 34              GOTO      STLF
n01   * dato ved fri søkevei
n01  c   53*in94         ifeq      *off
n01  c     HEDTOP        andlt     XFRIDT
n01  C                   GOTO      STLF
n01  c                   end
     C   41
     CANN94              DO
     C   41              MOVE      FIOPD         WSOPD
     C     HEADFF        CHAIN     HEADF                              34
     C   34              GOTO      STLF
     C     FAK8KE        chain     fak8                               34
     C   34              GOTO      STLF
     c  N34              do
     c     fakda         ifeq      'K'
     c     wskost        ifne      'X'
     c                   goto      stlf
     c                   end
     c                   else
     c     wskost        ifeq      'X'
     c                   goto      stlf
     c                   end
     c                   end
     c                   end
     C                   END
     C   57
     CANN94              DO
     C     DMKEY         CHAIN     HEADF                              34
     C   34              GOTO      STLF
     C                   END
      *
SV5  C*  51N94   XHADT     CABGTHEDTR     STLF
SV5  C*  52N94   XCODT     CABGTHEDTR     STLF
     C   51
NV5  CANN94XHADT         CABGT     HEDTOP        STLF
     C   52
NV5  CANN94XCODT         CABGT     HEDTOP        STLF
     C*
     C     FREETK        SETLL     FREETXT
     C                   SETOFF                                       2988
     C     FREETK        READE     FREETXT                                29
     C  N29              SETON                                            88
     C*
     C  N94              EXSR      MOVWS2
     C*
      *
N03  C     UtLes         tag
     C                   ENDSR
      *
N03
N03  C***********************************************
N03  C     TstHenLev     BEGSR
N03  C***********************************************
N03  c                   MOVE      'Y'           HLExclude         1
N03   * TEST Hentenavn utfylt - ikke match hopp ut (med Y i HLExclude )
N03  c     WSHnav        Ifne      *blanks
N03  C     ' '           CHECKR(E) WSHNAV        NUX               2 0
N03  C                   EVAL      %len(HenMot)= NUX
N03  C     NUX           SUBST     WSHNAV:1      HenMot
N03  C     LC:UC         XLATE     HENAS         TSTSCAN30        30
N03  C     HenMot        SCAN      TSTSCAN30                              33
N03  c     *IN33         CaBEQ     *OFF          UtTstHL
N03  C                   end
N03   * TEST Lev.navn utfylt - ikke match hopp ut (med Y i HLExclude )
N03  c     WSLnav        Ifne      *blanks
N03  C     ' '           CHECKR(E) WSLNAV        NUX               2 0
N03  C                   EVAL      %len(HenMot)= NUX
N03  C     NUX           SUBST     WSLNAV:1      HenMot
N03  C     LC:UC         XLATE     HENAK         TSTSCAN30
N03  C     HenMot        SCAN      TSTSCAN30                              33
N03  c     *IN33         CaBEQ     *OFF          UtTstHL
N03  C                   end
N03   * Overlevde begge tester - skal IKKE ekskluderes
N03  c                   MOVE      'N'           HLExclude
N03  C     UtTstHL       ENDSR
     C*
     C***********************************************
     C     MOVWS2        BEGSR
     C***********************************************
     C                   MOVE      HEAVD         XAVD
     C     *IN49         IFNE      '1'
     C     *IN44         ANDNE     '1'
     C                   MOVEL     HENAS         WSPOSS
     C                   ELSE
     C                   MOVE      *BLANKS       WSPOSS
     C     HEPO1B        IFEQ      *BLANKS
     C                   MOVE      HEPO1A        WSPSSA
     C                   MOVEL     HENAS         WSPSSB
     C                   ELSE
     C                   MOVEL     HEPOS1        WSPOSS
     C                   END
     C                   END
     C                   MOVEL     HENAK         WSPOSK
     C   41              MOVE      FIFN          XFNFM             7 0
     C   41              Z-ADD     FIFN          FAKTEN
     C  N41              MOVE      *ZEROS        XFNFM
     C  N41              Z-ADD     1             FAKTEN
      *
      * HENTER FAKTURANUMMER/KUNDENUMMER FRA FATURAFIL
      *
     C   41FAKT8K        CHAIN     FAK8                               33
     C  N41              DO
     C     FAKT8K        SETLL     FAK8
     C     *IN33         DOUEQ     '1'
     C     FREETK        READE     FAK8                                   33
     C  N33FAKDA         IFNE      'K'
     C     FASK          andne     'I'
     C                   MOVE      FAFAKT        XFNFM
     C                   SETON                                        33
     C                   END
     C                   END
     C                   END
     C*
     C* HVIS IKKE FUNNET FAKTURA SKAL FAKT-NAVN  BLANKES PÅ SUBFIL
     C*
     C     XFNFM         IFEQ      0                                             2<-B
     C                   MOVE      '1'           *IN33
     C                   MOVE      *ZEROS        FAKUNR
     C                   ELSE                                                    2
     C                   MOVE      '0'           *IN33
     C                   END                                                     2<-E
      *
     C  N33CUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         XNAFM
     C   33              MOVE      *BLANKS       XNAFM
      * FAKT-NR-FELT BRUKES TIL FR.BR.NR/LINJENR VED SØK VIA MERKE..
     C     *IN57         IFEQ      *ON
     C                   MOVE      '   /  '      XFNFMA
     C                   MOVEL     FMFBNR        XFNFMA
     C                   MOVE      FMLINR        XFNFMA
     C                   ELSE
      * FJERN LEDENDE NULLER I ALFA-FELT FOR FAKT-NR
     C     XFNFM         IFEQ      *ZEROS
     C                   MOVE      *BLANKS       XFNFMA
     C                   ELSE
     C                   MOVE      XFNFM         XFNFMA
     C     1             DO        6             N                 1 0
     C     FN(N)         IFNE      '0'
     C                   GOTO      UTFN
     C                   END
     C                   MOVE      ' '           FN(N)
     C                   END
     C     UTFN          TAG
     C                   END
     C                   END
     C*
     C* HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
     C     HEGN2         IFNE      *BLANKS
     C                   MOVE      HEGN          WSGNDS
     C                   ELSE
     C                   MOVEL     HEGN          WSGNDS
     C                   END
     C* HVIS HELE.GNN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
     C     HEGNN2        IFNE      *BLANKS
     C                   MOVE      HEGNN         WSGNND
     C                   ELSE
     C                   MOVEL     HEGNN         WSGNND
     C                   END
     C     WSGNND        IFEQ      *BLANKS
     C                   MOVEL     HETLL         WSGNND
     C                   MOVE      'T'           WSGNND
     C                   END
     C* EN OG BARE EN EXAKT MATCH.....
     C                   SETOFF                                       70
     C   43HESG          COMP      WSSG                                   70     HEAD2
     C   44HEGN          COMP      WSGN                                   70     HEAD3
     C   45HEKNSF        COMP      WSKN                                   70     HEAD4
     C   46HEKNKF        COMP      WSKN                                   70     HEAD5
     C   47HEOT          COMP      WSOT                                   70     HEAD6
     C   48HERFA         COMP      WSRFA                                  70     HEAD7
     C   49HEPRO         COMP      WSPRO                                  70     HEAD9
     C   50HEKNA         COMP      WSKN                                   70     HEAD10
     C   51HEHAWB        COMP      WSHAWB                                 70     HEAD12
     C   52HETRCN        COMP      WSCONT                                 70     HEAD13
     C   53FSSOK         COMP      WSFRI2                                 70     FRISOL01
     C   54HEKNS         COMP      WSKN                                   70     HEAD15
     C   55HEKNK         COMP      WSKN                                   70     HEAD16
     C   56HESAML        COMP      WSSAML                                 70
     C   70              ADD       1             EXAKT
     C                   ENDSR
     C*
     C***********************************************
     C     MOVDT1        BEGSR
     C***********************************************
     C                   MOVE      HEAVD         XYAVD             4 0
     C                   MOVE      HEOPD         XYOPD             7 0
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVDT2        BEGSR
     C***********************************************
     C     XYHKEY        KLIST
     C                   KFLD                    XYAVD
     C                   KFLD                    XYOPD
     C     XYHKEY        CHAIN     HEADF                              33
     C  N33              EXSR      MOVWS2
      *
     C                   ENDSR
      *
     C***********************************************
     C     CMDT2         BEGSR
     C***********************************************
     C                   SELECT
     C     XMSGN2        WHENEQ    0
     C                   ADD       1             XMSGN2            1 0
     C                   MOVE      'DIV0000'     MSGN2K
     C                   MOVE      'DIV0020'     MSGN2L
     C                   MOVE      'DIV0032'     MSGN2M
     C     XMSGN2        WHENEQ    1
     C                   ADD       1             XMSGN2
     C                   MOVE      'DIV0069'     MSGN2K
     C                   MOVE      'DIV0068'     MSGN2L
     C                   MOVE      'DIV0024'     MSGN2M
     C     XMSGN2        WHENEQ    2
     C                   ADD       1             XMSGN2
     C                   MOVE      'BBA0121'     MSGN2K
     C                   MOVE      'BBA0038'     MSGN2L
     C                   MOVE      'BBA0039'     MSGN2M
     C     XMSGN2        WHENEQ    3
     C                   Z-ADD     0             XMSGN2
     C                   MOVE      'BBA0040'     MSGN2K
     C                   MOVE      'BBA0046'     MSGN2L
     C                   MOVE      'DIV0000'     MSGN2M
     C                   ENDSL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     EASY          BEGSR
     C***********************************************
     C                   OPEN      LOCL01                               91
     C  N91              OPEN      ISUL02                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      EASY99
     C                   ENDIF
      *
     C                   CALL      'SM260C'
      *
     C     EASY99        TAG
     C                   CLOSE     LOCL01                               91
     C                   CLOSE     ISUL02                               91
      *
     C                   ENDSR
     C***********************************************
     C     SFSR          BEGSR
     C***********************************************
     C                   OPEN      LOCL01                               91
     C  N91              OPEN      ISUL02                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFSR99
     C                   ENDIF
     C* Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       AUTINF
     C     *IN20         IFEQ      '1'                                          <AUTOMATISK
     C                   MOVE      '1'           AUTTRM
     C                   ELSE                                                   <MED BILDE
     C                   MOVE      ' '           AUTTRM
     C                   ENDIF
     C  N99
     CAN 99WWUSER        CHAIN     LOCL01                             90
     C                   MOVE      WAIRLI        AUTALN                         <AIRLINE
     C                   MOVE      WAWBNO        AUTAWB                         <AWB
     C                   MOVE      *BLANKS       AUTPID                         <ADRESSE
     C     WAIRCD        IFNE      *BLANKS
     C     WAIRCD        CHAIN     ISUL02                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     ISPART        AUTPID
     C                   ELSE
     C                   MOVE      ' '           AUTTRM
     C                   ENDIF
     C                   ENDIF
      * Programmet venter på svar i et vist antall sekunder.
      * Kommer ikke svaret fortsetter pgm.
     C                   CALL      'SM200C2'
     C                   PARM                    AUTINF
      *
      *
     C     SFSR99        TAG
     C                   CLOSE     LOCL01                               91
     C                   CLOSE     ISUL02                               91
      *
     C                   ENDSR
      *
     C***********************************************
     C     SRLOGG        BEGSR
     C***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      XXLOGG
     C                   ENDIF
      * Kaller på logg program
     C                   CALL      'SM040C'
      *
     C     XXLOGG        TAG
     C                   CLOSE     LOCL01                               91
     C                   ENDSR
      *
     C***********************************************
     C     SFVR          BEGSR
     C***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFVR99
     C                   ENDIF
     C* Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       CUTINF           29
      * Programmet venter på svar i et vist antall sekunder.
      * Kommer ikke svaret fortsetter pgm.
     C                   CALL      'SM250C2'
     C                   PARM                    CUTINF
      *
     C     SFVR99        TAG
     C                   CLOSE     LOCL01                               91
      *
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C     LOGKEY        KLIST
     C                   KFLD                    LOJONR
     C                   KFLD                    FASTKO            2
     C                   MOVE      '00'          FASTKO
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADFK        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOPD
     C     FRIKEY        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     DMKEY         KLIST
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C     HEADFF        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     HEAD2K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XSGDT
     C     HEA24K        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    XSGDT
     C     HEA22K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XSGDT
     C     HEADTK        KLIST
     C                   KFLD                    XSGDT
N04  C     HEA41K        KLIST
N04  C                   KFLD                    XAVD
N04  C                   KFLD                    WSGM1
N04  C     HEA42K        KLIST
N04  C                   KFLD                    WSGM1
     C     HEAD3K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSGN
     C     HKNKEY        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSKN
     C                   KFLD                    XKNDT
     C     HKNK2         KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    XKNDT
     C     HEAD6K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOT
     C                   KFLD                    XOTDT
     C     HEAD17K       KLIST
     C*                  KFLD                    WSRFA
     C                   KFLD                    WSRFA35
     C                   KFLD                    XRFADT
     C     HEA30K        KLIST
     C                   KFLD                    WSOT
     C                   KFLD                    XOTDT
     C     HEAD7K        KLIST
     C                   KFLD                    XAVD
Nrfa C*                  KFLD                    WSRFA
Nrfa C                   KFLD                    WSRFA35
     C     HEAD9K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSPRO
     C                   KFLD                    XKNA
     C     HEA14K        KLIST
     C                   KFLD                    WSPRO
     C                   KFLD                    XKNA
     C     HEA12K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSHAWB
     C                   KFLD                    XHADT
     C     HEA31K        KLIST
     C                   KFLD                    WSHAWB
     C                   KFLD                    XHADT
     C     HEA13K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSCONT
     C                   KFLD                    XCODT
     C     HEA32K        KLIST
     C                   KFLD                    WSCONT
     C                   KFLD                    XCODT
     C     HEA34K        KLIST
     C                   KFLD                    WSSDF
     C                   KFLD                    WSSDT
     C                   KFLD                    XFRTID
     C     HE34K2        KLIST
     C                   KFLD                    WSSDF
     C                   KFLD                    WSSDT
     C     FRIS1K        KLIST
     C                   KFLD                    WSFRI1
     C                   KFLD                    WSFRI2
     C                   KFLD                    XFRIDT
     C     FAI2K         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSFN
     C     KODTAK        KLIST
     C                   KFLD                    XKAUNI
     C                   KFLD                    WSAVD
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    FAKUNR
     C     FAKT8K        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FAKTEN            7 0
     C     FAK8KE        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C                   KFLD                    FIFN
N03  C     SYPARKEY      KLIST
N03  C                   KFLD                    SYKUNR
N03  C                   KFLD                    SYPAID
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTYPE             1
     C                   PARM                    UAVDE             4 0
     C                   PARM                    UOPDE             7 0
     C                   PARM                    USGE              3
      * UTYPE = E  -->  PLUKK OPPDRAG FOR ENDRING
     C     UTYPE         COMP      'E'                                    28
     C   28              MOVE      UAVDE         WSAVD
     C                   MOVE      ' '           UTYPE
      * SØRG FOR AT F8/F9 KOMMER MED I 1. F.TAST-REKKE (F3/F4 VET ALLE)
     C                   Z-ADD     1             XMSGN2            1 0
     C* FINN ÅRHUNDRE
     C                   TIME                    DSTID            14 0
     C                   MOVE      DSCENT        WSGNA
     C                   Z-ADD     4             GMLIN             5 0
     C                   MOVE      *ZEROS        XAVD              4 0
EV5  C                   MOVE      *ZEROS        XSGDT
EV5  C                   MOVE      *ZEROS        XKNDT
EV5  C                   MOVE      *ZEROS        XOTDT
     C                   MOVE      *ZEROS        XHADT
     C                   MOVE      *ZEROS        XCODT
     C                   MOVE      *ZEROS        XFRTID
     C                   MOVE      *ZEROS        XFRIDT
     C                   MOVE      *ZEROS        XRFADT
     C                   MOVE      *ZEROS        XKNA              8 0
     C                   MOVE      '9999'        XAVD2             4 0
SV5  C*                    MOVE '999999'  XDTM    60
SV5  C*                    MOVE '999999'  XFN     60
SV5  C*                    MOVE '99999999'XOPD    50
SV5  C*                    MOVE '999'     XSG     3
SV5  C*                    MOVEL'99999999'XGN    11
SV5  C*                    MOVE '999'     XGN    11
SV5  C*                    MOVE '99999999'XKN     80
SV5  C*                    MOVE '99'      XOT     2
SV5  C*                    MOVEL'99999999'XRFA   15
SV5  C*                    MOVE '9999999' XRFA   15
SV5  C*                    MOVE '99999999'XPRO    80
     C                   MOVE      'A'           XKAUNI            1
     C                   MOVE      *ZEROS        HEAVD
     C                   MOVE      *ZEROS        WSDT1W
     C                   MOVE      *ZEROS        WSDT2W
     C                   MOVE      *ZEROS        WSDT4W
     C                   MOVE      *ZEROS        WSDT5W
     C                   MOVE      *ZEROS        WSDT6W
     C                   MOVE      *ZEROS        WSDT7W
     C                   MOVE      *ZEROS        WSDT8W
N09  C                   MOVE      *ZEROS        WSDT9W
     C                   MOVE      *ZEROS        WSDTAW
     C*
     C                   MOVEL     WUSER         WWUSER           17
     C*
     C                   EXSR      CMDT2
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   35
     C                   READ      FIRMARC                                90
     C                   MOVE      'J'           ARKIV             1
      * maxrecords i leseloop (pga filetr i les..)
S14  C*                  Move      *zeros        MAXLES
N14  C                   Move      100000        MAXLES
N03  C                   Move      *zeros        SYKUNR
N03  C                   move      'MXOFI'       SYPAID
N03  C     SyParKey      CHAIN     SYPARL1                            33
N03  c  N33              z-add     SYVRDN        MAXLES            9 0
N06   * Default = protect ekstra filer
N06  C                   MOVE      '1'           *IN32
     C*
     C                   EXSR      CMDFT1
     C                   EXSR      CMDF23
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      WSDT1D        UDT1              2 0
     C                   MOVE      WSDT1M        UDT2              2 0
     C                   MOVE      WSDT1Å        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT1D
     C                   MOVE      UDT2          WSDT1M
     C                   MOVE      UDT3          WSDT1Å
     C*
     C                   MOVE      WSDT2D        UDT1
     C                   MOVE      WSDT2M        UDT2
     C                   MOVE      WSDT2Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT2D
     C                   MOVE      UDT2          WSDT2M
     C                   MOVE      UDT3          WSDT2Å
     C*
     C*
     C                   MOVE      WSDT4D        UDT1
     C                   MOVE      WSDT4M        UDT2
     C                   MOVE      WSDT4Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT4D
     C                   MOVE      UDT2          WSDT4M
     C                   MOVE      UDT3          WSDT4Å
      *
     C                   MOVE      WSDT5D        UDT1
     C                   MOVE      WSDT5M        UDT2
     C                   MOVE      WSDT5Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT5D
     C                   MOVE      UDT2          WSDT5M
     C                   MOVE      UDT3          WSDT5Å
      *
     C                   MOVE      WSDT6D        UDT1
     C                   MOVE      WSDT6M        UDT2
     C                   MOVE      WSDT6Å        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDT6D
     C                   MOVE      UDT2          WSDT6M
     C                   MOVE      UDT3          WSDT6Å
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      HEDTD         UDT1
     C                   MOVE      HEDTM         UDT2
     C                   MOVE      HEDTÅ         UDT3
     C                   EXSR      KDTFMT
EV5  C                   MOVE      UDT1          WSDTOD
EV5  C                   MOVE      UDT2          WSDTOM
EV5  C                   MOVE      UDT3          WSDTOÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     C*************************************************
     C     BYAVD         BEGSR
     C*************************************************
     C*
     C* NEW DEPARTMENT SELECTED
     C*
     C     KODTAK        CHAIN     KODTA                              30
     C   30              GOTO      UTBY
     C                   MOVE      WSAVD         WSAVDO            4 0
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '000'         *IN(57)
     C*
     C     UTBY          ENDSR
     C***********************************************
     C     VISFAX        BEGSR
     C***********************************************
     C     FREETK        CHAIN     FAXLOG03                           87
     C  N87              DO
     C     LODOC8        IFEQ      'FAKTURA '
     C                   MOVE      'SHU0402'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      'J'           FINS
     C                   CALL      'FAXDSP'
     C                   PARM                    LODOCN
     C                   PARM                    LOMAPP
     C                   PARM                    FINS              1
     C                   END
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C***********************************************
     C     VISTT         BEGSR
     C***********************************************
n07  C                   MOVE      *zeros        UPRO              8 0
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYTT01CL'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
N07  C                   PARM                    UPRO
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C***********************************************
     C     VISTTT        BEGSR
     C***********************************************
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYTT02CL'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C*
     C*
     C* OPPDRAGSTYPE
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     29
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOT
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C* FRIE SØKEVEIER
     C     LINNBR        IFEQ      20
     C                   CALL      'SYFA65A'
     C                   PARM                    WSFRI1
     C                   Z-ADD     33            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     VISTUR        BEGSR
     C***********************************************
     C     TURKEY        KLIST
     C                   KFLD                    TUAVD
     C                   KFLD                    TUPRO
     C                   MOVE      HEAVD         TUAVD
     C                   MOVE      HEPRO         TUPRO
     C     TURKEY        CHAIN     TURER                              33
     C  N33              DO
     C                   MOVE      'J'           USPØR             1
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SYEX88A'
     C                   PARM                    FIFIRM
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   PARM                    USPØR
     C                   PARM                    UIMP
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      3                                      03
     C                   END
     C*
     C                   ENDSR
     C***********************************************
     C     UPDSBF        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       WSNR
     C     HESGM         COMP      *BLANKS                            2727
     C     FREETK        SETLL     FREETXT
     C                   SETOFF                                       2988
     C     FREETK        READE     FREETXT                                29
     C  N29              SETON                                            88
     C     FREETK        CHAIN     FAXLOG03                           87
     C                   MOVE      ' '           QFSU
     C  N87LOGKEY        CHAIN     FAXQLOG                            33
     C  N87
S11  C*N 33              MOVE      'I'           QFSU
N11  CAN 33LOFAXN        IFEQ      'MAIL'
N11  C                   MOVE      'E'           QFSU
N11  C                   else
N11  C                   MOVE      'I'           QFSU
N11  C                   END
     C     TRFA11        COMP      *BLANKS                            8989
     C  N89TRFA21        COMP      *BLANKS                            8989
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     DOKUME        BEGSR
      ***********************************************
     C                   CALL      'SYOPDO'
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   ENDSR
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C     *LIKE         DEFINE    HEAVD         UAVD2
     C     *LIKE         DEFINE    HEOPD         UOPD2
     C                   CALL      'ARC003'
     C                   PARM      HEAVD         UAVD2
     C                   PARM      HEOPD         UOPD2
     C                   PARM                    URUNDE           10
     C                   ENDSR
      ***********************************************
     C     PRTSKILL      BEGSR
      ***********************************************
     C                   MOVE      '  '          SCATYP            2
S02  C*                  MOVEL     HEAVD         SCASTR9           9
S02  C*                  MOVE      HEOPD         SCASTR9           9
N02  C                   MOVEL     HEAVD         SCASTR9          11
N02  C                   MOVE      HEOPD         SCASTR9          11
     C                   MOVEL     SCASTR9       SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   ENDSR
     C***********************************************
     C     DSPWEB        BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Se SYSPED oppdrag på WEB (eSped) '
     C                   EVAL      WebType = 'ESPEO'
     C                   move      HEAVD         HEAVDA            4
     C                   move      HEOPD         HEOPDA            7
     C                   EVAL      WebSok  = '&heavd='+HEAVDA+
     C                             '&heopd='+HEOPDA
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C                   ENDSR
      *
      ***********************************************
     C     CMDFT1        BEGSR
      ***********************************************
     C                   SELECT
     C     XMSG11        WHENEQ    0
     C                   ADD       1             XMSG11            1 0
     C                   MOVE      'DIV0020'     MSGF11
     C                   MOVE      'DIV0021'     MSGF12
     C                   MOVE      'DIV0024'     MSGF13
     C     XMSG11        WHENEQ    1
     C                   Z-ADD     0             XMSG11
     C                   MOVE      'YBC0033'     MSGF13
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     CMDF23        BEGSR
      ***********************************************
     C                   SELECT
     C     YMSG11        WHENEQ    0
     C                   ADD       1             YMSG11            1 0
     C                   MOVE      'SHU0919'     MSGF23
     C     YMSG11        WHENEQ    1
     C                   Z-ADD     0             YMSG11
     C                   MOVE      'SHU0920'     MSGF23
     C                   ENDSL
      *
     C                   ENDSR
      *
