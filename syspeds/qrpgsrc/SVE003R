********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P1000A* 01 CB  PTF10  Blanke flere felter ved ny
P1000A* 02 CB  PTF10  Auto viktberækning F10
P11XXX* 03 CB  PTF11  CALLME=00 vid ny linje
P11070* 04 CB  PTF11  FEL kontroll extra mængdenhet
P11066* 05 CB  PTF11  Hæmta Y-koder
P11072* 06 CB  PTF11  Hæmta Tillæggskoder R33.3 .4 .5
P11075* 07 CB  PTF11  Kontroll av kollital
P11076* 08 CB  PTF11  Decimaler på vikter
P11XXX* 09 CB  PTF11  Kontroll av decimaler
P11XXX* 10 CB  PTF11  Hæmta Y-koder och tillæggskoder också vid uppdatering 5, 6 utgår
P11XXX* 11 CB  PTF11  Flytta hæmtning av Bilagda handlingar
P11091* 12 CB  PTF11  Mer kontroller på diff mellan huvud och varuposter
P11100* 13 CB  PTF11  Kunders varuregister
P11XXX* 14 CB  PTF11  Blanka ut status(ERR) vid uppdatering
P11XXX* 15 CB  PTF11  Visa varupostnummer vi ændring
P11XXX* 16 CB  PTF11  Inte hæmta alla variablar från kunders varuregister
********************************************************************
     FSVE003D   CF   E             WORKSTN
     F                                     SFILE(SVE003DA:ZRECNO)
     F                                     INFDS(FBAREA)
     FSVEV      UF A E           K DISK
     FSVEV1     IF   E           K DISK
     F                                     RENAME(SVEVR:SVEVR1)
     FSVEH      IF   E           K DISK
     FSVEVA     UF A E           K DISK
     FSVEVX     UF A E           K DISK
     FSVTAR1    IF   E           K DISK
     FSVTX04F   IF   E           K DISK
     FSVTX08F2  IF   E           K DISK
     FSVTAV     IF   E           K DISK
     FSVTX03F   IF   E           K DISK
     FSVTPRO    IF   E           K DISK
     FSVTVK     IF   E           K DISK
     FSVTLV     IF   E           K DISK
     FSVEF      IF   E           K DISK
N13  FSVEW      IF   E           K DISK
     D  WT             S             19    DIM(9)
     D                 DS
     D  WVTA                   1     19
     D  WVTA_X                 1      1
     D  WVTA_SAT               2     11S 3
     D  WVTA_FTI              12     13
     D  WVTA_MTI              14     16
     D  WVTA_MUC              17     19
     D                 DS
     D  WZVEV_VATA             1     10
     D  ZVEV_VATA              1      8
     D  ZNULNULL               9     10
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
N09  D                 DS
N09  D  WVIKT                  1     14S 3
N09  D  WVIKTHEL               1     11S 0
N09  D  WVIKTDEC              12     14S 0
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *________________
      * Arbetsvariablar
      *""""""""""""""""
     C     *LIKE         DEFINE    ZRECNO        WRECNO
     C     *LIKE         DEFINE    *IN03         WIN03
     C     *LIKE         DEFINE    SVEV_SYAV     ZVEV_SYAV
     C     *LIKE         DEFINE    SVEV_SYOP     ZVEV_SYOP
     C     *LIKE         DEFINE    SVEV_SYLI     ZVEV_SYLI
     C     *LIKE         DEFINE    SVEV_VANO     ZVEV_VANO
     C     *LIKE         DEFINE    SVTA_IE       ZVTA_IE
     C     *LIKE         DEFINE    SVEV_STVA     ZVEV_STVA
     C     *LIKE         DEFINE    SVEV_STVA     ZVEV_STVA2
     C     *LIKE         DEFINE    SVEVA_ABB     WVEVA_ABB
     C     *LIKE         DEFINE    *IN03         WIN03
     C     *LIKE         DEFINE    *IN12         WIN12
     C     *LIKE         DEFINE    SVTX03_01     ZVKD_IE
     C     *LIKE         DEFINE    SVPR_IE       ZVPR_IE
     C     *LIKE         DEFINE    SVTX03_02     ZVKD_TYP
     C     *LIKE         DEFINE    SVTX03_03     ZVKD_KD
     C     *LIKE         DEFINE    SVEV_STVA     XVEV_STVA
     C                   Z-ADD     0             ZCIFTOT          18 4
     C                   Z-ADD     0             ZCIFTOT2         18 4
     C     *LIKE         DEFINE    SVVK_KD       ZVVK_KD
     C     *LIKE         DEFINE    SVVK_DTS      ZVVK_DTS
     C     *LIKE         DEFINE    SVEH_FABL     ZVEH_FABL
     C     *LIKE         DEFINE    SVTA_MUC      UVTA_MUC
     C     *LIKE         DEFINE    SVEH_BRUT     WVEH_BRUT
     C     *LIKE         DEFINE    SVEH_BRUT     XVEH_BRUT
     C     *LIKE         DEFINE    SVEH_KOTA     WVEH_KOTA
     C     *LIKE         DEFINE    SVEH_KOTA     XVEH_KOTA
N05  C     *LIKE         DEFINE    SVTA_VATA     UVTA_VATA
N13  C     *LIKE         DEFINE    SVEW_KNSO     UVEW_KNSO
     C                   Z-ADD     0             WPROT             1 0
     C                   Z-ADD     0             WTN               2 0
     C                   EVAL      ZVTA_IE='E'
     C                   EVAL      ZVPR_IE='E'
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    ZVEV_SYAV
     C                   PARM                    ZVEV_SYOP
     C                   PARM                    ZVEV_SYSG
     C                   PARM      *IN03         WIN03
     C                   PARM      *IN12         WIN12
     C                   PARM                    UMODE             1
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA1         KLIST
     C                   KFLD                    ZVEV_SYAV
     C                   KFLD                    ZVEV_SYOP
     C     KEYA          KLIST
     C                   KFLD                    ZVEV_SYAV
     C                   KFLD                    ZVEV_SYOP
     C                   KFLD                    SVEV_SYLI
     C     SVTAKEY       KLIST
     C                   KFLD                    ZVTA_IE
     C                   KFLD                    WZVEV_VATA
     C     SVTLKKEY      KLIST
     C                   KFLD                    ZVEV_ULKD4        4
     C                   KFLD                    SVTA_RG
     C     SVTLKKEY2     KLIST
     C                   KFLD                    ZVEV_ULKD4
     C                   KFLD                    SVAV_REGI
     C     SVTX03K       KLIST
     C                   KFLD                    ZVKD_IE
     C                   KFLD                    ZVKD_TYP
     C                   KFLD                    ZVKD_KD
     C     SVTPROKEY     KLIST
     C                   KFLD                    ZVPR_IE
     C                   KFLD                    ZVEV_EUP1
     C     SVTVKKEY      KLIST
     C                   KFLD                    ZVVK_KD
     C                   KFLD                    ZVVK_DTS
     C     SVEWKEY       KLIST
     C                   KFLD                    SVEH_AVKN
     C                   KFLD                    UVEW_KNSO
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *________________________________
      * Modus   D=Fråga, endast visning
      *""""""""""""""""""""""""""""""""
     C                   IF        UMODE='D'
     C                   EVAL      *IN27=*ON
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR

     C     SRB1          TAG
      *________________________
      * Summera varulinjebelopp
      *""""""""""""""""""""""""
     C                   EXSR      SRBS
      *______________
      * Tømme Subfile
      *""""""""""""""
     C                   EVAL      *IN93=*ON
     C                   WRITE     SVE003DB
     C                   MOVEA     '000'         *IN(93)
     C                   Z-ADD     *ZERO         ZRECNO
     C                   Z-ADD     *ZERO         WRECNO
     C                   Z-ADD     *ZERO         ZVEV_SYLI
     C                   Z-ADD     *ZERO         ZVEV_VANO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     KEYA1         SETLL     SVEV1
     C     KEYA1         READE     SVEV1                                  94

     C     *IN94         DOWEQ     '0'
     C                   ADD       1             ZRECNO
      * Spara undan høgsta linjenr. i filen.
     C     SVEV_SYLI     IFGT      ZVEV_SYLI
     C                   EVAL      ZVEV_SYLI=SVEV_SYLI
     C                   ENDIF
     C                   WRITE     SVE003DA
     C     KEYA1         READE     SVEV1                                  94
     C  N94              ENDDO

     C                   EVAL      WRECNO=ZRECNO
     C                   IF        ZRECNO > 1
     C                   EVAL      ZRECNO=1
     C                   ENDIF
     C                   EVAL      ZVEV_VANO=SVEV_SYLI
      *_______________
      * Behandle bilde
      *"""""""""""""""
     C     SRB3          TAG

     C                   MOVEA     '11'          *IN(91)
     C  N30              EVAL      ZMSGNO='SY00000'
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   WRITE     SVE003DE
     C                   WRITE     SVE003DØ
     C                   WRITE     SVE003DC
     C                   IF        ZRECNO = 0

     C                   EXFMT     SVE003DF

     C                   ELSE

     C                   EXFMT     SVE003DB

     C                   ENDIF

     C     *IN03         IFEQ      '0'
     C     *IN12         ANDEQ     '0'

     C                   MOVEA     '00'          *IN(91)
      *_____________
      * F5=Frisk opp
      *"""""""""""""
     C     *IN05         CABEQ     '1'           SRB1
      *___________
      * F6=Lage ny
      *"""""""""""
     C     *IN06         IFEQ      '1'
     C                   EXSR      SRBA
     C     *IN03         CABEQ     '1'           SRB8
     C                   GOTO      SRB3
     C                   ENDIF
      *_______
      * Valg ?
      *"""""""
     C                   IF        ZRECNO > 0
     C                   EVAL      *IN52=*OFF
     C                   EVAL      *IN95=*OFF
     C     *IN52         DOWEQ     '0'

     C                   READC     SVE003DA                               52
     C     *IN52         IFEQ      '0'
N13  C  N27ZOP           CASEQ     'K'           SRBK                           Lægg till
     C  N27ZOP           CASEQ     '2'           SRBB                           Endre
     C  N27ZOP           CASEQ     '4'           SRBD                           Slette
     C     ZOP           CASEQ     '5'           SRBE                           Vise
     C                   ENDCS
     C                   ENDIF
      *
     C  N52              ENDDO
     C                   ENDIF

     C     *IN03         CABEQ     '1'           SRB8
     C     *IN12         CABEQ     '1'           SRB3
     C                   GOTO      SRB1

     C                   ENDIF

      * Kontrollera om det ær differans och be anvændaren vælja.
     C     SRB8          TAG

N12  C     XVEH_FABL     COMP      0                                  7171
N12  C     XVEH_BRUT     COMP      0                                  7272
N12  C     XVEH_KOTA     COMP      0                                  7373
S12  C*    XVEH_FABL     IFNE      0
N12  C     *IN71         IFEQ      *ON
N12  C     *IN72         OREQ      *ON
N12  C     *IN73         OREQ      *ON
     C                   EVAL      XVEH_DIJN='N'
     C                   EXFMT     SVE003DG
     C     XVEH_DIJN     CABEQ     'J'           SRB9
     C                   GOTO      SRB1
     C                   ENDIF

     C     SRB9          ENDSR
      *////////////////////////////////////////////////////////////
      *  Lage ny                                             SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR

     C                   CLEAR                   SVE003DD
N01  C                   CLEAR                   SVE003DI
N01  C                   CLEAR                   SVE003DJ
N01  C                   CLEAR                   SVE003DK
N01  C                   CLEAR                   SVE003DL
N01  C                   CLEAR                   SVE003DM
N01  C*                  CLEAR                   SVE003DN
N03   * Default værden
N03  C                   EVAL      ZVEV_CALL='00'
      * Hent fra heading
     C                   EVAL      ZVEV_ULKD=SVEH_AVLK
     C                   EVAL      ZVEV_KOTA=XVEH_KOTA
     C                   EVAL      ZVEV_BRUT=XVEH_BRUT
     C                   EVAL      ZVEV_FABL=XVEH_FABL
     C                   EVAL      ZVEV_BIT1=SVEH_FATY
     C                   EVAL      ZVEV_BII1=SVEH_FATX

     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     7             POSNBR

     C     SRBA1         TAG

      *____________
      * Blanke felt
      *""""""""""""
     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DD
     C                   EVAL      *IN30 = *OFF
     C                   EVAL      *IN31 = *OFF
     C                   EVAL      *IN32 = *OFF
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
     C                   EVAL      *IN35 = *OFF
     C                   EVAL      *IN36 = *OFF
     C                   EVAL      *IN37 = *OFF
     C                   EVAL      *IN38 = *OFF
     C                   EVAL      *IN39 = *OFF
     C                   EVAL      *IN40 = *OFF
     C                   EVAL      *IN41 = *OFF
     C                   EVAL      *IN42 = *OFF
     C     *IN03         IFEQ      '0'
     C     *IN05         ANDEQ     '0'
     C     *IN12         ANDEQ     '0'
      *_______
      * F4=Søk
      *"""""""
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     *IN04         IFEQ      '1'
     C     LINNBR        IFEQ      22
     C     LINNBR        OREQ      23
     C     LINNBR        OREQ      24
     C     LINNBR        OREQ      25
     C                   EXSR      SRC
     C                   GOTO      SRBA1
     C                   ENDIF
     C                   ENDIF
N02   *_____________________________
N02   * F10=Automatisk viktberækning
N02   *"""""""""""""""""""""""""""""
N02  C                   IF        *IN10
N02  C                   EXSR      SRAUTOVK
N02  C                   GOTO      SRBA1
N02  C                   ENDIF
N13   *_________________________________
N13   * F11=Kunders varuposter (externt)
N13   *"""""""""""""""""""""""""""""""""
N13  C                   IF        *IN11
N13  C                   EXSR      SRKUNSOK
N13  C                   GOTO      SRBA1
N13  C                   ENDIF
      *______________
      * Teste input-1
      *""""""""""""""
     C                   EXSR      SRBTST
     C   30              GOTO      SRBA1
      * Lag linjenummer
     C                   ADD       1             ZVEV_SYLI
     C                   EVAL      ZVEV_VANO=ZVEV_SYLI
     C                   EVAL      SVEV_SYLI=ZVEV_SYLI
      * Føranmælan
     C     *IN13         IFEQ      '1'
     C                   EXFMT     SVE003DH
     C                   GOTO      SRBA1
     C                   ENDIF
      * Mer R31
     C     *IN14         IFEQ      '1'
     C                   EXSR      SRI
     C                   GOTO      SRBA1
     C                   ENDIF
      * Mer Særsk uppl
     C     *IN15         IFEQ      '1'
     C                   EXSR      SRJ
     C                   GOTO      SRBA1
     C                   ENDIF
      * Mer Bil Handl
     C     *IN16         IFEQ      '1'
     C                   EXSR      SRK
     C                   GOTO      SRBA1
     C                   ENDIF
      * Mer Containernummer
     C     *IN17         IFEQ      '1'
     C                   EXSR      SRL
     C                   GOTO      SRBA1
     C                   ENDIF
      * Mer Tidigare Handlingar
     C     *IN18         IFEQ      '1'
     C                   EXSR      SRM
     C                   GOTO      SRBA1
     C                   ENDIF
      * Lageridentitet
     C     *IN19         IFEQ      '1'
     C                   EXSR      SRN
     C                   GOTO      SRBA1
     C                   ENDIF
      * Automatisk avgiftsberækning
     C                   EXSR      SRBAA
      * Manuell avgiftsberækning ?  Vænta
     C     ZVEV_AVGB     IFNE      *BLANKS
     C                   CALL      'SVE004R'
     C                   PARM                    ZVEV_SYAV
     C                   PARM                    ZVEV_SYOP
     C                   PARM                    ZVEV_SYLI
     C                   PARM                    WPROT
     C                   ENDIF
N10   * Hæmta och skriv Y-koder och tillæggskoder automatiskt
N10  C                   EXSR      SRGETKOD
N11  C                   EXSR      SRGETBIL
      *___________________
      * Adda post til  FIL
      *"""""""""""""""""""
     C                   EVAL      SVEV_SYAV=ZVEV_SYAV
     C                   EVAL      SVEV_SYOP=ZVEV_SYOP
     C                   EVAL      SVEV_SYLI=ZVEV_SYLI
     C                   EVAL      SVEV_KOTA=ZVEV_KOTA
     C                   EVAL      SVEV_KOT2=ZVEV_KOT2
     C                   EVAL      SVEV_KOT3=ZVEV_KOT3
     C                   EVAL      SVEV_KOT4=ZVEV_KOT4
     C                   EVAL      SVEV_KOT5=ZVEV_KOT5
     C                   EVAL      SVEV_KOSL=ZVEV_KOSL
     C                   EVAL      SVEV_KOS2=ZVEV_KOS2
     C                   EVAL      SVEV_KOS3=ZVEV_KOS3
     C                   EVAL      SVEV_KOS4=ZVEV_KOS4
     C                   EVAL      SVEV_KOS5=ZVEV_KOS5
     C                   EVAL      SVEV_VASL=ZVEV_VASL
     C                   EVAL      SVEV_VAS2=ZVEV_VAS2
     C                   EVAL      SVEV_VAS3=ZVEV_VAS3
     C                   EVAL      SVEV_VAS4=ZVEV_VAS4
     C                   EVAL      SVEV_VAS5=ZVEV_VAS5
     C                   EVAL      SVEV_GODM=ZVEV_GODM
     C                   EVAL      SVEV_GOD2=ZVEV_GOD2
     C                   EVAL      SVEV_GOD3=ZVEV_GOD3
     C                   EVAL      SVEV_GOD4=ZVEV_GOD4
     C                   EVAL      SVEV_GOD5=ZVEV_GOD5
     C                   EVAL      SVEV_VANO=ZVEV_VANO
     C                   EVAL      SVEV_VATA=ZVEV_VATA
     C                   EVAL      SVEV_VATI=ZVEV_VATI
     C                   EVAL      SVEV_VAT4=ZVEV_VAT4
     C                   EVAL      SVEV_VAT5=ZVEV_VAT5
     C                   EVAL      SVEV_ULKD=ZVEV_ULKD
     C                   EVAL      SVEV_BRUT=ZVEV_BRUT
     C                   EVAL      SVEV_EUP1=ZVEV_EUP1
     C                   EVAL      SVEV_EUP2=ZVEV_EUP2
     C                   EVAL      SVEV_NETO=ZVEV_NETO
     C                   EVAL      SVEV_ANKV=ZVEV_ANKV
     C                   EVAL      SVEV_SUKO=ZVEV_SUKO
     C                   EVAL      SVEV_SUK6=ZVEV_SUK6
     C                   EVAL      SVEV_SUKB=ZVEV_SUKB
     C                   EVAL      SVEV_SUTX=ZVEV_SUTX
     C                   EVAL      SVEV_SUT2=ZVEV_SUT2
     C                   EVAL      SVEV_SUT3=ZVEV_SUT3
     C                   EVAL      SVEV_SUT4=ZVEV_SUT4
     C                   EVAL      SVEV_SUT5=ZVEV_SUT5
     C                   EVAL      SVEV_SUT6=ZVEV_SUT6
     C                   EVAL      SVEV_SUT7=ZVEV_SUT7
     C                   EVAL      SVEV_SUT8=ZVEV_SUT8
     C                   EVAL      SVEV_SUT9=ZVEV_SUT9
     C                   EVAL      SVEV_SUTA=ZVEV_SUTA
     C                   EVAL      SVEV_SUTB=ZVEV_SUTB
     C                   EVAL      SVEV_SUTC=ZVEV_SUTC
     C                   EVAL      SVEV_SUTD=ZVEV_SUTD
     C                   EVAL      SVEV_SUTE=ZVEV_SUTE
     C                   EVAL      SVEV_SUTF=ZVEV_SUTF
     C                   EVAL      SVEV_FABL=ZVEV_FABL
     C                   EVAL      SVEV_STVA=ZVEV_STVA
     C                   EVAL      SVEV_STVA2=ZVEV_STVA2
     C                   EVAL      SVEV_BETK=ZVEV_BETK
     C                   EVAL      SVEV_KOMR=ZVEV_KOMR
     C                   EVAL      SVEV_FNKD=ZVEV_FNKD
     C                   EVAL      SVEV_BIT1=ZVEV_BIT1
     C                   EVAL      SVEV_BIT2=ZVEV_BIT2
     C                   EVAL      SVEV_BIT3=ZVEV_BIT3
     C                   EVAL      SVEV_BIT4=ZVEV_BIT4
     C                   EVAL      SVEV_BIT5=ZVEV_BIT5
     C                   EVAL      SVEV_BIT6=ZVEV_BIT6
     C                   EVAL      SVEV_BIT7=ZVEV_BIT7
     C                   EVAL      SVEV_BIT8=ZVEV_BIT8
     C                   EVAL      SVEV_BIT9=ZVEV_BIT9
     C                   EVAL      SVEV_BII1=ZVEV_BII1
     C                   EVAL      SVEV_BII2=ZVEV_BII2
     C                   EVAL      SVEV_BII3=ZVEV_BII3
     C                   EVAL      SVEV_BII4=ZVEV_BII4
     C                   EVAL      SVEV_BII5=ZVEV_BII5
     C                   EVAL      SVEV_BII6=ZVEV_BII6
     C                   EVAL      SVEV_BII7=ZVEV_BII7
     C                   EVAL      SVEV_BII8=ZVEV_BII8
     C                   EVAL      SVEV_BII9=ZVEV_BII9
     C                   EVAL      SVEV_CO01=ZVEV_CO01
     C                   EVAL      SVEV_CO02=ZVEV_CO02
     C                   EVAL      SVEV_CO03=ZVEV_CO03
     C                   EVAL      SVEV_CO04=ZVEV_CO04
     C                   EVAL      SVEV_CO05=ZVEV_CO05
     C                   EVAL      SVEV_CO06=ZVEV_CO06
     C                   EVAL      SVEV_CO07=ZVEV_CO07
     C                   EVAL      SVEV_CO08=ZVEV_CO08
     C                   EVAL      SVEV_CO09=ZVEV_CO09
     C                   EVAL      SVEV_CO10=ZVEV_CO10
     C                   EVAL      SVEV_CO11=ZVEV_CO11
     C                   EVAL      SVEV_CO12=ZVEV_CO12
     C                   EVAL      SVEV_CO13=ZVEV_CO13
     C                   EVAL      SVEV_CO14=ZVEV_CO14
     C                   EVAL      SVEV_CO15=ZVEV_CO15
     C                   EVAL      SVEV_CO16=ZVEV_CO16
     C                   EVAL      SVEV_CO17=ZVEV_CO17
     C                   EVAL      SVEV_CO18=ZVEV_CO18
     C                   EVAL      SVEV_CO19=ZVEV_CO19
     C                   EVAL      SVEV_CO20=ZVEV_CO20
     C                   EVAL      SVEV_TIK1=ZVEV_TIK1
     C                   EVAL      SVEV_TIK2=ZVEV_TIK2
     C                   EVAL      SVEV_TIK3=ZVEV_TIK3
     C                   EVAL      SVEV_TIK4=ZVEV_TIK4
     C                   EVAL      SVEV_TIK5=ZVEV_TIK5
     C                   EVAL      SVEV_TIK6=ZVEV_TIK6
     C                   EVAL      SVEV_TIK7=ZVEV_TIK7
     C                   EVAL      SVEV_TIK8=ZVEV_TIK8
     C                   EVAL      SVEV_TIK9=ZVEV_TIK9
     C                   EVAL      SVEV_TIT1=ZVEV_TIT1
     C                   EVAL      SVEV_TIT2=ZVEV_TIT2
     C                   EVAL      SVEV_TIT3=ZVEV_TIT3
     C                   EVAL      SVEV_TIT4=ZVEV_TIT4
     C                   EVAL      SVEV_TIT5=ZVEV_TIT5
     C                   EVAL      SVEV_TIT6=ZVEV_TIT6
     C                   EVAL      SVEV_TIT7=ZVEV_TIT7
     C                   EVAL      SVEV_TIT8=ZVEV_TIT8
     C                   EVAL      SVEV_TIT9=ZVEV_TIT9
     C                   EVAL      SVEV_TIX1=ZVEV_TIX1
     C                   EVAL      SVEV_TIX2=ZVEV_TIX2
     C                   EVAL      SVEV_TIX3=ZVEV_TIX3
     C                   EVAL      SVEV_TIX4=ZVEV_TIX4
     C                   EVAL      SVEV_TIX5=ZVEV_TIX5
     C                   EVAL      SVEV_TIX6=ZVEV_TIX6
     C                   EVAL      SVEV_TIX7=ZVEV_TIX7
     C                   EVAL      SVEV_TIX8=ZVEV_TIX8
     C                   EVAL      SVEV_TIX9=ZVEV_TIX9
     C                   EVAL      SVEV_LAGI=ZVEV_LAGI
     C                   EVAL      SVEV_LAGT=ZVEV_LAGT
     C                   EVAL      SVEV_LAGL=ZVEV_LAGL
     C                   EVAL      SVEV_CALL=ZVEV_CALL
     C                   WRITE     SVEVR
      *______________________
      * Adda post til  SUBFIL
      *""""""""""""""""""""""
     C                   ADD       1             WRECNO
     C                   EVAL      ZRECNO=WRECNO
     C                   WRITE     SVE003DA

     C                   ADD       SVEV_FABL     WVEH_FABL
     C                   EVAL      XVEH_FABL=SVEH_FABL - WVEH_FABL
     C                   ADD       SVEV_BRUT     WVEH_BRUT
     C                   EVAL      XVEH_BRUT=SVEH_BRUT - WVEH_BRUT
     C                   ADD       SVEV_KOTA     WVEH_KOTA
     C                   EVAL      XVEH_KOTA=SVEH_KOTA - WVEH_KOTA

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Endre                                               SRBB /
      *////////////////////////////////////////////////////////////
     C     SRBB          BEGSR
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   MOVE      *BLANKS       ZOP
     C                   UPDATE    SVE003DA
      *____________
      * Flytte felt
      *""""""""""""
     C                   CLEAR                   SVE003DD
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     4             POSNBR
     C     KEYA          CHAIN(N)  SVEV                               53
     C                   EVAL      ZVEV_KOTA=SVEV_KOTA
     C                   EVAL      ZVEV_KOT2=SVEV_KOT2
     C                   EVAL      ZVEV_KOT3=SVEV_KOT3
     C                   EVAL      ZVEV_KOT4=SVEV_KOT4
     C                   EVAL      ZVEV_KOT5=SVEV_KOT5
     C                   EVAL      ZVEV_KOSL=SVEV_KOSL
     C                   EVAL      ZVEV_KOS2=SVEV_KOS2
     C                   EVAL      ZVEV_KOS3=SVEV_KOS3
     C                   EVAL      ZVEV_KOS4=SVEV_KOS4
     C                   EVAL      ZVEV_KOS5=SVEV_KOS5
     C                   EVAL      ZVEV_VASL=SVEV_VASL
     C                   EVAL      ZVEV_VAS2=SVEV_VAS2
     C                   EVAL      ZVEV_VAS3=SVEV_VAS3
     C                   EVAL      ZVEV_VAS4=SVEV_VAS4
     C                   EVAL      ZVEV_VAS5=SVEV_VAS5
     C                   EVAL      ZVEV_GODM=SVEV_GODM
     C                   EVAL      ZVEV_GOD2=SVEV_GOD2
     C                   EVAL      ZVEV_GOD3=SVEV_GOD3
     C                   EVAL      ZVEV_GOD4=SVEV_GOD4
     C                   EVAL      zVEV_GOD5=SVEV_GOD5
     C                   EVAL      ZVEV_VATA=SVEV_VATA
     C                   EVAL      ZVEV_VATI=SVEV_VATI
     C                   EVAL      ZVEV_VAT4=SVEV_VAT4
     C                   EVAL      ZVEV_VAT5=SVEV_VAT5
     C                   EVAL      ZVEV_ULKD=SVEV_ULKD
     C                   EVAL      ZVEV_BRUT=SVEV_BRUT
     C                   EVAL      ZVEV_EUP1=SVEV_EUP1
     C                   EVAL      ZVEV_EUP2=SVEV_EUP2
     C                   EVAL      ZVEV_NETO=SVEV_NETO
     C                   EVAL      ZVEV_ANKV=SVEV_ANKV
     C                   EVAL      ZVEV_SUKO=SVEV_SUKO
     C                   EVAL      ZVEV_SUK6=SVEV_SUK6
     C                   EVAL      ZVEV_SUKB=SVEV_SUKB
     C                   EVAL      ZVEV_SUTX=SVEV_SUTX
     C                   EVAL      ZVEV_SUTX=SVEV_SUTX
     C                   EVAL      ZVEV_SUT2=SVEV_SUT2
     C                   EVAL      ZVEV_SUT3=SVEV_SUT3
     C                   EVAL      ZVEV_SUT4=SVEV_SUT4
     C                   EVAL      ZVEV_SUT5=SVEV_SUT5
     C                   EVAL      ZVEV_SUT6=SVEV_SUT6
     C                   EVAL      ZVEV_SUT7=SVEV_SUT7
     C                   EVAL      ZVEV_SUT8=SVEV_SUT8
     C                   EVAL      ZVEV_SUT9=SVEV_SUT9
     C                   EVAL      ZVEV_SUTA=SVEV_SUTA
     C                   EVAL      ZVEV_SUTB=SVEV_SUTB
     C                   EVAL      ZVEV_SUTC=SVEV_SUTC
     C                   EVAL      ZVEV_SUTD=SVEV_SUTD
     C                   EVAL      ZVEV_SUTE=SVEV_SUTE
     C                   EVAL      ZVEV_SUTF=SVEV_SUTF
     C                   EVAL      ZVEV_FABL=SVEV_FABL
     C                   EVAL      ZVEV_STVA=SVEV_STVA
     C                   EVAL      ZVEV_STVA2=SVEV_STVA2
     C                   EVAL      ZVEV_BETK=SVEV_BETK
     C                   EVAL      ZVEV_KOMR=SVEV_KOMR
     C                   EVAL      ZVEV_FNKD=SVEV_FNKD
     C                   EVAL      ZVEV_BIT1=SVEV_BIT1
     C                   EVAL      ZVEV_BIT2=SVEV_BIT2
     C                   EVAL      ZVEV_BIT3=SVEV_BIT3
     C                   EVAL      ZVEV_BIT4=SVEV_BIT4
     C                   EVAL      ZVEV_BIT5=SVEV_BIT5
     C                   EVAL      ZVEV_BIT6=SVEV_BIT6
     C                   EVAL      ZVEV_BIT7=SVEV_BIT7
     C                   EVAL      ZVEV_BIT8=SVEV_BIT8
     C                   EVAL      ZVEV_BIT9=SVEV_BIT9
     C                   EVAL      ZVEV_BII1=SVEV_BII1
     C                   EVAL      ZVEV_BII2=SVEV_BII2
     C                   EVAL      ZVEV_BII3=SVEV_BII3
     C                   EVAL      ZVEV_BII4=SVEV_BII4
     C                   EVAL      ZVEV_BII5=SVEV_BII5
     C                   EVAL      ZVEV_BII6=SVEV_BII6
     C                   EVAL      ZVEV_BII7=SVEV_BII7
     C                   EVAL      ZVEV_BII8=SVEV_BII8
     C                   EVAL      ZVEV_BII9=SVEV_BII9
     C                   EVAL      ZVEV_CO01=SVEV_CO01
     C                   EVAL      ZVEV_CO02=SVEV_CO02
     C                   EVAL      ZVEV_CO03=SVEV_CO03
     C                   EVAL      ZVEV_CO04=SVEV_CO04
     C                   EVAL      ZVEV_CO05=SVEV_CO05
     C                   EVAL      ZVEV_CO06=SVEV_CO06
     C                   EVAL      ZVEV_CO07=SVEV_CO07
     C                   EVAL      ZVEV_CO08=SVEV_CO08
     C                   EVAL      ZVEV_CO09=SVEV_CO09
     C                   EVAL      ZVEV_CO10=SVEV_CO10
     C                   EVAL      ZVEV_CO11=SVEV_CO11
     C                   EVAL      ZVEV_CO12=SVEV_CO12
     C                   EVAL      ZVEV_CO13=SVEV_CO13
     C                   EVAL      ZVEV_CO14=SVEV_CO14
     C                   EVAL      ZVEV_CO15=SVEV_CO15
     C                   EVAL      ZVEV_CO16=SVEV_CO16
     C                   EVAL      ZVEV_CO17=SVEV_CO17
     C                   EVAL      ZVEV_CO18=SVEV_CO18
     C                   EVAL      ZVEV_CO19=SVEV_CO19
     C                   EVAL      ZVEV_CO20=SVEV_CO20
     C                   EVAL      ZVEV_TIK1=SVEV_TIK1
     C                   EVAL      ZVEV_TIK2=SVEV_TIK2
     C                   EVAL      ZVEV_TIK3=SVEV_TIK3
     C                   EVAL      ZVEV_TIK4=SVEV_TIK4
     C                   EVAL      ZVEV_TIK5=SVEV_TIK5
     C                   EVAL      ZVEV_TIK6=SVEV_TIK6
     C                   EVAL      ZVEV_TIK7=SVEV_TIK7
     C                   EVAL      ZVEV_TIK8=SVEV_TIK8
     C                   EVAL      ZVEV_TIK9=SVEV_TIK9
     C                   EVAL      ZVEV_TIT1=SVEV_TIT1
     C                   EVAL      ZVEV_TIT2=SVEV_TIT2
     C                   EVAL      ZVEV_TIT3=SVEV_TIT3
     C                   EVAL      ZVEV_TIT4=SVEV_TIT4
     C                   EVAL      ZVEV_TIT5=SVEV_TIT5
     C                   EVAL      ZVEV_TIT6=SVEV_TIT6
     C                   EVAL      ZVEV_TIT7=SVEV_TIT7
     C                   EVAL      ZVEV_TIT8=SVEV_TIT8
     C                   EVAL      ZVEV_TIT9=SVEV_TIT9
     C                   EVAL      ZVEV_TIX1=SVEV_TIX1
     C                   EVAL      ZVEV_TIX2=SVEV_TIX2
     C                   EVAL      ZVEV_TIX3=SVEV_TIX3
     C                   EVAL      ZVEV_TIX4=SVEV_TIX4
     C                   EVAL      ZVEV_TIX5=SVEV_TIX5
     C                   EVAL      ZVEV_TIX6=SVEV_TIX6
     C                   EVAL      ZVEV_TIX7=SVEV_TIX7
     C                   EVAL      ZVEV_TIX8=SVEV_TIX8
     C                   EVAL      ZVEV_TIX9=SVEV_TIX9
     C                   EVAL      ZVEV_LAGI=SVEV_LAGI
     C                   EVAL      ZVEV_LAGT=SVEV_LAGT
     C                   EVAL      ZVEV_LAGL=SVEV_LAGL
     C                   EVAL      ZVEV_CALL=SVEV_CALL
N15  C                   EVAL      WVEV_SYLI=SVEV_SYLI
      * Hent fra heading
     C                   IF        ZVEV_BIT1=*BLANKS
     C                   EVAL      ZVEV_BIT1=SVEH_FATY
     C                   EVAL      ZVEV_BII1=SVEH_FATX
     C                   ENDIF

     C     SRBB1         TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DD
     C                   EVAL      *IN30 = *OFF
     C                   EVAL      *IN31 = *OFF
     C                   EVAL      *IN32 = *OFF
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
     C                   EVAL      *IN35 = *OFF
     C                   EVAL      *IN36 = *OFF
     C                   EVAL      *IN37 = *OFF
     C                   EVAL      *IN38 = *OFF
     C                   EVAL      *IN39 = *OFF
     C                   EVAL      *IN40 = *OFF
     C                   EVAL      *IN41 = *OFF
     C                   EVAL      *IN42 = *OFF
     C     *IN12         IFEQ      '0'
      *_______
      * F4=Søk
      *"""""""
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     *IN04         IFEQ      '1'
     C     LINNBR        IFEQ      22
     C     LINNBR        OREQ      23
     C     LINNBR        OREQ      24
     C     LINNBR        OREQ      25
     C                   EXSR      SRC
     C                   GOTO      SRBB1
     C                   ENDIF
     C                   ENDIF
N13   * F11=Kunders varuposter (externt)
N13  C                   IF        *IN11
N13  C                   EXSR      SRKUNSOK
N13  C                   GOTO      SRBB1
N13  C                   ENDIF
      * Føranmælan
     C     *IN13         IFEQ      '1'
     C                   EXFMT     SVE003DH
     C                   GOTO      SRBB1
     C                   ENDIF
      * Mer R31
     C     *IN14         IFEQ      '1'
     C                   EXSR      SRI
     C                   GOTO      SRBB1
     C                   ENDIF
      * Mer Særsk uppl
     C     *IN15         IFEQ      '1'
     C                   EXSR      SRJ
     C                   GOTO      SRBB1
     C                   ENDIF
      * Mer Bil Handl
     C     *IN16         IFEQ      '1'
     C                   EXSR      SRK
     C                   GOTO      SRBB1
     C                   ENDIF
      * Mer Containernummer
     C     *IN17         IFEQ      '1'
     C                   EXSR      SRL
     C                   GOTO      SRBB1
     C                   ENDIF
      * Mer Tidigare Handlingar
     C     *IN18         IFEQ      '1'
     C                   EXSR      SRM
     C                   GOTO      SRBB1
     C                   ENDIF
      * Lageridentitet
     C     *IN19         IFEQ      '1'
     C                   EXSR      SRN
     C                   GOTO      SRBB1
     C                   ENDIF
N02   *_____________________________
N02   * F10=Automatisk viktberækning
N02   *"""""""""""""""""""""""""""""
N02  C                   IF        *IN10
N02  C                   EXSR      SRAUTOVK
N02  C                   GOTO      SRBB1
N02  C                   ENDIF
      *____________
      * Teste input
      *""""""""""""
     C                   EXSR      SRBTST
     C   30              GOTO      SRBB1
      * Statistisk verdi
     C                   EXSR      SRCIFDET
      * Avgiftsberækning ?
     C     ZVEV_AVGB     IFNE      *BLANKS
      * Automatisk avgiftsberækning
     C                   EXSR      SRBAA
     C*                  EVAL      ZVEV_AVGB='X'
     C                   ENDIF
     C     ZVEV_AVGB     IFNE      *BLANKS
     C                   CALL      'SVE004R'
     C                   PARM                    ZVEV_SYAV
     C                   PARM                    ZVEV_SYOP
     C                   PARM                    SVEV_SYLI
     C                   PARM                    WPROT
     C                   ENDIF
N10   * Hæmta och skriv Y-koder och tillæggskoder automatiskt
N10  C                   EXSR      SRGETKOD
      *______________
      * Oppdatere FIL
      *""""""""""""""
     C     KEYA          CHAIN     SVEV                               53

     C                   SUB       SVEV_FABL     WVEH_FABL
     C                   EVAL      XVEH_FABL=SVEH_FABL - WVEH_FABL
     C                   SUB       SVEV_BRUT     WVEH_BRUT
     C                   EVAL      XVEH_BRUT=SVEH_BRUT - WVEH_BRUT
     C                   SUB       SVEV_KOTA     WVEH_KOTA
     C                   EVAL      XVEH_KOTA=SVEH_KOTA - WVEH_KOTA

     C                   EVAL      SVEV_KOTA=ZVEV_KOTA
     C                   EVAL      SVEV_KOT2=ZVEV_KOT2
     C                   EVAL      SVEV_KOT3=ZVEV_KOT3
     C                   EVAL      SVEV_KOT4=ZVEV_KOT4
     C                   EVAL      SVEV_KOT5=ZVEV_KOT5
     C                   EVAL      SVEV_KOSL=ZVEV_KOSL
     C                   EVAL      SVEV_KOS2=ZVEV_KOS2
     C                   EVAL      SVEV_KOS3=ZVEV_KOS3
     C                   EVAL      SVEV_KOS4=ZVEV_KOS4
     C                   EVAL      SVEV_KOS5=ZVEV_KOS5
     C                   EVAL      SVEV_VASL=ZVEV_VASL
     C                   EVAL      SVEV_VAS2=ZVEV_VAS2
     C                   EVAL      SVEV_VAS3=ZVEV_VAS3
     C                   EVAL      SVEV_VAS4=ZVEV_VAS4
     C                   EVAL      SVEV_VAS5=ZVEV_VAS5
     C                   EVAL      SVEV_GODM=ZVEV_GODM
     C                   EVAL      SVEV_GOD2=ZVEV_GOD2
     C                   EVAL      SVEV_GOD3=ZVEV_GOD3
     C                   EVAL      SVEV_GOD4=ZVEV_GOD4
     C                   EVAL      SVEV_GOD5=ZVEV_GOD5
     C                   EVAL      SVEV_VATA=ZVEV_VATA
     C                   EVAL      SVEV_VATI=ZVEV_VATI
     C                   EVAL      SVEV_VAT4=ZVEV_VAT4
     C                   EVAL      SVEV_VAT5=ZVEV_VAT5
     C                   EVAL      SVEV_ULKD=ZVEV_ULKD
     C                   EVAL      SVEV_BRUT=ZVEV_BRUT
     C                   EVAL      SVEV_EUP1=ZVEV_EUP1
     C                   EVAL      SVEV_EUP2=ZVEV_EUP2
     C                   EVAL      SVEV_NETO=ZVEV_NETO
     C                   EVAL      SVEV_ANKV=ZVEV_ANKV
     C                   EVAL      SVEV_SUKO=ZVEV_SUKO
     C                   EVAL      SVEV_SUK6=ZVEV_SUK6
     C                   EVAL      SVEV_SUKB=ZVEV_SUKB
     C                   EVAL      SVEV_SUTX=ZVEV_SUTX
     C                   EVAL      SVEV_SUT2=ZVEV_SUT2
     C                   EVAL      SVEV_SUT3=ZVEV_SUT3
     C                   EVAL      SVEV_SUT4=ZVEV_SUT4
     C                   EVAL      SVEV_SUT5=ZVEV_SUT5
     C                   EVAL      SVEV_SUT6=ZVEV_SUT6
     C                   EVAL      SVEV_SUT7=ZVEV_SUT7
     C                   EVAL      SVEV_SUT8=ZVEV_SUT8
     C                   EVAL      SVEV_SUT9=ZVEV_SUT9
     C                   EVAL      SVEV_SUTA=ZVEV_SUTA
     C                   EVAL      SVEV_SUTB=ZVEV_SUTB
     C                   EVAL      SVEV_SUTC=ZVEV_SUTC
     C                   EVAL      SVEV_SUTD=ZVEV_SUTD
     C                   EVAL      SVEV_SUTE=ZVEV_SUTE
     C                   EVAL      SVEV_SUTF=ZVEV_SUTF
     C                   EVAL      SVEV_FABL=ZVEV_FABL
     C                   EVAL      SVEV_STVA=ZVEV_STVA
     C                   EVAL      SVEV_STVA2=ZVEV_STVA2
     C                   EVAL      SVEV_BETK=ZVEV_BETK
     C                   EVAL      SVEV_KOMR=ZVEV_KOMR
     C                   EVAL      SVEV_FNKD=ZVEV_FNKD
     C                   EVAL      SVEV_BIT1=ZVEV_BIT1
     C                   EVAL      SVEV_BIT2=ZVEV_BIT2
     C                   EVAL      SVEV_BIT3=ZVEV_BIT3
     C                   EVAL      SVEV_BIT4=ZVEV_BIT4
     C                   EVAL      SVEV_BIT5=ZVEV_BIT5
     C                   EVAL      SVEV_BIT6=ZVEV_BIT6
     C                   EVAL      SVEV_BIT7=ZVEV_BIT7
     C                   EVAL      SVEV_BIT8=ZVEV_BIT8
     C                   EVAL      SVEV_BIT9=ZVEV_BIT9
     C                   EVAL      SVEV_BII1=ZVEV_BII1
     C                   EVAL      SVEV_BII2=ZVEV_BII2
     C                   EVAL      SVEV_BII3=ZVEV_BII3
     C                   EVAL      SVEV_BII4=ZVEV_BII4
     C                   EVAL      SVEV_BII5=ZVEV_BII5
     C                   EVAL      SVEV_BII6=ZVEV_BII6
     C                   EVAL      SVEV_BII7=ZVEV_BII7
     C                   EVAL      SVEV_BII8=ZVEV_BII8
     C                   EVAL      SVEV_BII9=ZVEV_BII9
     C                   EVAL      SVEV_CO01=ZVEV_CO01
     C                   EVAL      SVEV_CO02=ZVEV_CO02
     C                   EVAL      SVEV_CO03=ZVEV_CO03
     C                   EVAL      SVEV_CO04=ZVEV_CO04
     C                   EVAL      SVEV_CO05=ZVEV_CO05
     C                   EVAL      SVEV_CO06=ZVEV_CO06
     C                   EVAL      SVEV_CO07=ZVEV_CO07
     C                   EVAL      SVEV_CO08=ZVEV_CO08
     C                   EVAL      SVEV_CO09=ZVEV_CO09
     C                   EVAL      SVEV_CO10=ZVEV_CO10
     C                   EVAL      SVEV_CO11=ZVEV_CO11
     C                   EVAL      SVEV_CO12=ZVEV_CO12
     C                   EVAL      SVEV_CO13=ZVEV_CO13
     C                   EVAL      SVEV_CO14=ZVEV_CO14
     C                   EVAL      SVEV_CO15=ZVEV_CO15
     C                   EVAL      SVEV_CO16=ZVEV_CO16
     C                   EVAL      SVEV_CO17=ZVEV_CO17
     C                   EVAL      SVEV_CO18=ZVEV_CO18
     C                   EVAL      SVEV_CO19=ZVEV_CO19
     C                   EVAL      SVEV_CO20=ZVEV_CO20
     C                   EVAL      SVEV_TIK1=ZVEV_TIK1
     C                   EVAL      SVEV_TIK2=ZVEV_TIK2
     C                   EVAL      SVEV_TIK3=ZVEV_TIK3
     C                   EVAL      SVEV_TIK4=ZVEV_TIK4
     C                   EVAL      SVEV_TIK5=ZVEV_TIK5
     C                   EVAL      SVEV_TIK6=ZVEV_TIK6
     C                   EVAL      SVEV_TIK7=ZVEV_TIK7
     C                   EVAL      SVEV_TIK8=ZVEV_TIK8
     C                   EVAL      SVEV_TIK9=ZVEV_TIK9
     C                   EVAL      SVEV_TIT1=ZVEV_TIT1
     C                   EVAL      SVEV_TIT2=ZVEV_TIT2
     C                   EVAL      SVEV_TIT3=ZVEV_TIT3
     C                   EVAL      SVEV_TIT4=ZVEV_TIT4
     C                   EVAL      SVEV_TIT5=ZVEV_TIT5
     C                   EVAL      SVEV_TIT6=ZVEV_TIT6
     C                   EVAL      SVEV_TIT7=ZVEV_TIT7
     C                   EVAL      SVEV_TIT8=ZVEV_TIT8
     C                   EVAL      SVEV_TIT9=ZVEV_TIT9
     C                   EVAL      SVEV_TIX1=ZVEV_TIX1
     C                   EVAL      SVEV_TIX2=ZVEV_TIX2
     C                   EVAL      SVEV_TIX3=ZVEV_TIX3
     C                   EVAL      SVEV_TIX4=ZVEV_TIX4
     C                   EVAL      SVEV_TIX5=ZVEV_TIX5
     C                   EVAL      SVEV_TIX6=ZVEV_TIX6
     C                   EVAL      SVEV_TIX7=ZVEV_TIX7
     C                   EVAL      SVEV_TIX8=ZVEV_TIX8
     C                   EVAL      SVEV_TIX9=ZVEV_TIX9
     C                   EVAL      SVEV_LAGI=ZVEV_LAGI
     C                   EVAL      SVEV_LAGT=ZVEV_LAGT
     C                   EVAL      SVEV_LAGL=ZVEV_LAGL
     C                   EVAL      SVEV_CALL=ZVEV_CALL
N14  C                   EVAL      SVEV_ERR=*BLANKS
     C                   UPDATE    SVEVR

     C                   ADD       SVEV_FABL     WVEH_FABL
     C                   EVAL      XVEH_FABL=SVEH_FABL - WVEH_FABL
     C                   ADD       SVEV_BRUT     WVEH_BRUT
     C                   EVAL      XVEH_BRUT=SVEH_BRUT - WVEH_BRUT
     C                   ADD       SVEV_KOTA     WVEH_KOTA
     C                   EVAL      XVEH_KOTA=SVEH_KOTA - WVEH_KOTA

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Slette                                              SRBD /
      *////////////////////////////////////////////////////////////
     C     SRBD          BEGSR
      *______________
      * Oppdatere FIL
      *""""""""""""""
     C     KEYA          CHAIN     SVEV                               53
     C                   DELETE    SVEVR
      *_______________
      * Slett avgifter
      *"""""""""""""""
     C                   EVAL      *IN53=*OFF
     C     KEYA          SETLL     SVEVA
     C     KEYA          READE     SVEVA                                  53
     C     *IN53         DOWEQ     *OFF
     C                   DELETE    SVEVAR
     C     KEYA          READE     SVEVA                                  53
     C                   ENDDO
      *_______________
      * Slett Xtra R44
      *"""""""""""""""
     C                   EVAL      *IN53=*OFF
     C     KEYA          SETLL     SVEVX
     C     KEYA          READE     SVEVX                                  53
     C     *IN53         DOWEQ     *OFF
     C                   DELETE    SVEVXR
     C     KEYA          READE     SVEVX                                  53
     C                   ENDDO
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   CLEAR                   SVE003DA
     C                   UPDATE    SVE003DA
     C                   EVAL      *IN95=*ON

     C                   SUB       SVEV_FABL     WVEH_FABL
     C                   EVAL      XVEH_FABL=SVEH_FABL - WVEH_FABL
     C                   SUB       SVEV_BRUT     WVEH_BRUT
     C                   EVAL      XVEH_BRUT=SVEH_BRUT - WVEH_BRUT
     C                   SUB       SVEV_KOTA     WVEH_KOTA
     C                   EVAL      XVEH_KOTA=SVEH_KOTA - WVEH_KOTA

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Vise                                                SRBE /
      *////////////////////////////////////////////////////////////
     C     SRBE          BEGSR
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   MOVE      *BLANKS       ZOP
     C                   UPDATE    SVE003DA
      *____________
      * Flytte felt
      *""""""""""""
     C                   CLEAR                   SVE003DD
     C                   IF        UMODE='D'
     C                   EVAL      *IN27=*ON
     C                   ENDIF
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     4             POSNBR
     C     KEYA          CHAIN(N)  SVEV                               53
     C                   EVAL      ZVEV_KOTA=SVEV_KOTA
     C                   EVAL      ZVEV_KOT2=SVEV_KOT2
     C                   EVAL      ZVEV_KOT3=SVEV_KOT3
     C                   EVAL      ZVEV_KOT4=SVEV_KOT4
     C                   EVAL      ZVEV_KOT5=SVEV_KOT5
     C                   EVAL      ZVEV_KOSL=SVEV_KOSL
     C                   EVAL      ZVEV_KOS2=SVEV_KOS2
     C                   EVAL      ZVEV_KOS3=SVEV_KOS3
     C                   EVAL      ZVEV_KOS4=SVEV_KOS4
     C                   EVAL      ZVEV_KOS5=SVEV_KOS5
     C                   EVAL      ZVEV_VASL=SVEV_VASL
     C                   EVAL      ZVEV_VAS2=SVEV_VAS2
     C                   EVAL      ZVEV_VAS3=SVEV_VAS3
     C                   EVAL      ZVEV_VAS4=SVEV_VAS4
     C                   EVAL      ZVEV_VAS5=SVEV_VAS5
     C                   EVAL      ZVEV_GODM=SVEV_GODM
     C                   EVAL      ZVEV_GOD2=SVEV_GOD2
     C                   EVAL      ZVEV_GOD3=SVEV_GOD3
     C                   EVAL      ZVEV_GOD4=SVEV_GOD4
     C                   EVAL      zVEV_GOD5=SVEV_GOD5
     C                   EVAL      ZVEV_VATA=SVEV_VATA
     C                   EVAL      ZVEV_VATI=SVEV_VATI
     C                   EVAL      ZVEV_VAT4=SVEV_VAT4
     C                   EVAL      ZVEV_VAT5=SVEV_VAT5
     C                   EVAL      ZVEV_ULKD=SVEV_ULKD
     C                   EVAL      ZVEV_BRUT=SVEV_BRUT
     C                   EVAL      ZVEV_EUP1=SVEV_EUP1
     C                   EVAL      ZVEV_EUP2=SVEV_EUP2
     C                   EVAL      ZVEV_NETO=SVEV_NETO
     C                   EVAL      ZVEV_ANKV=SVEV_ANKV
     C                   EVAL      ZVEV_SUKO=SVEV_SUKO
     C                   EVAL      ZVEV_SUK6=SVEV_SUK6
     C                   EVAL      ZVEV_SUKB=SVEV_SUKB
     C                   EVAL      ZVEV_SUTX=SVEV_SUTX
     C                   EVAL      ZVEV_SUTX=SVEV_SUTX
     C                   EVAL      ZVEV_SUT2=SVEV_SUT2
     C                   EVAL      ZVEV_SUT3=SVEV_SUT3
     C                   EVAL      ZVEV_SUT4=SVEV_SUT4
     C                   EVAL      ZVEV_SUT5=SVEV_SUT5
     C                   EVAL      ZVEV_SUT6=SVEV_SUT6
     C                   EVAL      ZVEV_SUT7=SVEV_SUT7
     C                   EVAL      ZVEV_SUT8=SVEV_SUT8
     C                   EVAL      ZVEV_SUT9=SVEV_SUT9
     C                   EVAL      ZVEV_SUTA=SVEV_SUTA
     C                   EVAL      ZVEV_SUTB=SVEV_SUTB
     C                   EVAL      ZVEV_SUTC=SVEV_SUTC
     C                   EVAL      ZVEV_SUTD=SVEV_SUTD
     C                   EVAL      ZVEV_SUTE=SVEV_SUTE
     C                   EVAL      ZVEV_SUTF=SVEV_SUTF
     C                   EVAL      ZVEV_FABL=SVEV_FABL
     C                   EVAL      ZVEV_STVA=SVEV_STVA
     C                   EVAL      ZVEV_STVA2=SVEV_STVA2
     C                   EVAL      ZVEV_BETK=SVEV_BETK
     C                   EVAL      ZVEV_KOMR=SVEV_KOMR
     C                   EVAL      ZVEV_FNKD=SVEV_FNKD
     C                   EVAL      ZVEV_BIT1=SVEV_BIT1
     C                   EVAL      ZVEV_BIT2=SVEV_BIT2
     C                   EVAL      ZVEV_BIT3=SVEV_BIT3
     C                   EVAL      ZVEV_BIT4=SVEV_BIT4
     C                   EVAL      ZVEV_BIT5=SVEV_BIT5
     C                   EVAL      ZVEV_BIT6=SVEV_BIT6
     C                   EVAL      ZVEV_BIT7=SVEV_BIT7
     C                   EVAL      ZVEV_BIT8=SVEV_BIT8
     C                   EVAL      ZVEV_BIT9=SVEV_BIT9
     C                   EVAL      ZVEV_BII1=SVEV_BII1
     C                   EVAL      ZVEV_BII2=SVEV_BII2
     C                   EVAL      ZVEV_BII3=SVEV_BII3
     C                   EVAL      ZVEV_BII4=SVEV_BII4
     C                   EVAL      ZVEV_BII5=SVEV_BII5
     C                   EVAL      ZVEV_BII6=SVEV_BII6
     C                   EVAL      ZVEV_BII7=SVEV_BII7
     C                   EVAL      ZVEV_BII8=SVEV_BII8
     C                   EVAL      ZVEV_BII9=SVEV_BII9
     C                   EVAL      ZVEV_CO01=SVEV_CO01
     C                   EVAL      ZVEV_CO02=SVEV_CO02
     C                   EVAL      ZVEV_CO03=SVEV_CO03
     C                   EVAL      ZVEV_CO04=SVEV_CO04
     C                   EVAL      ZVEV_CO05=SVEV_CO05
     C                   EVAL      ZVEV_CO06=SVEV_CO06
     C                   EVAL      ZVEV_CO07=SVEV_CO07
     C                   EVAL      ZVEV_CO08=SVEV_CO08
     C                   EVAL      ZVEV_CO09=SVEV_CO09
     C                   EVAL      ZVEV_CO10=SVEV_CO10
     C                   EVAL      ZVEV_CO11=SVEV_CO11
     C                   EVAL      ZVEV_CO12=SVEV_CO12
     C                   EVAL      ZVEV_CO13=SVEV_CO13
     C                   EVAL      ZVEV_CO14=SVEV_CO14
     C                   EVAL      ZVEV_CO15=SVEV_CO15
     C                   EVAL      ZVEV_CO16=SVEV_CO16
     C                   EVAL      ZVEV_CO17=SVEV_CO17
     C                   EVAL      ZVEV_CO18=SVEV_CO18
     C                   EVAL      ZVEV_CO19=SVEV_CO19
     C                   EVAL      ZVEV_CO20=SVEV_CO20
     C                   EVAL      ZVEV_TIK1=SVEV_TIK1
     C                   EVAL      ZVEV_TIK2=SVEV_TIK2
     C                   EVAL      ZVEV_TIK3=SVEV_TIK3
     C                   EVAL      ZVEV_TIK4=SVEV_TIK4
     C                   EVAL      ZVEV_TIK5=SVEV_TIK5
     C                   EVAL      ZVEV_TIK6=SVEV_TIK6
     C                   EVAL      ZVEV_TIK7=SVEV_TIK7
     C                   EVAL      ZVEV_TIK8=SVEV_TIK8
     C                   EVAL      ZVEV_TIK9=SVEV_TIK9
     C                   EVAL      ZVEV_TIT1=SVEV_TIT1
     C                   EVAL      ZVEV_TIT2=SVEV_TIT2
     C                   EVAL      ZVEV_TIT3=SVEV_TIT3
     C                   EVAL      ZVEV_TIT4=SVEV_TIT4
     C                   EVAL      ZVEV_TIT5=SVEV_TIT5
     C                   EVAL      ZVEV_TIT6=SVEV_TIT6
     C                   EVAL      ZVEV_TIT7=SVEV_TIT7
     C                   EVAL      ZVEV_TIT8=SVEV_TIT8
     C                   EVAL      ZVEV_TIT9=SVEV_TIT9
     C                   EVAL      ZVEV_TIX1=SVEV_TIX1
     C                   EVAL      ZVEV_TIX2=SVEV_TIX2
     C                   EVAL      ZVEV_TIX3=SVEV_TIX3
     C                   EVAL      ZVEV_TIX4=SVEV_TIX4
     C                   EVAL      ZVEV_TIX5=SVEV_TIX5
     C                   EVAL      ZVEV_TIX6=SVEV_TIX6
     C                   EVAL      ZVEV_TIX7=SVEV_TIX7
     C                   EVAL      ZVEV_TIX8=SVEV_TIX8
     C                   EVAL      ZVEV_TIX9=SVEV_TIX9
     C                   EVAL      ZVEV_LAGI=SVEV_LAGI
     C                   EVAL      ZVEV_LAGT=SVEV_LAGT
     C                   EVAL      ZVEV_LAGL=SVEV_LAGL
     C                   EVAL      ZVEV_CALL=SVEV_CALL
N15  C                   EVAL      WVEV_SYLI=SVEV_SYLI
      * Hent fra heading
     C                   IF        ZVEV_BIT1=*BLANKS
     C                   EVAL      ZVEV_BIT1=SVEH_FATY
     C                   EVAL      ZVEV_BII1=SVEH_FATX
     C                   ENDIF

     C     SRBE1         TAG


     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DD
     C                   EVAL      *IN30 = *OFF
     C                   EVAL      *IN31 = *OFF
     C                   EVAL      *IN32 = *OFF
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
     C                   EVAL      *IN35 = *OFF
     C                   EVAL      *IN36 = *OFF
     C                   EVAL      *IN37 = *OFF
     C                   EVAL      *IN38 = *OFF
     C                   EVAL      *IN39 = *OFF
     C                   EVAL      *IN40 = *OFF
     C                   EVAL      *IN41 = *OFF
     C                   EVAL      *IN42 = *OFF
     C     *IN12         IFEQ      '0'
      * Føranmælan
     C     *IN13         IFEQ      '1'
     C                   EXFMT     SVE003DH
     C                   GOTO      SRBE1
     C                   ENDIF
      * Mer R31
     C     *IN14         IFEQ      '1'
     C                   EXSR      SRI
     C                   GOTO      SRBE1
     C                   ENDIF
      * Mer Særsk uppl
     C     *IN15         IFEQ      '1'
     C                   EXSR      SRJ
     C                   GOTO      SRBE1
     C                   ENDIF
      * Mer Bil Handl
     C     *IN16         IFEQ      '1'
     C                   EXSR      SRK
     C                   GOTO      SRBE1
     C                   ENDIF
      * Mer Containernummer
     C     *IN17         IFEQ      '1'
     C                   EXSR      SRL
     C                   GOTO      SRBE1
     C                   ENDIF
      * Mer Tidigare Handlingar
     C     *IN18         IFEQ      '1'
     C                   EXSR      SRM
     C                   GOTO      SRBE1
     C                   ENDIF
      * Lageridentitet
     C     *IN19         IFEQ      '1'
     C                   EXSR      SRN
     C                   GOTO      SRBE1
     C                   ENDIF
      *____________
      * Teste input
      *""""""""""""
     C     ZVEV_AVGB     IFNE      *BLANKS
     C                   CALL      'SVE004R'
     C                   PARM                    ZVEV_SYAV
     C                   PARM                    ZVEV_SYOP
     C                   PARM                    SVEV_SYLI
     C                   PARM                    WPROT
     C                   ENDIF

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Søk                                                  SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
      * Ursprungsland
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDEQ     4
     C                   CALL      'SVT003R'
     C                   PARM      'GCY'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_ULKD
     C                   ENDIF
     C                   Z-ADD     7             POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * Varukod
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDEQ     7
     C                   EVAL      UKD=WZVEV_VATA
     C     UKD           IFEQ      *BLANKS
     C                   EVAL      UKD='0000000000'
     C                   ENDIF
     C                   CALL      'SVT004R'
     C                   PARM                    UKD              10
     C                   PARM      WDT           UDATO             8
     C                   PARM      'E'           UIE               1
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_VATA
     C                   ENDIF
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * Tillæggskod
     C     LINNBR        IFEQ      25
     C     POSNBR        ANDEQ     99
     C                   CALL      'SVT003R'
     C                   PARM      'ADD'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_VATI
     C                   ENDIF
     C                   Z-ADD     99            POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * Førfarande 37:1
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDEQ     16
     C                   CALL      'SVT006R'
     C                   PARM      'E'           UIE               1
     C                   PARM                    UKD2              4
     C     UKD2          IFNE      *BLANKS
     C                   MOVEL     UKD2          ZVEV_EUP1
     C                   ENDIF
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * Førfarande 37:2
     C     LINNBR        IFEQ      25
     C     POSNBR        ANDEQ     117
     C                   CALL      'SVT003R'
     C                   PARM      'FFK'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_EUP2
     C                   ENDIF
     C                   Z-ADD     117           POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * R.31 Kollislag
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDEQ     15
     C                   CALL      'SVT003R'
     C                   PARM      'KLI'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_KOSL
     C                   ENDIF
     C                   Z-ADD     23            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * R.44 Særskilda upplysningar kod
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDEQ     9
     C                   CALL      'SVT003R'
     C                   PARM      'SAL'         UTYP              3
     C                   PARM      'E'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_SUKO
     C                   ENDIF
     C                   Z-ADD     24            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SRC1
     C                   ENDIF
      * Bilagda handlingar
     C     LINNBR        IFEQ      25
     C     POSNBR        ANDEQ     9
     C                   CALL      'SVT003R'
     C                   PARM      'MCF'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   MOVEL     UKD           ZVEV_BIT1
     C                   ENDIF
     C                   Z-ADD     25            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SRC1
     C                   ENDIF

     C     SRC1          ENDSR
      *////////////////////////////////////////////////////////////
      *  Summera varulinjebelopp                             SRBS /
      *////////////////////////////////////////////////////////////
     C     SRBS          BEGSR
      *______________
      * Hæmta ærendet
      *""""""""""""""
     C     KEYA1         CHAIN     SVEH                               51
      * Rækna ut totalt CIF værde
     C                   EXSR      SRCIFTOT
      *___________________
      * Summera varulinjer
      *"""""""""""""""""""
     C                   EVAL      WVEH_FABL=0
     C                   EVAL      XVEH_FABL=0
     C                   EVAL      WVEH_BRUT=0
     C                   EVAL      XVEH_BRUT=0
     C                   EVAL      WVEH_KOTA=0
     C                   EVAL      XVEH_KOTA=0
     C                   EVAL      *IN94=*OFF

     C     KEYA1         SETLL     SVEV1
     C     KEYA1         READE     SVEV1                                  94
     C     *IN94         DOWEQ     '0'
     C                   ADD       SVEV_FABL     WVEH_FABL
     C                   ADD       SVEV_BRUT     WVEH_BRUT
     C                   ADD       SVEV_KOTA     WVEH_KOTA
     C     KEYA1         READE     SVEV1                                  94
     C  N94              ENDDO

     C                   EVAL      *IN94=*OFF
      *___________________________________________________
      * Differans mellan fakturabelopp och varulinjebelopp
      *"""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   EVAL      XVEH_FABL=SVEH_FABL - WVEH_FABL
     C                   EVAL      XVEH_BRUT=SVEH_BRUT - WVEH_BRUT
     C                   EVAL      XVEH_KOTA=SVEH_KOTA - WVEH_KOTA
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Automatisk avgiftsberækning                        SRBAA /
      *////////////////////////////////////////////////////////////
     C     SRBAA         BEGSR
      * Starta med Statistiskt værde
     C                   EXSR      SRCIFDET
      * Tull
     C                   EXSR      SRBAAA
      * Andra tullar, skatter och avgifter
     C                   EXSR      SRBAAB
      * Merværdesskatt  Vænta tills vidare, export har normalt inga avgifter.
     C*                  EXSR      SRBAAC
      * Marker avgifter
     C*                  EVAL      ZVEV_AVGB='X'
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Automatisk avgiftsberækning, Tull                 SRBAAA /
      *////////////////////////////////////////////////////////////
     C     SRBAAA        BEGSR
      *_____________________________________
      * Læs tulltariffen och lægg in i array
      *"""""""""""""""""""""""""""""""""""""
      * Blanka array
     C                   EVAL      WTN=0
     C                   MOVEA     *BLANKS       WT
     C     1             DO        9             WTN
     C                   MOVE      *BLANKS       WVTA
     C                   EVAL      WVTA_X='X'
     C                   MOVE      WVTA          WT(WTN)
     C                   ENDDO

     C                   EVAL      WTN=0
     C     SVTAKEY       SETLL     SVTAR1
     C     SVTAKEY       READE     SVTAR1                                 55
     C     *IN55         DOWEQ     *OFF
      * Stæmmer MEAS_TYP_ID ?     (Feil test ?)
     C     SVTA_MTI      COMP      '103'                                  56
     C  N56SVTA_MTI      COMP      '142'                                  56
     C  N56              GOTO      SRBAAA2
      * Er landkoden riktig ?
     C     SVTA_RG       CABEQ     ZVEV_ULKD     SRBAAA1
      * Eller stæmmer regionen ?
     C                   MOVEL     ZVEV_ULKD     ZVEV_ULKD4
     C     SVTLKKEY      CHAIN     SVTX08F2                           56
     C     *IN56         CABEQ     *OFF          SRBAAA1
     C                   GOTO      SRBAAA2
     C     SRBAAA1       TAG
      * Datum, Land eller region stæmmer, flytta in i array
     C                   EVAL      WVTA_X=' '
     C                   EVAL      WVTA_SAT=SVTA_SAT
     C                   EVAL      WVTA_FTI=SVTA_FTI
     C                   EVAL      WVTA_MTI=SVTA_MTI
     C                   EVAL      WVTA_MUC=SVTA_MUC
     C                   ADD       1             WTN
     C                   MOVE      WVTA          WT(WTN)
     C     SRBAAA2       TAG
     C     SVTAKEY       READE     SVTAR1                                 55
     C                   ENDDO
      * Sortera array
     C                   SORTA     WT
      * Læs array och skriv till avgiftsfil
     C                   EVAL      WTN=0
     C     1             DO        9             WTN
     C                   MOVEA     WT(WTN)       WVTA
     C                   IF        WVTA_X=' '
     C                   IF        WVTA_FTI=*BLANKS

     C                   CLEAR                   SVEVAR
     C                   EVAL      SVEVA_SAV=ZVEV_SYAV
     C                   EVAL      SVEVA_SOP=ZVEV_SYOP
     C                   EVAL      SVEVA_SLI=SVEV_SYLI
     C                   EVAL      SVEVA_ABK='A00'
     C                   EVAL      SVEVA_ABS=WVTA_SAT
     C                   EVAL      SVEVA_ABX=WVTA_MUC
      * ASV         VOLYMPROCENT
      * BSV         11 PROCENT AV BESKATTNINGSVäRDET
      * CCT         LASTFöRMÅGA I TON
      * CEN         100 STYCKEN
      * CTM         ANTAL KARAT (1 METRISK KARAT = 2 X 10-4 KG)
      * DHS         KILOGRAM DIHYDROSTREPTOMYCIN
      * DTN         100 KILOGRAM
      * FUB         FAST M$3 UNDER BARK
      * FUB         FAST M3 UNDER BARK
      * GFI         GRAM KLYVBARA ISOTOPER
      * GRM         GRAM
      * GRT         BRUTTODRäKTIGHET
      * HLT         100 LITER
      * HMT         100 METER
      * KCC         KILOGRAM KOLINKLORID
      * KCL         TON KALIUMKLORID
      * KGM         KILOGRAM
      * KLT         1000 LITER
      * KMA         KILOGRAM METYLAMINER
      * KNI         KILOGRAM KVäVE
      * KNS         KILOGRAM VäTEPEROXID
      * KPH         KILOGRAM KALIUMHYDROXID (KAUSTIKT KALI)
      * KPO         KILOGRAM KALIUMOXID
      * KPP         KILOGRAM FOSFORPENTAOXID
      * KSD         KILOGRAM 90 % TORRVIKT
      * KSH         KILOGRAM NATRIUMHYDROXID (KAUSTIK SODA)
      * KUR         KILOGRAM URAN
      * LPA         LITER REN (100 %) ALKOHOL
      * LTR         LITER
      * LVO         PER LITER FöR VARJE VOL-% ALKOHOL
      * MIL         1000 STYCKEN
      * MTK         KVADRATMETER
      * MTQ         KUBIKMETER
      * MTR         METER
      * MWH         1000 KILOWATTIMMAR
      * NAR         STYCK
      * NCL         ANTAL CELLER
      * NPR         ANTAL PAR
      * PSA         PER SäNDNING
      * PTK         FöR VARJE PÅBORJAT 100-TAL KG
      * SVK         PER KG SVAVEL I BRäNSLET
      * SVP         FöR VARJE TIONDELS VIKT-% SVAVEL I BRäNSLET (M$3)
      * TJO         TERAJOULE (TOTAL VäRMEENERGI)
      * TNE         TON NETTO
     C                   SELECT
     C     WVTA_MUC      WHENEQ    '   '
     C                   EVAL      SVEVA_ABG=ZVEV_STVA2
     C                   EVAL      SVEVA_ABB=(ZVEV_STVA2 * WVTA_SAT) / 100
     C                   OTHER
     C                   EVAL      SVEVA_ABG=ZVEV_ANKV
     C                   EVAL      SVEVA_ABB=ZVEV_ANKV * WVTA_SAT
     C                   ENDSL
     C                   IF        SVEVA_ABB > 0
     C                   WRITE     SVEVAR
     C                   ENDIF
     C                   LEAVE
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * Andra tullar, skatter och avgifter                 SRBAAB /
      *////////////////////////////////////////////////////////////
     C     SRBAAB        BEGSR
      *___________________________________
      * Læs avgiftsfil och lægg in i array
      *"""""""""""""""""""""""""""""""""""
      * Blanka array
     C                   EVAL      WTN=0
     C                   MOVEA     *BLANKS       WT
     C     1             DO        9             WTN
     C                   MOVE      *BLANKS       WVTA
     C                   EVAL      WVTA_X='X'
     C                   MOVE      WVTA          WT(WTN)
     C                   ENDDO

     C                   EVAL      WTN=0
     C     WZVEV_VATA    SETLL     SVTAV
     C     WZVEV_VATA    READE     SVTAV                                  55
     C     *IN55         DOWEQ     *OFF
      * Er landkoden riktig ?
     C     SVAV_REGI     CABEQ     ZVEV_ULKD     SRBAAB1
      * Eller stæmmer regionen ?
     C                   MOVEL     ZVEV_ULKD     ZVEV_ULKD4
     C     SVTLKKEY2     CHAIN     SVTX08F2                           56
     C     *IN56         CABEQ     *OFF          SRBAAB1
     C                   GOTO      SRBAAB2
     C     SRBAAB1       TAG
      * Land eller region stæmmer, flytta in i array
     C                   EVAL      WVTA_X=' '
     C                   EVAL      WVTA_SAT=SVAV_SAT
     C                   EVAL      WVTA_MTI=SVAV_KD
     C                   EVAL      WVTA_MUC=SVAV_ENH
     C                   ADD       1             WTN
     C                   MOVE      WVTA          WT(WTN)
     C     SRBAAB2       TAG
     C     WZVEV_VATA    READE     SVTAV                                  55
     C                   ENDDO
      * Sortera array
     C                   SORTA     WT
      * Læs array och skriv till avgiftsfil
     C                   EVAL      WTN=0
     C     1             DO        9             WTN
     C                   MOVEA     WT(WTN)       WVTA
     C                   IF        WVTA_X=' '

     C                   CLEAR                   SVEVAR
     C                   EVAL      SVEVA_SAV=ZVEV_SYAV
     C                   EVAL      SVEVA_SOP=ZVEV_SYOP
     C                   EVAL      SVEVA_SLI=SVEV_SYLI
     C                   EVAL      SVEVA_ABK=WVTA_MTI
     C                   EVAL      SVEVA_ABS=WVTA_SAT
     C                   EVAL      SVEVA_ABX=UVTA_MUC
     C                   SELECT
     C     WVTA_MUC      WHENEQ    '   '
     C                   EVAL      SVEVA_ABG=ZVEV_STVA2
     C                   EVAL      SVEVA_ABB=(ZVEV_STVA2 * WVTA_SAT) / 100
     C                   OTHER
     C                   EVAL      SVEVA_ABG=ZVEV_ANKV
     C                   EVAL      SVEVA_ABB=ZVEV_ANKV * WVTA_SAT
     C                   ENDSL
     C                   IF        SVEVA_ABB > 0
     C                   WRITE     SVEVAR
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Merværdesskatt                                    SRBAAC /
      *////////////////////////////////////////////////////////////
     C     SRBAAC        BEGSR
      *______________________________
      * Læs avgiftslinjer och summera
      *""""""""""""""""""""""""""""""
      * Blanka resultat
     C                   EVAL      WVEVA_ABB=0
      * Læs och summera
     C     KEYA          SETLL     SVEVA
     C     KEYA          READE(N)  SVEVA                                  55
     C     *IN55         DOWEQ     *OFF
     C                   ADD       SVEVA_ABB     WVEVA_ABB
     C     KEYA          READE     SVEVA                                  55
     C                   ENDDO
     C                   ADD       ZVEV_STVA2    WVEVA_ABB
      * Addera momspost
     C                   CLEAR                   SVEVAR
     C                   EVAL      SVEVA_SAV=ZVEV_SYAV
     C                   EVAL      SVEVA_SOP=ZVEV_SYOP
     C                   EVAL      SVEVA_SLI=SVEV_SYLI
     C                   EVAL      SVEVA_ABK='B00'
     C                   EVAL      SVEVA_ABS=25
     C                   EVAL      SVEVA_ABG=WVEVA_ABB
     C                   EVAL      SVEVA_ABB= WVEVA_ABB * 0,25
     C                   WRITE     SVEVAR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontrollera input på linje                        SRBTST /
      *////////////////////////////////////////////////////////////
     C     SRBTST        BEGSR
      * Landkod
     C                   MOVEL     ZVEV_ULKD     ZVEV_ULKD4
     C     ZVEV_ULKD4    CHAIN     SVTX08F2                           31
     C                   IF        *IN31
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVE0009'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     4             POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
      * TARIC nummer
     C     WZVEV_VATA    CHAIN     SVTX04F                            32
     C                   IF        *IN32
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVE0020'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     7             POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
      * Tillæggskod
     C     ZVEV_VATI     IFNE      *BLANKS
     C                   EVAL      ZVKD_IE='A'
     C                   EVAL      ZVKD_TYP='ADD'
     C                   EVAL      ZVKD_KD=ZVEV_VATI
     C                   ENDIF
      * EU Procedurkod
     C     SVTPROKEY     CHAIN     SVTPRO                             35
     C                   IF        *IN35
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVE0023'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
      * X mängdenhet kräves ?
     C                   EVAL      UVTA_MUC=*BLANKS
     C                   CALL      'SVT010R'
     C                   PARM                    ZVTA_IE
     C                   PARM                    WZVEV_VATA
S04  C*                  PARM                    ZVEV_ULKD
N04  C                   PARM                    SVEH_MOLK
     C                   PARM                    UVTA_MUC
     C     ZVEV_ANKV     IFLE      *ZEROS
     C     UVTA_MUC      ANDNE     *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN38=*ON
     C                   MOVE      'SVE0041'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
      * Nettovikt
     C                   IF        ZVEV_NETO=0
     C     ZVEV_BRUT     MULT      0.9           ZVEV_NETO
N09  C     ZVEV_NETO     IFGE      1
N09  C                   EVAL      WVIKT=ZVEV_NETO
N09  C                   EVAL      ZVEV_NETO=WVIKTHEL
N09  C                   ENDIF
     C                   ENDIF
     C                   EVAL      *IN37=*OFF
     C                   IF        ZVEV_NETO=0
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN37=*ON
     C                   MOVE      'SVE0043'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     37            POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
      * Nettovikt større æn bruttovikt inte tillåtet
     C                   IF        ZVEV_NETO > ZVEV_BRUT
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVE0051'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     37            POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
N09   * Nettovikt, Inga decimaler på vikter lik eller øver 1 Kg
N09  C     ZVEV_NETO     IFGE      1
N09  C                   EVAL      WVIKT=ZVEV_NETO
N09  C                   IF        WVIKTDEC > *ZEROS
N09  C                   EVAL      *IN30=*ON
N09  C                   EVAL      *IN37=*ON
N09  C                   MOVE      'SVI0052'     ZMSGNO
N09  C                   Z-ADD     22            LINNBR
N09  C                   Z-ADD     37            POSNBR
N09  C                   GOTO      SRBTST9
N09  C                   ENDIF
N09  C                   ENDIF
N09   * Bruttovikt, Inga decimaler på vikter lik eller øver 1 Kg
N09  C     ZVEV_BRUT     IFGE      1
N09  C                   EVAL      WVIKT=ZVEV_BRUT
N09  C                   IF        WVIKTDEC > *ZEROS
N09  C                   EVAL      *IN30=*ON
N09  C                   EVAL      *IN36=*ON
N09  C                   MOVE      'SVI0052'     ZMSGNO
N09  C                   Z-ADD     22            LINNBR
N09  C                   Z-ADD     21            POSNBR
N09  C                   GOTO      SRBTST9
N09  C                   ENDIF
N09  C                   ENDIF
N07   * Kollital
N07  C*    XVEH_KOTA     IFLE      SVEH_KOTA
N07  C     XVEH_KOTA     IFGT      *ZEROS
N07  C     ZVEV_KOTA     ANDLE     *ZEROS
N07  C                   EVAL      *IN30=*ON
N07  C                   MOVE      'SVI0012'     ZMSGNO
N07  C                   Z-ADD     23            LINNBR
N07  C                   Z-ADD     9             POSNBR
N07  C                   GOTO      SRBTST9
N07  C                   ENDIF
      * Kollislag
     C     ZVEV_KOSL     IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVI0029'     ZMSGNO
     C                   Z-ADD     23            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
      * Godsmærkning
     C     ZVEV_GODM     IFEQ      *BLANKS
     C     ZVEV_KOSL     COMP      'VR'                                   20
     C  N20ZVEV_KOSL     COMP      'VY'                                   20
     C  N20ZVEV_KOSL     COMP      'VO'                                   20
     C  N20ZVEV_KOSL     COMP      'VL'                                   20
     C  N20ZVEV_KOSL     COMP      'VG'                                   20
     C  N20ZVEV_KOSL     COMP      'VQ'                                   20
     C  N20ZVEV_KOSL     COMP      'NE'                                   20
     C  N20ZVEV_KOSL     COMP      'NF'                                   20
     C  N20ZVEV_KOSL     COMP      'NG'                                   20
     C                   IF        *IN20=*OFF
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVI0027'     ZMSGNO
     C                   Z-ADD     23            LINNBR
     C                   Z-ADD     91            POSNBR
     C                   GOTO      SRBTST9
     C                   ENDIF
     C                   ENDIF
      * Belopp
     C                   IF        XVEH_FABL > 0
     C                   IF        ZVEV_FABL=0
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN44=*ON
     C                   MOVE      'SVE0040'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     64            POSNBR
     C                   ENDIF
     C                   ENDIF
      * Call me
     C     SVEH_MTYP     IFNE      'UNU'
     C     ZVEV_CALL     COMP      '00'                                   20
     C  N20ZVEV_CALL     COMP      '01'                                   20
     C  N20ZVEV_CALL     COMP      '10'                                   20
     C  N20ZVEV_CALL     COMP      '11'                                   20
     C  N20ZVEV_CALL     COMP      '12'                                   20
     C  N20ZVEV_CALL     COMP      '13'                                   20
     C     *IN20         IFEQ      *OFF
     C                   EVAL      *IN30=*ON
     C                   MOVE      'SVE0032'     ZMSGNO
     C                   EVAL      LINNBR=22
     C                   EVAL      POSNBR=101
     C                   GOTO      SRBTST9
     C                   ENDIF
     C                   ENDIF

     C     SRBTST9       TAG

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Berækna CIF totalt                              SRCIFTOT /
      *////////////////////////////////////////////////////////////
     C     SRCIFTOT      BEGSR
      *__________________________________
      * Summera alla kostnader och avdrag
      *""""""""""""""""""""""""""""""""""
      * Fakturabelopp i Svenska kronor
     C     SVEH_FABL     MULT      SVEH_VAKU     ZVEH_FABL
     C                   EVAL      ZVVK_KD=SVEH_VAKD
     C                   EVAL      ZVVK_DTS=99999999
     C     SVTVKKEY      SETGT     SVTVK
     C                   READP     SVTVK                                  64
SH   C                   DOW       *IN64 = *OFF
SH   c                   IF        SVEH_TAXD >= SVVK_DTS
SH   C                   LEAVE
SH   C                   END
SH   C                   READP     SVTVK                                  64
SH   c                   ENDDO
     C                   IF        SVVK_OMR > *ZEROS
     C     ZVEH_FABL     DIV       SVVK_OMR      ZVEH_FABL
     C                   ENDIF
     C                   EVAL      ZCIFTOT=ZVEH_FABL
     C                   EVAL      ZCIFTOT2=ZVEH_FABL
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Berækna CIF før varupost                        SRCIFDET /
      *////////////////////////////////////////////////////////////
     C     SRCIFDET      BEGSR
     C                   IF        SVEH_FABL = ZCIFTOT
     C                   IF        ZVEV_STVA= *ZEROS
     C                   EVAL      ZVEV_STVA = ZVEV_FABL
     C                   ENDIF
     C                   IF        ZVEV_STVA2= *ZEROS
     C                   EVAL      ZVEV_STVA2 = ZVEV_FABL
     C                   ENDIF
     C                   ELSE
     C     ZVEV_FABL     DIV       SVEH_FABL     ZFAKTOR          18 8
     C                   IF        ZVEV_STVA = *ZEROS
     C     ZCIFTOT       MULT      ZFAKTOR       ZVEV_STVA
     C                   ENDIF
     C                   IF        ZVEV_STVA2= *ZEROS
     C     ZCIFTOT2      MULT      ZFAKTOR       ZVEV_STVA2
     C                   ENDIF
     C                   ENDIF
     C                   IF        ZVEV_STVA=0
     C                   EVAL      ZVEV_STVA = ZVEV_FABL
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mer rubrik 31                                        SRI /
      *////////////////////////////////////////////////////////////
     C     SRI           BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   EVAL      ZVEV_KOT1=ZVEV_KOTA
     C                   EVAL      ZVEV_KOS1=ZVEV_KOSL
     C                   EVAL      ZVEV_VAS1=ZVEV_VASL

     C     SRI1          TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DI
     C                   EVAL      *IN30 = *OFF
     C     *IN12         IFEQ      '0'
      *_______
      * F4=Søk
      *"""""""
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     *IN04         IFEQ      '1'
     C     LINNBR        IFGE      5
     C     LINNBR        ANDLE     9
     C     POSNBR        ANDEQ     11
     C                   CALL      'SVT003R'
     C                   PARM      'KLI'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   SELECT
     C     LINNBR        WHENEQ    5
     C                   MOVEL     UKD           ZVEV_KOS1
     C     LINNBR        WHENEQ    6
     C                   MOVEL     UKD           ZVEV_KOS2
     C     LINNBR        WHENEQ    7
     C                   MOVEL     UKD           ZVEV_KOS3
     C     LINNBR        WHENEQ    8
     C                   MOVEL     UKD           ZVEV_KOS4
     C     LINNBR        WHENEQ    9
     C                   MOVEL     UKD           ZVEV_KOS5
     C                   ENDSL
     C                   ENDIF
     C                   GOTO      SRI1
     C                   ENDIF
     C                   ENDIF
      *____________
      * Teste input
      *""""""""""""
     C*  30              GOTO      SRI1
      *________________________
      * Oppdatere felles felter
      *""""""""""""""""""""""""
     C                   EVAL      ZVEV_KOTA=ZVEV_KOT1
     C                   EVAL      ZVEV_KOSL=ZVEV_KOS1
     C                   EVAL      ZVEV_VASL=ZVEV_VAS1

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mer Særskilda upplysningar                           SRJ /
      *////////////////////////////////////////////////////////////
     C     SRJ           BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   EVAL      ZVEV_SUK1=ZVEV_SUKO
     C                   EVAL      ZVEV_SUT1=ZVEV_SUTX

     C     SRJ1          TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DJ
     C                   EVAL      *IN30 = *OFF
     C     *IN12         IFEQ      '0'
      *_______
      * F4=Søk
      *"""""""
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     *IN04         IFEQ      '1'
     C     LINNBR        IFGE      5
     C     LINNBR        ANDLE     15
     C     POSNBR        ANDEQ     2
     C                   CALL      'SVT003R'
     C                   PARM      'SAL'         UTYP              3
     C                   PARM      'E'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   SELECT
     C     LINNBR        WHENEQ    5
     C                   MOVEL     UKD           ZVEV_SUK1
     C     LINNBR        WHENEQ    10
     C                   MOVEL     UKD           ZVEV_SUK6
     C     LINNBR        WHENEQ    15
     C                   MOVEL     UKD           ZVEV_SUKB
     C                   ENDSL
     C                   ENDIF
     C                   GOTO      SRJ1
     C                   ENDIF
     C                   ENDIF
      *____________
      * Teste input
      *""""""""""""
     C*  30              GOTO      SRJ1
      *________________________
      * Oppdatere felles felter
      *""""""""""""""""""""""""
     C                   EVAL      ZVEV_SUKO=ZVEV_SUK1
     C                   EVAL      ZVEV_SUTX=ZVEV_SUT1

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mer Bilagda Handlingar                               SRK /
      *////////////////////////////////////////////////////////////
     C     SRK           BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR

     C     SRK1          TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DK
     C                   EVAL      *IN30 = *OFF
     C     *IN12         IFEQ      '0'
      *_______
      * F4=Søk
      *"""""""
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     *IN04         IFEQ      '1'
     C     LINNBR        IFGE      5
     C     LINNBR        ANDLE     13
     C     POSNBR        ANDEQ     2
     C                   CALL      'SVT003R'
     C                   PARM      'MCF'         UTYP              3
     C                   PARM      'A'           UIE               1
     C                   PARM      WDT           UDATO             8
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   SELECT
     C     LINNBR        WHENEQ    5
     C                   MOVEL     UKD           ZVEV_BIT1
     C     LINNBR        WHENEQ    6
     C                   MOVEL     UKD           ZVEV_BIT2
     C     LINNBR        WHENEQ    7
     C                   MOVEL     UKD           ZVEV_BIT3
     C     LINNBR        WHENEQ    8
     C                   MOVEL     UKD           ZVEV_BIT4
     C     LINNBR        WHENEQ    9
     C                   MOVEL     UKD           ZVEV_BIT5
     C     LINNBR        WHENEQ    10
     C                   MOVEL     UKD           ZVEV_BIT6
     C     LINNBR        WHENEQ    11
     C                   MOVEL     UKD           ZVEV_BIT7
     C     LINNBR        WHENEQ    12
     C                   MOVEL     UKD           ZVEV_BIT8
     C     LINNBR        WHENEQ    13
     C                   MOVEL     UKD           ZVEV_BIT9
     C                   ENDSL
     C                   ENDIF
     C                   GOTO      SRK1
     C                   ENDIF
     C                   ENDIF
      *____________
      * Teste input
      *""""""""""""
     C*  30              GOTO      SRK1

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Containernummer                                      SRL /
      *////////////////////////////////////////////////////////////
     C     SRL           BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR

     C     SRL1          TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DL
     C                   EVAL      *IN30 = *OFF
     C     *IN12         IFEQ      '0'
      *____________
      * Teste input
      *""""""""""""
     C*  30              GOTO      SRL1

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tidigare Handlingar                                  SRM /
      *////////////////////////////////////////////////////////////
     C     SRM           BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR

     C     SRM1          TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DM
     C                   EVAL      *IN30 = *OFF
     C     *IN12         IFEQ      '0'
      *____________
      * Teste input
      *""""""""""""
     C*  30              GOTO      SRM1

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Identifiering av lager                               SRN /
      *////////////////////////////////////////////////////////////
     C     SRN           BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR

     C     SRN1          TAG

     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVE003DØ
     C                   EXFMT     SVE003DN
     C                   EVAL      *IN30 = *OFF
     C     *IN12         IFEQ      '0'
      *____________
      * Teste input
      *""""""""""""
     C*  30              GOTO      SRN1

     C                   ENDIF

     C                   ENDSR
N02   *////////////////////////////////////////////////////////////
N02   *  Automatisk viktberækning                        SRAUTOVK /
N02   *////////////////////////////////////////////////////////////
N02  C     SRAUTOVK      BEGSR
N02  C     SVEH_FABL     IFGT      *ZEROS
N02  C     SVEH_BRUT     ANDGT     *ZEROS
N02
N02  C     ZVEV_FABL     DIV(H)    SVEH_FABL     ZFAKTOR          18 8
N02  C     ZFAKTOR       MULT(H)   SVEH_BRUT     ZVEV_BRUT              4848
N02  C   48              EVAL      ZVEV_BRUT=1
N02  C     ZVEV_BRUT     MULT      0.9           ZVEV_NETO
N09  C     ZVEV_BRUT     IFGE      1
N09  C                   EVAL      WVIKT=ZVEV_BRUT
N09  C                   EVAL      ZVEV_BRUT=WVIKTHEL
N09  C                   ENDIF
N09  C     ZVEV_NETO     IFGE      1
N09  C                   EVAL      WVIKT=ZVEV_NETO
N09  C                   EVAL      ZVEV_NETO=WVIKTHEL
N09  C                   ENDIF
N02
N02  C                   ENDIF
N02  C                   ENDSR
N10   *////////////////////////////////////////////////////////////
N10   *  Hæmta Y-koder och tillæggskoder                 SRGETKOD /
N10   *////////////////////////////////////////////////////////////
N10  C     SRGETKOD      BEGSR
N10   * Hæmta och skriv Y-koder automatiskt
N10  C                   IF        %SUBST(ZVEV_BIT2:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT3:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT4:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT5:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT6:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT7:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT8:1:1) <> 'Y' AND
N10  C                             %SUBST(ZVEV_BIT9:1:1) <> 'Y'
N10
N10  C                   CALL      'SVT013R'
N10  C                   PARM      'E'           UVIV_IE           1
N10  C                   PARM      ZVEV_VATA     UVTA_VATA
N10  C                   PARM                    SVEH_AUBE
N10  C                   PARM                    UFOKD             3
N10  C                   PARM      *BLANKS       UYKOD1            4
N10  C                   PARM      *BLANKS       UYKOD2            4
N10  C                   PARM      *BLANKS       UYKOD3            4
N10  C                   PARM      *BLANKS       UYKOD4            4
N10  C                   PARM      *BLANKS       UYKOD5            4
N10  C                   PARM      *BLANKS       UYKOD6            4
N10  C                   PARM      *BLANKS       UYKOD7            4
N10  C                   PARM      *BLANKS       UYKOD8            4
N10  C                   PARM      *BLANKS       UYKOD9            4
N10  C                   SELECT
N10  C     ZVEV_BIT1     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT1=UYKOD1
N10  C                   EVAL      ZVEV_BIT2=UYKOD2
N10  C                   EVAL      ZVEV_BIT3=UYKOD3
N10  C                   EVAL      ZVEV_BIT4=UYKOD4
N10  C                   EVAL      ZVEV_BIT5=UYKOD5
N10  C                   EVAL      ZVEV_BIT6=UYKOD6
N10  C                   EVAL      ZVEV_BIT7=UYKOD7
N10  C                   EVAL      ZVEV_BIT8=UYKOD8
N10  C                   EVAL      ZVEV_BIT9=UYKOD9
N10  C     ZVEV_BIT2     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT2=UYKOD1
N10  C                   EVAL      ZVEV_BIT3=UYKOD2
N10  C                   EVAL      ZVEV_BIT4=UYKOD3
N10  C                   EVAL      ZVEV_BIT5=UYKOD4
N10  C                   EVAL      ZVEV_BIT6=UYKOD5
N10  C                   EVAL      ZVEV_BIT7=UYKOD6
N10  C                   EVAL      ZVEV_BIT8=UYKOD7
N10  C                   EVAL      ZVEV_BIT9=UYKOD8
N10  C     ZVEV_BIT3     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT3=UYKOD1
N10  C                   EVAL      ZVEV_BIT4=UYKOD2
N10  C                   EVAL      ZVEV_BIT5=UYKOD3
N10  C                   EVAL      ZVEV_BIT6=UYKOD4
N10  C                   EVAL      ZVEV_BIT7=UYKOD5
N10  C                   EVAL      ZVEV_BIT8=UYKOD6
N10  C                   EVAL      ZVEV_BIT9=UYKOD7
N10  C     ZVEV_BIT4     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT4=UYKOD1
N10  C                   EVAL      ZVEV_BIT5=UYKOD2
N10  C                   EVAL      ZVEV_BIT6=UYKOD3
N10  C                   EVAL      ZVEV_BIT7=UYKOD4
N10  C                   EVAL      ZVEV_BIT8=UYKOD5
N10  C                   EVAL      ZVEV_BIT9=UYKOD6
N10  C     ZVEV_BIT5     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT5=UYKOD1
N10  C                   EVAL      ZVEV_BIT6=UYKOD2
N10  C                   EVAL      ZVEV_BIT7=UYKOD3
N10  C                   EVAL      ZVEV_BIT8=UYKOD4
N10  C                   EVAL      ZVEV_BIT9=UYKOD5
N10  C     ZVEV_BIT6     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT6=UYKOD1
N10  C                   EVAL      ZVEV_BIT7=UYKOD2
N10  C                   EVAL      ZVEV_BIT8=UYKOD3
N10  C                   EVAL      ZVEV_BIT9=UYKOD4
N10  C     ZVEV_BIT7     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT7=UYKOD1
N10  C                   EVAL      ZVEV_BIT8=UYKOD2
N10  C                   EVAL      ZVEV_BIT9=UYKOD3
N10  C     ZVEV_BIT8     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT8=UYKOD1
N10  C                   EVAL      ZVEV_BIT9=UYKOD2
N10  C     ZVEV_BIT9     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_BIT9=UYKOD1
N10  C                   ENDSL
N10
N10  C                   ENDIF
N10
N10   * Hæmta och skriv tillæggskoder automatiskt
N10  C                   IF        ZVEV_VATI=*BLANKS AND
N10  C                             ZVEV_VAT4=*BLANKS AND
N10  C                             ZVEV_VAT5=*BLANKS
N10
N10  C                   CALL      'SVT015R'
N10  C                   PARM      'E'           UVIV_IE           1
N10  C                   PARM      ZVEV_VATA     UVTA_VATA
N10  C                   PARM                    SVEH_AUBE
N10  C                   PARM      *BLANKS       UTKOD1            4
N10  C                   PARM      *BLANKS       UTKOD2            4
N10  C                   PARM      *BLANKS       UTKOD3            4
N10  C                   PARM      *BLANKS       UTKOD4            4
N10  C                   PARM      *BLANKS       UTKOD5            4
N10  C                   PARM      *BLANKS       UTKOD6            4
N10  C                   PARM      *BLANKS       UTKOD7            4
N10  C                   PARM      *BLANKS       UTKOD8            4
N10  C                   PARM      *BLANKS       UTKOD9            4
N10  C                   SELECT
N10  C     ZVEV_VATI     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_VATI=UTKOD1
N10  C                   EVAL      ZVEV_VAT4=UTKOD2
N10  C                   EVAL      ZVEV_VAT5=UTKOD3
N10  C     ZVEV_VAT4     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_VAT4=UTKOD1
N10  C                   EVAL      ZVEV_VAT5=UTKOD2
N10  C     ZVEV_VAT5     WHENEQ    *BLANKS
N10  C                   EVAL      ZVEV_VAT5=UTKOD1
N10
N10  C                   ENDSL
N10
N10  C                   ENDIF
N10  C                   ENDSR
N11   *////////////////////////////////////////////////////////////
N11   *  Hæmta Bilagda handlingar från header            SRGETBIL /
N11   *////////////////////////////////////////////////////////////
N11  C     SRGETBIL      BEGSR
N11  C                   EVAL      *IN54=*OFF
N11  C     KEYA1         SETLL     SVEF
N11  C     KEYA1         READE     SVEF                                   54
N11  C     *IN54         DOWEQ     *OFF
N11  C                   SELECT
N11  C     ZVEV_BIT1     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT1=SVEF_FATY
N11  C                   EVAL      ZVEV_BII1=SVEF_FATX
N11  C     ZVEV_BIT2     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT2=SVEF_FATY
N11  C                   EVAL      ZVEV_BII2=SVEF_FATX
N11  C     ZVEV_BIT3     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT3=SVEF_FATY
N11  C                   EVAL      ZVEV_BII3=SVEF_FATX
N11  C     ZVEV_BIT4     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT4=SVEF_FATY
N11  C                   EVAL      ZVEV_BII4=SVEF_FATX
N11  C     ZVEV_BIT5     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT5=SVEF_FATY
N11  C                   EVAL      ZVEV_BII5=SVEF_FATX
N11  C     ZVEV_BIT6     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT6=SVEF_FATY
N11  C                   EVAL      ZVEV_BII6=SVEF_FATX
N11  C     ZVEV_BIT7     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT7=SVEF_FATY
N11  C                   EVAL      ZVEV_BII7=SVEF_FATX
N11  C     ZVEV_BIT8     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT8=SVEF_FATY
N11  C                   EVAL      ZVEV_BII8=SVEF_FATX
N11  C     ZVEV_BIT9     WHENEQ    *BLANKS
N11  C                   EVAL      ZVEV_BIT9=SVEF_FATY
N11  C                   EVAL      ZVEV_BII9=SVEF_FATX
N11  C                   ENDSL
N11  C     KEYA1         READE     SVEF                                   54
N11  C                   ENDDO
N11  C                   ENDSR
N13   *////////////////////////////////////////////////////////////
N13   *  Lægg till i kunders varuregister                    SRBK /
N13   *////////////////////////////////////////////////////////////
N13  C     SRBK          BEGSR
N13  C                   CALL      'SVE037R'
N13  C                   PARM                    ZVEV_SYAV
N13  C                   PARM                    ZVEV_SYOP
N13  C                   PARM                    SVEV_SYLI
N13   *_________________
N13   * Oppdatere SUBFIL
N13   *"""""""""""""""""
N13  C                   CLEAR                   SVE003DA
N13  C                   UPDATE    SVE003DA
N13  C                   EVAL      *IN95=*ON
N13  C                   ENDSR
N13   *////////////////////////////////////////////////////////////
N13   *  Søk i kunders varuposter                        SRKUNSOK /
N13   *////////////////////////////////////////////////////////////
N13  C     SRKUNSOK      BEGSR
N13  C                   EVAL      UVEW_KNSO=*BLANKS
N13  C                   CALL      'SVE036R'
N13  C                   PARM                    SVEH_AVKN
N13  C                   PARM                    UVEW_KNSO
N13  C     UVEW_KNSO     IFNE      *BLANKS
N13  C     SVEWKEY       CHAIN     SVEW                               57
N13  C     *IN57         IFEQ      *OFF
N13
N13  C                   EVAL      ZVEV_KOSL=SVEW_KOSL
N13  C                   EVAL      ZVEV_VASL=SVEW_VASL
N13  C                   EVAL      ZVEV_GODM=SVEW_GODM
N13  C                   EVAL      ZVEV_VANO=SVEW_VANO
N13  C                   EVAL      ZVEV_VATA=SVEW_VATA
N13  C                   EVAL      ZVEV_VATI=SVEW_VATI
N13  C                   EVAL      ZVEV_VAT4=SVEW_VAT4
N13  C                   EVAL      ZVEV_VAT5=SVEW_VAT5
N13  C                   EVAL      ZVEV_ULKD=SVEW_ULKD
N13  C                   EVAL      ZVEV_EUP1=SVEW_EUP1
N13  C                   EVAL      ZVEV_EUP2=SVEW_EUP2
N16  C     *IN57         IFEQ      *ON
N13  C                   EVAL      ZVEV_KOTA=SVEW_KOTA
N13  C                   EVAL      ZVEV_KOT2=SVEW_KOT2
N13  C                   EVAL      ZVEV_KOT3=SVEW_KOT3
N13  C                   EVAL      ZVEV_KOT4=SVEW_KOT4
N13  C                   EVAL      ZVEV_KOT5=SVEW_KOT5
N13  C                   EVAL      ZVEV_KOS2=SVEW_KOS2
N13  C                   EVAL      ZVEV_KOS3=SVEW_KOS3
N13  C                   EVAL      ZVEV_KOS4=SVEW_KOS4
N13  C                   EVAL      ZVEV_KOS5=SVEW_KOS5
N13  C                   EVAL      ZVEV_VAS2=SVEW_VAS2
N13  C                   EVAL      ZVEV_VAS3=SVEW_VAS3
N13  C                   EVAL      ZVEV_VAS4=SVEW_VAS4
N13  C                   EVAL      ZVEV_VAS5=SVEW_VAS5
N13  C                   EVAL      ZVEV_GOD2=SVEW_GOD2
N13  C                   EVAL      ZVEV_GOD3=SVEW_GOD3
N13  C                   EVAL      ZVEV_GOD4=SVEW_GOD4
N13  C                   EVAL      ZVEV_GOD5=SVEW_GOD5
N13  C                   EVAL      ZVEV_BRUT=SVEW_BRUT
N13  C                   EVAL      ZVEV_NETO=SVEW_NETO
N13  C                   EVAL      ZVEV_ANKV=SVEW_ANKV
N13  C                   EVAL      ZVEV_SUKO=SVEW_SUKO
N13  C                   EVAL      ZVEV_SUK6=SVEW_SUK6
N13  C                   EVAL      ZVEV_SUKB=SVEW_SUKB
N13  C                   EVAL      ZVEV_SUTX=SVEW_SUTX
N13  C                   EVAL      ZVEV_SUT2=SVEW_SUT2
N13  C                   EVAL      ZVEV_SUT3=SVEW_SUT3
N13  C                   EVAL      ZVEV_SUT4=SVEW_SUT4
N13  C                   EVAL      ZVEV_SUT5=SVEW_SUT5
N13  C                   EVAL      ZVEV_SUT6=SVEW_SUT6
N13  C                   EVAL      ZVEV_SUT7=SVEW_SUT7
N13  C                   EVAL      ZVEV_SUT8=SVEW_SUT8
N13  C                   EVAL      ZVEV_SUT9=SVEW_SUT9
N13  C                   EVAL      ZVEV_SUTA=SVEW_SUTA
N13  C                   EVAL      ZVEV_SUTB=SVEW_SUTB
N13  C                   EVAL      ZVEV_SUTC=SVEW_SUTC
N13  C                   EVAL      ZVEV_SUTD=SVEW_SUTD
N13  C                   EVAL      ZVEV_SUTE=SVEW_SUTE
N13  C                   EVAL      ZVEV_SUTF=SVEW_SUTF
N13  C                   EVAL      ZVEV_FABL=SVEW_FABL
N13  C                   EVAL      ZVEV_STVA=SVEW_STVA
N13  C                   EVAL      ZVEV_STVA2=SVEW_STVA2
N13  C                   EVAL      ZVEV_BETK=SVEW_BETK
N13  C                   EVAL      ZVEV_KOMR=SVEW_KOMR
N13  C                   EVAL      ZVEV_FNKD=SVEW_FNKD
N13  C                   EVAL      ZVEV_BIT1=SVEW_BIT1
N13  C                   EVAL      ZVEV_BIT2=SVEW_BIT2
N13  C                   EVAL      ZVEV_BIT3=SVEW_BIT3
N13  C                   EVAL      ZVEV_BIT4=SVEW_BIT4
N13  C                   EVAL      ZVEV_BIT5=SVEW_BIT5
N13  C                   EVAL      ZVEV_BIT6=SVEW_BIT6
N13  C                   EVAL      ZVEV_BIT7=SVEW_BIT7
N13  C                   EVAL      ZVEV_BIT8=SVEW_BIT8
N13  C                   EVAL      ZVEV_BIT9=SVEW_BIT9
N13  C                   EVAL      ZVEV_BII1=SVEW_BII1
N13  C                   EVAL      ZVEV_BII2=SVEW_BII2
N13  C                   EVAL      ZVEV_BII3=SVEW_BII3
N13  C                   EVAL      ZVEV_BII4=SVEW_BII4
N13  C                   EVAL      ZVEV_BII5=SVEW_BII5
N13  C                   EVAL      ZVEV_BII6=SVEW_BII6
N13  C                   EVAL      ZVEV_BII7=SVEW_BII7
N13  C                   EVAL      ZVEV_BII8=SVEW_BII8
N13  C                   EVAL      ZVEV_BII9=SVEW_BII9
N13  C                   EVAL      ZVEV_CO01=SVEW_CO01
N13  C                   EVAL      ZVEV_CO02=SVEW_CO02
N13  C                   EVAL      ZVEV_CO03=SVEW_CO03
N13  C                   EVAL      ZVEV_CO04=SVEW_CO04
N13  C                   EVAL      ZVEV_CO05=SVEW_CO05
N13  C                   EVAL      ZVEV_CO06=SVEW_CO06
N13  C                   EVAL      ZVEV_CO07=SVEW_CO07
N13  C                   EVAL      ZVEV_CO08=SVEW_CO08
N13  C                   EVAL      ZVEV_CO09=SVEW_CO09
N13  C                   EVAL      ZVEV_CO10=SVEW_CO10
N13  C                   EVAL      ZVEV_CO11=SVEW_CO11
N13  C                   EVAL      ZVEV_CO12=SVEW_CO12
N13  C                   EVAL      ZVEV_CO13=SVEW_CO13
N13  C                   EVAL      ZVEV_CO14=SVEW_CO14
N13  C                   EVAL      ZVEV_CO15=SVEW_CO15
N13  C                   EVAL      ZVEV_CO16=SVEW_CO16
N13  C                   EVAL      ZVEV_CO17=SVEW_CO17
N13  C                   EVAL      ZVEV_CO18=SVEW_CO18
N13  C                   EVAL      ZVEV_CO19=SVEW_CO19
N13  C                   EVAL      ZVEV_CO20=SVEW_CO20
N13  C                   EVAL      ZVEV_TIK1=SVEW_TIK1
N13  C                   EVAL      ZVEV_TIK2=SVEW_TIK2
N13  C                   EVAL      ZVEV_TIK3=SVEW_TIK3
N13  C                   EVAL      ZVEV_TIK4=SVEW_TIK4
N13  C                   EVAL      ZVEV_TIK5=SVEW_TIK5
N13  C                   EVAL      ZVEV_TIK6=SVEW_TIK6
N13  C                   EVAL      ZVEV_TIK7=SVEW_TIK7
N13  C                   EVAL      ZVEV_TIK8=SVEW_TIK8
N13  C                   EVAL      ZVEV_TIK9=SVEW_TIK9
N13  C                   EVAL      ZVEV_TIT1=SVEW_TIT1
N13  C                   EVAL      ZVEV_TIT2=SVEW_TIT2
N13  C                   EVAL      ZVEV_TIT3=SVEW_TIT3
N13  C                   EVAL      ZVEV_TIT4=SVEW_TIT4
N13  C                   EVAL      ZVEV_TIT5=SVEW_TIT5
N13  C                   EVAL      ZVEV_TIT6=SVEW_TIT6
N13  C                   EVAL      ZVEV_TIT7=SVEW_TIT7
N13  C                   EVAL      ZVEV_TIT8=SVEW_TIT8
N13  C                   EVAL      ZVEV_TIT9=SVEW_TIT9
N13  C                   EVAL      ZVEV_TIX1=SVEW_TIX1
N13  C                   EVAL      ZVEV_TIX2=SVEW_TIX2
N13  C                   EVAL      ZVEV_TIX3=SVEW_TIX3
N13  C                   EVAL      ZVEV_TIX4=SVEW_TIX4
N13  C                   EVAL      ZVEV_TIX5=SVEW_TIX5
N13  C                   EVAL      ZVEV_TIX6=SVEW_TIX6
N13  C                   EVAL      ZVEV_TIX7=SVEW_TIX7
N13  C                   EVAL      ZVEV_TIX8=SVEW_TIX8
N13  C                   EVAL      ZVEV_TIX9=SVEW_TIX9
N13  C                   EVAL      ZVEV_LAGI=SVEW_LAGI
N13  C                   EVAL      ZVEV_LAGT=SVEW_LAGT
N13  C                   EVAL      ZVEV_LAGL=SVEW_LAGL
N13  C                   EVAL      ZVEV_CALL=SVEW_CALL
N16  C                   ENDIF
N13
N13  C                   ENDIF
N13  C                   ENDIF
N13  C                   ENDSR
