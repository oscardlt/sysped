     H debug(*yes)
      *   Arbeide med kostnadsbilag - ETT BILAG
      *********************************************************************
      *
      *
CRTPG+*  CRTPGM SYSPED/ESKS02 MODULE(*LIBL/ESKS02 *LIBL/INCGI)
CRTPGM*         ACTGRP(CGI) AUT(*USE)
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Omskrevet til Jquery tablesort / Multifs
      *              gamle sortteknikker slettet uten Merking (se ESKS01.G)
10XXX * 02 JOV PTF10 MER INFO I TOP VED SISN AV BILAGSLINJER
10XXX * 03 YBC PTF10 TITLE
10XXX * 04 SH  PTF11 videreutvikling i samarbeid med Nortrail
10XXX * 05 SH  PTF11 taste valutabeløp ved valuta
10XXX * 06 SH  PTF11 bytt ut indikator 33 i setrow
10XXX * 07 SH  PTF11 snutt sortering
10XXX * 08 SH  PTF11 reberegner budsjett
10XXX * 09 SH  PTF11 vekt
10XXX * 10 SH  PTF11 Obs ved ferdigmelding og 1. gangsreg sett 2.gangsreg
10XXX * 11 SH  PTF11 hentre vekt  fra trackl08
10XXX * 12 SH  PTF11 hent
10XXX * 13 SH  PTF11 ikke + 25 % på budsjett lev mva til syge71
10XXX * 14 SH  PTF11 blanke vekt2
10XXX * 15 SH  PTF11 reklamasjon
10XXX * 16 SH  PTF11 reklamasjon + insert nye linjer
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *********************************************************************
N09  FTRACKL08  IF   E           K DISK    USROPN
N04  FKOSBU12   UF   E           K DISK    USROPN
     FBRIDF     IF   E           K DISK    USROPN
     FKOSTA     UF   E           K DISK    USROPN
     FKOSTB     IF   E           K DISK    USROPN
     F                                     RENAME(KOSTBR:KOSTBR0)
     F                                     INFDS(KOSTBDS)
     FKOSTBOPD  UF   E             DISK    USROPN
     FKOSTT     IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
n08  FDOKUF     IF   E           K DISK    USROPN
n08  FTRAN      IF   E           K DISK    USROPN
     FVALUL01   IF   E           K DISK    USROPN
      *********************************************************************
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *
      * Indicators for GetHtmlIfsMult subprocedure
     D IfsMultIndicators...
     d                 ds
     D  NoErrors                       n
     D  NameTooLong                    n
     D  NotAccessible                  n
     D  NoFilesUsable                  n
     D  DupSections                    n
     D  FileIsEmpty                    n
      *
      * Client input variables
     D user            s             10
     D WSKABNR         s              7
     D WBKABNR         s              7  0
S02  D*WSSORT          s             10
S02  D*WSINTEG         s              6
S02  D*WBINTEG         s              6  0
     D WSFRAMES        s              1
     D WSSTART         s              1
     D WSBLDIFF        s             15
     D WBBLDIFF        s             13  2
     D XBBLHB          S             13  2
     D WSENDRE         s              1
     D WSSLETT         s              1
     D WSRECNO         s              7
     D WBRECNO         s              7  0
     D WSEMOD1         s              1
     D WSEMOD2         s             10
     D WSBS1           s              1
     D WSBS2           s             30
N15  D KBREKL3         s              3
N03  D TITLE           s            100
N04  D WSAVVI1         s              1
N04  D WSAVVI2         s              4
N04  D KBDIFF          S              5  2
N04  D FAKTUR          S             13  2
      *
     D WSBL            s             15
     D W3PMN           s              2
     D W3PAR           s              2
     D WSPROS          s              6
     D WSAVD           s              4
     D WSOPD           s              7
     D WSPRO           s              8
     D W2AVD           s              4
     D W2OPD           s              7
     D W2KN            s              8
     D W2BLHB          s             15
     D W2PMN           s              2
     D W2PAR           s              2
     D W2BLF           s             15
     D OddEven         s             10
      *
     D FEIL01          C                   CONST('Kostnad er ikke ferdig -
     D                                     fordelt ')
      * For xlate mellom Upper Case og Lower Case
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
      *
     D Spaces          s             12a   inz('&nbsp;&nbsp;')
     D ItemCount       s             10i 0
     D i               s             10i 0
      *
     D KOSTBDS         DS
     D  RECNOB               397    400B 0
      *
     D                 DS
     D  UPARM1                 1    512
     D  WBBL                   1     13  2
     D  WSVK                  14     16
     D  WSKDPF                17     17
     D  WSKDM                 18     18
     D  WBPROS                19     23  2
     D  WSKDMV                24     24
     D  WBAVD                 25     28  0
     D  WBOPD                 29     35  0
     D  WBPRO                 36     43  0
     D  WSGN17                44     60
     D  WSBILT                61     75
     D  WSFRIO                76     76
     D  WSFR01                77     79
     D  WSFR02                80     82
     D  WSFR03                83     85
     D  WSOTIO                86     86
     D  WSOT01                87     88
     D  WSOT02                89     90
     D  WSOT03                91     92
     D  WSSKIO                93     93
     D  WSSK01                94     94
     D  WSSK02                95     95
     D  WSF23                 96     96
     D  W2ENDRE              200    200
     D  W2RECNO              201    207  0
     D  W2BAVD               208    211  0
     D  W2BOPD               212    218  0
     D  W2BKN                219    226  0
     D  W2VK                 227    229
     D  W2KDPF               230    230
     D  W2BBLHB              231    243  2
     D  W2BPMN               274    275  0
     D  W2BPAR               276    277  0
     D  W3BMN                278    279  0
     D  W3BAR                280    281  0
     D  W2KDM                244    244
     D  W2BBLF               245    257  2
     D  W2KDMV               258    258
     D  W2BILT               259    273
     D  W3FM                 300    300
     D  UFEILMELDING         431    510
     D  UFMELDNR             511    512
N11  D                 DS
N11  D  TTDEPO                 1     10
N11  D  TT                     1     10
N11  D                                     DIM(10)
N11  D                 DS
N11  D  VEKT02                 1      5  0
N11  D  T2                     1      5
N11  D                                     DIM(5)
      *
      /copy syspeds/qrpgsrcpy,prolog3
      *
      * Get program start time for calculating execution time
     C                   time                    timedata1
      * Parse input / cvt to numeric
     C                   exsr      Parse
      * File open / keys
     C                   EXSR      INIT
      *
     C                   SELECT
     C                   WHEN      WSSLETT = 'Y'
     C                   EXSR      SRSLETT
     C                   WHEN      WSENDRE = 'Y'
     C                   EXSR      SRVIS
N16  C                   WHEN      WSENDRE = 'R'
N16  C                   EXSR      SRVISRE
     C                   WHEN      WSENDRE = 'J'
     C                   EXSR      TESTB2
     C                   WHEN      W3FM    = 'J'
     C                   EXSR      TESTB3
     C                   WHEN      WSSTART = 'N'
     C                   EXSR      TESTB1
     C                   ENDSL
      *
     C                   EXSR      SUMDELT
      * Read output skeleton html member into memory
     C                   exsr      LoadHtml
      *
     C                   IF        WSEMOD1 = 'Y'
     C                   IF        WSEMOD2 = 'FORENKLET'
      * Bruker vil ha forenklet input.
     C                   EVAL      WSEMOD2 = 'KOMPLETT'
     C                   ELSE
      * Bruker vil ha forenklet input.
     C                   EVAL      WSEMOD2 = 'FORENKLET'
     C                   END
     C                   END
N04  C                   IF        WSAVVI1 = 'Y'
N04  C                   EVAL      WSAVVI2 = 'ALLE'
N04   * Bruker vil ha alle poster.
N04  C                   ELSE
N04  C                   EVAL      WSAVVI1 = 'N'
N04  C                   EVAL      WSAVVI2 = 'FEIL'
N04  C                   END
      * Set section variables
     C                   exsr      Settop
     C                   callp     wrtsection('StdtopTab')
     C                   callp     wrtsection('top')
      *
     C                   IF        ((WSENDRE = 'Y') OR (WSENDRE = 'J'))
     C                   callp     wrtsection('Endre')
     C                   else
N16  C                   IF        ((WSENDRE = 'I'))
     C                   callp     wrtsection('Lage')
      *
     C                   IF        WSEMOD1 = 'Y'
     C                   IF        WSEMOD2 = 'KOMPLETT'
      * Bruker vil ha forenklet input.
     C                   callp     wrtsection('LageMod2')
     C                   callp     wrtsection('LageMod4')
     C                   ELSE
      * Bruker vil ha KOMPLETT  input.
     C                   callp     wrtsection('LageMod1')
     C                   callp     wrtsection('LageMod2')
     C                   callp     wrtsection('LageMod3')
     C                   callp     wrtsection('LageMod4')
     C                   END
     C                   ELSE
      * Bruker vil beholde tidligere moduls.
     C                   IF        WSEMOD2 = 'FORENKLET'
     C                   callp     wrtsection('LageMod1')
     C                   callp     wrtsection('LageMod2')
     C                   callp     wrtsection('LageMod3')
     C                   callp     wrtsection('LageMod4')
     C                   ELSE
     C                   callp     wrtsection('LageMod2')
     C                   callp     wrtsection('LageMod4')
     C                   END
     C                   END
      *
     C                   END
N16  C                   END
     C                   callp     wrtsection('Felles')
      *
s07  C*    WBKABNR       SETGT     KOSTB
s07  C*    WBKABNR       READPE    KOSTB                                  33
n07  C     WBKABNR       SETLL     KOSTB
n07  C     WBKABNR       READE     KOSTB                                  33
     C                   DOW       *IN33 = *OFF
N04  C  N33              IF        WSAVVI2 = 'FEIL'
N04  c     KBNØKK        ifne      8
N04  c     KBNØKK        andne     9
N04  c                   goto      nesrow
N04  c                   end
N04  c                   end
     C                   exsr      Setrow
      * Compute run time
     C                   time                    timedata2
     C     timedata2     subdur    timedata1     ms:*ms
     C                   eval      sec = ms / 1000000
     C                   callp     updhtmlvar('runtime':
     C                             %trim(%editw(sec:'     0 .   ')))
     C                   callp     wrtsection('row')
N04  C     nesrow        tag
s07  C*    WBKABNR       READPE    KOSTB                                  33
n07  C     WBKABNR       READE     KOSTB                                  33
     C                   ENDDO
      * Quit
      * Compute run time
     C                   time                    timedata2
     C     timedata2     subdur    timedata1     ms:*ms
     C                   eval      sec = ms / 1000000
     C                   callp     updhtmlvar('runtime':
     C                             %trim(%editw(sec:'     0 .   ')))
      *
     C                   callp     wrtsection('bot')
     C                   callp     wrtsection('botStd')                         Body/htmlavsl
     C                   exsr      Exit
      *
     C                   eval      *inlr = *on
     C                   return
      *
      *
      *=====================================================================
      * Parse input / cvt to numeric
      *=====================================================================
     C     Parse         begsr
      * Parse variables from QUERY_STRING environment variable
     C                   eval      user     = zhbgetvar('user')
     C                   eval      WSKABNR  = zhbgetvar('INRNR')
     C                   EVAL      WBKABNR  = c2n2(WSKABNR)
S02  C*                  eval      WSSORT   = zhbgetvar('SORT')
S02  C*                  eval      WSINTEG  = zhbgetvar('INTEG')
S02  C*                  EVAL      WBINTEG  = c2n2(WSINTEG)
     C                   eval      WSFRAMES = zhbgetvar('FRAMES')
     C                   eval      WSSTART  = zhbgetvar('WSSTART')
     C                   eval      WSBLDIFF = zhbgetvar('WSBLDIFF')
     C                   EVAL      WBBLDIFF = c2n2(WSBLDIFF)
     C                   eval      WSSLETT  = zhbgetvar('SLETT')
     C                   eval      WSENDRE  = zhbgetvar('ENDRE')
     C                   eval      WSRECNO  = zhbgetvar('RECNO')
     C                   EVAL      WBRECNO  = c2n2(WSRECNO)
     C                   eval      WSEMOD1  = zhbgetvar('EMODULS1')
     C                   IF        WSEMOD1  = *BLANKS
     C                   EVAL      WSEMOD1  = 'N'
     C                   END
     C                   eval      WSEMOD2  = zhbgetvar('EMODULS2')
     C                   IF        WSEMOD2  = *BLANKS
     C                   EVAL      WSEMOD2  = 'KOMPLETT'
     C                   END
     C                   eval      W3FM     = zhbgetvar('FERDIGM')
      *
N04  C                   eval      WSAVVI1  = zhbgetvar('WSAVVI1')
N04  C     LC:UC         XLATE     WSAVVI1       WSAVVI1
N04  C     WSAVVI1       IFNE      'Y'
N04  C     WSAVVI1       ANDNE     'N'
N04  C                   EVAL      WSAVVI1  = 'Y'
N04  C                   END
N04  C                   eval      WSAVVI2  = zhbgetvar('WSAVVI2')
N04  C                   IF        WSAVVI2  = *BLANKS
N04  C                   EVAL      WSAVVI2  = 'ALLE'
N04  C                   END
     C                   eval      WSBL     = zhbgetvar('WSBL')
     C                   EVAL      WBBL     = c2n2(WSBL)
     C                   eval      W3PMN    = zhbgetvar('W3PMN')
     C                   EVAL      W3BMN    = c2n2(W3PMN)
     C                   eval      W3PAR    = zhbgetvar('W3PAR')
     C                   EVAL      W3BAR    = c2n2(W3PAR)
     C                   eval      WSVK     = zhbgetvar('WSVK')
     C     LC:UC         XLATE     WSVK          WSVK
     C                   eval      WSKDPF   = zhbgetvar('WSKDPF')
     C     LC:UC         XLATE     WSKDPF        WSKDPF
     C                   eval      WSKDM    = zhbgetvar('WSKDM')
     C                   eval      WSPROS   = zhbgetvar('WSPROS')
     C                   EVAL      WBPROS   = c2n2(WSPROS)
     C                   eval      WSKDMV   = zhbgetvar('WSKDMV')
     C     LC:UC         XLATE     WSKDMV        WSKDMV
     C                   eval      WSAVD    = zhbgetvar('WSAVD')
     C                   EVAL      WBAVD    = c2n2(WSAVD)
     C                   eval      WSOPD    = zhbgetvar('WSOPD')
     C                   EVAL      WBOPD    = c2n2(WSOPD)
     C                   eval      WSPRO    = zhbgetvar('WSPRO')
     C                   EVAL      WBPRO    = c2n2(WSPRO)
     C                   eval      WSGN17   = zhbgetvar('WSGN17')
     C     LC:UC         XLATE     WSGN17        WSGN17
     C                   eval      WSBILT   = zhbgetvar('WSBILT')
     C     LC:UC         XLATE     WSBILT        WSBILT
     C                   eval      WSFRIO   = zhbgetvar('WSFRIO')
     C     LC:UC         XLATE     WSFRIO        WSFRIO
     C                   eval      WSFR01   = zhbgetvar('WSFR1')
     C     LC:UC         XLATE     WSFR01        WSFR01
     C                   eval      WSFR02   = zhbgetvar('WSFR2')
     C     LC:UC         XLATE     WSFR02        WSFR02
     C                   eval      WSFR03   = zhbgetvar('WSFR3')
     C     LC:UC         XLATE     WSFR03        WSFR03
     C                   eval      WSOTIO   = zhbgetvar('WSOTIO')
     C     LC:UC         XLATE     WSOTIO        WSOTIO
     C                   eval      WSOT01   = zhbgetvar('WSOT01')
     C     LC:UC         XLATE     WSOT01        WSOT01
     C                   eval      WSOT02   = zhbgetvar('WSOT02')
     C     LC:UC         XLATE     WSOT02        WSOT02
     C                   eval      WSOT03   = zhbgetvar('WSOT03')
     C     LC:UC         XLATE     WSOT03        WSOT03
     C                   eval      WSSKIO   = zhbgetvar('WSSKIO')
     C     LC:UC         XLATE     WSSKIO        WSSKIO
     C                   eval      WSSK01   = zhbgetvar('WSSK01')
     C     LC:UC         XLATE     WSSK01        WSSK01
     C                   eval      WSSK02   = zhbgetvar('WSSK02')
     C     LC:UC         XLATE     WSSK02        WSSK02
     C                   eval      WSF23    = zhbgetvar('WSF23')
      *
     C                   eval      W2AVD    = zhbgetvar('W2AVD')
     C                   EVAL      W2BAVD   = c2n2(W2AVD)
     C                   eval      W2OPD    = zhbgetvar('W2OPD')
     C                   EVAL      W2BOPD   = c2n2(W2OPD)
     C                   eval      W2KN     = zhbgetvar('W2KN')
     C                   EVAL      W2BKN    = c2n2(W2KN)
     C                   eval      W2VK     = zhbgetvar('W2VK')
     C     LC:UC         XLATE     W2VK          W2VK
     C                   eval      W2KDPF   = zhbgetvar('W2KDPF')
     C     LC:UC         XLATE     W2KDPF        W2KDPF
     C                   eval      W2BLHB   = zhbgetvar('W2BLHB')
     C                   EVAL      W2BBLHB  = c2n2(W2BLHB)
     C                   eval      W2PMN    = zhbgetvar('W2PMN')
     C                   EVAL      W2BPMN   = c2n2(W2PMN)
     C                   eval      W2PAR    = zhbgetvar('W2PAR')
     C                   EVAL      W2BPAR   = c2n2(W2PAR)
     C                   eval      W2KDM    = zhbgetvar('W2KDM')
     C     LC:UC         XLATE     W2KDM         W2KDM
     C                   eval      W2BLF    = zhbgetvar('W2BLF')
     C                   EVAL      W2BBLF   = c2n2(W2BLF)
     C                   eval      W2KDMV   = zhbgetvar('W2KDMV')
     C     LC:UC         XLATE     W2KDMV        W2KDMV
     C                   eval      W2BILT   = zhbgetvar('W2BILT')
     C     LC:UC         XLATE     W2BILT        W2BILT
      *
     C                   eval      UFEILMELDING = *BLANKS
     C                   eval      UFMELDNR     = *BLANKS
      *
     C                   endsr
      *
      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   CLOSE     BRIDF
     C                   CLOSE     KOSTA
N04  C                   CLOSE     KOSBU12
N09  C                   CLOSE     TRACKL08
     C                   CLOSE     KOSTB
     C                   CLOSE     KOSTBOPD
     C                   CLOSE     KOSTT
     C                   CLOSE     HEADF
n08  C                   CLOSE     DOKUF
n08  C                   CLOSE     TRAN
     C                   CLOSE     VALUL01
      *
     C                   endsr
      *
      *=====================================================================
      * Read output skeleton html member into memory
      *=====================================================================
     C     LoadHtml      begsr
cccccC                   eval      IfsMultIndicators = gethtmlifsmult(
cccccC                             '/syspeddev/html/eSpedTop.html -
cccccC                             /syspeddev/html/ESKS02.html -
cccccC                             /syspeddev/html/eSpedBot.html':
cccccC                             '/CGITAG/')
     C                   endsr
      *=====================================================================
      *  Set variable data for section /$top
      *=====================================================================
     C     SetTop        begsr
      *
OddEvC                   callp     updHTMLvar('ROWHEAD':RowHead)
OddEvC                   callp     updHTMLvar('LogoImg':LogoImg)
BODY C                   callp     updhtmlvar('BODYCLASS':'class='+BIFARG)
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHTMLvar('INRNR':WSKABNR)
S02  C*                  callp     updHTMLvar('SORT':WSSORT)
S02  C*                  callp     updHTMLvar('INTEG':WSINTEG)
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
     C                   callp     updHTMLvar('EModuls2':WSEMOD2)
N04  C                   callp     updHTMLvar('WSAVVI1':WSAVVI1)
N04  C                   callp     updHTMLvar('WSAVVI2':WSAVVI2)
N03  c                   eval      Title='Arbeid med bilagslinjer'
N03  C                   callp     updhtmlvar('TITLE':Title)
      *
     C                   callp     updHTMLvar('KAVAL':KAVAL)
     C                   callp     updHtmlVar('KABL':
     C                             %trim(%editc(KABL:'L')))
     C                   callp     updHtmlVar('WSBLDELT':
     C                             %trim(%editc(WSBLDELT:'L')))
     C                   callp     updHtmlVar('WSBLDIFF':
     C                             %trim(%editc(WBBLDIFF:'L')))
      *
     C                   callp     updHtmlVar('WSBL':
     C                             %trim(%editc(WBBL:'L')))
     C                   callp     updHtmlVar('W3PMN':
     C                             %trim(%editc(W3BMN:'Z')))
     C                   callp     updHtmlVar('W3PAR':
     C                             %trim(%editc(W3BAR:'Z')))
     C                   callp     updHTMLvar('WSVK':WSVK)
     C                   callp     updHTMLvar('WSKDPF':WSKDPF)
     C                   callp     updHTMLvar('WSKDM':WSKDM)
     C                   callp     updHtmlVar('WSPROS':
     C                             %trim(%editc(WBPROS:'3')))
     C                   callp     updHTMLvar('WSKDMV':WSKDMV)
      *
     C                   callp     updHtmlVar('WSAVD':
     C                             %trim(%editc(WBAVD:'Z')))
     C                   callp     updHtmlVar('WSOPD':
     C                             %trim(%editc(WBOPD:'Z')))
     C                   callp     updHtmlVar('WSPRO':
     C                             %trim(%editc(WBPRO:'Z')))
     C                   callp     updHTMLvar('WSGN17':WSGN17)
      *
     C                   callp     updHTMLvar('WSBILT':WSBILT)
     C                   callp     updHTMLvar('WSFRIO':WSFRIO)
     C                   callp     updHTMLvar('WSFR01':WSFR01)
     C                   callp     updHTMLvar('WSFR02':WSFR02)
     C                   callp     updHTMLvar('WSFR03':WSFR03)
     C                   callp     updHTMLvar('WSOTIO':WSOTIO)
     C                   callp     updHTMLvar('WSOT01':WSOT01)
     C                   callp     updHTMLvar('WSOT02':WSOT02)
     C                   callp     updHTMLvar('WSOT03':WSOT03)
     C                   callp     updHTMLvar('WSSKIO':WSSKIO)
     C                   callp     updHTMLvar('WSSK01':WSSK01)
     C                   callp     updHTMLvar('WSSK02':WSSK02)
      *
N02  C     WBKABNR       CHAIN(N)  KOSTA                              33
N02  C                   callp     updHTMLvar('KABNR2':
N02  C                             %trim(%editc(KABNR2:'3')))
N02  C                   callp     updHTMLvar('KAPMN':
N02  C                             %trim(%editc(KAPMN:'Z')))
N02  C                   callp     updHTMLvar('KAPAR':
N02  C                             %trim(%editc(KAPÅR:'Z')))
      *
     C                   callp     updhtmlvar('FEILMELDING':
     C                             UFEILMELDING)
     C                   callp     updhtmlvar('FMELDNR':UFMELDNR)
      *
     C                   endsr
      *=====================================================================
      *  Set variable data for section /$row
      *=====================================================================
     C     Setrow        begsr
     c*                  dump
      * odd/even tester
     c     OddEven       IFEQ      ODD
     c                   eval      OddEven = EVEN
     c                   else
     c                   eval      OddEven = ODD
     c                   end
      * odd/even tester slutt
     C                   callp     updHTMLvar('ODDEVEN':OddEven)
      *
s06  C*    HEADFK        CHAIN     HEADF                              33
n06  C     HEADFK        CHAIN     HEADF                              32
     c
n04   *
n04   * henter eventuelt busjett
n04   *
s06  c*    *in33         ifeq      '0'
n06  c     *in32         ifeq      '0'
SH   c*    kbbuds        andeq     0
n08  C     DOKUFK        CHAIN     DOKUF                              34
n08  C  N34TRANK         CHAIN     TRAN                               34
n08  c  N34kosbuk        chain(n)  kosbu12                            34
n04  c     *in34         ifeq      '0'
n08  c*                  exsr      berbud
n08  c*    nyttbu        ifne      bubl
n08  c*    kosbuk        chain     kosbu12                            34
n08  c*                  z-add     nyttbu        bubl
n08  c*                  update    kosbur
n08  c*                  end
n04  c                   z-add     recnob        recnok            9 0
n04  c     recnok        chain     kostbopd                           34
S13  C*    BUBL          MULT      1,25          BUBL
n04  c  N34              z-add     bubl          kbbuds
n04  c  N34              update    kostbr
n04  c                   end
n04  c                   end
      *
     C                   callp     updHtmlVar('KBAVD':
     C                             %trim(%editc(KBAVD:'Z')))
      * oppdragsnummer 0
N02  c     KBOPD         ifne      *zeros
     C                   callp     updHtmlVar('KBOPD':
     C                             %trim(%editc(KBOPD:'Z')))
N04  c                   else
N04  C                   callp     updHtmlVar('KBOPD':
N04  C                             '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')
N02  c                   endif
      * slutt oppdragsnummer
     C                   callp     updHTMLvar('KBOT':HEOT)
     C                   callp     updHTMLvar('KBFR':HEFR)
     C                   callp     updHtmlVar('KBNOKK':
     C                             %trim(%editc(KBNØKK:'3')))
     C                   callp     updHtmlVar('KBKN':
     C                             %trim(%editc(KBKN:'Z')))
     C                   callp     updHTMLvar('KBVK':KBVK)
     C                   callp     updHTMLvar('KAVAL':KAVAL)
     c                   move      *blanks       KBREKL3
N15  c     KBREKL        ifne      *blanks
N16  c                   move      *blanks       KBFAREK          50
N16  c                   eval      KBFAREK='color=red'
N15  c                   eval      KBREKL3 = '*' + KBREKL
N15  C                   end
N16  C                   callp     updHTMLvar('KBFAREK':KBFAREK)
N03  C                   callp     updHTMLvar('KBREKL3':KBREKL3)
     C                   callp     updHtmlVar('KBKDM':
     C                             %trim(%editc(KBKDM:'3')))
     C                   EVAL(H)   XBBLHB = KBBLHB / KAVKU * OMRFAK
     C                   callp     updHtmlVar('KBBLHB':
     C                             %trim(%editc(XBBLHB:'L')))
     C                   callp     updHTMLvar('KBKDMV':KBKDMV)
     C                   callp     updHtmlVar('KBBLF':
     C                             %trim(%editc(KBBLF:'L')))
     C                   callp     updHtmlVar('RECNO':
     C                             %trim(%editc(RECNOB:'Z')))
     C                   callp     updHtmlVar('KBPMN':
     C                             %trim(%editc(KBPMN:'Z')))
     C                   callp     updHtmlVar('KBPAR':
     C                             %trim(%editc(KBPÅR:'Z')))
n04  C                   callp     updHtmlVar('KBBUDS':
n04  C                             %trim(%editc(KBBUDS:'L')))
n04  c                   z-add     kbblf         faktur
n09  c                   z-add     hevkt         HEFBVO            5 0
n14  c                   movea     *blanks       T2
n09  c     hem3          mult      200           HEFBVOK          11 2
n09  c     HEFBVOK       ifgt      HEFBVO
n09  c                   z-add     HEFBVOK       HEFBVO
n09  c                   end
n09  C                   callp     updHtmlVar('HEFBVO':
n09  C                             %trim(%editc(HEFBVO:'Z')))
N12  c     hent          ifgt      999
n12  c                   z-add     999           wsnt
n12  c                   else
n12  c                   z-add     hent          wsnt              3 0
n12  c                   end
n12  C                   callp     updHtmlVar('WSNT':
n12  C                             %trim(%editc(WSNT:'Z')))
N12  C     trakey        chain     trackl08                           34
n11  c     *in34         ifeq      '0'
n11  c                   z-add     8             n8                2 0
n11  c                   z-add     5             n5                2 0
n11  c                   do        5
n11  c     tt(n8)        ifne      ' '
n11  c                   move      tt(N8)        t2(N5)
n11  c                   sub       1             n5
n11  c                   end
n11  c                   sub       1             n8
n11  c                   enddo
n11  c                   end
N09  C  N34              z-add     vekt02        hefbvl            7 0
n09  C   34              z-add     0             hefbvl
n09  C                   callp     updHtmlVar('HEFBVL':
n09  C                             %trim(%editc(HEFBVL:'Z')))
n04  5* kaller eksternt progra for tester
n04  C                   call      'SYGE71'
n04  C                   parm                    kbavd
n04  C                   parm                    kbopd
n04  C                   parm                    kbvk
n04  c                   parm                    kbblhb
n04  c                   parm                    kbbuds
n04  c                   parm                    faktur           13 2
n04  c                   parm                    upros             3 1
n04  c                   parm                    kbdiff            5 2
     c                   parm                    kalnr
     c                   parm                    kbkdm
n04  c                   parm                    feil1             1
      *
N04  c                   move      *blanks       KBFARGE          50
N04  C     feil1         ifeq      'J'
N02  c                   eval      KBFARGE='bgcolor=red'
N04  C                   end
     C                   callp     updHtmlVar('UPROS':
     C                             %trim(%editc(UPROS:'L')))
n04  C                   callp     updHtmlVar('FAKTUR':
n04  C                             %trim(%editc(FAKTUR:'L')))
n04  C                   callp     updHtmlVar('KBDIFF':
n04  C                             %trim(%editc(KBDIFF:'L')))
N02  C                   callp     updHTMLvar('KBFARGE':KBFARGE)
N02  c                   move      *blanks       OPDFARGE         50
      * nøkkel 9 oppdrG MANGLER
N02  c                   if        KBNØKK=9
N02  c                   eval      OPDFARGE='bgcolor=red'
N02  c                   endif
N02  c                   if        KBNØKK=8
N02  c                   eval      OPDFARGE='bgcolor=orange'
N02  c                   endif
N02  C                   callp     updHTMLvar('OPDFARGE':OPDFARGE)
      *
     C                   endsr
      *
      *=====================================================================******
      *  SUM FORDELT
      *=====================================================================******
     C     SUMDELT       begsr
     C                   MOVE      *ZEROS        WSBLDELT         13 2
     C     WBKABNR       SETLL     KOSTB
     C     WBKABNR       READE     KOSTB                                  33
     C                   DOW       *IN33 = *OFF
     C                   ADD       KBBLHB        WSBLDELT
     C     WBKABNR       READE     KOSTB                                  33
     C                   ENDDO
      *
     C     VALU1K        CHAIN     VALUL01                            33
     C                   EVAL(H)   WSBLDELT = WSBLDELT / KAVKU * OMRFAK
     C     KABL          ADD       WSBLDELT      WBBLDIFF
     C                   IF        WBBLDIFF < 0
     C                   Z-SUB     WBBLDIFF      XDIFF            13 2
     C                   ELSE
     C                   Z-ADD     WBBLDIFF      XDIFF
     C                   END
     C                   IF        XDIFF < 0,05
      * DIFF. SKYLDES OMREGNING AV KURS.
     C                   EVAL      WSBLDELT = KABL * -1
     C                   EVAL      WBBLDIFF = 0
     C                   END
      *
     C                   endsr
      *
      *=====================================================================******
      *  SRSLETT
      *=====================================================================******
     C     SRSLETT       begsr
      *
     C     WBRECNO       CHAIN     KOSTBOPD                           33
     C  N33              DELETE    KOSTBR
      *
     C                   endsr
      *
      *=====================================================================******
      *  SRVIS
      *=====================================================================******
     C     SRVIS         begsr
      *
     C     WBRECNO       CHAIN(N)  KOSTBOPD                           33
     C                   callp     updHtmlVar('W2AVD':
     C                             %trim(%editc(KBAVD:'Z')))
     C                   callp     updHtmlVar('W2OPD':
     C                             %trim(%editc(KBOPD:'Z')))
     C                   callp     updHtmlVar('W2KN':
     C                             %trim(%editc(KBKN:'Z')))
     C                   callp     updHTMLvar('W2VK':KBVK)
     C                   callp     updHTMLvar('W2KDPF':KBKDPF)
     C     VALU1K        CHAIN     VALUL01                            33
     C                   EVAL(H)   XBBLHB = KBBLHB / KAVKU * OMRFAK
     C                   callp     updHtmlVar('W2BLHB':
     C                             %trim(%editc(XBBLHB:'L')))
     C                   callp     updHtmlVar('W2PMN':
     C                             %trim(%editc(KBPMN:'Z')))
     C                   callp     updHtmlVar('W2PAR':
     C                             %trim(%editc(KBPÅR:'Z')))
     C                   callp     updHtmlVar('W2KDM':
     C                             %trim(%editc(KBKDM:'3')))
     C                   callp     updHtmlVar('W2BLF':
     C                             %trim(%editc(KBBLF:'L')))
     C                   callp     updHTMLvar('W2KDMV':KBKDMV)
     C                   callp     updHTMLvar('W2BILT':KBBILT)
     C                   callp     updHtmlVar('RECNO':
     C                             %trim(%editc(WBRECNO:'Z')))
      *
     C                   endsr
N16   *=====================================================================******
N16   *  SRVISRE
N16   *=====================================================================******
N16  C     SRVISRE       begsr
N16   *
N16  C     WBRECNO       CHAIN(N)  KOSTBOPD                           33
N16  C                   callp     updHtmlVar('W2AVD':
N16  C                             %trim(%editc(KBAVD:'Z')))
N16  C                   callp     updHtmlVar('W2OPD':
N16  C                             %trim(%editc(KBOPD:'Z')))
N16  C                   callp     updHtmlVar('W2KN':
N16  C                             %trim(%editc(KBKN:'Z')))
N16  C                   callp     updHTMLvar('W2VK':KBVK)
N16  C                   callp     updHTMLvar('W2KDPF':KBKDPF)
N16  C     VALU1K        CHAIN     VALUL01                            33
N16  C                   EVAL(H)   XBBLHB = KBBLHB / KAVKU * OMRFAK
N16  C                   callp     updHtmlVar('W2BLHB':
N16  C                             %trim(%editc(XBBLHB:'L')))
N16  C                   callp     updHtmlVar('W2PMN':
N16  C                             %trim(%editc(KBPMN:'Z')))
N16  C                   callp     updHtmlVar('W2PAR':
N16  C                             %trim(%editc(KBPÅR:'Z')))
N16  C                   callp     updHtmlVar('W2KDM':
N16  C                             %trim(%editc(KBKDM:'3')))
N16  C                   callp     updHtmlVar('W2BLF':
N16  C                             %trim(%editc(KBBLF:'L')))
N16  C                   callp     updHTMLvar('W2KDMV':KBKDMV)
N16  C                   callp     updHTMLvar('W2BILT':KBBILT)
N16  C                   callp     updHtmlVar('RECNO':
N16  C                             %trim(%editc(WBRECNO:'Z')))
N16   *
N16  C                   endsr
      *
      *=====================================================================******
      *  SRVIS2
      *=====================================================================******
     C     SRVIS2        begsr
      *
     C                   callp     updHtmlVar('W2AVD':
     C                             %trim(%editc(W2BAVD:'Z')))
     C                   callp     updHtmlVar('W2OPD':
     C                             %trim(%editc(W2BOPD:'Z')))
     C                   callp     updHtmlVar('W2KN':
     C                             %trim(%editc(W2BKN:'Z')))
     C                   callp     updHTMLvar('W2VK':W2VK)
     C                   callp     updHTMLvar('W2KDPF':W2KDPF)
     C                   callp     updHtmlVar('W2BLHB':
     C                             %trim(%editc(W2BBLHB:'L')))
     C                   callp     updHtmlVar('W2PMN':
     C                             %trim(%editc(W2BPMN:'Z')))
     C                   callp     updHtmlVar('W2PAR':
     C                             %trim(%editc(W2BPAR:'Z')))
     C                   callp     updHTMLvar('W2KDM':W2KDM)
     C                   callp     updHtmlVar('W2BLF':
     C                             %trim(%editc(W2BBLF:'L')))
     C                   callp     updHTMLvar('W2KDMV':W2KDMV)
     C                   callp     updHTMLvar('W2BILT':W2BILT)
     C                   callp     updHtmlVar('RECNO':
     C                             %trim(%editc(WBRECNO:'Z')))
      *
     C                   endsr
      *
      *=====================================================================******
      *  TESTB1
      *=====================================================================******
     C     TESTB1        begsr
     C     VALU1K        CHAIN     VALUL01                            33
     C                   MOVE      KABDT         UBDT              6 0
     C     KAVKU         DIV       OMRFAK        XFAK              9 6
     C     KABL          MULT(H)   XFAK          UBL              13 2
     C     WBBL          MULT(H)   XFAK          WBBL
     C     KAVKU         DIV       OMRFAK        UVKU             10 7
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      'N'           W2ENDRE
     C                   Z-SUB     WBBL          WBBL
     C                   MOVE      UPARM1        UPARM2
      *
     C                   CALL      'SYKS03'
     C                   PARM                    BIFIRM
     C                   PARM                    WBKABNR
     C                   PARM                    UBDT
     C                   PARM                    KAPÅR
     C                   PARM                    KAPMN
     C                   PARM                    KAVK
     C                   PARM                    KAVAL
     C                   PARM                    UVKU             10 7
     C                   PARM                    KABL
     C                   PARM                    KABLM
     C                   PARM                    ULNR              8 0
     C                   PARM                    UBL              13 2
     C                   PARM                    KAMVA             1
     C                   PARM                    KABNR2            7 0
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    UPARM2          512
     C                   MOVE      UPARM2        UPARM1
     C                   Z-SUB     WBBL          WBBL
      *
     C                   IF        UFLAGG = 0
     C                   EVAL      WBBL     = 0
     C                   EVAL      WSVK     = *BLANKS
     C                   EVAL      WSKDPF   = *BLANKS
     C                   EVAL      WSKDM    = *BLANKS
     C                   EVAL      WBPROS   = 0
     C                   EVAL      WSKDMV   = *BLANKS
     C                   EVAL      WBAVD    = 0
     C                   EVAL      WBOPD    = 0
     C                   EVAL      WBPRO    = 0
     C                   EVAL      WSGN17   = *BLANKS
     C                   EVAL      WSBILT   = *BLANKS
     C                   EVAL      WSFRIO   = *BLANKS
     C                   EVAL      WSFR01   = *BLANKS
     C                   EVAL      WSFR02   = *BLANKS
     C                   EVAL      WSFR03   = *BLANKS
     C                   EVAL      WSOTIO   = *BLANKS
     C                   EVAL      WSOT01   = *BLANKS
     C                   EVAL      WSOT02   = *BLANKS
     C                   EVAL      WSOT03   = *BLANKS
     C                   EVAL      WSSKIO   = *BLANKS
     C                   EVAL      WSSK01   = *BLANKS
     C                   EVAL      WSSK02   = *BLANKS
     C                   EVAL      W3PMN    = *blanks
     C                   EVAL      W3PAR    = *blanks
     C                   EVAL      W3BMN    = 0
     C                   EVAL      W3BAR    = 0
     C                   END
      *
     C                   endsr
      *
      *=====================================================================******
      *  TESTB2
      *=====================================================================******
     C     TESTB2        begsr
     C     VALU1K        CHAIN     VALUL01                            33
     C                   MOVE      KABDT         UBDT              6 0
     C     KAVKU         DIV       OMRFAK        XFAK              9 6
     C     KABL          MULT(H)   XFAK          UBL              13 2
s05  C*    W2BBLHB       MULT(H)   XFAK          W2BBLHB
     C     KAVKU         DIV       OMRFAK        UVKU             10 7
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      'J'           W2ENDRE
     C                   MOVE      WBRECNO       W2RECNO
     C                   MOVE      UPARM1        UPARM2
      *
     C                   CALL      'SYKS03'
     C                   PARM                    BIFIRM
     C                   PARM                    WBKABNR
     C                   PARM                    UBDT
     C                   PARM                    KAPÅR
     C                   PARM                    KAPMN
     C                   PARM                    KAVK
     C                   PARM                    KAVAL
     C                   PARM                    UVKU             10 7
     C                   PARM                    KABL
     C                   PARM                    KABLM
     C                   PARM                    ULNR              8 0
     C                   PARM                    UBL              13 2
     C                   PARM                    KAMVA             1
     C                   PARM                    KABNR2            7 0
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    UPARM2          512
     C                   MOVE      UPARM2        UPARM1
      *
     C                   IF        UFLAGG = 1
     C                   EXSR      SRVIS2
     C                   ELSE
     C                   MOVE      'N'           WSENDRE
     C                   END
      *
     C                   endsr
      *
      *=====================================================================******
      *  TESTB3
      *=====================================================================******
     C     TESTB3        begsr
     C                   IF        WBBLDIFF = 0
      *
     C                   IF        KABNR2 = 0
      * HENT ENDELIG BILAGSNR
     C                   callp     gethtml('HTMLSRC':
     C                             '*LIBL':
     C                             'ESKS04':'/CGITAG/')
      *
OddEvC*                  callp     updHTMLvar('ROWHEAD':RowHead)
OddEvC*                  callp     updHTMLvar('LogoImg':LogoImg)
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHTMLvar('INRNR':WSKABNR)
S02  C*                  callp     updHTMLvar('SORT':WSSORT)
S02  C*                  callp     updHTMLvar('INTEG':WSINTEG)
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
     C                   callp     updHTMLvar('EModuls2':WSEMOD2)
N04  C                   callp     updHTMLvar('WSAVVI1':WSAVVI1)
N04  C                   callp     updHTMLvar('WSAVVI2':WSAVVI2)
     C                   callp     updHTMLvar('FERDIGM':'J')
     C                   callp     updhtmlvar('FEILMELDING':' ')
     C                   callp     updhtmlvar('FMELDNR':' ')
s02  C*                  callp     updHTMLvar('KABNR2':
s02  C*                            %trim(%editc(KABNR2:'3')))
      *
     C                   callp     wrtsection('top')
      *
     C                   callp     wrtsection('BSStr')
     C                   callp     updHTMLvar('WSBS1':'')
     C                   callp     updHTMLvar('WSBS2':'-- Velg bilagserie --')
     C                   callp     wrtsection('BSrow')
     C     *LOVAL        SETLL     KOSTT
     C                   READ      KOSTT                                  33
     C                   DOW       *IN33 = *OFF
     C                   callp     updHTMLvar('WSBS1':KTTYP)
     C                   callp     updHTMLvar('WSBS2':KTNA)
     C                   callp     wrtsection('BSrow')
     C                   READ      KOSTT                                  33
     C                   ENDDO
     C                   callp     wrtsection('BSbot')
      *
     C                   callp     updHTMLvar('WSPMN':
     C                             %trim(%editc(KAPMN:'Z')))
     C                   callp     updHTMLvar('WSPAR':
     C                             %trim(%editc(KAPÅR:'Z')))
     C                   callp     updHTMLvar('WSSG':KASG)
     C                   callp     updHTMLvar('WSGEB':KAVK)
     C                   callp     updHTMLvar('WSBL':
     C                             %trim(%editc(KABL:'L')))
     C                   callp     updHTMLvar('WSMVA':KAMVA)
     C                   callp     updHTMLvar('WSBLM':
     C                             %trim(%editc(KABLM:'L')))
     C                   callp     updHTMLvar('WSVKU':
     C                             %trim(%editc(KAVKU:'3')))
     C                   callp     wrtsection('Andre')
      *
     C                   EXSR      DSPVAL
      *
     C                   exsr      Exit
     C                   eval      *inlr = *on
     C                   return
      *
     C                   ELSE
      *
     C*    WBKABNR       CHAIN(N)  KOSTA                              33
     C                   MOVE      KAPMN         W3BMN
     C                   MOVE      KAPÅR         W3BAR
     C     VALU1K        CHAIN     VALUL01                            33
     C                   MOVE      KABDT         UBDT              6 0
     C     KAVKU         DIV       OMRFAK        XFAK              9 6
     C     KABL          MULT(H)   XFAK          UBL              13 2
     C     KAVKU         DIV       OMRFAK        UVKU             10 7
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      'N'           W2ENDRE
     C                   MOVE      UPARM1        UPARM2
      *
     C                   CALL      'SYKS03'
     C                   PARM                    BIFIRM
     C                   PARM                    WBKABNR
     C                   PARM                    UBDT
     C                   PARM                    KAPÅR
     C                   PARM                    KAPMN
     C                   PARM                    KAVK
     C                   PARM                    KAVAL
     C                   PARM                    UVKU             10 7
     C                   PARM                    KABL
     C                   PARM                    KABLM
     C                   PARM                    ULNR              8 0
     C                   PARM                    UBL              13 2
     C                   PARM                    KAMVA             1
     C                   PARM                    KABNR2            7 0
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    UPARM2          512
     C                   MOVE      UPARM2        UPARM1
      *
     C                   IF        UFLAGG = 0
     C     WBKABNR       CHAIN     KOSTA                              33
     C                   IF        *IN33 = *OFF
     C                   MOVE      'G'           KAST
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     USER          KAUSER
     C                   MOVE      WTM           KATME
     C                   MOVE      WDT           KADTE
N10  c     kablst        ifeq      '1'
n10  c                   move      '2'           kablst
n10  c                   end
     C                   UPDATE    KOSTAR
     C                   END
     C                   callp     gethtml('HTMLSRC':
     C                             '*LIBL':
     C                             'ESKS02IC':'/CGITAG/')
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
     C                   callp     wrtsection('top')
     C                   exsr      Exit
     C                   eval      *inlr = *on
     C                   return
     C                   END
      *
     C                   END
      *
     C                   ELSE
     C                   EVAL      UFEILMELDING = FEIL01
      *
     C                   END
      *
     C                   endsr
      *
      *=====================================================================******
      *  DSPVAL
      *=====================================================================******
     C     DSPVAL        begsr
     C                   IF        KAVAL = *BLANKS
     C                   callp     updHTMLvar('WSVAL1':'')
     C                   callp     updHTMLvar('WSVAL2':'-- Velg valuta --')
     C                   callp     wrtsection('VALrow')
     C                   END
     C     BIFIRM        SETLL     VALUL01
     C     BIFIRM        READE     VALUL01                                33
     C                   DOW       *IN33 = *OFF
     C                   IF        KAVAL = VALKOD
     C                   callp     updhtmlvar('VALSEL':'SELECTED')
     C                   else
     C                   callp     updhtmlvar('VALSEL':spaces)
     C                   end
     C                   callp     updHTMLvar('WSVAL1':VALKOD)
     C                   callp     updHTMLvar('WSVAL2':VALTEK)
     C                   callp     wrtsection('VALrow')
     C     BIFIRM        READE     VALUL01                                33
     C                   ENDDO
     C                   callp     wrtsection('VALbot')
      *
     C                   endsr
      *
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
     C                   OPEN      BRIDF
     C     USER          CHAIN     BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
      *
OddEv * hent Parametre som går igjen i mange prog:
OddEv *      Odd/Even/Rowhead-farger,Logobilde,Språk,Intern/Ekstern bruker,  mm
OddEvc                   call      'ESGETPAR'
OddEvc                   parm                    BIBRID
OddEvc                   parm                    BIFIRM
OddEvc                   parm                    BIKUNR
OddEvc                   parm                    BIKNG
OddEvc                   parm                    RowHead          10
OddEvc                   parm                    Odd              10
OddEvc                   parm                    Even             10
OddEvc                   parm                    LogoImg          50
OddEvc                   parm                    XSPRÅK            2
OddEvc                   parm                    XINTERN           1
OddEvc                   parm                    ParmDS1        1024
OddEvc                   parm                    ParmDS2        1024
OddEvc                   parm                    ParmDS3        1024
      *
     C                   OPEN      KOSTA
n04  C                   OPEN      KOSBU12
N09  C                   OPEN      TRACKL08
     C                   OPEN      KOSTB
     C                   OPEN      KOSTT
     C                   OPEN      HEADF
     C                   OPEN      DOKUF
n08  C                   OPEN      TRAN
     C                   OPEN      VALUL01
     C                   EVAL      RC = DOCMD('OVRDBF FILE(KOSTBOPD) +
     C                             TOFILE(*LIBL/KOSTB) SECURE(*YES)')
     C                   OPEN      KOSTBOPD
      *
N09  C     TRAKEY        KLIST
N09  C                   KFLD                    KBAVD
N09  C                   KFLD                    KBOPD
N09  C                   KFLD                    ACTI              3
N09  C                   MOVE      'INC'         ACTI
     C     HEADFK        KLIST
     C                   KFLD                    KBAVD
     C                   KFLD                    KBOPD
n08  C     TRANK         KLIST
n08  c                   KFLD                    BIFIRM
n08  C                   KFLD                    DFTRAN
n08  C     DOKUFK        KLIST
n08  c                   KFLD                    DFKODE            1
n08  C                   KFLD                    KBAVD
n08  C                   KFLD                    KBOPD
n08  c                   move      'F'           DFKODE
     C     VALU1K        KLIST
     C                   KFLD                    BIFIRM
     C                   KFLD                    KAVAL
N04  C     KOSBUK        KLIST
N04  C                   KFLD                    KBAVD
N04  C                   KFLD                    KBOPD
N04  C                   KFLD                    UTXT             35
N04  C                   EVAL      utxt='*fb*001'
      *
     C     WBKABNR       CHAIN(N)  KOSTA                              33
      *
n11  c                   move      *zeros        vekt02
     C                   endsr
      *
n08   ***********************************************
n08  C     BERBUD        BEGSR
n08   ***********************************************
n08  C                   MOVE      DFPNLS        U2PNF             4
n08  C                   MOVE      DFPOUL        U2PNT             4
n08  C                   MOVE      HENT          U2NT              7
n08  C                   MOVE      HEVKT         U2VKT             9
n08  C                   MOVE      HEM3          U2DM3             7
n08  C                   MOVE      DFTRAN        U2KNT             8
n08  C                   MOVE      *ZEROS        U2RAB             3
n08  C                   MOVE      '2'           U2FLAGG           1
n08  C                   MOVE      KBAVD         U2AVD             4
n08  C                   MOVE      KBOPD         U2OPD             7
N08   * LASTEMETR
N08  C*    HELM          IFNE      0
N08  C*    HELM          MULT      VMLMOM        NYVKT             9 0
n08  C*    nyvkt         ifgt      HEVKT
n08  c*                  move      nyvkt         u2vkt
n08  c*                  end
n08  c*                  end
n08  C     HEKNKF        IFNE      *ZEROS
n08  C                   MOVE      HEKNKF        U2KN              8
n08  C                   ELSE
n08  C                   MOVE      HEKNK         U2KN
n08  C                   END
n08  C                   MOVE      DFKNS         U2KNS            12
n08  C                   MOVE      DFTRAN        U2TRAN            8
n08  C                   MOVE      DFPROK        U2PROK            5
n08  C                   CALL      'SYFB05C'
n08  C                   PARM                    U2PNF
n08  C                   PARM                    U2PNT
n08  C                   PARM                    U2NT
n08  C                   PARM                    U2VKT
n08  C                   PARM                    U2DM3
n08  C                   PARM                    U2KNT
n08  C                   PARM                    U2BRTBL           9
n08  C                   PARM                    U2NETBL           9
n08  C                   PARM                    U2RAB
n08  C                   PARM                    U2FLAGG
n08  C                   PARM                    U2AVD
n08  C                   PARM                    U2OPD
n08  C                   PARM                    U2KN
n08  C                   PARM                    U2KNS
n08  C                   PARM                    U2TRAN
n08  C                   PARM                    U2PROK
n08  C                   IF        U2FLAGG = '0'
n08  C                   MOVE      U2NETBL       NYTTBU            9 0
n08  C                   END
n08  C                   ENDSR
      *
