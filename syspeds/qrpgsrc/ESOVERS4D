********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10172 * 01 SH  PTF10 norsk text til Track and trace
********************************************************************
      *********************************************************************
      * OPPDATER DATOER PÅ SYSPED-OPPDRAG
      *********************************************************************
     FHEADF     UF   E           K DISK
     FTRACKT    UF   E           K DISK
     FTRACKF    O  A E             DISK
      *
     C                   EXSR      INIT
      *
     C     TRACKTK       CHAIN     TRACKT                             33
     C                   IF        *IN33 = *OFF
     C                   EXSR      OPDLOG
     C                   MOVE      UETA          TXETAD
     C                   MOVE      UETD          TXETDD
     C                   MOVE      UATA          TXATAD
     C                   MOVE      UATD          TXATDD
     C                   MOVE      UOS01         TXOS01
     C                   MOVE      UOS02         TXOS02
     C                   MOVE      UOS03         TXOS03
     C                   MOVE      UOS04         TXOS04
     C                   MOVE      UOS05         TXOS05
     C                   MOVE      UOS06         TXOS06
     C                   MOVE      UOS07         TXOS07
     C                   UPDATE    TRACKTR
     C                   END
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      *////////////////////////////////////////////////////////////
     C     OPDLOG        BEGSR
      *////////////////////////////////////////////////////////////
      * ETA
     C                   IF        XETA <> TXETAD
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXETAD        XAN08             8
     C                   EVAL      TTTEXT = 'ETA changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UETA) + ' by '
     C                             + %TRIM(UUSER)
N01  C                   EVAL      TTTEXL = 'ETA endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UETA) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * ETD
     C                   IF        XETD <> TXETDD
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXETDD        XAN08
     C                   EVAL      TTTEXT = 'ETD changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UETD) + ' by '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'ETD endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UETD) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * ATA
     C                   IF        XATA <> TXATAD
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXATAD        XAN08             8
     C                   EVAL      TTTEXT = 'ATA changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UATA) + ' by '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'ATA endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UATA) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C     HEADFK        CHAIN     HEADF                              33
     C  N33              MOVE      UATA          TRSDTD
     C  N33              UPDATE    HEADFR
     C                   MOVE      *OFF          *IN33
     C                   END
      * ETD
     C                   IF        XATD <> TXATDD
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXATDD        XAN08
     C                   EVAL      TTTEXT = 'ATD changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UATD) + ' by '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'ATD endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UATD) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * INGEN DATO ENDRING
     C                   IF        ((((XETA = TXETAD) AND
     C                                (XETD = TXETDD)) AND
     C                                (XATA = TXATAD)) AND
     C                                (XATD = TXATDD))
     C                   IF        UEDRE <> *BLANKS
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   EVAL      TTTEXT = 'New information from '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'Ny informasjon fra '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
     C                   END
      * DATO FOR KLAR FRA LEVERANDØR
     C                   IF        XOS01 <> TXOS01
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXOS01        XAN08
     C                   EVAL      TTTEXT = 'Ready date from supplier changed '
     C                             + 'from ' + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UOS01) + ' by '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'Klar dato fra leverandør endret '
n01  C                             + 'fra ' + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UOS01) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * FRIST FOR SHIPPING
     C                   IF        XOS02 <> TXOS02
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXOS02        XAN08
     C                   EVAL      TTTEXT = 'Deadline for shipping changed '
     C                             + 'from ' + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UOS02) + ' by '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'Frist for shipping endret '
n01  C                             + 'fra ' + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UOS02) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * FRIST FOR ANKOMST
     C                   IF        XOS03 <> TXOS03
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXOS03        XAN08
     C                   EVAL      TTTEXT = 'Deadline for arrival changed '
     C                             + 'from ' + %TRIM(XAN08) + ' to '
     C                             + %TRIM(UOS03) + ' by '
     C                             + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'Frist for ankomst endret '
n01  C                             + 'fra ' + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(UOS03) + ' av '
n01  C                             + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * SHIPPING VINDU
     C                   IF        ((XOS04 <> TXOS04) OR (XOS05 <> TXOS05))
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXOS04        XAN08
     C                   MOVE      TXOS05        XAN082            8
     C                   EVAL      TTTEXT = 'Shipping window changed from '
     C                             + %TRIM(XAN08) + '-' + %TRIM(XAN082) + ' to '
     C                             + %TRIM(UOS04) + '-' + %TRIM(UOS05)
     C                             + ' by ' + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'Shipping vindu  endret fra '
n01  C                             + %TRIM(XAN08) + '-' + %TRIM(XAN082) + ' ti'+
n01  C                             'l' + %TRIM(UOS04) + '-' + %TRIM(UOS05)
n01  C                             + ' av ' + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      * ANKOMST VINDU
     C                   IF        ((XOS06 <> TXOS06) OR (XOS07 <> TXOS07))
     C                   MOVE      UAVD          TTAVD
     C                   MOVE      UOPD          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTDEPO = 'ESOVERS4'
     C                   MOVE      UEDRE         TTEDRE
     C                   MOVE      TXOS06        XAN08
     C                   MOVE      TXOS07        XAN082            8
     C                   EVAL      TTTEXT = 'Arrival window changed from '
     C                             + %TRIM(XAN08) + '-' + %TRIM(XAN082) + ' to '
     C                             + %TRIM(UOS06) + '-' + %TRIM(UOS07)
     C                             + ' by ' + %TRIM(UUSER)
n01  C                   EVAL      TTTEXL = 'Ankomst vindu endret fra '
n01  C                             + %TRIM(XAN08) + '-' + %TRIM(XAN082) + ' ti'+
n01  C                             'l' + %TRIM(UOS06) + '-' + %TRIM(UOS07)
n01  C                             + ' av ' + %TRIM(UUSER)
     C                   WRITE     TRACKFR
     C                   END
      *
     C                   ENDSR
      *
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UOPD              7
     C                   PARM                    UEDRE             3
     C                   PARM                    UUSER            10
     C                   PARM                    UETD              8
     C                   PARM                    UATD              8
     C                   PARM                    UETA              8
     C                   PARM                    UATA              8
     C                   PARM                    UOS01             8
     C                   PARM                    UOS02             8
     C                   PARM                    UOS03             8
     C                   PARM                    UOS04             8
     C                   PARM                    UOS05             8
     C                   PARM                    UOS06             8
     C                   PARM                    UOS07             8
      *
     C     TRACKTK       KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XOPD
     C                   KFLD                    TXFBNR
     C     HEADFK        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XOPD
      *
     C                   MOVE      UAVD          XAVD              4 0
     C                   MOVE      UOPD          XOPD              7 0
     C                   MOVE      UETD          XETD              8 0
     C                   MOVE      UATD          XATD              8 0
     C                   MOVE      UETA          XETA              8 0
     C                   MOVE      UATA          XATA              8 0
     C                   MOVE      UOS01         XOS01             8 0
     C                   MOVE      UOS02         XOS02             8 0
     C                   MOVE      UOS03         XOS03             8 0
     C                   MOVE      UOS04         XOS04             8 0
     C                   MOVE      UOS05         XOS05             8 0
     C                   MOVE      UOS06         XOS06             8 0
     C                   MOVE      UOS07         XOS07             8 0
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   ENDSR
      *
