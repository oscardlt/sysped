      ************************************************************
      *** UTSKRIFT AV OPPDRAGS-STATISTIKK EKSTERN/INTERN       ***
      ************************************************************
     FFIRM      IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FSYST01FM  CF   E             WORKSTN
      *
      * DS. FOR PARAMETER 1...
     D                 DS
     D  DSUTV1                 1    256
     D  WSDTF                  2      7  0
     D  WSDTFÅ                 2      3  0
     D  WSDTFM                 4      5  0
     D  WSDTFD                 6      7  0
     D  WSDTT                  8     13  0
     D  WSDTTÅ                 8      9  0
     D  WSDTTM                10     11  0
     D  WSDTTD                12     13  0
     D  WSBEL                 14     14
     D  WSOTIO                15     15
     D  WSOT01                16     17
     D  WSOT02                18     19
     D  WSOT03                20     21
     D  WSOT04                22     23
     D  WSOT05                24     25
     D  WSOT06                26     27
     D  WSOT07                28     29
     D  WSOT08                30     31
     D  WSOT09                32     33
     D  WSOT10                34     35
     D  IOT                   16     35
     D  IOT310                20     35
     D*
     D  WSFRIO                36     36
     D  WSFR01                37     39
     D  WSFR02                40     42
     D  WSFR03                43     45
     D  WSFR04                46     48
     D  WSFR05                49     51
     D  WSFR06                52     54
     D  WSFR07                55     57
     D  WSFR08                58     60
     D  WSFR09                61     63
     D  WSFR10                64     66
     D  IFR                   37     66
     D  IFR310                43     66
     D*
     D  WSAVIO                67     67
     D  WSAV01                68     71  0
     D  WSAV02                72     75  0
     D  WSAV03                76     79  0
     D  WSAV04                80     83  0
     D  WSAV05                84     87  0
     D  WSAV06                88     91  0
     D  WSAV07                92     95  0
     D  WSAV08                96     99  0
     D  WSAV09               100    103  0
     D  WSAV10               104    107  0
     D  IAV                   68    107
     D  IAV310                76    107
     D* KUNDENR FAKT.MOT.
     D  WSFKIO               108    108
     D  WSFK01               109    116  0
     D  WSFK02               117    124  0
     D  WSFK03               125    132  0
     D  WSFK04               133    140  0
     D  WSFK05               141    148  0
     D  WSFK06               149    156  0
     D  WSFK07               157    164  0
     D  WSFK08               165    172  0
     D  WSFK09               173    180  0
     D  WSFK10               181    188  0
     D  IFK                  109    188
     D  IFK310               125    188
     D*
     D  WSLKIO               189    189
     D  WSLK01               190    191
     D  WSLK02               192    193
     D  WSLK03               194    195
     D  WSLK04               196    197
     D  WSLK05               198    199
     D  WSLK06               200    201
     D  WSLK07               202    203
     D  WSLK08               204    205
     D  WSLK09               206    207
     D  WSLK10               208    209
     D  ILK                  190    209
     D  ILK310               194    209
     D*
     D  WSURIO               210    210
     D  WSUR01               211    211
     D  WSUR02               212    212
     D  WSUR03               213    213
     D  WSUR04               214    214
     D  WSUR05               215    215
     D  WSUR06               216    216
     D  WSUR07               217    217
     D  WSUR08               218    218
     D  WSUR09               219    219
     D  WSUR10               220    220
     D  IUR                  211    220
     D  IUR310               213    220
      *
     D  WSLAYO               246    250
     D  WSTYPE               251    255
     D* PARAMETER SOM DATASTRUKTUR MAN IKKE AVSLUTTE MED BLANK.....
     D  DUMMY1               256    256
      *
     D* DS. FOR PARAMETER 2...
     D                 DS
     D  DSUTV2                 1    256
     D  WSFSIO                10     10
     D  WSFS01                11     15
     D  WSFS02                16     20
     D  WSFS03                21     25
     D  WSFS04                26     30
     D  WSFS05                31     35
     D  WSFS06                36     40
     D  WSFS07                41     45
     D  WSFS08                46     50
     D  WSFS09                51     55
     D  WSFS10                56     60
     D  IFS                   11     60
     D  IFS310                21     60
     D* TIL-STED
     D  WSTSIO                61     61
     D  WSTS01                62     66
     D  WSTS02                67     71
     D  WSTS03                72     76
     D  WSTS04                77     81
     D  WSTS05                82     86
     D  WSTS06                87     91
     D  WSTS07                92     96
     D  WSTS08                97    101
     D  WSTS09               102    106
     D  WSTS10               107    111
     D  ITS                   62    111
     D  ITS310                72    111
     D* KUNDENR "PART" (KJØPER/SELGER)
     D  WSKNIO               112    112
     D  WSKN01               113    120  0
     D  WSKN02               121    128  0
     D  WSKN03               129    136  0
     D  WSKN04               137    144  0
     D  WSKN05               145    152  0
     D  WSKN06               153    160  0
     D  WSKN07               161    168  0
     D  WSKN08               169    176  0
     D  WSKN09               177    184  0
     D  WSKN10               185    192  0
     D  IKN                  113    192
     D  IKN310               129    192
     D* FLYSELSKAP
     D  WSFLIO               193    193
     D  WSFL01               194    196  0
     D  WSFL02               197    199  0
     D  WSFL03               200    202  0
     D  WSFL04               203    205  0
     D  WSFL05               206    208  0
     D  WSFL06               209    211  0
     D  WSFL07               212    214  0
     D  WSFL08               215    217  0
     D  WSFL09               218    220  0
     D  WSFL10               221    223  0
     D  IFL                  194    226
     D  IFL310               200    226
     D* PARAMETER SOM DATASTRUKTUR MAN IKKE AVSLUTTE MED BLANK.....
     D  DUMMY2               256    256
     I*
     C*
     C                   EXSR      INIT
      *
     C     STB01         TAG
     C                   EXFMT     BILDE01
      *
     C     *IN03         IFEQ      '1'
     C     *IN12         OREQ      '1'
     C                   MOVE      '1'           UIN01
     C                   GOTO      SLUTT
     C                   END
      * SØK
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØK
     C                   GOTO      STB01
     C                   END
      * TEST UTVALGSBILDE...
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
     C                   GOTO      STB01
     C                   END
      *
      * AVD GITT - RETT TIL FERDIGUTFYLT PRITERBILDE
     C     WSVAVD        IFNE      *ZEROS
     C                   GOTO      STB022
     C                   END
      *
      *
     C* ØVRE HALVDEL AV PRINTERBILDE (AVD)
     C     STB02         TAG
     C                   SETON                                        50        IKKE VIS NEDRE DEL.
     C                   EXFMT     BILDE02
     C* UTVALGSBILDET??
     C   12              DO
     C                   GOTO      STB01
     C                   END
      *
     C* HENT PRINTERSTYRING / VIS NEDRE HALVDEL AV PRINTERBILDE
     C     STB022        TAG
     C                   MOVEA     '000'         *IN(97)
     C                   SETOFF                                       30
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C   12              MOVE      '1'           UIN01
     C   12              GOTO      SLUTT
     C*
     C     KODTVK        CHAIN     KODTV                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      STB02
     C*
     C     KODSFK        CHAIN     KODTSF                             98
     C   98              MOVE      'SPS0001'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      STB02
     C*
     C* HENTER STANDARD PRINTERSTYRING
     C*
     C     WSLAYO        IFEQ      'A4   '
     C                   Z-ADD     998           PRTNR             3 0
     C                   ELSE
     C                   Z-ADD     999           PRTNR
     C                   END
     C                   CALL      'SYGE01'
     C                   PARM                    WSVAVD
     C                   PARM                    PRTNR
     C                   PARM                    WSPRT
     C                   PARM                    WSFORM
     C                   PARM                    WSHEAD            1
     C                   PARM                    WKOPFM            5
     C*
     C                   SETOFF                                       50         VIS NEDRE DEL
     C                   EXFMT     BILDE02
     C* NY AVD??
     C   12              DO
     C                   MOVEA     '000'         *IN(97)
     C                   MOVE      *BLANKS       WSPRT
     C                   MOVE      *BLANKS       WSFORM
     C                   GOTO      STB02
     C                   END
     C   03              DO
     C                   MOVE      '1'           UIN01
     C                   GOTO      SLUTT
     C                   END
      *
      * OK - FLYTT UTVALG TIL DS.
     C                   MOVE      WSVAVD        UUVAVD                          *ALPHA
     C                   MOVE      DSUTV1        UTVAL1
     C                   MOVE      DSUTV2        UTVAL2
      *
     C                   MOVEL     'STAT_'       STTYPE
     C                   MOVE      WSTYPE        STTYPE
      *
      *
     C     SLUTT         TAG
      * RETURNER AVDELING I PARAMETER (->LDA)
     C                   MOVE      WSVAVD        UUVAVD                         *NUMERIC
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      * *****************************************
     C     INIT          BEGSR
      * """"""""""""""""""""""""""""""""""""""""""
     C*
     C     *ENTRY        PLIST
     C     UIN01         PARM      UIN01         UIN01             1
     C     UUVAVD        PARM      UUVAVD        UUVAVD            4            *ALPHA
     C     WSSFSI        PARM      WSSFSI        WSSFSI
     C     WSJOBQ        PARM      WSJOBQ        WSJOBQ
     C     WSPRT         PARM      WSPRT         WSPRT
     C     WSFORM        PARM      WSFORM        WSFORM
     C     WSANTK        PARM      WSANTK        WSANTK
     C     STTYPE        PARM      STTYPE        STTYPE           10
     C     UTVAL1        PARM      UTVAL1        UTVAL1          256
     C     UTVAL2        PARM      UTVAL2        UTVAL2          256
     C*
     C     KODSFK        KLIST
     C                   KFLD                    WSSFUN
     C                   KFLD                    WSSFSI
     C                   MOVE      'SF'          WSSFUN            2
     C     KODTVK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    WSVAVD
     C                   MOVE      'V'           WSVUNI            1
     C     TYPKEY        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'ST01TYPE'    KFTYP
      * INITIER DATASTRUKTUR
     C                   MOVE      *ZEROS        WSDTF
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        IAV                             *I/O AVD
     C                   MOVE      *ZEROS        IFK                             *I/O F.KUND
     C                   MOVE      *ZEROS        IKN                             *I/O PARTKN
     C                   MOVE      *ZEROS        IFL                             *I/O FLYSEL
     C                   MOVE      'X'           DUMMY1
     C                   MOVE      'X'           DUMMY2
     C* DEFAULTER...
     C                   MOVE      *BLANKS       KFTXT
     C                   MOVE      'N'           WSBEL
     C                   MOVE      '1'           WSANTK
     C                   MOVEL     '*STD '       WSLAYO
     C*
     C                   MOVE      '0'           UIN01
     C*
     C     UUVAVD        IFGT      '0000'
     C     UUVAVD        ANDLE     '9999'
     C                   MOVE      UUVAVD        WSVAVD                         *NUMERIC
     C                   ELSE
     C                   MOVE      *ZEROS        WSVAVD
     C                   END
      *
      *
     C                   READ      FIRM                                   98
      *
     C                   ENDSR
      *
     C************************************************
     C     SØK           BEGSR
      *"""""""""""""""""""""""""""""""""""""""""""""""
      * FORELØPIG KUN PÅ TYPE...
      *
     C                   MOVE      'N'           KDUPD             1
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KDUPD         IFNE      'X'
     C                   MOVEL     KFKOD         WSTYPE
     C     TYPKEY        CHAIN     KOFAST                             42
     C     *IN42         IFEQ      '1'
     C                   MOVE      *BLANKS       KFTXT
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *
      *
     C************************************************
     C     TESTB1        BEGSR
      *"""""""""""""""""""""""""""""""""""""""""""""""
      *
     C                   MOVE      '0'           *IN30
      *
     C                   MOVEA     '00000000'    *IN(40)
      *
     C                   MOVEL     WSTYPE        KFKOD
     C     TYPKEY        CHAIN     KOFAST                             42
     C     *IN42         IFEQ      '1'
     C                   MOVE      *BLANKS       KFTXT
     C                   MOVE      '1'           *IN30
     C                   GOTO      UTTST1
     C                   END
      * Dato format
     C                   MOVE      WSDTFÅ        UÅÅ               2 0
     C                   MOVE      WSDTFM        UMM               2 0
     C                   MOVE      WSDTFD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      WSDTTÅ        UÅÅ               2 0
     C                   MOVE      WSDTTM        UMM               2 0
     C                   MOVE      WSDTTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      41
     C     *IN40         IFEQ      '1'
     C     *IN41         OREQ      '1'
     C                   MOVE      '1'           *IN30
     C                   GOTO      UTTST1
     C                   END
      * Dato fra ikke større enn til.
     C     WSDTF         IFGT      501231
     C     WSDTF         ADD       19000000      WSDTF8            8 0
     C                   ELSE
     C     WSDTF         ADD       20000000      WSDTF8
     C                   END
     C     WSDTT         IFGT      501231
     C     WSDTT         ADD       19000000      WSDTT8            8 0
     C                   ELSE
     C     WSDTT         ADD       20000000      WSDTT8
     C                   END
     C     WSDTF8        COMP      WSDTT8                             41
     C     *IN41         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   GOTO      UTTST1
     C                   END
      *
      *  FEILTESTING SLUTT (RESTEN UTFØRES SELV VED FEIL)
      *
     C     UTTST1        TAG
      *
      *       Hvis koder angitt, men Blank Incl/Omit - Default til "I"
      *
     C     IAV           IFNE      *ZEROS
     C     WSAVIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSAVIO
     C                   END
     C     WSAVIO        IFEQ      'F'
     C                   MOVE      *ZEROS        IAV310
     C                   END
     C                   END
      *
     C     IFK           IFNE      *ZEROS
     C     WSFKIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSFKIO
     C                   END
     C     WSFKIO        IFEQ      'F'
     C                   MOVE      *ZEROS        IFK310
     C                   END
     C                   END
      *
     C     IKN           IFNE      *ZEROS
     C     WSKNIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSKNIO
     C                   END
     C     WSKNIO        IFEQ      'F'
     C                   MOVE      *ZEROS        IKN310
     C                   END
     C                   END
      *
     C     IOT           IFNE      *BLANKS
     C     WSOTIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSOTIO
     C                   END
     C     WSOTIO        IFEQ      'F'
     C                   MOVE      *BLANKS       IOT310
     C                   END
     C                   END
      *
     C     IFR           IFNE      *BLANKS
     C     WSFRIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSFRIO
     C                   END
     C     WSFRIO        IFEQ      'F'
     C                   MOVE      *BLANKS       IFR310
     C                   END
     C                   END
      *
     C     ILK           IFNE      *BLANKS
     C     WSLKIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSLKIO
     C                   END
     C     WSLKIO        IFEQ      'F'
     C                   MOVE      *BLANKS       ILK310
     C                   END
     C                   END
      *
     C     IFS           IFNE      *BLANKS
     C     WSFSIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSFSIO
     C                   END
     C     WSFSIO        IFEQ      'F'
     C                   MOVE      *BLANKS       IFS310
     C                   END
     C                   END
      *
     C     ITS           IFNE      *BLANKS
     C     WSTSIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSTSIO
     C                   END
     C     WSTSIO        IFEQ      'F'
     C                   MOVE      *BLANKS       ITS310
     C                   END
     C                   END
      *
     C     IFL           IFNE      *ZEROS
     C     WSFLIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSFLIO
     C                   END
     C     WSFLIO        IFEQ      'F'
     C                   MOVE      *ZEROS        IFL310
     C                   END
     C                   END
      *
     C     IUR           IFNE      *BLANKS
     C     WSURIO        IFEQ      *BLANKS
     C                   MOVE      'I'           WSURIO
     C                   END
     C     WSURIO        IFEQ      'F'
     C                   MOVE      *BLANKS       IUR310
     C                   END
     C                   END
      *
     C                   ENDSR
