      *
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE EKSPRESSFORT. DEFAULT (HODE)***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-02 06-08 10 11 13-26
      *** LEDIGE INDIKATORER 27-29 31 32 34-47 50-79          ***
      ***********************************************************
      *
     FSADEFDEF  UF A E           K DISK
     FTELL      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTTST   IF   E           K DISK
     FSAD139D   CF   E             WORKSTN INFDS(FBAREA)
     D                SDS
     D  UUSR                 254    263
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSETAD                 1      2  0
     D  WSETAM                 3      4  0
     D  WSETAA                 5      6  0
     D  WSETA                  1      6  0
     D                 DS
     D  EFETAA                 1      4  0
     D  EFETAM                 5      6  0
     D  EFETAD                 7      8  0
     D  EFETA                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRA                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  EFDTRA                 1      4  0
     D  EFDTRM                 5      6  0
     D  EFDTRD                 7      8  0
     D  EFDTR                  1      8  0
     D                 DS
     D  WSSJADTD               1      2  0
     D  WSSJADTM               3      4  0
     D  WSSJADTA               5      6  0
     D  WSSJADT                1      6  0
     D                 DS
     D  EFSJADTA               1      4  0
     D  EFSJADTM               5      6  0
     D  EFSJADTD               7      8  0
     D  EFSJADT                1      8  0
     D                 DS
     D  WSETMH                 1      2  0
     D  WSETMM                 3      4  0
     D  WSETMS                 5      6  0
     D  WSETM                  1      6  0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
      *...............................................
      * BILDE-1 INNLESING AV HOVED OPPLYSNINGER AV TUR
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '00000'       *IN(83)
     C                   SETOFF                                       30
      *
     C   03              GOTO      SLUTT
      *
      *  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
      *  12 = AVBRYT
     C   12              GOTO      SLUTT
      *
     C                   IF        *IN49 = *OFF                                 IKKE VISNINGSMODUS
      * ----------- T E S T   B I L D E 0 1 ----------
     C                   EXSR      TESTB1
     C   30              GOTO      START
      *
     C                   EXSR      OPDTUR
     C                   END
      *
     C     SLUTT         TAG
     C                   SELECT
     C                   WHEN      *IN03
     C                   EVAL      UFLAGG = 3
     C                   WHEN      *IN12
     C                   EVAL      UFLAGG = 1
     C                   OTHER
     C                   EVAL      UFLAGG = 0
     C                   ENDSL
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * SØK DEKLARANT
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     27
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKND
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAD
     C                   IF        WSKND <> 0
     C                   EXSR      TESTD
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     22
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     21
     C                   CALL      'SYFI10L'
     C                   PARM                    WSKLK
     C                   PARM                    USPED
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     21
     C                   CALL      'SYFI10L'
     C                   PARM                    WSPLK
     C                   PARM                    USPED
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     23
     C                   CALL      'SAD061J'
     C                   PARM                    WSTSD
     C                   Z-ADD     44            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *
      *** TEST AVDELING
     C  N48WSAVD         CHAIN     TELL                               99
      *
      *** TEST DEKLARANT
     C     WSKND         IFNE      0
     C                   EXSR      TESTD
     C                   END
      *
     C*    WSRGD         COMP      *BLANKS                                97
      *
     C                   SELECT
     C                   WHEN      WSTM = 'BIL'
     C                   EVAL      WSTMT = '(30) Bil (veitransport)'
     C                   OTHER
     C*                  EVAL      *IN96 = *ON
     C                   ENDSL
      *
     C                   SELECT
     C                   WHEN      WSKTYP = '01'
     C                   EVAL      WSKTYPT = 'VEHICLE_WITH_TRAILER'
     C                   WHEN      WSKTYP = '02'
     C                   EVAL      WSKTYPT = 'VEHICLE_WITH_SEMI_TRAILER_AND_'
     C                             + 'TRAILER'
     C                   WHEN      WSKTYP = '03'
     C                   EVAL      WSKTYPT = 'VEHICLE_WITHOUT_TRAILER'
     C                   WHEN      WSKTYP = '04'
     C                   EVAL      WSKTYPT = 'VEHICLE_WITHOUT_TRAILER'
     C                   OTHER
     C*                  EVAL      *IN95 = *ON
     C                   ENDSL
      *
     C                   IF        WSKLK <> *BLANKS
     C     KODTS2KK      CHAIN     KODTS2                             94
     C                   END
     C*    WSKMRK        COMP      *BLANKS                                93
      *
     C                   IF        WSPLK <> *BLANKS OR WSPMRK <> *BLANKS
     C     KODTS2KP      CHAIN     KODTS2                             92
     C     WSPMRK        COMP      *BLANKS                                91
     C                   END
      *
     C*    WSSJAF        COMP      *BLANKS                                90
     C*    WSSJAE        COMP      *BLANKS                                89
     C                   IF        WSSJALK <> *BLANKS
     C     KODTS2KS      CHAIN     KODTS2                             88
     C                   END
      *
     C                   IF        WSSJADT <> 0
     C                   MOVE      WSSJADTA      XAR               2 0
     C                   MOVE      WSSJADTM      XMN               2 0
     C                   MOVE      WSSJADTD      XDG               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDG
     C                   PARM                    XMN
     C                   PARM                    XAR
     C                   PARM                    FLAGG             1 0
     C     FLAGG         COMP      1                                      87
     C                   END
      *
      *
     C                   IF        WSETA <> 0
     C                   MOVE      WSETAA        XAR               2 0
     C                   MOVE      WSETAM        XMN               2 0
     C                   MOVE      WSETAD        XDG               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDG
     C                   PARM                    XMN
     C                   PARM                    XAR
     C                   PARM                    FLAGG             1 0
     C     FLAGG         COMP      1                                      86
     C                   END
      *
     C                   IF        WSETMH >= 24 OR WSETMM >= 60
     C                             OR WSETMS >= 60
     C                   EVAL      *IN85 = *ON
     C                   END
      *
     C     KODTTSTK      CHAIN     KODTTST                            84
      *
     C     WS3039E       COMP      0                                      83
      *
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG          BEGSR
      ***********************************************
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              DO
     C                   SETON                                        30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     7             POSNBR
     C                   END
     C   98
     CANN30              DO
     C                   MOVE      'YBC2037'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   97
     CANN30              DO
     C                   MOVE      'YBC2038'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     39            POSNBR
     C                   END
     C   96
     CANN30              DO
     C                   MOVE      'YBC2082'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   95
     CANN30              DO
     C                   MOVE      'YBC2083'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   94
     CANN30              DO
     C                   MOVE      'YBC2084'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   93
     CANN30              DO
     C                   MOVE      'YBC2085'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     38            POSNBR
     C                   END
     C   92
     CANN30              DO
     C                   MOVE      'YBC2086'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   91
     CANN30              DO
     C                   MOVE      'YBC2087'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     38            POSNBR
     C                   END
     C   90
     CANN30              DO
     C                   MOVE      'YBC2088'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   89
     CANN30              DO
     C                   MOVE      'YBC2089'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   88
     CANN30              DO
     C                   MOVE      'YBC2090'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   87
     CANN30              DO
     C                   MOVE      'YBC2091'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     38            POSNBR
     C                   END
     C   86
     CANN30              DO
     C                   MOVE      'YBC2092'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   85
     CANN30              DO
     C                   MOVE      'YBC2093'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     36            POSNBR
     C                   END
     C   84
     CANN30              DO
     C                   MOVE      'SPK0042'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C   83
     CANN30              DO
     C                   MOVE      'YBC2097'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     44            POSNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVEFW        BEGSR
      ***********************************************
     C                   MOVE      EFAVD         WSAVD
     C                   MOVE      EFDTRD        WSDTRD
     C                   MOVE      EFDTRM        WSDTRM
     C                   MOVE      EFDTRA        WSDTRA
      *
     C                   MOVE      EFKND         WSKND
     C                   MOVE      WSKND         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            98
     C  N33              MOVE      KNAVN         WSNAD
     C   33              MOVE      *BLANKS       WSNAD
     C                   MOVE      EFRGD         WSRGD
     C                   MOVE      EFTSD         WSTSD
     C                   MOVE      EF3039E       WS3039E
     C                   MOVE      EFEID         WSEID
     C                   MOVE      EFTM          WSTM
     C                   MOVE      EFTMT         WSTMT
     C                   MOVE      EFKTYP        WSKTYP
     C                   MOVE      EFKTYPT       WSKTYPT
     C                   MOVE      EFKLK         WSKLK
     C                   MOVE      EFKMRK        WSKMRK
     C                   MOVE      EFPLK         WSPLK
     C                   MOVE      EFPMRK        WSPMRK
     C                   MOVE      EFSJAF        WSSJAF
     C                   MOVE      EFSJAE        WSSJAE
     C                   MOVE      EFSJALK       WSSJALK
     C                   MOVE      EFSJADTD      WSSJADTD
     C                   MOVE      EFSJADTM      WSSJADTM
     C                   MOVE      EFSJADTA      WSSJADTA
     C                   MOVE      EFBEKR        WSBEKR
     C                   MOVE      EFETAD        WSETAD
     C                   MOVE      EFETAM        WSETAM
     C                   MOVE      EFETAA        WSETAA
     C                   MOVE      EFETM         WSETM
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWEF        BEGSR
      ***********************************************
     C                   MOVE      WSDTRD        EFDTRD
     C                   MOVE      WSDTRM        EFDTRM
     C                   EVAL      EFDTRA = 2000 + WSDTRA
     C                   MOVE      WSKND         EFKND
     C                   MOVE      WSRGD         EFRGD
     C                   MOVE      WSTSD         EFTSD
     C                   MOVE      WS3039E       EF3039E
     C                   MOVE      WSEID         EFEID
     C                   MOVE      WSTM          EFTM
     C                   MOVE      WSTMT         EFTMT
     C                   MOVE      WSKTYP        EFKTYP
     C                   MOVE      WSKTYPT       EFKTYPT
     C                   MOVE      WSKLK         EFKLK
     C                   MOVE      WSKMRK        EFKMRK
     C                   MOVE      WSPLK         EFPLK
     C                   MOVE      WSPMRK        EFPMRK
     C                   MOVE      WSSJAF        EFSJAF
     C                   MOVE      WSSJAE        EFSJAE
     C                   MOVE      WSSJALK       EFSJALK
     C                   MOVE      WSSJADTD      EFSJADTD
     C                   MOVE      WSSJADTM      EFSJADTM
     C                   EVAL      EFSJADTA = 2000 + WSSJADTA
     C                   MOVE      WSBEKR        EFBEKR
     C                   MOVE      WSETAD        EFETAD
     C                   MOVE      WSETAM        EFETAM
     C                   EVAL      EFETAA = 2000 + WSETAA
     C                   MOVE      WSETM         EFETM
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTD         BEGSR
      ***********************************************
     C                   MOVE      WSKND         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            98
     C  N98kundnr        comp      0                                      98
     C  N98              DO
     C                   MOVE      KNAVN         WSNAD
     C                   IF        SYFOR9 <> *ZEROS
     C                   EVAL      WSRGD = SYRG
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDTUR        BEGSR
      ***********************************************
      *
      * henter neste nummer
      *
     C     WSAVD         CHAIN     SADEFDEF                           33
      *
      * FLYTTER SKJERMVARIABLE TIL FILVARIABLE
      *
     C                   EXSR      MOVWEF
      *
      * 33 ER PÅ VED NY TUR
      *
     C                   IF        *IN33                                        1<-B
     C                   EVAL      EFAVD  = WSAVD
     C                   MOVE      WDT           EFDTR
     C                   WRITE     SADEFDEFR
     C                   ELSE
     C                   UPDATE    SADEFDEFR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTS2KK      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSKLK
     C     KODTS2KP      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSPLK
     C     KODTS2KS      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSSJALK
     C     KODTTSTK      KLIST
     C                   KFLD                    KTSUNI
     C                   KFLD                    WSTSD
      *
     C     *LIKE         DEFINE    EFAVD         UAVD
     C     *LIKE         DEFINE    EFPRO         UPRO
     C     *LIKE         DEFINE    EFSG          USG
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVE      'N'           USPED             1
     C                   EVAL      KS2UNI  = 'S2'
     C                   EVAL      KTSUNI  = 'TST'
     C                   EVAL      WSDTR  = 0
     C                   EVAL      WSETA   = 0
     C                   EVAL      WSSJADT = 0
     C                   EVAL      EFDTR  = 0
     C                   EVAL      EFETA   = 0
     C                   EVAL      EFSJADT = 0
      *
     C     UTYPE         COMP      'DSP'                                  49
     C     UTYPE         COMP      'CHG'                                  48
      *
     C                   EVAL      WSAVD  = UAVD
     C     UAVD          CHAIN     TELL                               33
     C  N33              EVAL      EFPRO = TETURN
     C     UAVD          CHAIN(N)  SADEFDEF                           33
     C                   IF        *IN33
     C                   EVAL      EFDTR  = 0
     C                   EVAL      EFETA   = 0
     C                   EVAL      EFSJADT = 0
     C                   END
     C                   EXSR      MOVEFW
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
