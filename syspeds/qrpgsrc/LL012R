********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 OPSJON D = VIS SAMMENSLÅINGS DETALJE
11XXX * 02 YBC PTF11 TELL ANTALL LOKASJONER
11XXX * 03 JOV PTF11 ENDRING AV LINJE M 0 I ANTALL, SETT ANT LOC=0 (AUTOSKAPT FEIL)
11XXX * 04 YBC PTF11 SETT STATUS I PÅ SERIENR VED SLETTING AV LINJE
********************************************************************
     FLL012D    CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(STATDS)
     FLLLINE    UF A E           K DISK
     FLLLINE01  IF   E           K DISK
     F                                     RENAME(LLLINER:LLLINER1)
     FLLHEAD    UF   E           K DISK
     FLLVARE01  IF   E           K DISK
     FLLSERL02  UF   E           K DISK
     FKUFAST    IF   E           K DISK
     FLLAGJS03  IF   E           K DISK
     D                 DS
     D  XPOSTN                 1      4
     D  PN                     1      4
     D                                     DIM(4)
     D                 DS
     D  LLANR                  1     15
     D  SLETT                  1      6
     D                 DS
     D  LLVB                   1     35
     D  XLVB                   1      6
     D                 DS
     D  XXADR                  1     50
     D  XXADR1                 1     25
     D  XXADR2                27     30
     D  XXADR3                32     50
     D                 DS
     D  LLLOK                  1     25
     D  LLLOK1                 1      5
     D  LLLOK2                 6     25
     D                 DS
     D  WSLOK                  1     25
     D  WSLOK1                 1      5
     D  WSLOK2                 6     25
     D                 DS
     D  WSPRDT                 1      8  0
     D  WSPRDTÅ                1      4  0
     D  WSPRDTM                5      6  0
     D  WSPRDTD                7      8  0
     D STATDS          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
      *
     C                   EXSR      INIT
     C                   EXSR      HOVED
     C                   EXSR      SUMTOT
     C                   MOVE      '1'           *INLR
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
     C     *ENTRY        PLIST
     C                   PARM                    UMN               7 0
     C                   PARM                    UFIRM             2
     C                   PARM                    UNAVN            30
     C                   PARM                    UANT0
     C                   PARM                    UANTL
     C                   PARM                    UAEH1
     C                   PARM                    UANT1
     C                   PARM                    UAEH2
     C                   PARM                    UANT2
     C                   PARM                    UAEH3
     C                   PARM                    UANT3
     C                   PARM                    UVEK
     C                   PARM                    UKUB
     C                   PARM                    UTLIN
     C                   PARM                    UKONTR            1
      *
      * IND. 49 PÅ --> KUN VISE LINJER
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      49
     C                   MOVE      *ZEROS        UFLAGG
      *
     C     *LIKE         DEFINE    ZRECNO        XRECNO
     C     *LIKE         DEFINE    ZRECNO        XKRECN
     C     *LIKE         DEFINE    POSNBR        XPNBR
     C     *LIKE         DEFINE    LHGRP         LHGRP0
     C     *LIKE         DEFINE    LLVN          XSISTN
     C     *LIKE         DEFINE    LLANT0        UANT0
     C     *LIKE         DEFINE    LLANTL        UANTL
     C     *LIKE         DEFINE    LLAEH1        UAEH1
     C     *LIKE         DEFINE    LLANT1        UANT1
     C     *LIKE         DEFINE    LLAEH2        UAEH2
     C     *LIKE         DEFINE    LLANT2        UANT2
     C     *LIKE         DEFINE    LLAEH3        UAEH3
     C     *LIKE         DEFINE    LLANT3        UANT3
     C     *LIKE         DEFINE    LLWVEK        UVEK
     C     *LIKE         DEFINE    LLWKUB        UKUB
     C     *LIKE         DEFINE    LLWVEK        UWVEK
     C     *LIKE         DEFINE    LLWKUB        UWKUB
     C     *LIKE         DEFINE    LHTLIN        UTLIN
     C     *LIKE         DEFINE    LLWNT0        XWNT0
     C     *LIKE         DEFINE    LLWNT0        XLWNT0
     C     *LIKE         DEFINE    LLWNTL        XWNTL
     C     *LIKE         DEFINE    LLWNT1        XWNT1
     C     *LIKE         DEFINE    LLWNT2        XWNT2
     C     *LIKE         DEFINE    LLWNT3        XWNT3
     C     *LIKE         DEFINE    LLWVEK        XWVEK
     C     *LIKE         DEFINE    LLWKUB        XWKUB
     C     *LIKE         DEFINE    LHGRP         UGRP
     C     *LIKE         DEFINE    LHPNR         UPNR
     C     *LIKE         DEFINE    LVANR         UANR
     C     *LIKE         DEFINE    LLVN          UVN
     C     *LIKE         DEFINE    LLWNT0        UWNT0
     C     *LIKE         DEFINE    LLWNT0        UWNTL
     C     *LIKE         DEFINE    LLWNT1        UWNT1
     C     *LIKE         DEFINE    LLWNT2        UWNT2
     C     *LIKE         DEFINE    LLWNT3        UWNT3
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     LLLINK        KLIST
     C                   KFLD                    UMN
     C                   KFLD                    LLVN
     C     LLVARK        KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    WSANR
     C     LLVA2K        KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    LLANR
     C     LLVGRK        KLIST
     C                   KFLD                    LHGRP0
     C                   KFLD                    LHPNR
     C                   KFLD                    WSANR
     C     LLAGSK        KLIST
     C                   KFLD                    LVGRUP
     C                   KFLD                    LVPNR
     C                   KFLD                    LVANR
     C     LLSE2K        KLIST
     C                   KFLD                    LLMN
     C                   KFLD                    LLVN
     C     KUFASTK       KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    WSMKD
     C                   EVAL      KFTYP = 'LAGERPLMAN'
      *
     C     UMN           CHAIN(N)  LLHEAD                             33
     C                   MOVEL     LHBNA         XXADR1
     C                   MOVEL     LHBPN         XXADR2
     C                   MOVEL     LHBA3         XXADR3
     C                   MOVE      'S'           UMODE             1
     C                   MOVE      LHGRP         UGRP8             8
     C                   MOVE      LHPNR         UPNR8             8
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     HOVED         BEGSR
      *////////////////////////////////////////////////////////////
      *______________
      * Tømme Subfile
      *""""""""""""""
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '000'         *IN(93)
     C                   Z-ADD     *ZERO         ZRECNO
     C                   MOVE      *ZEROS        XKRECN
     C                   MOVE      *ZEROS        XSISTN
     C                   MOVE      *ZEROS        XPNBR
N02  C                   MOVE      *ZEROS        XANTLOK           5 0
     C  N41UMN           SETLL     LLLINE
     C   41UMN           SETLL     LLLINE01
      *_____________
      * Fyll Subfile (med alle poster uavhengig av linjer pr side)
      *"""""""""""""
     C  N41UMN           READE(N)  LLLINE                                 94
     C   41UMN           READE     LLLINE01                               94
     C     *IN94         DOWEQ     '0'
     C                   ADD       1             ZRECNO
     C     UKONTR        IFEQ      'J'
     C     XKONTR        OREQ      'J'
N02  C                   ADD       LLNTLK        XANTLOK
     C                   EXSR      KTRREC
     C                   END
     C     LLLOK         COMP      *BLANKS                                46
     C                   WRITE     SUBFIL
     C     XSISTN        IFLT      LLVN
     C                   MOVE      LLVN          XSISTN
     C                   END
     C  N41UMN           READE(N)  LLLINE                                 94
     C   41UMN           READE     LLLINE01                               94
     C  N94              END
     C                   MOVE      ZRECNO        XRECNO
      *
     C     UKONTR        IFEQ      'J'
     C     XKONTR        OREQ      'J'
     C     XKRECN        IFEQ      0
     C     UMN           CHAIN     LLHEAD                             33
     C                   MOVE      'K'           LHST1
     C                   UPDATE    LLHEADR
     C     UKONTR        CABEQ     'J'           UTHOV
     C                   END
     C                   END
      *_______________
      * Bevar sist brukt recno, vis subfila fra post begynnelsen
      *_______________
     C     UKONTR        IFEQ      'J'
     C     XKONTR        OREQ      'J'
     C     XKRECN        IFGT      0
     C                   MOVE      XKRECN        ZRECNO
     C     XKRECN        DIV       15            LINNBR
     C                   MVR                     LINNBR
     C     LINNBR        IFEQ      0
     C                   Z-ADD     20            LINNBR
     C                   ELSE
     C                   ADD       5             LINNBR
     C                   END
     C     XPNBR         IFEQ      0
     C                   Z-ADD     2             POSNBR
     C                   ELSE
     C                   MOVE      XPNBR         POSNBR
     C                   END
     C                   ELSE
     C     ZRECNO        IFGT      0
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   END
     C                   ELSE
     C     ZRECNO        IFGT      0
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   END
      *_______________
      * Ingen record fantes??
      *_______________
     C     START3        TAG
     C     ZRECNO        IFEQ      0
     C                   MOVE      '0'           *IN05
     C                   WRITE     BLANKREC
     C                   EXFMT     NOREC
     C                   ELSE
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     BLANKREC
     C                   WRITE     BOTREC
     C     UKONTR        IFNE      'J'
     C     XKONTR        ANDNE     'J'
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   END
     C                   EXFMT     SUBCTL
     C                   END
     C                   MOVE      'N'           XKONTR            1
     C                   MOVE      '0'           *IN45
      *
     C   12UKONTR        IFEQ      'J'
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      UTHOV
     C                   END
      *
     C     *IN03         IFEQ      '1'
     C                   Z-ADD     3             UFLAGG
     C   49              GOTO      UTHOV
     C                   END
      *
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      START3
     C                   END
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(91)
      *
     C     *IN18         IFEQ      '1'
     C                   MOVE      'J'           XKONTR
     C                   GOTO      START
     C                   END
      *_____________
      * F5=Frisk opp
      *"""""""""""""
     C     *IN05         CABEQ     '1'           START
      *_____________
      * F6=Lag ny
      *"""""""""""""
     C     *IN06         IFEQ      '1'
     C                   EXSR      CRTNEW
     C                   GOTO      START3
     C                   END
      *_____________
      * F9=Lag ny
      *"""""""""""""
     C                   IF        *IN09 = *ON
     C                   EXSR      CRTNEW2
     C  N03              GOTO      START3
     C                   END
      *_____________
      * F7=SORTERING
      *"""""""""""""
     C     *IN07         IFEQ      '1'
     C     *IN41         IFEQ      '0'
     C                   MOVE      '1'           *IN41
     C                   ELSE
     C                   MOVE      '0'           *IN41
     C                   END
     C                   GOTO      START
     C                   END
      *_______
      * Valg ?
      *"""""""
     C                   MOVE      '0'           *IN52
     C     ZRECNO        IFGT      0
     C     *IN52         DOWEQ     '0'
     C                   READC     SUBFIL                                 52
     C  N52              EXSR      OPTION
     C  N52              END
     C                   END
      *
     C     UFLAGG        CABEQ     3             UTHOV
      *
     C     UKONTR        CABEQ     'J'           START
     C                   GOTO      START3
      *
     C     UTHOV         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     OPTION        BEGSR
      *////////////////////////////////////////////////////////////
     C     SLETT         IFNE      '*SLETT'
      *
     C  N49WSNR          IFEQ      '2'
     C                   EXSR      CHGLL
     C                   MOVE      ' '           WSNR
     C     LLLOK         COMP      *BLANKS                                46
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END
      *
     C  N49WSNR          IFEQ      '4'
     C     LLLINK        CHAIN(N)  LLLINE                             33
     C     LLVA2K        CHAIN     LLVARE01                           33
     C     LVTXT         COMP      *BLANKS                            2929
     C     STDLT         TAG
     C                   EXFMT     DDREC
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      STDLT
     C                   END
     C     *IN12         IFEQ      '0'
     C     LLLINK        CHAIN     LLLINE                             33
     C                   DELETE    LLLINER
     C     LLSE2K        SETLL     LLSERL02
     C     LLSE2K        READE     LLSERL02                               33
     C     *IN33         DOWEQ     '0'
N04  C                   MOVE      'I'           SNST
     C                   MOVE      *ZEROS        SNMNU
     C                   MOVE      *ZEROS        SNVNU
     C                   UPDATE    LLSERR
     C     LLSE2K        READE     LLSERL02                               33
     C  N33              ENDDO
      *
      * OPPDATER PÅ LAGER
     C                   MOVE      'DL2'         UTYPE             3
     C                   CALL      'LL019R'
     C                   PARM                    LHGRP
     C                   PARM                    LHPNR
     C                   PARM                    LLANR
     C                   PARM                    LLMN
     C                   PARM                    LLVN
     C                   PARM                    UTYPE
      *
     C                   MOVE      *BLANKS       LLANR
     C                   MOVE      '*SLETT'      SLETT
     C                   MOVE      *BLANKS       LLVB
     C                   MOVE      *ZEROS        LLWNT0
     C                   MOVE      *ZEROS        LLWNTL
     C                   MOVE      *ZEROS        LLWNT1
     C                   MOVE      *ZEROS        LLWNT2
     C                   MOVE      *ZEROS        LLWNT3
     C                   MOVE      *ZEROS        LLWVEK
     C                   MOVE      *ZEROS        LLWKUB
     C                   END
     C                   MOVE      ' '           WSNR
     C     LLLOK         COMP      *BLANKS                                46
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END
      *
     C     WSNR          IFEQ      '5'
     C     LLLINK        CHAIN(N)  LLLINE                             33
     C     LLVA2K        CHAIN     LLVARE01                           33
     C     LVTXT         COMP      *BLANKS                            2929
     C     STDSP         TAG
     C                   EXFMT     DDREC
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      STDSP
     C                   END
     C                   MOVE      ' '           WSNR
     C     LLLOK         COMP      *BLANKS                                46
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END
      *
     C  N49WSNR          IFEQ      '8'
     C                   CALL      'LL016R'
     C                   PARM      LHGRP         UGRP
     C                   PARM                    LHPNR
     C                   PARM                    LHALN
     C                   PARM                    LLMN
     C                   PARM                    LLVN
     C                   PARM      LLWNT0        UWNT0
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END
N01   *
N01  C     WSNR          IFEQ      'D'
N01  C                   CALL      'LL083R'
N01  C                   PARM                    LLMN
N01  C                   PARM                    LLANR
N01  C                   MOVE      ' '           WSNR
N01  C     LLLOK         COMP      *BLANKS                                46
N01  C                   UPDATE    SUBFIL
N01  C                   GOTO      SLOPT
N01  C                   END
      *
      * ENDRING AV ANTALL, VEKT KUBIKK
     C                   MOVE      LLWNT0        XWNT0
     C                   MOVE      LLWNTL        XWNTL
     C                   MOVE      LLWNT1        XWNT1
     C                   MOVE      LLWNT2        XWNT2
     C                   MOVE      LLWNT3        XWNT3
     C                   MOVE      LLWVEK        XWVEK
     C                   MOVE      LLWKUB        XWKUB
     C     LLLINK        CHAIN     LLLINE                             55
     C                   MOVE      XWNT0         LLWNT0
     C                   MOVE      XWNTL         LLWNTL
     C                   MOVE      XWNT1         LLWNT1
     C                   MOVE      XWNT2         LLWNT2
     C                   MOVE      XWNT3         LLWNT3
     C                   MOVE      XWVEK         LLWVEK
     C                   MOVE      XWKUB         LLWKUB
     C                   UPDATE    LLLINER
     C     LLLOK         COMP      *BLANKS                                46
     C                   UPDATE    SUBFIL
      *
     C                   END
      *
     C     SLOPT         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TESTB         BEGSR
      *////////////////////////////////////////////////////////////
      * TEST DATO
     C                   IF        WSPRDT <> 0
     C                   MOVE      WSPRDTD       UDD               2 0
     C                   MOVE      WSPRDTM       UMM               2 0
     C                   MOVE      WSPRDTÅ       UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C     *IN89         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     59            POSNBR
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
     C                   END
      * HENT ARTKKELNR VIA WSSENR
     C     WSSER         IFNE      *BLANKS
     C     WSANR         ANDEQ     *BLANKS
     C                   MOVE      WSPRDT        UPRDT             8
     C                   CALL      'LL024R'
     C                   PARM                    LHGRP
     C                   PARM                    LHPNR
     C                   PARM                    WSSER
     C                   PARM                    UPRDT
     C                   PARM                    WSANR
     C                   PARM                    WSBSAL
     C                   PARM                    WSBPOS
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      9
     C                   MOVE      '1'           *IN83
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0662'     ZMSGNO
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLTST
     C                   END
     C                   MOVE      '1'           *IN61
     C     WSBPOS        IFLE      1
     C     WSWNT0        ANDEQ     0
     C                   MOVE      WSBSAL        WSWNT0
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   WRITE     CHGREC
     C                   END
      * TEST ARTIKKELNR
     C     LLVARK        CHAIN     LLVARE01                           90
     C   90LHGRP         IFNE      0
     C     LLVGRK        CHAIN     LLVARE01                           90
     C                   END
     C  N90LVAKT         COMP      'I'                                    90
     C  N90LVVKT0        COMP      0                                      90
     C  N90LVTXT         COMP      *BLANKS                            2929
     C     *IN90         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0585'     ZMSGNO
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLTST
     C                   ELSE
     C     WSVB          IFEQ      *BLANKS
     C                   MOVEL     LVVB          WSVB
     C                   END
     C                   MOVE      LVEH1         WSAEH1
     C                   MOVE      LVEH2         WSAEH2
     C                   MOVE      LVEH3         WSAEH3
     C                   END
      * TEST ANTALL STYKK
     C     WSWNT0        IFEQ      0
     C     WSANT0        ANDEQ     0
     C                   MOVE      '1'           *IN88
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0586'     ZMSGNO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   END
      *
      * TRIGGE ALOKERING NÅ LOKASJON ER BLANK (AUTOSKAPT LINJE..)
     C     WSLOK         IFEQ      *BLANKS
     C                   MOVE      *ZEROS        LLWNT0
     C                   END
      *
      * TEST OM ANTALL UTTAK FINNES PÅ LAGER
     C     *IN30         IFEQ      '0'
     C     WSWNT0        ANDGT     0
     C                   Z-ADD     LLWNT0        XXSALD
     C                   Z-ADD     LLWNT0        X2SALD
     C                   MOVE      *ZEROS        XXNTLK
     C                   MOVE      *ZEROS        X2NTLK
     C     XXSALD        IFLT      WSWNT0
     C     LLAGSK        SETLL     LLAGJS03
     C     STTB1         TAG
     C     LLAGSK        READE     LLAGJS03                               30
     C     *IN30         IFEQ      '0'
     C     VADATO        IFNE      99999999
     C                   IF        WSPRDT <> 0
     C     VAPRDT        CABNE     WSPRDT        STTB1
     C                   END
      *
      * FOR Å HINDRE FEIL (BRUKER ENDRER REGLER PÅ ARTIKKEL MED IKKE
      * PÅ LAGERBEHOLDING) BEREGNER PROGRAMMET SALDO PÅ NYTT OG VELG
      * DEN LAVSTE AV DE TO SALDOENE.
     C                   Z-ADD     VASAE0        XNYS1             7 0
     C     VASAE1        MULT      VAAN01        XNYS2             7 0
     C                   ADD       XNYS2         XNYS1
     C     VASAE2        MULT      VAAN02        XNYS2
     C                   ADD       XNYS2         XNYS1
     C     VASAE3        MULT      VAAN03        XNYS2
     C                   ADD       XNYS2         XNYS1
     C     XNYS1         IFLT      VASALD
     C                   ADD       XNYS1         XXSALD
     C                   ADD       1             XXNTLK
     C     WSSER         IFEQ      VASENR
     C                   ADD       XNYS1         X2SALD
     C                   ADD       1             X2NTLK
     C                   END
     C                   ELSE
     C                   ADD       VASALD        XXSALD
     C                   ADD       1             XXNTLK
     C     WSSER         IFEQ      VASENR
     C                   ADD       VASALD        X2SALD
     C                   ADD       1             X2NTLK
     C                   END
     C                   END
      *
     C                   END
     C     WSSER         IFEQ      *BLANKS
     C     XXSALD        CABLT     WSWNT0        STTB1
     C                   ELSE
     C     X2SALD        CABLT     WSWNT0        STTB1
     C                   END
     C                   END
     C     *IN30         IFEQ      '1'
     C                   MOVE      '1'           *IN88
     C                   MOVE      'YBC0594'     ZMSGNO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   END
     C                   END
     C                   END
      *
      *
     C     WSMKD         IFEQ      *BLANKS
     C     WSMTXT        ANDNE     *BLANKS
     C                   MOVE      'MANKO'       WSMKD
     C                   END
      *
     C     WSMKD         IFNE      *BLANKS
     C     WSANT0        ORNE      WSWNT0
     C     WSANT0        ANDNE     0
     C     KUFASTK       CHAIN     KUFAST                             89
     C  N30*IN89         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1873'     ZMSGNO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   END
     C                   END
      *
     C     SLTST         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     MOVWLL        BEGSR
      *////////////////////////////////////////////////////////////
     C                   IF        WSWNT0 = 0
     C                   IF        WSMKD  = *BLANKS
     C                   GOTO      STMWLL
     C                   ELSE
     C                   GOTO      STMWLL2
     C                   END
     C                   END
     C     *IN07         IFEQ      '1'
     C     WSNTLK        IFEQ      0
     C                   Z-ADD     2             UFLAGG            1 0
     C                   ELSE
     C                   Z-ADD     3             UFLAGG
     C                   END
     C                   ELSE
     C     WSNTLK        IFEQ      0
     C                   MOVE      *ZEROS        UFLAGG
     C                   ELSE
     C                   Z-ADD     1             UFLAGG
     C                   END
     C                   END
      *
      * OPPDATER ANTALL PÅ LAGER
     C     LLWNT0        IFNE      WSWNT0
     C     LLANR         ORNE      WSANR
     C     LLLOK         ORNE      WSLOK
     C     LLSER         ORNE      WSSER
     C     LLPRDT        ORNE      WSPRDT
     C     UFLAGG        OREQ      2
     C     UFLAGG        OREQ      3
     C     WSLOK         OREQ      *BLANKS
      *
     C     *LIKE         DEFINE    WSLOK         ULOK
     C                   SELECT
     C     XLL015        WHENEQ    'J'
      * KUN PLUKKE FRA DET BESTEMTE LAGERPOSISJONEN
     C                   MOVE      WSLOK         ULOK
     C     WSNTLK        WHENEQ    0
     C     WSLOK1        ANDNE     *BLANKS
     C     WSLOK2        ANDEQ     *BLANKS
      * KUN PLUKKE FRA DET BESTEMTE LAGERSTEDET
     C                   MOVE      WSLOK         ULOK
     C                   OTHER
     C                   MOVE      *BLANKS       ULOK
     C                   ENDSL
      *
     C     STMWLL        TAG
     C                   MOVE      WSPRDT        UPRDT
     C                   CALL      'LL022R'
     C                   PARM      LVGRUP        UGRP
     C                   PARM                    LHPNR
     C                   PARM                    WSANR
     C                   PARM                    WSSER
     C                   PARM                    UPRDT
     C                   PARM                    LLMN
     C                   PARM                    LLVN
     C                   PARM      WSWNT0        UWNT0
     C                   PARM                    UWNTL
     C                   PARM                    UWNT1
     C                   PARM                    UWNT2
     C                   PARM                    UWNT3
     C                   PARM                    UWVEK
     C                   PARM                    UWKUB
     C                   PARM                    ULOK
     C                   PARM                    UNTLK             3 0
     C                   PARM                    UFLAGG
      *
     C     UFLAGG        CABEQ     1             SLMWL
     C     UFLAGG        IFEQ      2
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0683'     ZMSGNO
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLMWL
     C                   END
     C     UFLAGG        IFEQ      4
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1924'     ZMSGNO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLMWL
     C                   END
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1733'     ZMSGNO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLMWL
     C                   END
     C     UFLAGG        IFEQ      9
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0617'     ZMSGNO
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLMWL
     C                   END
     C                   MOVE      UWNTL         WSWNTL
     C                   MOVE      UWNT1         WSWNT1
     C                   MOVE      UWNT2         WSWNT2
     C                   MOVE      UWNT3         WSWNT3
     C                   MOVE      UWVEK         WSWVEK
     C                   MOVE      UWKUB         WSWKUB
     C                   MOVE      ULOK          WSLOK
     C                   MOVE      UNTLK         WSNTLK
     C                   ELSE
     C                   MOVE      *ZEROS        UFLAGG
     C                   END
      *
     C     STMWLL2       TAG
     C                   MOVE      WSANR         LLANR
     C                   MOVE      WSVB          LLVB
     C                   MOVE      WSHK          LLHK
     C     WSLOK2        IFEQ      *BLANKS
     C                   MOVE      ULOK          LLLOK
     C                   ELSE
     C                   MOVE      WSLOK         LLLOK
     C                   END
     C                   MOVE      WSNTLK        LLNTLK
     C                   MOVE      WSPRI         LLPRI
     C                   MOVE      WSSER         LLSER
     C                   MOVE      WSPRDT        LLPRDT
     C                   MOVE      WSMKD         LLMKD
     C                   MOVE      WSMTXT        LLMTXT
     C                   MOVE      WSALLO        LLALLO
     C                   MOVE      WSANT0        LLANT0
     C                   MOVE      WSWNT0        LLWNT0
     C                   MOVE      WSWNTL        LLWNTL
     C                   MOVE      WSANT1        LLANT1
     C                   MOVE      WSWNT1        LLWNT1
     C                   MOVE      WSAEH1        LLAEH1
     C                   MOVE      WSANT2        LLANT2
     C                   MOVE      WSWNT2        LLWNT2
     C                   MOVE      WSAEH2        LLAEH2
     C                   MOVE      WSANT3        LLANT3
     C                   MOVE      WSWNT3        LLWNT3
     C                   MOVE      WSAEH3        LLAEH3
     C                   MOVE      WSVEK         LLVEK
     C                   MOVE      WSWVEK        LLWVEK
     C                   MOVE      WSKUB         LLKUB
     C                   MOVE      WSWKUB        LLWKUB
      *
     C     SLMWL         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CHGLL         BEGSR
      *////////////////////////////////////////////////////////////
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     19            POSNBR
     C     LLLINK        CHAIN(N)  LLLINE                             33
     C                   MOVE      LLANR         WSANR
     C                   MOVE      LLVB          WSVB
     C                   MOVE      LLHK          WSHK
     C                   MOVE      LLLOK         WSLOK
     C                   MOVE      LLNTLK        WSNTLK
N03  C                   IF        WSNTLK=1 AND LLWNT0=0                        ENDRE LINJE MED 0
N03  C                   MOVE      *ZEROS        WSNTLK
N03  C                   ENDIF
     C                   MOVE      LLPRI         WSPRI
     C                   MOVE      LLSER         WSSER
     C                   MOVE      LLPRDT        WSPRDT
     C                   MOVE      LLMKD         WSMKD
     C                   MOVE      LLMTXT        WSMTXT
     C                   MOVE      LLALLO        WSALLO
     C                   MOVE      LLANT0        WSANT0
     C                   MOVE      LLWNT0        WSWNT0
     C                   MOVE      LLWNTL        WSWNTL
     C                   MOVE      LLANT1        WSANT1
     C                   MOVE      LLWNT1        WSWNT1
     C                   MOVE      LLAEH1        WSAEH1
     C                   MOVE      LLANT2        WSANT2
     C                   MOVE      LLWNT2        WSWNT2
     C                   MOVE      LLAEH2        WSAEH2
     C                   MOVE      LLANT3        WSANT3
     C                   MOVE      LLWNT3        WSWNT3
     C                   MOVE      LLAEH3        WSAEH3
     C                   MOVE      LLVEK         WSVEK
     C                   MOVE      LLWVEK        WSWVEK
     C                   MOVE      LLKUB         WSKUB
     C                   MOVE      LLWKUB        WSWKUB
     C                   MOVE      LHAVD         WSAVD
     C                   MOVE      LHOPD         WSOPD
     C                   MOVE      LHFBN         WSFBN
     C                   MOVE      LLANR         XANR             15
     C     LLVARK        CHAIN     LLVARE01                           33
     C     LVTXT         COMP      *BLANKS                            2929
     C                   MOVE      '0'           *IN61
      *
     C     STCHG         TAG
     C                   EXFMT     CHGREC
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00'          *IN(29)
     C                   MOVE      '0'           *IN61
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      STCHG
     C                   END
     C     *IN04         IFEQ      '1'
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   MOVE      *ZEROS        UFLAGG
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     35
     C                   CALL      'LL002R'
     C                   PARM      LHGRP         UGRP
     C                   PARM      LHPNR         UPNR
     C                   PARM                    WSANR
     C                   PARM                    UANRL            15
     C                   PARM                    LVTXT
     C                   PARM                    UFLAGG
     C     LVTXT         COMP      *BLANKS                            2929
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      WSANR         XANR
     C                   END
      *
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     23
     C                   MOVE      'J'           UUPDAT            1
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    WSMKD
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   END
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN12         IFEQ      '0'
     C     STCHG2        TAG
     C                   EXSR      TESTB
      *
     C     *IN30         IFEQ      '1'
     C     ZMSGNO        IFEQ      'YBC0594'                                    ANTALL FOR STOR
     C                   EXSR      VISANT
     C     *IN12         CABEQ     '1'           STCHG
     C                   GOTO      STCHG2
     C                   END
     C                   MOVE      WSANR         XANR
     C                   GOTO      STCHG
     C                   END
      *
      * LVTXT<>BLANK, VARSLE AT DENNE VAREN MÅ TAS SPESIAL HENSYN
     C     WSANR         IFNE      XANR
     C     LVTXT         ANDNE     *BLANKS
     C                   MOVE      WSANR         XANR
     C                   GOTO      STCHG
     C                   END
      *
     C     LLLINK        CHAIN     LLLINE                             33
     C                   EXSR      MOVWLL
     C                   UPDATE    LLLINER
     C     UFLAGG        IFEQ      1
     C     UFLAGG        OREQ      2
     C     UFLAGG        OREQ      9
     C                   GOTO      STCHG
     C                   END
     C                   MOVE      '0'           *IN45
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     VISANT        BEGSR
      *////////////////////////////////////////////////////////////
     C     WSSER         COMP      *BLANKS                            2828
     C     STVISA        TAG
     C                   EXFMT     CHGANT
     C     *IN12         IFEQ      '0'
     C     XXSALD        CABLT     WSWNT0        STVISA
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00'          *IN(29)
     C                   MOVE      '0'           *IN61
     C                   MOVE      *ZEROS        WSWNTL
     C                   MOVE      *ZEROS        WSWNT1
     C                   MOVE      *ZEROS        WSWNT2
     C                   MOVE      *ZEROS        WSWNT3
     C                   else
     C                   move      *ZEROS        WSWNT0
     C                   move      *blanks       WSVB
     C                   move      *blanks       LVTXT
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CRTNEW        BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      'J'           LAGNY             1
     C     STCRT0        TAG
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      *BLANKS       LLANR
     C                   MOVE      *BLANKS       LLLOK
     C                   MOVE      *BLANKS       LLSER
     C                   MOVE      *BLANKS       LLMKD
     C                   MOVE      *BLANKS       LLMTXT
     C                   MOVE      *ZEROS        LLVN
     C                   MOVE      *ZEROS        LLWNT0
     C                   MOVE      *BLANKS       WSANR
     C                   MOVE      *BLANKS       WSVB
     C                   MOVE      *BLANKS       WSHK
     C                   MOVE      *BLANKS       WSLOK
     C                   MOVE      *ZEROS        WSNTLK
     C                   MOVE      *ZEROS        WSPRI
     C                   MOVE      *BLANKS       WSSER
     C                   MOVE      *ZEROS        WSPRDT
     C                   MOVE      *BLANKS       WSMKD
     C                   MOVE      *BLANKS       WSMTXT
     C                   MOVE      *BLANKS       WSALLO
     C                   MOVE      *ZEROS        WSANT0
     C                   MOVE      *ZEROS        WSWNT0
     C                   MOVE      *ZEROS        WSWNTL
     C                   MOVE      *ZEROS        WSANT1
     C                   MOVE      *ZEROS        WSWNT1
     C                   MOVE      *BLANKS       WSAEH1
     C                   MOVE      *ZEROS        WSANT2
     C                   MOVE      *ZEROS        WSWNT2
     C                   MOVE      *BLANKS       WSAEH2
     C                   MOVE      *ZEROS        WSANT3
     C                   MOVE      *ZEROS        WSWNT3
     C                   MOVE      *BLANKS       WSAEH3
     C                   MOVE      *ZEROS        WSVEK
     C                   MOVE      *ZEROS        WSWVEK
     C                   MOVE      *ZEROS        WSKUB
     C                   MOVE      *ZEROS        WSWKUB
     C                   MOVE      *ZEROS        WSAVD
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        WSFBN
     C                   MOVE      *BLANKS       LVTXT
     C                   MOVE      *BLANKS       XANR             15
     C                   MOVE      *ZEROS        WSPRDT
     C                   MOVE      '0'           *IN61
      *
     C     STCRT         TAG
     C                   EXFMT     CHGREC
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00'          *IN(29)
     C                   MOVE      '0'           *IN61
      *
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      STCRT
     C                   END
     C     *IN04         IFEQ      '1'
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   MOVE      *ZEROS        UFLAGG
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     35
     C                   CALL      'LL002R'
     C                   PARM      LHGRP         UGRP
     C                   PARM      LHPNR         UPNR
     C                   PARM                    WSANR
     C                   PARM                    UANRL            15
     C                   PARM                    LVTXT
     C                   PARM                    UFLAGG
     C     LVTXT         COMP      *BLANKS                            2929
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      WSANR         XANR
     C                   END
      *
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     23
     C                   MOVE      'J'           UUPDAT            1
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    WSMKD
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   END
     C                   GOTO      STCRT
     C                   END
      *
     C     *IN12         IFEQ      '0'
      *
      * HENT ARTIKKELNR VIA LAGERLOKASJON
     C                   MOVE      'N'           XLL015            1
     C     WSANR         IFEQ      *BLANKS
     C     WSSER         ANDEQ     *BLANKS
     C     WSLOK2        ANDNE     *BLANKS
     C                   CALL      'LL015R'
     C                   PARM                    LHGRP
     C                   PARM                    LHPNR
     C                   PARM                    WSLOK
     C                   PARM                    WSANR
     C                   PARM                    WSSER
     C                   PARM                    WSWNT0
     C     WSANR         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN30
     C                   MOVE      'DIV0000'     ZMSGNO
     C                   GOTO      STCRT
     C                   ELSE
     C                   MOVE      'J'           XLL015
     C                   MOVE      *ZEROS        WSWNTL
     C                   MOVE      *ZEROS        WSWNT1
     C                   MOVE      *ZEROS        WSWNT2
     C                   MOVE      *ZEROS        WSWNT3
     C                   END
     C                   END
      *
     C     STCRT2        TAG
     C                   EXSR      TESTB
     C     *IN30         IFEQ      '1'
     C     ZMSGNO        IFEQ      'YBC0594'                                    ANTALL FOR STOR
     C                   EXSR      VISANT
     C     *IN12         CABEQ     '1'           STCRT
     C                   GOTO      STCRT2
     C                   END
     C                   MOVE      WSANR         XANR
     C                   GOTO      STCRT
     C                   END
      *
     C     WSANR         IFNE      XANR
     C     LVTXT         ANDNE     *BLANKS
     C                   MOVE      WSANR         XANR
     C                   GOTO      STCRT
     C                   END
      *
     C                   MOVE      LHMN          LLMN
     C     XSISTN        ADD       1             LLVN
     C                   EXSR      MOVWLL
     C     UFLAGG        IFEQ      1
     C     UFLAGG        OREQ      2
     C     UFLAGG        OREQ      3
     C     UFLAGG        OREQ      9
     C                   GOTO      STCRT
     C                   END
     C                   ADD       1             XSISTN                                     1
     C                   MOVE      XSISTN        LLVN
     C                   WRITE     LLLINER
     C                   MOVE      '0'           *IN45
     C                   ADD       1             XRECNO
     C                   MOVE      XRECNO        ZRECNO
     C     LLLOK         COMP      *BLANKS                                46
     C                   WRITE     SUBFIL
     C                   GOTO      STCRT0
     C                   END
      *
     C                   MOVE      'N'           LAGNY
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CRTNEW2       BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      'J'           LAGNY             1
     C     STCRT20       TAG
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      *BLANKS       LLANR
     C                   MOVE      *BLANKS       LLLOK
     C                   MOVE      *BLANKS       LLSER
     C                   MOVE      *BLANKS       LLMKD
     C                   MOVE      *BLANKS       LLMTXT
     C                   MOVE      *ZEROS        LLVN
     C                   MOVE      *ZEROS        LLWNT0
     C                   MOVE      *BLANKS       WSANR
     C                   MOVE      *BLANKS       WSVB
     C                   MOVE      *BLANKS       WSHK
     C                   MOVE      *BLANKS       WSLOK
     C                   MOVE      *ZEROS        WSNTLK
     C                   MOVE      *ZEROS        WSPRI
     C                   MOVE      *BLANKS       WSSER
     C                   MOVE      *ZEROS        WSPRDT
     C                   MOVE      *BLANKS       WSMKD
     C                   MOVE      *BLANKS       WSMTXT
     C                   MOVE      *BLANKS       WSALLO
     C                   MOVE      *ZEROS        WSANT0
     C                   MOVE      *ZEROS        WSWNT0
     C                   MOVE      *ZEROS        WSWNTL
     C                   MOVE      *ZEROS        WSANT1
     C                   MOVE      *ZEROS        WSWNT1
     C                   MOVE      *BLANKS       WSAEH1
     C                   MOVE      *ZEROS        WSANT2
     C                   MOVE      *ZEROS        WSWNT2
     C                   MOVE      *BLANKS       WSAEH2
     C                   MOVE      *ZEROS        WSANT3
     C                   MOVE      *ZEROS        WSWNT3
     C                   MOVE      *BLANKS       WSAEH3
     C                   MOVE      *ZEROS        WSVEK
     C                   MOVE      *ZEROS        WSWVEK
     C                   MOVE      *ZEROS        WSKUB
     C                   MOVE      *ZEROS        WSWKUB
     C                   MOVE      *ZEROS        WSAVD
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        WSFBN
     C                   MOVE      *BLANKS       LVTXT
     C                   MOVE      *BLANKS       XANR             15
     C                   MOVE      *ZEROS        WSPRDT
     C                   MOVE      '0'           *IN61
      *
     C     STCRT21       TAG
     C                   EXFMT     CHGREC2
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00'          *IN(29)
     C                   MOVE      '0'           *IN61
     C   03              Z-ADD     3             UFLAGG
     C   03              GOTO      SLCRTNEW2
      *
     C                   IF        *IN04 = *ON
     C                   CALL      'LL002R'
     C                   PARM      LHGRP         UGRP
     C                   PARM      LHPNR         UPNR
     C                   PARM                    WSANR
     C                   PARM                    UANRL            15
     C                   PARM                    LVTXT
     C                   PARM                    UFLAGG
     C     LVTXT         COMP      *BLANKS                            2929
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      WSANR         XANR
     C                   END
      *
     C     *IN12         IFEQ      '0'
      *
     C     STCRT22       TAG
     C                   EXSR      TESTB
     C     *IN30         IFEQ      '1'
     C     ZMSGNO        IFEQ      'YBC0594'                                    ANTALL FOR STOR
     C                   EXSR      VISANT
     C     *IN12         CABEQ     '1'           STCRT21
     C                   GOTO      STCRT22
     C                   END
     C                   MOVE      WSANR         XANR
     C                   SELECT
     C                   WHEN      *IN90 = *ON
     C                   Z-ADD     21            LINNBR
     C                   WHEN      *IN88 = *ON
     C                   Z-ADD     22            LINNBR
     C                   OTHER
     C                   Z-ADD     21            LINNBR
     C                   ENDSL
     C                   GOTO      STCRT21
     C                   END
      *
     C     WSANR         IFNE      XANR
     C     LVTXT         ANDNE     *BLANKS
     C                   MOVE      WSANR         XANR
     C                   GOTO      STCRT21
     C                   END
      *
     C                   MOVE      LHMN          LLMN
     C     XSISTN        ADD       1             LLVN
     C                   EXSR      MOVWLL
     C     UFLAGG        IFEQ      1
     C     UFLAGG        OREQ      2
     C     UFLAGG        OREQ      3
     C     UFLAGG        OREQ      9
     C                   GOTO      STCRT21
     C                   END
     C                   ADD       1             XSISTN                                     1
     C                   MOVE      XSISTN        LLVN
     C                   WRITE     LLLINER
     C                   MOVE      '0'           *IN45
     C                   ADD       1             XRECNO
     C                   MOVE      XRECNO        ZRECNO
     C     LLLOK         COMP      *BLANKS                                46
     C                   WRITE     SUBFIL
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      STCRT20
     C                   END
      *
     C     SLCRTNEW2     TAG
     C                   MOVE      'N'           LAGNY
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CRTALL        BEGSR
      *////////////////////////////////////////////////////////////
     C                   CLEAR                   LLLINER
     C                   MOVE      LHMN          LLMN
     C                   MOVE      *ZEROS        LLVN
      *
     C                   MOVE      '0'           *IN16
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     SUMTOT        BEGSR
      *////////////////////////////////////////////////////////////
     C     XRECNO        IFGT      0
     C                   MOVE      '0'           *IN52
     C                   MOVE      *ZEROS        UANT0
     C                   MOVE      *ZEROS        UANTL
     C                   MOVE      *ZEROS        UANT1
     C                   MOVE      *BLANKS       UAEH1
     C                   MOVE      *ZEROS        UANT2
     C                   MOVE      *BLANKS       UAEH2
     C                   MOVE      *ZEROS        UANT3
     C                   MOVE      *BLANKS       UAEH3
     C                   MOVE      *ZEROS        UVEK
     C                   MOVE      *ZEROS        UKUB
     C                   MOVE      *ZEROS        UTLIN
     C     1             DO        9000          ZRECNO
     C     ZRECNO        CHAIN     SUBFIL                             52
     C   52              LEAVE
     C     SLETT         IFNE      '*SLETT'
     C                   ADD       LLWNT0        UANT0
     C                   ADD       LLWNTL        UANTL
     C                   ADD       LLWNT1        UANT1
     C     LLAEH1        IFNE      *BLANKS
     C                   MOVE      LLAEH1        UAEH1
     C                   END
     C                   ADD       LLWNT2        UANT2
     C     LLAEH2        IFNE      *BLANKS
     C                   MOVE      LLAEH2        UAEH2
     C                   END
     C                   ADD       LLWNT3        UANT3
     C     LLAEH3        IFNE      *BLANKS
     C                   MOVE      LLAEH3        UAEH3
     C                   END
     C                   ADD       LLWVEK        UVEK
     C                   ADD       LLWKUB        UKUB
     C                   ADD       1             UTLIN
     C                   END
     C                   ENDDO
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     KTRREC        BEGSR
      *////////////////////////////////////////////////////////////
     C     LLANT0        IFGT      0
     C                   MOVE      '0'           *IN45
     C     LLANT0        ifne      LLWNT0
     C     LLMKD         andeq     *blanks
     C                   MOVE      '1'           *IN45
     C                   end
     C   45XKRECN        IFEQ      0
     C                   MOVE      ZRECNO        XKRECN
     C                   END
      * OK
     C                   ELSE
     C     LLWNT0        IFGT      0
     C     LLWNTL        ORGT      0
     C     LLWNT1        ORGT      0
     C     LLWNT2        ORGT      0
     C     LLWNT3        ORGT      0
     C     LLWVEK        COMP      0                                    4545
     C  N45LLLOK         COMP      *BLANKS                                45
     C  N45              DO
     C     LLVA2K        CHAIN     LLVARE01                           33
     C     LVSN          IFEQ      'I'
     C     LVSN          OREQ      'U'
     C     LLSE2K        SETLL     LLSERL02
     C                   MOVE      *ZEROS        XLWNT0
     C     LLSE2K        READE(N)  LLSERL02                               33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XLWNT0
     C     LLSE2K        READE(N)  LLSERL02                               33
     C  N33              ENDDO
     C     LLWNT0        COMP      XLWNT0                             4545
     C                   END
     C                   ENDDO
     C   45XKRECN        IFEQ      0
     C                   Z-ADD     ZRECNO        XKRECN
     C                   Z-ADD     2             XPNBR
     C                   END
     C                   END
      *
     C   45XKRECN        IFEQ      0
     C                   MOVE      ZRECNO        XKRECN
     C                   END
     C                   END
      *
     C                   ENDSR
      *
