********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 BRUK FREETXT3
10XXX * 02 YBC PTF10 FEIL KODE PÅ UTSKRIFT
10007 * 03 YBC PTF10 EKSTRA PARAMETER FOR KALL PÅ SYTR40CB
      * 04 YBC PTF10 tester WEB oppdrag TUATA
      * 05 JOV PTF10 Opt 1 på toplinja=F6 ved både 0 og 99999999 i turnr
      * 06 SH  PTF10 flytt kundenr transportør til oppdrag
      * 07 SH  PTF10 rettin 06 - skal være TRANSP-nr
P10046* 08 JOV PTF10 Opt 55 = Se på web
P10046* 09 SH  PTF10 Opt 25 = track and trace
P10197* 10 SH  PTF10 rødt ved farlig gods
P10216* 10 JOV PTF10 Opt 53 = print skilleark på alle oppdr
P10XXX* 11 CB  PTF10 Manglet parameter ved call til TR011C
P10XXX* 12 JOV PTF10 TURNR RØD = FARLIG, GUL = AVSLUTTET - HIGHLIGHT = MOTTATT GODSLISTE
P10XXX* 13 SH  PTF11 11=print godsliste FOR DE SOM IKKE HAR DET I STANDARD
P10XXX* 14 SH  PTF11 BRINGTMS
P10XXX* 15 SH  PTF11 TURRES  ind 82=rød 83=YLW
10XXX * 16 JOV PTF11 test mot at gitte typer farlig gods ikke kan mikses
10XXX * 17 SH  PTF11 vider okonomi
10XXX * 18 JOV PTF11 utvidede tester Fralig gods
10XXX * 19 JOV PTF11 Et oppdrag kan være unntatt for ADRsjekk
      * 20 JOV PTF11 Sperre mot å endre tur som ligger i eCare tatt bort
      * %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
12023 * 21 JOV PTF12 FARGE TURKIS= ER FJERNET FRA PDA (VIA FIX-TUTST4=3 )
      * 22 JOV PTF12 OPSJON 53 = prt skilleark på alle oppdrag
      * 23 JOV PTF12 OPSJON 12=Sende Gods som mail med lenker/22=Sende GL som SMS m.lenke->WEB
12XXX * 24 JOV PTF12 IKKE sjekk ADR dersom godset alt ER levert
      * 25 jov PTF12 OPJON '59 = Upload via espedSG
********************************************************************
      *
      ****************************************************************
      *** PROGRAM SKAL OPPRETTE/PLANLEGGE TURER                    ***
      *** INDIKATORER 01 - 25 KUN CMD-TASTER / ROLL TASTER         ***
      *** LEDIGE INDIKATORER 01 02 07 09-11 13-22
      *** LEDIGE INDIKATORER 39 42-69 83-89 95 97
      ***           37 PÅ = ARBEIDE MED TURER                      ***
      ***           35 PÅ = SPØRRING TURER                         ***
      ***           36 PÅ = PLUKK/ARBEIDE MED                      ***
      ****************************************************************
      *
N15  FTRAVH1    IF   E           K DISK
s07  F*RAN      IF   E           K DISK
     FFREETUR2  IF   E           K DISK
S01  F*REETXT2  IF   E           K DISK
N01  FFREETXT3  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FAVSLUTL2  IF   E           K DISK
     FAVSLUTG2  IF   E           K DISK
     FTRUSTD    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FTUFE      UF   E           K DISK    INFDS(TUFEDS)
     F                                     USROPN
     FREIS      UF   E           K DISK    INFDS(REISDS)
     F                                     USROPN
     FTILL      UF   E           K DISK    INFDS(TILLDS)
     F                                     USROPN
     FKOSBU     UF   E           K DISK    INFDS(KOSBDS)
     F                                     USROPN
     FKOSBU9    UF   E           K DISK    INFDS(KOS9DS)
     F                                     USROPN
     F                                     RENAME(KOSBUR:KOSB9R)
N17  FKOSBU13   IF   E           K DISK
N17  F                                     RENAME(KOSBUR:KOS13R)
N17  FVALUL01   IF   E           K DISK
     FDISPL01   UF   E           K DISK    INFDS(DIS1DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR1)
     FTURER     UF   E           K DISK
     FHEADF     UF   E           K DISK
     FHEAD11    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD11R)
     FTRACKL02  IF   E           K DISK
     FDISP      UF   E           K DISK    INFDS(DISPDS)
     F                                     USROPN
     FTURERDUM  IF   E           K DISK    INFDS(TUDUDS)
     F                                     USROPN
     F                                     RENAME(TURERR:TUREDR)
     FTURER1    IF   E           K DISK
     F                                     RENAME(TURERR:TURE1R)
     FTURER2    IF   E           K DISK    INFDS(TU02DS)
     F                                     USROPN
     F                                     RENAME(TURERR:TURE2R)
     FTURER5    IF   E           K DISK    INFDS(TU05DS)
     F                                     USROPN
     F                                     RENAME(TURERR:TURE5R)
     FTURER6    IF   E           K DISK    INFDS(TU06DS)
     F                                     USROPN
     F                                     RENAME(TURERR:TURE6R)
     FTURER8    IF   E           K DISK    INFDS(TU08DS)
     F                                     USROPN
     F                                     RENAME(TURERR:TURE8R)
     FTURER9    IF   E           K DISK    INFDS(TU09DS)
     F                                     USROPN
     F                                     RENAME(TURERR:TURE9R)
     FSYTR88FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
N25  D* Datastruktur for Å HENTE USER
N25  D                SDS
N25  D  ZJOB                 244    253
N25  D  ZUSER                254    263
     D* Datastruktur for hver fil med UC - er den åpnet ?
     D TUDUDS          DS
     D  TUDUOP                 9      9
     D TU02DS          DS
     D  TU02OP                 9      9
     D TU05DS          DS
     D  TU05OP                 9      9
     D TU06DS          DS
     D  TU06OP                 9      9
     D TU08DS          DS
     D  TU08OP                 9      9
     D TU09DS          DS
     D  TU09OP                 9      9
     D TUFEDS          DS
     D  TUFEOP                 9      9
     D REISDS          DS
     D  REISOP                 9      9
     D TILLDS          DS
     D  TILLOP                 9      9
     D KOSBDS          DS
     D  KOSBOP                 9      9
     D KOS9DS          DS
     D  KOS9OP                 9      9
     D DISPDS          DS
     D  DISPOP                 9      9
     D DIS1DS          DS
     D  DIS1OP                 9      9
     D                 DS
     D  YSONF2                 1      5
     D  AL                     1      5
     D                                     DIM(5)
     D                 DS
     D  YSONT2                 1      5
     D  AL2                    1      5
     D                                     DIM(5)
     D                 DS
     D  YSTEF2                 1      5
     D  SF                     1      5
     D                                     DIM(5)
     D                 DS
     D  YSTET2                 1      5
     D  ST                     1      5
     D                                     DIM(5)
     D                 DS
     D  SYFR05                 1      3
     D  SYSTAX                 1      1
     D                 DS
     D  TUSDF                  1     20
     D  XXSDF                  1      5
     D                 DS
     D  TUSDT                  1     20
     D  XXSDT                  1      5
     D                 DS
s14  D* TUBILN                 1     10
s14  D* XXBILN                 1      9
      * PARAMETERSTRENG FOR KALL PÅ SYKS12
     D                 DS
     D  P1DS                   1    256
     D  P1FLAG                 1      1
     D  P1BNR                  2      8  0
     D  P1AVD                  9     12  0
     D  P1TUNR                13     20  0
     D  P1OAVD                21     24  0
     D  P1OPD                 25     31  0
     D  P1BL                  32     44  2
     D                UDS
     D  UDSFIR                 1      2
     D  UDSAVD                15     18  0
     D  USG                   19     21
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   SETOFF                                           98
     C                   MOVE      ' '           ISTAT1
     C                   MOVE      ' '           ISTAT2
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   MOVE      *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        WSNR
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     WSBDAT        IFEQ      0
     C                   MOVE      *ZEROS        WSBÅMD
     C                   ELSE
     C     WSBDAT        IFEQ      999999
     C                   MOVE      99999999      WSBÅMD
     C                   ELSE
     C                   MOVE      WSBDAT        DATO0
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM                    DATO0
     C     DATO0         IFGT      501231
     C     DATO0         ADD       19000000      WSBÅMD
     C                   ELSE
     C     DATO0         ADD       20000000      WSBÅMD
     C                   END
     C                   END
     C                   END
     C   26
     CAN 41TURE2K        SETGT     TURER2
     C   26
     CANN41TURE2K        SETLL     TURER2
     C   27TUREDK        SETGT     TURERDUM
     C   40TURE1K        SETGT     TURER1
     C   28TURE5K        SETLL     TURER5
     C   29TURE6K        SETLL     TURER6
     C   31TURE8K        SETLL     TURER8
     C   32TURE9K        SETLL     TURER9
     C     START1        TAG
     C                   EXSR      LESFIL
      *
     C     START2        TAG
     C*
     C* START PÅ INDIKATOR 94 FOR LESING PÅ SUBFIL
     C*
     C  N94              DO
     C                   DO        16
     C                   ADD       1             ZRECNO
     C* PROTEKTER TURER I ARBEID VED STATUSKODE = 'P'
     C     UUSPØR        IFNE      'J'                                           *SPØR
     C     TUST          COMP      'P'                                    77
     C                   END
     C                   SETOFF                                       98
     C                   MOVE      TUDT          WSDATF
     C                   MOVE      TUDTT         WSDATT
     C     FIDTFM        IFNE      3
     C                   CALL      'DATFM4'
     C                   PARM                    FIDTFM
     C                   PARM                    WSDATF
     C                   PARM                    WSDATT
     C                   PARM                    DATO0
     C                   PARM                    DATO0
     C                   END
     C                   exsr      TstSFL
     C                   WRITE     SUBFIL
     C                   EXSR      LESFIL
     C  N94              END
     C                   END
     C* BEVAR 17. POSTEN (1. PÅ NESTE SIDE)
     C                   EXSR      MOVTUZ
     C*
     C* EKSEKVERER SKJERMBILDET
     C*
     c     *in30         ifeq      *OFF
     c     PturFins      andeq     'J'
     C                   MOVE      'N'           PturFins
     C                   MOVE      'JOV1450'     MSGNR
     C                   SETON                                            30
     c                   end
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C  N96              Z-ADD     5             LINNBR
     C  N96              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   SETOFF                                       9830
     C                   SETOFF                                       9096
     C     WSAVDA        IFNE      UDSAVD
     C                   EXSR      TESTB0
     C   30              GOTO      START3
     C                   END
     C   04              DO
     C                   CALL      'SYTR19'
     C                   PARM                    W2BILN
     C     W2BILN        IFEQ      *BLANKS
     C                   GOTO      START3
     C                   ELSE
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2PRO
     C                   END
     C                   END
     C   10              DO
     C                   CALL      'SYTR88U'
     C                   GOTO      START3
     C                   END
     C   23              DO
     C                   EXSR      OPSJON
     C                   GOTO      START3
     C                   END
     C   24              DO
     C                   EXSR      CMDFT
     C                   GOTO      START3
     C                   END
     C*
     C* F11 PÅ EN MED STATUS LIK B
     C*
     C   11              DO
     C     F11           IFEQ      'J'
     C                   MOVE      TUPRO         UPRO
     C                   MOVE      TUAVD         UAVD
     C                   MOVE      TURUND        URUND
     C                   MOVE      TUST          TUSTGG            1
     C                   EXSR      TILTUR
     C     TURERK        CHAIN     TURER                              33
     C  N33              MOVE      TUSTGG        TUST
     C  N33              EXCEPT    PTUR
     C   03              GOTO      START3
     C   12              GOTO      START3
     C                   END
     C                   END
     C*
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C*
     C* VED LAGE NY TAS UDSAVD SOM GJELDENDE AVDELING
     C*
     C     START4        TAG
     C   06              DO
     C                   MOVE      UDSAVD        TUAVD
     C                   MOVE      UDSAVD        UAVD
     C                   MOVE      *ZEROS        UPRO
     C                   MOVE      *ZEROS        URUND
     C                   MOVE      UUOPD         UOPD
     C                   EXSR      TILTUR
     C     UAVD          IFNE      WSAVDA
     C                   MOVE      UAVD          WSAVDA
     C                   MOVE      UAVD          UDSAVD
     C                   END
     C*
     C*** UPRO <> 0  --> FRIGJØR STATUSKODE PÅ TUREN
     C*
     C     UPRO          IFNE      0
     C     TURERK        CHAIN     TURER                              33
     C  N33              MOVE      ' '           TUST
     C  N33              EXCEPT    PTUR
     C*
     C* F03 VALGT I NESTE PROGRAM
     C*** UPRO <> 0  --> HAR OPPRETTET EN NY TUR OG LEGGE DEN PÅ SUBFIL
     C     XRECNO        ADD       1             ZRECNO
     C                   ADD       1             XRECNO
     C                   exsr      TstSFL
     C                   WRITE     SUBFIL
     C                   GOTO      START3
     C                   END
     C                   GOTO      START3
     C                   END
     C*
     C* SLUTT PÅ NY TUR
     C*
     C* F05 OPPDATER BILDET
     C*
     C   05              GOTO      START
     C*
     C* F08 = VELG SØKEBEGREP
     C*
     C*** BLA VIDERE
     C*
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   EXSR      MOVZTU
     C                   GOTO      START2
     C                   END
      * W2-VARIABLER SAMMENLIGNES MOT WS-VARIABLER FOR Å SJEKKE ENDRING
      * (TIDLIGERE BLE ALLE W2VARIABLER (UNNTATT) STATUS BLANKET
      *  MELLOM HVERT SØK)
     C     W2NR          IFNE      0                                            1<-B
     C     W2ST2         ORNE      WSSKOD
     C     W2AVD         ORNE      WSAVD
     C     W2PRO         ORNE      WSPRO
     C     W2BILN        ORNE      WSBILN
     C     W2STEF        ORNE      WSSTEF
     C     W2DATF        ORNE      WSBDAT
     C     W2STET        ORNE      WSSTET
     C     W2SONF        ORNE      WSSONF
     C     W2SONT        ORNE      WSSONT
     C* ENDRING I TOPPLINJA.. NYTT SØK...
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C   30              GOTO      START3
     C  N30              GOTO      START
     C                   ELSE                                                    2
      * .... ELLER OPTION........
      * HVIS IKKE SPØRRING/PLUKKING (35 OG 38 AV), KAN MAN LAGE NY TUR
     C  N35
     CANN38W2NR          COMP      1                                      06
s05  C* N35
s05  C*NN38
S05  C*N 06W2PRO         COMP      0                                      06
     C   06              DO                                                       3<-B
N05  c     W2PRO         ifeq      0
N05  c     W2PRO         oreq      99999999
     C                   MOVE      *ZEROS        W2NR
     C                   GOTO      START4
N05  c                   endif
     C                   END                                                      3<-E
     C     W2PRO         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0092'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYOPT
     C  N30WSNR          IFEQ      1
     C                   GOTO      SLUTT
     C                   END
     C                   END                                                      3<-E
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C* ENTER ER TASTET TEST HVA SOM ER TASTET
     C*
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENTSR
     C     WSNR          IFEQ      1
N16  C     *in30         andeq     '0'
     C                   GOTO      SLUTT
     C                   END
     C                   GOTO      START3
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
      ***********************************************
     C     MOVTUZ        BEGSR
      ***********************************************
      * Bevar subfil-felt for sist leste record (Hvis det er 1. rec.
      * på side 2,3,4... er den ennå ikke lagt ut i subfila - feltene
      * fra TURER kan bli "ødelagt" før en blar til neste side).
     C                   MOVE      TUDT          ZDT               8 0
     C                   MOVE      ISTAT1        ZSTAT1            1
     C                   MOVE      ISTAT2        ZSTAT2            1
     C                   MOVE      TUAVD         ZAVD              4 0
     C                   MOVE      TUPRO         ZPRO              8 0
     C                   MOVE      TUBILN        ZBILN            10
s14  C*                  MOVE      XXBILN        ZXBILN            9
     C                   MOVE      XXSDF         ZSDF              5
     C                   MOVE      WSDATF        ZDATF             6 0
     C                   MOVE      TUTM          ZTM               4 0
     C                   MOVE      XXSDT         ZSDT              5
     C                   MOVE      WSDATT        ZDATT             6 0
     C                   MOVE      TUDTT         ZDTT              8 0
     C                   MOVE      TUTMT         ZTMT              4 0
     C                   MOVE      TURUND        ZRUND             8 0
     C                   MOVE      TUTST1        ZTST1             1
     C                   MOVE      TUST          ZST               1
     C                   ENDSR
      ***********************************************
     C     MOVZTU        BEGSR
      ***********************************************
      * Legger tilbake subfil-felt for 1. rec. på side 2,3....
     C                   MOVE      ZDT           TUDT
     C                   MOVE      ZSTAT1        ISTAT1
     C                   MOVE      ZSTAT2        ISTAT2
     C                   MOVE      ZAVD          TUAVD
     C                   MOVE      ZPRO          TUPRO
     C                   MOVE      ZBILN         TUBILN
s14  C*                  MOVE      ZXBILN        XXBILN
     C                   MOVE      ZSDF          XXSDF
     C                   MOVE      ZDATF         WSDATF
     C                   MOVE      ZDTT          TUDTT
     C                   MOVE      ZTM           TUTM
     C                   MOVE      ZSDT          XXSDT
     C                   MOVE      ZDATT         WSDATT
     C                   MOVE      ZTMT          TUTMT
     C                   MOVE      ZRUND         TURUND
     C                   MOVE      ZTST1         TUTST1
     C                   MOVE      ZST           TUST
     C                   ENDSR
     C***********************************************
     C     TESTB0        BEGSR
     C***********************************************
     C     KODAKA        CHAIN     KODTA                              96
     C     *IN96         IFEQ      '1'
     C                   MOVE      'SPA0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   ELSE
     C                   MOVE      WSAVDA        UDSAVD
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
      ** W2-VARIABLENE SAMMENLIGNES MED WS... IKKE MED 0/BLANK
     C     W2AVD         IFNE      WSAVD
     C                   MOVE      W2AVD         WSAVD             4 0
     C                   END
     C     W2ST2         IFNE      WSSKOD                                       1<-B
     C                   MOVE      W2ST2         WSSKOD            1
     C                   END                                                    1<-E
     C     W2PRO         IFNE      WSPRO                                        1<-B
     C                   MOVE      W2PRO         WSPRO             8 0
     C                   END                                                    1<-E
     C     W2BILN        IFNE      WSBILN                                       1<-B
     C                   MOVEL     W2BILN        WSBILN           10
     C                   END                                                    1<-E
     C     W2STEF        IFNE      WSSTEF                                       1<-B
     C                   MOVE      W2STEF        WSSTEF            5
     C                   END                                                    1<-E
     C     W2DATF        IFNE      WSBDAT                                       1<-B
     C                   MOVE      W2DATF        WSBDAT
     C                   END                                                    1<-E
     C     W2STET        IFNE      WSSTET                                       1<-B
     C                   MOVE      W2STET        WSSTET            5
     C                   END                                                    1<-E
     C     W2SONF        IFNE      WSSONF                                       1<-B
     C                   MOVE      W2SONF        WSSONF            5
     C                   END                                                    1<-E
     C     W2SONT        IFNE      WSSONT                                       1<-B
     C                   MOVE      W2SONT        WSSONT            5
     C                   END                                                    1<-E
      *
     C                   EXSR      TSTSØK
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYOPT         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      UDSAVD        W2AVD
     C                   END
     C     WRK2K         CHAIN(N)  TURER                              98
     C   98              MOVE      'SPT0002'     MSGNR
     C  N98W2NR          IFNE      5
     C     W2NR          andne     52
     C     W2NR          andne     51
N08  C     W2NR          andne     55
N09  C     W2NR          andne     25
     C  N98W2PRO         CHAIN     AVSLUTL2                           33
     C  N98
     CANN33              DO
     C                   MOVE      'SHU0580'     MSGNR
     C                   SETON                                        9830
     C                   GOTO      STNYO2
     C                   END
     C                   END
      *
     C  N98              DO
     C                   SELECT
     C     W2NR          WHENEQ    1
     C     *IN36         IFEQ      '1'
     C     *IN38         OREQ      '1'
     C                   GOTO      STNYO1
     C                   END
     C     W2NR          WHENEQ    2
     C     *IN36         IFEQ      '1'
     C     *IN37         OREQ      '1'
     C                   GOTO      STNYO1
     C                   END
     C     W2NR          WHENEQ    5
     C                   GOTO      STNYO1
     C     *IN38         WHENEQ    '0'
     C     W2NR          IFEQ      3
     C     W2NR          OREQ      4
     C     W2NR          OREQ      6
     C     W2NR          OREQ      7
     C     W2NR          OREQ      8
     C     W2NR          OREQ      9
N23  C     W2NR          OREQ      11
N23  C     W2NR          OREQ      12
     C     W2NR          OREQ      13
     C     W2NR          OREQ      14
     C     W2NR          OREQ      15
     C     W2NR          OREQ      17
N23  C     W2NR          OREQ      22
     C     W2NR          OREQ      28
     C     W2NR          OREQ      51
N09  C     W2NR          OREQ      25
N08  C     W2NR          OREQ      52
N22  C     W2NR          OREQ      53
N08  C     W2NR          OREQ      55
     C     W2NR          OREQ      70
N08  C     W2NR          OREQ      90
     C                   GOTO      STNYO1
     C                   END
     C                   ENDSL
     C                   END
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      STNYO2
      *
     C     STNYO1        TAG
     C                   MOVE      W2NR          WSNR
     C                   MOVE      *BLANKS       ISTAT1
     C                   MOVE      W2ST2         ISTAT2
     C                   MOVE      WSSKOD        W2ST2
     C                   MOVE      W2AVD         TUAVD
     C                   MOVE      W2PRO         TUPRO
     C                   MOVE      '1'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      WSAVD         W2AVD
     C                   MOVE      WSPRO         W2PRO
     C                   MOVEL     WSBILN        W2BILN
     C                   MOVE      WSSTEF        W2STEF
     C                   MOVE      WSBDAT        W2DATF
     C                   MOVE      WSSTET        W2STET
     C                   MOVE      WSSONF        W2SONF
     C                   MOVE      WSSONT        W2SONT
      *
     C     WSNR          IFEQ      4
     C     TUKEY         CHAIN(N)  TURER                              33
     C     *IN33         IFEQ      '0'
     C     TUST          ANDEQ     ' '
     C                   MOVE      *ZEROS        WSNR
     C                   MOVE      'JOV1418'     MSGNR
     C                   SETON                                            98
     C                   GOTO      STNYO2
     C                   ELSE
     C                   MOVE      'JOV1288'     MSGNR
     C                   SETON                                            98
     C                   GOTO      STNYO2
     C                   END
     C                   END
     C                   SELECT
     C     WSNR          WHENEQ    1
     C     *IN38         IFEQ      '0'
     C                   EXSR      OPT01A
     C                   ELSE
     C                   EXSR      OPT01B
     C                   END
     C     WSNR          WHENEQ    2
     C                   EXSR      OPT02
     C     WSNR          WHENEQ    3
     C                   EXSR      OPT03
     C     WSNR          WHENEQ    5
     C                   EXSR      OPT05
     C     WSNR          WHENEQ    6
     C                   EXSR      OPT06
     C     WSNR          WHENEQ    7
     C                   EXSR      OPT07
     C     WSNR          WHENEQ    8
     C                   EXSR      OPT08
     C     WSNR          WHENEQ    9
     C                   EXSR      OPT09
     C     WSNR          WHENEQ    10
     C                   EXSR      OPT10
N13  C     WSNR          WHENEQ    11
N13  C                   EXSR      OPT11
N23  C     WSNR          WHENEQ    12
N23  C                   EXSR      OPT12
N23  C     WSNR          WHENEQ    22
N23  C                   EXSR      OPT22
     C     WSNR          WHENEQ    13
     C                   MOVE      'I'           XXTY              1
     C                   EXSR      OPT1X
     C     WSNR          WHENEQ    14
     C                   MOVE      'E'           XXTY              1
     C                   EXSR      OPT1X
     C     WSNR          WHENEQ    15
     C                   MOVE      'B'           XXTY              1
     C                   EXSR      OPT1X
     C     WSNR          WHENEQ    17
     C                   EXSR      OPT17
     C     WSNR          WHENEQ    18
     C                   EXSR      OPT18
     C     WSNR          WHENEQ    26
     C     *IN37         ANDEQ     '1'
     C                   EXSR      OPT26
     C     WSNR          WHENEQ    28
     C                   EXSR      OPT28
     C     WSNR          WHENEQ    52
     C                   EXSR      OPT52
N22  C     WSNR          WHENEQ    53
N22  C                   EXSR      OPT53
N08  C     WSNR          WHENEQ    55
N08  C                   EXSR      OPT55
N25  C     WSNR          WHENEQ    59
N25  C                   EXSR      OPT59
     C     WSNR          WHENEQ    90
     C                   EXSR      OPT90
     C     WSNR          WHENEQ    51
     C                   EXSR      OPT51
n09  C     WSNR          WHENEQ    51
n09  C                   EXSR      OPT25
     C     WSNR          WHENEQ    70
     C                   EXSR      OPT70
     C                   ENDSL
      *
     C     STNYO2        TAG
     C   98              MOVE      '1'           *IN30
     C*
     C                   ENDSR
      *
     C***********************************************
     C     TstSFL        BEGSR
     C***********************************************
      * Også tester som IKKE har med PDA å gjøre men med refr av subfil
     C     TUPRO         CHAIN     AVSLUTG2                           78        N78=G.List motatt RI
     C     TUPRO         CHAIN     AVSLUTL2                           79        N79=Avsluttet  = Gul
     C     TUKEY         CHAIN     FREETUR2                           80        N80=Fri.finnes,avdRI
N12  c                   seton                                        81        N81=Farlig gods= Rød
      * PDA-tester
      * *IN71 = HENTET TIL PDA                                (Bilnr Rosa)
      * *IN72 = SKAL TIL PDA - ENNÅ IKKE HENTET               (Bilnr Gul)
      * *IN73 = PDA HAR ENDRET ANT/VEKT MM, ENNÅ IKKE SJEKKET (Bilnr REV Image)
      * *IN74 = Det finnes ulest merknad fra PDA på Tur-nivå  (Avd Rød  )
      * *IN75 = Det finnes ulest merknad fra PDA på Snd-nivå  (Avd Rosa )
S11  C*                  Movea     '00000'       *in(71)
N11  C                   Movea     '000000'      *in(71)
N11  C     TUTST4        comp      '2'                                    76    Ferdig
     C     TUTST4        comp      '1'                                    71    På PDA
     c     TUSJA1        Ifne      *zeros
N21  c     TUTST4        andeq     ' '
     C  N71'PDA'         SCAN      TUSJN1                                 72    Tildelt/ikke på PDA
     c                   end
N21  C     TUTST4        ifeq      '3'
N21  C                   seton                                        7672      Ikke aktuelt..
N21  C                   endif
      * HVIS HENTET TIL PDA(ROSA)->Div andre RevImg/fargekoder (se over)
     C     *in71         IFEQ      '1'
      * fritekst fra
     c     PDFTTKey      Chain     FreeTur2                           33
     C  N33              Move      *ON           *IN74
     C     Tupro         setll     Head11
     C     Tupro         Reade     Head11                                 33
     C     *in33         doweq     *OFF
     c     TTCHGKey      Chain     TRACKl02                           33
     C  N33              Move      *ON           *IN73
     C     *in74         Ifeq      *off
s01  c*    PDFTSKey      Chain     FreeTxt2                           33
N01  c     PDFTSKey      Chain     FreeTxt3                           33
     C  N33              Move      *ON           *IN75
     C                   end
     C     Tupro         Reade     Head11                                 33
     C                   end
     C                   end
N10   * sjekk farlig gods
N10  C     Tupro         setll     Head11
N10  C     Tupro         Reade     Head11                                 33
N10  C     *in33         doweq     *OFF
N10  c     TRFA11        ifne      *blanks
N10  c     TRFA21        orne      *blanks
s12  C*                  setoff                                       79
N12  C                   setoff                                       81
N10  c                   GOTO      UTFG
N10  C                   end
N10  C     Tupro         Reade     Head11                                 33
N10  C                   end
N10  C     utfg          TAG
      **
      * FINN TURENS RESULTAT I PROSENT AV OPPNÅDD RESULTATMÅL/ESTIMAT
n15  c                   z-ADD     0             abelop           13 2
n15  c                   z-ADD     0             fbelop           13 2
n15  c                   z-ADD     0             ubelop           13 2
n15  c                   z-ADD     0             BUDSJ            11 2
n15  C                   Z-ADD     0             TURES             5 2
n15  c                   exsr      beregna
n15  c     tukey         chain     travh1                             33
n15  c     *in33         ifeq      '0'
n15  c                   z-add     thtot         abelop           13 2
n15  c                   end
n17  c     abelop        ifeq      0
n17  c                   exsr      kostsr
n17  c                   z-add     kosttu        abelop
n17  c                   end
      *
      * Sum frakt/fraktrelaterte inntekter
      *
N15  c                   move      ' '           kodet
n15  c                   call      'SYGE83'
n15  c                   parm                    Tupro
n15  c                   parm                    kodet             1
n15  c                   parm                    fbelop           13 2
n15   *
n15   * eller hente budsjett
n15   *
n15  c                   move      Tupro         uproa             8
N15  c                   call      'SYGE79TCL'
N15  c                   parm                    uproa
N15  c                   parm                    wstvalb           3
N15  c                   parm                    budsj            11 2
N15  c                   parm                    wstakob           1
      *
      * finner transportøres tall
      *
n15  c                   move      *zeros        work             15 5
N15  c     ABELOP        ifne      0
n15  c     ABELOP        SUB       budsj         work             15 5
N15  C     WORK          DIV       ABELOP        WORK
     c                   mult      100           work
N15  c                   end
n15  c                   z-add     work          TURES
N15  c                   setoff                                       8283
N15  c     tures         comp      0                                    82
N15  c  N82tures         comp      25                                   83
n15  c                   movel     tures         tureth
      *
      * finner egne verdier
      *
n15  c                   move      tures         work             15 5
n15  c                   move      *zeros        work             15 5
N15  c     FBELOP        ifne      0
n15  c     fbelop        SUB       ABELOP        work             15 5
N15  C     WORK          DIV       FBELOP        WORK
     c                   mult      100           work
N15  c                   end
n15  c                   z-add     work          TURES
N15  c                   setoff                                       8485
N15  c     tures         comp      0                                    84
N15  c  N84tures         comp      25                                   85
n15  c                   movel     tures         tureeh
     C                   ENDSR
     C***********************************************
     C     TILTUR        BEGSR
     C***********************************************
     C     UAVD          IFEQ      *ZEROS
     C                   MOVE      UUAVD         UAVD
     C                   END
     C                   CALL      'SYTR88A'
     C                   PARM                    UDSFIR
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   PARM                    URUND
     C                   PARM                    UUOPD
     C                   PARM                    AVDCOP
     C                   PARM                    UUSPØR
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      3                                      03
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
     C                   MOVE      'N'           F11               1
     C                   SETOFF                                         9830
     C                   Z-ADD     0             ANTLES            2 0
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C*
     C* VED 0 LESTE GI FEILMELDING
     C*
     C   98ANTLES        IFEQ      0                                             2<-B
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   GOTO      SLHENT
     C                   ELSE                                                    2
     C                   GOTO      SLHENT
     C                   END                                                     2<-E
     C*
     C                   ADD       1             ANTLES
      *
      * TUR MÅ IKKE VÆRE AVSLUTTET
      *
     C     WSNR          IFNE      5
     C     WSNR          andne     52
     C     WSNR          andne     51
N22  C     WSNR          andne     53
N08  C     WSNR          andne     55
n09  C     WSNR          andne     25
     C     TUPRO         CHAIN     AVSLUTL2                           33
     C  N33              DO
     C                   MOVE      'SHU0580'     MSGNR
     C                   MOVE      *ZEROS        WSNR                 9830
     C                   SETON                                        9830
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C* PLUKKING  12 = RETURNER VED PLUKKING
     C*
     C     UUSPØR        IFEQ      'P'                                           2<-B
     C     WSNR          ANDEQ     1
     C                   EXSR      OPT01A
     C                   GOTO      SLHENT
     C                   END                                                     2<-E
     C*
     C* PLUKKING  VED ORDRELETING
     C*
     C   38WSNR          IFEQ      1                                             2<-B
     C                   EXSR      OPT01B
     C                   GOTO      SLHENT
     C                   END                                                     2<-E
     C*
     C     WSNR          IFEQ      7                                             2<-B
     C                   EXSR      OPT07
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C     WSNR          IFEQ      6                                             2<-B
     C                   EXSR      OPT06
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C     WSNR          IFEQ      8                                             2<-B
     C                   EXSR      OPT08
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C     WSNR          IFEQ      9                                             2<-B
     C                   EXSR      OPT09
     C                   GOTO      OK
     C                   END                                                     2<-E
E08   * Opt 10 flyttet opp på 'rett sted'
     C     WSNR          IFEQ      10
     C                   EXSR      OPT10
     C                   GOTO      OK
     C                   END
E08   * Opt 10 flyttet opp på 'rett sted'
N13  C     WSNR          IFEQ      11
N13  C                   EXSR      OPT11
N13  C                   GOTO      OK
N13  C                   END
N23  C     WSNR          IFEQ      12
N23  C                   EXSR      OPT12
N23  C                   GOTO      OK
N23  C                   END
N23  C     WSNR          IFEQ      22
N23  C                   EXSR      OPT22
N23  C                   GOTO      OK
N23  C                   END
     C*
     C     WSNR          IFEQ      17                                            2<-B
     C                   EXSR      OPT17
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C     WSNR          IFEQ      18
     C                   EXSR      OPT18
     C                   GOTO      OK
     C                   END                                                     2<-E
      *
      *
     C   37WSNR          IFEQ      26                                            2<-B
     C                   EXSR      OPT26
     C                   GOTO      OK
     C                   END                                                     2<-E
     C     WSNR          IFEQ      28
     C                   EXSR      OPT28
     C                   GOTO      OK
     C                   END                                                     2<-E
E08   * Opt 51 flyttet opp på 'rett sted'
     C     WSNR          IFEQ      51
     C                   EXSR      OPT51
     C                   GOTO      OK
     C                   END                                                     2<-E
N09   * Opt 25 track & trace
n09  C     WSNR          IFEQ      25
n09  C                   EXSR      OPT25
n09  C                   GOTO      OK
n09  C                   END                                                     2<-E
     C     WSNR          IFEQ      52
     C                   EXSR      OPT52
     C                   GOTO      OK
     C                   END                                                     2<-E
N22  C     WSNR          IFEQ      53
N22  C                   EXSR      OPT53
N22  C                   GOTO      OK
N22  C                   END                                                     2<-E
N08  C     WSNR          IFEQ      55
N08  C                   EXSR      OPT55
N08  C                   GOTO      OK
N08  C                   END                                                     2<-E
N25  C     WSNR          IFEQ      59
N25  C                   EXSR      OPT59
N25  C                   GOTO      OK
N25  C                   END                                                     2<-E
E08   * Opt 70 Flyttet opp på 'rett sted'
     C     WSNR          IFEQ      70                                            2<-B
     C                   EXSR      OPT70
     C                   GOTO      OK
     C                   END                                                     2<-E
     C     WSNR          IFEQ      90
     C                   EXSR      OPT90
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C*
     C* ORDREUTSKRIFT INTERN / EKSTERN (KJØREORDRE)/BEGGE
     C     WSNR          IFEQ      13                                            2<-B
     C                   MOVE      'I'           XXTY              1
     C                   EXSR      OPT1X
     C                   GOTO      OK
     C                   END                                                     2<-E
     C     WSNR          IFEQ      14                                            2<-B
     C                   MOVE      'E'           XXTY              1
     C                   EXSR      OPT1X
     C                   GOTO      OK
     C                   END                                                     2<-B
     C     WSNR          IFEQ      15
S02  C*                  MOVE      'T'           XXTY              1
N02  C                   MOVE      'B'           XXTY              1
     C                   EXSR      OPT1X
     C                   GOTO      OK                                            2<-E
     C                   END
     C*
     C* SPØRRING
     C*
     C     WSNR          IFEQ      5                                             2<-B
     C                   EXSR      OPT05
     C   03              GOTO      SLHENT
     C   12              GOTO      SLHENT
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C* VED SPØRRING KAN MAN IKKE GJØRE NOE ANNET
     C*
     C     UUSPØR        IFEQ      'J'                                           2<-B
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   GOTO      SLHENT
     C                   END                                                     2<-E
     C*
     C* KOPIERING AV EN TUR
     C*
     C     WSNR          IFEQ      3                                             2<-B
     C                   EXSR      OPT03
     C*
     C   03              GOTO      SLHENT
     C   12              GOTO      SLHENT
     C                   GOTO      OK
     C                   END                                                     2<-E
     C*
     C*   START ENDRING AV TUR
     C*
     C     WSNR          IFEQ      4
     C     TUKEY         CHAIN(N)  TURER                              33
     C     *IN33         IFEQ      '0'
     C     TUST          ANDEQ     ' '
     C                   MOVE      *zeros        WSNR
     C                   MOVE      'JOV1418'     MSGNR
     C                   exsr      TstSFL
     C                   UPDATE    SUBFIL
     C                   SETON                                            30
     C                   GOTO      SLHENT
     C                   ELSE
     C                   MOVE      'JOV1288'     MSGNR
     C                   SETON                                            30
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C     WSNR          IFEQ      2                                             2<-B
     C                   EXSR      OPT02
     C   03
     COR 12
     COR 30              GOTO      SLHENT
     C                   ELSE                                                    2
     C*
     C* SLUTT TESTE AV STATUS  UGYLDIG OPTION ER VALGT
     C*
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   exsr      TstSFL
     C                   UPDATE    SUBFIL
     C*
     C                   END                                                     2<-E
     C*
     C     OK            TAG
     C* END  98
     C                   END                                                    1<-E
     C*
     C     SLHENT        ENDSR
     C*
     C***********************************************
     C     OPT01A        BEGSR
     C***********************************************
N16   * SJEKK OM FARLIG GODS SOM IKKE KAN SAMLASTES
N16  C                   SETOFF                                       30
N19  C     OPDKEY        CHAIN(N)  HEADF
N19  C     HESTN8        IFNE      'X'
N24  c     HESGM         andeq     *blanks
N16  C                   CALL      'SYGE84'
N16  C                   PARM      UUAVD         UFARAVD           4 0
N16  C                   PARM      UUOPD         UFAROPD           7 0
N16  C                   PARM      TUPRO         UFARPRO           8 0
N16  C                   PARM                    UFARSAM           1
N16  C     UFARSAM       IFEQ      '1'
N16  C                   MOVE      'JOV1673'     MSGNR
N16  C                   SETON                                        30
N16  C                   GOTO      UTPLUK
N16  C                   ENDIF
N18  C     UFARSAM       IFEQ      '2'
N18  C                   MOVE      'JOV1676'     MSGNR
N18  C                   SETON                                        30
N18  C                   GOTO      UTPLUK
N18  C                   ENDIF
N18  C     UFARSAM       IFEQ      '3'
N18  C                   MOVE      'JOV1677'     MSGNR
N18  C                   SETON                                        30
N18  C                   GOTO      UTPLUK
N18  C                   ENDIF
N19  C                   ENDIF
     C                   MOVE      TUAVD         UAVD
     C                   MOVE      TUPRO         UPRO
     C                   MOVE      TURUND        URUND
     C                   EXSR      FIXTUR
      *
N16  C     UTpluk        TAG
     C                   ENDSR
      *
     C***********************************************
     C     OPT01B        BEGSR
     C***********************************************
     C                   MOVE      TUAVD         UUAVD
     C                   MOVE      TUPRO         UUPRO
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT02         BEGSR
     C***********************************************
     C                   MOVE      TUAVD         UAVD
     C                   MOVE      TUPRO         UPRO
     C                   MOVE      TURUND        URUND
      *
      * VANLIG ENDRING AV TUR
      *
     C     ISTAT1        IFEQ      *BLANKS                                      1<-B
     C     ISTAT2        ANDEQ     *BLANKS
     C     UPRO          CHAIN     AVSLUTL2                           33
     C  N33              DO
     C                   MOVE      'SHU0580'     MSGNR
     C                   SETON                                        30
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   GOTO      SLOP03
     C                   END
     C     TUST          IFEQ      ' '                                           2<-B
S20  C*    TUSG          IFNE      'WEB'                                          3<-B
s04  C*    TUDTT         ORLE      XIDAG
s04  C*    TUDTT         ANDNE     0
S20  C*    TUATA         ORLE      XIDAG
S20  C*    TUATA         ANDNE     0
     C                   EXSR      TILTUR
S20  C*                  END
     C     TURERK        CHAIN(N)  TURER                              30
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   ELSE                                                    2
     C     TUST          IFEQ      'A'                                            3<-B
     C     TUST          OREQ      'B'                                            3<-B
     C     TUST          OREQ      'C'
     C                   MOVE      'JOV0421'     MSGNR
     C                   SETON                                        30
     C                   MOVE      *ZEROS        WSNR
     C                   MOVE      'J'           F11
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   ELSE                                                     3
     C                   MOVE      'JOV0420'     MSGNR
     C                   SETON                                        30
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   GOTO      SLOP03
     C                   END                                                    1<-E
      *
      * FORSØK PÅ STATUSENDRING
      *
      *
      * ENDRING AV PRINT AV KONVOLUTT
      *
     C     ISTAT1        IFNE      *BLANKS                                      1<-B
     C     ISTAT1        IFEQ      'Y'                                           2<-B
     C     ISTAT1        OREQ      '0'
     C     ISTAT1        OREQ      'P'
     C     TURERK        CHAIN     TURER                              30
     C  N30              MOVE      ISTAT1        TUTST1
     C  N30ISTAT1        IFEQ      '0'                                            3<-B
     C                   MOVE      ' '           TUTST1
     C                   END                                                      3<-E
     C  N30              EXCEPT    OTUST1
      *
      * OPPDATERER SUBFIL HVIS ANDRE STATUS ER BLANK
      *
     C  N30ISTAT2        IFEQ      ' '                                            3<-B
     C                   MOVE      ' '           ISTAT1
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   GOTO      SLOP03
     C                   END                                                      3<-E
      * FEIL
     C                   ELSE                                                    2
     C                   MOVE      'DIV4019'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLOP03
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      * SLUTT ENDRE STATUS KONVOLUTT
      *
      * START ENDRE STATUS PÅ TUREN
      *
     C     ISTAT2        IFEQ      'A'                                          1<-B
     C     ISTAT2        OREQ      'D'
     C     ISTAT2        OREQ      '0'
     C     TURERK        CHAIN     TURER                              30
      *
      * RETTELSE FRA ' ' TIL 'A'       FERDIGMELD
      *
     C     TUST          IFEQ      ' '                                           2<-B
     C     ISTAT2        IFEQ      'A'                                            3<-B
     C                   MOVE      'A'           NYSTAT            1
     C                   EXSR      SETSTA
     C                   MOVE      'A'           TUST
     C                   EXCEPT    PTUR
     C                   MOVE      ' '           ISTAT2
     C                   MOVE      ' '           ISTAT1
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C     TUSONF        IFEQ      *BLANKS                                         4<-B
     C     TUSONT        OREQ      *BLANKS
     C                   CALL      'SYTR88E'
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   END                                                       4<-E
     C                   GOTO      SLOP03
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
      * RETTELSE FRA A/B/C TIL ' '          FRIGJØR
      *
     C     TUST          IFEQ      'A'                                           2<-B
     C     TUST          OREQ      'B'                                           2<-B
     C     TUST          OREQ      'C'                                           2<-B
     C     ISTAT2        ANDEQ     '0'
     C                   MOVE      ' '           NYSTAT            1
     C                   EXSR      SETSTA
     C                   MOVE      ' '           TUST
     C                   EXCEPT    PTUR
     C                   MOVE      *ZEROS        WSNR
     C                   MOVE      ' '           ISTAT2
     C                   MOVE      ' '           ISTAT1
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   GOTO      SLOP03
     C                   END                                                     2<-E
      *
      * RETTELSE FRA ' ' TIL 'D'       SLETT TUR FRIGJØR OPPDRAG
      *
     C     ISTAT2        IFEQ      'D'                                           2<-B
     C                   MOVE      'D'           NYSTAT            1
     C                   EXSR      SETSTA
     C                   MOVE      'D'           TUST
     C                   MOVE      *ZEROS        TUSJA1
     C                   MOVE      *ZEROS        TUAO
     C                   MOVE      *ZEROS        TUTS
     C                   MOVE      *ZEROS        TUTVKT
     C                   MOVE      *ZEROS        TUTLM
N14  C                   MOVE      *ZEROS        TUTLM2
N14  C                   MOVE      *ZEROS        TUPOEN
     C                   MOVE      *ZEROS        TUTM3
     C                   UPDATE    TURERR
      * FJERNER KOSTNADSLINJE GENERERT FRA TURER
      * Åpne fila om ikke den er brukt før...
     C     KOSBOP        IFNE      '1'                                            3<-B
     C                   OPEN      KOSBU
     C                   END                                                      3<-E
     C     TUTREF        CHAIN     KOSBU                              34
     C  N34              DELETE    KOSBUR
      * FJERNER FERJEOVERFARTER
      * Åpne fila om ikke den er brukt før...
     C     TUFEOP        IFNE      '1'                                            3<-B
     C                   OPEN      TUFE
     C                   END                                                      3<-E
     C     TUKEY         SETLL     TUFE
     C     STO031        TAG
     C     TUKEY         READE     TUFE                                   34
     C  N34              DELETE    TUFER
     C  N34              DO                                                       3<-B
     C     FETREF        IFNE      *ZEROS                                          4<-B
     C     FETREF        CHAIN     KOSBU                              34
     C  N34              DELETE    KOSBUR
     C   34              SETOFF                                       34
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C  N34              GOTO      STO031
      *
      * FJERNER REISEKASSER
      * Åpne fila om ikke den er brukt før...
     C     REISOP        IFNE      '1'                                            3<-B
     C                   OPEN      REIS
     C                   END                                                      3<-E
     C     TUKEY         SETLL     REIS
     C     STO032        TAG
     C     TUKEY         READE     REIS                                   34
     C  N34              DELETE    REISR
     C  N34              GOTO      STO032
      *
      * FJERNER TILLATELSER
      * Åpne fila om ikke den er brukt før...
     C     TILLOP        IFNE      '1'                                            3<-B
     C                   OPEN      TILL
     C                   END                                                      3<-E
     C     TUKEY         SETLL     TILL
     C     STO033        TAG
     C     TUKEY         READE     TILL                                   34
     C  N34              DELETE    TILLR
     C  N34              GOTO      STO033
      *
     C                   MOVE      *ZEROS        WSNR
     C                   MOVE      ' '           ISTAT2
     C                   MOVE      ' '           ISTAT1
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   GOTO      SLOP03
     C                   END                                                     2<-E
      *
      * RETTELSE FRA 'D' TIL ' '       FRIGJØR SLETTET OPPDRAG
      *
     C     TUST          IFEQ      'D'                                           2<-B
     C     ISTAT2        ANDEQ     '0'
     C                   MOVE      ' '           TUST
     C                   EXCEPT    PTUR
     C                   MOVE      *ZEROS        WSNR
     C                   MOVE      ' '           ISTAT2
     C                   MOVE      ' '           ISTAT1
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   GOTO      SLOP03
     C                   END                                                     2<-E
      *
      * FEIL STATUSENDRING PÅ DISPONERINGSSTATUS   MEN A/D/0 VALGT
      *
     C                   MOVE      ' '           ISTAT1
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   EXCEPT    DUMTUR
      *
     C                   MOVE      'DIV4036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLOP03
      * FEIL
     C                   ELSE                                                   1
     C                   MOVE      'DIV4018'     MSGNR
     C                   SETON                                            30
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   GOTO      SLOP03
     C                   END                                                    1<-E
      *
     C     SLOP03        ENDSR
      *
     C***********************************************
     C     OPT03         BEGSR
     C***********************************************
     C                   MOVE      TUAVD         UAVD
     C                   MOVE      TUPRO         UPRO
     C                   MOVE      TURUND        URUND
     C                   MOVE      UUSPØR        UUSPØG            1
     C                   MOVE      'C'           UUSPØR
     C                   MOVE      UDSAVD        AVDCOP            4 0
     C                   EXSR      TILTUR
     C     UAVD          IFNE      WSAVDA
     C                   MOVE      UAVD          WSAVDA
     C                   MOVE      UAVD          UDSAVD
     C                   END
     C                   MOVE      UUSPØG        UUSPØR
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT05         BEGSR
     C***********************************************
     C                   MOVE      TUPRO         UPRO
     C                   MOVE      TUAVD         UAVD
     C                   MOVE      TURUND        URUND
     C                   MOVE      UUSPØR        UUSPØG            1
     C                   MOVE      'J'           UUSPØR
     C                   EXSR      TILTUR
     C                   MOVE      UUSPØG        UUSPØR
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT06         BEGSR
     C***********************************************
     C                   MOVE      'N'           UKOST             1
     C                   CALL      'SYTR17'
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   PARM                    TURUND
     C                   PARM                    UKOST
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT07         BEGSR
     C***********************************************
     C                   MOVE      'T'           P1FLAG
     C                   MOVE      *ZEROS        P1BNR
     C                   MOVE      TUAVD         P1AVD
     C                   MOVE      TUPRO         P1TUNR
     C                   MOVE      *ZEROS        P1OAVD
     C                   MOVE      *ZEROS        P1OPD
     C                   MOVE      *ZEROS        P1BL
     C                   MOVE      P1DS          PARM1           256
     C                   CALL      'SYKS12'
     C                   PARM                    PARM1
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT28         BEGSR
     C***********************************************
     C                   CALL      'SYTR07'
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPT52         BEGSR
      ***********************************************
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     TUPRO         SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   ENDSR
N22   ***********************************************
N22  C     OPT53         BEGSR
N22   ***********************************************
N22   * type bør kunne parametersette på firma/user-nivå i SYPARF
N22  C                   MOVE      'ZH'          SCATYP            2
N22  C                   MOVEL     TUPRO         SCATUR            8
N22  c     TypTag        Tag
N22  C                   EXFMT     ARKTYP
N22  c     *in04         IFEQ      '1'
N22  c                   CALL      'ARCA000B'
N22  C                   PARM                    SCATYP
N22  c                   goto      Typtag
N22  c                   endif
N22  c     *in12         ifne      *on
N22  C                   CALL      'ARCA000T'
N22  C                   PARM                    SCATYP
N22  C                   PARM                    SCATUR
N22  C                   MOVE      *ZEROS        WSNR
N22  c                   endif
N22  C  N90              exsr      TstSFL
N22  C  N90              UPDATE    SUBFIL
N22  C                   ENDSR
      ***********************************************
     C     OPT51         BEGSR
      ***********************************************
     C                   MOVEL     'T:'          uuparu
     C                   MOVE      TUPRO         uuparu           10
     C                   CALL      'ARC003'
     C                   PARM                    uuuavd            4 0
     C                   PARM                    uuuopd            7 0
     C                   PARM                    uuparu
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   ENDSR
n09   ***********************************************
n09  C     OPT25         BEGSR
n09   ***********************************************
n09  C                   MOVE      TUPRO         tttur             8 0
n09  C                   MOVE      TUAVD         ttavd             4 0
n09  C                   Z-ADD     0             TTopd             7 0
n09  C                   Z-ADD     1             TTFLAG            1 0
n09  C                   CALL      'SYTT01CL'
n09  C                   PARM                    TTAVD
n09  C                   PARM                    ttopd
n09  C                   PARM                    TTTUR
n09  C                   PARM                    TTFLAG
n09  C                   MOVE      *ZEROS        WSNR
n09  C  N90              exsr      TstSFL
n09  C  N90              UPDATE    SUBFIL
n09  C                   ENDSR
N08
N08   ***********************************************
N08  C     OPT55         BEGSR
N08   ***********************************************
N08  C                   EVAL      Overskr = 'Se SYSPED tur på WEB (eSped) '
N08  C                   EVAL      WebType = 'ESPET'
N08  C                   MOVE      TUPRO         XXTPRO
N08  C                   EVAL      WebSok  = '&tur='+XXTPRO
N08  C                   CALL      'WEBLINKR'
N08  C                   PARM                    Overskr          40
N08  C                   PARM                    WebType           5
N08  C                   PARM                    WebSok           50
N08  C                   MOVE      *ZEROS        WSNR
N08  C  N90              exsr      TstSFL
N08  C  N90              UPDATE    SUBFIL
N08  C                   ENDSR
N25   ***********************************************
N25  C     OPT59         BEGSR
N25   ***********************************************
N25   * Upload direkte via eSpedsg
N25  C                   CALL      'UPLOADSG'
N25  C                   PARM                    NullAVD           4 0
N25  C                   PARM                    NullOPD           7 0
N25  C                   PARM                    TUPRO
N25  C                   PARM                    ZUSER
N25  C                   MOVE      *ZEROS        WSNR
N25  C  N90              exsr      TstSFL
N25  C  N90              UPDATE    SUBFIL
N25  C                   ENDSR
     C***********************************************
     C     OPT08         BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYTR31'
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT09         BEGSR
     C***********************************************
     C                   CALL      'SYTR08'
     C                   PARM                    TUAVD
     C                   PARM                    TUPRO
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT1X         BEGSR
      * OPSJON 13, 14, 15
     C***********************************************
     C                   MOVE      TUAVD         XXTAVD            4
     C                   MOVE      TUPRO         XXTPRO            8
N03  C                   MOVE      *ZEROS        XXTOPD            7
     C                   CALL      'SYTR40CB'
     C                   PARM      XXTAVD        XXTAVD
     C                   PARM      XXTPRO        XXTPRO
N03  C                   PARM      XXTOPD        XXTOPD
     C                   PARM      XXTY          XXTY
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT17         BEGSR
     C***********************************************
     C     TUAVD         CHAIN     TRUSTD                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *ZEROS        UTDN              7 0
     C                   MOVE      USG           USG2              3
     C                   MOVE      'CRT'         UTYPE             3
     C                   CALL      'TR011C'
     C                   PARM                    TUAVD
     C                   PARM                    UTDN
     C                   PARM                    TUPRO
     C                   PARM                    USG2
     C                   PARM                    UTYPE
N11  C                   PARM                    UIE               1
     C                   PARM                    UFLAGG            1 0
     C                   ELSE
     C                   MOVE      '0'           UIN01             1
     C                   MOVE      '0'           UANT              1
     C                   CALL      'SAD025CT'
     C                   PARM                    UIN01
     C                   PARM      TUAVD         UAVD
     C                   PARM      TUPRO         UPRO
     C                   PARM                    UANT
     C                   END
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT18         BEGSR
     C***********************************************
     C                   CALL      'SYTR22CD'
     C                   PARM                    TUAVD
     C                   PARM                    USG
     C                   PARM                    TUPRO
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
N13  C***********************************************
N13  C     OPT11         BEGSR
N13  C***********************************************
N13  C                   CALL      'SYFA55CD'
N13  C                   PARM                    TUAVD
N13  C                   PARM                    USG
N13  C                   PARM                    TUPRO
N13  C                   MOVE      *ZEROS        WSNR
N13  C  N90              exsr      TstSFL
N13  C  N90              UPDATE    SUBFIL
N13   *
N13  C                   ENDSR
N23  C***********************************************
N23  C     OPT12         BEGSR
N23  C***********************************************
N23   * send gosdsliste som mail med klikkbare lenker
N23  c                   move      Tupro         uproa
N23  C                   CALL      'SYGE72T'
N23  C                   PARM                    uproa
N23  C                   MOVE      *ZEROS        WSNR
N23  C  N90              exsr      TstSFL
N23  C  N90              UPDATE    SUBFIL
N23   *
N23  C                   ENDSR
N23  C***********************************************
N23  C     OPT22         BEGSR
N23  C***********************************************
N23   * send gosdsliste som sms-lenke (til WEB-prog)
N23  c                   move      Tupro         uproa
N23  C                   CALL      'SYGE72S'
N23  C                   PARM                    uproa
N23  C                   MOVE      *ZEROS        WSNR
N23  C  N90              exsr      TstSFL
N23  C  N90              UPDATE    SUBFIL
N23   *
N23  C                   ENDSR
     C***********************************************
     C     OPT26         BEGSR
     C***********************************************
     C     FIURBL        IFEQ      'J'
     C                   MOVE      TUPRO         UTTPRO            8
     C                   CALL      'SYTT03CL'
     C                   PARM                    UTTPRO
     C                   END
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C*
     C***********************************************
     C     OPT10         BEGSR
     C***********************************************
     C                   MOVE      TUPRO         UTTPRO            8
     C                   MOVE      ' '           UTTYPE            1
     C                   CALL      'SYTR88S'
     C                   PARM                    UTTPRO
     C                   PARM                    UTTYPE            1
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPT70         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        UAVD2             4 0
     C                   MOVE      *ZEROS        UOPD2             7 0
     C                   MOVE      TUPRO         UTNO2             8 0
     C                   CALL      'SYIS10A'
     C                   PARM                    FIFIRM
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    UTNO2
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPT90         BEGSR
      ***********************************************
      * Avd/opd er parameter for POD-prog. NEGATIVT OPPDRNR er indikasjon på at det er turnr
     C                   MOVEL     TUPRO         PODAVD3           3 0          3 første av turnr
     C                   MOVE      TUPRO         PODOPD            7 0          5 siste  av turnr
     C                   Z-ADD     PODAVD3       PODAVD            4 0
     C                   mult      -1            PODOPD
     C                   MOVE      PODAVD        PODAVDa           4
     C                   MOVE      PODOPD        PODOPDa           7
     C                   CALL      'SYFA94R'
     C                   PARM                    PODAVDa
     C                   PARM                    PODOPDa
     C                   MOVE      *ZEROS        WSNR
     C  N90              exsr      TstSFL
     C  N90              UPDATE    SUBFIL
     C                   ENDSR
     C***********************************************
     C     TSTSØK        BEGSR
     C***********************************************
     C                   SETOFF                                       703099
     C                   SETOFF                                       313240
     C                   MOVEA     '0000'        *IN(26)
     C*
     C                   EXSR      MAX
     C* TEST
     C     WSSKOD        IFNE      ' '
     C     WSSKOD        ANDNE     '0'
     C     WSSKOD        ANDNE     'A'
     C     WSSKOD        ANDNE     'B'
     C     WSSKOD        ANDNE     'C'
     C     WSSKOD        ANDNE     'D'
     C     WSSKOD        ANDNE     'P'
     C                   MOVE      'DIV4040'     MSGNR
     C                   SETON                                        3070
     C                   END
     C*
     C     WSAVD         IFNE      0
     C     WSPRO         ORNE      0
     C     KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0009'     MSGNR
     C   99              SETON                                        30
     C  N99WSPRO         IFEQ      *ZEROS
     C                   MOVE      99999999      WSPRO
     C                   MOVE      99999999      W2PRO
     C                   END
     C* SORTERT PÅ AVDELING - UAVHENGIG AV STATUS.../ GITT STATUS
     C                   SELECT
     C     WSSKOD        WHENEQ    ' '
     C                   MOVEA     '0100'        *IN(26)
     C     WSSKOD        WHENEQ    '0'
     C* Kun åpne på gitt avd - varsel hvis det finnes tur i arbeid.
     c                   move      'N'           PturFins          1
     C                   MOVE      'P'           ZZST
     c     TURE1E        chain     TURER1                             33
     c  N33              move      'J'           PturFins
     C                   MOVE      ' '           ZZST
     C                   MOVE      *ON           *IN40                           KUN STAT...
     C                   OTHER
     C                   MOVE      WSSKOD        ZZST
     C                   MOVE      *ON           *IN40                           KUN STAT...
     C                   ENDSL
     C                   GOTO      SLTST
     C                   END
     C*
     C     WSBILN        IFNE      *BLANKS
     C     WSBDAT        IFEQ      *ZEROS
     C                   MOVE      999999        WSBDAT
     C                   MOVE      999999        W2DATF
     C                   END
     C                   MOVEA     '1000'        *IN(26)
     C     WSBDAT        COMP      999999                                 41     (=READP)
     C                   GOTO      SLTST
     C                   END
     C*
     C*
     C     WSSTEF        IFNE      *BLANKS
     C                   MOVEA     '0010'        *IN(26)
     C                   GOTO      SLTST
     C                   END
     C*
     C     WSSONF        IFNE      *BLANKS
     C                   MOVEA     '0001'        *IN(26)
     C                   GOTO      SLTST
     C                   END
     C*
     C*
     C     WSSTET        IFNE      *BLANKS
     C                   SETON                                        31
     C                   GOTO      SLTST
     C                   END
     C*
     C     WSSONT        IFNE      *BLANKS
     C                   SETON                                        32
     C                   GOTO      SLTST
     C                   END
     C*
     C                   MOVE      'DIV0983'     MSGNR
     C                   SETON                                        9930
     C*
     C     SLTST         TAG
     C* "Avvikende" sortering - åpne fila om det ikke er gjort før
     C     *IN30         IFEQ      *OFF
     C     *IN40         ANDEQ     *OFF
     C                   EXSR      OPNFIL
     C                   END
     C                   ENDSR
     C***********************************************
     C     OPNFIL        BEGSR
     C***********************************************
     C* Filer som sjelden ??Nbrukes åpnes kun ved behov (men forblir
     C* åpne resten av sesjonen etter 1. gangs bruk.)
     C   27TUDUOP        IFNE      '1'
     C                   OPEN      TURERDUM
     C                   END
     C   26TU02OP        IFNE      '1'
     C                   OPEN      TURER2
     C                   END
     C   28TU05OP        IFNE      '1'
     C                   OPEN      TURER5
     C                   END
     C   29TU06OP        IFNE      '1'
     C                   OPEN      TURER6
     C                   END
     C   31TU08OP        IFNE      '1'
     C                   OPEN      TURER8
     C                   END
     C   32TU09OP        IFNE      '1'
     C                   OPEN      TURER9
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     MAX           BEGSR
     C***********************************************
     C                   MOVE      WSSTEF        YSTEF             5
     C                   MOVE      WSSTEF        YSTEF2            5
     C                   MOVE      WSSTET        YSTET             5
     C                   MOVE      WSSTET        YSTET2            5
     C                   MOVE      WSSONF        YSONF             5
     C                   MOVE      WSSONF        YSONF2            5
     C                   MOVE      WSSONT        YSONT             5
     C                   MOVE      WSSONT        YSONT2            5
     C*
     C     YSTEF2        IFEQ      *BLANKS
     C                   MOVE      '99999'       YSTEF2
     C                   ELSE
     C                   Z-ADD     5             XN                2 0
     C     STMSF         TAG
     C     SF(XN)        IFEQ      ' '
     C                   MOVE      '9'           SF(XN)
     C                   SUB       1             XN
     C                   GOTO      STMSF
     C                   END
     C                   END
     C*
     C     YSTET2        IFEQ      *BLANKS
     C                   MOVE      '99999'       YSTET2
     C                   ELSE
     C                   Z-ADD     5             XN                2 0
     C     STMST         TAG
     C     ST(XN)        IFEQ      ' '
     C                   MOVE      '9'           ST(XN)
     C                   SUB       1             XN
     C                   GOTO      STMST
     C                   END
     C                   END
     C*
     C                   Z-ADD     5             XN                2 0
     C     YSONF2        IFEQ      *BLANKS
     C                   MOVE      '99999'       YSONF2
     C                   ELSE
     C     STMBIL        TAG
     C     AL(XN)        IFEQ      ' '
     C                   MOVE      '9'           AL(XN)
     C                   SUB       1             XN
     C                   GOTO      STMBIL
     C                   END
     C                   END
     C*
     C                   Z-ADD     5             XN                2 0
     C     YSONT2        IFEQ      *BLANKS
     C                   MOVE      '99999'       YSONT2
     C                   ELSE
     C     STMBI2        TAG
     C     AL2(XN)       IFEQ      ' '
     C                   MOVE      '9'           AL2(XN)
     C                   SUB       1             XN
     C                   GOTO      STMBI2
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESFIL        BEGSR
     C***********************************************
     C     STLES         TAG
     C   26
     CAN 41              READP     TURER2                                 94
     C   26
     CANN41              READ      TURER2                                 94
     C   27TUREDE        READPE    TURERDUM                               94
     C   40TURE1E        READPE    TURER1                                 94
     C   28              READ      TURER5                                 94
     C   29              READ      TURER6                                 94
     C   31              READ      TURER8                                 94
     C   32              READ      TURER9                                 94
     C*  HOPP UT HVIS END OF FILE
     C     *IN94         CABEQ     *ON           UTLES
     C*
     C* """""""""""""""""""""""""""""""""""""""""""""""""""""""
     C* TESTER PÅ KEYBEGREP FØLGER   LEST FOR LANGT???.....
     C* """""""""""""""""""""""""""""""""""""""""""""""""""""""
     C* DE "MEST EKSKLUDERENDE TESTENE" ER FLYTTET HIT RETT ETTER LES
     C* TESTER VED SØKING BILNUMMER
     C   26
     CANN94WSBILN        COMP      TUBILN                             9494      1<-B
     C*
     C* SØKING VED STED FRA UTFYLLT
     C   28
     CANN94TUSTEF        COMP      YSTEF2                             94
     C*
     C* SØKING VED SONE FRA UTFYLLT
     C   29
     CANN94TUSONF        COMP      YSONF2                             94
     C*
     C* SØKING VED STED FRA UTFYLLT
     C   31
     CANN94TUSTET        COMP      YSTET2                             94
     C*
     C*
     C* SØKING VED SONE FRA UTFYLLT
     C   32
     CANN94TUSONT        COMP      YSONT2                             94
     C*
     C*  HOPP UT HVIS FORBI DET KEYBEGREP SOM BEHANDLES
     C     *IN94         CABEQ     *ON           UTLES
     C*
     C* """""""""""""""""""""""""""""""""""""""""""""""""""""""
     C* TESTER PÅ BEGREP SOM IKKE ER BRUKT SOM KEY FØLGER......
     C* """""""""""""""""""""""""""""""""""""""""""""""""""""""
     C* TEST MOT DATO
     C     WSBDAT        IFNE      *ZEROS
     C     *IN28         IFEQ      '1'
     C     *IN29         OREQ      '1'
     C     *IN31         OREQ      '1'
     C     *IN32         OREQ      '1'
     C     WSSTEF        IFNE      *BLANKS
     C     WSSONF        ORNE      *BLANKS
     C     TUDT          IFLT      WSBÅMD
     C                   GOTO      STLES
     C                   END
     C                   END
     C     WSSTET        IFNE      *BLANKS
     C     WSSONT        ORNE      *BLANKS
     C     TUDTT         IFLT      WSBÅMD
     C                   GOTO      STLES
     C                   END
     C                   END
     C                   END
     C                   END
     C* TESTER STATUSKODE
     C  N40WSSKOD        IFNE      *BLANKS
     C     WSSKOD        IFEQ      '0'
     C     TUST          IFNE      ' '
     C                   GOTO      STLES
     C                   END
     C                   ELSE
     C     WSSKOD        IFNE      TUST
     C                   GOTO      STLES
     C                   END
     C                   END
     C* BLANK I SPØRREBILDET= ALLE UNNTATT SLETTEDE
     C                   ELSE
     C     TUST          IFEQ      'D'
     C                   GOTO      STLES
     C                   END
     C                   END
     C*
     C* GENERELL TEST HVIS FRA STED ER TASTET
     C  N28WSSTEF        IFNE      *BLANKS
     C     TUSTEF        IFGT      YSTEF2                                       EKS:50999
     C     TUSTEF        ORLT      WSSTEF
     C                   GOTO      STLES
     C                   END
     C                   END
     C*
     C* TIL STED ER TASTET - MEN ER IKKE KEY
     C  N31WSSTET        IFNE      *BLANKS                                      EKS:20999
     C     TUSTET        IFGT      YSTET2
     C     TUSTET        ORLT      WSSTET
     C                   GOTO      STLES
     C                   END
     C                   END
     C*
     C* FRA SONE ER TASTET - MEN ER IKKE KEY
     C  N29WSSONF        IFNE      *BLANKS                                      EKS:NO999
     C     TUSONF        IFGT      YSONF2
     C     TUSONF        ORLT      WSSONF
     C                   GOTO      STLES
     C                   END
     C                   END
     C*
     C* TIL SONE ER TASTET - MEN ER IKKE KEY
     C  N32WSSONT        IFNE      *BLANKS                                      EKS:DE299
     C     TUSONT        IFGT      YSONT2
     C     TUSONT        ORLT      WSSONT
     C                   GOTO      STLES
     C                   END
     C                   END
     C*
     C* AVDELING ER TASTET MEN INNGÅR IKKE I KEY
     C     WSAVD         IFNE      *ZEROS
     C     *IN27         ANDNE     '1'
     C     *IN40         ANDNE     '1'
     C     TUAVD         ANDNE     WSAVD
     C                   GOTO      STLES
     C                   END
     C*
     C     UTLES         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
s07  C*    TRANKE        KLIST
s07  C*                  KFLD                    FIFIRM
s07  C*                  KFLD                    TUKNT2
     C     OPDKEY        KLIST
     C                   KFLD                    UUAVD
     C                   KFLD                    UUOPD
     C     KOSB9K        KLIST
     C                   KFLD                    YYST
     C                   KFLD                    UUAVD
     C                   KFLD                    UUOPD
     C     TURERK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UPRO
     C     TUKEY         KLIST
     C                   KFLD                    TUAVD
     C                   KFLD                    TUPRO
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2PRO
     C     TUREDK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPRO
     C     TUREDE        KLIST
     C                   KFLD                    WSAVD
     C     TURE1K        KLIST
     C                   KFLD                    ZZST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPRO
     C     TURE1E        KLIST
     C                   KFLD                    ZZST
     C                   KFLD                    WSAVD
     C     TURE2K        KLIST
     C                   KFLD                    WSBILN
     C                   KFLD                    WSBÅMD
     C     TURE5K        KLIST
     C                   KFLD                    YSTEF
     C                   KFLD                    YSTET
     C     TURE6K        KLIST
     C                   KFLD                    YSONF
     C                   KFLD                    YSONT
     C     TURE8K        KLIST
     C                   KFLD                    YSTET
     C     TURE9K        KLIST
     C                   KFLD                    YSONT
     C                   Z-ADD     99999999      WSPRO
     C                   Z-ADD     99999999      W2PRO
     C                   MOVE      ' '           YYST              1
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVD
     C     KODAKA        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVDA
     C                   MOVE      'A'           YAUNI             1
      *
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     TTCHGKey      KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXFBNR            3 0
     C                   KFLD                    XXACTI            3
     C                   MOVE      'CHG'         XXACTI
      * Kode P / BLANK i LEST = ulest PDA-melding PÅ TUR
     C     PDFTTKey      KLIST
     C                   KFLD                    TUAVD
     C                   KFLD                    TUPRO
     C                   KFLD                    XFTKOD            1
     C                   KFLD                    XFTLES
     c     *like         Define    FRTLES        XFTLES
      * Kode P / 0 i fakt-nr = ulest PDA-melding PÅ OPPDRAG
     C     PDFTSKey      KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XFTKOD            1
N01  C                   KFLD                    XFTLES            1
s01  C*                  KFLD                    XFTFAK
s01  c*    *like         Define    FRTFAK        XFTFAK
     C                   MOVE      'P'           XFTKOD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UUPRO             8 0
     C                   PARM                    UURUND            8 0
     C                   PARM                    UUAVD             4 0
     C                   PARM                    UUOPD             7 0
     C                   PARM                    UUSPØR            1
     C                   PARM                    UUCMD             1 0
     C*
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
     C* UIMP ER LEGIG FOR BENYTTELSE DA EKSPORT IMPORT IKKE GJELDER
     C*
     C* A= KALL FRA MENU
     C     UUSPØR        COMP      'A'                                    37
     C* P= KALL FRA REGISTRET OPPDRAG
     C     UUSPØR        COMP      'P'                                    36
     C* J= KALL FRA SPØRRING
     C     UUSPØR        COMP      'J'                                    35
     C* O= KALL FRA ORDREREGISTRERING/PLUKKING ORDRE
     C     UUSPØR        COMP      'O'                                    38
     C   38              MOVE      'J'           UUSPØR
     C*
     C     *LIKE         DEFINE    WSAVD         AVDZER
     C     *LIKE         DEFINE    UUAVD         UAVD
     C     *LIKE         DEFINE    UUOPD         UOPD
     C     *LIKE         DEFINE    UURUND        URUND
     C     *LIKE         DEFINE    UUPRO         UPRO
     C                   MOVE      UDSAVD        WSAVD
     C   36              MOVE      UUAVD         WSAVD
     C   37              MOVE      UDSAVD        UUAVD
     C   38              MOVE      UUAVD         WSAVD
     C                   MOVE      WSAVD         WSAVDA
     C                   MOVE      WSAVD         W2AVD
     C                   MOVE      *BLANKS       YSONF
     C                   MOVE      *BLANKS       YSONF2
     C                   MOVE      *BLANKS       YSONT
     C                   MOVE      *BLANKS       YSONT2
     C                   MOVE      *BLANKS       YSTEF
     C                   MOVE      *BLANKS       YSTEF2
     C                   MOVE      *BLANKS       YSTET
     C                   MOVE      *BLANKS       YSTET2
     C                   MOVE      '0'           WSSKOD
     C                   MOVE      '0'           W2ST2
     C                   MOVE      *ZEROS        WSBDAT            6 0
     C                   MOVE      *ZEROS        WSBÅMD            8 0
     C                   MOVE      *ZEROS        DATO0             6 0
     C*
     C* SETTER INDIKATOR PÅ FOR SØKING PÅ AVDELING INITIELLT
     C* OG SPESIFIK STATUSKODE (BLANK) INITIELT
     C                   SETON                                        40
     C                   MOVE      ' '           ZZST              1
     C                   EXSR      TSTSØK
     C                   EXSR      CMDFT
     C                   EXSR      OPSJON
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FIXTUR        BEGSR
     C***********************************************
     C*
     C* LEGGER PROSJEKTNUMMER PÅ ORDRE
     C*
     C     TURERK        CHAIN(N)  TURER                              33
     C     OPDKEY        CHAIN     HEADF                              33
     C  N33              MOVE      TUPRO         HEPRO
     C  N33              MOVEL     TUBILN        HEHAWB
     C  N33              MOVE      TUTRMA        HETRM
s07  C* N33              MOVE      *ZEROS        HEKNT
s07  C* N33TRANKE        CHAIN     TRAN                               34
s07  C* N33
s07  C*NN34              MOVE      VMTRKU        HEKNT
N07  C  N33              MOVE      TUKNT2        HEKNT
     C  N33TUCON1        IFNE      *BLANKS
     C                   MOVE      1             HETRC
     C                   MOVEL     TUCON1        HETRCN
     C                   END
     C  N33              MOVE      TURUND        TRRUND
     C  N33              UPDATE    HEADFR
     C     TURERK        CHAIN     TURER                              33
     C                   ADD       HENT          TUTS
     C                   ADD       HEVKT         TUTVKT
     C                   ADD       HEM3          TUTM3
     C                   ADD       HELM          TUTLM
N14  C                   ADD       HELMLA        TUTLM2
N14  C                   ADD       HEPOEN        TUPOEN
     C                   ADD       1             TUAO
     C                   UPDATE    TURERR
     C* Åpne fila om ikke den er brukt før...
     C     DISPOP        IFNE      '1'
     C                   OPEN      DISP
     C                   END
     C     OPDKEY        CHAIN     DISP                               33
     C  N33              MOVE      TUAVD         DITUAV
     C  N33              MOVE      TUPRO         DITUR
     C  N33              MOVE      TURUND        DIRUND
     C  N33              MOVE      ' '           DISTA1
     C  N33              UPDATE    DISPR
     C*
     C                   MOVE      TURUND        UURUND
     C                   MOVE      TUPRO         UUPRO
     C*
     C                   EXSR      BUTADD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     BUTADD        BEGSR
     C***********************************************
     C     UUOPD         CABEQ     *ZEROS        UTBUTA
     C* Åpne fila om ikke den er brukt før...
     C     KOS9OP        IFNE      '1'
     C                   OPEN      KOSBU9
     C                   END
     C* GÅR IGJENNOM EVT. REKVISISJONER PÅ DETTE OPPDRAG OG LEGGER INN
     C* TURNUMMER (FOR EVT Å KUNNE INNGÅ I TRANSPORTØRAVREGNING )
     C                   MOVE      ' '           YYST
     C     KOSB9K        CHAIN     KOSBU9                             33
     C     *IN33         DOWNE     '1'
     C                   MOVE      TUAVD         BUTAVD
     C                   MOVE      TUPRO         BUTUNR
     C                   MOVE      TURMND        BUPMN                          *PERIODE FØLGER
     C                   MOVE      TURAAR        BUPÅR                           ALLTID TUREN...
     C                   MOVE      TURACC        BUPCC                           ALLTID TUREN...
     C     BUBILN        IFEQ      *BLANKS
     C                   MOVE      TUBILN        BUBILN
     C                   MOVE      TUBILK        BUBILK
     C                   MOVE      TUDT          BUFEDT
     C                   END
     C                   UPDATE    KOSB9R
     C     KOSB9K        READE     KOSBU9                                 33
     C  N33              END
     C* EVT. DUMMYREKVISISJONER (DUP)PÅ DETTE OPPDRAG?-LEGGER INN TURNR
     C* (FOR Å FÅ "TOTALBILDE" VED SPØRRING PÅ REKV - STATUS "*")
     C                   MOVE      'D'           YYST
     C     KOSB9K        CHAIN     KOSBU9                             33
     C     *IN33         DOWNE     '1'
     C                   MOVE      TUAVD         BUTAVD
     C                   MOVE      TUPRO         BUTUNR
     C                   MOVE      TURMND        BUPMN                          *PERIODE FØLGER
     C                   MOVE      TURAAR        BUPÅR                           ALLTID TUREN...
     C                   MOVE      TURACC        BUPCC                           ALLTID TUREN...
     C                   UPDATE    KOSB9R
     C     KOSB9K        READE     KOSBU9                                 33
     C  N33              END
     C*
     C     UTBUTA        ENDSR
     C*
     C***********************************************
     C     SETSTA        BEGSR
     C***********************************************
     C*
     C* ENDRER DISPONERINGSSTATUS PÅ HEAD/HEADTR/DISP
     C*
     C*
     C                   MOVE      'N'           SAMTAX            1
     C                   SETOFF                                       33
     C     STAKEY        KLIST
     C                   KFLD                    TUST
     C                   KFLD                    TUPRO
     C     STAKE2        KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C* Åpne fila om ikke den er brukt før...
     C     DIS1OP        IFNE      '1'
     C                   OPEN      DISPL01
     C                   END
     C     STAKEY        SETLL     DISPL01
     C     *IN33         DOWEQ     '0'
     C     STAKEY        READE     DISPL01                                33
     C  N33              DO
     C*
     C* OPPDATERER DISPONERINGSSTATUS I DISP
     C* VED SLETTING NULLSTILLES TUR OG RUNDTUR
     C*
     C                   MOVE      NYSTAT        DISTA1
     C     NYSTAT        IFEQ      'D'
     C                   MOVE      *ZEROS        DITUR
     C                   MOVE      *ZEROS        DITUAV
     C                   MOVE      *ZEROS        DIRUND
     C                   MOVE      *BLANKS       DISTA1
     C                   END
     C                   UPDATE    DISPR1
     C*
     C* OPPDATERER HEADF  NULLSTILLER PROSJEKTNUMMER
     C*
     C     NYSTAT        IFEQ      'D'
     C     STAKE2        CHAIN     HEADF                              34
     C                   MOVE      *ZEROS        HEPRO
     C                   MOVE      *BLANKS       HEHAWB
N06  C                   MOVE      *zeros        HEKNT
     C                   MOVE      *ZEROS        HETRM
     C                   MOVE      0             HETRC
     C                   MOVE      *BLANKS       HETRCN
     C                   MOVE      NYSTAT        TRSTA1
     C                   MOVE      *ZEROS        TRRUND
     C  N34              UPDATE    HEADFR
     C                   END
      *
      * VED AVSL. AV TUR, SJEKK OM KUNDE SKAL SAMTAKSERES...
     C     NYSTAT        IFEQ      'A'
     C     STAKE2        CHAIN(N)  HEADF                              34
     C     HEKNKF        IFNE      *ZEROS
     C                   MOVE      HEKNKF        KUNDNR
     C                   ELSE
     C                   MOVE      HEKNSF        KUNDNR
     C                   END
     C     KUNKEY        CHAIN     CUNDL01                            34
     C  N34SYSTAX        IFEQ      'J'
     C                   MOVE      'J'           SAMTAX
     C                   END
     C                   END
      *
     C                   END                                                     N33  DO
     C                   END                                                     DOWEQ
      *
     C     SAMTAX        IFEQ      'J'
     C                   MOVE      TUPRO         UTTPRO            8
     C                   MOVE      'A'           UTTYPE            1
     C                   CALL      'SYTR88S'
     C                   PARM                    UTTPRO
     C                   PARM                    UTTYPE
     C                   END
      *
     C                   ENDSR
     C***********************************************
     C     CMDFT         BEGSR
     C***********************************************
     C                   SELECT
     C     XMSGB         WHENEQ    0
     C                   ADD       1             XMSGB             1 0
     C                   MOVE      'DIV0020'     MSGB1V
     C                   MOVE      'DIV0021'     MSGB2V
     C                   MOVE      'DIV0024'     MSGB3V
     C                   MOVE      'DIV0029'     MSGB4V
     C     XMSGB         WHENEQ    1
     C                   Z-ADD     0             XMSGB
     C                   MOVE      'YBC0033'     MSGB1V
     C  N35
     CANN38              MOVE      'DIV0022'     MSGB2V
     C   35
     COR 38              MOVE      'DIV0000'     MSGB2V
     C                   MOVE      'YBC0105'     MSGB3V
     C                   MOVE      'DIV0029'     MSGB4V
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPSJON        BEGSR
     C***********************************************
     C                   SELECT
     C     XMSGOP        WHENEQ    0
     C                   ADD       1             XMSGOP            1 0
     C   35              MOVE      'YBC0081'     MSGC1V
     C   36              MOVE      'YBC0084'     MSGC1V
     C   37              MOVE      'YBC0087'     MSGC1V
     C   38              MOVE      'YBC0090'     MSGC1V
     C     XMSGOP        WHENEQ    1
     C                   ADD       1             XMSGOP
     C   35              MOVE      'YBC0082'     MSGC1V
     C   36              MOVE      'YBC0085'     MSGC1V
     C   37              MOVE      'YBC0088'     MSGC1V
     C   38              MOVE      'YBC0090'     MSGC1V
     C     XMSGOP        WHENEQ    2
     C                   ADD       1             XMSGOP
     C   35              MOVE      'YBC0083'     MSGC1V
     C   36              MOVE      'YBC0086'     MSGC1V
     C   37              MOVE      'YBC0089'     MSGC1V
     C   38              MOVE      'YBC0090'     MSGC1V
     C     XMSGOP        WHENEQ    3
     C                   ADD       1             XMSGOP
     C                   MOVE      'SHU0581'     MSGC1V
     C     XMSGOP        WHENEQ    4
S13  C*                  Z-ADD     0             XMSGOP
N13  C                   ADD       1             XMSGOP
     C                   MOVE      'SHU1133'     MSGC1V
N13  C     XMSGOP        WHENEQ    5
N13  C                   Z-ADD     0             XMSGOP
s23  C*                  MOVE      'SHU1507'     MSGC1V
N23  C                   MOVE      'JOV1762'     MSGC1V
     C                   ENDSL
      *
     C                   ENDSR
N15   ***********************************************
n15  C     BEREGNA       BEGSR
n15   ***********************************************
n15  C                   CALL      'SYTR12A'
n15  C                   PARM                    TUAVD
n15  C                   PARM                    TUPRO
n15  C                   PARM                    XXVIS             1
n15  C                   PARM                    N4                4 0
n15  C*                  PARM                    N5                5 0
n15  C                   PARM                    N7                7 0
n15  C                   PARM                    N8                8 0
N17  C                   ENDSR
      *
N17   ************************************************************************
N17  c     kostsr        begsr
N17   ************************************************************************
N17   * Hent åpne forv. kostnader. på turnivå
N17  C                   move      *zeros        kosttu           13 2
N17  c                   SETOFF                                       33
N17  C     TUPRO         SETLL     KOSBU13
N17  C     *IN33         DOWEQ     '0'
N17  C     TUPRO         READE     KOSBU13                                33
N17  C     *in(33)       IFEQ      '0'
N17  C     BUVAL         IFNE      FICURR
N17  C                   MOVE      BUVAL         TMPVAL            3
N17  C                   Z-ADD     BUBL          TMPBL
N17  C                   EXSR      VALUT
N17  C                   Z-ADD     TMPBL         BUBL
N17  C                   END
N17  C                   ADD       BUBL          kosttu
N17  C                   END
N17  C                   ENDDO
N17  C                   ENDSR
N17  C***********************************************
N17  C     VALUT         BEGSR
N17  C***********************************************
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TMPVAL
N17  C*
N17  C     VALU1K        CHAIN     VALUL01                            39
N17  C  N39              DO
N17  C     VALKU2        IFNE      0
N17  C                   MOVE      VALKU2        VALKU1
N17  C                   END
N17  C     TMPBL         MULT      VALKU1        XWORK            15 4
N17  C     XWORK         DIV(H)    OMRFAK        TMPBL            13 2
N17  C                   END
N17  C                   ENDSR
      *
     OTURERR    E            DUMTUR
     O          E            PTUR
     O                       TUST
     O          E            OTUST1
     O                       TUTST1
