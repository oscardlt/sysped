      *
      ***************************************************************
      *** LAGER WORKFILE (RAPPORTGRUNNLAG)                        ***
      ***                                                         ***
      *** PROGRAMMERT AV TORE BRÅSTAD, SYSTEMA A/S, APRIL 1994    ***
      ***************************************************************
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01-99                                ***
      ***************************************************************
      *
     FFAK4      IF   E           K DISK
     FHEADF     IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTG2    IF   E           K DISK
     FGBREGLF   IF   E           K DISK
     FGBWREG    O    E           K DISK
     D                 DS
     D  LESPER                 1      6  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  FRAPER                 1      6  0
     D  WSFÅRH                 1      2  0
     D  WSFAAR                 3      4  0
     D  WSFPER                 5      6  0
     D                 DS
     D  TILPER                 1      6  0
     D  WSTÅRH                 1      2  0
     D  WSTAAR                 3      4  0
     D  WSTPER                 5      6  0
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UFPER             2
     C                   PARM                    UFAAR             2
     C                   PARM                    UTPER             2
     C                   PARM                    UTAAR             2
     C*
     C                   MOVE      UAVD          WSAVD             4 0
     C                   MOVE      UFPER         WSFPER            2 0
     C                   MOVE      UFAAR         WSFAAR            2 0
     C     WSFAAR        IFGT      50
     C                   MOVE      '19'          WSFÅRH            2 0
     C                   ELSE
     C                   MOVE      '20'          WSFÅRH
     C                   END
     C                   MOVE      UTPER         WSTPER            2 0
     C                   MOVE      UTAAR         WSTAAR            2 0
     C     WSTAAR        IFGT      50
     C                   MOVE      '19'          WSTÅRH
     C                   ELSE
     C                   MOVE      '20'          WSTÅRH
     C                   END
     C                   MOVEL     'BEH. AVS'    BE2TXT           15
     C                   MOVE      'ETN. II'     BE2TXT
     C*
     C     LESKEY        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD             7 0
     C*
     C     GBKEY         KLIST
     C                   KFLD                    AVD               4 0
     C                   KFLD                    FAVK
     C*
     C     GBKY1         KLIST
     C                   KFLD                    AVD
     C                   KFLD                    WAVK              3
     C*
     C     HEDKEY        KLIST
     C                   KFLD                    FAAVD
     C                   KFLD                    FAOPD
     C*
     C     HE2KEY        KLIST
     C                   KFLD                    GAVD
     C                   KFLD                    GOPD
     C*
     C     KKEY          KLIST
     C                   KFLD                    WUNI              2
     C                   KFLD                    WAVK
     C*
     C     K2KEY         KLIST
     C                   KFLD                    W2UNI             2
     C                   KFLD                    WAVK
     C*
     C                   MOVE      'GE'          WUNI
     C                   MOVE      'G2'          W2UNI
     C*
     C     START         TAG
     C     LESKEY        SETLL     FAKTR
     C                   READ      FAKTR                                  10
     C                   Z-ADD     FAAVD         WAVD              4 0
     C                   Z-ADD     FAOPD         WOPD              7 0
     C                   MOVEL     FAVK          WAVK              3
     C                   MOVEL     FAKDM         WAKDM             1
     C     *IN10         DOWEQ     '0'
     C                   EXSR      SJEKK
     C     *IN30         IFEQ      '1'
     C     HEDKEY        CHAIN     HEADFR                             11
     C     LESPER        IFGE      FRAPER
     C     LESPER        ANDLE     TILPER
     C     FAAVD         IFNE      WAVD
     C     FAOPD         ORNE      WOPD
     C     FAVK          ORNE      WAVK
     C                   Z-ADD     WAVD          GAVD
     C                   Z-ADD     WOPD          GOPD
     C                   MOVE      WAVK          GAVK
     C                   MOVEL     WAKDM         GMVA
     C                   MOVE      *BLANKS       GSIGN
     C                   MOVEL     HESG          GSIGN
     C                   Z-ADD     HEPRO         GTUR
     C                   MOVE      BE2TXT        GAVTXT
     C                   EXSR      GJEKTO
     C                   EXSR      BEHKTO
     C     GAVS          IFNE      0
     C     GAVS          MULT      -1            GAVS
     C     HE2KEY        CHAIN     HEADFR                             12
     C                   MOVE      *BLANKS       GSIGN
     C                   MOVEL     HESG          GSIGN
     C                   Z-ADD     HEPRO         GTUR
     C                   WRITE     GBWRR
     C                   END
     C                   Z-ADD     0             GBKOST
     C                   Z-ADD     0             GBFAKT
     C                   Z-ADD     0             GFKOST
     C                   Z-ADD     0             GFFAKT
     C                   Z-ADD     0             GAVS
     C                   Z-ADD     FAAVD         WAVD
     C                   Z-ADD     FAOPD         WOPD
     C                   MOVEL     FAVK          WAVK
     C                   MOVEL     FAKDM         WAKDM
     C                   ELSE
     C                   END
     C                   ADD       FABELN        GAVS
     C                   END
     C                   ELSE
     C                   SETON                                        10
     C                   END
     C                   READ      FAKTR                                  10
     C     WSAVD         IFNE      0
     C     FAAVD         IFNE      WSAVD
     C                   SETON                                        10
     C                   END
     C                   END
     C                   END
     C                   Z-ADD     WAVD          GAVD
     C                   Z-ADD     WOPD          GOPD
     C                   MOVE      WAVK          GAVK
     C                   MOVEL     WAKDM         GMVA
     C     HE2KEY        CHAIN     HEADFR                             12
     C     *IN11         IFEQ      '0'
     C                   MOVE      *BLANKS       GSIGN
     C                   MOVEL     HESG          GSIGN
     C                   Z-ADD     HEPRO         GTUR
     C                   MOVE      BE2TXT        GAVTXT
     C                   END
     C                   EXSR      GJEKTO
     C                   EXSR      BEHKTO
     C     GAVS          IFNE      0
     C     GAVS          MULT      -1            GAVS
     C                   WRITE     GBWRR
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***************************************************************
     C*
     C     SJEKK         BEGSR
     C*
     C                   Z-ADD     FAAVD         AVD
     C     GBKEY         CHAIN     GBREGR                             20
     C     *IN20         IFEQ      '0'
     C     AKF           ANDEQ     'X'
     C                   SETON                                        30
     C                   ELSE
     C                   Z-ADD     0             AVD
     C     GBKEY         CHAIN     GBREGR                             21
     C     *IN21         IFEQ      '0'
     C     AKF           ANDEQ     'X'
     C                   SETON                                        30
     C                   ELSE
     C                   SETOFF                                       30
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     GJEKTO        BEGSR
     C*
     C     K2KEY         CHAIN     KOG2R                              21
     C     *IN21         IFEQ      '0'
     C     WAKDM         IFNE      'N'
     C                   Z-ADD     KG2MOT        GKONTO
     C                   ELSE
     C     KG2UTG        IFEQ      0
     C                   Z-ADD     KG2MOT        GKONTO
     C                   ELSE
     C                   Z-ADD     KG2UTG        GKONTO
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     BEHKTO        BEGSR
     C*
     C     KKEY          CHAIN     KOGER                              22
     C     *IN22         IFEQ      '0'
     C     WAKDM         IFNE      'N'
     C                   Z-ADD     KGEKON        GKONTO
     C                   ELSE
     C     K2KEY         CHAIN     KOG2R                              23
     C     *IN23         IFEQ      '0'
     C     KG2KON        IFEQ      0
     C                   Z-ADD     KGEKON        GKONTO
     C                   ELSE
     C                   Z-ADD     KG2KON        GKONTO
     C                   END
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
