********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 02 SH  PTF10 merkelig ved B=fast beløp
10XXX * 03 SH  PTF10 utelate fra til kunde
********************************************************************
      *
      ************************************************************
      *** PROGRAM TO RAISE PRICES BY GIVEN % RATE              ***
      *** INDICKTORS 01 - 26 ONLY FOR FUNCTION/ROLL KEYS       ***
      *** UNUSED INDIKATORS  01 02 05-26                       ***
      *** UNUSED INDIKATORS  34-89 91-95                       ***
      ************************************************************
      *
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FPRIK      UF   E           K DISK
     FPRIS      UF   E           K DISK
     FFRATN     UF   E           K DISK
     FKUIPRL01  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FGEBIPR    IF   E           K DISK
     FFRATFRA   UF   E           K DISK    RENAME(FRATR:FRATFR)
     FFRATTIL   UF   E           K DISK    RENAME(FRATR:FRATTR)
E01  FSYFA67FM  CF   E             WORKSTN INFDS(FBAREA)
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
N01  D                UDS
N01  D FIFIRM                  1      2
     D WP              S              1    DIM(12)
     D                 DS
     D  WAGEDA                 1      6  0
     D  WAGDD                  1      2  0
     D  WAGDM                  3      4  0
     D  WAGDÅ                  5      6  0
     D                 DS
     D  XAGEDA                 1      8  0
     D  XAGDÅ                  1      4  0
     D  XAGDM                  5      6  0
     D  XAGDD                  7      8  0
     D                 DS
     D  FB01                   1      3P 0
     D  FB02                   4      6P 0
     D  FB03                   7      9P 0
     D  FB04                  10     12P 0
     D  FB05                  13     15P 0
     D  FB06                  16     18P 0
     D  FB07                  19     21P 0
     D  FB08                  22     24P 0
     D  FB09                  25     27P 0
     D  FB10                  28     30P 0
     D  FB11                  31     33P 0
     D  FB12                  34     36P 0
     D  FB                     1     36P 0
     D                                     DIM(12)
     D  FBX                    1     36
     D                 DS
     D  FM01                   1      3P 0
     D  FM02                   4      6P 0
     D  FM03                   7      9P 0
     D  FM04                  10     12P 0
     D  FM05                  13     15P 0
     D  FM06                  16     18P 0
     D  FM07                  19     21P 0
     D  FM08                  22     24P 0
     D  FM09                  25     27P 0
     D  FM10                  28     30P 0
     D  FM11                  31     33P 0
     D  FM12                  34     36P 0
     D  FM                     1     36P 0
     D                                     DIM(12)
     D  FMX                    1     36
     D                 DS
     D  WAGB01                 1      3
     D  WAGB02                 4      6
     D  WAGB03                 7      9
     D  WAGB04                10     12
     D  WAGB05                13     15
     D  WAGB06                16     18
     D  WAGB07                19     21
     D  WAGB                   1     21
     D                                     DIM(7)
     D  WAGBA                  1     21
     D                 DS
     D  WAGE01                 1      3
     D  WAGE02                 4      6
     D  WAGE03                 7      9
     D  WAGE04                10     12
     D  WAGE05                13     15
     D  WAGE06                16     18
     D  WAGE07                19     21
     D  WAGE                   1     21
     D                                     DIM(7)
     D  WAGEA                  1     21
     D                 DS
     D  FRVK1                  1      5  0
     D  FRVK2                  6     10  0
     D  FRVK3                 11     15  0
     D  FRVK4                 16     20  0
     D  FRVK5                 21     25  0
     D  FRVK6                 26     30  0
     D  FRVK7                 31     35  0
     D  FRVK8                 36     40  0
     D  FRVK9                 41     45  0
     D  FRVK10                46     50  0
     D  FRVK11                51     55  0
     D  FRVK12                56     60  0
     D  FVK                    1     60  0
     D                                     DIM(12)
     D  FVKX                   1     60
     D                 DS
     D  ZNUMB                  1     11  2
     D  ZNUMBB                 9     11  2
      *
      *
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000'       *IN(87)
     C                   MOVEA     '00000000'    *IN(92)
     C* NULLSTILL TELLER "ENDRET DETTE UTVALG"
     C                   MOVE      *ZEROS        WBFRSI
     C                   MOVE      *ZEROS        WBGESI
     C                   MOVE      *ZEROS        WAFRSI
     C                   MOVE      *ZEROS        WAGESI
     C*
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
      * VIS ANTALL ENDRET...
     C                   MOVE      *ON           *IN65
     C*
     C* Standard freight rates
     C     WBFRPR        IFNE      *ZEROS
     C     WBFRAV        ORNE      *ZEROS
     C                   EXSR      INCBFR
     C                   END
     C* Standard price tabels
     C     WBGEPR        IFNE      *ZEROS
     C     WBGEAV        ORNE      *ZEROS
     C                   EXSR      INCBGE
     C                   END
     C* Agreed freight rates
     C     WAFRPR        IFNE      *ZEROS
     C     WAFRAV        ORNE      *ZEROS
     C                   EXSR      INCAFR
     C                   END
     C* Agreed price tables
     C     WAGEPR        IFNE      *ZEROS
     C     WAGEAV        ORNE      *ZEROS
     C     WAGEDA        ORNE      *ZEROS
     C                   EXSR      INCAGE
     C                   END
     C*
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     TESTB         BEGSR
     C******************************************
     C*
     C*
     C* Standard freight rates
     C* ØKNING OG/ELLER AVRUNDINGSFELT UTFYLT...
     C     WBFRPR        IFNE      *ZEROS
     C     WBFRAV        ORNE      *ZEROS
     C*** Rounding code
     C     WBFRAV        COMP      0                                  9999
     C   99WBFRAV        COMP      1                                  9999
     C   99WBFRAV        COMP      2                                  9999
     C   99WBFRAV        COMP      3                                  9999
     C   99              MOVE      'SP00000'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB
     C*
     C* From destination
     C     WBFRFR        IFNE      '*ALL '
     C     WBFRFR        CHAIN     STED2                              98
     C   98              MOVE      'SPS0012'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLTB
     C                   END
     C*
     C* To - destination
     C     WBFRTI        IFNE      '*ALL '
     C     WBFRTI        CHAIN     STED2                              97
     C   97              MOVE      'SPS0013'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      SLTB
     C                   END
     C                   END
     C*
     C*
     C* Standard price tables
     C* ØKNING OG/ELLER AVRUNDINGSFELT UTFYLT...
     C     WBGEPR        IFNE      *ZEROS
     C     WBGEAV        ORNE      *ZEROS
     C*** Rounding code 2
     C     WBGEAV        COMP      0                                  9696
     C   96WBGEAV        COMP      1                                  9696
     C   96WBGEAV        COMP      2                                  9696
     C   96WBGEAV        COMP      3                                  9696
     C   96              MOVE      'SP00000'     MSGNR
     C   96              SETON                                        30
     C   96              GOTO      SLTB
     C                   END
     C     WBGEPM        IFEQ      'B'
     C     WBGEVA        ANDEQ     *BLANKS
     C                   SETON                                        8830
     C                   MOVE      'SHU1136'     MSGNR
     C                   GOTO      SLTB
     C                   END
     C*
     C* Agreed freight rates
     C* ØKNING OG/ELLER AVRUNDINGSFELT UTFYLT...
     C     WAFRPR        IFNE      *ZEROS
     C     WAFRAV        ORNE      *ZEROS
     C*** Rounding code
     C     WAFRAV        COMP      0                                  9595
     C   95WAFRAV        COMP      1                                  9595
     C   95WAFRAV        COMP      2                                  9595
     C   95WAFRAV        COMP      3                                  9595
     C   95              MOVE      'SP00000'     MSGNR
     C   95              SETON                                        30
     C   95              GOTO      SLTB
     C*  Only customer no...
     C     WAFRKU        IFNE      99999999
     C                   MOVE      WAFRKU        YKNR
     C     KUND1K        CHAIN     CUNDL01                            92
     C   92              MOVE      'SPK0001'     MSGNR
     C   92              SETON                                        30
     C   92              GOTO      SLTB
     C                   END
     C* From destination
     C     WAFRFR        IFNE      '*ALL '
     C     WAFRFR        CHAIN     STED2                              94
     C   94              MOVE      'SPS0012'     MSGNR
     C   94              SETON                                        30
     C   94              GOTO      SLTB
     C                   END
     C*
     C* To - destination
     C     WAFRTI        IFNE      '*ALL '
     C     WAFRTI        CHAIN     STED2                              93
     C   93              MOVE      'SPS0013'     MSGNR
     C   93              SETON                                        30
     C   93              GOTO      SLTB
     C                   END
     C                   END
      *
     C     WAGEPM        IFEQ      'B'
     C     WAGEVA        ANDEQ     *BLANKS
     C                   SETON                                        8730
     C                   MOVE      'SHU1136'     MSGNR
     C                   GOTO      SLTB
     C                   END
     C*
     C* Agreed prices fee codes
     C* ØKNING OG/ELLER AVRUNDINGSFELT UTFYLT...
     C     WAGEPR        IFNE      *ZEROS
     C     WAGEAV        ORNE      *ZEROS
     C*** Rounding code
     C     WAGEAV        COMP      0                                  9191
     C   91WAGEAV        COMP      1                                  9191
     C   91WAGEAV        COMP      2                                  9191
     C   91WAGEAV        COMP      3                                  9191
     C   91              MOVE      'SP00000'     MSGNR
     C   91              SETON                                        30
     C   91              GOTO      SLTB
     C*
     C*  Only customer no...
     C     WAGEKU        IFNE      99999999
     C                   MOVE      WAGEKU        YKNR
     C     KUND1K        CHAIN     CUNDL01                            90
     C   90              MOVE      'SPK0001'     MSGNR
     C   90              SETON                                        30
     C   90              GOTO      SLTB
     C                   END
     C*
     C* Expire date
     C     WAGEDA        IFNE      0
     C                   MOVE      WAGDÅ         UÅÅ               2 0
     C                   MOVE      WAGDM         UMM               2 0
     C                   MOVE      WAGDD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C   89              MOVE      'SPD0001'     MSGNR
     C   89              SETON                                        30
     C   89              GOTO      SLTB
     C                   MOVE      WAGDD         XAGDD
     C                   MOVE      WAGDM         XAGDM
     C     WAGDÅ         IFGT      50
     C     WAGDÅ         ADD       1900          XAGDÅ
     C                   ELSE
     C     WAGDÅ         ADD       2000          XAGDÅ
     C                   END
     C                   END
     C*
     C                   END
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     INCBFR        BEGSR
     C***********************************************
     C                   MOVEA     '0000'        *IN(27)
     C* One single factor to do the incr. by % (ZMULT is 1.????)
     C                   Z-ADD     1             ZMULT
     C                   MOVE      WBFRPR        ZDESIM            4 4
     C* rent prosenttrekk
     C     WBFRPM        IFEQ      '-'
     C                   SUB       ZDESIM        ZMULT
     C                   ELSE
     C* opphev tidligere økning på xx %
     C     WBFRPM        IFEQ      'M'
     C                   ADD       ZDESIM        ZMULT
     C     1             DIV(H)    ZMULT         ZMULT
     C                   ELSE
     C* rent prosent tillegg
     C                   ADD       ZDESIM        ZMULT
     C                   END
     C                   END
     C* Is rounding procedure to be called (code 2 and 3) -> 29 On
     C                   MOVE      WBFRAV        ZKODE             1 0
     C     ZKODE         COMP      2                                  29  29
     C* Set keys for freight rate files
     C                   MOVE      *ZEROS        YKN
     C* Which file is to be used?
     C     WBFRFR        COMP      '*ALL '                            2727
     C     WBFRTI        COMP      '*ALL '                            2828
     C  N27              MOVE      *BLANKS       WBFRFR                             *ALL
     C  N28              MOVE      *BLANKS       WBFRTI                             *ALL
     C                   MOVE      WBFRFR        YSDF
     C                   MOVE      WBFRTI        YSDT
     C* N27/N28 -> use the FRAT  file    KEY: YKN
     C*  27     -> use the FRATFRA file  KEY: YKN/YSDF
     C* N27  28 -> use the FRATTIL file  KEY: YKN/YSDT
     C*
     C  N27
     CANN28FRATK         SETLL     FRATN
     C   27FRATFK        SETLL     FRATFRA
     C  N27
     CAN 28FRATTK        SETLL     FRATTIL
     C*
     C     STBFR         TAG
     C  N27
     CANN28              READ      FRATN                                  30
     C   27              READ      FRATFRA                                30
     C  N27
     CAN 28              READ      FRATTIL                                30
     C  N30FTKNR         COMP      *ZEROS                             30
     C  N30
     CAN 27FTFRA         COMP      WBFRFR                             30
     C  N30
     CAN 28FTTIL         COMP      WBFRTI                             30
     C   30              GOTO      SLBFR
     C*
     C* Utelates pga STED FRA (NÅR NØKKEL = STED TIL)
     C  N27
     CAN 28WBFRFR        IFNE      FTFRA
     C                   GOTO      STBFR
     C                   END
     C* Utelates pga STED TIL (NÅR NØKKEL = STED FRA)
     C   27WBFRTI        IFNE      FTTIL
     C                   GOTO      STBFR
     C                   END
     C* Utelates pga LANDKODE FRA ????
     C     WBFRFL        IFNE      *BLANKS
     C     FTFRA         CHAIN     STED2                              33
     C  N33WBFRFL        COMP      ST2LK                              3333
     C   33              GOTO      STBFR
     C                   END
     C* Utelates pga LANDKODE TIL ????
     C     WBFRTL        IFNE      *BLANKS
     C     FTTIL         CHAIN     STED2                              33
     C  N33WBFRTL        COMP      ST2LK                              3333
     C   33              GOTO      STBFR
     C                   END
     C* The prices in the record read is to be raised
     C  N29FTMIN         MULT(H)   ZMULT         FTMIN
     C   29FTMIN         MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMIN
     C*
     C  N29FTMAX1        MULT(H)   ZMULT         FTMAX1
     C   29FTMAX1        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX1
     C*
     C  N29FTMAX2        MULT(H)   ZMULT         FTMAX2
     C   29FTMAX2        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX2
     C*
     C  N29FTMAX3        MULT(H)   ZMULT         FTMAX3
     C   29FTMAX3        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX3
     C*
     C                   Z-ADD     1             NR                2 0
     C     NR            DOWLE     12
     C  N29FB(NR)        MULT(H)   ZMULT         FB(NR)
     C   29FB(NR)        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FB(NR)
     C                   ADD       1             NR
     C                   END
     C* MINMAX KODE ... (Også ved brutto lagret på den enkelte linje)
     C     FTMM          IFNE      0
     C                   EXSR      SRFM
     C                   END
     C*
     C                   ADD       1             WBFRSI
     C                   ADD       1             WBFRTO
     C*
     C  N27
     CANN28              UPDATE    FRATR
     C   27              UPDATE    FRATFR
     C  N27
     CAN 28              UPDATE    FRATTR
     C*
     C                   GOTO      STBFR
     C*
     C     SLBFR         TAG
     C                   MOVE      'DIV2110'     MSGNR
     C                   MOVE      *ZEROS        WBFRPR
     C                   MOVE      *ZEROS        WBFRAV
     C                   MOVE      *BLANKS       WBFRFR
     C                   MOVE      *BLANKS       WBFRTI
     C                   MOVE      *BLANKS       WBFRFL
     C                   MOVE      *BLANKS       WBFRTL
     C                   MOVE      '+'           WBFRPM
     C                   ENDSR
     C*
     C*
     C*
     C*
     C***********************************************
     C     INCAFR        BEGSR
     C***********************************************
     C                   MOVEA     '0000'        *IN(27)
     C                   Z-ADD     1             ZMULT
     C                   MOVE      WAFRPR        ZDESIM            4 4
     C* rent prosenttrekk
     C     WAFRPM        IFEQ      '-'
     C                   SUB       ZDESIM        ZMULT
     C                   ELSE
     C* opphev tidligere økning på xx %
     C     WAFRPM        IFEQ      'M'
     C                   ADD       ZDESIM        ZMULT
     C     1             DIV(H)    ZMULT         ZMULT
     C                   ELSE
     C* rent prosent tillegg
     C                   ADD       ZDESIM        ZMULT
     C                   END
     C                   END
     C* Is rounding procedure to be called (code 2 and 3) -> 29 On
     C                   MOVE      WAFRAV        ZKODE             1 0
     C     ZKODE         COMP      2                                  29  29
     C* Set keys for freight rate files
     C     WAFRKU        IFEQ      99999999
     C                   Z-ADD     1             YKN
     C                   Z-ADD     99999999      MAXKU             8 0
     C                   ELSE
     C                   MOVE      WAFRKU        YKN
     C                   MOVE      WAFRKU        MAXKU
     C                   END
     C* BRUKER ALLTID FRAT VED KUNDEAVTALER.....
     C                   MOVE      WAFRFR        YSDF
     C                   MOVE      WAFRTI        YSDT
     C*
     C     FRATK         SETLL     FRATN
     C*
     C     STAFR         TAG
     C                   READ      FRATN                                  30
     C  N30FTKNR         COMP      MAXKU                              30
     C   30              GOTO      SLAFR
N03  C*
N03  C* med i utelate fra til kunde
N03  C     FTKNR         IFGE      WAFKU1
N03  C     FTKNR         ANDLE     WAFKU2
N03  C                   GOTO      STAFR
N03  C                   END
     C*
     C* VED ALLE ... Utelat visse kunder fra økning......
     C     WAFRKU        IFEQ      99999999
     C                   MOVE      FTKNR         YYYKNR
     C     KUNKEY        CHAIN     KUIPRL01                           33
     C  N33              GOTO      STAFR
     C                   END
     C* Prosent av brutto .. ikke endring.
     C     FTKODE        IFEQ      'P'
     C                   GOTO      STAFR
     C                   END
     C* Utelates pga STED FRA ????
     C     WAFRFR        IFNE      '*ALL'
     C     WAFRFR        ANDNE     FTFRA
     C                   GOTO      STAFR
     C                   END
     C* Utelates pga STED TIL ????
     C     WAFRTI        IFNE      '*ALL'
     C     WAFRTI        ANDNE     FTTIL
     C                   GOTO      STAFR
     C                   END
     C* Utelates pga LANDKODE FRA ????
     C     WAFRFL        IFNE      *BLANKS
     C     FTFRA         CHAIN     STED2                              33
     C  N33WAFRFL        COMP      ST2LK                              3333
     C   33              GOTO      STAFR
     C                   END
     C* Utelates pga LANDKODE TIL ????
     C     WAFRTL        IFNE      *BLANKS
     C     FTTIL         CHAIN     STED2                              33
     C  N33WAFRTL        COMP      ST2LK                              3333
     C   33              GOTO      STAFR
     C                   END
     C* The prices in the record read is to be raised
     C  N29FTMIN         MULT(H)   ZMULT         FTMIN
     C   29FTMIN         MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMIN
     C*
     C  N29FTMAX1        MULT(H)   ZMULT         FTMAX1
     C   29FTMAX1        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX1
     C*
     C  N29FTMAX2        MULT(H)   ZMULT         FTMAX2
     C   29FTMAX2        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX2
     C*
     C  N29FTMAX3        MULT(H)   ZMULT         FTMAX3
     C   29FTMAX3        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FTMAX3
     C*
     C                   Z-ADD     1             NR                2 0
     C     NR            DOWLE     12
     C  N29FB(NR)        MULT(H)   ZMULT         FB(NR)
     C   29FB(NR)        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD(H)  ZNUMB         FB(NR)
     C                   ADD       1             NR
     C                   END
     C* MINMAX KODE ...
     C     FTMM          IFNE      0
     C                   EXSR      SRFM
     C                   END
     C*
     C                   ADD       1             WAFRSI
     C                   ADD       1             WAFRTO
     C*
     C                   UPDATE    FRATR
     C* FLERE...?
     C                   GOTO      STAFR
     C*
     C     SLAFR         TAG
     C                   MOVE      'DIV2110'     MSGNR
     C                   MOVE      *ZEROS        WAFRKU
     C                   MOVE      *ZEROS        WAFRPR
     C                   MOVE      *ZEROS        WAFRAV
     C                   MOVE      *BLANKS       WAFRFR
     C                   MOVE      *BLANKS       WAFRTI
     C                   MOVE      *BLANKS       WAFRFL
     C                   MOVE      *BLANKS       WAFRTL
     C                   MOVE      '+'           WAFRPM
     C                   ENDSR
     C*
     C***********************************************
     C     INCBGE        BEGSR
     C***********************************************
      *
      * ENDRE I BRUTTO PRISFIL
      *
     C                   MOVEA     '0000'        *IN(27)
     C* One single factor to do the incr. by % (ZMULT is 1.????)
     C                   Z-ADD     1             ZMULT
     C                   MOVE      WBGEPR        ZDESIM            4 4
     C* rent prosenttrekk
     C     WBGEPM        IFEQ      '-'
     C                   SUB       ZDESIM        ZMULT
     C                   ELSE
     C* opphev tidligere økning på xx %
     C     WBGEPM        IFEQ      'M'
     C                   ADD       ZDESIM        ZMULT
     C     1             DIV(H)    ZMULT         ZMULT
     C                   ELSE
     C* rent prosent tillegg
     C                   ADD       ZDESIM        ZMULT
     C                   END
     C                   END
     C* Is rounding procedure to be called (code 2 and 3) -> 29 On
     C* Half adj. to field with no desim.  (code 1  )     -> 28 On
     C                   MOVE      WBGEAV        ZKODE             1 0
     C     ZKODE         COMP      1                                      28
     C     ZKODE         COMP      2                                  29  29
     C* Set key  for standard price table
     C                   MOVE      WBGETA        YTNR
     C*
     C     PRISKE        SETLL     PRIS
     C*
     C     STBGE         TAG
     C                   READ      PRIS                                   30
     C  N30WBGETA        IFNE      '*'
     C     PRTNR         COMP      WBGETA                             30
     C                   END
     C   30              GOTO      SLBGE
      *
     C     PRGEBY        CHAIN     GEBIPR                             33
     C  N33              GOTO      STBGE
     c     wagba         ifne      *blanks
     c     PRGEBY        lookup    WAGB                                   33
     C  N33              GOTO      STBGE
     c                   end
      *
      * ENDRING I FAST BELØP
      *
     c     wbgepm        ifeq      'B'
S02  c*    wbgeva        andeq     PKFVAL
n02  c     wbgeva        IFEQ      PKFVAL
     C                   add       WBGEPR        PRBELØ
n02  c                   end
     c                   else
     C* The prices in the record read is to be raised
     C* No rounding (keep the decimals)
     C  N28
     CANN29PRBELØ        MULT(H)   ZMULT         PRBELØ
     C* Round to nearest whole number
     C   28PRBELØ        MULT(H)   ZMULT         ZWORK             7 0
     C   28              Z-ADD     ZWORK         PRBELØ
     C* Round to nearest ....5 (kode 2) or ....10 (kode3)
     C   29PRBELØ        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD     ZNUMB         PRBELØ
     C*
     C                   END
     C*
     C                   ADD       1             WBGESI
     C                   ADD       1             WBGETO
     C                   UPDATE    PRISR
     C*
     C                   GOTO      STBGE
     C*
     C     SLBGE         TAG
     C                   MOVE      'DIV2110'     MSGNR
     C                   MOVE      *ZEROS        WBGEPR
     C                   MOVE      *ZEROS        WBGEAV
     C                   MOVE      *BLANKS       WBGETA
     C                   MOVE      '+'           WBGEPM
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INCAGE        BEGSR
     C***********************************************
      *
      * endre gebyravtaler kunder
      *
     C                   MOVEA     '0000'        *IN(27)
     C* One single factor to do the incr. by % (ZMULT is 1.????)
     C                   Z-ADD     1             ZMULT
     C                   MOVE      WAGEPR        ZDESIM            4 4
     C* rent prosenttrekk
     C     WAGEPM        IFEQ      '-'
     C                   SUB       ZDESIM        ZMULT
     C                   ELSE
     C* opphev tidligere økning på xx %
     C     WAGEPM        IFEQ      'M'
     C                   ADD       ZDESIM        ZMULT
     C     1             DIV(H)    ZMULT         ZMULT
     C                   ELSE
     C* rent prosent tillegg
     C                   ADD       ZDESIM        ZMULT
     C                   END
     C                   END
     C* Is rounding procedure to be called (code 2 and 3) -> 29 On
     C* Half adj. to field with no desim.  (code 1  )     -> 28 On
     C                   MOVE      WAGEAV        ZKODE             1 0
     C     ZKODE         COMP      1                                      28
     C     ZKODE         COMP      2                                  29  29
     C* Set key  for price agreement file (move to alpha for compare)
     C                   MOVE      WAGEKU        YKNA
     C                   MOVE      WAGEKU        ZAGEKU            8
     C* Alle ???
     C     WAGEKU        IFEQ      99999999
     C                   MOVE      '00000001'    YKNA
     C                   END
     C*
     C     PRIKK         SETLL     PRIK
     C*
     C     STAGE         TAG
     C                   READ      PRIK                                   30
     C  N30WAGEKU        IFNE      99999999
     C     PKKNR         COMP      ZAGEKU                             30
     C                   END
     C   30              GOTO      SLAGE
      * UTELAT GEBYRKODER
      *
     C     PKGEBY        CHAIN     GEBIPR                             33
     C  N33              GOTO      STAGE
N03  C*
N03  C* med i utelate fra til kunde
N03  C                   MOVE      PKKNR         PKKNRN            8 0
N03  C     PKKNRN        IFGE      WAGKU1
N03  C     PKKNRN        ANDLE     WAGKU2
N03  C                   GOTO      STAGE
N03  C                   END
      *
     C* Utelat visse kunder fra økning......
     C     WAGEKU        IFEQ      99999999
     C                   MOVE      PKKNR         YYYKNR
     C     KUNKEY        CHAIN     KUIPRL01                           33
     C  N33              GOTO      STAGE
     C                   END
     C     PKAVTT        IFEQ      'P'
     C     PKAVTT        OREQ      'B'
     C     PKAVTT        OREQ      'X'
     C     PKAVTT        OREQ      'H'
     C                   GOTO      STAGE
     C                   END
      *
      * kun følgende gebyr
      *
     c     wagea         ifne      *blanks
     c     PKGEBY        lookup    WAGE                                   33
     C  N33              GOTO      STAGE
     c                   end
     C* The prices in the record read is to be raised
      *
      * fast beløp endring
      *
     c     wagepm        ifeq      'B'
S02  c*    wbgeva        andeq     PKFVAL
N02  c     wageva        ifeq      PKFVAL
     C                   add       WAGEPR        PKBELØ
N02  C                   end
     c                   else
     C* No rounding (keep the decimals)
     C  N28
     CANN29PKBELØ        MULT(H)   ZMULT         PKBELØ
     C  N28
     CANN29PKJUST        MULT(H)   ZMULT         PKJUST
     C* Round to nearest whole number
     C   28PKBELØ        MULT(H)   ZMULT         ZWORK             7 0
     C   28              Z-ADD     ZWORK         PKBELØ
     C   28PKJUST        MULT(H)   ZMULT         ZWORK             7 0
     C   28              Z-ADD     ZWORK         PKJUST
     C* Round to nearest ....5 (kode 2) or ....10 (kode3)
     C   29PKBELØ        MULT      ZMULT         ZNUMB
     C   29              EXSR      ROUND
     C   29              Z-ADD     ZNUMB         PKBELØ
     C   29PKJUST        IFNE      *ZEROS
     C     PKJUST        MULT      ZMULT         ZNUMB
     C                   EXSR      ROUND
     C                   Z-ADD     ZNUMB         PKBELØ
     C                   END
     c                   end
     C*
     C* New expire date?
     C     WAGEDA        IFNE      *ZEROS
     C                   MOVE      XAGEDA        PKDT
     C                   END
     C*
     C                   ADD       1             WAGESI
     C                   ADD       1             WAGETO
     C                   UPDATE    PRIKR
     C*
     C                   GOTO      STAGE
     C*
     C     SLAGE         TAG
     C                   MOVE      'DIV2110'     MSGNR
     C                   MOVE      *ZEROS        WAGEPR
     C                   MOVE      *ZEROS        WAGEAV
     C                   MOVE      *ZEROS        WAGEKU
     C                   MOVE      *ZEROS        WAGEDA
     C                   MOVE      '+'           WAGEPM
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     ROUND         BEGSR
     C***********************************************
     C* Param. = ZKODE (1,2,3,4)  = Roundingcode
     C*          ZNUMB workfield 11 long 2 digits
     C*         (ZNUMBB) is the 3 last pos. of ZNUMB (via Data Struct.)
     C*
     C* Code 2 = To nearest  5
     C     ZKODE         IFEQ      2                                            B1
     C     ZNUMBB        IFLT      2.50                                           B2
     C                   MOVE      '000'         ZNUMB
     C                   ELSE
     C     ZNUMBB        IFGE      2.50                                             B3
     C     ZNUMBB        ANDLE     7.49
     C                   MOVE      '500'         ZNUMB
     C                   ELSE
     C                   ADD       10            ZNUMB
     C                   MOVE      '000'         ZNUMB
     C                   END                                                        E3
     C                   END                                                      E2
     C* Code 3 = To nearest 10
     C                   ELSE
     C     ZNUMBB        IFGE      5.00                                           B2
     C                   ADD       10            ZNUMB
     C                   END                                                      E2
     C                   MOVE      '000'         ZNUMB
     C                   END                                                    E1
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     SRFM          BEGSR
     C***********************************************
     C                   Z-ADD     0             NR                2 0
     C                   MOVE      *BLANKS       WP
     C     NR            DOWLT     FTFAST                                        1<-B
     C                   ADD       1             NR
     C                   MOVE      'F'           WP(NR)
     C                   END                                                     1<-E
     C     FTPRPR        IFEQ      0                                            1<-B
     C                   Z-ADD     100           FTPRPR
     C                   END                                                    1<-E
     C                   Z-ADD     0             YPRIS             5 0
     C                   Z-ADD     1             NR
      *
     C     FTMM          IFEQ      1                                            1<-B
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FB(NR)        YPRIS
     C                   END                                                     2
     C     FTMIN         IFGT      YPRIS                                         2<-B
     C                   Z-ADD     FTMIN         YPRIS
     C                   END                                                     2
      *
     C     STMM1         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C     FB(NR)        IFGT      YPRIS                                         2<-B
     C                   Z-ADD     FB(NR)        FM(NR)
     C                   Z-ADD     FB(NR)        YPRIS
     C                   ELSE                                                    2
     C                   Z-ADD     YPRIS         FM(NR)
     C                   END                                                     2
     C                   ELSE                                                    2
     C                   Z-ADD     YPRIS         FM(NR)
     C                   MOVE      99999         FVK(12)
     C     FVK(NR)       MULT      FB(NR)        WORK              8 0
     C     FTKOLL        IFEQ      'L'
     C     FTKOLL        OREQ      'M'
     C     WORK          DIV(H)    100           YPRIS
     C                   ELSE
     C     WORK          DIV       FTPRPR        YPRIS
     C                   END
     C     YPRIS         IFLT      FM(NR)                                         3<-B
     C                   Z-ADD     FM(NR)        YPRIS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C     FVK(NR)       IFNE      99999                                          3<-B
     C                   ADD       1             NR
     C     NR            IFLE      12                                              4<-B
     C                   GOTO      STMM1
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C                   END                                                    1<-E
      *
     C     FTMM          IFEQ      2                                            1<-B
      *
     C                   Z-ADD     2             N2                2 0
     C     STMM2         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FB(NR)        FM(NR)
     C                   ELSE                                                    2
      *
     C     FVK(NR)       MULT      FB(N2)        WORK              8 0
     C     FTKOLL        IFEQ      'L'
     C     FTKOLL        OREQ      'M'
     C     WORK          DIV(H)    100           FM(NR)
     C                   ELSE
     C     WORK          DIV       FTPRPR        FM(NR)
     C     FM(NR)        IFEQ      *ZEROS
     C                   Z-ADD     FTMAX3        FM(NR)
     C                   END
     C                   END
     C                   END                                                     2<-E
      * AVTALESPESIFIK VEKTINNDELING ???
     C     FVK(N2)       IFNE      99999
     C                   ADD       1             NR
     C                   ADD       1             N2
     C                   GOTO      STMM2
     C                   END
      *
     C                   END                                                    1<-E
      *
     C     FTKOLL        IFEQ      'X'
     C                   MOVE      *ZEROS        FTPRPR
     C                   END
      *
     C                   ENDSR
      *
      *
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WAFRKU
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WAGEKU
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      15
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WAFRKU
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     16            LINNBR
N01  C                   Z-ADD     35            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      21
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WAGEKU
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     22            LINNBR
N01  C                   Z-ADD     35            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C* Key for freightrates sorted by cust.no.....
     C     FRATK         KLIST
     C                   KFLD                    YKN
     C* Key for freightrates sorted by cust.no+From-destin.+.......
     C     FRATFK        KLIST
     C                   KFLD                    YKN
     C                   KFLD                    YSDF
     C* Key for freightrates sorted by cust.no+To-destin.+.......
     C     FRATTK        KLIST
     C                   KFLD                    YKN
     C                   KFLD                    YSDT
     C* Key for customer file
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YKNR              8 0
     C* Key for standard price tables
     C     PRISKE        KLIST
     C                   KFLD                    YTNR
     C                   KFLD                    YGEBY
     C                   KFLD                    YINT
     C* Key for Price agreement file
     C     PRIKK         KLIST
     C                   KFLD                    YKNA
     C                   KFLD                    YAVTNA
     C                   KFLD                    YGEBY
     C                   KFLD                    YAVTT
     C                   KFLD                    YINT
     C                   KFLD                    YLNR
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YYYKNR            8 0
     C*
     C                   READ      FIRM                                   33
     C*
     C*
     C* INITIALIZE DS-DEFINED ARRAYS
     C                   MOVE      *ZEROS        FB
     C                   MOVE      *ZEROS        FM
     C                   MOVE      *BLANKS       WP
     C                   MOVE      *ZEROS        FVK
     C*
     C                   MOVE      '10000'       ZMULT             5 4
     C                   MOVE      *ZEROS        WBFRAV
     C                   MOVE      *ZEROS        WBGEAV
     C                   MOVE      *ZEROS        WAFRAV
     C                   MOVE      *ZEROS        WBGEAV
     C                   MOVE      *ZEROS        WBFRSI
     C                   MOVE      *ZEROS        WBGESI
     C                   MOVE      *ZEROS        WAFRSI
     C                   MOVE      *ZEROS        WAGESI
     C                   MOVE      *ZEROS        WBFRTO
     C                   MOVE      *ZEROS        WBGETO
     C                   MOVE      *ZEROS        WAFRTO
     C                   MOVE      *ZEROS        WAGETO
     C                   MOVE      '+'           WBFRPM
     C                   MOVE      '+'           WAFRPM
     C                   MOVE      '+'           WBGEPM
     C                   MOVE      '+'           WAGEPM
     C                   MOVE      *ZEROS        WAGEDA
     C                   MOVE      *ZEROS        XAGEDA
     C                   MOVE      ' '           YTNR              1
     C                   MOVE      '   '         YGEBY             3
     C                   MOVE      ' '           YAVTT             1
     C                   MOVE      *ZEROS        YINT              5 0
     C                   MOVE      *ZEROS        YLNR              4 0
     C                   MOVE      *ZEROS        YKNA              8
     C                   MOVE      *ZEROS        YKN               8 0
     C                   MOVE      '     '       YSDF              5
     C                   MOVE      '     '       YSDT              5
     C                   Z-ADD     0             YAVTN             1 0
     C                   MOVE      ' '           YAVTNA            1
     C                   MOVE      'DIV0000'     MSGNR
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
S01  C*
S01  C*                  EXSR      HMSG
     C*
     C                   ENDSR
S01  C***********************************************
S01  C*    HMSG          BEGSR
S01  C***********************************************
S01  C*                  MOVE      'DIV2094'     XMSGNR            7            MELDING-ID
S01  C*                  EXSR      HMSG2
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV2095'     XMSGNR
S01  C*                  EXSR      HMSG2
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*
S01  C*                  ENDSR
S01  C*
S01  C***********************************************
S01  C*    HMSG2         BEGSR
S01  C***********************************************
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIVÅ
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     132           XMSGL             4 0          LENGDE PÅ MELDING
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    XMSG            132
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C*
     C* Format expiredate for agreed prices
     C     WAGEDA        IFNE      *ZEROS
     C                   MOVE      WAGDD         UDT1              2 0
     C                   MOVE      WAGDM         UDT2              2 0
     C                   MOVE      WAGDÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WAGDD
     C                   MOVE      UDT2          WAGDM
     C                   MOVE      UDT3          WAGDÅ
     C                   END
     C*
     C                   ENDSR
     C*
