********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 02 SH  PTF10 tollsted 4 0
10XXX * 03 JOV PTF10 HENT KUNDEINFO ETTER SØK (EXSR TESTKU)
10XXX * 04 YBC PTF10 IKKE BLANKE NAVN VED SØKING AV KUNDENR
10XXX * 05 YBC PTF10 OPPDATER RIKTIG DATA PÅ INNLANDS FRAKTBREV
10XXX * 06 SH  PTF10 endringer på selges landkode  NO = Norge
10XXX * 07 JOV PTF10 Søk på "gamlemåten"(alle 8 nr)dersom cursor i pos 2-8
10XXX * 08 SH  PTF10 RETTELSE TIL NUMMER 6
10172 * 09 SH  PTF10 norsk text til Track and trace
10217 * 10 YBC PTF10 FLERE DEFAULT PRINTER
10XXX * 11 JOV PTF10 Nye parametre SYIN10B
10XXX * 12 SH  PTF11 dummu oppdragsgiver  er  S
10XXX * 13 SH  PTF11 feil i høyde lengde bredde syin10b
10XXX * 14 SH  PTF11 sette tilbake status
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11132 * 15 YBC PTF11 3 DESIMALER PÅ KALKULATOR
11132 * 16 SH  PTF11 f17 er nå arkiv
11132 * 17 SH  PTF11 tatt bort fax rått
11132 * 18 SH  PTF12 oppdaterer fakt ved valuta kunde endret
********************************************************************
      *
      *****************************************************************
      *** PROGRAM FOR AIR EXPORT                                    ***
      *****************************************************************
      ***                                                           ***
      *** INDICATORER 01 - 26 IS FUNCTION-KEYS                      ***
      *** FREE   INDICATORES 01 08 13 17 19 22 25 26                ***
      ***                    35-52 71-79 90-92                      ***
      *** INDICATOR 31 32 34 MEENS CALL FROM    SYFF10              ***
      *****************************************************************
      *
     FKUFAST    IF   E           K DISK
     FFRILKSD   IF   E           K DISK
     FDOKOTH    UF   E           K DISK
     FDOKEF     UF   E           K DISK
     FKODTFLP   IF   E           K DISK
     FTRACKF    O  A E           K DISK
     FTRACKT    O  A E           K DISK
     FSTATVF    O  A E           K DISK
     FGSSTRF    IF   E           K DISK
     FGSSBIF    IF   E           K DISK
     FHEADF     UF A E           K DISK
     FHEDUMMY   IF   E           K DISK    RENAME(HEADFR:HEAD2R)
     FDOKUF     UF A E           K DISK
     FSAMLA     UF   E           K DISK
     FMULTKODT  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FFRATXT    IF   E           K DISK
     FTELL      UF   E           K DISK
     FTELLAWB   UF   E           K DISK
     FVADR      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFREETXT   IF   E           K DISK
     FGSSBXF    IF   E           K DISK
     FLOCL01    IF   E           K DISK    USROPN
     FEDIM1     IF   E           K DISK
     FCUOTI     IF   E           K DISK
     FFRISOK    UF A E           K DISK
     FKODFRI    IF   E           K DISK
     FENADSF    IF   E           K DISK
     FKUNKO2    IF   E           K DISK
     FSYEF10FM  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
s13  D*HØ              S              3  2 DIM(99)
s13  D*LE              S              3  2 DIM(99)
s13  D*BR              S              3  2 DIM(99)
s13  D*AN              S              3  0 DIM(99)
n13  D HØ              S              3  2 DIM(12)
n13  D LE              S              3  2 DIM(12)
n13  D BR              S              3  2 DIM(12)
n13  D AN              S              3  0 DIM(12)
     D NAV             S              3    DIM(12) CTDATA PERRCD(1)
     D WR1             S              1    DIM(9)
     D WR2             S              1    DIM(17)
     D WR3             S              1    DIM(30)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSMSG                  1     62
     D  XKN                    7     14
     D  XLIKOD                31     31
     D  XLINAV                33     62
     D                 DS
     D  XMÅL1                  6      9
     D  XMÅL2                 11     13
     D  XMÅL                   1     13
     D                 DS
     D  WSSDT                  1      5
     D  YSDT                   1      3
     D                 DS
     D  WSSDF                  1      5
     D  YSDF                   1      3
     D                 DS
     D  HEKNT                  1      8  0
     D  HEKNF                  6      8  0
     D                 DS
     D  WSSDL                  1     20
     D  WSSDL1                 1      1
     D  WSSDL2                 2     20
     D                 DS
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  HEDTRÅ                 1      4  0
     D  HEDTRM                 5      6  0
     D  HEDTRD                 7      8  0
     D  HEDTR                  1      8  0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
     D                 DS
     D  M0068A                 1      8  0
     D  W0068A                 5      8  0
      *____________________________________________________________
      * Definisjon av parameterlisten som brukes ved kall av TDV51C
      * (Schedule Request). TdV IS må være installert
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  BUTTRM                 1      1
     D  BUTAOR                 2      4
     D  BUTADE                 5      7
     D  BUTDA1                 8      9  0
     D  BUTMN1                10     12
     D  BUTPID                13     29
     D  BUTRA1                30     32
     D  BUTRB1                33     39
     D  BUTRC1                40     41  0
     D  BUTRA2                42     44
     D  BUTRB2                45     51
     D  BUTRC2                52     53  0
     D  BUTRA3                54     56
     D  BUTRB3                57     63
     D  BUTRC3                64     65  0
     D  BUTYKL                66     69  0
     D  BUTYAI                70     72
     D  BUTINF                 1     72
     D                 DS
     D  QDATA                  1    109
     D  QDA01                  1      2
     D  QDA02                  3      6
     D  QDA03                  7     13
     D  QDA04                 14     15
     D  QDA05                 16     16
     D  QDA06                 17     20
     D  QDA07                 21     24
     D  QDA08                 25     26
     D  QDA09                 27     28
     D  QDA10                 29     29
     D  QDA11                 30     30
     D  QDA12                 31     37
     D  QDA13                 38     38
     D  QDA14                 39    100
     D  QDA15                101    101
     D  QDA16                102    102
     D  QDA17                103    103
     D  QDA18                104    109
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
      *____________________________________________________________
      * Definition of the parameter CUTINF
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  CUTTRM                 1      1
     D  CUTPID                 2     18
     D  CUTALN                19     21  0
     D  CUTAWB                22     29  0
     D  CUTORI                30     32
     D  CUTDES                33     35
     D  CUTNPI                37     40  0
     D  CUTWGH                42     50  1
     D  CUTVOL                51     62  2
     D  CUTCON                63     77
     D  CUTCAR                78     79
     D  CUTFLN                80     84
     D  CUTSR1                85    149
     D  CUTSR2               150    214
     D  CUTINF                 1    256
     D                 DS
     D  CUTOS1                 1     64
     D  CUTPNA                65     99
     D  CUTPAD               100    134
     D  CUTPPL               135    151
     D  CUTPCO               152    160
     D  CUTDNA               161    195
     D  CUTDAD               196    230
     D  CUTDPL               231    247
     D  CUTDCO               248    256
     D  CUTIN2                 1    256
     D                 DS
     D  WRKSR1                 1     65
     D  F5212                  1      1
     D  F52141                 2      3
     D  F52142                 4      6
     D  F52143                 7     10
     D  F52161                11     12
     D  F52162                13     15
     D  F52163                16     19
     D  F5218                 20     31
     D  F52110                32     39
     D  F52112                40     44
     D                 DS
     D  WRKSR2                 1     65
     D  F5321                  1     30
     D  F5323                 31     60
     D                 DS
     D  WRKOS1                 1     65
     D  F6231                  1     30
     D  F6233                 31     40
     D  F6235                 41     50
     D  F6236                 51     60
N05  D                 DS
N05  D  TMPAD3                 1     25
N05  D  TMPAD3B                1      1
N05  D  TMPAD3c                2     25
     D                 DS
     D SKTXT1          C                   CONST('Op.giver')
     D LDADS          UDS
     D  DSTINF               801    872
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UBIAVD                15     18  0
     D  UBIUSI               101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
     D  UBILOC               144    148
N10  D  UBIPRP               149    158
N10  D  UBIPRI               159    168
      *___________________
      * DS for System Data
      *"""""""""""""""""""
     D                SDS
     D  WUSER                254    263
      *
     C                   OPEN      SYEF10FM
     C                   EXSR      INIT
      * Oppdaterer LDA slik at pos. 801-869 er garantert blanke
     C                   MOVEL     *BLANKS       DSTINF
     C                   OUT       LDADS
     C                   GOTO      START1
     C*
     C     START         TAG
     C  N30              DO
     C                   MOVE      HEOPD         WSOPDG
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        HEAVD
     C                   MOVE      *ZEROS        HEOPD
     C                   SETOFF                                       279998
     C                   END
     C     STB1A         TAG
     C                   MOVEL     *BLANKS       DSTINF
     C                   EXFMT     BILDE01
     C     UDUMMY        IFEQ      'J'
     C   12              GOTO      SLUTT
     C                   MOVE      *ZEROS        WSOPD
     C                   EXSR      TESTB1
     C                   MOVE      *ZEROS        WSDT
     C                   SETOFF                                       30
     C                   GOTO      START2
     C                   END
     C                   SETOFF                                       30
     C                   MOVEA     '0000'        *IN(96)
     C                   MOVE      *BLANKS       WSMSG
     C*
     C   07              DO
     C                   EXSR      GETOPD
     C     UAVDE         IFEQ      0
     C     UOPDE         OREQ      0
     C                   GOTO      STB1A
     C                   END
     C                   END
     C*
     C   12              GOTO      SLUTT
     C     START1        TAG
     C                   EXSR      TESTB1
     C*
     C   30UTYPE         IFEQ      'CR2'
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      SLUTT
     C                   END
     C     MSGNR         IFNE      'YBC0036'
     C                   MOVE      'DIV0000'     MSGNR
     C                   END
     C*
     C*** UTYPE = 'CHF/CHO' CALL FROM SYFF10 (CHANGE INVOICE)
     C  N05UTYPE         IFEQ      'CHF'
     C                   EXSR      TESTB2
     C                   GOTO      START3
     C                   END
     C*
     C   05              DO
     C                   EXSR      TESTB2
     C                   GOTO      START3
     C                   END
     C*
     C     START2        TAG
     C  N30
     CANN04
     CANN14              Z-ADD     2             LINNBR
     C  N30
     CANN04
     CANN14              Z-ADD     8             POSNBR
     C*
     C                   EXSR      TSTOPL
     C*
     C*
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE02
     C                   EXSR      KDTFMT
     C     UDUMMY        IFEQ      'J'
     C                   EXSR      OPDHEA
     C                   GOTO      SLUTT
     C                   END
     C                   SETOFF                                       309998
     C                   MOVEA     '0000'        *IN(93)
     C                   MOVEA     '0000000'     *IN(83)
     C                   MOVEA     '000'         *IN(80)
     C                   MOVEA     '000000'      *IN(65)
     C                   MOVEA     '0000'        *IN(59)
     C                   MOVEA     '0'           *IN(71)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C* CHANGES F-FUNCTION LINES
     C*
     C   24              DO
     C                   EXSR      UTCMDL
     C                   GOTO      START2
     C                   END
     C* KALL PÅ TDVIS SCHEDUEL REQUEST
     C*
     C     *IN22         IFEQ      '1'
     C     FITDVI        IFNE      'J'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      START2
     C                   ENDIF
     C                   EXSR      SFACT
     C                   GOTO      START2
     C                   ENDIF
     C*
     C*
     C* KALL PÅ TDVIS SCHEDUEL REQUEST
     C*
     C     *IN23         IFEQ      '1'
     C     FITDVI        IFNE      'J'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      START2
     C                   ENDIF
     C                   EXSR      SFIR
     C                   GOTO      START2
     C                   ENDIF
     C*
     C* CALLS INQUIRY PROGRAM
     C*
     C   07              DO
     C                   MOVE      'S'           UTYPE2
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE2
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   GOTO      START2
     C                   END
     C*
     C* FREETEXT
     C   18              DO
     C     WSOPD         IFEQ      *ZEROS
     C                   MOVE      'SPO0106'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START2
     C                   END
     C                   EXSR      VISFRE
     C                   GOTO      START2
     C                   END
     C* FRI SØKEVEI
     C                   EXSR      TESTKT
     C   15              DO
     C     WSOPD         IFEQ      *ZEROS
     C                   MOVE      'SHU0126'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START2
     C                   END
     C                   CALL      'SYFA64'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
     C                   GOTO      START2
     C                   END
     C*
     C*
     C* DUPOPPDRAG INNHENT/UTKJØRING
     C   11              DO
     C     WSOPD         IFEQ      *ZEROS
     C                   MOVE      'JOV0802'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START2
     C                   END
     C                   EXSR      OPDHEA
     C                   Move      'J'           XXVIS             1
     C                   CALL      'SYTR11'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    XXFBNR            3 0
     C                   PARM                    XXVIS
     C                   GOTO      START2
     C                   END
     C*
     C   02WSMAWB        IFEQ      0
     C                   EXSR      SETSML
     C                   GOTO      START2
     C                   ELSE
     C                   GOTO      START2
     C                   END
     C*
     C* SEARTCH IN A FILE FOR INFORMATION  F4
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C   30              GOTO      START2
     C     UFLAGG        IFEQ      1
     C                   GOTO      START2
     C                   END
     C     UTYPE         IFEQ      'CHO'
     C*** UTYPE = 'CHF/CHO' CALL FROM SYFF10 (CHANGE ORDER)
     C                   GOTO      START2
     C                   END
     C                   END
     C*** 05 ON = DO NOT MOVE INFO. FROM ORDER TO AIRWAYBILL
     C   05              Z-ADD     8             UFLAGG
     C   06              DO
     C                   EXSR      KUBIKK
     C                   GOTO      START2
     C                   END
     C*
     C*   09   GETS AWB-NUMBER  ON AIRFREIGT
     C*
     C   09WSMAWB        IFEQ      0
     C                   EXSR      AWBSR
     C                   GOTO      START2
     C                   ELSE
     C                   GOTO      START2
     C                   END
     C*
     C* TAKES ORDER OFF AN CONSOLLIDATION
     C*
     C   10WSHAWB        IFNE      *ZEROS
     C     WSHAWB        ANDNE     *BLANKS
     C                   EXSR      SAMSLE
     C                   GOTO      START2
     C                   ELSE
     C                   MOVE      *ZEROS        WSHAWB
     C                   GOTO      START2
     C                   END
     C*
     C* ENDS ORDER
     C*
     C   12              DO
     C     HEADFK        CHAIN     HEADF                              33
S14  C* N33              MOVE      ' '           HEST
N14  C  N33              MOVE      GMST          HEST
     C  N33              UPDATE    HEADFR
     C   33WSMAWB        IFNE      *ZEROS
     C                   GOTO      START2
     C                   END
     C                   GOTO      SLUTT
     C                   END
     C*
     C* SHOWS FREEINFO FOR CUSTOMER
     C*
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START2
     C                   END
     C*
      *
      * SHOWS AIRFREIGHT RATES (BRUTTO)
      *
     C   17              DO
S16  C*                  EXSR      FINNVK
S16  C*                  MOVE      'O'           UMOD              1
S16  C*                  CALL      'SYEF62R'
S16  C*                  PARM                    WSSDF
S16  C*                  PARM                    WSSDT
S16  C*                  PARM      WSKNF         UKNF              3 0
S16  C*                  PARM      WSFBV         UFBV              5 0
S16  C*                  PARM                    UMOD
N16  C     WSOPD         IFEQ      *ZEROS
N16  C                   MOVE      'SHU1678'     MSGNR
N16  C                   SETON                                        30
N16  C                   GOTO      START2
N16  C                   END
N16  C                   CALL      'ARC003'
N16  C                   PARM                    WSAVD
N16  C                   PARM                    WSOPD
N16  C                   PARM                    WSRUNDE          10
     C                   GOTO      START2
     C                   END
      *
      * SHOWS AIRFREIGHT RATES (NETTO)
      *
     C   19              DO
     C                   EXSR      FINNVK
     C                   MOVE      'O'           UMOD              1
     C                   CALL      'SYEF63R'
     C                   PARM                    WSSDF
     C                   PARM                    WSSDT
     C                   PARM      WSKNF         UKNF              3 0
     C                   PARM      WSKNS         UKN               8 0
     C                   PARM                    URK               1
     C                   PARM                    UCOM              4
     C                   PARM      WSFBV         UFBV              5 0
     C                   PARM                    URPR              1
     C                   PARM                    URATE            13 2
     C                   PARM                    UMOD
     C                   GOTO      START2
     C                   END
     C*
     C                   EXSR      TESTB2
     C   30              GOTO      START2
     C*
     C* OPDATERER NYE OPPDRAG
     C*
     C     WSOPD         IFEQ      *ZEROS
     C                   EXSR      OPDHEA
     C                   END
     C*
     C*
     C*** UTYPE = 'CHF/CHO' CALL FROM SYFF10 (CHANGE ORDER)
     C  N03
     CANN05
     CANN07UTYPE         IFNE      'CHO'
      * TIL SHIP-SYS
     C                   IF        WSTSS = 'J'
     C                   EXSR      TILSS
     C                   END
     C                   GOTO      START2
     C                   END
     C*
     C                   EXSR      OPDHEA
      * TIL SHIP-SYS
     C                   IF        WSTSS = 'J'
     C                   EXSR      TILSS
     C                   END
     C*
     C*** UTYPE = 'CHF/CHO' CALL FROM SYFF10 (CHANGE ORDER)
     C     UTYPE         IFEQ      'CHO'
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** AIRWAYBILL
     C  N03WSPK8         IFEQ      'J'
     C                   EXSR      EFRABR
     C   12              GOTO      START2
     C                   END
     C*
     C*
     C     WSPK1         IFEQ      'J'
     C     DOKUFK        CHAIN(N)  DOKUF                              33
     C   03
     CAN 33
     COR 16
     CAN 33              EXSR      MOVWDF
     C*
     C*** REGISTRERE FRAKTBREV
     C  N03
     CANN16              EXSR      FRABR
     C   12              GOTO      START2                                       TIL OPPDRAG
     C                   END
     C*** BILL OF LADING
     C     WSPK7         IFEQ      'B'
     C                   EXSR      BILLOF
     C   12              GOTO      START2                                       TIL OPPDRAG
     C                   END
     C*
     C*** CMR FRAKTBREV
     C     WSPK7         IFEQ      'C'
     C                   EXSR      CMRFBR
     C   12              GOTO      START2                                       TIL OPPDRAG
     C                   END
     C*
     C*** INVOICE
     C     START3        TAG
     C     XNYGML        IFEQ      'NY'
     C                   MOVE      ' '           XKODE
     C                   EXSR      FAKTUR
     C                   ELSE
     C   05              EXSR      FAKTUR
     C  N05UTYPE         IFEQ      'CHF'
     C                   EXSR      FAKTUR
     C                   GOTO      SLUTT
     C                   ELSE
     C     HEADFK        CHAIN     HEADF                              33
S14  C* N33              MOVE      ' '           HEST
N14  C  N33              MOVE      GMST          HEST
     C  N33              UPDATE    HEADFR
     C                   END
     C                   END
     C*
     C   03UTYPE         IFEQ      'CR2'
     C                   MOVE      HEOPD         WSOPDG
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        HEAVD
     C                   MOVE      *ZEROS        HEOPD
     C                   SETOFF                                       300503
     C                   MOVEA     '0000'        *IN(96)
     C                   MOVE      '1'           *IN58
     C                   GOTO      START1
     C                   ELSE
N14  C     HEADFK        CHAIN     HEADF                              33
N14  C  N33              MOVE      GMST          HEST
N14  C  N33              UPDATE    HEADFR
     C                   GOTO      SLUTT
     C                   END
     C   12              GOTO      START2
     C*
     C     SLUTT         TAG
     C                   CLOSE     SYEF10FM
     C                   RETURN
     C*
     C***********************************************
     C     GETOPD        BEGSR
     C***********************************************
     C                   MOVE      'E'           UTYPE2            1
     C                   MOVE      WSAVD         UAVDE             4 0
     C                   MOVE      *ZEROS        UOPDE             7 0
     C                   MOVE      *BLANKS       USGE              3
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE2
     C                   PARM                    UAVDE
     C                   PARM                    UOPDE
     C                   PARM                    USGE
     C     UAVDE         IFNE      0                                            1<-B
     C     UOPDE         ANDNE     0
     C     UTYPE2        IFEQ      'E'                                           2<-B
     C                   MOVE      UAVDE         WSAVD
     C                   MOVE      UOPDE         WSOPD
     C                   MOVE      USGE          WSSG
     C                   ELSE                                                    2
     C                   MOVE      UAVDE         HEAVD
     C                   MOVE      UOPDE         HEOPD
     C     WSSG          IFEQ      *BLANKS                                        3<-B
     C                   MOVE      USGE          WSSG
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
N14  C                   MOVE      ' '           GMST              1
     C                   MOVE      'N'           VIADUMMY          1
     C                   MOVE      'DIV0000'     MSGNR
     C     WSOPD         IFGT      0
     C     HEOPD         IFGT      0
     C     HEAVD         ORGT      0
     C                   MOVE      'SPO0015'     MSGNR
     C                   SETON                                        3097
     C                   GOTO      SLT1
     C                   END
     C                   END
     C     XKODE         IFEQ      'Z'
     C                   MOVE      'NY'          XNYGML
     C                   ELSE
     C                   MOVE      'GM'          XNYGML            2
     C                   END
     C                   MOVE      'N'           XFLYTM            1
      * 28 ON = KOPI AV OPPDRAG
     C     HEOPD         COMP      0                                  28
     C  N28HEAVD         COMP      0                                  28
     C*
     C**** TEST SIGNATURE
     C     KODSFK        CHAIN     KOSFR                              99
     C   99              MOVE      'SPS0011'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLT1
     C*
     C*** TEST DEPARTMENT
     C     KODTAK        CHAIN     KOAR                               98
     C  N98KODTWK        CHAIN     KOWR                               98
     C  N98KODTVK        CHAIN     KOVR                               98
     C  N98              DO
     C     WSAVD         CHAIN(N)  TELL                               98
     C   98AVDZER        CHAIN(N)  TELL                               98
     C                   END
     C   98              MOVE      'SPA0006'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLT1
     C* KUN IMPORT  PÅ DENNE AVDELING?
     C     KOAIE         COMP      'I'                                    98
     C   98              MOVE      'JOV0077'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLT1
     C*
     C*** TEST ORDER
     C  N28              DO
     C     WSOPD         COMP      *ZEROS                                 33
     C  N33HEADFK        CHAIN     HEADF                              97
N14  C  N97
N14  CANN33              MOVE      HEST          GMST
     C   33
     CAN 05              SETON                                        97
     C   97              MOVE      'SPO0002'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      SLT1
     C  N33
     CANN09HESG          IFEQ      'DUP'
     C                   MOVE      USG           HESG
     C                   MOVE      USG           WSSG
     C                   END
     C  N33
     CANN09WSSG          IFNE      HESG
     C                   MOVE      HESG          WSSG
     C                   MOVE      'YBC0036'     MSGNR
     C                   END
     C  N33
     CANN99HEST          COMP      ' '                                9797
     C  N33
     CANN99
     CAN 97HEST          COMP      'C'                                9797
     C  N33
     CANN99
     CAN 97HEST          COMP      'U'                                9797
     C  N33
     CANN97
     CANN99HEUR          IFNE      'S'
     C     HEUR          COMP      'D'                                9797
     C                   END
     C   97              MOVE      'SPO0006'     MSGNR
     C   99              MOVE      'SPS0014'     MSGNR
     C   97
     COR 99              SETON                                        30
     C   30              UPDATE    HEADFR
     C   30              MOVE      *ZEROS        HEAVD
     C   30              MOVE      *ZEROS        HEOPD
     C   97
     COR 99              GOTO      SLT1
     C   33              MOVE      KOABÆR        WSSTD
     C                   END
     C*
     C*** TEST DEPARTMENT/ORDERNUMBER FOR COPYFUNCTION
     C   28              DO
     C     HEADKK        CHAIN(N)  HEADF                              33
     C  N33              MOVE      KOABÆR        WSSTD
     C   33              SETON                                        9630
     C   96              MOVE      'SPA0007'     MSGNR
     C* DIRECT TO INVOICE NOT ALLOWED
     C   05              MOVE      'SPO0029'     MSGNR
     C   05              SETON                                        9630
     C   96              GOTO      SLT1
     C                   MOVE      *ZEROS        WSOPD
     C                   END
     C*
     C  N33
     CANN28              DO
     C                   MOVE      'X'           HEST
     C   09              MOVE      WSSG          HESG
     C                   UPDATE    HEADFR
     C                   END
     C*
     C     WSOPD         IFEQ      0
     C                   MOVE      'NY'          XNYGML
     C  N28              MOVE      'N'           VIADUMMY
     C  N28HEADFK        CHAIN     HEDUMMY                            33
     C  N28
     CANN33              MOVE      'J'           VIADUMMY
     C  N28
     CANN33              SETON                                        28
     C  N28              EXSR      MOVB1
     C   28              EXSR      MOVHFW
     C                   ELSE
     C                   EXSR      MOVHFW
     C                   END
     C*
     C     SLT1          ENDSR
     C*
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C                   MOVE      'DIV0000'     MSGNR
     C     WSSG          IFEQ      *BLANKS
     C                   MOVE      USG           WSSG
     C                   END
     C     WSAVD         IFEQ      0
     C                   MOVE      UAVD          WSAVD
     C                   ELSE
     C     KODTAK        CHAIN     KOAR                               33
      * KUN IMPORT PÅ DENNE AVDELING?
     C  N33KOAIE         COMP      'I'                                    33
     C   33              MOVE      UAVD          WSAVD
     C   33KODTAK        CHAIN     KOAR                               33
     C                   END
     C                   MOVE      *BLANKS       KARTXT
     C*
     C*** TEST DATE
     C                   MOVE      WSDT          XMMÅÅ             4 0
     C                   MOVE      XMMÅÅ         UÅÅ               2 0
     C                   MOVEL     XMMÅÅ         UMM               2 0
     C                   MOVEL     WSDT          UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      96
     C   96              MOVE      'SPD0001'     MSGNR
     C   96              SETON                                        30
     C*
     C*** TEST TO DESTINATION
     C                   MOVE      *BLANKS       USDTT            18
     C     WSSDT         IFNE      *BLANKS                                      1<-B
     C     WSSDT         CHAIN     STED2                              94
     C  N94              DO                                                      2<-B
     C                   MOVEL     ST2NVN        USDTT
     C* GETS PREFFERRED ROUTING
     C                   MOVE      'N'           XANRUT            1
     C     KODARK        CHAIN     KODTARR                            33
     C  N33              MOVE      'J'           XANRUT
     C     ST2LK         IFNE      'NO'                                           3<-B
     C     WSLKA         ANDEQ     '  '
     C                   MOVE      ST2LK         WSLKA
     C                   END                                                      3<-E
     C     WSLKK         IFEQ      *BLANKS
     C                   MOVE      ST2LK         WSLKK
     C                   END
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** TEST DESTINATION FROM
     C                   MOVE      *BLANKS       USDFT            18
     C     WSSDF         IFNE      *BLANKS
     C     WSSDF         CHAIN     STED2                              95
     C  N95
     CANN94WSLKA         IFEQ      *BLANKS
     C                   MOVE      ST2LK         WSLKA
     C                   END
     C  N95WSLKS         IFEQ      *BLANKS
     C                   MOVE      ST2LK         WSLKS
     C                   END
     C  N95              MOVEL     ST2NVN        USDFT
     C                   END
     C   95
     CANN30              MOVE      'SPS0012'     MSGNR
     C   95              SETON                                        30
     C   94
     CANN30              MOVE      'SPS0013'     MSGNR
     C   94              SETON                                        30
     C*
     C*** TEST CONTRYCODE
     C                   MOVE      WSLKA         WSLKX
     C     KODLKK        CHAIN     KODTLKR                            93
     C   93
     CANN30              MOVE      'SPL0001'     MSGNR
     C   93              SETON                                        30
     C*
     C*** GET TEXT FOR LOADING
     C     WSSDL2        IFEQ      *BLANKS
     C     KODTEK        CHAIN     KOTMR                              33
     C  N33              MOVE      KOTMNV        WSSDL
     C                   END
     C   30              GOTO      SLT2
     C* TEST PRODUKTKODE
     C     WSPROD        IFEQ      ' '
     C                   MOVE      'E'           WSPROD
     C                   END
     C     KEYPRO        CHAIN     KODTFLP                            71
     C   71              MOVE      'SHU0644'     MSGNR
     C   71              SETON                                        30
     C   30              GOTO      SLT2
     C*
     C*** TEST CUSTOMERPARTS
     C                   EXSR      TESTKU
     C   30              GOTO      SLT2
     C*
     C*
     C*** TEST CONTRYCODE
     C*
     C     WSLKS         IFNE      '  '
     C                   MOVE      WSLKS         WSLKX
     C     KODLKK        CHAIN     KODTLKR                            83
     C   83
     CANN30              MOVE      'SPL0001'     MSGNR
     C   83              SETON                                        30
     C                   END
     C*
     C*
     C     WSLKK         IFNE      '  '
     C                   MOVE      WSLKK         WSLKX
     C     KODLKK        CHAIN     KODTLKR                            84
     C   84
     CANN30              MOVE      'SPL0001'     MSGNR
     C   84              SETON                                        30
     C                   END
     C*
     C*** TEST TYPE OF ORDER
     C     KODOTK        CHAIN     KOOTYR                             89
     C   89
     CANN30              MOVE      'SPO0007'     MSGNR
     C   89              SETON                                        30
     C*
     C*** TEST FRANKATUR
     C     KODFRK        CHAIN     KOFRR                              88
     C   88
     CANN30              MOVE      'SPF0006'     MSGNR
     C   88              SETON                                        30
     C*
     C*** TEST NUMBER OF COLLIES
     C     WSNT          COMP      0                                      87
     C   87
     CANN30              MOVE      'SPN0003'     MSGNR
     C   87              SETON                                        30
     C*
     C*** TEST TYPE OF GOODS
     C     WSVS1         COMP      *BLANKS                                86
     C   86
     CANN30              MOVE      'SPV0005'     MSGNR
     C   86              SETON                                        30
     C*
     C*** TEST OF WEIGHT
     C     WSVKT         COMP      0                                      85
     C   85
     CANN30              MOVE      'SPV0002'     MSGNR
     C   85              SETON                                        30
     C*
     C*** TEST OM PRODUKTSKODE
     C                   MOVEL     WSKDPL        XUKOD
     C     KUFASK        CHAIN     KUFAST                             73
     C  N30*IN73         IFEQ      '1'
     C                   MOVE      'YBC0360'     MSGNR
     C                   SETON                                        30
     C                   END
     C*** GETS DOKUMENTCODES FROM TYPE
     C*
     C     KODO2K        CHAIN     KOOT2R                             33
     C  N33              DO
     C     WSPK1         IFEQ      ' '
     C                   MOVE      KO2FB         WSPK1
     C                   END
     C     WSPK3         IFEQ      ' '
     C                   MOVE      KO2KK         WSPK3
     C                   END
     C     WSPK6         IFEQ      ' '
     C                   MOVE      KO2TE         WSPK6
     C                   END
     C     WSPK8         IFEQ      ' '
     C                   MOVE      KO2FF         WSPK8
     C                   END
     C     WSPK7         IFEQ      ' '                                           2<-B
     C     KO2BI         IFNE      'N'                                            3<-B
     C                   MOVE      'B'           WSPK7
     C                   ELSE                                                     3
     C     KO2CM         IFNE      'N'                                             4<-B
     C                   MOVE      'C'           WSPK7
     C                   ELSE                                                      4
     C                   MOVE      'N'           WSPK7
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END
     C*
     C*** TEST CODE FOR PRINT OF ORDER
     C*
     C     WSPK3         COMP      ' '                                    82
     C   82
     CANN30              MOVE      'SPP0004'     MSGNR
     C   82              SETON                                        30
     C*
     C*** TEST CODE FOR SAD
     C     WSPK6         COMP      ' '                                    81
     C   81
     CANN30              MOVE      'SPP0005'     MSGNR
     C   81              SETON                                        30
     C*
     C*** TEST CODE FOR AIRWAYBILL
     C     WSPK8         COMP      ' '                                    80
     C   80
     CANN30              MOVE      'SPP0007'     MSGNR
     C   80              SETON                                        30
     C*
     C*** MANUAL AWB/HAWB
     C*   A = IS MANUAL AWB/HAWB
     C*   B = MANUAL AWB
     C*
     C     WSAWBK        IFEQ      'A'
     C     WSAWBK        OREQ      'B'
     C                   MOVE      WSAWBN        WSMAWB
     C     WSOPD         IFNE      *ZEROS
     C     XNYGML        ANDNE     'NY'
     C                   EXSR      TOMCHA
     C                   END
     C     WSAWBK        IFEQ      'B'
     C     WSAWBN        IFEQ      *ZEROS
     C     WSAWBN        OREQ      *BLANKS
     C                   MOVE      *ZEROS        WSHAWB
     C                   END
     C                   END
     C     WSHAWB        IFEQ      *BLANKS
     C     WSHAWB        OREQ      *ZEROS
     C     WSAWBK        IFNE      'B'
     C     TELAWK        CHAIN     TELLAWB                            33
     C  N33              MOVE      TEHAWB        WSHAWB
     C  N33              ADD       1             TEHAWB
     C  N33              UPDATE    TELLAWBR
     C                   END
     C                   END
     C                   MOVE      ' '           WSAWBK
     C                   MOVE      *BLANKS       WSAWBN
     C                   END
     C*
     C*** GETS FREIGHTWEIGHT
     C                   EXSR      FINNVK
     C*
     C     SLT2          TAG
     C   30              EXSR      SETCUR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C* POSTIONATING CURSER
     C*
     C   80
     COR 81
     COR 82              Z-ADD     21            LINNBR
     C   85
     COR 86
     COR 87
     COR 88
     COR 89              Z-ADD     17            LINNBR
     C   84              Z-ADD     14            LINNBR
     C   62
     COR 61
     COR 60
     COR 59              Z-ADD     12            LINNBR
     C   83              Z-ADD     10            LINNBR
     C   68
     COR 67
     COR 66
     COR 65              Z-ADD     8             LINNBR
     C   70              Z-ADD     5             LINNBR
     C   69              Z-ADD     4             LINNBR
     C   72              Z-add     7             LINNBR
     C   71              Z-ADD     7             LINNBR
     C   71              Z-ADD     8             POSNBR
     C   95
     COR 94
     COR 93              Z-ADD     3             LINNBR
     C   73              Z-ADD     2             LINNBR
     C   96              Z-ADD     2             LINNBR
     C*
     C   80              Z-ADD     15            POSNBR
     C   81              Z-ADD     10            POSNBR
     C   82              Z-ADD     5             POSNBR
     C   85              Z-ADD     60            POSNBR
     C   86              Z-ADD     33            POSNBR
     C   87              Z-ADD     25            POSNBR
     C   88              Z-ADD     18            POSNBR
     C   89              Z-ADD     7             POSNBR
     C   60              Z-ADD     33            POSNBR
     C   62
     COR 61              Z-ADD     8             POSNBR
     C   65              Z-ADD     42            POSNBR
     C   66              Z-ADD     33            POSNBR
     C   68
     COR 67              Z-ADD     8             POSNBR
     C   72              Z-add     20            posnbr
     C   70              Z-ADD     8             POSNBR
     C   69              Z-ADD     8             POSNBR
     C   93              Z-ADD     30            POSNBR
     C   94              Z-ADD     19            POSNBR
     C   95              Z-ADD     8             POSNBR
     C   73              Z-ADD     20            POSNBR
     C   96              Z-ADD     8             POSNBR
     C   83
     COR 84              Z-ADD     74            POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTKU        BEGSR
     C***********************************************
     C                   SETOFF                                       72
     C                   SETOFF                                       53
     C*
     C*** TEST AIRCOMPANY
     C     WSKNF         IFEQ      0                                            1<-B
     C     WSPROD        ANDEQ     'E'
     C                   MOVE      *BLANKS       KFSNAV
     C                   ELSE                                                   1
     C     KODFSK        CHAIN     KODTFSR                            69
     C   69              MOVE      'SPK0017'     MSGNR
     C   69              SETON                                        30
     C     WSKNKF        IFEQ      0                                             2<-B
     C                   MOVE      KFSKNR        WSKNKF
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** TEST AGENT
     C     WSKNA         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       WSNAA
     C                   ELSE                                                   1
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            70
     C   70
     CANN30              MOVE      'SPK0008'     MSGNR
     C   70              SETON                                        30
     C                   MOVE      KNAVN         WSNAA
     C                   END                                                    1<-E
     C*
     C*** TEST OPPDRAGSGIVER
     C     WSKNO         IFEQ      0                                            1<-B
      * SETT OPPDRAGSGIVER (WEB-SPØR/STATISTIKK) ETTER MODUL
     C                   CALL      'SYOP10'
     C                   PARM      'D'           heur              1
     C                   PARM                    wsKNK
     C                   PARM                    wsKNKF
     C                   PARM                    wsKNS
     C                   PARM                    wsKNSF
     C                   PARM                    wskno
     C                   end
     c     wskdak        ifeq      ' '
     c     wskno         ifeq      wskns
n12  c     wskno         andne     0
     c                   move      'S'           wskdak
     c                   end
     c     wskno         ifeq      wsknk
n12  c     wskno         andne     0
     c                   move      'K'           wskdak
     c                   end
     c                   move      wskdak        wskdak
     C                   MOVE      *BLANKS       WSNAO
     C                   ELSE                                                   1
     C                   MOVE      WSKNO         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            72
     C   72              MOVE      'SPO0033'     MSGNR
     C   72              SETON                                        30
     C  N72              MOVE      KNAVN         WSNAO
     C  N72WSKNS         IFEQ      0
     c     WSKDAK        ANDEQ     'S'
     c                   move      wskno         wskns
     c                   end
     C  N72WSKNk         IFEQ      0
     c     WSKDAK        ANDEQ     'K'
     c                   move      wskno         wsknk
     c                   end
     C                   END                                                    1<-E
     C*
     C*
     C*** TEST SHIPPER
     C                   MOVE      *BLANKS       XSTLF            15
     C     WSKNS         IFEQ      0                                            1<-B
     C     WSNAS         COMP      *BLANKS                                67
     C   67
     CANN30              MOVE      'SPN0005'     MSGNR
     C   67              SETON                                        30
     C                   MOVE      *ZEROS        FMOT
     C                   ELSE                                                   1
     C                   MOVE      WSKNS         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            68
     C   68
     CANN30              MOVE      'SPK0010'     MSGNR
     C   68              SETON                                        30
s06  C* N68WSLKS         IFEQ      *BLANKS
s06  C*                  MOVE      SYLAND        WSLKS
s06  C*                  END
N08  C  N68WSLKS         IFEQ      *BLANKS
n06  C  N68SYLAND        IFNE      *BLANKS
n06  C                   MOVE      SYLAND        WSLKS
n06  c                   else
n06  C                   move      filand        wslks
n06  C                   END
n08  C                   END
     C  N68              MOVE      TLF           XSTLF
     C  N68WSNAS         IFEQ      *BLANKS                                       2<-B
     C     VADRK2        CHAIN     VADR                               33
     C                   MOVE      *BLANKS       WSADS3
     C  N33              DO                                                       3<-B
     C                   MOVE      VADRNA        WSNAS
     C                   MOVE      VADRN1        WSADS1
     C                   MOVE      VADRN2        WSADS2
     C                   MOVE      VADRN3        WSADS3
     C     VALAND        IFNE      '  '
N08  C     WSLKS         ANDEQ     *BLANKS
     C                   MOVE      VALAND        WSLKS
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C   33              DO                                                       3<-B
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSADS1
     C                   MOVE      ADR2          WSADS2
     C                   MOVE      *BLANKS       WSADS3
     C     POSTNR        IFEQ      0                                              4<-B
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          WSADS3
     C                   ELSE                                                     4
     C                   MOVE      ENGAD3        WSADS3
     C                   END
     C                   ELSE                                                     4
     C                   MOVEL     POSTNR        WSADS3
     C                   MOVE      ADR3          WSADS3
     C                   END                                                      4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C  N68WSKNSF        IFEQ      0                                             2<-B
     C     FMOT          IFEQ      0                                              3<-B
     C                   MOVE      WSKNS         WSKNSF
     C                   ELSE                                                     3
     C                   MOVE      FMOT          WSKNSF
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** TEST CURRANCYCODE SHIPPER
     C     WSVALS        IFNE      *BLANKS                                      1<-B
     C                   MOVE      WSVALS        KVAKOD
     C     KODVAK        CHAIN     VALUL01                            66
     C   66
     CANN30              MOVE      'SPV0001'     MSGNR
     C   66              SETON                                        30
     C                   END                                                    1<-E
     C*
     C*** TEST SHIPPERS INVOICE-PART
     C     WSKNSF        IFEQ      0                                            1<-B
     C     WSKDFS        COMP      'X'                                6565
     C                   MOVE      *BLANKS       WSNASF
     C                   ELSE                                                   1
     C                   MOVE      WSKNSF        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            65
     C     WSKDFS        IFNE      'X'
     C  N65AKTKOD        COMP      'A'                                6565
     C                   END
     C  N65              MOVE      KNAVN         WSNASF
     C                   END                                                    1<-E
     C   65
     CANN30              MOVE      'SPK0011'     MSGNR
     C   65              SETON                                        30
     C*
     C*** OTHER SHIPPERTEST
     C                   MOVE      *BLANKS       WSMSG
     C  N65WSKNSF        IFNE      0                                            1<-B
     C*
     C* GETS COUNTRYCODE
     C*
     C     WSLKS         IFEQ      *BLANKS
     C                   MOVE      SYLAND        WSLKS
     C                   END
     C*
     C*** TEST CREDITLIMIT
     C     KGRENS        IFNE      0                                             2<-B
     C     KGRENS        MULT      1000          XOVER            13 2
     C                   CALL      'SYGE07CL'
     C                   PARM                    FIRMA
     C                   PARM                    KUNDNR
     C                   PARM                    KSALDO           13 2
     C     KSALDO        COMP      XOVER                              65
     C   65
     CANN30              MOVE      'SPK0012'     MSGNR
     C   65              SETON                                        30
     C                   END                                                     2<-E
     C*** TEST CURRANCYCODE
     C     WSVALS        IFEQ      *BLANKS                                       2<-B
     C     VALKOD        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FICURR        WSVALS
     C                   ELSE                                                     3
     C                   MOVE      VALKOD        WSVALS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*** FIX VALUES FOR DISPURSMENTFE/MINIMUM
     C     SYUTLP        IFEQ      0                                             2<-B
     C                   MOVE      FIUPS         XSUTL             4 2
     C                   MOVE      FIUPM         XSUMIN            2 0
     C                   ELSE                                                    2
     C                   Z-ADD     SYUTLP        XSUTL
     C                   Z-ADD     SYMINU        XSUMIN
     C                   END                                                     2<-E
     C     XSUTL         IFEQ      99.99                                         2<-B
     C                   MOVE      *ZEROS        XSUTL
     C                   END                                                     2<-E
     C*** TEST STOPPCODE ON SHIPPER
     C     SYLIKV        COMP      ' '                                6363
     C   63              DO                                                      2<-B
     C                   MOVE      SYLIKV        KLIKOD
     C     KODLIK        CHAIN     KOLIKR                             33
     C  N33              MOVE      XMSG1         WSMSG
     C  N33              MOVE      WSKNSF        XKN
     C  N33              MOVE      KLIKOD        XLIKOD
     C  N33              MOVE      KLINAV        XLINAV
     C     KLISTO        IFEQ      'J'
     C                   SETON                                        30
     C   30              GOTO      SLTKU
     C                   END                                                     2<-E
     C                   END                                                     2<-E
     C*
     C                   END                                                    1<-E
     C*** END PÅ  <WSKNSF IFNE 0>
     C*
     C*
     C*** TEST CONSIGNEE *********************************
     C                   MOVE      *BLANKS       XKTLF            15
     C     WSKNK         IFEQ      0                                            1<-B
     C     WSNAK         COMP      *BLANKS                                62
     C   62
     CANN30              MOVE      'SPN0006'     MSGNR
     C   62              SETON                                        30
     C                   MOVE      *ZEROS        FMOT
     C                   ELSE                                                   1
     C                   MOVE      WSKNK         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            61
     C   61
     CANN30              MOVE      'SPK0013'     MSGNR
     C   61              SETON                                        30
     C*
     C* MOVES IN STANDARD ORDERTYPE/PHONENUMBER
     C*
     C  N61              MOVE      TLF           XKTLF
     C  N61WSLKK         IFEQ      *BLANKS
     C                   MOVE      SYLAND        WSLKK
     C                   END
     C  N61WSOT          IFEQ      *BLANKS                                       2<-B
     C                   MOVE      SYOPDT        WSOT
     C                   MOVE      'D'           UUR               1
     C                   CALL      'SYFA24'
     C                   PARM      WSKNS         UKNOP             8 0
     C                   PARM                    UUR
     C                   PARM      WSAVD         UAVDOP            4 0
     C                   PARM                    WSOT
     C                   END                                                     2<-E
     C*
     C  N61WSNAK         IFEQ      *BLANKS                                       2<-B
     C     VADRK         CHAIN     VADR                               33
     C                   MOVE      *BLANKS       WSADK3
     C  N33              DO                                                       3<-B
     C                   MOVE      VADRNA        WSNAK
     C                   MOVE      VADRN1        WSADK1
     C                   MOVE      VADRN2        WSADK2
     C                   MOVE      VADRN3        WSADK3
     C     VALAND        IFNE      '  '
     C                   MOVE      VALAND        WSLKK
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C   33              DO                                                       3<-B
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSADK1
     C                   MOVE      ADR2          WSADK2
     C     POSTNR        IFEQ      0                                               4<-B
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          WSADK3
     C                   ELSE                                                     3
     C                   MOVE      ENGAD3        WSADK3
     C                   END
     C                   ELSE                                                      4
     C                   MOVEL     POSTNR        WSADK3
     C                   MOVE      ADR3          WSADK3
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*
     C     WSKNKF        IFEQ      0                                             2<-B
     C     FMOT          IFEQ      0                                              3<-B
     C                   MOVE      WSKNK         WSKNKF
     C                   ELSE                                                     3
     C                   MOVE      FMOT          WSKNKF
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*
     C                   END                                                    1<-E
     C*** END  <WSKNK IFEQ 0>
     C*
     C*
     C*** TEST CURRANCYCODE INVOICERECEEVER CONSIGNEE
     C     WSVALK        IFNE      *BLANKS                                      1<-B
     C                   MOVE      WSVALK        KVAKOD
     C     KODVAK        CHAIN     VALUL01                            60
     C   60
     CANN30              MOVE      'SPV0001'     MSGNR
     C   60              SETON                                        30
     C                   END                                                    1<-E
     C*
     C*** TEST CONSIGNEES INVOICERECEEVER
     C     WSKNKF        IFEQ      0                                            1<-B
     C     WSKDFK        COMP      'X'                                5959
     C                   MOVE      *BLANKS       WSNAKF
     C                   ELSE                                                   1
     C                   MOVE      WSKNKF        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            59
     C     WSKDFK        IFNE      'X'
     C  N59AKTKOD        COMP      'A'                                5959
     C                   END
     C  N59              MOVE      KNAVN         WSNAKF
     C                   END                                                    1<-E
     C   59
     CANN30              MOVE      'SPK0014'     MSGNR
     C   59              SETON                                        30
     C*
     C*** OTHER TESTS CONSIGNNEE
     C     WSKNKF        IFNE      0                                            1<-B
     C*
     C* GETS COUNTRYCODE
     C*
     C     WSLKK         IFEQ      *BLANKS
     C     SYLAND        ANDNE     *BLANKS
     C     SYLAND        ANDNE     'NO'
     C                   MOVE      SYLAND        WSLKK
     C                   ELSE
     C     WSLKK         IFEQ      '  '
     C                   MOVEL     WSLKA         WSLKK
     C                   END
     C                   END
     C*
     C*
     C*** TEST IF CREDITLIMIT IS REACHED
     C     KGRENS        IFNE      0                                             2<-B
     C     KGRENS        MULT      1000          XOVER
     C                   CALL      'SYGE07CL'
     C                   PARM                    FIRMA
     C                   PARM                    KUNDNR
     C                   PARM                    KSALDO           13 2
     C     KSALDO        COMP      XOVER                              59
     C   59
     CANN30              MOVE      'SPK0015'     MSGNR
     C   59              SETON                                        30
     C                   END                                                     2<-E
     C*** SJEKK CURRANCYCODE
     C     WSVALK        IFEQ      *BLANKS                                       2<-B
     C     VALKOD        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FICURR        WSVALK
     C                   ELSE                                                     3
     C                   MOVE      VALKOD        WSVALK
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*** GET DISPURSMENTINFORMATION
     C     SYUTLP        IFEQ      0                                             2<-B
     C                   MOVE      FIUPS         XKUTL             4 2
     C                   MOVE      FIUPM         XKUMIN            2 0
     C                   ELSE                                                    2
     C                   MOVE      SYUTLP        XKUTL
     C                   MOVE      SYMINU        XKUMIN
     C                   END                                                     2<-E
     C     XKUTL         IFEQ      99.99                                         2<-B
     C                   MOVE      *ZEROS        XKUTL
     C                   END                                                     2<-E
     C*** TEST STOPPCODE
     C     SYLIKV        COMP      ' '                                5757
     C   57              DO                                                      2<-B
     C                   MOVE      SYLIKV        KLIKOD
     C     KODLIK        CHAIN     KOLIKR                             33
     C  N33              MOVE      XMSG1         WSMSG
     C  N33              MOVE      WSKNKF        XKN
     C  N33              MOVE      KLIKOD        XLIKOD
     C  N33              MOVE      KLINAV        XLINAV
     C     KLISTO        IFEQ      'J'
     C                   SETON                                        30
     C                   END                                                     2<-E
     C                   END                                                     2<-E
     C*
     C                   END                                                    1<-E
     C*** END PÅ  <WSKNKF IFNE 0>
     C*
     C*
     C     SLTKU         TAG
     C     WSMSG         COMP      *BLANKS                            2727
     C*
      * SETT OPPDRAGSGIVER (WEB-SPØR/STATISTIKK) ETTER MODUL
     C     WSKNO         IFEQ      0                                            1<-B
     C                   CALL      'SYOP10'
     C                   PARM      'D'           heur              1
     C                   PARM                    wsKNK
     C                   PARM                    wsKNKF
     C                   PARM                    wsKNS
     C                   PARM                    wsKNSF
     C                   PARM                    wskno
     C                   end
     c     wskdak        ifeq      ' '
     c     wskno         ifeq      wskns
n12  c     wskno         andne     0
     c                   move      'S'           wskdak
     c                   end
     c     wskno         ifeq      wsknk
n12  c     wskno         andne     0
     c                   move      'K'           wskdak
     c                   end
     c                   move      wskdak        wskdak
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     SAMSLE        BEGSR
     C***********************************************
     C     SAMLAK        SETLL     SAMLA
     C                   SETOFF                                       30
     C     STSML         TAG
     C     YSDT          READE     SAMLA                                  30
     C  N30SMST          IFEQ      'U'
     C                   UPDATE    SAMLAR
     C                   GOTO      STSML
     C                   ELSE
     C     SMMAWB        IFEQ      WSMAWB
     C                   MOVE      *ZEROS        WSMAWB
     C                   MOVE      *BLANKS       WSRFA
     C                   MOVE      *BLANKS       WSSAML
     C                   MOVE      *ZEROS        WSHAWB
     C                   MOVE      *ZEROS        WSPRO
     C                   SUB       1             SMNT
     C                   UPDATE    SAMLAR
     C                   ELSE
     C                   UPDATE    SAMLAR
     C                   GOTO      STSML
     C                   END
     C                   END
     C                   SETOFF                                       30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FINNVK        BEGSR
     C***********************************************
     C*
     C*** GETS FREIGHTWEIGHT
     C     WSLM          MULT      KOVLKG        XLMLM             9 0
     C     WSM3          MULT      KOVKKG        XM3DE            12 3
     C                   ADD       0.999         XM3DE
     C                   Z-ADD     XM3DE         XM3M3             9 0
     C     WSVKT         COMP      XLMLM                              33
     C   33              Z-ADD     WSVKT         WSFBV             9 0
     C  N33              Z-ADD     XLMLM         WSFBV
     C     WSFBV         COMP      XM3M3                              33
     C  N33              Z-ADD     XM3M3         WSFBV
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVHFW        BEGSR
     C***********************************************
     C* FLYTTING VED ENDRING OPPDRAG
     C                   MOVE      *BLANKS       TRBCD
     C  N28              DO
     C                   MOVE      HESTD         WSSTD
     C                   MOVE      HEPRO         WSPRO
     C     HEGN          IFEQ      *BLANKS
     C                   MOVE      *ZEROS        WSMAWB
     C                   ELSE
     C                   MOVE      HEGN          WSMAWB
     C                   END
     C                   MOVEL     HESAML        WSSAML
     C                   MOVEL     HERFA         WSRFA
     C     hehawb        ifeq      *blanks
     C                   MOVE      *ZEROS        WSHAWB
     c                   else
     C                   MOVE      HEHAWB        WSHAWB
     c                   end
     C                   MOVE      HEDTD         WSDTD
     C                   MOVE      HEDTM         WSDTM
     C                   MOVE      HEDTÅ         WSDTÅ
     C                   MOVEL     WSAVD         GSSTRK           11 0
     C                   MOVE      WSOPD         GSSTRK
     C     GSSTRK        CHAIN     GSSTRF                             33
     C                   END
     C                   MOVE      HEPK1         WSPK1
     C                   MOVE      HEPK3         WSPK3
     C                   MOVE      HEPK6         WSPK6
     C                   MOVE      HEPK7         WSPK7
     C                   MOVE      HEPK8         WSPK8
     C                   MOVE      'N'           WSTSS
     C* FLYTTING VED KOPIERING OPPDRAG
     C   28              DO
     C                   MOVE      ' '           HE01
     C                   MOVE      KOABÆR        WSSTD
     C                   MOVE      *ZEROS        WSPRO
     C                   MOVE      *ZEROS        WSMAWB
     C                   MOVEL     '    '        HEGN
     C                   move      *zeros        helm
     C                   MOVE      *BLANKS       WSRFA
     C                   MOVE      *BLANKS       WSSAML
     C                   MOVE      *ZEROS        WSHAWB
     C     VIADUMMY      IFNE      'J'
     C                   MOVE      ' '           WSPK1
     C                   MOVE      ' '           WSPK3
     C                   MOVE      ' '           WSPK6
     C                   MOVE      ' '           WSPK7
     C                   MOVE      ' '           WSPK8
     C                   END
     C                   Z-ADD     0             HENTF
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UYEAR         WSDTÅ
     C                   MOVE      *BLANKS       HEKDTM
     C                   MOVE      *ZEROS        TRAVD0
     C                   MOVE      *ZEROS        TROPD0
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      *BLANKS       HETLE
     C                   MOVE      *BLANKS       HETLL
     C                   END
     C* FLYTTING UANSETT
     C                   MOVE      HESDF         WSSDF
     C                   MOVE      HESDT         WSSDT
     C                   MOVE      HELKA         WSLKA
     C                   MOVE      HELKK         WSLKK
     C                   MOVE      HELKS         WSLKS
     C                   MOVE      HESDL         WSSDL
     C                   MOVE      TRSTA4        WSPROD
     C                   MOVE      HEKNA         WSKNA
     C                   MOVE      HENAA         WSNAA
     C                   MOVE      HEKNF         WSKNF
     C     WSKNF         IFEQ      0
     C                   MOVE      *BLANKS       KFSNAV
     C                   ELSE
     C     KODFSK        CHAIN     KODTFSR                            33
     C                   END
     C                   MOVE      HEKNS         WSKNS
     C                   MOVE      HEANS         WSANS
     C                   MOVE      HEKDFS        WSKDFS
     C                   MOVE      HEVALS        WSVALS
     C                   MOVE      HEKNSF        WSKNSF
     C                   MOVE      HENASF        WSNASF
     C                   MOVE      HENAS         WSNAS
     C                   MOVE      HEADS1        WSADS1
     C                   MOVE      HEADS2        WSADS2
     C                   MOVE      HEADS3        WSADS3
     C                   MOVE      HEKNK         WSKNK
     C                   MOVE      HEANK         WSANK
     C                   MOVE      HEKDFK        WSKDFK
     C                   MOVE      HEVALK        WSVALK
     C                   MOVE      HEKNKF        WSKNKF
     C                   MOVE      HENAKF        WSNAKF
     C                   MOVE      HENAK         WSNAK
     C                   MOVE      HEADK1        WSADK1
     C                   MOVE      HEADK2        WSADK2
     C                   MOVE      HEADK3        WSADK3
     C                   MOVE      HEOT          WSOT
     C                   MOVE      HEFR          WSFR
     C                   MOVE      HEGM1         WSGM1
     C                   MOVE      HEGM2         WSGM2
     C                   MOVE      HENT          WSNT
     C                   MOVE      HEVS1         WSVS1
     C                   MOVE      HEVKT         WSVKT
     C                   MOVE      *zeros        WSLM              4 2
     C                   MOVE      HEM3          WSM3
     C                   MOVE      HEFBV         WSFBV
     C                   MOVE      HEVS2         WSVS2
     C                   MOVE      HEKDPL        WSKDPL
     C                   MOVE      HEKDL         WSKDL
     C                   MOVE      TRKDAK        WSKDAK
     C                   MOVE      TRKNFA        WSKNO
     C*** HEPK9 = JETPAKKE
     C*                    MOVE HEPK9     WSPK9
     C*                    MOVE HEKF      WSKF
     C                   MOVE      TRAVD0        WSAVD0
     C                   MOVE      TROPD0        WSOPD0
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C*                    MOVE *ZEROS    WSSTD
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        WSPRO
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UYEAR         WSDTÅ
     C                   MOVE      *BLANKS       WSRFA
     C                   MOVE      *BLANKS       WSSAML
     C                   MOVE      *ZEROS        WSMAWB
     C                   MOVE      *BLANKS       WSSDF
     C                   MOVE      *BLANKS       WSSDT
     C                   MOVE      *ZEROS        WSHAWB
     C                   MOVE      *BLANKS       WSLKA
     C                   MOVE      *BLANKS       WSLKK
     C                   MOVE      *BLANKS       WSLKS
     C                   MOVE      *BLANKS       WSSDL
     C                   MOVE      *BLANKS       WSPROD
     C                   MOVE      *ZEROS        WSKNA
     C                   MOVE      *BLANKS       WSNAA
     C                   MOVE      *ZEROS        WSKNF
     C                   MOVE      *BLANKS       KFSNAV
     C                   MOVE      *ZEROS        WSKNS
     C                   MOVE      *ZEROS        WSANS
     C                   MOVE      *BLANKS       WSKDFS
     C                   MOVE      *BLANKS       WSVALS
     C                   MOVE      *ZEROS        WSKNSF
     C                   MOVE      *BLANKS       WSNASF
     C                   MOVE      *BLANKS       WSNAS
     C                   MOVE      *BLANKS       WSADS1
     C                   MOVE      *BLANKS       WSADS2
     C                   MOVE      *BLANKS       WSADS3
     C                   MOVE      *ZEROS        WSKNK
     C                   MOVE      *ZEROS        WSANK
     C                   MOVE      *BLANKS       WSKDFK
     C                   MOVE      *BLANKS       WSVALK
     C                   MOVE      *ZEROS        WSKNKF
     C                   MOVE      *BLANKS       WSNAKF
     C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      *BLANKS       WSADK1
     C                   MOVE      *BLANKS       WSADK2
     C                   MOVE      *BLANKS       WSADK3
     C                   MOVE      *BLANKS       WSOT
     C                   MOVE      *BLANKS       WSFR
     C                   MOVE      *BLANKS       WSGM1
     C                   MOVE      *BLANKS       WSGM2
     C                   MOVE      *ZEROS        WSNT
     C                   MOVE      *BLANKS       WSVS1
     C                   MOVE      *ZEROS        WSVKT
     C                   MOVE      *ZEROS        WSLM
     C                   MOVE      *ZEROS        WSM3
     C                   MOVE      *ZEROS        WSFBV
     C                   MOVE      *BLANKS       WSVS2
     C                   MOVE      *BLANKS       WSKDPL
     C                   MOVE      *BLANKS       WSKDL
     C                   MOVE      *blanks       WSKDAK
     C                   MOVE      *ZEROS        WSKNO
     C                   MOVE      *BLANKS       WSNAO
     C                   MOVE      *BLANKS       WSPK3
     C                   MOVE      *BLANKS       WSPK6
     C                   MOVE      *BLANKS       WSPK8
     C                   MOVE      'N'           WSTSS
     C                   MOVE      *BLANKS       WSAWBK
     C                   MOVE      *BLANKS       WSAWBN
     C                   MOVE      *ZEROS        WSAVD0
     C                   MOVE      *ZEROS        WSOPD0
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDHEA        BEGSR
     C***********************************************
     C* UPDATE HEADINGRECORD
     C*
     C     WSPRO         IFEQ      0
     C     WSAVD         CHAIN     TELL                               33
     C   33AVDZER        CHAIN     TELL                               33
     C  N33              Z-ADD     TETURN        WSPRO
     C  N33              ADD       1             TETURN
     C  N33              UPDATE    TELLR
     C                   END
     C*
     C     HEADFK        CHAIN     HEADF                              33
      * OPPDATER STATISTIKK HVIS OPPDRAG ER ALLEREDE OPPDATERT PÅ STAT.
     C  N33HE01          IFEQ      'J'
     C                   Z-ADD     WSKNF         WSKNT
     C                   WRITE     STATVFR
     C                   MOVE      WSAVD         USTAVD            4
     C                   MOVE      WSOPD         USTOPD            7
     C                   CALL      'SYST35CA'
     C                   PARM                    USTAVD            4
     C                   PARM                    USTOPD            7
     C                   END
      *
     C                   EXSR      MOVWHF
     C  N33              UPDATE    HEADFR
     C   33              DO
     C     UDUMMY        IFNE      'J'
     C     WSAVD         CHAIN     TELL                               33
     C   33AVDZER        CHAIN     TELL                               33
     C                   MOVE      TEOPDN        WSOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   END
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          HEDTRÅ
     C                   ELSE
     C     UYEAR         ADD       2000          HEDTRÅ
     C                   END
     C                   MOVE      UMONTH        HEDTRM
     C                   MOVE      UDAY          HEDTRD
     C                   MOVE      WSOPD         HEOPD
     C                   Z-ADD     0             HENTF
      *                    MOVE WSSG      HESG
     C                   MOVE      WSAVD         HEAVD
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVE      *BLANKS       HESDFF
     C                   MOVE      *ZEROS        HEDTMP
     C                   MOVE      *ZEROS        HEDTÅP
     C                   MOVE      *ZEROS        HEDTCP
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C                   MOVE      ' '           HEKDTM
     C                   MOVE      *ZEROS        HEFBK
     C                   MOVE      *ZEROS        HEVN
     C                   MOVE      ' '           HEKDKK
     C                   MOVE      *ZEROS        HEFNGK
     C                   MOVE      *ZEROS        HEFNGS
     C                   MOVE      '   '         HEVALT
     C                   MOVE      *ZEROS        HEVALP
     C                   MOVE      '   '         HETLE
     C                   MOVE      ' '           HETLKU
     C                   MOVE      '     '       HETLL
     C                   MOVE      ' '           HEPK2
     C                   MOVE      ' '           HEPK4
     C                   MOVE      ' '           HEPK5
     C                   MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       HEDTMO
     C                   MOVE      *Zeros        HEKLMO
     C                   MOVE      ' '           HEPK7
     C                   MOVE      ' '           HEPK9
     C                   MOVE      *BLANKS       HEGNN
     C                   MOVE      *ZEROS        TRRUND
     C                   MOVE      *ZEROS        TRAVD0
     C                   MOVE      *ZEROS        TROPD0
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      *ZEROS        TRSFFD
     C                   MOVE      *ZEROS        TRSFFK
     C                   MOVE      *ZEROS        TRSDFD
     C                   MOVE      *ZEROS        TRSDFK
     C                   MOVE      *ZEROS        TRSDTD
     C                   MOVE      *ZEROS        TRSDTK
     C                   MOVE      *ZEROS        TRSVTD
     C                   MOVE      *ZEROS        TRSVTK
     C                   MOVE      *ZEROS        TRFRAB
     C                   MOVE      *BLANKS       TRSLAG
     C                   MOVE      *BLANKS       TRKDAK
     C                   MOVE      *BLANKS       TRKDFF
     C                   MOVE      *BLANKS       TRFRAK
     C                   MOVE      *BLANKS       TRFRAV
     C                   MOVE      *BLANKS       TRMVA
     C                   WRITE     HEADFR
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
     C                   END
      *
     C                   MOVE      HEAVD         UAVD
     C                   MOVE      HEOPD         UOPD
     C                   MOVE      HESG          USG
     C                   MOVE      '0'           *IN58
      * OPPDATER OPPDRAGSDATO PÅ ALLE FRISØKEVEIER
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      HEDTOP        FSDTOP
     C                   UPDATE    FRISOKR
     C     HEADFK        READE     FRISOK                                 33
     C  N33              ENDDO
      *
N18  c                   CALL      'SYGE114'
N18  c                   parm                    heavd
N18  c                   parm                    heopd
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWHF        BEGSR
     C***********************************************
     C                   MOVE      'D'           HEUR
     C     UDUMMY        IFEQ      'J'
     C                   MOVE      ' '           HEST
     C                   ELSE
     C                   MOVE      'X'           HEST
     C                   END
     C                   MOVE      WSSG          HESG
     C                   MOVE      WSSTD         HESTD
     C                   MOVE      WSPRO         HEPRO
     C                   MOVE      WSDTD         HEDTD
     C                   MOVE      WSDTM         HEDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          HEDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          HEDTÅ
     C                   END
     C                   MOVE      WSMAWB        HEGN
     C                   MOVE      WSSDF         HESDF
     C                   MOVE      WSSDT         HESDT
     C                   MOVE      WSKNA         HEKNA
     C                   MOVE      WSNAA         HENAA
     C                   MOVE      WSKNS         HEKNS
     C                   MOVE      WSKDFS        HEKDFS
     C                   MOVE      WSVALS        HEVALS
     C                   MOVE      WSNAS         HENAS
     C                   MOVE      WSADS1        HEADS1
     C                   MOVE      WSADS2        HEADS2
     C                   MOVE      WSADS3        HEADS3
     C                   MOVE      WSKNSF        HEKNSF
     C                   MOVE      WSANS         HEANS
     C                   MOVE      WSNASF        HENASF
     C                   MOVE      WSKNK         HEKNK
     C                   MOVE      WSKDFK        HEKDFK
     C                   MOVE      WSVALK        HEVALK
     C                   MOVE      WSNAK         HENAK
     C                   MOVE      WSADK1        HEADK1
     C                   MOVE      WSADK2        HEADK2
     C                   MOVE      WSADK3        HEADK3
     C                   MOVE      WSKNKF        HEKNKF
     C                   MOVE      WSANK         HEANK
     C                   MOVE      WSNAKF        HENAKF
     C                   MOVE      WSOT          HEOT
     C                   MOVE      WSFR          HEFR
     C                   MOVE      WSGM1         HEGM1
     C                   MOVE      WSGM2         HEGM2
     C                   MOVE      WSNT          HENT
     C                   MOVE      WSVS1         HEVS1
     C                   MOVE      WSVKT         HEVKT
     C                   MOVE      *zeros        HELM
     C                   MOVE      WSM3          HEM3
     C                   MOVE      WSPK1         HEPK1
     C                   MOVE      WSPK3         HEPK3
     C                   MOVE      WSPK6         HEPK6
     C                   MOVE      WSPK7         HEPK7
     C                   MOVE      WSPK8         HEPK8
     C                   MOVE      WSKNF         HEKNF
     C                   MOVE      WSLKA         HELKA
     C                   MOVE      WSLKK         HELKK
     C                   MOVE      WSLKS         HELKS
     C                   MOVE      WSKDPL        HEKDPL
     C                   MOVE      WSHAWB        HEHAWB
     C                   MOVE      WSFBV         HEFBV
     C                   MOVEL     WSRFA         HERFA
     C                   MOVEL     WSSAML        HESAML
     C                   MOVE      WSSDL         HESDL
     C                   MOVE      WSPROD        TRSTA4
     C                   MOVE      WSVS2         HEVS2
     C                   MOVE      WSKDL         HEKDL
     C                   MOVE      WSKDAK        TRKDAK
     C                   MOVE      WSKNO         TRKNFA
      * SETT OPPDRAGSGIVER (WEB-SPØR/STATISTIKK) ETTER MODUL
     C     trknfa        ifeq      *zeros
     C                   CALL      'SYOP10'
     C                   PARM      'D'           XXXUR             1
     C                   PARM                    HEKNK
     C                   PARM                    HEKNKF
     C                   PARM                    HEKNS
     C                   PARM                    HEKNSF
     C                   PARM                    TRKNFA
     C                   END
     c     trkdak        ifeq      ' '
     c     trknfa        ifeq      hekns
     c                   move      'S'           trkdak
     c                   end
     c     trknfa        ifeq      heknk
     c                   move      'K'           trkdak
     c                   end
     c                   move      trkdak        wskdak
     c                   end
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETSML        BEGSR
     C***********************************************
     c     wspro         ifeq      99999991
     c                   move      *zeros        wspro
     c                   end
     C                   MOVE      *BLANKS       WSSAML
     C                   MOVE      *ZEROS        XDT               6 0
     C                   Z-ADD     2             UFLAGG
     C                   CALL      'SYIN10A'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    YSDT
     C                   PARM                    XDT
     C                   PARM                    WSKNF
     C                   PARM                    WSKNA
     C                   PARM                    WSPRO
     C                   PARM                    WSSAML
     C                   PARM                    WSKNKF
     C                   PARM                    WSHAWB
     C                   PARM                    WSMAWB
     C                   PARM                    UFLAGG
     C                   PARM                    KOWLAS
     C     XDT           IFNE      0
     C                   MOVE      XDT           WSDT
     C                   END
     C     UFLAGG        IFEQ      1
     C                   MOVE      XMSG2         WSMSG
     C                   ELSE
     C                   MOVE      *BLANKS       WSMSG
     C                   END
     C*
     C     WSMAWB        IFNE      *ZEROS
     C     WSOPD         ANDNE     *ZEROS
     C     XNYGML        ANDNE     'NY'
     C                   EXSR      TOMCHA
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     KUBIKK        BEGSR
     C***********************************************
      * HENT MÅL
     C                   MOVEL     WSAVD         BXTNO
     C                   MOVE      WSOPD         BXTNO
     C     BXTNO         SETLL     GSSBXF
     C     BXTNO         READE     GSSBXF                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        ((BXBOX <= 900) AND (BXGSL <> '*'))          GA. GSL/RTM
     C                   ADD       1             XN                3 0
     C                   MOVE      BXLEN         LE(XN)
     C                   MOVE      BXBRE         BR(XN)
     C                   MOVE      BXHØY         HØ(XN)
     C                   Z-ADD     1             AN(XN)
     C                   MOVE      'J'           XFLYTM            1
     C                   END
     C     BXTNO         READE     GSSBXF                                 33
     C  N33              ENDDO
     C* SUBROUTINE FOR CUBIKK
      * hvis xn = > 12 summeres kubikk og returner
     c     xn            ifgE      12
     c                   z-add     0             wsm3
     c     1             do        xn            xx2               2 0
     C     HØ(Xx2)       MULT      LE(Xx2)       XKUB             14 5
     C                   MULT      BR(Xx2)       XKUB
     C                   ADD       XKUB          WSm3
     c                   end
     C                   MOVEA     *ZEROS        HØ
     C                   MOVEA     *ZEROS        LE
     C                   MOVEA     *ZEROS        BR
     C                   MOVEA     *ZEROS        AN
     C                   MOVE      'N'           XFLYTM            1
     c                   goto      utm3
     c                   end
     C                   CALL      'SYIN10B'
n11  C                   PARM                    UUavd             4 0
n11  C                   PARM                    UUopd             7 0
n11  C                   PARM                    UUfbn             3 0
     C                   PARM                    XFLYTM
     C     WSM3          PARM      WSM3          UM3               7 3
     C                   PARM                    HØ
     C                   PARM                    LE
     C                   PARM                    BR
     C                   PARM                    AN
     C*
     C     utm3          ENDSR
     C*
     C***********************************************
     C     AWBSR         BEGSR
     C***********************************************
     C                   Z-ADD     2             UFLAGG
     C     KEYPRO        CHAIN     KODTFLP                            71
     C     *IN71         IFEQ      '0'
     c                   move      kowlas        kowla2            1
     c     wsawse        ifne      *blanks
     c                   move      wsawse        kowlas
     c                   end
     C                   CALL      'SYIN10C'
     C                   PARM                    WSKNF
     C                   PARM                    WSMAWB
     C                   PARM                    UFLAGG
     C                   PARM                    KOWLAS
     C                   PARM                    KOFMK2
     c                   move      kowla2        kowlas
     C     UFLAGG        IFEQ      1
     C                   MOVE      XMSG2         WSMSG
     C                   ELSE
     C                   MOVE      *BLANKS       WSMSG
     C                   END
     C                   END
     C*
     C     WSMAWB        IFNE      *ZEROS
     C     WSOPD         ANDNE     *ZEROS
     C     XNYGML        ANDNE     'NY'
     C                   EXSR      TOMCHA
     C                   END
     C                   ENDSR
     C*
N07  C***********************************************
N07  C     SØKKUN        BEGSR
N07  C***********************************************
N07  C   32              MOVE      WSKNK         XKNK              8 0
N07  C   34              MOVE      WSKNS         XKNS              8 0
N07  C                   CALL      'SOEKUN'
N07  C                   PARM                    FIFIRM
N07  C                   PARM                    SOANTK
N07  C                   PARM                    SOTXT1
N07  C                   PARM                    WSKNA
N07  C                   PARM                    SOTXT2
N07  C                   PARM                    WSKNS
N07  C                   PARM                    SOTXT3
N07  C                   PARM                    WSKNSF
N07  C                   PARM                    SOTXT4
N07  C                   PARM                    WSKNK
N07  C                   PARM                    SOTXT5
N07  C                   PARM                    WSKNKF
N07  C                   PARM                    SOTXT6
N07  C                   PARM                    WSKNO
N07  C                   PARM                    SOTXT7
N07  C                   PARM                    SOKNR7
N07  C                   PARM                    SOTXT8
N07  C                   PARM                    SOKNR8
N07  C   32              MOVE      XKNK          WSKNK
N07  C   34              MOVE      XKNS          WSKNS
N07  C                   Z-ADD     0             UFLAGG
N07  C
N07  C                   ENDSR
N07  C
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     2
     C     POSNBR        ANDLE     16
     C                   CALL      'EDI90R'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   GOTO      SLVISO
     C                   END
      *
     C                   MOVE      'D'           DELINI            1
     C   50LINNBR        IFEQ      4
     C     FLYSTE        IFEQ      'J'
     C                   MOVE      WSSDT         FZKODE
     C                   END
     C                   CALL      'SYEF05'
     C                   PARM                    FIFIRM
     C                   PARM                    KFSKNR
     C                   PARM                    DELINI
     C                   PARM                    FZTYPE
     C                   PARM                    FZKODE
     C                   GOTO      SLVISO
     C                   END
     C   51LINNBR        IFEQ      3
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     31
     C                   CALL      'SYEF05'
     C                   PARM                    FIFIRM
     C                   PARM                    FZNULL            8 0
     C                   PARM                    DELINI
     C                   PARM                    FZTYPE
     C                   PARM                    FZBLAN            5
     C                   GOTO      SLVISO
     C                   END
     C   52LINNBR        IFEQ      3
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     23
     C                   MOVE      WSSDT         FZKODE
     C                   CALL      'SYEF05'
     C                   PARM                    FIFIRM
     C                   PARM                    FZNULL            8 0
     C                   PARM                    DELINI
     C                   PARM                    FZTYPE
     C                   PARM                    FZKODE
     C                   GOTO      SLVISO
     C                   END
     C     LINNBR        IFGE      8
     C     LINNBR        ANDLE     10
     C                   MOVE      SOTXT3        XSKMOT            8
     C     POSNBR        IFGE      42
     C     LINNBR        ANDEQ     8
     C                   MOVE      WSKNSF        XSKKNR            8 0
     C                   ELSE
     C                   MOVE      WSKNS         XSKKNR            8 0
     C                   END
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C                   ELSE
     C     LINNBR        IFGE      12
     C     LINNBR        ANDLE     14
     C                   MOVE      SOTXT5        XSKMOT
     C     POSNBR        IFGE      42
     C     LINNBR        ANDEQ     12
     C                   MOVE      WSKNKF        XSKKNR
     C                   ELSE
     C                   MOVE      WSKNK         XSKKNR
     C                   END
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C                   END
     C                   END
     C   53LINNBR        IFEQ      7
     C                   MOVE      SOTXT6        XSKMOT            8
     C                   MOVE      WSKNO         XSKKNR            8 0
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C                   END
     C*
     C* HVIS F14 ER TRYKKET I UDEFINERT OMRÅDE VISES FØRSTE
     C* OG BESTE, HVIS DET FINNES NOE
     C                   SELECT
     C     *IN56         WHENEQ    '1'                                           AGENT
     C                   MOVE      SOTXT1        XSKMOT            8
     C                   MOVE      WSKNA         XSKKNR
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C     *IN55         WHENEQ    '1'                                           SELGER
     C                   MOVE      SOTXT2        XSKMOT
     C                   MOVE      WSKNS         XSKKNR
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C     *IN99         WHENEQ    '1'                                           SELGERS MOTAGER
     C                   MOVE      SOTXT3        XSKMOT
     C                   MOVE      WSKNSF        XSKKNR
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C     *IN54         WHENEQ    '1'                                           KJØPER
     C                   MOVE      SOTXT4        XSKMOT
     C                   MOVE      WSKNK         XSKKNR
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C     *IN98         WHENEQ    '1'                                           KJØPERS MOTAGER
     C                   MOVE      SOTXT5        XSKMOT
     C                   MOVE      WSKNKF        XSKKNR
     C                   EXSR      VISSK
     C                   GOTO      SLVISO
     C                   ENDSL
     C*
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
     C*
     C     SLVISO        ENDSR
     C*
     C***********************************************
     C     VISSK         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR
     C                   PARM                    XSKMOT
     C                   PARM                    UFLAGG
     C                   PARM                    DELSYI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKVAD        BEGSR
     C***********************************************
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNS
     C                   PARM                    WSNAK
     C                   PARM                    WSADK1
     C                   PARM                    WSADK2
     C                   PARM                    WSADK3
     C                   PARM                    WSLKK
     C                   PARM                    UADRNR            5
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     EFRABR        BEGSR
     C***********************************************
     C                   OUT       LDADS
     C                   Z-ADD     0             UFLAGG
     C                   Z-ADD     1             WSLOP             3 0
     C                   CALL      'SYEF10B'
     C                   PARM                    FIFIRM
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSLOP
     C                   PARM                    XSTLF
     C                   PARM                    XKTLF
     C                   PARM                    XANRUT
     C                   PARM                    XFLYTM
     C                   PARM                    HØ
     C                   PARM                    LE
     C                   PARM                    BR
     C                   PARM                    AN
     C                   PARM                    WSMSG
     C     UFLAGG        PARM      UFLAGG        UFLAGG
     C*
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      5                                      05
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRILES        BEGSR
     C***********************************************
     C     YSDT          IFNE      *BLANKS
     C     YSDF          ANDNE     *BLANKS
     C                   CALL      'SYEF10A'
     C                   PARM                    YSDF
     C                   PARM                    YSDT
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FAKTUR        BEGSR
     C***********************************************
     C                   EXSR      TESTKT
     C                   MOVE      'N'           OTIAUT            1              KRAV=auto
      *
     C     OTIKU1        IFNE      *ZEROS
      * FØRST KUNDE 1
     C                   MOVE      OTIKU1        OTIKNR
     C     OTI0          TAG
     C                   MOVE      WSAVD         OTIAVD
     C     OTI1          TAG
     C                   MOVE      'N'           OTIJN             1
     C     OTIKEY        SETLL     CUOTI
     C     OTIKEY        READE     CUOTI                                  33
     C     *IN33         DOWEQ     '0'
      * Kundespesif. søkevei.. Finnes koden fra før/hvis ikke lag den
     C                   MOVE      'J'           OTIJN
     C                   MOVE      WSAVD         FSAVD
     C                   MOVE      WSOPD         FSOPD
     C                   MOVE      COKODE        FSKODE
     C     FSOKEY        CHAIN     FRISOK                             33
     C  N33              UPDATE    FRISOKR
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C  N33              MOVE      KFSODK        FSDOKK
     C   33              MOVE      *BLANKS       FSDOKK
     C                   WRITE     FRISOKR
     C                   END
      *  Hvis kravfelt.. er det utfyllt ...  hvis ikke AUTO INN..
     C     COKRAV        IFEQ      '1'
     C     COKRAV        OREQ      '2'
     C     FSSOK         IFEQ      *BLANKS
     C                   MOVE      'J'           OTIAUT                           KRAV=AUTO
     C                   END
     C                   END
     C     OTIKEY        READE     CUOTI                                  33
     C                   END
      * Hvis ingenting fantes på spesifik avdeling, prøv med 0 i avd.
     C     OTIJN         IFEQ      'N'
     C     OTIAVD        ANDNE     *ZEROS
     C                   MOVE      *ZEROS        OTIAVD
     C                   GOTO      OTI1
     C                   END
      * DERETTER KUNDE 2  HVIS FORSKJ. FRA KUNDE 1
     C     OTIKU2        IFNE      *ZEROS
     C                   MOVE      OTIKU2        OTIKNR
     C                   MOVE      *ZEROS        OTIKU2
     C                   GOTO      OTI0
     C                   END
      *
      * HVIS UTILFREDSSTILTE KRAVFELT - AUTO-VIS FRIE SØKEV.
     C     OTIAUT        IFEQ      'J'
     c                   move      WSKNSF        OTIKU1
     C                   MOVE      *ZEROS        OTIKU2
     C     WSKNKF        IFNE      *zeros
     C     WSKNKF        andne     WSKNSF
     C     OTIKU1        ifeq      *zeros
     C                   MOVE      WSKNKF        OTIKU1
     C                   else
     C                   MOVE      WSKNKF        OTIKU2
     C                   end
     C                   END
     C                   CALL      'SYFA64'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
     C                   END
      *
     C                   END
      *
     C                   Z-ADD     1             UFLAGG
     C   03              Z-ADD     3             UFLAGG
     C                   MOVE      *ZEROS        UKFRA             7 0
     C                   MOVE      ' '           WSMELD            1
     C     UFLAGG        IFEQ      3
     C                   GOTO      BAT
     C                   END
     C                   CALL      'SYFI10X'
     C                   PARM                    FIFIRM
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    XNYGML
     C                   PARM                    KO2UTL
     C                   PARM                    XKUTL
     C                   PARM                    XSUTL
     C                   PARM                    XKUMIN
     C                   PARM                    XSUMIN
     C                   PARM                    KO2MVK
     C                   PARM                    KO2MVS
     C                   PARM                    UKFRA
     C                   PARM                    KOVAVR
     C                   PARM                    WSMSG
     C                   PARM                    WSMELD
     C                   PARM                    UFLAGG
     C                   PARM                    UKODE
     C                   PARM                    USECUR            6
     C                   GOTO      UTFAK
     C     BAT           TAG
     C                   MOVEL     FIFIRM        QDA01
     C                   MOVEL     WSAVD         QDA02
     C                   MOVEL     WSOPD         QDA03
     C                   MOVEL     XNYGML        QDA04
     C                   MOVEL     KO2UTL        QDA05
     C                   MOVEL     XKUTL         QDA06
     C                   MOVEL     XSUTL         QDA07
     C                   MOVEL     XKUMIN        QDA08
     C                   MOVEL     XSUMIN        QDA09
     C                   MOVEL     KO2MVK        QDA10
     C                   MOVEL     KO2MVS        QDA11
     C                   MOVEL     UKFRA         QDA12
     C                   MOVEL     KOVAVR        QDA13
     C                   MOVEL     WSMSG         QDA14
     C                   MOVEL     WSMELD        QDA15
     C                   MOVEL     UFLAGG        QDA16
     C                   MOVEL     UKODE         QDA17
     C                   MOVEL     USECUR        QDA18
     C                   MOVEL     'SYFI10XQ'    QDTAQ            10
     C                   MOVEL     '*LIBL'       QLIB             10
     C                   Z-ADD     109           QRLEN             5 0
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QDTAQ
     C                   PARM                    QLIB
     C                   PARM                    QRLEN
     C                   PARM                    QDATA
     C     UTFAK         TAG
     C     UFLAGG        COMP      3                                      03
     C  N03UFLAGG        COMP      6                                      03
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     15
N07  C     POSNBR        IFGT      8
N07  C                   EXSR      SØKKUN
N07  c                   else
N04  C                   MOVE      WSNAA         UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    FIFIRM
S04  C*                  PARM                    WSNAA
N04  C                   PARM                    UKNAVN
N03  C                   EXSR      TESTKU
N01  C                   Z-ADD     6             LINNBR
N01  C                   Z-ADD     8             POSNBR
N07  c                   endif
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDEQ     20
     C                   MOVEL     WSKDPL        XUKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    XUTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XUKOD
     C                   MOVEL     XUKOD         WSKDPL
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
E01  C  N34LINNBR        IFEQ      8
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     15
N07  C     POSNBR        IFGT      8
N07  C                   EXSR      SØKKUN
N07  c                   else
N04  C                   MOVE      WSNAS         UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
S04  C*                  PARM                    WSNAS
N04  C                   PARM                    UKNAVN
N03  C                   EXSR      TESTKU
N01  C                   Z-ADD     8             LINNBR
N01  C                   Z-ADD     42            POSNBR
N07  c                   endif
     C                   GOTO      SLSØK
     C                   END
     C*
     C*
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     27
N07  C     POSNBR        IFGT      20
N07  C                   EXSR      SØKKUN
N07  c                   else
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNO
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N03  C                   EXSR      TESTKU
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     8             POSNBR
N07  c                   endif
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     49
N07  C     POSNBR        IFGT      42
N07  C                   EXSR      SØKKUN
N07  c                   else
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNSF
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N03  C                   EXSR      TESTKU
N01  C                   Z-ADD     12            LINNBR
N01  C                   Z-ADD     8             POSNBR
N07  c                   endif
     C                   GOTO      SLSØK
     C                   END
     C*
E01  C  N32LINNBR        IFEQ      12
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     15
N07  C     POSNBR        IFGT      8
N07  C                   EXSR      SØKKUN
N07  c                   else
N04  C                   MOVE      WSNAK         UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNK
N01  C                   PARM                    FIFIRM
S04  C*                  PARM                    WSNAK
N04  C                   PARM                    UKNAVN
N03  C                   EXSR      TESTKU
N01  C                   Z-ADD     12            LINNBR
N01  C                   Z-ADD     42            POSNBR
N07  c                   endif
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     49
N07  C     POSNBR        IFGT      42
N07  C                   EXSR      SØKKUN
N07  c                   else
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNKF
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N03  C                   EXSR      TESTKU
N01  C                   Z-ADD     17            LINNBR
N01  C                   Z-ADD     7             POSNBR
N07  c                   endif
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     37
     C                   EXSR      SØKVAD
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     7             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDF
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     23
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDT
     C                   PARM                    UNVN             30
     C                   PARM                    WSLKA
     C                   Z-ADD     40            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     59
     C                   CALL      'SYFI10J'
     C                   PARM                    WSSDL
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     31
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKA
     C                   PARM                    USPED
     C                   Z-ADD     40            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C*
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     75
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKS
     C                   PARM                    USPED
     C                   Z-ADD     8             POSNBR
     C                   Z-ADD     12            LINNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     75
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKK
     C                   PARM                    USPED
     C                   Z-ADD     7             POSNBR
     C                   Z-ADD     17            LINNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     10
     C                   CALL      'SYFI10K'
     C                   PARM                    WSKNF
     C                   Z-ADD     5             LINNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSVALS
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSVALK
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     7
     C     POSNBR        ANDLE     8
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOT
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     20
     C                   MOVE      'J'           USPED
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFR
     C                   PARM                    USPED
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C* KALKULATOR ANTALL
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     31
S15  C*                  Z-ADD     WSNT          UNU132           13 2
N15  C                   Z-ADD     WSNT          UNU133           13 3
     C                   CALL      'SYGE11'
S15  C*                  PARM                    UNU132
N15  C                   PARM                    UNU133
S15  C*                  Z-ADD     UNU132        WSNT
N15  C                   Z-ADD(H)  UNU133        WSNT
     C                   Z-ADD     33            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C* KALKULATOR BRUTTOVEKT
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     59
     C     POSNBR        ANDLE     67
S15  C*                  Z-ADD     WSVKT         UNU132           13 2
N15  C                   Z-ADD     WSVKT         UNU133           13 3
     C                   CALL      'SYGE11'
S15  C*                  PARM                    UNU132
N15  C                   PARM                    UNU133
S15  C*                  Z-ADD     UNU132        WSVKT
N15  C                   Z-ADD(H)  UNU133        WSVKT
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C* KALKULATOR KUBIKK
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     75
S15  C*                  Z-ADD     WSM3          UNU132           13 2
N15  C                   Z-ADD     WSM3          UNU133           13 3
     C                   CALL      'SYGE11'
S15  C*                  PARM                    UNU132
N15  C                   PARM                    UNU133
S15  C*                  Z-ADD     UNU132        WSM3
N15  C                   Z-ADD(H)  UNU133        WSM3
     C                   Z-ADD     33            POSNBR
     C                   Z-ADD     18            LINNBR
     C                   GOTO      SLSØK
     C                   END
     C*
      *
      *
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     UTCMDL        BEGSR
     C***********************************************
     C     XCMD          IFEQ      0
     C                   MOVE      'DIV0032'     MSGLN1
     C                   MOVE      'DIV0033'     MSGLN2
     C                   MOVE      'DIV0024'     MSGLN3
     C                   MOVE      'DIV0029'     MSGLN4
     C                   ADD       1             XCMD
     C                   ELSE
     C     XCMD          IFEQ      1
     C                   MOVE      'DIV0037'     MSGLN1
     C  N31              MOVE      'DIV0038'     MSGLN2
     C   31              MOVE      'DIV0000'     MSGLN2
     C  N31              MOVE      'DIV0020'     MSGLN3
     C   31              MOVE      'DIV0000'     MSGLN3
     C  N31              ADD       1             XCMD
     C   31              Z-ADD     0             XCMD
     C                   ELSE
     C     XCMD          IFEQ      2
     C                   MOVE      'DIV0030'     MSGLN1
     C                   MOVE      'DIV0041'     MSGLN2
     C                   MOVE      'DIV0039'     MSGLN3
     C                   MOVE      'DIV0029'     MSGLN4
     C                   ADD       1             XCMD              1 0
     C                   ELSE
     C     XCMD          IFEQ      3
     C                   MOVE      'DIV0040'     MSGLN1
     C                   MOVE      'JOV0803'     MSGLN2
     C                   MOVE      'DIV3572'     MSGLN3
     C                   MOVE      'SHU0127'     MSGLN4
     C                   ADD       1             XCMD
     C                   ELSE
     C     XCMD          IFEQ      4
     C                   MOVE      'BBA0042'     MSGLN1
     C                   MOVE      'DIV0000'     MSGLN2
     C                   MOVE      'BBA0151'     MSGLN3
     C                   MOVE      'DIV0029'     MSGLN4
     C                   ADD       1             XCMD
     C                   ELSE
s16  C*                  MOVE      'SHU0631'     MSGLN1
n16  C                   MOVE      'SHU1679'     MSGLN1
     C                   MOVE      'SHU0632'     MSGLN2
     C                   Z-ADD     0             XCMD
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C* INITIATIONROUTINE
     C*
     C     KUFASK        KLIST
     C                   KFLD                    XUTYP
     C                   KFLD                    XUKOD
     C                   MOVEL     'PRODTYPE'    XUTYP
     C     *LIKE         DEFINE    KFTYP         XUTYP
     C     *LIKE         DEFINE    KFKOD         XUKOD
     C                   MOVE      'N'           UUPDAT            1
     C     *LIKE         DEFINE    KFTYP         XKFTYP
     C     *LIKE         DEFINE    KFKOD         XKFKOD
      *
     C     KEYPRO        KLIST
     C                   KFLD                    YSFUXY
     C                   KFLD                    WSPROD
     C                   MOVE      'FLPR'        YSFUXY            4
     C     FIRAVD        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     DOKUFK        KLIST
     C                   KFLD                    XDFSTA
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C                   KFLD                    XFBNR
     C     DOKEFK        KLIST
     C                   KFLD                    XDFSTAE
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C                   KFLD                    XLOP
     C                   z-add     1             xlop              3 0
     C                   move      'F'           xdfstae           1
     C     HEADFK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     FREETK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     HEADKK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     SAMLAK        KLIST
     C                   KFLD                    YSDT
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVD
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    WSAVD
     C     KODTVK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    WSSG
     C     KODTEK        KLIST
     C                   KFLD                    YTEUNI
     C                   KFLD                    WSSDL1
     C     KODOTK        KLIST
     C                   KFLD                    YOTUNI
     C                   KFLD                    WSOT
     C     KODO2K        KLIST
     C                   KFLD                    YO2UNI
     C                   KFLD                    WSOT
     C     KODLIK        KLIST
     C                   KFLD                    KLIUNI
     C                   KFLD                    KLIKOD
     C     KODFRK        KLIST
     C                   KFLD                    YFRUNI
     C                   KFLD                    WSFR
     C     KODFSK        KLIST
     C                   KFLD                    YFSUNI
     C                   KFLD                    WSKNF
     C     KODLKK        KLIST
     C                   KFLD                    YLKUNI
     C                   KFLD                    WSLKX             2
     C     KODVAK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KVAKOD
     C     KODARK        KLIST
     C                   KFLD                    YARUNI
     C                   KFLD                    YSDF
     C                   KFLD                    YSDT
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYI            1
     C                   MOVE      'D'           DELSYI
     C     FRAT2K        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYB            1
     C     VADRK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNK
     C                   KFLD                    YVADRN
N05  C     VADRK1        KLIST
N05  C                   KFLD                    FIFIRM
N05  C                   KFLD                    KUNDNR
N05  C                   KFLD                    YVADRN
     C     VADRK2        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNS
     C                   KFLD                    YVADRN
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C*
     C     TELAWK        KLIST
     C                   KFLD                    TEHUNI
     C                   KFLD                    KOWLAS
     C                   MOVE      'E'           TEHUNI
     C     EDIMKI        KLIST
     C                   KFLD                    EDSTAT
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVE      'C'           EDSTAT            1
     C     OTIKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    OTIKNR            8 0
     C                   KFLD                    OTIAVD            4 0
     C     FSOKEY        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    FSKODE
     C     KUNKO2K       KLIST
     C                   KFLD                    NKN
     C                   KFLD                    KUINTN
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    USG               3
     C                   PARM                    UTYPE             3
     C*** UKODE = 'O' CALL FROM SYFF10CLO
     C*** UKODE = 'S' CALL FROM SYFF10CLS
     C*** UKODE = 'K' CALL FROM SYFF10CLK
     C*** UKODE = 'A' CALL FROM ?????????
     C*** UKODE = 'Z' KALLE FRA SYOP21R
     C                   PARM                    UKODE             1
     C                   PARM                    UDUMMY            1
     C                   PARM                    UAVDNY            4 0
     C                   CLEAR                   BILDE01
     C                   CLEAR                   BILDE02
     C                   CLEAR                   HEADFR
     C                   MOVE      *ZEROS        *IN
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
     C     UKODE         IFEQ      'Z'
     C                   MOVE      UKODE         XKODE             1
     C                   MOVE      ' '           UKODE
     C                   END
     C     UTYPE         IFEQ      'CHG'
     C     UTYPE         OREQ      'CHF'
     C     UTYPE         OREQ      'CHO'
     C                   MOVE      UOPD          WSOPD
     C                   ELSE
     C                   MOVE      '1'           *IN58
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          HEAVD
     C                   MOVE      UOPD          HEOPD
     C                   MOVE      *ZEROS        UOPD
     C                   MOVE      UAVDNY        WSAVD
     C                   END
     C                   END
      *
     C     UKODE         IFEQ      'A'
     C                   SETON                                        3234
     C                   ELSE
     C     UKODE         COMP      'K'                                    32    KUN KJØPER
     C     UKODE         COMP      'S'                                    34    KUN SELGER
     C                   END
     C*
N07  C                   Z-ADD     6             SOANTK            1 0
N07  C                   MOVE      *BLANKS       SOTXT6            8
N07  C                   MOVE      *BLANKS       SOTXT7            8
N07  C                   MOVE      *BLANKS       SOTXT8            8
N07  C                   MOVE      *ZEROS        SOKNR6            8 0
N07  C                   MOVE      *ZEROS        SOKNR7            8 0
N07  C                   MOVE      *ZEROS        SOKNR8            8 0
     C     *LIKE         DEFINE    WSAVD         AVDZER
     C
     C                   MOVE      'F'           XDFSTA            1
     C                   MOVE      'J'           USØK              1
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      'TERM'        YTEUNI            4
     C                   MOVE      'OTY'         YOTUNI            3
     C                   MOVE      'O2Y'         YO2UNI            3
     C                   MOVE      'FR'          YFRUNI            2
     C                   MOVE      'FS'          YFSUNI            2
     C                   MOVE      'LK '         YLKUNI            3
     C                   MOVE      'LIKO'        KLIUNI
     C                   MOVE      'VA'          YVAUNI            2
     C                   MOVE      'AR'          YARUNI            2
     C                   MOVE      *ZEROS        YFXLNR            2 0
     C                   MOVE      '00001'       YVADRN            5 0
     C                   MOVE      '001'         XFBNR             3 0
     C                   MOVEL     'M³ =    '    XMÅL
     C                   MOVE      ' ,   '       XMÅL
     C                   MOVE      *BLANKS       XTRNV            30
     C                   MOVE      *BLANKS       WSGM1            15
     C                   MOVE      *BLANKS       WSGM2            15
s02  C*                  MOVE      *ZEROS        W2TOLL            2 0
n02  C                   MOVE      *ZEROS        W2TOLL            4 0
     C                   MOVE      ' '           W2KDME            1
     C                   MOVE      ' '           W2KDE             1
     C                   MOVEA     *ZEROS        HØ
     C                   MOVEA     *ZEROS        LE
     C                   MOVEA     *ZEROS        BR
     C                   MOVEA     *ZEROS        AN
     C*
     C                   MOVE      'DIV0608'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     62            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG1            62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV0611'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     62            XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG2            62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1059'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    SOTXT1            8
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1060'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    SOTXT2            8
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1061'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    SOTXT3            8
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1062'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    SOTXT4            8
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1063'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    SOTXT5            8
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVEL     SKTXT1        SOTXT6            8
     C*
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM                               33
     C                   READ      FIRM                                   33
     C     'DISPU'       CHAIN     KODTDISR                           33
     C                   EXSR      UTCMDL
     C*
      * Gir local data area navnet LDADS internt i programmet.
      * Dette for å få oppdatert LDA etter å ha hentet routing
     C     *DTAARA       DEFINE    *LDA          LDADS
     C     WUSER         CHAIN     GSSBIF                             33
     C                   IF        *IN33 = *OFF
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      FICURR        UCURR
     C                   MOVE      UAVD          UBIAVD
     C                   MOVE      BICGR         UBICGR
     C                   MOVE      BICNO         UBICNO
     C                   MOVE      BIFC          UBIFC
     C                   MOVE      BIPRT         UBIPRT
     C                   MOVE      BIPRTM        UBIPRM
N10  C                   MOVE      BIPRTP        UBIPRP
N10  C                   MOVE      BIPRTI        UBIPRI
     C                   MOVE      BILOC         UBILOC
     C                   OUT       LDADS
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWDF        BEGSR
     C***********************************************
     C                   CLEAR                   DOKUFR
     C                   MOVE      ' '           DFST
     C                   MOVEL     KOVXXX        DFBELA
     C     DFBELA        IFEQ      ' '
     C     FILFB         IFEQ      'S'
     C     FILFB         OREQ      'M'
     C                   MOVE      FILFB         DFBELA
     C                   END
     C                   END
S05  C*                  MOVE      KOAKNR        DFKNSS
N05  C                   MOVE      WSKNS         DFKNSS
     C                   MOVEL     WSNAS         DFFASE
S05  C*    FIRAVD        CHAIN     CUNDL01                            34
N05  C                   MOVE      WSKNS         KUNDNR
N05  C     KUND1K        CHAIN     CUNDL01                            34
     C     *IN34         IFEQ      '0'
     C                   MOVE      KNAVN         DFNAVS
     C                   MOVE      ADR1          DFAD1S
     C                   MOVE      *BLANKS       DFAD2S
     C                   MOVEL     ADR3          DFAD3S
     C                   MOVE      POSTNR        DFPNLS
     C                   END
     C                   MOVE      WSNT          DFNTLA
     C                   MOVE      W2TOLL        DFTOLL
S05  C*                  MOVE      WSNAK         DFNAVL
S05  C*                  MOVE      WSADK1        DFAD1L
S05  C*                  MOVE      *BLANKS       DFAD2L
S05  C*                  MOVEL     WSADK3        TMPPUL            4
S05  C*                  TESTN                   TMPPUL               77
S05  C*    *IN77         IFEQ      '1'
S05  C*                  MOVE      TMPPUL        DFPOUL                          UTL.POSTNR
S05  C*                  MOVE      WSADK3        TMPAD3           25
S05  C*                  MOVEL     TMPAD3        DFADUL                          UTL.STED
S05  C*                  ELSE
S05  C*                  MOVEL     WSADK3        DFADUL
S05  C*                  END
N05  C                   MOVE      KOAKNR        KUNDNR
N05  C     VADRK1        CHAIN     VADR                               34
N05  C     *IN34         IFEQ      '0'
N05  C                   MOVE      VADRNA        DFNAVL
N05  C                   MOVE      VADRN1        DFAD1L
N05  C                   MOVEL     VADRN3        TMPPUL            4
N05  C     VAREGN        IFNE      0
N05  C                   MOVE      VAREGN        DFRG
N05  C                   END
N05  C     VARG          IFNE      *BLANKS
N05  C                   MOVEL     VARG          DFFORE
N05  C                   END
N05  C                   MOVE      VAKON1        DFKTA
N05  C                   MOVE      VAKON2        DFKTB
N05   *
N05  C                   MOVE      *ZEROS        DFPOUL
N05  C                   TESTN                   TMPPUL               34
N05  C     *IN34         IFEQ      '1'
N05  C                   MOVE      TMPPUL        DFPOUL                          UTL.POSTNR
N05  C                   MOVE      *BLANKS       DFADUL
N05  C                   MOVE      VADRN3        TMPAD3
N05  C     TMPAD3B       IFEQ      ' '
N05  C                   MOVEL     TMPAD3c       DFADUL                          UTL.STED
N05  c                   else
N05  C                   MOVEL     TMPAD3        DFADUL                          UTL.STED
N05  c                   end
N05  C                   ELSE
N05  C                   MOVE      *ZEROS        DFPOUL
N05  C                   MOVEL     VADRN3        DFADUL
N05  C                   END
N05  C                   ELSE
N05  C                   MOVE      KNAVN         DFNAVL
N05  C                   MOVE      ADR1          DFAD1L
N05  C                   MOVE      *BLANKS       DFAD2L
N05  C                   MOVEL     ADR3          DFADUL
N05  C                   MOVE      POSTNR        DFPOUL
N05  C                   END
     C                   MOVEL     XTRNV         DFNAT
     C                   MOVE      W2KDE         DFKDE
     C                   MOVE      W2KDME        DFKDME
     C                   MOVE      WSKNK         DFKNSM
     C                   MOVE      WSNAK         DFNAVM
     C                   MOVE      WSADK1        DFAD1M
     C                   MOVE      WSADK3        DFAD3M
     C                   MOVEL     WSGM1         DFGM
     C                   MOVE      WSNT          DFNT
     C                   MOVE      WSVS1         DFVS
     C                   MOVE      WSVKT         DFVKT
     C                   MOVE      WSLM          DFLM
     C                   MOVE      WSM3          DFM3
     C                   MOVEL     WSGM2         DFGM2
     C                   MOVEL     WSVS2         DFVS2
     C                   MOVE      WSFBV         DFVKTF
     C                   MOVE      WSSG          DFSG
     C                   MOVE      'F'           DFRI
     C                   MOVE      WSAVD         DFAVD
     C                   MOVE      WSOPD         DFOPD
     C                   MOVE      XFBNR         DFFBNR
     C*
     C                   WRITE     DOKUFR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FRABR         BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   MOVE      *BLANKS       TEST              1
     C                   CALL      'SYFI10A'
     C                   PARM                    FIFIRM
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    XFBNR
     C                   PARM                    KOAKNR
     C                   PARM                    XTRNV
     C                   PARM                    W2KDME
     C                   PARM                    W2KDE
     C                   PARM                    W2TOLL
     C                   PARM                    FILFB
     C                   PARM                    FILTB
     C                   PARM                    WSMSG
     C                   PARM                    UFLAGG
     C                   PARM                    TEST
     C                   Z-ADD     1             XFBNR
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      5                                      05
     C     UFLAGG        COMP      6                                      16
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   SETOFF                                       299899
     C                   SETOFF                                       545556
     C                   MOVEA     '000'         *IN(50)
     C*** TEST OM DET ER OPPLYSNINGER TIL OPPDRAG
     C     FREETK        SETLL     FREETXT
     C     FREETK        READE     FREETXT                                29
     C*** TEST OM AGENT OPPLYSNING. HVIS DET, SETT 56 PÅ
     C                   MOVE      WSKNA         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        56
     C*** TEST OM SELGER OPPLYSNING. HVIS DET, SETT 55 PÅ
     C                   MOVE      WSKNS         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        55
     C*
     C*** TEST OM SELGERSMOTTAGER HAR OPPLYSNING. HVIS DET, SETT 99 PÅ
     C                   MOVE      WSKNSF        FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        99
     C*** TEST OM KJØPER OPPLYSNING. HVIS DET, SETT 54 PÅ
     C                   MOVE      WSKNK         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        54
     C*** TEST OM KJØPERSMOTTAGER HAR OPPLYSNING. HVIS DET, SETT 98 PÅ
     C                   MOVE      WSKNKF        FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        98
     C* TESTER FØRST PÅ FLYSELAKAP
     C                   MOVE      KFSKNR        FZKUND
     C                   MOVE      'N'           FLYSTE            1
     C                   EXSR      FRIFLY
     C* TESTER DERETTER GENERELLT
     C                   MOVE      *ZEROS        FZKUND
     C                   EXSR      FRIFLY
     C*
     C*** HENT OPPDRAGGIVER
     C     WSKNO         ifne      0                                            1<-B
     C                   MOVE      WSKNO         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         WSNAO
     C                   END                                                    1<-E
     C*** TEST OM OPPDRAGSGIVER HAR FRITEKST
     C                   MOVE      WSKNO         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        53
      *
     C     HEADFK        SETLL     ENADSF                                 33
     C                   IF        *IN33
     C     HEADFK        READE     ENADSF                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        N3039 <> *BLANKS
     C                   IF        NKN = 0
     C                   LEAVE
     C                   ELSE
     C                   EVAL      KUINTN = N3039
     C     KUNKO2K       CHAIN     KUNKO2                             34
     C   34              LEAVE
     C                   END
     C                   END
     C     HEADFK        READE     ENADSF                                 33
     C                   ENDDO
     C  N33              EVAL      WSEDIINF = 'EDI-ADR. F14'
     C   33              EVAL      WSEDIINF = *BLANKS
     C                   ELSE
     C                   EVAL      WSEDIINF = *BLANKS
     C                   END
      *
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CMRFBR        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C   03              Z-ADD     3             UFLAGG
     C   16              Z-ADD     6             UFLAGG
     C                   CALL      'SYEX10B'
     C                   PARM                    FIFIRM
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSMSG
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      5                                      05
     C     UFLAGG        COMP      6                                      16
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     BILLOF        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C   03              Z-ADD     3             UFLAGG
     C   16              Z-ADD     6             UFLAGG
     C                   CALL      'SYEX10A'
     C                   PARM                    FIFIRM
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSMSG
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      5                                      05
     C     UFLAGG        COMP      6                                      16
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SFIR          BEGSR
     C***********************************************
     C                   OPEN      LOCL01                               33
     C     *IN33         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFIR99
     C                   ENDIF
     C* Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       BUTINF
     C                   MOVEL     WUSER         WWUSER           17
     C     WWUSER        CHAIN     LOCL01                             63
     C     *IN63         IFEQ      '0'
     C                   MOVEL     LODEFA        BUTPID                         <ADRESSE
     C                   ELSE
     C                   MOVEL     *BLANKS       BUTPID                         <ADRESSE
     C                   ENDIF
     C                   MOVEL     WSSDF         BUTAOR                         <ORIGIN AIRPORT
     C                   MOVEL     WSSDT         BUTADE                         <DEST. AIRPORT
     C                   Z-ADD     UDAY          BUTDA1
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     BUTDA1        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       BUTMN1                         <FLIGHT MND
     C                   Z-ADD     0             BUTYKL
      * Kaller på program for å sende og motta Schedule Request
      * Parameter inneholder routing hvis plukket av bruker
     C                   CALL      'TDV51C'
     C                   PARM                    BUTINF
      *
      * Routingen som evemtuelt er valgt i TDV51R legges i LDA
      * for å kunne brukes hvis man fortsetter direkte til flyfraktbrev
      *
     C                   MOVEL     BUTINF        DSTINF
      * Oppdaterer LDA'n slik at routingen kan bli oppfattet i SYEF10B
     C                   OUT       LDADS
      *
     C     SFIR99        TAG
     C                   CLOSE     LOCL01                               33
      *
     C                   ENDSR
     C***********************************************
     C     SFACT         BEGSR
     C***********************************************
     C                   MOVEL     WUSER         WWUSER           17
     C* Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       CUTINF
     C                   MOVEL     ' '           CUTTRM
     C                   MOVEL     'FACT'        CUTPID                         <ADRESSE
     C     3             SUBST     HEGN:5        WUTALN            3
     C                   MOVEL     WUTALN        CUTALN
     C     8             SUBST     HEGN:8        WUTAWB            8
     C                   MOVEL     WUTAWB        CUTAWB
     C                   MOVEL     WSSDF         CUTORI                         <ORIGIN AIRPORT
     C                   MOVEL     WSSDT         CUTDES                         <DEST. AIRPORT
     C                   Z-ADD     WSNT          CUTNPI                                     RT
     C                   Z-ADD     WSVKT         CUTWGH                                     RT
     C                   Z-ADD     WSM3          CUTVOL                                     RT
     C                   MOVEL     WSVS1         CUTCON
     C                   MOVEL     *BLANKS       CUTCAR
     C                   MOVEL     WSNAS         CUTPNA
     C                   MOVEL     WSADS1        CUTPAD
     C                   Z-ADD     1             XW                3 0
     C                   Z-ADD     0             MY                3 0
     C                   MOVEA     *BLANKS       WR3
     C                   MOVEA     *BLANKS       WR2
     C                   MOVEA     *BLANKS       WR1
     C                   MOVEA     WSADS3        WR3
     C     WR3(XW)       DOWNE     *BLANK
     C     XW            ANDLE     9
     C                   MOVE      WR3(XW)       WR1(XW)
     C                   ADD       1             XW
     C                   ENDDO
     C                   DO        17
     C                   ADD       1             XW
     C                   ADD       1             MY
     C                   MOVE      WR3(XW)       WR2(MY)
     C                   ENDDO
     C                   MOVEA     WR2           CUTPPL
     C                   MOVEA     WR1           CUTPCO
     C                   Z-ADD     1             XW                3 0
     C                   Z-ADD     0             MY                3 0
     C                   MOVEA     *BLANKS       WR3
     C                   MOVEA     *BLANKS       WR2
     C                   MOVEA     *BLANKS       WR1
     C                   MOVEA     WSADK3        WR3
     C     WR3(XW)       DOWNE     *BLANK
     C     XW            ANDLE     9
     C                   MOVE      WR3(XW)       WR1(XW)
     C                   ADD       1             XW
     C                   ENDDO
     C                   DO        17
     C                   ADD       1             XW
     C                   ADD       1             MY
     C                   MOVE      WR3(XW)       WR2(MY)
     C                   ENDDO
     C                   MOVEL     'P'           F5212
     C                   MOVEL     UDAY          F52141
     C                   Z-ADD     UMONTH        ZZ
     C                   MOVEA     NAV(ZZ)       F52142
     C                   MOVEL     *BLANKS       F52143
     C                   MOVEL     UDAY          F52161
     C                   MOVEL     NAV(ZZ)       F52162
     C                   MOVEL     *BLANKS       F52163
     C                   MOVEL     WSHAWB        F5218
     C                   MOVE      HEAVD         X52110            2
     C                   MOVEL     X52110        F52110
     C     F52110        CAT       '/':0         F52110
     C                   MOVE      HEOPD         F52110
     C                   MOVEL     *BLANKS       F52112
     C                   MOVEL     *BLANKS       F5321                          KONTAKT NAVN
     C                   MOVEL     *BLANKS       F5323                          KONTAKT NAVN
     C                   MOVEL     *BLANKS       F6231
     C                   MOVEL     *BLANKS       F6233
     C                   MOVEL     *BLANKS       F6235
      * DETTE ER KUNDENUMMER HOS FAKT.
      * LEGG INTILL VIDERE DETTE PROGRAMMET I SYENDRE
      * OG ENDRE NUMMER UTIFRA AVDELING.
     C                   MOVEL     '00000000'    F6236
     C                   MOVE      '00'          F6236
     C                   SELECT
     C     HEAVD         WHENEQ    0
     C                   MOVE      '00000000'    F6236
     C                   ENDSL
      *
     C                   MOVEL     HETLE         F6233
     C                   MOVE      HETLL         F6233
     C     EDIMKI        CHAIN     EDIM1                              90
     C     *IN90         IFEQ      *OFF
     C                   MOVEL     W0068A        F6235
     C                   MOVE      M0068B        F6235
     C                   ENDIF
     C                   MOVEL     WRKSR1        CUTSR1
     C                   MOVEL     WRKSR2        CUTSR2
     C                   MOVEL     WRKOS1        CUTOS1
      * Kaller på program for å sende FACT booking.
     C                   CALL      'SM280C2'
     C                   PARM                    CUTINF
     C                   PARM                    CUTIN2
     C                   PARM                    WWUSER           17
     C                   PARM                    WWRECN            9 0
      *
      *
     C     SFAC99        TAG
      *
     C                   ENDSR
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
      * OPPDRAG OPPRETTET (POST I FIL TRACKF)
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      'STR'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      WUSER         TTUSER
     C                   MOVEL     'Order en'    XXTEXT           16
     C                   MOVE      'tered   '    XXTEXT
     C                   MOVEL     XXTEXT        TTTEXT
N09  C                   MOVEL     'Ordre op'    XXTEXL           16
N09  C                   MOVE      'prettet '    XXTEXL
N09  C                   MOVEL     XXTEXT        TTTEXL
     C                   WRITE     TRACKFR
      *
      * ETD/ATD - ETA/ATA - TIDSOPPFØLGING. (EGEN FIL TRACKT)
      * (KUNNE TENKES Å VÆRE KUNDESTYRT... RESERVERT KODE I CUOTI???)
     C                   CLEAR                   TRACKTR
     C                   MOVE      HEAVD         TXAVD
     C                   MOVE      HEOPD         TXOPD
     C                   MOVE      HEDTOP        TXETDD
     C                   MOVE      *ZEROS        TXETDK
     C                   MOVE      *ZEROS        TXETAD
     C                   MOVE      *ZEROS        TXETAK
     C                   WRITE     TRACKTR
     C                   ENDSR
     C*
     C***********************************************
     C     TESTKT        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        OTIKU1            8 0
     C                   MOVE      *ZEROS        OTIKU2            8 0
     C     WSKDFS        IFNE      'X'
     C                   MOVE      WSKNSF        OTIKU1
     C                   END
     C     WSKDFK        IFNE      'X'
     C     OTIKU1        IFEQ      *ZEROS
     C                   MOVE      WSKNKF        OTIKU1
     C                   ELSE
     C                   MOVE      WSKNKF        OTIKU2
     C                   END
     C                   END
     C                   ENDSR
      *
     C***********************************************
     C     TOMCHA        BEGSR
     C***********************************************
      *
      * TØMMER EVENTUELLE TILLEGGSCHARGER
      *
     C                   SETOFF                                       33
     C     HEADFK        SETLL     DOKOTH
     C     *IN33         DOWEQ     '0'
     C     HEADFK        READE     DOKOTH                                 33
     C     *IN33         IFEQ      '0'
     C                   DELETE    DOKOTH
     C                   END
     C                   END
     C     dokefk        chain     dokef                              33
     C  N33              move      wsknf         dffsn
     C  N33              update    dokefr
     C                   ENDSR
      *
     C***********************************************
     C     FRIFLY        BEGSR
     C***********************************************
      *
      * SKJEKK OM FRITEKST PÅ FLYSELSKAP / LAND STED
      *
     C     KEYFRI        KLIST
     C                   KFLD                    FZKUND
     C                   KFLD                    FZDELS
     C                   KFLD                    FZTYPE
     C                   KFLD                    FZKODE
     C                   MOVE      WSLKA         FZTYPE
     C                   MOVE      WSSDT         FZKODE
     C                   MOVE      'D'           FZDELS
     C     KEYFRI        CHAIN     FRILKSD                            33
     C  N33FZKUND        IFNE      *ZEROS
     C                   SETON                                        50
     C                   MOVE      'J'           FLYSTE
     C                   ELSE
     C                   SETON                                        52
     C                   END
      * PRØV BLANKT STED
     C                   MOVE      *BLANKS       FZKODE
     C     KEYFRI        CHAIN     FRILKSD                            33
     C  N33FZKUND        IFNE      *ZEROS
     C                   SETON                                        50
     C                   ELSE
     C                   SETON                                        51
     C                   END
      * PRØV  DELSYSTEM ' ' OG STED
     C                   MOVE      ' '           FZDELS
     C                   MOVE      WSSDT         FZKODE
     C     KEYFRI        CHAIN     FRILKSD                            33
     C  N33FZKUND        IFNE      *ZEROS
     C                   SETON                                        50
     C                   MOVE      'J'           FLYSTE
     C                   ELSE
     C                   SETON                                        52
     C                   END
      * PRØV BLANKT STED MEN LANDKODE
     C                   MOVE      *BLANKS       FZKODE
     C     KEYFRI        CHAIN     FRILKSD                            33
     C  N33FZKUND        IFNE      *ZEROS
     C  N33              SETON                                        50
     C                   ELSE
     C                   SETON                                        51
     C                   END
     C                   ENDSR
      *
      ***********************************************
     C     TILSS         BEGSR
      ***********************************************
     C     WUSER         CHAIN     GSSBIF                             33
     C   33              GOTO      SLTILSS
      *
     C                   MOVEL     WSAVD         TRTNO
     C                   MOVE      WSOPD         TRTNO
     C     TRTNO         CHAIN     GSSTRF                             33
     C                   SELECT
     C                   WHEN      *IN33
     C                   MOVE      'CRT'         UTYPES            3
     C                   MOVE      '1'           UMODES            1
     C                   WHEN      TRST = 'X'
     C                   MOVE      'N'           WSTSS
     C                   GOTO      SLTILSS
     C                   WHEN      TRST < '2'
     C                   MOVE      'CHG'         UTYPES
     C                   MOVE      '1'           UMODES
     C                   WHEN      TRST > '1'
     C                   MOVE      'DSP'         UTYPES
     C                   MOVE      '1'           UMODES
     C                   ENDSL
     C                   CALL      'GSS021R'
     C                   PARM      TRTNO         UTNO             11 0
     C                   PARM                    UTYPES
     C                   PARM                    UMODES
      *
     C     SLTILSS       TAG
     C                   MOVE      'N'           WSTSS
      *
     C                   ENDSR
      *
      *
**    TABELL  (NAV)  ENDRING N09BB
JAN
FEB
MAR
APR
MAY
JUN
JUL
AUG
SEP
OCT
NOV
DEC
