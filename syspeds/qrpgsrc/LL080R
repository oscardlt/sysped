      *
      ***********************************************************
      *** PROGRAM SKAL FORDELE VARE PÅ PLUKKLISTER            ***
      ***********************************************************
      *
     FLLAGJL01  IF   E           K DISK
     FLLHEAD01  UF   E           K DISK
     FLLLINE    UF   E           K DISK
     FLL080F    O  A E             DISK
     FLL080D    CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
     D                 DS
     D  VAVARE                 1     35
     D  VAVARE20               1     20
      *
     C                   EXSR      INIT
      *
     C     LLAGJL01K     CHAIN(N)  LLAGJL01                           33
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   MOVE      '0'           *IN42
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     LLHEAD01K     SETLL     LLHEAD01
     C     LLHEAD01K     READE(N)  LLHEAD01                               94
      *
     C                   DOW       *IN94 = *OFF                                 1<-B
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE(N)  LLLINE                                 33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        LLANR  = VAANR AND                             3<-B
     C                             LLANT0 <> 0 AND LLANT0 > LLWNT0
     C                   MOVE      LLWNT0        WSWNT0
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   END                                                      3<-E
     C     LHMN          READE(N)  LLLINE                                 33
     C                   ENDDO                                                   2<-E
     C     LLHEAD01K     READE(N)  LLHEAD01                               94
     C  N94              ENDDO                                                  1<-E
      *
     C     ZRECNO        CABEQ     0             SLUTT
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     1             ZRECNO
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
      *
     C                   MOVEA     '00'          *IN(30)
      *
     C     *IN12         CABEQ     '1'           SLUTT
      * RE-ALLOKER
     C     *IN07         CABEQ     '1'           START
      *
     C                   EXSR      SRHENT
     C     *IN30         CABEQ     '1'           START3
     C     START5        TAG
     C     *IN23         IFEQ      '1'
     C                   EXSR      OPDLAG
     C                   ELSE
     C                   Z-ADD     1             ZRECNO
     C                   GOTO      START3
     C                   END
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     SRHENT        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XWNT0A
     C                   MOVE      VASALD        XWNT0D
     C     1             DO        YRECNO        ZRECNO                         1<-B
     C     ZRECNO        CHAIN     SUBFIL                             33
     C                   SELECT                                                  2<-B
     C                   WHEN      WSWNT0 = 0 AND WSNR = '1'                     2
     C                   MOVE      LLANT0        WSWNT0
     C                   MOVE      ' '           WSNR
     C                   WHEN      WSWNT0 > LLANT0                               2
     C                   MOVE      'YBC1979'     MSGNR
     C                   MOVEA     '11'          *IN(30)
     C                   MOVE      *ZEROS        XWNT0A
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   WHEN      WSWNT0 < LLWNT0                               2
     C                   MOVE      'YBC1981'     MSGNR
     C                   MOVEA     '11'          *IN(30)
     C                   MOVE      *ZEROS        XWNT0A
     C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   ENDSL                                                   2<-E
     C                   UPDATE    SUBFIL
     C                   ADD       WSWNT0        XWNT0A
     C                   END                                                    1<-E
      *
     C     VASALD        SUB       XWNT0A        XWNT0D
     C                   IF        XWNT0D < 0
     C                   Z-ADD     1             ZRECNO
     C                   MOVE      'YBC1980'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     SLHENT        ENDSR
      *
      ***********************************************
     C     OPDLAG        BEGSR
      ***********************************************
     C     1             DO        YRECNO        ZRECNO                         1<-B
      *
     C     ZRECNO        CHAIN     SUBFIL                             33
     C                   IF        WSWNT0 > LLWNT0                               2<-B
      *
     C                   MOVE      *ZEROS        UPRDT             8
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      *ZEROS        UWNTL
     C                   MOVE      *ZEROS        UWNT1
     C                   MOVE      *ZEROS        UWNT2
     C                   MOVE      *ZEROS        UWNT3
     C                   MOVE      *ZEROS        UWVEK
     C                   MOVE      *ZEROS        UWKUB
      *
     C                   CALL      'LL022R'
     C                   PARM                    UGRP
     C                   PARM                    UPNR
     C                   PARM                    VAANR
     C                   PARM                    USENR
     C                   PARM                    UPRDT
     C                   PARM                    LHMN
     C                   PARM                    LLVN
     C                   PARM      WSWNT0        UWNT0
     C                   PARM                    UWNTL
     C                   PARM                    UWNT1
     C                   PARM                    UWNT2
     C                   PARM                    UWNT3
     C                   PARM                    UWVEK
     C                   PARM                    UWKUB
     C                   PARM                    ULOK
     C                   PARM                    UNTLK             3 0
     C                   PARM                    UFLAGG
      *
     C     LLLINEK       CHAIN     LLLINE                             33
     C                   MOVE      WSWNT0        LLWNT0
     C                   MOVE      UWNTL         LLWNTL
     C                   MOVE      UWNT1         LLWNT1                           3<-B
     C                   MOVE      UWNT2         LLWNT2
     C                   MOVE      UWNT3         LLWNT3
     C                   MOVE      UWVEK         LLWVEK
     C                   MOVE      UWKUB         LLWKUB
     C                   MOVE      ULOK          LLLOK
     C                   MOVE      UNTLK         LLNTLK
     C                   UPDATE    LLLINER
      *
     C                   WRITE     LL080FR
     C                   END                                                     2<-E
      *
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *LIKE         DEFINE    VAGRUP        UGRP
     C     *LIKE         DEFINE    VAKJED        UPNR
     C     *LIKE         DEFINE    VAMN          UMN
     C     *LIKE         DEFINE    VAANR         UANR
     C     *LIKE         DEFINE    VASENR        USENR
     C     *LIKE         DEFINE    VALLOK        ULOK
     C     *LIKE         DEFINE    LLWNT0        UWNT0
     C     *LIKE         DEFINE    LLWNTL        UWNTL
     C     *LIKE         DEFINE    LLWNT1        UWNT1
     C     *LIKE         DEFINE    LLWNT2        UWNT2
     C     *LIKE         DEFINE    LLWNT3        UWNT3
     C     *LIKE         DEFINE    LLWVEK        UWVEK
     C     *LIKE         DEFINE    LLWKUB        UWKUB
      *
     C     LLLINEK       KLIST
     C                   KFLD                    LHMN
     C                   KFLD                    LLVN
     C     LLHEAD01K     KLIST
     C                   KFLD                    LHSTA
     C                   KFLD                    UGRP
     C                   KFLD                    UPNR
     C     LLAGJL01K     KLIST
     C                   KFLD                    UGRP
     C                   KFLD                    UPNR
     C                   KFLD                    UMN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UGRP
     C                   PARM                    UPNR
     C                   PARM                    UMN
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
