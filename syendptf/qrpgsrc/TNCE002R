CB    * Lagt inn lengre feltdefinisjon vedr. UPDHTMLVAR
      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TNCE002R MODULE(*LIBL/TNCE002R *LIBL/INCGI)
CRTPGM*        ACTGRP(*NEW) AUT(*USE)
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 FJERN REKORD-LÅS PÅ SVXH
11133 * 02 YBC PTF11 VEKT ER ENDRET FRA 9.1 TIL 11.3, EGET FELT FOR GARANTI
12163 * 03 CB  PTF12 Signera direkt
12XXX * 04 YBC PTF12 Oppdater brukt garantibeløp
12XXX * 05 CB  PTF12 NCTS Version 5
12XXX * 06 CB  PTF12 Ikke oppdater negative garantibelöp
********************************************************************
      *
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
N04  FSVXGH     UF   E           K DISK    USROPN
     FSVXH      UF A E           K DISK    USROPN
     F                                     PREFIX(X_)
     FSVXHFV    UF A E           K DISK    USROPN
     F                                     PREFIX(X_)
     FSVXSTD    UF   E           K DISK    USROPN
     F                                     PREFIX(X_)
     FSVTHA2    IF   E           K DISK    USROPN
     F                                     RENAME(SVTHAR:SVTHAR2)
     FSVTHA     IF   E           K DISK    USROPN
     FSVXV      IF A E           K DISK    USROPN
     FSVXVAM    IF A E           K DISK    USROPN
     FSVXVVT    IF A E           K DISK    USROPN
     FSVXVDK    IF A E           K DISK    USROPN
     FSVXVCN    IF A E           K DISK    USROPN
     FSVXVMN    IF A E           K DISK    USROPN
     FFRISOK    UF A E           K DISK    USROPN
     FFRISOL01  IF   E           K DISK    USROPN
     F                                     RENAME(FRISOKR:FRISOKRL)
     FHEADF     IF   E           K DISK    USROPN
     FSVEH      IF   E           K DISK    USROPN
N03  FEDIC      UF   E             DISK    USROPN
N03  FSVTFI     IF   E             DISK    USROPN
N03  FEDIM      O  A E             DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D THAVD_A         S              4
     D THAVD           S              4  0
     D THTDN_A         S              7
     D THTDN           S              7  0
     D NEWSYAVA        S              4
     D NEWAVD          S              4  0
     D NEWOPD          S              7  0
     D NEWSIGN         S              3
     D WMODE           S              2
     D WSIGN           S              3
     D THXREF          S             35
     D THSG            S              3
     D THST            S              1
     D THDT_A          S              8
     D THDT            S              8  0
     D THPRO_A         S              8
     D THPRO           S              8  0
     D THENKL          S              1
     D THDK            S              5
     D THKNA_A         S              8
     D THKNA           S              8  0
     D THNAA           S             30
     D THADA1          S             30
     D THPNA           S              9
     D THPSA           S             24
     D THLKA           S              2
     D THSKA           S              2
     D THTINA          S             17
     D THKNS_A         S              8
     D THKNS           S              8  0
     D THNAS           S             30
     D THADS1          S             30
     D THPNS           S              9
     D THPSS           S             24
     D THLKS           S              2
     D THSKS           S              2
     D THTINS          S             17
     D THKNK_A         S              8
     D THKNK           S              8  0
     D THNAK           S             30
     D THADK1          S             30
     D THPNK           S              9
     D THPSK           S             24
     D THLKK           S              2
     D THSKK           S              2
     D THTINK          S             17
     D THBLK           S              2
     D THLSD           S             17
     D THLASD          S             17
     D THLAS2          S             17
     D THALK           S              2
     D THTRM_A         S              2
     D THTRM           S              2  0
     D THTRMI_A        S              2
     D THTRMI          S              2  0
     D THTAID          S             27
     D THTASK          S              2
     D THTALK          S              2
     D THTGID          S             27
     D THTGSK          S              2
     D THTGLK          S              2
     D THSKFD          S              2
     D THCATS          S              8
     D THTSD1          S              8
     D THTSD2          S              8
     D THTSD3          S              8
     D THTSD4          S              8
     D THTSD5          S              8
     D THTSD6          S              8
     D THTSD7          S              8
     D THTSD8          S              8
     D THTSB           S              8
     D THDDT_A         S              8
     D THDDT           S              8  0
     D THDFKD          S             20
     D THDFSK          S              2
     D THDKR           S              2
     D THDANT_A        S              4
     D THDANT          S              4  0
     D THDDTK_A        S              8
     D THDDTK          S              8  0
     D THDATS          S              8
     D THDKAV          S             35
     D THDKSK          S              2
     D THGKD_A         S              8
     D THGKD           S              8  0
     D THGFT1          S             24
     D THGFT2          S             35
     D THGADK          S              4
     D THGBL_A         S             13
     D THGBL           S             13  2
     D THGVK           S              3
     D THGBGI_A        S              1
     D THGBGI          S              1  0
     D THGBGU          S              2
     D THKDC           S              1
     D THTSSD          S              8
     D THTSN1          S             35
     D THTSN2          S             35
     D THTSPN          S              9
     D THTSLK          S              2
     D THTSSK          S              2
     D THLSTL_A        S              4
     D THLSTL          S              4  0
     D THVPOS_A        S              5
     D THVPOS          S              5  0
     D THNTK_A         S              7
     D THNTK           S              7  0
S02  D*THVKB_A         S              9
S02  D*THVKB           S              9  1
N02  D THVKB_A         S             12
N02  D THVKB           S             11  3
     D THDST           S             15
     D THDSK           S              2
     D THTARF          S             16
     D THWS            S             10
     D THTRNR          S             18
     D THTRDT_A        S              8
     D THTRDT          S              8  0
     D THOMD_A         S              1
     D THOMD           S              1  0
     D THBIND          S            140
     D THTET_A         S              1
     D THTET           S              1  0
     D THMF            S              3
     D THMP_A          S              1
     D THMP            S              1  0
     D THPKL           S              1
     D THKDV           S              1
     D TH0035          S              1
     D SVXH_0035       S              1
     D THTUID          S             14
     D THSGDK          S              6
     D THSGME          S              3
     D THSGUT          S              6
     D THSGID          S             10
     D THSGDT          S             12
     D THBYTE_A        S              7
     D THBYTE          S              7  0
     D THSIK           S              1  0
     D THDTA           S              8  0
     D THTMA           S              4  0
     D THSPOM          S              1
     D THTKBM          S              1
     D THKREF          S             70
     D THTREF          S             35
     D THLOSD          S             35
     D THLOSDSK        S              2
     D THLKR1          S              2
     D THLKR2          S              2
     D THLKR3          S              2
     D THLKR4          S              2
     D THLKR5          S              2
     D THLKR6          S              2
     D THLKR7          S              2
     D THLKR8          S              2
     D THKNSS          S              8  0
     D THNASS          S             30
     D THADSS1         S             30
     D THPNSS          S              9
     D THPSSS          S             24
     D THLKSS          S              2
     D THSKSS          S              2
     D THTINSS         S             17
     D THKNKS          S              8  0
     D THNAKS          S             30
     D THADKS1         S             30
     D THPNKS          S              9
     D THPSKS          S             24
     D THLKKS          S              2
     D THSKKS          S              2
     D THTINKS         S             17
     D THKNT           S              8  0
     D THNAT           S             30
     D THADT1          S             30
     D THPNT           S              9
     D THPST           S             24
     D THLKT           S              2
     D THSKT           S              2
     D THTINT          S             17
     D THDKT           S              1
     D THTIRN          S             12
     D THSECU          S              1  0
     D THRDIN          S              1  0
     D THSCIN          S              3
     D THCLKD          S              2
     D THBINI          S              1  0
     D THLIDT          S             10
     D THATYP          S              4
     D THAREF          S             35
     D THETA1          S              8  0
     D THETAT1         S              4  0
     D THETA2          S              8  0
     D THETAT2         S              4  0
     D THETA3          S              8  0
     D THETAT3         S              4  0
     D THETA4          S              8  0
     D THETAT4         S              4  0
     D THETA5          S              8  0
     D THETAT5         S              4  0
     D THETA6          S              8  0
     D THETAT6         S              4S 0
     D THETA7          S              8S 0
     D THETAT7         S              4S 0
     D THETA8          S              8S 0
     D THETAT8         S              4S 0
     D THTSDE          S              8
     D THKNH           S              8  0
     D THTINH          S             17
     D THTIRH          S             17
     D THNAH           S             30
     D THAD1H          S             30
     D THPNH           S             17
     D THPSH           S             24
     D THLKH           S              2
     D THCPH           S             30
     D THTLH           S             20
     D THEMH           S             50
     D THSTA           S              1  0
     D THCPA           S             30
     D THTLA           S             20
     D THEMA           S             50
     D THTMIN          S              1  0
     D THTMGR          S              1  0
     D THUCR           S             35
     D THTINC          S             17
     D THKNC           S              8  0
     D THNAC           S             30
     D THTLC           S             20
     D THEMC           S             50
     D THCPS           S             30A
     D THTLS           S             20
     D THEMS           S             50
     D THROLE          S              3
     D THIDR           S             17
     D THCNR           S             17
     D THGINR          S              5  0
     D THLGTY          S              1
     D THLGID          S              1
     D THLGAU          S             35
     D THLGAI          S              4
     D THLGUN          S             17
     D THLGTS          S              8
     D THLGLA          S             17
     D THLGLO          S             17
     D THKNE           S              8  0
     D THTINE          S             17
     D THADE1          S             30
     D THPNE           S             17
     D THPSE           S             24
     D THLKE           S              2
     D THADE2          S             17
     D THPNE2          S             17
     D THLKE2          S              2
     D THCPE           S             30
     D THTLE           S             20
     D THEME           S             50
     D THTGTS          S              8
     D THTRMG          S              2  0
     D THTGCN          S             17
     D THLSUN          S             17
     D THLSLK          S              2
     D THLSNA          S             35
     D THLOUN          S             17
     D THLOLK          S              2
     D THLONA          S             35
     D THPDTY          S              4
     D THPDRF          S             70
     D THPDIN          S             35
     D THSDTY          S              4
     D THSDRF          S             70
     D THSDLN          S              5  0
     D THSDIN          S             35
     D THTDTY          S              4
     D THTDRF          S             70
     D THADTY          S              4
     D THADRF          S             70
     D THAICD          S              5
     D THAITX          S             70
     D THTRMP          S              1
     D THVERS          S              1
     D WALFA18         S             18
     D JSONstring      S          32000
     D Error           S            150
     D                 DS
     D  WDDMMAA                1      6  0
     D  WDD                    1      2  0
     D  WMM                    3      4  0
     D  WAA                    5      6  0
     D                 DS
     D  WAMD                   1      6  0
     D  WA                     1      2  0
     D  WM                     3      4  0
     D  WD                     5      6  0
N03   *   SYEDI data area
N03  D EDIDTA          DS           256
N03  D  UELIBF               171    180

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C  N50              EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬thavd¬ : ¬'+%trim(%editc(THAVD:'Z'))+'¬, '
        +'¬thtdn¬ : ¬'+%trim(%editc(THTDN:'Z'))+'¬, '
        +'¬newavd¬ : ¬'+%trim(%editc(NEWAVD:'Z'))+'¬, '
        +'¬newopd¬ : ¬'+%trim(%editc(NEWOPD:'Z'))+'¬, '
        +'¬newsign¬ : ¬'+%trim(NEWSIGN)+'¬, '
        +'¬mode¬ : ¬'+%trim(WMODE)+'¬, '
        +'¬thtuid¬ : ¬'+%trim(THTUID)+'¬, '
        +'¬thsg¬ : ¬'+%trim(THSG)+'¬, '
        +'¬thst¬ : ¬'+%trim(THST)+'¬, '
        +'¬thdt¬ : ¬'+%trim(%editc(THDT:'Z'))+'¬, '
        +'¬thpro¬ : ¬'+%trim(%editc(THPRO:'Z'))+'¬, '
        +'¬thenkl¬ : ¬'+%trim(THENKL)+'¬, '
        +'¬thdk¬ : ¬'+%trim(THDK)+'¬, '
        +'¬thkna¬ : ¬'+%trim(%editc(THKNA:'Z'))+'¬, '
        +'¬thnaa¬ : ¬'+%trim(THNAA)+'¬, '
        +'¬thada1¬ : ¬'+%trim(THADA1)+'¬, '
        +'¬thpna¬ : ¬'+%trim(THPNA)+'¬, '
        +'¬thpsa¬ : ¬'+%trim(THPSA)+'¬, '
        +'¬thlka¬ : ¬'+%trim(THLKA)+'¬, '
        +'¬thska¬ : ¬'+%trim(THSKA)+'¬, '
        +'¬thtina¬ : ¬'+%trim(THTINA)+'¬, '
        +'¬thkns¬ : ¬'+%trim(%editc(THKNS:'Z'))+'¬, '
        +'¬thnas¬ : ¬'+%trim(THNAS)+'¬, '
        +'¬thads1¬ : ¬'+%trim(THADS1)+'¬, '
        +'¬thpns¬ : ¬'+%trim(THPNS)+'¬, '
        +'¬thpss¬ : ¬'+%trim(THPSS)+'¬, '
        +'¬thlks¬ : ¬'+%trim(THLKS)+'¬, '
        +'¬thsks¬ : ¬'+%trim(THSKS)+'¬, '
        +'¬thtins¬ : ¬'+%trim(THTINS)+'¬, '
        +'¬thknk¬ : ¬'+%trim(%editc(THKNK:'Z'))+'¬, '
        +'¬thnak¬ : ¬'+%trim(THNAK)+'¬, '
        +'¬thadk1¬ : ¬'+%trim(THADK1)+'¬, '
        +'¬thpnk¬ : ¬'+%trim(THPNK)+'¬, '
        +'¬thpsk¬ : ¬'+%trim(THPSK)+'¬, '
        +'¬thlkk¬ : ¬'+%trim(THLKK)+'¬, '
        +'¬thskk¬ : ¬'+%trim(THSKK)+'¬, '
        +'¬thtink¬ : ¬'+%trim(THTINK)+'¬, '
        +'¬thblk¬ : ¬'+%trim(THBLK)+'¬, '
        +'¬thlsd¬ : ¬'+%trim(THLSD)+'¬, '
        +'¬thlasd¬ : ¬'+%trim(THLASD)+'¬, '
        +'¬thlas2¬ : ¬'+%trim(THLAS2)+'¬, '
        +'¬thalk¬ : ¬'+%trim(THALK)+'¬, '
        +'¬thtrm¬ : ¬'+%trim(%editc(THTRM:'Z'))+'¬, '
        +'¬thtrmi¬ : ¬'+%trim(%editc(THTRMI:'Z'))+'¬, '
        +'¬thtaid¬ : ¬'+%trim(THTAID)+'¬, '
        +'¬thtask¬ : ¬'+%trim(THTASK)+'¬, '
        +'¬thtalk¬ : ¬'+%trim(THTALK)+'¬, '
        +'¬thtgid¬ : ¬'+%trim(THTGID)+'¬, '
        +'¬thtgsk¬ : ¬'+%trim(THTGSK)+'¬, '
        +'¬thtglk¬ : ¬'+%trim(THTGLK)+'¬, '
        +'¬thskfd¬ : ¬'+%trim(THSKFD)+'¬, '
        +'¬thcats¬ : ¬'+%trim(THCATS)+'¬, '
        +'¬thtsd1¬ : ¬'+%trim(THTSD1)+'¬, '
        +'¬thtsd2¬ : ¬'+%trim(THTSD2)+'¬, '
        +'¬thtsd3¬ : ¬'+%trim(THTSD3)+'¬, '
        +'¬thtsd4¬ : ¬'+%trim(THTSD4)+'¬, '
        +'¬thtsd5¬ : ¬'+%trim(THTSD5)+'¬, '
        +'¬thtsd6¬ : ¬'+%trim(THTSD6)+'¬, '
        +'¬thtsd7¬ : ¬'+%trim(THTSD7)+'¬, '
        +'¬thtsd8¬ : ¬'+%trim(THTSD8)+'¬, '
        +'¬thtsb¬ : ¬'+%trim(THTSB)+'¬, '
        +'¬thddt¬ : ¬'+%trim(%editc(THDDT:'Z'))+'¬, '
        +'¬thdfkd¬ : ¬'+%trim(THDFKD)+'¬, '
        +'¬thdfsk¬ : ¬'+%trim(THDFSK)+'¬, '
        +'¬thdkr¬ : ¬'+%trim(THDKR)+'¬, '
        +'¬thdant¬ : ¬'+%trim(%editc(THDANT:'Z'))+'¬, '
        +'¬thddtk¬ : ¬'+%trim(%editc(THDDTK:'Z'))+'¬, '
        +'¬thdats¬ : ¬'+%trim(THDATS)+'¬, '
        +'¬thdkav¬ : ¬'+%trim(THDKAV)+'¬, '
        +'¬thdksk¬ : ¬'+%trim(THDKSK)+'¬, '
        +'¬thgkd¬ : ¬'+%trim(%editc(THGKD:'3'))+'¬, '
        +'¬thgft1¬ : ¬'+%trim(THGFT1)+'¬, '
        +'¬thgft2¬ : ¬'+%trim(THGFT2)+'¬, '
        +'¬thgadk¬ : ¬'+%trim(THGADK)+'¬, '
        +'¬thgbl¬ : ¬'+%trim(%editc(THGBL:'K'))+'¬, '
        +'¬thgvk¬ : ¬'+%trim(THGVK)+'¬, '
        +'¬thgbgi¬ : ¬'+%trim(%editc(THGBGI:'3'))+'¬, '
        +'¬thgbgu¬ : ¬'+%trim(THGBGU)+'¬, '
        +'¬thkdc¬ : ¬'+%trim(THKDC)+'¬, '
        +'¬thtssd¬ : ¬'+%trim(THTSSD)+'¬, '
        +'¬thtsn1¬ : ¬'+%trim(THTSN1)+'¬, '
        +'¬thtsn2¬ : ¬'+%trim(THTSN2)+'¬, '
        +'¬thtspn¬ : ¬'+%trim(THTSPN)+'¬, '
        +'¬thtslk¬ : ¬'+%trim(THTSLK)+'¬, '
        +'¬thtssk¬ : ¬'+%trim(THTSSK)+'¬, '
        +'¬thlstl¬ : ¬'+%trim(%editc(THLSTL:'Z'))+'¬, '
        +'¬thvpos¬ : ¬'+%trim(%editc(THVPOS:'Z'))+'¬, '
        +'¬thntk¬ : ¬'+%trim(%editc(THNTK:'Z'))+'¬, '
        +'¬thvkb¬ : ¬'+%trim(%editc(THVKB:'4'))+'¬, '
        +'¬thdst¬ : ¬'+%trim(THDST)+'¬, '
        +'¬thdsk¬ : ¬'+%trim(THDSK)+'¬, '
        +'¬thtarf¬ : ¬'+%trim(THTARF)+'¬, '
        +'¬thws¬ : ¬'+%trim(THWS)+'¬, '
        +'¬thtrnr¬ : ¬'+%trim(THTRNR)+'¬, '
        +'¬thtrdt¬ : ¬'+%trim(%editc(THTRDT:'Z'))+'¬, '
        +'¬thomd¬ : ¬'+%trim(%editc(THOMD:'Z'))+'¬, '
        +'¬thbind¬ : ¬'+%trim(THBIND)+'¬, '
        +'¬thtet¬ : ¬'+%trim(%editc(THTET:'Z'))+'¬, '
        +'¬thmf¬ : ¬'+%trim(THMF)+'¬, '
        +'¬thmp¬ : ¬'+%trim(%editc(THMP:'Z'))+'¬, '
        +'¬thpkl¬ : ¬'+%trim(THPKL)+'¬, '
        +'¬thkdv¬ : ¬'+%trim(THKDV)+'¬, '
        +'¬th0035¬ : ¬'+%trim(TH0035)+'¬, '
        +'¬thsgdk¬ : ¬'+%trim(THSGDK)+'¬, '
        +'¬thsgme¬ : ¬'+%trim(THSGME)+'¬, '
        +'¬thsgut¬ : ¬'+%trim(THSGUT)+'¬, '
        +'¬thsgid¬ : ¬'+%trim(THSGID)+'¬, '
        +'¬thsgdt¬ : ¬'+%trim(THSGDT)+'¬, '
        +'¬thbyte¬ : ¬'+%trim(%editc(THBYTE:'Z'))+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     c                   eval      JSONstring ='"orderupdate" : ['
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
N04  C  N50              CLOSE     SVXGH
     C  N50              CLOSE     SVXH
     C  N50              CLOSE     SVXHFV
     C  N50              CLOSE     SVXSTD
     C  N50              CLOSE     SVTHA
     C  N50              CLOSE     SVTHA2
     C  N50              CLOSE     FRISOK
     C  N50              CLOSE     FRISOL01
     C  N50              CLOSE     HEADF
     C  N50              CLOSE     SVEH
N03  C  N50              CLOSE     EDIC
N03  C  N50              CLOSE     SVTFI
N03  C  N50              CLOSE     EDIM

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER   = zhbgetvar('USER')
     C                   EVAL      THAVD_A  = zhbgetvar('THAVD')
     C                   EVAL      THAVD    = c2n2(THAVD_A)
     C                   EVAL      THTDN_A  = zhbgetvar('THTDN')
     C                   EVAL      THTDN    = c2n2(THTDN_A)
     C                   EVAL      NEWSYAVA = zhbgetvar('NEWAVD')
     C                   EVAL      NEWAVD   = c2n2(NEWSYAVA)
     C                   EVAL      NEWSIGN  = zhbgetvar('NEWSIGN')
     C                   EVAL      WMODE    = zhbgetvar('MODE')
     C                   EVAL      THSG     = zhbgetvar('THSG')
     C                   EVAL      WSIGN    = zhbgetvar('SIGN')
     C                   EVAL      THXREF   = zhbgetvar('THXREF')
     C                   EVAL      THST     = zhbgetvar('THST')
     C                   EVAL      THDT_A   = zhbgetvar('THDT')
     C                   EVAL      THDT     = c2n2(THDT_A)
     C                   EVAL      THPRO_A  = zhbgetvar('THPRO')
     C                   EVAL      THPRO    = c2n2(THPRO_A)
     C                   EVAL      THENKL   = zhbgetvar('THENKL')
     C                   EVAL      THDK     = zhbgetvar('THDK')
     C                   EVAL      THKNA_A  = zhbgetvar('THKNA')
     C                   EVAL      THKNA    = c2n2(THKNA_A)
     C                   EVAL      THNAA    = zhbgetvar('THNAA')
     C                   EVAL      THADA1   = zhbgetvar('THADA1')
     C                   EVAL      THPNA    = zhbgetvar('THPNA')
     C                   EVAL      THPSA    = zhbgetvar('THPSA')
     C                   EVAL      THLKA    = zhbgetvar('THLKA')
     C                   EVAL      THSKA    = zhbgetvar('THSKA')
     C                   EVAL      THTINA   = zhbgetvar('THTINA')
     C                   EVAL      THKNS_A  = zhbgetvar('THKNS')
     C                   EVAL      THKNS    = c2n2(THKNS_A)
     C                   EVAL      THNAS    = zhbgetvar('THNAS')
     C                   EVAL      THADS1   = zhbgetvar('THADS1')
     C                   EVAL      THPNS    = zhbgetvar('THPNS')
     C                   EVAL      THPSS    = zhbgetvar('THPSS')
     C                   EVAL      THLKS    = zhbgetvar('THLKS')
     C                   EVAL      THSKS    = zhbgetvar('THSKS')
     C                   EVAL      THTINS   = zhbgetvar('THTINS')
     C                   EVAL      THKNK_A  = zhbgetvar('THKNK')
     C                   EVAL      THKNK    = c2n2(THKNK_A)
     C                   EVAL      THNAK    = zhbgetvar('THNAK')
     C                   EVAL      THADK1   = zhbgetvar('THADK1')
     C                   EVAL      THPNK    = zhbgetvar('THPNK')
     C                   EVAL      THPSK    = zhbgetvar('THPSK')
     C                   EVAL      THLKK    = zhbgetvar('THLKK')
     C                   EVAL      THSKK    = zhbgetvar('THSKK')
     C                   EVAL      THTINK   = zhbgetvar('THTINK')
     C                   EVAL      THBLK    = zhbgetvar('THBLK')
     C                   EVAL      THLSD    = zhbgetvar('THLSD')
     C                   EVAL      THLASD   = zhbgetvar('THLASD')
     C                   EVAL      THLAS2   = zhbgetvar('THLAS2')
     C                   EVAL      THALK    = zhbgetvar('THALK')
     C                   EVAL      THTRM_A  = zhbgetvar('THTRM')
     C                   EVAL      THTRM    = c2n2(THTRM_A)
     C                   EVAL      THTRMI_A = zhbgetvar('THTRMI')
     C                   EVAL      THTRMI   = c2n2(THTRMI_A)
     C                   EVAL      THTAID   = zhbgetvar('THTAID')
     C                   EVAL      THTASK   = zhbgetvar('THTASK')
     C                   EVAL      THTALK   = zhbgetvar('THTALK')
     C                   EVAL      THTGID   = zhbgetvar('THTGID')
     C                   EVAL      THTGSK   = zhbgetvar('THTGSK')
     C                   EVAL      THTGLK   = zhbgetvar('THTGLK')
     C                   EVAL      THSKFD   = zhbgetvar('THSKFD')
     C                   EVAL      THCATS   = zhbgetvar('THCATS')
     C                   EVAL      THTSD1   = zhbgetvar('THTSD1')
     C                   EVAL      THTSD2   = zhbgetvar('THTSD2')
     C                   EVAL      THTSD3   = zhbgetvar('THTSD3')
     C                   EVAL      THTSD4   = zhbgetvar('THTSD4')
     C                   EVAL      THTSD5   = zhbgetvar('THTSD5')
     C                   EVAL      THTSD6   = zhbgetvar('THTSD6')
     C                   EVAL      THTSD7   = zhbgetvar('THTSD7')
     C                   EVAL      THTSD8   = zhbgetvar('THTSD8')
     C                   EVAL      THTSB    = zhbgetvar('THTSB')
     C                   EVAL      THDDT_A  = zhbgetvar('THDDT')
     C                   EVAL      THDDT    = c2n2(THDDT_A)
     C                   EVAL      THDFKD   = zhbgetvar('THDFKD')
     C                   EVAL      THDFSK   = zhbgetvar('THDFSK')
     C                   EVAL      THDKR    = zhbgetvar('THDKR')
     C                   EVAL      THDANT_A = zhbgetvar('THDANT')
     C                   EVAL      THDANT   = c2n2(THDANT_A)
     C                   EVAL      THDDTK_A = zhbgetvar('THDDTK')
     C                   EVAL      THDDTK   = c2n2(THDDTK_A)
     C                   EVAL      THDATS   = zhbgetvar('THDATS')
     C                   EVAL      THDKAV   = zhbgetvar('THDKAV')
     C                   EVAL      THDKSK   = zhbgetvar('THDKSK')
     C                   EVAL      THGKD_A  = zhbgetvar('THGKD')
     C                   EVAL      THGKD    = c2n2(THGKD_A)
     C                   EVAL      THGFT1   = zhbgetvar('THGFT1')
     C                   EVAL      THGFT2   = zhbgetvar('THGFT2')
     C                   EVAL      THGADK   = zhbgetvar('THGADK')
     C                   EVAL      THGBL_A  = zhbgetvar('THGBL')
     C                   EVAL      THGBL    = c2n2(THGBL_A)
     C                   EVAL      THGVK    = zhbgetvar('THGVK')
     C                   EVAL      THGBGI_A = zhbgetvar('THGBGI')
     C                   EVAL      THGBGI   = c2n2(THGBGI_A)
     C                   EVAL      THGBGU   = zhbgetvar('THGBGU')
     C                   EVAL      THKDC    = zhbgetvar('THKDC')
     C                   EVAL      THTSSD   = zhbgetvar('THTSSD')
     C                   EVAL      THTSN1   = zhbgetvar('THTSN1')
     C                   EVAL      THTSN2   = zhbgetvar('THTSN2')
     C                   EVAL      THTSPN   = zhbgetvar('THTSPN')
     C                   EVAL      THTSLK   = zhbgetvar('THTSLK')
     C                   EVAL      THTSSK   = zhbgetvar('THTSSK')
     C                   EVAL      THLSTL_A = zhbgetvar('THLSTL')
     C                   EVAL      THLSTL   = c2n2(THLSTL_A)
     C                   EVAL      THVPOS_A = zhbgetvar('THVPOS')
     C                   EVAL      THVPOS   = c2n2(THVPOS_A)
     C                   EVAL      THNTK_A  = zhbgetvar('THNTK')
     C                   EVAL      THNTK    = c2n2(THNTK_A)
     C                   EVAL      THVKB_A  = zhbgetvar('THVKB')
     C                   EVAL      THVKB    = c2n2(THVKB_A)
     C                   EVAL      THDST    = zhbgetvar('THDST')
     C                   EVAL      THDSK    = zhbgetvar('THDSK')
     C*                  EVAL      THTARF   = zhbgetvar('THTARF')
     C                   EVAL      THWS     = zhbgetvar('THWS')
     C                   EVAL      THTRNR   = zhbgetvar('THTRNR')
     C                   EVAL      THTRDT_A = zhbgetvar('THTRDT')
     C                   EVAL      THTRDT   = c2n2(THTRDT_A)
     C                   EVAL      THOMD_A  = zhbgetvar('THOMD')
     C                   EVAL      THOMD    = c2n2(THOMD_A)
     C                   EVAL      THBIND   = zhbgetvar('THBIND')
     C                   EVAL      THTET_A  = zhbgetvar('THTET')
     C                   EVAL      THTET    = c2n2(THTET_A)
     C                   EVAL      THMF     = zhbgetvar('THMF')
     C                   EVAL      THMP_A   = zhbgetvar('THMP')
     C                   EVAL      THMP     = c2n2(THMP_A)
     C                   EVAL      THPKL    = zhbgetvar('THPKL')
     C                   EVAL      THKDV    = zhbgetvar('THKDV')
     C*                  EVAL      TH0035   = zhbgetvar('TH0035')
     C*                  EVAL      THTUID   = zhbgetvar('THTUID')
     C*                  EVAL      THSGDK   = zhbgetvar('THSGDK')
     C*                  EVAL      THSGME   = zhbgetvar('THSGME')
     C*                  EVAL      THSGUT   = zhbgetvar('THSGUT')
     C*                  EVAL      THSGID   = zhbgetvar('THSGID')
     C*                  EVAL      THSGDT   = zhbgetvar('THSGDT')
     C*                  EVAL      THBYTE_A = zhbgetvar('THBYTE')
     C*                  EVAL      THBYTE   = c2n2(THBYTE_A)
     C                   EVAL      WALFA18  = zhbgetvar('THSIK')
     C                   EVAL      THSIK    = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THDTA')
     C                   EVAL      THDTA    = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THTMA')
     C                   EVAL      THTMA    = c2n2(WALFA18)
     C                   EVAL      THSPOM   = zhbgetvar('THSPOM')
     C                   EVAL      THTKBM   = zhbgetvar('THTKBM')
     C                   EVAL      THKREF   = zhbgetvar('THKREF')
     C                   EVAL      THTREF   = zhbgetvar('THTREF')
     C                   EVAL      THLOSD   = zhbgetvar('THLOSD')
     C                   EVAL      THLOSDSK = zhbgetvar('THLOSDSK')
     C                   EVAL      THLKR1   = zhbgetvar('THLKR1')
     C                   EVAL      THLKR2   = zhbgetvar('THLKR2')
     C                   EVAL      THLKR3   = zhbgetvar('THLKR3')
     C                   EVAL      THLKR4   = zhbgetvar('THLKR4')
     C                   EVAL      THLKR5   = zhbgetvar('THLKR5')
     C                   EVAL      THLKR6   = zhbgetvar('THLKR6')
     C                   EVAL      THLKR7   = zhbgetvar('THLKR7')
     C                   EVAL      THLKR8   = zhbgetvar('THLKR8')
     C                   EVAL      WALFA18  = zhbgetvar('THKNSS')
     C                   EVAL      THKNSS   = c2n2(WALFA18)
     C                   EVAL      THNASS   = zhbgetvar('THNASS')
     C                   EVAL      THADSS1  = zhbgetvar('THADSS1')
     C                   EVAL      THPNSS   = zhbgetvar('THPNSS')
     C                   EVAL      THPSSS   = zhbgetvar('THPSSS')
     C                   EVAL      THLKSS   = zhbgetvar('THLKSS')
     C                   EVAL      THSKSS   = zhbgetvar('THSKSS')
     C                   EVAL      THTINSS  = zhbgetvar('THTINSS')
     C                   EVAL      WALFA18  = zhbgetvar('THKNKS')
     C                   EVAL      THKNKS   = c2n2(WALFA18)
     C                   EVAL      THNAKS   = zhbgetvar('THNAKS')
     C                   EVAL      THADKS1  = zhbgetvar('THADKS1')
     C                   EVAL      THPNKS   = zhbgetvar('THPNKS')
     C                   EVAL      THPSKS   = zhbgetvar('THPSKS')
     C                   EVAL      THLKKS   = zhbgetvar('THLKKS')
     C                   EVAL      THSKKS   = zhbgetvar('THSKKS')
     C                   EVAL      THTINKS  = zhbgetvar('THTINKS')
     C                   EVAL      WALFA18  = zhbgetvar('THKNT')
     C                   EVAL      THKNT    = c2n2(WALFA18)
     C                   EVAL      THNAT    = zhbgetvar('THNAT')
     C                   EVAL      THADT1   = zhbgetvar('THADT1')
     C                   EVAL      THPNT    = zhbgetvar('THPNT')
     C                   EVAL      THPST    = zhbgetvar('THPST')
     C                   EVAL      THLKT    = zhbgetvar('THLKT')
     C                   EVAL      THSKT    = zhbgetvar('THSKT')
     C                   EVAL      THTINT   = zhbgetvar('THTINT')
     C                   EVAL      THDKT    = zhbgetvar('THDKT')
     C                   EVAL      THTIRN   = zhbgetvar('THTIRN')
     C                   EVAL      WALFA18  = zhbgetvar('THSECU')
     C                   EVAL      THSECU   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THRDIN')
     C                   EVAL      THRDIN   = c2n2(WALFA18)
     C                   EVAL      THSCIN   = zhbgetvar('THSCIN')
     C                   EVAL      THCLKD   = zhbgetvar('THCLKD')
     C                   EVAL      WALFA18  = zhbgetvar('THBINI')
     C                   EVAL      THBINI   = c2n2(WALFA18)
     C                   EVAL      THLIDT   = zhbgetvar('THLIDT')
     C                   EVAL      THATYP   = zhbgetvar('THATYP')
     C                   EVAL      THAREF   = zhbgetvar('THAREF')
     C                   EVAL      WALFA18  = zhbgetvar('THETA1')
     C                   EVAL      THETA1   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT1')
     C                   EVAL      THETAT1  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA2')
     C                   EVAL      THETA2   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT2')
     C                   EVAL      THETAT2  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA3')
     C                   EVAL      THETA3   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT3')
     C                   EVAL      THETAT3  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA4')
     C                   EVAL      THETA4   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT4')
     C                   EVAL      THETAT4  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA5')
     C                   EVAL      THETA5   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT5')
     C                   EVAL      THETAT5  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA6')
     C                   EVAL      THETA6   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT6')
     C                   EVAL      THETAT6  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA7')
     C                   EVAL      THETA7   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT7')
     C                   EVAL      THETAT7  = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETA8')
     C                   EVAL      THETA8   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THETAT8')
     C                   EVAL      THETAT8  = c2n2(WALFA18)
     C                   EVAL      THTSDE   = zhbgetvar('THTSDE')
     C                   EVAL      WALFA18  = zhbgetvar('THKNH')
     C                   EVAL      THKNH    = c2n2(WALFA18)
     C                   EVAL      THTINH   = zhbgetvar('THTINH')
     C                   EVAL      THTIRH   = zhbgetvar('THTIRH')
     C                   EVAL      THNAH    = zhbgetvar('THNAH')
     C                   EVAL      THAD1H   = zhbgetvar('THAD1H')
     C                   EVAL      THPNH    = zhbgetvar('THPNH')
     C                   EVAL      THPSH    = zhbgetvar('THPSH')
     C                   EVAL      THLKH    = zhbgetvar('THLKH')
     C                   EVAL      THCPH    = zhbgetvar('THCPH')
     C                   EVAL      THTLH    = zhbgetvar('THTLH')
     C                   EVAL      THEMH    = zhbgetvar('THEMH')
     C                   EVAL      WALFA18  = zhbgetvar('THSTA')
     C                   EVAL      THSTA    = c2n2(WALFA18)
     C                   EVAL      THCPA    = zhbgetvar('THCPA')
     C                   EVAL      THTLA    = zhbgetvar('THTLA')
     C                   EVAL      THEMA    = zhbgetvar('THEMA')
     C                   EVAL      WALFA18  = zhbgetvar('THTMIN')
     C                   EVAL      THTMIN   = c2n2(WALFA18)
     C                   EVAL      WALFA18  = zhbgetvar('THTMGR')
     C                   EVAL      THTMGR   = c2n2(WALFA18)
     C                   EVAL      THUCR    = zhbgetvar('THUCR')
     C                   EVAL      THTINC   = zhbgetvar('THTINC')
     C                   EVAL      WALFA18  = zhbgetvar('THKNC')
     C                   EVAL      THKNC    = c2n2(WALFA18)
     C                   EVAL      THNAC    = zhbgetvar('THNAC')
     C                   EVAL      THTLC    = zhbgetvar('THTLC')
     C                   EVAL      THEMC    = zhbgetvar('THEMC')
     C                   EVAL      THCPS    = zhbgetvar('THCPS')
     C                   EVAL      THTLS    = zhbgetvar('THTLS')
     C                   EVAL      THEMS    = zhbgetvar('THEMS')
     C                   EVAL      THROLE   = zhbgetvar('THROLE')
     C                   EVAL      THIDR    = zhbgetvar('THIDR')
     C                   EVAL      THCNR    = zhbgetvar('THCNR')
     C                   EVAL      WALFA18  = zhbgetvar('THGINR')
     C                   EVAL      THGINR   = c2n2(WALFA18)
     C                   EVAL      THLGTY   = zhbgetvar('THLGTY')
     C                   EVAL      THLGID   = zhbgetvar('THLGID')
     C                   EVAL      THLGAU   = zhbgetvar('THLGAU')
     C                   EVAL      THLGAI   = zhbgetvar('THLGAI')
     C                   EVAL      THLGUN   = zhbgetvar('THLGUN')
     C                   EVAL      THLGTS   = zhbgetvar('THLGTS')
     C                   EVAL      THLGLA   = zhbgetvar('THLGLA')
     C                   EVAL      THLGLO   = zhbgetvar('THLGLO')
     C                   EVAL      WALFA18  = zhbgetvar('THKNE')
     C                   EVAL      THKNE    = c2n2(WALFA18)
     C                   EVAL      THTINE   = zhbgetvar('THTINE')
     C                   EVAL      THADE1   = zhbgetvar('THADE1')
     C                   EVAL      THPNE    = zhbgetvar('THPNE')
     C                   EVAL      THPSE    = zhbgetvar('THPSE')
     C                   EVAL      THLKE    = zhbgetvar('THLKE')
     C                   EVAL      THADE2   = zhbgetvar('THADE2')
     C                   EVAL      THPNE2   = zhbgetvar('THPNE2')
     C                   EVAL      THLKE2   = zhbgetvar('THLKE2')
     C                   EVAL      THCPE    = zhbgetvar('THCPE')
     C                   EVAL      THTLE    = zhbgetvar('THTLE')
     C                   EVAL      THEME    = zhbgetvar('THEME')
     C                   EVAL      THLKR1   = zhbgetvar('THLKR1')
     C                   EVAL      THLKR2   = zhbgetvar('THLKR2')
     C                   EVAL      THLKR3   = zhbgetvar('THLKR3')
     C                   EVAL      THLKR4   = zhbgetvar('THLKR4')
     C                   EVAL      THLKR5   = zhbgetvar('THLKR5')
     C                   EVAL      THLKR6   = zhbgetvar('THLKR6')
     C                   EVAL      THTGTS   = zhbgetvar('THTGTS')
     C                   EVAL      WALFA18  = zhbgetvar('THTRMG')
     C                   EVAL      THTRMG   = c2n2(WALFA18)
     C                   EVAL      THTGCN   = zhbgetvar('THTGCN')
     C                   EVAL      THLSUN   = zhbgetvar('THLSUN')
     C                   EVAL      THLSLK   = zhbgetvar('THLSLK')
     C                   EVAL      THLSNA   = zhbgetvar('THLSNA')
     C                   EVAL      THLOUN   = zhbgetvar('THLOUN')
     C                   EVAL      THLOLK   = zhbgetvar('THLOLK')
     C                   EVAL      THLONA   = zhbgetvar('THLONA')
     C                   EVAL      THPDTY   = zhbgetvar('THPDTY')
     C                   EVAL      THPDRF   = zhbgetvar('THPDRF')
     C                   EVAL      THPDIN   = zhbgetvar('THPDIN')
     C                   EVAL      THSDTY   = zhbgetvar('THSDTY')
     C                   EVAL      THSDRF   = zhbgetvar('THSDRF')
     C                   EVAL      WALFA18  = zhbgetvar('THSDLN')
     C                   EVAL      THSDLN   = c2n2(WALFA18)
     C                   EVAL      THSDIN   = zhbgetvar('THSDIN')
     C                   EVAL      THTDTY   = zhbgetvar('THTDTY')
     C                   EVAL      THTDRF   = zhbgetvar('THTDRF')
     C                   EVAL      THADTY   = zhbgetvar('THADTY')
     C                   EVAL      THADRF   = zhbgetvar('THADRF')
     C                   EVAL      THAICD   = zhbgetvar('THAICD')
     C                   EVAL      THAITX   = zhbgetvar('THAITX')
     C                   EVAL      THTRMP   = zhbgetvar('THTRMP')
     C                   EVAL      THVERS   = zhbgetvar('THVERS')
     c                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C  N50BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end
      *
     C     SVXHKey       klist
     C                   kfld                    THAVD
     C                   kfld                    THTDN
     C     SVXHKeyG      klist
     C                   kfld                    GM_THAVD
     C                   kfld                    GM_THTDN
     C     FRIKEY        klist
     C                   kfld                    THAVD
     C                   kfld                    THTDN
     C                   KFLD                    WFSKODE           3
     C     FRIKEY01      KLIST
     C                   KFLD                    WFSKODE
     C                   KFLD                    THXREF

     C     *LIKE         DEFINE    X_THAVD       GM_THAVD
     C     *LIKE         DEFINE    X_THTDN       GM_THTDN
     C                   EVAL      WFSKODE='*CE'
      *
     C   50              eval      Error = 'Invalid userID'
N04  C  N50              OPEN      SVXGH
     C  N50              OPEN      SVXH
     C  N50              OPEN      SVXHFV
     C  N50              OPEN      SVXSTD
     C  N50              OPEN      SVTHA
     C  N50              OPEN      SVTHA2
     C  N50              OPEN      FRISOK
     C  N50              OPEN      FRISOL01
     C  N50              OPEN      HEADF
     C  N50              OPEN      SVEH
N03  C  N50              OPEN      EDIC
N03  C  N50              OPEN      SVTFI
N03  C  N50              OPEN      EDIM
N03   * Hæmta firmaupplysningar
N03  C  N501             CHAIN     SVTFI                              51
N03   * Åpne dataarea
N03  C     *DTAARA       DEFINE                  EDIDTA
N03  C                   IN        EDIDTA
N03   * Hæmta næsta meddelandenummer
N03  C                   IF        WMODE='S'
N03  C                   IF        *IN50=*OFF
N03  C     1             CHAIN     EDIC                               51
N03  C                   ADD       1             CMN
N03  C                   UPDATE    EDICR
N03  C                   ENDIF
N03  C                   ENDIF
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C  N50THSG          CHAIN     SVTHA                              33
     C                   MOVEL     SVTH_NAMN     THTARF
      * MODE=GS
     C     WMODE         IFEQ      'GS'
     C     THXREF        ANDNE     *BLANKS
     C     *IN50         ANDEQ     *OFF
     C     FRIKEY01      CHAIN     FRISOL01                           56
     C                   IF        *IN56=*OFF
     C                   EVAL      THAVD=FSAVD
     C                   EVAL      THTDN=FSOPD
     C                   ENDIF
     C                   ENDIF


     c                   endsr
      *
      *______________________________________________________
      * TEST                                             TEST
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TEST          BEGSR
      * Hæmta userid
     C     WSUSER        CHAIN     SVTHA2
      * Hæmta ærende
     C     WMODE         IFNE      'A'
     C     SVXHKey       CHAIN     SVXH                               55
     C     SVXHKey       CHAIN     SVXHFV                             34
N01  C                   ELSE
N01  C                   EVAL      *IN55 = *ON
     C                   ENDIF
      * MODE A=Add  D=Delete  U=Update GS=Hæmta från SYSPED
     C                   SELECT
     C     WMODE         WHENEQ    'A'
     C                   eval      Error = *blanks
     C                   EXSR      SRA
     C     WMODE         WHENEQ    'GS'
     C                   eval      Error = *blanks
     C  N55              eval      Error = 'Fel, finns redan'
     C   55              EXSR      SRGS
     C     WMODE         WHENEQ    'C'                                                 f
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   UPDATE    SVXHR
     C  N34              UPDATE    SVXHFVR
     C   34              WRITE     SVXHFVR
     C                   eval      Error = *blanks
     C                   EXSR      SRC
     C                   ENDIF
     C     WMODE         WHENEQ    'D'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRD
     C                   ENDIF
     C     WMODE         WHENEQ    'S'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRS
     C                   ENDIF
     C     WMODE         WHENEQ    'U'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRU
     C                   ENDIF
     C                   OTHER
N01  C  N55              UPDATE    SVXHR
     C                   eval      Error = 'Wrong mode'
     C                   ENDSL
     C                   ENDSR
      *______________________________________________________
      * Add                                               SRA
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
     C                   CLEAR                   SVXHR
     C                   CLEAR                   SVXHFVR
      * Hæmta uppdragsnummer
     C     THAVD         CHAIN     SVXSTD                             52
     C                   EVAL      THTDN    = X_THTDN
     C                   ADD       1             X_THTDN
     C                   UPDATE    SVXSTDR
     C                   EVAL      X_THTDN  = THTDN
     C                   EVAL      THST     = ' '
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = WSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
      * Hæmta tullid
     C                   CALL      'SVG001R'
     C                   PARM                    WTUID            10
     C*                  PARM                    X_THTUID
     C                   MOVE      UYEAR         XÅR               2
     C                   EVAL      X_THTUID = 'SE' + XÅR + WTUID
      * Write
     C                   WRITE     SVXHR
     C*                  IF        X_THSIK>0
     C                   WRITE     SVXHFVR
     C*                  ENDIF
      * Oppdater WEB-variabler
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THST     = X_THST
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THNAA    = X_THNAA
     C                   EVAL      THADA1   = X_THADA1
     C                   EVAL      THPNA    = X_THPNA
     C                   EVAL      THPSA    = X_THPSA
     C                   EVAL      THLKA    = X_THLKA
     C                   EVAL      THSKA    = X_THSKA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THADS1   = X_THADS1
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THSKS    = X_THSKS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THADK1   = X_THADK1
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THSKK    = X_THSKK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THLSD    = X_THLSD
     C                   EVAL      THLASD   = X_THLASD
     C                   EVAL      THLAS2   = X_THLAS2
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTRMI   = X_THTRMI
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTASK   = X_THTASK
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGSK   = X_THTGSK
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THSKFD   = X_THSKFD
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THDDT    = X_THDDT
     C                   IF        THDDT    > *ZEROS
     C                   EXSR      SRDATPLU
     C                   ENDIF
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THDFSK   = X_THDFSK
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKSK   = X_THDKSK
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THGBGI   = X_THGBGI
     C                   EVAL      THGBGU   = X_THGBGU
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THDSK    = X_THDSK
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
     C                   EVAL      THSGDK   = X_THSGDK
     C                   EVAL      THSGUT   = X_THSGUT
     C                   EVAL      THSGID   = X_THSGID
     C                   EVAL      THSGDT   = X_THSGDT
     C                   EVAL      THBYTE   = X_THBYTE
     C                   EVAL      THSIK    = X_THSIK
     C                   EVAL      THDTA    = X_THDTA
     C                   EVAL      THTMA    = X_THTMA
     C                   EVAL      THSPOM   = X_THSPOM
     C                   EVAL      THTKBM   = X_THTKBM
     C                   EVAL      THKREF   = X_THKREF
     C                   EVAL      THTREF   = X_THTREF
     C                   EVAL      THLOSD   = X_THLOSD
     C                   EVAL      THLOSDSK = X_THLOSDSK
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THLKR7   = X_THLKR7
     C                   EVAL      THLKR8   = X_THLKR8
     C                   EVAL      THKNSS   = X_THKNSS
     C                   EVAL      THNASS   = X_THNASS
     C                   EVAL      THADSS1  = X_THADSS1
     C                   EVAL      THPNSS   = X_THPNSS
     C                   EVAL      THPSSS   = X_THPSSS
     C                   EVAL      THLKSS   = X_THLKSS
     C                   EVAL      THSKSS   = X_THSKSS
     C                   EVAL      THTINSS  = X_THTINSS
     C                   EVAL      THKNKS   = X_THKNKS
     C                   EVAL      THNAKS   = X_THNAKS
     C                   EVAL      THADKS1  = X_THADKS1
     C                   EVAL      THPNKS   = X_THPNKS
     C                   EVAL      THPSKS   = X_THPSKS
     C                   EVAL      THLKKS   = X_THLKKS
     C                   EVAL      THSKKS   = X_THSKKS
     C                   EVAL      THTINKS  = X_THTINKS
     C                   EVAL      THKNT    = X_THKNT
     C                   EVAL      THNAT    = X_THNAT
     C                   EVAL      THADT1   = X_THADT1
     C                   EVAL      THPNT    = X_THPNT
     C                   EVAL      THPST    = X_THPST
     C                   EVAL      THLKT    = X_THLKT
     C                   EVAL      THSKT    = X_THSKT
     C                   EVAL      THTINT   = X_THTINT
     C                   EVAL      THDKT    = X_THDKT
     C                   EVAL      THTIRN   = X_THTIRN
     C                   EVAL      THSECU   = X_THSECU
     C                   EVAL      THRDIN   = X_THRDIN
     C                   EVAL      THSCIN   = X_THSCIN
     C                   EVAL      THCLKD   = X_THCLKD
     C                   EVAL      THBINI   = X_THBINI
     C                   EVAL      THLIDT   = X_THLIDT
     C                   EVAL      THATYP   = X_THATYP
     C                   EVAL      THAREF   = X_THAREF
     C                   EVAL      THETA1   = X_THETA1
     C                   EVAL      THETAT1  = X_THETAT1
     C                   EVAL      THETA2   = X_THETA2
     C                   EVAL      THETAT2  = X_THETAT2
     C                   EVAL      THETA3   = X_THETA3
     C                   EVAL      THETAT3  = X_THETAT3
     C                   EVAL      THETA4   = X_THETA4
     C                   EVAL      THETAT4  = X_THETAT4
     C                   EVAL      THETA5   = X_THETA5
     C                   EVAL      THETAT5  = X_THETAT5
     C                   EVAL      THETA6   = X_THETA6
     C                   EVAL      THETAT6  = X_THETAT6
     C                   EVAL      THETA7   = X_THETA7
     C                   EVAL      THETAT7  = X_THETAT7
     C                   EVAL      THETA8   = X_THETA8
     C                   EVAL      THETAT8  = X_THETAT8
     C                   EVAL      THTSDE   = X_THTSDE
     C                   EVAL      THKNH    = X_THKNH
     C                   EVAL      THTINH   = X_THTINH
     C                   EVAL      THTIRH   = X_THTIRH
     C                   EVAL      THNAH    = X_THNAH
     C                   EVAL      THAD1H   = X_THAD1H
     C                   EVAL      THPNH    = X_THPNH
     C                   EVAL      THPSH    = X_THPSH
     C                   EVAL      THLKH    = X_THLKH
     C                   EVAL      THCPH    = X_THCPH
     C                   EVAL      THTLH    = X_THTLH
     C                   EVAL      THEMH    = X_THEMH
     C                   EVAL      THSTA    = X_THSTA
     C                   EVAL      THCPA    = X_THCPA
     C                   EVAL      THTLA    = X_THTLA
     C                   EVAL      THEMA    = X_THEMA
     C                   EVAL      THTMIN   = X_THTMIN
     C                   EVAL      THTMGR   = X_THTMGR
     C                   EVAL      THUCR    = X_THUCR
     C                   EVAL      THTINC   = X_THTINC
     C                   EVAL      THKNC    = X_THKNC
     C                   EVAL      THNAC    = X_THNAC
     C                   EVAL      THTLC    = X_THTLC
     C                   EVAL      THEMC    = X_THEMC
     C                   EVAL      THCPS    = X_THCPS
     C                   EVAL      THTLS    = X_THTLS
     C                   EVAL      THEMS    = X_THEMS
     C                   EVAL      THROLE   = X_THROLE
     C                   EVAL      THIDR    = X_THIDR
     C                   EVAL      THCNR    = X_THCNR
     C                   EVAL      THGINR   = X_THGINR
     C                   EVAL      THLGTY   = X_THLGTY
     C                   EVAL      THLGID   = X_THLGID
     C                   EVAL      THLGAU   = X_THLGAU
     C                   EVAL      THLGAI   = X_THLGAI
     C                   EVAL      THLGUN   = X_THLGUN
     C                   EVAL      THLGTS   = X_THLGTS
     C                   EVAL      THLGLA   = X_THLGLA
     C                   EVAL      THLGLO   = X_THLGLO
     C                   EVAL      THKNE    = X_THKNE
     C                   EVAL      THTINE   = X_THTINE
     C                   EVAL      THADE1   = X_THADE1
     C                   EVAL      THPNE    = X_THPNE
     C                   EVAL      THPSE    = X_THPSE
     C                   EVAL      THLKE    = X_THLKE
     C                   EVAL      THADE2   = X_THADE2
     C                   EVAL      THPNE2   = X_THPNE2
     C                   EVAL      THLKE2   = X_THLKE2
     C                   EVAL      THCPE    = X_THCPE
     C                   EVAL      THTLE    = X_THTLE
     C                   EVAL      THEME    = X_THEME
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THTGTS   = X_THTGTS
     C                   EVAL      THTRMG   = X_THTRMG
     C                   EVAL      THTGCN   = X_THTGCN
     C                   EVAL      THLSUN   = X_THLSUN
     C                   EVAL      THLSLK   = X_THLSLK
     C                   EVAL      THLSNA   = X_THLSNA
     C                   EVAL      THLOUN   = X_THLOUN
     C                   EVAL      THLOLK   = X_THLOLK
     C                   EVAL      THLONA   = X_THLONA
     C                   EVAL      THPDTY   = X_THPDTY
     C                   EVAL      THPDRF   = X_THPDRF
     C                   EVAL      THPDIN   = X_THPDIN
     C                   EVAL      THSDTY   = X_THSDTY
     C                   EVAL      THSDRF   = X_THSDRF
     C                   EVAL      THSDLN   = X_THSDLN
     C                   EVAL      THSDIN   = X_THSDIN
     C                   EVAL      THTDTY   = X_THTDTY
     C                   EVAL      THTDRF   = X_THTDRF
     C                   EVAL      THADTY   = X_THADTY
     C                   EVAL      THADRF   = X_THADRF
     C                   EVAL      THAICD   = X_THAICD
     C                   EVAL      THAITX   = X_THAITX
     C                   EVAL      THTRMP   = X_THTRMP
     C                   EVAL      THVERS   = X_THVERS
      *
     C                   ENDSR
      *______________________________________________________
      * Copy                                              SRC
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRC           BEGSR
     C                   EVAL      WSIGN = X_THSG
      * Hæmta uppdragsnummer
     C     NEWAVD        CHAIN     SVXSTD                             52
     C                   EVAL      NEWOPD   = X_THTDN
     C                   ADD       1             X_THTDN
     C                   UPDATE    SVXSTDR
      *
     C                   EVAL      GM_THAVD = THAVD
     C                   EVAL      GM_THTDN = THTDN
     C     SVXHKeyG      CHAIN(N)  SVXH                               55
     C     SVXHKeyG      CHAIN(N)  SVXHFV                             34
     C                   EVAL      X_THAVD  = NEWAVD
     C                   EVAL      X_THTDN  = NEWOPD
     C                   EVAL      THAVD    = NEWAVD
     C                   EVAL      THTDN    = NEWOPD
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = NEWSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
     C                   EVAL      X_THTRNR = *BLANKS
     C                   EVAL      X_THTRDT = 0
     C                   EVAL      X_THOMD  = 0
     C                   EVAL      X_THBIND = *BLANKS
     C                   EVAL      X_THMF   = *BLANKS
     C                   EVAL      X_THMP   = 0
     C                   EVAL      X_THSGDK = *BLANKS
     C                   EVAL      X_THSGME = *BLANKS
     C                   EVAL      X_THSGUT = *BLANKS
     C                   EVAL      X_THSGID = *BLANKS
     C                   EVAL      X_THSGDT = *BLANKS
     C                   EVAL      X_THBYTE = 0
      * Hæmta tullid
     C                   CALL      'SVG001R'
     C                   PARM                    WTUID            10
     C                   MOVE      UYEAR         XÅR               2
     C                   EVAL      X_THTUID = 'SE' + XÅR + WTUID
      * Write
     C                   WRITE     SVXHR
     C*                  IF        X_THSIK>0
     C                   WRITE     SVXHFVR
     C*                  ENDIF
N04   * Legg inn nytt garantibeløp
N04  C                   IF        X_THGFT1 <> *BLANKS AND
N04  C                             (X_THGKD <= 1 OR X_THGKD >= 6)
N06  C                   IF        X_THGBL < 0
N06  C                   Z-SUB     X_THGBL       X_THGBL
N06  C                   ENDIF
N06  C                   IF        X_THGBL > 0
N04  C     X_THGFT1      CHAIN     SVXGH                              30
N04  C  N30              EVAL      TGGBLB = TGGBLB + X_THGBL
N04  C  N30              UPDATE    SVXGHR
N06  C                   ENDIF
N04  C                   END
N04   *
      * Oppdater WEB-variabler
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THST     = X_THST
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THNAA    = X_THNAA
     C                   EVAL      THADA1   = X_THADA1
     C                   EVAL      THPNA    = X_THPNA
     C                   EVAL      THPSA    = X_THPSA
     C                   EVAL      THLKA    = X_THLKA
     C                   EVAL      THSKA    = X_THSKA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THADS1   = X_THADS1
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THSKS    = X_THSKS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THADK1   = X_THADK1
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THSKK    = X_THSKK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THLSD    = X_THLSD
     C                   EVAL      THLASD   = X_THLASD
     C                   EVAL      THLAS2   = X_THLAS2
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTRMI   = X_THTRMI
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTASK   = X_THTASK
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGSK   = X_THTGSK
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THSKFD   = X_THSKFD
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THDDT    = X_THDDT
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THDFSK   = X_THDFSK
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKSK   = X_THDKSK
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THGBGI   = X_THGBGI
     C                   EVAL      THGBGU   = X_THGBGU
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THDSK    = X_THDSK
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
     C                   EVAL      THSGDK   = X_THSGDK
     C                   EVAL      THSGUT   = X_THSGUT
     C                   EVAL      THSGID   = X_THSGID
     C                   EVAL      THSGDT   = X_THSGDT
     C                   EVAL      THBYTE   = X_THBYTE
     C                   EVAL      THSIK    = X_THSIK
     C                   EVAL      THDTA    = X_THDTA
     C                   EVAL      THTMA    = X_THTMA
     C                   EVAL      THSPOM   = X_THSPOM
     C                   EVAL      THTKBM   = X_THTKBM
     C                   EVAL      THKREF   = X_THKREF
     C                   EVAL      THTREF   = X_THTREF
     C                   EVAL      THLOSD   = X_THLOSD
     C                   EVAL      THLOSDSK = X_THLOSDSK
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THLKR7   = X_THLKR7
     C                   EVAL      THLKR8   = X_THLKR8
     C                   EVAL      THKNSS   = X_THKNSS
     C                   EVAL      THNASS   = X_THNASS
     C                   EVAL      THADSS1  = X_THADSS1
     C                   EVAL      THPNSS   = X_THPNSS
     C                   EVAL      THPSSS   = X_THPSSS
     C                   EVAL      THLKSS   = X_THLKSS
     C                   EVAL      THSKSS   = X_THSKSS
     C                   EVAL      THTINSS  = X_THTINSS
     C                   EVAL      THKNKS   = X_THKNKS
     C                   EVAL      THNAKS   = X_THNAKS
     C                   EVAL      THADKS1  = X_THADKS1
     C                   EVAL      THPNKS   = X_THPNKS
     C                   EVAL      THPSKS   = X_THPSKS
     C                   EVAL      THLKKS   = X_THLKKS
     C                   EVAL      THSKKS   = X_THSKKS
     C                   EVAL      THTINKS  = X_THTINKS
     C                   EVAL      THKNT    = X_THKNT
     C                   EVAL      THNAT    = X_THNAT
     C                   EVAL      THADT1   = X_THADT1
     C                   EVAL      THPNT    = X_THPNT
     C                   EVAL      THPST    = X_THPST
     C                   EVAL      THLKT    = X_THLKT
     C                   EVAL      THSKT    = X_THSKT
     C                   EVAL      THTINT   = X_THTINT
     C                   EVAL      THDKT    = X_THDKT
     C                   EVAL      THTIRN   = X_THTIRN
     C                   EVAL      THSECU   = X_THSECU
     C                   EVAL      THRDIN   = X_THRDIN
     C                   EVAL      THSCIN   = X_THSCIN
     C                   EVAL      THCLKD   = X_THCLKD
     C                   EVAL      THBINI   = X_THBINI
     C                   EVAL      THLIDT   = X_THLIDT
     C                   EVAL      THATYP   = X_THATYP
     C                   EVAL      THAREF   = X_THAREF
     C                   EVAL      THETA1   = X_THETA1
     C                   EVAL      THETAT1  = X_THETAT1
     C                   EVAL      THETA2   = X_THETA2
     C                   EVAL      THETAT2  = X_THETAT2
     C                   EVAL      THETA3   = X_THETA3
     C                   EVAL      THETAT3  = X_THETAT3
     C                   EVAL      THETA4   = X_THETA4
     C                   EVAL      THETAT4  = X_THETAT4
     C                   EVAL      THETA5   = X_THETA5
     C                   EVAL      THETAT5  = X_THETAT5
     C                   EVAL      THETA6   = X_THETA6
     C                   EVAL      THETAT6  = X_THETAT6
     C                   EVAL      THETA7   = X_THETA7
     C                   EVAL      THETAT7  = X_THETAT7
     C                   EVAL      THETA8   = X_THETA8
     C                   EVAL      THETAT8  = X_THETAT8
     C                   EVAL      THTSDE   = X_THTSDE
     C                   EVAL      THKNH    = X_THKNH
     C                   EVAL      THTINH   = X_THTINH
     C                   EVAL      THTIRH   = X_THTIRH
     C                   EVAL      THNAH    = X_THNAH
     C                   EVAL      THAD1H   = X_THAD1H
     C                   EVAL      THPNH    = X_THPNH
     C                   EVAL      THPSH    = X_THPSH
     C                   EVAL      THLKH    = X_THLKH
     C                   EVAL      THCPH    = X_THCPH
     C                   EVAL      THTLH    = X_THTLH
     C                   EVAL      THEMH    = X_THEMH
     C                   EVAL      THSTA    = X_THSTA
     C                   EVAL      THCPA    = X_THCPA
     C                   EVAL      THTLA    = X_THTLA
     C                   EVAL      THEMA    = X_THEMA
     C                   EVAL      THTMIN   = X_THTMIN
     C                   EVAL      THTMGR   = X_THTMGR
     C                   EVAL      THUCR    = X_THUCR
     C                   EVAL      THTINC   = X_THTINC
     C                   EVAL      THKNC    = X_THKNC
     C                   EVAL      THNAC    = X_THNAC
     C                   EVAL      THTLC    = X_THTLC
     C                   EVAL      THEMC    = X_THEMC
     C                   EVAL      THCPS    = X_THCPS
     C                   EVAL      THTLS    = X_THTLS
     C                   EVAL      THEMS    = X_THEMS
     C                   EVAL      THROLE   = X_THROLE
     C                   EVAL      THIDR    = X_THIDR
     C                   EVAL      THCNR    = X_THCNR
     C                   EVAL      THGINR   = X_THGINR
     C                   EVAL      THLGTY   = X_THLGTY
     C                   EVAL      THLGID   = X_THLGID
     C                   EVAL      THLGAU   = X_THLGAU
     C                   EVAL      THLGAI   = X_THLGAI
     C                   EVAL      THLGUN   = X_THLGUN
     C                   EVAL      THLGTS   = X_THLGTS
     C                   EVAL      THLGLA   = X_THLGLA
     C                   EVAL      THLGLO   = X_THLGLO
     C                   EVAL      THKNE    = X_THKNE
     C                   EVAL      THTINE   = X_THTINE
     C                   EVAL      THADE1   = X_THADE1
     C                   EVAL      THPNE    = X_THPNE
     C                   EVAL      THPSE    = X_THPSE
     C                   EVAL      THLKE    = X_THLKE
     C                   EVAL      THADE2   = X_THADE2
     C                   EVAL      THPNE2   = X_THPNE2
     C                   EVAL      THLKE2   = X_THLKE2
     C                   EVAL      THCPE    = X_THCPE
     C                   EVAL      THTLE    = X_THTLE
     C                   EVAL      THEME    = X_THEME
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THTGTS   = X_THTGTS
     C                   EVAL      THTRMG   = X_THTRMG
     C                   EVAL      THTGCN   = X_THTGCN
     C                   EVAL      THLSUN   = X_THLSUN
     C                   EVAL      THLSLK   = X_THLSLK
     C                   EVAL      THLSNA   = X_THLSNA
     C                   EVAL      THLOUN   = X_THLOUN
     C                   EVAL      THLOLK   = X_THLOLK
     C                   EVAL      THLONA   = X_THLONA
     C                   EVAL      THPDTY   = X_THPDTY
     C                   EVAL      THPDRF   = X_THPDRF
     C                   EVAL      THPDIN   = X_THPDIN
     C                   EVAL      THSDTY   = X_THSDTY
     C                   EVAL      THSDRF   = X_THSDRF
     C                   EVAL      THSDLN   = X_THSDLN
     C                   EVAL      THSDIN   = X_THSDIN
     C                   EVAL      THTDTY   = X_THTDTY
     C                   EVAL      THTDRF   = X_THTDRF
     C                   EVAL      THADTY   = X_THADTY
     C                   EVAL      THADRF   = X_THADRF
     C                   EVAL      THAICD   = X_THAICD
     C                   EVAL      THAITX   = X_THAITX
     C                   EVAL      THTRMP   = X_THTRMP
     C                   EVAL      THVERS   = X_THVERS
      * Kopiera också varuposter
     C                   OPEN      SVXV
     C                   OPEN      SVXVAM
     C                   OPEN      SVXVVT
     C                   OPEN      SVXVDK
     C                   OPEN      SVXVCN
     C                   OPEN      SVXVMN

     C     SVXHKeyG      SETLL     SVXV
     C     SVXHKeyG      READE     SVXV                                   52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVR
     C     SVXHKeyG      READE     SVXV                                   52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVAM
     C     SVXHKeyG      READE     SVXVAM                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVAMR
     C     SVXHKeyG      READE     SVXVAM                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVVT
     C     SVXHKeyG      READE     SVXVVT                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVVTR
     C     SVXHKeyG      READE     SVXVVT                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVDK
     C     SVXHKeyG      READE     SVXVDK                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVDKR
     C     SVXHKeyG      READE     SVXVDK                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVCN
     C     SVXHKeyG      READE     SVXVCN                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVCNR
     C     SVXHKeyG      READE     SVXVCN                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVMN
     C     SVXHKeyG      READE     SVXVMN                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVMNR
     C     SVXHKeyG      READE     SVXVMN                                 52
     C                   ENDDO

     C                   CLOSE     SVXV
     C                   CLOSE     SVXVAM
     C                   CLOSE     SVXVVT
     C                   CLOSE     SVXVDK
     C                   CLOSE     SVXVCN
     C                   CLOSE     SVXVMN

     C                   ENDSR
      *______________________________________________________
      * Delete                                            SRD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C                   EVAL      X_THST    = 'D'
     C                   EVAL      THST      = 'D'
     C                   UPDATE    SVXHR
     C  N34              UPDATE    SVXHFVR
     C   34              WRITE     SVXHFVR
     C                   ENDSR
      *______________________________________________________
      * Skicka                                            SRS
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRS           BEGSR
     C                   eval      Error = *blanks
     C                   UPDATE    SVXHR
     C  N34              UPDATE    SVXHFVR
      * Skapa edifact + fil
     C                   CALL      'SVX013R'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM      '015'         X1N07             3
     C                   PARM                    UFLAGG            1 0
N03   * Ændra status
N03  C     SVXHKEY       CHAIN     SVXH
N03  C                   EVAL      X_THST='A'
N03  C                   UPDATE    SVXHR
N03   * Skriv til EDIM
N03  C                   CLEAR                   EDIMR
N03  C                   EVAL      M0004=SVTF_0004
N03  C                   EVAL      M0010=SVTF_0010
N03  C                   EVAL      M0035=SVTF_0035
N03  C                   MOVEL     X_THAVD       W0062            11
N03  C                   MOVE      X_THTDN       W0062
N03  C                   EVAL      M0062=W0062
N03  C                   EVAL      M0065='CUSDEC'
N03  C                   EVAL      M1001='STE'
N03  C                   EVAL      M1004=X_THTUID
N03  C                   EVAL      M0068=X_THTUID
N03  C                   EVAL      M1225=X_THMF
N03  C                   EVAL      M1N07=X_THMF
N03  C                   EVAL      MMN=CMN
N03  C                   EVAL      MSR='S'
N03  C                   MOVEL     WDT           MDT
N03  C                   MOVEL     WTM           MTM
N03  C                   EVAL      MAVD=X_THAVD
N03  C                   EVAL      MTDN=X_THTDN
N03
N03  C                   WRITE     EDIMR
     C                   ENDSR
      *______________________________________________________
      * Update                                            SRU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRU           BEGSR
N04   * Trekk gammelt garantibeløp
N04  C                   IF        X_THGFT1 <> *BLANKS AND
N04  C                             (X_THGKD <= 1 OR X_THGKD >= 6)
N06  C                   IF        X_THGBL > 0
N04  C     X_THGFT1      CHAIN     SVXGH                              30
N04  C  N30              EVAL      TGGBLB = TGGBLB - X_THGBL
N04  C  N30              UPDATE    SVXGHR
N06  C                   ENDIF
N04  C                   END
N04   *
     C                   EVAL      X_THSG   = THSG
     C                   EVAL      X_THST   = THST
      *                  EVAL      X_THDT   = THDT
      *                  EVAL      X_THTUID = THTUID
     C                   EVAL      X_THPRO  = THPRO
     C                   EVAL      X_THENKL = THENKL
     C                   EVAL      X_THDK   = THDK
     C                   EVAL      X_THKNA  = THKNA
     C                   EVAL      X_THNAA  = THNAA
     C                   EVAL      X_THADA1 = THADA1
     C                   EVAL      X_THPNA  = THPNA
     C                   EVAL      X_THPSA  = THPSA
     C                   EVAL      X_THLKA  = THLKA
     C                   EVAL      X_THSKA  = THSKA
     C                   EVAL      X_THTINA = THTINA
     C                   EVAL      X_THKNS  = THKNS
     C                   EVAL      X_THNAS  = THNAS
     C                   EVAL      X_THADS1 = THADS1
     C                   EVAL      X_THPNS  = THPNS
     C                   EVAL      X_THPSS  = THPSS
     C                   EVAL      X_THLKS  = THLKS
     C                   EVAL      X_THSKS  = THSKS
     C                   EVAL      X_THTINS = THTINS
     C                   EVAL      X_THKNK  = THKNK
     C                   EVAL      X_THNAK  = THNAK
     C                   EVAL      X_THADK1 = THADK1
     C                   EVAL      X_THPNK  = THPNK
     C                   EVAL      X_THPSK  = THPSK
     C                   EVAL      X_THLKK  = THLKK
     C                   EVAL      X_THSKK  = THSKK
     C                   EVAL      X_THTINK = THTINK
     C                   EVAL      X_THBLK  = THBLK
     C                   EVAL      X_THLSD  = THLSD
     C                   EVAL      X_THLASD = THLASD
     C                   EVAL      X_THLAS2 = THLAS2
     C                   EVAL      X_THALK  = THALK
     C                   EVAL      X_THTRM  = THTRM
     C                   EVAL      X_THTRMI = THTRMI
     C                   EVAL      X_THTAID = THTAID
     C                   EVAL      X_THTASK = THTASK
     C                   EVAL      X_THTALK = THTALK
     C                   EVAL      X_THTGID = THTGID
     C                   EVAL      X_THTGSK = THTGSK
     C                   EVAL      X_THTGLK = THTGLK
     C                   EVAL      X_THSKFD = THSKFD
     C                   EVAL      X_THCATS = THCATS
     C                   EVAL      X_THTSD1 = THTSD1
     C                   EVAL      X_THTSD2 = THTSD2
     C                   EVAL      X_THTSD3 = THTSD3
     C                   EVAL      X_THTSD4 = THTSD4
     C                   EVAL      X_THTSD5 = THTSD5
     C                   EVAL      X_THTSD6 = THTSD6
     C                   EVAL      X_THTSD7 = THTSD7
     C                   EVAL      X_THTSD8 = THTSD8
     C                   EVAL      X_THTSB  = THTSB
     C                   EVAL      X_THDDT  = THDDT
     C                   EVAL      X_THDFKD = THDFKD
     C                   EVAL      X_THDFSK = THDFSK
     C                   EVAL      X_THDKR  = THDKR
     C                   EVAL      X_THDANT = THDANT
     C                   EVAL      X_THDKAV = THDKAV
     C                   EVAL      X_THDKSK = THDKSK
     C                   EVAL      X_THGKD  = THGKD
     C                   EVAL      X_THGFT1 = THGFT1
     C                   EVAL      X_THGFT2 = THGFT2
     C                   EVAL      X_THGADK = THGADK
     C                   EVAL      X_THGBL  = THGBL
     C                   EVAL      X_THGVK  = THGVK
     C                   EVAL      X_THGBGI = THGBGI
     C                   EVAL      X_THGBGU = THGBGU
     C                   EVAL      X_THKDC  = THKDC
     C                   EVAL      X_THTSSD = THTSSD
     C                   EVAL      X_THTSN1 = THTSN1
     C                   EVAL      X_THTSN2 = THTSN2
     C                   EVAL      X_THTSPN = THTSPN
     C                   EVAL      X_THTSLK = THTSLK
     C                   EVAL      X_THTSSK = THTSSK
     C                   EVAL      X_THLSTL = THLSTL
     C                   EVAL      X_THVPOS = THVPOS
     C                   EVAL      X_THNTK  = THNTK
     C                   EVAL      X_THVKB  = THVKB
     C                   EVAL      X_THDST  = THDST
     C                   EVAL      X_THDSK  = THDSK
     C                   EVAL      X_THTARF = THTARF
     C                   EVAL      X_THWS   = THWS
     C                   EVAL      X_THTRNR = THTRNR
     C                   EVAL      X_THTRDT = THTRDT
     C                   EVAL      X_THOMD  = THOMD
     C                   EVAL      X_THBIND = THBIND
     C                   EVAL      X_THTET  = THTET
     C                   EVAL      X_THMF   = THMF
     C                   EVAL      X_THMP   = THMP
     C                   EVAL      X_THPKL  = THPKL
     C                   EVAL      X_THKDV  = THKDV
     C*                  EVAL      X_TH0035 = TH0035
     C*                  EVAL      X_THSGDK = THSGDK
     C*                  EVAL      X_THSGUT = THSGUT
     C*                  EVAL      X_THSGID = THSGID
     C*                  EVAL      X_THSGDT = THSGDT
     C*                  EVAL      X_THBYTE = THBYTE
     C                   EVAL      X_THSIK  =   THSIK
     C                   EVAL      X_THDTA  =   THDTA
     C                   EVAL      X_THTMA  =   THTMA
     C                   EVAL      X_THSPOM =   THSPOM
     C                   EVAL      X_THTKBM =   THTKBM
     C                   EVAL      X_THKREF =   THKREF
     C                   EVAL      X_THTREF =   THTREF
     C                   EVAL      X_THLOSD =   THLOSD
     C                   EVAL      X_THLOSDSK = THLOSDSK
     C                   EVAL      X_THLKR1 =   THLKR1
     C                   EVAL      X_THLKR2 =   THLKR2
     C                   EVAL      X_THLKR3 =   THLKR3
     C                   EVAL      X_THLKR4 =   THLKR4
     C                   EVAL      X_THLKR5 =   THLKR5
     C                   EVAL      X_THLKR6 =   THLKR6
     C                   EVAL      X_THLKR7 =   THLKR7
     C                   EVAL      X_THLKR8 =   THLKR8
     C                   EVAL      X_THKNSS =   THKNSS
     C                   EVAL      X_THNASS =   THNASS
     C                   EVAL      X_THADSS1=   THADSS1
     C                   EVAL      X_THPNSS =   THPNSS
     C                   EVAL      X_THPSSS =   THPSSS
     C                   EVAL      X_THLKSS =   THLKSS
     C                   EVAL      X_THSKSS =   THSKSS
     C                   EVAL      X_THTINSS=   THTINSS
     C                   EVAL      X_THKNKS =   THKNKS
     C                   EVAL      X_THNAKS =   THNAKS
     C                   EVAL      X_THADKS1=   THADKS1
     C                   EVAL      X_THPNKS =   THPNKS
     C                   EVAL      X_THPSKS =   THPSKS
     C                   EVAL      X_THLKKS =   THLKKS
     C                   EVAL      X_THSKKS =   THSKKS
     C                   EVAL      X_THTINKS=   THTINKS
     C                   EVAL      X_THKNT  =   THKNT
     C                   EVAL      X_THNAT  =   THNAT
     C                   EVAL      X_THADT1 =   THADT1
     C                   EVAL      X_THPNT  =   THPNT
     C                   EVAL      X_THPST  =   THPST
     C                   EVAL      X_THLKT  =   THLKT
     C                   EVAL      X_THSKT  =   THSKT
     C                   EVAL      X_THTINT =   THTINT
     C                   EVAL      X_THDKT  = THDKT
     C                   EVAL      X_THTIRN = THTIRN
     C                   EVAL      X_THSECU = THSECU
     C                   EVAL      X_THRDIN = THRDIN
     C                   EVAL      X_THSCIN = THSCIN
     C                   EVAL      X_THCLKD = THCLKD
     C                   EVAL      X_THBINI = THBINI
     C                   EVAL      X_THLIDT = THLIDT
     C                   EVAL      X_THATYP = THATYP
     C                   EVAL      X_THAREF = THAREF
     C                   EVAL      X_THETA1 = THETA1
     C                   EVAL      X_THETAT1= THETAT1
     C                   EVAL      X_THETA2 = THETA2
     C                   EVAL      X_THETAT2= THETAT2
     C                   EVAL      X_THETA3 = THETA3
     C                   EVAL      X_THETAT3= THETAT3
     C                   EVAL      X_THETA4 = THETA4
     C                   EVAL      X_THETAT4= THETAT4
     C                   EVAL      X_THETA5 = THETA5
     C                   EVAL      X_THETAT5= THETAT5
     C                   EVAL      X_THETA6 = THETA6
     C                   EVAL      X_THETAT6= THETAT6
     C                   EVAL      X_THETA7 = THETA7
     C                   EVAL      X_THETAT7= THETAT7
     C                   EVAL      X_THETA8 = THETA8
     C                   EVAL      X_THETAT8= THETAT8
     C                   EVAL      X_THTSDE = THTSDE
     C                   EVAL      X_THKNH  = THKNH
     C                   EVAL      X_THTINH = THTINH
     C                   EVAL      X_THTIRH = THTIRH
     C                   EVAL      X_THNAH  = THNAH
     C                   EVAL      X_THAD1H = THAD1H
     C                   EVAL      X_THPNH  = THPNH
     C                   EVAL      X_THPSH  = THPSH
     C                   EVAL      X_THLKH  = THLKH
     C                   EVAL      X_THCPH  = THCPH
     C                   EVAL      X_THTLH  = THTLH
     C                   EVAL      X_THEMH  = THEMH
     C                   EVAL      X_THSTA  = THSTA
     C                   EVAL      X_THCPA  = THCPA
     C                   EVAL      X_THTLA  = THTLA
     C                   EVAL      X_THEMA  = THEMA
     C                   EVAL      X_THTMIN = THTMIN
     C                   EVAL      X_THTMGR = THTMGR
     C                   EVAL      X_THUCR  = THUCR
     C                   EVAL      X_THTINC = THTINC
     C                   EVAL      X_THKNC  = THKNC
     C                   EVAL      X_THNAC  = THNAC
     C                   EVAL      X_THTLC  = THTLC
     C                   EVAL      X_THEMC  = THEMC
     C                   EVAL      X_THCPS  = THCPS
     C                   EVAL      X_THTLS  = THTLS
     C                   EVAL      X_THEMS  = THEMS
     C                   EVAL      X_THROLE = THROLE
     C                   EVAL      X_THIDR  = THIDR
     C                   EVAL      X_THCNR  = THCNR
     C                   EVAL      X_THGINR = THGINR
     C                   EVAL      X_THLGTY = THLGTY
     C                   EVAL      X_THLGID = THLGID
     C                   EVAL      X_THLGAU = THLGAU
     C                   EVAL      X_THLGAI = THLGAI
     C                   EVAL      X_THLGUN = THLGUN
     C                   EVAL      X_THLGTS = THLGTS
     C                   EVAL      X_THLGLA = THLGLA
     C                   EVAL      X_THLGLO = THLGLO
     C                   EVAL      X_THKNE  = THKNE
     C                   EVAL      X_THTINE = THTINE
     C                   EVAL      X_THADE1 = THADE1
     C                   EVAL      X_THPNE  = THPNE
     C                   EVAL      X_THPSE  = THPSE
     C                   EVAL      X_THLKE  = THLKE
     C                   EVAL      X_THADE2 = THADE2
     C                   EVAL      X_THPNE2 = THPNE2
     C                   EVAL      X_THLKE2 = THLKE2
     C                   EVAL      X_THCPE  = THCPE
     C                   EVAL      X_THTLE  = THTLE
     C                   EVAL      X_THEME  = THEME
     C                   EVAL      X_THLKR1 = THLKR1
     C                   EVAL      X_THLKR2 = THLKR2
     C                   EVAL      X_THLKR3 = THLKR3
     C                   EVAL      X_THLKR4 = THLKR4
     C                   EVAL      X_THLKR5 = THLKR5
     C                   EVAL      X_THLKR6 = THLKR6
     C                   EVAL      X_THTGTS = THTGTS
     C                   EVAL      X_THTRMG = THTRMG
     C                   EVAL      X_THTGCN = THTGCN
     C                   EVAL      X_THLSUN = THLSUN
     C                   EVAL      X_THLSLK = THLSLK
     C                   EVAL      X_THLSNA = THLSNA
     C                   EVAL      X_THLOUN = THLOUN
     C                   EVAL      X_THLOLK = THLOLK
     C                   EVAL      X_THLONA = THLONA
     C                   EVAL      X_THPDTY = THPDTY
     C                   EVAL      X_THPDRF = THPDRF
     C                   EVAL      X_THPDIN = THPDIN
     C                   EVAL      X_THSDTY = THSDTY
     C                   EVAL      X_THSDRF = THSDRF
     C                   EVAL      X_THSDLN = THSDLN
     C                   EVAL      X_THSDIN = THSDIN
     C                   EVAL      X_THTDTY = THTDTY
     C                   EVAL      X_THTDRF = THTDRF
     C                   EVAL      X_THADTY = THADTY
     C                   EVAL      X_THADRF = THADRF
     C                   EVAL      X_THAICD = THAICD
     C                   EVAL      X_THAITX = THAITX
     C                   EVAL      X_THTRMP = THTRMP
     C                   EVAL      X_THVERS = THVERS
     C                   UPDATE    SVXHR
     C  N34              UPDATE    SVXHFVR
     C   34              WRITE     SVXHFVR
N04   * Legg inn nytt garantibeløp
N04  C                   IF        X_THGFT1 <> *BLANKS AND
N04  C                             (X_THGKD <= 1 OR X_THGKD >= 6)
N06  C                   IF        X_THGBL > 0
N04  C     X_THGFT1      CHAIN     SVXGH                              30
N04  C  N30              EVAL      TGGBLB = TGGBLB + X_THGBL
N04  C  N30              UPDATE    SVXGHR
N06  C                   ENDIF
N04  C                   END
N04   *
     C                   ENDSR
      *______________________________________________________
      * Hæmta från Export eller SYSPED uppdrag           SRGS
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRGS          BEGSR
      * Finnes export ?
     C     SVXHKEY       CHAIN     SVEH                               53
      * Finnes SYSPED Oppdrag ?
     C     SVXHKEY       CHAIN     HEADF                              54
      * Fel, finns inte varken export eller sysped uppdrag
     C                   IF        *IN53
     C                   IF        *IN54
     C                   eval      Error = 'Order not found'
     C                   GOTO      SRGS9
     C                   ENDIF
     C                   ENDIF
      * Skapa gemensam information
     C                   CLEAR                   SVXHR
     C                   CLEAR                   SVXHFVR
     C     THAVD         CHAIN(N)  SVXSTD                             52
     C                   EVAL      X_THTDN  = THTDN
     C                   EVAL      THST     = ' '
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = WSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
     C                   MOVE      *ZEROS        X_THDDTK
     C                   MOVE      *BLANKS       X_THDATS
     C                   MOVE      *BLANKS       X_THDKAV
     C                   MOVE      *BLANKS       X_THDKSK

      * Hæmta tullid
     C                   CALL      'SVG001R'
     C                   PARM                    WTUID            10
     C                   MOVE      UYEAR         XÅR               2
     C                   EVAL      X_THTUID = 'SV' + XÅR + WTUID
      * Hæmta från SKAT Export
     C  N53              EXSR      SRGSS
      * Hæmta från SYSPED oppdrag
     C   53              EXSR      SRGSO
      * Write
     C                   WRITE     SVXHR
     C*                  IF        X_THSIK>0
     C                   WRITE     SVXHFVR
     C*                  ENDIF
      * Oppdater WEB-variabler
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THST     = X_THST
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THNAA    = X_THNAA
     C                   EVAL      THADA1   = X_THADA1
     C                   EVAL      THPNA    = X_THPNA
     C                   EVAL      THPSA    = X_THPSA
     C                   EVAL      THLKA    = X_THLKA
     C                   EVAL      THSKA    = X_THSKA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THADS1   = X_THADS1
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THSKS    = X_THSKS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THADK1   = X_THADK1
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THSKK    = X_THSKK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THLSD    = X_THLSD
     C                   EVAL      THLASD   = X_THLASD
     C                   EVAL      THLAS2   = X_THLAS2
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTRMI   = X_THTRMI
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTASK   = X_THTASK
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGSK   = X_THTGSK
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THSKFD   = X_THSKFD
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THDDT    = X_THDDT
     C                   IF        THDDT    > *ZEROS
     C                   EXSR      SRDATPLU
     C                   ENDIF
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THDFSK   = X_THDFSK
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKSK   = X_THDKSK
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THGBGI   = X_THGBGI
     C                   EVAL      THGBGU   = X_THGBGU
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THDSK    = X_THDSK
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
     C*                  EVAL      SVXH_0035= X_SVXH_0035
     C                   EVAL      THSGDK   = X_THSGDK
     C                   EVAL      THSGUT   = X_THSGUT
     C                   EVAL      THSGID   = X_THSGID
     C                   EVAL      THSGDT   = X_THSGDT
     C                   EVAL      THBYTE   = X_THBYTE
     C                   EVAL      THSIK    = X_THSIK
     C                   EVAL      THDTA    = X_THDTA
     C                   EVAL      THTMA    = X_THTMA
     C                   EVAL      THSPOM   = X_THSPOM
     C                   EVAL      THTKBM   = X_THTKBM
     C                   EVAL      THKREF   = X_THKREF
     C                   EVAL      THTREF   = X_THTREF
     C                   EVAL      THLOSD   = X_THLOSD
     C                   EVAL      THLOSDSK = X_THLOSDSK
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THLKR7   = X_THLKR7
     C                   EVAL      THLKR8   = X_THLKR8
     C                   EVAL      THKNSS   = X_THKNSS
     C                   EVAL      THNASS   = X_THNASS
     C                   EVAL      THADSS1  = X_THADSS1
     C                   EVAL      THPNSS   = X_THPNSS
     C                   EVAL      THPSSS   = X_THPSSS
     C                   EVAL      THLKSS   = X_THLKSS
     C                   EVAL      THSKSS   = X_THSKSS
     C                   EVAL      THTINSS  = X_THTINSS
     C                   EVAL      THKNKS   = X_THKNKS
     C                   EVAL      THNAKS   = X_THNAKS
     C                   EVAL      THADKS1  = X_THADKS1
     C                   EVAL      THPNKS   = X_THPNKS
     C                   EVAL      THPSKS   = X_THPSKS
     C                   EVAL      THLKKS   = X_THLKKS
     C                   EVAL      THSKKS   = X_THSKKS
     C                   EVAL      THTINKS  = X_THTINKS
     C                   EVAL      THKNT    = X_THKNT
     C                   EVAL      THNAT    = X_THNAT
     C                   EVAL      THADT1   = X_THADT1
     C                   EVAL      THPNT    = X_THPNT
     C                   EVAL      THPST    = X_THPST
     C                   EVAL      THLKT    = X_THLKT
     C                   EVAL      THSKT    = X_THSKT
     C                   EVAL      THTINT   = X_THTINT
     C                   EVAL      THDKT    = X_THDKT
     C                   EVAL      THTIRN   = X_THTIRN
     C                   EVAL      THSECU   = X_THSECU
     C                   EVAL      THRDIN   = X_THRDIN
     C                   EVAL      THSCIN   = X_THSCIN
     C                   EVAL      THCLKD   = X_THCLKD
     C                   EVAL      THBINI   = X_THBINI
     C                   EVAL      THLIDT   = X_THLIDT
     C                   EVAL      THATYP   = X_THATYP
     C                   EVAL      THAREF   = X_THAREF
     C                   EVAL      THETA1   = X_THETA1
     C                   EVAL      THETAT1  = X_THETAT1
     C                   EVAL      THETA2   = X_THETA2
     C                   EVAL      THETAT2  = X_THETAT2
     C                   EVAL      THETA3   = X_THETA3
     C                   EVAL      THETAT3  = X_THETAT3
     C                   EVAL      THETA4   = X_THETA4
     C                   EVAL      THETAT4  = X_THETAT4
     C                   EVAL      THETA5   = X_THETA5
     C                   EVAL      THETAT5  = X_THETAT5
     C                   EVAL      THETA6   = X_THETA6
     C                   EVAL      THETAT6  = X_THETAT6
     C                   EVAL      THETA7   = X_THETA7
     C                   EVAL      THETAT7  = X_THETAT7
     C                   EVAL      THETA8   = X_THETA8
     C                   EVAL      THETAT8  = X_THETAT8
     C                   EVAL      THTSDE   = X_THTSDE
     C                   EVAL      THKNH    = X_THKNH
     C                   EVAL      THTINH   = X_THTINH
     C                   EVAL      THTIRH   = X_THTIRH
     C                   EVAL      THNAH    = X_THNAH
     C                   EVAL      THAD1H   = X_THAD1H
     C                   EVAL      THPNH    = X_THPNH
     C                   EVAL      THPSH    = X_THPSH
     C                   EVAL      THLKH    = X_THLKH
     C                   EVAL      THCPH    = X_THCPH
     C                   EVAL      THTLH    = X_THTLH
     C                   EVAL      THEMH    = X_THEMH
     C                   EVAL      THSTA    = X_THSTA
     C                   EVAL      THCPA    = X_THCPA
     C                   EVAL      THTLA    = X_THTLA
     C                   EVAL      THEMA    = X_THEMA
     C                   EVAL      THTMIN   = X_THTMIN
     C                   EVAL      THTMGR   = X_THTMGR
     C                   EVAL      THUCR    = X_THUCR
     C                   EVAL      THTINC   = X_THTINC
     C                   EVAL      THKNC    = X_THKNC
     C                   EVAL      THNAC    = X_THNAC
     C                   EVAL      THTLC    = X_THTLC
     C                   EVAL      THEMC    = X_THEMC
     C                   EVAL      THCPS    = X_THCPS
     C                   EVAL      THTLS    = X_THTLS
     C                   EVAL      THEMS    = X_THEMS
     C                   EVAL      THROLE   = X_THROLE
     C                   EVAL      THIDR    = X_THIDR
     C                   EVAL      THCNR    = X_THCNR
     C                   EVAL      THGINR   = X_THGINR
     C                   EVAL      THLGTY   = X_THLGTY
     C                   EVAL      THLGID   = X_THLGID
     C                   EVAL      THLGAU   = X_THLGAU
     C                   EVAL      THLGAI   = X_THLGAI
     C                   EVAL      THLGUN   = X_THLGUN
     C                   EVAL      THLGTS   = X_THLGTS
     C                   EVAL      THLGLA   = X_THLGLA
     C                   EVAL      THLGLO   = X_THLGLO
     C                   EVAL      THKNE    = X_THKNE
     C                   EVAL      THTINE   = X_THTINE
     C                   EVAL      THADE1   = X_THADE1
     C                   EVAL      THPNE    = X_THPNE
     C                   EVAL      THPSE    = X_THPSE
     C                   EVAL      THLKE    = X_THLKE
     C                   EVAL      THADE2   = X_THADE2
     C                   EVAL      THPNE2   = X_THPNE2
     C                   EVAL      THLKE2   = X_THLKE2
     C                   EVAL      THCPE    = X_THCPE
     C                   EVAL      THTLE    = X_THTLE
     C                   EVAL      THEME    = X_THEME
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THTGTS   = X_THTGTS
     C                   EVAL      THTRMG   = X_THTRMG
     C                   EVAL      THTGCN   = X_THTGCN
     C                   EVAL      THLSUN   = X_THLSUN
     C                   EVAL      THLSLK   = X_THLSLK
     C                   EVAL      THLSNA   = X_THLSNA
     C                   EVAL      THLOUN   = X_THLOUN
     C                   EVAL      THLOLK   = X_THLOLK
     C                   EVAL      THLONA   = X_THLONA
     C                   EVAL      THPDTY   = X_THPDTY
     C                   EVAL      THPDRF   = X_THPDRF
     C                   EVAL      THPDIN   = X_THPDIN
     C                   EVAL      THSDTY   = X_THSDTY
     C                   EVAL      THSDRF   = X_THSDRF
     C                   EVAL      THSDLN   = X_THSDLN
     C                   EVAL      THSDIN   = X_THSDIN
     C                   EVAL      THTDTY   = X_THTDTY
     C                   EVAL      THTDRF   = X_THTDRF
     C                   EVAL      THADTY   = X_THADTY
     C                   EVAL      THADRF   = X_THADRF
     C                   EVAL      THAICD   = X_THAICD
     C                   EVAL      THAITX   = X_THAITX
     C                   EVAL      THTRMP   = X_THTRMP
     C                   EVAL      THVERS   = X_THVERS
     C     SRGS9         ENDSR
      *______________________________________________________
      * Hæmta från export                               SRGSS
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRGSS         BEGSR
     C                   EVAL      X_THKNS = SVEH_AVKN
     C                   EVAL      X_THNAS = SVEH_AVNA
     C                   EVAL      X_THADS1 = SVEH_AVA1
     C                   EVAL      X_THPNS  = SVEH_AVPN
     C                   EVAL      X_THPSS  = SVEH_AVPA
     C                   EVAL      X_THLKS  = SVEH_AVLK
     C                   EVAL      X_THTINS = SVEH_AVEO
     C                   EVAL      X_THKNK=SVEH_MOKN
     C                   EVAL      X_THNAK=SVEH_MONA
     C                   EVAL      X_THADK1=SVEH_MOA1
     C                   MOVEL     SVEH_MOPN     X_THPNK
     C                   MOVEL     SVEH_MOPA     X_THPSK
     C                   EVAL      X_THTINK=SVEH_MOEO
     C                   EVAL      X_THLKK=SVEH_MOLK

     C                   Z-ADD     SVEH_KOTA     X_THNTK
     C                   Z-ADD     SVEH_BRUT     X_THVKB

     C     SVEH_AUBE     IFNE      *BLANKS
     C                   MOVE      SVEH_AUBE     X_THBLK
     C                   ENDIF                                                   2<-E
     C     SVEH_TRID     IFNE      *BLANKS
     C     SVEH_TRLK     ORNE      *BLANKS
     C                   MOVEL     SVEH_TRID     X_THTGID
     C                   MOVE      SVEH_TRLK     X_THTGLK
     C                   MOVE      *BLANKS       X_THTGSK
     C                   MOVEL     SVEH_TRID     X_THTAID
     C                   MOVE      SVEH_TRLK     X_THTALK
     C                   MOVE      *BLANKS       X_THTASK
     C                   ENDIF
     C     SVEH_TRGR     IFNE      *BLANKS                                       2<-B
     C                   MOVE      SVEH_TRGR     X_THTRM
     C                   ENDIF                                                   2<-E
     C                   ENDSR
      *______________________________________________________
      * Hæmta från SYSPED Oppdrag                       SRGSO
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRGSO         BEGSR
     C                   EVAL      X_THKNS = HEKNS
     C                   EVAL      X_THNAS = HENAS
     C                   EVAL      X_THADS1 = HEADS1
     C                   EVAL      X_THPNS  = HEPNS
     C                   EVAL      X_THPSS  = HEADS3
     C                   EVAL      X_THLKS  = HELKS
     C                   EVAL      X_THKNK=HEKNK
     C                   EVAL      X_THNAK=HENAK
     C                   EVAL      X_THADK1=HEADK1
     C                   EVAL      X_THPNK=HEPNK
     C                   MOVEL     HEADK3        X_THPSK
     C                   EVAL      X_THLKK=HELKK

     C                   Z-ADD     HENT          X_THNTK
     C                   Z-ADD     HEVKT         X_THVKB
     C     SVEH_AUBE     IFNE      *BLANKS
     C                   MOVE      SVEH_AUBE     X_THBLK
     C                   ENDIF                                                   2<-E
     C     SVEH_TRID     IFNE      *BLANKS
     C     SVEH_TRLK     ORNE      *BLANKS
     C                   MOVEL     SVEH_TRID     X_THTGID
     C                   MOVE      SVEH_TRLK     X_THTGLK
     C                   MOVE      *BLANKS       X_THTGSK
     C                   MOVEL     SVEH_TRID     X_THTAID
     C                   MOVE      SVEH_TRLK     X_THTALK
     C                   MOVE      *BLANKS       X_THTASK
     C                   ENDIF
     C     SVEH_TRGR     IFNE      *BLANKS                                       2<-B
     C                   MOVE      SVEH_TRGR     X_THTRM
     C                   ENDIF                                                   2<-E

     C                   ENDSR
      *______________________________________________________
      * Räkna X antall dagar framåt                  SRDATPLU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRDATPLU      BEGSR
     C                   Z-ADD     THDDT         UANTDG
     C                   CALL      'SYFA20B'
     C                   PARM      *ZEROS        UINNDT            6 0
     C                   PARM                    UANTDG            3 0
     C                   PARM                    UUTDT             6 0          DDMMÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   EVAL      WDDMMAA=UUTDT
     C                   EVAL      WD=WDD
     C                   EVAL      WM=WMM
     C                   EVAL      WA=WAA
     C     WAMD          ADD       20000000      THDDT
     C                   ENDSR
