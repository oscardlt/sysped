     H DFTACTGRP(*NO) BNDDIR('BASE64')

      /copy qrpglesrc,ifsio_h
      /copy base64_h

     D fd              s             10i 0
     d filnam          s            256A   varying
     d Input64         s           4096A   Inz varying
     d Result          s          65535A   Inz varying
     D outlen          S             10I 0

      /free
       Input64=
        'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVIAAACWCAYAAA'
       +'CM2wD5AAAF1klEQVR4Xu3cQW5bQQxEQelGvqHtE8o3cqKss/j4Q6CBZnkdDc'
       +'Oi8BBv8vz9+/PwQ4AAAQK3BZ5CetvOBwkQIPBPQEh9EQgQIHAoIKSHgD5OgA'
       +'ABIfUdIECAwKGAkB4C+jgBAgSE1HeAAAEChwJCegjo4wQIEBBS3wECBAgcCg'
       +'jpIaCPEyBAQEh9BwgQIHAoIKSHgD5OgAABIfUdIECAwKGAkB4C+jgBAgSE1H'
       +'eAAAEChwKXQ/rx8fF4Pp+P1+t1ONLHCRAg0CVwOaTviL5//PelXV8A2xAgcC'
       +'5wOaTvf5G+f35+fs6neoEAAQJFApdD+r+d/bpf9E2wCgECtwWOQurX/dvuPk'
       +'iAQJHAUUj9ul/0TbAKAQK3BY5CenuqDxIgQKBIQEiLjmkVAgQyAkKacTeVAI'
       +'EiASEtOqZVCBDICAhpxt1UAgSKBIS06JhWIUAgIyCkGXdTCRAoEhDSomNahQ'
       +'CBjICQZtxNJUCgSEBIi45pFQIEMgJCmnE3lQCBIgEhLTqmVQgQyAgIacbdVA'
       +'UCBDICQppxN5UAgSIBIS06plUIEMgICGnG3VQCBIoEhLTomFYhQCAjIKQZd1'
       +'MJECgSENKiY1qFAIGMgJBm3E0lQKBIQEiLjmkVAgQyAkKacTeVAIEiASEtOq'
       +'ZVCBDICAhpxt1UAgSKBIS06JhWIUAgIyCkGXdTCRAoEhDSomNahQCBjICQZt'
       +'xNJUCgSEBIi45pFQIEMgJCmnE3lQCBIgEhLTqmVQgQyAgIacbdVAIEigSEtO'
       +'iYViFAICMgpBl3UwkQKBIQ0qJjWoUAgYyAkGbcTSVAoEhASIuOaRUCBDICQp'
       +'pxN5UAgSIBIS06plUIEMgICGnG3VQCBIoEhLTomFYhQCAjIKQZd1MJECgSEN'
       +'KiY1';
       Input64= %subst(Input64:23);

            filnam = '/syspeddev/temp/Testbase64_54.jpg';
            fd = open(filnam
                     : O_CREAT + O_WRONLY + O_CCSID
                     : S_IRUSR + S_IWUSR + S_IRWXU + S_IROTH + S_IXOTH
                     : 819 );
          // 2 første byte i en varying-variabel (t.om v5.4) inneholde info om lengde
          // OBS!! Fra 6.1 -> kan det være 2 el 4 byte - så da er det bedre med *data.. )
            %len(Result) = %size(Result) - 2;
            outlen = base64_decode( %addr(input64) + 2
                                  : %len(input64)
                                  : %addr(result) + 2
                                  : %len(result) );
            %len(result) = outlen;

            callp write(fd: %addr(result)+2: outlen);
            callp close(fd);
            return;
      /end-free



