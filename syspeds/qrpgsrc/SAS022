********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P8XXX * 01 SH  PTF8 OgsÂ lage innlands utskrift
********************************************************************
      *
     F********************************************************************
     F* genererer flyfrakt export  for SAS
     f* sonepriser er tatt ut
     F********************************************************************
     Fsted2     IF   E           k disk
     Fsas022fm  CF   E             WORKSTN
     Fairld     IF   E           k disk
     FLISTE     O    F  100        PRINTER OFLIND(*INOF)
      *Arrays for gebyrlinjer ved etterkrav
     D B               S              6  2 DIM(9)
     D                 DS
     D  st2nvn                 1     30
     D  stnavn                 1     20
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XUL≈≈                 13     14  0
     D                 DS
     D  ULDD                   1      2  0
     D  ULMM                   3      4  0
     D  UL≈≈                   5      6  0
     D  ULDT                   1      6  0
      *
N01  c     *entry        plist
N01  c                   parm                    utinn             1
     C     key           klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
      * HENT DATO/KLOKKESLETT
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XUL≈≈         UL≈≈
     C                   z-add     117           airlin
     c     start         tag
     C                   EXFMT     BILDE01
     c                   setoff                                       7030
     c     *in(03)       cabeq     '1'           slutt
      * test flyplass
     c                   movel     airpfr        airp5             5
     c     airpfr        comp      *blanks                                70
     c  N70airp5         chain     sted2                              70
     c  N70ST2lk         comp      'NO'                               7070
     c   70              seton                                        30
     C   70              MOVE      'SHU0869'     MSGNR
     c   70              goto      start
      *
      *
     c                   except    head
     c     key           setll     airld
     c     *in33         doweq     '0'
     c     les           tag
     c     key           reade     airld                                  33
     c     *in(33)       ifeq      '0'
     c                   movel     airpto        airp5             5
     c     airp5         chain     sted2                              34
     c
     c  n34st2lk         ifeq      'NO'
N01  c     utinn         andeq     'U'
     c                   goto      les
     c                   end
n01  c  n34st2lk         ifne      'NO'
N01  c     utinn         andeq     'I'
n01  c                   goto      les
n01  c                   end
     c     airpto        ifne      gmlpto
     c     gmlpto        andne     *blanks
     c     *inof         ifeq      '1'
     c                   except    head
     c                   move      '0'           *inof
     c                   end
     c                   move      *blanks       st2nvn
     c                   movel     gmlpto        airp5             5
     c     airp5         chain     sted2                              44
     c   44              movel     '*ukjent*'    st2nvn
     c                   except    det
     c                   clear                   b
     c                   end
     c     airccp        ifeq      ' '
     c                   exsr      general
     c                   end
     c     airccp        ifeq      'P'
     c                   exsr      priorit
     c                   end
     c                   move      airpto        gmlpto            3
     c                   end
     c                   end
     c     slutt         tag
     c                   seton                                        lr
     c                   return
     c*********************************************************
     c     general       begsr
     c*********************************************************
     c     aircod        ifeq      'N'
     c                   z-add     airgrn        b(1)
     c                   z-add     airawb        b(2)
     c                   end
     c     aircod        ifeq      'Q'
     c     airwei        ifeq      99
     c                   z-add     airawb        b(3)
     c                   end
     c     airwei        ifeq      499
     c                   z-add     airawb        b(4)
     c                   end
     c     airwei        ifeq      99999
     c                   z-add     airawb        b(5)
     c     b(4)          ifeq      *zeros
     c                   z-add     b(5)          b(4)
     c                   end
     c                   end
     c                   end
     c                   endsr
     c*********************************************************
     c     priorit       begsr
     c*********************************************************
     c     aircod        ifeq      'N'
     c                   z-add     airgrn        b(6)
     c                   z-add     airawb        b(7)
     c                   end
     c     aircod        ifeq      'Q'
     c     airwei        ifeq      99
     c                   z-add     airawb        b(8)
     c                   end
     c     airwei        ifeq      99999
     c                   z-add     airawb        b(9)
     c                   end
     c                   end
     c                   endsr
     OLISTE     E            head           1 03
     O                                           26 'Utskrift SAS priser fra:  '
     O                       airpfr              28
     O                                           60 'Dato:'
     O                       uldt          y     70
     OLISTE     E            head           1
     O                                           45 'SAS general cargo'
     O                                           77 'SAS priority cargo'
     OLISTE     E            head           1
     O                                           12 'flyplassnavn'
     O                                           24 'Kode'
     O                                           34 'Min'
     O                                           42 'N'
     O                                           50 'Q45'
     O                                           58 'Q100'
     O                                           66 'Q500'
     O                                           74 'Min'
     O                                           82 'N'
     O                                           90 'Q45'
     O                                           98 'Q100'
     OLISTE     E            head           1
     O                                           26 '--------------------------'
     O                                           52 '--------------------------'
     O                                           78 '--------------------------'
     O                                          100 '-----------------------'
     OLISTE     E            DET            1
     O                       STNAVN              20
     O                       GMLPTO              24
     O                       B(1)          4     34
     O                       B(2)          4     42
     O                       B(3)          4     50
     O                       B(4)          4     58
     O                       B(5)          4     66
     O                       B(6)          4     74
     O                       B(7)          4     82
     O                       B(8)          4     90
     O                       B(9)          4     98
