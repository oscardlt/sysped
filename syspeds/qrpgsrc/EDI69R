      *
     FEDI69D    CF   E             WORKSTN
     FEDIM      UF   E           K DISK
     FEDII      IF   E           K DISK
     D                 DS
     D  WDT                    1      6  0
     D  WDTM                   3      4  0
     D  WDTD                   5      6  0
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    MSN           WSN
     C     *LIKE         DEFINE    MMN           WMN
     C     *LIKE         DEFINE    *IN03         WIN03
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WMN
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     WMN           PARM                    WMN
     C                   PARM      *IN03         WIN03
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Endre melding                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     EDIM                               51
      *________
      * Bilde-1
      *""""""""
     C     SRB1          TAG
     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     EDI69DØ
     C                   EXFMT     EDI69DA
     C                   MOVEA     '000000'      *IN(30)
     C     *IN25         CABEQ     '1'           SRB2
     C     *IN03         CABEQ     '1'           SRB9
     C     *IN12         CABEQ     '1'           SRB9
      * Teste Deklarasjonens dato.
     C                   Z-ADD     M0068A        WDT
     C                   EXSR      SRDT
     C     *IN30         IFEQ      '1'
     C                   MOVE      '1'           *IN31
     C                   GOTO      SRB1
     C                   END
      * Teste NODI Avsender.
     C                   MOVEL     M0004         W0004            35
     C     W0004         CHAIN     EDII                               30
     C     *IN30         IFEQ      '1'
     C                   MOVE      '1'           *IN32
     C                   MOVE      'SPN0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   END
      * Teste NODI Mottaker.
     C                   MOVEL     M0010         W0010            35
     C     W0010         CHAIN     EDII                               30
     C     *IN30         IFEQ      '1'
     C                   MOVE      '1'           *IN33
     C                   MOVE      'SPN0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   END
      * Teste Omberegning Deklarasjonens dato.
     C     M0068D        IFGT      0
     C                   Z-ADD     M0068D        WDT
     C                   EXSR      SRDT
     C     *IN30         IFEQ      '1'
     C                   MOVE      '1'           *IN34
     C                   GOTO      SRB1
     C                   END
     C                   END
      * Teste Ønsket behandlingsdato.
     C     M2005B        IFGT      0
     C                   Z-ADD     M2005B        WDT
     C                   EXSR      SRDT
     C     *IN30         IFEQ      '1'
     C                   MOVE      '1'           *IN35
     C                   GOTO      SRB1
     C                   END
     C                   END
     C                   UPDATE    EDIMR
      *________
      * Bilde-2
      *""""""""
     C     SRB2          TAG
     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     EDI69DØ
     C                   EXFMT     EDI69DB
     C                   MOVE      '0'           *IN30
     C     *IN26         CABEQ     '1'           SRB1
     C     *IN03         CABEQ     '1'           SRB9
     C     *IN12         CABEQ     '1'           SRB9
      * Oppdatere record:
     C                   MOVE      M1N07         X1N07             3
     C                   MOVE      M1N08         X1N08             2
     C                   MOVE      M9N01         X9N01             1 0
     C                   MOVE      MSN           XSN               9 0
     C                   MOVE      MMN           XMN               6 0
     C                   MOVE      MSR           XSR               1
     C                   MOVE      MST           XST               1
     C                   MOVE      MDT           XDT               6 0
     C                   MOVE      MTM           XTM               6 0
     C                   MOVE      MAVD          XAVD              4 0
     C                   MOVE      MTDN          XTDN              7 0
     C                   MOVE      MVEN          XVEN              1
     C     KEYA          CHAIN     EDIM                               51
     C                   MOVE      X1N07         M1N07
     C                   MOVE      X1N08         M1N08
     C                   MOVE      X9N01         M9N01
     C                   MOVE      XSN           MSN
     C                   MOVE      XMN           MMN
     C                   MOVE      XSR           MSR
     C                   MOVE      XST           MST
     C                   MOVE      XDT           MDT
     C                   MOVE      XTM           MTM
     C                   MOVE      XAVD          MAVD
     C                   MOVE      XTDN          MTDN
     C                   MOVE      XVEN          MVEN
     C                   UPDATE    EDIMR
      *
     C     SRB9          ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell dato-test                                  SRDT /
      *////////////////////////////////////////////////////////////
     C     SRDT          BEGSR
      * Input: WDT 6.0 ÅMD
      * Output: *IN30
      * Output: ZMSGNO
     C     WDTM          COMP      1                                    30
     C  N30WDTM          COMP      12                                 30
     C  N30WDTD          COMP      1                                    30
     C  N30WDTD          COMP      31                                 30
     C   30              MOVE      'SPD0001'     ZMSGNO
     C                   ENDSR
