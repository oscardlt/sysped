      *
      ***************************************************************
      *** SKRIVER UT RAPPORT                                      ***
      ***                                                         ***
      *** PROGRAMMERT AV TORE BRÅSTAD, SYSTEMA A/S, APRIL 1994    ***
      ***************************************************************
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01-99                                ***
      ***************************************************************
      *
     FGBWREG    IF   E           K DISK
     FSYGB04P   O    E             PRINTER
     FSYGB04P1  O    E             PRINTER
     C*
     C     *ENTRY        PLIST
     C                   PARM                    FRAPER            4
     C                   PARM                    TILPER            4
     C                   PARM                    BRUKER           10
     C                   PARM                    DATO              6
     C                   PARM                    TID               8
     C*
     C                   MOVE      FRAPER        PFPER
     C                   MOVE      TILPER        PTPER
     C                   MOVE      BRUKER        PUSER
     C                   MOVE      DATO          PDATO
     C                   MOVEL     TID           PTID
     C*
     C                   MOVEL     'GJELDSAV'    GJETXT           15
     C                   MOVE      'SETNING'     GJETXT
     C                   MOVEL     'BEH. AVS'    BE1TXT           15
     C                   MOVE      'ETN. I '     BE1TXT
     C                   MOVEL     'BEH. AVS'    BE2TXT           15
     C                   MOVE      'ETN. II'     BE2TXT
     C*
     C     LESKEY        KLIST
     C                   KFLD                    WSAVD             4 0
     C                   KFLD                    WSAVK             3
     C*
     C                   Z-ADD     0             WSAVD
     C                   MOVE      *BLANKS       WSAVK
     C*
     C     START         TAG
     C     LESKEY        SETLL     GBWRR
     C                   READ      GBWRR                                  10
     C                   Z-ADD     GAVD          WAVD              4 0
     C                   Z-ADD     GAVD          PAVD
     C                   MOVEL     GAVK          WAVK              3
     C                   Z-ADD     1             USIDE
     C                   Z-ADD     1             GSIDE
     C                   WRITE     HEAD
     C                   WRITE     HODE
     C     *IN10         DOWEQ     '0'
     C     GAVD          IFEQ      WAVD
     C     GAVK          IFEQ      WAVK
     C                   EXSR      FORMAT
     C                   WRITE     DETALJ                               90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   ELSE
     C                   EXSR      SJEKK2
     C                   EXSR      SKRIV1
     C                   WRITE     DET1                                 91
     C     *IN91         IFEQ      '1'
     C                   ADD       1             GSIDE
     C                   WRITE     HODE
     C                   END
     C                   SETOFF                                       404142
     C                   SETOFF                                       434445
     C                   Z-ADD     0             KGSUM
     C                   Z-ADD     0             KB1SUM
     C                   Z-ADD     0             KB2SUM
     C                   Z-ADD     0             LGSUM
     C                   Z-ADD     0             LB1SUM
     C                   Z-ADD     0             LB2SUM
     C                   MOVE      *BLANKS       WAVK
     C                   MOVEL     GAVK          WAVK
     C                   EXSR      FORMAT
     C                   SETON                                        92
     C                   WRITE     DETALJ                               90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C                   ELSE
     C                   EXSR      SJEKK2
     C                   EXSR      SKRIV1
     C                   WRITE     DET1                                 91
     C     *IN91         IFEQ      '1'
     C                   ADD       1             GSIDE
     C                   WRITE     HODE
     C                   END
     C                   EXSR      SJEKK
     C                   EXSR      SKRIV2
     C                   WRITE     DET2                                 91
     C     *IN91         IFEQ      '1'
     C                   ADD       1             GSIDE
     C                   WRITE     HODE
     C                   END
     C                   SETOFF                                       303132
     C                   SETOFF                                       333435
     C                   SETOFF                                       404142
     C                   SETOFF                                       434445
     C                   Z-ADD     GAVD          WAVD
     C                   Z-ADD     GAVD          PAVD
     C                   Z-ADD     0             KGSUM
     C                   Z-ADD     0             KB1SUM
     C                   Z-ADD     0             KB2SUM
     C                   Z-ADD     0             LGSUM
     C                   Z-ADD     0             LB1SUM
     C                   Z-ADD     0             LB2SUM
     C                   Z-ADD     0             PGSUM
     C                   Z-ADD     0             PB1SUM
     C                   Z-ADD     0             PB2SUM
     C                   Z-ADD     0             FGSUM
     C                   Z-ADD     0             FB1SUM
     C                   Z-ADD     0             FB2SUM
     C                   MOVE      *BLANKS       WAVK
     C                   MOVEL     GAVK          WAVK
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   EXSR      FORMAT
     C  N92              WRITE     DETALJ                               90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   SETOFF                                       92
     C                   END
     C                   READ      GBWRR                                  10
     C                   END
     C*
     C                   EXSR      SJEKK2
     C                   EXSR      SKRIV1
     C                   WRITE     DET1                                 91
     C     *IN91         IFEQ      '1'
     C                   ADD       1             GSIDE
     C                   WRITE     HODE
     C                   END
     C                   EXSR      SJEKK
     C                   EXSR      SKRIV2
     C                   WRITE     DET2                                 91
     C     *IN91         IFEQ      '1'
     C                   ADD       1             GSIDE
     C                   WRITE     HODE
     C                   END
     C                   WRITE     SUM3                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   WRITE     DET3                                 91
     C     *IN91         IFEQ      '1'
     C                   ADD       1             GSIDE
     C                   WRITE     HODE
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***************************************************************
     C*
     C     FORMAT        BEGSR
     C*
     C                   MOVE      *BLANKS       PAVK
     C                   MOVEL     GAVK          PAVK
     C                   Z-ADD     GKONTO        PKONTO
     C                   Z-ADD     GTUR          PTURNR
     C                   Z-ADD     GOPD          POPD
     C                   MOVE      *BLANKS       PSIGN
     C                   MOVEL     GSIGN         PSIGN
     C                   Z-ADD     GAVS          PAVS
     C                   Z-ADD     GFFAKT        PFFAKT
     C                   Z-ADD     GBFAKT        PBFAKT
     C                   Z-ADD     GFKOST        PFKOST
     C                   Z-ADD     GBKOST        PBKOST
     C                   ADD       GAVS          PAVST
     C     GMVA          IFEQ      'J'
     C     GAVTXT        IFEQ      GJETXT
     C                   ADD       GAVS          PGSUM
     C                   ADD       GAVS          KGSUM
     C                   Z-ADD     GKONTO        KGONTO
     C                   END
     C     GAVTXT        IFEQ      BE1TXT
     C                   ADD       GAVS          PB1SUM
     C                   ADD       GAVS          KB1SUM
     C                   Z-ADD     GKONTO        KB1KTO
     C                   END
     C     GAVTXT        IFEQ      BE2TXT
     C                   ADD       GAVS          PB2SUM
     C                   ADD       GAVS          KB2SUM
     C                   Z-ADD     GKONTO        KB2KTO
     C                   END
     C                   ELSE
     C     GAVTXT        IFEQ      GJETXT
     C                   ADD       GAVS          FGSUM
     C                   ADD       GAVS          LGSUM
     C                   Z-ADD     GKONTO        LGONTO
     C                   END
     C     GAVTXT        IFEQ      BE1TXT
     C                   ADD       GAVS          FB1SUM
     C                   ADD       GAVS          LB1SUM
     C                   Z-ADD     GKONTO        LB1KTO
     C                   END
     C     GAVTXT        IFEQ      BE2TXT
     C                   ADD       GAVS          FB2SUM
     C                   ADD       GAVS          LB2SUM
     C                   Z-ADD     GKONTO        LB2KTO
     C                   END
     C                   END
     C*
     C                   MOVEL     GAVTXT        PTEXT
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     SJEKK         BEGSR
     C*
     C     PGSUM         IFNE      0
     C                   SETON                                        30
     C                   END
     C*
     C     PB1SUM        IFNE      0
     C                   SETON                                        31
     C                   END
     C*
     C     PB2SUM        IFNE      0
     C                   SETON                                        32
     C                   END
     C*
     C     FGSUM         IFNE      0
     C                   SETON                                        33
     C                   END
     C*
     C     FB1SUM        IFNE      0
     C                   SETON                                        34
     C                   END
     C*
     C     FB2SUM        IFNE      0
     C                   SETON                                        35
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     SJEKK2        BEGSR
     C*
     C     KGSUM         IFNE      0
     C                   MOVE      *BLANKS       KGVK
     C                   MOVEL     WAVK          KGVK
     C                   Z-ADD     WAVD          OAVD
     C                   SETON                                        40
     C                   END
     C*
     C     KB1SUM        IFNE      0
     C                   MOVE      *BLANKS       KB1VK
     C                   MOVEL     WAVK          KB1VK
     C                   Z-ADD     WAVD          QAVD
     C                   SETON                                        41
     C                   END
     C*
     C     KB2SUM        IFNE      0
     C                   MOVE      *BLANKS       KB2VK
     C                   MOVEL     WAVK          KB2VK
     C                   Z-ADD     WAVD          RAVD
     C                   SETON                                        42
     C                   END
     C*
     C     LGSUM         IFNE      0
     C                   MOVE      *BLANKS       LGVK
     C                   MOVEL     WAVK          LGVK
     C                   Z-ADD     WAVD          SAVD
     C                   SETON                                        43
     C                   END
     C*
     C     LB1SUM        IFNE      0
     C                   MOVE      *BLANKS       LB1VK
     C                   MOVEL     WAVK          LB1VK
     C                   Z-ADD     WAVD          TAVD
     C                   SETON                                        44
     C                   END
     C*
     C     LB2SUM        IFNE      0
     C                   MOVE      *BLANKS       LB2VK
     C                   MOVEL     WAVK          LB2VK
     C                   Z-ADD     WAVD          UAVD
     C                   SETON                                        45
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     SKRIV1        BEGSR
     C*
     C     *IN40         IFEQ      '1'
     C                   WRITE     SUM1                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN41         IFEQ      '1'
     C                   WRITE     SUM11                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN42         IFEQ      '1'
     C                   WRITE     SUM12                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN43         IFEQ      '1'
     C                   WRITE     SUM13                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN44         IFEQ      '1'
     C                   WRITE     SUM14                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN45         IFEQ      '1'
     C                   WRITE     SUM15                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     SKRIV2        BEGSR
     C*
     C     *IN30         IFEQ      '1'
     C                   WRITE     SUM2                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN31         IFEQ      '1'
     C                   WRITE     SUM21                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN32         IFEQ      '1'
     C                   WRITE     SUM22                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN33         IFEQ      '1'
     C                   WRITE     SUM23                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN34         IFEQ      '1'
     C                   WRITE     SUM24                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C     *IN35         IFEQ      '1'
     C                   WRITE     SUM25                                90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HEAD
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
