********************************************************************
     H debug(*yes)
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Ikke brgrense til kun versjon1
LEM   * xml fra SKY begynner litt ukurant,Tatt inn fo å kunne teste en feilsituasj hos oss
10030 * 03 CB  PTF10 Hent IFS bane slik at navn kan valideres
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      * 04 JOV PTF11 Finn også XML utf-16
      * 05 JOV PTF11 Reelt kundeeksempel tatt inn i standard - (god mal)
      * 06 SH  PTF11 MOTTAK NAVITRO faktura
      * 07 SH  PTF11 MOTTAK NAVITRO fortolling
      * 08 SH  PTF11 RETTELSE  NAVITRO
********************************************************************
N06  FFIRM      IF   E           K DISK    USROPN
N06  FFIRMARC   IF   E           K DISK    USROPN
N06  FFIRMNA    IF   E           K DISK    USROPN
N06  FARKTXT    IF   E           K DISK    USROPN
N06  FARKEXT    IF   E           K DISK    USROPN
     FEDI79F1K  UF   E             DISK
     FEDI85F1K  O  A E             DISK
N03  FEDISX2    IF   E           K DISK
     D XICTYPE         C                   CONST('PostenInterchange')
S01  D*XINHOUSE        C                   CONST('<?xml version="1.0"')
N01  D XINHOUSE        C                   CONST('<?xml version=')
LEM  D XSKY            C                   CONST('<SkynetExchange>')
N04  D XUTF16          C                   CONST('<?xml version=')
     D                 DS
     D  RDATA                  1   1024
N06  D  NAVITRO                1      7
     D  RTYBBS                 1      8
     D  RTYDNB                41     48
     D  RTYPE                  1      4
     D  AH100                  1      5
     D  TDS1                  10     11
     D  TDS2                  12     12
N07  D  FORT                   1     11
      *
     C     *ENTRY        PLIST
     C                   PARM      WTYPE         WTYPE             4
N03  C                   PARM                    WSXWORKM
     C                   MOVE      *BLANKS       WTYPE
N03  C     *LIKE         DEFINE    SXWORKM       WSXWORKM
N03   * Hent IFS katalog og filnavn
N03   * Har nå variabel: SXIFSOBJ som inneholder katalogbane + filnavn
N03   * hvis en vill teste på filnavn isteden for innehold.
N03  C     WSXWORKM      CHAIN     EDISX2
N03   * Exempellinje, bytt ut YYY.XXX med aktuell verdi
N03  C     'YYY.XXX'     SCAN      SXIFSOBJ                               54
      *
      * NAVITRO PDF
      *
N06  C     '.pdf'        SCAN      SXIFSOBJ                               54
N06  c     *in54         ifeq      '1'
S08  C*    'Navitro_'    SCAN      SXIFSOBJ      x                 3 0    54
N08  C     '_'           SCAN      SXIFSOBJ      x                 3 0    54
N06  C     *in54         ifeq      '1'
     C     arklagk       KLIST
     C                   KFLD                    fifirm
     C                   KFLD                    arklag
N06  C                   OPEN      FIRM
N06  C                   OPEN      FIRMARC
N06  C                   OPEN      ARKTXT
N06  C                   OPEN      ARKEXT
N06  C                   OPEN      FIRMNA
N06  C                   READ      FIRM                                   33
N06  C     FIFIRM        CHAIN     FIRMARC                            33
N06  C     FIFIRM        CHAIN     FIRMNA                             33
N08  C     *IN33         IFEQ      '0'
N06  C                   MOVE      *blanks       IFSFIL           70
N06  C                   MOVE      *blanks       FRAOBJ          256
N06  C                   MOVE      *blanks       TILBAN           70
N06  C                   EVAL      IFSFIL = %SUBST(SXIFSOBJ:X:70)
N06  C     'BACKUP'      SCAN      SXIFSOBJ      x                 3 0    54
N06  C     *in54         ifeq      '1'
N06   * henter eventuell avvinde bane fra arkext
N06  c     NADTDO        chain     ARKTXT                             54
N06  C     *in54         ifeq      '0'
N06  C     ARKLAG        IFNE      *blanks
N06  c     arklagk       chain     arkext                             54
N06  c                   end
N06  c                   end
N06  C                   EVAL      FRAOBJ = %SUBST(SXIFSOBJ:1:x+6)
N06  C                             + %trim(IFSFIL)
N06  C                   EVAL      TILBAN = '/' + ARCANE
N06  C                   CALL      'SYNA02CL'
N06  C                   PARM                    SXIFSOBJ
N06  C                   PARM                    IFSFIL
N06  C                   PARM                    FRAOBJ
N06  C                   PARM                    TILBAN
N06  C                   end
N06  C                   end
N06  C                   CLOSE     FIRM
N06  C                   CLOSE     FIRMARC
N06  C                   CLOSE     ARKTXT
N06  C                   CLOSE     ARKEXT
N06  C                   CLOSE     FIRMNA
N06  C                   end
N06  C                   end
      *
     C                   READ      EDI79F1K                               51
      *
      * DETALJPOSTER KAN HA AH100 I SEG
      *
      * DETALJPOSTER KAN HA AAANO I SEG   (CASS AVREGNING)
     C     AH100         IFEQ      'AAANO'
     C                   MOVE      'J'           AH100J            1
     C                   MOVE      AH100         AH100B            5
     C                   END
N06   * NAVITRO kostnadsfil
N06  C     NAVITRO       IFEQ      'Navitro'
N06  C                   MOVE      'J'           NAVJN             1            *BBS INNBET.
N06  C                   END
      *
     C     *IN51         DOWEQ     '0'
      *
     C     'UNB+U'       SCAN      RDATA         WPOS              4 0    52
     C     XICTYPE       SCAN      RDATA         WPOS              4 0    53
     C  N53XINHOUSE      SCAN      RDATA         WPOS              4 0    53
N04  C  N53XUTF16        SCAN      RDATA         WPOS              4 0    53
LEM  C  N53XSKY          SCAN      RDATA         WPOS              4 0    53
     C     RTYPE         IFEQ      '*SYS'                                       IE MSG
     C     RTYPE         OREQ      'UNB+'                                       EDIFACT
     C     RTYPE         OREQ      'UNA:'                                       EDIFACT
     C     RTYPE         OREQ      '*IN#'                                       EDIFACT
N07  C     FORT          OREQ      'Export toll'
N07  C     FORT          OREQ      'Eksport_tol'
N07  C     FORT          OREQ      'Import_toll'
     C     TDS1          OREQ      '_K'                                         TDS TARIC
     C     TDS2          ANDGE     'A'                                          TDS TARIC
     C     TDS2          ANDLE     'T'                                          TDS TARIC
     C     TDS1          OREQ      '_D'                                         TDS TARIC
     C     TDS2          ANDGE     'A'                                          TDS TARIC
     C     TDS2          ANDLE     'T'                                          TDS TARIC
     C     RTYBBS        OREQ      'NY000010'                                   OCR-INB
     C     RTYDNB        OREQ      'BETFOR00'                                   BANK
N06  C     NAVITRO       OREQ      'Navitro'
     C     AH100         OREQ      'AAANO'                                      CASS
N05  C     RTYBBS        OREQ      'Manifest'                                   CTS manifest
     C     *IN52         OREQ      *ON                                          EDIFACT
     C     *IN53         OREQ      *ON                                          XML POSTEN
S05   * line under innført i ptf 03 kan ikke brukes - vil splitte i en og en linje
N03  C**   *IN54         OREQ      *ON                                          FIL/FILTYPE
     C     *IN81         CABEQ     '1'           END
     C                   MOVE      '1'           *IN81
     C                   SELECT
     C                   WHEN      *IN52
     C                   MOVEL     'UNB+'        WTYPE
     C                   WHEN      *IN53
     C                   MOVEL     'XMLP'        WTYPE
N07  C                   WHEN      FORT   = 'Export toll'
N07  C                   MOVEL     'EXTO'        WTYPE
N07  C                   WHEN      FORT   = 'Import_toll'
N07  C                   MOVEL     'IMTO'        WTYPE
N07  C                   WHEN      FORT   = 'Eksport_tol'
N07  C                   MOVEL     'EXTO'        WTYPE
     C                   OTHER
     C                   MOVE      RTYPE         WTYPE
     C                   ENDSL
     C                   END
      *
     C     STNESTE       TAG
     C   81              WRITE     EDIRER
     C                   DELETE    EDI79FR
     C                   READ      EDI79F1K                               51
     C  N51WTYPE         CABEQ     'XMLP'        STNESTE
N07  C  N51WTYPE         CABEQ     'EXTO'        STNESTE
N07  C  N51WTYPE         CABEQ     'IMTO'        STNESTE
N06  C  N51NAVJN         CABEQ     'J'           STNESTE
      *
      * FOR Å SKRIVE ALLE RECORDS VED AH100 BANKAVSTEMNING
      * MÅ LEGGES ANNEN TYPE I AH100B
      *
     C  N51              END
      *
     C     END           TAG
     C                   MOVE      '1'           *INLR
