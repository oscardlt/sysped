     FENITPWF   UF A E             DISK
     F                                     INFDS(EPWDS)
     FENITPW1   IF   E           K DISK
     F                                     INFDS(EPWDS1)
     F                                     RENAME(ENITPR:ENITP1)
     FE075D     CF   E             WORKSTN
     F                                     SFILE(E075DA:ZRECNO)
     F                                     INFDS(FBAREA)
     D EPWDS           DS
     D  RRNP                 397    400B 0
     D EPWDS1          DS
     D  RRNP1                397    400B 0
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     C                   EXSR      INIT
      *_____________
      * Toem Subfile
      *"""""""""""""
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     E075DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     EPWKY1        SETLL     ENITPW1                            77
      *
     C     START1        TAG
     C                   DO        13
     C                   READ      ENITPW1                                94
     C     *IN94         IFEQ      '0'
     C                   MOVE      RRNP1         SFRRN
     C                   MOVE      EPWUSR        XPWUSR
     C                   MOVEL     EPWST         XPWST
     C                   MOVEL     EPWPW         XPWPW
     C                   ADD       1             ZRECNO
     C                   Z-ADD     ZRECNO        CURS1
     C     XPWST         COMP      'B'                                838182
     C                   WRITE     E075DA
     C                   END                                                    <*IN94
     C  N94              ENDDO
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     YRECNO        IFGT      0
     C     YRECNO        SUB       1             ZRECNO
     C     ZRECNO        DIV       13            ZRECNO
     C     ZRECNO        MULT      13            ZRECNO
     C                   ADD       1             ZRECNO
     C                   ENDIF
      *_____________
      * Vise Subfile
      *"""""""""""""
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C                   CLEAR                   WPWUSR
     C     ZRECNO        IFEQ      0
     C                   MOVE      '1'           *IN31
     C                   WRITE     E075DD
     C                   EXFMT     E075DC
     C                   READ      E075DD                                 66
     C                   ELSE
     C                   MOVE      '0'           *IN31
     C                   WRITE     E075DB
     C                   Z-ADD     WSSUBN        XRECNO
     C                   EXFMT     E075DC
     C                   READ      E075DB                                 66
     C                   END
      *
     C     FKEYS         TAG
      *
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      *
     C                   SETOFF                                       999830
      * F3=Avslutt
     C     *IN03         IFEQ      '1'
     C                   GOTO      ENDPGM
     C                   END                                                    <*IN03
      * F5=Frisk opp
     C     *IN05         IFEQ      '1'
     C                   CLEAR                   XPWUSR
     C                   CLEAR                   XPWST
     C                   CLEAR                   XPWPW
     C                   GOTO      START
     C                   END                                                    <*IN05
      * F6=Lage ny
     C     *IN06         IFEQ      '1'
     C                   MOVEL     'Lage ny '    WMODE
     C                   EXSR      CLRSCR
     C                   MOVE      '0'           *IN40
     C                   GOTO      START5
     C                   END                                                    <*IN06
      * F12=Forrige
     C     *IN12         IFEQ      '1'
     C                   CLEAR                   XPWUSR
     C                   CLEAR                   XPWST
     C                   CLEAR                   XPWPW
     C                   GOTO      START
     C                   END                                                    <*IN12
      * Rulle
     C     *IN25         IFEQ      '1'
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      '0'           *IN25
     C     START4        TAG
     C     *IN94         IFEQ      '0'
     C                   GOTO      START1
     C                   END                                                    <*IN94
     C                   END                                                    <*IN25
      * *IN08=Soek på BRUKER ID
     C     WPWUSR        IFNE      *BLANKS
     C                   MOVE      '1'           *IN08
     C                   GOTO      START6
     C                   ELSE
     C                   MOVE      '0'           *IN08
     C                   END                                                    <WPWUSR
      * Hente alternativ fra skjermbilde
     C     ZRECNO        IFNE      0
     C                   EXSR      GETOPT
      * Ingen alterbativ er valgt
     C     *IN97         IFEQ      '1'
     C                   EXFMT     E075DC
     C                   READ      E075DB                                 66
     C                   MOVE      '0'           *IN97
     C                   GOTO      FKEYS
     C                   END                                                    <*IN12
      * F3=Avlsutt
     C     *IN03         IFEQ      '1'
     C                   GOTO      ENDPGM
     C                   END                                                    <*IN03
     C                   END                                                    <ZRECNO
     C     *IN98         IFEQ      '1'
     C     XRECNO        ANDNE     0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END                                                    <*IN98
     C                   GOTO      START3
      * Lage ny
     C     START5        TAG
     C                   EXFMT     E075DE
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   MOVE      '0'           *IN30
      * F3=Avslutt
      * F12=Forrige
     C     *IN12         IFEQ      '1'
     C     *IN03         OREQ      '1'
     C                   EXSR      CLRSCR
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   ELSE
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
     C                   GOTO      START5
     C                   END                                                    <*IN30
     C                   END                                                    <*IN12
     C                   GOTO      START3
      * Soek på BRUKER ID
     C     START6        TAG
     C                   MOVE      WPWUSR        XPWUSR
      * Finn s kekriteria
     C                   MOVEA     '01'          *IN(50)
     C                   GOTO      START
      *
     C     ENDPGM        TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *______________________________________________
     C     TESTB1        BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
      *          N40 = NY
      *           40 = ENDRE
      *
     C                   EXSR      TSTSCR
     C     *IN30         IFEQ      '1'
     C                   GOTO      ENDTST
     C                   END                                                    <*IN30
     C     *IN40         IFEQ      '1'
     C                   UPDATE    ENITPR                               38
     C                   ELSE
     C                   WRITE     ENITPR
     C                   END                                                    <*IN40
      *
     C                   MOVE      EPWUSR        XPWUSR
     C                   MOVEL     EPWST         XPWST
     C                   MOVEL     EPWPW         XPWPW
     C     XPWST         COMP      'B'                                838182
     C     *IN40         IFEQ      '1'
     C                   UPDATE    E075DA
     C                   ELSE
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      RRNP          SFRRN
     C                   WRITE     E075DA
     C                   END                                                    <*IN40
     C                   EXSR      CLRSCR
     C     ENDTST        ENDSR
      *______________________________________________
     C     TSTSCR        BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
      *
     C     EPWUSR        IFEQ      *BLANKS
     C                   MOVE      'CBA0130'     MSGNR
     C                   MOVE      '1'           *IN62
     C                   MOVE      '1'           *IN30
     C                   GOTO      TSTEND
     C                   END                                                    <EPWUSR
      *
     C     EPWST         IFEQ      *BLANKS
     C                   MOVE      'CBA0130'     MSGNR
     C                   MOVE      '1'           *IN63
     C                   MOVE      '1'           *IN30
     C                   GOTO      TSTEND
     C                   END                                                    <EPWST
      *
     C     EPWPW         IFEQ      *BLANKS
     C                   MOVE      'CBA0130'     MSGNR
     C                   MOVE      '1'           *IN64
     C                   MOVE      '1'           *IN30
     C                   GOTO      TSTEND
     C                   END                                                    <EPWPW
     C     TSTEND        ENDSR
      *______________________________________________
     C     GETOPT        BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C                   Z-ADD     0             OPTNBR            2 0
     C                   SETOFF                                       919299
     C                   MOVE      '1'           *IN97
     C     *IN98         DOWEQ     '0'
     C                   READC     E075DA                                 98
     C     *IN98         IFEQ      '1'
     C     *IN99         IFEQ      '1'
     C                   MOVE      '0'           *IN98
     C                   END                                                    <*IN99
     C                   GOTO      ENDGET
     C                   END                                                    <*IN98
     C                   MOVE      '0'           *IN97
     C                   Z-ADD     CURS1         ZRECNO
      * 2=Endre
     C     WSNR          IFEQ      '2 '
     C     WSNR          OREQ      ' 2'
     C     WSNR          OREQ      '02'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Endre   '    WMODE
     C     XPWPW         IFEQ      'SLETTET'
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFNAM
     C                   MOVE      '1'           *IN40
     C                   EXSR      CHGST
      * F12=Forrige
     C     *IN12         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   MOVE      '0'           *IN40
     C                   END                                                    <WSNR=2
      * 3=Kopiere
     C     WSNR          IFEQ      '3 '
     C     WSNR          OREQ      ' 3'
     C     WSNR          OREQ      '03'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Kopiere '    WMODE
     C     XPWPW         IFEQ      'SLETTET'
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFNAM
     C                   EXSR      CPYST
      * F12=Forrige
     C     *IN12         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   END                                                    <WSNR=3
      * 4=Slett
     C     WSNR          IFEQ      '4 '
     C     WSNR          OREQ      ' 4'
     C     WSNR          OREQ      '04'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Slette  '    WMODE
     C     XPWPW         IFEQ      'SLETTET'
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFNAM
     C                   EXSR      DLTST
      * F12=Forrige
     C     *IN12         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   END                                                    <WSNR=4
      * 5=Vise
     C     WSNR          IFEQ      '5 '
     C     WSNR          OREQ      ' 5'
     C     WSNR          OREQ      '05'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Vise    '    WMODE
     C     XPWPW         IFEQ      'SLETTET'
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFNAM
     C     SFRRN         CHAIN(N)  ENITPWF                            77
     C                   MOVE      '1'           *IN88
     C                   EXFMT     E075DE
      * F12=Forrige
     C     XPWST         COMP      'B'                                838182
     C     *IN12         IFEQ      '1'
     C                   UPDATE    E075DA
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   MOVE      '0'           *IN88
     C                   UPDATE    E075DA
     C                   END                                                    <WSNR=5
     C                   ENDDO
      *
     C     ENDGET        TAG
      *
     C                   ENDSR
      *______________________________________________
     C     CHGST         BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     SFRRN         CHAIN     ENITPWF                            77
     C                   MOVE      EPWUSR        ZPWUSR
     C                   MOVEL     EPWST         ZPWST
     C                   MOVEL     EPWPW         ZPWPW
     C                   MOVE      '1'           *IN99
     C     STCHG         TAG
     C                   EXFMT     E075DE
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C     *IN12         IFEQ      '1'
     C     *IN03         OREQ      '1'
     C     XPWST         COMP      'B'                                838182
     C                   UPDATE    E075DA
     C                   GOTO      CHGEND
     C                   END                                                    <*IN12
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
     C                   GOTO      STCHG
     C                   END                                                    <*IN30
      *
     C     CHGEND        TAG
     C                   ENDSR
      *______________________________________________
     C     CPYST         BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     SFRRN         CHAIN(N)  ENITPWF                            77
     C                   MOVE      '1'           *IN99
     C     XPWST         COMP      'B'                                838182
     C                   UPDATE    E075DA
     C     STCPY         TAG
     C                   EXFMT     E075DE
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C     *IN12         IFEQ      '1'
     C     *IN03         OREQ      '1'
     C                   EXSR      CLRSCR
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   GOTO      CPYEND
     C                   END                                                    <*IN12
     C                   MOVE      '0'           *IN40
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
     C                   GOTO      STCPY
     C                   END                                                    <*IN30
      *
     C     CPYEND        TAG
     C                   ENDSR
      *______________________________________________
     C     DLTST         BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      '1'           *IN99
     C                   MOVEA     '11'          *IN(88)
     C     SFRRN         CHAIN     ENITPWF                            77
     C                   EXFMT     E075DE
     C                   MOVEA     '00'          *IN(88)
     C     *IN11         IFEQ      '1'
     C     *IN77         IFEQ      '0'
     C                   DELETE    ENITPR
     C                   END                                                    <*IN77
     C                   MOVE      EPWUSR        XPWUSR
     C                   MOVEL     'SLETTET'     XPWPW
     C                   END                                                    <*IN11
     C     XPWST         COMP      'B'                                838182
     C                   UPDATE    E075DA
     C                   ENDSR
      *______________________________________________
     C     CLRSCR        BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      '0'           *IN40
     C                   CLEAR                   EPWUSR
     C                   CLEAR                   EPWST
     C                   CLEAR                   EPWPW
     C                   ENDSR
      *______________________________________________
     C     INIT          BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     *LIKE         DEFINE    EPWUSR        ZPWUSR
     C     *LIKE         DEFINE    EPWST         ZPWST
     C     *LIKE         DEFINE    EPWPW         ZPWPW
      *--------------------------------------------------------------
      * DEFINE KEY FOR ENITPW1
      *--------------------------------------------------------------
     C     EPWKY1        KLIST
     C                   KFLD                    WPWUSR
      *
     C                   CLEAR                   WPWUSR
     C                   MOVE      '1'           *IN50
      *
     C                   ENDSR
      *
