/*N01 - 2 SYKLUSER, FØRST F.BREV SÅ TOLLPASS  */
/*N01 - KUTT KALL PÅ SYFA00 - KAN KALLES FRA WEB(MED KLARGJORT UDS)  */
             PGM        PARM(&AVD &OPD &TUR)
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          HVIS &IN01 PÅ, BETYR DET AVSLUTT PROGRAM +
                          FRA VALGBILDE. */
             DCL        VAR(&JBK) TYPE(*CHAR) LEN(1) VALUE('D') /* +
                          JOBBKØ. */
             DCL        VAR(&LG) TYPE(*CHAR) LEN(1) /* HVIS 'J', +
                          BENYTTER LINJEGODS FRAKTBREV. ELLERS +
                          STANDARD FRAKBREV. */
             DCL        VAR(&EKSP) TYPE(*CHAR) LEN(1) /* HVIS 'J', +
                          BENYTTER EKSPRESS FRAKTBREV. */
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('F')  /* +
                          KODE = 'F', 'T'. 'F'=FRAKTBREV, +
                          'T'=TOLLPASSFRAKTBREV */
             DCL        VAR(&VB) TYPE(*CHAR) LEN(1) /* HVIS &VB = +
                          'J', SKAL SENDE VALGBILDE UT TIL BRUKER. */
             DCL        VAR(&PO) TYPE(*CHAR) LEN(1) /* HVIS &PO = +
                          'J', SKAL SORTERE PÅ POSTNR. */
             CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
    /* */
    /* HENTE AVDELING, SIGNATUR OG FIRMAKODE */
    /* */
    /*S01    CALL       PGM(SYFA00) PARM(&IN01)                    */
    /*S01    IF         COND(&IN01 = '1') THEN(GOTO CMDLBL(SLUTT)) */

    /* */
    /* SETTER VERDI TUR VED TURNR UTFYLLT   */
    /* */
             IF         COND(&TUR *NE '00000000') THEN(CHGVAR +
                          VAR(&PO) VALUE('T'))
    /* */
    /* HENTE OPPLYSNINGER OM HVA SLAGS UTSKRIFT/ SETTER ØVRIG UDS  */
             CALL       PGM(SYFAFB) PARM(&JBK &LG &EKSP &IN01 &VB &PO)
             IF         COND(&IN01 = '1') THEN(GOTO CMDLBL(SLUTT)) /* +
                          HVIS &IN01 PÅ, AVSLUTTER PROGRAM. */
             IF         COND(&VB = 'K') THEN(CHGVAR VAR(&JBK) +
                          VALUE('N'))
    /* */
    /* ----------------------------------------------------------- */
    /* SKRIVER UT FRAKTBREV */
             CHGDTAARA  DTAARA(*LDA (22 8)) VALUE(&TUR)
             CHGDTAARA  DTAARA(*LDA (82 7)) VALUE(&OPD)
             CHGVAR     VAR(&VB) VALUE(' ')
 SKRIV:
             SBMJOB     CMD(CALL PGM(SYFA12CLJ) PARM(&KODE &VB &EKSP +
                          &LG &PO)) JOB(FRBREV) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
    /* ----------------------------------------------------------- */

 /*N01*/     IF         COND(&KODE = 'F') THEN(DO)
 /*N01*/     CHGVAR     VAR(&KODE) VALUE('T')
 /*N01*/     GOTO       SKRIV
 /*N01*/     ENDDO
 SLUTT:      ENDPGM
