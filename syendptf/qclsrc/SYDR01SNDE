             PGM        PARM(&SBS &PGM &LIB &JOB &JOBQ &JOBD &JOBN &USER)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
             DCL        VAR(&FIL) TYPE(*CHAR) LEN(10) VALUE('FEILM')
             DCL        VAR(&MBR) TYPE(*CHAR) LEN(10) VALUE('FEILM')
             DCL        VAR(&SBS) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MELD) TYPE(*CHAR) LEN(70)
             DCL        VAR(&PGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&JOBD) TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBN) TYPE(*CHAR) LEN(6)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPLF) TYPE(*CHAR) LEN(10) +
                          VALUE('QPJOBLOG')
/*______________*/
/* LES EPOSTADR */
/*""""""""""""""*/
             DCLF       FILE(SYDRUSRF) RCDFMT(*ALL)
             RCVF       DEV(*FILE) RCDFMT(*FILE)
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&MELD) VALUE('Feilmelding i SBS:' *BCAT +
                          &SBS *BCAT 'Job:' *BCAT &JOB *BCAT ' ')
/******************************************************************/
/* LAGER SOURCEMEMBER I SYDR04F                                   */
/******************************************************************/
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &QNBR)
             ADDPFM     FILE(SYDR04F) MBR(&UNIK)
             MONMSG     MSGID(CPF0000)
             CLRPFM     FILE(SYDR04F) MBR(&UNIK)
             CHGJOB     JOB(&JOBN/&USER/&JOB) LOG(4 0 *SECLVL) +
                          LOGCLPGM(*YES)
/******************************************************************/
/* LAGER FYSISK FIL FEILM I QTEMP                                 */
/******************************************************************/
             CRTPF      FILE(QTEMP/FEILM) RCDLEN(132)
             MONMSG     MSGID(CPF0000) EXEC(CLRPFM FILE(FEILM))
/******************************************************************/
/* LAGER FYSISK FIL SYDR04F                                       */
/******************************************************************/
             CRTDUPOBJ  OBJ(SYDR04F) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(SYDR04F)
             MONMSG     MSGID(CPF0000) EXEC(CLRPFM FILE(QTEMP/SYDR04F))
/******************************************************************/
/* SKRIVER JOBBLOGG TIL PRINT                                     */
/******************************************************************/
             DSPJOBLOG  JOB(&JOBN/&USER/&JOB) OUTPUT(*PRINT)
/******************************************************************/
/* KOPIERER SPOOLFIL TIL FEILM                                    */
/******************************************************************/
             CPYSPLF    FILE(&SPLF) TOFILE(*LIBL/FEILM) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST) +
                          CRTDATE(*LAST) TOMBR(*FIRST) MBROPT(*ADD) +
                          CTLCHAR(*NONE)
/******************************************************************/
/* KOPIERER FEILM TIL SYDR04F (SOURCEFIL)                         */
/******************************************************************/
             CPYF       FROMFILE(QTEMP/FEILM) TOFILE(QTEMP/SYDR04F) +
                          TOMBR(&UNIK) MBROPT(*REPLACE) FMTOPT(*CVTSRC)
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/******************************************************************/
/* SENDER TIL EPOSTADRESSE 1                                      */
/******************************************************************/
             IF         COND(&AREP1 *NE '     ') THEN(DO)
             EMLMSG     SUBJECT(&MELD) FROMNAME(&FIRMA) +
                          FROMADDR('drift@systema.no') +
                          TO(&AREP1/&ARUS1/*TO) TXTF(QTEMP/SYDR04F) +
                          TXTMBR(&UNIK) EDTMBR(*NO) PREFORM(Y)
                          enddo
/******************************************************************/
/* SENDER TIL EPOSTADRESSE 2                                      */
/******************************************************************/
             IF         COND(&AREP2 *NE '     ') THEN(DO)
             EMLMSG     SUBJECT(&MELD) FROMNAME(&FIRMA) +
                          FROMADDR('drift@systema.no') +
                          TO(&AREP2/&ARUS2/*TO) TXTF(QTEMP/SYDR04F) +
                          TXTMBR(&UNIK) EDTMBR(*NO) PREFORM(Y)
                          enddo
/******************************************************************/
/* SENDER TIL EPOSTADRESSE 3                                      */
/******************************************************************/
             IF         COND(&AREP3 *NE '     ') THEN(DO)
             EMLMSG     SUBJECT(&MELD) FROMNAME(&FIRMA) +
                          FROMADDR('drift@systema.no') +
                          TO(&AREP3/&ARUS3/*TO) TXTF(QTEMP/SYDR04F) +
                          TXTMBR(&UNIK) EDTMBR(*NO) PREFORM(Y)
                          enddo
/******************************************************************/
/* SENDER TIL EPOSTADRESSE 4                                      */
/******************************************************************/
             IF         COND(&AREP4 *NE '     ') THEN(DO)
             EMLMSG     SUBJECT(&MELD) FROMNAME(&FIRMA) +
                          FROMADDR('drift@systema.no') +
                          TO(&AREP4/&ARUS4/*TO) TXTF(QTEMP/SYDR04F) +
                          TXTMBR(&UNIK) EDTMBR(*NO) PREFORM(Y)
                          enddo
/******************************************************************/
/* SENDER TIL EPOSTADRESSE 5                                      */
/******************************************************************/
             IF         COND(&AREP5 *NE '     ') THEN(DO)
             EMLMSG     SUBJECT(&MELD) FROMNAME(&FIRMA) +
                          FROMADDR('drift@systema.no') +
                          TO(&AREP5/&ARUS5/*TO) TXTF(QTEMP/SYDR04F) +
                          TXTMBR(&UNIK) EDTMBR(*NO) PREFORM(Y)
                          enddo
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             DLTSPLF    FILE(&SPLF) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             ENDPGM
