             PGM        PARM(&CALLPGM &CALLPGMLIB)
             DCL        VAR(&SPCAUT) TYPE(*CHAR) LEN(100)
             DCL        VAR(&JOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CALLPGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CALLPGMLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SECURY) TYPE(*CHAR) LEN(2)
             DCL        VAR(&OK) TYPE(*LGL) LEN(1)
             DCL        VAR(&SORT) TYPE(*CHAR) LEN(22)
             DCL        VAR(&SPC1) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC3) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC4) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC5) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC6) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC21) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC22) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC23) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC24) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC25) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC26) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC31) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC32) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC33) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC34) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC35) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SPC36) TYPE(*CHAR) LEN(10)
             DCL        VAR(&GRP) TYPE(*CHAR) LEN(10)
             DCL        VAR(&USERCLS) TYPE(*CHAR) LEN(10)
             DCL        VAR(&COMPARE) TYPE(*CHAR) LEN(22) +
                          VALUE('*SAVSYS*JOBCTL*SPLCTL')
             DCL        VAR(&MSG1) TYPE(*CHAR) LEN(18) +
                          VALUE('Spesialadgangene ')
             DCL        VAR(&MSG2) TYPE(*CHAR) LEN(41) VALUE('kreves +
                          for å kunne kjøre denne jobben !')
             DCL        VAR(&MSG3) TYPE(*CHAR) LEN(19) VALUE('Du er +
                          brukerklasse')
             DCL        VAR(&MSG4) TYPE(*CHAR) LEN(37) VALUE('og er +
                          tildelt spesialautorisasjonen')
             DCL        VAR(&MSG5) TYPE(*CHAR) LEN(36) VALUE('Og har +
                          henvisning til gruppeprofil ')
             DCL        VAR(&MSG6) TYPE(*CHAR) LEN(44) VALUE('Denne +
                          skal ha verdi QPGMR for å unngå feil.')
             RTVJOBA    JOB(&JOB)
             RTVUSRPRF  SPCAUT(&SPCAUT) GRPPRF(&GRP) USRCLS(&USERCLS)
             CHGDTAARA  DTAARA(TST (1 100)) VALUE(&SPCAUT)
             CHGDTAARA  DTAARA(TST (100 10)) VALUE(&GRP)
             CHGDTAARA  DTAARA(TST (110 10)) VALUE(&USERCLS)
             CHGVAR     VAR(&USERCLS) VALUE(&USERCLS *CAT &USERCLS)
             CHGVAR     VAR(&GRP) VALUE(&GRP *CAT &GRP)
             RTVSYSVAL  SYSVAL(QSECURITY) RTNVAR(&SECURY)
             CHGVAR     VAR(&CALLPGM) VALUE(&CALLPGM *CAT &CALLPGM)
             IF         COND(&CALLPGM = SYFA35CL) THEN(DO)
             IF         COND(&GRP = *NONE) THEN(GOTO CMDLBL(MSG2))
             ENDDO
             IF         COND(&USERCLS = *USER) THEN(GOTO +
                          CMDLBL(CHKSPCAUT1))
             IF         COND(&USERCLS = *SYSOPR) THEN(GOTO +
                          CMDLBL(CHKSPCAUT1))
             IF         COND(&USERCLS = *PGMR) THEN(GOTO +
                          CMDLBL(CHKSPCAUT1))
             IF         COND(&USERCLS = *SECADM) THEN(GOTO +
                          CMDLBL(CHKSPCAUT1))
             IF         COND(&USERCLS = *SECOFR) THEN(GOTO +
                          CMDLBL(CHKSPCAUT1))
             /**/
             /* GJELDER ALLE BRUKERKLASSER */
 CHKSPCAUT1: IF         COND(%SST(&SPCAUT 1 5) = *NONE) THEN(GOTO +
                          CMDLBL(MSG1))
             /**/
             /* *USER *USERCLS */
             IF         COND(&USERCLS = *USER) THEN(DO)
             IF         COND(%SST(&SPCAUT 1 7) = *USRCLS) THEN(GOTO +
                          CMDLBL(MSG1))
             ENDDO
             /* *SYSOPR *USRCLS */
             IF         COND(&USERCLS = *SYSOPR) THEN(DO)
             IF         COND(%SST(&SPCAUT 1 7) = *USRCLS) THEN(GOTO +
                          CMDLBL(MSG1))
             ENDDO
             /* *SECADM *USRCLS */
             IF         COND(&USERCLS = *SECADM) THEN(DO)
             IF         COND(%SST(&SPCAUT 1 7) = *USRCLS) THEN(GOTO +
                          CMDLBL(AUT))
             ENDDO
             /* *SECOFR *USRCLS */
             IF         COND(&USERCLS = *SECOFR) THEN(DO)
             IF         COND(%SST(&SPCAUT 1 7) = *USRCLS) THEN(GOTO +
                          CMDLBL(AUT))
             ENDDO
             /**/
             /*FINNE SPESIALADGANGER, OG SORTERE REKKEFØLGEN.          S*/
             /*SAVSYS*/
             RTVDTAARA  DTAARA(TST (1 100)) RTNVAR(&SPCAUT)
             IF         COND(%SST(&SPCAUT 1 10) = *SAVSYS) +
                          THEN(CHGVAR VAR(&SPC1) VALUE(%SST(&SPCAUT +
                          1 10)))
             CHGVAR     VAR(&SPC1) VALUE(&SPC1 *CAT &SPC1)
             IF         COND(%SST(&SPCAUT 11 10) = *SAVSYS) +
                          THEN(CHGVAR VAR(&SPC2) VALUE(%SST(&SPCAUT +
                          11 10)))
             CHGVAR     VAR(&SPC2) VALUE(&SPC2 *CAT &SPC2)
                          /**/
             IF         COND(%SST(&SPCAUT 21 10) = *SAVSYS) +
                          THEN(CHGVAR VAR(&SPC3) VALUE(%SST(&SPCAUT +
                          21 10)))
             CHGVAR     VAR(&SPC3) VALUE(&SPC3 *CAT &SPC3)
             IF         COND(%SST(&SPCAUT 31 10) = *SAVSYS) +
                          THEN(CHGVAR VAR(&SPC4) VALUE(%SST(&SPCAUT +
                          31 10)))
             CHGVAR     VAR(&SPC4) VALUE(&SPC4 *CAT &SPC4)
             IF         COND(%SST(&SPCAUT 41 10) = *SAVSYS) +
                          THEN(CHGVAR VAR(&SPC5) VALUE(%SST(&SPCAUT +
                          41 10)))
             CHGVAR     VAR(&SPC5) VALUE(&SPC5 *CAT &SPC5)
             IF         COND(%SST(&SPCAUT 51 10) = *SAVSYS) +
                          THEN(CHGVAR VAR(&SPC6) VALUE(%SST(&SPCAUT +
                          51 10)))
             CHGVAR     VAR(&SPC6) VALUE(&SPC6 *CAT &SPC6)

             /*JOBCTL*/
             IF         COND(%SST(&SPCAUT 1 10) = *JOBCTL) +
                          THEN(CHGVAR VAR(&SPC21) VALUE(%SST(&SPCAUT +
                          1 10)))
             CHGVAR     VAR(&SPC21) VALUE(&SPC21 *CAT &SPC21)
             IF         COND(%SST(&SPCAUT 11 10) = *JOBCTL) +
                          THEN(CHGVAR VAR(&SPC22) VALUE(%SST(&SPCAUT +
                          11 10)))
             CHGVAR     VAR(&SPC22) VALUE(&SPC22 *CAT &SPC22)
                          /**/
             IF         COND(%SST(&SPCAUT 21 10) = *JOBCTL) +
                          THEN(CHGVAR VAR(&SPC23) VALUE(%SST(&SPCAUT +
                          21 10)))
             CHGVAR     VAR(&SPC23) VALUE(&SPC23 *CAT &SPC23)
             IF         COND(%SST(&SPCAUT 31 10) = *JOBCTL) +
                          THEN(CHGVAR VAR(&SPC24) VALUE(%SST(&SPCAUT +
                          31 10)))
             CHGVAR     VAR(&SPC24) VALUE(&SPC24 *CAT &SPC24)
             IF         COND(%SST(&SPCAUT 41 10) = *JOBCTL) +
                          THEN(CHGVAR VAR(&SPC25) VALUE(%SST(&SPCAUT +
                          41 10)))
             CHGVAR     VAR(&SPC25) VALUE(&SPC25 *CAT &SPC25)
             IF         COND(%SST(&SPCAUT 51 10) = *JOBCTL) +
                          THEN(CHGVAR VAR(&SPC26) VALUE(%SST(&SPCAUT +
                          51 10)))
             CHGVAR     VAR(&SPC26) VALUE(&SPC26 *CAT &SPC26)
              /*SPLCTL*/
             IF         COND(%SST(&SPCAUT 1 10) = *SPLCTL) +
                          THEN(CHGVAR VAR(&SPC31) VALUE(%SST(&SPCAUT +
                          1 10)))
             CHGVAR     VAR(&SPC31) VALUE(&SPC31 *CAT &SPC31)
             IF         COND(%SST(&SPCAUT 11 10) = *SPLCTL) +
                          THEN(CHGVAR VAR(&SPC32) VALUE(%SST(&SPCAUT +
                          11 10)))
             CHGVAR     VAR(&SPC32) VALUE(&SPC32 *CAT &SPC32)
                          /**/
             IF         COND(%SST(&SPCAUT 21 10) = *SPLCTL) +
                          THEN(CHGVAR VAR(&SPC33) VALUE(%SST(&SPCAUT +
                          21 10)))
             CHGVAR     VAR(&SPC33) VALUE(&SPC33 *CAT &SPC33)
             IF         COND(%SST(&SPCAUT 31 10) = *SPLCTL) +
                          THEN(CHGVAR VAR(&SPC34) VALUE(%SST(&SPCAUT +
                          31 10)))
             CHGVAR     VAR(&SPC34) VALUE(&SPC34 *CAT &SPC34)
             IF         COND(%SST(&SPCAUT 41 10) = *SPLCTL) +
                          THEN(CHGVAR VAR(&SPC35) VALUE(%SST(&SPCAUT +
                          41 10)))
             CHGVAR     VAR(&SPC35) VALUE(&SPC35 *CAT &SPC35)
             IF         COND(%SST(&SPCAUT 51 10) = *SPLCTL) +
                          THEN(CHGVAR VAR(&SPC36) VALUE(%SST(&SPCAUT +
                          51 10)))
             CHGVAR     VAR(&SPC36) VALUE(&SPC36 *CAT &SPC36)
             CHGVAR     VAR(&SORT) VALUE(&SPC1 *TCAT &SPC2 *TCAT +
                          &SPC3 *TCAT &SPC4 *TCAT &SPC5 *TCAT &SPC6 +
                          *TCAT &SPC21 *TCAT &SPC22 *TCAT &SPC23 +
                          *TCAT &SPC24 *TCAT &SPC25 *TCAT &SPC26 +
                          *TCAT &SPC31 *TCAT &SPC32 *TCAT &SPC33 +
                          *TCAT &SPC34 *TCAT &SPC35 *TCAT &SPC36)
                          GOTO CHK
 CHK:        IF         COND(&SORT = &COMPARE) THEN(GOTO CMDLBL(AUT))
             ELSE       CMD(GOTO CMDLBL(MSG1))
 MSG1:       SNDBRKMSG  MSG(&MSG3 *CAT &USERCLS *CAT &MSG4 *CAT +
                          &SPCAUT *CAT &MSG1 *CAT &COMPARE *CAT +
                          &MSG2) TOMSGQ(&JOB) MSGTYPE(*INFO)
             GOTO EXIT
 MSG2:       SNDUSRMSG  MSG(&MSG3 *CAT &USERCLS *CAT &MSG4 *CAT +
                          &SPCAUT *CAT &MSG5 *CAT &GRP *CAT &MSG6)
             GOTO EXIT

 AUT:        TFRCTL     PGM(&CALLPGMLIB/&CALLPGM)

 EXIT:       CALL       PGM(QCMD)
             ENDPGM
