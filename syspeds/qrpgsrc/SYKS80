     H debug(*yes)
     FKODTVA    IF   E           K DISK
     FSAEV      IF   E           K DISK
     FSADAVGE   IF   E           K DISK
     Fkosbu12   UF   E           K DISK
     FSYKS80FM  CF   E             WORKSTN
     Fkostt     uf   e           k DISK
     Fheadf     if   e           k DISK
     FKODTÅ     if   e           k DISK
     FLEVEL01   if   e           k DISK
     Fsadh11    if   e           k DISK
     Fsaeh11    if   e           k DISK
     Fvalul01   if   e           k DISK
     Ffakt      uf   e           k DISK
     Ffirm      if   e           k DISK
     FfirmDAG   if   e           k DISK
     Fkosta     uf a e           k DISK
     Fkosta2    if   e           k DISK
     F                                     RENAME(KOSTAR:KOSTA2R)
     Fkostb     o  a e             DISK
      *""""""""""""""""""""""""
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  Xtime                  1     14  0
     D  Xtm                    1      6  0
     D  Xdg                    7      8  0
     D  Xmn                    9     10  0
     D  Xar                   11     14  0
     D  XarTO                 13     14  0
     D                 DS
     D  kadte                  1      8  0
     D  KAARE                  1      4  0
     D  KAMNE                  5      6  0
     D  KADGE                  7      8  0
      *
      * fortollet dato 1
      *
     D                 DS
     D  tdato1                 1      8  0
     D  taaru1                 1      4  0
     D  tmndu1                 5      6  0
     D  tdagu1                 7      8  0
      *
      * fortollet dato 2
      *
     D                 DS
     D  tdato2                 1      8  0
     D  taaru2                 1      4  0
     D  tmndu2                 5      6  0
     D  tdagu2                 7      8  0
      *
      * fortollet dato 3
      *
     D                 DS
     D  tdato3                 1      8  0
     D  taaru3                 1      4  0
     D  tmndu3                 5      6  0
     D  tdagu3                 7      8  0
      *
      * fortollet dato 4
      *
     D                 DS
     D  tdato4                 1      8  0
     D  taaru4                 1      4  0
     D  tmndu4                 5      6  0
     D  tdagu4                 7      8  0
      *
      *
      *
      * fortollet dato 5
      *
     D                 DS
     D  tdato5                 1      8  0
     D  taaru5                 1      4  0
     D  tmndu5                 5      6  0
     D  tdagu5                 7      8  0
      *
      * fortollet dato 6
      *
     D                 DS
     D  tdato6                 1      8  0
     D  taaru6                 1      4  0
     D  tmndu6                 5      6  0
     D  tdagu6                 7      8  0
      *
      * fortollet dato 7
      *
     D                 DS
     D  tdato7                 1      8  0
     D  taaru7                 1      4  0
     D  tmndu7                 5      6  0
     D  tdagu7                 7      8  0
      *
      * fortollet dato 8
      *
     D                 DS
     D  tdato8                 1      8  0
     D  taaru8                 1      4  0
     D  tmndu8                 5      6  0
     D  tdagu8                 7      8  0
      *
      *
      * bilagsdato
      *
     D                 DS
     D  bdatou                 1      8  0
     D  baaru                  1      4  0
     D  bmndu                  5      6  0
     D  bdagu                  7      8  0
      *
      * INITIERER VARIABLE
      *
     c                   exsr      init
      *
     c     start         tag
      *
      *
     C                   EXFMT     BILDE01
      *
     c   03              goto      slutt
      *
     c                   exsr      testsr
     c   30              goto      start
      *
      * dato 1 import
      *
     c     key01         setll     sadh11
     c     *in34         doweq     '0'
     c     key01         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 1 export
      *
     c                   setoff                                       34
     c     key01         setll     saeh11
     c     *in34         doweq     '0'
     c     key01         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 2 import
      *
     c     taar2         ifne      *zeros
     c                   setoff                                       34
     c     key02         setll     sadh11
     c     *in34         doweq     '0'
     c     key02         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      * dato 2 export
      *
     c                   setoff                                       34
     c     key02         setll     saeh11
     c     *in34         doweq     '0'
     c     key02         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * dato 3 import
      *
     c     taar3         ifne      *zeros
     c                   setoff                                       34
     c     key03         setll     sadh11
     c     *in34         doweq     '0'
     c     key03         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 3 export
      *
     c                   setoff                                       34
     c     key03         setll     saeh11
     c     *in34         doweq     '0'
     c     key03         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * dato 4 IMPORT
      *
     c     taar4         ifne      *zeros
     c                   setoff                                       34
     c     key04         setll     sadh11
     c     *in34         doweq     '0'
     c     key04         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 4  EXPORT
      *
     c                   setoff                                       34
     c     key04         setll     saeh11
     c     *in34         doweq     '0'
     c     key04         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * dato 5 IMPORT
      *
     c     taar5         ifne      *zeros
     c                   setoff                                       34
     c     key05         setll     sadh11
     c     *in34         doweq     '0'
     c     key05         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 5  EXPORT
      *
     c                   setoff                                       34
     c     key05         setll     saeh11
     c     *in34         doweq     '0'
     c     key05         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * dato 6 IMPORT
      *
     c     taar6         ifne      *zeros
     c                   setoff                                       34
     c     key06         setll     sadh11
     c     *in34         doweq     '0'
     c     key06         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 6  EXPORT
      *
     c                   setoff                                       34
     c     key06         setll     saeh11
     c     *in34         doweq     '0'
     c     key06         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * dato 7 IMPORT
      *
     c     taar7         ifne      *zeros
     c                   setoff                                       34
     c     key07         setll     sadh11
     c     *in34         doweq     '0'
     c     key07         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 7  EXPORT
      *
     c                   setoff                                       34
     c     key07         setll     saeh11
     c     *in34         doweq     '0'
     c     key07         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * dato 8 IMPORT
      *
     c     taar8         ifne      *zeros
     c                   setoff                                       34
     c     key08         setll     sadh11
     c     *in34         doweq     '0'
     c     key08         reade     sadh11                                 34
     c     *in34         ifeq      '0'
     c     sikddk        andeq     'D'
     c     sibel7        andne     0
     c     sist          andne     'F'
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
      *
      * dato 8  EXPORT
      *
     c                   setoff                                       34
     c     key08         setll     saeh11
     c     *in34         doweq     '0'
     c     key08         reade     saeh11                                 34
     c     *in34         ifeq      '0'
     c     sekddk        andeq     'D'
     c                   exsr      moveei
     c                   exsr      finsum
     c                   exsr      kostbsr
     c                   endif
     c                   enddo
     c                   end
      *
      * skriv til kosta
      *
     C     TOTALSUM      IFNE      0
     c                   exsr      kostasr
     C                   END
      *
     c     slutt         tag
     c                   seton                                        lr
     c                   return
     c***************************************************************
     c     kostasr       begsr
     c***************************************************************
     c                   clear                   kostar
     c                   z-add     ukabnr        kabnr
     C                   MOVE      DGGEB1        KAVK
     c                   movel     dgtext        katxt
      *
      * fakturanummer
      *
     c                   movel     faktnr        kafnr
      *
      * leverandørnummer
      *
     c                   z-add     levnr         kalnr
      *
      * kid-nr(3)
      *
     c                   movel     kid           kalkid
      *
      * valutakode
      *
     C                   MOVE      FICURR        KAVAL
      *
     c                   z-add     100           kavku
     c                   z-add     100           kaomrf
     c                   z-add     1             uvku
      *
     c     keyval        chain     valul01                            34
     c     *in34         ifeq      '0'
     c                   z-add     valku1        kavku
     c                   z-add     omrfak        kaomrf
     C     kavku         DIV       OMRFAK        UVKU             10 7
     c                   end
      *
      *
      * totalsum
      *
     c                   z-add     totalsum      kabl
      *
     c                   move      'F'           kamva
      *
      * fakturadato
      *
     C                   z-add     bdatou        KAfdt
      *
      * forfallsdato
      *
     c                   z-add     bdatou        kaffdt
      *
      * periode ccaamm
      *
     c                   movel     20            kapcc
     c                   move      paar          kapÅr
     c                   move      pmnd          kapmn
      *
      * henter bilagsnummer
      *
     c                   z-add     bilnr         kabnr2
      *
     C     KABNR2        IFEQ      0
     C     DGSERI        ANDNE     *BLANKS
     c     DGSERI        chain     kostt                              35
     c  N35              z-add     ktnr          KABNR2            7 0
     c  N35              add       1             ktnr
     c  N35              update    kosttr
     C                   END
      *
      * henter bruker
      *
     C                   MOVEL     ZUSER         KAUSER
     C                   MOVEL     'EDI'         KASG
     C                   MOVE      XTM           KATME
     C                   MOVE      XDG           KADGE
     C                   MOVE      XMN           KAMNE
     C                   MOVE      XAR           KAARE
     C                   MOVE      KAfdt         KAbdt
     C                   MOVE      KADTE         KADTR
     C                   MOVE      KATME         KATDR
     C                   MOVE      *ZEROS        KAJOUR
     c                   write     kostar
     c                   endsr
     c***************************************************************
     c     testsr        begsr
     c***************************************************************
     c                   setoff                                       309798
     c                   setoff                                       969995
     c                   setoff                                       948182
     c                   setoff                                       8384
     c                   setoff                                       858687
     c                   setoff                                       88
      *
      *fortollet dato 1
      *
     c     taar1         add       2000          taaru1
     c                   z-add     tmnd1         tmndu1
     c                   z-add     tdag1         tdagu1
     c                   movel     tdato1        keysad1
     C                   MOVE      TDAG1         UDTD              2 0
     C                   MOVE      TMND1         UDTM              2 0
     C                   MOVE      TAAR1         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      81
     C  N81TAAR1         COMP      XARIF                                81
     C   81              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
      *
      *
      *fortollet dato 2
      *
     c     taar2         ifne      *zeros
     c     taar2         add       2000          taaru2
     c                   z-add     tmnd2         tmndu2
     c                   z-add     tdag2         tdagu2
     c                   movel     tdato2        keysad2
     C                   MOVE      TDAG2         UDTD              2 0
     C                   MOVE      TMND2         UDTM              2 0
     C                   MOVE      TAAR2         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      82
     C  N82TAAR2         COMP      XARIF                                82
     C   82              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     C                   end
      *
      *
      *fortollet dato 3
      *
     c     taar3         ifne      *zeros
     c     taar3         add       2000          taaru3
     c                   z-add     tmnd3         tmndu3
     c                   z-add     tdag3         tdagu3
     c                   movel     tdato3        keysad3
     C                   MOVE      TDAG3         UDTD              2 0
     C                   MOVE      TMND3         UDTM              2 0
     C                   MOVE      TAAR3         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      83
     C  N83TAAR3         COMP      XARIF                                83
     C   83              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     c                   end
      *
      *
      *fortollet dato 4
      *
     c     taar4         ifne      *zeros
     c     taar4         add       2000          taaru4
     c                   z-add     tmnd4         tmndu4
     c                   z-add     tdag4         tdagu4
     c                   movel     tdato4        keysad4
     C                   MOVE      TDAG4         UDTD              2 0
     C                   MOVE      TMND4         UDTM              2 0
     C                   MOVE      TAAR4         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      84
     C  N84TAAR4         COMP      XARIF                                84
     C   84              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     c                   end
      *
      *
      *fortollet dato 5
      *
     c     taar5         ifne      *zeros
     c     taar5         add       2000          taaru5
     c                   z-add     tmnd5         tmndu5
     c                   z-add     tdag5         tdagu5
     c                   movel     tdato5        keysad5
     C                   MOVE      TDAG5         UDTD              2 0
     C                   MOVE      TMND5         UDTM              2 0
     C                   MOVE      TAAR5         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      85
     C  N85TAAR5         COMP      XARIF                                85
     C   85              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     C                   end
      *
      *
      *fortollet dato 6
      *                             n
     c     taar6         ifne      *zeros
     c     taar6         add       2000          taaru6
     c                   z-add     tmnd6         tmndu6
     c                   z-add     tdag6         tdagu6
     c                   movel     tdato6        keysad6
     C                   MOVE      TDAG6         UDTD              2 0
     C                   MOVE      TMND6         UDTM              2 0
     C                   MOVE      TAAR6         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      86
     C  N86TAAR6         COMP      XARIF                                86
     C   86              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     C                   end
      *
      *
      *fortollet dato 7
      *
     c     taar7         ifne      *zeros
     c     taar7         add       2000          taaru7
     c                   z-add     tmnd7         tmndu7
     c                   z-add     tdag7         tdagu7
     c                   movel     tdato7        keysad7
     C                   MOVE      TDAG7         UDTD              2 0
     C                   MOVE      TMND7         UDTM              2 0
     C                   MOVE      TAAR7         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      87
     C  N87TAAR7         COMP      XARIF                                87
     C   87              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     c                   end
      *
      *
      *fortollet dato 8
      *
     c     taar8         ifne      *zeros
     c     taar8         add       2000          taaru8
     c                   z-add     tmnd8         tmndu8
     c                   z-add     tdag8         tdagu8
     c                   movel     tdato8        keysad8
     C                   MOVE      TDAG8         UDTD              2 0
     C                   MOVE      TMND8         UDTM              2 0
     C                   MOVE      TAAR8         UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      88
     C  N88TAAR4         COMP      XARIF                                88
     C   88              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
     c                   end
      *
      *
      *
      *bilagsdato
      *
     c     baar          add       2000          baaru
     c                   z-add     bmnd          bmndu
     c                   z-add     bdag          bdagu
     C                   MOVE      BDAG          UDTD              2 0
     C                   MOVE      BMND          UDTM              2 0
     C                   MOVE      BAAR          UDTÅ              2 0
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      98
     C  N98BAAR          COMP      XARTO                              98
     C  N98bAAR          COMP      XARIF                                98
     C   98              SETON                                        30
     C   30              MOVE      'SPD0001'     MSGNR
     C   30              GOTO      UTTST
      *
      *PERIODE   dato
     C     KODTÅK        CHAIN     KODTÅ                              96
     C   96              SETON                                        30
     C   30              MOVE      'SPP0001'     MSGNR
     C   30              GOTO      UTTST
      *
     C     LEVNR         IFNE      *ZEROS
     C     LEVE1K        CHAIN     LEVEL01                            99
     C  N99AKTKOD        COMP      'A'                                9999
     C     *IN99         IFEQ      '1'
     c                   seton                                        30
     C                   MOVE      'SPL0029'     MSGNR
     C                   GOTO      UTTST
     c                   end
     c                   end
      *
     C* KOMBINASJONEN LEVERANDØR / LEVERANDØRS NR ER BENYTTET FØR ??
     C* (PÅ ANNET BILAG ENN DET SOM NÅ BLIR LAGET / ENDRET).
     c     faktnr        ifne      *blanks
     C     KOSA2K        CHAIN     KOSTA2                             33
     c  N33KAST          COMP      'D'                                33
     C     *IN33         IFEQ      '0'
     C     faktnr        oreq      *blanks
     C                   MOVE      'JOV0220'     MSGNR
     C                   SETON                                        3095
     C                   GOTO      UTTST
     C                   END
     C                   END
     c     UTTST         endsr
     c***************************************************************
     c     kostbsr       begsr
     c***************************************************************
      *
     c                   clear                   kostbr
      *
      * FLYTTER BILAGSNUMMER
     c                   z-add     UKABNR        kBbnr
      *
     c                   movel     sitll         kbbilt
      *
      * avd
      *
     c                   z-add     siavd         kbavd
      *
      * opdnr
      *
     c                   z-add     sitdn         kbopd
      *
     C                   MOVE      SIKNK         KBKN
      *
      * TEST HVIS KUNDE MANGLER
      *
     C     HEAKEY        CHAIN     HEADF                              20
     C   20              move      9             KBNØKK
     c     siknk         ifeq      *zeros
     C     *IN20         IFEQ      '0'
     c     hekdfk        ifne      'X'
     C                   MOVE      HEKNKF        KBKN
     c                   else
     c     hekdfs        ifne      'X'
     c                   move      heknsf        KBKN
     c                   end
     c                   end
      * behandlin hvis inger fakturapart på oppdraget
     c     kbkn          ifeq      0
      *
      * import
      *
     c     heur          ifeq      'A'
     c     heur          oreq      'C'
     c     heur          oreq      'E'
     c     heur          oreq      'F'
     c     heknk         andne     0
     c     heknk         andlt     9000000
     c                   move      heknk         kbkn
     c                   end
     c
      *
      * eksport
      *
     c     heur          ifeq      'B'
     c     heur          oreq      'E'
     c     heur          oreq      'G'
     c     hekns         andne     0
     c     hekns         andlt     9000000
     c                   move      hekns         kbkn
     c                   end
     c                   end
      *
      * generell kjøper
      *
     c     kbkn          ifeq      0
     c     heknk         andne     0
     c     heknk         andlt     9000000
     c                   move      heknk         kbkn
     c                   end
      *
      * generell selger
      *
     c     kbkn          ifeq      0
     c     hekns         andne     0
     c     hekns         andlt     9000000
     c                   move      hekns         kbkn
     c                   end
      *
      * generell kjøpers fakturamottager
      *
     c     kbkn          ifeq      0
     c     heknkf        andne     0
     c     heknkf        andlt     9000000
     c                   move      heknkf        kbkn
     c                   end
      *
      * generell selgers fakturamottager
      *
     c     kbkn          ifeq      0
     c     heknsf        andne     0
     c     heknsf        andlt     9000000
     c                   move      heknsf        kbkn
     c                   end
     c                   end
     c                   end
      *
      *
      * MOMSKODE
      *
     c                   movel     'F'           kamva
     c                   move      'F'           KBKDPF
     c                   z-add     0             KBKDM
      *
      * BELØP  toll/mva
      *
     c                   move      *zeros        toll             13 2
     c                   move      *zeros        mva              13 2
     c*
     C     SIBEL6        IFGT      50                                              4<-B
     C     SIBEL7        SUB       SIBEL6        toll
     C                   Z-ADD     SIBEL6        mva
     C                   ELSE                                                      4
     C                   MOVE      *ZEROS        mva
     C     SIBELT        IFGE      5                                                5<-B
     C                   Z-ADD     SIBELT        toll
     C                   ELSE                                                       5
     C                   MOVE      *ZEROS        toll
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C     TOLL          ADD       MVA           TOTNET           11 0
     c                   SUB       TOTNET        totalsum         11 0
      *
      *    skriver TOLL til fil
      *
     c     toll          ifne      *zeros
      * gebyrkode
      *
     c                   movel     DGGEB2        kbvk
     c*
     c                   Z-ADD     toll          kbblhb
     c                   write     kostbr
     c                   end
      *
      *
      *    skriver MVA  til fil
      *
     c     mva           ifne      *zeros
      * gebyrkode
      *
     c                   movel     DGGEB3        kbvk
     c*
     c                   z-add     mva           kbblhb
     c                   write     kostbr
     c                   end
      *
     c     toll          ifne      *zeros
     c     mva           ORNE      *zeros
     c                   exsr      budsr
     c                   end
      *
     c                   endsr
      *
     c***********************************************************************
     c     init          begsr
     c***********************************************************************
      *
     C     KOSA2K        KLIST
     C                   KFLD                    LEVNR
     C                   KFLD                    FAKTNR
     C                   KFLD                    PAAR
     c     leve1k        klist
     c                   kfld                    fifirm
     c                   kfld                    levnr
     c     key01         klist
     c                   kfld                    keysad1          10
     c     key02         klist
     c                   kfld                    keysad2          10
     c     key03         klist
     c                   kfld                    keysad3          10
     c     key04         klist
     c                   kfld                    keysad4          10
     c     key05         klist
     c                   kfld                    keysad5          10
     c     key06         klist
     c                   kfld                    keysad6          10
     c     key07         klist
     c                   kfld                    keysad7          10
     c     key08         klist
     c                   kfld                    keysad8          10
     c     heakey        klist
     c                   kfld                    kbavd
     c                   kfld                    kbopd
     C     KODTÅK        KLIST
     C                   KFLD                    YÅUNI
     C                   KFLD                    PCC
     C                   KFLD                    PAAR
     C                   KFLD                    PMND
     C                   MOVE      'K'           YÅUNI             1
     C                   Z-ADD     20            PCC               2 0
     c                   read      firm                                   33
     C     FIFIRM        CHAIN     FIRMDAG                            33
     C                   Z-ADD     DGLEVN        LEVNR
     c                   time                    xtime
     C                   MOVE      XTM           KATME
     C                   MOVE      XDG           KADGE
     C                   MOVE      XMN           KAMNE
     C                   MOVE      XAR           KAARE
     c     xarto         sub       1             xarif             2 0
     c     keyval        klist
     c                   kfld                    fifirm
     c                   kfld                    kaval
      * VARIABLE VAT
     C                   MOVE      FITAX         FITAXB            4 4
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     KADTE         ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAXB            4 4
     C                   END
      *
      * henter preregnummer
      *
     c     'Ø'           chain     kostt
     c                   z-add     ktnr          ukabnr            7 0
     c                   add       1             ktnr
     c                   update    kosttr
     c                   time                    xtime
     c                   endsr
      *
     C***********************************************
     C     SJDATO        BEGSR
     C***********************************************
     C                   CALL      'TESTDATO'
     C                   PARM                    UDTD
     C                   PARM                    UDTM
     C                   PARM                    UDTÅ
     C                   PARM                    UFLAGG            1 0
     C*
     C                   ENDSR
     C*
     c***********************************************************************
     C     budsr         begsr
     c***********************************************************************
     c     bukey         klist
     c                   kfld                    kbavd
     c                   kfld                    kbopd
      *
     C                   setoff                                       33
     C     bukey         setll     kosbu12
     C     *in(33)       doweq     '0'
     C     bukey         reade     kosbu12                                33
     c     *in33         ifeq      '0'
     c     bust          andne     'F'
     C     BUVK          ifeq      'TOL'
     C     BUVK          oreq      'MVA'
     c                   move      'F'           bust
     c                   z-add     kabnr         bubnr2
     c                   z-add     kalnr         bulnr
     c                   update    kosbur
     C                   endif
     C                   endif
     C                   enddo
     C                   endsr
     c***********************************************************************
     C     moveei        begsr
     c***********************************************************************
      *move variable fra export til import
     c                   movel     setll         sitll
      *
      * avd
      *
     c                   z-add     seavd         siavd
     c                   z-add     siavd         kbavd
      *
      * opdnr
      *
     c                   z-add     setdn         sitdn
     c                   z-add     sitdn         kbopd
      *
      *
      *
     C                   MOVE      SEKNK         SIKNK
     c*
     c* beløpsrubrikke
     C                   Z-ADD     *zeros        SIBEL6
     C                   Z-ADD     *zeros        SIBEL7
     C                   Z-ADD     *zeros        SIBELT
     c                   endsr
     C***********************************************
     C     FINSUM        BEGSR
     C***********************************************
     C     AVGEK         KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    AGAKD
     C                   KFLD                    SVAVTS
     C                   MOVE      'FF'          AGAKD
     C     AVGEK2        KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    AGAKD
     C                   KFLD                    SVAVTS
     C                   KFLD                    SEDT
     C     KODVAK        KLIST
     C                   KFLD                    KVAUNI
     C                   KFLD                    SEVAL1
     C                   MOVE      'VA'          KVAUNI
     C*** SUMMERE TOLLVERDIER PÅ HVER ENKEL POST OG REGNE DIFFERANSE.
     C                   MOVE      *ZEROS        W2VSUM           13 2
     C                   MOVE      *ZEROS        XAVGTT
     C     KODVAK        CHAIN     KODTVA                             34
     C     SEBEL1        MULT(H)   SEVKU         XWORK2           17 5
     C   34SEVAL1        IFEQ      'IEP'
     C                   Z-ADD     1             KVAOMR
     C                   ELSE
     C                   Z-ADD     100           KVAOMR
     C                   END
     C                   DIV(H)    KVAOMR        XWORK2
     C     SEFTG2        IFEQ      '-'
     C     SEFTG2        OREQ      'M'
     C                   SUB       SEBEL3        XWORK2
     C                   ELSE
     C                   ADD       SEBEL3        XWORK2
     C                   END
     C                   IF        SEBEL1 = 0
     C                   MOVE      *ZEROS        XWORK2
     C                   ELSE
     C                   DIV(H)    SEBEL1        XWORK2
     C                   END
     C     BUKEY         SETLL     SAEV
     C*
     C     STFS          TAG
     C     BUKEY         READE     SAEV                                   33
     C  N33              DO
     C                   ADD       SVBELT        W2VSUM
     C     SVAVT         IFEQ      'X'
     C     SVBELT        ANDNE     0
     C     SVBELT        MULT      SVAVTP        XWORK            15 2
     C     AVGEK2        SETLL     SADAVGE
     C     AVGEK         READPE    SADAVGE                                33
     C  N33AGDTT         COMP      SEDT                                 3333
     C     *IN33         IFEQ      '0'
     C     AGPP          ANDEQ     '%'
     C                   DIV(H)    100           XWORK
     C                   ELSE
     C                   DIV(H)    1000          XWORK
     C                   END
     C                   MULT(H)   XWORK2        XWORK
     C                   ADD(H)    XWORK         XAVGTT            9 0
     C                   END
     C                   GOTO      STFS
     C                   END
     C*
     C                   z-add     XAVGTT        sibelT
     C*
     C                   ENDSR
     C*
