********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 ANTALL BOKSER RETTET slik som vekt
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL VISE BOX-INFORMASJONER
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 04 06-11 13-24
      *** LEDIGE INDIKATORER 27-29 31-90 95-97
      **************************************************************
      *
     FHEADF     UF   E           K DISK
     FGSSBXF    IF   E           K DISK
     FGSS047D   CF   E             WORKSTN
     F                                     SFILE(GSS047DA:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN(93)
     C                   WRITE     GSS047DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *BLANKS       WSNR
     C                   MOVE      *ZEROS        WSVKTT
n01  C                   MOVE      *ZEROS        WSBOXT
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     UTNO          SETLL     GSSBXF
     C     UTNO          READE     GSSBXF                                 94
      *
     C                   DOW       *IN94 = *OFF
     C                   ADD       1             ZRECNO
     C                   ADD       BXVKT         WSVKTT
N01  C                   ADD       1             WSBOXT
     C                   ADD       BXM3          WSM3T
     C                   ADD       BXLM          WSLMT
     C                   IF        BXID = *BLANKS
     C                   MOVE      BXCN          XXIDCN
     C                   ELSE
     C                   MOVE      BXID          XXIDCN
     C                   END
     C                   WRITE     GSS047DA
     C     UTNO          READE     GSSBXF                                 94
     C  N94              ENDDO
      *
     C                   IF        ZRECNO > 1
     C                   Z-ADD     1             ZRECNO
     C                   END
      *
     C     START3        TAG
     C  N30              Z-ADD     4             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS047DG
     C                   ELSE
     C                   WRITE     GSS047DC
     C                   EXFMT     GSS047DB
     C                   END
      *
      *** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
      *
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C   10              DO
     C     HEADFK        CHAIN     HEADF                              33
     C                   IF        *IN33 = *OFF
S01  C*                  Z-ADD     BXTOT         HENT
N01  C                   Z-ADD     WSBOXT        HENT
     C                   Z-ADD     WSVKTT        HEVKT
     C                   IF        WSM3T <> 0
     C                   Z-ADD     WSM3T         HEM3
     C                   END
     C                   IF        WSLMT <> 0
     C                   Z-ADD     WSLMT         HEM3
     C                   END
     C                   UPDATE    HEADFR
     C                   END
     C                   GOTO      START
     C                   ENDDO
     C   12              GOTO      SLUTT
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HHENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HHENT         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVE      '0'           *IN99
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS047DA                               98
     C   98              DO
     C   99              MOVE      '0'           *IN98
     C                   GOTO      SLHENT
     C                   END
      *
     C     ZRECNO        DIV       10            LINNBR
     C                   MVR                     XLIN              1 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     10            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   SELECT
     C     WSNR          WHENEQ    '5'
     C                   EXSR      DSPBOX
     C                   OTHER
     C                   MOVE      '1'           *IN98
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS047DA
     C                   GOTO      SLHENT
     C                   ENDSL
     C                   MOVE      '1'           *IN99
      *
     C                   END
      *
     C     SLHENT        TAG
     C                   MOVE      '0'           *IN99
     C   98MSGNR         IFEQ      *BLANKS
     C                   MOVE      'GSS0009'     MSGNR
     C                   END
     C   98              MOVE      '1'           *IN30
     C  N30              Z-ADD     4             LINNBR
     C   30              ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO             11 0
      *
     C                   MOVEL     UTNO          HEAVD
     C                   MOVE      UTNO          HEOPD
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPBOX        BEGSR
     C***********************************************
     C     STDSP         TAG
     C                   EXFMT     GSS047DD
     C     *IN12         CABEQ     *OFF          STDSP
      *
     C                   MOVE      '1'           *IN90
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS047DA
     C                   MOVE      '0'           *IN90
      *
     C                   ENDSR
      *
