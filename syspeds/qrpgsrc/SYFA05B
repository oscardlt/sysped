      *
      ************************************************************
      *** PROGRAM SKAL  KOPIERE     KUNDERS LEVERINGSADRESSE   ***
      ***               ADRESSE 1 KOPIERES IKKE                ***
      ************************************************************
     FVADR      IF   E           K DISK
     FVADROPD   UF A E           K DISK
     F                                     RENAME(VADRR:VADRRO)
     FKUNKO     UF A E           K DISK
      *
     D VA              S              5  0 DIM(9999)
      *
     C                   EXSR      INIT
      * 55 OFF =ALLE,   55 ON = KUN EN ADRESSE
     C     *IN55         IFEQ      *OFF
     C     KOPKEY        SETLL     VADR
     C     KOPKEY        READE     VADR                                   33
     C                   ELSE
     C     KOPKE1        SETLL     VADR
     C     KOPKE1        READE     VADR                                   33
     C                   END
     C     *IN33         DOWEQ     '0'
     C     VADRNR        IFEQ      1
     C     *IN55         ANDEQ     '0'
     C                   GOTO      SKIPP1
     C                   END
     C                   EXSR      MOVVAX
     C     NYKEY         CHAIN     VADROPD                            34
     C     *IN34         IFEQ      '1'
     C                   MOVE      WSKUNR        KUNDNR
     C                   WRITE     VADRRO
     C                   EXSR      KRYREF
     C                   ELSE
     C     WSDUPK        IFEQ      '0'
     C     *IN55         ANDEQ     '1'
     C                   MOVE      *ZEROS        WSADR                           FLAGG
     C                   END
      * Finnes fra før: 0=Hopp over, 1= Overskriv, 2=Legg til/eget nr.
     C     WSDUPK        IFEQ      '1'
     C                   EXSR      MOVXVA
     C                   UPDATE    VADRRO
     C                   EXSR      KRYREF
     C                   END
     C     WSDUPK        IFEQ      '2'
     C                   ADD       1             NR                5 0
     C                   MOVE      VADRNR        VA(NR)
     C                   END
     C                   END                                                     *IN34
     C*
     C     SKIPP1        TAG
     C     *IN55         IFEQ      *OFF
     C     KOPKEY        READE     VADR                                   33
     C                   ELSE
     C     KOPKE1        READE     VADR                                   33
     C                   END
     C                   END
      *
      *
      * ADRESSE-NR MED KONFLIKT, SOM SKAL SKRIVES I NYE NR
     C     WSDUPK        IFEQ      '2'
     C     NR            ANDGT     *ZEROS
     C                   Z-ADD     1             NXTNR             5 0
     C     1             DO        NR            N2                5 0
     C                   EXSR      GETNXT
     C                   MOVE      VA(N2)        VADRNR
     C     KOPKE2        CHAIN     VADROPD                            34
     C                   MOVE      NXTNR         VADRNR
     C                   MOVE      WSKUNR        KUNDNR
     C                   WRITE     VADRRO
     C                   EXSR      KRYREF
     C                   END
     C                   END
     C*
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     GETNXT        BEGSR
     C***********************************************
      * FINN NESTE NR (OGSÅ HULL UTNYTTES.. (LIK F9 INTERAKTIVT)
     C                   MOVE      *OFF          *IN34
     C     *IN34         DOWEQ     *OFF
     C                   ADD       1             NXTNR
     C                   MOVE      NXTNR         VADRNR
     C     NYKEY         CHAIN     VADROPD                            34
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVVAX        BEGSR
     C***********************************************
      *
     C                   MOVE      AKTKOD        XKTKOD
     C                   MOVE      JOURNR        XOURNR
     C                   MOVE      FIRMA         XIRMA
     C                   MOVE      KUNDNR        XUNDNR
     C                   MOVE      VADRNR        XADRNR
     C                   MOVE      VADRNA        XADRNA
     C                   MOVE      VADRN1        XADRN1
     C                   MOVE      VADRN2        XADRN2
     C                   MOVE      VADRN3        XADRN3
     C                   MOVE      SONAVN        XONAVN
     C                   MOVE      DISTR         XISTR
     C                   MOVE      RUTENR        XUTENR
     C                   MOVE      SEKVNR        XEKVNR
     C                   MOVE      VAREGN        XAREGN
     C                   MOVE      VAKON1        XAKON1
     C                   MOVE      VAKON2        XAKON2
     C                   MOVE      VARG          XARG
     C                   MOVE      VASTAT        XASTAT
     C                   MOVE      VALAND        XALAND
     C                   MOVE      VAKURE        XAKURE
     C                   MOVE      VATLF         XATLF
     C                   MOVE      VAFAX         XAFAX
     C                   MOVE      VAMAIL        XAMAIL
     C*
     C                   ENDSR
      *
     C***********************************************
     C     MOVXVA        BEGSR
     C***********************************************
      *
     C                   MOVE      XKTKOD        AKTKOD
     C                   MOVE      XOURNR        JOURNR
     C                   MOVE      XIRMA         FIRMA
     C                   MOVE      WSKUNR        KUNDNR
     C                   MOVE      XADRNR        VADRNR
     C                   MOVE      XADRNA        VADRNA
     C                   MOVE      XADRN1        VADRN1
     C                   MOVE      XADRN2        VADRN2
     C                   MOVE      XADRN3        VADRN3
     C                   MOVE      XONAVN        SONAVN
     C                   MOVE      XISTR         DISTR
     C                   MOVE      XUTENR        RUTENR
     C                   MOVE      XEKVNR        SEKVNR
     C                   MOVE      XAREGN        VAREGN
     C                   MOVE      XAKON1        VAKON1
     C                   MOVE      XAKON2        VAKON2
     C                   MOVE      XARG          VARG
     C                   MOVE      XASTAT        VASTAT
     C                   MOVE      XALAND        VALAND
     C                   MOVE      XAKURE        VAKURE
     C                   MOVE      XATLF         VATLF
     C                   MOVE      XAFAX         VAFAX
     C                   MOVE      XAMAIL        VAMAIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KRYREF        BEGSR
     C***********************************************
     C     KUDRK         CHAIN     KUNKO                              44
     C  N44              DO
     C     VAKURE        IFNE      *BLANKS
     C                   MOVE      VAKURE        KUINTN
     C                   MOVE      SONAVN        KUALFA
     C                   UPDATE    KUNKOR
     C                   ELSE
     C                   DELETE    KUNKOR
     C                   END
     C                   END
     C*
     C   44VAKURE        IFNE      *BLANKS
     C                   MOVE      WSKUNR        KUKUN1
     C                   MOVE      WSKUNR        KUKUN2
     C                   MOVE      VAKURE        KUINTN
     C                   MOVE      VADRNR        KUVADR
     C                   MOVE      SONAVN        KUALFA
     C                   WRITE     KUNKOR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    FIFIRM            2
     C                   PARM                    WSKUNR            8 0            TIL
     C                   PARM                    WSKUN2            8 0            FRA
     C                   PARM                    WSADR             5 0            ADR
     C                   PARM                    WSDUPK            1              DUP-KODE
      *
     C     KOPKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKUN2
     C     KOPKE1        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKUN2
     C                   KFLD                    W1ADR
     C                   MOVE      WSADR         W1ADR             5 0
     C     KOPKE2        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKUN2
     C                   KFLD                    VADRNR
     C     NYKEY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKUNR
     C                   KFLD                    VADRNR
      * X-REF KUNDES KUNDE...
     C     KUDRK         KLIST
     C                   KFLD                    WSKUNR
     C                   KFLD                    WSKUNR
     C                   KFLD                    VADRNR
      * 55 ON= KOPIER KUN ETT ADR.NR!!
     C     WSADR         COMP      *ZEROS                             5555
     C                   Z-ADD     0             NR                5 0
      *
     C     *LIKE         DEFINE    AKTKOD        XKTKOD
     C     *LIKE         DEFINE    JOURNR        XOURNR
     C     *LIKE         DEFINE    FIRMA         XIRMA
     C     *LIKE         DEFINE    KUNDNR        XUNDNR
     C     *LIKE         DEFINE    VADRNR        XADRNR
     C     *LIKE         DEFINE    VADRNA        XADRNA
     C     *LIKE         DEFINE    VADRN1        XADRN1
     C     *LIKE         DEFINE    VADRN2        XADRN2
     C     *LIKE         DEFINE    VADRN3        XADRN3
     C     *LIKE         DEFINE    SONAVN        XONAVN
     C     *LIKE         DEFINE    DISTR         XISTR
     C     *LIKE         DEFINE    RUTENR        XUTENR
     C     *LIKE         DEFINE    SEKVNR        XEKVNR
     C     *LIKE         DEFINE    VAREGN        XAREGN
     C     *LIKE         DEFINE    VAKON1        XAKON1
     C     *LIKE         DEFINE    VAKON2        XAKON2
     C     *LIKE         DEFINE    VARG          XARG
     C     *LIKE         DEFINE    VASTAT        XASTAT
     C     *LIKE         DEFINE    VALAND        XALAND
     C     *LIKE         DEFINE    VAKURE        XAKURE
     C     *LIKE         DEFINE    VATLF         XATLF
     C     *LIKE         DEFINE    VAFAX         XAFAX
     C     *LIKE         DEFINE    VAMAIL        XAMAIL
     C                   ENDSR
