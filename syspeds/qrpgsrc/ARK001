      * RETTINGER I DETTE PROGRAM:
PTFnrF*Sek Sig Vers Beskrivelse...........................
"""""F*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P8XXX * 01 SH  PTF8 SETTER IKKE PURREBREVSNUMMER
P8XXX * 02 SH  PTF8 reorg kunder leverandører
P8XXX * 03 SH  PTF9 utbetalingsliste
P8XXX * 04 SH  PTF10 H linje rentenota flyttet 1 pos
P8XXX * 05 SH  PTF10 posteringsjournal
P8XXX * 06 SH  PTF10 ocr innbetalinger
      *****************************************************************
N14  Fsyarktel  uf a E             DISK
N14  Farkwork   Ip   E             DISK
     F                                     RENAME(syarkivr:syarkinn)
N14  Fsyarkivf  o  a E           K DISK
N14  Fsyarkivl1 uF   E           K DISK
     F                                     RENAME(syarkivr:syarkivrl)
     D                 DS
     D  syatxt                 1    132
     D  TXT                    1    132
     D                                     DIM(132)
     D                 DS
     D  b7                     1      7
     D  b7a                    1      7
     D                                     DIM(7)
     D                 DS
     D  b8                     1      8
     D  b8a                    1      8
     D                                     DIM(8)
     D                 DS
     D  XULTID                 1     14  0
     D  SYTID                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  sydato                 1      8  0
     C*___________
     C* initierer
     C*"""""""""""
     C  n99              EXSR      INIT
     C  n99              seton                                        99
     C*
     C* skriver til fil
     C*
     C                   MOVE      'J'           DATA              1
     c                   add       1             sytell
     c                   z-add     sytell        syalin
     c                   move      prtfil        syafil
      *-------------------------------------------------------------------------
      * rentenota
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifge      'DR150U01  '
     c     prtfil        andle     'DR150U99  '
      *skriver ikke innstillingslinjeR
     C                   MOVEA     TXT(10)       TST010           10
     c     TST010        ifeq      'XXXXXXXX--'
     c                   sub       1             sytell
     c                   goto      avbryt
     c                   end
     C                   MOVEA     TXT(1)        TST010           10
     C                   MOVEA     TXT(3)        TST075           75
     c     TST010        ifeq      ' H        '
     c     TST075        ANDEQ     *BLANKS
     c                   sub       1             sytell
     c                   goto      avbryt
     c                   end
n04  c     TST010        ifeq      '  H       '
n04  c     TST075        ANDEQ     *BLANKS
n04  c                   sub       1             sytell
n04  c                   goto      avbryt
n04  c                   end
     c                   exsr      srrenten
     c                   end
      *-------------------------------------------------------------------------
      * purrebrev
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifge      'DR170U01  '
     c     prtfil        andle     'DR170U99  '
      *skriver ikke innstillingslinjeR
     C                   MOVEA     TXT(10)       TST010           10
     c     TST010        ifeq      'XXXXXXXX--'
     c                   sub       1             sytell
     c                   goto      avbryt
     c                   end
     c                   exsr      srpurre
     c                   end
      *-------------------------------------------------------------------------
      * generalnota
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'DR260U01  '
      *skriver ikke innstillingslinjeR
     C                   MOVEA     TXT(10)       TST010           10
     c     TST010        ifeq      'XXXXXXXX--'
     c                   sub       1             sytell
     c                   goto      avbryt
     c                   end
     c                   exsr      srgenno
     c                   end
      *-------------------------------------------------------------------------
      * dagbok
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'HR940U01  '
     c                   exsr      srdagbok
     c                   end
      *-------------------------------------------------------------------------
      * kontoutdrag debitorer
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'DR020U01  '
     c     prtfil        oreq      'KR020U01  '
     c                   exsr      srktodk
     c                   end
N02   *-------------------------------------------------------------------------
N02   * reorganisering av kunder leverandører
N02   *-------------------------------------------------------------------------
N02   *
N02  c     prtfil        ifeq      'VR860U01  '
N02  c     prtfil        oreq      'VR830U01  '
N02  c                   exsr      srreorg
N02  c                   end
      *-------------------------------------------------------------------------
      * DIVERSE AVKRYSSINGER INNBETALINGER
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'HR940U10  '
     c                   exsr      srbbs
     c                   end
n03   *-------------------------------------------------------------------------
n03   * Bekreftelse utbetalinger
n03   *-------------------------------------------------------------------------
n03   *
n03  c     prtfil        ifeq      'KR085U01  '
n03  c                   exsr      srutbet
n03  c                   end
n06   *-------------------------------------------------------------------------
n06   * OCR innbetalinger
n06   *-------------------------------------------------------------------------
n06   *
n06  c     prtfil        ifeq      'DR205U01  '
n06  c                   exsr      srocr
n06  c                   end
n06   *
n06  c     prtfil        ifeq      'DR210U01  '
n06  c                   exsr      srocr2
n06  c                   end
      *-------------------------------------------------------------------------
      * hovedbok
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'HR040U01  '
     c                   exsr      srhovedbok
     c                   end
      *-------------------------------------------------------------------------
      *-------------------------------------------------------------------------
      * Momsoppgjør
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'HR140U01  '
     c                   exsr      srmoms
     c                   end
     c     prtfil        ifeq      'HR142U01  '
     c                   exsr      srmoms2
     c                   end
      *-------------------------------------------------------------------------
      * syspedjournaler
      *-------------------------------------------------------------------------
      *
     c     prtfil        ifeq      'SYFA35P   '
     c     prtfil        oreq      'SYKS35P   '
     c     prtfil        oreq      'SYKR35P   '
     c     prtfil        oreq      'SYTR35P   '
     c                   exsr      srjournal
     c                   end
      *
      *
      *
     c                   write     syarkivr
     c     AVBRYT        TAG
      * avslutte purrebrev
     cLR   prtfil        ifge      'DR170U01  '
     cLR   prtfil        andle     'DR170U99  '
     cLR                 add       1             syalin
     cLR                 exsr      updbakp
     cLR                 end
      * avslutte rentenota
     cLR   prtfil        ifge      'DR150U01  '
     cLR   prtfil        andle     'DR150U99  '
     cLR                 add       1             syalin
     cLR                 exsr      updbakr
     cLR                 end
     cLR   DATA          IFEQ      'J'
     cLRn44              update    syarktelr
     cLR 44              write     syarktelr
     CLR                 END
     c**************************************************************
     C     INIT          BEGSR
     c**************************************************************
     c     *entry        plist
     c                   parm                    firma             2
     c                   parm                    prtfil           10
     c                   parm                    uaar              4
     c                   parm                    uper              2
      *
      * HENT DATO/KLOKKESLETT
      *
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
      *
     C     uaar          ifeq      '    '
     C     uaar          oreq      '0000'
     c                   move      xulÅÅ         uaar
     c                   end
      *
      * henter sist brukte linje
      *
     C                   read      syarktel                               44
     C                   ENDSR
     c**************************************************************
     C     srdagbok      BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
      * start side på dagbok
     C     'D A G B O K' SCAN      syatxt        TN                3 0    20
N05  C  N20'POSTERINGSJ' SCAN      syatxt        TN                3 0    20
     c     *in(20)       ifeq      '1'
     c                   movea     txt(31)       journa            5
     c                   move      journa        journr            5 0
     c                   movel     'D'           jou6              6
     c                   move      journr        jou6
     c                   movel     jou6          sykod1
     c                   movea     txt(84)       syaara            4
     c                   move      syaara        syaar
     c                   movea     txt(127)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     C                   END
      * start linje på bilagsnummer
     c                   movea     txt(1)        b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c                   end
     c                   end
     c                   endsr
     c**************************************************************
     C     srbbs         BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
     c                   movea     TXT(111)      tests             2
     c     tests         ifeq      'Si'
     c                   movea     txt(121)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     C                   END
     c                   endsr
     c**************************************************************
     C     srktodk       BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
     c                   movea     TXT(108)      tests             2
     c     tests         ifeq      'Si'
     c                   movea     txt(118)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     C                   END
     c                   endsr
     c**************************************************************
     C     srreorg       BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
     c                   movea     TXT(107)      tests             2
     c     tests         ifeq      'Si'
     c                   movea     txt(114)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     C                   END
     c                   endsr
n03  c**************************************************************
n03  C     srutbet       BEGSR
n03  c**************************************************************
n03  c                   movel     *blanks       sykod2
n03  c                   movea     TXT(107)      tests             2
n03  c     tests         ifeq      'Si'
n03  c                   movea     txt(117)      sypagea           4
n03  c                   move      sypagea       sypage            4 0
n03  c                   move      sypage        sypage5           5
n03  c                   movel     'P'           sypage5
n03  c                   movel     sypage5       sykod2
n03  C                   END
n03  c                   endsr
n06  c**************************************************************
n06  C     srocr         BEGSR
n06  c**************************************************************
n06  c                   movel     *blanks       sykod2
n06  c                   movea     TXT(117)      tests             2
n06  c     tests         ifeq      'Si'
n06  c                   movea     txt(127)      sypagea           4
n06  c                   move      sypagea       sypage            4 0
n06  c                   move      sypage        sypage5           5
n06  c                   movel     'P'           sypage5
n06  c                   movel     sypage5       sykod2
n06  C                   END
n06  c                   endsr
n06  c**************************************************************
n06  C     srocr2        BEGSR
n06  c**************************************************************
n06  c                   movel     *blanks       sykod2
n06  c                   movea     TXT(108)      tests             2
n06  c     tests         ifeq      'Si'
n06  c                   movea     txt(118)      sypagea           4
n06  c                   move      sypagea       sypage            4 0
n06  c                   move      sypage        sypage5           5
n06  c                   movel     'P'           sypage5
n06  c                   movel     sypage5       sykod2
n06  C                   END
n06  c                   endsr
     c**************************************************************
     C     srjournal     BEGSR
     c**************************************************************
      *
      *sysped fakturajournal kostnadsjournal
      *
     c                   movel     *blanks       sykod2
      * start side på dagbok
     C     'JOURNALNR:'  SCAN      syatxt        TN                3 0    20
     c     *in(20)       ifeq      '1'
     c                   movea     txt(91)       journa7           7
     c                   move      journa7       journr7           7 0
     c                   movel     'J'           jou8              8
     c                   move      journr7       jou8
     c                   movel     jou8          sykod1
     c                   movea     txt(108)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     C                   END
      * start linje på bilagsnummer
     c                   movea     txt(1)        b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c     txt(130)      ifeq      '/'
     c                   movea     txt(131)      syaara2           2
     c                   move      syaara2       syaara
     c                   movel     '20'          syaara
     c                   move      syaara        syaar
     c                   end
     c                   end
     c                   end
     c     syaar         ifeq      *zeros
     c                   move      XULÅÅ         syaar
     c                   end
     c                   endsr
     c**************************************************************
     C     srhovedbok    BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
     c                   move      uaar          syaar
      * start side på hovedbok
     C     'SPESIFISERT' SCAN      syatxt        TN                3 0    20
     c     *in(20)       ifeq      '1'
      *
      * finner sidenummer
      *
     c                   movea     TXT(102)      tests             2
     c     tests         ifeq      'Fø'
     c                   z-add     0             sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     c                   else
     c     tests         ifeq      'Si'
     c                   movea     txt(112)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     c                   end
     c                   end
     c                   end
      *finner regnskapsperiode
     c                   move      uper          per3              3
     c                   movel     'P'           per3
     c                   movel     per3          sykod1
      * start linje på bilagsnummer
     c                   movea     txt(11)       b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c                   end
     c                   end
     c                   endsr
     c**************************************************************
     C     srmoms        BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
     c                   move      uaar          syaar
      * start side på hovedbok
     C     'OPPGJØR'     SCAN      syatxt        TN                3 0    20
     c     *in(20)       ifeq      '1'
      *
      * finner sidenummer
      *
     c                   movea     TXT(108)      tests             2
     c     tests         ifeq      'Fø'
     c                   z-add     0             sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     c                   else
     c     tests         ifeq      'Si'
     c                   movea     txt(118)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     c                   end
     c                   end
     c                   end
      *finner regnskapsperiode
     c                   move      uper          per3              3
     c                   movel     'P'           per3
     c                   movel     per3          sykod1
      * start linje på bilagsnummer
     c                   movea     txt(27)       b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c                   end
     c                   end
     c                   endsr
     c**************************************************************
     C     srmoms2       BEGSR
     c**************************************************************
     c                   movel     *blanks       sykod2
     c                   move      uaar          syaar
      * start side på hovedbok
     C     'momskode'    SCAN      syatxt        TN                3 0    20
     c     *in(20)       ifeq      '1'
      *
      * finner sidenummer
      *
     c                   movea     TXT(119)      tests             2
     c     tests         ifeq      'Fø'
     c                   z-add     0             sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     c                   else
     c     tests         ifeq      'Si'
     c                   movea     txt(129)      sypagea           4
     c                   move      sypagea       sypage            4 0
     c                   move      sypage        sypage5           5
     c                   movel     'P'           sypage5
     c                   movel     sypage5       sykod2
     c                   end
     c                   end
     c                   end
      *finner regnskapsperiode
     c                   move      uper          per3              3
     c                   movel     'P'           per3
     c                   movel     per3          sykod1
     c                   endsr
     c**************************************************************
     C     srrenten      BEGSR
     c**************************************************************
     c**************************************************************
      * finner linjenummer på toppen
      *
     c     forste        ifeq      ' '
     c                   move      syakod        toppli            4
     c                   move      'N'           forste            1
     c                   end
      *
      * hvis ikke første side skal det oppdateres bakover med rentenotanummer
      *
     C     SYAKOD        IFEQ      toppli
     c     fak8          ifne      *blanks
     c                   exsr      updbakr
     c                   end
     C                   END
      *
      *
     c                   move      uaar          syaar
     c                   move      *blanks       sykod1
     c                   move      *blanks       sykod2
     C
      *
      * SKRIVE PAGE   VED LINJE 2 OG LINJE 8
      *
     C     SYAKOD        IFEQ      toppli
     C                   ADD       1             RENTSI            4 0
     C                   MOVEL     'P'           SYPAGE5
     C                   MOVE      RENTSI        SYPAGE5
     C                   MOVEL     SYPAGE5       SYKOD2
     C                   END
      *
      * start linje med fakturanummer
      * legges i sykod2
      *
     C     'Notanr..:'   SCAN      syatxt        TN                3 0    20
     c  N20'Note no.:'   SCAN      syatxt        TN                3 0    20
     c     *in(20)       ifeq      '1'
     c                   movea     txt(66)       b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           fak8              8
     c                   movel     'F'           fak8
     c                   movel     fak8          sykod2
     c                   end
     c                   end
      *
      *
      * start linje med kundenummer
      * legges i sykod2
      *
     C                   MOVEA     TXT(53)       TST006            6
     C     tst006        ifeq      'Kunden'
     C     tst006        oreq      'Cust.n'
     C     tst006        oreq      'Kunden'
     c                   movea     txt(65)       b8                8
     c     1             do        8             nr                2 0
     c     b8a(nr)       ifeq      ' '
     c                   move      '0'           b8a(nr)
     c                   end
     c                   enddo
     C                   TESTN                   b8                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b8            b8n               8 0
     c                   move      b8n           kun9              9
     c                   movel     'K'           kun9
     c                   movel     kun9          sykod2
     c                   end
     c                   end
      *
      * start linje på bilagsnummer
      * legges i sykod2
      *
     c                   movea     txt(1)        b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c                   end
     c                   end
      *
     c                   endsr
     c**************************************************************
     C     srpurre       BEGSR
     c**************************************************************
      * finner linjenummer på toppen
      *
     c     forste        ifeq      ' '
     c                   move      syakod        toppli            4
     c                   move      'N'           forste            1
     c                   end
      *
      * hvis ikke første side skal det oppdateres bakover med purrebrevsnummer
      *
     C     SYAKOD        IFEQ      toppli
     c     pur8          ifne      *blanks
     c                   exsr      updbakp
     c                   end
     C                   END
      *
     c                   move      uaar          syaar
     c                   move      *blanks       sykod1
     c                   move      *blanks       sykod2
     C
      *
      * SKRIVE PAGE   VED toppli
      *
     C     SYAKOD        IFEQ      toppli
     C                   ADD       1             RENTSI            4 0
     C                   MOVEL     'P'           SYPAGE5
     C                   MOVE      RENTSI        SYPAGE5
     C                   MOVEL     SYPAGE5       SYKOD2
     c                   end
      * start linje med purrebrevsnummer
      * legges i sykod1
      *
     C                   MOVEA     TXT(49)       TST004            4
     C     tst004        ifeq      'Refe'
     c                   movea     txt(64)       b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           pur8              8
     c                   movel     'P'           pur8
     c                   movel     pur8          sykod1
     c                   end
     c                   end
      *
      *
      * start linje med kundenummer
      * legges i sykod2
      *
     C                   MOVEA     TXT(49)       TST006            6
     C     tst006        ifeq      'Kunden'
     C     tst006        oreq      'Custom'
     C     tst006        oreq      'Kunden'
     c                   movea     txt(63)       b8                8
     c     1             do        8             nr                2 0
     c     b8a(nr)       ifeq      ' '
     c                   move      '0'           b8a(nr)
     c                   end
     c                   enddo
     C                   TESTN                   b8                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b8            b8n               8 0
     c                   move      b8n           kun9              9
     c                   movel     'K'           kun9
     c                   movel     kun9          sykod2
     c                   end
     c                   end
      *
      * start linje på bilagsnummer
      * legges i sykod2
      *
     c                   movea     txt(2)        b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c                   end
     c                   end
      *
      *
     c                   endsr
     c**************************************************************
     C     srgenno       BEGSR
     c**************************************************************
      * finner linjenummer på toppen
      *
     c     forste        ifeq      ' '
     c                   move      syakod        toppli            4
     c                   move      'N'           forste            1
     c                   end
      *
      * hvis ikke første side skal det oppdateres bakover med purrebrevsnummer
      *
     C     SYAKOD        IFEQ      toppli
     c     pur8          ifne      *blanks
     c                   exsr      updbakp
     c                   end
     C                   END
      *
     c                   move      uaar          syaar
     c                   move      *blanks       sykod1
     c                   move      *blanks       sykod2
     C
      *
      * SKRIVE PAGE   VED toppli
      *
     C     SYAKOD        IFEQ      toppli
     C                   ADD       1             RENTSI            4 0
     C                   MOVEL     'P'           SYPAGE5
     C                   MOVE      RENTSI        SYPAGE5
     C                   MOVEL     SYPAGE5       SYKOD2
     c                   end
      * start linje med generalnotanummer
      * legges i sykod1
      *
     C                   MOVEA     TXT(53)       TST004            4
     C     tst004        ifeq      'Nota'
     C     tst004        oreq      'Note'
     c                   movea     txt(68)       b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           pur8              8
     c                   movel     'P'           pur8
     c                   movel     pur8          sykod1
     c                   end
     c                   end
      *
      *
      * start linje med kundenummer
      * legges i sykod2
      *
     C                   MOVEA     TXT(53)       TST006            6
     C     tst006        ifeq      'Kunden'
     C     tst006        oreq      'Custom'
     C     tst006        oreq      'Kunden'
     c                   movea     txt(67)       b8                8
     c     1             do        8             nr                2 0
     c     b8a(nr)       ifeq      ' '
     c                   move      '0'           b8a(nr)
     c                   end
     c                   enddo
     C                   TESTN                   b8                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b8            b8n               8 0
     c                   move      b8n           kun9              9
     c                   movel     'K'           kun9
     c                   movel     kun9          sykod2
     c                   end
     c                   end
      *
      * start linje på bilagsnummer
      * legges i sykod2
      *
     c                   movea     txt(2)        b7                7
     c     1             do        7             nr                2 0
     c     b7a(nr)       ifeq      ' '
     c                   move      '0'           b7a(nr)
     c                   end
     c                   enddo
     c     b7            ifne      *zeros
     C                   TESTN                   b7                   34
     C     *IN34         IFEQ      '1'
     C                   MOVEL     b7            b7n               7 0
     c                   move      b7n           bil8              8
     c                   movel     'B'           bil8
     c                   movel     bil8          sykod2
     c                   end
     c                   end
      *
      *
     c                   endsr
     c**************************************************************
     C     updbakp       BEGSR
     c**************************************************************
      * oppdatrer purrebrevnummer/rentenotanummer  bakover
     c                   setoff                                       33
     c                   move      syafil        syafilg          10
     c                   z-add     syalin        syaling          13 0
      *
     c     *in(33)       doweq     '0'
     c                   sub       1             syalin
     c     syalin        chain     syarkivl1                          33
     c  N33syafil        comp      syafilg                            3333
     c     *in(33)       ifeq      '0'
     c                   movel     pur8          sykod1
     c                   movel     sykod2        tst001            1
     c                   update    syarkivrl
     c     tst001        comp      'P'                                    33
     c                   endif
     c                   enddo
     c                   z-add     syaling       syalin
     c                   endsr
     c**************************************************************
     C     updbakr       BEGSR
     c**************************************************************
      * oppdatrer rentenotanummer  bakover
     c                   setoff                                       33
     c                   move      syafil        syafilg          10
     c                   z-add     syalin        syaling          13 0
      *
     c     *in(33)       doweq     '0'
     c                   sub       1             syalin
     c     syalin        chain     syarkivl1                          33
     c  N33syafil        comp      syafilg                            3333
     c     *in(33)       ifeq      '0'
     c                   movel     fak8          sykod1
     c                   movel     sykod2        tst001            1
     c                   update    syarkivrl
     c     tst001        comp      'P'                                    33
     c                   endif
     c                   enddo
     c                   z-add     syaling       syalin
     c                   endsr
