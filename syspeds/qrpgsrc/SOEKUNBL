      *
      ***********************************************************
      *** PROGRAM SKAL SØKE KUNDENR. (MAX. 8 KUNDENR.)        ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-11 13-24                      ***
      *** LEDIGE INDIKATORER 27-49 61-90                      ***
      ***********************************************************
      *
     FCUNDL01   IF   E           K DISK
     FCUNDL02   IF   E           K DISK
     F                                     RENAME(KUNDR:KUNDR2)
     FSOKUNFBL  CF   E             WORKSTN
     F                                     SLN(LINJE)
     D                 DS
     D  WALFA2                 1     10
     D  AL                     1     10
     D                                     DIM(10)
     D                 DS
     D  WKD1                   1      1
     D  WKD2                   2      2
     D  WKD3                   3      3
     D  WKD4                   4      4
     D  WKD5                   5      5
     D  WKD6                   6      6
     D  WKD7                   7      7
     D  WKD8                   8      8
     D  KD                     1      8
     D                 DS
     D  WKNR1                  1      8  0
     D  WKNR2                  9     16  0
     D  WKNR3                 17     24  0
     D  WKNR4                 25     32  0
     D  WKNR5                 33     40  0
     D  WKNR6                 41     48  0
     D  WKNR7                 49     56  0
     D  WKNR8                 57     64  0
     D  KN                     1     64
     D                 DS
     D  WTXT1                  1      8
     D  WTXT2                  9     16
     D  WTXT3                 17     24
     D  WTXT4                 25     32
     D  WTXT5                 33     40
     D  WTXT6                 41     48
     D  WTXT7                 49     56
     D  WTXT8                 57     64
     D  TXT                    1     64
     C*
     C     KUND1K        KLIST
     C                   KFLD                    UFIRMA
     C                   KFLD                    WKUNR
     C     KUND2K        KLIST
     C                   KFLD                    UFIRMA
     C                   KFLD                    WALFA
     C     MAXKEY        KLIST
     C                   KFLD                    UFIRMA
     C                   KFLD                    WALFA2
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UFIRMA            2
     C                   PARM                    UANTK             1 0
     C                   PARM                    UTXT             64
     C                   PARM                    UKN              64
     C                   PARM                    UKD               8
     C*
     C                   MOVE      UTXT          TXT
     C                   MOVE      UKN           KN
     C                   MOVE      UKD           KD
     C*
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      *BLANKS       WALFA
     C                   WRITE     HEADER
     C*
     C                   SETON                                        50
     C*
     C     UANTK         COMP      1                                  51  51
     C     UANTK         COMP      2                                  52  52
     C     UANTK         COMP      3                                  53  53
     C     UANTK         COMP      4                                  54  54
     C     UANTK         COMP      5                                  55  55
     C     UANTK         COMP      6                                  56  56
     C     UANTK         COMP      7                                  57  57
     C     UANTK         COMP      8                                      58
     C*
     C     START         TAG
     C                   EXFMT     VARELI
     C                   SETOFF                                       5030
     C   12              GOTO      SLUTT
     C   06              DO
     C                   CALL      'VKUIBMCL'
     C                   WRITE     HEADER
     C                   GOTO      START
     C                   END
     C* SYSPED VEDLIKEHOLD
     C   09              DO
     C                   CALL      'VKUNDCL'
     C                   WRITE     HEADER
     C                   GOTO      START
     C                   END
     C   25              DO
     C                   EXSR      LES
     C                   GOTO      START
     C                   END
     C   26              DO
     C                   EXSR      DOWN
     C                   GOTO      START
     C                   END
     C*
     C     WALFA         IFEQ      *BLANKS
     C                   EXSR      TEST
     C  N30              GOTO      SLUTT
     C                   ELSE
     C                   EXSR      SETMAX
     C     KUND2K        SETLL     CUNDL02
     C                   Z-ADD     0             RULLB
     C                   EXSR      LES
     C                   END
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   MOVE      KD            UKD
     C                   MOVE      KN            UKN
     C                   MOVE      TXT           UTXT
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TEST          BEGSR
     C***********************************************
     C   51WKNR1         IFNE      *ZEROS
     C                   MOVE      WKNR1         WKUNR             8 0
     C     KUND1K        CHAIN     CUNDL01                            91
     C                   END
     C   52WKNR2         IFNE      *ZEROS
     C                   MOVE      WKNR2         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            92
     C                   END
     C   53WKNR3         IFNE      *ZEROS
     C                   MOVE      WKNR3         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            93
     C                   END
     C   54WKNR4         IFNE      *ZEROS
     C                   MOVE      WKNR4         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            94
     C                   END
     C   55WKNR5         IFNE      *ZEROS
     C                   MOVE      WKNR5         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            95
     C                   END
     C   56WKNR6         IFNE      *ZEROS
     C                   MOVE      WKNR6         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            96
     C                   END
     C   57WKNR7         IFNE      *ZEROS
     C                   MOVE      WKNR7         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            97
     C                   END
     C   58WKNR8         IFNE      *ZEROS
     C                   MOVE      WKNR8         WKUNR
     C     KUND1K        CHAIN     CUNDL01                            98
     C                   END
     C*
     C   91
     COR 92
     COR 93
     COR 94
     COR 95
     COR 96
     COR 97
     COR 98              SETON                                        30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETMAX        BEGSR
     C***********************************************
     C     WALFA         IFEQ      '*'
     C                   MOVE      *BLANKS       WALFA
     C                   MOVEL     '99999999'    WALFA2
     C                   MOVE      '99'          WALFA
     C                   ELSE
     C                   MOVE      WALFA         WALFA2
     C                   Z-ADD     10            NR                2 0
     C     STSMAX        TAG
     C     AL(NR)        IFEQ      ' '
     C                   MOVE      '9'           AL(NR)
     C                   SUB       1             NR
     C                   GOTO      STSMAX
     C                   END
     C                   END
     C                   MOVE      WALFA         WALFA1           10
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LES           BEGSR
     C***********************************************
     C                   MOVE      WALFA1        WALFA
     C                   Z-ADD     4             LINJE
     C                   SETOFF                                       60
     C                   MOVE      *ZEROS        RULLF             2 0
     C                   WRITE     HEADER
     C*
     C     STLES         TAG
     C     UFIRMA        READE     CUNDL02                                60
     C  N60WALFA2        COMP      SONAVN                               60
     C  N60              SUB       1             RULLB                59
     C  N60
     CAN 59              GOTO      STLES
     C   60              SETON                                        51
     C   60MAXKEY        SETLL     CUNDL02
     C  N60              DO
     C                   MOVEL     ADR1          KADR1
     C                   MOVEL     POSTNR        WADR3
     C                   MOVE      ADR3          WADR3
     C     AKTKOD        COMP      'I'                                    70
     C                   WRITE     SUBFIL
     C                   ADD       1             RULLF
     C                   ADD       2             LINJE
     C     LINJE         COMP      18                                 60
     C  N60              GOTO      STLES
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DOWN          BEGSR
     C***********************************************
     C                   MOVE      WALFA1        WALFA
     C                   Z-ADD     18            LINJE
     C                   SETOFF                                       60
     C                   MOVE      *ZEROS        RULLB             2 0
     C                   WRITE     HEADER
     C*
     C     STDOW         TAG
     C                   READP     CUNDL02                                60
     C  N60FIRMA         COMP      UFIRMA                             6060
     C  N60WALFA1        COMP      SONAVN                             60
     C  N60              SUB       1             RULLF                59
     C  N60
     CAN 59              GOTO      STDOW
     C   60KUND2K        SETLL     CUNDL02
     C  N60              DO
     C                   MOVEL     ADR1          KADR1
     C                   MOVEL     POSTNR        WADR3
     C                   MOVE      ADR3          WADR3
     C     AKTKOD        COMP      'I'                                    70
     C                   WRITE     SUBFIL
     C                   ADD       1             RULLF
     C                   SUB       2             LINJE
     C     LINJE         COMP      4                                    60
     C  N60              GOTO      STDOW
     C                   END
     C*
     C                   ENDSR
     C*
