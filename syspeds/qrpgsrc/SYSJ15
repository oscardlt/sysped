********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 LOGG DATO/TID FOR UTSKRIFT
10XXX * 02 YBC PTF10 EKSTRA FELTER FOR OVERSJØ SYSTEM
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT BILL OF LADIND (OVERSJØ)     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-31 35-59 63-95 98 99          ***
      ***********************************************************
      *
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FBLADRT    IF   E           K DISK
     FBILLOF    IF   E           K DISK
N02  FBILLOFOS  IF   E           K DISK
      *
      *** BILLOPD BRUKES TIL Å OPPDATERE STATUS PÅ BILLOF
     FBILLOPD   UF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOPDR)
N01  FTRACKF    O  A E             DISK
      *
     FBLV1LF    IF   E           K DISK
     FBLV2LF    IF   E           K DISK
     FBLVSD2    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDBLF     IF   E           K DISK
     FCDBLFLF   IF   E           K DISK
     F                                     RENAME(CDBLFR:CDBLFRL)
     FCDBLF2    IF   E           K DISK
     FKODTP     IF   E           K DISK
     FSYSJ15P   O    E             PRINTER USROPN
     FSYSJ15P2  O    E             PRINTER OFLIND(*IN01)
     D AN              S              1    DIM(10)
     D MN              S             17    DIM(100)
     D FT              S             51    DIM(100)
N02  D                 DS
N02  D  BLGB1                  1     35
N02  D  BLGB2                 36     70
N02  D  OSFT1                  1     70    DIM(2)
N02  D                 DS
N02  D  BLTXT1                 1    100
N02  D  BLTXT2               101    200
N02  D  BLTXT3               201    300
N02  D  BLTXT4               301    400
N02  D  OSFT2                  1    400    DIM(4)
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(SYSJ15P) -
     D                                     OUTQ(')
     D XCMD12          C                   CONST(') PAGESIZE(72 120) -
     D                                     CPI(15) OVRFLW(72) -
     D                                     FORMTYPE(')
     D XCMD13          C                   CONST(') SECURE(*YES)')
     D XCMD21          C                   CONST('OVRPRTF -
     D                                     FILE(SYSJ15P) -
     D                                     OUTQ(')
     D XCMD22          C                   CONST(') PAGESIZE(72 120) -
     D                                     CPI(15) OVRFLW(72) -
     D                                     DRAWER(')
     D XCMD23          C                   CONST(') FORMTYPE(')
     D XCMD24          C                   CONST(') COPIES(')
     D XCMD25          C                   CONST(') SECURE(*YES)')
     D                 DS
     D  AA                     1    150
     D                                     DIM(150)
     D  AA120                  1    120
     D                 DS
     D  CFLIN                  1      2  0
     D  VL                     1      2  0
     D                 DS
     D  CFCOL                  1      3  0
     D  VK                     1      3  0
     D                 DS
     D  B2AD0A                 1     45
     D  BLAD0A                 1     30
     D  BTAD0A                31     45
     D                 DS
     D  B2NAA                  1     45
     D  BLNAA                  1     30
     D  BTNAA                 31     45
     D                 DS
     D  B2AD1A                 1     45
     D  BLAD1A                 1     30
     D  BTAD1A                31     45
     D                 DS
     D  B2AD2A                 1     45
     D  BLAD2A                 1     30
     D  BTAD2A                31     45
     D                 DS
     D  B2AD3A                 1     45
     D  BLAD3A                 1     30
     D  BTAD3A                31     45
     D                 DS
     D  B2AD4A                 1     45
     D  BLAD4A                 1     30
     D  BTAD4A                31     45
     D                 DS
     D  B2AD0M                 1     45
     D  BLAD0M                 1     30
     D  BTAD0M                31     45
     D                 DS
     D  B2NAM                  1     45
     D  BLNAM                  1     30
     D  BTNAM                 31     45
     D                 DS
     D  B2AD1M                 1     45
     D  BLAD1M                 1     30
     D  BTAD1M                31     45
     D                 DS
     D  B2AD2M                 1     45
     D  BLAD2M                 1     30
     D  BTAD2M                31     45
     D                 DS
     D  B2AD3M                 1     45
     D  BLAD3M                 1     30
     D  BTAD3M                31     45
     D                 DS
     D  B2AD4M                 1     45
     D  BLAD4M                 1     30
     D  BTAD4M                31     45
     D                 DS
     D  B2AD0N                 1     45
     D  BLAD0N                 1     30
     D  BTAD0N                31     45
     D                 DS
     D  B2NAN                  1     45
     D  BLNAN                  1     30
     D  BTNAN                 31     45
     D                 DS
     D  B2AD1N                 1     45
     D  BLAD1N                 1     30
     D  BTAD1N                31     45
     D                 DS
     D  B2AD2N                 1     45
     D  BLAD2N                 1     30
     D  BTAD2N                31     45
     D                 DS
     D  B2AD3N                 1     45
     D  BLAD3N                 1     30
     D  BTAD3N                31     45
     D                 DS
     D  B2AD4N                 1     45
     D  BLAD4N                 1     30
     D  BTAD4N                31     45
     D                 DS
     D  B2AD0G                 1     45
     D  BLAD0G                 1     30
     D  BTAD0G                31     45
     D                 DS
     D  B2NAG                  1     45
     D  BLNAG                  1     30
     D  BTNAG                 31     45
     D                 DS
     D  B2AD1G                 1     45
     D  BLAD1G                 1     30
     D  BTAD1G                31     45
     D                 DS
     D  B2AD2G                 1     45
     D  BLAD2G                 1     30
     D  BTAD2G                31     45
     D                 DS
     D  B2AD3G                 1     45
     D  BLAD3G                 1     30
     D  BTAD3G                31     45
     D                 DS
     D  B2AD4G                 1     45
     D  BLAD4G                 1     30
     D  BTAD4G                31     45
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
N01  D  UWEBS2                22     22
N01  D                SDS
N01  D  UUSER                254    263
     C*
     C                   EXSR      INIT
     C*
     C* SKRIV TIL PRINTER
     C*
     C     BILLK         SETLL     BILLOF
     C     START         TAG
     C     UAVD          READE     BILLOF                                 60
     C  N60BLOPD         IFGT      UOPDT
     C                   GOTO      SLUTT
     C                   END
     C  N60BLST          IFNE      ' '
     C     UOPDF         ANDNE     UOPDT
     C                   GOTO      START
     C                   END
     C  N60USG           IFNE      BLSG
     C     USG           ANDNE     'ALL'
     C     UOPDF         ANDNE     UOPDT
     C                   GOTO      START
     C                   END
     C  N60              DO
     C                   EXSR      LESANT
     C                   EXSR      PRINT
     C     BILLKO        CHAIN     BILLOPD                            33
     C  N33              MOVE      'P'           BLST
     C  N33              EXCEPT    BLMRK
     C                   GOTO      START
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     LESANT        BEGSR
     C******************************************
     C                   MOVE      'J'           XSTKGD            1
     C                   Z-ADD     0             XSUMNT            5 0
     C                   Z-ADD     0             YLI
     C                   Z-ADD     0             YSORT
     C     BLV1K         SETLL     BLV1LF
     C                   SETOFF                                       33
     C     STLA1         TAG
     C     BILLKO        READE     BLV1LF                                 33
     C  N33BVKDC         IFNE      *BLANKS
     C                   MOVE      'N'           XSTKGD
     C                   END
     C  N33              ADD       BVNT          XSUMNT
     C  N33              GOTO      STLA1
     C*
     C                   Z-ADD     0             XLI               3 0
     C                   Z-ADD     5             XLI2              1 0
     C                   Z-ADD     0             XLI1              3 0
     C                   Z-ADD     5             XLI21             1 0
     C                   Z-ADD     0             XN                3 0
     C                   Z-ADD     0             XN2               3 0
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       FT
     C     BLV2K         SETLL     BLV2LF
     C                   SETOFF                                       33
     C     STLA2         TAG
     C     BILLKO        READE     BLV2LF                                 33
     C  N33BVMN          IFNE      *BLANKS                                      1<-B
     C     BVLI          IFNE      XLI1                                          2<-B
     C     XLI21         DOWLE     4                                              3<-B
     C                   ADD       1             XN
     C                   ADD       1             XLI21
     C                   END                                                      3<-E
     C                   MOVE      BVLI          XLI1
     C                   MOVE      BVLI2         XLI21
     C                   END                                                     2<-E
     C     XLI21         DOWLT     BVLI2                                         2<-B
     C                   ADD       1             XN
     C                   ADD       1             XLI21
     C                   END                                                     2<-E
     C                   ADD       1             XLI21
     C                   ADD       1             XN
     C                   MOVE      BVMN          MN(XN)
     C                   END
     C  N33BVKD          IFNE      ' '                                           2<-B
     C     BVKD          ANDNE     'Z'
     C     BVKD          ANDNE     'N'
     C     BVKD          ANDNE     'Y'
     C                   GOTO      STLA2
     C                   END                                                     2<-E
     C  N33              DO
     C     XLI           IFNE      BVLI
     C     XLI2          DOWLE     4
     C                   ADD       1             XN2
     C                   ADD       1             XLI2
     C                   END
     C                   MOVE      BVLI          XLI
     C                   MOVE      BVLI2         XLI2
     C                   END
     C     XLI2          DOWLT     BVLI2
     C                   ADD       1             XN2
     C                   ADD       1             XLI2
     C                   END
     C                   ADD       1             XN2
     C                   ADD       1             XLI2
     C                   MOVE      BVFT          FT(XN2)
     C                   GOTO      STLA2
     C                   END
     C*
     C     XN            IFLT      XN2
     C                   MOVE      XN2           XN
     C                   END
     C     XN            IFGT      0
     C     FT(XN)        DOWEQ     *BLANKS
     C     MN(XN)        ANDEQ     *BLANKS
     C                   SUB       1             XN
     C                   END
     C                   END
     C                   Z-ADD     1             XN2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OVRPRT        BEGSR
     C***********************************************
     C     UKOPI         IFEQ      '00'
     C     CF2ANT        IFGE      '01'
     C     CF2ANT        ANDLE     '99'
     C                   MOVE      CF2ANT        UKOPI
     C                   ELSE
     C                   MOVE      '01'          UKOPI
     C                   END
     C                   END
     C     CF2PRT        IFEQ      *BLANKS
     C     UPRT26        ORNE      *BLANKS
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       KOPNVN:0      UCMD
     C                   CAT       XCMD12:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       XCMD24:0      UCMD
     C                   CAT       UKOPI:0       UCMD
     C                   CAT       XCMD13:0      UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   ELSE
     C                   MOVE      *BLANKS       UCMD
     C     XCMD21        CAT       CF2PRT:0      UCMD
     C                   CAT       XCMD22:0      UCMD
     C                   CAT       CF2SKF:0      UCMD
     C                   CAT       XCMD23:0      UCMD
     C                   CAT       CF2KDP:0      UCMD
     C                   CAT       XCMD24:0      UCMD
     C                   CAT       UKOPI:0       UCMD
     C                   CAT       XCMD25:0      UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   END
      *
     C                   ENDSR
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
N02  C                   MOVE      *BLANKS       BLNAB
N02  C                   MOVE      *BLANKS       BLREFS
N02  C                   MOVE      *BLANKS       BLFD1
N02  C                   MOVE      *BLANKS       BLFD2
N02  C                   MOVE      *BLANKS       BLFD3
N02  C                   MOVE      *BLANKS       BLPLC
N02  C                   MOVE      *BLANKS       BLPDT
N02  C                   MOVE      *BLANKS       OSFT1
N02  C                   MOVE      *BLANKS       OSFT2
N02  C     BILLKO        CHAIN     BILLOFOS                           33
N02   *
     C     BILLKO        CHAIN     BLADRT                             33
     C   33              CLEAR                   BLADRTR
     C     CDBLFK        CHAIN     CDBLF                              33
     C   33              MOVE      'STAND'       BLKDP
     C   33CDBLFK        CHAIN     CDBLF                              33
     C                   MOVE      CFCOL         XANTL             3 0
     C     BLKDP         CHAIN     CDBLF2                             33
     C                   EXSR      OVRPRT
     C                   OPEN      SYSJ15P
     C                   WRITE     LINJE1
     C*
     C                   SETOFF                                       6297
     C     STP11         TAG
     C                   Z-ADD     1             YLIN
     C                   MOVE      *BLANKS       AA
     C                   SETOFF                                       61
     C     CDBLK2        SETLL     CDBLFLF
     C     STP12         TAG
     C     BLKDP         READE     CDBLFLF                                61
     C*
     C* CFFNR (FELTNR.) > 500  BETYR FELTET TILHØRER LOKAL-B/L
     C  N61CFFNR         IFGT      501
     C                   GOTO      STP12
     C                   END
     C   61              Z-ADD     71            CFLIN
     C     YLIN          DOWLT     CFLIN
     C                   WRITE     UTSKRI
     C                   MOVE      *BLANKS       AA
     C                   ADD       1             YLIN
     C                   END
     C*
     C   61
     CAN 62CDBLFK        CHAIN     CDBLF                              33
     C   61
     CAN 62              WRITE     LINJE1
     C   61
     CAN 62              GOTO      STP11
     C*
     C* CFFNR (FELTNR.) <= 200  BETYR FELTET TILHØRER B/L ELLER LOKAL-B/L
     C  N61CFFNR         IFLT      200
     C                   EXSR      PRINT2
     C                   ELSE
     C*
     C     CFFNR         IFLT      300
     C* 201 <= CFFNR < 300  BETYR FELTET TILHØRER VARELINJE (CMD-10/11)
     C                   EXSR      PRINT3
     C                   ELSE
     C* 301 <= CFFNR < 500  BETYR FELTET TILHØRER TOTALER ELLER FASTTEKSTER
     C                   EXSR      PRINT2
     C                   END
     C                   END
     C  N61              GOTO      STP12
     C*
     C                   EXSR      UTSID2
N01  C                   IF        UWEBS2 <> 'J'
N01  C                   EXSR      SRLOG
N01  C                   END
     C*
     C                   CLOSE     SYSJ15P
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT2        BEGSR
     C******************************************
     C     CFFNR         IFEQ      1
     C                   MOVE      BLAVD         X4                4
     C                   MOVEA     X4            AN(1)
     C                   Z-ADD     4             AT                1 0
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      2
     C                   MOVE      BLOPD         X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      3
     C                   MOVEA     BLSG          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      4
     C                   MOVE      BLKNR         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      5
     C                   MOVE      BLKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEA     KNAVN         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      6
     C                   MOVE      BLKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEA     ADR1          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      7
     C                   MOVE      BLKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEA     ADR2          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      8
     C                   MOVE      BLKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      *BLANKS       XADR3            30
     C  N33POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XADR3
     C                   ELSE
     C                   MOVEL     POSTNR        XADR3
     C                   MOVE      ADR3          XADR3
     C                   END
     C  N33              MOVEA     XADR3         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      9
     C     BLOB          CHAIN     CDBOAT                             33
     C  N33              MOVEA     CBNAB         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      10
     C                   MOVEA     BLREIS        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      11
     C                   MOVEA     BLBLNR        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      12
     C                   MOVE      BLUKE         X2                2
     C                   MOVEA     X2            AN(1)
     C                   Z-ADD     2             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      13
     C                   MOVE      BLAAR         X2                2
     C                   MOVEA     X2            AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      14
     C                   MOVE      BLKNA         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      15
     C                   MOVEA     B2NAA         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      16
     C                   MOVEA     B2AD1A        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      17
     C                   MOVEA     B2AD2A        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      18
     C                   MOVEA     B2AD3A        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      20
     C                   MOVE      BLKNM         X8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      21
     C                   MOVEA     B2NAM         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      22
     C                   MOVEA     B2AD1M        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      23
     C                   MOVEA     B2AD2M        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      24
     C                   MOVEA     B2AD3M        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      26
     C                   MOVE      BLKNN         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      27
     C                   MOVEA     B2NAN         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      28
     C                   MOVEA     B2AD1N        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      29
     C                   MOVEA     B2AD2N        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      30
     C                   MOVEA     B2AD3N        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      32
     C     BLLSS         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BLLSS         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      33
     C                   MOVEA     BLLSS2        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      34
     C     CFFNR         OREQ      49
     C     BLLSH         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BLLSH         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      35
     C     CFFNR         OREQ      48
     C     BLLB          CHAIN     CDBOAT                             33
     C  N33              MOVEA     CBNAB         AA(VK)
     C   33              MOVEA     BLLB          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      36
     C     BLVH          CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BLVH          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      37
     C     BLLOH         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BLLOH         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      38
     C     BLLOS         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BLLOS         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      39
     C                   MOVEA     BLLOS2        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      40
     C                   MOVE      BLDTA         UDT               6 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          X2                2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       2             VK
     C                   MOVE      '/'           AA(VK)
     C                   ADD       1             VK
     C                   MOVE      UDT2          X2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       2             VK
     C                   MOVE      '/'           AA(VK)
     C                   ADD       1             VK
     C                   MOVE      UDT1          X2
     C                   MOVEA     X2            AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      41
     C                   MOVEA     BLMM          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      42
     C                   MOVE      BLPRO         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      43
     C                   MOVE      BLKNG         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      44
     C                   MOVEA     B2NAG         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      45
     C                   MOVEA     B2AD1G        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      46
     C                   MOVEA     B2AD2G        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      47
     C                   MOVEA     B2AD3G        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      50
     C     BLVH2         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BLVH2         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      51
     C                   MOVE      BLOLP         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      52
     C                   MOVE      BLOLC         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      53
     C                   MOVE      BLOTP         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      54
     C                   MOVE      BLOTC         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      55
     C                   MOVE      BLSFP         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      56
     C                   MOVE      BLSFC         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      57
     C                   MOVE      BLDTP         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      58
     C                   MOVE      BLDTC         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      59
     C                   MOVE      BLDLP         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      60
     C                   MOVE      BLDLC         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      61
     C                   MOVE      BLMFP         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      62
     C                   MOVE      BLMFC         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      63
     C     BLCP          IFEQ      'C'
     C                   MOVEA     XDEST         AA(VK)
     C                   ELSE
     C                   MOVEA     XPREP         AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      64
     C                   MOVEA     BLNTBS        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      65
     C     BLSD          CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      66
     C     FIDTFM        IFEQ      1
     C                   EXSR      MOVDAG
     C                   EXSR      MOVMND
     C                   EXSR      MOVÅR
     C                   ELSE
     C     FIDTFM        IFEQ      2
     C                   EXSR      MOVMND
     C                   EXSR      MOVDAG
     C                   EXSR      MOVÅR
     C                   ELSE
     C                   EXSR      MOVÅR
     C                   EXSR      MOVMND
     C                   EXSR      MOVDAG
     C                   END
     C                   END
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      67
     C     BLAD0M        IFNE      *BLANKS
     C                   MOVEA     B2AD0M        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      68
     C     BLAD4M        IFNE      *BLANKS
     C                   MOVEA     B2AD4M        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      69
     C     BLAD0N        IFNE      *BLANKS
     C                   MOVEA     B2AD0N        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      70
     C     BLAD4N        IFNE      *BLANKS
     C                   MOVEA     B2AD4N        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      71
     C     BLKNG         ANDNE     0
     C                   MOVE      BLKNG         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      '0'
     C                   MOVEA     'TEL:'        AA(VK)
     C     VK            ADD       5             VK2               3 0
     C                   MOVEA     TLF           AA(VK2)
     C                   END
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      72
     C     BLKNG         ANDNE     0
     C                   MOVE      BLKNG         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      '0'
     C                   MOVEA     'FAX:'        AA(VK)
     C     VK            ADD       5             VK2               3 0
     C                   MOVEA     TFAXNR        AA(VK2)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      73
     C     BLAD0A        IFNE      *BLANKS
     C                   MOVEA     B2AD0A        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      74
     C     BLAD4A        IFNE      *BLANKS
     C                   MOVEA     B2AD4A        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      75
     C     BLAD0G        IFNE      *BLANKS
     C                   MOVEA     B2AD0G        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      76
     C     BLAD4G        IFNE      *BLANKS
     C                   MOVEA     B2AD4G        AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      379
     C     XSTKGD        ANDEQ     'N'                                          CONTAINER
     C                   MOVE      XSUMNT        X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      380
     C     XSTKGD        ANDEQ     'J'                                          STYKKGODS
     C                   MOVE      XSUMNT        X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      481
     C                   MOVEA     CF2FT1        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      482
     C                   MOVEA     CF2FT2        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      483
     C                   MOVEA     CF2FT3        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      484
     C                   MOVEA     CF2FT4        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      485
     C                   MOVEA     CF2FT5        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      486
     C                   MOVEA     CF2FT6        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      487
     C                   MOVEA     CF2FT7        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      488
     C                   MOVEA     CF2FT8        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      489
     C                   MOVEA     CF2FT9        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     SLP21         ENDSR
     C*
     C******************************************
     C     MOVDAG        BEGSR
     C******************************************
     C                   MOVE      BLDTR         XDTD              2 0
     C     XDTD          IFLT      10
     C                   Z-ADD     XDTD          XDG               1 0
     C                   MOVE      XDG           AA(VK)
     C                   ADD       2             VK
     C                   ELSE
     C                   MOVE      XDTD          X2                2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       3             VK
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVMND        BEGSR
     C******************************************
     C                   MOVE      BLDTR         XDTFMT
     C                   MOVEL     XDTFMT        XDTM              2 0
     C     XDTM          IFEQ      1
     C                   MOVEA     'JANUARY'     AA(VK)
     C                   ADD       8             VK
     C                   END
     C*
     C     XDTM          IFEQ      2
     C                   MOVEA     'FEBRUARY'    AA(VK)
     C                   ADD       9             VK
     C                   END
     C*
     C     XDTM          IFEQ      3
     C                   MOVEA     'MARCH'       AA(VK)
     C                   ADD       6             VK
     C                   END
     C*
     C     XDTM          IFEQ      4
     C                   MOVEA     'APRIL'       AA(VK)
     C                   ADD       6             VK
     C                   END
     C*
     C     XDTM          IFEQ      5
     C                   MOVEA     'MAY'         AA(VK)
     C                   ADD       4             VK
     C                   END
     C*
     C     XDTM          IFEQ      6
     C                   MOVEA     'JUNE'        AA(VK)
     C                   ADD       5             VK
     C                   END
     C*
     C     XDTM          IFEQ      7
     C                   MOVEA     'JULY'        AA(VK)
     C                   ADD       5             VK
     C                   END
     C*
     C     XDTM          IFEQ      8
     C                   MOVEA     'AUGUST'      AA(VK)
     C                   ADD       7             VK
     C                   END
     C*
     C     XDTM          IFEQ      9
     C                   MOVEA     'SEPTEMBE'    AA(VK)
     C                   ADD       8             VK
     C                   MOVEA     'R'           AA(VK)
     C                   ADD       2             VK
     C                   END
     C*
     C     XDTM          IFEQ      10
     C                   MOVEA     'OCTOBER'     AA(VK)
     C                   ADD       8             VK
     C                   END
     C*
     C     XDTM          IFEQ      11
     C                   MOVEA     'NOVEMBER'    AA(VK)
     C                   ADD       9             VK
     C                   END
     C*
     C     XDTM          IFEQ      12
     C                   MOVEA     'DECEMBER'    AA(VK)
     C                   ADD       9             VK
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVÅR         BEGSR
     C******************************************
     C                   MOVEL     BLDTR         X4                4
     C                   MOVEA     X4            AA(VK)
     C                   ADD       5             VK
     C*
     C                   ENDSR
     C*
     C******************************************
     C     NUM1          BEGSR
     C******************************************
     C                   Z-ADD     1             AT1               1 0
     C     AT1           DOWLT     AT
     C     AN(AT1)       COMP      '0'                                    33
     C   33              ADD       1             AT1
     C  N33              GOTO      STN11
     C                   END
     C*
     C     STN11         TAG
     C                   SUB       1             VK
     C                   ADD       AT1           VK
     C     AT1           DOWLE     AT
     C                   MOVE      AN(AT1)       AA(VK)
     C                   ADD       1             VK
     C                   ADD       1             AT1
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT3        BEGSR
     C******************************************
     C                   SELECT
     C     CFFNR         WHENEQ    270
     C                   MOVE      VK            V1                3 0
     C     CFFNR         WHENEQ    271
     C                   MOVE      VK            V2                3 0
     C     CFFNR         WHENEQ    272
     C                   MOVE      VK            V3                3 0
     C     CFFNR         WHENEQ    273
     C                   MOVE      VK            V4                3 0
     C     CFFNR         WHENEQ    274
     C                   MOVE      VK            V5                3 0
     C     CFFNR         WHENEQ    275
     C                   MOVE      VK            V6                3 0
     C                   ENDSL
     C     1             DO        5
     C  N61              READ      CDBLFLF                                61
     C                   SELECT
     C     CFFNR         WHENEQ    270
     C                   MOVE      VK            V1                3 0
     C     CFFNR         WHENEQ    271
     C                   MOVE      VK            V2                3 0
     C     CFFNR         WHENEQ    272
     C                   MOVE      VK            V3                3 0
     C     CFFNR         WHENEQ    273
     C                   MOVE      VK            V4                3 0
     C     CFFNR         WHENEQ    274
     C                   MOVE      VK            V5                3 0
     C     CFFNR         WHENEQ    275
     C                   MOVE      VK            V6                3 0
     C                   ENDSL
     C                   END
     C                   Z-ADD     0             XNTLIN            3 0
     C                   SETOFF                                       3462
     C   97              GOTO      STP33
     C     BLV1K         SETLL     BLV1LF
     C*
     C     STP31         TAG
     C     BILLKO        READE     BLV1LF                                 34
     C  N34              DO                                                     1<-B
     C                   MOVEA     BVMN          AA(V1)
     C     BVNT          IFNE      0                                             2<-B
     C                   MOVE      BVNT          X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   Z-ADD     V3            VK
     C                   EXSR      NUM1
     C                   END                                                     2<-E
     C                   MOVEA     BVVS          AA(V4)
     C     BVVKT         IFNE      0                                             2<-B
     C                   MOVE      BVVKT         X9                9
     C                   MOVEA     X9            AN(1)
     C                   Z-ADD     V5            VK
     C                   EXSR      NUM2
     C                   END                                                     2<-E
     C     BVM3          IFNE      0                                             2<-B
     C                   MOVE      BVM3          X9
     C                   MOVEA     X9            AN(1)
     C                   Z-ADD     V6            VK
     C                   EXSR      NUM3
     C                   END                                                     2<-E
     C*
     C                   WRITE     UTSKRI
     C                   MOVE      *BLANKS       AA
     C                   ADD       1             XNTLIN
     C                   ADD       1             YLIN
     C     XNTLIN        IFLT      XANTL                                         2<-B
     C                   GOTO      STP31
     C                   ELSE                                                    2
     C     BILLKO        READE     BLV1LF                                 34
     C  N34              SETON                                        62
     C  N34              MOVE      BVLI          YLI
     C  N34              MOVE      BVSORT        YSORT
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     STP33         TAG
     C  N62              SETON                                        97
     C  N62XNTLIN        COMP      XANTL                              62
     C  N62XN2           DOWLE     XN
     C                   MOVE      MN(XN2)       BVMN
     C                   MOVE      FT(XN2)       BVFT
     C                   MOVEA     BVMN          AA(V1)
     C                   MOVEA     BVFT          AA(V2)
     C                   WRITE     UTSKRI
     C                   MOVE      *BLANKS       AA
     C                   ADD       1             YLIN
     C                   ADD       1             XNTLIN
     C                   ADD       1             XN2
     C     XNTLIN        COMP      XANTL                              62
     C   62              GOTO      SLP3
     C                   END
     C*
     C     SLP3          ENDSR
     C*
     C******************************************
     C     NUM2          BEGSR
     C******************************************
     C     AN(1)         COMP      '0'                                    33
     C  N33              MOVE      AN(1)         AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(2)         COMP      '0'                                    33
     C  N33              MOVE      AN(2)         AA(VK)
     C                   ADD       1             VK
     C   33AN(3)         COMP      '0'                                    33
     C  N33              MOVE      AN(3)         AA(VK)
     C                   ADD       1             VK
     C  N33              MOVE      '.'           AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(4)         COMP      '0'                                    33
     C  N33              MOVE      AN(4)         AA(VK)
     C                   ADD       1             VK
     C   33AN(5)         COMP      '0'                                    33
     C  N33              MOVE      AN(5)         AA(VK)
     C                   ADD       1             VK
     C   33AN(6)         COMP      '0'                                    33
     C  N33              MOVE      AN(6)         AA(VK)
     C                   ADD       1             VK
     C  N33              MOVE      '.'           AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(7)         COMP      '0'                                    33
     C  N33              MOVE      AN(7)         AA(VK)
     C                   ADD       1             VK
     C   33AN(8)         COMP      '0'                                    33
     C  N33              MOVE      AN(8)         AA(VK)
     C                   ADD       1             VK
     C   33AN(9)         COMP      '0'                                    33
     C  N33              MOVE      AN(9)         AA(VK)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     NUM3          BEGSR
     C******************************************
     C     AN(1)         COMP      '0'                                    33
     C  N33              MOVE      AN(1)         AA(VK)
     C                   ADD       1             VK
     C   33AN(2)         COMP      '0'                                    33
     C  N33              MOVE      AN(2)         AA(VK)
     C                   ADD       1             VK
     C   33AN(3)         COMP      '0'                                    33
     C  N33              MOVE      AN(3)         AA(VK)
     C                   ADD       1             VK
     C  N33              MOVE      '.'           AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(4)         COMP      '0'                                    33
     C  N33              MOVE      AN(4)         AA(VK)
     C                   ADD       1             VK
     C   33AN(5)         COMP      '0'                                    33
     C  N33              MOVE      AN(5)         AA(VK)
     C*
     C                   ADD       1             VK
     C                   MOVE      AN(6)         AA(VK)
     C                   ADD       1             VK
     C                   MOVE      ','           AA(VK)
     C*
     C                   ADD       1             VK
     C                   MOVE      AN(7)         AA(VK)
     C                   ADD       1             VK
     C                   MOVE      AN(8)         AA(VK)
     C                   ADD       1             VK
     C                   MOVE      AN(9)         AA(VK)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     UTSID2        BEGSR
     C******************************************
     C                   MOVE      *ZEROS        YLI
     C     BLVSDK        SETLL     BLVSD2
     C                   SETOFF                                       33
     C     BILLKO        READE     BLVSD2                                 33
     C   33              GOTO      SLUTS
     C*
     C     BLOB          CHAIN     CDBOAT                             96
     C   96              MOVE      *BLANKS       XOBNAV           30
     C  N96              MOVEL     CBNAB         XOBNAV
     C     BLLB          CHAIN     CDBOAT                             96
     C   96              MOVE      *BLANKS       XLBNAV           30
     C  N96              MOVEL     CBNAB         XLBNAV
     C     BLVH          CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XVIAHN           30
     C  N96              MOVE      ST2NVN        XVIAHN
     C     BLLOH         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLOSHN           30
     C  N96              MOVE      ST2NVN        XLOSHN
     C     BLLOS         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLOSN            30
     C  N96              MOVE      ST2NVN        XLOSN
     C     BLLSH         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLSTHN           30
     C  N96              MOVE      ST2NVN        XLSTHN
     C     BLLSS         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLSTN            30
     C  N96              MOVE      ST2NVN        XLSTN
     C*
     C                   WRITE     SIDE2
     C                   SETOFF                                       01
     C                   Z-ADD     1             XSLNR             3 0
     C                   Z-ADD     0             XSUMVK            9 0
     C                   Z-ADD     0             XSUMKB            9 3
     C     BVLI          DOWGT     XSLNR
     C                   WRITE     TOMS2
     C                   ADD       1             XSLNR
     C                   END
     C     BVVKT         COMP      0                                  9696
     C     BVM3          COMP      0                                  3232
     C                   WRITE     SIDE2D
     C                   ADD       1             XSLNR
     C                   ADD       BVVKT         XSUMVK
     C                   ADD       BVM3          XSUMKB
     C*
     C     STUTS2        TAG
     C     BILLKO        READE     BLVSD2                                 33
     C  N33              DO
     C     BVLI          DOWGT     XSLNR
     C  N01              WRITE     TOMS2
     C                   ADD       1             XSLNR
     C                   END
     C   01              WRITE     SIDE2
     C   01              SETOFF                                       01
     C     BVVKT         COMP      0                                  9696
     C     BVM3          COMP      0                                  3232
     C                   WRITE     SIDE2D
     C                   ADD       1             XSLNR
     C                   ADD       BVVKT         XSUMVK
     C                   ADD       BVM3          XSUMKB
     C                   GOTO      STUTS2
     C                   END
     C*
     C     XSUMVK        COMP      0                                  9696
     C     XSUMKB        COMP      0                                  3232
     C   01              WRITE     SIDE2
     C   01              SETOFF                                       01
     C                   WRITE     SIDE2S
     C*
     C     SLUTS         ENDSR
     C*
N01   ******************************************
N01  C     SRLOG         BEGSR
N01   ******************************************
N01  C                   MOVE      BLAVD         TTAVD
N01  C                   MOVE      BLOPD         TTOPD
N01  C                   MOVE      'PS5'         TTACTI
N01  C                   EVAL      TTTEXT='Print bill of lading'
N01  C                   EVAL      TTTEXL='Print bill of lading'
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      WDT           TTDATE
N01  C                   MOVE      WTM           TTTIME
N01  C                   MOVE      WDT           TTDATL
N01  C                   MOVE      WTM           TTTIML
N01  C                   MOVEL     UUSER         TTUSER
N01  C                   EVAL      TTDEPO = 'SYSJ15'
N01  C                   WRITE     TRACKFR
N01   *
N01  C                   ENDSR
N01   *
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     BILLK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPDF
     C     BILLKO        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BLOPD
     C     BLV1K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BLOPD
     C                   KFLD                    YSORT
     C                   KFLD                    YLI
     C     BLV2K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BLOPD
     C                   KFLD                    YSORT
     C                   KFLD                    YLI
     C                   KFLD                    YLI2
     C     BLVSDK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BLOPD
     C                   KFLD                    YLI
     C     CDBLFK        KLIST
     C                   KFLD                    BLKDP
     C                   KFLD                    YFNR
     C     CDBLK2        KLIST
     C                   KFLD                    BLKDP
     C                   KFLD                    YLIN
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI             1
     C                   KFLD                    UAVD
     C                   KFLD                    YLNR              3 0
     C                   MOVE      'P'           YPUNI
     C                   Z-ADD     26            YLNR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UOPDF2            7
     C                   PARM                    UOPDT2            7
     C                   PARM                    UPRT26           10
     C                   PARM                    UPT26            10
     C                   PARM                    UKOPI             2
     C                   TESTN                   UOPDF2               33
     C  N33              DO
     C                   MOVE      *ZEROS        UOPDF             7 0
     C                   MOVE      *ZEROS        UOPDT             7 0
     C                   END
     C   33              DO
     C                   MOVE      UOPDF2        UOPDF
     C                   SETOFF                                       33
     C                   TESTN                   UOPDT2               33
     C   33              MOVE      UOPDT2        UOPDT
     C  N33              MOVE      UOPDF         UOPDT
     C                   END
     C*
     C                   MOVE      *ZEROS        YSORT             3 0
     C                   MOVE      *ZEROS        YLI               3 0
     C                   MOVE      *ZEROS        YLI2              1 0
     C                   MOVE      *ZEROS        YFNR              3 0
     C                   MOVE      *ZEROS        YLIN              2 0
     C                   MOVE      *ZEROS        CFLIN
     C                   MOVE      *ZEROS        CFCOL
     C                   Z-ADD     1024          UCMDL            15 5
     C*
     C                   MOVE      'DIV3622'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     12            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          XDEST            12
     C                   MOVE      'DIV3623'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          XPREP            12
     C*
     C     UPRT26        IFEQ      *BLANKS
     C     KODTPK        CHAIN     KODTP                              33
     C                   ELSE
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      UPRT26        KOPNVN
     C                   MOVE      UPT26         KOPTY
     C                   END
     C     KOPFM         CHAIN     KODTFM                             33                       42
     C     FIFIRM        SETLL     FIRM                               33
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             12
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      UDT           XDTFMT            4 0
     C                   MOVEL     UDT           UDT1              2 0
     C                   MOVEL     XDTFMT        UDT2              2 0
     C                   MOVE      XDTFMT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     OBILLOPDR  E            BLMRK
     O                       BLST
