      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT LOSSELISTE                   ***
      ***********************************************************
      **  OBS!!!!  33 brukt som hoved leseloopsindikator ( Ikke bruk som arbeids/tilfeldig indik)
      **************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 også godta kode F afpprinter
10XXX * 02 SH  PTF10 TIL ARKIV
10XXX * 03 JOV PTF10 Skriv alle merkelapper for turen (hvis L i USUM)
10XXX * 04 sh  PTF10 kun 1 arkivkopi
10XXX * 05 sh  PTF10 skriver til track and trace ved turrecord
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10195 * 06 JOV PTF11 Fritekst på TURHeader i toppen av liste (kun side 1)
10195 * 07 sh  PTF11 sikres litt mer ved barkodeskriving
10195 * 08 sh  PTF11 sidebrudd testing
10195 * 09 JOV PTF11 OVELAPP UTL-FORBEHOLD/BEDRET SPREDNING - tekst fra fraktb el DUPoppdrag
      *              (begrenset merking for å få det ryddig ( gml = se syfi48. )
********************************************************************
      *
n05  FTRACKF    O  A E           K DISK
n05  FTURER14   IF   E           K DISK
N06  FFREETUR2  IF   E           K DISK
n02  FARKTXT    IF   E           K DISK
n02  FFIRMARC   IF   E           K DISK
n02  FARKIVP    O  A E             DISK
n02  FFIRM      IF   E           K DISK
     FHEAD3     IF   E           K DISK
     FHEAD11    IF   E           K DISK
     F                                     RENAME(HEADFR:HEADFR11)
     FHEADF     IF   E           K DISK
     F                                     RENAME(HEADFR:HEADFRR)
     FKODTA     IF   E           K DISK
     FHESTED    IF   E           K DISK
     FBILLOF    IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FFRISOL01  IF   E           K DISK
     F                                     RENAME(FRISOKR:FRISR01)
     FKODFRI    IF   E           K DISK
     FFAK2      IF   E           K DISK
     FASSAM     UF A E           K DISK
     FHODE      IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTH     IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FFREETXT2  IF   E           K DISK
     FSYPARL1   IF   E           K DISK
     FDOKUF     IF   E           K DISK
     FSYFI48P   O    E             PRINTER OFLIND(*IN90)
NRFA D                 DS
NRFA D  HERFA                  1     35
NRFA D  HERFA15                1     15
n02  D                 DS
n02  D  XULTID                 1     14  0
n02  D  XULTM                  1      6  0
n02  D  XULDD                  7      8  0
n02  D  XULMM                  9     10  0
n02  D  XULÅÅ                 11     14  0
n02  D                 DS
n02  D  ULÅÅ                   1      4  0
n02  D  ULMM                   5      6  0
n02  D  ULDD                   7      8  0
n02  D  ULDT                   1      8  0
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  DFS                    1     10
     D                                     DIM(10)
     D  FSDOKK                 1     10
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
     D  HEFT1C                 1     30
     D                 DS
     D  HXSNDN                 1     20
     D  HXSNDNB                1     20
     D                 DS
     D  HEAVDOPD               1     12
     D  HEAVDOPDB              1     12
     D    HEAVDA               1      4
     D     Strek               5      5    INZ('/')
     D    HEOPDA               6     12                                         OBS! ER alt 7 lang!!
     D                 DS
     D  HENAA                  1     30
     D  XXNAA                  1     30
     D                 DS
     D  IDAG1                  1      2  0
     D  IDAG2                  3      4  0
     D  IDAG3                  5      6  0
     D  IDAG                   1      6  0
     D                 DS
     D  HEDTÅ                  3      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  ADAG1                  1      2  0
     D  ADAG2                  3      4  0
     D  ADAG3                  5      6  0
     D  ADATO                  1      6  0
     D                 DS
     D  HOHT1                  1     80
     D  HOHT2                 81    160
     D  HOHT3                161    240
     D  HOHT4                241    320
     D  HOHT5                321    400
     D  HOHT6                401    480
     D  HOHT7                481    560
     D  HOBT1                561    640
     D  HOBT2                641    720
     D  HOBT3                721    800
     D  HP                     1    800
     D                                     DIM(10)
     D                 DS
     D  STR                    1     75
     D                                     DIM(75)
     D  KFMT1                  1     75
     D                UDS
s03  D* UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UHOD                  47     47
     D  UBBS                  48     48
     D  UDATO                 64     69  0
     D  UOT1                  70     71
     D  UOT2                  72     73
     D  UOT3                  74     75
     D  UOT4                  76     77
     D  UOT5                  78     79
     D  USUM                  80     80
N03  D  UPRT67               921    930
N03  D  UPRTST               821    830
     D  UGN                  981    995
      *
     C                   EXSR      INIT
      *
     C     KFMTAG        TAG
      *
      *  TURNUMMER UTFYLT
      *
     C     UPRO          IFNE      0
     C     UPRO          SETLL     HEAD11
     C     START         TAG
     C     UPRO          READE     HEAD11                                 33
     C  N33HEUR          IFEQ      'B'
     C     HEUR          OREQ      'D'
     C                   GOTO      START
     C                   END
     C* UTELAT OPPDRAGSTYPER
     C  N33UOT1          IFNE      *BLANKS
     C     UOT2          ORNE      *BLANKS
     C     UOT3          ORNE      *BLANKS
     C     UOT4          ORNE      *BLANKS
     C     UOT5          ORNE      *BLANKS
     C     HEOT          IFEQ      UOT1
     C     HEOT          OREQ      UOT2
     C     HEOT          OREQ      UOT3
     C     HEOT          OREQ      UOT4
     C     HEOT          OREQ      UOT5
     C                   GOTO      START
     C                   ENDIF                                                  <HEOT
     C                   ENDIF                                                  <UOT1
     C*
     C  N33              EXSR      PRINT
     C  N33              GOTO      START
     C*
     C     XPRT          IFEQ      'J'
     C                   Z-ADD     1             XPRANT
     C                   WRITE     PTOT
n02  c     ulaser        ifne      'A'
n02  c     skrivark      andne     'N'
n02  c                   exsr      arkivsr
n05  c                   exsr      ttsr
N02  C                   END
     C     USUM          IFEQ      'J'
     C     USUM          OREQ      'Y'
     C                   EXSR      LRSR
     C                   END
     C                   END                                                    <HENT
     C*
     C                   ELSE                                                   <UPRO
      *
      *  GODSNUMMER UTFYLT
      *
     C     UGN           IFNE      *BLANKS
     C* HENT 1. AVDELING...
     C     *LOVAL        SETLL     KODTA
     C     NESTAV        TAG
     C                   READ      KODTA                                  50
     C     *IN50         IFEQ      '0'
     C     HEAD3K        SETLL     HEAD3
     C     START2        TAG
     C     HEAD3K        READE     HEAD3                                  33
     C  N33HEDTOP        IFLT      UDATO8
     C                   GOTO      START2
     C                   END                                                    <HEDTOP
     C  N33HEUR          IFEQ      'B'
     C     HEUR          OREQ      'D'
     C                   GOTO      START2
     C                   END
     C* UTELAT OPPDRAGSTYPER
     C  N33UOT1          IFNE      *BLANKS
     C     UOT2          ORNE      *BLANKS
     C     UOT3          ORNE      *BLANKS
     C     UOT4          ORNE      *BLANKS
     C     UOT5          ORNE      *BLANKS
     C     HEOT          IFEQ      UOT1
     C     HEOT          OREQ      UOT2
     C     HEOT          OREQ      UOT3
     C     HEOT          OREQ      UOT4
     C     HEOT          OREQ      UOT5
     C                   GOTO      START2
     C                   ENDIF                                                  <HEOT
     C                   ENDIF                                                  <UOT1
     C*
     C  N33              EXSR      PRINT
     C  N33              GOTO      START2
     C*FINNES DET FLERE AVDELINGER
     C                   GOTO      NESTAV
     C                   END
      *
     C     XPRT          IFEQ      'J'
     C                   Z-ADD     1             XPRANT
     C                   WRITE     PTOT
n02  c     ulaser        ifne      'A'
n02  c     skrivark      andne     'N'
n02  c                   exsr      arkivsr
n05  c                   exsr      ttsr
N02  C                   END
     C                   END                                                    <HENT
     C                   END                                                    <UGN
     C                   END                                                    <UPRO
     C*
     C* UTSKRIFT VIA EDI-SENDINGSNR
     C     UEDS          IFNE      *BLANKS
     C                   move      UEDS          EDSKOD
     C                   moveL     UEDS          EDSSOK
     C     FriL01Key     SETLL     Frisol01
     C     FriL01Key     READE     Frisol01                               91
     C     *IN91         DOWEQ     '0'
     c     HeadfK        chain     HEADF                              91
     C                   exsr      PRINT
     C     FriL01Key     READE     Frisol01                               91
     C                   END
     C     XPRT          IFEQ      'J'
     C                   Z-ADD     1             XPRANT
     C                   WRITE     PTOT
n02  c                   exsr      arkivsr
     C                   END                                                    <HENT
     C                   END                                                    <UGN
      **
      * HVIS STRINGKODE-STYRING, HENT NESTE
     C     KFMT1         IFNE      *BLANKS
     C     KOPFM         READE     KODTFM                                 34
     C     *IN34         IFEQ      *OFF
     C                   MOVE      *ZEROS        XN
     C                   MOVE      *ZEROS        XTVKT             9 0
     C                   MOVE      *ZEROS        XTNT              7 0
     C                   MOVE      *ZEROS        XTVKT2            9 0
     C                   MOVE      *ZEROS        XTPOS             5 0
N04  C                   MOVE      'N'           skrivark          1
     C                   GOTO      KFMTAG
     C                   END
     C                   END
      *
N03   * Skriv alle labels  (labelkode settes til P=printed i DOKUF.)
N03  C     UPRO          IFNE      0
N03  C     USUM          andeq     'L'
N03  c                   call      'PRTLABR'
N03  c                   parm      FIFIRM        PRLFIRM           2
N03  c                   parm      UAVD          PRLAVD            4 0
N03  c                   parm      UPRO          PRLPRO            8 0
N03  c                   parm                    xOPD              7 0
N03  c                   parm                    xFBNR             3 0
N03  c                   parm                    xSNDNR           17
N03  c                   parm                    UPRTKO            1
N03  C                   PARM                    UPRT67
N03  c                   end
      *
     C                   MOVE      XPRANT        UPRANT
     C                   SETON                                        LR
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C     FERDI1        IFNE      'J'
     C     KODTPK        CHAIN     KOPR                               34
n04  c     ulaser        ifeq      'A'
n04  c                   move      *blanks       kopfm
N04  C                   END
     C  N34KOPFM         IFEQ      *BLANKS
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   ELSE
     C     KOPFM         SETLL     KODTFM
     C     KOPFM         READE     KODTFM                                 34
     C* SKRIV TURNR SOM STREK-KODE?
     C     *in34         ifeq      *OFF
     C     KFMPOS        andne     *ZEROS
     C                   MOVE      KFMPOS        NN                2 0
     C                   MOVE      UPRO          AUPRO             8
     C                   MOVEA     AUPRO         STR(NN)
     C                   END
     C   34              MOVE      *BLANKS       KFMT1
     C   34              MOVE      *BLANKS       KFMT2
     C                   END
     C                   MOVE      'J'           FERDI1            1
     C                   END
     C*
     C                   MOVE      'J'           XPRT              1
     C     HEUR          IFEQ      'H'
     C     HEATRK        CHAIN     HESTED                             34
     C  N34              MOVEL     HSFROM        HESDF
     C  N34              MOVEL     HSTO          HESDT
     C                   MOVE      *BLANKS       HERFA
     C  N96              MOVE      *BLANKS       HENAA
     C                   MOVE      *BLANKS       DIV588
     C                   MOVE      TRSDTD        HEDTOP                           ANK.DATO
     C                   END
      * AVVIKENDE HEADER-INFO UTFRA TYPE
     C                   MOVEA     '000'         *IN(97)
     C                   SELECT
     C     HEUR          WHENEQ    'F'
     C     HEUR          OREQ      'G'
     C                   MOVE      *ON           *IN97                          *SJØ
     C     HEATRK        CHAIN     BILLOF                             34
     C     HEUR          WHENEQ    'C'
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'E'
     C                   MOVE      *ON           *IN98                          *FLY
     C                   OTHER
     C                   MOVE      *ON           *IN99                          *LAND
     C                   ENDSL
      *
      *
     C   90              DO
     C                   WRITE     HEAD
     C                   WRITE     HEAD2
     C                   SETOFF                                       90
     C                   END
      * SKRIV HEADER VED 1. POST
     C     XN            IFEQ      0
     C                   MOVE      HEDTD         UDT1              2 0
     C                   MOVE      HEDTM         UDT2              2 0
     C                   MOVE      HEDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          ADAG1                           ANK.DATO
     C                   MOVE      UDT2          ADAG2
     C                   MOVE      UDT3          ADAG3
     C                   WRITE     HEAD
     C                   WRITE     HEAD2
N06   * fritekst på headernivp KODE L
N06  C                   EXSR      TurFreet
     C                   END
     C                   ADD       1             XN                5 0
     C                   WRITE     DET
     C*
      * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE LIK L)
     C     HEATRK        SETLL     FRISOK
     C     HEATRK        READE     FRISOK                                 91
     C     *IN91         DOWEQ     '0'
     C                   SORTA     DFS
     C                   MOVE      '0'           *IN91
     C     DFS(10)       IFNE      ' '
     C     'L'           LOOKUP    DFS                                    91
     C     *IN91         IFEQ      '1'
     C     FSKODE        CHAIN     KODFRI                             91
     C     *IN91         IFEQ      '0'
     C   90              DO
     C                   WRITE     HEAD
     C                   WRITE     HEAD2
     C                   SETOFF                                       90
     C                   END
     C                   WRITE     DETFS
     C                   END
     C                   END
     C                   END
     C*
     C     HEATRK        READE     FRISOK                                 91
     C                   END
      *
      * OG UTLEV.FORBEHOLD
     C     HEKFT1        IFEQ      *BLANKS
     C     HEFT1A        ANDNE     *BLANKS
     C                   WRITE     DETUFB
     C                   END
      *
     C* SKRIVER FRIE LINJER
     C     FREETK        SETLL     FREETXT2
     C     FRIST         TAG
     C     FREETK        READE     FREETXT2                               91
     C  N91
     CAN 90              DO
     C                   WRITE     HEAD
     C                   WRITE     HEAD2
     C                   SETOFF                                       90
     C                   END
     C  N91              WRITE     DET2
     C  N91              GOTO      FRIST
      * Barcode pr fraktbrev ??
     c     LOSBA         Ifeq      'J'                                          alle fbr (el av-opd)
     c     LOSBA         oreq      'O'                                          O=kun Avd-Oppdrnr.
     c     *IN80         andeq     *ON
     c                   exsr      BarCode
     c                   end
      * SKRIV STREK ETTER HVER POSISJON....
     C                   WRITE     DET3
     C*
     C                   ADD       HEVKT         XTVKT             9 0
     C                   ADD       HENT          XTNT              7 0
     C                   ADD       HEFBV         XTVKT2            9 0
     C                   ADD       1             XTPOS             5 0
     C                   EXSR      SUMVAL
      *
     C*
     C                   ENDSR
     C*
N06  C******************************************
N06  C     TurFreet      BEGSR
N06  C******************************************
N06  c     upro          chain     turer14                            91
N06  c     *in91         cabeq     '1'           UtTurFr
N06  c                   Move      *zeros        aTurFt            2 0
N06  C     FREETTK       SETLL     FREETUR2
N06  C     FREETTK       READE     FREETUR2                               91
N06  C     *IN91         doweq     '0'
N06  c                   add       1             aTurFt
N06  c     aTurFt        ifeq      1
N06  C                   WRITE     HEAD2SS                                      Turinfo Start/slutt
N06  C                   endif
N06  C                   WRITE     HEAD2F
N06  C     FREETTK       READE     FREETUR2                               91
N06  C                   enddo
N06  c     aTurFt        ifge      1
N06  C                   WRITE     HEAD2SS                                      Turinfo Start/slutt
N06  C                   endif
N06  C     UtTurFr       ENDSR
     C******************************************
     C     Barcode       BEGSR
     C******************************************
      * Barcode pr fr.brev - enten fra tr.modul innland(kun ett) eller dokuf/frisok
     C                   movea     '000'         *in(91)
N09  c                   move      *blanks       DFBREF                         U.op:0300/0001015
N09  C                   move      *zeros        DisAvdA           4
N09  C                   move      *zeros        DisOpdA           7
      * HXSNDN <> *BLANKS = REN INNLAND
     c     HXSNDN        ifeq      *blanks
     c     LOSBA         Ifeq      'J'
     c     DokKey        chain     DOKUF                              91
n07  c  n91df1004        ifne      *blanks
n07  c                   eval      HXSNDN = '401' + DF1004
n07  c                   move      *on           *in92
n07  c                   end
     c     HXSNDN        ifeq      *blanks
     c     IFBKey        chain     FRISOK                             91
n07  c  n91fssok         ifne      *blanks
n07  c                   eval      HXSNDN = '401' + FSSOK
n07  c                   move      *on           *in93
N09  c                   move      *blanks       DFNAVL                         Ikke opd/fb,kun fbnr
n07  c                   end
     c                   end
     c                   end
     c                   else
     c                   eval      HXSNDN = *blanks
     c                   end
N09
      *
     c     NextBar       tag
n08  C   90              DO
n08  C                   WRITE     HEAD
n08  C                   WRITE     HEAD2
n08  C                   SETOFF                                       90
n08  C                   END

N09   * er det videresendt til dup/distribusjonsoppdrag (93 ON = VIA DOKUF EL IFB..)
N09  C                   move      *zeros        DisAvd            4 0
N09  C                   move      *zeros        DisOpd            7 0
N09  C                   if        TROPD2<>0
N09  C                   move      TRAVD2        DisAvd
N09  C                   move      TROPD2        DisOpd
N09  C                   move      DisAvd        DisAvdA
N09  C                   move      DisOpd        DisOpdA
N09  c*                  else                                                   12345678901234567
N09  c*                  if        %subst(DFBREF:1:5)='U.op:'                   U.op:0300/0001015
N09  c*                  eval      DisAvdA=%subst(DFBREF:6:4)
N09  c*                  eval      DisOpdA=%subst(DFBREF:11:7)
N09  C*                  move      DisAvdA       DisAvd
N09  C*                  move      DisOpdA       DisOpd
N09  c*                  endif
N09  c                   endif
      *
N09  c                   if        DisOpd<>0
N09  c     DisKey        chain     HEADF                              33
N09  c                   if        *IN33 = *off
N09  c                   eval      DFBREF='DUP.:'+DisAvdA+'/'+DisOpdA
N09  c                   eval      DFNT   = HENT
N09  c                   eval      DFVKT  = HEVKT
N09  c                   eval      DFNAVL = HENAK
N09  c                   eval      DFAD1L = HEADK3
N09  c                   movel     HEADK3        DFPOUL
N09  c                   eval      DFADUL = %subst(HEADK3:6)
N09  c                   endif
N09  c                   endif
N09   *
N09   *  OBS HXSNDN er enten fra innland ELLER fra DOKUF / FRISOK
     C     HXsndn        ifne      *blanks
N09  c                   move      *blanks       DISTXT1
N09  c                   move      *blanks       DISTXT2
N09  c                   move      *blanks       DISTXT3
N09  C     DFNAVL        ifne      *blanks
N09  c                   move      DFPOUL        DFPOULA           4
N09  c                   eval      DISTXT1=%trim(DFNAVL)+', '+%trim(DFAD1L)
N09  c                                    +', '+DFPOULA+' '+%trim(DFADUL)
N09  c
N09  c                   eval      DISTXT2='Ant:'+ %trimr(%editc(DFNT:'3'))
N09  c                                    +' Vekt:'+ %trimr(%editc(DFVKT:'3'))
N09  c                   eval      DISTXT3=DFBREF
N09  c                   endif
     c     BarLR         ifeq      'L'
     c                   write     BarLeft
     c                   else
     c                   write     BarRight
     c                   end
     c                   else
     c                   move      HEAVD         HEAVDA
     c                   move      *zeros        HEOPDA
     c                   move      HEOPD         HEOPDA
     c     BarLR         ifeq      'L'
     c                   write     BarLeftO
     c                   else
     c                   write     BarRightO
     c                   end
     c                   end
     c*
     c     BarLR         ifeq      'L'
     c                   move      'R'           BarLR
     c                   else
     c                   move      'L'           BarLR
     c                   end
      * spredning? (VIA DOKUF ELLER  LØSE EKSTERN-REFER I IFB..)
     c     *in91         ifeq      *off
     c     *in92         ifeq      *on
     c     DokKey        reade     DOKUF                                  91
     c  n91              eval      HXSNDN = '401' + DF1004
     c  n91              write     BarSpace
     c  n91              goto      NextBar
     c                   end
     c     *in93         ifeq      *on
N09  c                   move      *blanks       DFBREF
N09  c                   move      *blanks       DFNAVL                         Ikke opd/fb,kun fbnr
     c     IFBKey        reade     FRISOK                                 91
     c  n91              eval      HXSNDN = '401' + FSSOK
     c  n91              write     BarSpace
     c  n91              goto      NextBar
     c                   end
     c                   end
      *
     C*
     C                   ENDSR
     C*
     C******************************************
     C     SUMVAL        BEGSR
     C******************************************
     C                   SETOFF                                       88
     C     FAK2K         SETLL     FAK2
     C     STVA          TAG
     C     HEAVD         READE     FAK2                                   88
     C  N88HEOPD         COMP      FAOPD                              8888
     C  N88              DO
     C     FAKDA         IFEQ      'K'
     C     FAKDA         OREQ      'D'
     C     FAOPKO        OREQ      'D'
     C                   GOTO      STVA
     C                   END
     C     ASSAMK        CHAIN     ASSAM                              89
     C   89              DO
     C                   MOVE      FAVK          ASMVK
     C                   MOVE      FAVAL         ASMVAL
     C                   Z-ADD     FABELV        ASMBLV
     C                   Z-ADD     1             ASMNT
     C                   Z-ADD     FABELN        ASMBLN
     C                   WRITE     ASSAMR
     C                   END
     C  N89              DO
     C                   ADD       FABELV        ASMBLV
     C                   ADD       1             ASMNT
     C                   ADD       FABELN        ASMBLN
     C                   UPDATE    ASSAMR
     C                   END
     C                   END
     C  N88              GOTO      STVA
     C*
     C                   ENDSR
     C*
     C******************************************
     C     LRSR          BEGSR
     C******************************************
      * sideskiftindikator på fri å undertykke   barcode
     C                   move      *on           *in90
     C                   WRITE     HEAD
     C                   WRITE     H1
     C*
     C                   MOVE      *BLANKS       FAVK
     C                   MOVE      *BLANKS       FAVAL
     C     ASSAMK        SETLL     ASSAM
     C                   SETOFF                                       88
     C     STLR          TAG
     C                   READ(N)   ASSAM                                  88
     C  N88              DO
     C     KODGEK        CHAIN     KODTGE                             33
     C   88              DO
     C                   WRITE     HEAD
     C                   WRITE     H1
     C                   END
     C                   WRITE     D1
     C                   ADD       ASMBLN        XTOTAL           13 2
     C                   GOTO      STLR
     C                   END
     C*
     C                   WRITE     T1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEAD3K        KLIST
     C                   KFLD                    KOAAVD
     C                   KFLD                    UGN
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YSK
     C     ASSAMK        KLIST
     C                   KFLD                    FAVK
     C                   KFLD                    FAVAL
     C     HODEK         KLIST
     C                   KFLD                    YNET
     C                   KFLD                    UAVD
     C     KODTHK        KLIST
     C                   KFLD                    YHUNI
     C                   KFLD                    UAVD
     C     KODGEK        KLIST
     C                   KFLD                    YGEUNI
     C                   KFLD                    ASMVK
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXSKKO            1
     C                   MOVE      'L'           XXSKKO
     C     HEATRK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
N09  C     DisKey        KLIST
N09  C                   KFLD                    DisAvd
N09  C                   KFLD                    DisOpd
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    HEAVD
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI
     C                   Z-ADD     11            KOPLNR
     C     BarKey        KLIST
     C                   KFLD                    XXPAKN            8 0
     C                   KFLD                    XXPAID            5
     C                   movel     'LOSBA'       XXPAID
     C     DOKKey        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   move      'F'           DFRI
     C     IFBKey        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    IFBKODE
     C                   move      'IFB'         IFBKODE           3
     C     FriL01Key     KLIST
     C                   KFLD                    EDSKOD            3
     C                   KFLD                    EDSSOK           35
     C     HEAdfK        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
N06  C     FREETTK       KLIST
N06  C                   KFLD                    TUAVD
N06  C                   KFLD                    TUPRO
N06  C                   KFLD                    XXSKKO
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UPRANT            2
     C                   PARM                    UIN03             1
     C                   PARM                    UIN04             1
     C                   PARM                    ULASER            1
     C                   PARM                    UEDS             39
     C     ULASER        COMP      'P'                                    80
N01  C  N80ULASER        COMP      'F'                                    80
N01  C  N80ULASER        COMP      'A'                                    80
N03  C     *LOVAL        SETLL     FIRM
N02  C                   READ      FIRM                                   33
      * 96 on - det er kall fra Edendingsprogram med gitt EDS-parameter fylt ut..
      *    (ved kall fra normal lossel: param initiert med "*BLANKS" (unngå grums /batch)
     C                   movel     UEDS          TestEDS           7
     c     TestEDS       ifne      '*BLANKS'
     C     TestEDS       andne     *blanks
     C                   move      *on           *in96
     C                   else
     C                   MOVE      *blanks       UEDS
     C                   end
     C                   MOVE      *ZEROS        XPRANT            2 0
     C*
     C     UDATO         IFGT      501231
     C     UDATO         ADD       19000000      UDATO8            8 0
     C                   ELSE
     C     UDATO         ADD       20000000      UDATO8
     C                   END
     C                   TIME                    TID               6 0
     C                   MOVE      *BLANKS       YPOS1             7
     C                   MOVE      ' '           YSK               1
     C                   MOVE      *BLANKS       YNET              1
     C                   MOVE      'H'           YHUNI             1
     C                   MOVE      'GE'          YGEUNI            2
     C                   MOVE      UDAY          UDT1              2 0
     C                   MOVE      UMONTH        UDT2              2 0
     C                   MOVE      UYEAR         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          IDAG1
     C                   MOVE      UDT2          IDAG2
     C                   MOVE      UDT3          IDAG3
     C*
     c     BarKey        chain     SYPARL1                            33
     C  N33              MOVEL     SYVRDA        LOSBA             1
     C                   move      'L'           BarLR             1
     C*
     C     KODTHK        CHAIN     KODTH                              33
     C     KOHLOS        COMP      'J'                                    40
     C   40HODEK         CHAIN     HODE                               33
     C     *IN40         IFEQ      '1'
     C     *IN33         ANDEQ     '0'
     C                   MOVE      HP(1)         HP1
     C                   MOVE      HP(2)         HP2
     C                   MOVE      HP(3)         HP3
     C                   MOVE      HP(4)         HP4
     C                   MOVE      HP(5)         HP5
     C                   MOVE      HP(6)         HP6
     C                   MOVE      HP(7)         HP7
     C                   END
     C*
     C                   MOVE      UPRO          AUPRO             8
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     GETMSB        BEGSR
     C***********************************************
     C* GETS MSGMEMBERS
     C*
     C                   MOVE      'PRI0024'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI024           24
     C*
     C*
     C                   MOVE      'DIV0062'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DIV062            5
     C*
     C                   MOVE      'DIV0084'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DIV084            5
     C*
     C                   MOVE      'DIV1098'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DIV198            4
     C*
     C                   MOVE      'DIV0588'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DIV588            4
     C*
     C                   MOVE      'DIV2130'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DI2130            3
     C*
     C                   MOVE      'DIV1440'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DIV140            7
     C*
     C                   MOVE      'JOV0355'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV355           16
     C*
     C                   MOVE      'DIV1916'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          DIV116            8
     C*
     C                   MOVE      'PRI0012'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI012           24
     C*
     C                   MOVE      'PRI0025'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     120           XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI025           24
     C*
     C                   MOVE      'PRI0026'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI026           24
     C*
     C                   MOVE      'PRI0027'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI027           11
     C*
     C                   MOVE      'JOV0563'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI028           10
     C*
     C                   MOVE      'PRI0029'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          PRI029            5
     C*
     C                   MOVE      'PRI0006'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV246           10
     C*
     C                   MOVE      'JOV0690'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV690            7
     C*
     C                   MOVE      'JOV0691'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV691            5
     C*
     C                   MOVE      'JOV0692'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV692           80
     C*
     C                   MOVE      'YBC0491'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          YBC491           24
     C*
     C                   MOVE      'PRI0010'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR010           11
     C*
     C                   MOVE      'PRI0013'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR013           14
     C*
     C                   MOVE      'PRI0014'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR014           17
     C*
     C                   MOVE      'PRI0015'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          VAR015           15
     C*
     C*
     C                   MOVE      'JOV1026'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV026           12
     C*
     C                   MOVE      'JOV1027'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          JOV027           10
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETTXT        BEGSR
     C***********************************************
     C                   Z-ADD     3             XLEVEL            1 0
     C                   Z-ADD     0             XRETUR            1 0
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG            120
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
n02  C***********************************************
n02  C     ARKIVSR       BEGSR
n02  C***********************************************
n02  C***********************************************
n02  C                   TIME                    XULTID
n02  C                   MOVE      XULDD         ULDD
n02  C                   MOVE      XULMM         ULMM
n02  C                   MOVE      XULÅÅ         ULÅÅ
n02  C     FIFIRM        CHAIN     FIRMARC                            33
n02  C     *IN33         IFEQ      '0'
n02  C     'lo'          chain     arktxt                             33
n02  C     *IN33         IFEQ      '0'
n02  C     arkjn         andeq     'J'
n02   *
n02  C                   MOVE      FIFIRM        ARFIRM
n02  C                   MOVE      *zeros        ARAVD
n02  C                   MOVE      *zeros        AROPD
n02  C                   MOVEL     upro          ARUNDE
n02  C                   MOVE      'lo'          ARTYPE
n02  C                   MOVE      ZUSER         ARUSER
n02  C                   MOVE      ULDT          ARDATE
n02  C                   MOVE      XULTM         ARTIME
n02  C                   MOVE      *zeros        ARKUND
n02  C                   WRITE     ARKIVR
n02  C                   END
n02  C                   END
n02  C                   ENDSR
n05  C***********************************************
n05  C     TTSR          BEGSR
n05  C***********************************************
n05  c     upro          chain     turer14                            35
n05  c     *in35         ifeq      '0'
n05  c                   move      tuavd         ttavd
n05  c                   move      tupro         tttur
n05  c                   move      *zeros        ttopd
n05  C                   MOVE      'UNL'         TTACTI
n05  C                   MOVE      ULDT          TTDATE
n05  C                   MOVE      XULTM         TTTIME
n05  C                   MOVE      TTDATE        TTDATL
n05  C                   MOVE      TTTIME        TTTIML
n05  C                   MOVEL     ZUSER         TTUSER
n05  C     TUKNT2        IFNE      *ZEROS
n05  C                   MOVEL     TUKNT2        TUKNT
n05  C                   End
n05  C                   EVAL      TTTEXT = 'Unloadinglist printed, Transp: '
n05  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n05  C                   EVAL      TTTEXL = 'Losseliste skrevet Transp: '
n05  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n05  C     HEKNA         IFNE      *ZEROS
n05  C                   MOVEL     ' Agent: '    XXTEXT           16
n05  C                   MOVE      '        '    XXTEXT
n05  C                   MOVE      HEKNA         XXTEXT
n05  C                   MOVE      XXTEXT        TTTEXT
n05  C                   MOVE      XXTEXT        TTTEXL
n05  C                   END
n05  C                   WRITE     TRACKFR
n05  C     UTTT          TAG
n05  c                   end
n05  C                   ENDSR
