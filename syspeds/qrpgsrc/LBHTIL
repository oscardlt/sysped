      * Prog kan kalles på oppdragsnivå og linjenrivå(ulik 0 i UULINR)
      * men pr nå (2015.03.31) er dte kun kall på oppdragsnivå som er relevant) Inp til SYFI10X
      * Tilleg på linje/kolli-nivå skapes IKKE av SYFI10X og må ha all info i FAKTIL
      *    (og oppslag som kun returnere Tillegskoden er dermed meningsløst for linjetillegg...)
     FHEADF     IF   E           K DISK
     FDOKUFV    IF   E           K DISK
     FFAKTIL    IF   E           K DISK
      *
     C     *entry        PLIST
     C                   PARM                    UUAVD             4 0
     C                   PARM                    UUOPD             7 0
     C                   PARM                    UULINR            2 0
     C                   PARM                    UUTIL             5
     C                   move      *blanks       UUTIL
     C                   move      'O'           UUNIV             1
     C                   If        UULINR<>0
     C                   move      'L'           UUNIV
     C                   endif
      *
     C                   z-add     UUAVD         HEAVD
     C                   z-add     UUOPD         HEOPD
     C     HeadKey       KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     DokufvKey     KLIST
     C                   KFLD                    FVRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FVFBNR
     C                   MOVE      'F'           FVRI
     C                   Z-ADD     1             FVFBNR
     C     DokufvKeyL    KLIST
     C                   KFLD                    FVRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FVFBNR
     C                   KFLD                    FVLINR
     C                   Z-ADD     UULINR        FVLINR
     C     FTKey         KLIST
     C                   KFLD                    FTKUND
     C                   KFLD                    UUNIV
      *
     C                   EXSR      FinnTill
      *
     C                   seton                                        LR
     C***********************************************
     C     FinnTill      BEGSR
     C***********************************************
     C                   move      *zeros        MaxLen            4 0
     C                   move      *zeros        MaxBre            4 0
     C                   move      *zeros        MaxHoy            4 0
     C                   if        UULINR <> 0
     C     DokufvKeyL    chain     DOKUFV                             34
     c  N33              exsr      TstLBH
     C                   else
     C     DokufvKey     setll     DOKUFV
     C     DokufvKey     reade     DOKUFV                                 34
     C     *in34         doweq     '0'
     c                   exsr      TstLBH
     C     DokufvKey     reade     DOKUFV                                 34
     C                   enddo
     C                   endif
      * Ingen mål oppgitt = hopp ut
     C                   if        MaxLen=0 and MaxBre=0 and MaxHoy=0
     C                   goto      UtFinn
     C                   endif
      *
     c* MÅL ER OPPGITT sjekk mot verdier for Len/bre/høyde-tillegg
     c* Finn fraktbet i oppdraget.
     c*   Om det finnes minst en styrings-Record på denne foventes alt å være på kundenivå
     c     HeadKey       chain     HEADF                              33
     c                   if        TRKDFF = 'S'
     c                   eval      FTKUND = HEKNSF
     c                   else
     c                   eval      FTKUND = HEKNKF
     c                   endif
     c     FTKey         chain     FAKTIL                             33
     c   33              move      *zeros        FTKUND
      **
      **
     C     FTKey         setll     FAKTIL
     C     FTKey         reade     FAKTIL                                 34
     C     *in34         doweq     '0'
      *
     C                   if        %subst(FTTYPE:1:6)='LENGDE'
     c                   if        MaxLen > FTMAX
     c                   eval      UUTIL = %trim(UUTIL) + FTKODE
     c                   endif
     c                   endif
     C                   if        %subst(FTTYPE:1:6)='BREDDE'
     c                   if        MaxBre > FTMAX
     c                   eval      UUTIL = %trim(UUTIL) + FTKODE
     c                   endif
     c                   endif
     C                   if        %subst(FTTYPE:1:5)='HØYDE'
     c                   if        MaxHoy > FTMAX
     c                   eval      UUTIL = %trim(UUTIL) + FTKODE
     c                   endif
     c                   endif
      *
     C     FTKey         reade     FAKTIL                                 34
     C                   enddo
     C     UtFinn        ENDSR
      ***************************************************
     C     TstLBH        BEGSR
      ***************************************************
     C                   if        FVLEN > MaxLen
     C                   eval      MaxLen = FVLEN
     c                   endif
     C                   if        FVBRD > MaxBre
     C                   eval      MaxBre = FVBRD
     c                   endif
     C                   if        FVHOY > MaxHoy
     C                   eval      MaxHoy = FVHOY
     c                   endif
     C                   ENDSR
