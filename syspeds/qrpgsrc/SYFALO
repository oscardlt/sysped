      *
      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE UT      ***
      ***                   LOSELISTE                          ***
      ************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Printer for merkelapp inn i UDS
********************************************************************
      *
     FFIRM      IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTH     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FSYFALOFM  CF   E             WORKSTN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  KOVFIR                 3      4
     D  KOVPRO                13     13
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UDT1                  30     35  0
     D  KOWHOD                47     47
     D  KOWBBS                48     48
     D  UDTÅ                  64     65  0
     D  UDTM                  66     67  0
     D  UDTD                  68     69  0
     D  UDT2                  64     69  0
     D  UOT1                  70     71
     D  UOT2                  72     73
     D  UOT3                  74     75
     D  UOT4                  76     77
     D  UOT5                  78     79
     D  USUM                  80     80
     D* XBLA1/XBLA2 ER IKKE I BRUK. HVIS TAR NOEN POSISJONER TIL BRUK
     D* HUSK Å SYNKE STØRRELSE PÅ XBLA1/XBL2
     D  XBLA1                 22    256
     D  XBLA2                257    510
     D  UPRT11               821    830
     D  UPT11                831    840
     D  UPRT12               841    850
     D  UPT12                851    860
N01  D  UPRT67               921    930
N01  D  UPT67                931    940
     D  UGN                  981    995
     I*
     C*
N01   * (tidligere styring/overstyring av label-printer må blankes..)
N01   * (losseliste KAN kalle PRTLABR sob overrider porinter / skriver labels..)
N01  c                   move      *blanks       UPRT67
N01  c                   move      *blanks       UPT67
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPLNR
     C     KODTWK        KLIST
     C                   KFLD                    WSWUNI
     C                   KFLD                    WSAVD
     C     KODTVK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    WSAVD
     C     KODTHK        KLIST
     C                   KFLD                    WSHUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    WSFUNI
     C                   KFLD                    WSSG
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UJBKØ             1
     C                   PARM                    UIN03             1
     C                   PARM                    UIN04             1
     C                   PARM                    UIN01             1
     C                   PARM                    UEDS             39
     C                   MOVE      '0'           UIN01
     C                   MOVE      'N'           UJBKØ
     C*
     C                   MOVE      'J'           WSSUM
     C                   MOVE      'J'           WSJBK
     C                   MOVE      'P'           WSPUNI            1
     C                   MOVE      'W'           WSWUNI            1
     C                   MOVE      'V'           WSVUNI            1
     C                   MOVE      'H'           WSHUNI            1
     C                   MOVE      'SF'          WSFUNI            2
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
     C                   MOVE      '01'          WSDTD
     C                   MOVE      '01'          WSDTM
     C                   MOVE      UYEAR         WSDTÅ
     C* BLANKE DE FELTENE SOM IKKE ER I BRUK
     C                   MOVE      *BLANKS       XBLA1
     C                   MOVE      *BLANKS       XBLA2
     C*
     C     FIFIRM        CHAIN     FIRM                               99
     C                   READ      FIRM                                   99
     C                   MOVE      FIFIRM        UFIRM
     C*
     C     START         TAG
     c     UEDS          ifne      *blanks
     c     UEDS          andne     '*BLANKS'
     c                   move      UEDS          UEDSK
     c                   movel     UEDS          UEDST
     C                   MOVE      ' '           WSSUM
     C                   EXFMT     WINDOWE
     c                   else
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     c                   end
     C                   SETOFF                                       309998
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C*
     C     KODTVK        CHAIN     KODTV                              99
     C  N99KODTWK        CHAIN     KODTW                              99
     C  N99KODTHK        CHAIN     KODTH                              99
     C  N99              Z-ADD     11            WSPLNR            3 0
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT11
     C  N99              MOVE      KOPTY         UPT11
     C  N99              Z-ADD     12            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT12
     C  N99              MOVE      KOPTY         UPT12
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      START
     C     WSSG          IFNE      'ALL'
     C     KODSFK        CHAIN     KODTSF                             98
     C   98              MOVE      'SPS0001'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      START
     C                   END
     C*
     C                   MOVE      WSAVD         UAVD
     C                   MOVE      WSSG          USG
     C                   MOVE      WSPRO         UPRO
     C                   MOVE      WSOT1         UOT1
     C                   MOVE      WSOT2         UOT2
     C                   MOVE      WSOT3         UOT3
     C                   MOVE      WSOT4         UOT4
     C                   MOVE      WSOT5         UOT5
     C                   MOVE      WSSUM         USUM
     C                   MOVE      WSGN          UGN
     C     WSDT          IFEQ      0
     C                   MOVE      '510101'      UDT2
     C                   ELSE
     C                   MOVE      WSDTD         UDTD
     C                   MOVE      WSDTM         UDTM
     C                   MOVE      WSDTÅ         UDTÅ
     C                   END
     C                   MOVE      *ZEROS        UDT1
     C                   MOVE      WSJBK         UJBKØ
     C     KOHLS3        IFEQ      'L'                                                      TÅENDE')
     C                   MOVE      '0'           UIN03
     C                   ELSE
     C                   MOVE      '1'           UIN03
     C                   END
     C     KOH423        IFEQ      'J'
     C                   MOVE      '1'           UIN04
     C                   ELSE
     C                   MOVE      '0'           UIN04
     C                   END
     C     WSPRT         IFNE      *BLANKS
     C                   MOVE      WSPRT         UPRT11
     C                   MOVE      WSPRT         UPRT12
     C                   END
     C     UPRT11        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT11
     C                   END
     C     UPT11         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT11
     C                   END
     C     UPRT12        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT12
     C                   END
     C     UPT12         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT12
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1FM            2 0
     C                   MOVE      WSDTM         UDT2FM            2 0
     C                   MOVE      WSDTÅ         UDT3FM            2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1FM
     C                   PARM                    UDT2FM
     C                   PARM                    UDT3FM
     C                   MOVE      UDT1FM        WSDTD
     C                   MOVE      UDT2FM        WSDTM
     C                   MOVE      UDT3FM        WSDTÅ
     C*
     C                   ENDSR
     C*
