      *
     H FTRANS
     FEPOH      IF   E           K DISK
     FEPOL      IF   E           K DISK
     FEPOK      UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FZBARC     O    F  132        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D                 DS
     D  DATA                   1    132
     D  DATA1                  4    132
     D  DATA3                  1      3
     D  TG2                    6     14
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS            10
     D BBOX1           C                   CONST('720,160,80')
     D SENDTXT         C                   CONST('Sendings-ID/Consignment')
     D KOLIDTXT        C                   CONST('Kolli-ID/Licence plate')
     D TRANTXT         C                   CONST('Transportør/Carrier')
     D PRODTXT         C                   CONST('Produkt/Product')
     D BARPAR          C                   CONST('N,250,N,N,Y,N')
     D                 DS
     D                 DS
     D  WRK                    1      4  0
     D                 DS
     D  WPCN                   1      4  0
     D  WPCA                   1      4
     D  WPCB                   2      4
     D                 DS
     D  KOID                   1     18
     D  DSIDPK                 1      1
     D  DSIDLA                 2      3
     D  DSIDLE                 4      8
     D  DSIDNR                 9     18
     D                 DS
     D  WTIME                  1     14
     D  WÅÅA                   1      4
     D  WMMA                   5      6
     D  WDDA                   7      8
     D  WTIDA                  9     10
     D  WTIDB                 11     12
      * Input Parameter
     C     *ENTRY        PLIST
     C                   PARM                    WUSR             10
     C                   PARM                    WFIRM             2
     C                   PARM                    WMLAYO            2
     C                   PARM                    WKN               8
     C                   PARM                    WBES             10
     C                   PARM                    WLIN              7
     C                   PARM                    WULIN             5
     C                   PARM                    uukopi            1
      * 77 ON = FRA WEB-LØSNING, SKAL SKRIVES UT VIA HTML
      * WW - ordinært knyttet til gitt fraktbrev, W2=Frie lapper..
     C     WMLAYO        COMP      'WW'                                   77
     C  N77WMLAYO        COMP      'W2'                                   77
     C  N77WMLAYO        COMP      'HZ'                                   77
     C                   EVAL      *IN77 = *ON
      * Open Printerfile
     C                   OPEN      ZBARC                                55
     C                   MOVE      'N'           EXTRA             1
      * Execute init routine only once
     C                   EXSR      SRINIT
      * Juster ALT xx dots til venstre (60 dots er ca 1 cm til venstre)
      * (Forenkler kundetilpasning)
     C                   MOVE      '0  '         LSDOTS            3
      *
      * Loop number of pieces
     C                   Z-ADD     1             WPCN
     C     EPOLK         SETLL     EPOK
     C                   Z-ADD     ELNTKL        XN05              5 0
     C     WPCN          DO        XN05          WPCN
      *
      * Execute Label Init
      * Send Default Instructions  (flyttet fra sr0001/sr0001K)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    ZBARCA
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    ZBARCA
      *
     C     WMLAYO        IFNE      'W2'
      * sjekk alltid først om en eksisterende Kll-id skal gjenbrukes
      * (SR0001K kaller SR0001 hvis  NY id skal tildeles)
     c                   EXSR      SR0001K
     c                   end
      * Execute Label top Text
     C                   EXSR      SR0010
      * Execute Label Lines vert/hor
     C                   EXSR      SR0005
      * Execute Shipper Name/address 1
     C                   EXSR      SR0080
      * Execute Shipper Name/address 2
     C                   IF        ADR2 <> *BLANKS
     C                   EXSR      SR0090
     C                   ENDIF
      * Execute Shipper Name/address 3
     C                   EXSR      SR0105
      * Execute Consignee Name/address 1
     C                   EXSR      SR0110
      * Execute Consignee Name/address 2
     C                   EXSR      SR0120
      * Execute Consignee Name/address 3
     C                   EXSR      SR0125
      * Execute Pieces in Consignment
     C                   EXSR      SR0050
      * Strekkode - Sendingsnr EAN 128
     C                   EXSR      SR0190
      * Strekkode - Kolliid
     C                   EXSR      SR0290
      * Execute End Label Format
     C                   EXSR      SREND
      * KUTTER SPOOLFILE I MAX 10 LABELS (MEN IKKE VED WEB..)
     C     *IN77         IFEQ      *OFF
     C     WPCN          DIV       10            XWPCN             5 0
     C                   MVR                     XWPCN
     C                   IF        XWPCN = 0
     C                   CLOSE     ZBARC                                55
     C                   OPEN      ZBARC                                55
     C                   END
     C                   END
      *
     C                   ENDDO
      * Close Prinerfile
     C                   CLOSE     ZBARC                                55
      * End Program
     C                   seton                                        LR
     C                   RETURN
      *_____________________________________________________
      * Execute Label Init copyprint
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001K       BEGSR
      *
     C     EPOLK         READE     EPOK                                   33
     C                   IF        *IN33 = *OFF
     C                   MOVE      'P'           EKST
     C                   MOVE      WDT           EKDTPR
     C                   MOVE      WUSR          EKUSR
     C                   UPDATE    EPOKR
     C                   END
     C                   EVAL      KOID = EKMRK
      *
     C                   ENDSR
      *____________________________________________________
      * Execute Label Lines Hor/Vert
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0005        BEGSR
      * First  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,150'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '650,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Second horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,345'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '650,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Third  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,632'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '650,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Execute Label top Text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C     LSDOTS        IFNE      '0  '
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     LSDOTS        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
      * Transportørnavn - Ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,360'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     TRANTXT       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Transportørnavn - data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,380'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KNAVN         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,540'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Senders ref' DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Senders ref. -data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,540'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   EVAL      DATA1 = EHBES
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *
      *_____________________________________________________
      * Execute Pieces in Consignment
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0050        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,600'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kolli'       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - kollinummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,580'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   eval      DATA1 = %trim(%editc(WPCN:'Z'))
     c                             +' AV '+%trim(%editc(XN05:'Z'))
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0080        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,40'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Fra/from'    DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA

      * Ledetekst - 2
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '300,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Utskr. dato' DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Dato - klokkeslett
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '450,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WDDA          DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WMMA:0        DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WÅÅA:0        DATA1
     C     DATA1         CAT       WTIDA:2       DATA1
     C     DATA1         CAT       ':':0         DATA1
     C     DATA1         CAT       WTIDB:0       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      **
      * Senders Navn
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,60'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KNAVN         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0090        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,90'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     ADR1          DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 4
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0105        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,120'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     POSTNR        DATA1
     C     DATA1         CAT       X_ADR3:1      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0110        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,170'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/to'      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,190'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     EHLNAV        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0120        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,240'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     EHLAD1        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 3
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0125        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,290'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     EHLAD2        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,310'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     EHLAD3        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *
      *____________________________________________________
      * Strekkode SEND.NR
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0190        BEGSR
      * Send.nr ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,640'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     SENDTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Send.nr data
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,660'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE  (1 parameter er bredde)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>8401'     DATA1
     C     DATA1         CAT       EKMRK:0       DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,915'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '(401)'       DATA1
     C     DATA1         CAT       EKMRK:0       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Til postnummer
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0040        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '18,965'      DATA1
     C                   MOVEL     '18,945'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/to'      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Destination Code
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,962'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      * Text to be printed (421)= internasj. nr / 578= Norge
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   EVAL      DATA1= '>;>8421'
     C                             + %TRIM(EHTLK) + ' ' + %TRIM(EHTSTE)
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,1215'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed (421)= internasj. nr / 578= Norge
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Eval      DATA1 = '(421)'+EHFSTE
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *____________________________________________________
      * Strekkode KOLLI ID
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0290        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,1250'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KOLIDTXT      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,1267'     DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>800'      DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,1520'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '(00)'        DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *
      *_____________________________________________________
      * Initialise subroutine, set character set
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WB3               3            B3
     C                   MOVE      'B3'          WB3               3            B3
      *
     C                   MOVEL     WA            WBC               3            B2
     C                   MOVE      'BC'          WBC               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WFR               3            FR
     C                   MOVE      'FR'          WFR               3            FR
      *
     C                   MOVEL     WA            WLS               3            XZ
     C                   MOVE      'LS'          WLS               3            XZ
      *
     C                   Z-ADD     0             ØX                3 0          Index for Ø
     C                   MOVE      *BLANKS       ØAN              12            Num alpha
     C                   MOVE      'N'           ØADEC             1            Decimal Indicator
     C                   Z-ADD     0             ÆX                3 0
      * Define workfields
     C     EPOHK         KLIST
     C                   KFLD                    EHKUND
     C                   KFLD                    EHBES
     C     EPOLK         KLIST
     C                   KFLD                    EHKUND
     C                   KFLD                    EHBES
     C                   KFLD                    ELLIN
     C                   KFLD                    ELULIN
     C     CUNDL01K      KLIST
     C                   KFLD                    WFIRM
     C                   KFLD                    EHKUND
      *
      * HENTE DAGENS DATO OG TID
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           WTIME
     C                   MOVE      WTM           WTIME
      *
     C                   MOVE      WKN           EHKUND
     C                   MOVE      WBES          EHBES
     C     EPOHK         CHAIN     EPOH                               33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   MOVE      WLIN          ELLIN
     C                   MOVE      WULIN         ELULIN
     C     EPOLK         CHAIN     EPOL                               33
     c                   MOVEL     POSTNR        X_ADR3           30
     c                   MOVE      ADR3          X_ADR3
      *
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to end Label Format
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C     LSDOTS        IFNE      '0  '
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     0             DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *
     OZBARC     E            ZBARCA
     O                       DATA
** TABELL FOR OVERSETTELSE TIL Æ,Ø,Å FOR ZEBRA STRIPE PRINTERE
ZBARC     9E7B
ZBARC     E07C
ZBARC     9F5B
ZBARC     9CC0
ZBARC     BB6A
ZBARC     47D0
