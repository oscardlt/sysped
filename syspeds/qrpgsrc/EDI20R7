      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P06078* 01 YBC PTF6 SØKEVEI FRA 15 TEGN TIL 35 TEGN
********************************************************************
     FFRISOK    IF A E           K DISK
     FCUNDL01   IF   E           K DISK
     FPWDINT    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FTELL      UF   E           K DISK
     FHEADF     IF A E           K DISK
     FRCVDST    IF   E             DISK
     FEDIINN    IF   E             DISK
     FSNDDST    O  A E             DISK
     D A               S              1    DIM(4000)                            Input string
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  RCVDT2                 1   4000
     D  Z                      1   4000
     D                                     DIM(4000)                            Output string
     D                 DS
     D  B                      1     80
     D                                     DIM(80)                              Output string
     D  RDATA                  1     80
     D                 DS
     D  DATA                   1     30
     D  D                      1     30
     D                                     DIM(30)                              Output string
     D                 DS
     D  NUMVAL                 1     30  0
     D  N                      1     30
     D                                     DIM(30)                              Output string
     D                 DS
     D  bruker1                1     10
     D  bruker2               11     20
     D  bruker3               21     30
     D  bruker4               31     40
     D  bruker5               41     50
     D  br                     1     50
     D                                     DIM(5)                               Output string
     D                 DS
     D  bootxt                 1     80
     D  ordfra                 1     10
     D  henas                 11     40
     d  avd                   42     45
     d  heavd                 47     50  0
     d  ordre                 52     57
     d  heopd                 59     63  0
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D                 DS
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
     D html            C                   CONST('<pre><ul>')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     D YANSW2          C                   CONST('Du har lagt inn følg-
     D                                     ende ordre i vår dat-
     D                                     atabase:    ')
     D YANSW3          C                   CONST('====================-
     D                                     ====================-
     D                                     =============')
     D YANSW4          C                   CONST('** Takk for ordren *-
     D                                     ***    Slutt     ***-
     D                                     *************')
     D PANSW1          C                   CONST('**Passord mangler**')
     D PANSW2          C                   CONST('**Passord er feil**')
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C     TCPJN         IFEQ      'J'
     C                   EXSR      SRBTCP
     C                   ELSE
     C                   EXSR      SRB
     C                   END
     C                   EXSR      TESTMO
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *************************************************************
     C     SRA           BEGSR
      *************************************************************
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     QTYPE         PARM      QTYPE         QTYPE             3
     C     Qvalue        PARM      Qvalue        Qvalue           15
     C     MAILA         PARM      MAILA         MAILA             8
     C     TCPJN         PARM      TCPJN         TCPJN             1
     c                   movel     qvalue        qvalu4            4
      *__________________
      * Define Nøkler
      *""""""""""""""""""
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
      *__________________
      * Define Workfields
      *""""""""""""""""""
     C                   Z-ADD     0             AX                4 0          Index for A
     C                   Z-ADD     1             BX                4 0          Index for B
     C                   Z-ADD     0             AXV               4 0          Leftindx A
     C                   Z-ADD     0             AXH               4 0          Rightindx A
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   READ      FIRM                                   33
     C                   IF        UYEAR > 50
     C                   EVAL      HEDTÅ = UYEAR + 1900
     C                   ELSE
     C                   EVAL      HEDTÅ = UYEAR + 2000
     C                   END
     C                   MOVE      UMONTH        HEDTM
     C                   MOVE      UDAY          HEDTD
     C                   MOVE      HEDTOP        HEDTR
     c                   move      'ordre fra:'  ordfra
     c                   move      'avd:'        avd
     c                   move      'ordre:'      ordre
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRB                                                  SRB /
      *************************************************************
     C     SRB           BEGSR
      *************************************************************
      *
     C                   Z-ADD     1             X                 4 0
     C                   DO        8
     C                   READ      OSRCVD                                 51
     C     *IN51         IFEQ      '0'
     C     LO:UP         XLATE     RCVDTA        RCVDTA
      *
     C                   MOVEA     RCVDTA        A(X)
     C                   MOVEA     RCVDTA        Z(X)
     C                   ADD       500           X
     C                   ENDIF
     C  N51              ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRBTCP                                            SRBTCP /
      *////////////////////////////////////////////////////////////
     C     SRBTCP        BEGSR
      *
     C                   Z-ADD     1             X                 4 0
     C                   DO        50
     C                   READ      EDIINN                                 51
     C     *IN51         IFEQ      '0'
     C     LO:UP         XLATE     EDIDTA        EDIDTA
      *
     C                   MOVEA     EDIDTA        A(X)
     C                   MOVEA     EDIDTA        Z(X)
     C                   ADD       80            X
     C                   ENDIF
     C  N51              ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TESTMO                                            testmo /
      *////////////////////////////////////////////////////////////
     C*
     C     TESTMO        BEGSR
      *
      * FJERN ALLE UNDER HEX40  men ikke 15
      *
     C     1             DO        4000          AXV
     C     A(AXV)        IFLT      X'40'
     C     A(AXV)        ANDNE     X'15'
     C                   MOVE      X'40'         A(AXV)
     C                   ENDIF
     C                   ENDDO
      *
     C                   EXSR      ORDER
     C     PWDK          IFNE      'N'
     C                   EXSR      OPDHE
     C                   END
     C                   ENDSR
      *
      *
      *////////////////////////////////////////////////////////////
      *  ORDER                                              ORDER /
      *////////////////////////////////////////////////////////////
     C     ORDER         BEGSR
      *
     C     KODKW         KLIST
     C                   KFLD                    KOWUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'W'           KOWUNI
     C     KODKV         KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'V'           KOVUNI
     c     qvalu4        ifeq      'AIRE'
     C                   MOVE      'D'           HEUR
     c                   else
     c     qvalu4        ifeq      'BILE'
     C                   MOVE      'B'           HEUR
     c                   else
     c     qvalu4        ifeq      'FLYI'
     c                   move      'E'           HEUR
     c                   end
     c                   end
     c                   end
     C                   MOVE      'C'           HEST
      *passordkontroll av bruker
     C     'PWD: '       SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       5             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          PWD               6
     C     PWD           CHAIN     PWDINT                             63
     C     *IN63         IFEQ      '1'
     C*passord feil
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      'N'           PWDK              1
     C                   END
     C*passord ikke funnet
     C                   ELSE
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PANSW1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      'N'           PWDK              1
     C                   END
     C     PWDK          IFEQ      'N'
     C                   GOTO      FEILP
     C                   END
      *avdeling
     C     'AVD: '       SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       5             AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HEAVD
     C                   MOVE      NUMVAL        AAAVD             4
     C     KODKW         CHAIN     KODTW                              33
     C     KODKV         CHAIN     KODTV                              33
     C                   END
      *signatur
     C     'SIGN: '      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HESG
     C                   END
      *sted fra
     C     'FLAND:'      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HELKS
     C                   END
     C     'FRA: '       SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       5             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HESDF
     C                   END
      *sted til
     C     'TLAND:'      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HELKK
     C                   MOVEL     DATA          HELKA
     C                   END
     C     'DEST: '      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HESDT
     C                   END
      *prefix flyselskap
     c     qvalu4        ifeq      'AIRE'
     C     'PREFIX: '    SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       8             AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HEKNT
     c                   MOVE      NUMVAL        WSFLY             3 0
     C                   MOVEL     DATA          AAFLY             3
     C                   END
     C                   END
      *kundenummer avsender
     C     'AVS: '       SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       5             AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
     C     NUMVAL        IFNE      *ZEROS
     C                   MOVE      NUMVAL        KUNDNR
     C                   END
     C                   END
     C                   MOVE      KUNDNR        HEKNS
     C                   MOVE      KUNDNR        HEKNSF
     C     KUNKEY        CHAIN     CUNDL01                            33
     C     *IN33         IFNE      '1'
     C                   MOVE      KNAVN         HENAS
     C                   MOVE      ADR1          HEADS1
     C                   MOVE      KNAVN         HEADS2
     C                   MOVE      KNAVN         HENAS
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          HEADS3
     C                   ELSE
     C                   MOVE      ENGAD3        HEADS3
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        HEADS3
     C                   MOVE      ADR3          HEADS3
     C                   END
     C                   ELSE
     C                   MOVEL     'Ukjent'      HENAS
     C                   MOVE      HEKNS         HENAS
     C                   END
      *kundenummer mottager
     C                   z-add     0             kundnr
     C     'MOTTAKER:'   SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       10            AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HEKNK
     C                   MOVE      NUMVAL        KUNDNR
     C     KUNKEY        CHAIN     CUNDL01                            33
     C     *IN33         IFNE      '1'
     C                   MOVE      KNAVN         HENAK
     C                   MOVE      ADR1          HEADK1
     C                   MOVE      KNAVN         HEADK2
     C                   MOVE      KNAVN         HENAK
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          HEADK3
     C                   ELSE
     C                   MOVE      ENGAD3        HEADK3
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        HEADK3
     C                   MOVE      ADR3          HEADK3
     C                   END
     C                   ELSE
     C                   MOVEL     'Ukjent'      HENAK
     C                   MOVE      HEKNK         HENAK
     C                   END
     C                   END
     C* NAVN ADR MANUELLT LAGT INN
     c     kundnr        ifeq      0
     C     'NAVN: '      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HENAK
     C                   END
     C     'ADR1: '      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEADK1
     C                   END
     C     'ADR2: '      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEADK2
     C                   END
     C     'ADR3: '      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEADK3
     C                   END
     C                   END
      *oppdragstype
     C     'OT: '        SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       4             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEOT
     C                   END
      *delterm
     C     'DELTERM:'    SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       9             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEFR
     C                   END
      *antall kolli
     C     'KOLLI:'      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HENT
     C                   MOVEL     DATA          AANT              7
     C                   END
      *vekt
     C     'VEKT:'       SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HEVKT
     C                   MOVEL     DATA          AAVKT             9
     C                   END
      *
      *volum i kubikk
     C     'VOLUM: '     SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   EXSR      NUMKON
      *
     C                   SELECT
     C                   WHEN      XDESIMAL = 0
     C                   MULT      1000          NUMVAL
     C                   WHEN      XDESIMAL = 1
     C                   MULT      100           NUMVAL
     C                   WHEN      XDESIMAL = 2
     C                   MULT      10            NUMVAL
     C                   WHEN      XDESIMAL = 4
     C                   DIV(H)    10            NUMVAL
     C                   WHEN      XDESIMAL = 5
     C                   DIV(H)    100           NUMVAL
     C                   ENDSL
      *
     C                   MOVE      NUMVAL        HEM3
     C                   MOVEL     DATA          AAM3              7
     C                   END
     C                   EXSR      FINNVK
      *vareslag
     C     'VARE:'       SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       6             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEVS1
     C                   END
      *order 1
     C     'ORDER1:'     SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       8             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HERFA
     C                   END
      *merk1
     C     'MERK1:'      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEGM1
     C                   END
      *merk2
     C     'MERK2:'      SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          HEGM2
     C                   END
     C     FEILP         TAG
     C     'MAILA: '     SCAN      RCVDT2        AXV                      62
     C     *IN62         IFEQ      '1'
     C                   ADD       7             AXV
     C                   EXSR      VESSE2
     C                   MOVEL     DATA          MAILA
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  VESSE2                                             VESSE2/
      *////////////////////////////////////////////////////////////
     C     VESSE2        BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   Z-ADD     1             NM                2 0
     C     1             DO        30            NM
     C     A(AXV)        IFNE      X'15'
     C                   MOVE      A(AXV)        D(NM)
     C                   ADD       1             AXV
     C                   ELSE
     C                   GOTO      UTV
     C                   END
     C                   END
     C     UTV           ENDSR
      *////////////////////////////////////////////////////////////
      *  NUMKON                                             NUMKON/
      *////////////////////////////////////////////////////////////
     C     NUMKON        BEGSR
     C                   MOVE      *ZEROS        NUMVAL
     C                   MOVE      *ZEROS        XDESIMAL          1 0
     C                   Z-ADD     30            NM                2 0
     C                   Z-ADD     30            NN                2 0
     C                   DO        30
     C     D(NM)         IFGE      '0'
     C     D(NM)         ANDLE     '9'
     C                   MOVE      D(NM)         N(NN)
     C                   SUB       1             NN
     C                   ELSE
     C     D(NM)         IFEQ      '.'
     C     D(NM)         OREQ      ','
     C                   EVAL      XDESIMAL = 30 - NN
     C                   END
     C                   END
     C                   SUB       1             NM
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SHISR                                              SHISR /
      *////////////////////////////////////////////////////////////
     C     SHISR         BEGSR
      *
      * sender svar til den som har sendt ordren
      *
      * Heading
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     html          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     YANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Underline
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     YANSW3        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Blank linje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * vår odre
     C                   MOVE      '/'           SLASH             1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Vår ref....:'RDATA
     C     RDATA         CAT       AAAVD:1       RDATA
     C     RDATA         CAT       SLASH:1       RDATA
     C     RDATA         CAT       AAOPD:1       RDATA
     C     RDATA         CAT       SLASH:1       RDATA
     C     RDATA         CAT       HESG:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * fra til sted
     C                   MOVE      '-'           BINDE             1
     C                   MOVE      '/'           slash             1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Fra-til....:'RDATA
     C     RDATA         CAT       HELKS:1       RDATA
     C     RDATA         CAT       slash:1       RDATA
     C     RDATA         CAT       HESDF:1       RDATA
     C     RDATA         CAT       BINDE:1       RDATA
     C     RDATA         CAT       HELKK:1       RDATA
     C     RDATA         CAT       slash:1       RDATA
     C     RDATA         CAT       HESDT:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * flyselskap
     c     qvalu4        ifeq      'AIRE'
     C                   MOVE      '-'           BINDE             1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Flyselskap.:'RDATA
     C     RDATA         CAT       AAFLY:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
      *
      * avsender
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Avsender...:'RDATA
     C     RDATA         CAT       HENAS:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * mottager
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Mottager...:'RDATA
     C     RDATA         CAT       HENAK:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Adr 1......:'RDATA
     C     RDATA         CAT       HEADK1:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Adr 2......:'RDATA
     C     RDATA         CAT       HEADK2:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Adr 3......:'RDATA
     C     RDATA         CAT       HEADK3:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * oppdragstype
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Opd.type...:'RDATA
     C     RDATA         CAT       HEOT:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * del.term
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Lev.bet....:'RDATA
     C     RDATA         CAT       HEFR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * antall kolli
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Ant. kolli.:'RDATA
     C     RDATA         CAT       AANT:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * vekt
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Vekt.......:'RDATA
     C     RDATA         CAT       AAVKT:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * kubikk
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Kubikk.....:'RDATA
     C     RDATA         CAT       AAM3:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      *
      * vareslag
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Vareslag...:'RDATA
     C     RDATA         CAT       HEVS1:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * deres ordre
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Deres ref..:'RDATA
     C     RDATA         CAT       HERFA:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * merknad1
     C     HEGM1         IFNE      *BLANKS
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Merknad 1..:'RDATA
     C     RDATA         CAT       HEGM1:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      *
      * merknad2
     C     HEGM2         IFNE      *BLANKS
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Merknad 2..:'RDATA
     C     RDATA         CAT       HEGM2:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      *
      *
      * Blank linje,
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *oppdaterer fri søkevei
     C     HERFA         IFNE      *BLANKS
     C                   EXSR      SRFRI
     C                   END
      * End of Info
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     YANSW4        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  OPDHE                                              OPDHE /
      *////////////////////////////////////////////////////////////
     C     OPDHE         BEGSR
     C     HEAVD         CHAIN     TELL                               33
     C     *IN33         IFNE      '1'
     C                   MOVE      TEOPDN        HEOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   WRITE     HEADFR
     C                   MOVE      HEOPD         AAOPD             5
     C                   EXSR      SHISR
     C     1             DO        5             NM                2 0
     c     br(nm)        ifne      *blanks
     c                   call      'EDI20STC'
     c                   parm                    br(nm)
     c                   parm                    bootxt
     c                   endif
     c                   enddo
     C                   ENDif
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     FINNVK        BEGSR
     C***********************************************
     C*
     C*** GETS FREIGHTWEIGHT
     C     HELM          MULT      KOVLKG        XLMLM             9 0
     C     HEM3          MULT      KOVKKG        XM3DE            12 3
     C                   ADD       0.999         XM3DE
     C                   Z-ADD     XM3DE         XM3M3             9 0
     C     HEVKT         COMP      XLMLM                              33
     C   33              Z-ADD     HEVKT         HEFBV
     C  N33              Z-ADD     XLMLM         HEFBV
     C     HEFBV         COMP      XM3M3                              33
     C  N33              Z-ADD     XM3M3         HEFBV
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     SRFRI         BEGSR
     C***********************************************
     C*
     C                   MOVE      HEAVD         FSAVD
     C                   MOVE      HEOPD         FSOPD
     C                   MOVEL     'ORD'         FSKODE
     C                   MOVEL     HERFA         FSSOK
N01  C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     C                   ENDSR
