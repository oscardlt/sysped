     FPWDINT    IF   E           K DISK
     FKRESL01   IF   E           K DISK
     FKREhL02   IF   E           K DISK
     F                                     RENAME(kresr:kresrx)
     Fkundl01   IF   E           K DISK
     Flevel01   IF   E           K DISK
     FLRESL01   IF   E           K DISK
     FLREhL02   IF   E           K DISK
     F                                     RENAME(lresr:lresrx)
     FSNDDST    O  A E             DISK
     D PANSW1          C                   CONST('**Passord mangler**')
     D PANSW2          C                   CONST('**Passord er feil**')
     D PHEA01          C                   CONST('<center><table border=0>-
     D                                     <tr><td><hr size=1 width=250><c-
     D                                     enter><b>')
     D PHEA02          C                   CONST('<font size=+2 color=-
     D                                     "#800040" face="courier new-
     D                                     ">')
     D PHEA03          C                   CONST('UOPPGJORTE POSTER</b-
     D                                     ></center></font><hr size=-
     D                                     1 width=250></td></tr></tab-
     D                                     le>')
     D PHEAA3          C                   CONST('ALLE POSTER</b-
     D                                     ></center></font><hr size=-
     D                                     1 width=250></td></tr></tab-
     D                                     le>')
     D PHEA03b         C                   CONST('<center><table borde-
     D                                     r=2 border cellspacing=5 wi-
     D                                     dth=85%><tr><td bgcolor=yel-
     D                                     low>')
     D pdet03          c                   const('<b>')
     D PHEA03c         C                   CONST('</td></tr></table>')
     D PHEA04          C                   CONST('<center><table borde-
     D                                     r=2 border cellspacing=5 wi-
     D                                     dth=85%><tr>')
     D PHEA05          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Bil.nr<br>Voucher</b></td>')
     D PHEA06          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Bilagstekst<br>Vouchertxt-
     D                                     </b></td>')
     D PHEA07          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Dato<br>Date</b></td>')
     D PHEA08          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Forf.<br>Due</b></-
     D                                     td>')
     D PHEA09          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Val<br>Cur</b></-
     D                                     td>')
     D PHEA10          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Belop<br>Amount</b></-
     D                                     td></tr>')
     D PDET01S         C                   CONST('<tr><td align=right>')
     D PDET03S         C                   CONST('<td align=right>')
     D PDET04S         C                   CONST('<td align=right bgcolor-
     D                                     =red>')
     D PDET02S         C                   CONST('<td>')
     D PDET01E         C                   CONST('</td>')
     D PDET02E         C                   CONST('</td></tr>')
     D PDETE           C                   CONST('</td></tr></table><br>')
     D                 DS
     D  bildat                 1      8
     D  bildag                 1      2  0
     D  bilmnd                 3      4  0
     D  bilaar                 5      8  0
     D                 DS
     D  tildaf                 1      8
     D  xilaar                 1      4  0
     D  xilmnd                 5      6  0
     D  xildag                 7      8  0
     D                 DS
     D  wsfra                  1      8
     D  fradag                 1      2  0
     D  framnd                 3      4  0
     D  fraaar                 5      8  0
     D                 DS
     D  wstil                  1      8
     D  tildag                 1      2  0
     D  tilmnd                 3      4  0
     D  tilaar                 5      8  0
     D                 DS
     D  tildat                 1      8
     D  aartil                 1      4  0
     D  mndtil                 5      6  0
     D  dagtil                 7      8  0
     D                 DS
     D  fordat                 1      8
     D  ffddag                 1      2  0
     D  ffdmnd                 3      4  0
     D  ffdaar                 5      8  0
     D                 DS
     D  bilnra                 1      7
     D  bn                     1      7
     D                                     DIM(7)                               Output string
     D                 DS
     D  restva                 1     11
     D  restvd                10     11
     D  restvh                 1      9
     D  rv                     1     11
     D                                     DIM(11)                              Output string
     D                 DS
     D  kundnr                 1      8  0
     D  kundnra                1      8
     D                 DS
     D  levnr                  1      8  0
     D  levnra                 1      8
     D                 DS
     D  belhel                 1      9
     D  komma                 10     10
     D  beldes                11     12
     D  plumin                13     13
     D  nybel                  1     13
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      TESTMO
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *************************************************************
     C     SRA           BEGSR
      *************************************************************
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     QTYPE         PARM      QTYPE         QTYPE             3
     C     QVALUE        PARM      QVALUE        QVALUE           15
     C     QPWD          PARM      QPWD          QPWD              6
     C     TCPJN         PARM      TCPJN         TCPJN             1
     c                   parm                    frad              8
     c                   parm                    tild              8
     c                   movel     qvalue        qvalu4            4
     c                   move      frad          wsfra
     c                   move      tild          wstil
     c                   move      tildag        dagtil
     c                   move      tilmnd        mndtil
     c                   move      tilaar        aartil
      *__________________
      * Define Nøkler
      *""""""""""""""""""
     C     RESKEY        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    KUNDNR
     C     RESKE2        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    levenr
     C     RESKAY        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    KUNDNR
     c                   kfld                    fraaar
     c                   kfld                    framnd
     c                   kfld                    fradag
     C     RESKA2        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    levenr
     c                   kfld                    fraaar
     c                   kfld                    framnd
     c                   kfld                    fradag
     C                   MOVE      X'0D'         RDATA
     C                   MOVE      ','           komma
      *__________________
      * Define Workfields
      *""""""""""""""""""
     C                   ENDSR
      *
     C     TESTMO        BEGSR
      *
      *passordkontroll av bruker
     C     QPWD          CHAIN     PWDINT                             63
     C     *IN63         IFEQ      '1'
     C*passord feil
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      'N'           PWDK              1
     C                   GOTO      FEILP
     C                   END
     C* Les kunde/levnavn
     c     qtype         ifeq      'deb'
     C     RESKEY        chain     kundl01                            37
     c                   else
     C     RESKE2        chain     level01                            37
     c                   end
      *heading
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA01        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA02        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     c     qvalu4        ifeq      'OPEN'
     C                   MOVEL     PHEA03        RDATA
     c                   else
     C                   MOVEL     PHEAA3        RDATA
     c                   end
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*kunde/lev
     c*start-linje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA03b       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     c                   move      *blanks       rdata
     C                   movel     pdet03        RDATA
     c     qtype         ifeq      'deb'
     C     RDATA         CAT       'Debitor:':1  RDATA
     C     RDATA         CAT       kundnra:1     RDATA
     C     RDATA         CAT       'Navn:':1     RDATA
     C     RDATA         CAT       knavn:1       RDATA
     c                   else
     C     RDATA         CAT       'Kreditor:':1 RDATA
     C     RDATA         CAT       levnra:1      RDATA
     C     RDATA         CAT       'Navn:':1     RDATA
     C     RDATA         CAT       lnavn:1       RDATA
     c                   end
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA03c       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c* slutt kundenavn
     c* saldolinje
     c*start-linje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA03b       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     c                   move      *blanks       rdata
     C                   movel     pdet03        RDATA
     C     RDATA         CAT       'Saldo NOK:':1RDATA
     c     qtype         ifeq      'kre'
     c                   z-sub     ksaldo        ksaldo
     c                   end
     c     ksaldo        iflt      *zeros
     c                   z-sub     ksaldo        restv2           11 2
     c                   else
     c                   z-add     ksaldo        restv2           11 2
     c                   end
     c                   move      restv2        restva
     c     1             do        9             xx                2 0
     c     rv(xx)        ifeq      '0'
     c                   move      ' '           rv(xx)
     c                   else
     c                   goto      ut2a
     c                   end
     c                   end
     c     ut2a          tag
     c                   move      restvh        belhel
     c                   move      restvd        beldes
     c                   move      ' '           plumin
     c     ksaldo        iflt      *zeros
     c                   move      '-'           plumin
     c                   end
     C     RDATA         CAT       nybel:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA03c       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c* slutt Saldolinje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA04        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA05        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA06        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA07        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA08        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA09        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA10        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C* Les reskontroposter
     c     qtype         ifeq      'deb'
     c     qvalu4        ifeq      'OPEN'
     C     RESKEY        SETLL     KRESL01
     c                   else
     c     reskay        setll     krehl02
     c                   end
     c                   else
     c     qvalu4        ifeq      'OPEN'
     C     RESKE2        SETLL     lRESL01
     c                   else
     c     reska2        setll     lrehl02
     c                   end
     c                   end
     C     *IN33         DoUEQ     '1'
     c     qtype         ifeq      'deb'
     c     qvalu4        ifeq      'OPEN'
     C     RESKEY        READE     KRESL01                                33
     c                   else
     c     reskey        reade     krehl02                                33
     c  n33              movel     bilaar        xilaar
     c  n33              movel     bilmnd        xilmnd
     c  n33              movel     bildag        xildag
     c  N33tildaf        comp      tildat                             33
     c                   end
     c                   else
     c     qvalu4        ifeq      'OPEN'
     C     RESKE2        READE     lRESL01                                33
     c                   else
     c     reske2        reade     lrehl02                                33
     c  n33              movel     bilaar        xilaar
     c  n33              movel     bilmnd        xilmnd
     c  n33              movel     bildag        xildag
     c  N33tildaf        comp      tildat                             33
     c                   end
     c                   end
     C     *IN33         IFEQ      '0'
     c     qvalu4        ifeq      'ALLE'
     c                   z-add     belopv        restv
     c                   end
     C     VALKOD        IFEQ      *BLANKS
     C                   MOVE      'NOK'         VALKOD
     c     qvalu4        ifeq      'OPEN'
     C                   Z-ADD     RESTN         RESTV
     c                   else
     c                   z-add     belopn        restv
     c                   end
     C                   END
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdet01s:1     RDATA
     c                   move      bilnr         bilnra
     c     1             do        7             xx                2 0
     c     bn(xx)        ifeq      '0'
     c                   move      ' '           bn(xx)
     c                   else
     c                   goto      ut
     c                   end
     c                   end
     c     ut            tag
     C     RDATA         CAT       bilnra:1      RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdet02s:1     RDATA
     C     RDATA         CAT       biltxt:1      RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdet02s:1     RDATA
     C     RDATA         CAT       bildat:1      RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdet02s:1     RDATA
     C     RDATA         CAT       fordat:1      RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdet02s:1     RDATA
     C     RDATA         CAT       valkod:1      RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   move      *blanks       rdata
     c     qtype         ifeq      'kre'
     c                   z-sub     restv         restv
     c                   end
     c     restv         iflt      *zeros
     c                   z-sub     restv         restv2           11 2
     c                   else
     c                   z-add     restv         restv2           11 2
     c                   end
     c                   move      restv2        restva
     c     1             do        9             xx                2 0
     c     rv(xx)        ifeq      '0'
     c                   move      ' '           rv(xx)
     c                   else
     c                   goto      ut2
     c                   end
     c                   end
     c     ut2           tag
     c                   move      restvh        belhel
     c                   move      restvd        beldes
     c                   move      ' '           plumin
     c     restv         iflt      *zeros
     c                   move      '-'           plumin
     c                   end
     c     restv         ifgt      0
     C     RDATA         CAT       pdet03s:1     RDATA
     c                   else
     C     RDATA         CAT       pdet04s:1     RDATA
     c                   end
     C     RDATA         CAT       nybel:1       RDATA
     C     RDATA         CAT       pdet02e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
     C                   END
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdete:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C     FEILP         ENDSR
