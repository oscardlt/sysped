********************************************************************
     H DECEDIT(',') debug(*yes)
      ************************************************************************
      *  finner ett oppdrags andel av rene turkostnader
      ************************************************************************
     FFIRM      IF   E           K DISK
     FVALUL01   IF   E           K DISK
     Fhead11    IF   E           K DISK
     FKOSBU17   IF   E           K DISK
      *
     c                   exsr      init
      * SUMMERER BUDSJETT  PÅ   TUR
     C                   EXSR      SUMBUD
      *
      * SUMMERER VEKT PÅ TUR
      *
     c                   exsr      SUMVKTSR
     c                   exsr      fordel
      *
     c                   seton                                        lr
     c                   return
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     c     *entry        plist
     c                   parm                    uproa             8
     C                   PARM                    UAVDa             4
     C                   PARM                    UOPDa             7
     c                   parm                    ufordel          13
     c                   move      uproa         upro              8 0
     c                   move      UAVDA         UAVDN             4 0
     c                   move      UOPDA         UOPDN             7 0
     c                   z-add     upro          hepro
     C     turkey        KLIST
     C                   KFLD                    hepro
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    BUVAL
     C     KOSB17K       KLIST
     C                   KFLD                    YYST
     C                   KFLD                    HEPRO             8 0
     C                   KFLD                    AVDNUL            4 0
     C                   KFLD                    OPDNUL            7 0
     C                   MOVE      ' '           YYST              1
     C                   READ      FIRM                                   33
     C                   ENDSR
      *
      ***********************************************
     C     sumvktsr      BEGSR
      ***********************************************
      *  summerer fraktvekt
      *
     c                   setoff                                       33
     c     turkey        setll     head11
     c     *in33         doweq     '0'
     c     turkey        reade     head11                                 33
     c  N33hefbv         ifeq      0
     c                   z-add     1             hefbv
     c                   end
     C     UAVDN         IFEQ      HEAVD
     C     UOPDN         ANDEQ     HEOPD
     C                   Z-ADD     HEFBV         HEFBVD            9 0
     C                   END
     c  N33              add       hefbv         sumvkt           15 2
     c                   enddo
     C                   ENDSR
      ***********************************************
     C     fordel        BEGSR
      ***********************************************
      *  summerer fraktvekt
      *
     c                   setoff                                       33
     c     hefbvd        div       sumvkt        faktor           17 5
     c     sumbudt       mult      faktor        heandel          13 2
     c                   move      heandel       ufordel
     C                   ENDSR
      ***********************************************
     C     SUMBUD        BEGSR
      ***********************************************
      *
      * SUMMERER RENE TURBUDSJETTER
      *
     C                   MOVE      *ZEROS        SUMBUDT          13 2
     C     KOSB17K       SETLL     KOSBU17
     C     KOSB17K       READE     KOSBU17                                33
     C     *IN33         DOWEQ     '0'
     C* Omregn valuta
     C     BUVAL         IFNE      FICURR
     C     VALU1K        CHAIN     VALUL01                            34
     C  N34VALKU1        DIV       OMRFAK        XFAK              9 6
     C  N34              MULT(H)   XFAK          BUBL
     C                   END
     C                   SUB       BUBL          SUMBUDT
     C     KOSB17K       READE     KOSBU17                                33
     C                   END
     C                   ENDSR
      *
