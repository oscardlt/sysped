      ***********************************************************
      *** PROGRAM for arkivering
      ***********************************************************
     FFIRM      IF   E           K DISK
     FARKIVL06  IF A E           K DISK
     FFAIN      IF   E           K DISK
     Fheadf     IF   E           K DISK
     FFAK9      IF   E           K DISK
     D                SDS
     D  UUSR                 254    263
      *
     c     KEYFAI        klist
     c                   kfld                    FIFN
      *
     c     KEYhea        klist
     c                   kfld                    FIavd
     c                   kfld                    FIopd
      *
     C                   READ      FIRM                                   33
     C                   MOVE      FIFIRM        ARFIRM
      *
     c     KEYSIN        klist
     c                   kfld                    ARFIRM
     C                   KFLD                    ARSING
     C                   KFLD                    ARUNDE
     C                   MOVE      'fa'          ARSING            2
      *
     c     KEYSAM        klist
     c                   kfld                    ARFIRM
     C                   KFLD                    ARSAML
     C                   KFLD                    ARUNDE
     C                   MOVE      'fs'          ARSAML            2
      *
     C     KEYFAI        SETLL     FAIN
      *************************************************************************
     C     LES           TAG
      *************************************************************************
      *
     C                   READ      FAIN                                   33
     c     *in(33)       ifeq      '1'
     c                   goto      slutt
     c                   end
      *
     c     keyhea        chain     headf                              36
     c     *in(36)       ifeq      '0'
     C     FIFN          CHAIN     FAK9                               34
     C     *IN(34)       IFEQ      '0'
     C     FAKDA         ANDNE     'K'
     C     FAOPKO        ANDEQ     'O'
     C*
     C                   MOVEL     FAFAKT        ARUNDE
     C                   MOVE      FADATO        ARDATE
     C                   MOVE      UUSR          ARUSER
     C                   MOVE      FAKUNR        ARKUND
     C                   Z-ADD     120000        ARTIME
      *
      * SAMLE
      *
     C     FAKDA         IFEQ      'S'
     C     KEYSAM        CHAIN     ARKIVL06                           36
     C                   MOVE      'fs'          ARTYPE
     C                   move      *zeros        ARAVD
     C                   move      *zeros        AROPD
     C     FIFN          SETGT     FAIN
      *
      * SINGEL
      *
     C                   ELSE
     C     KEYSIN        CHAIN     ARKIVL06                           36
     C                   MOVE      'fa'          ARTYPE
     C                   move      FAAVD         ARAVD
     C                   move      FAOPD         AROPD
     C                   END
      *
      * SKRIVER VED INDIKATOR 36
      *
     C     *IN36         IFEQ      '1'
     C                   WRITE     ARKIVR
     C                   END
     C                   END
     C                   END
     C                   GOTO      LES
      *
     c     slutt         tag
     c                   move      'fa'          artype
     c                   call      'ARC002CLB'
     c                   parm                    artype
     c                   parm                    uusr
     c                   move      'fs'          artype
     c                   call      'ARC002CLB'
     c                   parm                    artype
     c                   parm                    uusr
      *
     c                   seton                                        lr
     c                   return
      *
