             PGM        PARM(&TURNR &AGENT &STMF &BANE &BANES +
                          &INFOP &AVD &FAK)
             DCL        VAR(&LASER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAKT) TYPE(*DEC) LEN(3 0) VALUE(004)
             DCL        VAR(&LOGO) TYPE(*CHAR) LEN(10) +
                          VALUE('LOGOFAKT')
             DCL        VAR(&DRAWER) TYPE(*CHAR) LEN(7)
             DCL        VAR(&DRAWUT) TYPE(*CHAR) LEN(11)
             DCL        VAR(&COPIES)  TYPE(*CHAR) LEN(6)
             DCL        VAR(&PNAVN)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&LOGO2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LPI2) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&LPP) TYPE(*DEC) LEN(3 0) VALUE(72)
             DCL        VAR(&LPS) TYPE(*DEC) LEN(3 0) VALUE(72)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&FAK) TYPE(*CHAR) LEN(7)
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) VALUE('0')
             DCL        VAR(&P1) TYPE(*CHAR) LEN(2) VALUE('00')
             DCL        VAR(&P2) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&P3) TYPE(*LGL) LEN(1) VALUE('0')
             DCL        VAR(&P4) TYPE(*LGL) LEN(1) VALUE('0')
             DCL        VAR(&P5) TYPE(*LGL) LEN(1) VALUE('0')
             DCL        VAR(&P6) TYPE(*LGL) LEN(1) VALUE('0')
             DCL        VAR(&P7) TYPE(*CHAR) LEN(1) VALUE('J')
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode +
                          til register SORT. */
             DCL        VAR(&TIME) TYPE(*CHAR) LEN(6)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10) +
                          VALUE('SYAM02PF')
             DCL        VAR(&FILENS) TYPE(*CHAR) LEN(10) +
                          VALUE('SYAM20P')
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&BANES) TYPE(*CHAR) LEN(50)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
    /* */
             DCL        VAR(&TURNR) TYPE(*DEC)  LEN(8 0)
             DCL        VAR(&AGENT) TYPE(*DEC)  LEN(8 0)
             DCL        VAR(&FRA)   TYPE(*CHAR) LEN(1) VALUE('P')
             DCL        VAR(&PROG)  TYPE(*CHAR) LEN(2) VALUE('02')
             DCL        VAR(&PPRT) TYPE(*CHAR) LEN(10) +
                          VALUE('          ') /*   PRINTER    */
             DCL        VAR(&PPRTP) TYPE(*CHAR) LEN(10) +
                          VALUE('          ') /*   PRINTER    */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&TIME)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &TIME)
    /* UTSKRIFT AV AMETASKJEMA */
    /* */
             OVRPRTF    FILE(SYAM02PF) DEVTYPE(*AFPDS) PAGESIZE(48 +
                          180) CPI(15) OVRFLW(46) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)
             OVRPRTF    FILE(SYAM02P2) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) CPI(15) OVRFLW(66) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD)
    /* */
             CALL       PGM(SYAM02) PARM(&TURNR &AGENT &FRA)
/*                                       */
/* LAGER PDF AV SELVE FAKTURAEN          */
/*                                       */
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE          */
/* UTEN INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILEN) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANES) ORIENTAT(*V)
             DLTSPLF    FILE(&FILEN) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
                          ENDDO
/*                                       */
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE           */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANES)
                          ENDDO
/*                                       */
/*                                       */
/* SORT OGSÅ I LØSNING 1 - INLIBL FOR Å SIKRE BIBLIOTEKSLISTE */
/*                                       */
             CALL INLIBL
             RMVM       FILE(SORT) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(SORT) MBR(&UNIK)
             OVRDBF     FILE(SORT) TOFILE(SORT) MBR(&UNIK)
    /* */
    /*                                    */
/*                                         */
/*           HENTER AVT AVVIKENDE LOGO     */
/*                                         */
             CALL       PGM(GETPRN) PARM(&AVD &FAKT &PNAVN &FORM +
                          &LASER &LPI2 &DRAWER &COPIES &LOGO2 &DRAWUT)
             IF         COND(&LOGO2 *NE '*NONE     ') THEN(DO)
             IF         COND(&LOGO2 *NE '          ') THEN(CHGVAR +
                          VAR(&LOGO) VALUE(&LOGO2))
             ENDDO

             OVRPRTF    FILE(SYAM20P) DEV(*JOB) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) CPI(10) +
                          FRONTMGN(0.2 0.1) OVRFLW(72) +
                          FRONTOVL(&LOGO) OUTQ(OUTMAIL) FORMTYPE(*STD)
             CHGDTAARA  DTAARA(*LDA (101 7)) VALUE(&FAK)
             CHGDTAARA  DTAARA(*LDA (108 7)) VALUE('0000000')
             CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
             CALL       PGM(SYAM21) PARM(&P1 &P2 &P3 &P4 &P5 &P6 &P7)
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE          */
/* UTEN INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILENS) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
             DLTSPLF    FILE(&FILENS) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
                          ENDDO
/*                                       */
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE           */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILENS &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
    /* */
 /*                           */
 SLUTT:      ENDPGM
