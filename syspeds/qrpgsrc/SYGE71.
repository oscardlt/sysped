     H DECEDIT(',') debug(*yes)
      ************************************************************************
      *  budsjett feil
      ************************************************************************
     FKODTGE    IF   E           K DISK
     FFAKT      IF   E           K DISK
     FHEADF     IF   E           K DISK
     FKOSBU12   IF   E           K DISK
     FTRAPRAV   IF   E           K DISK
     FDOKUF     IF   E           K DISK
     D                 DS
     D  TRVK01                 1      5  0
     D  TRVK02                 6     10  0
     D  TRVK03                11     15  0
     D  TRVK04                16     20  0
     D  TRVK05                21     25  0
     D  TRVK06                26     30  0
     D  TRVK07                31     35  0
     D  TRVK08                36     40  0
     D  TRVK09                41     45  0
     D  TRVK10                46     50  0
     D  TRVK11                51     55  0
     D  TRVK12                56     60  0
     D  FV                     1     60  0
     D                                     DIM(12) ASCEND                       VEKTGR. AVTALE
     D                 DS
     D  TRPA01                 1      3  1
     D  TRPA02                 4      6  1
     D  TRPA03                 7      9  1
     D  TRPA04                10     12  1
     D  TRPA05                13     15  1
     D  TRPA06                16     18  1
     D  TRPA07                19     21  1
     D  TRPA08                22     24  1
     D  TRPA09                25     27  1
     D  TRPA10                28     30  1
     D  TRPA11                31     33  1
     D  TRPA12                34     36  1
     D  FP                     1     36  1
     D                                     DIM(12)                              VEKTGR. AVTALE
      *
     c                   exsr      init
      *
     c*                  exsr      berbud
      *
     C     dftran        chain     traprav                            33
     c     *in33         ifeq      '0'
     c                   z-add     dfvkt         vekt5             5 0
     c                   z-add     1             xn                2 0
     C     vekt5         LOOKUP    FV(XN)                             76  76
     c     *in76         ifeq      '1'
     c                   z-add     FP(XN)        upros
     c                   z-sub     FP(XN)        uprosn            3 1
     c                   move      'N'           feil1
     c     kbdiff        ifgt      upros
     c                   move      'J'           feil1
     C                   end
     c     kbdiff        iflt      uprosn
     c                   move      'J'           feil1
     C                   end
     C                   end
     C                   END
     c                   seton                                        lr
     c                   return
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *entry        plist
     C                   parm                    kbavd             4 0
     C                   parm                    kbopd             7 0
     C                   parm                    kbvk              3
     c                   parm                    kbblhb           13 2
     c                   parm                    kbbuds           13 2
     c                   parm                    kbblf            13 2
     c                   parm                    upros             3 1
     c                   parm                    kbdiff            5 2
     C                   parm                    feil1             1
     C     DOKUFK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    KBAVD
     C                   KFLD                    KBOPD
     C                   KFLD                    DFFBNR
     c                   z-add     1             dffbnr
     c                   move      'F'           DFRI
     C     headfk        KLIST
     C                   KFLD                    KBAVD
     C                   KFLD                    KBOPD
     C*    dokufk        KLIST
     c*                  KFLD                    dokuko            1
     C*                  KFLD                    KBAVD
     C*                  KFLD                    KBOPD
     c*                  move      'F'           dokuko
     C     kodtgek       KLIST
     C                   KFLD                    KODEGE            2
     C                   KFLD                    KBVK
     C                   move      'GE'          KODEGE
      *
      * hent utfakturert
      *
      *
     c                   exsr      srfakt
     c     KBBUDS        ifne      0
     C     KBBLHB        DIV(h)    KBBUDS        work             12 2
     C                   mult      100           work             12 2
     C                   sub       100           work
     C                   z-add     work          KBDIFF            5 2
     c                   else
     c                   z-add     100           KBDIFF
     c                   end
     C     DOKUFK        CHAIN     DOKUF                              33
     C*    HEADFK        CHAIN     HEADF                              33
     C                   ENDSR
      *******************************************************************
     C     SRFAKT        BEGSR
      *******************************************************************
     C     kodtgek       chain     kodtge                             33
     C                   MOVE      *ZEROS        fasum
     C     HEADFK        SETLL     FAKT
     C     HEADFK        READE     FAKT                                   33
     C                   DOW       *IN33 = *OFF
     C                   IF        (((FAKDA <> 'K') AND
     C                               (FAKDA <> 'D')))
     C     FAVK          IFEQ      'FRA'
     C     FAVK          OREQ      'TGF'
     C     FAVK          OREQ      'TGI'
     C     FAVK          OREQ      'FR1'
     C     FAVK          OREQ      'FR2'
     C                   ADD       FABELN        FASUM            11 2
     C                   END
     C                   END
     C     HEADFK        READE     FAKT                                   33
     C                   ENDDO
      *
     c                   add       fasum         kbblf
     C                   ENDSR
      ***********************************************
     C*    BERBUD        BEGSR
      ***********************************************
     C*                  MOVE      'N'           UOVERS
     C*                  MOVE      DFPNLS        U2PNF             4
     C*                  MOVE      DFPOUL        U2PNT             4
     C*                  MOVE      HENT          U2NT              7
     C*                  MOVE      HEVKT         U2VKT             9
     C*                  MOVE      HEM3          U2DM3             7
     C*                  MOVE      DFTRAN        U2KNT             8
     C*                  MOVE      *ZEROS        U2RAB             3
     C*                  MOVE      '2'           U2FLAGG           1
     C*                  MOVE      KBAVD         U2AVD             4
     C*                  MOVE      KBOPD         U2OPD             7
     C*    HEKNKF        IFNE      *ZEROS
     C*                  MOVE      HEKNKF        U2KN              8
     C*                  ELSE
     C*                  MOVE      HEKNK         U2KN
     C*                  END
     C*                  MOVE      DFKNS         U2KNS            12
     C*                  MOVE      DFTRAN        U2TRAN            8
     C*                  MOVE      DFPROK        U2PROK            5
     C*                  CALL      'SYFB05C'
     C*                  PARM                    U2PNF
     C*                  PARM                    U2PNT
     C*                  PARM                    U2NT
     C*                  PARM                    U2VKT
     C*                  PARM                    U2DM3
     C*                  PARM                    U2KNT
     C*                  PARM                    U2BRTBL           9
     C*                  PARM                    U2NETBL           9
     C*                  PARM                    U2RAB
     C*                  PARM                    U2FLAGG
     C*                  PARM                    U2AVD
     C*                  PARM                    U2OPD
     C*                  PARM                    U2KN
     C*                  PARM                    U2KNS
     C*                  PARM                    U2TRAN
     C*                  PARM                    U2PROK
     C*                  IF        U2FLAGG = '0'
     C*                  MOVE      U2NETBL       U2NETBL2          9 0
     C*                  Z-ADD     U2NETBL2      WSBUDB
     C*                  move      ficurr        WSBUDV
     C*                  END
     C*                  ENDSR
     C*
