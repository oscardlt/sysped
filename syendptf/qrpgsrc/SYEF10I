********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 SH  PTF12 gå til faste koder isteden
********************************************************************
     FDOKOCI    UF A E           K DISK
     FSYEF10FI  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
      *
     D FBAREA          DS
     D  WSCLOC               382    383B 0
      *
     D                 DS
     D  A01                    1     18    DIM(9)
     D  A01A                   1      2
     D  A01B                   3      4
     D  A01C                   5      6
     D  A01D                   7      8
     D  A01E                   9     10
     D  A01F                  11     12
     D  A01G                  13     14
     D  A01H                  15     16
     D  A01I                  17     18
     D                 DS
     D  A02                    1     27    DIM(9)
     D  A02A                   1      3
     D  A02B                   4      6
     D  A02C                   7      9
     D  A02D                  10     12
     D  A02E                  13     15
     D  A02F                  16     18
     D  A02G                  19     21
     D  A02H                  22     24
     D  A02I                  25     27
     D                 DS
     D  A03                    1     18    DIM(9)
     D  A03A                   1      2
     D  A03B                   3      4
     D  A03C                   5      6
     D  A03D                   7      8
     D  A03E                   9     10
     D  A03F                  11     12
     D  A03G                  13     14
     D  A03H                  15     16
     D  A03I                  17     18
     D                 DS
     D  A04                    1    315    DIM(9)
     D  A04A                   1     35
     D  A04B                  36     70
     D  A04C                  71    105
     D  A04D                 106    140
     D  A04E                 141    175
     D  A04F                 176    210
     D  A04G                 211    245
     D  A04H                 246    280
     D  A04I                 281    315
      *
     C     OCIKEY        KLIST
     C                   KFLD                    WAVD
     C                   KFLD                    WOPD
     c                   KFLD                    WLOP
      *
     C     *ENTRY        PLIST
     C                   PARM                    PAVD
     C                   PARM                    POPD
     C                   PARM                    PLOP
     C                   PARM                    PFLAG             1 0
      *
     C     *LIKE         DEFINE    DOKOCIAVD     PAVD
     C     *LIKE         DEFINE    DOKOCIOPD     POPD
     C     *LIKE         DEFINE    DOKOCILOP     PLOP
     C     *LIKE         DEFINE    DOKOCIAVD     WAVD
     C     *LIKE         DEFINE    DOKOCIOPD     WOPD
     C     *LIKE         DEFINE    DOKOCILOP     WLOP
     C                   Z-ADD     1             X                 3 0
     C                   Z-ADD     0             WX                3 0
     C     PFLAG         IFEQ      1
     C                   MOVE      *ON           *IN88
     C                   ENDIF
      *
     C                   Z-ADD     PAVD          WAVD
     C                   Z-ADD     POPD          WOPD
     C                   Z-ADD     PLOP          WLOP
      * Sjekker først om det finnes noen verdier å vise
     C     OCIKEY        SETLL     DOKOCI
     C     OCIKEY        READE(N)  DOKOCI                                 90
     C     *IN90         DOWEQ     *OFF
     C                   MOVEA     DOKOCI293     A01(X)
     C                   MOVEA     DOKOCI295     A02(X)
     C                   MOVEA     DOKOCI297     A03(X)
     C                   MOVEA     DOKOCI299     A04(X)
     C                   ADD       1             X
     C     X             IFGT      9
     C                   LEAVE
     C                   ENDIF
     C     OCIKEY        READE(N)  DOKOCI                                 90
     C                   ENDDO
      * Viser bilde
     C     TAG01         TAG
     C                   EXFMT     BILDE1
      * F4=Søk kode
     C     *IN04         IFEQ      *ON
     C     WSCLOC        DIV       256           LINNBR            3 0
N01  C                   MVR                     POSNBR            3 0
N01  c     posnbr        ifge      2
N01  c     posnbr        andle     3
N01  C                   MOVE      'J'           USPED             1
N01  c                   move      '  '          wpland
N01  C                   CALL      'SYFI10L'
N01  C                   PARM                    WPLAND            2
N01  C                   PARM                    USPED
N01  c     wpland        ifne      '  '
N01  C                   MOVEL     wpland        A01(X)
N01  c                   z-add     9             posnbr
N01  c                   end
N01  c                   goto      tag01
N01  c                   else
N01  c     posnbr        ifge      9
N01  c     posnbr        andle     11
     C                   MOVEL     'AIROCI'      XTYPE
N01  c                   else
N01  c     posnbr        ifge      16
N01  c     posnbr        andle     17
N01  C                   MOVEL     'AIROCC'      XTYPE
N01  c                   else
N01  c                   goto      tag01
N01  c                   end
N01  c                   end
N01  c                   end
s01  C*                  CALL      'SYKUKD'
n01  c                   move      *blanks       xkode
n01  C                   CALL      'SYFAKDA'
     C                   PARM                    XTYPE            10
     C                   PARM      ' '           XUPDAT            1
     C                   PARM                    XKODE             5
     C     LINNBR        IFGT      3
     C     LINNBR        ANDLT     20
     C     LINNBR        SUB       3             X
     C     XKODE         IFNE      *BLANKS
N01  c     posnbr        iflt      16
     C                   MOVEL     XKODE         A02(X)
N01  c                   z-add     16            posnbr
N01  c                   else
N01  c                   z-add     28            posnbr
N01  C                   MOVEL     XKODE         A03(X)
N01  c                   end
     C                   ENDIF
     C                   GOTO      TAG01
     C                   ENDIF
     C                   ENDIF
     C     *IN12         CABEQ     *ON           SLUTT
     C     *IN88         CABEQ     *ON           SLUTT
      * Enter medfører oppdatering, først sletting og deretter WRITE
     C     OCIKEY        SETLL     DOKOCI
     C     OCIKEY        READE     DOKOCI                                 90
     C     *IN90         DOWEQ     *OFF
     C                   DELETE    DOKOCIR
     C     OCIKEY        READE     DOKOCI                                 90
     C                   ENDDO
      * Skriver så alle poster til fil.
      * Skriver også blanke linjer, men ikke når det er bare blanke
     C                   Z-ADD     1             X
     C                   Z-ADD     0             WX
     C                   DO        9
     C     A01(X)        IFNE      *BLANKS
     C                   Z-ADD     X             WX
     C                   ENDIF
     C                   ADD       1             X
     C                   ENDDO
     C                   Z-ADD     1             X
     C     WX            IFGT      0
     C                   DO        9
     C                   Z-ADD     WAVD          DOKOCIAVD
     C                   Z-ADD     WOPD          DOKOCIOPD
     C                   Z-ADD     WLOP          DOKOCILOP
     C                   MOVEA     A01(X)        DOKOCI293
     C                   MOVEA     A02(X)        DOKOCI295
     C                   MOVEL     A03(X)        DOKOCI297
     C                   MOVEA     A04(X)        DOKOCI299
     C     A01(X)        IFNE      *BLANKS
     C                   WRITE     DOKOCIR
     C                   ENDIF
     C     X             IFGE      WX
     C                   LEAVE
     C                   ENDIF
     C                   ADD       1             X
     C                   ENDDO
     C                   ENDIF
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
