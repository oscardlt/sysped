********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 OPSJON 51 --> SE ARKIVERTE DOKUMENTER
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED BILL OF LADING                ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      **************************************************************
      *
     FHEADF     UF   E           K DISK
     FBOOKING   IF   E           K DISK
     FBILLOF    IF   E           K DISK
     FBILLOFL1  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF1R)
     FBILLOFL2  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF2R)
     FBILLOFL3  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF3R)
     FBILLOFL4  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF4R)
     FBILLOFL5  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF5R)
     FBILLOFL6  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF6R)
     FBILLOFL7  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF7R)
     FBILLOFLD  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOFDR)
     FBILLOFLE  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOFER)
     FBILLOFLF  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOFFR)
     FBLJOINLF  IF   E           K DISK
     F                                     RENAME(BILLOFR:BLJLFR)
     F                                     RENAME(BLV1R:BLJLFRV1)
     F                                     RENAME(BLV2R:BLJLFRV2)
     FBLV1      IF   E           K DISK
     FBLV2      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FTRAN      IF   E           K DISK
     FSYSJ80D   CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  BLMN                   1     17
     D  BVMN                   1     17
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTÅ                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  XÅR4                   1      4  0
     D  BLACC                  1      2  0
     D  BLAAR                  3      4  0
     D                 DS
     D  BLDTAÅ                 1      4  0
     D  BLDTAM                 5      6  0
     D  BLDTAD                 7      8  0
     D  BLDTA                  1      8  0
     D                 DS
     D  XDTAD                  1      2  0
     D  XDTAM                  3      4  0
     D  XDTAÅ                  5      6  0
     D  XDTA                   1      6  0
     D                 DS
     D  BLAVD                  1      4  0
     D  BVAVD                  1      4  0
     D                 DS
     D  BLOPD                  1      7  0
     D  BVOPD                  1      7  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UUSER                301    310
      *
     C                   EXSR      INIT
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
     C                   MOVE      999999        WSDT
     C                   Z-ADD     9             WSTYPE
     C     USTAC1        CABEQ     'BL'          BG2
      *
     C     BG1           TAG
     C  N30
     CANN04WSAVD         IFEQ      0
     C                   Z-ADD     3             LINNBR
     C                   ELSE
     C                   Z-ADD     7             LINNBR
     C                   END
     C  N30
     CANN04              Z-ADD     28            POSNBR
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C   03              GOTO      SLUTT
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000'       *IN(78)
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      BG1
     C                   END
      *
     C     BG2           TAG
     C                   EXSR      TESTB
     C   30              GOTO      BG1
      *
     C                   EXSR      OPSJON
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C                   EXSR      LESREC
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        7
     C                   ADD       1             ZRECNO
     C                   EXSR      HHEADF
     C                   WRITE     SUBFIL
     C                   EXSR      LESREC
     C  N94              END
     C                   END
     C*
     C                   MOVE      ZRECNO        XRECNO            4 0
     C     START3        TAG
     C  N30              Z-ADD     6             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
     C                   SETOFF                                       9830
      *** AVSLUTT
     C   03              GOTO      SLUTT
      *
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      START3
     C                   END
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTBL
     C                   GOTO      START3
     C                   END
     C   08              GOTO      BG1
     C   12              GOTO      BG1
     C   13
     COR 15              DO
     C                   EXSR      BYTTMD
     C                   GOTO      START3
     C                   END
     C   20              DO
     C                   CALL      'SYSJ70R'
     C                   GOTO      START3
     C                   ENDDO
     C   23              DO
     C                   EXSR      OPSJON
     C                   GOTO      START3
     C                   END
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     WSAVDA        IFNE      UAVD
     C     WSSGA         ORNE      USG
     C                   EXSR      TESTB0
     C   30              GOTO      START3
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2OPD         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2UKE         ORNE      0
     C     W2LB          ORNE      *BLANKS
     C     W2OB          ORNE      *BLANKS
     C     W2BLNR        ORNE      *BLANKS
     C     W2REIS        ORNE      *BLANKS
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C     *IN30         IFEQ      '1'                                            3Z-B
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   ELSE                                                     3
     C                   GOTO      START
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     W2NR          COMP      1                                      06
     C   06              DO                                                       3<-B
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAVDA
     C                   MOVE      W2AVD         WSAVD
     C                   MOVE      W2AVD         UAVD
     C                   END                                                       4<-E
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2OPD         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0039'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYOPT
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2UKE
     C                   MOVE      *ZEROS        W2DT
     C                   MOVE      *BLANKS       W2LB
     C                   MOVE      *BLANKS       W2OB
     C                   MOVE      *BLANKS       W2REIS
     C                   MOVE      *BLANKS       W2BLNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C     W2AVD         IFNE      0                                             2<-B
     C                   MOVE      W2AVD         WSAVD
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      BHENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SELECT
     C     USTAC3        WHENEQ    'BL'
     C                   MOVE      USTAC2        UTILMD
     C                   MOVE      *BLANKS       USTAC3
     C     USTAC2        WHENEQ    'BL'
     C                   MOVE      USTAC1        UTILMD
     C                   MOVE      *BLANKS       USTAC2
     C                   ENDSL
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     BYTTMD        BEGSR
      ***********************************************
     C     STBMD         TAG
      * TIL OPPDRAG
     C   13              DO                                                     1<-B
     C                   MOVE      'OP'          UTILMD
     C                   SELECT                                                  2<-B
     C     USTAC1        WHENEQ    'OP'
     C                   MOVE      *BLANKS       USTAC3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'OP'
     C                   MOVE      *BLANKS       USTAC3
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'BL'
     C                   MOVE      'OP'          USTAC3
     C                   CALL      'SYOP01R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'BL'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C                   END                                                      3<-E
     C                   OTHER
     C                   MOVE      'OP'          USTAC2
     C                   CALL      'SYOP01R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'BL'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      '0'           *IN13
     C                   MOVE      '1'           *IN15
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      * TIL BOOKING
     C   15              DO                                                     1<-B
     C                   MOVE      'BK'          UTILMD
     C                   SELECT                                                  2<-B
     C     USTAC1        WHENEQ    'BK'
     C                   MOVE      *BLANKS       USTAC3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'BK'
     C                   MOVE      *BLANKS       USTAC3
     C                   SETON                                        LR
     C                   RETURN
     C     USTAC2        WHENEQ    'BL'
     C                   MOVE      'BK'          USTAC3
     C                   CALL      'SYSJ81R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'BL'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      *BLANKS       USTAC2
     C                   SETON                                        LR
     C                   RETURN
     C                   END                                                      3<-E
     C                   OTHER
     C                   MOVE      'BK'          USTAC2
     C                   CALL      'SYSJ81R'
     C                   PARM                    UUR
     C                   PARM                    USTAC1
     C                   PARM                    USTAC2
     C                   PARM                    USTAC3
     C                   PARM                    UTILMD
     C     UTILMD        IFEQ      'BL'                                           3<-B
     C                   GOTO      SLBMD
     C                   ELSE                                                     3
     C                   MOVE      '1'           *IN13
     C                   MOVE      '0'           *IN15
     C                   GOTO      STBMD
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
     C     SLBMD         ENDSR
      *
      ***********************************************
     C     TESTB0        BEGSR
      ***********************************************
     C     KODAKA        CHAIN     KODTA                              96
     C     *IN96         IFEQ      '1'
     C                   MOVE      'SPA0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   END
     C     KODSKA        CHAIN     KODTSF                             95
     C     *IN95         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   MOVE      'SPS0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   END
      *
     C     *IN30         IFEQ      '0'
     C                   MOVE      WSAVDA        UAVD
     C                   MOVE      WSSGA         USG
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB         BEGSR
      ***********************************************
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00'          *IN(49)
      *
     C     WSAVD         IFNE      0
     C     KODTAK        CHAIN     KODTA                              90
     C   90              MOVE      'SPA0001'     MSGNR
     C   90              SETON                                        30
     C                   END
      *
     C     WSDT          IFNE      0
     C     WSDT          IFEQ      999999
     C     WSTYPE        ANDEQ     9
     C                   GOTO      STTB1
     C                   END
     C                   MOVE      WSDTÅ         UÅÅ               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C   89
     CANN30              MOVE      'SPD0001'     MSGNR
     C   89              SETON                                        30
     C                   END
     C*
     C     WSTYPE        COMP      0                                      88
     C  N88WSTYPE        COMP      10                                 88
     C   88
     CANN30              MOVE      'SPN0104'     MSGNR
     C   88              SETON                                        30
     C*
     C     WSTYPE        IFEQ      1
     C     WSBLNR        COMP      *BLANKS                                87
     C   87
     CANN30              MOVE      'SPB0105'     MSGNR
     C   87              SETON                                        30
     C                   END
     C*
     C     WSTYPE        IFEQ      2
     C     WSREIS        COMP      *BLANKS                                86
     C   86
     CANN30              MOVE      'SPR0101'     MSGNR
     C   86              SETON                                        30
     C                   END
     C*
     C     WSTYPE        IFEQ      3
     C     WSOB          CHAIN     CDBOAT                             85
     C   85
     CANN30              MOVE      'SPB0106'     MSGNR
     C   85              SETON                                        30
     C  N85              MOVE      CBNAB         XCBNAB
     C                   END
     C*
     C     WSTYPE        IFEQ      4
     C     WSLB          CHAIN     CDBOAT                             84
     C   84
     CANN30              MOVE      'SPB0102'     MSGNR
     C   84              SETON                                        30
     C  N84              MOVE      CBNAB         XCBNAB
     C                   END
     C*
     C     WSTYPE        IFEQ      5
     C     KUNDRK        CHAIN     CUNDL01                            83
     C   83
     CANN30              MOVE      'SPK0121'     MSGNR
     C   83              SETON                                        30
     C  N83              MOVE      KNAVN         XKNAVN
     C                   END
     C*
     C     WSUKE         COMP      53                                 82
     C   82
     CANN30              MOVE      'SPU0101'     MSGNR
     C   82              SETON                                        30
     C*
     C     WSUKET        IFEQ      0
     C                   MOVE      WSUKE         WSUKET
     C                   ELSE
     C     WSUKET        COMP      53                                 81
     C   81
     CANN30              MOVE      'SPU0101'     MSGNR
     C   81              SETON                                        30
     C                   END
     C*
     C  N82WSTYPE        IFEQ      6
     C     WSUKE         COMP      0                                      82
     C   82
     CANN30              MOVE      'SPU0101'     MSGNR
     C   82              SETON                                        30
     C  N82WSÅR          IFGT      50
     C     WSÅR          ADD       1900          WSÅR4             4 0
     C                   ELSE
     C     WSÅR          ADD       2000          WSÅR4
     C                   END
     C                   END
     C*
     C     WSTYPE        IFEQ      7
     C     WSAVD         IFEQ      0
     C     WSTR          COMP      *BLANKS                                80
     C                   ELSE
     C     BILL7K        SETLL     BILLOFL7
     C     WSAVD         READE     BILLOFL7                               80
     C  N80WSTR          COMP      BLTR                               8080
     C                   END
     C   80
     CANN30              MOVE      'SPT0102'     MSGNR
     C   80              SETON                                        30
     C                   END
     C*
     C     WSTYPE        IFEQ      8
     C     WSOPD         COMP      0                                      79
     C   79
     CANN30              MOVE      'SPO0016'     MSGNR
     C   79              SETON                                        30
     C                   END
     C*
     C     STTB1         TAG
     C     WSTYPE        IFEQ      9
     C     KODSFK        CHAIN     KODTSF                             78
     C   78
     CANN30              MOVE      'SPS0001'     MSGNR
     C   78              SETON                                        30
     C                   END
     C*
     C     *IN30         IFEQ      '0'
     C     WSTYPE        ADD       40            XN                3 0
     C                   MOVE      '1'           *IN(XN)
     C                   MOVE      *ZEROS        YAVD
     C                   ELSE
     C   78
     COR 79
     COR 80              Z-ADD     28            POSNBR
     C   81              Z-ADD     59            POSNBR
     C   82              Z-ADD     42            POSNBR
     C   83
     COR 84
     COR 85
     COR 86
     COR 87
     COR 88
     COR 89
     COR 90              Z-ADD     28            POSNBR
     C   78              Z-ADD     18            LINNBR
     C   79              Z-ADD     17            LINNBR
     C   80              Z-ADD     16            LINNBR
     C   81
     COR 82              Z-ADD     15            LINNBR
     C   83              Z-ADD     14            LINNBR
     C   84              Z-ADD     13            LINNBR
     C   85              Z-ADD     12            LINNBR
     C   86              Z-ADD     11            LINNBR
     C   87              Z-ADD     10            LINNBR
     C   88              Z-ADD     8             LINNBR
     C   89              Z-ADD     7             LINNBR
     C   90              Z-ADD     3             LINNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYSØK         BEGSR
      ***********************************************
     C                   MOVE      WSAVD         XAVD3             4 0
     C                   CLEAR                   BILDE
     C                   MOVE      XAVD3         WSAVD
     C                   MOVE      UYEAR         WSÅR
     C     W2AVD         IFEQ      0
     C     WSAVD         IFEQ      0
     C                   MOVE      UAVD          WSAVD
     C                   END
     C                   ELSE
     C                   MOVE      W2AVD         WSAVD
     C                   END
      *
     C                   SELECT                                                 1<-B
     C                   WHEN      W2OPD <> 0
     C                   MOVE      W2OPD         WSOPD
     C                   MOVE      8             WSTYPE
     C                   WHEN      W2SG <> *BLANKS
     C                   MOVE      W2SG          WSSG
     C                   MOVE      9             WSTYPE
     C                   WHEN      W2UKE <> 0
     C                   MOVE      W2UKE         WSUKE
     C                   MOVE      6             WSTYPE
     C                   WHEN      W2LB <> *BLANKS
     C                   MOVE      W2LB          WSLB
     C                   MOVE      4             WSTYPE
     C                   WHEN      W2OB <> *BLANKS
     C                   MOVE      W2OB          WSOB
     C                   MOVE      3             WSTYPE
     C                   WHEN      W2BLNR <> *BLANKS
     C                   MOVE      W2BLNR        WSBLNR
     C                   MOVE      1             WSTYPE
     C                   WHEN      W2REIS <> *BLANKS
     C                   MOVE      W2REIS        WSREIS
     C                   MOVE      2             WSTYPE
     C                   ENDSL                                                  1<-E
      *
     C                   MOVE      W2DT          WSDT
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2UKE
     C                   MOVE      *ZEROS        W2DT
     C                   MOVE      *BLANKS       W2LB
     C                   MOVE      *BLANKS       W2OB
     C                   MOVE      *BLANKS       W2BLNR
     C                   MOVE      *BLANKS       W2REIS
      *
     C                   EXSR      TESTB
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYOPT         BEGSR
      ***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      WSAVD         W2AVD
     C                   END
     C     WRK2K         CHAIN     BILLOF                             98
     C  N98W2NR          IFEQ      11
     C     WRK2K         CHAIN     BOOKING                            98
     C                   END
     C   98              DO
     C                   MOVE      'SPO0002'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    2
     C     BLST          IFNE      ' '
     C     BLST          ANDNE     'P'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'SPO0006'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   EXSR      CHGBL
     C     W2NR          WHENEQ    3
     C                   EXSR      CPYBL
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPBL
     C     W2NR          WHENEQ    7
     C                   EXSR      WRKFV
     C     W2NR          WHENEQ    8
     C                   EXSR      WRKFT
     C     W2NR          WHENEQ    11
     C     USG           IFNE      BOSG
     C                   MOVE      '1'           *IN98
     C                   MOVE      'SPS0014'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C     BOST          IFNE      ' '
     C     BOST          ANDNE     'P'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'SPO0006'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   EXSR      CHGBK
     C     W2NR          WHENEQ    12
     C     WRK2K         CHAIN(N)  HEADF                              98
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'C'
     C     HEST          ANDNE     'U'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'K'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   EXSR      CHGOPD
     C     W2NR          WHENEQ    13
     C     WRK2K         CHAIN(N)  HEADF                              98
     C     HEST          IFEQ      'S'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   EXSR      CHGFAK
     C     W2NR          WHENEQ    14
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'C'
     C     HEST          ANDNE     'U'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'K'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   EXSR      CHGFBR
     C     W2NR          WHENEQ    21
     C                   EXSR      DSPBK
     C     W2NR          WHENEQ    22
     C                   EXSR      DSPOPD
     C     W2NR          WHENEQ    23
     C                   EXSR      DSPFAK
     C     W2NR          WHENEQ    24
     C                   EXSR      DSPFBR
N01  C     W2NR          WHENEQ    51
N01  C                   EXSR      ARKIVS
     C                   OTHER
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDSL
      *
     C     SLOPT         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2OPD
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     35
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     29
     C                   CALL      'SYSJ17A'
     C                   PARM                    WSKNR
     C                   PARM                    WSTR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSLB
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSOB
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     1             UFLAGG
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     19
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSLB
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     27
     C     POSNBR        ANDLE     31
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSOB
     C                   GOTO      SLSØK2
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK2        ENDSR
      *
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNR
     C                   PARM                    UFIRM
     C                   PARM                    USØKNV           30
     C*
     C                   ENDSR
     C*
      ***********************************************
     C     CRTBL         BEGSR
      ***********************************************
     C                   MOVE      WSAVDA        UAVD2             4 0
     C                   MOVE      *ZEROS        UOPD2             7 0
     C                   MOVE      WSSGA         USG2              3
     C                   MOVE      *ZEROS        UAVD3             4 0
     C                   MOVE      *ZEROS        UOPD3             7 0
     C                   MOVE      'J'           XLAGNY            1
     C     UUR           IFEQ      'F'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     2             UFLAGG
     C                   END
      *
     C                   EXSR      WRKBL
     C                   EXSR      VISBL
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISBL         BEGSR
      ***********************************************
     C     UAVD2         IFNE      0                                            1<-B
     C     UOPD2         ANDNE     0
     C     BLKNY         CHAIN     BILLOF                             33
     C  N33              DO                                                      2<-B
     C                   EXSR      HHEADF
     C     XLAGNY        IFEQ      'J'                                            3<-B
     C                   ADD       1             XRECNO
     C                   MOVE      XRECNO        ZRECNO
     C                   WRITE     SUBFIL
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     HHEADF        BEGSR
      ***********************************************
     C     HEADFK        CHAIN(N)  HEADF                              33
     C   33              MOVE      *ZEROS        HENT
     C   33              MOVE      *ZEROS        HEVKT
     C                   MOVE      BLKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     KNAVN         XNAR
     C                   ELSE
     C                   MOVE      *BLANKS       XNAR
     C                   MOVEL     BLKNR         XNAR
     C                   END
      *
     C     *IN50         IFEQ      '0'
     C     BLMN          ANDEQ     *BLANKS
     C     HEADFK        SETLL     BLV1
     C     HEADFK        READE     BLV1                                   33
     C     *IN33         DOWEQ     '0'
     C     BVMN          IFNE      *BLANKS
     C                   LEAVE
     C                   END
     C     HEADFK        READE     BLV1                                   33
     C  N33              ENDDO
     C     BVMN          IFNE      *BLANKS
     C     HEADFK        SETLL     BLV2
     C     HEADFK        READE     BLV2                                   33
     C     *IN33         DOWEQ     '0'
     C     BVMN          IFNE      *BLANKS
     C                   LEAVE
     C                   END
     C     HEADFK        READE     BLV2                                   33
     C  N33              ENDDO
     C                   END
     C                   END
      *
     C                   EXSR      KDTFMT
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGBL         BEGSR
      ***********************************************
     C                   MOVE      BLAVD         UAVD2
     C                   MOVE      BLOPD         UOPD2
     C                   MOVE      USG           USG2
     C                   MOVE      *ZEROS        UAVD3
     C                   MOVE      *ZEROS        UOPD3
     C     BLUR          IFEQ      'F'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     2             UFLAGG
     C                   END
     c     heur          ifeq      'H'
     C     BLUR          IFEQ      'F'
     C                   Z-ADD     8             UFLAGG
     C                   ELSE
     C                   Z-ADD     9             UFLAGG
     C                   END
     c                   end
      *
     C                   EXSR      WRKBL
      *
     C     *IN90         IFEQ      '0'
     C                   MOVE      'N'           XLAGNY
     C                   EXSR      VISBL
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     CPYBL         BEGSR
      ***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C                   MOVE      WSAVDA        UAVD2
     C                   MOVE      *ZEROS        UOPD2
     C                   MOVE      USG           USG2
     C                   MOVE      BLAVD         UAVD3
     C                   MOVE      BLOPD         UOPD3
     C                   MOVE      'J'           XLAGNY
     C     UUR           IFEQ      'F'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     2             UFLAGG
     C                   END
      *
     C                   EXSR      WRKBL
      *
     C  N90              EXSR      VISBL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPBL         BEGSR
     C***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C                   Z-ADD     1             UFLAGG            1 0
     C                   CALL      'SYSJ52I'
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    BLSG
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      3                                      03
     C*
     C                   ENDSR
     C*
      ***********************************************
     C     WRKFV         BEGSR
      ***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C                   MOVE      *ZEROS        OTIKU1            8 0
     C                   MOVE      *ZEROS        OTIKU2            8 0
     C                   CALL      'SYFA64'
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKFT         BEGSR
      ***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    UFLAGG
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKBL         BEGSR
      ***********************************************
     C                   CALL      'SYSJ50I'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UKUNB
     C                   PARM                    UAVD3
     C                   PARM                    UOPD3
     C                   PARM                    UFLAGG
     C                   PARM      0             ULUNIK            9 0
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGBK         BEGSR
      ***********************************************
     C                   MOVE      BOAVD         UAVD2
     C                   MOVE      BOOPD         UOPD2
     C                   MOVE      USG           USG2
     C                   MOVE      *ZEROS        UAVD3
     C                   MOVE      *ZEROS        UOPD3
      *
     C                   EXSR      WRKBO
      *
     C     *IN90         IFEQ      '0'
     C     HEADFK        CHAIN     BILLOF                             33
     C                   MOVE      'N'           XLAGNY
     C                   EXSR      VISBL
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKBO         BEGSR
      ***********************************************
     C                   CALL      'SYSJ50'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UAVD3
     C                   PARM                    UOPD3
     C                   PARM                    UFLAGG
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGOPD        BEGSR
      ***********************************************
     C                   MOVE      'CHG'         UTYPE             3
     C                   MOVE      BLAVD         UAVD2
     C                   MOVE      BLOPD         UOPD2
     C                   MOVE      HESG          USG2
      *
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      HEST          XST               1
     C     HEST          IFNE      'C'
     C     HEST          ANDNE     'U'
     C                   MOVE      ' '           HEST
     C                   END
     C                   EXCEPT    NYOPDS
      *
     C                   EXSR      WRKOPD
     C     *IN90         IFEQ      '0'
     C                   EXSR      VISBL
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C     HEADFK        CHAIN     HEADF                              33
     C     XST           IFEQ      'U'                                          1<-B
     C     HEOT          ANDNE     *BLANKS
     C                   MOVE      ' '           HEST
     C                   ELSE                                                   1
     C                   MOVE      XST           HEST
     C                   END                                                    1<-E
     C                   EXCEPT    NYOPDS
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKOPD        BEGSR
      ***********************************************
     C                   MOVE      ' '           UKODE             1
     C                   MOVE      ' '           UDUMMY            1
     C                   MOVE      *ZEROS        UAVDNY            4 0
      *
      * SJØ IMPORT
     C     BLUR          IFEQ      'F'
     C                   CALL      'SYSJ10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      *
     C                   ELSE
      * SJØ EXPORT
     C                   CALL      'SYSE10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGFAK        BEGSR
      ***********************************************
     C                   MOVE      'CHF'         UTYPE             3
     C                   MOVE      BLAVD         UAVD2
     C                   MOVE      BLOPD         UOPD2
     C                   MOVE      HESG          USG2
      *
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      HEST          XST               1
     C                   MOVE      ' '           HEST
     C                   EXCEPT    NYOPDS
      *
     C                   EXSR      WRKOPD
     C     *IN90         IFEQ      '0'
     C                   EXSR      VISBL
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      XST           HEST
     C                   EXCEPT    NYOPDS
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGFBR        BEGSR
      ***********************************************
     C                   MOVE      BLAVD         UAVD2
     C                   MOVE      BLOPD         UOPD2
     C                   MOVE      HESG          USG2
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      'J'           HEPK1
     C                   EXCEPT    NYOPDP
     C                   EXSR      WRKFBR
      *
     C     *IN90         IFEQ      '0'
     C                   EXSR      VISBL
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     WRKFBR        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   MOVE      001           XFBNR             3 0
     C                   MOVE      *BLANKS       XKDME             1
     C                   MOVE      *BLANKS       XKDE              1
     C                   MOVE      *ZEROS        XTOLL             2 0
     C                   MOVE      *BLANKS       XMSG             62
     C                   MOVE      '2'           TEST              1
     C     KOD2AK        CHAIN     KODTA                              33
     C     HEKNT         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       VMNAVN
     C                   ELSE                                                   1
     C     TRANK         CHAIN     TRAN                               33
     C   33              MOVE      *BLANKS       VMNAVN
     C                   END
     C                   CALL      'SYFI10A'
     C                   PARM                    FIFIRM
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    XFBNR
     C                   PARM                    KOAKNR
     C                   PARM                    VMNAVN
     C                   PARM                    XKDME
     C                   PARM                    XKDE
     C                   PARM                    XTOLL
     C                   PARM                    FILFB
     C                   PARM                    FILTB
     C                   PARM                    XMSG
     C                   PARM                    UFLAGG
     C                   PARM                    TEST
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPBK         BEGSR
     C***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C     BLUR          IFEQ      'G'
     C                   Z-ADD     1             UFLAGG            1 0
     C                   CALL      'SYSJ52B'
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    UFLAGG            1 0
     C                   END
     C*
     C                   ENDSR
     C*
      ***********************************************
     C     DSPOPD        BEGSR
      ***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   CALL      'SYFM21A'
     C                   PARM                    UFIRM
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      0
     C                   CALL      'SYFM21B'
     C                   PARM                    UFIRM
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    UFLAGG
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     DSPFAK        BEGSR
      ***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C                   CALL      'SYFM21B'
     C                   PARM                    UFIRM
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    UFLAGG
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPFBR        BEGSR
     C***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      *ZEROS        WSNR
     C                   UPDATE    SUBFIL
     C                   END
     C                   CALL      'SYFM21C'
     C                   PARM                    UFIRM
     C                   PARM      BLAVD         UAVD2
     C                   PARM      BLOPD         UOPD2
     C                   PARM                    UFBNR             3 0
     C                   PARM                    UFLAGG
      *
     C                   ENDSR
      *
N01   ***********************************************
N01  C     ARKIVS        BEGSR
N01   ***********************************************
N01  C     *IN90         IFEQ      '0'
N01  C                   MOVE      *ZEROS        WSNR
N01  C                   UPDATE    SUBFIL
N01  C                   END
N01  C                   CALL      'ARC003'
N01  C                   PARM      BLAVD         UAVD2
N01  C                   PARM      BLOPD         UOPD2
N01  C                   PARM                    URUNDE           10
N01  C                   ENDSR
N01   *
     C***********************************************
     C     BHENT         BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
      *
     C     *IN98         IFEQ      '1'
     C   99              MOVE      '0'           *IN98
     C                   GOTO      SLHENT
     C                   ELSE
     C                   MOVE      '1'           *IN99
     C                   SELECT
     C     WSNR          WHENEQ    2
     C                   EXSR      CHGBL
     C     WSNR          WHENEQ    3
     C                   EXSR      CPYBL
     C     WSNR          WHENEQ    5
     C                   EXSR      DSPBL
     C     WSNR          WHENEQ    7
     C                   EXSR      WRKFV
     C     WSNR          WHENEQ    8
     C                   EXSR      WRKFT
     C     WSNR          WHENEQ    11
     C     HEADFK        CHAIN     BOOKING                            98
     C     *IN98         IFEQ      '1'
     C                   MOVE      'SPO0002'     MSGNR
     C                   GOTO      SLHENT
     C                   END
     C     USG           IFNE      BOSG
     C                   MOVE      '1'           *IN98
     C                   MOVE      'SPS0014'     MSGNR
     C                   GOTO      SLHENT
     C                   END
     C     BOST          IFNE      ' '
     C     BOST          ANDNE     'P'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'SPO0006'     MSGNR
     C                   GOTO      SLHENT
     C                   END
     C                   EXSR      CHGBK
     C     WSNR          WHENEQ    12
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'C'
     C     HEST          ANDNE     'U'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'K'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLHENT
     C                   END
     C                   EXSR      CHGOPD
     C     WSNR          WHENEQ    13
     C     HEST          IFEQ      'S'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLHENT
     C                   END
     C                   EXSR      CHGFAK
     C     WSNR          WHENEQ    14
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'C'
     C     HEST          ANDNE     'U'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'K'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'YBC0041'     MSGNR
     C                   GOTO      SLHENT
     C                   END
     C                   EXSR      CHGFBR
     C     WSNR          WHENEQ    21
     C                   EXSR      DSPBK
     C     WSNR          WHENEQ    22
     C                   EXSR      DSPOPD
     C     WSNR          WHENEQ    23
     C                   EXSR      DSPFAK
     C     WSNR          WHENEQ    24
     C                   EXSR      DSPFBR
N01  C     WSNR          WHENEQ    51
N01  C                   EXSR      ARKIVS
     C                   OTHER
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLHENT
     C                   ENDSL
     C                   END
      *
     C                   ENDDO
      *
     C     SLHENT        TAG
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C     WSAVD         COMP      0                                      40
     C   50              MOVE      '0'           *IN40
     C                   SELECT
     C     WSDT          WHENEQ    0
     C                   MOVE      *ZEROS        XDT
     C     WSDT          WHENEQ    999999
     C                   MOVE      99999999      XDT
     C                   OTHER
     C                   MOVE      WSDTD         XDTD
     C                   MOVE      WSDTM         XDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          XDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          XDTÅ
     C                   END
     C                   ENDSL
      *
     C   41              MOVE      WSBLNR        YBLNR            16
     C   42              MOVE      WSREIS        YREIS            14
     C   43              MOVE      WSOB          YOB               5
     C   44              MOVE      WSLB          YLB               5
     C   45              MOVE      WSKNR         YKNR              8 0
     C   46              MOVEL     WSÅR4         YCC               2 0
     C   46              MOVE      WSÅR4         YÅR               2 0
     C   46              MOVE      WSUKE         YUKE              2 0
     C   47              MOVE      WSTR          YTR               4
     C   49              MOVE      WSSG          YSG               3
     C   50              MOVE      WSMN          YMN              17
     C  N40              DO
     C   41BILL1K        SETLL     BILLOFL1
     C   42BILL2K        SETLL     BILLOFL2
     C   43BILL3K        SETLL     BILLOFL3
     C   44BILL4K        SETLL     BILLOFL4
     C   45BILL5K        SETLL     BILLOFL5
     C   46BILL6K        SETLL     BILLOFL6
     C   47BILL7K        SETLL     BILLOFL7
     C   48BILLK         SETLL     BILLOF
     C   49BILLDK        SETLL     BILLOFLD
     C   50BLJLFK        SETLL     BLJOINLF
     C                   END
     C   40              DO
     C   41BIL21K        SETLL     BILLOFL1
     C   42BIL22K        SETLL     BILLOFL2
     C   43BIL2EK        SETLL     BILLOFLE
     C   44BIL2FK        SETLL     BILLOFLF
     C   45BIL25K        SETLL     BILLOFL5
     C   46BIL26K        SETLL     BILLOFL6
     C   47BIL27K        SETLL     BILLOFL7
     C   48BIL2K         SETLL     BILLOF
     C   49BIL2DK        SETLL     BILLOFLD
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
     C     STLES         TAG
     C  N40              DO                                                     1<-B
     C   41WSAVD         READE     BILLOFL1                               94
     C   42WSAVD         READE     BILLOFL2                               94
     C   43WSAVD         READE     BILLOFL3                               94
     C   44WSAVD         READE     BILLOFL4                               94
     C   45WSAVD         READE     BILLOFL5                               94
     C   46WSAVD         READE     BILLOFL6                               94
     C   47WSAVD         READE     BILLOFL7                               94
     C   48WSAVD         READE     BILLOF                                 94
     C   49XDT           IFEQ      99999999                                      2<-B
     C     WSAVD         READPE    BILLOFLD                               94
     C                   ELSE                                                    2
     C     WSAVD         READE     BILLOFLD                               94
     C                   END                                                     2<-E
     C   50              READ      BLJOINLF                               94
     C   50
     CANN94              DO                                                      2<-B
     C                   MOVE      BLMN          XMN              17
     C     HEADFK        CHAIN     BILLOF                             33
     C   33              GOTO      STLES
     C                   MOVE      XMN           BLMN
     C                   END                                                     2<-E
     C   43
     CANN94WSOB          COMP      BLOB                               9494
     C   44
     CANN94WSLB          COMP      BLLB                               9494
     C   45
     CANN94WSKNR         COMP      BLKNR                              9494
     C   47
     CANN94WSTR          COMP      BLTR                               9494
     C   49
     CANN94WSSG          COMP      BLSG                               9494
     C                   END                                                    1<-E
     C   40              DO                                                     1<-B
     C   41YAVD          READE     BILLOFL1                               94
     C   42YAVD          READE     BILLOFL2                               94
     C   43WSOB          READE     BILLOFLE                               94
     C   44WSLB          READE     BILLOFLF                               94
     C   45YAVD          READE     BILLOFL5                               94
     C   46BIL26K        READE     BILLOFL6                               94
     C   47YAVD          READE     BILLOFL7                               94
     C   48BIL2K         READE     BILLOF                                 94
     C   49XDT           IFEQ      99999999                                      2<-B
     C     BIL2DK        READPE    BILLOFLD                               94
     C                   ELSE                                                    2
     C     BIL2DK        READE     BILLOFLD                               94
     C                   END                                                     2<-E
     C   41
     CANN94WSBLNR        COMP      BLBLNR                             9494
     C   42
     CANN94WSREIS        COMP      BLREIS                             9494
     C   45
     CANN94WSKNR         COMP      BLKNR                              9494
     C   47
     CANN94WSTR          COMP      BLTR                               9494
     C   48
     CANN94WSSG          COMP      BLSG                               9494
     C   94
     CANN43
     CANN44YAVD          IFNE      9999                                          2<-B
     C                   ADD       1             YAVD
     C                   SETOFF                                       33
     C     KODAKB        SETLL     KODTA
     C                   READ      KODTA                                  33
     C  N33              MOVE      KOAAVD        YAVD              4 0
     C  N33              EXSR      SETKEY
     C  N33              SETOFF                                       94
     C  N33              GOTO      STLES
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C  N48
     CANN94XDT           IFGT      BLDTA
     C     XDT           ANDNE     99999999
     C   41              MOVE      BLBLNR        YBLNR
     C   42              MOVE      BLREIS        YREIS            14
     C   43              MOVE      BLOB          YOB               5
     C   44              MOVE      BLLB          YLB               5
     C   45              MOVE      BLKNR         YKNR              8 0
     C   46              MOVE      BLACC         YCC               2 0
     C   46              MOVE      BLAAR         YÅR               2 0
     C   46              MOVE      BLUKE         YUKE              2 0
     C   47              MOVE      BLTR          YTR               4
     C   49              MOVE      BLSG          YSG               3
     C                   GOTO      STLES
     C                   END
     C  N41
     CANN48
     CANN94WSBLNR        IFNE      *BLANKS
     C     WSBLNR        ANDNE     BLBLNR
     C                   GOTO      STLES
     C                   END
     C  N42
     CANN48
     CANN94WSREIS        IFNE      *BLANKS
     C     WSREIS        ANDNE     BLREIS
     C                   GOTO      STLES
     C                   END
     C  N43
     CANN48
     CANN94WSOB          IFNE      *BLANKS
     C     WSOB          ANDNE     BLOB
     C                   GOTO      STLES
     C                   END
     C  N44
     CANN48
     CANN94WSLB          IFNE      *BLANKS
     C     WSLB          ANDNE     BLLB
     C                   GOTO      STLES
     C                   END
     C  N45
     CANN48
     CANN94WSKNR         IFNE      0
     C     WSKNR         ANDNE     BLKNR
     C                   GOTO      STLES
     C                   END
     C   46
     CANN94WSÅR4         COMP      XÅR4                               9494
     C   46
     CANN94WSUKET        COMP      BLUKE                                94
     C*
     C  N46
     CANN48
     CANN94WSUKE         IFNE      0
     C     WSÅR4         IFNE      XÅR4
     C                   GOTO      STLES
     C                   END
     C     WSUKE         IFNE      BLUKE
     C                   GOTO      STLES
     C                   END
     C                   END
     C  N47
     CANN48
     CANN94WSTR          IFNE      *BLANKS
     C     WSTR          ANDNE     BLTR
     C                   GOTO      STLES
     C                   END
     C  N49
     CANN48
     CANN94WSSG          IFNE      *BLANKS
     C     WSSG          ANDNE     BLSG
     C                   GOTO      STLES
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    WSAVD
     C     KODAKA        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    WSAVDA
     C     KODAKB        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    YAVD
     C     KOD2AK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    BLAVD
     C     KODSKA        KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    WSSGA
     C     TRANK         KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    HEKNT
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2OPD
     C     KODSFK        KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    WSSG
     C     HEADFK        KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     BLKNY         KLIST
     C                   KFLD                    UAVD2
     C                   KFLD                    UOPD2
     C     BILLK         KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     BILL1K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YBLNR
     C                   KFLD                    XDT
     C     BILL2K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YREIS
     C                   KFLD                    XDT
     C     BILL3K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YOB
     C                   KFLD                    XDT
     C     BILL4K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YLB
     C                   KFLD                    XDT
     C     BILL5K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YKNR
     C                   KFLD                    XDT
     C     BILL6K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YCC
     C                   KFLD                    YÅR
     C                   KFLD                    YUKE
     C     BILL7K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YTR
     C                   KFLD                    XDT
     C     BILLDK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YSG
     C                   KFLD                    XDT
     C     BLJLFK        KLIST
     C                   KFLD                    YMN
     C     BIL2K         KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    WSOPD
     C     BIL21K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YBLNR
     C                   KFLD                    XDT
     C     BIL22K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YREIS
     C                   KFLD                    XDT
     C     BIL2EK        KLIST
     C                   KFLD                    YOB
     C                   KFLD                    XDT
     C     BIL2FK        KLIST
     C                   KFLD                    YLB
     C                   KFLD                    XDT
     C     BIL25K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YKNR
     C                   KFLD                    XDT
     C     BIL26K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YCC
     C                   KFLD                    YÅR
     C                   KFLD                    YUKE
     C     BIL27K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YTR
     C                   KFLD                    XDT
     C     BIL2DK        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YSG
     C                   KFLD                    XDT
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     KUNDRK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSKNR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UUR               1
     C                   PARM                    USTAC1            2
     C                   PARM                    USTAC2            2
     C                   PARM                    USTAC3            2
     C                   PARM                    UTILMD            2
     C*
     C                   MOVE      UAVD          WSAVDA
     C                   MOVE      USG           WSSGA
     C                   MOVE      'A'           KOAUNI
     C                   MOVE      'SF'          KOSFUN
     C                   MOVE      *BLANKS       BLMN
     C                   MOVE      *ZEROS        BLAVD
     C                   MOVE      *ZEROS        BLOPD
     C                   MOVE      *ZEROS        BLDTA
     C                   MOVE      *ZEROS        XDTA
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        W2DT
     C                   MOVE      UYEAR         WSÅR
     C                   MOVE      'N'           UKUNB             1
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPSJON        BEGSR
      ***********************************************
     C                   SELECT
     C     XOPTNR        WHENEQ    0
     C                   ADD       1             XOPTNR            1 0
     C                   MOVE      'YBC0719'     XOPNR
     C     XOPTNR        WHENEQ    1
     C                   ADD       1             XOPTNR
     C                   MOVE      'YBC0722'     XOPNR
     C     XOPTNR        WHENEQ    2
S01  C*                  Z-ADD     0             XOPTNR
N01  C                   Z-ADD     3             XOPTNR
     C                   MOVE      'YBC0750'     XOPNR
N01  C     XOPTNR        WHENEQ    3
N01  C                   Z-ADD     0             XOPTNR
N01  C                   MOVE      'YBC1964'     XOPNR
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BLDTAD        UDT1              2 0
     C                   MOVE      BLDTAM        UDT2              2 0
     C                   MOVE      BLDTAÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          XDTAD
     C                   MOVE      UDT2          XDTAM
     C                   MOVE      UDT3          XDTAÅ
     C*
     C                   ENDSR
     C*
     OHEADFR    E            NYOPDS
     O                       HEST
     O          E            NYOPDP
     O                       HEPK1
