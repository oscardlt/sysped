********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12068 * 01 CB  PTF12 3 DESIMALER PÅ FAKTURABELOPP
12068 * 02 sh  PTF12 økt bx til 90.000
********************************************************************
     FDKEH      IF   E           K DISK
     FDKEV      UF   E           K DISK
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
s02  D* A                      1  30000
s02  D*                                    DIM(30000)                           Input string
s02  D* ADS                    1  30000
n02  D  A                      1  90000
n02  D                                     DIM(90000)                           Input string
n02  D  ADS                    1  90000
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
s02  D* B                      1  30000
s02  D*                                    DIM(30000)                           Output string
s02  D* BDS                    1  30000
n02  D  B                      1  90000
n02  D                                     DIM(90000)                           Output string
n02  D  BDS                    1  90000
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN164                  1     16  4
     D  ØA164H                 1     12
     D  ØA164D                13     16
     D                 DS
     D  ØA17                   1     17
     D  Ø17                    1     17
     D                                     DIM(17)                              Num edit
      *____________
      * DS for EORI
      *""""""""""""
     D                 DS
     D  WEORI                  1     17
     D  WEORIA                 1      2
     D  WEORIB                 3     17
     D                 DS
     D  WDKEH_30               1     24
     D  DKEH_301               1      2
     D  DKEH_302               3     10
     D  DKEH_303              11     13
     D  DKEH_304              14     16
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    DKEH_SYAV     UKEH_SYAV
     C     *LIKE         DEFINE    DKEH_SYOP     UKEH_SYOP
     C     *LIKE         DEFINE    DKEV_32       UKEV_32

     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             7 0
     C                   Z-ADD     80            LEN               5 0
     C                   MOVEL     'EUNOAO  '    TABLE            10
     C                   MOVEL     '*LIBL   '    LIB              10
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UKEH_SYAV
     C                   KFLD                    UKEH_SYOP
     C     KEYB          KLIST
     C                   KFLD                    DKEV_SYAV
     C                   KFLD                    DKEV_SYOP
     C                   KFLD                    DKEV_SYLI
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                5 0          Index for B
     C                   Z-ADD     0             AXV               5 0          Leftindx A
     C                   Z-ADD     0             AXH               5 0          Rightindx A
     C                   MOVE      'R'           WDIR              1            Search direction
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UKEH_SYAV
     C                   PARM                    UKEH_SYOP
     C                   PARM      BDS           UDATA         30000
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     DKEH

      *_____________
      * Huvudsektion
      *"""""""""""""
      * Meddelandeingress
     C                   EXSR      UNH00
      * Meddelandebørjan
     C                   EXSR      BGM00
      * Eksport art
     C                   EXSR      CST00
      * Plats lokaliseringsidentifikation
     C                   EXSR      LOC00
      * Datoer
     C                   EXSR      DTM00
      * Triggers
     C                   EXSR      GIS00
      * Landkoder routing
     C                   EXSR      EQD00
      * Plomberingsoplsyninger
     C                   EXSR      SEL00
      * Fritekst
     C                   EXSR      FTX00
      * Referenser
     C                   EXSR      RFF01
      * Transportdetaljer
     C                   EXSR      TDT04
      * NAD Eksportør
     C                   EXSR      NAD06A
      * NAD Klarerer
     C                   EXSR      NAD06B
      * NAD Carrier
     C                   EXSR      NAD06C
      * NAD Modtager
     C                   EXSR      NAD06D
      * NAD Repræsentant ved udpassage
     C                   EXSR      NAD06E
      * NAD Transportmidlets fører
     C                   EXSR      NAD06F
      * Leveransvillkår
     C                   EXSR      TOD07
      * Belopp
     C                   EXSR      MOA08
      * Seksjonskille
     C                   EXSR      UNSD
      *______________
      * Detaljsektion
      *""""""""""""""
      * Vareposter
     C     DKEH_AART     IFNE      '50'
     C     DKEH_AJOU     IFNE      '8'
     C     DKEH_AJOU     IFNE      '9'
     C                   EXSR      CST30
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Seksjonskille
     C                   EXSR      UNSS
      *_____________
      * Summasektion
      *"""""""""""""
      * Meddelandeslut
     C
     C     DKEH_AJOU     IFNE      '8'
     C     DKEH_AJOU     IFNE      '9'
     C                   EXSR      CNT00
     C                   ENDIF
     C                   ENDIF
      * Meddelandeslut
     C                   EXSR      UNT00
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_________________
      * Trim left blanks
      *"""""""""""""""""
     C                   MOVEL(P)  ADS           ADS2          30000
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS=%TRIML(ADS2)
      *_______________
      * Find positions
      *""""""""""""""""
     C                   EVAL      AXV=1
     C     ' '           CHECKR    ADS           AXH
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WDIR          ANDEQ     'R'
     C     WCHAR         IFEQ      ';'                                                      III
     C                   MOVE      ':'           WCHAR
     C                   ENDIF                                                    <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   ENDIF                                                   <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I

     C                   END                                                    <-------------I

     C                   MOVE      'Y'           WCHART
     C                   EVAL      ADS=*BLANKS
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA17
     C     ØA164D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA164H        ØA17                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA164H        ØA17                                         I
     C                   MOVE      ',    '       ØA17                                         I
     C                   MOVE      ØA164D        ØA17                                         I
     C     Ø17(17)       IFEQ      '0'
     C                   MOVE      ' '           Ø17(17)
     C     Ø17(16)       IFEQ      '0'
     C                   MOVE      ' '           Ø17(16)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        16            ØX                             <-------------I
     C     Ø17(ØX)       IFNE      '0'                                           <-----------II
     C     Ø17(ØX)       IFEQ      ','                                           <-----------II
     C                   SUB       1             ØX
     C                   ENDIF                                                   <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø17(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandeingress                                  UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVEL     'UNH+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVEL     DKEH_SYAV     W0062            11
     C                   MOVE      DKEH_SYOP     W0062
     C                   MOVEL     W0062         ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVEL     'CUSDEC'      ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEA     ':D:96B:U'    A(1)
     C                   MOVEA     'N:1053'      A(9)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL(P)  WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandebørjan                                   BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'BGM+:::'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1000 Ang_type(2)
     C     DKEH_AART     IFNE      '50'
     C                   IF        DKEH_R011 <> *BLANKS
     C                   MOVEL     DKEH_R011     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * 1000 EU_Ang_typ(1)
     C     DKEH_AART     IFNE      '30'
     C     DKEH_AART     IFNE      '50'
     C                   IF        DKEH_R012 <> *BLANKS
     C                   MOVEL     DKEH_R012     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * 1000 Ang_art(2)
     C     DKEH_AART     IFNE      '50'
     C                   MOVEL     DKEH_AART     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1004 Internt_nr
     C                   IF        DKEH_AART='50'
     C                   MOVEL     DKEH_MRN      ADS
     C                   ELSE
     C                   MOVEL     W0062         ADS
     C                   ENDIF
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1056 Ajour_type
     C                   IF        DKEH_AJOU <> *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     DKEH_AJOU     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL(P)  WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontroll totaler                                   CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
      * Antal vareposter
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=UKEV_32
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+5:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Antal kolli
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEH_06
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+11:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Antal plomber
     C     DKEH_D011     IFNE      *BLANKS
     C                   ADD       1             WANTPLOM          1 0
     C                   ENDIF
     C     DKEH_D012     IFNE      *BLANKS
     C                   ADD       1             WANTPLOM
     C                   ENDIF
     C     DKEH_D013     IFNE      *BLANKS
     C                   ADD       1             WANTPLOM
     C                   ENDIF
     C     DKEH_D014     IFNE      *BLANKS
     C                   ADD       1             WANTPLOM
     C                   ENDIF
     C     DKEH_D015     IFNE      *BLANKS
     C                   ADD       1             WANTPLOM
     C                   ENDIF
     C     DKEH_AART     IFNE      '50'
     C     WANTPLOM      ANDNE     *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=WANTPLOM
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+16:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Eksport art                                        CST00 /
      *////////////////////////////////////////////////////////////
     C     CST00         BEGSR
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='CST++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Eksport art
     C                   MOVEL     DKEH_YM21     ADS
     C                   EXSR      SRÅ
      * T-status
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKEH_YM23     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varupostnivå                                       CST30 /
      *////////////////////////////////////////////////////////////
     C     CST30         BEGSR

     C                   EVAL      *IN20=*OFF
     C                   EVAL      UKEV_32=*ZEROS
     C     KEYA          SETLL     DKEV
     C     KEYA          READE     DKEV                                   20
     C     *IN20         DOWEQ     *OFF
     C                   ADD       1             UKEV_32
     C                   EVAL      DKEV_32=UKEV_32
     C                   UPDATE    DKEVR

      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='CST+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varepost_nr
     C                   EVAL      ØN164=DKEV_32
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ

     C     DKEH_AART     IFEQ      '22'
     C     DKEH_AART     OREQ      '23'
     C                   GOTO      CST30A
     C                   ENDIF
      * Varekod
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKEV_331      ADS
     C                   EXSR      SRÅ
      * Tillæg kode 1
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_332      CABEQ     *BLANKS       CST30a
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKEV_332      ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C     CST30A        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

      * Andra segment under CST
     C                   EXSR      FTX30
     C                   EXSR      LOC30
     C                   EXSR      DTM30
     C                   EXSR      MEA30
     C                   EXSR      PAC31
     C                   EXSR      MOA33
     C                   EXSR      RFF35
     C                   EXSR      DOC37
     C                   EXSR      GIS40
     C                   EXSR      GIR44

      * Læs næsta varulinje
     C     KEYA          READE     DKEV                                   20
     C  N20              ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tidigare handlingar (tullid)                       DOC37 /
      *////////////////////////////////////////////////////////////
     C     DOC37         BEGSR
      *_________________________
      * Forudgående tolddokument
      *"""""""""""""""""""""""""
      * Sumarisk angivelse 1
     C     DKEV_403A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C*                  EVAL      ADS='DOC+998:::'+DKEV_401A+DKEV_402A+'+'
     C*                                +%trimr(DKEV_403A)+WAPSTR
     C                   EVAL      ADS='DOC+998:::'+DKEV_401A+DKEV_402A+'+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKEV_403A     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
      * Sumarisk angivelse 2
     C     DKEV_403B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C*                  EVAL      ADS='DOC+998:::'+DKEV_401B+DKEV_402B+'+'
     C*                                +%trimr(DKEV_403B)+WAPSTR
     C                   EVAL      ADS='DOC+998:::'+DKEV_401B+DKEV_402B+'+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKEV_403B     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
      * Sumarisk angivelse 3
     C     DKEV_403C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401C+DKEV_402C+'+'
     C                                 +%trimr(DKEV_403C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 4
     C     DKEV_403D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401D+DKEV_402D+'+'
     C                                 +%trimr(DKEV_403D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 5
     C     DKEV_403E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401E+DKEV_402E+'+'
     C                                 +%trimr(DKEV_403E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 6
     C     DKEV_403F     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401F+DKEV_402F+'+'
     C                                 +%trimr(DKEV_403F)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 7
     C     DKEV_403G     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401G+DKEV_402G+'+'
     C                                 +%trimr(DKEV_403G)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 8
     C     DKEV_403H     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401H+DKEV_402H+'+'
     C                                 +%trimr(DKEV_403H)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 9
     C     DKEV_403I     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401I+DKEV_402I+'+'
     C                                 +%trimr(DKEV_403I)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 10
     C     DKEV_403J     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401J+DKEV_402J+'+'
     C                                 +%trimr(DKEV_403J)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 11
     C     DKEV_403K     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401K+DKEV_402K+'+'
     C                                 +%trimr(DKEV_403K)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 12
     C     DKEV_403L     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401L+DKEV_402L+'+'
     C                                 +%trimr(DKEV_403L)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 13
     C     DKEV_403M     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401M+DKEV_402M+'+'
     C                                 +%trimr(DKEV_403M)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 14
     C     DKEV_403N     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401N+DKEV_402N+'+'
     C                                 +%trimr(DKEV_403N)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 15
     C     DKEV_403O     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401O+DKEV_402O+'+'
     C                                 +%trimr(DKEV_403O)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 16
     C     DKEV_403P     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401P+DKEV_402P+'+'
     C                                 +%trimr(DKEV_403P)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 17
     C     DKEV_403Q     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401Q+DKEV_402Q+'+'
     C                                 +%trimr(DKEV_403Q)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 18
     C     DKEV_403R     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401R+DKEV_402R+'+'
     C                                 +%trimr(DKEV_403R)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 19
     C     DKEV_403S     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401S+DKEV_402S+'+'
     C                                 +%trimr(DKEV_403S)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 20
     C     DKEV_403T     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401T+DKEV_402T+'+'
     C                                 +%trimr(DKEV_403T)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 21
     C     DKEV_403U     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401U+DKEV_402U+'+'
     C                                 +%trimr(DKEV_403U)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 22
     C     DKEV_403V     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401V+DKEV_402V+'+'
     C                                 +%trimr(DKEV_403V)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 23
     C     DKEV_403W     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401W+DKEV_402W+'+'
     C                                 +%trimr(DKEV_403W)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 24
     C     DKEV_403X     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401X+DKEV_402X+'+'
     C                                 +%trimr(DKEV_403X)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 25
     C     DKEV_403Y     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKEV_401Y+DKEV_402Y+'+'
     C                                 +%trimr(DKEV_403Y)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *___________
      * Certifikat
      *"""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
      * Certifikat-1
     C     DKEV_4421     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4421+'+'
     C                                 +%trimr(DKEV_442A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-2
     C     DKEV_4422     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4422+'+'
     C                                 +%trimr(DKEV_442B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-3
     C     DKEV_4423     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4423+'+'
     C                                 +%trimr(DKEV_442C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-4
     C     DKEV_4424     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4424+'+'
     C                                 +%trimr(DKEV_442D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-5
     C     DKEV_4425     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4425+'+'
     C                                 +%trimr(DKEV_442E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-6
     C     DKEV_4426     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4426+'+'
     C                                 +%trimr(DKEV_442F)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-7
     C     DKEV_4427     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4427+'+'
     C                                 +%trimr(DKEV_442G)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-8
     C     DKEV_4428     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4428+'+'
     C                                 +%trimr(DKEV_442H)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-9
     C     DKEV_4429     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKEV_4429+'+'
     C                                 +%trimr(DKEV_442I)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_________________
      * Bevillingsnummer
      *"""""""""""""""""
     C     DKEH_AART     IFNE      '30'
     C     DKEV_441      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+811+'+%trimr(DKEV_441)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________
      * Transportdokument
      *""""""""""""""""""
     C     DKEV_445A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+785:::'+DKEV_445A+'+'
     C                                 +%trimr(DKEV_445B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Datoer                                             DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
      *___________________
      * Forventet eksp_tid
      *"""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '30'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEH_DTM1
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+133:'+%trimr(ØAN)+':203'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_________________
      * Faktisk eksp_tid
      *"""""""""""""""""
     C     DKEH_AART     IFEQ      '28'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_DTM2     IFGT      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEH_DTM2
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+186:'+%trimr(ØAN)+':203'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_____________________
      * YM Indladnings start
      *"""""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEH_YMD1
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+291:'+%trimr(ØAN)+':203'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *____________________
      * YM Indladnings slut
      *""""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEH_YMD2
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+206:'+%trimr(ØAN)+':203'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________
      * YM Fraførselsdato
      *""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_YMD3     IFGT      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEH_YMD3
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+XXX:'+%trimr(ØAN)+':102'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Datoer                                             DTM30 /
      *////////////////////////////////////////////////////////////
     C     DTM30         BEGSR
      *________________
      * Satsdato ved FF
      *""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y73      IFGT      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y73
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+170:'+%trimr(ØAN)+':102'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Landkoder i ruttordning                            EQD00 /
      *////////////////////////////////////////////////////////////
     C     EQD00         BEGSR
      *__________
      * Landkoder
      *""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'

     C     DKEH_S131     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='EQD+CH+:::'+DKEH_S131+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_S132     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='EQD+CH+:::'+DKEH_S132+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_S133     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='EQD+CH+:::'+DKEH_S133+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_S134     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='EQD+CH+:::'+DKEH_S134+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_S135     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='EQD+CH+:::'+DKEH_S135+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekst                                           FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
      *_____________________
      * Transportinformation
      *"""""""""""""""""""""
     C     DKEH_AART     IFEQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '05'
     C     DKEH_FTX1     IFNE      *BLANKS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4451 Kode
     C                   MOVEL     'TRA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   MOVEL     DKEH_FTX1     ADS
     C                   EXSR      SRÅ
     C     DKEH_FTX2     IFNE      *ZEROS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ØN164=DKEH_FTX2
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTX3     IFNE      *ZEROS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ØN164=DKEH_FTX3
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTX4     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTX4     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTX5     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTX5     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
      *___________
      * Bemærkning
      *"""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_FTX6     IFNE      *BLANKS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4451 Kode
     C                   MOVEL     'CUR'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   MOVEL     DKEH_FTX6     ADS
     C                   EXSR      SRÅ
     C     DKEH_FTX7     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTX7     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTX8     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTX8     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTX9     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTX9     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
      *_______________________
      * Spritusbeholdning styk
      *"""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXA     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZSS+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXA
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *________________________
      * Spritusbeholdning liter
      *""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXB     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZSL+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXB
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *__________
      * Vin antal
      *""""""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXC     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZVS+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXC
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *__________
      * Vin liter
      *""""""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXD     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZVL+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXD
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *________
      * Cigaret
      *""""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXE     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZCI+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXE
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *______
      * Cigar
      *""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXF     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZCC+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXF
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *______
      * Tobak
      *""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXG     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZTO+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXG
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *___
      * Øl
      *"""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXH     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZOS+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXH
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *______
      * Andet
      *""""""
     C     DKEH_AART     IFEQ      '26'
     C*    DKEH_FTXI     IFNE      *ZEROS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZOV+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   EVAL      ØN164=DKEH_FTXI
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *__________________________
      * Provianteringsbeskrivelse
      *""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '26'
     C     DKEH_AART     OREQ      '27'
     C*    DKEH_FTXJ     IFNE      *BLANKS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ZBE+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   MOVEL     DKEH_FTXJ     ADS
     C                   EXSR      SRÅ
     C     DKEH_FTXK     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTXK     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTXL     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTXL     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_FTXM     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_FTXM     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C*                  ENDIF
     C                   ENDIF
      *________________
      * YM Bemærkninger
      *""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_YMB1     IFNE      *BLANKS

      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+AAI+++'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   MOVEL     DKEH_YMB1     ADS
     C                   EXSR      SRÅ
     C     DKEH_YMB2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_YMB2     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_YMB3     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_YMB3     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_YMB4     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEH_YMB4     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varebeskrivelse                                    FTX30 /
      *////////////////////////////////////////////////////////////
     C     FTX30         BEGSR
      *________________
      * Varebeskrivelse
      *""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_315      IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKEV_315      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
      *________________________
      * Supplerende information
      *""""""""""""""""""""""""
     C     DKEV_446A     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'ACB'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Suppl. varebeskrivelse-1
     C                   MOVEL     DKEV_446A     ADS
     C                   EXSR      SRÅ
      * Suppl. varebeskrivelse-2
     C     DKEV_446B     CABEQ     *BLANKS       FTX30B
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEV_446B     ADS
     C                   EXSR      SRÅ
      * Suppl. varebeskrivelse-3
     C     DKEV_446C     CABEQ     *BLANKS       FTX30B
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEV_446C     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     FTX30B        TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
      *________________________
      * Supplerende information
      *""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_BEM1     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAI'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Bem-1
     C                   MOVEL     DKEV_BEM1     ADS
     C                   EXSR      SRÅ
      * Bem-2
     C     DKEV_BEM2     CABEQ     *BLANKS       FTX30C
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEV_BEM2     ADS
     C                   EXSR      SRÅ
      * Bem-3
     C     DKEV_BEM3     CABEQ     *BLANKS       FTX30C
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEV_BEM3     ADS
     C                   EXSR      SRÅ
      * Bem-4
     C     DKEV_BEM4     CABEQ     *BLANKS       FTX30C
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKEV_BEM4     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     FTX30C        TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
      *_____________
      * Delsendinger
      *"""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '28'
     C     DKEV_447      IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'DEL'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKEV_447      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Recept/Basisvarer                                  GIR44 /
      *////////////////////////////////////////////////////////////
     C     GIR44         BEGSR
      *_______
      * Recept
      *"""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y81A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIR+AAA+'+DKEV_Y81A+DKEV_Y81B+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________
      * Basisvare
      *""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y82E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y82G
     C                   EXSR      SRNE
     C                   EVAL      ADS='GIR+BBB+'+DKEV_Y82E+'+'+DKEV_Y82A+'+'
     C                                 +%trimr(ØAN)+'+'+DKEV_Y82H+'+'
     C                                 +DKEV_Y82F+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   EXSR      GIS44
     C                   EXSR      MEA44
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generella indikatorer                              GIS00 /
      *////////////////////////////////////////////////////////////
     C     GIS00         BEGSR
      * Fragtdokument
     C     DKEH_AART     IFNE      '50'
     C     DKEH_GIS1     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+DKEH_GIS1+':117'
     C                                 + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Storage flag
     C     DKEH_AART     IFEQ      '30'
     C     DKEH_AART     OREQ      '50'
     C     DKEH_GIS2     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+DKEH_GIS2+':109'
     C                                 + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Disp for forsegling
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_GIS3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+DKEH_GIS3+':XXX'
     C                                 + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Restitution
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_GIS4     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+DKEH_GIS4+':BBB'
     C                                 + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS40 /
      *////////////////////////////////////////////////////////////
     C     GIS40         BEGSR
      *___________________________
      * Angivelse af procedurekode
      *"""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_37       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+ZZZ:117::'+DKEV_37+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_____________________________
      * Angivelse af varebestemmelse
      *"""""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_443      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+ZZZ:110::'+DKEV_443+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_____________
      * YM Licensart
      *"""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y72      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+1:AAA'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS44 /
      *////////////////////////////////////////////////////////////
     C     GIS44         BEGSR
      *______________________
      * Recept under/overvægt
      *""""""""""""""""""""""
     C     DKEV_Y81E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+DKEV_Y81E+'ZZZ'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plats/lokaliseringsidentifikation                  LOC00 /
      *////////////////////////////////////////////////////////////
     C     LOC00         BEGSR
      *___________________________________________________
      * Angivelse af varens placering, SAD Box# 30.1 -30.4
      *"""""""""""""""""""""""""""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '31'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+14+'+%trimr(WDKEH_30)
     C                                 + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________________
      * Eksp.sted, SAD Box# A.1
      *""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+91+'+%trimr(DKEH_A1)+':1:105'
     C                                 +WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_________________________________________
      * Angivelse af best.landkode, SAD Box# 17a
      *"""""""""""""""""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+36+'+DKEH_17A+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________________
      * Udgangstoldsted, SAD Box# 29
      *"""""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '50'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+42+'+DKEH_29+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________
      * Indladningssted
      *""""""""""""""""
     C     DKEH_AART     IFEQ      '26'
     C     DKEH_AART     OREQ      '27'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+9+'+DKEH_IND+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________
      * Udpassage
      *""""""""""
     C     DKEH_AART     IFEQ      '30'
     C     DKEH_AART     OREQ      '50'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+60+:::'+%trimr(DKEH_UVP)
     C                                 + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________
      * YM-Varenes placering
      *"""""""""""""""""""""
     C     DKEH_AART     IFEQ      '32'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+4+:::'+DKEH_YMVP+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Oprindelsesland                                    LOC30 /
      *////////////////////////////////////////////////////////////
     C     LOC30         BEGSR
      *_________________
      * Oprindelsesland
      *"""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_34A      IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '27'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     DKEV_34A      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_____________
      * Oplagsnummer
      *"""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_49       IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '18'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     DKEV_49       ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Eksportør                                         NAD06A /
      *////////////////////////////////////////////////////////////
     C     NAD06A        BEGSR
     C     DKEH_AART     IFNE      '22'
     C     DKEH_AART     IFNE      '23'
     C     DKEH_AART     IFNE      '50'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+EX+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKEH_02A      IFNE      *BLANKS
     C                   MOVEL     DKEH_02A      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   GOTO      NAD06A9
     C                   ENDIF
      * Navn
     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_02B      IFNE      *BLANKS
     C                   MOVEL     DKEH_02B      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Gade
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_02C      IFNE      *BLANKS
     C                   MOVEL     DKEH_02C      ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * By
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_02E      IFNE      *BLANKS
     C                   MOVEL     DKEH_02E      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Postnr
     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_02D      IFNE      *BLANKS
     C                   MOVEL     DKEH_02D      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Land
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_02F      IFNE      *BLANKS
     C                   MOVEL     DKEH_02F      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C     NAD06A9       TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Klarerer                                          NAD06B /
      *////////////////////////////////////////////////////////////
     C     NAD06B        BEGSR
     C     DKEH_AART     IFNE      '50'
     C     DKEH_14A      IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CB+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C                   MOVEL     DKEH_14A      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Carrier                                           NAD06C /
      *////////////////////////////////////////////////////////////
     C     NAD06C        BEGSR
     C     DKEH_AART     IFEQ      '50'
     C     DKEH_14A      IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CA+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C                   MOVEL     DKEH_14A      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Modtager                                          NAD06D /
      *////////////////////////////////////////////////////////////
     C     NAD06D        BEGSR
     C     DKEH_AART     IFNE      '22'
     C     DKEH_AART     IFNE      '23'
     C     DKEH_AART     IFNE      '50'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CN+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKEH_08A      IFNE      *BLANKS
     C                   MOVEL     DKEH_08A      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   GOTO      NAD06D9
     C                   ENDIF
      * Navn
     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_08B      IFNE      *BLANKS
     C                   MOVEL     DKEH_08B      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Gade
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_08C      IFNE      *BLANKS
     C                   MOVEL     DKEH_08C      ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * By
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_08E      IFNE      *BLANKS
     C                   MOVEL     DKEH_08E      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Postnr
     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_08D      IFNE      *BLANKS
     C                   MOVEL     DKEH_08D      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Land
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_08F      IFNE      *BLANKS
     C                   MOVEL     DKEH_08F      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C     NAD06D9       TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Repræsentant                                      NAD06E /
      *////////////////////////////////////////////////////////////
     C     NAD06E        BEGSR
     C     DKEH_AART     IFEQ      '30'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+AH+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKEH_REEO     IFNE      *BLANKS
     C                   MOVEL     DKEH_REEO     ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Navn
     C                   GOTO      NAD06E9
     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_RENA     IFNE      *BLANKS
     C                   MOVEL     DKEH_RENA     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Gade
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_REGA     IFNE      *BLANKS
     C                   MOVEL     DKEH_REGA     ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * By
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_REBY     IFNE      *BLANKS
     C                   MOVEL     DKEH_REBY     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Postnr
     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_REPO     IFNE      *BLANKS
     C                   MOVEL     DKEH_REPO     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Land
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKEH_RELK     IFNE      *BLANKS
     C                   MOVEL     DKEH_RELK     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C     NAD06E9       TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tarnsportmidlets fører                            NAD06F /
      *////////////////////////////////////////////////////////////
     C     NAD06F        BEGSR
     C     DKEH_AART     IFEQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_ZKP      IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+ZKP++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Førernavn
     C                   MOVEL     DKEH_ZKP      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSD /
      *////////////////////////////////////////////////////////////
     C     UNSD          BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='UNS+D'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSS /
      *////////////////////////////////////////////////////////////
     C     UNSS          BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='UNS+S'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mått varulinje                                     MEA30 /
      *////////////////////////////////////////////////////////////
     C     MEA30         BEGSR
      *___________
      * Bruttovægt
      *"""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_35
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+AAB+KGM:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________
      * Nettovægt
      *""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_38       IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_38
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+AAA+KGM:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________
      * Supplerende mængde
      *"""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_412      IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_412
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+AAR++'+%trimr(DKEV_411)+':'+
     C                                 %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_______________
      * Procentindhold
      *"""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_449A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='MEA+DV+:::'+%trimr(DKEV_449A)+'+ZZZ:'+
     C                                 %trimr(DKEV_449B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________
      * Supplerende mængde
      *"""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '21'
     C     DKEV_Y63      IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y63
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+QQQ++'+%trimr(DKEV_Y64)+':'+
     C                                 %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Recept/Basisvarer                                  MEA44 /
      *////////////////////////////////////////////////////////////
     C     MEA44         BEGSR
      *______________
      * Recept mængde
      *""""""""""""""
     C     DKEV_Y81C     IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y81C
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+XXX+1:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________
      * Basis nettovægt
      *""""""""""""""""
     C     DKEV_Y82B     IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y82B
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+YYY+0:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *______________
      * Basis procent
      *""""""""""""""
     C     DKEV_Y82C     IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y82C
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+PCT++:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________
      * Basis mængde
      *"""""""""""""
     C     DKEV_Y82D     IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y82D
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+ZZZ+0:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Belopp, huvudnivå                                  MOA08 /
      *////////////////////////////////////////////////////////////
     C     MOA08         BEGSR
      *_________________________
      * Møntsort og fakturabeløb
      *"""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_221      IFNE      *BLANKS
     C     DKEH_222      ANDNE     *ZEROS
     C                   ADD       1             W0074
N01  C                   Z-ADD     DKEH_222      WRUBR222         15 0
S01  C*                  EVAL      ØN164=DKEH_222
N01  C                   EVAL      ØN164=WRUBR222
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+39:'+%trimr(ØAN)+':'
     C                             + %trimr(DKEH_221)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Beløp                                              MOA33 /
      *////////////////////////////////////////////////////////////
     C     MOA33         BEGSR
      *_________________
      * Statistisk værdi
      *"""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_46       IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_46
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+123:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *______________
      * Softvareverdi
      *""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '22'
     C     DKEH_AART     OREQ      '23'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '28'
     C     DKEV_448      IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_448
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+40:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *____________________
      * YM Restitutionssats
      *""""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y75      IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_Y75
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+40:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Antal og art                                       PAC31 /
      *////////////////////////////////////////////////////////////
     C     PAC31         BEGSR
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_314      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKEV_313
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+'+%trimr(ØAN)+'++'
     C                                 +%trimr(DKEV_314)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     *LIKE         DEFINE    DKEV_311      ZKIV_311
     C                   EVAL      ZKIV_311=DKEV_311
     C                   ENDIF

     C                   EXSR      PCI32

     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Førpackningsidentifikation                         PCI32 /
      *////////////////////////////////////////////////////////////
     C     PCI32         BEGSR
     C     ZKIV_311      IFNE      *BLANKS
     C                   EVAL      ADS=*BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     ZKIV_311      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
      *___________________
      * Ekspeditionsnummer
      *"""""""""""""""""""
     C     DKEH_AART     IFNE      '50'
     C     DKEH_A2       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ACW:'+%trimr(DKEH_A2)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________
      * YM Erklæringskoder
      *"""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_YME1     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEH_YME1)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_YME2     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEH_YME2)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_YME3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEH_YME3)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF35 /
      *////////////////////////////////////////////////////////////
     C     RFF35         BEGSR
      *_____________
      * Container id
      *"""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
      * ID-1
     C     DKEV_312A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKEV_312A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-2
     C     DKEV_312B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKEV_312B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-3
     C     DKEV_312C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKEV_312C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-4
     C     DKEV_312D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKEV_312D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-5
     C     DKEV_312E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKEV_312E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDIF
      *_______________
      * FN farlig gods
      *"""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '30'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_444      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+UN:'+DKEV_444+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *________________
      * YM Licensnummer
      *""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y71      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+EX:'+%trimr(DKEV_Y71)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________________
      * YM Erklæring til varepost
      *""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
      * 1
     C     DKEV_Y76A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEV_Y76A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * 2
     C     DKEV_Y76B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEV_Y76B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * 3
     C     DKEV_Y76C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEV_Y76C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * 4
     C     DKEV_Y76D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ADP:'+%trimr(DKEV_Y76D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDIF
      *________________________
      * YM Garantijournalnummer
      *""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEV_Y74      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ZZZ:'+%trimr(DKEV_Y74)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plomberingsoplysninger                             SEL00 /
      *////////////////////////////////////////////////////////////
     C     SEL00         BEGSR
     C     DKEH_AART     IFNE      '50'
     C     DKEH_D011     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='SEL+0+:::'+%trimr(DKEH_D011)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_D012     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='SEL+0+:::'+%trimr(DKEH_D012)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_D013     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='SEL+0+:::'+%trimr(DKEH_D013)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_D014     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='SEL+0+:::'+%trimr(DKEH_D014)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_D015     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='SEL+0+:::'+%trimr(DKEH_D015)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetaljer                                  TDT04 /
      *////////////////////////////////////////////////////////////
     C     TDT04         BEGSR
      *______________
      * Id ved afgang
      *""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_181      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+12+++++++:::'
     C                                 +%trimr(DKEH_181)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *______________________________________
      * Id ved grænsepassage med nationalitet
      *""""""""""""""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_21       IFNE      *BLANKS
     C     DKEH_25       ANDNE     *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+11++'+%trimr(DKEH_25)+
     C                                 '+++++:::'+%trimr(DKEH_21)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *______________________________________
      * Id ved grænsepassage uten nationalitet
      *""""""""""""""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_21       IFEQ      *BLANKS
     C     DKEH_25       ANDNE     *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+11++'+%trimr(DKEH_25)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________________
      * Indenlandsk transportmåde
      *""""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '28'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
     C     DKEH_26       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+1++'+%trimr(DKEH_26)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leveransvillkår                                    TOD07 /
      *////////////////////////////////////////////////////////////
     C     TOD07         BEGSR
      *________________________
      * Betalingskode mandatory
      *""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '20'
     C     DKEH_AART     OREQ      '21'
     C     DKEH_AART     OREQ      '24'
     C     DKEH_AART     OREQ      '25'
     C     DKEH_AART     OREQ      '26'
     C     DKEH_AART     OREQ      '27'
     C     DKEH_AART     OREQ      '31'
     C     DKEH_AART     OREQ      '32'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='TOD+6+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Betalingskode
     C                   MOVEL     DKEH_S29      ADS
     C                   EXSR      SRÅ

     C     DKEH_201      IFEQ      *BLANKS
     C     DKEH_202      ANDEQ     *BLANKS
     C                   GOTO      TOD071
     C                   ENDIF
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * TOD Kode
     C     DKEH_201      IFNE      *BLANKS
     C                   MOVEL     DKEH_201      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_202      IFEQ      *BLANKS
     C                   GOTO      TOD071
     C                   ENDIF
     C                   MOVEL     '::::'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * TOD Sted
     C                   MOVEL     DKEH_202      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     TOD071        TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________
      * Betalingskode NOT
      *""""""""""""""""""
     C     DKEH_AART     IFEQ      '28'
     C     DKEH_201      IFEQ      *BLANKS
     C     DKEH_202      ANDEQ     *BLANKS
     C                   GOTO      TOD079
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='TOD+6+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * TOD Kode
     C     DKEH_201      IFNE      *BLANKS
     C                   MOVEL     DKEH_201      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKEH_202      IFEQ      *BLANKS
     C                   GOTO      TOD072
     C                   ENDIF
     C                   MOVEL     '::::'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * TOD Sted
     C                   MOVEL     DKEH_202      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     TOD072        TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________________
      * Betalingskode frivillig
      *""""""""""""""""""""""""
     C     DKEH_AART     IFEQ      '30'
     C     DKEH_S29      ANDNE     *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='TOD+6+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Betalningskode
     C                   MOVEL     DKEH_S29      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C     TOD079        ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                      UNT00 /
      *////////////////////////////////////////////////////////////
     C     UNT00         BEGSR

     C                   ADD       1             W0074
     C                   EVAL      ØN164=W0074
     C                   EXSR      SRNE

     C                   EVAL      ADS='UNT+' + %trimr(ØAN) + '+'
     C                                 + %trimr(W0062) + WAPSTR
     C                   EVAL      AXV=1
     C     ' '           CHECKR(E) ADS           AXH
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
     C                   ENDSR
