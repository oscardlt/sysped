      ****************************************************
      * Sjekk file extention på opplastet fil
      * Ret.parameter Uflagg = 1 = Ikke tillatt.
      * Sjekkes kun dersom param av type OLEXT finnes
      ****************************************************
     FBRPARF    if   e           k disk
      * For xlate mellom Upper Case og Lower Case
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     C     *entry        Plist
     c                   parm                    UFile           512
     c                   parm                    UUser            10
     c                   parm                    UFirma            2
     c                   parm                    UKunde            8 0
     c                   parm                    UKuGRP            8 0
     c                   parm                    ValidExt        512
     c                   parm                    UFlagg            1
      *
     C                   move      *BLANKS       ValidExt
     c                   move      '0'           Uflagg
      *
     c     BrParKey      klist
     c                   kfld                    PABRID           10
     c                   kfld                    PAKUNR
     c                   kfld                    PAID
     c                   Eval      PABRID  = '*KUNDFT*'+UFirma
     c                   Eval      PAKUNR  = *zeros
     C                   Eval      PAID    = 'OLEXT'
      *
      * hent gyldige filtyper..
     C     BrParKey      SETLL     BRPARF
     C     BrParKey      READE     BRPARF                                 33
     C  N33              movel     PAVRDA        ValidExt
     C  N33BrParKey      READE     BRPARF                                 33
     C     *IN33         DOWEQ     '0'
     C                   EVAL      ValidExt = %trim(ValidExt)
     C                             + ' ' +  %trim(PAVRDA)
     C     BrParKey      READE     BRPARF                                 33
     C                   END
      *
      * ER AKTUELL FILEXTENTION OK
      * finn posisjon for siste punktum
     c                   move      *blanks       Extent            5
     c                   move      *zeros        X
     c                   move      *zeros        Y                 3 0
     C     '.'           SCAN      UFile         X                 3 0    33
     c     *IN33         doweq     '1'
     c                   move      X             Y                 3 0
     c                   add       1             X
     C     '.'           SCAN      UFile:X       X                 3 0    33
     c                   end
      * finn extention name Y=startpkt max 5 lang inkl punktum
     c     Y             ifne      *zeros
     C                   EVAL      EXTENT = %SUBST(UFile:Y:5)
     c                   end
      *
     C     ValidExt      Ifne      *blanks
     C     Extent        ifeq      *blanks
     c                   move      '1'           Uflagg
     c                   else
     C     LC:UC         XLATE     ValidExt      ValidExtUC      512
     C     LC:UC         XLATE     Extent        Extent
     C     Extent        SCAN      ValidExtUC    X                 3 0    33
     c  N33              move      '1'           Uflagg
     c                   end
     c                   end
      *
     c                   move      *on           *INLR
     c                   return
