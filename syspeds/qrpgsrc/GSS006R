********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 FEIL VARIABELNAVN
10XXX * 02 YBC PTF10 epost utvidet
10XXX * 03 YBC PTF10 INKL. TRANSIT KAN IKKE KOMBINERER MED GRUPPE
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED PURCHASER                  ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-11 13-24             ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-83 95-97    ***
      ***********************************************************
      *
     FGSSPCL01  IF   E           K DISK
     F                                     RENAME(GSSPCFR:GSSPCFR1)
     FGSSPCF    UF A E           K DISK
     FGSSCNF    UF A E           K DISK
     FGSSBIF    IF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FGSSCGL02  IF   E           K DISK
     FGSSCCF    IF   E           K DISK
     FFAXLK     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FGSS006D   CF   E             WORKSTN
     F                                     SFILE(GSS006DA:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  CBNAB                  1     30
     D  XNAB                   1     26
     D                 DS
s02  D* PCEM                   1     35
n02  D  PCEM                   1     70
     D  WXEM                   1     21
     D                 DS
     D  WXNM                   1     30
     D  XDLT                   1      7
     D                SDS
     D  UUSER                254    263
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     GSS006DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     W2NM          SETLL     GSSPCL01
     C                   READ      GSSPCL01                               94
      *
     C     *IN94         DOWEQ     '0'
     C                   ADD       1             ZRECNO
     C     PCBCD         CHAIN     CDBOAT                             33
     C   33              MOVE      *BLANKS       CBNAB
     C     CBNAB         IFEQ      *BLANKS
     C                   MOVEL     PCNM          WXNM
     C                   ELSE
     C                   MOVEL     CBNAB         WXNM
     C                   END
     C                   WRITE     GSS006DA
     C                   READ      GSSPCL01                               94
     C  N94              END
      *
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C     ZRECNO        IFGT      1
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS006DG
     C                   ELSE
     C                   WRITE     GSS006DB
     C                   EXFMT     GSS006DC
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C***
     C*
     C                   SETOFF                                       9830
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE NY
     C   06              DO
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   GOTO      START5
     C                   END
     C*** SØK FRA
     C   08              GOTO      START6
     C*
     C*** BLA VIDERE
     C   25              GOTO      START3
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
      *
      *** LAGE NY
     C     START5        TAG
     C                   EXFMT     GSS006DD
S03  C*                  MOVEA     '0000000'     *IN(84)
N03  C                   MOVEA     '00000000'    *IN(83)
     C                   SETOFF                                           30
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START5
     C                   END
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C*
     C*** SØK FRA
     C     START6        TAG
     C                   EXFMT     GSS006DE
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     20            POSNBR
     C   12              GOTO      START3
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     WSCG          IFEQ      *BLANKS
     C     WSBCD         CHAIN     CDBOAT                             33
     C  N33              MOVE      CBKN          WSPNO
     C     CUND1K        CHAIN     CUNDL01                            90
     C     *IN90         IFEQ      '0'
     C     WSNM          IFEQ      *BLANKS
     C                   MOVE      KNAVN         WSNM
     C                   END
     C                   ELSE
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        WSPNO
     C                   MOVE      *BLANKS       WSBCD
     C                   MOVE      *BLANKS       WSNM
     C                   END
      *
     C     WSBCD         IFNE      *BLANKS
     C     WSBCD         CHAIN     CDBOAT                             89
     C  N30*IN89         IFEQ      '1'
     C                   MOVE      'GSS0032'     MSGNR
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     45            POSNBR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSCG          IFNE      *BLANKS
     C     WSCG          SETLL     GSSCGL02
     C     WSCG          READE     GSSCGL02                               88
     C  N30*IN88         IFEQ      '1'
     C                   MOVE      'GSS0016'     MSGNR
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   MOVE      '1'           *IN30
     C                   ELSE
     C     WSCG          CHAIN     GSSCCF                             33
     C                   MOVEL     CCDSC         WSNM
     C                   END
     C                   END
      *
     C     WSAUTO        IFEQ      'Y'
     C     WSFAX         COMP      *BLANKS                                87
     C   87WSEM          COMP      *BLANKS                                87
     C  N30*IN87         IFEQ      '1'
     C                   MOVE      'GSS0067'     MSGNR
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
N03   *
N03  C                   IF        WSBCD = *BLANKS AND WSPNO = 0 AND WSTR = 'Y'
N03  C                   IF        *IN30 = *OFF
N03  C                   MOVE      'YBC1990'     MSGNR
N03  C                   Z-ADD     20            LINNBR
N03  C                   Z-ADD     17            POSNBR
N03  C                   MOVE      '1'           *IN30
N03  C                   END
N03  C                   MOVE      '1'           *IN83
N03  C                   END
      *
     C     WSFIR         CHAIN     GSSFIF                             86
     C  N30*IN86         IFEQ      '1'
     C                   MOVE      'GSS0052'     MSGNR
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSLK          IFNE      *BLANKS
     C     WSLK          CHAIN     FAXLK                              36
     C  N30*IN85         IFEQ      '1'
     C                   MOVE      'SPL0001'     MSGNR
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     36            POSNBR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSUSER        COMP      *BLANKS                                84
     C  N30*IN84         IFEQ      '1'
     C                   MOVE      'YBC1845'     MSGNR
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     62            POSNBR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C   30              GOTO      SLTB1
      *
      *** OPPDATERE PÅ REGISTER OG SUBFIL
     C     *IN40         IFEQ      '0'
     C     CNCC          CHAIN     GSSCNF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      CNNO          PCNO
     C                   ADD       1             CNNO
     C                   UPDATE    GSSCNFR
     C                   ELSE
     C                   Z-ADD     1             PCNO
     C                   Z-ADD     2             CNNO
     C                   WRITE     GSSCNFR
     C                   END
     C                   ELSE
     C     PCNO          CHAIN     GSSPCF                             33
     C                   END
     C                   EXSR      MOVWPC
     C     *IN40         IFEQ      '1'
     C                   UPDATE    GSSPCFR
     C                   UPDATE    GSS006DA
     C                   ELSE
     C                   WRITE     GSSPCFR
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   WRITE     GSS006DA
     C                   WRITE     GSS006DB
     C                   END
     C                   EXSR      MOVB2
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS006DA                               98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       14            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      CHGPC
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      DLTPC
     C   12              GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              DO
     C                   MOVE      'GSS0009'     MSGNR
     C                   SETON                                            30
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGPC         BEGSR
     C***********************************************
     C                   EXSR      MOVPCW
     C                   MOVE      '1'           *IN99
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     5             POSNBR
     C     STCHG         TAG
     C                   EXFMT     GSS006DD
S03  C*                  MOVEA     '0000000'     *IN(84)
N03  C                   MOVEA     '00000000'    *IN(83)
     C                   MOVE      '0'           *IN30
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
      *
     C   12              DO
     C                   UPDATE    GSS006DA
     C                   EXSR      MOVB2
     C                   END
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTPC         BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   EXFMT     GSS006DF
     C  N12              DO
     C     PCNO          CHAIN     GSSPCF                             33
     C                   DELETE    GSSPCFR
     C                   EXSR      MOVB1
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    GSS006DA
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWPC        BEGSR
     C***********************************************
     C                   MOVE      WSPNO         PCPNO
     C                   MOVE      WSNM          PCNM
     C                   MOVE      WSBCD         PCBCD
     C*                    MOVE WSTEL     PCTEL
     C                   MOVE      WSFAX         PCFAX
     C                   MOVE      WSEM          PCEM
     C                   MOVE      WSAUTO        PCAUTO
     C                   MOVE      WSCP          PCCP
     C                   MOVE      WSTR          PCTR
     C                   MOVE      WSCG          PCCG
     C                   MOVE      WSPEND        PCPEND
     C                   MOVE      WSFIR         PCFIR
     C                   MOVE      WSLK          PCLK
     C                   MOVE      WSUSER        PCUSER
     C                   MOVE      WSUD1         PCUD1
     C                   MOVE      WSUD2         PCUD2
     C                   MOVE      WSUD3         PCUD3
     C                   MOVE      WSUD4         PCUD4
     C                   MOVE      WSUD5         PCUD5
     C                   MOVE      WSUD6         PCUD6
     C                   MOVE      WSUD7         PCUD7
S01  C*                  MOVE      WSTID         PCTID
N01  C                   MOVE      WSTD          PCTD
     C     PCBCD         CHAIN     CDBOAT                             33
     C   33              MOVE      *BLANKS       CBNAB
     C     CBNAB         IFEQ      *BLANKS
     C                   MOVEL     PCNM          WXNM
     C                   ELSE
     C                   MOVEL     CBNAB         WXNM
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVPCW        BEGSR
     C***********************************************
     C     PCNO          CHAIN(N)  GSSPCF                             33
     C                   MOVE      PCPNO         WSPNO
     C                   MOVE      PCNM          WSNM
     C                   MOVE      PCBCD         WSBCD
     C*                    MOVE PCTEL     WSTEL
     C                   MOVE      PCFAX         WSFAX
     C                   MOVE      PCEM          WSEM
     C                   MOVE      PCAUTO        WSAUTO
     C                   MOVE      PCCP          WSCP
     C                   MOVE      PCTR          WSTR
     C                   MOVE      PCCG          WSCG
     C                   MOVE      PCPEND        WSPEND
     C                   MOVE      PCFIR         WSFIR
     C                   MOVE      PCLK          WSLK
     C                   MOVE      PCUSER        WSUSER
     C                   MOVE      PCUD1         WSUD1
     C                   MOVE      PCUD2         WSUD2
     C                   MOVE      PCUD3         WSUD3
     C                   MOVE      PCUD4         WSUD4
     C                   MOVE      PCUD5         WSUD5
     C                   MOVE      PCUD6         WSUD6
     C                   MOVE      PCUD7         WSUD7
S01  C*                  MOVE      PCTID         WSTID
N01  C                   MOVE      PCTD          WSTD
     C                   SETON                                        40
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        PCNO
     C                   MOVE      *ZEROS        PCPNO
     C                   MOVE      *BLANKS       PCNM
     C                   MOVE      *BLANKS       CBNAB
     C                   MOVE      *BLANKS       WXNM
     C                   MOVE      '*DELETE'     XDLT
     C                   MOVE      *BLANKS       PCBCD
     C                   MOVE      *BLANKS       PCTEL
     C                   MOVE      *BLANKS       PCFAX
     C                   MOVE      *BLANKS       PCEM
     C                   MOVE      *BLANKS       PCAUTO
     C                   MOVE      *BLANKS       PCCP
     C                   MOVE      *BLANKS       PCTR
     C                   MOVE      *BLANKS       PCCG
     C                   MOVE      *BLANKS       PCPEND
     C                   MOVE      *BLANKS       PCFIR
     C                   MOVE      *BLANKS       PCLK
     C                   MOVE      *BLANKS       PCUSER
     C                   MOVE      *BLANKS       PCUD1
     C                   MOVE      *BLANKS       PCUD2
     C                   MOVE      *BLANKS       PCUD3
     C                   MOVE      *BLANKS       PCUD4
     C                   MOVE      *BLANKS       PCUD5
     C                   MOVE      *BLANKS       PCUD6
     C                   MOVE      *BLANKS       PCUD7
S01  C*                  MOVE      *ZEROS        PCTID
N01  C                   MOVE      *ZEROS        PCTD
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *ZEROS        WSPNO
     C                   MOVE      *BLANKS       WSNM
     C                   MOVE      *BLANKS       WSBCD
     C*                    MOVE *BLANKS   WSTEL
s02  C*                  MOVE      *BLANKS       WSFAX
n02  C                   MOVE      *BLANKS       WSFAX            15
     C                   MOVE      *BLANKS       WSLK
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKUNR        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSPNO
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG            1 0
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     5
     C     POSNBR        ANDLE     12
     C                   EXSR      SØKUNR
     C     WSPNO         IFNE      0
     C     CUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      *BLANKS       KNAVN
     C                   END
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     45
     C     POSNBR        ANDLE     49
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSBCD
     C     WSBCD         IFNE      *BLANKS
     C     WSBCD         CHAIN     CDBOAT                             33
     C   33              MOVE      *BLANKS       CBNAB
     C                   END
     C                   Z-ADD     78            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'GSS002R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSCG
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     14
     C     POSNBR        ANDLE     16
     C                   CALL      'GSS004R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSFIR
     C                   Z-ADD     40            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     41
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLK
     C                   PARM                    USPED
     C                   Z-ADD     67            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'GSS0013'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSPNO
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     UUSER         CHAIN     GSSBIF                             33
     C                   MOVE      'Y'           WSAUTO
     C                   MOVE      'N'           WSCP
     C                   MOVE      'N'           WSTR
     C                   MOVE      '2'           WSPEND
     C                   MOVE      BIFC          WSFIR
     C                   MOVE      UUSER         WSUSER
     C                   MOVE      'P'           CNCC
      *
     C                   ENDSR
      *
