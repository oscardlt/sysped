     FPWDINT    IF   E           K DISK
     Flagel01   IF   E           K DISK
     FSNDDST    O  A E             DISK
     D PANSW1          C                   CONST('**Passord mangler**')
     D PANSW2          C                   CONST('**Passord er feil**')
     D PHEA01          C                   CONST('<center><table border=0>-
     D                                     <tr><td><hr size=1 width=250><c-
     D                                     enter><b>')
     D PHEA02          C                   CONST('<font size=+2 color=-
     D                                     "#800040" face="courier new-
     D                                     ">')
     D PHEA03          C                   CONST('UOPPGJORTE POSTER</b-
     D                                     ></center></font><hr size=-
     D                                     1 width=250></td></tr></tab-
     D                                     le>')
     D PHEAA3          C                   CONST('ALLE POSTER</b-
     D                                     ></center></font><hr size=-
     D                                     1 width=250></td></tr></tab-
     D                                     le>')
     D PHEA03b         C                   CONST('<center><table borde-
     D                                     r=2 border cellspacing=5 wi-
     D                                     dth=85%><tr><td bgcolor=yel-
     D                                     low>')
     D pdet03          c                   const('<b>')
     D PHEA03c         C                   CONST('</td></tr></table>')
     D PHEA04          C                   CONST('<center><table borde-
     D                                     r=2 border cellspacing=5 wi-
     D                                     dth=85%><tr>')
     D PHEA05          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Varenr<br>Voucher</b></td>')
     D PHEA06          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Lagernr<br>Vouchertxt-
     D                                     </b></td>')
     D PHEA07          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Beholding>Date</b></td>')
     D PHEA08          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Reservert.<br>Due</b></-
     D                                     td>')
     D PHEA09          C                   CONST('<td bgcolor=lime-
     D                                     ><b>Til utlevering<br>Cur</b></-
     D                                     td>')
     D*PHEA10          C                   CONST('<td bgcolor=lime-
     D*                                    ><b>Belop<br>Amount</b></-
     D*                                    td></tr>')
     D PDET01S         C                   CONST('<tr><td align=right>')
     D PDET03S         C                   CONST('<td align=right>')
     D PDET04S         C                   CONST('<td align=right bgcolor-
     D                                     =red>')
     D PDET02S         C                   CONST('<td>')
     D PDET01E         C                   CONST('</td>')
     D PDET02E         C                   CONST('</td></tr>')
     D PDETE           C                   CONST('</td></tr></table><br>')
     D                 DS
     D  restva                 1     11
     D  restvd                 9     11
     D  restvh                 1      8
     D  rv                     1     11
     D                                     DIM(11)                              Output string
     D                 DS
     D  belhel                 1      8
     D  komma                 10     10
     D  beldes                11     13
     D  plumin                14     14
     D  nybel                  1     14
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      TESTMO
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *************************************************************
     C     SRA           BEGSR
      *************************************************************
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     QTYPE         PARM      QTYPE         QTYPE             3
     C     QVALUE        PARM      QVALUE        QVALUE           15
     C     QPWD          PARM      QPWD          QPWD              6
     C     TCPJN         PARM      TCPJN         TCPJN             1
     c                   parm                    firma             2
     c                   parm                    vare             15
     c                   movel     qvalue        qvalu4            4
      *__________________
      * Define Nøkler
      *""""""""""""""""""
     C     lagkey        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    varenr
     C                   MOVE      X'0D'         RDATA
     C                   MOVE      ','           komma
      *__________________
      * Define Workfields
      *""""""""""""""""""
     C                   ENDSR
      *
     C     TESTMO        BEGSR
      *
      *passordkontroll av bruker
     C     QPWD          CHAIN     PWDINT                             63
     C     *IN63         IFEQ      '1'
     C*passord feil
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      'N'           PWDK              1
     C                   GOTO      FEILP
     C                   END
      *heading
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA01        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA02        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA04        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA05        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA06        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA07        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA08        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PHEA09        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C* Les lagerbeholdning
     C     lagkey        SETLL     lagel01
     C     *IN33         DoUEQ     '1'
     C     lagkey        READE     lagel01                                33
     c*
     c*varenr
     c*
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdet01s:1     RDATA
     C     RDATA         CAT       varenr:1      RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   move      *blanks       rdata
     c* lagernummer
     C     RDATA         CAT       pdet02s:1     RDATA
     C     RDATA         CAT       lagnr:1       RDATA
     C     RDATA         CAT       pdet01e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     c* beholdning
     c*
     c                   move      *blanks       rdata
     c                   move      behold        restva
     c     1             do        9             xx                2 0
     c     rv(xx)        ifeq      '0'
     c                   move      ' '           rv(xx)
     c                   else
     c                   goto      ut2
     c                   end
     c                   end
     c     ut2           tag
     c                   move      restvh        belhel
     c                   move      restvd        beldes
     c                   move      ' '           plumin
     c     behold        iflt      *zeros
     c                   move      '-'           plumin
     c                   end
     C     RDATA         CAT       pdet03s:1     RDATA
     C     RDATA         CAT       nybel:1       RDATA
     C     RDATA         CAT       pdet02e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     c* reservert
     c*
     c                   move      *blanks       rdata
     c                   move      reserv        restva
     c     1             do        9             xx                2 0
     c     rv(xx)        ifeq      '0'
     c                   move      ' '           rv(xx)
     c                   else
     c                   goto      ut3
     c                   end
     c                   end
     c     ut3           tag
     c                   move      restvh        belhel
     c                   move      restvd        beldes
     c                   move      ' '           plumin
     c     reserv        iflt      *zeros
     c                   move      '-'           plumin
     c                   end
     C     RDATA         CAT       pdet03s:1     RDATA
     C     RDATA         CAT       nybel:1       RDATA
     C     RDATA         CAT       pdet02e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     c* til utlevering
     c*
     c                   move      *blanks       rdata
     c                   move      utlev         restva
     c     1             do        9             xx                2 0
     c     rv(xx)        ifeq      '0'
     c                   move      ' '           rv(xx)
     c                   else
     c                   goto      ut4
     c                   end
     c                   end
     c     ut4           tag
     c                   move      restvh        belhel
     c                   move      restvd        beldes
     c                   move      ' '           plumin
     c     utlev         iflt      *zeros
     c                   move      '-'           plumin
     c                   end
     C     RDATA         CAT       pdet03s:1     RDATA
     C     RDATA         CAT       nybel:1       RDATA
     C     RDATA         CAT       pdet02e:1     RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
     c* slutt løkke
     c                   move      *blanks       rdata
     C     RDATA         CAT       pdete:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C     FEILP         ENDSR
