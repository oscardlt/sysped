     C*
     C                   EXSR      INIT
     C*
     C                   EXSR      DUPLIK
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     c                   parm                    UAVD              4 0
     c                   parm                    UOPD              7 0
     c                   parm                    UFFLk             2
     c                   parm                    UFFSte            5
     c                   parm                    UFFDt             8 0
     c                   parm                    UFFKl             4 0
     c                   parm                    UFFAvd            4 0
     c                   parm                    UFFOty            2
     c                   parm                    UFFBiln          10
     c                   parm                    UFFTran           8 0
     c                   parm                    UFFbel           11 2
     c                   parm                    UFFbeAE           1
     c                   parm                    UFFbeTX          35
     c                   parm                    UFFLedig        100
     c                   parm                    UVFLk             2
     c                   parm                    UVFSte            5
     c                   parm                    UVFDt             8 0
     c                   parm                    UVFKl             4 0
     c                   parm                    UVFAvd            4 0
     c                   parm                    UVFOty            2
     c                   parm                    UVFBiln          10
     c                   parm                    UVFTran           8 0
     c                   parm                    UVFbel           11 2
     c                   parm                    UVFbeAE           1
     c                   parm                    UVFbeTX          35
     c                   parm                    UVFLedig        100
     C                   ENDSR
      *
      *
      *
     C***********************************************
     C     DUPLIK        BEGSR
     C***********************************************
      *
     C                   MOVE      'N'           DUPOPD            1
     C                   MOVE      XNYGML        YNYGML            2
     C     KEYTRG        KLIST
     C                   KFLD                    HEAVDG
     C                   KFLD                    HEOPDG
     C                   MOVE      WSAVD         HEAVDG            4 0
     C                   MOVE      WSOPD         HEOPDG            7 0
     C                   MOVE      WSPRO         HEPROG            8 0
     C                   MOVE      WSSG          HESGG             3
     C                   move      HEPRO         GMTURA            8
     C                   movel     HEHAWB        GMBILA            8
      *
     C                   MOVE      HEFR          WSFRFF
     C                   MOVE      HEFR          WSFRVT
      *
      * HENT EVT. FORFRAKT VIA REKVISISJON.
     C                   MOVE      *BLANKS       WSFFBN
     C                   MOVE      *ZEROS        WSFFTN
     C                   MOVE      *ZEROS        XXFFLN            8 0
     C                   MOVE      *ZEROS        WSFFBL
     C                   MOVE      ' '           WSFFAE
     C                   MOVE      *BLANKS       WSFFTX
     C                   MOVE      'FF'          XXSLAG
     C     TRIKEY        CHAIN     HETRIU                             34
     C     *IN34         IFEQ      '0'
     C     TIBURF        ANDNE     *ZEROS
     C     TIBURF        CHAIN(N)  KOSBU                              34
     C     *IN34         IFEQ      '0'
     C                   MOVE      BUBILN        WSFFBN
     C                   MOVE      BUTNR         WSFFTN
     C                   MOVE      BULNR         XXFFLN
     C                   MOVE      BUBL          WSFFBL
     C                   MOVE      BUTYPE        WSFFAE
     C                   MOVE      BUTXT         WSFFTX
     C                   END
     C                   END
      * HENT EVT. VIDEREFR VIA REKVISISJON.
     C                   MOVE      *BLANKS       WSVFBN
     C                   MOVE      *ZEROS        WSVFTN
     C                   MOVE      *ZEROS        XXVFLN            8 0
     C                   MOVE      *ZEROS        WSVFBL
     C                   MOVE      ' '           WSVFAE
     C                   MOVE      *BLANKS       WSVFTX
     C                   MOVE      'VF'          XXSLAG
     C     TRIKEY        CHAIN     HETRIU                             34
     C     *IN34         IFEQ      '0'
     C     TIBURF        ANDNE     *ZEROS
     C     TIBURF        CHAIN(N)  KOSBU                              34
     C     *IN34         IFEQ      '0'
     C                   MOVE      BUBILN        WSVFBN
     C                   MOVE      BUTNR         WSVFTN
     C                   MOVE      BULNR         XXVFLN
     C                   MOVE      BUBL          WSVFBL
     C                   MOVE      BUTYPE        WSVFAE
     C                   MOVE      BUTXT         WSVFTX
     C                   END
     C                   END
      *
      *  VERDIENE MÅ TIL WS-VARIABLER FØR FF/VF-OPPDRAG CHAINES
     C                   MOVE      TRAVD1        WSAVD1
     C                   MOVE      TROPD1        WSOPD1
     C                   MOVE      TRAVD2        WSAVD2
     C                   MOVE      TROPD2        WSOPD2
      *  91 ON - PROTECTES (ER TATT HÅND OM/SKAL IKKE TAS HÅND OM)
     C     WSAVD1        COMP      *ZEROS                             91
     C  N91WSSDFF        COMP      *BLANKS                                91
     C  N91
     CAN 42WPPNS3        COMP      *BLANKS                                91
     C  N91WSSTAF        COMP      *BLANKS                            9191
     C     WSOPD1        IFNE      *ZEROS
     C                   MOVE      WSAVD1        XDUAVD
     C                   MOVE      WSOPD1        XDUOPD
     C                   MOVE      *ZEROS        XXFALI
     C                   MOVE      *ZEROS        WSFFBL
     C     FFKEY         SETLL     FAKT
     C     FFKEY         READE(N)  FAKT                                   31
     C     *IN31         DOWEQ     '0'
      * AKKUMULER ILINJER (MEN IKKE STATISTISKE MOTLINJER-DUP PÅ DUP)
     C     FASK          IFEQ      'I'
     C     FAKDA         ANDNE     'I'
     C                   ADD       FABELN        WSFFBL
     C                   END
     C     FFKEY         READE(N)  FAKT                                   31
     C                   END
      *
     C     FFKEY         CHAIN(N)  HEADF                              31
     C     *IN31         IFEQ      '0'
     C                   MOVE      HEUR          WSURF
     C                   MOVE      HEOT          WSOTFF
     C                   MOVE      HEFR          WSFRFF
     C                   MOVE      HEKDPL        WSPKFF
     C                   MOVE      HENAK         WSLNAV
     C                   MOVEL     HEHAWB        WSFFBN
     C                   END
     C                   END
      *  92 ON - PROTECTES (ER TATT HÅND OM/SKAL IKKE TAS HÅND OM)
     C     WSAVD2        COMP      *ZEROS                             92
     C  N92WSSDVT        COMP      *BLANKS                                92
     C  N92
     CAN 42WPPNS4        COMP      *BLANKS                                92
     C  N92WSSTAE        COMP      *BLANKS                            9292
      * Vis pris på evt dupoppdrag
     C     WSOPD2        IFNE      *ZEROS
     C                   MOVE      WSAVD2        XDUAVD
     C                   MOVE      WSOPD2        XDUOPD
     C                   MOVE      *ZEROS        XXFALI
     C                   MOVE      *ZEROS        WSVFBL
     C     VFKEY         SETLL     FAKT
     C     VFKEY         READE(N)  FAKT                                   31
     C     *IN31         DOWEQ     '0'
      * AKKUMULER ILINJER (MEN IKKE STATISTISKE MOTLINJER-DUP PÅ DUP)
     C     FASK          IFEQ      'I'
     C     FAKDA         ANDNE     'I'
     C                   ADD       FABELN        WSVFBL
     C                   END
     C     VFKEY         READE(N)  FAKT                                   31
     C                   END
      *
     C     VFKEY         CHAIN(N)  HEADF                              31
     C     *IN31         IFEQ      '0'
     C                   MOVE      HEUR          WSURE
     C                   MOVE      HEOT          WSOTVT
     C                   MOVE      HEFR          WSFRVT
     C                   MOVE      HEKDPL        WSPKVT
     C                   MOVE      HENAS         WSHNAV
     C                   MOVEL     HEHAWB        WSVFBN
     C                   END
     C                   END
      * HAR CHAINET INNH. OG/ELLER UTKJ.OPPDRAG. HENT INN IGJEN HOVED..
     C     WSOPD1        IFNE      *ZEROS
     C     WSOPD2        ORNE      *ZEROS
     C     KEYTRG        CHAIN(N)  HEADF                              31
     C                   END
      * VIS NAVN...
     C                   MOVE      *BLANKS       XXPNS1           14
     C                   MOVE      *BLANKS       XXPNS2           12
     C                   MOVE      *BLANKS       XXPNS3           12
     C                   MOVE      *BLANKS       XXPNS4           10
     C     *IN42         IFEQ      '1'
     C                   MOVE      WPPNS1        XXPNS1
     C                   MOVE      WPPNS2        XXPNS2
     C                   MOVE      WPPNS3        XXPNS3
     C                   MOVE      WPPNS4        XXPNS4
     C     WPPNS3        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       XXPNS1
     C                   END
     C     WPPNS4        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       XXPNS2
     C                   END
     C                   ELSE
     C     WSSDFF        IFNE      *BLANKS
     C     WSSDF         CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS1
     C     WSSDFF        CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS3
     C                   END
     C     WSSDVT        IFNE      *BLANKS
     C     WSSDVT        CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS4
     C     WSSDT         CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS2
     C                   END
     C                   END
     C                   MOVEL     XXPNS1        DXPNS1           10
     C                   MOVEL     XXPNS2        DXPNS2           10
     C                   MOVEL     XXPNS3        DXPNS3           10
     C                   MOVEL     XXPNS4        DXPNS4           10
      *
      * 34 ON= IKKE FORFRAKT/INNHENTING  35 ON=IKKE VIDEREFRAKT/UTKJ.
     C     WSSDFF        COMP      *BLANKS                                34
     C     WSSDVT        COMP      *BLANKS                                35
      * hent innl-avd via postnr
     c                   If        DUPINL = 'J'
     c                   If        (WSSDFF<>*blanks and WSAVD1=*zeros)
     c                             or (WSSDVT<>*blanks and WSAVD2=*zeros)
     c                   exsr      GetDupAvd
     c                   endif
     c                   endif
      *
     C  N91              Z-ADD     6             LINNBR
     C   91              Z-ADD     13            LINNBR
     C                   Z-ADD     49            POSNBR
      *
     C     *IN91         IFEQ      '0'
     C     *IN92         OREQ      '0'
     C     KEYFTG        KLIST
     C                   KFLD                    HEAVDG
     C                   KFLD                    HEOPDG
     C                   END
      *
     C                   MOVE      *ZEROS        XXFFBLM           9 2
     C                   MOVE      *ZEROS        XXVFBLM           9 2
      *
     C     STDUP         TAG
     C     WSURF         IFEQ      *BLANKS
     C                   MOVEL     'H'           WSURF
     C                   END
     C     WSURE         IFEQ      *BLANKS
     C                   MOVEL     'H'           WSURE
     C                   END
     C     WSHNAV2       IFEQ      *BLANKS
     C     WSHNAV1       ANDNE     *blank
     C     KODTEKH       CHAIN     KOTMR                              31
     C  N31              MOVE      KOTMNV        WSHNAV
     C                   END
     C     WSLNAV2       IFEQ      *BLANKS
     C     WSLNAV1       ANDNE     *blank
     C     KODTEKL       CHAIN     KOTMR                              31
     C  N31              MOVE      KOTMNV        WSLNAV
     C                   END
     C                   EXFMT     BILDE03
      * FF
     C     WSAVD1        IFNE      0
     C     KODTA1        CHAIN     KOAR                               31
     C     *IN31         IFEQ      *OFF
     C     KODTAK        CHAIN     KOAR                               31
     C                   ENDIF
     C                   ENDIF
      * VF
     C     WSAVD2        IFNE      0
     C     KODTA2        CHAIN     KOAR                               31
     C     *IN31         IFEQ      *OFF
     C     KODTAK        CHAIN     KOAR                               31
     C                   ENDIF
     C                   ENDIF
     C                   SETOFF                                       30
     C   12              SETOFF                                       989192
     C   12              GOTO      UTDUPS
     C                   SETOFF                                       98
     C*
     C     *IN04         IFEQ      '1'
     C   91
     CAN 92              GOTO      STDUP
     C                   EXSR      SOKDUP
     C                   GOTO      STDUP
     C                   END
     C*
      * HVIS BEGGE ALT ER TATT HÅND OM - HOPP UT ETTER AT BILDE VIST.
     C   91
     CAN 92              GOTO      UTDUPS
      *
     C*
     C* TESTER AT TASTET AVDELING HAR TELLER
     C*
     C  N91WSAVD1        IFNE      *ZEROS
     C     WSAVD1        CHAIN(N)  TELL                               98
     C   98AVDZER        CHAIN(N)  TELL                               98
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     49            POSNBR
     C   98              MOVE      'SPA0001'     MSGNR2
     C   98              SETON                                        30
     C   98              GOTO      STDUP
      *
     C  N98KODOTF        CHAIN     KOOTYR                             98
     C  N98KODO2F        CHAIN     KOOT2R                             98
     C   98              MOVE      'SPO0007'     MSGNR2
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     54            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      STDUP
      *
     C                   MOVEL     WSPKFF        KFKOD
N04  C                   EVAL      YKFTYP = 'PRODTYPE'
     C     KUFASK        CHAIN     KUFAST                             98
     C   98              MOVE      'YBC0360'     MSGNR2
     C   98              Z-ADD     7             LINNBR
     C   98              Z-ADD     55            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      STDUP
      *
     C     KODFRF        CHAIN     KOFRR                              98
     C   98              MOVE      'SPF0006'     MSGNR2
     C   98              Z-ADD     7             LINNBR
     C   98              Z-ADD     64            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      STDUP
     C                   MOVE      KO2FB         FKO2FB            1
     C                   MOVE      KO2FPS        FO2FPS            1
     C                   MOVE      KO2KK         FKO2KK            1
     C                   MOVE      KO2TI         FKO2TI            1
     C                   MOVE      KO2FI         FKO2FI            1
     C                   MOVE      KO2TE         FKO2TE            1
      *
     C                   END
      *
     C  N91WSFFBN        IFNE      *BLANKS
     C     WSFFTN        ORNE      *ZEROS
      * ikke tillat med Rekv hvis dup (avd) er valgt
     C     WSAVD1        Ifne      *zeros
     C                   MOVE      'JOV1373'     MSGNR2
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   SETON                                        3098
     C                   GOTO      STDUP
     c                   end
     C     WSFFTN        IFEQ      *ZEROS
     C     WSFFBN        CHAIN     UNITL01                            98
     C  N98              MOVE      UNTRAN        WSFFTN
     C                   END
     C                   MOVE      WSFFTN        TRANUM
     C     TRAKEY        CHAIN     TRAN                               98
     C     *IN98         IFEQ      '0'
     C                   MOVE      VMTRLE        XXFFLN
     C                   ELSE
     C                   MOVE      'JOV0704'     MSGNR2
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     60            POSNBR
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
     C*
     C  N92WSAVD2        IFNE      *ZEROS
     C     WSAVD2        CHAIN(N)  TELL                               98
     C   98AVDZER        CHAIN(N)  TELL                               98
     C   98              MOVE      'SPA0001'     MSGNR2
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     49            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      STDUP
      *
     C  N98KODOTV        CHAIN     KOOTYR                             98
     C  N98KODO2V        CHAIN     KOOT2R                             98
     C*                    Z-ADD12        LINNBR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     54            POSNBR
     C   98              MOVE      'SPO0007'     MSGNR2
     C   98              SETON                                        30
     C   98              GOTO      STDUP
      *
     C                   MOVEL     WSPKVT        KFKOD
N04  C                   EVAL      YKFTYP = 'PRODTYPE'
     C     KUFASK        CHAIN     KUFAST                             98
     C   98              MOVE      'YBC0360'     MSGNR2
     C   98              Z-ADD     4             LINNBR
     C   98              Z-ADD     55            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      STDUP
      *
     C     KODFRV        CHAIN     KOFRR                              98
     C   98              MOVE      'SPF0006'     MSGNR2
     C   98              Z-ADD     14            LINNBR
     C   98              Z-ADD     64            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      STDUP
     C                   MOVE      KO2FB         VKO2FB            1
     C                   MOVE      KO2FPS        VO2FPS            1
     C                   MOVE      KO2KK         VKO2KK            1
     C                   MOVE      KO2TI         VKO2TI            1
     C                   MOVE      KO2FI         VKO2FI            1
     C                   MOVE      KO2TE         VKO2TE            1
     C                   END
      *
     C  N92WSVFBN        IFNE      *BLANKS
     C     WSVFTN        ORNE      *ZEROS
      * ikke tillat med Rekv hvis dup (avd) er valgt
     C     WSAVD2        Ifne      *zeros
     C                   MOVE      'JOV1373'     MSGNR2
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     49            POSNBR
     C                   SETON                                        3098
     C                   GOTO      STDUP
     c                   end
     C     WSVFTN        IFEQ      *ZEROS
     C     WSVFBN        CHAIN     UNITL01                            98
     C  N98              MOVE      UNTRAN        WSVFTN
     C                   END
     C                   MOVE      WSVFTN        TRANUM
     C     TRAKEY        CHAIN     TRAN                               98
     C     *IN98         IFEQ      '0'
     C                   MOVE      VMTRLE        XXVFLN
     C                   ELSE
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     60            POSNBR
     C                   MOVE      'JOV0704'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
      *
      * BEREGN DUP-FRAKT OM DEN IKKE ALT ER SATT
     C     *IN42         IFEQ      *ON
     C  N91WSAVD1        IFNE      *ZEROS
     C     WSFFBL        ANDEQ     *ZEROS
     C     WSFFAE        ANDNE     'A'
     C     WSFFAE        ANDNE     'E'
     C                   MOVE      'F'           DUPTYP            1
     C                   EXSR      BERDUP
     C     UUBELØ        IFNE      *ZEROS
     C                   Z-ADD     UUBELØ        WSFFBL
     C                   Z-ADD     UUBELØ        XXFFBLM
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'JOV1298'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
      *
     C  N92WSAVD2        IFNE      *ZEROS
     C     WSVFBL        ANDEQ     *ZEROS
     C     WSVFAE        ANDNE     'A'
     C     WSVFAE        ANDNE     'E'
     C                   MOVE      'V'           DUPTYP            1
     C                   EXSR      BERDUP
     C     UUBELØ        IFNE      *ZEROS
     C                   Z-ADD     UUBELØ        WSVFBL
     C                   Z-ADD     UUBELØ        XXVFBLM
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'JOV1299'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
     C                   END
      *
      * (FLYTTET ETTER ALLE TESTER...)
     C* GÅR TIL START HVIS INGEN F-TAST ER BENYTTET
     C*
     C  N03
     CANN05
     CANN16              GOTO      STDUP
     C*
     C* FORSOKER Å AVSLUTTE UTEN Å PLASSERE PÅ AVD  (ELLER PÅ REKV)
     C*
     C  N91WSFFBN        IFNE      *BLANKS
     C     WSFFTN        ORNE      *ZEROS
     C                   MOVE      'FF'          XXSLAG
     C                   EXSR      KOST
     C                   ELSE
     C  N91WSAVD1        IFEQ      *ZEROS
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   MOVE      'JOV0705'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
      *
     C  N92WSVFBN        IFNE      *BLANKS
     C     WSVFTN        ORNE      *ZEROS
     C                   MOVE      'VF'          XXSLAG
     C                   EXSR      KOST
     C                   ELSE
     C  N92WSAVD2        IFEQ      *ZEROS
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     49            POSNBR
     C                   MOVE      'JOV0705'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
     C*
     C                   MOVE      'N'           DIN03             1
     C                   MOVE      'N'           DIN05             1
     C                   MOVE      'N'           DIN16             1
     C   03              MOVE      'J'           DIN03
     C   05              DO
     C                   MOVE      'J'           XIN05             1
     C                   SETON                                        03
     C                   SETOFF                                       05
     C                   MOVE      'J'           DIN03             1
     C                   END
     C   16              MOVE      'J'           DIN16
     C*
     C**********************************************
     C* OPPDATERER FORTRANSPORT DUPLIKATOPPDRAG
     C**********************************************
     C*
     C  N91WSAVD1        IFNE      *ZEROS
     C                   EXSR      MOVWHF
     C     WSAVD1        CHAIN     TELL                               33
     C   33AVDZER        CHAIN     TELL                               33
     C                   MOVE      TEOPDN        WSOPD
     C                   ADD       1             TEOPDN
     C     TEOPDN        IFEQ      0
     C                   Z-ADD     1             TEOPDN
     C                   END
     C                   UPDATE    TELLR
     C* DATA SOM SKAL BYTTES
     C                   MOVE      WSOTFF        HEOT
     C                   MOVE      WSFRFF        HEFR
     C                   MOVE      WSPKFF        HEKDPL
     C     WSLNAV        IFNE      *BLANKS
     C                   MOVE      WSLNAV        HENAK
     C                   MOVE      *BLANKS       HEADK1
     C                   MOVE      *BLANKS       HEADK2
     C                   MOVE      *BLANKS       HEADK3
     C                   END
     C                   MOVE      WSSDFF        HESDT
     C   42              MOVE      WPLAN1        HETRI
     C  N42              MOVE      WSLAN1        HETRI
     C                   MOVE      UDATOC        TRSDTD
     C                   MOVE      WSSFFK        TRSDTK
     C                   MOVE      *BLANKS       HELKS
     C                   MOVE      *BLANKS       HELKK
     C                   MOVE      *BLANKS       HESDFF
     C                   MOVE      *ZEROS        TRSFFD
     C                   MOVE      *ZEROS        TRSFFK
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVE      *ZEROS        TRSVTD
     C                   MOVE      *ZEROS        TRSVTK
     C                   MOVE      ' '           TRMVA
     C                   MOVE      *ZEROS        HEPRO
     C*
     C     HELKA         IFEQ      FILAND
     C                   MOVE      UDATOA        HEDTOP
     C                   ELSE
     C                   MOVE      UDATOB        HEDTOP
     C                   END
     C                   MOVE      WSOPD         HEOPD
     C                   MOVE      WSOPD         WSOPD1
     C                   MOVE      'H'           HEUR
     C                   MOVE      WSURF         HEUR
     C                   Z-ADD     0             HENTF
     C                   MOVE      WSAVD1        HEAVD
     C                   MOVE      WSAVD1        WSAVD
     C                   MOVE      *ZEROS        HESTD
     C                   MOVE      *ZEROS        HEDTMP
     C                   MOVE      *ZEROS        HEDTÅP
     C                   MOVE      *ZEROS        HEDTCP
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C                   MOVE      ' '           HEKDTM
     C                   MOVE      *ZEROS        HEFBK
     C                   MOVE      *ZEROS        HEVN
     C                   MOVE      ' '           HEKDKK
     C                   MOVE      *ZEROS        HEFNGK
     C                   MOVE      *ZEROS        HEFNGS
     C                   MOVE      ' '           HEPK8
     C                   MOVE      ' '           HEPK9
     C                   MOVE      FKO2FB        HEPK1
     C                   MOVE      FO2FPS        HEPK2
     C                   MOVE      FKO2KK        HEPK3
     C                   MOVE      FKO2TI        HEPK4
     C                   MOVE      FKO2FI        HEPK5
     C                   MOVE      FKO2TE        HEPK6
     C                   MOVE      'N'           HEPK7
     C                   MOVE      'N'           HEPK8
     C                   MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       HEDTMO
     C                   MOVE      *Zeros        HEKLMO
     C                   MOVE      *BLANKS       HEGNN
     C                   MOVE      ' '           HEST
     C                   MOVE      'DUP'         HESG
     C                   MOVEL     HESGG         HELB
     C                   MOVE      *BLANKS       HEPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   MOVE      *BLANKS       HEGN
     C                   MOVE      *BLANKS       HETLE
     C                   MOVE      *BLANKS       HETLL
     C                   MOVE      *BLANKS       HETLKU
     C                   MOVE      *BLANKS       HEHAWB
     c                   MOVE      *BLANKS       HEVALS
     c                   MOVE      *BLANKS       HEVALK
     C                   MOVE      *zeros        HEKNT
     C*
     C*   BYTTER  FAKTURAMOTTAGER
     C*
     C     TRKDFF        IFEQ      'S'
     C                   MOVE      KOAKNR        HEKNSF
     C                   MOVE      *ZEROS        HEKNKF
     C                   ELSE
     C                   MOVE      KOAKNR        HEKNKF
     C                   MOVE      *ZEROS        HEKNSF
     C                   END
     C*FLYTTET OPP LINJER FRA NEDE I RUTINEN
     C*
     C* OPPADSTIGENDE REFERANSE I EGNE DATAFELT
     C* AVD0/OPD0 - REF TIL MODEROPPDRAG (SOM GJERNE OGSÅ KAN VÆRE DUP)
     C                   MOVE      'FF'          TRSLAG
     C                   MOVE      HEAVDG        TRAVD0
     C                   MOVE      HEOPDG        TROPD0
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      ' '           TRSTAF
     C                   MOVE      ' '           TRSTAE
     C                   EXSR      OPDHTD
     C                   MOVE      ULDT          HEDTR
     C                   WRITE     HEADFR
N19  C                   CALL      'SYGE86'
N19  C                   PARM                    HEAVDG
N19  C                   PARM                    HEOPDG
N19  C                   PARM                    HEAVD
N19  C                   PARM                    HEOPD
     C     XKOPI         IFEQ      'J'
     C                   EXSR      MERKPI
     C                   END
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
      * DUPLISER FRITEKST????
     C     KEYFTG        CHAIN     FREETXT2                           31
     C     *IN31         DOWEQ     '0'
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
     C                   WRITE     FREETX2R
     C     KEYFTG        READE     FREETXT2                               31
     C                   END
      * FRITEKST TIL OPPDRAG
     C     WSFRD1        IFEQ      'J'
     C                   EXSR      VISFRE
     C                   END
     C* VED POSTNR.BASERT - LEGG UT OGSÅ POST MED STEDSNAVN
     C   42              DO
     C                   CLEAR                   HESTEDR
     C                   MOVE      HEAVD         HSAVD
     C                   MOVE      HEOPD         HSOPD
     C                   MOVEL     WPPNS1        HSFROM
     C                   MOVEL     WPPNS3        HSTO
     C                   WRITE     HESTEDR
     C                   END
     C* WP/WS... KEY I POSTAL ...
     C   42              MOVE      WPLANT        GMLK              2
     C   42              MOVE      WSSDT         GMSD              5
     C   42              MOVE      WPLAN1        WPLANT
     C   42              MOVE      WSSDFF        WSSDT
     C                   EXSR      OPDDIS
     C   42              MOVE      GMLK          WPLANT
     C   42              MOVE      GMSD          WSSDT
     C* Send varsel til USER-profiles knyttet til avdelingen
     C                   EXSR      SNDMSG
     C                   MOVE      'J'           DUPOPD
     C                   MOVE      'NY'          XNYGML
     C                   EXSR      FAKTUR
     C                   MOVE      YNYGML        XNYGML
     C* LEGG UT DUMMY REKVISISJON FOR Å LETTE SENERE SPØRRING
     C                   EXSR      DUMREK
     C                   END
     C*
     C* SLUTT DUPLIKATOPPDRAG FOR FORFRAKT
     C*
     C*
     C**********************************************
     C* OPPDATERER VIDERETRANSPORT DUPLIKATOPPDRAG
     C*
     C  N92WSAVD2        IFNE      *ZEROS
      * SIKRE AT ALLE HEADF/HEADTR OPPL ER OK HVIS OGSÅ FF.ER LAGT UT..
     C     DUPOPD        IFEQ      'J'
     C     KEYTRG        CHAIN(N)  HEADF                              98
     C                   END
     C                   EXSR      MOVWHF
     C     WSAVD2        CHAIN     TELL                               33
     C   33AVDZER        CHAIN     TELL                               33
     C                   MOVE      TEOPDN        WSOPD
     C                   ADD       1             TEOPDN
     C     TEOPDN        IFEQ      0
     C                   Z-ADD     1             TEOPDN
     C                   END
     C                   UPDATE    TELLR
     C* DATA SOM SKAL BYTTES
     C                   MOVE      WSOTVT        HEOT
     C                   MOVE      WSFRVT        HEFR
     C                   MOVE      WSPKVT        HEKDPL
     C     WSHNAV        IFNE      *BLANKS
     C                   MOVE      WSHNAV        HENAS
     C                   MOVE      *BLANKS       HEADS1
     C                   MOVE      *BLANKS       HEADS2
     C                   MOVE      *BLANKS       HEADS3
     C                   END
     C                   MOVE      WSSDVT        HESDF
     C   42              MOVE      WPLAN2        HELKA
     C  N42              MOVE      WSLAN2        HELKA
     C                   MOVE      UDATOD        TRSDFD
     C                   MOVE      WSSVTK        TRSDFK
     C                   MOVE      UDATOB        TRSDTD
     C                   MOVE      WSSDTK        TRSDTK
     C                   MOVE      *BLANKS       HELKS
     C                   MOVE      *BLANKS       HELKK
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVE      *ZEROS        TRSVTD
     C                   MOVE      *ZEROS        TRSVTK
     C                   MOVE      *BLANKS       HESDFF
     C                   MOVE      *ZEROS        TRSFFD
     C                   MOVE      *ZEROS        TRSFFK
     C                   MOVE      ' '           TRMVA
     C                   MOVE      *ZEROS        HEPRO
     C*
     C                   MOVE      WSOPD         HEOPD
     C                   MOVE      WSOPD         WSOPD2
     C                   MOVE      'H'           HEUR
     C                   MOVE      WSURE         HEUR
     C                   Z-ADD     0             HENTF
     C                   MOVE      WSAVD2        HEAVD
     C                   MOVE      WSAVD2        WSAVD
     C                   MOVE      *ZEROS        HESTD
     C                   MOVE      *ZEROS        HEDTMP
     C                   MOVE      *ZEROS        HEDTÅP
     C                   MOVE      *ZEROS        HEDTCP
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C                   MOVE      ' '           HEKDTM
     C                   MOVE      *ZEROS        HEFBK
     C                   MOVE      *ZEROS        HEVN
     C                   MOVE      ' '           HEKDKK
     C                   MOVE      *ZEROS        HEFNGK
     C                   MOVE      *ZEROS        HEFNGS
     C                   MOVE      ' '           HEPK8
     C                   MOVE      ' '           HEPK9
     C                   MOVE      VKO2FB        HEPK1
     C                   MOVE      VO2FPS        HEPK2
     C                   MOVE      VKO2KK        HEPK3
     C                   MOVE      VKO2TI        HEPK4
     C                   MOVE      VKO2FI        HEPK5
     C                   MOVE      VKO2TE        HEPK6
     C                   MOVE      'N'           HEPK7
     C                   MOVE      'N'           HEPK8
     C                   MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       HEDTMO
     C                   MOVE      *Zeros        HEKLMO
     C                   MOVE      *BLANKS       HEGNN
     C                   MOVE      ' '           HEST
     C                   MOVE      'DUP'         HESG
     C                   MOVEL     HESGG         HELB
     C                   MOVE      *BLANKS       HEPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   MOVE      *BLANKS       HEGN
     C                   MOVE      *BLANKS       HETLE
     C                   MOVE      *BLANKS       HETLL
     C                   MOVE      *BLANKS       HETLKU
     C                   MOVE      *BLANKS       HEHAWB
     C                   MOVE      *zeros        heknt
     c                   MOVE      *BLANKS       HEVALS
     c                   MOVE      *BLANKS       HEVALK
      * VF-Dup til Innlans distr-avd..  - avsender av xxxxx c/o dupavdelingens k.nr
     C     KODTA2        CHAIN     KOAR                               31
     C                   IF        KOAIE = '1'
     c                   if        HXSNDN = *blanks
     C                   call      'SYGE15'
     C                   parm                    HXSNDN
     C                   endif
     C     FIRAVD        CHAIN     CUNDL01                            34
     C     *IN34         IFEQ      '0'
     c                   eval      HENAS = %subst(HENAS:1:15) + ' c/o:'
     c                             + FIKRTN
     c                   eval      HEADS1= ADR1
     c                   eval      HEADS2= *blanks
     c                   movel     POSTNR        HEADS3
     c                   eval      HEADS3= %subst(HEADS3:1:4) +' '+ADR3
     C                   endif
     C                   ENDIF
      * flytt ovetr kolli-IDs til utkj.oppdraget ubetinget..
      * Dette KAN VÆRE FOR TØFT..
      *  .. hensikten er å kunne skyte UT terminal-->PÅ BIL / denmde EDI fra innland mm
      * (V12 - alltid kan holde kolliene på mor.oppdraget?? Heller fixe prog som skal bruke de??)
     c                   move      HEAVDG        FMAVDx
     c                   move      HEOPDG        FMOPDx
     C                   z-add     1             XXFBNR
     C     DOKFMKey      Setll     DOKUFM
     C     DOKFMKey      READE     DOKUFM                                 33
     C     *in33         doweq     '0'
     C     FMST          IFEQ      'E'                                          Ekstern
     C     FMST          OREQ      'I'                                          Intern
     C     FMST          OREQ      'M'                                          Mankomerket
     C     FMST          OREQ      'O'                                          Ompakket/Original
     C                   delete    dokufmr
     C                   move      heavd         FMAVD
     C                   move      heopd         FMOPD
     C                   z-add     1             FMFBNR
     C                   write     dokufmr
     C                   end
     C     DOKFMKey      READE     DOKUFM                                 33
     C                   end
      * hent opp igen HO-oppdragets avd-info
     C     KODTAK        CHAIN     KOAR                               31
     c
     C*
     C*   BYTTER  FAKTURAMOTTAGER
     C*
     C     TRKDFF        IFEQ      'S'
     C                   MOVE      KOAKNR        HEKNSF
     C                   MOVE      *ZEROS        HEKNKF
     C                   ELSE
     C                   MOVE      KOAKNR        HEKNKF
     C                   MOVE      *ZEROS        HEKNSF
     C                   END
     C* FLYTTET LINJER NEDENFOR OPP HIT
     C* OPPADSTIGENDE REFERANSE I EGNE DATAFELT
     C* AVD0/OPD0 - REF TIL MODEROPPDRAG (SOM GJERNE OGSÅ KAN VÆRE DUP)
     C                   MOVE      'VF'          TRSLAG
     C                   MOVE      HEAVDG        TRAVD0
     C                   MOVE      HEOPDG        TROPD0
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   MOVE      ' '           TRSTAF
     C                   MOVE      ' '           TRSTAE
     C                   EXSR      OPDHTD
     C                   MOVE      ULDT          HEDTR
     C                   WRITE     HEADFR
N19  C                   CALL      'SYGE86'
N19  C                   PARM                    HEAVDG
N19  C                   PARM                    HEOPDG
N19  C                   PARM                    HEAVD
N19  C                   PARM                    HEOPD
     C     XKOPI         IFEQ      'J'
     C                   EXSR      MERKPI
     C                   END
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
      * DUPLISER FRITEKST????
     C     KEYFTG        CHAIN     FREETXT2                           31
     C     *IN31         DOWEQ     '0'
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
     C                   WRITE     FREETX2R
     C     KEYFTG        READE     FREETXT2                               31
     C                   END
      * FRITEKST TIL OPPDRAG
     C     WSFRD2        IFEQ      'J'
     C                   EXSR      VISFRE
     C                   END
     C* VED POSTNR.BASERT - LEGG UT OGSÅ POST MED STEDSNAVN
     C   42              DO
     C                   CLEAR                   HESTEDR
     C                   MOVE      HEAVD         HSAVD
     C                   MOVE      HEOPD         HSOPD
     C                   MOVEL     WPPNS4        HSFROM
     C                   MOVEL     WPPNS2        HSTO
     C                   WRITE     HESTEDR
     C                   END
     C   42              MOVE      WPLANF        GMLK
     C   42              MOVE      WSSDF         GMSD
     C   42              MOVE      WPLAN2        WPLANF
     C   42              MOVE      WSSDVT        WSSDF
     C                   EXSR      OPDDIS
     C   42              MOVE      GMLK          WPLANF
     C   42              MOVE      GMSD          WSSDF
     C* Send varsel til USER-profiles knyttet til avdelingen
     C                   EXSR      SNDMSG
     C                   MOVE      'J'           DUPOPD
     C                   MOVE      'NY'          XNYGML
     C                   SETOFF                                       030516
     C     DIN03         IFEQ      'J'
     C                   SETON                                        03
     C                   END
     C     DIN05         IFEQ      'J'
     C                   SETON                                        05
     C                   END
     C     DIN16         IFEQ      'J'
     C                   SETON                                        16
     C                   END
     C                   EXSR      FAKTUR
     C                   MOVE      YNYGML        XNYGML
     C* LEGG UT DUMMY REKVISISJON FOR Å LETTE SENERE SPØRRING
     C                   EXSR      DUMREK
     C                   END
     C*
     C* SLUTT DUPLIKATOPPDRAG FOR VIDERETRANSPORT
     C*
     C*
     C* OPPDATERER KRYSSREFERANSE GAMMELT OPPDRAG
     C*
     C     DUPOPD        IFEQ      'J'
     C*
     C     KEYTRG        CHAIN     HEADF                              98
     C  N98              MOVE      WSAVD1        TRAVD1
     C  N98              MOVE      WSOPD1        TROPD1
     C  N98              MOVE      WSAVD2        TRAVD2
     C  N98              MOVE      WSOPD2        TROPD2
     C  N98WSSTAF        IFEQ      ' '
     C     WSOPD1        IFNE      *ZEROS
     C                   MOVE      'O'           WSSTAF
     C                   MOVE      'O'           TRSTAF
     C                   END
     C                   END
     C  N98WSSTAE        IFEQ      ' '
     C     WSOPD2        IFNE      *ZEROS
     C                   MOVE      'O'           WSSTAE
     C                   MOVE      'O'           TRSTAE
     C                   END
     C                   END
     C  N98              UPDATE    HEADFR
     C                   END
     C                   SETOFF                                       030516
     C     DIN03         IFEQ      'J'
     C                   SETON                                        03
     C                   END
     C     XIN05         IFEQ      'J'
     C                   SETON                                        05
     C                   SETOFF                                       03
     C                   END
     C     DIN16         IFEQ      'J'
     C                   SETON                                        16
     C                   END
     C                   MOVE      HEAVDG        WSAVD
     C                   MOVE      HEOPDG        WSOPD
     C                   MOVE      HEPROG        WSPRO
     C                   MOVE      HEAVDG        HEAVD
     C                   MOVE      HEOPDG        HEOPD
     C                   MOVE      HEPROG        HEPRO
     C                   MOVE      HESGG         HESG
     C     DUPOPD        IFEQ      'J'
     C     KEYTRG        CHAIN(N)  HEADF                              98
     C                   MOVE      *OFF          *IN28
     C                   EXSR      MOVHFW
     C                   END
     C*
     C                   SETOFF                                       919298
     C     UTDUPS        ENDSR
     C***********************************************
     C     GetDupAvd     BEGSR
     C***********************************************
      * FORELØPIG er det ingen som benytter Innland som distr-modul utenom NOREGE
      *           (åpner ikke før det før det gjøres som bevisst valg - mye jobb antakelig)
      * Benytt Dupens Via-som term..
     C                   MOVE      RITERM        RITERMG           4 0
      * Finn avd for Innhentingsdup (primært via NOPNR - sekundært via sone-liste)
     c                   If        WSSDFF<>*blanks and WSAVD1=*zeros
     c                             and WPLANF='NO' and WPLAN1='NO'
      * Benytt Dupens Via som term..
     C                   MOVEL     WSSDFF        TSTPNR            4
     C                   TESTN                   TSTPNR               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      TSTPNR        RITERM
     C                   ENDIF
     C                   MOVEL     WSSDF         TSTPNR            4
     C                   TESTN                   TSTPNR               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      TSTPNR        NUMPNR
     C     KODRIK        CHAIN     NOPNR                              33
     C     *IN33         IFEQ      *OFF
     C     NOAVDU        ANDNE     *ZEROS
     C                   MOVE      NOAVDI        WSAVD1
     C                   goto      UtAvd1
     C                   END
     C     KODRIK        SETGT     KODTRI
     C     RITERM        READPE    KODTRI                                 33
     C  N33NUMPNR        IFGE      RIPNRF
     C     NUMPNR        ANDLE     RIPNRT
     C                   MOVE      RIAVDI        WSAVD1
     C                   goto      UtAvd1
     c                   ENDIF
     C                   ENDIF                                                  end OK Num avd
     c     UtAvd1        tag
      * ved autosatt avd-sett også OTY/Frank
     c                   If        WSAVD1<>*zeros
     c                   eval      WSOTFF=IFOTFF
     c                   If        HEFBV >IFOTVG
     c                   eval      WSOTFF=IFO2FF
     c                   endif
     c                   eval      WSFRFF=IFFRFF
     c                   endif
     c                   endif                                                  end wsadv2...
      *
      * Finn avd for Utkjøringsdup. (primært via NOPNR - sekundært via sone-liste)
     c                   if        WSSDVT<>*blanks and WSAVD2=*zeros
     c                             and WPLAN2='NO' and WPLANT='NO'
      * Benytt Dupens Via som term..
     C                   MOVEL     WSSDVT        TSTPNR            4
     C                   TESTN                   TSTPNR               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      TSTPNR        RITERM
     C                   ENDIF
     C                   MOVEL     WSSDT         TSTPNR            4
     C                   TESTN                   TSTPNR               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      TSTPNR        NUMPNR
     C     KODRIK        CHAIN     NOPNR                              33
     C     *IN33         IFEQ      *OFF
     C     NOAVDU        ANDNE     *ZEROS
     C                   MOVE      NOAVDU        WSAVD2
     C                   goto      UtAvd2
     C                   END
     C     KODRIK        SETGT     KODTRI
     C     RITERM        READPE    KODTRI                                 33
     C  N33NUMPNR        IFGE      RIPNRF
     C     NUMPNR        ANDLE     RIPNRT
     C                   MOVE      RIAVDU        WSAVD2
     C                   goto      UtAvd2
     c                   ENDIF
     C                   ENDIF                                                  end OK Num avd
     c     UtAvd2        tag
      * ved autosatt avd-sett også OTY/Frank
     c                   If        WSAVD2<>*zeros
     c                   eval      WSOTVT=IFOTVF
     c                   If        HEFBV >IFOTVG
     c                   eval      WSOTVT=IFO2VF
     c                   endif
     c                   eval      WSFRVT=IFFRVF
     c                   endif
     c                   endif                                                  end wsadv2...
      *
     C                   MOVE      RITERMG       RITERM
     c                   endsr
     C***********************************************
     C     BERDUP        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        UUBELØ
     C     DUPTYP        IFEQ      'F'
     C                   MOVE      WSAVD2        DUPAVD            4 0
     C                   MOVE      WSFRFF        HXFR
     C                   MOVE      WSPKFF        HXKDPL
     C                   MOVE      WPLANF        HXLKA
     C                   MOVE      WPSDF         HXSDF
     C                   MOVE      WPLAN1        HXTRI
     C                   MOVE      WPSDFF        HXSDT
     C                   ELSE
     C                   MOVE      WSAVD1        DUPAVD            4 0
     C                   MOVE      WSFRVT        HXFR
     C                   MOVE      WSPKVT        HXKDPL
     C                   MOVE      WPLAN2        HXLKA
     C                   MOVE      WPSDVT        HXSDF
     C                   MOVE      WPLANT        HXTRI
     C                   MOVE      WPSDT         HXSDT
     C                   END
     C                   MOVE      HEUR          HXUR
     C                   MOVE      *BLANKS       HXLKS
     C                   MOVE      *BLANKS       HXSDFF
     C                   MOVE      *BLANKS       HXLKK
     C                   MOVE      *BLANKS       HXSDVT
     C                   MOVE      HEVKT         HXVKT
     C                   MOVE      HEFBV         HXFBV
     C                   MOVE      HEM3          HXM3
     C                   MOVE      HELM          HXLM
     C                   MOVE      HENT          HXNT
     C                   MOVE      TRVERV        HXVERV
     C                   MOVE      TRVERB        HXVERB
      *
     C                   MOVE      *ZEROS        N5                5 0
     C                   MOVE      ' '           USKA              1
     C                   MOVE      *ZEROS        DUVNR             9 0
     C                   MOVE      *BLANK        DUVMSG           50
      * FINN FRAKT I KUNDERSFRAKTAVTALE
     C                   Z-ADD     KOAKNR        UUKN              8 0
     C                   MOVE      *BLANKS       UUVAL             3
     C                   MOVE      'FRA'         UGEB              3
     C                   MOVE      'FRA'         UGEBKO            3
     C                   MOVE      *ZEROS        UUBELØ           13 2
     C                   MOVE      HXHEAD        UHEAD           256
     C                   CALL      'SYGE14'
     C                   PARM                    UGEBKO
     C                   PARM                    UGEB
     C                   PARM                    DUPAVD
     C                   PARM                    N5
     C                   PARM                    UUKN
     C                   PARM                    UUVAL
     C                   PARM                    UUBELØ
     C                   PARM                    DUVNR             9 0
     C                   PARM                    DUVMSG           50
     C                   PARM                    USKA
     C                   PARM                    UHEAD
      * BRUTTO
     C     UUBELØ        IFEQ      0
     C                   MOVE      *BLANKS       USONE
     C                   MOVE      *BLANKS       UUVAL
     C                   MOVE      *ZEROS        URABAT
     C                   MOVE      HXHEAD        UHEAD           256
     C                   CALL      'SYGE13'
     C                   PARM                    UGEB
     C                   PARM                    DUPAVD
     C                   PARM                    N5
     C                   PARM                    UUVAL
     C                   PARM                    UUBELØ
     C                   PARM                    USONE             5
     C                   PARM                    URABAT            5 2
     C                   PARM                    N5                5 0
     C                   PARM                    N5                5 0
     C                   PARM                    N5                5 0
     C                   PARM                    N5                5 0
     C                   PARM                    UUKN
     C                   PARM                    UHEAD
     c                   parm                    atdum             1
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDDIS        BEGSR
     C***********************************************
     C*
     C*
     C* OPPDATERER DISPONERINGSFILE
     C*
     C     DISPKE        KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C*
     C                   MOVE      HEOPD         DIOPD
     C                   MOVE      HEAVD         DIAVD
     C     DISPKE        CHAIN     DISP                               34
     C                   MOVE      HEOT          DIOT
      * VED NY...
     C   34HEPRO         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        DIRUND
     C                   MOVE      *ZEROS        DITUR
     C                   MOVE      *ZEROS        DITUAV
     C                   ELSE
     C                   Z-ADD     TRRUND        DIRUND
     C                   Z-ADD     HEPRO         DITUR
     C                   MOVE      XITUAV        DITUAV
     C                   END
      * TUR GITT, MEN TURENS AVD UDEFINERT (FRA EDI-PLUKK)
     C     DITUR         IFNE      *ZEROS
     C     DITUAV        ANDEQ     *ZEROS
     C     DITUR         CHAIN     TURER14                            33
     C  N33              MOVE      TUAVD         DITUAV
     C                   END
     C                   MOVE      HESDF         DISTEF
     C                   MOVE      HESDT         DISTET
     C                   MOVE      TRSDFD        DIDATF
     C                   MOVE      TRSDTD        DIDATT
     C                   MOVE      TRSDFK        DITIMF
     C                   MOVE      TRSDTK        DITIMT
     C     HESDFF        IFNE      *BLANKS
     C     WSSTAF        IFEQ      ' '
     C     WSSTAF        OREQ      'R'
     C     WSSTAF        OREQ      'F'
     C     WSSTAF        OREQ      'O'
     C                   MOVE      TRSFFD        DIDATF
     C                   MOVE      HESDFF        DISTEF
     C                   MOVE      TRSFFK        DITIMF
     C                   END
     C                   END
     C     HESDVT        IFNE      *BLANKS
     C     WSSTAE        IFEQ      ' '
     C     WSSTAE        OREQ      'R'
     C     WSSTAE        OREQ      'F'
     C     WSSTAE        OREQ      'O'
     C                   MOVE      TRSVTD        DIDATT
     C                   MOVE      HESDVT        DISTET
     C                   MOVE      TRSVTK        DITIMT
     C                   END
     C                   END
     C                   MOVE      *BLANKS       DISONF
     C                   MOVE      *BLANKS       DISONT
     C  N42DISTEF        CHAIN     STED2                              33
     C   42WKSDF         CHAIN     STED2D                             33
     C  N33              MOVEL     ST2LK         DISONF
     C  N33              MOVE      ST2SOL        DISONF
     C  N42DISTET        CHAIN     STED2                              33
     C   42WKSDT         CHAIN     STED2D                             33
     C  N33              MOVEL     ST2LK         DISONT
     C  N33              MOVE      ST2SOL        DISONT
     C   34              MOVE      ' '           DISTA1
      * ved dup til innlandsmodul sett dispstatus E=Skjult 'E-sending' inntil strekkodeskutt inn
     C   34TRSLAG        IFEQ      'VF'
     C     DUPINL        andeq     'J'
     C                   MOVE      'E'           DISTA1
      * legg ut fri søkevei EDS som samler(v/F13) 'Esendinger' fra aktuell avsender (avds kundenr)
     C                   MOVE      HEAVD         FSAVD
     C                   MOVE      HEOPD         FSOPD
     C                   MOVE      'EDS'         FSKODE
     c                   MOVE      *blanks       FSDOKK
     c                   MOVE      HEKNSF        AAKNFA            8
     c                   MOVE      HEDTOP        AADTOP            8
     C                   EVAL      FSSOK=AAKNFA+' '+AADTOP+' '+GMTURA+' '+GMBILA
     C                   WRITE     FRISOKR
     c                   endif
     C* Dersom kopieringsmal(*IN37 ON) - sett dispon.status til "M"
     C   37              MOVE      'M'           DISTA1
     C     *IN34         IFEQ      *ON
     C     HEUR          ANDEQ     'H'
     C                   WRITE     DISPR
     C                   ENDIF
     C  N34              UPDATE    DISPR
     C                   ENDSR
     C*
