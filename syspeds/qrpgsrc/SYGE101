     H DFTACTGRP(*NO)
     fdokufm    o  a e             disk
     ffirfb     uf   e           k disk
     ffirm      if   e             disk

     d  uan22          s             22

     d                 ds
     d koid                          18
     d  dsidpk                        1    overlay(koid)
     d  dsidla                        2  0 overlay(koid:2)
     d  dsidle                        5  0 overlay(koid:4)
     d  dsidnr                        9s 0 overlay(koid:9)
     ‚*  Prototype for syge101
     d syge101         pr
     d uavd_                               like(uavd)
     d uopd_                               like(uopd)
     d ufbnr_                              like(ufbnr)
     d uant_                               like(uant)
     ‚*  Prototype for 'SYGE08'
     d syge08          pr                  extpgm('SYGE08')
     d uan22_                              like(uan22)
     ‚*  *ENTRY Interface for Main Procedure
     d syge101         pi
     d uavd                           4  0
     d uopd                           7  0
     d ufbnr                          3  0
     d uant                           3  0
     d do_x            s              7  0

      /free

       read firm;

       clear dokufmr;

       fmst='I';
       fmri='F';
       fmavd=uavd;
       fmopd=uopd;
       fmfbnr=ufbnr;
       fmlinr=0;

       for do_x = 1 to uant;

         chain fifirm firfb;
         fiidnr=fiidnr+1;
         update firfbr;

         fmmknr=fmmknr+1;
         dsidpk='3';
         dsidla=fiidla;
         dsidle=fiidle;
         dsidnr=fiidnr;
         uan22=*zeros;
         %subst(uan22:5:18) = koid;
         syge08 ( uan22 );
         koid = %subst(uan22:5:18);
         fmmrk1 = koid;
         write dokufmr;

       endfor;

       *inlr=*on;
      /end-free
