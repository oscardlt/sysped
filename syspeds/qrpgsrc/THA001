     F********************************************************************
     F* genererer flyfrakt innland for SAS og Bråthens
     F********************************************************************
     Fthai      IP   E           k disk
     F                                     RENAME(THAI:THAIR)
     Fairlh     uF a E           k disk
     Fairld     uF a E           k disk
N03  D                 DS
N03  D  rdata                  1    512
N03  D  land                   9     10
N03  D  AIRPFRI               17     19
N03  D  AIRPTOI               25     27
N03  D  VEKTA                 62     64
N03  D  PRISH                 83     85
N03  D  PRISD                 87     88
     D  AIRCUR                89     91
     ITHAIR
     I              THAI                        DATA
      *
     c                   movel     DATA          rdata
      *
     c   99              exsr      skriv
     c                   seton                                        99
      *
     c                   z-add     0             airgrn
     c                   z-add     217           airlin
     c                   move      airpfri       airpfr
     c                   move      airptoi       airpto
     c                   move      vekta         vektan            3 0
     c                   move      prish         prishn            3 0
     c                   move      prisd         prisdn            2 0
     c                   exsr      oppdat
     cLR                 move      '  0'         vekta
     cLR                 exsr      skriv
     c*****************************************************
     c     oppdat        begsr
     c*****************************************************
     c*
     c     keyhea        klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c*
     c* THAI
     c*
     c     keyhea        chain     airlh                              34
      *
     c     *in(34)       ifeq      '1'
     c                   write     airlhr
     c                   else
     c                   update    airlhr
     c                   end
     c                   exsr      detsr
     c                   endsr
     c*
     c*******************************************************************
     c     detsr         begsr
     c*******************************************************************
     c     keydet        klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   kfld                    airccp
     c*
     c* general  cargo
     c*
     c                   move      ' '           airccp
     c*
     c*    sletter records ved ny vektn
     c*
     c     vektan        ifeq      0
     c                   setoff                                       34
     c     keydet        setll     airld
     c     *in(34)       doweq     '0'
     c     keydet        reade     airld                                  34
     c  n34              delete    airldr
     c                   enddo
     c                   endif
     c     vektan        ifeq      0
     c     vektan        oreq      1
     c                   move      'N'           aircod
     c                   else
     c                   move      'Q'           aircod
     c                   end
     c     vektan        ifeq      0
     c                   z-add     prishn        GRPR             13 2
     c                   else
     c                   z-add     prishn        airawb
     c                   move      prisd         airawb
     c                   end
      *
     c                   endsr
     c*
     c*******************************************************************
     c     skriv         begsr
     c*******************************************************************
      * skjekk om ny record
     c     vekta         ifeq      '  0'
     c                   z-add     99999         airwei
     c                   end
     c     vekta         ifeq      '  1'
     c                   z-add     99999         airwei
     c                   end
     c     vekta         ifeq      ' 45'
     c                   z-add     44            airwei
     c                   end
     c     vekta         ifeq      '100'
     c                   z-add     99            airwei
     c                   end
     c     vekta         ifeq      '300'
     c                   z-add     299           airwei
     c                   end
     c     vekta         ifeq      '500'
     c                   z-add     499           airwei
     c                   end
     c     vekta         ifne      '  1'
     c                   z-add     GRPR          AIRGRN
     c                   write     airldr
     C                   Z-ADD     0             GRPR
     c                   end
     c                   endsr
