********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 Skriv godkjennelsesdato ve utskrift i ettertid
10XXX * 02 YBC PTF10 PROSEDYRE 63 BEHANDLES SAMME SOM 64
10XXX * 03 YBC PTF10 FIRSØKEVEI FLYTTES 3 POS. TIL VENSTRE
10XXX * 04 JOV PTF10 AFP-PRINT, LITT AVVIKENDE OVERSTYRING I FORHOLD TIL PDF..
10XXX * 05 SH  PTF10 innført drawer skuff  ant kopier
10XXX * 06 SH  PTF10 72 linjer endret til 70 ved laser dataliste
      *              tatt bort høyrestilling av godsnummer
      *              flytett kundenummer
10XXX * 07 SH  PTF10 risikerer låsing ved arkiv
10XXX * 08 SH  PTF10 flytett litt på refnummer
10XXX * 09 SH  PTF10 kundens ref også i andre felt
10XXX * 10 YBC PTF10 GRENSE FOR AVGIFT ER FRA OG MED 50
10XXX * 11 SH  PTF10 dataliste bredde 80
10XXX * 12 SH  PTF10 ALLTID ÅPNE LUKKE PRINTFILER
10212 * 13 YBC PTF10 HENT FAKTURANR OG BETALINGSREF VED KONTAKTOPPGJØR
10XXX * 14 SH  PTF10 TEKSTRETTING
10XXX * 15 SH  PTF10 LITT FLYTTING BLA ANNET FOR DHL
      * 16 SH  PTF10 Egen fritekstkode fra fri søkevei
      * 17 SH  PTF10 utskuff innført
10XXX * 18 YBC PTF10 LAV VERDI IMP. VIN MED UTB OG TR.TYPE=1
10XXX * 19 SH  PTF10 PRINTERSTYRING PÅ BRUKERNIVÅ
10XXX * 20 SH  PTF10 feil i print
10214 * 21 YBC PTF10 IKKE SKRIV SER VED PREFERANSE = J/N
10XXX * 22 YBC PTF10 SJEKK FAKTURASUM PÅ 200,00
10XXX * 23 SH  PTF10 nuy bakgrunn alt 2 posisjoner til høyre på utskrift
10XXX * 24 YBC PTF10 RETTELSE PÅ ENDRING 16
10247 * 25 YBC PTF10 INFORMASJON OM MIDLERTIDIG DEKLARASJON
      *              EKSTERN DEFINERT SAD61PF FOR TOLLDEK
10247 * 26 SH  PTF10 Rettet regkort
10XXX * 27 YBC PTF10 GODSNR+POSISJON ER 15+1+9=25 LANG
10260 * 28 YBC PTF10 TVINN ER KLAR TIL Å MOTTA FLERE ENN 8 AVGIFTER
10262 * 29 YBC PTF10 TOLLSATS ER UTVIDERT TIL 7.2
10264 * 30 YBC PTF10 DATALIST ER BYTTET MED SAD61PFT
10XXX * 31 YBC PTF10 HENT DEFAUL VERDIER FRA AVDELING
10XXX * 32 YBC PTF10 SIFT3 OG SIFT4 DOBBELT DEFINERES I DS
10XXX * 33 YBC PTF10 FLYTT SVFT PÅ RIKTIG MÅTE
10286 * 34 YBC PTF10 VEKT ER ENDRET FRA 9.0 TIL 12.3
      *              VAREBESKRIVELSE ER ØKT FRA 15A TIL 30A
10XXX * 35 YBC PTF10 OPPDATER P PÅ HEPK4 HVIS LØPENR ER UTFYLLT.
10XXX * 36 YBC PTF10 PROBLEM MED DOBBEL ØREAVRUNDING
10329 * 37 YBC PTF10 MENGDE I ANNEN ENHET ER ENDRET FRA 7.0 TIL 9.0
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 38 YBC PTF11 IKKE HENT TEKST FRA SOKTARI PGA. FLERE TEKST PR TARIFF
11XXX * 39 YBC PTF11 TEST HELTALL PÅ 50-KR GRENSE
11XXX * 40 SH  PTF11 skyver de med laser=F litt til høyre
11XXX * 41 YBC PTF11 TOTAL LINJE PÅ IKKE A4 MÅ REDUSERES TIL 39
11XXX * 42 SH  PTF11 angre på ptf 40 ny overlay innført
11015 * 43 YBC PTF11 SEND XML-FIL TIL EMMA SYSTEM
11XXX * 44 YBC PTF11 ANTALL LINJE PÅ SAD61PFT ENDRES FRA 61 TIL 59
11016 * 45 YBC PTF11 OMBEREGNING
11XXX * 46 SH  PTF11 Vise total mva på side 1 ved mange avgifter
11XXX * 47 YBC PTF11 UTVIDER 22 AVGIFTER PÅ TOTAL
11XXX * 48 SH  PTF11 rettelse utskuff
11XXX * 49 YBC PTF11 BEREGN AVGIFT ALLTID PÅ NYTT
11XXX * 50 YBC PTF11 PRINT OMBEREGNING
11XXX * 51 YBC PTF11 BRUK RIKTIG BANE
11XXX * 52 YBC PTF11 HELTALL PÅ GRUNNALG TIL AVGIFTER
11XXX * 53 YBC PTF11 SKRIV UT LØPENR AV OPPRINNELIG SAD PÅ OMBEREGNING
11XXX * 54 SH  PTF11 Ny test 350 kroner
11XXX * 55 SH  PTF11 FEIL I OVERSTYRING BRUKENIVÅ
11XXX * 56 YBC PTF11 RETTELSE PÅ ENDRING 54. OMBEREGNING KAN HA EN TIDLIG DATO
11XXX * 57 YBC PTF11 VIDERE ENDRING PÅ ENDRING 52
11XXX * 58 YBC PTF11 ENDRING 54, TIL OG MED KR 350, IKKE TIL 350
11XXX * 59 SH  PTF11 sikret rettelse til ptf 55
11XXX * 60 YBC PTF11 VEDLEGG TIL EMMA SJEKKER OGSÅ PÅ FIRMA-NIVÅ
11XXX * 61 YBC PTF11 SEND TOTAL VEKT SOM ER SUMMERT FRA LINJER TIL EMMA
11XXX * 62 SH  PTF11 EPOSTADRESSE BRUKER
11XXX * 63 YBC PTF11 TILLAT DESIMAL VED TL PÅ AVGIFTSFELT
11108 * 64 YBC PTF11 OMBEREGNING PÅ OMBEREGING. IND. 35 ER TATT I BRUK
11XXX * 65 YBC PTF11 PRINTERFIL REGKORT ENDRET
11XXX * 66 YBC PTF11 ENDRING 58 TREKKES TILBAKE. MED MVA FRA OG MED KR 350
11XXX * 67 SH  PTF11 MAILTAG I PRINTERFIL
11XXX * 68 YBC PTF11 AVGIFTSGRUNNLAG MED DESIMALER
11174 * 69 YBC PTF11 TILLEGGSLINJER MED SAMME POST
11XXX * 70 SH  PTF11 *STD i skriver gir ingen brukerspesialitet
11XXX * 71 YBC PTF11 PROSEDYRE 49 -> SÆRBEHANDLING
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12001 * 72 YBC PTF12 MVA-registrert
12XXX * 73 YBC PTF12 FEILRETTING PÅ ENDRING 18
12024 * 74 YBC PTF12 BEARBEIDINGSKOSTNAD SKAL VÆRE GRUNNLAG FOR TOLL
      *              NÅR DET ER VERDI FORTOLLING
12XXX * 75 YBC PTF12 IKKE SUMMERE SLETTET LINJE VED OMBEREGNING
12XXX * 76 YBC PTF12 ANTALL LINJER PÅ DATALISTE JUSTERES FRA 59 TIL 57
12047 * 77 YBC PTF12 SKRIV UT CONTAINERNR/GODSMERKING PÅ TILLEGGSARK
12053 * 78 YBC PTF12 FLERE FELTER ER ENDRET LENGDE
12055 * 79 YBC PTF12 OMBEREGNING TIL EMMA
12061 * 80 YBC PTF12 Logg sending til EMMA
12XXX * 81 YBC PTF12 OMREGNING
12067 * 82 YBC PTF12 IKKE OPPDATER SAD-STATUS VED ARKIVERING
12XXX * 83 YBC PTF12 FEIL VED XML TIL EMMA (MOMSGRUNNLAG OG MOMS)
12080 * 84 YBC PTF12 ALLE NYE LINJER FRA OMBEREGNING SKAL IKKE SLÅ SAMME
12119 * 85 YBC PTF12 NYE LINJER I OMBEREGNING
12XXX * 86 YBC PTF12 PROSEDYRE 76 ENDRES TIL 77 VED OPPRINNELSESLAND<>NO
12XXX * 87 YBC PTF12 IKKE ALKOHOLD/TOBAKK -> IKKE SEND TOTAL AVG. VED MINDRE ENN 50 KR
12122 * 88 YBC PTF12 Flere nye felter for Emma
12XXX * 89 YBC PTF12 Indikator 33 problem ved endring 65
12XXX * 90 YBC PTF12 Rettelse på endring 78
12XXX * 91 sh  PTF12 sadgebyr til batch
12XXX * 92 sh  PTF12 utvidet fakturaref felt
12XXX * 93 YBC PTF12 Særtegn på omberegning til Emma
12108 * 94 YBC PTF12 Prosedyre på linje-nivå
12XXX * 95 YBC PTF12 Rettelse på endring 81. Omberegningsfaktor
12110 * 96 YBC PTF12 Arbeidsvariabel XAVG endres til 11.0
12XXX * 97 YBC PTF12 EMMA <MVAFritakKode> og avgift
12XXX * 98 SH  PTF12 close open ved brudd signatur (som avdeling)
12XXX * 99 YBC PTF12 Ikke kalle SAD061 hvis kunde ikke skal ha spesifikasjon
12160 * 100 YBC PTF12 Rett feil ved 50 kr grense og alkohold/tobakk med
12167 * 101 YBC PTF12 Enhetskode til særavgift
12184 * 102 YBC PTF12 Containernr sendes på egen måte
12XXX * 103 YBC PTF12 Feil enhetskode for toll
12197 * 104 YBC PTF12 Proteria er på samme måte som EMMA
12199 * 105 YBC PTF12 Feil i omberegning. Linje blir ikke printet ved første sammenslåtte
      *               er slettet og minst en av sammenslåtte linje ikke er slettet.
12200 * 106 YBC PTF12 CONTAINER ER I EGEN FIL
12XXX * 107 YBC PTF12 SETT PÅ LAST RECORD
12XXX * 108 YBC PTF12 STREKKODE AV DEKLARASJONSID
********************************************************************
S43  H*debug(*yes)
N43  H Option( *SrcStmt ) DftActGrp( *No ) BndDir( 'QC2LE' ) debug(*yes)
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT TOLLDEKLARASJON  (IMPORT)    ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 35 36 43 54-60 85-88
      ***    IND. 28,49,50 ER TATT I BRUK VED SJØ-OPPDRAG     ***
      *
      * TILLEGG AV AKOST: BELØP SIBEL2 BENYTTES  IKKE SIBELB
      * VED EU/70,72 KREVER KUN RUBR. 1,2,5,6,7,8,14,21,25,31,35,37,44
      * OG 54. BENYTTE FRITEKST FOR Å SKRIVE RUBR. 31 OG 44
      *  PROS.=48,70-77  ---> 99 PÅ
      *  PROS.=47        ---> 91,99 PÅ
      * IND. 98 PÅ = SÆRAVGIFT ER MER ENN 7 (GJELDER BARE FOR DATALIST)
      * IND 27 OFF = MOTORVOGNFORTOLLING (SADW)  / ON = Vanlig (SADV)
      *
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
N102 FSYPTFF    IF   E           K DISK
     FFRISOK    IF   E           K DISK
N16  FKODFRI    IF   E           K DISK
     FFPXREF    IF   E           K DISK
     FEDIM4     IF   E           K DISK
N43  FEDIC      UF   E             DISK
N43  FEDIM      O  A E             DISK    RENAME(EDIMR:EDIMR0)
N43  F                                     PREFIX(M0_)
N43  FEDIS      O  A E             DISK    RENAME(EDISR:EDISR0)
N43  F                                     PREFIX(S0_)
N43  FEDISX     O  A E             DISK    RENAME(EDISXR:EDISXR0)
N43  F                                     PREFIX(X0_)
N43  FCUNDC01   IF   E           K DISK
N43  FFIRMARC   IF   E           K DISK
N43  FARKTXT    IF   E           K DISK
N43  FARKEXT    IF   E           K DISK
N43  FARKIVL02  IF   E           K DISK
N43  FARKVEDK   IF   E           K DISK
N72  FCUNDL01   IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FSADH      UF   E           K DISK
N25  FSADHMD    IF   E           K DISK
N50  FSADHOM    IF   E           K DISK    RENAME(SADHR:SADHOMR)
N64  FSADOMTH   IF   E           K DISK    PREFIX(TO_)
     FSADH8     IF   E           K DISK
     F                                     RENAME(SADHR:SADH8R)
     FSADV2     UF   E           K DISK
     FSADV4     UF   E           K DISK    RENAME(SADVR:SADV4R)
     FSADVJ     IF   E           K DISK
N72  FSADVAVG   UF A E           K DISK
     FSADW      IF   E           K DISK
     FSADF      IF   E           K DISK
     FSADSD     IF   E           K DISK
     FSTANDI    IF   E           K DISK
     FHEADF     UF   E           K DISK
     FWFILEIMP  UF A E           K DISK    USROPN
     FKODTVAL2  IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTS8    IF   E           K DISK
     FTARI      IF   E           K DISK
S37  F*SOKTARI2  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTP     IF   E           K DISK
N19  FKODTPUSR  IF   E           K DISK
N62  FKODTSI    IF   E           K DISK
N80  FTRACKF    O  A E             DISK
N25  FSAD61PF   O    E             PRINTER USROPN
     FTOLLDEK2  O    F   83        PRINTER USROPN
     F                                     FORMLEN(72)
     F                                     FORMOFL(72)
N30  FSAD61PFT  O    E             PRINTER USROPN
N65  FSAD61PFR  O    E             PRINTER USROPN
N43   *
N43  D FILE_o          s               *
N43  D String          s            512a
N43  D rc              s             10i 0
N43  D Data            s             80a   Varying
N43  D Codepage        s              5a   Varying
N43  D CmdLine         S            512
N43  D CmdLen          S             15  5
N43  D LF              c                   x'25'
N43  Dopen             Pr              *   ExtProc( '_C_IFS_fopen' )
N43  D                                 *   Value Options( *String )
N43  D                                 *   Value Options( *String )
N43  Dfputs            Pr            10i 0 ExtProc( '_C_IFS_fputs' )
N43  D                                 *   Value Options( *String )
N43  D                                 *   Value
N43  Dclose            Pr            10i 0 ExtProc( '_C_IFS_fclose' )
N43  D                                 *   Value
N43  D                 DS
N43  D  WMBR                   1     14
N43  D  WMBRA                  1      1
N43  D  WMBRB                  2     10  0
N43   *
N43  D                 DS
N43  D  XTXT801                1     80
N43  D  XT801                  1     80    DIM(80)
N43  D                 DS
N43  D  XTXT802                1     80
N43  D  XT802                  1     80    DIM(80)
N43  D                 DS
N43  D  AVKVED                 5     64
N43  D  VKD                    1     64    DIM(32)
N43  D VEDL            S            100    DIM(100)
N43  D EDIDTA          DS           256
N43  D  UELIBF               171    180
N80  D                SDS
N80  D  ZUSER                254    263
S25  D*Y1              S              2    DIM(24)
     D E1              S              3    DIM(24)
S25  D*G1              S             11  2 DIM(24)
S25  D*G11             S              9  0 DIM(24)
S25  D*S1              S              7  2 DIM(24)
S25  D*P1              S              1    DIM(24)
S25  D*B1              S              9  0 DIM(24)
S30  D*TR              S              2    DIM(24)
S25  D*T1              S              2    DIM(20)
S25  D*T2              S              9  0 DIM(20)
     D T3              S              2    DIM(20)
S90  D*T4              S             11  2 DIM(40)
N90  D T4              S             13  2 DIM(40)
N72  D T5              S              7  2 DIM(40)
N72  D T6              S              3    DIM(40)
     D MN              S             17    DIM(20)
     D VS              S             25    DIM(20)
     D F1              S             75    DIM(9)
     D F2              S             75    DIM(9)
     D F3              S             75    DIM(9)
     D F4              S             75    DIM(9)
     D F5              S             75    DIM(9)
     D F6              S             75    DIM(9)
      *
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
N25  D                                     FILE(SAD61PF) -
     D                                     OUTQ(')
     D XCMDPDF         C                   CONST('DEVTYPE(')
     D XCMDPDF2        C                   CONST('FRONTOVL(FSAD38)')
     D XCMDPDF3        C                   CONST('FRONTOVL(FSAD2)')
     D XCMD12          C                   CONST('OVRPRTF -
     D                                     FILE(TOLLDEK2) -
     D                                     OUTQ(')
     D XCMD13          C                   CONST('OVRPRTF -
N30  D                                     FILE(SAD61PFT) -
     D                                     OUTQ(')
     D XCMD14          C                   CONST('OVRPRTF -
N65  D                                     FILE(SAD61PFR) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(72 83) -
     D                                     CPI(10) -
     D                                     OVRFLW(72) -
     D                                     USRDTA(')
N25  D XCMD21A         C                   CONST('PAGESIZE(108 120) -
N25  D                                     LPI(9) -
N25  D                                     CPI(15) -
N25  D                                     OVRFLW(108) -
N25  D                                     USRDTA(')
S30  D*XCMD22          C                   CONST('PAGESIZE(48 80) -
N30  D XCMD22          C                   CONST('PAGESIZE(48 120) -
     D                                     CPI(10) -
     D                                     OVRFLW(48) -
     D                                     USRDTA(')
s06  D*XCMD23          C                   CONST('PAGESIZE(72 80) -
s11  D*XCMD23          C                   CONST('PAGESIZE(70 83) -
S30  D*XCMD23          C                   CONST('PAGESIZE(70 80) -
S30  D*                                    CPI(10) -
N30  D XCMD23          C                   CONST('PAGESIZE(70 120) -
N30  D                                     CPI(15) -
s06  D*                                    OVRFLW(72) -
n06  D                                     OVRFLW(70) -
     D                                     USRDTA(')
     D XCMD31          C                   CONST(') COPIES(')
     D XCMD01          C                   CONST('CLRPFM -
     D                                     FILE(WFILEIMP) -
     D                                     MBR(SADPRT)')
     D XCMD02          C                   CONST('OVRDBF -
     D                                     FILE(WFILEIMP) -
     D                                     TOFILE(WFILEIMP) -
     D                                     MBR(SADPRT)')
N36  D                 DS
N36  D  KS8FTX                 1     52
N36  D  KS8MIL                52     52
N36  D  KS8ØRE                51     51
     D                 DS
s16  D* FSSOK                  1     35
N16  D  FSSOK00                1     35
     D  FSSO15                 1     15
N08  D  FSSO25                 1     25
N16  D                 DS
N16  D  DFS                    1     10    DIM(10)
N16  D  FSDOKK                 1     10
N16  D                 DS
N16  D  DFRT                   1    210    DIM(3)
     D                 DS
     D  XANTDL                 1      1  0
     D  XANTD2                 1      1
     D                 DS
     D  SINAD                  1     30
N25  D  SINAD2                 1     30
S25  D* SINA26                 1     26
     D  SINA22                 1     22
S27  D*                DS
S27  D* SIPOS                  1      9
S27  D* SIPO06                 1      6
S27  D* SIPO26                 2      6
S27  D* SIPO36                 3      6
S27  D* SIPO46                 4      6
S27  D* SIPO56                 5      6
S27  D* SIPO66                 6      6
     D                 DS
     D  SITRT                  1      7  0
     D  SITRT1                 1      1  0
     D  SIDFVF                 2      2  0
N25  D                 DS
N25  D  SIFRDT                 1      8  0
N25  D  SIFRDTA                1      4  0
N25  D  SIFRDTM                5      6  0
N25  D  SIFRDTD                7      8  0
N25  D                 DS
N25  D  XSIFRDT                1      8  0
N25  D  XSIFRDTD               1      2  0
N25  D  XSIFRDTM               3      4  0
N25  D  XSIFRDTA               5      8  0
N25  D                 DS
N25  D  SIFRT1                 1     70
N25  D  XSIFRT1                1     55
N25  D                 DS
N25  D  SIFRT2                 1     70
N25  D  XSIFRT2                1     55
N25  D                 DS
N25  D  SIFRT3                 1     70
N25  D  XSIFRT3                1     55
N25  D                 DS
N25  D  SIFRT4                 1     70
N25  D  XSIFRT4                1     55
N25  D                 DS
N25  D  SIFRT5                 1     70
N25  D  XSIFRT5                1     55
S27  D*                DS
S27  D* UTGNPO                 1     22
S27  D* UTGN                   1     16
S27  D* UTPO06                17     22
      *____________________
      * DS for BILFORTOLL  NUMERISK EDIT
      *""""""""""""""""""""
     D                 DS
     D  SWTX1A                 1      6  1
     D  SWVK15                 1      5
     D  SWVK25                 2      5
     D  SWVK66                 6      6
     D                 DS
     D  SWTX2A                 1      6  2
     D  SWEF14                 1      4
     D  SWEF24                 2      4
     D  SWEF56                 5      6
     D  SWEF55                 5      5
     D  SWEF66                 6      6
     D                 DS
     D  BN                     1      6
     D                                     DIM(6)                               Bilfort num->Alfa
     D  BILNUM                 1      6
     D                 DS
     D  DSFTXM                 1     36
     D  DSM                    1      5
     D  DSPACB                 7     17
     D  SWTX1C                19     28
     D  SWTX2C                29     38
     D                 DS
     D  DSFTXV                 1     21
     D  DSV                    1      5
     D  DSTX1A                 7     12
     D  DSVSTR                14     15
     D  DSTX1B                17     21
     D                 DS
     D  DSFTXE                 1     21
     D  DSE                    1      5
     D  DSTX2A                 7     12
     D  DSESTR                14     15
     D  DSTX2B                17     21
     D                 DS
     D  DSFTXK                 1     21
     D  DSK                    1      5
     D  DSTX3A                 7     12
     D  DSKSTR                14     15
     D  DSTX3B                17     21
     D                 DS
     D  DSPCIC                 1     21
     D  DSC                    1      5
     D  DSPC1A                 7     12
     D  DSCSTR                14     15
     D  DSPC1B                17     21
     D                 DS
     D  DSPCI                  1     42
     D  DSC2                   1      6
     D  DSPC2B                 7     12
     D  DSC22                 14     16
     D  SWPC1C                17     17
     D  DSC23                 18     18
     D  DSPROS                19     24
     D  DSPROT                25     25
     D  DSPC2C                26     31
     D  DSC24                 33     42
      *  SI28 I SADH ER TATT I BRUK (FØRST 15 POS.)
      *  PGA. ENDRING AV REGISTER BESKRIVELSE (SE SADH)
      *  GJØR VI FØLGENDE DOBBEL DEFINISJON.
     D                 DS
     D  SI28                   1     28
     D  SIBELC                 1     11  2
     D  SIRAB                 12     15  2
     D  SIRABX                12     15
     D  SI27                   1     27
N32  D                 DS
N32  D  SIFT3                  1     45
N32  D  SIFT32                 1     45
N32  D                 DS
N32  D  SIFT4                  1     45
N32  D  SIFT42                 1     45
N106 D                 DS
N106 D  CNR50                  1    850
N106 D  CNR                    1    850    DIM(50)
      *
     D                 DS
     D  KO                     1      3
     D  TAORDK                 1      1
     D  TAEFTK                 2      2
     D  TAEFK                  3      3
     D                 DS
S29  D* TS                     1     15
S29  D* TAORDB                 1      5  2
S29  D* TAEFTB                 6     10  2
S29  D* TAEFB                 11     15  2
     D                 DS
     D  WFIRNR                 1      5  0
     D  XN2                    2      5  0
N34  D                 DS
N34  D  WFIVKB                 1      9  0
N34  D  WFIVKB123              1     12  3
N34  D                 DS
N34  D  WFIVKN                 1      9  0
N34  D  WFIVKN123              1     12  3
     D                 DS
     D  WFITY1                 1      2
     D  WFITY2                 3      4
     D  WFITY3                 5      6
     D  WFITY4                 7      8
     D  WFITY5                 9     10
     D  WFITY6                11     12
     D  WFITY7                13     14
     D  WFITY8                15     16
     D  Y2                     1     14    DIM(7)
     D                 DS
     D  WFISK1                 1      3
     D  WFISK2                 4      6
     D  WFISK3                 7      9
     D  WFISK4                10     12
     D  WFISK5                13     15
     D  WFISK6                16     18
     D  WFISK7                19     21
     D  WFISK8                22     24
     D  E2                     1     21    DIM(7)
     D                 DS
E78  D  WFIGL1                 1     13  2
E78  D  WFIGL2                14     26  2
E78  D  WFIGL3                27     39  2
E78  D  WFIGL4                40     52  2
E78  D  WFIGL5                53     65  2
E78  D  WFIGL6                66     78  2
E78  D  WFIGL7                79     91  2
E78  D  WFIGL8                92    104  2
E78  D  G2                     1     91  2 DIM(7)
     D                 DS
     D  WFIST1                 1      7  2
     D  WFIST2                 8     14  2
     D  WFIST3                15     21  2
     D  WFIST4                22     28  2
     D  WFIST5                29     35  2
     D  WFIST6                36     42  2
     D  WFIST7                43     49  2
     D  WFIST8                50     56  2
     D  S2                     1     49  2 DIM(7)
     D                 DS
     D  WFIPR1                 1      1
     D  WFIPR2                 2      2
     D  WFIPR3                 3      3
     D  WFIPR4                 4      4
     D  WFIPR5                 5      5
     D  WFIPR6                 6      6
     D  WFIPR7                 7      7
     D  WFIPR8                 8      8
     D  P2                     1      7    DIM(7)
     D                 DS
E78  D  WFIBL1                 1     13  2
E78  D  WFIBL2                14     26  2
E78  D  WFIBL3                27     39  2
E78  D  WFIBL4                40     52  2
E78  D  WFIBL5                53     65  2
E78  D  WFIBL6                66     78  2
E78  D  WFIBL7                79     91  2
E78  D  WFIBL8                92    104  2
E78  D  B2                     1     91  2 DIM(7)
     D                 DS
S34  D* WFIKN1                 1     17
S34  D* WFIKN2                18     34
S34  D* WFIKN3                35     51
S34  D* WFIKN4                52     68
S34  D* WFIKN5                69     85
S34  D* WFIKN6                86    102
S34  D* WFIKN7               103    119
S34  D* KN                     1    119    DIM(7) ASCEND                        Merke & nummer
N34  D  WFIKN1                 1     28
N34  D  WFIKN1A                1     24
N34  D  WFIKN2                29     56
N34  D  WFIKN2A               29     52
N34  D  WFIKN3                57     84
N34  D  WFIKN3A               57     80
N34  D  WFIKN4                85    112
N34  D  WFIKN4A               85    108
N34  D  WFIKN5               113    140
N34  D  WFIKN5A              113    136
N34  D  WFIKN6               141    168
N34  D  WFIKN6A              141    164
N34  D  WFIKN7               169    196
N34  D  WFIKN7A              169    192
N34  D  KN                     1    196    DIM(7) ASCEND                        Merke & nummer
     D                 DS
S34  D* WFIVB1                 1     15
S34  D* WFIVB2                16     30
S34  D* WFIVB3                31     45
S34  D* WFIVB4                46     60
S34  D* WFIVB5                61     75
S34  D* WFIVB6                76     90
S34  D* WFIVB7                91    105
S34  D* WFIVB72               91    105
S34  D* VB                     1    105    DIM(7) ASCEND                        Varebeskr
N34  D  WFIVB1                 1     30
N34  D  WFIVB2                31     60
N34  D  WFIVB3                61     90
N34  D  WFIVB4                91    120
N34  D  WFIVB5               121    150
N34  D* WFIVB6               151    180
N106 D  WFIVB6               151    180
N34  D* WFIVB7               181    210
N106 D  WFIVB7               181    210
N34  D* WFIVB72              181    210
N106 D  WFIVB8               211    240
S77  D* VB                     1    210    DIM(7) ASCEND                        Varebeskr
N77  D  VB                     1    360    DIM(12) ASCEND                       Varebeskr
     D                 DS
     D  WFITO1                 1     45
N30  D  WFITO1A                1     17
     D  WFITO2                46     90
N30  D  WFITO2A               46     62
     D  WFITO3                91    135
N30  D  WFITO3A               91    107
     D  WFITO4               136    180
N30  D  WFITO4A              136    152
     D  WFITO5               181    225
N30  D  WFITO5A              181    197
N34  D  WFITO6               226    270
N34  D  WFITO6A              226    242
N34  D  WFITO7               271    315
N34  D  WFITO7A              271    287
N34  D  WFITO8               316    360
N34  D  WFITO9               361    405
N34  D  WFITO10              406    450
N34  D  WFITO11              451    495
N34  D  WFITO12              496    540
N34  D  WFITO13              541    585
N34  D  WFITO14              586    630
N34  D  WFITO15              631    675
S34  D* TO                     1    225    DIM(5)                               Til.opl
N34  D  TO                     1    675    DIM(15)
     D                 DS
     D  WFITC1                 1      3
     D  WFITC2                 4      6
     D  WFITC3                 7      9
     D  WFITC4                10     12
     D  WFITC5                13     15
N34  D  WFITC6                16     18
N34  D  WFITC7                19     21
N34  D  WFITC8                22     24
N34  D  WFITC9                25     27
N34  D  WFITC10               28     30
N34  D  WFITC11               31     33
N34  D  WFITC12               34     36
N34  D  WFITC13               37     39
N34  D  WFITC14               40     42
N34  D  WFITC15               43     45
S34  D* TC                     1     15    DIM(5)                               Cref ved komm.
N34  D  TC                     1     45    DIM(15)                              Cref ved komm.
N25  D                 DS
N25  D  WFIPRE                 1      1
N25  D  WFIPRE2                1      1
N25  D                 DS
N25  D  WFIVT                  1      4
N25  D  WFIVT1                 1      4
N25  D                 DS
N25  D  WFIANT                 1      6  0
N25  D  WFIANT1                1      6  0
N25  D                 DS
N25  D  WTY01                  1      2
N25  D  WTY011                 1      2
N25  D  WTY012                 1      2
N25  D  WTY013                 1      2
N25  D  WTY02                  3      4
N25  D  WTY03                  5      6
N25  D  WTY04                  7      8
N25  D  WTY05                  9     10
N25  D  WTY06                 11     12
N25  D  WTY07                 13     14
N25  D  WTY08                 15     16
N25  D  WTY09                 17     18
N25  D  WTY10                 19     20
N25  D  WTY11                 21     22
N25  D  WTY12                 23     24
N25  D  WTY13                 25     26
N25  D  WTY14                 27     28
N25  D  WTY15                 29     30
N25  D  WTY16                 31     32
N25  D  WTY17                 33     34
N25  D  WTY18                 35     36
N25  D  WTY19                 37     38
N25  D  WTY20                 39     40
N25  D  WTY21                 41     42
N25  D  WTY22                 43     44
N25  D  WTY23                 45     46
N25  D  WTY24                 47     48
N25  D  Y1                     1     48    DIM(24)
N25  D                 DS
E78  D  WGL01                  1     13  2
E78  D  WGL012                 1     13  2
E78  D  WGL02                 14     26  2
E78  D  WGL03                 27     39  2
E78  D  WGL04                 40     52  2
E78  D  WGL05                 53     65  2
E78  D  WGL06                 66     78  2
E78  D  WGL07                 79     91  2
E78  D  WGL08                 92    104  2
E78  D  WGL09                105    117  2
E78  D  WGL10                118    130  2
E78  D  WGL11                131    143  2
E78  D  WGL12                144    156  2
E78  D  WGL13                157    169  2
E78  D  WGL14                170    182  2
E78  D  WGL15                183    195  2
E78  D  WGL16                196    208  2
E78  D  WGL17                209    221  2
E78  D  WGL18                222    234  2
E78  D  WGL19                235    247  2
E78  D  WGL20                248    260  2
E78  D  WGL21                261    273  2
E78  D  WGL22                274    286  2
E78  D  WGL23                287    299  2
E78  D  WGL24                300    312  2
E78  D  G1                     1    312  2 DIM(24)
E78  D                 DS
E78  D  WGL01A                 1     11  0
E78  D  WGL01A2                1     11  0
E78  D  WGL02A                12     22  0
E78  D  WGL03A                23     33  0
E78  D  WGL04A                34     44  0
E78  D  WGL05A                45     55  0
E78  D  WGL06A                56     66  0
E78  D  WGL07A                67     77  0
E78  D  WGL08A                78     88  0
E78  D  WGL09A                89     99  0
E78  D  WGL10A               100    110  0
E78  D  WGL11A               111    121  0
E78  D  WGL12A               122    132  0
E78  D  WGL13A               133    143  0
E78  D  WGL14A               144    154  0
E78  D  WGL15A               155    165  0
E78  D  WGL16A               166    176  0
E78  D  WGL17A               177    187  0
E78  D  WGL18A               188    198  0
E78  D  WGL19A               199    209  0
E78  D  WGL20A               210    220  0
E78  D  WGL21A               221    231  0
E78  D  WGL22A               232    242  0
E78  D  WGL23A               243    253  0
E78  D  WGL24A               254    264  0
E78  D  G11                    1    264  0  DIM(24)
N25  D                 DS
N25  D  WST01                  1      7  2
N25  D  WST012                 1      7  2
N25  D  WST02                  8     14  2
N25  D  WST03                 15     21  2
N25  D  WST04                 22     28  2
N25  D  WST05                 29     35  2
N25  D  WST06                 36     42  2
N25  D  WST07                 43     49  2
N25  D  WST08                 50     56  2
N25  D  WST09                 57     63  2
N25  D  WST10                 64     70  2
N25  D  WST11                 71     77  2
N25  D  WST12                 78     84  2
N25  D  WST13                 85     91  2
N25  D  WST14                 92     98  2
N25  D  WST15                 99    105  2
N25  D  WST16                106    112  2
N25  D  WST17                113    119  2
N25  D  WST18                120    126  2
N25  D  WST19                127    133  2
N25  D  WST20                134    140  2
N25  D  WST21                141    147  2
N25  D  WST22                148    154  2
N25  D  WST23                155    161  2
N25  D  WST24                162    168  2
N25  D  S1                     1    168  2 DIM(24)
N25  D                 DS
N25  D  WPR01                  1      1
N25  D  WPR012                 1      1
N25  D  WPR02                  2      2
N25  D  WPR03                  3      3
N25  D  WPR04                  4      4
N25  D  WPR05                  5      5
N25  D  WPR06                  6      6
N25  D  WPR07                  7      7
N25  D  WPR08                  8      8
N25  D  WPR09                  9      9
N25  D  WPR10                 10     10
N25  D  WPR11                 11     11
N25  D  WPR12                 12     12
N25  D  WPR13                 13     13
N25  D  WPR14                 14     14
N25  D  WPR15                 15     15
N25  D  WPR16                 16     16
N25  D  WPR17                 17     17
N25  D  WPR18                 18     18
N25  D  WPR19                 19     19
N25  D  WPR20                 20     20
N25  D  WPR21                 21     21
N25  D  WPR22                 22     22
N25  D  WPR23                 23     23
N25  D  WPR24                 24     24
N25  D  P1                     1     24    DIM(24)
E78  D                 DS
E78  D  WBL01                  1     11  0
E78  D  WBL02                 12     22  0
E78  D  WBL03                 23     33  0
E78  D  WBL04                 34     44  0
E78  D  WBL05                 45     55  0
E78  D  WBL06                 56     66  0
E78  D  WBL07                 67     77  0
E78  D  WBL08                 78     88  0
E78  D  WBL09                 89     99  0
E78  D  WBL10                100    110  0
E78  D  WBL11                111    121  0
E78  D  WBL12                122    132  0
E78  D  WBL13                133    143  0
E78  D  WBL14                144    154  0
E78  D  WBL15                155    165  0
E78  D  WBL16                166    176  0
E78  D  WBL17                177    187  0
E78  D  WBL18                188    198  0
E78  D  WBL19                199    209  0
E78  D  WBL20                210    220  0
E78  D  WBL21                221    231  0
E78  D  WBL22                232    242  0
E78  D  WBL23                243    253  0
E78  D  WBL24                254    264  0
E78  D  B1                     1    264  0 DIM(24)
N30  D                 DS
N30  D  WTR01                  1      2
N30  D  WTR02                  3      4
N30  D  WTR03                  5      6
N30  D  WTR04                  7      8
N30  D  WTR05                  9     10
N30  D  WTR06                 11     12
N30  D  WTR07                 13     14
N30  D  WTR08                 15     16
N30  D  WTR09                 17     18
N30  D  WTR10                 19     20
N30  D  WTR11                 21     22
N30  D  WTR12                 23     24
N30  D  WTR13                 25     26
N30  D  WTR14                 27     28
N30  D  WTR15                 29     30
N30  D  WTR16                 31     32
N30  D  WTR17                 33     34
N30  D  WTR18                 35     36
N30  D  WTR19                 37     38
N30  D  WTR20                 39     40
N30  D  WTR21                 41     42
N30  D  WTR22                 43     44
N30  D  WTR23                 45     46
N30  D  WTR24                 47     48
N25  D  TR                     1     48    DIM(24)
N25  D                 DS
N25  D  WT101                  1      2
N25  D  WT102                  3      4
N25  D  WT103                  5      6
N25  D  WT104                  7      8
N25  D  WT105                  9     10
N25  D  WT106                 11     12
N25  D  WT107                 13     14
N25  D  WT108                 15     16
N25  D  WT109                 17     18
N25  D  WT110                 19     20
N25  D  WT111                 21     22
N25  D  WT112                 23     24
N25  D  WT113                 25     26
N25  D  WT114                 27     28
N25  D  WT115                 29     30
N25  D  WT116                 31     32
N25  D  WT117                 33     34
N25  D  WT118                 35     36
N25  D  WT119                 37     38
N25  D  WT120                 39     40
S47  D* T1                     1     40    DIM(20)
N47  D  T1                     1     80    DIM(40)
E78  D                 DS
E78  D  WT201                  1     11  0
E78  D  WT202                 12     22  0
E78  D  WT203                 23     33  0
E78  D  WT204                 34     44  0
E78  D  WT205                 45     55  0
E78  D  WT206                 56     66  0
E78  D  WT207                 67     77  0
E78  D  WT208                 78     88  0
E78  D  WT209                 89     99  0
E78  D  WT210                100    110  0
E78  D  WT211                111    121  0
E78  D  WT212                122    132  0
E78  D  WT213                133    143  0
E78  D  WT214                144    154  0
E78  D  WT215                155    165  0
E78  D  WT216                166    176  0
E78  D  WT217                177    187  0
E78  D  WT218                188    198  0
E78  D  WT219                199    209  0
E78  D  WT220                210    220  0
S47  D* T2                     1    180  0  DIM(20)
E78  D  T2                     1    440  0  DIM(40)
     D                 DS
     D  XWFVN1                 1      6  0
     D  XWFVN2                 7      8  0
     D  WFIVNT                 1      8  0
     D                 DS
     D  XDP1                   1      1  0
     D  XDP2                   2      2  0
     D  SIDP                   1      2  0
     D                 DS
E78  D  WFITOL                 1     11  0
E78  D  XWFTOL                 1     13  2
     D                 DS
E78  D  WFITLG                 1     11  0
E78  D  XWFTLG                 1     13  2
     D                 DS
     D  WFISTB                 1     13  0
     D  XWFSTB                 1     15  2
     D                 DS
     D  SIFIDÅ                 1      4  0
     D  SIFIDM                 5      6  0
     D  SIFIDD                 7      8  0
     D  SIFID                  1      8  0
     D                 DS
     D  SFÅR                   1      4  0
     D  SFMND                  5      6  0
     D  SFDAG                  7      8  0
     D  SFDT                   1      8  0
     D                 DS
     D  SVVNT                  1      8  0
     D  SVLK                   9     10
     D  SVTN                  11     11
     D  SVPRE                 12     12
S29  D* SVAS                  13     17  2
S29  D* SVPVA                 18     18
S29  D* SVMFR                 19     19
S29  D* SVVF                  20     20
S29  D* XBRUD1                 1     20
N29  D  SVAS                  13     19  2
N29  D  SVPVA                 20     20
N29  D  SVMFR                 21     21
N29  D  SVVF                  22     22
S94  D* XBRUD1                 1     22
N94  D  SVDP                  23     24  0
N94  D  XBRUD1                 1     24
     D                 DS
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D  XTOPP                  1     45
     D                 DS
     D  SWKTGR                 1     30
     D  SWKTGX                 1     26
     D                 DS
     D  DTWS                   1     10
     D  DTUSER                11     20
     D  DTIN39                21     21
     D  DTPRT1                22     31
     D  DTPRT2                32     41
     D  DTPRT3                42     51
     D  DTDTA                  1    128
n01  D                 DS
n01  D  SIDTG                  1     10
n01  D  SIAAR                  1      4
n01  D  SIMND                  5      6
n01  D  SIDAG                  7      8
n01  D                 DS
n01  D  PRODAT                 1     10
n01  D  PRAAR                  1      4
n01  D  PRMND                  6      7
n01  D  PRDAG                  9     10
N64  D                 DS
N64  D  TOMBL                  1     40    DIM(4)
N64  D  TO1_SITLL              1     10
N64  D  TO2_SITLL             11     20
N64  D  TO3_SITLL             21     30
N64  D  TO4_SITLL             31     40
N64  D                 DS
N64  D  TOMBE                  1     24    DIM(4)
N64  D  TO1_SITLE              1      6
N64  D  TO2_SITLE              7     12
N64  D  TO3_SITLE             13     18
N64  D  TO4_SITLE             19     24
     D                 DS
     D  SVAKD1                 1      2
     D  SVAKD2                 3      4
     D  SVAKD3                 5      6
     D  SVAKD4                 7      8
     D  SVAKD5                 9     10
     D  SVAKD6                11     12
     D  SVAKD7                13     14
     D  SVAKD8                15     16
     D  SVAKD                  1     16    DIM(8)
     D                 DS
     D  SVASV1                 1      3
     D  SVASV2                 4      6
     D  SVASV3                 7      9
     D  SVASV4                10     12
     D  SVASV5                13     15
     D  SVASV6                16     18
     D  SVASV7                19     21
     D  SVASV8                22     24
     D  SVASV                  1     24    DIM(8)
     D                 DS
     D  SVASA1                 1      7  2
     D  SVASA2                 8     14  2
     D  SVASA3                15     21  2
     D  SVASA4                22     28  2
     D  SVASA5                29     35  2
     D  SVASA6                36     42  2
     D  SVASA7                43     49  2
     D  SVASA8                50     56  2
     D  SVASA                  1     56  2 DIM(8)
     D                 DS
E78  D  SVAGR1                 1     13  2
E78  D  SVAGR2                14     26  2
E78  D  SVAGR3                27     39  2
E78  D  SVAGR4                40     52  2
E78  D  SVAGR5                53     65  2
E78  D  SVAGR6                66     78  2
E78  D  SVAGR7                79     91  2
E78  D  SVAGR8                92    104  2
E78  D  SVAGR                  1    104  2 DIM(8)
     D                 DS
E78  D  SVABL1                 1     13  2
E78  D  SVABL2                14     26  2
E78  D  SVABL3                27     39  2
E78  D  SVABL4                40     52  2
E78  D  SVABL5                53     65  2
E78  D  SVABL6                66     78  2
E78  D  SVABL7                79     91  2
E78  D  SVABL8                92    104  2
E78  D  SVABL                  1    104  2 DIM(8)
     D                 DS
     D  SVEH21                 1      1
     D  SVEH22                 2      2
     D  SVEH23                 3      3
     D  SVEH24                 4      4
     D  SVEH25                 5      5
     D  SVEH26                 6      6
     D  SVEH27                 7      7
     D  SVEH28                 8      8
     D  SVEH2                  1      8    DIM(8)
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  SVFT                   1    224    DIM(8)
     D                 DS
     D  SVNT01                 1      6  0
     D  SVNT02                 7     12  0
     D  SVNT03                13     18  0
     D  SVNT04                19     24  0
     D  SVNT05                25     30  0
     D  SVNT06                31     36  0
     D  SVNT07                37     42  0
     D  SVNT                   1     48  0 DIM(8)
     D                 DS
     D  SVEH01                 1      4
     D  SVEH02                 5      8
     D  SVEH03                 9     12
     D  SVEH04                13     16
     D  SVEH05                17     20
     D  SVEH06                21     24
     D  SVEH07                25     28
     D  SVEH                   1     32    DIM(8)
     D                 DS
     D  SVVT01                 1     30
     D  SVVT02                31     60
     D  SVVT03                61     90
     D  SVVT04                91    120
     D  SVVT05               121    150
     D  SVVT                   1    240    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  SVTOP                  1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  SVTCR                  1     33    DIM(11)
     C*
     C                   MOVEL     'SAD61PQ'     UDTAQ            10
     C                   MOVEL     '*LIBL'       ULIBL            10
     C                   Z-ADD     128           ULENGT            5 0
     C                   MOVE      *BLANKS       UDTA            128
     C                   Z-SUB     99999         UWAIT             5 0
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
N102 C     'TVI00007'    CHAIN     SYPTFF                             33
N102 C   33              MOVE      *ZEROS        PTFDT
N102 C                   CALL      'SYGE15C'
N102 C                   PARM                    WDT               8
N102 C                   PARM                    WTM               6
N102 C                   MOVE      WDT           WDT80             8 0
      *
     C     START0        TAG
     C                   EXSR      INIT
      *
      * SPESIALBEHANDLING VED FAX
      *
     C     PRTTYP        IFEQ      'F'
     C     PRTTYP        oreq      'A'
N43  C     PRTTYP        OREQ      'X'
     C                   SETON                                        32
     C     PRTAVX        CHAIN     STANDI                             33
     C     FAXTD         CHAIN(N)  SADH                               30
N59  C  N30              MOVE      SISG          SISGDE            3
     C  N30              EXSR      PRINT
     C                   GOTO      SLUTT
     C                   END
     C     PRTTYP        IFEQ      'U'
     C     PRTAVX        CHAIN     STANDI                             33
     C     FAXTD         CHAIN(N)  SADH                               30
N59  C  N30              MOVE      SISG          SISGDE            3
     C  N30              EXSR      PRINT
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** LES TOLLDEK. FRA SADH-REGISTER. OG TEST OM AVDELING ER SAMMEN
     C***   SOM FORRIGE TOLLDEK. HVIS IKKE, GÅ UT PROGRAM FOR Å HENTE
     C***   AVDELINGS OPPLYSNINGER
     C*
     C     SADH8K        SETLL     SADH8                              30
     C     START         TAG
     C     SADH8K        READE     SADH8                                  30
N98  C  N30SISGDE        IFNE      SISG
N98  C     SISGDE        ANDNE     *BLANKS
N98  C                   MOVE      SISG          SISGDE            3
N98  C                   GOTO      SLUTT
N98  C                   END
s98  C* N30              MOVE      SISG          SISGDE            3
     C  N30SIAVD         IFNE      UAVD
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** IND. 32 PÅ BETYR AT DET SKAL KOMME UT UTSKRIFT.
     C*** UTOLK = J ---> DENNE TOLLDEK. SKAL VIA KOMMUNIKASJON (TVINN)
     C  N30UTOLK         IFEQ      'J'
     C     SIPKL         COMP      'J'                                    32
     C                   EXSR      PRINT
     C                   ELSE
     C                   SETON                                        32
     C                   EXSR      PRINT
     C                   END
     C*
     C*** FERDIG Å BEHANDLE EN TOLLDEK. OG GÅ TIL NESTE TOLLDEK.
     C  N30              GOTO      START
     C*
     C     SLUTT         TAG
     C                   CLOSE     WFILEIMP
N25  C                   CLOSE     SAD61PF
     C                   CLOSE     TOLLDEK2
N30  C                   CLOSE     SAD61PFT
N65  C                   CLOSE     SAD61PFR
     C     PRTTYP        IFNE      'F'
     C     PRTTYP        ANDNE     'A'
N43  C     PRTTYP        ANDNE     'X'
     C     PRTTYP        ANDNE     'H'
     C     PRTTYP        ANDNE     'U'
     C                   GOTO      START0
     C                   ELSE
      * FORTELLER FAX OM DATALISTE ER PRODUSERT
     C                   MOVE      FAXDE2        PRTTYP
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
S11  C*  32XÅPN          IFEQ      'J'
s20  C*    32            DO
n20  C   32              DO
N25  C                   CLOSE     SAD61PF
     C                   CLOSE     TOLLDEK2
N30  C                   CLOSE     SAD61PFT
N65  C                   CLOSE     SAD61PFR
N25  C                   OPEN      SAD61PF
     C                   OPEN      TOLLDEK2
N30  C                   OPEN      SAD61PFT
N65  C                   OPEN      SAD61PFR
     C                   END
N72   *
N72  C                   MOVE      *BLANKS       X_SYMVSP          1
N72  C     CUNDL01K      CHAIN     CUNDL01                            33
N72  C  N33              MOVE      SYMVSP        X_SYMVSP
      *
N108 C*                  EVAL      XDEKLID = *BLANKS
N53  C                   IF        SITDN < 0                                    1<-B
N53  C                   EVAL      SITDN = SITDN * -1
N53  C     SADHK         CHAIN(N)  SADH                               33
N59  C  N33              MOVE      SISG          SISGDE            3
N53  C                   MOVE      SIDTG         OMB_SIDTG
N53  C                   MOVE      SITLL         OMB_SITLL
N53  C                   MOVE      SITLE         OMB_SITLE
N56   * HENT OPPRINNELIG FORTOLLINGSDATO
N56  C                   MOVE      SIDT          X_M0068A          8 0
N56  C     TVIM4K        SETLL     EDIM4
N56  C     TVI41K        READPE    EDIM4                                  33
N56  C                   IF        *IN33                                         2<-B
N56  C                   MOVE      *ZEROS        XAN02             2
N56  C                   IF        %SUBST(SIDTG:1:2) = '20'                       3<-B
N56  C                   EVAL      XAN02 = %SUBST(SIDTG:3:2)
N56  C                   MOVE      XAN02         XAAR
N56  C                   EVAL      XAN02 = %SUBST(SIDTG:7:2)
N56  C                   MOVE      XAN02         XMND
N56  C                   EVAL      XAN02 = %SUBST(SIDTG:9:2)
N56  C                   MOVE      XAN02         XDAG
N56  C                   CALL      'TESTDATO'
N56  C                   PARM                    XDAG              2 0
N56  C                   PARM                    XMND              2 0
N56  C                   PARM                    XAAR              2 0
N56  C                   PARM                    FLAGG             1 0
N56  C                   IF        FLAGG <> 1                                      4<-B
N56  C                   MOVEL     SIDTG         X_M0068A
N56  C                   END                                                       4<-E
N56  C                   END                                                      3<-E
N56  C                   ELSE                                                    2
N56  C                   DOW       *IN33 = *OFF                                   3<-B
N56  C                   IF        M1N07 = 'DTK' OR M1N07 = 'DUA'                  4<-B
N56  C                   MOVE      M0068A        X_M0068A
N56  C                   LEAVE
N56  C                   END                                                       4<-E
N56  C     TVI41K        READPE    EDIM4                                  33
N56  C                   ENDDO                                                    3<-E
N56  C                   END                                                     2<-E
N56   *
N53  C                   EVAL      SITDN = SITDN * -1
N56  C                   ELSE                                                   1
N56   * HENT FORTOLLINGSDATO
N56  C                   MOVE      SIDT          X_M0068A          8 0
N56  C     TVIM4K        SETLL     EDIM4
N56  C     TVI41K        READPE    EDIM4                                  33
N56  C                   DOW       *IN33 = *OFF                                  2<-B
N56  C                   IF        M1N07 = 'DTK' OR M1N07 = 'DUA'                 3<-B
N56  C                   MOVE      M0068A        X_M0068A
N108 C*                  EVAL      XDEKLID = M0068
N56  C                   LEAVE
N56  C                   END                                                      3<-E
N56  C     TVI41K        READPE    EDIM4                                  33
N56  C                   ENDDO                                                   2<-E
N53  C                   END                                                    1<-E
N07  C     PRTTYP        IFEQ      'F'                                          1<-B
N07  C     PRTTYP        OREQ      'A'
N43  C     PRTTYP        OREQ      'X'
N07  C     SADHK         CHAIN(N)  SADH                               33
N59  C  N33              MOVE      SISG          SISGDE            3
N07  C                   ELSE                                                   1
     C     SADHK         CHAIN     SADH                               33
N59  C  N33              MOVE      SISG          SISGDE            3
N07  c                   END                                                    1<-E
     C   33              GOTO      SLPRI
N62  C                   EXSR      EPOSTSR
N43   *
N43  C                   MOVE      'N'           XSNDEMMA          1
N43  C                   IF        PRTTYP = 'X'                                 1<-B
N104 C                   MOVE      'E'           XTILMOTTAK        1            E=EMMA
N43  C     CUNDC01K      CHAIN     CUNDC01                            36
N104 C                   IF        *IN33                                         2<-B
N104 C     CUNDC01KPRO   CHAIN     CUNDC01                            33
N104 C  N33              MOVE      'P'           XTILMOTTAK        1            P=PROTERIA
N104 C                   END                                                     2<-E
N43  C                   DOW       *IN36 = *OFF                                  2<-B
N43  C                   IF        CTYPE = '*SAD IMPORT' AND CLIVE = 'X'          3<-B
N43  C     EDIM4KS       SETLL     EDIM4
N43  C     EDIM4KS       READPE    EDIM4                                  36
N43  C                   DOW       *IN36 = *OFF                                    4<-B
N43  C                   IF        M0065 = 'XMLEMA' AND M1001 = '929'               5<-B
N43  C                   GOTO      STPRI0
N43  C                   END                                                        5<-E
N43  C     EDIM4KS       READPE    EDIM4                                  36
N43  C                   ENDDO                                                     4<-E
N43  C   36              EVAL      XSNDEMMA = 'J'
N43  C                   GOTO      STPRI0
N43  C                   END                                                      3<-E
N104 C                   IF        XTILMOTTAK = 'E'                               3<-B
N43  C     CUNDC01K      READE     CUNDC01                                36
N104 C                   ELSE                                                     3
N104 C     CUNDC01KPRO   CHAIN     CUNDC01                            33
N104 C                   END                                                      3<-E
N43  C                   ENDDO                                                   2<-E
N43  C     STPRI0        TAG
N43  C                   IF        XSNDEMMA = 'N'                                2<-B
S107 C*                  EVAL      *INLR = *OFF
N107 C                   EVAL      *INLR = *ON
N43  C                   RETURN
N43  C                   END                                                     2<-E
N43  C                   END                                                    1<-E
N25   *
N25  C                   MOVE      *BLANKS       Y1
N25  C                   MOVE      *ZEROS        G1
N25  C                   MOVE      *ZEROS        G11
N25  C                   MOVE      *ZEROS        S1
N25  C                   MOVE      *BLANKS       P1
N25  C                   MOVE      *ZEROS        B1
N25  C                   MOVE      *BLANKS       T1
N25  C                   MOVE      *ZEROS        T2
N25   * HENT MIDLERTIDIG DEKLARASJONS INFORMASJON
N25  C     SADHK         CHAIN     SADHMD                             36
N25  C                   IF        *IN36                                        1<-B
N25  C                   EVAL      XSIFRDT = 0
N25  C                   EVAL      XSIFRT1 = *BLANKS
N25  C                   EVAL      XSIFRT2 = *BLANKS
N25  C                   EVAL      XSIFRT3 = *BLANKS
N25  C                   EVAL      XSIFRT4 = *BLANKS
N25  C                   EVAL      XSIFRT5 = *BLANKS
N25  C                   ELSE                                                   1
N25  C                   EVAL      XSIFRDTD = SIFRDTD
N25  C                   EVAL      XSIFRDTM = SIFRDTM
N25  C                   EVAL      XSIFRDTA = SIFRDTA
N25  C                   END                                                    1<-E
N25   *
n01   * fikser dato  dagens hvis ikke godkjent
n01  c                   movel     '    .  .  '  prodat
n01  C     sidtg         ifne      *blanks                                      1<-B
n01  c                   move      sidag         prdag
n01  c                   move      simnd         prmnd
n01  c                   move      siaar         praar
n01  c                   else                                                   1
n01  c                   move      '2000'        praar
n01  c                   move      uyear         praar
n01  c                   move      umonth        prmnd
n01  c                   move      uday          prdag
n01  c                   end                                                    1<-E
      * IKKE SKRIV UT HELE PERSONNR. FOR PRIVATPERSONER
     C     1             SUBST     SIRG:11       PERSN             1
     C     PERSN         COMP      *BLANKS                            8989
N25  C                   IF        *IN89                                        1<-B
N25  C                   EVAL      SIRGPRI = %SUBST(SIRG:1:6) + '*****'
N25  C                   END                                                    1<-E
     C                   MOVE      SIFIF         XSIFIF           17
     C                   MOVE      SIFID         XSIFID            8 0
     C                   CLEAR                   WFILEIR
     C                   CLEAR                   SADVR
     C* IND 27 OFF = MOTORVOGNFORTOLLING  (XNR=ANT. LINJER)
     C     SADHK         SETGT     SADW
     C     SADHK         READPE    SADW                                   27
     C     *IN27         IFEQ      '0'                                          1<-B
     C                   MOVE      'J'           MVOGN             1
     C                   MOVE      'J'           MVOREG            1            SKRIV REG.K.
     C                   ELSE                                                   1
     C                   MOVE      'N'           MVOGN
     C                   MOVE      'N'           MVOREG
     C                   END                                                    1<-E
      *
     C     TVIM4K        SETLL     EDIM4
     C     STPRI1        TAG
     C     TVI41K        READPE    EDIM4                                  33
     C  N33M1N07         IFEQ      'DIU'                                        1<-B
     C                   MOVE      '1'           *IN33
     C                   ELSE                                                   1
     C     M1N07         IFNE      'DUA'                                         2<-B
     C     M1N07         ANDNE     'DME'
     C     M1N07         ANDNE     'DPU'
     C     M1N07         ANDNE     'DTK'
     C                   GOTO      STPRI1
     C                   END                                                     2<-E
     C     M1001         CABNE     '929'         STPRI1
     C                   END                                                    1<-E
S56  C*    *IN33         IFEQ      '0'
S56  C*                  MOVE      M0068A        XIDT              8 0
S56  C*                  ELSE
S56  C*                  MOVE      SIDT          XIDT
S56  C*                  END
     C                   SETOFF                                       33
      *
N50   *** IND. 37 PÅ BETYR UTLEVERINGSATTEST
N50  C     SITDN         COMP      0                                    26
N50  C   26SADHK         CHAIN     SADHOM                             33
      *** IND. 37 PÅ BETYR UTLEVERINGSATTEST
     C     SIMF          COMP      'DUA'                                  37
      *
     C     SIMF          COMP      'DTK'                                  29
N72   *
N72   * TØM VARELINJER I SADVAVG
N72  C*  39              IF        *IN37 = *OFF OR *IN26
N88  C                   IF        PRTTYP <> 'X'                                1<-B
N72  C     SADHK         SETLL     SADVAVG
N72  C     SADHK         READE     SADVAVG                                33
N72  C                   DOW       *IN33 = *OFF                                  2<-B
N72  C                   DELETE    SADVAVGR
N72  C     SADHK         READE     SADVAVG                                33
N72  C                   ENDDO                                                   2<-E
N88  C                   END                                                    1<-E
N72  C*                  END
N13   *
N13   * VED KONTAKTOPPGJØR HENTER FAKTURA
N13  C     FRIKEYTLI     CHAIN     FRISOK                             33
N13  C  N33              EVAL      XBETALT = 'Betalt: '
N13  C  N33              EVAL      XFAKTNR = 'Fakturanr: '
N13  C                             + %TRIM(FSSOK)
s92  C*  33              MOVE      *BLANKS       XBETALT          30
n92  C   33              MOVE      *BLANKS       XBETALT
N13  C   33              MOVE      *BLANKS       XFAKTNR          30
N13   *
N13   * VED KONTAKTOPPGJØR HENTER BETALINGSREF
N13  C     FRIKEYTLP     CHAIN     FRISOK                             33
N13  C  N33              EVAL      XBETALL = 'Betalingsref: '
N13  C                             + %TRIM(FSSOK)
N13  C   33              MOVE      *BLANKS       XBETALL          30
N13   *
      *
N16  C                   MOVE      *BLANKS       FSSOK00
     C     FRIKEY        CHAIN     FRISOK                             33
s09  C*  33              MOVE      *BLANKS       FSSOK
N09  C                   move      *blanks       kuref            21
N09  C     *in33         ifeq      '1'                                          1<-B
N09  C                   MOVE      *BLANKS       FSSOK
N09  C                   move      sitdn         sitdna            7
N50  C   26              Z-SUB     sitdn         X_SITDN           7 0
N50  C   26              MOVE      X_SITDN       SITDNA
N09  C                   movel     siavd         kuref
N09  C     kuref         CAT       '/':0         kuref
N09  C     kuref         CAT       sitdna:0      kuref
N09  C     kuref         CAT       '/':0         kuref
N09  C     kuref         CAT       sisg:0        kuref
N09  C                   ELSE                                                   1
N09  C                   MOVEL     fssok         kuref
N16  C                   MOVEL     fssok         fssok00
N09  C                   END                                                    1<-E
      *** HENTE CONTAINERNR. OG TESTE OPPDRAGSTYPE
     C     HEADFK        CHAIN(N)  HEADF                              33
     C   33              MOVE      *BLANKS       HETRCN
     C     SIUR          COMP      'F'                                    28
     C     HETRCN        COMP      *BLANKS                                50
N94   *
N94   * SJEKK OM PROSEDYRE 49 ER BLANK ANDRE 4x PROSEDYRE
N94  C                   EVAL      X_SIBEL3 = 0
N94  C                   MOVE      'N'           XPR49             1
N94  C                   IF        SIDP <> 49 AND XDP1 = 4
N94  C     *LIKE         DEFINE    SIBEL3        X_SIBEL3
N94  C     SADHK         SETLL     SADV2
N94  C     SADHK         READE(N)  SADV2                                  33
N94  C                   DOW       *IN33 = *OFF
N94  C                   IF        SVDP = 49
N94  C                   EVAL      X_SIBEL3 = X_SIBEL3 + SVBELT * 0.2
N94  C                   MOVE      'J'           XPR49
N94  C                   ELSE
N94  C                   EVAL      X_SIBEL3 = X_SIBEL3 + SVBELT
N94  C                   END
N94  C     SADHK         READE(N)  SADV2                                  33
N94  C                   ENDDO
N94  C                   ELSE
N94  C                   EVAL      X_SIBEL3 = SIBEL3
N94  C                   END
N94   *
     C*
     C                   EXSR      MOVBWF
     C                   MOVE      *ZEROS        XTVF             17 9
     C                   MOVE      *ZEROS        XTVF2            17 9
     C*
     C*** IND. 41 PÅ BETYR INNSTIKK
     C     SIMF          IFEQ      '   '
     C     SIMI          COMP      'I'                                    41
     C                   ELSE
     C     SIMF          COMP      'DFO'                                  41
     C                   END
      *
      * PROS.=48,70-77 ---> 99 PÅ
     C     SIDP          COMP      70                                 99  99
     C   99SIDP          COMP      77                                   9999
     C  N99SIDP          COMP      48                                     99
      * PROS.=47    ---> 91,99 PÅ
     C     SIDP          COMP      47                                     91
     C   91              MOVE      '1'           *IN99
      *
     C*
     C*** VED INNSTIKK SKAL DET SKRIVE UT 'J/N' PÅ PREFERANSE.
     C*** HVIS PREFERANSE FINNES PÅ LANDKODE-REGISTER, SKRIVE 'JA'
     C*** ELLERS SKRIVE 'NEI'.
     C   41              DO
     C     KODS2K        CHAIN     KODTS2                             42
     C  N42KS2PRE        COMP      *BLANKS                                42
     C                   END
     C*
     C*** FINNE OMREGNINGSFAKTOR AV FRAKT FOR VARELINJER
     C  N41SIBEL3        IFNE      0
N81  C     KODVAK        SETGT     KODTVAL2
N81  C     SIVAL3        READPE    KODTVAL2                               33
N95  C                   IF        *IN33
N95  C     SIVAL3        CHAIN     KODTVAL2                           33
N95  C                   END
N81  C     *LIKE         DEFINE    SIBEL4        X_SIBEL4
N81  C                   EVAL(H)   X_SIBEL4 = SIBEL3 * SIVKU / KVAOMR
N81  C                   IF        SIBEL4 = X_SIBEL4
N81  C                   EVAL(H)   XTVF = SIVKU / KVAOMR
N81  C                   ELSE
     C     SIBEL4        DIV(H)    SIBEL3        XTVF
NXX  C                   END
S94  C*                  IF        SIDP = 49
N94  C                   SELECT
N94  C                   WHEN      SIDP = 49
N71  C                   EVAL(H)   XTVF2 = SIBELS / (SIBEL3 * 0.2)
N94  C                   WHEN      XPR49 = 'J'
N94  C                   EVAL(H)   XTVF2 = SIBELS / X_SIBEL3
N71  C                   END
     C                   END
      * SIBELS = SIBELR(NOK) + FRAKT - RABATT + ANDRE KOSTNADER
      * SIBELQ = SIBELR(NOK)*0,08 + FRAKT - RABATT + ANDRE KOSTNADER
     C  N41SIBELR        IFNE      0
     C     SIBEL3        ANDNE     0
     C     SIBELS        DIV(H)    SIBEL3        XTVF2
     C                   END
     C*
     C*** HENTE OMREGNINGSFAKTOR FOR VALUTA
     C     KODVAK        SETGT     KODTVAL2
     C     SIVAL3        READPE    KODTVAL2                               33
      * HVIS IKKE FINNES, FORSØK PÅ SENERE DATO
     C   33KODVAK        SETGT     KODTVAL2
     C   33SIVAL3        READE     KODTVAL2                               33
     C   33SIVAL3        IFEQ      'IEP'
     C                   Z-ADD     1             KVAOMR
     C                   ELSE
     C                   Z-ADD     100           KVAOMR
     C                   END
     C*
     C*** DIVERS TESTER FOR DEL-1 AV TOLLDEKLARASJON
     C     SILV          COMP      'TFR'                                  38
     C*
     C                   MOVE      *ZEROS        XNR               5 0
N50  C                   MOVE      *ZEROS        XNROMB            5 0
     C     MVOGN         IFEQ      'J'
     C                   Z-ADD     SWLI          XNR
N50  C   26              Z-ADD     SWLI          XNROMB            5 0
     C                   END
     C                   MOVE      *ZEROS        XN2               4 0
     C                   MOVE      *ZEROS        XN3               5 0
     C                   MOVE      *ZEROS        SIBELT
     C                   MOVE      *ZEROS        XTOT1            13 2
     C                   MOVE      *ZEROS        XTOT2            13 2
     C                   MOVE      *ZEROS        XTOTBV           13 2
     C* XTOLKL SKAL INNEHOLDE SPESIFISERTE KOLLI
     C                   MOVE      *ZEROS        XTOTKL            6 0
      *
     C     *IN41         IFEQ      '1'
     C                   MOVE      '1'           *IN94
     C                   MOVE      *ZEROS        XIBEL3
     C                   ELSE
     C     SIBEL3        IFEQ      0
     C                   MOVE      *ZEROS        XIBEL3
     C                   ELSE
     C     SIBEL3        MULT      SIVKU         XIBEL3           15 2
     C                   DIV(H)    KVAOMR        XIBEL3
     C                   END
     C                   SELECT
S22  C*    XIBEL3        WHENGE    199,5
s54  C*    XIBEL3        WHENGE    200
S58  C*    SIBEL4        WHENGE    350
S66  C*    SIBEL4        WHENGT    350
N66  C     SIBEL4        WHENGE    350
N56  C     X_M0068A      ANDGE     20150101
N56  C     SIBEL3        ORGE      200
N56  C     X_M0068A      ANDLT     20150101
      * VAREVERDI>=LAVVERDI GRENSE--> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   OTHER
     C                   MOVE      '1'           *IN94
     C                   ENDSL
     C                   END
     C                   MOVE      '1'           *IN92
     C*
     C*** I SUMVAR GJØR NØDVENDIGE BEREGNINGER (SUMMER VARELINJER)
     C***   OG SKRIV UT DETALJLINJER PÅ WFILEIMP
     C     SITRT1        IFEQ      1
      * OMNUMMERE LINJENR
     C                   MOVE      *ZEROS        XVLN1             5 0
     C                   MOVE      *ZEROS        XVLN2             5 0
     C     SADHK         SETLL     SADV4
     C     SADHK         READE     SADV4                                  33
     C                   DOW       *IN33 = *OFF
     C                   IF        SVLN <> 0
     C                   IF        ((SVLN = XVLN2) OR (SVVKTB = 0))
     C                   EVAL      SVLN  = XVLN1
     C                   ELSE
     C                   EVAL      XVLN2 = SVLN
     C                   ADD       1             XVLN1
     C                   EVAL      SVLN  = XVLN1
     C                   END
     C                   END
     C                   EXCEPT    SADVL4
     C     SADHK         READE     SADV4                                  33
     C                   ENDDO
     C                   END
N18  C                   MOVE      'N'           UTBTAX0S          1
N61  C                   MOVE      *ZEROS        XTVKTBEMMA        9 0
     C  N41              EXSR      SUMVAR
     C*
     C* XRESKL SKAL INNEHOLDE 1 ELLER DIFERANSE MELLOM XTOTKL OG SENTK
     C  N41SINTK         IFGT      XTOTKL
     C     SINTK         SUB       XTOTKL        XRESKL            6 0
     C                   ELSE
     C                   Z-ADD     1             XRESKL
     C                   END
     C*
     C*** SKRIV UT DEL-1 AV TOLLDEKLARASJON
     C                   EXSR      UTDEL1
      * INGEN OPPDATERING VED FAXING
      *
     C*
     C*** SKRIV UT DEL-2 AV TOLLDEKLARASJON
     C  N41HENTF         IFGT      1
     C                   EXSR      UTDEL2
     C                   END
N50   *
N64  C                   IF        *IN26
N64  C                   EVAL      *IN35 = *OFF
N64  C                   MOVE      *ZEROS        XN_OMB            1 0
N64  C                   MOVE      *BLANKS       TOMBE
N64  C                   MOVE      *BLANKS       TOMBL
N64  C     SADHK         SETLL     SADOMTH
N64  C     SADHK         READE     SADOMTH                                33
N64  C                   DOW       *IN33 = *OFF
N64  C                   EVAL      *IN35 = *ON
N64  C                   ADD       1             XN_OMB
N64  C                   MOVE      TO_SITLE      TOMBE(XN_OMB)
N64  C                   MOVE      TO_SITLL      TOMBL(XN_OMB)
N64  C                   IF        XN_OMB = 4
N64  C                   LEAVE
N64  C                   END
N64  C     SADHK         READE     SADOMTH                                33
N64  C                   ENDDO
N64  C                   END
N50   * SKRIV UT OMBEREGNING
S64  C*  26              WRITE     OMBEREGN
N64  C   26
N64  CAN 32              WRITE     OMBEREGN
      * INGEN OPPDATERING VED FAXING
      *
     C     PRTTYP        IFEQ      'F'
     C     PRTTYP        OREQ      'A'
N43  C     PRTTYP        OREQ      'X'
S07  C*                  UPDATE    SADHR
S72  C*                  GOTO      SLPRI
N72  C                   GOTO      SLPRI2
     C                   END
     C*
     C*
     C*** OPPDATER SADH-/HEAD-REGISTER
     C*** T2,19 ---> TOTAL TOLL;     T2,20 ---> TOTAL MOMS
S47  C*                  Z-ADD     T2(19)        SIBEL5
S47  C* N94              Z-ADD     T2(20)        SIBEL6
N47  C                   Z-ADD     T2(39)        SIBEL5
N47  C  N94              Z-ADD     T2(40)        SIBEL6
     C   94              MOVE      *ZEROS        SIBEL6
N72.2C   94              IF        XSNDEMMA = 'J' AND X_SYMVSP = 'J'
N72.2C                             AND SIMVA = 'J'
N72.2C                   Z-ADD     X_SIBEL6      SIBEL6
N72.2C                   END
     C  N32              MOVE      'Q'           SIST
      * VED SIWS<>TVINR OG SI0035=2 --> SENDE TOLLDEK. I TESTPERIODE
N82  C                   IF        PRTTYP <> 'A'
     C   32SIWS          IFNE      'TVINR'
     C     SI0035        ANDEQ     '2'
     C                   MOVE      'Q'           SIST
     C                   ELSE
     C                   MOVE      'P'           SIST
     C   37              MOVE      'U'           SIST
      * status F ved forenklet prosedyre
     C     sadhk         chain     fpxref                             33
     C  N33              move      'F'           SIST
     C                   END
     C                   MOVE      *BLANKS       SIWS
N82  C                   END
     C                   MOVE      XSIFIF        SIFIF
     C                   MOVE      XSIFID        SIFID
     C                   UPDATE    SADHR
N16  C                   MOVE      *BLANKS       FSSOK00
     C     FRIKEY        CHAIN     FRISOK                             33
N16  C  N33              MOVE      FSSOK         FSSOK00
     C   33              MOVE      *BLANKS       FSSOK
     C     HEADFK        CHAIN     HEADF                              33
     C  N33              DO
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C*** HEPK4  ---> MERKING FOR UTSKRIFT AV SAD
     C*** SIBEL7 ---> TOTAL AVGIFTER;   HEBELM ---> TOTAL MOMS;
     C*** HEBELT ---> TOTAL AVGIFTER UTEN MOMS;
     C*** HENTF  ---> ANTALL VARELINJER;
N35  C                   IF        SITLL <> *BLANKS AND SITLE <> *BLANKS
     C                   MOVE      'P'           HEPK4
N35  C                   END
N72   *
N72  C*  39              IF        *IN37 = *OFF OR *IN26
N72  C                   IF        SIMVA = 'J'
N72  C                   IF        XSNDEMMA = 'N' OR                            IKKE SEND TIL EMMA
N72  C                             XSNDEMMA = 'J' AND X_SYMVSP <> 'J'           TIL EMMA, IKKE SPEC
N72   * TOTAL BLIR KUN AVGIFTER   <-- ENTEN IKKE TIL EMMA ELLER TIL EMMA OG IKKE SPESIFIKASJON
N72  C*                  EVAL      SIBEL7 = SIBEL6
N72  C                   END
N72  C                   END
N72  C*                  END
N72   *
     C   94
     CANN93              Z-ADD     SIBELT        HEBELT
S47  C* N94SIBEL7        SUB       T2(20)        HEBELT
S47  C* N94              Z-ADD     T2(20)        HEBELM
N47  C  N94SIBEL7        SUB       T2(40)        HEBELT
N47  C  N94              Z-ADD     T2(40)        HEBELM
     C                   MOVE      SISKI         HEKDTM
     C                   MOVE      SITLL         HETLL
     C                   MOVE      SITLE         HETLE
     C                   MOVE      XNR           HENTF
N50  C   26              MOVE      XNROMB        HENTF
     C                   UPDATE    HEADFR
      * UPDATE TAXES/PRICES TO INVOICE
     C                   CALL      'SYFA50'
     C                   PARM                    SIAVD
     C                   PARM                    SITDN
     C                   END
N72   *
N72  C     SLPRI2        TAG
N72  C*  39              IF        *IN37 = *OFF OR *IN26
N72.4C*                  IF        SIMVA = 'J'
N72.4C   32              IF        SIMVA = 'J'
N72   * MVA-REGISTRERT
N72  C                   IF        X_SYMVSP = 'J'
N88  C                             AND PRTTYP <> 'X'
N72   * KUNDE SKAL HA AVGIFTSSPESIFIKASJON MED MOMS
N72  C                   EXSR      SRPRTAVG
N72  C                   END
N72  C                   END
N72  C*                  END
     C*
     C     SLPRI         ENDSR
     C*
N72   ***********************************************
N72  C     SRPRTAVG      BEGSR
N72   ***********************************************
N72.3 * OPPDATER GEBYR PÅ FAKTURA
N72  C                   IF        SIKNK <> 0 AND SITLL <> *BLANKS
N99  C                             AND X_SYMVSP = 'J'
s91  C*                  CALL      'SAD067'
n91  C                   MOVE      SIAVD         SIAVDAL           4
n91  C                   MOVE      SITDN         SITDNAL           7
n91  C                   MOVE      SIKNK         SIKNKAL           8
n91  C                   CALL      'SAD067CL'
n91  C                   PARM                    SIAVDAL
n91  C                   PARM                    SITDNAL
n91  C                   PARM                    SIKNKAL
N72  C                   END
N72   *
N72  C                   MOVE      *BLANKS       T1
N72  C                   MOVE      *ZEROS        T2
N72  C                   MOVE      *ZEROS        T4
N72  C                   MOVE      *ZEROS        T5
N72  C                   MOVE      *BLANKS       T6
N72  C                   MOVE      *ZEROS        XN5
N72  C     FITAX         MULT      100           X_FITAX           5 2
N72   *
N72  C                   WRITE     AVGSP01
N72   *
N72.6C                   IF        *IN94 = *OFF OR SIBEL4 >= 350
N72  C     SADHK         SETLL     SADVAVG
N72  C     SADHK         READE(N)  SADVAVG                                33
N72  C                   DOW       *IN33 = *OFF                                 1<-B
N72  C                   EVAL      X_AVGTT = 0
N72  C                   MOVE      'N'           XPRTLT            1
N72.2C                   IF        *IN94 = *OFF                                  2<-B
N72  C     1             DO        6             XN3                              3<-B
N72  C                   IF        Y2(XN3) <> *BLANKS                              4<-B
N72  C                   EVAL      X_AVGKD = Y2(XN3)
N72  C                   EVAL      X_AVGSK = E2(XN3)
N72  C                   EVAL      X_AVGTY = P2(XN3)
N72  C                   EVAL      X_AVGGR = G2(XN3)
N72  C                   EVAL      X_AVGSA = S2(XN3)
N72  C                   EVAL      X_AVGBL = B2(XN3)
N72  C                   ADD       1             XN5
N72.5C*                  IF        XN5 > 56
N72.5C                   IF        XN5 > XA4                                        5<-B
N72  C                   WRITE     AVGSP01
N72  C                   Z-ADD     1             XN5
N72  C                   END                                                        5<-E
N72  C                   WRITE     AVGSP02
N72  C                   MOVE      'J'           XPRTLT
N72  C                   EVAL      X_AVGTT = X_AVGTT + X_AVGBL
N72  C                   EVAL      WFIRNR  = 0
N72  C     1             DO        36            XN4                                5<-B
N72  C                   SELECT                                                      6<-B
N72  C                   WHEN      T1(XN4) = X_AVGKD                                 6
N72  C                   EVAL      T2(XN4) = T2(XN4) + X_AVGBL
N72  C                   LEAVE
N72  C                   WHEN      T1(XN4) = *BLANKS                                 6
N72  C                   EVAL      T1(XN4) = X_AVGKD
N72  C                   EVAL      T2(XN4) = X_AVGBL
N72  C                   LEAVE
N72  C                   ENDSL                                                       6<-E
N72  C                   ENDDO                                                      5<-E
N72  C                   END                                                       4<-E
N72  C                   ENDDO                                                    3<-E
N72   *
N72   * Beregn toll
N72  C                   IF        WFPVA <> 'F'                                   3<-B
N72  C                   EVAL      X_AVGKD = 'TL'
N72  C                   EVAL      X_AVGSK = '1'
N72  C                   EVAL      X_AVGTY = ' '
N72  C                   EVAL      X_AVGGR = WFITLG
N72  C                   EVAL      X_AVGSA = WFISAT
N72  C                   EVAL      X_AVGBL = WFITOL
N72  C                   ADD       1             XN5
N72.5C*                  IF        XN5 > 56
N72.5C                   IF        XN5 > XA4                                       4<-B
N72  C                   WRITE     AVGSP01
N72  C                   Z-ADD     1             XN5
N72  C                   END                                                       4<-E
N72  C                   WRITE     AVGSP02
N72  C                   MOVE      'J'           XPRTLT
N72  C                   EVAL      X_AVGTT = X_AVGTT + X_AVGBL
N72  C                   EVAL      WFIRNR  = 0
N72  C                   EVAL      T1(37)  = 'TL'
N72  C                   EVAL      T2(37)  = T2(37) + X_AVGBL
N72  C                   END                                                      3<-E
N72.2C                   END
N72   *
N72   * Beregn moms
N72  C*                  IF        WFISKV <> ' '
N72  C                   EVAL      X_AVGKD = 'MV'
N72  C                   EVAL      X_AVGSK = WFISKV
N72  C                   EVAL      X_AVGTY = ' '
N74  C                   IF        SIDP = 64 OR SIDP = 65 OR SIDP = 66            3<-B
N74  C                   EVAL      X_AVGGR = WFIMVG
N74  C                   ELSE                                                     3
N72  C                   EVAL      X_AVGGR = WFISTB + X_AVGTT
N74  C                   END                                                      3<-E
N72  C                   EVAL      X_AVGSA = WFIMVS
N72.1C                   EVAL(H)   X_AVGBL = X_AVGGR * X_AVGSA / 100
N72  C                   ADD       1             XN5
N72.5C*                  IF        XN5 > 56
N72.5C                   IF        XN5 > XA4                                      3<-B
N72  C                   WRITE     AVGSP01
N72  C                   Z-ADD     1             XN5
N72  C                   END                                                      3<-E
N72  C                   WRITE     AVGSP02
N72  C                   MOVE      'J'           XPRTLT
N72  C                   EVAL      X_AVGTT = X_AVGTT + X_AVGBL
N72  C                   EVAL      WFIRNR  = 0
N72  C                   SELECT                                                   3<-B
N72  C                   WHEN      WFISKV = ' '                                   3
N72  C                   EVAL      T1(40)  = 'MV'
N72  C                   EVAL      T2(40)  = 0
N72  C                   EVAL      T4(40)  = T4(40) + X_AVGGR
N72  C                   EVAL      T5(40)  = 0
N72  C                   EVAL      T6(40)  = '0'
N72  C                   WHEN      X_AVGSA = X_FITAX                              3
N72  C                   EVAL      T1(38)  = 'MV'
N72  C                   EVAL      T2(38)  = T2(38) + X_AVGBL
N72  C                   EVAL      T4(38)  = T4(38) + X_AVGGR
N72  C                   EVAL      T5(38)  = X_AVGSA
N72  C                   EVAL      T6(38)  = X_AVGSK
N72  C                   OTHER                                                    3
N72  C                   EVAL      T1(39)  = 'MV'
N72  C                   EVAL      T2(39)  = T2(39) + X_AVGBL
N72  C                   EVAL      T4(39)  = T4(39) + X_AVGGR
N72  C                   EVAL      T5(39)  = X_AVGSA
N72  C                   EVAL      T6(39)  = X_AVGSK
N72  C                   ENDSL                                                    3<-E
N72  C*                  END
N72   *
N72  C                   IF        XPRTLT = 'J'                                   3<-B
N72  C                   ADD       1             XN5
N72  C                   WRITE     AVGSP03
N72  C                   END                                                      3<-E
N72  C     SADHK         READE(N)  SADVAVG                                33
N72  C                   ENDDO                                                  1<-E
N72.6C                   END
N72   *
N72  C                   ADD       2             XN5
N72.5C*                  IF        XN5 > 56
N72.5C                   IF        XN5 > XA4                                    1<-B
N72  C                   WRITE     AVGSP01
N72  C                   Z-ADD     2             XN5
N72  C                   END                                                    1<-E
N72  C                   WRITE     AVGSP04
N72  C                   EVAL      X_AVGTT = 0
N72  C                   EVAL      X_AVGSK = *BLANKS
N72  C     1             DO        40            XN3                            1<-B
N72  C                   IF        T1(XN3) <> *BLANKS                            2<-B
N72  C                   EVAL      X_AVGKD = T1(XN3)
N72  C                   EVAL      X_AVGBL = T2(XN3)
N72  C                   EVAL      X_AVGTT = X_AVGTT + X_AVGBL
N72  C                   EVAL      X_AVGGR = T4(XN3)
N72  C                   EVAL      X_AVGSA = T5(XN3)
N72  C                   EVAL      X_AVGSK = T6(XN3)
N72  C                   ADD       1             XN5
N72.5C*                  IF        XN5 > 56
N72.5C                   IF        XN5 > XA4                                      3<-B
N72  C                   WRITE     AVGSP01
N72  C                   Z-ADD     1             XN5
N72  C                   END                                                      3<-E
N72  C                   WRITE     AVGSP05
N72  C                   END                                                     2<-E
N72  C                   ENDDO                                                  1<-E
N72   *
N72.5C*                  IF        XN5 > 56
N72.5C                   IF        XN5 > XA4
N72  C                   WRITE     AVGSP01
N72  C                   Z-ADD     1             XN5
N72  C                   END
N72  C                   WRITE     AVGSP06
N72   *
N72  C                   ENDSR
N72   *
     C***********************************************
     C     UTDEL1        BEGSR
     C***********************************************
     C*** SKRIVE FAKTURALINJER (RUBR. 28)
     C   32              EXSR      UTR28
     C     MVOGN         IFEQ      'J'
     C                   Z-ADD     SIBEL7        XTOT2                            TOTAL
     C     XTOT2         SUB       SIBELT        XTOT1                            UTEN TA
     C                   END
     C*
     C                   MOVE      *ZEROS        XN2
     C                   MOVE      *ZEROS        XN4               2 0
     C                   MOVE      *ZEROS        XSNR              2 0
     C                   MOVE      *ZEROS        XTOTS             2 0
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        T2
     C                   MOVE      *BLANKS       T3
     C                   MOVE      *ZEROS        SIBEL7
N72.2C                   MOVE      *ZEROS        X_SIBEL6
     C                   MOVE      XNR           HENTF
N50  C   26              MOVE      XNROMB        HENTF
     C                   Z-ADD     1             XLN
     C*
     C*** SIBELT ---> TOTAL TRAFIKKAVGIFT
     C*** SIBELT < 5 (93 PÅ) ---> IKKE BEREGNE TRAFIKKAVGIFT
     C     SIBELT        COMP      5                                    93
     C*** XTOT1  ---> TOTAL AVGIFTER UTEN TRAFIKKAVGIFT
     C*** XTOT2  ---> TOTAL AVGIFTER MED TRAFIKKAVGIFT
S22  C*                  IF        XIBEL3 >= 199.5
S10  C*  93XTOT1         COMP      50                                   9494
S10  C* N93XTOT2         COMP      50                                   9494
s54  C*                  IF        XIBEL3 >= 200
S56  C*                  IF        SIBEL4 >= 350
S58  C*                  IF        (SIBEL4 >= 350 AND X_M0068A >= 20150101) OR
S66  C*                  IF        (SIBEL4 > 350 AND X_M0068A >= 20150101) OR
N66  C                   IF        (SIBEL4 >= 350 AND X_M0068A >= 20150101) OR
N56  C                             (SIBEL3 >= 200 AND X_M0068A < 20150101)
S39  C*  93XTOT1         COMP      50                                   94
S39  C* N93XTOT2         COMP      50                                   94
N39  C   93              Z-ADD(H)  XTOT1         XTOTHEL          11 0
N39  C  N93              Z-ADD(H)  XTOT2         XTOTHEL
N39  C     XTOTHEL       COMP      50                                   94
     C                   END
      * "BV/TO" > 0  --->  ALLTID MED MOMOS
     C  N94              MOVE      '1'           *IN92
     C   94XTOTBV        COMP      0                                    9292
N18  C   94              IF        UTBTAX0S = 'J'
N18  C                   EVAL      *IN92 = *OFF
N18  C                   END
     C   94
     CANN92              MOVE      '0'           *IN94
N18   *
S22  C*                  IF        UTBTAX0S='J' AND SITST = 1 AND XIBEL3 <= 199
s54  C*                  IF        UTBTAX0S='J' AND SITST = 1 AND XIBEL3 < 200
S56  C*                  IF        UTBTAX0S='J' AND SITST = 1 AND SIBEL4 < 350
N56  C                   IF        UTBTAX0S='J' AND SITST = 1
S58  C*                  IF        (SIBEL4 < 350 AND X_M0068A >= 20150101) OR
S66  C*                  IF        (SIBEL4 <= 350 AND X_M0068A >= 20150101) OR
N66  C                   IF        (SIBEL4 < 350 AND X_M0068A >= 20150101) OR
N56  C                             (SIBEL3 < 200 AND X_M0068A < 20150101)
S73  C*                  EVAL      *IN94 = *ON
N73  C                   EVAL      *IN94 = *OFF
N56  C                   END
N18  C                   END
N18   *
     C*** VED INNSTIKK TESTE FAKTURADATO = 0. HVIS IKKE, SKRIVE UT.
     C     SIFID         COMP      0                                  9696
     C*** 97 PÅ ---> TOLLDEK. ER TILHØRT ET OPPDRAG.
     C***            SKRIVE OPPDRAGSNR. EVENTUELT FRAKTBREVNR.
     C     SIOPD         COMP      0                                  9797
     C   97SIOPD         COMP      SITDN                              9797
     C*** 44 PÅ, SEKTC<>'8'/'9'  ---> SKRIVE 'DAGSOPPGJØR'
     C*** 45 PÅ ---> SKRIVE 'KONTANT'
     C     SIKDDK        COMP      'D'                                    44
     C   44SIKTC         IFEQ      '8'
     C     SIKTC         OREQ      '9'
     C                   MOVE      '0'           *IN44
     C                   END
     C     SIKDDK        COMP      'K'                                    45
     C*** VED INNSTIKK TESTE FAKT.SUM(SIBEL3)=0. HVIS IKKE, SKRIVE UT.
     C*** TESTE OMREGNET FRAKT (SIBEL8) = 0. HVIS IKKE, SKRIVE UT.
     C     SIBEL3        COMP      0                                      46
     C     SIBEL8        COMP      0                                      47
     C*
     C*** SUMMERE ANDREKOSTNADER MED FAKTURASUM. LEGGE DET PÅ XBEL3
     C*** VALUTAKODE FOR ANDREKOST <> P ---> SUMMERE A.KOST MED F.SUM
     C                   Z-ADD     0             XWORK            19 6
     C     SIVKU         IFNE      0
     C     SIVALB        ANDNE     'P  '
     C     SIVALB        IFEQ      SIVAL3
     C                   Z-ADD     SIBEL2        XWORK
     C                   ELSE
     C     SIBEL9        MULT      KVAOMR        XWORK
     C     XWORK         DIV(H)    SIVKU         XWORK
     C                   END
     C                   END
     C     SIFTG2        IFNE      '-'                                          B1
     C     SIFTG2        ANDNE     '+'
     C                   Z-ADD     SIBEL3        XBEL3
     C                   ELSE                                                   X1
     C     SIFTG2        IFEQ      '+'                                           B2
     C     SIBEL3        ADD(H)    XWORK         XBEL3            12 2
     C                   ELSE                                                    X2
     C     SIFTG2        IFEQ      '-'                                            B3
     C     SIBEL3        SUB(H)    XWORK         XBEL3
     C                   END                                                      E3
     C                   END                                                     E2
     C                   END                                                    E1
N43   *
N43  C                   IF        XSNDEMMA = 'J'                               1<-B
N88  C                   MOVE      SIMVA         X_SIMVA           1
N88  C                   EVAL      SIMVA = 'J'
N43  C                   EXSR      SREMMA1
N43  C                   END                                                    1<-E
     C*
     C                   MOVE      *ZEROS        XN3
     C     MVOGN         IFEQ      'J'
     C     SADHK         SETLL     SADW
     C     SADHK         READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADHK         SETLL     WFILEIMP
     C                   SETOFF                                       33
N77  C                   MOVE      *BLANKS       VB
     C     SADHK         READE     WFILEIMP                               33
N50  C                   DOW       *IN33 = *OFF
N50  C                   IF        WFITRP <> 'S'
N84  C                             AND WFITRP <> 'D'
N50  C                   LEAVE
N50  C                   END
N50  C                   DELETE    WFILEIR
N77  C                   MOVE      *BLANKS       VB
N50  C     SADHK         READE     WFILEIMP                               33
N50  C                   ENDDO
N50  C   33              CLEAR                   WFILEIR
     C  N33              DELETE    WFILEIR
N106  *
N106  * HENT CONTAINENR
N106 C                   IF        XSNDEMMA <> 'J'
N106 C   33              EVAL      CNR50 = *BLANKS
N106 C  N33              EXSR      SRHENTCN
N106 C                   END
     C                   END
     C*** TESTE OM DET SKAL BRUKE DATALISTE (EVENTUELL VANLIG ELLER A4)
     C***   UDL = J --> VANLIG DATALISTE;  UDL = 1 --> A4-LISTE
     C*** XNR       --> ANTALL VARELINJER;
     C*** XLANT + 1 --> MIN. ANTALL VARELINJER FOR Å BRUKE DATALISTE
     C     UDL           IFEQ      'J'
     C     UDL           OREQ      '1'
     C     XNR           IFGT      XLANT
N50  C     *IN26         ANDEQ     '0'
N50  C     XNROMB        ORGT      XLANT
N50  C     *IN26         ANDEQ     '1'
     C*** UTDELD SKAL SKRIVE UT TOLLDEK. PÅ DATALISTE (INKL. DEL-1)
     C                   EXSR      UTDELD
     C                   MOVE      *ZEROS        HENTF
     C                   GOTO      SLUTD
     C                   END
     C                   END
     C*
     C  N32              SETOFF                                       95
     C*
     C  N41              DO
     C                   MOVE      *BLANKS       Y1
     C                   MOVE      *BLANKS       E1
     C                   MOVE      *ZEROS        G1
     C                   MOVE      *ZEROS        S1
     C                   MOVE      *BLANKS       P1
     C                   MOVE      *ZEROS        B1
     C*** UTREGNING AV AVGIFTER FOR RUBR. 47
     C                   EXSR      REGN2
     C                   END
     C*** BEREGNE ANTALL SIDER OG SETTES INN XTOTS
S50  C*    XNR           IFGT      1
N50  C                   SELECT
N50  C                   WHEN      *IN26 = *OFF AND XNR > 1
     C                   ADD       1             XSNR
     C     XNR           ADD       4             XNR
     C     XNR           DIV       3             XTOTS
     C     XNR           SUB       4             XNR
     C                   MOVE      *ZEROS        WFISUM
N50  C                   WHEN      *IN26  AND XNROMB > 1
N50  C                   ADD       1             XSNR
N50  C     XNROMB        ADD       4             XNROMB
N50  C     XNROMB        DIV       3             XTOTS
N50  C     XNROMB        SUB       4             XNROMB
N50  C                   MOVE      *ZEROS        WFISUM
S50  C*                  ELSE
N50  C                   OTHER
     C                   Z-ADD     0             XN2
     C                   END
     C*
     C  N32              GOTO      SLUTD
     C*
     C*** SJEKKE RUBR. 31 OG 44
     C  N41              EXSR      SJVBES
     C*klargjøre R.31.   ??????????
     C*** SKRIVE UT HOVEDARK
     C   321             DO        8             YN
     C                   MOVE      G1(YN)        XDESIM            2 0
     C     YN            ADD       60            ZN                3 0
     C     XDESIM        IFEQ      0
     C                   MOVE      '0'           *IN(ZN)
     C                   MOVEL     G1(YN)        G11(YN)
     C                   ELSE
     C                   MOVE      '1'           *IN(ZN)
     C                   END
     C                   END
     C   32              MOVE      *BLANKS       KFMT1
     C   32              MOVE      *BLANKS       KFMT2
     C   32F1(1)         IFEQ      *BLANKS                                      1<-B
     C                   EXSR      TRIMGN
N16  C  N41              EXSR      FRISR
S25  C*                  EXCEPT    DEL1
n46  c                   move      *blanks       MVP1
n46  c                   z-add     0             MVP2
N46  C     wty11         ifne      *blanks
n46  c     wty11         andne     'MV'
n46  c                   move      'MV='         MVP1
n46  c                   z-add     WFIMVA        MVP2
n46  c                   end
N50  C   26              MOVE      XNR           XNROMB2           5 0
N50  C   26              MOVE      XNROMB        XNR
N25  C                   WRITE     DEL1
N50  C   26              MOVE      XNROMB2       XNR
     C                   ELSE                                                   1
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9                                             2<-B
     C                   ADD       1             YN
     C     F1(YN)        IFEQ      *BLANKS                                        3<-B
     C                   ADD       10            YN
     C                   ELSE                                                     3
     C                   MOVE      F1(YN)        KFMT1
     C                   MOVE      F2(YN)        KFMT2
     C                   EXSR      TRIMGN
N16  C  N41              EXSR      FRISR
S25  C*                  EXCEPT    DEL1
n46  c                   move      *blanks       MVP1
n46  c                   z-add     0             MVP2
N46  C     wty11         ifne      *blanks
n46  c     wty11         andne     'MV'
n46  c                   move      'MV='         MVP1
n46  c                   z-add     WFIMVA        MVP2
n46  c                   end
N50  C   26              MOVE      XNR           XNROMB2           5 0
N50  C   26              MOVE      XNROMB        XNR
N25  C                   WRITE     DEL1
N50  C   26              MOVE      XNROMB2       XNR
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N43   *
N43  C                   IF        XSNDEMMA = 'J'
N43  C                   EXSR      SREMMA5
N43  C                   END
     C*
S43  C*    SLUTD         ENDSR
N43   *
N43  C     SLUTD         TAG
N43  C                   IF        XSNDEMMA = 'J'                               1<-B
N43  C                   EXSR      SREMMA9
N88  C                   MOVE      X_SIMVA       SIMVA
N43  C                   END                                                    1<-E
N43   *
N43  C                   ENDSR
     C*
      */////////////////////////////////////////////////////////////
      *                                                       MOVSWW
      */////////////////////////////////////////////////////////////
     C     MOVSWW        BEGSR
      * TØM VARIABLER FOR WFILEIMP
     C                   EXSR      MOVBWF
      * FLYTTE FRA MOTORV.FORTOLLING TIL VARIABLER FOR WFILEIMP
     C                   MOVE      SWAVD         WFAVD
     C                   MOVE      SWTDN         WFTDN
     C                   MOVE      SWLI          WFIRNR
     C                   MOVE      SWVNT         WFIVNT
     C                   MOVE      SWTN          WFITN
     C                   MOVE      SWLK          WFILK
S34  C*                  MOVE      SWVKTB        WFIVKB
S34  C*                  MOVE      SWVKTN        WFIVKN
N34  C                   Z-ADD     SWVKTB        WFIVKB123
N34  C                   Z-ADD     SWVKTN        WFIVKN123
     C                   MOVE      SWPRE         WFIPRE
S37  C*                  MOVE      SWNTM         WFINTM
N37  C                   Z-ADD     SWNTM         WFINTM
     C                   MOVE      SWPVA         WFPVA
     C                   MOVE      *BLANKS       WFISKV
     C                   MOVE      *ZEROS        WFIMVS
     C     SWMFR         IFNE      'F'
     C                   MOVEL     SWMFR         WFISKV
     C     SADSDK        SETLL     SADSD
     C     SADSDK        READE     SADSD                                  34
     C     *IN34         DOWEQ     '0'
S56  C*    SDDTF         IFLE      XIDT
S56  C*    SDDTT         ANDGE     XIDT
N56  C                   IF        SDDTF <= X_M0068A AND SDDTT >= X_M0068A
     C                   LEAVE
     C                   END
     C     SADSDK        READE     SADSD                                  34
     C  N34              ENDDO
     C   34SWMFR         IFEQ      '1'
     C     FITAX         MULT      100           SDBLSÆ
     C                   MOVE      '0'           *IN34
     C                   END
     C  N34              MOVE      SDBLSÆ        WFIMVS
     C                   END
     C                   MOVE      SWVF          WFIVF
     C                   MOVE      SWWJUS        WFIJUS
     C                   MOVE      SWWFTG        WFIFTG
     C                   MOVE      SWBELS        WFISTB
     C                   MOVE      SWWMVA        WFIMVA
     C                   MOVE      SWWMVG        WFIMVG
     C                   MOVE      SWWTOL        WFITOL
     C                   MOVE      SWWTLG        WFITLG
     C     XTVF2         MULT(H)   SWBELT        WFIBBL
     C                   MOVE      SWWTRA        WFITRA
     C                   MOVE      SWWSAT        WFISAT
     C                   MOVE      SWWSUM        WFISUM
      * SWWTY1 = BEREGNET "MO" AVGIFT - SKAL IKKE SENDES (01.04.2001)
      * ØVRIGE AVGIFTER "RYKKER 1 PLASS OPP" UTEN YTTERLIGERE MERKING
     C                   MOVE      SWWTY2        WFITY1
     C                   MOVE      SWWTY3        WFITY2
     C                   MOVE      SWWTY4        WFITY3
     C                   MOVE      SWWTY5        WFITY4
     C                   MOVE      *BLANKS       WFITY5
     C                   MOVE      *BLANKS       WFITY6
     C                   Z-ADD     SWWGL2        WFIGL1
     C                   Z-ADD     SWWGL3        WFIGL2
     C                   Z-ADD     SWWGL4        WFIGL3
     C                   Z-ADD     SWWGL5        WFIGL4
     C                   MOVE      *ZEROS        WFIGL5
     C                   MOVE      *ZEROS        WFIGL6
     C                   MOVE      SWWST2        WFIST1
     C                   MOVE      SWWST3        WFIST2
     C                   MOVE      SWWST4        WFIST3
     C                   MOVE      SWWST5        WFIST4
     C                   MOVE      *ZEROS        WFIST5
     C                   MOVE      *ZEROS        WFIST6
     C                   MOVE      SWWPR2        WFIPR1
     C                   MOVE      SWWPR3        WFIPR2
     C                   MOVE      SWWPR4        WFIPR3
     C                   MOVE      SWWPR5        WFIPR4
     C                   MOVE      *BLANKS       WFIPR5
     C                   MOVE      *BLANKS       WFIPR6
     C                   Z-ADD     SWWBL2        WFIBL1
     C                   Z-ADD     SWWBL3        WFIBL2
     C                   Z-ADD     SWWBL4        WFIBL3
     C                   Z-ADD     SWWBL5        WFIBL4
     C                   MOVE      *ZEROS        WFIBL5
     C                   MOVE      *ZEROS        WFIBL6
     C                   MOVE      SWWPRO        WFIPRO
     C*MERKE/NR - GÅR SOM PCI - KUN CIFVERDI.MM. HÅNDTERES I PCI0VB
     C*ANTAL/MERKE GÅR SOM PAC                   HÅNDTERES I PAC0VB
     C*VEKT/EFFEKT/KUB+++ GÅR SOM FTX            HÅNDTERES I FTX0VB
      * CHASSISNR M.M. HÅNDTERES SOM VANLIG R.44.
     C                   MOVEL     SWR441        WFITO1
     C                   MOVEL     SWR442        WFITO2
     C                   MOVEL     SWR443        WFITO3
     C                   MOVEL     SWR444        WFITO4
     C                   MOVEL     SWR445        WFITO5
     C                   MOVE      SWREF1        WFITC1
     C                   MOVE      SWREF2        WFITC2
     C                   MOVE      SWREF3        WFITC3
     C                   MOVE      SWREF4        WFITC4
     C                   MOVE      SWREF5        WFITC5
     C* UDEF I SADW..      MOVE SWITRG    WFITRG
     C*  --- " ----        MOVE SWITRP    WFITRP
      *
     C                   MOVEL     SWPACB        DSPACB                          (11 FØRSTE)
      *
     C                   MOVE      *ZEROS        BILNUM            6
     C     SWVK66        IFEQ      *ZEROS
     C                   MOVE      SWVK15        BILNUM
     C                   ELSE
     C                   MOVEL     SWVK25        BILNUM
     C                   MOVE      ','           BN(5)
     C                   MOVE      SWVK66        BILNUM
     C                   END
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX1A
     C                   MOVE      SWTX1B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX1B
      *
     C                   MOVE      *ZEROS        BILNUM            6
     C     SWEF56        IFEQ      *ZEROS
     C                   MOVE      SWEF14        BILNUM
     C                   ELSE
     C     SWEF66        IFEQ      *ZEROS
     C                   MOVEL     SWEF14        BILNUM
     C                   MOVE      ','           BN(5)
     C                   MOVE      SWEF55        BILNUM
     C                   ELSE
     C                   MOVEL     SWEF24        BILNUM
     C                   MOVE      ','           BN(4)
     C                   MOVE      SWEF56        BILNUM
     C                   END
     C                   END
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX2A
     C                   MOVE      SWTX2B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX2B
      *
     C                   MOVE      SWTX3A        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX3A
     C                   MOVE      SWTX3B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX3B
      *
     C                   MOVE      SWPC1A        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC1A
     C                   MOVE      SWPC1B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC1B
      *
     C                   MOVE      SWPC2B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC2B
     C                   MOVE      SWPC2C        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC2C
      *
     C                   MOVE      '   ,  '      DSPROS
     C                   MOVEL     SWPC2A        PROHEL            3 0
     C                   MOVE      SWPC2A        PRODEC            2 0
     C                   MOVEL     PROHEL        DSPROS
     C                   MOVE      PRODEC        DSPROS
     C     PROHEL        IFLT      100
     C                   MOVEL     ' '           DSPROS
     C                   END
      *
     C     MVOREG        IFEQ      'J'
     C     *IN32         ANDEQ     '1'                                          SAD PRINTES
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
N65  C                   Z-ADD     88            WOPLNR
N65  C     KODKEY        CHAIN     KODTP                              33
N65  C                   IF        *IN33 = *OFF AND KOPFM <> *BLANKS
N65  C     KOPFM         CHAIN     KODTFM                             33
N65  C                   END
      * Ikke styrt av stringkoder - print 1 gang
     C     F5(1)         IFEQ      *BLANKS
N65  C                   WRITE     REGKOR
     C                   ELSE
      * styrt av stringkoder - print 1 gang pr post i fil (array)
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9
     C                   ADD       1             YN
     C     F5(YN)        IFEQ      *BLANKS
     C                   ADD       10            YN
     C                   ELSE
     C                   MOVE      F5(YN)        KFMT1
     C                   MOVE      F6(YN)        KFMT2
N65  C                   WRITE     REGKOR
     C                   END
     C                   END
     C                   END
     C                   END
N72   *
N88  C                   IF        PRTTYP <> 'X'
N72  C                   WRITE     SADVAVGR
N88  C                   END
N89  C                   EVAL      *IN33 = *OFF
      *
     C                   ENDSR
      *
     C***********************************************
     C     BLANBI        BEGSR
     C***********************************************
      * BLANK FORANSTILTE NULLER I BILFORTOLLINGSDS...
     C                   Z-ADD     1             NN                1 0
     C     BN(NN)        DOWEQ     '0'
     C                   MOVE      ' '           BN(NN)
     C     NN            CABEQ     5             UTBLAN
     C                   ADD       1             NN
     C                   END
     C     UTBLAN        ENDSR
      *
     C***********************************************
     C     SUMVAR        BEGSR
     C***********************************************
      *** HENTE MERKE & NR. DERSOM SJØ-OPPDRAG
     C   28              DO
     C                   CALL      'SAD61PBL'
     C                   PARM      SIAVD         UAVD2             4 0
     C                   PARM      SITDN         UOPD              7 0
     C                   PARM                    UNR               2 0
     C                   PARM                    MN
     C                   PARM                    UN2               2 0
     C                   PARM                    VS
     C                   END
      *
N50  C                   MOVE      'J'           XORI              1
     C     SITRT1        IFEQ      1
     C                   MOVE      *ZEROS        XVLN              5 0
     C     SADHK         SETLL     SADV4
     C                   ELSE
     C*** XBRUD2 INNEHOLDER SAMSLÅINGSNØKKEL (SE DATASTRUKTUR)
S29  C*                  MOVE      *BLANKS       XBRUD2           20
S94  C*                  MOVE      *BLANKS       XBRUD2           22
N94  C                   MOVE      *BLANKS       XBRUD2           24
     C     SADHK         SETLL     SADV2
     C                   END
     C                   SETOFF                                       33
N50  C                   MOVE      'J'           XTOTSLT           1
     C*
     C     STSV          TAG
     C     SITRT1        IFEQ      1                                            1<-B
N84  C     XORI          ORNE      'J'
     C     SADHK         READE     SADV4                                  33
S50  C* N33              IF        SVPREÆ = 'S'
S50  C*                  EXCEPT    SADVL4
S50  C*                  GOTO      STSV
S50  C*                  END
N50  C  N33              IF        XORI = 'J'                                    2<-B
N50  C                   IF        SVPREÆ = 'J'                                   3<-B
N84  C                             OR SVPREÆ = 'N' OR SVPREÆ = 'D'
N50  C                   GOTO      STSV
N50  C                   END                                                      3<-E
N50  C                   ELSE                                                    2
N84  C                   IF        XORI = 'G'                                     3<-B TIDLIGERE OMB
N84  C                   IF        SVPREÆ <> 'N' AND SVPREÆ <> 'D'                 4<-B
N84  C                   GOTO      STSV
N84  C                   END                                                       4<-E
N84  C                   ELSE                                                     3
N50  C                   IF        SVPREÆ <> 'J'                                   4<-B
N50  C                   GOTO      STSV
N50  C                   END                                                       4<-E
N84  C                   END                                                      3<-E
N50  C                   END                                                     2<-E
N50  C   33              IF        SITDN < 0 AND XORI = 'J'                      2<-B
N84  C                             OR SITDN < 0 AND XORI = 'G'
N84  C                   IF        XORI = 'J'                                     3<-B
N84  C                   EVAL      XORI = 'G'
N84  C                   ELSE                                                     3
N50  C                   EVAL      XORI = 'N'
N84  C                   END                                                      3<-E
N50  C     SADHK         SETLL     SADV4
N50  C                   GOTO      STSV
N50  C                   END                                                     2<-E
      * LAGT TIL SOM EN NØDLØSING FORDI SAD061A KAN LAGE TILLEGGSLINJER HVOR SVLN=0
      * SELVFØLGELIG SKAL DETTE RETTES I SAD061A, MEN P.G.A. AVANSERT LOGIKK
      * MÅ VI VENTE TIL CHANG ER TILBAKE FRA FERIE
     C  N33SVLN          IFEQ      0                                             2<-B
N84  C     SVLN          ANDNE     0                                            TILL.LINJE ER BORT
     C                   EXCEPT    SADVD4
     C                   GOTO      STSV
     C                   ENDIF                                                   2<-E
     C                   ELSE                                                   1
     C     SADHK         READE     SADV2                                  33
S50  C*                  DOW       *IN33 = *OFF
S50  C*                  IF        SVPREÆ <> 'S'
S50  C*                  LEAVE
S50  C*                  END
S50  C*                  EXCEPT    SADVLN
S50  C*    SADHK         READE     SADV2                                  33
S50  C*                  ENDDO
N50  C  N33              IF        XORI = 'J'                                    2<-B
N50  C                   IF        SVPREÆ = 'J'                                   3<-B
N84  C                             OR SVPREÆ = 'N' OR SVPREÆ = 'D'
N50  C                   GOTO      STSV
N50  C                   END                                                      3<-E
N50  C                   ELSE                                                    2
N50  C                   IF        SVPREÆ <> 'J'                                  3<-B
N50  C                   GOTO      STSV
N50  C                   END                                                      3<-E
N50  C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*** XBRUD2 <> BLANK ---> DET ER EN SAMSLÅENDE LINJE SOM SKAL
     C***                      OPPDATERES PÅ WFILEIMP
     C   33SITRT1        IFEQ      1
N84  C     XORI          ORNE      'J'
     C     XVLN          IFNE      0
     C                   EXSR      REGN
     C                   END
     C                   ELSE
     C     XBRUD2        IFNE      *BLANKS
     C                   EXSR      REGN
     C                   END
     C                   END
N50  C   33              IF        SITDN < 0 AND XORI = 'J'
N84  C                             OR SITDN < 0 AND XORI = 'G'
N84  C                   IF        XORI = 'J'                                    2<-B
N84  C                   EVAL      XORI = 'G'                                   LES TIDLIGERE OMB
N84  C                   ELSE                                                    2
N50  C                   EVAL      XORI = 'N'
N84  C                   END                                                     2<-E
N50  C                   MOVE      *BLANKS       XBRUD2
S84  C*    SADHK         SETLL     SADV2
N84  C     SADHK         SETLL     SADV4
N50  C                   GOTO      STSV
N50  C                   END
     C   33              GOTO      SLSV
N50  C                   IF        SVPREÆ <> 'S'
N84  C                             AND SVPREÆ <> 'D'
N50  C                   MOVE      'N'           XTOTSLT           1
N50  C                   END
     C*
     C*** XBRUD2 = BLANK ---> DE ER FØRST SAMSLÅINGSLINJE. FLYTTE DATA
     C     SITRT1        IFEQ      1
N84  C     XORI          ORNE      'J'
     C     XVLN          IFEQ      0
N85  C     XORI          ORNE      'J'
N85  C     XVLN          ANDEQ     SVLN
     C                   EXSR      FLYTT
     C                   ELSE
     C     XVLN          IFNE      SVLN
     C                   EXSR      REGN
     C                   EXSR      FLYTT
     C                   END
     C                   END
     C                   MOVE      SVLN          XVLN
     C                   IF        SVLN = 0
     C                   Z-ADD     XNR           SVLN
     C                   END
     C                   EXCEPT    SADVL4
     C                   ELSE
     C     XBRUD2        IFEQ      *BLANKS
     C                   EXSR      FLYTT
     C                   ELSE
     C     XBRUD1        IFNE      XBRUD2
     C*** DET ER KOMMET EN NY SAMSL3ENDE LINJE. OPPDATERE DATA SOM
     C*** LIGGER I VARIABLER FOR SAMSLÅING PÅ WFILEIMP. FLYTTE DATA
     C*** FOR NESTE SAMSLÅENDE LINJE
     C                   EXSR      REGN
     C                   EXSR      FLYTT
     C                   END
     C                   END
     C*
     C                   Z-ADD     XNR           SVLN
     C                   EXCEPT    SADVLN
     C*
     C                   MOVE      XBRUD1        XBRUD2
     C                   END
N75   *
N75  C                   IF        SVPREÆ = 'S'
N84  C                             OR SVPREÆ = 'D'
N75  C                   GOTO      STSV
N75  C                   END
N105 C                   IF        WFITRP = 'S' AND SVPREÆ <> 'S'
N105 C                   MOVE      SVPREÆ        WFITRP
N105 C                   END
N75   *
     C*** OMREGNE TOLLVERDI INKLUDERT MED FRAKT, FOSIKRING OG A.KOSTNAD
S78  C*    XTVF          MULT(H)   SVBELT        XTVRD            11 2
N78  C     XTVF          MULT(H)   SVBELT        XTVRD            13 2
N71  C                   IF        SIDP = 49
N94  C                             OR SVDP = 49
N71  C                   EVAL(H)   XTVRD2 = XTVF2 * SVBELT * 0.2
N71  C                   END
      *** TEST OM DET SKAL HENTE MERKE & NR.
     C  N49SV01          COMP      'B'                                    49
      *
      *** SAMLE LINJER AV MERKE & NR. (CONTAINERNR.) - MAX. 7 LINJER
     C     1             DO        7             XN2                            1<-B
     C                   IF        SVFT(XN2) <> *BLANKS                          2<-B
     C     1             DO        7             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      KN(XN4) = *BLANKS                               4
     C                   EVAL      KN(XN4) = SVFT(XN2)
     C                   LEAVE
     C                   WHEN      KN(XN4) = SVFT(XN2)                             4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
      *** SAMLE LINJER AV VARESLAG - MAX. 7 LINJER
     C     1             DO        7             XN2                            1<-B
     C                   IF        SVVT(XN2) <> *BLANKS                          2<-B
     C     1             DO        7             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      VB(XN4) = *BLANKS                               4
     C                   EVAL      VB(XN4) = SVVT(XN2)
     C                   LEAVE
     C                   WHEN      VB(XN4) = SVVT(XN2)                             4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
      *** HENTE ENHETSKODE OG SUMMERE ANTALL ENHTER
     C     STSV2         TAG
     C     WFIVT         IFEQ      *BLANKS                                      1<-B
     C                   MOVE      SVEH01        WFIVT
     C                   END                                                    1<-E
      *
     C     1             DO        7             XN2                            1<-B
     C                   EVAL      WFIANT = WFIANT + SVNT(XN2)
     C                   ENDDO                                                  1<-E
      *
E34   *** SAMLE LINJER AV TILLEGGSOPPLYSNINGER - MAX. 10 LINJER
     C     1             DO        10            XN2                            1<-B
     C                   IF        SVTOP(XN2) <> *BLANKS                         2<-B
S100 C*                  IF        SVTCR(XN2) = 'UTB'
N87  C     SADSDKBV      CHAIN     SADSD                              33
N87  C   33SADSDKGB      CHAIN     SADSD                              33
N87  C   33SADSDKMB      CHAIN     SADSD                              33
N87  C   33SADSDKTO      CHAIN     SADSD                              33
N87  C                   IF        *IN33 = *OFF
N73   * GLEMT ETTER POSTSAMSLÅING
N73  C                   MOVE      'J'           UTBTAX0S
N87  C                   END
S100 C*                  END
     C     1             DO        10            XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      TO(XN4) = *BLANKS                               4
     C                   EVAL      TO(XN4) = SVTOP(XN2)
     C                   EVAL      TC(XN4) = SVTCR(XN2)
     C                   LEAVE
     C                   WHEN      TO(XN4) = SVTOP(XN2) AND TC(XN4) = SVTCR(XN2)   4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
     C     STSV3         TAG
     C*** TESTE MÅTER FOR Å BEREGNE TOLLGRUNNLAG
     C*** P ---> BASERE PÅ TOLLVERDI;   A ---> BASERE PÅ MENGDE
     C*** V ---> BASERE PÅ VEKT;        W ---> BASERE PÅ PR. 100 KG
     C*** F ---> TOLLFRI
     C     SVPVA         COMP      'P'                                    51
     C     SVPVA         COMP      'V'                                    52
     C  N52SVPVA         COMP      'W'                                    52
     C     SVPVA         COMP      'A'                                    53
     C*
S34  C*                  ADD       SVVKTB        WFIVKB
S34  C*                  ADD       SVVKTN        WFIVKN
N34  C                   ADD       SVVKTB        WFIVKB123
N34  C                   ADD       SVVKTN        WFIVKN123
     C   53              ADD       SVNTM         XNTM              9 0
     C     SVBELT        MULT      SIVKU         XWORK
     C     KVAOMR        IFGT      0
     C     XWORK         DIV(H)    KVAOMR        XWORK
     C                   ENDIF
     C     SIBELR        IFNE      0
S78  C*    XTVF2         MULT(H)   SVBELT        XTVRD2           11 2
S78  C*                  ADD       SVBELT        XBELR2           11 2
N78  C     XTVF2         MULT(H)   SVBELT        XTVRD2           13 2
N78  C                   ADD       SVBELT        XBELR2           13 2
     C                   END
N71  C                   IF        SIDP = 49
N94  C                             OR SVDP = 49
N71  C                   EVAL(H)   XTVRD2 = XTVF2 * SVBELT * 0.2
S78  C*                  ADD       SVBELT        XBELR2           11 2
N78  C                   ADD       SVBELT        XBELR2
N71  C                   EVAL(H)   X_XWFSTB = X_XWFSTB + XWORK
N71  C                   END
     C*** ADDERE TIL DATASTRUKTURFELT MED DESIMAL
     C                   ADD(H)    XWORK         XWFSTB
      *
      *** SUMMERE EKSTRAAVGIFTER
     C     1             DO        8             XN2                            1<-B
     C                   IF        SVAKD(XN2) <> *BLANKS                         2<-B
     C     1             DO        8             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      Y2(XN4) = *BLANKS                               4
     C                   EVAL      Y2(XN4) = SVAKD(XN2)
     C                   EVAL      E2(XN4) = SVASV(XN2)
     C                   EVAL      S2(XN4) = SVASA(XN2)
     C*                  EVAL      P2(XN4) = SVEH2(XN2)
S101 C*                  EVAL      P2(XN4) = SVEH2Æ
N101 C                   EVAL      P2(XN4) = SVEH2(xn2)
     C                   EVAL      B2(XN4) = SVABL(XN2)
     C                   EVAL      G2(XN4) = SVAGR(XN2)
     C                   LEAVE
     C                   WHEN      Y2(XN4) = SVAKD(XN2) AND E2(XN4) = SVASV(XN2)   4
     C                   EVAL      B2(XN4) = B2(XN4) + SVABL(XN2)
     C                   EVAL      G2(XN4) = G2(XN4) + SVAGR(XN2)
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
     C*
     C*** FINN TOLLBELØP
     C                   MOVE      *ZEROS        XTBEL            13 2
     C   51SIBELR        IFEQ      0
N71  C     SIDP          ANDNE     49
N94  C     SVDP          ANDNE     49
     C     XTVRD         MULT      SVAS          XWORK
     C                   ELSE
     C     XTVRD2        MULT      SVAS          XWORK
     C                   END
     C   51XWORK         DIV(H)    100           XTBEL
     C   52SVVKTN        MULT      SVAS          XTBEL
     C   52SVPVA         IFEQ      'W'
     C                   DIV(H)    100           XTBEL
     C                   END
     C   53SVNTM         MULT      SVAS          XTBEL
     C                   ADD       XTBEL         XWFTOL
     C                   ADD       SVNTM         WFINTM
N71  C     SIDP          IFEQ      49
N94  C     SVDP          OREQ      49
N71   * XWFTLG = Tollgrunnlag etter 20% av fakturaverdi
N71   * X_XWFTLG = Opprinnelig tollgrunnlag
N71  C                   ADD       XTVRD2        XWFTLG
N71  C                   ADD       XTVRD         X_XWFTLG         11 2
N71  C                   ELSE
     C                   ADD       XTVRD         XWFTLG
N71  C                   END
     C*
     C                   GOTO      STSV
     C*
     C     SLSV          ENDSR
     C*
     C***********************************************
     C     UTDELD        BEGSR
     C***********************************************
     C*** SKRIVE TOLLDEK. PÅ DATALISTE
     C   32              DO
     C                   MOVE      'J'           FAXDE2            1
S30  C*                  EXCEPT    DLHEAD
N30  C                   WRITE     DLHEAD
     C                   MOVE      *ZEROS        XTVKTB            9 0
     C                   MOVE      *ZEROS        XTJUS            10 0
     C                   MOVE      *ZEROS        XN5
     C                   END
     C*
     C     STUDD         TAG
     C                   Z-ADD     0             XN3
     C                   MOVE      *BLANKS       Y1
     C                   MOVE      *BLANKS       E1
     C                   MOVE      *ZEROS        G1
     C                   MOVE      *ZEROS        S1
     C                   MOVE      *BLANKS       P1
     C                   MOVE      *ZEROS        B1
     C                   EXSR      REGN2
N77   *
N77   * FLYTT CONTAINERNR/GODSMERKING TIL VAREBESRIVELSE
N77  C     1             DO        5             YN
N77  C                   IF        VB(YN) = *BLANKS
N77  C                   LEAVE
N77  C                   END
N77  C                   ENDDO
N77  C                   IF        VB(YN) <> *BLANKS
N77  C                   EVAL      YN = YN + 1
N77  C                   END
N106 C                   MOVE      *BLANKS       X_SISTECN        17
N77  C     1             DO        7             YN2               3 0
N77  C                   IF        KN(YN2) <> *BLANKS
N77  C                   IF        YN = 2
N77  C                   EVAL      %SUBST(VB(YN):3:28) = KN(YN2)
N77  C                   ELSE
N77  C                   EVAL      VB(YN) = KN(YN2)
N77  C                   END
N106 C                   EVAL      X_SISTECN = KN(YN2)
N77  C                   EVAL      YN = YN + 1
N77  C                   END
N77  C                   ENDDO
     C*
     C* --------------- START IND. 32 PÅ ----------------
     C   32              DO
     C                   Z-ADD     1             XN3
     C     XN3           DOWLE     5
     C     TO(XN3)       IFEQ      *BLANKS
N22  C     VB(XN3)       ANDEQ     *BLANKS
S34  C*                  GOTO      STUDD2
N34  C                   GOTO      STUDD1
     C                   END
     C                   ADD       1             XN3
     C                   END
N34  C     STUDD1        TAG
S77  C*    XN3           DOWLE     10
N77  C     XN3           DOWLE     12
N34  C     TO(XN3)       IFEQ      *BLANKS
N77  C     VB(XN3)       ANDEQ     *BLANKS
N34  C                   GOTO      STUDD2
N34  C                   END
N34  C                   ADD       1             XN3
N34  C                   END
     C*
     C     STUDD2        TAG
     C                   ADD       1             XN3
     C     XN3           IFLE      2
     C                   Z-ADD     3             XN3
     C                   END
     C     XN3           IFLE      3
     C     Y1(3)         ANDNE     *BLANKS
     C                   Z-ADD     4             XN3
     C                   END
     C     XN3           IFLE      4
     C     Y1(4)         ANDNE     *BLANKS
     C                   Z-ADD     5             XN3
     C                   END
     C     XN3           IFLE      5
     C     Y1(5)         ANDNE     *BLANKS
     C                   Z-ADD     6             XN3
     C                   END
     C     Y1(6)         IFNE      *BLANKS
N34  C     XN3           ANDLE     6
     C                   Z-ADD     7             XN3
     C                   END
     C     Y1(7)         IFNE      *BLANKS
N34  C     XN3           ANDLE     7
     C                   Z-ADD     8             XN3
     C                   END
     C     Y1(8)         IFNE      *BLANKS
N34  C     XN3           ANDLE     8
     C                   Z-ADD     9             XN3
     C                   END
     C*
     C*** XN3 INNEHOLDER NÅ ANTALL LINJER SOM DENNE VAREPOSTEN TRENGER
     C*
     C*** XN5 = START LINJENR.  HVIS XN5+XN3>XA4, SÅ SKIFTER SIDE
     C     XN5           ADD       XN3           XN5               2 0
      * Hvis motorvogn går det 2 linjer ektra pga R31.
     C     MVOGN         IFEQ      'J'
     C                   ADD       3             XN5
      * Hvis motorvogn via ordinære fort-linjer 1 linje pga Underst.nr
     C                   ELSE
     C     WFIVT         IFEQ      'U.NR'
     C     WFIVT         OREQ      'U-NR'
N102 C     WFIVT         OREQ      'U.'                                         WEB-KODE
N102 C     WFIVT         OREQ      'U-'                                         WEB-KODE
     C                   ADD       1             XN5
     C                   END
     C                   END
     C     WFIVF         IFLE      '0'
     C     SIDFVF        IFEQ      0
     C                   MOVE      '1'           WFIVF
     C                   ELSE
     C                   MOVE      SIDFVF        WFIVF
     C                   END
     C                   END
     C*
     C     XN5           IFGT      XA4
S30  C*                  EXCEPT    DLHEAD
N30  C                   WRITE     DLHEAD
     C                   Z-ADD     XN3           XN5
     C                   END
     C     1             DO        8             YN
     C                   MOVE      G1(YN)        XDESIM            2 0
     C     YN            ADD       60            ZN                3 0
     C     XDESIM        IFEQ      0
     C                   MOVE      '0'           *IN(ZN)
     C                   MOVEL     G1(YN)        G11(YN)
     C                   ELSE
     C                   MOVE      '1'           *IN(ZN)
     C                   END
     C                   END
S30  C*                  EXCEPT    DLIST1
S94  C*                  SELECT
S94  C*                  WHEN      SIDP = 76 AND WFILK <> 'NO'
S94  C*                  EVAL      SIDP = 77
S94  C*                  WRITE     DLIST1
S94  C*                  EVAL      SIDP = 76
S94  C*                  WHEN      SIDP = 77 AND WFILK = 'NO'
S94  C*                  EVAL      SIDP = 76
S94  C*                  WRITE     DLIST1
S94  C*                  EVAL      SIDP = 77
S94  C*                  OTHER
N94  C                   IF        WFIDP = 0
N94  C                   EVAL      X_DP = SIDP
N94  C                   ELSE
N94  C                   EVAL      X_DP = WFIDP
N94  C                   END
N30  C                   WRITE     DLIST1
S94  C*                  ENDSL
     C     XN3           IFGT      3
S30  C*                  EXCEPT    DLIST2
N30  C                   WRITE     DLIST2
     C                   END
     C     XN3           IFGT      4
S30  C*                  EXCEPT    DLIST3
N30  C                   WRITE     DLIST3
     C                   END
     C     XN3           IFGT      5
S30  C*                  EXCEPT    DLIST4
N30  C                   WRITE     DLIST4
     C                   END
     C     XN3           IFGT      6
S30  C*                  EXCEPT    DLIST5
N30  C                   WRITE     DLIST5
     C                   END
     C     XN3           IFGT      7
S30  C*                  EXCEPT    DLIST6
N30  C                   WRITE     DLIST6
     C                   END
     C     XN3           IFGT      8
S30  C*                  EXCEPT    DLIST7
N30  C                   WRITE     DLIST7
N106 C                   EVAL      VB(8) = *BLANKS
     C                   END
S77  C*    8             DO        10            XN3
N77  C     8             DO        12            XN3
N34  C                   IF        TO(XN3) = *BLANKS
N77  C                             AND VB(XN3) = *BLANKS
N34  C                   LEAVE
N34  C                   END
N77  C                   EVAL      WFIVB = VB(XN3)
N34  C                   EVAL      WFITO = TO(XN3)
N34  C                   WRITE     DLIST8
N34  C                   ENDDO
N106  *
N106 C                   IF        SIKDC = '1' AND X_SISTECN <> *BLANKS
N106 C                   EVAL      WFITO = *BLANKS
N106 C     1             DO        50            XN4
N106 C                   IF        CNR(XN4) = X_SISTECN OR CNR(XN4) = *BLANKS
N106 C                   LEAVE
N106 C                   END
N106 C                   ENDDO
N106 C                   ADD       1             XN4
N106 C     XN4           DO        50            XN3
N106 C                   IF        CNR(XN3) = *BLANKS
N106 C                   LEAVE
N106 C                   END
N106 C                   ADD       1             XN5
N106 C                   IF        XN5 > XA4
N106 C                   WRITE     DLHEAD
N106 C                   Z-ADD     1             XN5
N106 C                   END
N106 C                   EVAL      WFIVB = CNR(XN3)
N106 C                   WRITE     DLIST8
N106 C                   ENDDO
N106 C                   END
N106  *
     C     MVOGN         IFEQ      'J'
S30  C*                  EXCEPT    DLIMVO
N30  C                   WRITE     DLIMVO
      * Hvis motorvogn via ordinære fort-linjer 1 linje pga Underst.nr
     C                   ELSE
     C     WFIVT         IFEQ      'U.NR'
     C     WFIVT         OREQ      'U-NR'
N102 C     WFIVT         OREQ      'U.'                                         WEB-KODE
N102 C     WFIVT         OREQ      'U-'                                         WEB-KODE
S30  C*                  EXCEPT    DLIMV2
N30  C                   WRITE     DLIMV2
     C                   END
     C                   END
S30  C*                  EXCEPT    DTOMLI
N30  C                   WRITE     DTOMLI
N43  C                   IF        XSNDEMMA = 'J'                               1<-B
N43  C                   EXSR      SREMMA5
N43  C                   END                                                    1<-E
     C*
     C                   END
     C* --------------- SLUTT IND. 32 PÅ ----------------
     C*
     C*** REGNER TOTAL BRUTTO VEKT OG TOTAL JUSTERING
     C*                    ADD  SVVKTB    XTVKTB
     C                   ADD       WFIVKB        XTVKTB
     C     SIFTG2        IFEQ      '-'
     C     SIFTG2        OREQ      'M'
     C                   SUB       WFIJUS        XTJUS
     C                   ELSE
     C                   ADD       WFIJUS        XTJUS
     C                   END
     C*
     C     MVOGN         IFEQ      'J'
     C     SADHK         READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
N77  C                   MOVE      *BLANKS       VB
     C     SADHK         READE     WFILEIMP                               33
N50  C                   DOW       *IN33 = *OFF
N50  C                   IF        WFITRP <> 'S'
N84  C                             AND WFITRP <> 'D'
N50  C                   LEAVE
N50  C                   END
N50  C                   DELETE    WFILEIR
N77  C                   MOVE      *BLANKS       VB
N50  C     SADHK         READE     WFILEIMP                               33
N50  C                   ENDDO
     C  N33              DELETE    WFILEIR
     C                   END
N106  *
N106  * HENT CONTAINENR
N106 C                   IF        XSNDEMMA <> 'J'
N106 C  N33              EXSR      SRHENTCN
N106 C                   END
N106  *
     C  N33              GOTO      STUDD
     C*
     C*** SKRIV DEL-1
     C                   Z-ADD     0             XN3
     C                   Z-ADD     1             XN4
S47  C*    XN4           DOWLT     16
N47  C     XN4           DOWLT     38
     C     T1(XN4)       IFEQ      *BLANKS
     C                   GOTO      STUDD3
     C                   END
     C     T1(XN4)       IFNE      'TL'
     C                   ADD       1             XN3
     C                   END
     C                   ADD       1             XN4
     C                   END
     C     STUDD3        TAG
S47  C*    T1(20)        IFNE      *BLANKS
N47  C     T1(40)        IFNE      *BLANKS
N72  C     SIMVA         ANDNE     'J'
N72  C     T1(40)        ORNE      *BLANKS
N72  C     SIMVA         ANDEQ     'J'                                          MVA-REGISTRERT
N72  C     XSNDEMMA      ANDEQ     'J'                                          SEND TIL EMMA
N72  C     X_SYMVSP      ANDEQ     'J'                                          MED MVA-SPEC
N72   * ENTEN IKKE MVA-REGISTRERT ELLER MVA-REGISTRERT, TIL EMMA OG MVA-SPESIFIKASJON
     C                   MOVE      'MV'          T1(XN4)
S47  C*                  MOVE      T2(20)        T2(XN4)
N47  C                   MOVE      T2(40)        T2(XN4)
     C                   END
     C*
     C     XTJUS         COMP      0                                    51
S28  C*  32XN4           IFLE      8                                            1<-B
S47  C*  32XN4           IFLE      16                                           1<-B
N47  C   32XN4           IFLE      38                                           1<-B
     C                   SETOFF                                       98
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C     F1(1)         IFEQ      *BLANKS                                       2<-B
     C                   EXSR      TRIMGN
N24  C                   MOVE      *BLANKS       TO
N16  C                   EXSR      FRISR
S25  C*                  EXCEPT    DLDEL1
n46  c                   move      *blanks       MVP1
n46  c                   z-add     0             MVP2
N46  C     wt111         ifne      *blanks
n46  c     wt111         andne     'MV'
n46  c                   move      'MV='         MVP1
n46  c                   z-add     sibel6        MVP2
n46  c                   end
N50  C   26              MOVE      XNR           XNROMB2           5 0
N50  C   26              MOVE      XNROMB        XNR
N25  C                   WRITE     DLDEL1
N50  C   26              MOVE      XNROMB2       XNR
     C                   ELSE                                                    2
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9                                              3<-B
     C                   ADD       1             YN
     C     F1(YN)        IFEQ      *BLANKS                                         4<-B
     C                   ADD       10            YN
     C                   ELSE                                                      4
     C                   MOVE      F1(YN)        KFMT1
     C                   MOVE      F2(YN)        KFMT2
     C                   EXSR      TRIMGN
N24  C                   MOVE      *BLANKS       TO
N16  C                   EXSR      FRISR
S25  C*                  EXCEPT    DLDEL1
n46  c                   move      *blanks       MVP1
n46  c                   z-add     0             MVP2
N46  C     wt111         ifne      *blanks
n46  c     wt111         andne     'MV'
n46  c                   move      'MV='         MVP1
n46  c                   z-add     sibel6        MVP2
n46  c                   end
N50  C   26              MOVE      XNR           XNROMB2           5 0
N50  C   26              MOVE      XNROMB        XNR
N25  C                   WRITE     DLDEL1
N50  C   26              MOVE      XNROMB2       XNR
     C                   END                                                       3<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C                   SETON                                        98
     C                   Z-ADD     0             XDSUM
     C     1             DO        8             XN5                             2<-B
E78  C                   ADD       T2(XN5)       XDSUM
     C                   END                                                     2<-E
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C     F1(1)         IFEQ      *BLANKS                                       2<-B
     C                   EXSR      TRIMGN
N24  C                   MOVE      *BLANKS       TO
N16  C                   EXSR      FRISR
S25  C*                  EXCEPT    DLDEL1
n46  c                   move      *blanks       MVP1
n46  c                   z-add     0             MVP2
N46  C     wt111         ifne      *blanks
n46  c     wt111         andne     'MV'
n46  c                   move      'MV='         MVP1
n46  c                   z-add     sibel6        MVP2
n46  c                   end
N50  C   26              MOVE      XNR           XNROMB2           5 0
N50  C   26              MOVE      XNROMB        XNR
N25  C                   WRITE     DLDEL1
N50  C   26              MOVE      XNROMB2       XNR
     C                   ELSE                                                    2
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9                                              3<-B
     C                   ADD       1             YN
     C     F1(YN)        IFEQ      *BLANKS                                         4<-B
     C                   ADD       10            YN
     C                   ELSE                                                      4
     C                   MOVE      F1(YN)        KFMT1
     C                   MOVE      F2(YN)        KFMT2
     C                   EXSR      TRIMGN
N24  C                   MOVE      *BLANKS       TO
N16  C                   EXSR      FRISR
S25  C*                  EXCEPT    DLDEL1
n46  c                   move      *blanks       MVP1
n46  c                   z-add     0             MVP2
N46  C     wt111         ifne      *blanks
n46  c     wt111         andne     'MV'
n46  c                   move      'MV='         MVP1
n46  c                   z-add     sibel6        MVP2
n46  c                   end
N50  C   26              MOVE      XNR           XNROMB2           5 0
N50  C   26              MOVE      XNROMB        XNR
N25  C                   WRITE     DLDEL1
N50  C   26              MOVE      XNROMB2       XNR
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   Z-ADD     0             XDSUM
     C     9             DO        16            XN5                             2<-B
E78  C                   ADD       T2(XN5)       XDSUM
     C                   END                                                     2<-E
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C     F1(1)         IFEQ      *BLANKS                                       2<-B
     C                   EXSR      TRIMGN
S25  C*                  EXCEPT    DLDEL2
N25  C                   WRITE     DLDEL2
     C                   ELSE                                                    2
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9                                              3<-B
     C                   ADD       1             YN
     C     F1(YN)        IFEQ      *BLANKS                                         4<-B
     C                   ADD       10            YN
     C                   ELSE                                                      4
     C                   MOVE      F1(YN)        KFMT1
     C                   MOVE      F2(YN)        KFMT2
     C                   EXSR      TRIMGN
S25  C*                  EXCEPT    DLDEL2
N25  C                   WRITE     DLDEL2
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N28   *
N28  C   32              IF        T1(12) <> *BLANKS                            1<-B
N28  C                   WRITE     DLAVGH
S47  C*    1             DO        16            XN5                             2<-B
N47  C     1             DO        38            XN5                             2<-B
N28  C                   IF        T1(XN5) = *BLANKS                              3<-B
N28  C                   LEAVE
N28  C                   END                                                      3<-E
N28  C                   EVAL      XTAVGT = T1(XN5)
N28  C                   EVAL      XTAVGB = T2(XN5)
N28  C                   WRITE     DLAVGD
N28  C                   ENDDO                                                   2<-E
N28  C                   WRITE     DLAVGS
N28  C                   END                                                    1<-E
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     UTR28         BEGSR
     C***********************************************
     C*** SKRIVE FAKTURALINJER (RUBR. 28)
     C                   SETOFF                                       9095
      *
     C     SADFK         SETLL     SADF
     C     SADFK         READE     SADF                                   90
     C                   IF        *IN90 = *OFF
     C     SADFK         READE     SADF                                   90
     C                   IF        *IN90
     C                   MOVE      SFTXT         SIFIF
     C                   MOVE      SFDT          SIFID
     C                   GOTO      SLUTR28
     C                   END
     C                   END
      *
     C     SADFK         SETLL     SADF
     C     SADFK         READE     SADF                                   90
     C  N90              DO
     C*
     C   32              DO
S30  C*                  EXCEPT    RU28H
N30  C                   WRITE     RU28H
     C     SIFID         IFNE      99999999
S30  C*                  EXCEPT    RU28H2
N30  C                   WRITE     RU28H2
     C                   END
S30  C*                  EXCEPT    RU28D
N30  C                   WRITE     RU28D
     C                   END
     C*
     C                   SETON                                        95
     C                   Z-ADD     8             XN5
     C                   Z-ADD     1             XR28SD            3 0  40
     C     STUT28        TAG
     C     SADFK         READE     SADF                                   90
     C  N90
     CAN 32XN5           IFGE      XA4
     C                   ADD       1             XR28SD               40
S30  C*                  EXCEPT    RU28H
N30  C                   WRITE     RU28H
     C                   Z-ADD     8             XN5
     C                   ELSE
     C                   ADD       1             XN5
     C                   END
     C  N90
S30  CAN 32              WRITE     RU28D
N30  C*N 32              EXCEPT    RU28D
     C  N90              GOTO      STUT28
     C                   END
     C*
     C     SLUTR28       TAG
     C                   ENDSR
     C*
     C***********************************************
     C     UTDEL2        BEGSR
     C***********************************************
     C*** SKRIVE VARELINJER (TOLLDEK. DEL-2) PÅ TOLLDEK. FORMULAR.
     C                   SETON                                        97
     C                   SETOFF                                       33
      *
     C                   MOVE      *ZEROS        XLN               3 0
     C     STUD20        TAG
     C                   ADD       1             XLN
     C     XLASER        IFEQ      'N'
     C                   MOVE      'J'           XSLETT            1
     C                   MOVE      F3(XLN)       XPFM1            75
     C                   MOVE      F4(XLN)       XPFM2            75
     C                   ELSE
     C                   ADD       1             XLN
     C     F3(XLN)       IFEQ      *BLANKS
     C                   MOVE      'J'           XSLETT
     C                   ELSE
     C                   MOVE      'N'           XSLETT
     C                   END
     C                   SUB       1             XLN
     C                   MOVE      F3(XLN)       XPFM1
     C                   MOVE      F4(XLN)       XPFM2
     C                   END
      *
     C     MVOGN         IFEQ      'J'
     C     SADHK         READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADHK         READE     WFILEIMP                               33
N50  C                   DOW       *IN33 = *OFF
N50  C                   IF        WFITRP <> 'S'
N84  C                             AND WFITRP <> 'D'
N50  C                   LEAVE
N50  C                   END
N50  C                   DELETE    WFILEIR
N50  C     SADHK         READE     WFILEIMP                               33
N50  C                   ENDDO
     C  N33XSLETT        IFEQ      'J'
     C                   DELETE    WFILEIR
     C                   ELSE
     C                   UPDATE    WFILEIR
     C                   END
N106  *
N106  * HENT CONTAINENR
N106 C                   IF        XSNDEMMA <> 'J'
N106 C  N33              EXSR      SRHENTCN
N106 C                   END
N106  *
     C                   END
     C     STUD2         TAG
     C                   Z-ADD     0             XN3
     C     XLN           IFEQ      1
     C                   ADD       1             XSNR
     C                   END
     C                   MOVE      *BLANKS       Y1
     C                   MOVE      *BLANKS       E1
     C                   MOVE      *ZEROS        G1
     C                   MOVE      *ZEROS        S1
     C                   MOVE      *BLANKS       P1
     C                   MOVE      *ZEROS        B1
     C*
     C   32              EXCEPT    DEL2
     C*
     C                   EXSR      REGN2
     C   32              EXSR      SJVBES
     C   32              EXCEPT    DEL21
     C*
     C     MVOGN         IFEQ      'J'
     C     SADHK         READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADHK         READE     WFILEIMP                               33
N50  C                   DOW       *IN33 = *OFF
N50  C                   IF        WFITRP <> 'S'
N84  C                             AND WFITRP <> 'D'
N50  C                   LEAVE
N50  C                   END
N50  C                   DELETE    WFILEIR
N50  C     SADHK         READE     WFILEIMP                               33
N50  C                   ENDDO
     C  N33XSLETT        IFEQ      'J'
     C                   DELETE    WFILEIR
     C                   ELSE
     C                   UPDATE    WFILEIR
     C                   END
N106  *
N106  * HENT CONTAINENR
N106 C                   IF        XSNDEMMA <> 'J'
N106 C  N33              EXSR      SRHENTCN
N106 C                   END
N106  *
     C                   END
     C   33
     CAN 32              EXCEPT    DEL21X
     C   33              EXSR      DEL2SL
     C   33XSLETT        IFEQ      'J'
     C                   GOTO      SLUD2
     C                   ELSE
     C     SADHK         SETLL     WFILEIMP
     C                   GOTO      STUD20
     C                   END
     C*
     C                   EXSR      REGN2
     C   32              EXSR      SJVBES
     C   32              EXCEPT    DEL22
     C*
     C     MVOGN         IFEQ      'J'
     C     SADHK         READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADHK         READE     WFILEIMP                               33
N50  C                   DOW       *IN33 = *OFF
N50  C                   IF        WFITRP <> 'S'
N84  C                             AND WFITRP <> 'D'
N50  C                   LEAVE
N50  C                   END
N50  C                   DELETE    WFILEIR
N50  C     SADHK         READE     WFILEIMP                               33
N50  C                   ENDDO
     C  N33XSLETT        IFEQ      'J'
     C                   DELETE    WFILEIR
     C                   ELSE
     C                   UPDATE    WFILEIR
     C                   END
N106  *
N106  * HENT CONTAINENR
N106 C                   IF        XSNDEMMA <> 'J'
N106 C  N33              EXSR      SRHENTCN
N106 C                   END
N106  *
     C                   END
     C   33
     CAN 32              EXCEPT    DEL22X
     C   33              EXSR      DEL2SL
     C   33XSLETT        IFEQ      'J'
     C                   GOTO      SLUD2
     C                   ELSE
     C     SADHK         SETLL     WFILEIMP
     C                   GOTO      STUD20
     C                   END
     C*
     C                   EXSR      REGN2
     C   32              EXSR      SJVBES
     C   32              EXCEPT    DEL23
     C*
     C     XLN           IFEQ      1
     C     XSLETT        ANDEQ     'J'
     C     MVOGN         IFEQ      'J'
     C     SADHK         READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADHK         READE     WFILEIMP                               33
N50  C                   DOW       *IN33 = *OFF
N50  C                   IF        WFITRP <> 'S'
N84  C                             AND WFITRP <> 'D'
N50  C                   LEAVE
N50  C                   END
N50  C                   DELETE    WFILEIR
N50  C     SADHK         READE     WFILEIMP                               33
N50  C                   ENDDO
     C  N33              DELETE    WFILEIR
N106  *
N106  * HENT CONTAINENR
N106 C                   IF        XSNDEMMA <> 'J'
N106 C  N33              EXSR      SRHENTCN
N106 C                   END
N106  *
     C                   END
     C   33              EXSR      DEL2SL
     C   33              GOTO      SLUD2
     C                   ELSE
     C     XSNR          IFEQ      XTOTS
     C                   MOVE      '1'           *IN33
     C                   EXSR      DEL2SL
     C     XSLETT        CABEQ     'J'           SLUD2
     C                   GOTO      SLUD20
     C                   END
     C                   END
     C   32
     CANN941             DO        24            YN
     C                   MOVE      G1(YN)        XDESIM            2 0
     C     YN            ADD       60            ZN                3 0
     C     XDESIM        IFEQ      0
     C                   MOVE      '0'           *IN(ZN)
     C                   MOVEL     G1(YN)        G11(YN)
     C                   ELSE
     C                   MOVE      '1'           *IN(ZN)
     C                   END
     C                   END
     C   32
     CANN94              EXCEPT    DEL2S
     C   32
     CAN 94              MOVE      G1(1)         XDESIM            2 0
     C   32
     CAN 94XDESIM        IFEQ      0
     C                   MOVE      '0'           *IN61
     C                   MOVEL     G1(1)         G11(YN)
     C                   ELSE
     C                   MOVE      '1'           *IN61
     C                   END
     C   32
     CAN 94              EXCEPT    DEL2SX
     C     SLUD20        TAG
     C     XLN           IFEQ      1
     C     XSLETT        ANDEQ     'J'
     C                   GOTO      STUD2
     C                   ELSE
     C     SADHK         SETLL     WFILEIMP
     C     XSLETT        IFEQ      'J'
     C                   MOVE      *ZEROS        XLN
     C                   END
     C                   GOTO      STUD20
     C                   END
     C*
     C     SLUD2         ENDSR
     C*
     C***********************************************
     C     FLYTT         BEGSR
     C***********************************************
     C*** FLYTTE FELLES DATA TIL ARB.VARIABLER OG NULLSTILLE ANDRE VAR.
     C                   ADD       1             XNR
N50  C                   IF        SVPREÆ <> 'S'
N84  C                             AND SVPREÆ <> 'D'
N50  C                   ADD       1             XNROMB
N50  C                   END
     C                   Z-ADD     1             XN2
     C                   Z-ADD     1             XN3
     C                   EXSR      MOVBWF
     C*
     C                   MOVE      SVTN          WFITN
     C                   MOVE      SVVNT         WFIVNT
     C                   MOVE      SVLK          WFILK
N94  C                   MOVE      SVDP          WFIDP
     C                   MOVE      SVPRE         WFIPRE
     C                   MOVE      SVVF          WFIVF
     C                   MOVE      SVAS          WFISAT
S103 C*                  MOVE      SVEH21        WFIPRO
N103 C                   IF        SVPVA = 'P'
N103 C                   EVAL      WFIPRO = '%'
N103 C                   ELSE
N103 C                   EVAL      WFIPRO = ' '
N103 C                   END
N50  C                   MOVE      SVPREÆ        WFITRP
     C                   MOVE      SVPVA         XPVA1             1
     C     SVMFR         IFEQ      'F'
     C                   MOVE      '1'           *IN34
     C                   MOVE      *BLANKS       WFISKV
     C                   ELSE
     C                   MOVEL     SVMFR         WFISKV
     C     SADSDK        SETLL     SADSD
     C     SADSDK        READE     SADSD                                  34
     C     *IN34         DOWEQ     '0'
S56  C*    SDDTF         IFLE      XIDT
S56  C*    SDDTT         ANDGE     XIDT
N56  C                   IF        SDDTF <= X_M0068A AND SDDTT >= X_M0068A
     C                   LEAVE
     C                   END
     C     SADSDK        READE     SADSD                                  34
     C  N34              ENDDO
     C     *IN34         IFEQ      '1'
     C     SVMFR         ANDEQ     '1'
     C     FITAX         MULT      100           SDBLSÆ
     C                   MOVE      '0'           *IN34
     C                   END
     C                   END
     C     *IN34         IFEQ      '0'
     C                   MOVE      SDBLSÆ        WFIMVS
     C                   ELSE
     C                   MOVE      *ZEROS        WFIMVS
     C                   END
     C                   MOVE      *BLANKS       Y2
     C                   MOVE      *BLANKS       E2
     C                   MOVE      *ZEROS        G2
     C                   MOVE      *ZEROS        S2
     C                   MOVE      *BLANKS       P2
     C                   MOVE      *ZEROS        B2
     C                   MOVE      *BLANKS       KN
     C                   MOVE      *ZEROS        WFIANT
     C                   MOVE      *ZEROS        WFINTM
     C                   MOVE      *BLANKS       WFIVT
      *
     C                   SELECT
     C     SVVNT         WHENGE    22030000
     C     SVVNT         ANDLE     22089999
      * ALKOHOL --> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   MOVE      '1'           *IN92
     C     SVVNT         WHENGE    24010000
     C     SVVNT         ANDLE     24039999
      * TOBAKK  --> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   MOVE      '1'           *IN92
     C     SVVNT         WHENGE    48130000
     C     SVVNT         ANDLE     48139999
      * TOBAKK  --> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   MOVE      '1'           *IN92
     C                   ENDSL
      * HENTE JUSTERINGSBELØP
     C     SADVJK        CHAIN     SADVJ                              34
     C   34              MOVE      *ZEROS        SJBELN
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FLYTT2        BEGSR
     C***********************************************
     C                   ADD       1             XN3
     C     XN3           MULT      8             XN4
     C     XN4           SUB       7             XN4
     C                   MOVE      SIAS          XSIAS             5 1
     C     1             DO        6             XN6
     C     Y2(XN6)       IFEQ      'TA'
     C                   MOVE      *ZEROS        SIAS
     C                   MOVE      *ZEROS        WFITRA
     C                   END
     C                   END
      *
      * N93, 94, 92 ---> KUN "TA" AVGIFT
      * N93,N94,N92 ---> "TA", "BV/TO" AVGIFTER
      *  93,N94,N92 ---> KUN "BV/TO" AVGIFTER
     C   94              MOVE      *ZEROS        WFITOL
     C   94              MOVE      *ZEROS        WFIMVA
     C   94              MOVE      'F'           WFPVA
     C   94              MOVE      *BLANKS       WFISKV
     C   94              MOVE      *ZEROS        WFISUM
     C   92
     CAN 94
     CANN93
     CORN92
     CANN94              DO                                                     1<-B
     C  N94SIBELR        IFEQ      0
     C                   Z-ADD     WFISTB        WFIMVG
     C                   ELSE
     C                   Z-ADD     WFIBBL        WFIMVG
     C                   END
     C                   SUB       WFITOL        WFISUM
     C     1             DO        6             XN6                             2<-B
     C  N93Y2(XN6)       CABEQ     'TA'          STF201
     C  N94XTOTBV        IFGT      0                                              3<-B
N18  C     UTBTAX0S      CABEQ     'J'           STF201
     C     Y2(XN6)       CABEQ     'BV'          STF201
     C     Y2(XN6)       CABEQ     'EB'          STF201
     C     Y2(XN6)       CABEQ     'EG'          STF201
     C     Y2(XN6)       CABEQ     'TO'          STF201
      * AVGIFTER FRITATT FRA MVA-GR.LAG
     C                   MOVE      E2(XN6)       KS8SKV
     C                   MOVE      Y2(XN6)       KS8AVG
     C     KODS8K        CHAIN     KODTS8                             31
     C  N31KS8STA        CABEQ     'N'           STF201
     C                   MOVE      *BLANKS       KS8SKV
     C     KODS8K        CHAIN     KODTS8                             31
     C  N31KS8STA        CABEQ     'N'           STF201
     C     Y2(XN6)       CABEQ     'NA'          STF201
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       Y2(XN6)
     C                   MOVE      *BLANKS       E2(XN6)
     C                   MOVE      *ZEROS        G2(XN6)
     C                   MOVE      *ZEROS        S2(XN6)
     C                   MOVE      *BLANKS       P2(XN6)
     C                   MOVE      *ZEROS        B2(XN6)
     C     STF201        TAG
     C     Y2(XN6)       IFNE      'TA'                                           3<-B
     C     Y2(XN6)       ANDNE     *BLANKS
      * AVGIFTER FRITATT FRA MVA-GR.LAG
     C                   MOVE      E2(XN6)       KS8SKV
     C                   MOVE      Y2(XN6)       KS8AVG
     C     KODS8K        CHAIN     KODTS8                             31
     C     *IN31         IFEQ      *ON                                             4<-B
     C     KS8STA        ORNE      'N'
     C                   MOVE      *BLANKS       KS8SKV
     C     KODS8K        CHAIN     KODTS8                             31
     C                   END                                                       4<-E
     C     *IN31         IFEQ      *OFF                                            4<-B
     C     KS8STA        ANDNE     'N'
     C                   ADD       B2(XN6)       WFIMVG
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C*** 43 PÅ  --->  FULL TOLL (PREFERANSE KAN VÆRE JA/NEI)
     C*** N42 43 ---> JA;      42 43 --> NEI
     C*
     C*** FLYTTE TOLL FOR Å SKRIVE UT
     C     WFPVA         IFNE      'F'
     C                   MOVE      'TL'          Y1(XN4)
     C                   MOVE      '1  '         E1(XN4)
     C                   Z-ADD     WFITLG        G1(XN4)
     C                   Z-ADD     WFISAT        S1(XN4)
     C                   MOVE      WFIPRO        P1(XN4)
     C                   MOVE      WFITOL        B1(XN4)
     C  N92
     CANN94              ADD       WFITOL        WFIMVG
     C                   MOVE      *BLANKS       TR(XN4)
     C                   ADD       1             XN4
     C                   END
     C*
     C*** FLYTTE TRAFIKKAVGIFT FOR Å SKRIVE UT VED AT BRUKER ØNSKER
     C*** EN GENERELL TRAFIKKAVGIFT FOR HELE TOLLDEK.
     C  N93SIAS          IFGT      0
     C     WFITRA        ANDGT     0
     C                   MOVE      'TA'          Y1(XN4)
     C                   MOVE      '1  '         E1(XN4)
     C                   Z-ADD     WFITRG        G1(XN4)
     C                   Z-ADD     SIAS          S1(XN4)
     C                   MOVE      WFITRP        P1(XN4)
     C                   MOVE      WFITRA        B1(XN4)
     C                   ADD       1             XN4
     C  N94              ADD       WFITRA        WFIMVG
     C                   ADD       WFITRA        WFISUM
     C                   END
     C*
     C*** FLYTTE ANDRE AVGIFTER FOR Å SKRIVE UT
     C                   Z-ADD     1             XN6               1 0
     C     XN6           DOWLE     6
     C     Y2(XN6)       IFNE      *BLANKS
     C     Y2(XN6)       IFEQ      'TA'
     C   93              GOTO      STFL2
     C  N94              ADD       B2(XN6)       WFIMVG
     C                   ADD       B2(XN6)       WFISUM
     C                   ELSE
     C                   MOVE      *BLANKS       TR(XN4)
     C                   END
     C                   MOVE      Y2(XN6)       Y1(XN4)
     C                   MOVE      E2(XN6)       E1(XN4)
     C                   MOVE      G2(XN6)       G1(XN4)
     C                   MOVE      S2(XN6)       S1(XN4)
     C                   MOVE      P2(XN6)       P1(XN4)
     C                   Z-ADD     B2(XN6)       B1(XN4)
     C                   ADD       1             XN4
     C                   END
     C     STFL2         TAG
     C                   ADD       1             XN6
     C                   END
     C*
     C*** FLYTTE MOMS FOR Å SKRIVE UT
     C     WFISKV        IFNE      *BLANKS
N72  C     SIMVA         ANDNE     'J'
N72  C     WFISKV        ORNE      *BLANKS
N72  C     SIMVA         ANDEQ     'J'                                          MVA-REGISTRERT
N72  C     XSNDEMMA      ANDEQ     'J'                                          SEND TIL EMMA
N72  C     X_SYMVSP      ANDEQ     'J'                                          MED MVA-SPEC
N72   * ENTEN IKKE MVA-REGISTRERT ELLER MVA-REGISTRERT, TIL EMMA OG MVA-SPESIFIKASJON
     C     WFIMVG        MULT(H)   WFIMVS        XWORK2           11 0
     C     XWORK2        DIV(H)    100           WFIMVA
     C                   Z-ADD     WFIMVS        S1(XN4)
     C   92
     CAN 94
     CANN93
     CORN92
     CANN94WFPVA         IFNE      'F'
     C                   ADD       WFITOL        WFISUM
     C                   END
     C                   ADD       WFIMVA        WFISUM
     C                   MOVE      'MV'          Y1(XN4)
     C                   MOVE      WFISKV        E1(XN4)
     C                   Z-ADD     WFIMVG        G1(XN4)
     C                   MOVE      '%'           P1(XN4)
     C                   MOVE      WFIMVA        B1(XN4)
     C                   MOVE      *BLANKS       TR(XN4)
     C                   END
      *
     C                   MOVE      XSIAS         SIAS
N71   *
N71  C                   IF        SIDP = 49
N94  C                             OR WFIDP = 49
N71  C                   EVAL      WFIFTG = ' '
N71  C                   EVAL      WFIJUS = WFITRA
N71  C                   EVAL      WFISTB = WFIBBL
N71  C                   END
     C*
     C                   ENDSR
     C*
N36   */////////////////////////////////////////////////////////////
N36   *                                                      AVRUND
N36   */////////////////////////////////////////////////////////////
N36  C     AVRUND        BEGSR
N36   *
N36  C                   EVAL      KS8AVG = Y2(XN4)
N36  C                   EVAL      KS8SKV = E2(XN4)
N63  C                   IF        KS8AVG <> 'TL'
N68  C                             AND KS8AVG = 'TL'
N68   * AVGIFTGRUNNLAG MED 2 DESIMALER GODTAS
N52  C                   Z-ADD(H)  G2(XN4)       XN09              9 0
N57  C                   IF        XN09 = 0
N52  C                   EVAL      G2(XN4) = 1
N57  C                   ELSE
N52  C                   EVAL      G2(XN4) = XN09
N57  C                   END
N63  C                   END
N36  C     KODS8K        CHAIN     KODTS8                             31
N36  C  N31              SELECT
N36  C                   WHEN      KS8STY = '%' OR
N36  C                             KS8STY = 'H' OR
N36  C                             KS8STY = '*'
N36  C                   IF        KS8ØRE = '*'
N36  C                   EVAL      XWORK = G2(XN4) * S2(XN4) / 10000
N36  C                   ELSE
N36  C                   EVAL      XWORK = G2(XN4) * S2(XN4) / 100
N36  C                   END
N36  C                   WHEN      KS8STY = 'P'
N36  C                   IF        KS8ØRE = '*'
N36  C                   EVAL      XWORK = G2(XN4) * S2(XN4) / 100000
N36  C                   ELSE
N36  C                   EVAL      XWORK = G2(XN4) * S2(XN4) / 1000
N36  C                   END
N36  C                   WHEN      KS8STY = ' ' OR
N36  C                             KS8STY = 'P' OR
N36  C                             KS8STY = 'K' OR
N36  C                             KS8STY = 'G' OR
N36  C                             KS8STY = 'M' OR
N36  C                             KS8STY = 'D' OR
N36  C                             KS8STY = 'T' OR
N36  C                             KS8STY = 'L' OR
N36  C                             KS8STY = 'A' OR
N36  C                             KS8STY = 'B'
N36  C                   IF        KS8ØRE = '*'
N36  C                   EVAL      XWORK = G2(XN4) * S2(XN4) / 100
N36  C                   ELSE
N36  C                   EVAL      XWORK = G2(XN4) * S2(XN4)
N36  C                   END
N36  C                   ENDSL
S49  C*                  MOVE      XWORK         XAN06             6
S49  C*                  IF        *IN31 = *OFF AND XAN06 < '500000'
S49  C*                  Z-ADD     B2(XN4)       XAVG              9 0
N49  C                   IF        *IN31 = *OFF
S96  C*                  Z-ADD(H)  XWORK         XAVG              9 0
N96  C                   Z-ADD(H)  XWORK         XAVG             11 0
N36  C                   ELSE
N36  C                   Z-ADD(H)  B2(XN4)       XAVG
N36  C                   END
N36   *
N36  C                   ENDSR
N36   *
     C***********************************************
     C     REGN          BEGSR
     C***********************************************
N34  C                   IF        WFIVKB123 < 0.5
N34  C                   Z-ADD     1             WFIVKB
N34  C                   ELSE
N34  C                   ADD       0,5           WFIVKB123
N34  C                   END
N34  C                   IF        WFIVKN123 < 0.5
N34  C                   Z-ADD     1             WFIVKN
N34  C                   ELSE
N34  C                   ADD       0,5           WFIVKN123
N34  C                   END
N34   *
     C     SIBELR        IFNE      0
     C     XTVF2         MULT(H)   XBELR2        WFIBBL
     C                   END
     C                   MOVE      *ZEROS        XECEI             9 0
     C*** BEREGNE TOLL, MOMS OG TRAFIKKAVGIFTER. OPPDATERE PÅ WFILEIMP
     C                   ADD       X50           XWFTLG
     C                   ADD       X50           XWFSTB
     C*** AVRUNDING VIA DATASTRUKTUR
     C*
     C*** BEREGNE TRAFIKKAVGIFT.
     C*** 1. BRUKER HAR GITT SATS FOR HELE TOLLDEK.
     C*** 2. BRUKER REGISTRERER DET SOM ANDRE AVGIFTER.
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     6
     C     B2(XN4)       IFNE      0
S96  C*                  Z-ADD(H)  B2(XN4)       XAVG              9 0
N96  C                   Z-ADD(H)  B2(XN4)       XAVG
S49  C*                  MOVE      B2(XN4)       XAN02             2
S49  C*                  IF        XAN02 = '50'
N36  C                   EXSR      AVRUND
S49  C*                  END
     C                   Z-ADD     XAVG          B2(XN4)
     C                   END
     C                   ADD       1             XN4
     C                   END
     C                   MOVE      *ZEROS        XWFTOL
     C     XPVA1         IFEQ      'P'
     C     WFITLG        MULT      WFISAT        XWORK
     C     XWORK         DIV(H)    100           XWFTOL
     C                   END
     C     XPVA1         IFEQ      'V'
     C     WFIVKN        MULT      WFISAT        XWFTOL
     C                   END
     C     XPVA1         IFEQ      'W'
     C     WFIVKN        MULT      WFISAT        XWFTOL
     C                   DIV(H)    100           XWFTOL
     C                   END
     C     XPVA1         IFEQ      'A'
     C     WFINTM        MULT      WFISAT        XWFTOL
     C                   END
     C                   ADD       X50           XWFTOL
     C*
     C                   MOVE      *ZEROS        XTRAVG            9 0
      * 99 PÅ --> PROS.48, 70-77 --> IKKE BEREGN TRAFIKKAVGIFT
     C     *IN99         IFEQ      '1'
     C                   MOVE      *ZEROS        WFITRA
     C                   ELSE
     C     SIKDTR        IFEQ      *BLANKS
     C     WFIVKN        DIV       1000          XTRAV2           11 3
S50  C*                  MOVE      *BLANKS       WFITRP
     C                   Z-ADD     WFIVKN        WFITRG
     C                   ELSE
      * PROSENT AV VAREVERDI
     C     WFITLG        DIV       100           XTRAV2
     C                   Z-ADD     WFITLG        WFITRG
S50  C*                  MOVE      '%'           WFITRP
     C                   END
     C     XTRAV2        MULT(H)   SIAS          WFITRA
     C                   END
     C*
     C                   MOVE      *ZEROS        WFIMVG
     C     1             DO        6             XN4                            1<-B
     C     Y2(XN4)       IFEQ      'TA'                                          2<-B
     C                   Z-ADD     B2(XN4)       XTRAVG
     C                   MOVE      *ZEROS        WFITRA
     C                   ELSE                                                    2
     C     Y2(XN4)       IFEQ      'BV'                                           3<-B
     C     Y2(XN4)       OREQ      'TO'
     C                   ADD       B2(XN4)       XTOTBV
     C                   END                                                      3<-E
      *
      * AVGIFTER FRITATT FRA MVA-GR.LAG
     C                   MOVE      E2(XN4)       KS8SKV
     C                   MOVE      Y2(XN4)       KS8AVG
     C     KODS8K        CHAIN     KODTS8                             31
     C     *IN31         IFEQ      *OFF
     C     KS8STA        ANDEQ     'N'
     C                   ADD       B2(XN4)       XECEI
     C                   ELSE
     C                   MOVE      *BLANKS       KS8SKV
     C     KODS8K        CHAIN     KODTS8                             31
     C     *IN31         IFEQ      *OFF
     C     KS8STA        ANDEQ     'N'
     C                   ADD       B2(XN4)       XECEI
     C                   END
     C                   END
     C                   ADD       B2(XN4)       WFIMVG
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C                   ADD       XTRAVG        WFITRA
     C                   Z-ADD     WFITRA        XTRAVG
     C                   ADD       WFITRA        SIBELT
     C*
     C*** 38 PÅ ---> TOLLFRANKO
     C   38              DO
     C     WFITLG        SUB       XTRAVG        XHELP             9 0
     C     WFITLG        SUB       WFISTB        WFIJUS
     C     WFIJUS        SUB       XTRAVG        WFIJUS
     C*  WFISAT PÅ F.EKS 25,75  LEGGES I ARB.FELT SOM 1.2575
     C*  FOR Å KUNNE TREKKE UT TOLL SOM ALT ER INNKALK. I HAND.FAKTURA.
     C* VERDITOLL
     C  N52              MOVE      WFISAT        XTSATS            7 4
     C  N52              ADD       1             XTSATS
     C     *IN52         IFEQ      '0'
     C     XTSATS        ANDGT     0
     C     XHELP         DIV(H)    XTSATS        WFITLG
     C                   ENDIF
     C  N52WFITLG        MULT(H)   WFISAT        WFITOL
     C  N52              DIV(H)    100           WFITOL
     C* VEKTTOLL
     C   52WFIVKN        MULT(H)   WFISAT        WFITOL
     C   52XHELP         SUB       WFITOL        WFITLG
     C     WFIJUS        SUB       WFITOL        WFIJUS
     C     WFIJUS        IFLT      0
     C                   MULT      -1            WFIJUS
     C                   MOVE      '-'           WFIFTG
     C                   ELSE
     C                   MOVE      *BLANKS       WFIFTG
     C                   END
     C                   END
N71   *
N71  C  N38              IF        SIDP = 49
N94  C                             OR WFIDP = 49
N71   * MIDLETIDIG LAGRING AV VERDIER
N71  C                   ADD       X50           X_XWFTLG
N71  C                   ADD       X50           X_XWFSTB
N71  C                   EVAL      WFITRA = X_XWFTLG - X_XWFSTB                 WFIJUS
N71  C                   Z-ADD     X_XWFTLG      WFIBBL                         WFISTB
N71  C                   END
      * ADDERE JUSTERINGSBELØP
     C                   ADD       SJBELN        WFITLG
     C*
     C  N38WFITLG        IFGE      WFISTB
     C                   MOVE      *BLANKS       WFIFTG
     C     WFITLG        SUB       WFISTB        WFIJUS
     C                   ELSE
     C                   MOVE      '-'           WFIFTG
     C     WFISTB        SUB       WFITLG        WFIJUS
     C                   END
     C*
     C                   Z-ADD     WFITLG        WFISTB
     C                   ADD       WFITOL        WFIMVG
     C                   Z-ADD     WFIMVG        WFISUM
     C     SIBELR        IFEQ      0
     C                   ADD       WFITLG        WFIMVG
     C                   ELSE
     C                   ADD       WFIBBL        WFIMVG
     C                   END
     C                   SUB       XECEI         WFIMVG
     C   52              Z-ADD     WFIVKN        WFITLG
     C   53              Z-ADD     XNTM          WFITLG
     C                   Z-ADD     SIAVD         WFAVD
     C                   Z-ADD     SITDN         WFTDN
      *** HENTE MERKE & NR. FRA B/L DERSOM SJØ-OPPDRAG
     C   49
     CAN 28              EXSR      UTBL
     C                   SETOFF                                       49
      *
     C                   MOVE      XNR           WFIRNR
     C                   MOVE      XPVA1         WFPVA
      * Fyll ut default-verdier hvis blank.
     C                   MOVE      '0'           *IN34
S34  C*    BLAN17        LOOKUP    KN                                 34
N34  C     BLAN28        LOOKUP    KN                                 34
     C  N34              MOVEL     'ADR'         KN(1)
      *
     C     WFIVT         IFEQ      *BLANKS
     C                   MOVEL     'EX'          WFIVT
     C                   END
      *
     C* SUMMERE TOTAL KOLLI
     C                   ADD       WFIANT        XTOTKL
      *
     C                   MOVE      '0'           *IN34
S34  C*    BLAN15        LOOKUP    VB                                 34
N34  C     BLAN30        LOOKUP    VB                                 34
     C  N34WFIVNT        COMP      0                                      34
S34  C* N34TARIK         CHAIN     TARI                               34
S34  C* N34              MOVEL     TAALFA        VB(1)
N34  C                   IF        *IN34 = *OFF
S37  C*    WFIVNT        CHAIN     SOKTARI2                           34
S37  C*                  IF        *IN34
N34  C     TARIK         CHAIN     TARI                               34
N34  C  N34              EVAL      VB(1) = TAALFA
S37  C*                  ELSE
S37  C*                  EVAL      VB(1) = BESKR1
S37  C*                  END
N34  C                   END
     C     WFKEY         CHAIN     WFILEIMP                           34
      *
     C   34SIDP          IFEQ      64
N02  C     SIDP          OREQ      63
     C     SIDP          OREQ      65
     C     SIDP          OREQ      66
      * WFIJUS = FRAKT/FORSIKR + ANDREKOSTNAD (OPPRINGELIG VERDI)
      * WFIBBL = FRAKT/FORSIKR + BEARB.KOSTNAD
      * WFISTB = FRAKT/FORSIKR + ANDREKOSTNAD + BEARB.KOSTNAD
      * WFIJUS + WFIBBL - WFISTB = FRAKT/FORSIKR
     C                   ADD       WFIBBL        WFIJUS
     C                   SUB       WFISTB        WFIJUS
     C                   END
N74   *
N74   * BEREGN TOLL AV BEARBEIDINGSKOSTNAD
N74  C                   IF        (SIDP = 64 OR SIDP = 65 OR SIDP = 66)
N74  C                             AND WFIPRO = '%'
N74  C                   EVAL      WFISUM = WFISUM - WFITOL
N74  C                   EVAL      WFIMVG = WFIMVG - WFITOL
N74  C                   EVAL      WFITLG = WFIBBL
N74  C                   EVAL(H)   WFITOL = WFITLG * WFISAT / 100
N74  C                   EVAL      WFISUM = WFISUM + WFITOL
N74  C                   EVAL      WFIMVG = WFIMVG + WFITOL
N74  C                   END
      *
     C   34              WRITE     WFILEIR
N72  C   34
N72  CAN 39              IF        *IN37 = *OFF OR *IN26
N72  C*                  WRITE     SADVAVGR
N72  C                   END
N88  C                   IF        PRTTYP <> 'X'
N72  C   34              WRITE     SADVAVGR
N88  C                   END
N61  C                   ADD       WFIVKB        XTVKTBEMMA
     C*
     C                   Z-ADD     WFIMVG        XTOT10           13 2
     C     WFIMVG        ADD       WFITRA        XTOT20           13 2
     C     WFISKV        IFNE      *BLANKS
N72.1C     SIMVA         IFEQ      'N'
N72.1C     SIMVA         OREQ      ' '
     C                   MULT(H)   WFIMVS        XTOT10
     C                   MULT(H)   WFIMVS        XTOT20
     C                   DIV(H)    100           XTOT10
     C                   DIV(H)    100           XTOT20
     C                   ADD       XTOT10        XTOT1
     C                   ADD       XTOT20        XTOT2
N72.1C                   END
     C                   END
     C                   ADD       WFITRA        XTOT2
     C                   ADD       WFISUM        XTOT1
     C                   ADD       WFISUM        XTOT2
     C*
     C                   ENDSR
     C*
     C******************************************
     C     UTBL          BEGSR
     C******************************************
     C                   Z-ADD     1             XN2
     C     XN2           DOWLE     7                                            1<-B
     C     KN(XN2)       IFEQ      *BLANKS                                       2<-B
     C                   GOTO      STUBL1
     C                   ELSE                                                    2
     C                   ADD       1             XN2
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     STUBL1        TAG
     C                   Z-ADD     1             XN3
S34  C*    XN3           DOWLE     5                                            1<-B
N34  C     XN3           DOWLE     10                                           1<-B
     C     TO(XN3)       IFEQ      *BLANKS                                       2<-B
     C                   GOTO      STUBL2
     C                   ELSE                                                    2
     C                   ADD       1             XN3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     STUBL2        TAG
     C                   Z-ADD     1             UN2               2 0
     C*
     C     UN2           DOWLE     UNR                                          1<-B
     C     XN2           IFLE      7                                             2<-B
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     7                                              3<-B
     C     MN(UN2)       IFEQ      KN(XN4)                                         4<-B
     C                   GOTO      STUBL3
     C                   END                                                       4<-E
     C                   ADD       1             XN4
     C                   END                                                      3<-E
     C                   MOVEL     MN(UN2)       KN(XN2)
     C                   ADD       1             XN2
     C                   ELSE                                                    2
S34  C*    XN3           IFLE      5                                              3<-B
N34  C     XN3           IFLE      10                                             3<-B
     C                   MOVEL     MN(UN2)       TO(XN3)
     C                   ADD       1             UN2
     C     UN2           IFGT      UNR                                             4<-B
     C                   GOTO      SLUBL
     C                   END                                                       4<-E
     C                   MOVEL     MN(UN2)       TO(XN3)
     C                   ADD       1             XN3
     C                   ELSE                                                     3
     C                   GOTO      SLUBL
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     STUBL3        TAG
     C                   ADD       1             UN2
     C                   END                                                    1<-E
     C*
     C     SLUBL         ENDSR
     C*
     C***********************************************
     C     REGN2         BEGSR
     C***********************************************
     C*** BEREGNE TOTAL TOLL, MOMS OG AVGIFTER
     C*** ?2 INNEHOLDER DATA FOR HVER ENKEL VARELINJE.
     C*** T? INNEHOLDER TOTAL.
     C                   EXSR      FLYTT2
     C*
     C     XLN           IFEQ      1
     C                   ADD       WFISUM        SIBEL7
S47  C*                  ADD       WFITOL        T2(19)
N47  C                   ADD       WFITOL        T2(39)
     C*
     C     WFIMVA        IFNE      0
N72  C     SIMVA         ANDNE     'J'
N72  C     WFIMVA        ORNE      0
N72  C     SIMVA         ANDEQ     'J'                                          MVA-REGISTRERT
N72  C     XSNDEMMA      ANDEQ     'J'                                          SEND TIL EMMA
N72  C     X_SYMVSP      ANDEQ     'J'                                          MED MVA-SPEC
N72   * ENTEN IKKE MVA-REGISTRERT ELLER MVA-REGISTRERT, TIL EMMA OG MVA-SPESIFIKASJON
S47  C*                  ADD       WFIMVA        T2(20)
S47  C*                  MOVE      'MV'          T1(20)
N47  C                   ADD       WFIMVA        T2(40)
N47  C                   MOVE      'MV'          T1(40)
N72.2C                   ADD       WFIMVA        X_SIBEL6
     C                   END
     C                   END
     C*
     C                   Z-ADD     7             XN6
     C     WFITOL        IFNE      0
     C                   Z-ADD     WFITOL        B2(XN6)
     C                   MOVE      'TL'          Y2(XN6)
     C                   MOVE      '1  '         E2(XN6)
     C                   EXSR      TYPLIK
     C                   END
     C*
     C  N93SIAS          IFGT      0
     C                   MOVE      'TA'          Y2(XN6)
     C                   MOVE      '1  '         E2(XN6)
     C                   Z-ADD     WFITRA        B2(XN6)
     C                   EXSR      TYPLIK
     C                   END
     C*
     C                   Z-ADD     1             XN6
     C     XN6           DOWLE     6
     C     Y2(XN6)       IFNE      *BLANKS
     C                   EXSR      TYPLIK
     C                   ELSE
     C                   ADD       1             XN6
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TYPLIK        BEGSR
     C***********************************************
     C     XLN           IFEQ      1
     C*** SUMMER BELØP PÅ SAMME TYPE AVGIFTER
     C                   Z-ADD     1             XN4
S47  C*    XN4           DOWLE     16
N47  C     XN4           DOWLE     38
     C     T1(XN4)       IFEQ      *BLANKS
     C     T1(XN4)       OREQ      Y2(XN6)
     C                   GOTO      SLTYPL
     C                   END
     C                   ADD       1             XN4
     C                   END
     C*
     C     SLTYPL        TAG
S47  C*    XN4           IFLE      15
N47  C     XN4           IFLE      37
     C                   MOVE      Y2(XN6)       T1(XN4)
     C                   ADD       B2(XN6)       T2(XN4)
     C                   END
     C                   END
     C                   ADD       1             XN6
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SJVBES        BEGSR
     C***********************************************
     C                   SETOFF                                       33
     C     WFIANT        IFEQ      0
     C                   Z-ADD     XRESKL        WFIANT
     C                   END
     C     HENTF         IFEQ      1
     C     WFIVT         ANDEQ     'EX  '
     C     XN2           IFEQ      0
     C                   MOVE      'KLL.'        WFIVT
     C                   END
     C                   END
     C     WFIVT         IFEQ      'U.NR'
     C     WFIVT         OREQ      'U-NR'
N102 C     WFIVT         OREQ      'U.'                                         WEB-KODE
N102 C     WFIVT         OREQ      'U-'                                         WEB-KODE
S106 C*    WFIVT         OREQ      'CONT'
S106 C*    PTFDT         ANDLE     WDT80
S106 C*    WFIVT         OREQ      'C.'                                         WEB-KODE
S106 C*    PTFDT         ANDLE     WDT80
N106 C     SIKDC         OREQ      '1'
     C                   MOVE      'KLL.'        WFIVT
     C                   END
     C     WFIVT         COMP      'EX  '                                 48
      *
     C                   SETOFF                                       33
S34  C*    BLAN15        LOOKUP    VB                                 33
S34  C* N33TARIK         CHAIN     TARI                               90
S34  C* N33
S34  C*NN90              MOVE      TAALFA        VB(1)
N34  C     BLAN30        LOOKUP    VB                                 33
N34  C                   IF        *IN33 = *OFF
S37  C*    WFIVNT        CHAIN     SOKTARI2                           33
S37  C*                  IF        *IN33
N34  C     TARIK         CHAIN     TARI                               33
N34  C  N33              EVAL      VB(1) = TAALFA
S37  C*                  ELSE
S37  C*                  EVAL      VB(1) = BESKR1
S37  C*                  END
N34  C                   END
     C     WFIVF         IFLE      '0'
     C     SIDFVF        IFEQ      0
     C                   MOVE      '1'           WFIVF
     C                   ELSE
     C                   MOVE      SIDFVF        WFIVF
     C                   END
     C                   END
     C                   SETOFF                                       33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DEL2SL        BEGSR
     C***********************************************
     C                   Z-ADD     1             XN4
S47  C*    XN4           DOWLE     15
N47  C     XN4           DOWLE     37
     C     T1(XN4)       IFEQ      *BLANKS
     C                   GOTO      STD2SL
     C                   END
     C                   ADD       1             XN4
     C                   END
     C*
     C     STD2SL        TAG
S47  C*    T2(20)        IFNE      0
N47  C     T2(40)        IFNE      0
     C     XLN           ANDEQ     1
N72  C     SIMVA         ANDNE     'J'
N72  C     T2(40)        ORNE      0
N72  C     XLN           ANDEQ     1
N72  C     SIMVA         ANDEQ     'J'                                          MVA-REGISTRERT
N72  C     XSNDEMMA      ANDEQ     'J'                                          SEND TIL EMMA
N72  C     X_SYMVSP      ANDEQ     'J'                                          MED MVA-SPEC
N72   * ENTEN IKKE MVA-REGISTRERT ELLER MVA-REGISTRERT, TIL EMMA OG MVA-SPESIFIKASJON
     C                   MOVE      'MV'          T1(XN4)
S47  C*                  MOVE      T2(20)        T2(XN4)
N47  C                   MOVE      T2(40)        T2(XN4)
     C                   ADD       1             XN4
     C                   END
     C*
     C   32
     CANN941             DO        24            YN
     C                   MOVE      G1(YN)        XDESIM            2 0
     C     YN            ADD       60            ZN                3 0
     C     XDESIM        IFEQ      0
     C                   MOVE      '0'           *IN(ZN)
     C                   MOVEL     G1(YN)        G11(YN)
     C                   ELSE
     C                   MOVE      '1'           *IN(ZN)
     C                   END
     C                   END
     C   32
     CAN 94              MOVE      G1(1)         XDESIM            2 0
     C   32
     CAN 94XDESIM        IFEQ      0
     C                   MOVE      '0'           *IN61
     C                   MOVEL     G1(1)         G11(YN)
     C                   ELSE
     C                   MOVE      '1'           *IN61
     C                   END
     C   32XN4           IFLE      9
     C  N94              EXCEPT    DEL2S
     C   94              EXCEPT    DEL2SX
     C                   ELSE
     C  N94              EXCEPT    DEL2S
     C  N94              EXCEPT    DEL2S1
     C   94              EXCEPT    DEL2SX
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBWF        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       VB
     C                   MOVE      *BLANKS       TO
     C                   MOVE      *BLANKS       TC
     C                   MOVE      *ZEROS        WFIVNT
     C                   MOVE      *ZEROS        XNTM
     C                   MOVE      *BLANKS       WFITN
     C                   MOVE      *BLANKS       WFILK
S34  C*                  MOVE      *ZEROS        WFIVKB
S34  C*                  MOVE      *ZEROS        WFIVKN
N34  C                   MOVE      *ZEROS        WFIVKB123
N34  C                   MOVE      *ZEROS        WFIVKN123
     C                   MOVE      *BLANKS       WFIPRE
     C                   MOVE      *ZEROS        WFIANT
     C                   MOVE      *BLANKS       WFIVF
     C                   MOVE      *ZEROS        WFIJUS
     C                   MOVE      *ZEROS        XWFSTB
N71  C                   MOVE      *ZEROS        X_XWFSTB         15 2
     C                   MOVE      *ZEROS        XBELR2
     C                   MOVE      *ZEROS        WFIBBL
     C                   MOVE      *BLANKS       WFIFTG
     C                   MOVE      *ZEROS        WFIMVG
     C                   MOVE      *ZEROS        XWFTLG
N71  C                   MOVE      *ZEROS        X_XWFTLG
     C                   MOVE      *ZEROS        XWFTOL
     C                   MOVE      *ZEROS        WFITRA
     C                   MOVE      *ZEROS        WFISUM
     C                   MOVE      *ZEROS        WFISAT
     C                   MOVE      *BLANKS       Y2
     C                   MOVE      *BLANKS       E2
     C                   MOVE      *ZEROS        B2
     C                   MOVE      *ZEROS        G2
     C                   MOVE      *ZEROS        S2
     C                   MOVE      *BLANKS       P2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    PRTTYP            1
     C                   PARM                    PRTAVD            4
     C                   PARM                    PRTTDN            7
     C                   PARM                    PRTPT1           10
     C                   PARM                    PRTPT2           10
     C                   PARM                    PRTPT3           10
     C     FAXTD         KLIST
     C                   KFLD                    PRTAVX            4 0
     C                   KFLD                    PRTTDX            7 0
     C     FRIKEY        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    WSKODE
     C                   MOVE      '*CR'         WSKODE            3
N13  C     FRIKEYTLI     KLIST
N13  C                   KFLD                    SIAVD
N13  C                   KFLD                    SITDN
N13  C                   KFLD                    WSKODETLI
N13  C                   MOVE      'TLI'         WSKODETLI         3
N13  C     FRIKEYTLP     KLIST
N13  C                   KFLD                    SIAVD
N13  C                   KFLD                    SITDN
N13  C                   KFLD                    WSKODETLP
N13  C                   MOVE      'TLP'         WSKODETLP         3
      *
     C     WFKEY         KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    XNR
     C     SADHK         KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C     SADH8K        KLIST
     C                   KFLD                    UWS
     C                   KFLD                    YST
     C                   MOVE      'K'           YST               1
     C     SADVJK        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    SVLI
     C     SADFK         KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C     STANIK        KLIST
     C                   KFLD                    UAVD
N87  C     SADSDKBV      KLIST
N87  C                   KFLD                    WFIVNT
N87  C                   KFLD                    BV_SDKDAÆ         2
N87  C                   MOVE      'BV'          BV_SDKDAÆ
N87  C     SADSDKGB      KLIST
N87  C                   KFLD                    WFIVNT
N87  C                   KFLD                    GB_SDKDAÆ
N87  C                   MOVE      'GB'          GB_SDKDAÆ         2
N87  C     SADSDKMB      KLIST
N87  C                   KFLD                    WFIVNT
N87  C                   KFLD                    MB_SDKDAÆ
N87  C                   MOVE      'MB'          MB_SDKDAÆ         2
N87  C     SADSDKTO      KLIST
N87  C                   KFLD                    WFIVNT
N87  C                   KFLD                    TO_SDKDAÆ
N87  C                   MOVE      'TO'          TO_SDKDAÆ         2
     C     SADSDK        KLIST
     C                   KFLD                    WFIVNT
     C                   KFLD                    XDKDAÆ            2
     C                   KFLD                    WFISKV
     C                   MOVE      'MV'          XDKDAÆ
     C     HEADFK        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
N72  C     CUNDL01K      KLIST
N72  C                   KFLD                    FIFIRM
N72  C                   KFLD                    SIKNK
     C     KODVAK        KLIST
     C                   KFLD                    SIVAL3
S56  C*                  KFLD                    XIDT
N56  C                   KFLD                    X_M0068A
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    SILKA
     C     KODS8K        KLIST
     C                   KFLD                    KS8AVG
     C                   KFLD                    KS8SKV
     C     TARIK         KLIST
     C                   KFLD                    WFIVNT
     C                   KFLD                    XTAR
     C     WFILIK        KLIST
     C                   KFLD                    WFIRNR
     C     KODKEY        KLIST
     C                   KFLD                    WOPUNI
     C                   KFLD                    WOPAVD
     C                   KFLD                    WOPLNR
N19  C     KODKEYU1      KLIST
s59  C*                  KFLD                    SISG
n59  C                   KFLD                    SISGDE
N19  C                   KFLD                    WOPLNR
N62  C     KEYSIGN       KLIST
N62  C                   KFLD                    KSIUNI
N62  C                   KFLD                    SISG
N62  C                   MOVE      'SI'          KSIUNI
N43  C     CUNDC01K      KLIST
N43  C                   KFLD                    FIFIRM
N43  C                   KFLD                    SIKNK
N43  C                   KFLD                    CCONTA
N43  C                   EVAL      CCONTA = 'EMMA-XML'
N104 C     CUNDC01KPRO   KLIST
N104 C                   KFLD                    FIFIRM
N104 C                   KFLD                    SIKNK
N104 C                   KFLD                    PRO_CCONTA
N104 C     *LIKE         DEFINE    CCONTA        PRO_CCONTA
N104 C                   EVAL      PRO_CCONTA = 'PROTERIA-XML'
N43  C     ARKEXTK       KLIST
N43  C                   KFLD                    FIFIRM
N43  C                   KFLD                    ARKLAG
N43  C     ARKIVL02K     KLIST
N43  C                   KFLD                    ARSTAT
N43  C                   KFLD                    SIAVD
N43  C                   KFLD                    SITDN
N43  C                   KFLD                    ARTYPE
N43  C                   EVAL      ARSTAT = 'A'
N43  C     ARKVEDKK      KLIST
N43  C                   KFLD                    FIFIRM
N43  C                   KFLD                    SIKNK
N43  C                   KFLD                    AVTYPE
N43  C                   EVAL      AVTYPE = 'si'
N43  C     EDIM4KS       KLIST
N43  C                   KFLD                    X4SR_S
N43  C                   KFLD                    SIAVD
N43  C                   KFLD                    SITDN
N43  C                   MOVE      'S'           X4SR_S            1
     C     TVIM4K        KLIST
     C                   KFLD                    X4SR
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    MAX0B
     C     TVI41K        KLIST
     C                   KFLD                    X4SR
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   MOVE      'R'           X4SR              1
     C                   MOVE      '99999999'    MAX0B             8 0
      *
     C                   GOTO      STINI2
     C     STINIT        TAG
     C                   CALL      'QRCVDTAQ'
     C                   PARM                    UDTAQ
     C                   PARM                    ULIBL
     C                   PARM                    ULENGT
     C                   PARM                    UDTA
     C                   PARM                    UWAIT
      *
     C                   MOVE      UDTA          DTDTA
     C                   MOVE      DTWS          UWS              10
     C*** UIN39=0 -> KOMMER FRA TOLLDE.REGISTRERING    (U4 I S/36)
     C*** UIN39=1 -> KOMMER FRA KOMMUNIKASJON
     C                   MOVE      DTIN39        *IN39
N67  C                   move      *blanks       DTEPOST
N67  C     *in39         ifeq      '0'
N67  C     dtuser        andne     *blanks
N67  C     dtprt1        andeq     'EPOSTSND'
N67  C                   CALL      'SYGE108CU'
N67  C                   PARM                    DTUSER
N67  C                   PARM                    DTEPOST          70
N67  C     DTEPOST       IFNE      *BLANKS
N67  C                   MOVE      *blanks       usrepo          120
N67  C                   EVAL      usrepo='USRDFNDTA('
N67  C                             + X'7D'
N67  C                             + 'MAILTAG('
N67  C                             + %trim(DTEPOST)
N67  C                             + ')'
N67  C                             + X'7D'
N67  C                             + ')'
N67  C                   end
N67  C                   END
      *
     C     STINI2        TAG
N43  C                   MOVE      *BLANKS       XDATA           500
N43  C                   MOVE      *BLANKS       XSUMAVG          13 2
N43  C                   BITON     '123457'      XAPS              1
N43  C                   BITOFF    '06'          XAPS
N43  C     *DTAARA       DEFINE                  EDIDTA
N43  C                   IN        EDIDTA
N43   *
     c  N39PRTTYP        COMP      'A'                                    39
N43  c  N39PRTTYP        COMP      'X'                                    39
     C     PRTTYP        IFEQ      'H'
     C                   SETON                                        32
     C                   MOVEL     'HIST'        UWS
     C                   MOVEL     PRTPT1        DTPRT1
     C                   MOVEL     PRTPT2        DTPRT2
     C                   MOVEL     PRTPT3        DTPRT3
     C                   ELSE
     C     PRTAVD        IFGE      '0000'
     C     PRTAVD        ANDLE     '9999'
     C                   MOVE      PRTAVD        PRTAVX
     C                   MOVE      PRTTDN        PRTTDX
N31  C     PRTAVX        CHAIN     STANDI                             33
S59  C*                  MOVE      SISGDE        SISG
N31  C                   MOVEL     SILV2         XUATK
N31  C                   MOVE      SIDL          UDL
N31  C                   MOVE      SITOLK        UTOLK
N31  C                   MOVE      'P'           WOPUNI
     C                   END
      *
     C     PRTTYP        IFEQ      'F'
     C     PRTTYP        OREQ      'A'
N43  C     PRTTYP        OREQ      'X'
     C                   MOVE      '1'           UDL
     C                   GOTO      FAXTAG
     C                   END
     C                   END
      *
     C     PRTTYP        IFEQ      'U'
     C                   MOVE      '1'           UDL
     C                   MOVE      PRTAVD        PRTAVX
     C                   MOVE      PRTTDN        PRTTDX
     C                   GOTO      FAXTAG
     C                   END
     C     SADH8K        SETLL     SADH8                              33
     C     SADH8K        READE     SADH8                                  33
N59  C  N33              MOVE      SISG          SISGDE            3
     C   33              GOTO      STINIT
     C                   MOVE      SIAVD         UAVD              4 0
     C     STANIK        CHAIN     STANDI                             33
     C                   MOVEL     SILV2         XUATK             1
     C                   MOVE      SIDL          UDL               1
     C                   MOVE      SITOLK        UTOLK             1
     C                   MOVE      'P'           WOPUNI
     C                   EXSR      OVRF
     C     SIST          IFNE      'J'
     C     XXPFM         ANDNE     *BLANKS
     C                   MOVE      'J'           XÅPN              1
     C                   ELSE
     C                   MOVE      'N'           XÅPN
     C                   END
      *
     C     FAXTAG        TAG
     C                   OPEN      WFILEIMP
N25  C                   OPEN      SAD61PF
     C                   OPEN      TOLLDEK2
N30  C                   OPEN      SAD61PFT
N65  C                   OPEN      SAD61PFR
     C*
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      *BLANKS       XTAR              3
     C                   MOVE      050           X50               3 2
S34  C*                  MOVE      *BLANKS       BLAN15           15
S34  C*                  MOVE      *BLANKS       BLAN17           17
N34  C                   MOVE      *BLANKS       BLAN30           30
N34  C                   MOVE      *BLANKS       BLAN28           28
     C     *LIKE         DEFINE    KOPAVD        WOPAVD
     C     *LIKE         DEFINE    KOPUNI        WOPUNI
     C     *LIKE         DEFINE    KOPLNR        WOPLNR
N72.2C     *LIKE         DEFINE    SIBEL6        X_SIBEL6
     C                   Z-ADD     0             WOPAVD
     C                   Z-ADD     0             WOPLNR
     C*
     C     FIKDT         IFEQ      0
     C                   Z-ADD     1             XLANT             2 0
     C                   ELSE
     C     UDL           IFEQ      '1'
     C                   Z-ADD     1             XLANT
     C                   ELSE
     C                   Z-ADD     10            XLANT
     C                   END
     C                   END
     C*
     C     SIA4          IFEQ      'J'
S44  C*                  Z-ADD     61            XA4               2 0
S76  C*                  Z-ADD     59            XA4               2 0
N76  C                   Z-ADD     57            XA4               2 0
     C                   ELSE
S41  C*                  Z-ADD     44            XA4
S76  C*                  Z-ADD     39            XA4
N76  C                   Z-ADD     37            XA4
     C                   END
     C     UYEAR         IFGT      85
     C                   MOVEL     '19'          UCENT             2 0
     C                   ELSE
     C                   MOVEL     '20'          UCENT
     C                   END
      * Initiering av konstanter for MO - datastrukturer
     C                   MOVE      'Merke'       DSM
     C                   MOVE      'Vekt:'       DSV
     C                   MOVE      'Eff.:'       DSE
     C                   MOVE      'Kub.:'       DSK
     C                   MOVE      'CIFv:'       DSC
     C                   MOVE      'F.Avg:'      DSC2
     C                   MOVE      '->'          DSVSTR
     C                   MOVE      '->'          DSESTR
     C                   MOVE      '->'          DSKSTR
     C                   MOVE      '->'          DSCSTR
     C                   MOVE      'Gr:'         DSC22
     C                   MOVE      '='           DSC23
     C                   MOVEL     '(Forv.Av'    DSC24
     C                   MOVE      'g)'          DSC24
     C                   MOVE      '%'           DSPROT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OVRF          BEGSR
     C***********************************************
      *
      * Printerstyring for hovedark
      *
     C                   Z-ADD     SIAVD         WOPAVD
     C                   Z-ADD     81            WOPLNR
N19  C     KODKEYU1      CHAIN     KODTPUSR                           33
N70  C  N33KOPNVN        COMP      '*STD'                                 33
N19  C*    KODKEY        CHAIN     KODTP                              33
N19  C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       F1
     C                   MOVE      *BLANKS       F2
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     *LIKE         DEFINE    KOPFM         XXPFM
     C                   MOVE      KOPFM         XXPFM
     C     KOPFM         SETLL     KODTFM                             33
     C                   MOVE      *ZEROS        YN
     C     STFM1         TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   ADD       1             YN
     C                   MOVE      KFMT1         F1(YN)
     C                   MOVE      KFMT2         F2(YN)
     C                   END
     C  N33              GOTO      STFM1
     C                   ENDIF
     C     DTPRT1        IFNE      *BLANKS
     C                   MOVE      DTPRT1        KOPNVN
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPLAS        IFEQ      'P'
N04  C     KOPLAS        OREQ      'F'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     C                   CAT       XCMDPDF2:1    UCMD
     c                   move      *blanks       FMOVL            20
     c***                eval      FMOVL='FRONTMGN(0.14 0.16)'                  PDF
N04  C     KOPLAS        IFEQ      'F'
S40  c*                  eval      FMOVL='FRONTMGN(0.23 0)'                        AFP
s42  c*                  eval      FMOVL='FRONTMGN(0.24 0.30)'                     AFP
n40  c                   eval      FMOVL='FRONTMGN(0.23 0)'                        AFP
     C                   CAT       FMOVL:1       UCMD
N04  C                   end
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   END
S25  C*                  CAT       XCMD21:1      UCMD
N25  C                   CAT       XCMD21A:1     UCMD
     C                   CAT       DTUSER:0      UCMD
     C                   CAT       ')':0         UCMD
N05  C     KOPDRAW       ifne      *blanks
N05  c                   move      *blanks       FDRAW            20
N05  c                   eval      FDRAW='DRAWER('                              PDF
N05  C                   CAT       KOPDRAW:0     FDRAW
N05  C                   CAT       ')':0         FDRAW
N05  C                   CAT       FDRAW:1       UCMD
N05  C                   END
N05  C     KOPCOPI       ifne      *blanks
N05  c                   move      *blanks       FDCOP            20
N05  c                   eval      FDCOP='COPIES('                              PDF
N05  C                   CAT       KOPCOPI:0     FDCOP
N05  C                   CAT       ')':0         FDCOP
N05  C                   CAT       FDCOP:1       UCMD
N05  C                   END
      *OUTBIN(&DRAWUT) utskuff
N17  C     KOPOUTB       ifne      *blanks
N17  c                   move      *blanks       FDOUT            20
N17  c                   eval      FDOUT='OUTBIN('                              PDF
s48  C*                  CAT       KOPOUTB:0     FDCOP
s48  C*                  CAT       ')':0         FDCOP
n48  C                   CAT       KOPOUTB:0     FDOUT
n48  C                   CAT       ')':0         FDOUT
N17  C                   CAT       FDOUT:1       UCMD
N17  C                   END
N67  C     DTEPOST       ifne      *blanks
N67  C                   CAT       usrepo:1      UCMD
N67  C                   end
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      * Printerstyring for tilleggsark
     C                   Z-ADD     SIAVD         WOPAVD
     C                   Z-ADD     82            WOPLNR
N19  C     KODKEYU1      CHAIN     KODTPUSR                           33
N70  C  N33KOPNVN        COMP      '*STD'                                 33
N19  C*    KODKEY        CHAIN     KODTP                              33
N19  C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       F3
     C                   MOVE      *BLANKS       F4
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C                   MOVE      *ZEROS        YN
     C     STFM2         TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   ADD       1             YN
     C                   MOVE      KFMT1         F3(YN)
     C                   MOVE      KFMT2         F4(YN)
     C                   END
     C  N33              GOTO      STFM2
     C     YN            IFGT      1
     C                   MOVE      'J'           XLASER            1
     C                   ELSE
     C                   MOVE      'N'           XLASER
     C                   END
     C                   ENDIF
     C     DTPRT2        IFNE      *BLANKS
     C                   MOVE      DTPRT2        KOPNVN
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD12        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPLAS        IFEQ      'P'
N04  C     KOPLAS        OREQ      'F'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     C                   CAT       XCMDPDF3:1    UCMD
N04  C     KOPLAS        IFEQ      'F'
S40  c*                  eval      FMOVL='FRONTMGN(0.34 0.00)'                  AFP
s42  c*                  eval      FMOVL='FRONTMGN(0.24 0.30)'                  AFP
n42  c                   eval      FMOVL='FRONTMGN(0.34 0.00)'                  AFP
N04  C                   CAT       FMOVL:1       UCMD
N04  C                   END
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   END
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C                   CAT       ')':0         UCMD
N05  C     KOPDRAW       ifne      *blanks
N05  c                   move      *blanks       FDRAW            20
N05  c                   eval      FDRAW='DRAWER('                              PDF
N05  C                   CAT       KOPDRAW:0     FDRAW
N05  C                   CAT       ')':0         FDRAW
N05  C                   CAT       FDRAW:1       UCMD
N05  C                   END
N05  C     KOPCOPI       ifne      *blanks
N05  c                   move      *blanks       FDCOP            20
N05  c                   eval      FDCOP='COPIES('                              PDF
N05  C                   CAT       KOPCOPI:0     FDCOP
N05  C                   CAT       ')':0         FDCOP
N05  C                   CAT       FDCOP:1       UCMD
N05  C                   END
      *OUTBIN(&DRAWUT) utskuff
N17  C     KOPOUTB       ifne      *blanks
N17  c                   move      *blanks       FDOUT            20
N17  c                   eval      FDOUT='OUTBIN('                              PDF
s48  C*                  CAT       KOPOUTB:0     FDCOP
s48  C*                  CAT       ')':0         FDCOP
n48  C                   CAT       KOPOUTB:0     FDOUT
n48  C                   CAT       ')':0         FDOUT
N17  C                   CAT       FDOUT:1       UCMD
N17  C                   END
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      * Printerstyring for dataliste
     C                   Z-ADD     SIAVD         WOPAVD
     C                   Z-ADD     83            WOPLNR
     C                   MOVE      *ZEROS        XANTDL
N19  C     KODKEYU1      CHAIN     KODTPUSR                           33
N70  C  N33KOPNVN        COMP      '*STD'                                 33
N19  C*    KODKEY        CHAIN     KODTP                              33
N19  C   33KODKEY        CHAIN     KODTP                              33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C     STOVF1        TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   MOVEL     KFMT1         DLFMT1           75
     C                   ADD       1             XANTDL
     C                   GOTO      STOVF1
     C                   END
     C                   ENDIF
     C     DTPRT3        IFNE      *BLANKS
     C                   MOVE      DTPRT3        KOPNVN
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     SIA4          IFEQ      'J'
     C     XCMD13        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD23:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C     XANTDL        IFNE      0
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XANTD2:0      UCMD
     C                   END
     C                   CAT       ')':0         UCMD
     C                   ELSE
     C     XCMD13        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD22:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C     XANTDL        IFNE      0
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XANTD2:0      UCMD
     C                   END
     C                   CAT       ')':0         UCMD
     C                   END
N05  C     KOPDRAW       ifne      *blanks
N05  c                   move      *blanks       FDRAW            20
N05  c                   eval      FDRAW='DRAWER('                              PDF
N05  C                   CAT       KOPDRAW:0     FDRAW
N05  C                   CAT       ')':0         FDRAW
N05  C                   CAT       FDRAW:1       UCMD
N05  C                   END
N05  C     KOPCOPI       ifne      *blanks
N05  c                   move      *blanks       FDCOP            20
N05  c                   eval      FDCOP='COPIES('                              PDF
N05  C                   CAT       KOPCOPI:0     FDCOP
N05  C                   CAT       ')':0         FDCOP
N05  C                   CAT       FDCOP:1       UCMD
N05  C                   END
      *OUTBIN(&DRAWUT) utskuff
N17  C     KOPOUTB       ifne      *blanks
N17  c                   move      *blanks       FDOUT            20
N17  c                   eval      FDOUT='OUTBIN('                              PDF
s48  C*                  CAT       KOPOUTB:0     FDCOP
s48  C*                  CAT       ')':0         FDCOP
n48  C                   CAT       KOPOUTB:0     FDOUT
n48  C                   CAT       ')':0         FDOUT
N17  C                   CAT       FDOUT:1       UCMD
N17  C                   END
N67  C     DTEPOST       ifne      *blanks
N67  C                   CAT       usrepo:1      UCMD
N67  C                   end
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD01        UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD02        UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C***        MVOGN     IFEQ 'J'
      * Printerstyring for REG-KORT MOTORVOGN
     C                   Z-ADD     SIAVD         WOPAVD
     C                   Z-ADD     88            WOPLNR
N19  C     KODKEYU1      CHAIN     KODTPUSR                           33
N70  C  N33KOPNVN        COMP      '*STD'                                 33
N19  C*    KODKEY        CHAIN     KODTP                              33
N19  C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       F5
     C                   MOVE      *BLANKS       F6
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C                   MOVE      *ZEROS        YN
     C     STFM3         TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   ADD       1             YN
     C                   MOVE      KFMT1         F5(YN)
     C                   MOVE      KFMT2         F6(YN)
     C                   END
     C  N33              GOTO      STFM3
     C                   ENDIF
     C                   MOVE      *BLANKS       UCMD
     C     XCMD14        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C                   CAT       ')':0         UCMD
N67  C     DTEPOST       ifne      *blanks
N67  C                   CAT       usrepo:1      UCMD
N67  C                   end
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   ENDSR
     C*
N62  C***********************************************
N62  C     EPOSTSR       BEGSR
N62  C***********************************************
N62  C                   MOVE      *BLANKS       EPOSTT
N62  C     KEYSIGN       CHAIN     KODTSI                             33
N62  C     *IN33         IFEQ      '0'
N62  C     KSUSER        ANDNE     *BLANKS
N62  C                   CALL      'EPOS04E'
N62  C                   PARM                    KSUSER
N62  C                   PARM                    DIRENA            8
N62  C                   PARM                    DIREAD            8
N62  C                   PARM                    EPOSTT
N62  C                   END
N62  C                   SETOFF                                       33
N62  C                   ENDSR
     C***********************************************
     C     TRIMGN        BEGSR
     C***********************************************
      * Trimmer utskrift av godsnummer/posisjon
N27  C                   EVAL      UTGNP = %TRIM(SIGN) + '-' + %TRIM(SIPOS)
S27  C*                  MOVEL     SIGN          UTGN
S27  C*                  MOVE      '-'           UTGN
S27  C*                  MOVEL     SIPO06        UTPO06
S27  C*
S27  C*    SIPO06        IFEQ      *BLANKS
S27  C*    ' '           CAT       UTGNPO:6      UTGNP            22
S27  C*                  ELSE
S27  C*    SIPO26        IFEQ      *BLANKS
S27  C*    ' '           CAT       UTGNPO:5      UTGNP            22
S27  C*                  ELSE
S27  C*    SIPO36        IFEQ      *BLANKS
S27  C*    ' '           CAT       UTGNPO:4      UTGNP            22
S27  C*                  ELSE
S27  C*    SIPO46        IFEQ      *BLANKS
S27  C*    ' '           CAT       UTGNPO:3      UTGNP            22
S27  C*                  ELSE
S27  C*    SIPO56        IFEQ      *BLANKS
S27  C*    ' '           CAT       UTGNPO:2      UTGNP            22
S27  C*                  ELSE
S27  C*    SIPO66        IFEQ      *BLANKS
S27  C*    ' '           CAT       UTGNPO:1      UTGNP            22
S27  C*                  ELSE
S27  C*                  MOVEL     UTGNPO        UTGNP            22
S27  C*                  ENDIF                                                  <SIPO66
S27  C*                  ENDIF                                                  <SIPO56
S27  C*                  ENDIF                                                  <SIPO46
S27  C*                  ENDIF                                                  <SIPO36
S27  C*                  ENDIF                                                  <SIPO26
S27  C*                  ENDIF                                                  <SIPO06
      *
     C                   ENDSR
N16   ***************************************************************
N16  C     frisr         begsr
N16   ***************************************************************
N16  c                   z-add     1             nr                2 0
N16  C                   clear                   DFRT
N16   *
N16   * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE T=Tolldek
N16   *
N16  C     SADHK         SETLL     FRISOK
N16  C     SADHK         READE     FRISOK                                 33
N16  C     *IN33         DOWEQ     '0'
N16  C                   SORTA     DFS
N16  C     DFS(10)       IFNE      ' '
N16  C     'T'           LOOKUP    DFS                                    33
N16  C     *IN33         IFEQ      '1'
N16  C     FSKODE        CHAIN     KODFRI                             33
N16  C     *IN33         IFEQ      '0'
N16  C                   MOVEL     KFSOTX        DFRT(NR)
N16  c     DFRT(NR)      cat       ':':0         DFRT(NR)
N16  c     DFRT(NR)      cat       FSSOK:0       DFRT(NR)
N16  C                   ADD       1             NR
N16  C                   END
N16  C                   END
N16  C                   END
N16  C*
N16  C     SADHK         READE     FRISOK                                 33
N16  C  N33NR            COMP      3                                  33
N16  C                   END
N16  C     DFRT(1)       IFNE      *blanks
N16  C                   MOVEL     DFRT(1)       TO(5)
N16  C                   END
N16  C     DFRT(2)       IFNE      *blanks
N16  C                   MOVEL     DFRT(2)       TO(4)
N16  C                   END
N16  C     DFRT(3)       IFNE      *blanks
N16  C                   MOVEL     DFRT(3)       TO(3)
N16  C                   END
N16  C                   ENDSR
N43   *
N43   ***************************************************************
N43  C     SREMMA1       BEGSR
N43   ***************************************************************
N43  C     1             CHAIN     EDIC                               36
N43  C                   ADD       1             CSN
N43  C                   ADD       1             CMN
N43  C                   UPDATE    EDICR
N43  C                   EVAL      WMBRA = 'S'
N43  C                   EVAL      WMBRB = CSN
N43   * Lag fil og set codepage (pc)
N43  C                   MOVE      *BLANKS       WFilNam         256
N43  C                   EVAL      WFilNam= '/' + %TRIM(UELIBF) + 'X'
N43  C                             + '/EMMA/EDISE/' + %TRIM(SITLE)
N43  C                             + %TRIM(SITLL) + '_DEKLKODE.xml'
N43  C                   MOVE      *BLANKS       WFilNam2        256
N43  C                   EVAL      WFilNam2 = '/' + %TRIM(UELIBF) + 'X'
N43  C                             + '/EMMA/EDISE1K/BACKUP/' + %TRIM(SITLE)
N43  C                             + %TRIM(SITLL) + '_' + %TRIM(CPHONE) + '.xml'
N43  C                   EVAL      FILE_o = open( %TrimR( WFilNam2 )
N43  C                             : 'w, codepage=819' )
N43  C                   EVAL      rc = close( FILE_o )
N43  C                   EVAL      FILE_o = open( %TrimR( WFilNam2 )
N43  C                             : 'w' )
N43   *
N43  C                   EVAL      XDATA = '<?xml version="1.0" '
N43  C                             + 'encoding="ISO-8859-1" '
N43  C                             + 'standalone="yes"?>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<EmmaSystemsFortolling>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Fortolling>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Tollnummer>'
N43  C                             + %TRIM(SITLE) + %TRIM(SITLL)
N43  C                             + '</Tollnummer>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Unhsekvens>'
N43  C                             + %TRIM(%EDITC(M0068B:'Z')) + '</Unhsekvens>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Unhversjon>'
N43  C                             + %TRIM(%EDITC(M0068C:'Z')) + '</Unhversjon>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Deklarasjon1A>'
N43  C                             + %TRIM(SIDTY) + '</Deklarasjon1A>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   MOVEL     SIDP          XAN01             1
N43  C                   EVAL      XDATA = '<Deklarasjon1B>'
N43  C                             + %TRIM(XAN01) + '</Deklarasjon1B>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   * Avsender
N43  C                   EVAL      XDATA = '<Avsender>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SINAS
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Navn>'
N43  C                             + %TRIM(XTXT802) + '</Navn>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIADS1
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Gateadresse>'
N43  C                             + %TRIM(XTXT802) + '</Gateadresse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIADS2
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Postadresse>'
N43  C                             + %TRIM(XTXT802) + '</Postadresse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C     ' '           SCAN      SIADS3        XPOS              3 0    36
N43  C   36              IF        XPOS < 10
N43  C                   EVAL      XTXT801 = %SUBST(SIADS3:1:XPOS-1)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Postnr>'
N43  C                             + %TRIM(XTXT802) + '</Postnr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XPOS = XPOS + 1
N43  C                   ELSE
N43  C                   EVAL      XPOS = 1
N43  C                   END
N43  C  N36              EVAL      XPOS = 1
N43  C                   EVAL      XTXT801 = %SUBST(SIADS3:XPOS:31-XPOS)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Poststed>'
N43  C                             + %TRIM(XTXT802) + '</Poststed>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C     KODS2K        CHAIN     KODTS2                             42
N43  C                   EVAL      XTXT801 = KS2FTX
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Land>'
N43  C                             + %TRIM(XTXT802) + '</Land>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Landkode>'
N43  C                             + %TRIM(SILKA) + '</Landkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   IF        SIKNS <> 0
N43  C                   EVAL      XDATA = '<Nr>'
N43  C                             + %TRIM(%EDITC(SIKNS:'Z')) + '</Nr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   EVAL      XDATA = '</Avsender>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C                   EVAL      XDATA = '<Vareposter>'
N43  C                             + %TRIM(%EDITC(XNR:'Z')) + '</Vareposter>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Antallkolli>'
N43  C                             + %TRIM(%EDITC(SINTK:'Z')) + '</Antallkolli>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<TotBruttoVekt>'
S61  C*                            + %TRIM(%EDITC(SIVKB:'Z'))
N61  C                             + %TRIM(%EDITC(XTVKTBEMMA:'Z'))
N43  C                             + '</TotBruttoVekt>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = KUREF
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Referanse>'
N43  C                             + %TRIM(XTXT802) + '</Referanse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   * Mottager
N43  C                   EVAL      XDATA = '<Mottaker>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Orgnr>'
N43  C                             + %TRIM(SIRG) + '</Orgnr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SINAK
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Navn>'
N43  C                             + %TRIM(XTXT802) + '</Navn>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIADK1
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Gateadresse>'
N43  C                             + %TRIM(XTXT802) + '</Gateadresse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIADK2
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Postadresse>'
N43  C                             + %TRIM(XTXT802) + '</Postadresse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C     ' '           SCAN      SIADK3        XPOS              3 0    36
N43  C   36              IF        XPOS < 10
N43  C                   EVAL      XTXT801 = %SUBST(SIADK3:1:XPOS-1)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Postnr>'
N43  C                             + %TRIM(XTXT802) + '</Postnr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XPOS = XPOS + 1
N43  C                   ELSE
N43  C                   EVAL      XPOS = 1
N43  C                   END
N43  C  N36              EVAL      XPOS = 1
N43  C                   EVAL      XTXT801 = %SUBST(SIADK3:XPOS:31-XPOS)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Poststed>'
N43  C                             + %TRIM(XTXT802) + '</Poststed>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Land>NORGE</Land>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Landkode>NO</Landkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   IF        SIKNK <> 0
N43  C                   EVAL      XDATA = '<Nr>'
N43  C                             + %TRIM(%EDITC(SIKNK:'Z')) + '</Nr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   EVAL      XDATA = '</Mottaker>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C                   IF        SIBEL8 <> 0
N43  C                   EVAL      XDATA = '<Verdiopplysninger>'
N43  C                             + %TRIM(%EDITC(SIBEL8:'L'))
N43  C                             + '</Verdiopplysninger>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43   * Deklarant
N43  C                   EVAL      XTXT801 = SINAD
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Deklarantnavn>'
N43  C                             + %TRIM(XTXT802) + '</Deklarantnavn>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SITLF
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Deklaranttlf>'
N43  C                             + %TRIM(XTXT802) + '</Deklaranttlf>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C                   EVAL      XDATA = '<Landkode>'
N43  C                             + %TRIM(SILKA) + '</Landkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = KS2FTX
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Landtekst>'
N43  C                             + %TRIM(XTXT802) + '</Landtekst>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Container>'
N43  C                             + %TRIM(SIKDC) + '</Container>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SILV2
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Levvilkkode>'
N43  C                             + %TRIM(XTXT802) + '</Levvilkkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SILVT
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Levvilktekst>'
N43  C                             + %TRIM(XTXT802) + '</Levvilktekst>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SITRID
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<AktivtransportID>'
N43  C                             + %TRIM(XTXT802) + '</AktivtransportID>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<AktivtransportTYPE>'
N43  C                             + %TRIM(SILKT) + '</AktivtransportTYPE>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Fakturabelop>'
N43  C                             + %TRIM(%EDITC(SIBEL3:'L'))
N43  C                             + '</Fakturabelop>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Fakturuakurs>'
N43  C                             + %TRIM(%EDITC(SIVKU:'4'))
N43  C                             + '</Fakturuakurs>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Transaksjonstype>'
N43  C                             + %TRIM(%EDITC(SITST:'Z'))
N43  C                             + '</Transaksjonstype>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Transportvedgrensen>'
N43  C                             + %TRIM(%EDITC(SITRM:'Z'))
N43  C                             + '</Transportvedgrensen>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   IF        SIKDDK = ' '
N43  C                   EVAL      XDATA = '<Betaler>M</Betaler>'
N43  C                   ELSE
N43  C                   EVAL      XDATA = '<Betaler>'
N43  C                             + %TRIM(SIKDDK) + '</Betaler>'
N43  C                   END
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   * Faktura
N43  C                   EXSR      SREMMA2
N43   *
N43  C                   EVAL      XDATA = '<Varenslagringsstedkode>'
N43  C                             + %TRIM(SIKDLS)
N43  C                             + '</Varenslagringsstedkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SILS
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Varenslagringsstedtekst>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Varenslagringsstedtekst>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C                   ENDSR
N43   *
N43   ***************************************************************
N43  C     SREMMA2       BEGSR
N43   ***************************************************************
N43   *
N43  C                   IF        SIFIF = 'F15  ER  BENYTTET'
N43   *
N43  C     SADFK         SETLL     SADF
N43  C     SADFK         READE     SADF                                   36
N43  C                   DOW       *IN36 = *OFF
N43  C                   EVAL      XDATA = '<Faktura>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SFTXT
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Fakturanr>'
N43  C                             + %TRIM(XTXT802) + '</Fakturanr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Belop>'
N43  C                             + %TRIM(%EDITC(SFBL28:'4')) + '</Belop>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Valuta>'
N43  C                             + %TRIM(SFVK28) + '</Valuta>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Kurs>'
N43  C                             + %TRIM(%EDITC(SFKR28:'4')) + '</Kurs>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Dato>'
N43  C                             + %TRIM(%EDITW(SIDT:'    .  .  '))
N43  C                             + '</Dato>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</Faktura>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C     SADFK         READE     SADF                                   36
N43  C                   ENDDO
N43   *
N43  C                   ELSE
N43  C                   EVAL      XDATA = '<Faktura>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIFIF
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Fakturanr>'
N43  C                             + %TRIM(SIFIF) + '</Fakturanr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Belop>'
N43  C                             + %TRIM(%EDITC(SIBEL3:'4')) + '</Belop>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Valuta>'
N43  C                             + %TRIM(SIVAL3) + '</Valuta>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Kurs>'
N43  C                             + %TRIM(%EDITC(SIVKU:'4')) + '</Kurs>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Dato>'
N43  C                             + %TRIM(%EDITW(SIFID:'    .  .  '))
N43  C                             + '</Dato>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</Faktura>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43   *
N43  C                   ENDSR
N43   *
N43   ***************************************************************
N43  C     SREMMA5       BEGSR
N43   ***************************************************************
N97   *
N97  C                   IF        WFIMVS = 0 AND X_SIMVA = 'J'
N97  C                   EVAL      X_MVAFRITAK = 'M2'
N97  C                   ELSE
N97  C                   MOVE      *BLANKS       X_MVAFRITAK       3
N97  C     1             DO        15            XN7
N97  C                   SELECT
N97  C                   WHEN      TC(XN7) = 'M2'
N97  C                   EVAL      X_MVAFRITAK = 'M2'
N97  C                   LEAVE
N97  C                   ENDSL
N97  C                   ENDDO
N97  C                   END
N97   *
N43  C                   EVAL      XDATA = '<Varelinje>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C*                  EVAL      XDATA = '<Grunnlag>'
N43  C*                            + %TRIM(%EDITC(XXXXXX:'Z')) + '</Grunnlag>'
N43  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C                   IF        SIKDC = '0'
N43  C*    1             DO        7             XN7               3 0
N43  C*                  IF        KN(XN7) <> *BLANKS
N43  C*                  EVAL      XDATA = '<MerkeogNummer>'
N43  C*                            + %TRIM(KN(XN7)) + '</MerkeogNummer>'
N43  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C*                  END
N43  C*                  ENDDO
N43   *
N43  C   27              IF        KN(1) <> *BLANKS
N43  C                   EVAL      XTXT801 = KN(1)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<MerkeogNummer>'
N43  C                             + %TRIM(XTXT802) + '</MerkeogNummer>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   END
N43   *
N43  C                   IF        WFIANT = 0
N43  C                   EVAL      XDATA = '<Antall>'
N43  C                             + %TRIM(%EDITC(SINTK:'Z')) + '</Antall>'
N43  C                   ELSE
N43  C                   EVAL      XDATA = '<Antall>'
N43  C                             + %TRIM(%EDITC(WFIANT:'Z')) + '</Antall>'
N43  C                   END
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = VB(1)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Vareslag>'
N43  C                             + %TRIM(XTXT802) + '</Vareslag>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   IF        VB(2) <> *BLANKS
N43  C                   EVAL      XTXT801 = VB(2)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Godsbeskrivelse1>'
N43  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse1>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   IF        VB(3) <> *BLANKS
N43  C                   EVAL      XTXT801 = VB(3)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Godsbeskrivelse2>'
N43  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse2>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   IF        VB(4) <> *BLANKS
N43  C                   EVAL      XTXT801 = VB(4)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Godsbeskrivelse3>'
N43  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse3>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   IF        VB(5) <> *BLANKS
N43  C                   EVAL      XTXT801 = VB(5)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Godsbeskrivelse4>'
N43  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse4>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   IF        VB(6) <> *BLANKS
N43  C                   EVAL      XTXT801 = VB(6)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Godsbeskrivelse5>'
N43  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse5>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43   *
N43  C   27              IF        SIKDC = '1'
N106 C                   CALL      'SAD068A'
N106 C                   PARM      SIAVD         UAVDCN            4 0
N106 C                   PARM      SITDN         UOPDCN            7 0
N106 C                   PARM      WFIRNR        ULNCN             5 0
N106 C     CNR50         PARM                    UCNR            850
S106 C*    1             DO        7             XN7               3 0
S106 C*                  IF        KN(XN7) <> *BLANKS
S106 C*                  EVAL      XTXT801 = KN(XN7)
N106 C     1             DO        50            XN7               3 0
N106 C                   IF        CNR(XN7) <> *BLANKS
N106 C                   EVAL      XTXT801 = CNR(XN7)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Container' + %TRIM(%EDITC(XN7:'Z'))
N43  C                             + '>' + %TRIM(XTXT802)
N43  C                             + '</Container' + %TRIM(%EDITC(XN7:'Z')) +'>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   ENDDO
N43  C                   END
N43   *
N43   * BILFORTOLLING
N43  C                   IF        *IN27 = *OFF
N43  C                   EVAL      XTXT801 = DSFTXM
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Hvasomhelst1>'
N43  C                             + %TRIM(XTXT802) + '</Hvasomhelst1>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = %TRIM(DSFTXV) +', '+ %TRIM(DSFTXE)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Hvasomhelst2>'
N43  C                             + %TRIM(XTXT802) + '</Hvasomhelst2>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = %TRIM(DSFTXK) +', '+ %TRIM(DSFCIC)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Hvasomhelst3>'
N43  C                             + %TRIM(XTXT802) + '</Hvasomhelst3>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = %TRIM(DSFCI)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Hvasomhelst4>'
N43  C                             + %TRIM(XTXT802) + '</Hvasomhelst4>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = 'Underst. nr.: ' + %TRIM(SWUNNR)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Hvasomhelst5>'
N43  C                             + %TRIM(XTXT802) + '</Hvasomhelst5>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43   *
N43  C                   IF        WFIRNR = 0
N43  C                   EVAL      XDATA = '<Varepostnr>1</Varepostnr>'
N43  C                   ELSE
N43  C                   EVAL      XDATA = '<Varepostnr>'
N43  C                             + %TRIM(%EDITC(WFIRNR:'4')) + '</Varepostnr>'
N43  C                   END
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   MOVE      WFIVNT        XAN08             8
N43  C                   EVAL      XDATA = '<Varenummer>'
N43  C                             + %TRIM(XAN08) + '</Varenummer>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Tollnedsettelse>'
N43  C                             + %TRIM(WFITN) + '</Tollnedsettelse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Opprinnelse>'
N43  C                             + %TRIM(WFILK) + '</Opprinnelse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Bruttovekt>'
N43  C                             + %TRIM(%EDITC(WFIVKB:'4')) + '</Bruttovekt>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Preferanse>'
N43  C                             + %TRIM(WFIPRE) + '</Preferanse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Prosedyre>'
N43  C                             + %TRIM(%EDITC(SIDP:'4')) + '</Prosedyre>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Nettovekt>'
N43  C                             + %TRIM(%EDITC(WFIVKN:'Z')) + '</Nettovekt>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Annenenhet>'
N43  C                             + %TRIM(%EDITC(WFINTM:'Z')) + '</Annenenhet>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Verdifastsettelse>'
N43  C                             + %TRIM(WFIVF) + '</Verdifastsettelse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N88   *
N88  C                   EVAL      XDATA = '<EdocRef1></EdocRef1>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N88  C                   EVAL      XDATA = '<EdocRef2></EdocRef2>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N88  C                   EVAL      XDATA = '<EdocRef3></EdocRef3>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N88  C                   EVAL      XDATA = '<EdocRef4></EdocRef4>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N88  C                   EVAL      XDATA = '<EdocRef5></EdocRef5>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N88  C                   EVAL      XDATA = '<ArtNr></ArtNr>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
S97  C*                  EVAL      XDATA = '<MVAFrifakKode>'
S97  C*                            + %TRIM(X_SIMVA) + '</MVAFrifakKode>'
N97  C                   EVAL      XDATA = '<MVAFritakKode>'
N97  C                             + %TRIM(X_MVAFritak) + '</MVAFritakKode>'
N88  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C     1             DO        15            XN7               3 0
N43  C                   IF        TO(XN7) <> *BLANKS
N43  C                   EVAL      XDATA = '<Dokument>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Kode>'
N43  C                             + %TRIM(TC(XN7)) + '</Kode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = TO(XN7)
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Tekst>'
N43  C                             + %TRIM(XTXT802) + '</Tekst>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</Dokument>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   ENDDO
N43   *
N43  C                   IF        WFIFTG = '-'
N43  C                   EVAL      XDATA = '<Justernig>-'
N43  C                             + %TRIM(%EDITC(WFIJUS:'Z')) + '</Justernig>'
N43  C                   ELSE
N43  C                   EVAL      XDATA = '<Justernig>'
N43  C                             + %TRIM(%EDITC(WFIJUS:'Z')) + '</Justernig>'
N43  C                   END
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Statistiskverdi>'
N43  C                             + %TRIM(%EDITC(WFISTB:'Z'))
N43  C                             + '</Statistiskverdi>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N72.2C                   MOVE      'N'           XMVAMED           1
S72.2C*    1             DO        15            XN7               3 0
N72.2C  N941             DO        15            XN7               3 0
N43  C                   IF        Y1(XN7) <> *BLANKS
N72.2C                   IF        Y1(XN7) = 'MV'
N72.2C                   MOVE      'J'           XMVAMED
N72.2C                   END
N43  C                   EVAL      XDATA = '<Avgift>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Avgkode>'
N43  C                             + %TRIM(Y1(XN7)) + '</Avgkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Grunnlag>'
N43  C                             + %TRIM(%EDITC(G1(XN7):'4')) + '</Grunnlag>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Sats>'
N43  C                             + %TRIM(%EDITC(S1(XN7):'4')) + '</Sats>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Belop>'
N43  C                             + %TRIM(%EDITC(B1(XN7):'4')) + '</Belop>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<BM>'
N43  C                             + %TRIM(P1(XN7)) + '</BM>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</Avgift>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   END
N43  C                   ENDDO
N97   *
N97  C                   IF        X_MVAFritak <> *BLANKS AND X_SYMVSP = 'J'
N97  C                   EVAL      XDATA = '<Avgift>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   EVAL      XDATA = '<Avgkode>MV</Avgkode>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   EVAL      XDATA = '<Grunnlag>'
N97  C                             + %TRIM(%EDITC(WFIMVG:'4')) + '</Grunnlag>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   EVAL      XDATA = '<Sats>0</Sats>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   EVAL      XDATA = '<Belop>0</Belop>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   EVAL      XDATA = '<BM>%</BM>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   EVAL      XDATA = '</Avgift>'
N97  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N97  C                   ELSE
N72.2 *
N72.2 * MVA-REGISTRERT MED TOTAL AVGIFT < 50, FAKTURASUM > 350 OG MVASPES = 'J'
N72.2C   94              IF        SIMVA = 'J' AND SIBEL4 > 350 AND
N72.2C                             X_SYMVSP = 'J' AND
N72.2C                             XMVAMED = 'N' AND WFIMVS <> 0
N72.2C                   EVAL      XDATA = '<Avgift>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      XDATA = '<Avgkode>MV</Avgkode>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      XDATA = '<Grunnlag>'
S83  C*                            + %TRIM(%EDITC(WFISTB:'4')) + '</Grunnlag>'
N83  C                             + %TRIM(%EDITC(WFIMVG:'4')) + '</Grunnlag>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      XDATA = '<Sats>'
N72.2C                             + %TRIM(%EDITC(WFIMVS:'4')) + '</Sats>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
S83  C*                  EVAL(H)   X_AVGBL = WFISTB * WFIMVS / 100
N83  C                   EVAL(H)   X_AVGBL = WFIMVG * WFIMVS / 100
N72.2C                   EVAL      XDATA = '<Belop>'
N72.2C                             + %TRIM(%EDITC(X_AVGBL:'4')) + '</Belop>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      XDATA = '<BM></BM>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      XDATA = '</Avgift>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      SIBEL7 = SIBEL7 + X_AVGBL
N72.2C                   EVAL      X_SIBEL6 = X_SIBEL6 + X_AVGBL
N72.2C                   END
N97   *
N97  C                   END
N43   *
N43  C                   EVAL      XDATA = '</Varelinje>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   *
N43  C                   ENDSR
N43   *
N43   ***************************************************************
N43  C     SREMMA9       BEGSR
N43   ***************************************************************
N43   * VEDLEGG
N43  C                   MOVE      *BLANKS       VKD
N43  C     ARKVEDKK      CHAIN     ARKVEDK                            36
N60  C                   IF        AVKVED = *BLANKS
N60  C     'si'          CHAIN     ARKTXT                             36
N60  C  N36              EVAL      AVKVED = ARKVED
N60  C                   END
N43  C                   EVAL      VKD(1) = 'si'
N43  C                   EVAL      VKD(2) = 'sk'
N43   *
N43  C                   EVAL      ARTYPE = VKD(1)
N43  C                   Z-ADD     1             XN8               3 0
N43  C                   MOVE      *BLANKS       VEDL
N43  C                   MOVE      *ZEROS        XN7
S50  C*    FIFIRM        CHAIN     FIRMARC                            36
N43  C     STEMMA91      TAG
N43  C     ARTYPE        CHAIN     ARKTXT                             36
N43  C                   IF        ARKLAG <> *BLANKS
N43  C     ARKEXTK       CHAIN     ARKEXT                             36
N50  C                   ELSE
N50  C     FIFIRM        CHAIN     FIRMARC                            36
N43  C                   END
N43  C     ARKIVL02K     SETLL     ARKIVL02
N43  C     ARKIVL02K     READE     ARKIVL02                               36
N43  C                   DOW       *IN36 = *OFF
N43  C                   ADD       1             XN7
N43  C     '.'           SCAN      ARLINK                                 36
N43  C  N36              EVAL      ARLINK = %TRIM(ARLINK) + '.pdf'
N43  C                   EVAL      VEDL(XN7) = '/' + %TRIM(ARCANE)
N43  C                             + '/' + %TRIM(ARLINK)
N43  C                   EVAL      XDATA = '<Vedlegg>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Filnavn>'
N43  C                             + %TRIM(ARLINK) + '</Filnavn>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   IF        ARRFK = *BLANKS
N43  C                   EVAL      ARRFK = %TRIM(ARTXT) + ' ' + %TRIM(KUREF)
N43  C                   END
N43  C                   EVAL      XDATA = '<Beskrivelse>'
N43  C                             + %TRIM(ARRFK) + '</Beskrivelse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</Vedlegg>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C     ARKIVL02K     READE     ARKIVL02                               36
N43  C                   ENDDO
N43  C                   ADD       1             XN8
N79   * Ikke sende SAD-vedlegg flere ganger
N79  C                   DOW       XN8>2 AND (VKD(XN8)='si' OR VKD(XN8)='sk')
N79  C                   ADD       1             XN8
N79  C                   ENDDO
N79   *
N43  C                   IF        VKD(XN8) <> *BLANKS
N43  C                   EVAL      ARTYPE = VKD(XN8)
N43  C                   GOTO      STEMMA91
N43  C                   END
N43   *
N43  C                   MOVE      SIKTA         XAN05             5
N43  C                   EVAL      XDATA = '<Tollkontonr>'
N43  C                             + %TRIM(SIKTC) + %TRIM(XAN05)
N43  C                             + '</Tollkontonr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   MOVE      SIKTB         XAN02             2
N43  C                   EVAL      XDATA = '<Kontrollsiffer>'
N43  C                             + %TRIM(XAN02) + '</Kontrollsiffer>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIGN
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Godsnr>'
N43  C                             + %TRIM(XTXT802) + '</Godsnr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SIPOS
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Posnr>'
N43  C                             + %TRIM(XTXT802) + '</Posnr>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   SELECT
N43  C                   WHEN      XSIFRT1 <> *BLANKS
N43  C                   EVAL      XTXT801 = XSIFRT1
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger1>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Regnskapsopplysninger1>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = XSIFRT2
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger2>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Regnskapsopplysninger2>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = XSIFRT3
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger3>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Regnskapsopplysninger3>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = XSIFRT4
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger4>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Regnskapsopplysninger4>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   WHEN      XBETALT <> *BLANKS
N43  C                   EVAL      XTXT801 = XBETALT
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger1>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Regnskapsopplysninger1>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = XFAKTNR
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger2>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Regnskapsopplysninger2>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Regnskapsopplysninger3>'
N43  C                             + %TRIM(XBETALL)
N43  C                             + '</Regnskapsopplysninger3>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   ENDSL
N43   *
N43  C                   EVAL      XTXT801 = SIDST
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Sted>'
N43  C                             + %TRIM(XTXT802) + '</Sted>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Dato>'
N43  C                             + %TRIM(PRODAT) + '</Dato>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SINAD2
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Representantensnavn>'
N43  C                             + %TRIM(XTXT802) + '</Representantensnavn>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XTXT801 = SITARF
N43  C                   EXSR      KNVST
N43  C                   EVAL      XDATA = '<Representantensunderskrift>'
N43  C                             + %TRIM(XTXT802)
N43  C                             + '</Representantensunderskrift>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43   * Tilleggsopplysninger
N43  C                   EVAL      XDATA = '<TilleggsOpplysninger>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Deklkode>'
N43  C                             + %TRIM(CPHONE) + '</Deklkode>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C*                  EVAL      XDATA = '<OppdragsGivernr>'
N43  C*                            + '</OppdragsGivernr>'
N43  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C*                  EVAL      XDATA = '<OppdragsGivernavn>'
N43  C*                            + %TRIM(SINAK) + '</OppdragsGivernavn>'
N43  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C*                  EVAL      XDATA = '<OppdragsGiverorgnr>'
N43  C*                            + %TRIM(SIRG) + '</OppdragsGiverorgnr>'
N43  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   MOVE      SIAVD         XAN04             4
N79  C                   IF        SITDN < 0
N79  C                   Z-SUB     SITDN         X_SITDN           7 0
N79  C                   MOVE      X_SITDN       XAN07
N79  C                   MOVE      '-'           XAN01
N79  C                   ELSE
N43  C                   MOVE      SITDN         XAN07             7
N79  C                   MOVE      ' '           XAN01             1
N79  C                   END
N43  C                   EVAL      XDATA = '<InternReferanse>'
S79  C*                            + %TRIM(XAN04) + '/' + %TRIM(XAN07) + '/'
N79  C                             + %TRIM(XAN04) + '/' + %TRIM(XAN07)
N79  C                             + %TRIM(XAN01) + '/'
N43  C                             + %TRIM(SISG) + '</InternReferanse>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<ImportEksport>I</ImportEksport>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<Godkjentdato>'
N43  C                             + %SUBST(SIDTG:7:2) + '.'
N43  C                             + %SUBST(SIDTG:5:2) + '.'
N43  C                             + %SUBST(SIDTG:1:4) + '</Godkjentdato>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '<SumAvgifter>'
N43  C                             + %TRIM(%EDITC(SIBEL7:'4'))
N43  C                             + '</SumAvgifter>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   IF        SIMVA = 'J'
N72.2C                   EVAL      XDATA = '<SumMoms>'
N72.2C                             + %TRIM(%EDITC(X_SIBEL6:'4')) + '</SumMoms>'
N72.2C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N72.2C                   EVAL      XSUMAVG = SIBEL7 - X_SIBEL6
N72.2C                   ELSE
N43  C                   EVAL      XDATA = '<SumMoms>'
S72.2C*                            + %TRIM(%EDITC(SIBEL6:'4')) + '</SumMoms>'
N72.2C                             + %TRIM(%EDITC(X_SIBEL6:'4')) + '</SumMoms>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
S72.2C*                  EVAL      XSUMAVG = SIBEL7 - SIBEL6
N72.2C                   EVAL      XSUMAVG = SIBEL7 - X_SIBEL6
N72.2C                   END
N43  C                   EVAL      XDATA = '<SumEkslMoms>'
N43  C                             + %TRIM(%EDITC(XSUMAVG:'4'))
N43  C                             + '</SumEkslMoms>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</TilleggsOpplysninger>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79   *
N79  C                   IF        SITDN < 0
N79  C                   EXSR      SREMMA10
N79  C                   END
N43   *
N43  C                   EVAL      XDATA = '</Fortolling>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      XDATA = '</EmmaSystemsFortolling>'
N43  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N43  C                   EVAL      rc = close( FILE_o )
N43   *
N43  C                   CALL      'SYGE15C'
N43  C                   PARM                    WDT               8
N43  C                   PARM                    WTM               6
N43   *
N43  C                   CLEAR                   EDISR0
N43  C                   EVAL      S0_S0004  = CMOBIL
N43  C                   EVAL      S0_S0010  = CFAX
N43  C                   EVAL      S0_S0020  = WMBR
N43  C                   EVAL      S0_SSN    = CSN
N43  C                   EVAL      S0_SSR    = 'S'
N43  C                   EVAL      S0_SST    = 'A'
N43  C                   EVAL      S0_S0036  = 1
N43  C                   MOVEL     WDT           S0_SDT
N43  C                   MOVEL     WTM           S0_STM
N43  C                   EVAL      S0_SFILE  = '*IFS'
N43  C                   EVAL      S0_SMBR   = WMBR
N43  C                   EVAL      S0_SLIB   = '*LIBL'
N43  C                   EVAL      S0_SIFS   = WFILNAM2
N43  C                   WRITE     EDISR0
N43   *
N43  C                   CLEAR                   EDISXR0
N43  C                   EVAL      X0_SXPRODM  = WMBR
N43  C                   EVAL      X0_SXIFSOBJ = Wfilnam2
N43  C                   WRITE     EDISXR0
N43   *
N43  C                   CLEAR                   EDIMR0
N43  C                   EVAL      M0_M0004  = CMOBIL
N43  C                   EVAL      M0_M0010  = CFAX
N43  C                   EVAL      M0_MSN    = CSN
N43  C                   EVAL      M0_MMN    = CMN
N43  C                   EVAL      M0_MSR    = 'S'
N43  C                   EVAL      M0_MST    = 'C'
N43  C                   EVAL      M0_MAVD   = SIAVD
N43  C                   EVAL      M0_MTDN   = SITDN
N43  C                   EVAL      M0_M0035  = M0035
N43  C                   EVAL      M0_M0062  = M0062
N43  C                   EVAL      M0_M0065  = 'XMLEMA'
N43  C                   EVAL      M0_M0068  = 'EMMA-' + %TRIM(KUREF)
N43  C                   EVAL      M0_M1001  = '929'
N43  C                   EVAL      M0_M1004  = *BLANKS
N43  C                   EVAL      M0_M1225  = 'XML'
N43  C                   EVAL      M0_M1N07  = 'XML'
N43  C                   EVAL      M0_M0068A = M0068A
N43  C                   EVAL      M0_M0068B = M0068B
N43  C                   EVAL      M0_M0068C = M0068C
N43  C                   MOVEL     WDT           M0_MDT
N43  C                   MOVEL     WTM           M0_MTM
N43  C                   WRITE     EDIMR0
N43   * VEDL
N43  C     1             DO        100           XN7
N43  C                   IF        VEDL(XN7) = *BLANKS
N43  C                   LEAVE
N43  C                   END
N43  C     1             CHAIN     EDIC                               51
N43  C                   ADD       1             CSN
N43  C                   UPDATE    EDICR
N43  C                   EVAL      WMBRB = CSN
N43  C                   EVAL      S0_S0020  = WMBR
N43  C                   EVAL      S0_SSN    = CSN
N43  C                   EVAL      S0_SST    = 'A'
N43  C                   EVAL      S0_SFILE  = '*IFS'
N43  C                   EVAL      S0_SMBR   = WMBR
N43  C                   EVAL      S0_SLIB   = '*LIBL'
N43  C                   EVAL      S0_SIFS   = VEDL(XN7)
N43  C                   WRITE     EDISR0
N43  C                   ENDDO
N80   *
N80   * Oppdater track & trace
N80  C                   EVAL      TTAVD  = SIAVD
N80  C                   EVAL      TTOPD  = SITDN
N80  C                   EVAL      TTACTI = 'EMM'
N80  C                   MOVEL     WDT           TTDATE
N80  C                   MOVEL     WTM           TTTIME
N104 C                   IF        M0_M0010 = 'EMMA'
N80  C                   EVAL      TTTEXT='Customdecl. import is sent to Emma.'
N104 C                   ELSE
N104 C                   EVAL      TTTEXT='Customdecl. import is sent to '
N104 C                             + 'Proteria.'
N104 C                   END
N80  C                   EVAL      TTUSER = ZUSER
N80  C                   EVAL      TTDATL = TTDATE
N80  C                   EVAL      TTTIML = TTTIME
N104 C                   IF        M0_M0010 = 'EMMA'
N80  C                   EVAL      TTTEXL = 'Tolldek. import er sendt til Emma.'
N104 C                   ELSE
N104 C                   EVAL      TTTEXL = 'Tolldek. import er sendt til Emma.'
N104 C                             + 'Proteria.'
N104 C                   END
N80  C                   WRITE     TRACKFR
N43   *
N43  C                   ENDSR
N43   *
N79   ***************************************************************
N79  C     SREMMA10      BEGSR
N79   ***************************************************************
N79   * Omberegning start
N79  C                   EVAL      XDATA = '<Omberegning>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79   * Reason1
N79  C                   IF        SIFT01 <> *BLANKS
S93  C*                  EVAL      XDATA = '<Reason1>' + %TRIM(SIFT01)
N93  C                   EVAL      XTXT801 = SIFT01
N93  C                   EXSR      KNVST
N93  C                   EVAL      XDATA = '<Reason1>' + %TRIM(XTXT802)
N79  C                             + '</Reason1>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * Reason2
N79  C                   IF        SIFT02 <> *BLANKS
S93  C*                  EVAL      XDATA = '<Reason2>' + %TRIM(SIFT02)
N93  C                   EVAL      XTXT801 = SIFT02
N93  C                   EXSR      KNVST
N93  C                   EVAL      XDATA = '<Reason2>' + %TRIM(XTXT802)
N79  C                             + '</Reason2>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * Reason3
N79  C                   IF        SIFT03 <> *BLANKS
S93  C*                  EVAL      XDATA = '<Reason3>' + %TRIM(SIFT03)
N93  C                   EVAL      XTXT801 = SIFT03
N93  C                   EXSR      KNVST
N93  C                   EVAL      XDATA = '<Reason3>' + %TRIM(XTXT802)
N79  C                             + '</Reason3>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * Reason4
N79  C                   IF        SIFT04 <> *BLANKS
S93  C*                  EVAL      XDATA = '<Reason4>' + %TRIM(SIFT04)
N93  C                   EVAL      XTXT801 = SIFT04
N93  C                   EXSR      KNVST
N93  C                   EVAL      XDATA = '<Reason4>' + %TRIM(XTXT802)
N79  C                             + '</Reason4>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * Reason5
N79  C                   IF        SIFT05 <> *BLANKS
S93  C*                  EVAL      XDATA = '<Reason5>' + %TRIM(SIFT05)
N93  C                   EVAL      XTXT801 = SIFT05
N93  C                   EXSR      KNVST
N93  C                   EVAL      XDATA = '<Reason5>' + %TRIM(XTXT802)
N79  C                             + '</Reason5>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * TadRefOpprDekl
N79  C                   EVAL      XDATA = '<TadRefOpprDekl>'
N79  C                             + %TRIM(OMB_SITLE)
N79  C                             + %TRIM(OMB_SITLL)
N79  C                             + '</TadRefOpprDekl>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79   * Kode
N79  C                   EVAL      XDATA = '<Kode>' + %TRIM(SITYPE)
N79  C                             + '</Kode>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79   * OriginalSpednr
N79  C                   Z-SUB     SITDN         XN07              7 0
N79  C                   MOVE      XN07          XAN07
N79  C                   EVAL      XDATA = '<OriginalSpednr>'
N79  C                             + %TRIM(XAN04) + '/' + %TRIM(XAN07) + '/'
N79  C                             + %TRIM(SISG) + '</OriginalSpednr>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   MOVE      SITDN         XAN07
N79   * MeldingFraToller1
N79  C                   IF        SIFT11 <> *BLANKS
N93  C                   EVAL      XTXT801 = SIFT11
N93  C                   EXSR      KNVST
N79  C                   EVAL      XDATA = '<MeldingFraToller1>'
S93  C*                            + %TRIM(SIFT11) + '</MeldingFraToller1>'
N93  C                             + %TRIM(XTXT802) + '</MeldingFraToller1>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * MeldingFraToller2
N79  C                   IF        SIFT12 <> *BLANKS
N93  C                   EVAL      XTXT801 = SIFT12
N93  C                   EXSR      KNVST
N79  C                   EVAL      XDATA = '<MeldingFraToller2>'
S93  C*                            + %TRIM(SIFT12) + '</MeldingFraToller2>'
N93  C                             + %TRIM(XTXT802) + '</MeldingFraToller2>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * MeldingFraToller3
N79  C                   IF        SIFT13 <> *BLANKS
N93  C                   EVAL      XTXT801 = SIFT13
N93  C                   EXSR      KNVST
N79  C                   EVAL      XDATA = '<MeldingFraToller3>'
S93  C*                            + %TRIM(SIFT13) + '</MeldingFraToller3>'
N93  C                             + %TRIM(XTXT802) + '</MeldingFraToller3>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * MeldingFraToller4
N79  C                   IF        SIFT14 <> *BLANKS
N93  C                   EVAL      XTXT801 = SIFT14
N93  C                   EXSR      KNVST
N79  C                   EVAL      XDATA = '<MeldingFraToller4>'
S93  C*                            + %TRIM(SIFT14) + '</MeldingFraToller4>'
N93  C                             + %TRIM(XTXT802) + '</MeldingFraToller4>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * MeldingFraToller5
N79  C                   IF        SIFT15 <> *BLANKS
N93  C                   EVAL      XTXT801 = SIFT15
N93  C                   EXSR      KNVST
N79  C                   EVAL      XDATA = '<MeldingFraToller5>'
S93  C*                            + %TRIM(SIFT15) + '</MeldingFraToller5>'
N93  C                             + %TRIM(XTXT802) + '</MeldingFraToller5>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79  C                   END
N79   * Omberegning slutt
N79  C                   EVAL      XDATA = '</Omberegning>'
N79  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N79   *
N79  C                   ENDSR
N79   *
N43   ***********************************************
N43  C     KNVST         BEGSR
N43   ***********************************************
N43  C                   Z-ADD     50            XN53              3 0
N43  C     XN53          SUB       4             XN54              3 0
N43  C     XN53          SUB       5             XN55              3 0
N43  C     XN53          SUB       6             XN56              3 0
N43  C                   Z-ADD     0             XN52              3 0
N43  C                   MOVE      *BLANKS       XTXT802
N43  C     1             DO        80            XN51              3 0
N43  C                   IF        (((((XT801(XN51) = '&') OR
N43  C                                 (XT801(XN51) = '"')) OR
N43  C                                 (XT801(XN51) = XAPS)) OR
N43  C                                 (XT801(XN51) = '<')) OR
N43  C                                 (XT801(XN51) = '>'))
N43  C                   IF        XN52 < XN53
N43  C                   ADD       1             XN52
N43  C                   SELECT
N43  C                   WHEN      XT801(XN51) = '&'
N43  C                   IF        XN51 < XN55
N43  C                   MOVEA     '&amp;'       XT802(XN52)
N43  C                   ADD       4             XN52
N43  C                   ELSE
N43  C                   SUB       1             XN52
N43  C                   END
N43  C                   WHEN      XT801(XN51) = '"'
N43  C                   IF        XN51 < 75
N43  C                   MOVEA     '&quot;'      XT802(XN52)
N43  C                   ADD       5             XN52
N43  C                   ELSE
N43  C                   SUB       1             XN52
N43  C                   END
N43  C                   WHEN      XT801(XN51) = XAPS
N43  C                   IF        XN51 < XN56
N43  C                   MOVEA     '&apos;'      XT802(XN52)
N43  C                   ADD       5             XN52
N43  C                   ELSE
N43  C                   SUB       1             XN52
N43  C                   END
N43  C                   WHEN      XT801(XN51) = '>'
N43  C                   IF        XN51 < XN54
N43  C                   MOVEA     '&gt;'        XT802(XN52)
N43  C                   ADD       3             XN52
N43  C                   ELSE
N43  C                   SUB       1             XN52
N43  C                   END
N43  C                   WHEN      XT801(XN51) = '<'
N43  C                   IF        XN51 < XN54
N43  C                   MOVEA     '&lt;'        XT802(XN52)
N43  C                   ADD       3             XN52
N43  C                   ELSE
N43  C                   SUB       1             XN52
N43  C                   END
N43  C                   ENDSL
N43  C                   END
N43  C                   ELSE
N43  C                   IF        XN52 < XN53
N43  C                   ADD       1             XN52
N43  C                   MOVE      XT801(XN51)   XT802(XN52)
N43  C                   ELSE
N43  C                   LEAVE
N43  C                   END
N43  C                   END
N43  C                   ENDDO
N43   *
N43  C                   ENDSR
N43   *
N106  ***********************************************
N106 C     SRHENTCN      BEGSR
N106  ***********************************************
N106 C  N33              IF        SIKDC = '1'
N106 C                   CALL      'SAD068A'
N106 C                   PARM      SIAVD         UAVDCN            4 0
N106 C                   PARM      SITDN         UOPDCN            7 0
N106 C                   PARM      WFIRNR        ULNCN             5 0
N106 C     CNR50         PARM                    UCNR            850
N106 C                   Z-ADD     0             XN2
N106 C     1             DO        7             XN1               3 0
N106 C                   IF        KN(XN1) = *BLANKS
N106 C                   ADD       1             XN2
N106 C                   EVAL      KN(XN1) = CNR(XN2)
N106 C                   END
N106 C                   ENDDO
N106 C                   END
N106  *
N106 C                   ENDSR
N106  *
      *
      * =============================================================
      *
      *** ............ START DEL-1 (IKKE DATA LISTE PÅ DEL-2) .......
      *
      *** ............ START DEL-2 (STANDARD FORMULAR)
     OTOLLDEK2  E            DEL2             01
     O                       XPFM1               75
     OTOLLDEK2  E            DEL2             02
S03  O*                                          28 'REF:     /       /   '
S03  O*                      SIAVD         Z     16
S03  O*                      SITDN         Z     24
S03  O*                      SISG                28
S03  O*              97                          43 '(       /   )'
S03  O*              97      SIOPD         Z     38
S03  O*              97      SIFRBN        Z     42
S03  O*                      FSSO15              60
N14  O                                           29 'REF:     /       /   '
S14  O*                                          27 '         /       /   '
N03  O                       SIAVD         Z     17
N03  O                       SITDN         Z     25
N03  O                       SISG                29
s08  O*              97                          41 '(       /   )'
s08  O*              97      SIOPD         Z     36
s08  O*              97      SIFRBN        Z     40
s08  O*                      FSSO15              57
n08  O                       FSSO25              55
     O               39   N37                    75 'LINJEDEKLARERT'
S14  O*             N39 29N37                    77 'LINJEDEKLARERT KOPI'
N14  O              N39 34N37                    77 'L.DEKLARERT KOPI'
     O               39    37                    75 'UTLEV.-ATTEST '
S14  O*             N39 29 37                    77 'UTLEV.-ATTEST  KOPI'
N14  O              N39 34 37                    78 'UTLEV-ATTEST KOPI'
     O          E            DEL2             03
     O                       SIRG                38
     O               89                          38 '******'
     O                       SIDTY               47
     O                       XDP1                50
     O                       SIDTG               68
     O          E            DEL2             04
     O                       SINAK               39
     O                       SITLL               68
     O          E            DEL2             05
     O                       SITLE               64
     O          E            DEL2             06
     O                       XSNR          Z     47
     O                       XTOTS         Z     50
     O                                           54 '***'
     O*
     O*** DEL-2 FØRST VAREPOST
     O          E            DEL21            08
     O                       XN2           Z     51
     O                       XWFVN1              60 '0    .  '
     O                       XWFVN2              66
     O                       WFITN               79
      *IND 27 OFF=MOTORV.FORTOLLING/ON=Vanlig (SADV)
      *Gammel R.31 info er nå betinget med 27 uten videre merking.
     O          E            DEL21            09
S34  O*                 27   KN(1)               26
N34  O                  27   KN(1)               33
     O              N48 27   WFIANT        Z     33
     O              N48 27   WFIVT               38
     O               48 27   WFIVT               31
     O               48 27   WFIANT        Z     38
     O                  27   VB(1)               54
     O                 N27   SWPACA        Z     18
     O                 N27   SWPACB              26
     O          E            DEL21            10
S34  O*                 27   KN(2)               26
N34  O                  27   KN(2)               33
     O                  27   VB(2)               54
     O                 N27   DSFTXV              30
     O                       WFILK               58
     O                       WFIVKB        Z     74
     O                       WFIPRE              78
     O          E            DEL21            11
S34  O*                 27   KN(3)               26
N34  O                  27   KN(3)               33
     O                  27   VB(3)               54
     O                 N27   DSFTXE              30
     O          E            DEL21            12
S34  O*                 27   KN(4)               26
N34  O                  27   KN(4)               33
     O                  27   VB(4)               54
     O                 N27   DSFTXK              30
     O                       SIDP                58
     O                       WFIVKN        Z     74
     O          E            DEL21            13
S34  O*                 27   KN(5)               26
N34  O                  27   KN(5)               33
     O                  27   VB(5)               54
     O                 N27   DSPCIC              30
     O          E            DEL21            14
S34  O*                 27   KN(6)               26
N34  O                  27   KN(6)               33
     O                  27   VB(6)               54
     O                 N27   DSPCI               51
     O          E            DEL21            15
S34  O*                 27   KN(7)               26
N34  O                  27   KN(7)               33
     O              N28 27   VB(7)               54
     O               28 50 27VB(7)               54
     O               28N50 27                    36 'EX Cont:'
     O               28N50 27HETRCN              54
     O                 N27                       22 'Underst. nr.:'
     O                 N27   SWUNNR              40
     O          E            DEL21            16
     O                       TO(1)               54
     O                       WFINTM        Z     63
     O                       WFIVF               78
     O          E            DEL21            17
     O                       TO(2)               54
     O          E            DEL21            18
     O                       TO(3)               54
     O                       WFIJUS        Z     77
     O                       WFIFTG              78
     O          E            DEL21            19
     O                       TO(4)               54
     O          E            DEL21            20
     O                       TO(5)               54
     O                       WFISTB        Z     78
     O          E            DEL21X           25
     O                                           32 '**** IKKE BENYTTET ****'
     O          E            DEL21X           39
     O                                           32 '**** IKKE BENYTTET ****'
     O*
     O*** DEL-2 ANNEN VAREPOST
     O          E            DEL22            22
     O                       XN2           Z     51
     O                       XWFVN1              60 '0    .  '
     O                       XWFVN2              66
     O                       WFITN               79
      *IND 27 OFF=MOTORV.FORTOLLING/ON=Vanlig (SADV)
      *Gammel R.31 info er nå betinget med 27 uten videre merking.
     O          E            DEL22            23
S34  O*                 27   KN(1)               26
N34  O                  27   KN(1)               33
     O              N48 27   WFIANT        Z     33
     O              N48 27   WFIVT               38
     O               48 27   WFIVT               31
     O               48 27   WFIANT        Z     38
     O                  27   VB(1)               54
     O                 N27   SWPACA        Z     18
     O                 N27   SWPACB              26
     O          E            DEL22            24
S34  O*                 27   KN(2)               26
N34  O                  27   KN(2)               33
     O                  27   VB(2)               54
     O                 N27   DSFTXV              30
     O                       WFILK               58
     O                       WFIVKB        Z     74
     O                       WFIPRE              78
     O          E            DEL22            25
S34  O*                 27   KN(3)               26
N34  O                  27   KN(3)               33
     O                  27   VB(3)               54
     O                 N27   DSFTXE              30
     O          E            DEL22            26
S34  O*                 27   KN(4)               26
N34  O                  27   KN(4)               33
     O                  27   VB(4)               54
     O                 N27   DSFTXK              30
     O                       SIDP                58
     O                       WFIVKN        Z     74
     O          E            DEL22            27
S34  O*                 27   KN(5)               26
N34  O                  27   KN(5)               33
     O                  27   VB(5)               54
     O                 N27   DSPCIC              30
     O          E            DEL22            28
S34  O*                 27   KN(6)               26
N34  O                  27   KN(6)               33
     O                  27   VB(6)               54
     O                 N27   DSPCI               51
     O          E            DEL22            29
S34  O*                 27   KN(7)               26
N34  O                  27   KN(7)               33
     O              N28 27   VB(7)               54
     O               28 50 27VB(7)               54
     O               28N50 27                    36 'EX Cont:'
     O               28N50 27HETRCN              54
     O                 N27                       22 'Underst. nr.:'
     O                 N27   SWUNNR              40
     O          E            DEL22            30
     O                       TO(1)               54
     O                       WFINTM        Z     63
     O                       WFIVF               78
     O          E            DEL22            31
     O                       TO(2)               54
     O          E            DEL22            32
     O                       TO(3)               54
     O                       WFIJUS        Z     77
     O                       WFIFTG              78
     O          E            DEL22            33
     O                       TO(4)               54
     O          E            DEL22            34
     O                       TO(5)               54
     O                       WFISTB        Z     78
     O          E            DEL22X           39
     O                                           32 '**** IKKE BENYTTET ****'
     O*
     O*** DEL-2 TREDJE VAREPOST
     O          E            DEL23            36
     O                       XN2           Z     51
     O                       XWFVN1              60 '0    .  '
     O                       XWFVN2              66
     O                       WFITN               79
      *IND 27 OFF=MOTORV.FORTOLLING/ON=Vanlig (SADV)
      *Gammel R.31 info er nå betinget med 27 uten videre merking.
     O          E            DEL23            37
S34  O*                 27   KN(1)               26
N34  O                  27   KN(1)               33
     O              N48 27   WFIANT        Z     33
     O              N48 27   WFIVT               38
     O               48 27   WFIVT               31
     O               48 27   WFIANT        Z     38
     O                  27   VB(1)               54
     O                 N27   SWPACA        Z     18
     O                 N27   SWPACB              26
     O          E            DEL23            38
S34  O*                 27   KN(2)               26
N34  O                  27   KN(2)               33
     O                  27   VB(2)               54
     O                 N27   DSFTXV              30
     O                       WFILK               58
     O                       WFIVKB        Z     74
     O                       WFIPRE              78
     O          E            DEL23            39
S34  O*                 27   KN(3)               26
N34  O                  27   KN(3)               33
     O                  27   VB(3)               54
     O                 N27   DSFTXE              30
     O          E            DEL23            40
S34  O*                 27   KN(4)               26
N34  O                  27   KN(4)               33
     O                  27   VB(4)               54
     O                 N27   DSFTXK              30
     O                       SIDP                58
     O                       WFIVKN        Z     74
     O          E            DEL23            41
S34  O*                 27   KN(5)               26
N34  O                  27   KN(5)               33
     O                  27   VB(5)               54
     O                 N27   DSPCIC              30
     O          E            DEL23            42
S34  O*                 27   KN(6)               26
N34  O                  27   KN(6)               33
     O                  27   VB(6)               54
     O                 N27   DSPCI               51
     O          E            DEL23            43
S34  O*                 27   KN(7)               26
N34  O                  27   KN(7)               33
     O              N28 27   VB(7)               54
     O               28 50 27VB(7)               54
     O               28N50 27                    36 'EX Cont:'
     O               28N50 27HETRCN              54
     O                 N27                       22 'Underst. nr.:'
     O                 N27   SWUNNR              40
     O          E            DEL23            44
     O                       TO(1)               54
     O                       WFINTM        Z     63
     O                       WFIVF               78
     O          E            DEL23            45
     O                       TO(2)               54
     O          E            DEL23            46
     O                       TO(3)               54
     O                       WFIJUS        Z     77
     O                       WFIFTG              78
     O          E            DEL23            47
     O                       TO(4)               54
     O          E            DEL23            48
     O                       TO(5)               54
     O                       WFISTB        Z     78
     O*
     O*** DEL-2 SUMMERINGSLINJE
     O          E            DEL2S            50
     O               61      G1(1)         4     21
     O              N61      G11(1)        Z     21
     O                       Y1(1)               11
     O                       S1(1)         4     30
     O                       P1(1)               31
     O                       B1(1)         Z     41
     O                       TR(1)               44
     O               69      G1(9)         4     58
     O              N69      G11(9)        Z     58
     O                       Y1(9)               47
     O                       S1(9)         4     66
     O                       P1(9)               67
     O                       B1(9)         Z     78
     O                       TR(9)               80
     O          E            DEL2S            51
     O               62      G1(2)         4     21
     O              N62      G11(2)        Z     21
     O                       Y1(2)               11
     O                       S1(2)         4     30
     O                       P1(2)               31
     O                       B1(2)         Z     41
     O                       TR(2)               44
     O               70      G1(10)        4     58
     O              N70      G11(10)       Z     58
     O                       Y1(10)              47
     O                       S1(10)        4     66
     O                       P1(10)              67
     O                       B1(10)        Z     78
     O                       TR(10)              80
     O          E            DEL2S            52
     O               63      G1(3)         4     21
     O              N63      G11(3)        Z     21
     O                       Y1(3)               11
     O                       S1(3)         4     30
     O                       P1(3)               31
     O                       B1(3)         Z     41
     O                       TR(3)               44
     O               71      G1(11)        4     58
     O              N71      G11(11)       Z     58
     O                       Y1(11)              47
     O                       S1(11)        4     66
     O                       P1(11)              67
     O                       B1(11)        Z     78
     O                       TR(11)              80
     O          E            DEL2S            53
     O               64      G1(4)         4     21
     O              N64      G11(4)        Z     21
     O                       Y1(4)               11
     O                       S1(4)         4     30
     O                       P1(4)               31
     O                       B1(4)         Z     41
     O                       TR(4)               44
     O               72      G1(12)        4     58
     O              N72      G11(12)       Z     58
     O                       Y1(12)              47
     O                       S1(12)        4     66
     O                       P1(12)              67
     O                       B1(12)        Z     78
     O                       TR(12)              80
     O          E            DEL2S            54
     O               65      G1(5)         4     21
     O              N65      G11(5)        Z     21
     O                       Y1(5)               11
     O                       S1(5)         4     30
     O                       P1(5)               31
     O                       B1(5)         Z     41
     O                       TR(5)               44
     O               73      G1(13)        4     58
     O              N73      G11(13)       Z     58
     O                       Y1(13)              47
     O                       S1(13)        4     66
     O                       P1(13)              67
     O                       B1(13)        Z     78
     O                       TR(13)              80
     O          E            DEL2S            55
     O               66      G1(6)         4     21
     O              N66      G11(6)        Z     21
     O                       Y1(6)               11
     O                       S1(6)         4     30
     O                       P1(6)               31
     O                       B1(6)         Z     41
     O                       TR(6)               44
     O               74      G1(14)        4     58
     O              N74      G11(14)       Z     58
     O                       Y1(14)              47
     O                       S1(14)        4     66
     O                       P1(14)              67
     O                       B1(14)        Z     78
     O                       TR(14)              80
     O          E            DEL2S            56
     O               67      G1(7)         4     21
     O              N67      G11(7)        Z     21
     O                       Y1(7)               11
     O                       S1(7)         4     30
     O                       P1(7)               31
     O                       B1(7)         Z     41
     O                       TR(7)               44
     O               75      G1(15)        4     58
     O              N75      G11(15)       Z     58
     O                       Y1(15)              47
     O                       S1(15)        4     66
     O                       P1(15)              67
     O                       B1(15)        Z     78
     O                       TR(15)              80
     O          E            DEL2S            57
     O               68      G1(8)         4     21
     O              N68      G11(8)        Z     21
     O                       Y1(8)               11
     O                       S1(8)         4     30
     O                       P1(8)               31
     O                       B1(8)         Z     41
     O                       TR(8)               44
     O               76      G1(16)        4     58
     O              N76      G11(16)       Z     58
     O                       Y1(16)              47
     O                       S1(16)        4     66
     O                       P1(16)              67
     O                       B1(16)        Z     78
     O                       TR(16)              80
     O          E            DEL2S            60
     O               77      G1(17)        4     21
     O              N77      G11(17)       Z     21
     O                       Y1(17)              11
     O                       S1(17)        4     30
     O                       P1(17)              31
     O                       B1(17)        Z     41
     O                       TR(17)              44
     O               33      T1(1)               47
     O               33      T2(1)         Z     57
     O               33      T3(1)               60
     O          E            DEL2S            61
     O               78      G1(18)        4     21
     O              N78      G11(18)       Z     21
     O                       Y1(18)              11
     O                       S1(18)        4     30
     O                       P1(18)              31
     O                       B1(18)        Z     41
     O                       TR(18)              44
     O               33      T1(2)               47
     O               33      T2(2)         Z     57
     O               33      T3(2)               60
     O                                           63 '***'
     O          E            DEL2S            62
     O               79      G1(19)        4     21
     O              N79      G11(19)       Z     21
     O                       Y1(19)              11
     O                       S1(19)        4     30
     O                       P1(19)              31
     O                       B1(19)        Z     41
     O                       TR(19)              44
     O               33      T1(3)               47
     O               33      T2(3)         Z     57
     O               33      T3(3)               60
     O          E            DEL2S            63
     O               80      G1(20)        4     21
     O              N80      G11(20)       Z     21
     O                       Y1(20)              11
     O                       S1(20)        4     30
     O                       P1(20)              31
     O                       B1(20)        Z     41
     O                       TR(20)              44
     O               33      T1(4)               47
     O               33      T2(4)         Z     57
     O               33      T3(4)               60
     O          E            DEL2S            64
     O               81      G1(21)        4     21
     O              N81      G11(21)       Z     21
     O                       Y1(21)              11
     O                       S1(21)        4     30
     O                       P1(21)              31
     O                       B1(21)        Z     41
     O                       TR(21)              44
     O               33      T1(5)               47
     O               33      T2(5)         Z     57
     O               33      T3(5)               60
     O          E            DEL2S            65
     O               82      G1(22)        4     21
     O              N82      G11(22)       Z     21
     O                       Y1(22)              11
     O                       S1(22)        4     30
     O                       P1(22)              31
     O                       B1(22)        Z     41
     O                       TR(22)              44
     O               33      T1(6)               47
     O               33      T2(6)         Z     57
     O               33      T3(6)               60
     O          E            DEL2S            66
     O               83      G1(23)        4     21
     O              N83      G11(23)       Z     21
     O                       Y1(23)              11
     O                       S1(23)        4     30
     O                       P1(23)              31
     O                       B1(23)        Z     41
     O                       TR(23)              44
     O               33      T1(7)               47
     O               33      T2(7)         Z     57
     O               33      T3(7)               60
     O          E            DEL2S            67
     O               84      G1(24)        4     21
     O              N84      G11(24)       Z     21
     O                       Y1(24)              11
     O                       S1(24)        4     30
     O                       P1(24)              31
     O                       B1(24)        Z     41
     O                       TR(24)              44
     O               33      T1(8)               47
     O               33      T2(8)         Z     57
     O               33      T3(8)               60
     O          E            DEL2S            68
     O               33      SIBEL7        Z     57
     O*
     O          E            DEL2S            70
     O                       XPFM2               75
     O          E   N93 94   DEL2SX           50
     O               61      G1(1)         4     21
     O              N61      G11(1)        Z     21
     O                       Y1(1)               11
     O                       S1(1)         4     30
     O                       P1(1)               31
     O                       B1(1)         Z     41
     O                       TR(1)               44
     O          E   N93 94 33DEL2SX           60
     O                       T1(1)               47
     O                       T2(1)         Z     57
     O                       T3(1)               60
     O          E            DEL2SX           61
     O                                           63 '***'
     O          E   N93 94 33DEL2SX           68
     O                       SIBELT        Z     57
     O          E            DEL2SX           70
     O                       XPFM2               75
      *
      *** DEL-2 SUMMERINGSLINJE FOR FLERE ENN 8 AVGIFTKODER
     O          E            DEL2S1           01
     O                       XPFM1               75
     O          E            DEL2S1           02
S03  O*                                          28 'REF:     /       /   '
S03  O*                      SIAVD         Z     16
S03  O*                      SITDN         Z     24
S03  O*                      SISG                28
S03  O*              97                          43 '(       /   )'
S03  O*              97      SIOPD         Z     38
S03  O*              97      SIFRBN        Z     42
S03  O*                      FSSO15              60
N14  O                                           29 'REF:     /       /   '
S14  O*                                          27 '         /       /   '
N03  O                       SIAVD         Z     17
N03  O                       SITDN         Z     25
N03  O                       SISG                29
s08  O*              97                          41 '(       /   )'
s08  O*              97      SIOPD         Z     36
s08  O*              97      SIFRBN        Z     40
s08  O*                      FSSO15              57
n08  O                       FSSO25              55
     O               39   N37                    75 'LINJEDEKLARERT'
S14  O*             N39 29N37                    77 'LINJEDEKLARERT KOPI'
N14  O              N39 34N37                    77 'L.DEKLARERT KOPI'
     O               39    37                    75 'UTLEV.-ATTEST '
S14  O*             N39 29 37                    77 'UTLEV.-ATTEST  KOPI'
N14  O              N39 34 37                    78 'UTLEV-ATTEST KOPI'
     O          E            DEL2S1           03
     O                       SIRG                38
     O               89                          38 '******'
     O                       SIDTY               47
     O                       XDP1                50
     O                       SIDTG               68
     O          E            DEL2S1           04
     O                       SINAK               39
     O                       SITLL               68
     O          E            DEL2S1           05
     O                       SITLE               64
     O          E            DEL2S1           06
     O                                           54 '***'
     O          E            DEL2S1           11
     O                                           32 '**** IKKE BENYTTET ****'
     O          E            DEL2S1           25
     O                                           32 '**** IKKE BENYTTET ****'
     O          E            DEL2S1           39
     O                                           32 '**** IKKE BENYTTET ****'
     O          E            DEL2S1           60
     O                       T1(9)               47
     O                       T2(9)         Z     57
     O                       T3(9)               60
     O          E            DEL2S1           61
     O                       T1(10)              47
     O                       T2(10)        Z     57
     O                       T3(10)              60
     O                                           63 '***'
     O          E            DEL2S1           62
     O                       T1(11)              47
     O                       T2(11)        Z     57
     O                       T3(11)              60
     O          E            DEL2S1           63
     O                       T1(12)              47
     O                       T2(12)        Z     57
     O                       T3(12)              60
     O          E            DEL2S1           64
     O                       T1(13)              47
     O                       T2(13)        Z     57
     O                       T3(13)              60
     O          E            DEL2S1           65
     O                       T1(14)              47
     O                       T2(14)        Z     57
     O                       T3(14)              60
     O          E            DEL2S1           66
     O                       T1(15)              47
     O                       T2(15)        Z     57
     O                       T3(15)              60
     O          E            DEL2S1           67
     O                       T1(16)              47
     O                       T2(16)        Z     57
     O                       T3(16)              60
     O          E            DEL2S1           68
     O                       SIBEL7        Z     57
     O          E            DEL2S1           70
     O                       XPFM2               75
      *** '''''''''''' SLUTT DEL-2 (STANDARD FORMULAR)
      *
      *
     OSADVR     E            SADVLN
     O                       SVLN
     OSADV4R    E            SADVL4
     O                       SVLN
     O          EDEL         SADVD4
