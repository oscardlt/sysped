/*---------------------------------------------------------------------*/
/* Program: ADDBKP                                                     */
/* Title..: Add Breakpoint                                             */
/* From "A Better Debugger," NEWS 3x/400, January 1993                 */
/*                                                                     */
             PGM        PARM(&NEWBKP &RTNCDE)
             DCL        VAR(&NEWBKP)   TYPE(*CHAR)  LEN(10)
             DCL        VAR(&MSG)      TYPE(*CHAR)  LEN(80)
             DCL        VAR(&RTNCDE)   TYPE(*CHAR)  LEN(1)

             CHGVAR     VAR(&RTNCDE)   VALUE('0')         /* NO ERROR */

             ADDBKP     STMT(&NEWBKP)  BKPPGM(SRCDBGC02)

/* SEND ERROR MESSAGES TO THE CALLING RPG PROGRAM                      */

             MONMSG     MSGID(CPF0000) EXEC(DO)
               CHGVAR     VAR(&RTNCDE) VALUE('1')        /* ERROR OCCURED */
RCV:           RCVMSG     MSG(&MSG)
               IF         COND(&MSG *NE ' ') THEN(DO)
                 SNDPGMMSG  MSG(&MSG)
                 GOTO RCV
               ENDDO
             ENDDO
             RETURN
             ENDPGM
