********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 kaller fraktberegning
10XXX * 02 YBC PTF10 BÅTKODE=*ALL -> ENDELIG TRIP MED TRANSIT-LAYOUT
10XXX * 03 SH  PTF10 beregne kubikk på oppdrag
10027 * 04 YBC PTF10 ORDRETYPE
10XXX * 05 YBC PTF10 FRITEKST BESTEMMES AV KODE
10044 * 06 YBC PTF10 VALUTAKODE SENDES MED TIL ARKIV
10XXX * 07 YBC PTF10 KUN OPPDATER TRIP STATUS TIL 3 NÅR STATUS < 3
10172 * 08 SH  PTF10 norsk text til Track and trace
10172 * 09 SH  PTF10 høyde for utenlandsk adresse
10172 * 10 SH  PTF10 RETTELSE AFP PROBLEMATIKK FRONTMGN(0.1 0.25) -
10XXX * 11 YBC PTF10 OPPDATER LOGG
10172 * 12 SH  PTF10 OPPDATERE FRAKTVEKT
10172 * 13 SH  PTF10 sletter eventuelle gamle arkivdokumenter
10XXX * 14 YBC PTF10 OPPDATER ORDRETYPE
10217 * 15 YBC PTF10 FLERE DEFAULT PRINTER
10XXX * 16 YBC PTF10 VED CONTAINERSENDING SUMMERER VEKT HVER FOR SEG
10XXX * 17 SH  PTF10 omrokkeringer print
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 18 YBC PTF11 FEIL VALUTAKODE VED ARKIVERING
********************************************************************
     H DEBUG(*YES)
      *
      **************************************************************
      *** PROGRAM SKAL SKRIVE UT PROFORMAFAKTURA
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01-26
      *** LEDIGE INDIKATORER 30 31 41-49 52-99
      **************************************************************
      *
N03  FKODTV     IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E             DISK
     Ffirm      IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FGSSSTK    IF   E           K DISK
     FGSS035W   UF   E           K DISK    USROPN
     FGSS035W2  IF A E           K DISK    USROPN
     FGSSGDF    IF   E           K DISK
     FGSSBIF    IF   E           K DISK
     FGSSTWL02  UF   E           K DISK
     FBRIDF     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FHEADF     UF   E           K DISK
     FTURER     IF   E           K DISK
     FGSSBXF    IF   E           K DISK
     FFAXSEN    IF   E           K DISK
     FFAXMANP   O  A E           K DISK    USROPN
     FFAXMANT   UF A E           K DISK
     FTRACKF    O    E             DISK
     FGSSTRF    UF   E           K DISK
     FGSSOLF    UF   E           K DISK
     FGSSORL22  UF   E           K DISK
     FGSSORF    IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF00)
     FGSSORL21  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF21)
     FGSSORL24  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF24)
     FGSSORL25  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF25)
     FGSS031W   UF A E           K DISK    USROPN
     FGSSPOF    IF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FGSSSFF    IF   E           K DISK
     FGSSFGF    IF   E           K DISK
N11  FGSSLGF    O  A E             DISK
     FGSS031P   O    E             PRINTER OFLIND(*IN27)
     F                                     USROPN
     FGSS031PL  O    E             PRINTER OFLIND(*IN37)
     F                                     USROPN
     D TAB1            S              2  0 DIM(12) CTDATA PERRCD(1)
     D TAB2            S              7    DIM(12) ALT(TAB1)
     D                 DS
     D  ORFT1                  1     30
     D  ORFT2                 31     60
     D  ORFT3                 61     90
     D  ORFT4                 91    120
     D  FT                     1    120
     D                                     DIM(4)
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(GSS031P) OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(72 120) -
     D                                     CPI(15) -
     D                                     OVRFLW(59) -
     D                                     COPIES(')
     D XCMD30          C                   CONST('OVRPRTF -
     D                                     FILE(GSS031P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
E10  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(59) -
     D                                     DRAWER(3) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(QFAX/QFAXOUTQ) -
     D                                     FORMTYPE(*STD)')
      * email
     D XCMD30e         C                   CONST('OVRPRTF -
     D                                     FILE(GSS031P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     OVRFLW(59) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(OUTMAIL) -
     D                                     FORMTYPE(*STD)')
     D XCMD30B         C                   CONST('OVRPRTF -
     D                                     FILE(GSS031P) -
     D                                     DEVTYPE(*SCS) -
     D                                     PAGESIZE(70 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     OVRFLW(59) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(FAX/FAXOUT) -
     D                                     FORMTYPE(*STD)')
     D XCMD40          C                   CONST('OVRPRTF -
     D                                     FILE(GSS031P) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
E10  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(59) -
     D                                     DRAWER(3) -
     D                                     PRTTXT(')
     D XCMD41          C                   CONST('OUTQ(')
     D XCMD51          C                   CONST('OVRPRTF -
     D                                     FILE(GSS031PL) OUTQ(')
     D XCMD61          C                   CONST('PAGESIZE(50 115) -
     D                                     CPI(10) -
     D                                     OVRFLW(38) -
     D                                     COPIES(')
     D XCMD70          C                   CONST('OVRPRTF -
     D                                     FILE(GSS031PL) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(50 120) -
     D                                     LPI(6) -
     D                                     CPI(12) -
E10  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(38) -
     D                                     DRAWER(3) -
     D                                     PAGRTT(90) -
     D                                     OUTQ(QFAX/QFAXOUTQ) -
     D                                     FORMTYPE(*STD)')
      * email
     D XCMD70e         C                   CONST('OVRPRTF -
     D                                     FILE(GSS031PL) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*SCS) -
     D                                     PAGESIZE(50 120) -
     D                                     LPI(6) -
     D                                     CPI(12) -
     D                                     OVRFLW(38) -
     D                                     OUTQ(OUTMAIL) -
     D                                     FORMTYPE(*STD)')
     D XCMD70B         C                   CONST('OVRPRTF -
     D                                     FILE(GSS031PL) -
     D                                     DEVTYPE(*SCS) -
     D                                     PAGESIZE(50 120) -
     D                                     LPI(6) -
     D                                     CPI(12) -
     D                                     OVRFLW(38) -
     D                                     OUTQ(FAX/FAXOUT) -
     D                                     FORMTYPE(*STD)')
     D XCMD80          C                   CONST('OVRPRTF -
     D                                     FILE(GSS031PL) -
     D                                     PAGESIZE(50 120) -
     D                                     LPI(6) -
     D                                     CPI(12) -
E10  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(38) -
     D                                     PAGRTT(90) -
     D                                     DRAWER(3) -
     D                                     PRTTXT(')
     D XCMD81          C                   CONST('OUTQ(')
     D XCMD90          C                   CONST('CLRPFM FILE(GSS031W)-
     D                                      MBR(')
     D XXTXT01         C                   CONST('Printed manifest.')
     D XXTXT02         C                   CONST('Manifest No.')
N08  D XXTXT01L        C                   CONST('Skrevet manifest.')
N08  D XXTXT02L        C                   CONST('Manifest Nr.')
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  FAXNRP                 1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  WSFAXN                 1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     D                 DS
     D  HEGN                   1     15
     D  HEGN3                  5      7
     D  HEGN8                  8     15
     D                 DS
     D  ORSNM                  1     30
     D  XSNM                   1     24
     D                 DS
     D  TRDTL                  1      8  0
     D  TRDTLÅ                 1      4  0
     D  TRDTLM                 5      6  0
     D  TRDTLD                 7      8  0
     D                 DS
     D  XDTL                   1      6  0
     D  XDTLD                  1      2  0
     D  XDTLM                  3      4  0
     D  XDTLÅ                  5      6  0
     D                 DS
     D  TRDTS                  1      8  0
     D  TRDTSÅ                 1      4  0
     D  TRDTSM                 5      6  0
     D  TRDTSD                 7      8  0
     D                 DS
     D  XDTS                   1      6  0
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTSÅ                  5      6  0
     D                 DS
     D  ORDSC                  1     30
N17  D  XDSC                   1     25
     D                 DS
     D  POCONO                 1     20
     D  XCONO                  1     12
     D  XCONO2                 1     20
     D                 DS
     D  TRTNO                  1     11  0
     D  TAVD                   1      4  0
     D  TOPD                   5     11  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  XTIME                  1     14  0
     D  XDAG                   7      8  0
     D  XMND                   9     10  0
     D  XAAR                  11     14  0
     D                 DS
     D  XDDP                   1      2
     D  XMMP                   3      9
     D  XÅÅP                  10     11
     D  XIDAGP                 1     11
     D                 DS
     D  OLMN                   1     35
     D  OLMN01                 1      1
     D  OLMN02                 1      2
     D  OLMN03                 3      4
     D  OLMN04                 5     35
     D                SDS
     D  UJOBNM               244    253
     D  UUSER                254    263
S06  D*               UDS
N06  D SAVUDS         UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UBIUSI               101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
N15  D  UBIPRP               149    158
N15  D  UBIPRI               159    168
     D  UFT1                 201    270
     D  UFT2                 271    340
     D  UWCNAM               544    573
     D  UWFAXN               574    588
     D  UWRET                591    596
     D  UWTIME               598    603  0
     D  UWDATE               606    611  0
     D  UCOVP                612    612
     D  UCOV01               613    652
     D  UCOV02               653    692
     D  UCOV03               693    732
     D  UCOV04               733    772
     D  UCOV05               773    812
     D  UCOV06               813    852
     D  UCOV07               853    892
     D  UCOV08               893    932
     D  UEMAIL               933   1002
     D  Uemailj             1003   1003
      *
     C     nykopi        tag
     C                   EXSR      INIT
      *
     C     UTNO          CHAIN     GSSTRF                             33
      * BÅTKODE = BLANK ELLER FRA/TIL LOKASJON <> BLANK ---> TRANSITT
     C  N33TRBCD         COMP      *BLANKS                                40
N02  C  N33
N02  CANN40TRBCD         COMP      '*ALL'                                 40
     C  N33
     CANN40TRLOCT        COMP      *BLANKS                            4040
     C                   IF        *IN40
     C     UTNO          CHAIN(N)  GSSTWL02                           33
     C  N33TWTYP         COMP      'W'                                4040
     C                   MOVE      *OFF          *IN33
     C                   END
      *
     C  N33UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
     C     UTYPE         OREQ      'PRL'
     C     UTYPE         OREQ      'CPL'
      *
     C     UCOMM         IFEQ      'Y'
      * HENT NAVN/ADRESSE TIL FAKTURAAVSENDER
      * HVIS BRUKER IKKE OPPGIR FAKT.AVSENDER, BRUKES AVDELINGSKUNDENR.
     C     UKNC          IFEQ      *ZEROS
     C                   MOVEL     TRTNO         KOAAVD
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        XXKNC             8 0
     C                   ELSE
     C                   MOVE      UKNC          XXKNC
     C                   END
     C     CUN1CK        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         XXNA
     C                   MOVE      ADR1          XXAD1
     C                   MOVE      ADR2          XXAD2
     C     POSTNR        IFEQ      0
N09  C                   EVAL      XXAD3=SYPOGE
s09  C*                  MOVEL     ADR3          XXAD3
n09  C     XXAD3         CAT       ADR3:2        XXAD3
     C                   ELSE
     C                   MOVEL     POSTNR        XXAD3
s09  C*                  MOVE      ADR3          XXAD3
n09  C     XXAD3         CAT       ADR3:1        XXAD3
     C                   END
     C                   MOVE      TLF           XXTLF
     C                   MOVE      TFAXNR        XXFAX
     C                   END
      *
     C     *IN50         IFEQ      '0'
     C                   OPEN      GSS035W
     C     TRTNO         CHAIN     GSS035W                            38
     C   38              CLOSE     GSS035W
     C  N38              OPEN      GSS035W2
     C  N38              MOVE      TRTNO         W32TNO
     C                   END
      *
     C                   IF        ((XCONT = 'AV') OR (XCONT = 'CT'))
N07  C                   IF        TRST < '3'
     C  N50              MOVE      '3'           TRST
N07  C                   END
     C  N50              MOVE      XIDAG         TRDTI
     C                   END
     c     *in51         ifeq      '0'
     C                   UPDATE    GSSTRFR
     C                   end
     C                   MOVE      *BLANKS       XBCD             30
      *
     C   50              EXSR      LESORD
      *
     C                   IF        UPRT = 'WEB'
     C                   ELSE
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
      *
      * INGEN OVERRIDE VED ARKIVLØSNING (SKJER DA I CL)
      *
     C     UUTFAX        IFne      'A'                                           2<-B
      *---------------------------------------------------------------
      * START  ved FAX / EMAIL
      *---------------------------------------------------------------
     C     UUTFAX        IFEQ      'J'                                           2<-B
     C     FAXLIB        IFEQ      *BLANKS                                        3<-B
     c     uemail        orne      *blanks
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     c     uemail        ifeq      *blanks
     C     FAXSYS        IFEQ      'B'
      *FAX400
     C                   MOVEL     XCMD30B       UCMD
     C                   ELSE
      *FAXIMILE
     C                   MOVEL     XCMD30        UCMD
     C                   END
     c                   else
      *EMAIL
     C                   MOVEL     XCMD30e       UCMD
     c                   end
     C                   ELSE                                                      4
     c     uemail        ifeq      *blanks
     C     FAXSYS        IFEQ      'B'
      *FAX400
     C                   MOVEL     XCMD70B       UCMD
     C                   ELSE
      *FAXIMILE
     C                   MOVEL     XCMD70        UCMD
     C                   END
     c                   else
      *EMAIL
     C                   MOVEL     XCMD70e       UCMD
     c                   end
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     C     XCMD40        CAT       '.FAX':1      UCMD
     C                   CAT       WSFAXN:0      UCMD
     C                   CAT       ')':1         UCMD
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       FAXLIB:0      UCMD
     C                   CAT       '/':0         UCMD
     C                   CAT       FAXUTK:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   ELSE                                                      4
     C     XCMD80        CAT       '.FAX':1      UCMD
     C                   CAT       WSFAXN:0      UCMD
     C                   CAT       ')':1         UCMD
     C                   CAT       XCMD81:0      UCMD
     C                   CAT       FAXLIB:0      UCMD
     C                   CAT       '/':0         UCMD
     C                   CAT       FAXUTK:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
      *---------------------------------------------------------------
      * IKKE FAX  (ULIK J) ALSÅ PRINT
      *---------------------------------------------------------------
     C                   ELSE                                                    2
     C     UTYPE         IFEQ      'PRT'                                          3<-B
     C     UTYPE         OREQ      'CPY'
      * pdf
     C     STRF02        IFEQ      '*PDF '
     C                   eval      UCMD = 'OVRPRTF FILE'+
     c                             '(GSS031P) DEV(FAX3812) ' +
     c                             'DEVTYPE(*AFPDS) ' +
     c                             'PAGESIZE(72 125) ' +
     c                             'LPI(6) CPI(15) ' +
     c                             'OVRFLW(59) ' +
     c                             'PAGRTT(0) ' +
     c                             'OUTQ('+
     c                             %trim(UPRT) + ')' +
     c                             ' FORMTYPE(*STD)' +
     c                             ' FRONTOVL(' +
     c                             'LOGOFAKT' +
     c                             ')' +
E10  c                             ' FRONTMGN(0.1 0.25)'
     C                   ELSE
     C     XCMD11        CAT       UPRT:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       UCPY:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   END
     C                   ELSE                                                     3
     C     STRF02        IFEQ      '*PDF '
     C                   eval      UCMD = 'OVRPRTF FILE'+
     c                             '(GSS031PL) DEV(FAX3812) ' +
     c                             'DEVTYPE(*AFPDS) ' +
     c                             'PAGESIZE(50 120) ' +
     c                             'LPI(6) CPI(12) ' +
     c                             'OVRFLW(38) ' +
     c                             'PAGRTT(0) ' +
     c                             'OUTQ('+
     c                             %trim(UPRT) + ')' +
     c                             ' FORMTYPE(*STD)' +
     c                             ')' +
E10  c                             ' FRONTMGN(0.1 0.25)'
     C                   ELSE
     C     XCMD51        CAT       UPRT:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD61:1      UCMD
     C                   CAT       UCPY:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   END
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     c                   end
     C                   END
      *
     C     UTYPE         IFEQ      'PRT'                                         2<-B
     C     UTYPE         OREQ      'CPY'
     C                   OPEN      GSS031P
     c     ucpy          ifgt      '1'
     c     stresc        andeq     '¤    '
     c                   write     gss031co
     c                   end
     C                   ELSE                                                    2
     C                   OPEN      GSS031PL
     c     ucpy          ifgt      '1'
     c     stresc        andeq     '¤    '
     c                   write     gss031c2
     c                   end
     C                   END                                                     2<-E
      *
     C                   EXSR      PRTHD
      *
     C     *IN50         IFEQ      '0'                                           2<-B
     C     UTNO          SETLL     GSSORL22                           33
     C                   ELSE                                                    2
     C     *LOVAL        SETLL     GSS031W                            33
     C                   END                                                     2<-E
     C     STPRT         TAG
     C     *IN50         IFEQ      '0'                                           2<-B
     C     UTNO          READE     GSSORL22                               33
     C                   ELSE                                                    2
     C                   READ(N)   GSS031W                                33
     C                   END                                                     2<-E
N04   *
N04  C  N33              IF        UORDTYP <> ' '                                2<-B
N04  C                   IF        UORDTYP <> 'C' OR ORTYPE <> ' '                3<-B
N04  C     ORTYPE        CABNE     UORDTYP       STPRT
N04  C                   END                                                      3<-E
N04  C                   END                                                     2<-E
      *
     C     *IN33         IFEQ      '1'                                           2<-B
     C                   EXSR      PRTBUN
     C     *IN50         IFEQ      '1'                                            3<-B
     C                   CLOSE     GSS031W
     C                   CLOSE     GSSORF
     C                   CLOSE     GSSORL21
     C                   CLOSE     GSSORL24
     C                   CLOSE     GSSORL25
     C                   END                                                      3<-E
     C                   ELSE                                                    2
      *
     C                   IF        (((XCONT <> *BLANKS) AND
     C                               (XCONT <> 'AV')) AND
     C                               (XCONT <> 'CT'))
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE(N)  GSSOLF                                 34
     C  N34XCONT         CABNE     OLMN02        STPRT
     C                   END
N11   *
N11  C                   IF        *IN50 = *OFF AND *IN51 = *OFF
N11  C                   EVAL      LGFTYP = 'PRTPI'
N11  C                   EVAL      LGTXT  = 'Print proforma invoice.'
N11  C                   EVAL      LGAGM  = 'Status from ' + %TRIM(ORST)
N11  C                   EVAL      LGANY  = 'Status to 3'
N11  C                   EXSR      OPDLOG
N11  C                   END
      *
     C  N50              MOVE      '3'           ORST
     c     *in51         ifeq      '0'
     C  N50              UPDATE    GSSORFR
     C                   end
      *
     C     ORSNO         CHAIN     GSSSFF                             34
     C  N34              MOVE      SFNM          ORSNM
      *
     C     ORCLNF        IFGT      XCLNT                                          3<-B
     C                   EXSR      CALVK1
     C                   ELSE                                                     3
     C     ORCLNT        IFNE      0                                               4<-B
     C     ORCLNT        ANDGT     XCLNT
     C                   EXSR      CALVK2
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C                   ADD       ORWT          XVKTOT
     C                   ADD       ORWT          XVKTD
     C     ORCURC        IFEQ      UCUR                                           3<-B
     C                   ADD       ORAMT         XBLTOT
     C                   ADD       ORAMT         XBLTD
     C                   ELSE                                                     3
     C     VAL11K        CHAIN     VALUL01                            34
     C     ORAMT         MULT(H)   VALKU1        XWORK            15 4
     C                   DIV(H)    OMRFAK        XWORK
S18  C*    UCURR         IFNE      UCUR                                            4<-B
N18  C                   IF        UCUR <> FICURR                                  4<-B
     C     VAL12K        CHAIN     VALUL01                            34
     C                   MULT      OMRFAK        XWORK
     C                   DIV(H)    VALKU1        XWORK
     C                   END                                                       4<-E
     C                   ADD(H)    XWORK         XBLTOT
     C                   ADD(H)    XWORK         XBLTD
     C                   END                                                      3<-E
     C                   ADD       ORCLI         XCLTD
      *
     C     ORONO         SETLL     GSSPOF                             34
     C     ORONO         READE     GSSPOF                                 34
     C   34              MOVE      *BLANKS       POCONO
     C                   MOVE      XCLNF         XCLNF2            3 0
     C                   MOVE      XCLNT         XCLNT2            3 0
     C     ORCLNF        IFNE      XCLNF
     C     ORCLNF        ANDNE     0
     C                   MOVE      ORCLNF        XCLNF
     C                   END
     C     ORCLNT        IFNE      XCLNT
     C     ORCLNT        IFEQ      0
     C                   MOVE      ORCLNF        XCLNT
     C                   ELSE
     C                   MOVE      ORCLNT        XCLNT
     C                   END
     C                   END
      *
      * HENT KOLLINR
     C                   IF        XCLNF = 0                                       4<-B
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE(N)  GSSOLF                                 32
     C                   DOW       *IN32 = *OFF                                     5<-B
     C                   IF        ((XCLNF > OLBOX) OR (XCLNF = 0))                  6<-B
     C                   MOVE      OLBOX         XCLNF
     C                   END                                                         6<-E
     C                   IF        ((XCLNT < OLBOX) OR (XCLNT = 0))                  6<-B
     C                   MOVE      OLBOX         XCLNT
     C                   END                                                         6<-E
     C     ORONO         READE(N)  GSSOLF                                 32
     C                   ENDDO                                                      5<-E
     C                   END                                                       4<-E
      *
     C     XCLNF         COMP      XCLNT                                  32
     C     *IN40         IFEQ      '1'                                            3<-B
     C     ORBCD         ANDNE     XBCD
     C     ORBCD         CHAIN     CDBOAT                             34
     C   34              MOVE      *BLANKS       CBNAB
     C   34              MOVEL     '*UNKNOW'     CBNAB
     C   27
     COR 37              EXSR      NYSIDE
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031P8
     C                   ELSE                                                      4
     C                   WRITE     GSS031L8
     C                   END                                                       4<-E
     C                   MOVE      ORBCD         XBCD
     C                   END                                                      3<-E
      *
     C   27
     COR 37              EXSR      NYSIDE
     C     *IN39         IFEQ      '1'
     C     XCLNF         COMP      0                                      39
     C   39XCLNT         COMP      0                                      39
     C                   END
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031P2
     C                   ELSE                                                      4
     C                   WRITE     GSS031L2
     C                   END                                                       4<-E
      *
     C                   IF        XCONT = 'CT'
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE(N)  GSSOLF                                 34
     C                   WRITE     GSS031PB
     C                   END
      *
     C                   MOVE      XCLNF2        XCLNF
     C                   MOVE      XCLNT2        XCLNT
     C     *IN38         IFEQ      '0'                                             4<-B
     C     *IN50         ANDEQ     '0'
     C     XCLNF         ANDNE     0
     C     XCLNT         IFEQ      0                                                5<-B
     C                   MOVE      XCLNF         XCLNT
     C                   END                                                        5<-E
     C     XCLNF         DO        XCLNT         W32CLN                             5<-B
     C     GW352K        CHAIN     GSS035W2                           35
     C   35              WRITE     GSS35WR2
     C                   ENDDO                                                      5<-E
     C                   END                                                       4<-E
      *
     C     ORONO         SETLL     GSSGDF
     C     ORONO         READE     GSSGDF                                 35
     C  N34ORONO         READE     GSSPOF                                 34
     C     *IN34         DOWEQ     '0'                                            3<-B
     C   35              MOVE      *BLANKS       GDDSC
     C   27
     COR 37              EXSR      NYSIDE
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031P3
     C                   ELSE                                                      4
     C                   WRITE     GSS031L3
     C                   END                                                       4<-E
     C  N35ORONO         READE     GSSGDF                                 35
     C  N34ORONO         READE     GSSPOF                                 34
     C  N34              END                                                      3<-E
      *
     C     *IN35         DOWEQ     '0'                                            3<-B
     C   27
     COR 37              EXSR      NYSIDE
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031P9
     C                   ELSE                                                      4
     C                   WRITE     GSS031L9
     C                   END                                                       4<-E
     C     ORONO         READE     GSSGDF                                 35
     C  N35              END                                                      3<-E
      *
     C     ORKDL1        IFEQ      'PI'
     C     ORKDL2        OREQ      'PI'
     C     ORKDL3        OREQ      'PI'
     C     1             DO        4             XN                1 0
     C     FT(XN)        IFNE      *BLANKS
     C                   MOVE      FT(XN)        XXFT
     C   27
     COR 37              EXSR      NYSIDE
     C     UTYPE         IFEQ      'PRT'                                           4<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031PA
     C                   ELSE                                                      4
     C                   WRITE     GSS031LA
     C                   ENDIF                                                     4<-E
     C                   ENDIF
     C                   ENDDO
     C                   ENDIF
      *
      *
     C                   GOTO      STPRT
     C                   END                                                     2<-E
      *
     C                   EXSR      OPDLOGG
     c     UTYPE         ifeq      'PRT'
     C     UUTFAX        ANDNE     'A'
     C     UPRT          ANDNE     'WEB'
     c     arkiver       andne     'J'
     c                   exsr      arkivsr
     c                   end
      *
     C     UTYPE         IFEQ      'PRT'                                         2<-B
     C     UTYPE         OREQ      'CPY'
     C                   CLOSE     GSS031P
     C                   ELSE                                                    2
     C                   CLOSE     GSS031PL
     C                   END                                                     2<-E
      *
     C     UUTFAX        IFEQ      'J'                                           2<-B
     C                   EXSR      SNDFAX
     C                   END                                                     2<-E
      *
     C                   ELSE                                                   1
      *
     C                   IF        *IN40
     C     UTNO          SETLL     GSSORL22                           33
     C     UTNO          READE(N)  GSSORL22                               33
     C  N33ORONO         SETLL     GSSOLF
     C  N33ORONO         READE(N)  GSSOLF                                 33
     C  N33              IF        OLST <> ' '
     C                   MOVE      'ERR'         UTYPE
     C                   GOTO      SLCFM
     C                   END
     C                   END
      *
N02  C                   IF        TRBCD = '*ALL'
N02  C                   MOVE      '4'           TRST
N02  C                   ELSE
     C  N40              MOVE      '4'           TRST
     C   40              MOVE      '6'           TRST
N02  C                   END
     c     *in51         ifeq      '0'
     C                   UPDATE    GSSTRFR
     C     TRTNO         CHAIN     GSSTWL02                           33
     C  N33              MOVE      TRST          TWST
     C  N33              UPDATE    GSSTWFR
     c                   end
     C  N40              MOVE      'CF4'         UTYPE
     C   40              MOVE      'CF6'         UTYPE
N01  C   40              EXSR      BERFAK
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      *BLANKS       FGFA11
     C                   MOVE      *BLANKS       FGFA12
     C                   MOVE      *ZEROS        FGFLP1
     C                   MOVE      *BLANKS       FGFA21
     C                   MOVE      *BLANKS       FGFA22
     C                   MOVE      *ZEROS        FGFLP2
     C     UTNO          SETLL     GSSORL22                           33
     C     STCFM         TAG
     C     UTNO          READE     GSSORL22                               33
     C  N33              DO                                                      2<-B
N11   *
N11  C                   IF        *IN51 = *OFF
N11  C                   EVAL      LGFTYP = 'CFMPI'
N11  C                   EVAL      LGTXT  = 'Confirm proforma invoice.'
N11  C                   EVAL      LGAGM  = 'Status from ' + %TRIM(ORST)
N11  C                   IF        *IN40 AND TRBCD <> '*ALL'
N11  C                   EVAL      LGANY  = 'Status to 0'
N11  C                   ELSE
N11  C                   EVAL      LGANY  = 'Status to 4'
N11  C                   END
N11  C                   EXSR      OPDLOG
N11  C                   END
N11   *
     C                   IF        FGFA11 = *BLANKS
     C     ORONO         CHAIN     GSSFGF                             33
     C                   END
     C     *IN40         IFEQ      '1'                                            3<-B
N02  C     TRBCD         ANDNE     '*ALL'
     C                   MOVE      ORTNO2        ORTNO3
     C                   MOVE      ORTNO         ORTNO2
     C                   MOVE      *ZEROS        ORTNO
     C                   MOVE      TRLOCT        ORLC
     C                   MOVE      '0'           ORST
     C                   MOVE      UPOS1         ORPOS1
     C                   MOVE      UPOS2         ORPOS2
     C                   MOVE      UPOS3         ORPOS3
N14  C     ORLC          IFEQ      'RTM'
N14  C                   MOVE      UORDTYP       ORTYPE
N14  C                   END
     C                   ELSE
     C                   MOVE      '4'           ORST
     C                   CALL      'GSS032R'
     C                   PARM                    UTNO
     C                   PARM                    ORONO
     C                   END                                                      3<-E
     c     *in51         ifeq      '0'
     C                   UPDATE    GSSORFR
     c                   end
     C                   IF        *IN40
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE     GSSOLF                                 33
     C                   DOW       *IN33 = *OFF
     C                   MOVE      ' '           OLST
     c     *in51         ifeq      '0'
     C                   UPDATE    GSSOLFR
     c                   end
     C     ORONO         READE     GSSOLF                                 33
     C                   ENDDO
     C                   END
     C                   GOTO      STCFM
     C                   END                                                     2<-E
     C                   IF        FGFA11 <> *BLANKS
     C                   MOVE      FGFA11        TRFA11
     C                   MOVE      FGFA12        TRFA12
     C                   MOVE      FGFLP1        TRFLP1
     C                   MOVE      FGFA21        TRFA21
     C                   MOVE      FGFA22        TRFA22
     C                   MOVE      FGFLP2        TRFLP2
     C                   END
     c     *in51         ifeq      '0'
     C     UTNO          CHAIN(N)  GSSTWL02                           33
     C  N33              IF        TWWT <> 0
     C                   EVAL(H)   HEVKT = TWWT + 0,4
N12  C                   EVAL      HEFBV = HEVKT
     C                   END
     C  N33              IF        TWM3 <> 0
     C                   EVAL      HEM3  = TWM3
N03  C                   EXSR      FINNVK
     C                   END
     C                   UPDATE    HEADFR
     c                   end
      *
     C     SLCFM         TAG
     C                   END                                                    1<-E
      *
     C     SLUTT         TAG
     c                   sub       1             ucpyn
     c                   move      ucpyn         ucpy
     c     ucpyn         ifgt      0
     C                   MOVE      ZTNO2         UTNO2
     C                   MOVE      ZTYPE         UTYPE
     C                   MOVE      ZPRT          UPRT
     C                   MOVE      ZCUR          UCUR
     C                   MOVE      ZUTFAX        UUTFAX
     C                   MOVE      ZCOMM         UCOMM
     C                   MOVE      ZKNC          UKNC
     C                   MOVE      ZQJOB         UQJOB
     C                   MOVE      ZQUSER        UQUSER
     C                   MOVE      ZQNBR         UQNBR
     C                   MOVE      ZPOS1         UPOS1
     C                   MOVE      ZPOS2         UPOS2
     C                   MOVE      ZPOS3         UPOS3
     C                   MOVE      *ZEROS        XCLNF
     C                   MOVE      *ZEROS        XCLNT
     c                   goto      nykopi
     c                   end
     c     arkiver       ifeq      'J'
S04  C*                  call      'ARC002CLB'
N06  C                   MOVE      UCURR         XXCURR            3
N06  C                   MOVE      UCUR          UCURR
N06  C                   OUT       SAVUDS
N04  C                   CALL      'ARC002CLC'
     c                   parm                    artype
     c                   parm                    aruser
N04  c                   PARM                    UORDTYP
N06  C                   MOVE      XXCURR        UCURR
N06  C                   OUT       SAVUDS
     c                   end
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *================================================
     C     PRTHD         BEGSR
      *================================================
     C                   MOVE      TRDTLÅ        XDTLÅ
     C                   MOVE      TRDTLM        XDTLM
     C                   MOVE      TRDTLD        XDTLD
     C                   MOVE      TRDTSÅ        XDTSÅ
     C                   MOVE      TRDTSM        XDTSM
     C                   MOVE      TRDTSD        XDTSD
      * HENTE FIRMAOPPLYSNINGER
     C     TRFC          CHAIN     GSSFIF                             34
      * HENTE OPPDRAG
     C     HEADFK        CHAIN(N)  HEADF                              34
     C                   MOVEL     HEHAWB        XHAWB
     C     XHAWB         IFEQ      *BLANKS
     C     TURERK        CHAIN     TURER                              34
     C  N34              MOVEL     TUBILN        XHAWB
     C                   END
      * HENTE FRA STEDSNAVN
     C     HESDF         CHAIN     STED2                              34
     C                   MOVEL     ST2NVN        XSTDF
      * HENTE TIL STEDSNAVN
     C     HESDT         CHAIN     STED2                              34
     C                   MOVEL     ST2NVN        XSTDT
      * HENTE SIGNANTUR
     C                   IF        UPRT = 'WEB'
     C     TWUSR         CHAIN     BRIDF                              34
     C                   EVAL      KOSFNV = BIBESK
     C                   ELSE
     C     KODSFK        CHAIN     KODTSF                             34
     C                   END
      * HENTE KUNDENAVN
     C     CUND1K        CHAIN     CUNDL01                            34
     C   34              DO
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *ZEROS        POSTNR
     C                   MOVE      *BLANKS       ADR3
     C                   END
      * HENTE BÅTNAVN
     C     TRBCD         CHAIN     CDBOAT                             34
     C   34              MOVE      *BLANKS       CBNAB
      *
     C                   Z-ADD     1             XSIDE
     C     UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
     C     UCOMM         IFEQ      'N'
     C                   WRITE     GSS031P1
     C                   ELSE
     C                   WRITE     GSS031PÆ
     C                   WRITE     GSS031PØ
     C                   END
     C                   WRITE     GSS031PX
     C   77              WRITE     GSS031PXP
     C                   ELSE                                                   1
     C     UCOMM         IFEQ      'N'
     C                   WRITE     GSS031L1
     C                   ELSE
     C                   WRITE     GSS031LÆ
     C                   WRITE     GSS031LØ
     C                   END
     C                   END                                                    1<-E
     C                   MOVE      '0'           *IN27
     C                   MOVE      '0'           *IN37
      *
     C                   MOVE      *ZEROS        XVKTOT
     C                   MOVE      *ZEROS        XCLTOT
     C                   MOVE      *ZEROS        XBLTOT
      *
     C                   ENDSR
      *
      *================================================
     C     PRTBUN        BEGSR
      *================================================
     C   27
     COR 37              EXSR      NYSIDE
     C     *IN39         IFEQ      '0'
     C                   IF        ((XCONT = *BLANKS) OR (XCONT = 'AV'))
     C     UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031P4
     C                   ELSE                                                   1
     C                   WRITE     GSS031L4
     C                   END                                                    1<-E
     C                   END
     C                   END
      *
     C     HEADFK        CHAIN     HEADF                              34
     C  N34              DO
     C     XVKTOT        ADD       0.5           HEVKT
     C     XCLTOT        IFNE      0
     C                   Z-ADD     XCLTOT        HENT
     C                   END
     C                   EXSR      BOX
     C     UTNO          CHAIN(N)  GSSTWL02                           33
     C  N33              IF        TWWT <> 0
     C                   EVAL(H)   HEVKT = TWWT + 0,4
N12  C                   EVAL      HEFBV = HEVKT
     C                   END
     C  N33              IF        TWM3 <> 0
     C                   EVAL      HEM3  = TWM3
N03  C                   EXSR      FINNVK
     C                   END
     C                   EXCEPT    UPDHEA
     C                   END
     C   27
     COR 37              EXSR      NYSIDE
N05  C                   IF        TRKDL1 = 'PI' OR
N05  C                             TRKDL2 = 'PI' OR
N05  C                             TRKDL3 = 'PI'
N05  C                   EVAL      XTRFT1 = TRFT1
N05  C                   ELSE
N05  C                   EVAL      XTRFT1 = *BLANKS
N05  C                   END
     C     UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
N09  C     POSTNR        IFEQ      0
N09  C                   EVAL      ADR3NY=SYPOGE
n09  C     ADR3NY        CAT       ADR3:2        ADR3NY
n09  C                   ELSE
n09  C                   MOVEL     POSTNR        ADR3NY
n09  C     ADR3NY        CAT       ADR3:1        ADR3NY
n09  C                   END
     C                   WRITE     GSS031P5
     C   77              WRITE     GSS031P5P
     C                   ELSE                                                   1
     C                   WRITE     GSS031L5
     C                   END                                                    1<-E
      *
     C     *IN50         IFEQ      '0'
     C     *IN38         ANDEQ     '0'
     C                   CLOSE     GSS035W2
     C     TRTNO         CHAIN     GSS035W                            34
     C     *IN34         IFEQ      '0'
     C                   MOVE      CBNAB         W3NAB
     C                   MOVE      TRAD1         W3AD1
     C                   MOVE      TRAD2         W3AD2
     C                   MOVE      TRAD3         W3AD3
     C                   MOVE      TRAD4         W3AD4
     C                   MOVE      TRAD5         W3AD5
     C                   MOVE      TRAD6         W3AD6
     C                   MOVE      TRFC          W3FC
     C                   MOVE      XDTL          W3DTL
     C                   MOVE      XCLTOT        W3CLT
     C                   MOVE      XVKTOT        W3VKT
     C                   MOVE      HESDT         W3SDT
     C                   UPDATE    GSS035WR
     C                   CLOSE     GSS035W
     C                   CALL      'GSS035R'
     C                   PARM                    UTNO2
     C                   ELSE
     C                   CLOSE     GSS035W
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      *
      *================================================
     C     BOX           BEGSR
      *================================================
N16  C     'CONTAINER:'  SCAN      TRMFT2                                 33
N16  C   33              MOVE      'J'           XCONTSND          1
N16  C  N33              MOVE      'N'           XCONTSND
     C                   MOVE      *ZEROS        ZNT               3 0
     C                   MOVE      *ZEROS        ZVKT
     C                   MOVE      *ZEROS        ZM3
     C     UTNO          SETLL     GSSBXF
     C     UTNO          READE     GSSBXF                                 33
     C     *IN33         DOWEQ     '0'
N16  C                   IF        XCONTSND = 'J'
N16  C                   IF        BXCN <> *BLANKS
N16  C                   Z-ADD     18            XPOS              3 0
N16  C                   DO        17
N16  C                   SUB       1             XPOS
N16  C                   IF        %SUBST(BXCN:XPOS:1) <> ' '
N16  C                   LEAVE
N16  C                   END
N16  C                   ENDDO
N16  C     BXCN:XPOS     SCAN      TRMFT2                                 33
N16  C                   END
N16  C                   ELSE
N16  C                   EVAL      *IN33 = *ON
N16  C                   END
N16  C                   IF        *IN33
     C                   ADD       1             ZNT
     C                   ADD       BXVKT         ZVKT              7 1
     C                   ADD       BXM3          ZM3               6 3
N16  C                   END
     C     UTNO          READE     GSSBXF                                 33
     C                   ENDDO
      *
     C     ZNT           IFGT      *ZEROS
     C                   Z-ADD     ZNT           HENT
     C                   Z-ADD(H)  ZVKT          HEVKT
     C                   Z-ADD     ZM3           HEM3
N04  C                   IF        UORDTYP = ' '
     C                   Z-ADD     ZNT           XCLTOT
     C                   Z-ADD     ZVKT          XVKTOT
N04  C                   END
     C                   END
     C                   ENDSR
      *
      *================================================
     C     CALVK1        BEGSR
      *================================================
     C     XCLNF         IFNE      0
     C   27
     COR 37              EXSR      NYSIDE
     C     *IN39         IFEQ      '0'
     C                   IF        ((XCONT = *BLANKS) OR (XCONT = 'AV'))
     C     UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
     C                   WRITE     GSS031P4
     C                   ELSE                                                   1
     C                   WRITE     GSS031L4
     C                   END                                                    1<-E
     C                   END
     C                   END
     C                   MOVE      *ZEROS        XCLTD
     C                   MOVE      *ZEROS        XVKTD
     C                   MOVE      *ZEROS        XBLTD
     C                   END
      *
     C                   MOVE      ORCLNF        XCLNF
     C     ORCLNT        IFEQ      0
     C                   MOVE      ORCLNF        XCLNT
     C                   ELSE
     C                   MOVE      ORCLNT        XCLNT
     C                   END
     C     XCLNT         SUB       XCLNF         XCLI
     C                   ADD       1             XCLI
     C                   ADD       XCLI          XCLTOT
      *
     C                   ENDSR
      *
      *================================================
     C     CALVK2        BEGSR
      *================================================
     C     ORCLNT        SUB       XCLNT         XCLI
     C                   MOVE      ORCLNT        XCLNT
     C                   ADD       XCLI          XCLTOT
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYSIDE        BEGSR
     C***********************************************
     C     UTYPES2       IFEQ      'PRT'                                        1<-B
     C     UTYPES2       OREQ      'CPY'
     C                   WRITE     GSS031P6
     C                   ADD       1             XSIDE
     C     UCOMM         IFEQ      'N'
     C                   WRITE     GSS031P1
     C                   ELSE
     C                   WRITE     GSS031PÆ
     C                   WRITE     GSS031PØ
     C                   END
     C                   WRITE     GSS031PX
     C   77              WRITE     GSS031PXP
     C                   WRITE     GSS031P7
     C                   MOVE      '0'           *IN27
     C                   ELSE                                                   1
     C                   WRITE     GSS031L6
     C                   ADD       1             XSIDE
     C     UCOMM         IFEQ      'N'
     C                   WRITE     GSS031L1
     C                   ELSE
     C                   WRITE     GSS031LÆ
     C                   WRITE     GSS031LØ
     C                   END
     C                   WRITE     GSS031L7
     C                   MOVE      '0'           *IN37
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C                   move      *zeros        XCLTD
     C                   move      *zeros        XVKTD
     C                   move      *zeros        XBLTD
     C                   move      *zeros        XVKTOT
     C                   move      *zeros        XCLTOT
     C                   move      *zeros        XBLTOT
     C     KODVAK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    ORCURC
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    KOAAVD
     C                   MOVE      'A'           KOAUNI
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    TRCNO
     C     CUN1CK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    XXKNC
     C     HEADFK        KLIST
     C                   KFLD                    TAVD
     C                   KFLD                    TOPD
     C     TURERK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEPRO
     C     KODSFK        KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    HESG
     C     VAL11K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    ORCURC
     C     VAL12K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    UCUR
     C     GW352K        KLIST
     C                   KFLD                    W32TNO
     C                   KFLD                    W32CLN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO2            11
     C                   PARM                    UTYPE             3
     C                   PARM                    UPRT             10
N04  C                   PARM                    UORDTYP           1
     C                   PARM                    UCUR              3
     C                   PARM                    UCPY              1
     C                   PARM                    UUTFAX            1
     C                   PARM                    UCOMM             1
     C                   PARM                    UKNC              8
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    UPOS1             5
     C                   PARM                    UPOS2             5
     C                   PARM                    UPOS3             5
N06   *
N06  C     *DTAARA       DEFINE    *LDA          SAVUDS
N06  C                   IN        SAVUDS
N06  C                   IF        UCUR = 'XXX'
N06  C                   EVAL      UCUR = UCURR
N06  C                   END
      *
     C                   move      UTNO2         ZTNO2            11
     C                   MOVE      UTYPE         ZTYPE             3
     C                   MOVE      UPRT          ZPRT             10
     C                   MOVE      UCUR          ZCUR              3
     C                   MOVE      UUTFAX        ZUTFAX            1
     C                   MOVE      UCOMM         ZCOMM             1
     C                   MOVE      UKNC          ZKNC              8
     C                   MOVE      UQJOB         ZQJOB            10
     C                   MOVE      UQUSER        ZQUSER           10
     C                   MOVE      UQNBR         ZQNBR             6
     C                   MOVE      UPOS1         ZPOS1             5
     C                   MOVE      UPOS2         ZPOS2             5
     C                   MOVE      UPOS3         ZPOS3             5
     C                   SELECT
     C                   WHEN      UTYPE = 'WEB'
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     UPRT          CHAIN     GSSBIF                             33
     C                   MOVE      UTNO2         UTNO             11 0
     C     UTNO          CHAIN(N)  GSSTWL02                           33
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      FICURR        UCURR
     C                   MOVE      TWCURC        UCUR
     C                   MOVE      TWFT1         UFT1
     C                   MOVE      TWFT2         UFT2
     C                   MOVE      BICGR         UBICGR
     C                   MOVE      BICNO         UBICNO
     C                   MOVE      BIFC          UBIFC
     C                   EVAL      UTYPE = 'PRT'
     C                   EVAL      UPRT  = 'WEB'
     C                   WHEN      UTYPE = 'CFW'
     C                   MOVE      UTNO2         UTNO             11 0
     C     UTNO          CHAIN(N)  GSSTWL02                           33
     C                   EVAL      UTYPE = 'CFM'
     C                   EVAL      UPRT  = 'WEB'
     C                   ENDSL
      *
     C                   SELECT
     C                   WHEN      UTYPE = 'PRC'
     C                   MOVE      'PRT'         UTYPE
     C                   MOVEL     UPOS1         XCONT             2
     C                   MOVE      *BLANKS       UPOS1
     C                   WHEN      UTYPE = 'CPC'
     C                   MOVE      'CPY'         UTYPE
     C                   MOVEL     UPOS1         XCONT
     C                   MOVE      *BLANKS       UPOS1
     C                   OTHER
     C                   MOVE      'AV'          XCONT
     C                   ENDSL
      *
     c                   move      utype         utypes2           3
     c     uutfax        comp      'A'                                    51
     c                   read      firm                                   33
     C                   MOVE      UTNO2         UTNO             11 0
     C                   MOVE      *BLANKS       POCONO
     C                   MOVE      'SF'          KOSFUN
     C                   MOVE      '1'           *IN39
     C                   TIME                    XTIME
     C                   MOVE      XAAR          XIDAGÅ
     C                   MOVE      XMND          XIDAGM
     C                   MOVE      XDAG          XIDAGD
     C     XMND          LOOKUP    TAB1          TAB2                     33
     C                   MOVE      TAB2          XMMP
     C                   MOVE      XAAR          XÅÅP
     C                   MOVE      XDAG          XDDP
     C     *LIKE         DEFINE    ORCLI         XCLI
     C     *LIKE         DEFINE    ORONO         XONO
     C     *LIKE         DEFINE    ORONO         XONO1
     C     *LIKE         DEFINE    ORONO         XONO2
     C     *LIKE         DEFINE    ORONO         XONO3
     C     *LIKE         DEFINE    ORBCD         XBCD1
     C     *LIKE         DEFINE    ORBCD         XBCD2
     C     *LIKE         DEFINE    ORBCD         XBCD3
     C     UTYPE         COMP      'CPY'                                  50
     C  N50UTYPE         COMP      'CPL'                                  50
      *
     C     UUTFAX        IFEQ      'J'
     C     UFIRM         CHAIN     FAXSEN                             28
     C                   MOVE      '1'           *IN28
     C                   END
      *
     C     UUTFAX        IFNE      'J'
     C     uutfax        andne     'A'
     C     KEYST         KLIST
     C                   KFLD                    STRPRT
     C                   MOVE      UPRT          STRPRT
     C     KEYST         CHAIN     GSSSTK                             33
     C     *IN33         IFEQ      '0'
     C     STRF02        andne     '*PDF '
     C     STRF02        CHAIN     KODTFM                             33
     C                   END
     C                   END
     C* lager stringkoder for skifte av font
     C     stresc        ifne      *blanks
     C     STRF02        andne     '*PDF '
      *
      * string for antall kopier ved tcp-ip
     c     ucpy          ifgt      '1'
     c     stresc        andeq     '¤    '
     c                   move      *blanks       strico           70
     C     strico        CAT       stresc:0      strico
     C     strico        CAT       '&l':0        strico
     C     strico        CAT       ucpy:0        strico
     C     strico        CAT       'X':0         strico
     c                   end
      *
      *
      * ¤1B(¤1B(s0p10h6v0s0b0T prøver med pitch 12
     c                   move      *blanks       stri01           70
     C     stri01        CAT       stresc:0      stri01
     C     stri01        CAT       '(':0         stri01
     C     stri01        CAT       stresc:0      stri01
     C     stri01        CAT       '(s0p12h6v0':0stri01
     C     stri01        CAT       's0b0T':0     stri01
      *
      * ¤1B(¤1B(s0p08h4v0s0b0T
     c                   move      *blanks       stri02           70
     C     stri02        CAT       stresc:0      stri02
     C     stri02        CAT       '(':0         stri02
     C     stri02        CAT       stresc:0      stri02
     C     stri02        CAT       '(s0p08h4v0':0stri02
     C     stri02        CAT       's0b0T':0     stri02
      *
      * ¤1B(¤1B(s0p15h6v0s0b0T'
     c                   move      *blanks       stri03           70
     C     stri03        CAT       stresc:0      stri03
     C     stri03        CAT       '(':0         stri03
     C     stri03        CAT       stresc:0      stri03
     C     stri03        CAT       '(s0p15h6v0':0stri03
     C     stri03        CAT       's0b0T':0     stri03
      *
      * tvinge landscape
      * ¤&l0O
     c                   move      *blanks       stri04           70
     C     stri04        CAT       stresc:0      stri04
     C     stri04        CAT       '&l1O':0      stri04
     C     stri04        CAT       stresc:1      stri04
     C     stri04        CAT       '(':0         stri04
     C     stri04        CAT       stresc:0      stri04
     C     stri04        CAT       '(s0p10h6v0':0stri04
     C     stri04        CAT       's0b0T':0     stri04
      *
      *
      * 10 cpi
      *
     c                   move      *blanks       stri05           70
     C     stri05        CAT       stresc:0      stri05
     C     stri05        CAT       '(':0         stri05
     C     stri05        CAT       stresc:0      stri05
     C     stri05        CAT       '(s0p10h6v0':0stri05
     C     stri05        CAT       's0b0T':0     stri05
      *
      * ¤1B(¤1B(s0p08h4v0s0b0T + landscape
     c                   move      *blanks       stri06           70
     C     stri06        CAT       stresc:0      stri06
     C     stri06        CAT       '&l1O':0      stri06
     C     stri06        CAT       stresc:1      stri06
     C     stri06        CAT       '(':0         stri06
     C     stri06        CAT       stresc:0      stri06
     C     stri06        CAT       '(s0p08h4v0':0stri06
     C     stri06        CAT       's0b0T':0     stri06
      *
      *
     c                   end
      *
      * indikator 77 ved PDF
      *
     C     uutfax        comp      'A'                                    77
     C  n77STRF02        comp      '*PDF '                                77
      *
     C     uutfax        ifne      'A'
     C     STRF02        andeq     '*PDF '
     c                   move      ucpy          UCPYN             1 0
     c                   end
     C                   ENDSR
      *
     C***********************************************
     C     LESORD        BEGSR
     C***********************************************
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD90        UCMD
     C     XCMD90        CAT       UJOBNM:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   OPEN      GSS031W
     C                   OPEN      GSSORF
     C                   OPEN      GSSORL21
     C                   OPEN      GSSORL24
     C                   OPEN      GSSORL25
      *
     C     UTNO          SETLL     GSSORL21                           33
     C     UTNO          SETLL     GSSORL24                           34
     C     UTNO          SETLL     GSSORL25                           35
     C     STLES         TAG
     C     UTNO          READE     GSSORL21                               33
     C   33              Z-ADD     9999999       XONO1
     C   33              MOVE      '99999'       XBCD1
     C  N33              MOVE      ORONO         XONO1
     C  N33              MOVE      ORBCD         XBCD1
     C     UTNO          READE     GSSORL24                               34
     C   34              Z-ADD     9999999       XONO2
     C   34              MOVE      '99999'       XBCD2
     C  N34              MOVE      ORONO         XONO2
     C  N34              MOVE      ORBCD         XBCD2
     C     UTNO          READE     GSSORL25                               35
     C   35              Z-ADD     9999999       XONO3
     C   35              MOVE      '99999'       XBCD3
     C  N35              MOVE      ORONO         XONO3
     C  N35              MOVE      ORBCD         XBCD3
     C                   SELECT
     C     XBCD3         WHENLT    XBCD1                                        XBCD3 ER MINST
     C     XBCD3         ANDLT     XBCD2
     C                   MOVE      XONO3         XONO
     C     XBCD2         WHENLT    XBCD1                                        XBCD2 ER MINST
     C     XBCD2         ANDLT     XBCD3                                        XBCD2 ER MINST
     C                   MOVE      XONO2         XONO
     C     XBCD1         WHENLT    XBCD2                                        XBCD1 ER MINST
     C     XBCD1         ANDLT     XBCD3
     C                   MOVE      XONO1         XONO
     C     XBCD1         WHENEQ    XBCD2                                        XBCD1=XBCD2
     C     XBCD1         ANDLT     XBCD3                                        XBCD3 ER STØRST
     C     XONO2         IFLT      XONO1                                        ORD2<ORD1
     C                   MOVE      XONO2         XONO
     C                   ELSE
     C                   MOVE      XONO1         XONO
     C                   END
     C     XBCD2         WHENEQ    XBCD3                                        XBCD2=XBCD3
     C     XBCD2         ANDLT     XBCD1                                        XBCD1 ER STØRST
     C     XONO3         IFLT      XONO2                                        ORD3<ORD2
     C                   MOVE      XONO3         XONO
     C                   ELSE
     C                   MOVE      XONO2         XONO
     C                   END
     C     XBCD3         WHENEQ    XBCD1                                        XBCD3=XBCD1
     C     XBCD3         ANDLT     XBCD2                                        XBCD2 ER STØRST
     C     XONO1         IFLT      XONO3                                        ORD3<ORD1
     C                   MOVE      XONO1         XONO
     C                   ELSE
     C                   MOVE      XONO3         XONO
     C                   END
     C                   OTHER                                                  XBCD1,2,3 ER LIKE
     C                   SELECT
     C     XONO3         WHENLT    XONO1
     C     XONO3         ANDLT     XONO2
     C                   MOVE      XONO3         XONO
     C     XONO2         WHENLT    XONO1
     C                   MOVE      XONO2         XONO
     C                   OTHER
     C                   MOVE      XONO1         XONO
     C                   ENDSL
     C                   ENDSL
      *
     C     *IN33         DOWEQ     '0'
     C     *IN34         OREQ      '0'
     C     *IN35         OREQ      '0'
     C     XONO          CHAIN     GSSORF                             36
N04  C                   IF        UORDTYP <> ' '
N04  C                   IF        UORDTYP <> 'C' OR ORTYPE <> ' '
N04  C     ORTYPE        CABNE     UORDTYP       STLES
N04  C                   END
N04  C                   END
     C                   WRITE     GSS031WR
     C     STLES2        TAG
     C                   SELECT
     C     XONO3         WHENEQ    XONO
     C  N35UTNO          READE     GSSORL25                               35
     C  N35              MOVE      ORONO         XONO3
     C  N35              MOVE      ORBCD         XBCD3
     C   35              Z-ADD     9999999       XONO3
     C   35              MOVE      '99999'       XBCD3
     C   35              GOTO      STLES2
     C     XONO2         WHENEQ    XONO
     C  N34UTNO          READE     GSSORL24                               34
     C   34              Z-ADD     9999999       XONO2
     C   34              MOVE      '99999'       XBCD2
     C  N34              MOVE      ORONO         XONO2
     C  N34              MOVE      ORBCD         XBCD2
     C                   OTHER
     C  N33UTNO          READE     GSSORL21                               33
     C   33              Z-ADD     9999999       XONO1
     C   33              MOVE      '99999'       XBCD1
     C  N33              MOVE      ORONO         XONO1
     C  N33              MOVE      ORBCD         XBCD1
     C                   ENDSL
     C                   SELECT
     C     XBCD3         WHENLT    XBCD1                                        XBCD3 ER MINST
     C     XBCD3         ANDLT     XBCD2
     C                   MOVE      XONO3         XONO
     C     XBCD2         WHENLT    XBCD1                                        XBCD2 ER MINST
     C     XBCD2         ANDLT     XBCD3                                        XBCD2 ER MINST
     C                   MOVE      XONO2         XONO
     C     XBCD1         WHENLT    XBCD2                                        XBCD1 ER MINST
     C     XBCD1         ANDLT     XBCD3
     C                   MOVE      XONO1         XONO
     C     XBCD1         WHENEQ    XBCD2                                        XBCD1=XBCD2
     C     XBCD1         ANDLT     XBCD3                                        XBCD3 ER STØRST
     C     XONO2         IFLT      XONO1                                        ORD2<ORD1
     C                   MOVE      XONO2         XONO
     C                   ELSE
     C                   MOVE      XONO1         XONO
     C                   END
     C     XBCD2         WHENEQ    XBCD3                                        XBCD2=XBCD3
     C     XBCD2         ANDLT     XBCD1                                        XBCD1 ER STØRST
     C     XONO3         IFLT      XONO2                                        ORD3<ORD2
     C                   MOVE      XONO3         XONO
     C                   ELSE
     C                   MOVE      XONO2         XONO
     C                   END
     C     XBCD3         WHENEQ    XBCD1                                        XBCD3=XBCD1
     C     XBCD3         ANDLT     XBCD2                                        XBCD2 ER STØRST
     C     XONO1         IFLT      XONO3                                        ORD3<ORD1
     C                   MOVE      XONO1         XONO
     C                   ELSE
     C                   MOVE      XONO3         XONO
     C                   END
     C                   OTHER                                                  XBCD1,2,3 ER LIKE
     C                   SELECT
     C     XONO3         WHENLT    XONO1
     C     XONO3         ANDLT     XONO2
     C                   MOVE      XONO3         XONO
     C     XONO2         WHENLT    XONO1
     C                   MOVE      XONO2         XONO
     C                   OTHER
     C                   MOVE      XONO1         XONO
     C                   ENDSL
     C                   ENDSL
     C  N33
     CORN34
     CORN35              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SNDFAX        BEGSR
     C***********************************************
     C     UWRET         IFNE      *BLANKS
     C                   EXSR      FAXFIX
     C                   ELSE
     C                   MOVEL     UWFAXN        FAXNRP
     C                   END
      *
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
     C     UWTIME        IFNE      *ZEROS
     C     UWDATE        IFNE      *ZEROS
     C                   MOVE      *BLANKS       PTIME
     C                   MOVEL     *BLANKS       PDATE
     C                   MOVEL     UWTIME        PTIME
     C                   MOVEL     UWDATE        PDATE
     C                   END
     C                   END
     C                   MOVE      'B'           UUKODE            1
     C                   MOVEL     'SHIPINVO'    DOKNAV           12
     C                   MOVE      'ICE '        DOKNAV
     C                   MOVE      *ZEROS        FAXAVD            4
     C                   MOVE      *ZEROS        FAXOPD            7
     C                   MOVE      *ZEROS        FAXTUR            8
     C     UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
     C                   MOVEL     'GSS031P '    FILEN            10
     C                   ELSE                                                   1
     C                   MOVEL     'GSS031PL'    FILEN            10
     C                   END                                                    1<-E
     C     UCOVP         IFEQ      ' '
     C                   MOVE      'N'           UCOVP
     C                   END
     C     UCOVP         IFEQ      'Y'
     C                   MOVE      'J'           UCOVP
     C                   END
      *
     C     FAXSYS        IFEQ      'F'
     c     uemail        orne      *blanks
     c                   move      ' '           uemailj
     C     FAXLIB        IFEQ      *BLANKS
     c     uemail        orne      *blanks
     c     uemail        ifne      *blanks
     c                   movel     uemail        uwcnam
     c                   movel     'MAIL        'FAXNRP
     c                   move      'J'           uemailj
     c     cbnab         ifne      *blanks
     c                   movel     cbnab         emne             40
     c     EMNE          CAT       'Pr.inv':1    emne
     c     emne          cat       'from:':1     emne
     c     emne          cat       fikrtn:1      emne
     c                   else
     c                   movel     'Prof.invoice'emne             40
     c                   movel     'from:'       emne26           26
     c                   movel     fift          emne20           20
     c                   move      emne20        emne26
     c                   move      emne26        emne             40
     c                   end
     c                   end
     C                   CALL      'GSS015C2'
     C                   PARM                    UCOVP
     C                   PARM                    UQJOB
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    FAXNRP
     C                   PARM                    FILEN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   PARM                    uemail
     C                   PARM                    emne
     C                   PARM                    uemailj
     C                   ELSE
      * VED FAX400 SENDER SYSTEMET AUTOMATISK FRA UTKØ
     C                   END
      *
     C                   MOVEL     UQUSER        MAPPE            20
     C                   CALL      'FAX013'
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    UQJOB
     C                   PARM                    FAXNRP
     C                   PARM                    DOKNAV
     C                   PARM                    MAPPE
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UWCNAM
     C                   PARM                    FAXAVD
     C                   PARM                    FAXOPD
     C                   PARM                    FAXTUR
     C                   PARM                    UUKODE
     C                   END
      *
     C     FAXSYS        IFEQ      'B'
     c     uemail        ANDEQ     *blanks
     C     FIFIRM        CHAIN     FAXMANT                            33
     C   33              Z-ADD     1             UNIK
     C  N33              ADD       1             UNIK
     C   33              WRITE     FAXMANTR
     C  N33              UPDATE    FAXMANTR
     C                   EVAL      PRTFIL = FILEN
     C                   OPEN      FAXMANP
     C                   MOVE      UQNBR         JOBNR
     C                   EVAL      KNAVN = UWCNAM
     C                   EVAL      FINAVN = FIFT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           PUDATE
     C                   EXCEPT    SKRIV
     C                   CLOSE     FAXMANP
     C                   CALL      'GSS015C3'
     C                   PARM                    KNAVN
     C                   PARM                    FAXNRP
     C                   PARM                    UNIK
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    PRTFIL           10
     C                   PARM                    DOKNAV
     C                   PARM                    UCOVP
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   END
      *
     C                   ENDSR
      *
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   MOVE      UWRET         FAXRET
     C                   MOVE      UWFAXN        WSFAXN
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
      *=====================================================================
      *  Oppdater loggen
      *=====================================================================
     C     OPDLOGG       begsr
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVEL     UTNO          TTAVD
     C                   MOVE      UTNO          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'PS3'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTTEXT = XXTXT01
     C                   CAT       XXTXT02:10    TTTEXT
     C                   CAT       UTNO2:1       TTTEXT
n08  C                   EVAL      TTTEXl = XXTXT01l
n08  C                   CAT       XXTXT02l:10   TTTEXl
n08  C                   CAT       UTNO2:1       TTTEXl
     C                   WRITE     TRACKFR
      *
     C                   endsr
      *
      *=====================================================================
      *  Oppdater arkivfil
      *=====================================================================
     C     arkivsr       begsr
      *=====================================================================
     C     FIFIRM        CHAIN     FIRMARC                            33
     C     *IN33         IFEQ      '0'
     C     'pf'          chain     arktxt                             33
     C     *IN33         IFEQ      '0'
     C     arkjn         andeq     'J'
      *
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVEl     UTNO          ARAVD
     C                   MOVE      UTNO          AROPD
     C                   EVAL      ARUNDE = UCUR
     C                   MOVE      UCOMM         ARUNDE
     C                   MOVE      'pf'          ARTYPE
     C                   MOVE      UUSER         ARUSER
     C                   MOVE      WDT           ARDATE
     C                   MOVE      WTM           ARTIME
     C                   MOVE      KUNDNR        ARKUND
N13  C                   exsr      sletta
     C                   WRITE     ARKIVR
     C                   move      'J'           arkiver           1
     C                   END
     C                   END
     C                   ENDSR
N13  C***********************************************
N13  C     Sletta        BEGSR
N13  C***********************************************
N13  C* sletter gamle arkivdokumenter
N13  C                   move      aravd         aravda
N13  C                   move      aropd         aropda
N13  C                   CALL      'SYGE59'
N13  C                   parm                    artype            2
N13  C                   PARM                    aravda            4
N13  C                   PARM                    aropda            7
N13   *
N13  C                   ENDSR
N01  C***********************************************
N01  C     BERFAK        BEGSR
N01  C***********************************************
N01  C                   MOVE      TRTNO         UTNO
N01  C                   CALL      'GSS049C'
N01  C                   PARM                    PAR07             7 0
N01  C                   PARM                    UTNO             11 0
N01   *
N01  C                   ENDSR
N03  C***********************************************
N03  C     FINNVK        BEGSR
N03  C***********************************************
N03  C     KEYV          KLIST
N03  C                   KFLD                    UNIV              1
N03  C                   KFLD                    HEAVD
N12  C                   move      'V'           univ
N03  C     KEYV          CHAIN     KODTV                              33
N03  C     *IN33         IFEQ      '0'
N03  C*
N03  C*** GETS FREIGHTWEIGHT
N03  C                   Z-add     HEVKT         HEFBV
N03  C     HEM3          MULT      KOVKKG        XM3DE            12 3
N03  C                   ADD       0.999         XM3DE
N03  C                   Z-ADD     XM3DE         XM3M3             9 0
N03  C     XM3M3         IFGT      HEVKT
N03  C                   Z-ADD     XM3M3         HEFBV
N03  C                   END
N03  C*
N03  C                   END
N03  C                   ENDSR
N11   ***********************************************
N11  C     OPDLOG        BEGSR
N11   ***********************************************
N11  C                   EVAL      LGUSER = UUSER
N11  C                   CALL      'SYGE15C'
N11  C                   PARM                    WDT               8
N11  C                   PARM                    WTM               6
N11  C                   MOVE      WDT           LGDT
N11  C                   MOVE      WTM           LGTID
N11  C                   MOVE      WDT           LGHDT
N11  C                   MOVE      WTM           LGHTID
N11  C                   EVAL      LGPGM  = 'GSS031R'
N11  C                   EVAL      LGNIVÅ = 3
N11  C                   EVAL      LGONO  = ORONO
N11  C                   EVAL      LGNGM  = ORTNO
N11  C                   EVAL      LGNNY  = ORTNO
N11  C                   WRITE     GSSLGFR
N11   *
N11  C                   ENDSR
N11   *
      *
     OHEADFR    E            UPDHEA
     O                       HENT
     O                       HEVKT
     O                       HEM3
N03  O                       HEFBV
     O                       TRFA11
     O                       TRFA12
     O                       TRFLP1
     O                       TRFA21
     O                       TRFA22
     O                       TRFLP2
     OFAXMANR   EADD         SKRIV
     O                       UNIK
     O                       FAXNRP
     O                       PTIME
     O                       PDATE
     O                       KUNDNR
     O                       KNAVN
     O                       TIL
     O                       FRA
     O                       EMNE
     O                       FINAVN
     O                       JOBNR
     O                       PUDATE
**
01. JAN.
02. FEB.
03. MAR.
04. APR.
05. MAY
06. JUN.
07. JUL.
08. AUG.
09. SEP.
10. OCT.
11. NOV.
12. DEC.
