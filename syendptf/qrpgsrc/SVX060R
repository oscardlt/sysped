********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 CB  PKI, ikke merket
10XXX * 02 YBC PTF10 TEST TET FOR SENDING
10XXX * 03 YBC PTF10 IKKE OPSJON 11 NÅR STATUS ER S
11067 * 04 CB  PTF11 Endre signatur
11084 * 05 CB  PTF11 Ny opsjon 16=Upplæggningsanmælan
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 06 YBC PTF12 Ved status U tester om bruker har klargjort IE44
********************************************************************
     FGODSHF    O  A E           K DISK
     FSVNH      IF   E           K DISK
     FSVNHOPD   UF   E           K DISK    RENAME(SVNHR:SVNHROPD)
     FSVNH01    IF   E           K DISK    RENAME(SVNHR:SVNH01R)
     FSVNH03    IF   E           K DISK    RENAME(SVNHR:SVNH03R)
     FSVNH04    IF   E           K DISK    RENAME(SVNHR:SVNH04R)
     FSVNH05    IF   E           K DISK    RENAME(SVNHR:SVNH05R)
     FSVNH07    IF   E           K DISK    RENAME(SVNHR:SVNH07R)
     FSVNH08    IF   E           K DISK    RENAME(SVNHR:SVNH08R)
     FSVNH09    IF   E           K DISK    RENAME(SVNHR:SVNH09R)
     FSVNH10    IF   E           K DISK    RENAME(SVNHR:SVNH10R)
     FSVNSTD    IF   E           K DISK
     FSVTHA     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FFREETXT2  UF A E           K DISK
     FSTS       IF A E           K DISK
     FGODSFI    IF   E           K DISK
     FGODSJL05  UF A E           K DISK
     FTRACKF    O  A E           K DISK
     FSVX060D   CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
N01  F                                     INFDS(FBAREA)
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
     D                 DS
     D  WAFT1                  1     50
     D  WAFT2                 51    100
     D  WAFT3                101    150
     D  WAFT4                151    200
     D  WAFT5                201    250
     D  FT                     1    250
     D                                     DIM(5)
     D  FT2501                 1    250
     D                 DS
     D  TINA                   1     30
     D  WXNA                   1      7
     D                 DS
     D  TIGN                   1     35
     D  WXGN                   1     13
     D  TIGNFIRM               5      9
     D                 DS
     D  WBTRDTÅ                1      4  0
     D  WBTRDTM                5      6  0
     D  WBTRDTD                7      8  0
     D  WBTRDT                 1      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D                SDS
     D  UUSER                254    263
      *
     C                   EXSR      INIT
     C                   GOTO      START
      *
     C     START0        TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START0
     C                   END
      *
     C                   EXSR      TESTB1
     C   30              GOTO      START0
      *
     C     START         TAG
     C                   MOVE      '1'           *IN92
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        XNAVD             4 0
     C                   MOVE      *ZEROS        XNTDN             7 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        16
     C                   ADD       1             ZRECNO
     C                   EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECN2            5 0
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
     C  N94              END
     C                   END
      *
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C  N27              DO
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
      *** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTTRH
     C                   GOTO      START3
     C                   END
     C   08
     COR 12              EXSR      SETCUR
     C   08              GOTO      START0
     C   12              GOTO      START0
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C     SVHKN         CHAIN     SVNH                               33
     C   33              DO
     C                   MOVE      TIDT          WXDT
     C                   MOVE      TIDTF         WXDTF
     C                   END
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2TDN         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2DTT         ORNE      0
     C     W2TRNR        ORNE      *BLANKS
     C     W2ST          ORNE      *BLANKS
     C     W2GN          ORNE      *BLANKS
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          COMP      1                                      06
     C   06              DO                                                       3<-B
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAAVD
     C                   END                                                       4<-B
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2TDN         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'SVX0046'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYTDN
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TRNR
     C                   MOVE      *BLANKS       W2ST
     C                   MOVE      *BLANKS       W2GN
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C     WSAAVD        IFNE      0
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C     WSSG          IFNE      *BLANKS
     C                   MOVE      WSSG          USG
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   CLEAR                   BILDE01
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          WSAAVD
     C                   ELSE
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C     W2TDN         IFNE      0                                            1<-B
     C                   MOVE      W2TDN         WSTDN
     C                   ELSE                                                   1
     C     W2SG          IFNE      *BLANKS                                       2<-B
     C                   MOVE      W2SG          WSSG
     C                   IF        W2DTT = 0
     C                   MOVE      *ZEROS        WSDTT
     C                   ELSE
     C     20000000      ADD       W2DTT         WSDTT
     C                   END
     C                   MOVE      W2ST          WSST
     C                   ELSE                                                    2
     C     W2DTT         IFNE      0                                              3<-B
     C     20000000      ADD       W2DTT         WSDT
     C                   ELSE                                                     3
     C     W2TRNR        IFNE      *BLANKS                                         4<-B
     C                   MOVE      W2TRNR        WSTRNR
     C                   ELSE                                                      4
     C     W2ST          IFNE      *BLANKS                                          5<-B
     C                   MOVE      W2ST          WSST
     C                   ELSE                                                       5
     C                   MOVE      *BLANKS       WSGN
     C                   MOVEL     W2GN          WSGN
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2TDN
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TRNR
     C                   MOVE      *BLANKS       W2ST
     C                   MOVE      *BLANKS       W2GN
      *
     C                   MOVEA     '0000'        *IN(96)
     C                   EXSR      TESTB1
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYTDN         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          W2AVD
     C                   END
     C     WRK2K         CHAIN(N)  SVNHOPD                            98
     C   98              DO
     C                   MOVE      'SVX0047'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    2
     C                   EXSR      CHGTRH
     C     W2NR          WHENEQ    3
     C                   EXSR      CPYTRH
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPTRH
     C     W2NR          WHENEQ    8
     C                   EXSR      DSPWEB
     C     W2NR          WHENEQ    9
     C                   EXSR      DSPTVI
     C     W2NR          WHENEQ    11
     C                   EXSR      SNDIEXX
N04  C     W2NR          WHENEQ    13
N04  C                   EXSR      CHGSIG
     C     W2NR          WHENEQ    44
     C                   EXSR      LSMTRH
     C     W2NR          WHENEQ    45
     C                   EXSR      DLSTRH
     C                   ENDSL
      *
     C     SLTDN         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2TDN
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C                   SELECT
     C     WSNR          WHENEQ    2
     C                   MOVE      '1'           *IN99
     C                   EXSR      CHGTRH
     C     WSNR          WHENEQ    3
     C                   MOVE      '1'           *IN99
     C                   EXSR      CPYTRH
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTRH
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPWEB
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
     C     WSNR          WHENEQ    11
     C                   EXSR      SNDIEXX
N04  C     WSNR          WHENEQ    13
N04  C                   EXSR      CHGSIG
N05  C     WSNR          WHENEQ    16
N05  C                   EXSR      PRTUPP
     C     WSNR          WHENEQ    44
     C                   MOVE      '1'           *IN99
     C                   EXSR      LSMTRH
     C     WSNR          WHENEQ    45
     C                   MOVE      '1'           *IN99
     C                   EXSR      DLSTRH
     C     WSNR          WHENEQ    99
     C                   MOVE      '1'           *IN99
     C                   EXSR      MRKST
     C                   ENDSL
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKN
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    SOKNR2
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      11
N01  C     POSNBR        ANDGE     35
N01  C     POSNBR        ANDLE     42
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKN
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     55            POSNBR
N01  C                   END
      *
     C                   ENDSR
      *
N01   ***********************************************
N01  C     SETCUR        BEGSR
N01   ***********************************************
N01  C                   Z-ADD     35            POSNBR
N01  C                   SELECT
N01  C                   WHEN      WSDT   <> 0
N01  C                   Z-ADD     9             LINNBR
N01  C                   WHEN      WSTDN  <> 0
N01  C                   Z-ADD     10            LINNBR
N01  C                   WHEN      WSKN   <> 0
N01  C                   Z-ADD     11            LINNBR
N01  C                   WHEN      WSSG   <> *BLANKS
N01  C                   Z-ADD     13            LINNBR
N01  C                   WHEN      WSTRNR <> *BLANKS
N01  C                   Z-ADD     14            LINNBR
N01  C                   WHEN      WSGN   <> *BLANKS
N01  C                   Z-ADD     15            LINNBR
N01  C                   WHEN      WSST   <> *BLANKS
N01  C                   Z-ADD     16            LINNBR
N01  C                   OTHER
N01  C                   Z-ADD     8             LINNBR
N01  C                   ENDSL
N01   *
N01  C                   ENDSR
N01   *
     C***********************************************
     C     DSPTRH        BEGSR
     C***********************************************
     C                   MOVE      'DSP'         XTYPE             3
     C                   CALL      'SVX061C'
     C                   PARM      TIAVD         XAVD
     C                   PARM      TITDN         XTDN
     C                   PARM                    TISG
     C                   PARM                    XTYPE
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGTRH        BEGSR
     C***********************************************
     C                   MOVE      'CHG'         XTYPE             3
     C                   CALL      'SVX061C'
     C                   PARM      TIAVD         XAVD
     C                   PARM      TITDN         XTDN
     C                   PARM                    TISG
     C                   PARM                    XTYPE
     C                   PARM                    UFLAGG            1 0
     C     SVHKOP        CHAIN(N)  SVNHOPD                            33
      * HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYTRH        BEGSR
     C***********************************************
     C                   MOVE      'CPY'         XTYPE             3
     C     *LIKE         DEFINE    TIAVD         XAVD
     C     *LIKE         DEFINE    TITDN         XTDN
     C                   MOVE      TIAVD         XAVD
     C                   MOVE      TITDN         XTDN
     C                   CALL      'SVX061C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UFLAGG            1 0
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
     C     XTDN          IFNE      0
     C     XAVD          IFNE      TIAVD
     C     XTDN          ORNE      TITDN
     C     SVHKKP        CHAIN(N)  SVNHOPD                            33
     C                   MOVE      TIDT          WXDT
     C                   MOVE      TIDTF         WXDTF
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
     C                   EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CRTTRH        BEGSR
     C***********************************************
     C                   MOVE      'CRT'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'SVX061C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UFLAGG            1 0
     C     XAVD          IFNE      0
     C     XTDN          ANDNE     0
     C     SVHKKP        CHAIN(N)  SVNHOPD                            33
     C  N33              DO
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
     C                   MOVE      TIDT          WXDT
     C                   MOVE      TIDTF         WXDTF
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
     C                   EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPWEB        BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Søk på MRNnr på WEB '
     C                   EVAL      WebType = 'MRNNR'
     C                   EVAL      WebSok  = TITRNR
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
     C***********************************************
     C     DSPTVI        BEGSR
     C***********************************************
     C                   MOVE      '6'           WIN03             1
     C*                  CALL      'SAD003'
     C                   CALL      'SVX006R'
     C                   PARM      TIAVD         TIAVD
     C                   PARM      TITDN         UTDN              7 0
     C                   PARM                    WIN03
     C     WIN03         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     SNDIEXX       BEGSR
     C***********************************************
S03  C*                  IF        ((((TIST = ' ') OR
S03  C*                               (TIST = 'U')) OR
S03  C*                               (TIST = 'H')) OR
S03  C*                               (TIST = 'S'))
N03  C                   IF        TIST = ' ' OR TIST = 'U' OR
N03  C                             TIST = 'H'
     C                   IF        ((TIST = 'U') OR (TIST = 'H'))
N02  C     SVHKOP        CHAIN     SVNH                               33
N02  C                   IF        NIKONF = 1 OR NIMN1 <> *BLANKS
     C                   MOVE      '044'         X1N07
N06  C                   ELSE
N06   * FEIL Å SENDE. IE44 ER IKKE KLARGJORT.
N06  C                   GOTO      SLSNDIE
N02  C                   END
     C                   ELSE
     C                   MOVE      '007'         X1N07             3
     C                   END
     C                   CALL      'SVX063R'
     C                   PARM      TIAVD         XAVD
     C                   PARM      TITDN         XTDN
     C                   PARM                    X1N07
     C                   PARM                    UFLAGG            1 0
      *_________
      * Sendning
      *"""""""""
     C     TISG          CHAIN     SVTHA

     C     SVHKOP        CHAIN     SVNH                               33
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
N06  C     SLSNDIE       TAG
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     LSMTRH        BEGSR
     C***********************************************
     C                   MOVE      'CHG'         XTYPE             3
     C                   CALL      'SVX064C'
     C                   PARM      TIAVD         XAVD
     C                   PARM      TITDN         XTDN
     C                   PARM                    XTYPE
     C                   PARM                    UFLAGG            1 0
     C     SVHKOP        CHAIN(N)  SVNHOPD                            33
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLSTRH        BEGSR
     C***********************************************
     C                   MOVE      'DSP'         XTYPE             3
     C                   CALL      'SVX064C'
     C                   PARM      TIAVD         XAVD
     C                   PARM      TITDN         XTDN
     C                   PARM                    XTYPE
     C                   PARM                    UFLAGG            1 0
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     MRKST         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       FT
     C                   MOVE      *ZEROS        XN                3 0
     C                   MOVE      *BLANKS       WAUSER
     C                   MOVE      *ZEROS        WADT
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE(N)  FREETXT2                               33
     C     *IN33         DOWEQ     '0'
     C     WAUSER        IFEQ      *BLANKS
     C                   MOVE      FRTTXT        WAUSER
     C                   MOVE      FRTDT         WADT
     C                   END
     C                   ADD       1             XN
     C                   MOVEL     FRTTXT        FT(XN)
     C     FRT2K         READE(N)  FREETXT2                               33
     C  N33              ENDDO
     C                   MOVE      TIST          WAST
     C                   MOVE      FT2501        FT2502          250
      * GODSJOURNAL
     C                   MOVE      'N'           WAOPGJ
     C     TIDTF         COMP      0                                      50
     C                   IF        *IN50                                        1B
     C                   MOVEL     TIGN          GOGN
     C                   MOVEL     TITRNR        GOTRNR
     C     GODS5K        CHAIN(N)  GODSJL05                           50
     C                   IF        *IN50                                         2B
     C                   MOVE      *BLANKS       GOTRNR
     C     GODS5K        CHAIN(N)  GODSJL05                           33
     C                   IF        *IN33                                          3B
     C                   MOVE      *BLANKS       GOGREN
     C                   MOVE      *ZEROS        GOTRDT
     C                   MOVEL     TITAID        GOBILN
     C                   MOVEL     TINAK         GOMOTT
     C     TIGNFIRM      CHAIN(N)  GODSFI                             33
     C                   IF        *IN33 = *OFF                                    4B
     C                   MOVE      'J'           WAOPGJ
     C                   ELSE                                                      4
     C                   MOVE      *OFF          *IN50
     C                   END                                                       4E
     C                   ELSE                                                     3
     C                   MOVE      'J'           WAOPGJ
     C                   END                                                      3E
     C                   END                                                     2E
     C                   END                                                    1E
      *
     C     STMRK         TAG
     C                   EXFMT     BILDE02
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
     C   12              GOTO      SLMRK
      *
     C     WAFT1         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SVX1864'     MSGNR
     C                   GOTO      STMRK
     C                   END
      *
     C     FT2501        IFNE      FT2502
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE     FREETXT2                               33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    FREETXTR
     C     FRT2K         READE     FREETXT2                               33
     C  N33              ENDDO
      *
     C                   MOVE      TIAVD         FRTAVD
     C                   MOVE      TITDN         FRTOPD
     C                   MOVE      WDT           FRTDT
     C     1             DO        5             XN
     C     FT(XN)        IFNE      *BLANKS
     C                   Z-ADD     XN            FRTLI
     C                   MOVEL     FT(XN)        FRTTXT
     C                   MOVE      UUSER         FRTTXT
     C                   WRITE     FREETXTR
     C                   END
     C                   ENDDO
     C                   END
      *
     C     TIST          IFNE      WAST
     C     SVHKOP        CHAIN     SVNHOPD                            33
     C                   MOVE      WAST          TIST
     C                   UPDATE    SVNHROPD
     C     STMRK2        TAG
     C                   MOVE      WDT           SSDT
     C                   MOVE      WTM           SSTM
     C     STSK          CHAIN     STS                                33
     C     *IN33         IFEQ      '0'
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   GOTO      STMRK2
     C                   END
     C                   MOVE      TIAVD         SSAVD
     C                   MOVE      TITDN         SSOPD
     C                   MOVE      UUSER         SSUSR
     C                   MOVE      TISG          SSSG
     C                   MOVE      'P'           SSRTYP
     C                   MOVE      TIST          SSSTG
     C                   MOVE      WAST          SSSTN
     C                   WRITE     STSR
     C                   END
      *
     C                   IF        WAOPGJ = 'J'
     C                   EXSR      OPDGJ
     C   12              GOTO      STMRK
     C                   END
      *
     C     SLMRK         TAG
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKKMRK
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     SJEKKMRK      BEGSR
     C***********************************************
      *
      * SJEKK MERKING
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE(N)  FREETXT2                               33
     C  N33              MOVE      '1'           *IN29
     C   33              MOVE      '0'           *IN29
      *
      * SJEKK PLL
     C     TILSTL        COMP      0                                  28
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDGJ         BEGSR
      ***********************************************
     C                   MOVE      GOGREN        WBGREN
     C                   MOVE      GOTRDT        WBTRDT
     C                   MOVE      GOBILN        WBBILN
     C                   MOVE      GOMOTT        WBMOTT
     C                   MOVE      *BLANKS       WBKONF
     C     STOPDGJ       TAG
     C                   EXFMT     BILDE03
     C                   MOVEA     '00000'       *IN(86)
     C                   MOVE      '0'           *IN30
     C   12              GOTO      SLOPDGJ
      *
     C     WBGREN        IFEQ      *BLANKS
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SVX1875'     MSGNR
     C                   GOTO      STOPDGJ
     C                   END
      *
     C                   MOVE      WBTRDTÅ       UÅÅ               2 0
     C                   MOVE      WBTRDTM       UMM               2 0
     C                   MOVE      WBTRDTD       UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C     *IN89         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   GOTO      STOPDGJ
     C                   END
      *
     C     WBBILN        IFEQ      *BLANKS
     C                   MOVE      '1'           *IN88
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SVX1876'     MSGNR
     C                   GOTO      STOPDGJ
     C                   END
      *
     C     WBMOTT        IFEQ      *BLANKS
     C                   MOVE      '1'           *IN87
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SVX1877'     MSGNR
     C                   GOTO      STOPDGJ
     C                   END
      *
     C     WBKONF        IFEQ      *BLANKS
     C                   MOVE      '1'           *IN86
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SVX1880'     MSGNR
     C                   GOTO      STOPDGJ
     C                   END
     C     SVHKOP        CHAIN     SVNHOPD                            33
     C                   MOVE      WBKONF        NIKONF
     C                   UPDATE    SVNHROPD
      *
     C     GODS5K        CHAIN     GODSJL05                           33
     C                   MOVEL     TITRNR        GOTRNR
     C                   MOVE      WBGREN        GOGREN
     C                   MOVE      WBTRDT        GOTRDT
     C                   MOVE      WBBILN        GOBILN
     C                   MOVE      WBMOTT        GOMOTT
     C                   IF        *IN33
     C                   MOVEL     TIGN          GOGN
     C                   WRITE     GODSJR
     C                   MOVE      'N'           GOHKOD
     C                   exsr      GOHIST
     C                   ELSE
     C                   UPDATE    GODSJR
     C                   MOVE      'E'           GOHKOD
     C                   exsr      GOHIST
     C                   END
     C                   EXSR      TTSR
      *
     C     SLOPDGJ       ENDSR
      *
N04  C***********************************************
N04  C     CHGSIG        BEGSR
N04  C***********************************************
N04  C                   CALL      'SVX082R'
N04  C                   PARM      TIAVD         XAVD
N04  C                   PARM      TITDN         XTDN
N04  C                   ENDSR
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KOANVN
     C     WSAAVD        IFNE      0
     C     WSTDN         ORNE      0
     C     WSAAVD        CHAIN     SVNSTD                             99
     C  N99KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB1
     C                   MOVE      WSAAVD        UAVD
     C                   END
      *
     C                   MOVEA     '00000000'    *IN(42)
      *
     C     WSDT          COMP      *ZEROS                             4141
     C   41              GOTO      STTB1
     C     WSTDN         COMP      *ZEROS                             4242
     C   42              GOTO      STTB1
     C     WSKN          COMP      *ZEROS                             4343
     C   43              GOTO      STTB1
     C     WSSG          COMP      *BLANKS                            4545
     C   45              GOTO      STTB1
     C     WSTRNR        COMP      *BLANKS                            4646
     C   46              GOTO      STTB1
     C     WSGN          COMP      *BLANKS                            4747
     C   47              GOTO      STTB1
     C     WSST          COMP      *BLANKS                            4949
     C   49              GOTO      STTB1
      *
     C                   MOVE      'DIV0064'     MSGNR
     C                   SETON                                        3098
     C                   GOTO      SLTB1
      *
     C     STTB1         TAG
     C   43              MOVE      WSKN          KUNDNR
     C   43KUNDK         CHAIN     CUNDL01                            97
     C   97              MOVE      'SPK0035'     MSGNR
     C   97              SETON                                        30
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
      *
     C     WSAAVD        IFEQ      0
     C     *IN46         ANDEQ     '0'
     C                   Z-ADD     1             YAVD              4 0
     C                   EXSR      MINTRL
     C                   ELSE
     C                   EXSR      MINTRE
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MINTRE        BEGSR
     C***********************************************
      * SET KEY NÅR SØK KUN I EN !!!!  AVDELING
     C   41SVH1K         SETLL     SVNH01
     C   42SVHK          SETLL     SVNH
     C   43SVH3K         SETLL     SVNH03
     C   45WSDTT         IFEQ      99999999
     C     SVH4K         SETGT     SVNH04
     C                   ELSE
     C     SVH4K         SETLL     SVNH04
     C                   END
     C   46WSTRNR        SETLL     SVNH05
     C   47WSGN          SETLL     SVNH10
     C   49SVH8K         SETLL     SVNH08
      *
     C                   ENDSR
      *
     C***********************************************
     C     MINTRL        BEGSR
     C***********************************************
      * SET KEY NÅR SØK I ALLE !!  AVDELINGER
     C   41SVH9K         SETLL     SVNH09
     C   43SVHA3K        SETLL     SVNH03
     C   45WSDTT         IFEQ      99999999
     C     SVHA4K        SETGT     SVNH04
     C                   ELSE
     C     SVHA4K        SETLL     SVNH04
     C                   END
     C   49WSST          SETLL     SVNH07
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
      * LES REC NÅR SØK KUN I EN !!!!  AVDELING
     C     STLREC        TAG
     C   41WSAAVD        READE     SVNH01                                 94
     C   42WSAAVD        READE     SVNH                                   94
     C   43WSAAVD        READE     SVNH03                                 94
     C   43
     CANN94WSKN          COMP      TIKN                               9494
     C   45WSDTT         IFEQ      99999999
     C     WSAAVD        READPE    SVNH04                                 94
     C  N94WSSG          COMP      TISG                               9494
     C                   ELSE
     C     WSAAVD        READE     SVNH04                                 94
     C  N94WSSG          COMP      TISG                               9494
     C  N94              IF        WSST <> *BLANKS
     C     WSST          CABNE     TIST          STLREC
     C                   END
     C                   END
     C   46              READ      SVNH05                                 94
     C   47              READ      SVNH10                                 94
     C   49SVH8K         READE     SVNH08                                 94
     C  N94              DO
     C                   MOVE      TIDT          WXDT
     C                   MOVE      TIDTF         WXDTF
     C                   MOVE      TIAVD         XNAVD
     C                   MOVE      TITDN         XNTDN
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESRAL        BEGSR
     C***********************************************
      * LES REC NÅR SØK I ALLE !!  AVDELINGER
     C     STLRAL        TAG
     C   41              READ      SVNH09                                 94
     C   43YAVD          READE     SVNH03                                 94
     C   43
     CANN94WSKN          COMP      TIKN                               9494
     C   45WSDTT         IFEQ      99999999
     C     YAVD          READPE    SVNH04                                 94
     C  N94WSSG          COMP      TISG                               9494
     C                   ELSE
     C     YAVD          READE     SVNH04                                 94
     C  N94WSSG          COMP      TISG                               9494
     C                   END
     C   49WSST          READE     SVNH07                                 94
     C  N94              DO
     C                   MOVE      TIDT          WXDT
     C                   MOVE      TIDTF         WXDTF
     C                   MOVE      TIAVD         XNAVD
     C                   MOVE      TITDN         XNTDN
     C                   END
     C  N41
     CANN49              DO
     C   94YAVD          IFLT      9999
     C                   ADD       1             YAVD
     C     YAVD          SETLL     SVNSTD
     C                   READ      SVNSTD                                 33
     C  N33              DO
     C                   MOVE      TIAVD         YAVD
     C                   EXSR      MINTRL
     C                   SETOFF                                       94
     C                   GOTO      STLRAL
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SVHK          KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTDN
     C     SVHKN         KLIST
     C                   KFLD                    XNAVD
     C                   KFLD                    XNTDN
     C     SVHKOP        KLIST
     C                   KFLD                    TIAVD
     C                   KFLD                    TITDN
     C     SVHKKP        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2TDN
     C     SVH1K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSDT
     C     SVH3K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKN
     C                   KFLD                    WSDTN
     C     SVH4K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSSG
     C                   KFLD                    WSDTT
     C     SVH5K         KLIST
     C                   KFLD                    WSTRNR
     C     SVH8K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSST
     C     SVH9K         KLIST
     C                   KFLD                    WSDT
     C     KUNDK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    XUNIK
     C                   KFLD                    WSAAVD
     C     SVHA3K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    WSKN
     C                   KFLD                    WSDTN
     C     SVHA4K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    WSSG
     C                   KFLD                    WSDTT
     C     FRT2K         KLIST
     C                   KFLD                    TIAVD
     C                   KFLD                    TITDN
     C                   KFLD                    FRTKOD
     C     STSK          KLIST
     C                   KFLD                    SSDT
     C                   KFLD                    SSTM
     C                   KFLD                    TIAVD
     C                   KFLD                    TITDN
     C                   KFLD                    UUSER
     C     GODS5K        KLIST
     C                   KFLD                    GOGN
     C                   KFLD                    GOTRNR
      *
     C                   MOVE      'A'           XUNIK             1
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      'MOTTAKER'    SOTXT1            8
S01  C*                  MOVE      *BLANKS       SOTXT2            8
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR2            8 0
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
      *
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTN
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        TIDT
     C                   MOVE      *ZEROS        TIDTF
     C                   MOVE      *ZEROS        WXDT
     C                   MOVE      *ZEROS        WXDTF
     C                   MOVE      'N'           FRTKOD
      *
     C                   MOVE      UAVD          WSAAVD
     C     KODTAK        CHAIN     KODTA                              30
     C                   MOVE      USG           WSSG
     C                   MOVE      99999999      WSDTT
     C                   SETON                                        45
      *
     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
N02   * Hent dato og tid
N02  C                   CALL      'SYGE15C'
N02  C                   PARM                    WDT               8
N02  C                   PARM                    WTM               6
N02  C                   ENDSR
      *
      ***********************************************
     C     TTSR          BEGSR
      ***********************************************
     C                   MOVE      TIAVD         TTAVD
     C                   MOVE      TITDN         TTOPD
     C                   MOVE      '125'         TTACTI
     C                   MOVEL     'T'           TTACTI
     C                   CALL      'SYGE15C'
     C                   PARM                    WDATO             8
     C                   PARM                    WTID              6
     C                   MOVE      WDATO         TTDATE
     C                   MOVE      WTID          TTTIME
     C                   MOVEL     UUSER         TTUSER
     C                   MOVE      *BLANKS       TTTEXT
     C                   MOVEL     'TET-impo'    TTTEXT
     C                   CAT       'rt':0        TTTEXT
     C                   CAT       'MRN-nr':2    TTTEXT
     C                   CAT       ':':0         TTTEXT
     C                   CAT       TITRNR:2      TTTEXT
     C                   CAT       'Godsnr':2    TTTEXT
     C                   CAT       ':':0         TTTEXT
     C                   CAT       TIGN:2        TTTEXT
     C                   CAT       'Tr.avs':2    TTTEXT
     C                   CAT       'lutt':0      TTTEXT
     C                   CAT       'dato:':1     TTTEXT
     C                   MOVE      GOTRDT        XAN08             8
     C                   CAT       XAN08:1       TTTEXT
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
     C***********************************************
     C     gohist        BEGSR
     C***********************************************
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   movel     'SVX060R'     gohpgm
     c                   move      wdt           gohdat
     c                   move      wtm           gohtim
     c                   movel     uuser         gohusr
     c                   write     godshr
     c                   endsr
N05   ***********************************************
N05  C     PRTUPP        BEGSR
N05   ***********************************************
N05  C                   MOVEL     TIAVD         XTIAVD            4
N05  C                   MOVEL     TITDN         XTITDN            7
N05  C                   MOVE      'C'           XCALL             1
N05  C                   CALL      'SVL006R'
N05  C                   PARM                    XTIAVD
N05  C                   PARM                    XTITDN
N05  C                   PARM                    XCALL
N05  C  N90              MOVE      *ZEROS        WSNR
N05  C  N90              UPDATE    SUBFIL
N05  C                   ENDSR
