     FFIRFB     UF   E           K DISK
     FWSNRCLI   UF A E           K DISK
     FZBARC     O    F   66        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D A4              S              1    DIM(4)                               Input string
     D B4              S              1    DIM(4)                               Output string
     D Æ               S              1    DIM(20)                              Input string
     D Å               S              1    DIM(20)                              Output string
     D                 DS
     D  DATA                   1     66
     D  DATA1                  4     66
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS            10
     D SENDTXT         C                   CONST('Sendings-ID/Consignment')
     D KOLIDTXT        C                   CONST('Kolli-ID/Licence plate')
     D TRANTXT         C                   CONST('Transportør/Carrier')
     D BARPAR          C                   CONST('N,250,N,N,Y,N')
     D                 DS
      * Gør om antall kolli
     D  LANUMA                 1      4  0
     D                 DS
     D  WPCN                   1      4  0
     D  WPCA                   1      4
     D  WPCB                   2      4
     D                 DS
     D  SNDNRDS                1     20
     D  SNDNR_1                1      1
     D  SNDNR_2_20             2     20
     D                 DS
     D  KOID                   1     18
     D  DSIDPK                 1      1
     D  DSIDLA                 2      3
     D  DSIDLE                 4      8
     D  DSIDNR                 9     18
     D                 DS
     D  XTIME                  1     14  0
     D  XTID                   1      4  0
     D  XDD                    7      8  0
     D  XMM                    9     10  0
     D  XÅÅ                   11     14  0
     D  WTIDA                  1      2
     D  WTIDB                  3      4
     D  WDDA                   7      8
     D  WMMA                   9     10
     D  WÅÅA                  11     14
     D                 DS
     D  WscDat                 1      8  0
     D  WscDatÅ                1      4  0
     D  WscDatM                4      6  0
     D  WscDatD                7      8  0
      * Input Parameter
     C     *ENTRY        PLIST
     C                   PARM                    WsUser           10
     C                   PARM                    WFIRM             2
     C                   PARM                    SNDNR            20
     C                   PARM                    ANTKLL            4
     C                   PARM                    POSTNR            4
     C                   PARM                    KOMMENTAR        20
     C                   PARM                    TRANSPORTØR      20
     C                   PARM                    FLAGG             1
      *
      * Open Printerfile
     C                   OPEN      ZBARC                                55
      * Execute init routine only once
     C                   EXSR      SRINIT
      * Juster ALT xx dots til venstre (60 dots er ca 1 cm til venstre)
      * (Forenkler kundetilpasning)
     C                   MOVE      '0  '         LSDOTS            3
     C*                  MOVE      '60 '         LSDOTS            3
      *
      * Loop number of pieces
     C                   Z-ADD     1             WPCN
     C     WPCN          DO        DFNTLA        WPCN
      *
      * Execute Label Init
     C                   EXSR      SR0001
      *
      * Execute Label top Text
     C                   EXSR      SR0010
      * Execute Label Lines vert/hor
     C                   EXSR      SR0005
      * Execute Pieces in Consignment
     C                   EXSR      SR0050
      * Strekkode - Sendingsnr EAN 128
     C     SNDNR         IFNE      *Blanks
     C                   EXSR      SR0190
     C                   end
      * Strekkode - til postnummer
     C     POSTNR        IFNE      *Blanks
     C                   EXSR      SR0040
     C                   end
      * Strekkode - Kolliid
     C                   EXSR      SR0290
      * Execute End Label Format
     C                   EXSR      SREND
      *
     C                   ENDDO
      * Close Prinerfile
     C                   CLOSE     ZBARC                                55
      * End Program
     C                   seton                                        LR
     C                   RETURN
     C*                  seton                                        LR
      *_____________________________________________________
      * Execute Label Init
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      * Send Default Instructions
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    ZBARCA
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    ZBARCA
     C                   MOVE      *BLANKS       KOID
      * Hent kolli-id,
     C     WFIRM         CHAIN     FIRFB                              33
     C                   ADD       1             FIIDNR
     C                   UPDATE    FIRFBR
     C                   MOVE      '3'           DSIDPK
     C                   MOVE      FIIDLA        DSIDLA
     C                   MOVE      FIIDLE        DSIDLE
     C                   MOVEL     FIIDNR        DSIDNR
     C                   MOVE      *ZEROS        UAN22            22
     C                   MOVE      KOID          UAN22
     C                   CALL      'SYGE08'
     C                   PARM                    UAN22
     C                   MOVE      UAN22         KOID
      *
      * WscKOD: U=Umerket gods mottatt/LABEL PRINTET
      *         (M=Merket gods mottatt/koblet)
     C                   MOVE      'U'           WSCKOD
     C                   MOVEL     SNDNR17       WSCSNR
     C                   MOVEL     KOID          WSCCLI
     C                   MOVEL     KOMMENTAR     WSCTXT
     C                   TIME                    XTIME
     C                   MOVE      XDD           WscDatD
     C                   MOVE      XMM           WscDatM
     C                   MOVE      XÅÅ           WscDatÅ
     C                   MOVE      XTID          WscTIM
     C                   MOVE      WSUSER        WscUse
     C                   WRITE     WSNRCLIR
      *
     C                   ENDSR
      *____________________________________________________
      * Execute Label Lines Hor/Vert
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0005        BEGSR
      * First  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,150'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Second horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,345'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Third  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '1,640'       DATA1
     C                   MOVEL     '1,632'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Execute Label top Text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C     LSDOTS        IFNE      '0  '
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     LSDOTS        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
      * Transportørnavn - Ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,360'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     TRANTXT       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Transportørnavn - data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,380'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     TRANSPORTØR   DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Dato /tid merket - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '250,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Merket dato' DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Dato - klokkeslett
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '450,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WDDA          DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WMMA:0        DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WÅÅA:0        DATA1
     C     DATA1         CAT       WTIDA:2       DATA1
     C     DATA1         CAT       ':':0         DATA1
     C     DATA1         CAT       WTIDB:0       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Kommentar   - Ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,420'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kommentar'   DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Kommentar   - Data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,440'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KOMMENTAR     DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Pieces in Consignment
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0050        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,580'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kolli'       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - kollinummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,580'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     WPCN          LANUMA
     C                   MOVE      LANUMA        CHAR4             4
     C                   MOVEA     CHAR4         A4
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B4
     C     A4(X)         DOWEQ     '0'
     C     X             ANDLT     4
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     4
     C                   MOVEA     A4(X)         B4(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B4            B4FELT            4
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     B4FELT        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Tekst - av
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '280,580'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     'AV'          DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - Tot. ant. kolli
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '370,580'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     DFNTLA        LANUMA
     C                   MOVE      LANUMA        CHAR4             4
     C                   MOVEA     CHAR4         A4
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B4
     C     A4(X)         DOWEQ     '0'
     C     X             ANDLT     4
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     4
     C                   MOVEA     A4(X)         B4(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B4            B4FELT            4
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     B4FELT        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *____________________________________________________
      * Strekkode SEND.NR
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0190        BEGSR
      * Send.nr ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,640'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     SENDTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Send.nr data
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,660'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE  (1 parameter er bredde)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>8401'     DATA1
     C     DATA1         CAT       SNDNR17:0     DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,915'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '(401)'       DATA1
     C     DATA1         CAT       SNDNR17:0     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Til postnummer
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0040        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,945'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/to'      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Destination Code
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,962'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      * Text to be printed (421)= internasj. nr / 578= Norge
     C                   move      *blanks       xxlkpn           12
     C                   Eval      XXLKPN = '578'+POSTNR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>8421'     DATA1
     C     DATA1         CAT       XXLKPN:0      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,1215'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed (421)= internasj. nr / 578= Norge
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Eval      DATA1 = '(421)'+XXLKPN
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *____________________________________________________
      * Strekkode KOLLI ID
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0290        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,1250'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KOLIDTXT      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,1267'     DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C*                  MOVEL     WB2           DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>800'      DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,1520'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '(00)'        DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Initialise subroutine, set character set
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WB3               3            B3
     C                   MOVE      'B3'          WB3               3            B3
      *
     C                   MOVEL     WA            WBC               3            B2
     C                   MOVE      'BC'          WBC               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WFR               3            FR
     C                   MOVE      'FR'          WFR               3            FR
      *
     C                   MOVEL     WA            WLS               3            XZ
     C                   MOVE      'LS'          WLS               3            XZ
      *
     C                   Z-ADD     0             ØX                3 0          Index for Ø
     C                   MOVE      *BLANKS       ØAN              12            Num alpha
     C                   MOVE      'N'           ØADEC             1            Decimal Indicator
     C                   Z-ADD     0             ÆX                3 0
      *
      * Kommer inn uten f.brevsnr... Tildel.
     C                   movel     SNDNR         SNDNRDS
     c     SNDNR_1       IFNE      *Blanks
     c     SNDNR_2_20    ANDEQ     *Blanks
     C                   call      'SYGE15'
     c                   parm                    SndNr
     c                   end
     c                   move      SNDNR         SNDNR17          17
     c                   move      ANTKLL        DFNTLA            4 0
      *
      * Fjern evt gamle cll-ID på dette send.nr
     C     SNDNR         IFNE      *blanks
     C     SNDNR17       SETLL     WSNRCLI
     C     SNDNR17       READE     WSNRCLI                                33
     C     *in33         DOWEQ     *OFF
     C                   DELETE    WSNRCLIR
     C     SNDNR17       READE     WSNRCLI                                33
     C                   END
     C                   END
      *
     c                   clear                   WscDat
     c                   clear                   xtime
      *
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to end Label Format
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C     LSDOTS        IFNE      '0  '
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     0             DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *
     OZBARC     E            ZBARCA
     O                       DATA
