             PGM
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in01 på, betyr det avslutt program +
                          fra valgbilde. */
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(10) /* Unikkode +
                          til register SORT. */
             DCL        VAR(&TIME) TYPE(*CHAR) LEN(9)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&NR) TYPE(*DEC) LEN(3 0) VALUE(019)
             DCL        VAR(&PRT) TYPE(*CHAR) LEN(10) /* Printernavn*/
             DCL        VAR(&PT) TYPE(*CHAR) LEN(10) /* Papirtype */

             CALL       PGM(SYFA00) PARM(&IN01)
             IF         COND(&IN01 = '1') THEN(GOTO CMDLBL(SLUTT)) /* +
                          Hvis &IN01 på, avslutter program. */

             RTVDTAARA  DTAARA(*LDA (15 4)) RTNVAR(&AVD)
             CALL       PGM(GETPRT) PARM(&AVD &NR &PRT &PT)
             OVRMSGF    MSGF(QUSERMSG) TOMSGF(SYMSGF)
             OVRPRTF    FILE(SYFA27PP) PAGESIZE(70 80) CPI(10) +
                          OVRFLW(66) OUTQ(&PRT) FORMTYPE(&PT) /* +
                          Pirnterfil av samlefaktura liste */

    /* OPPRETTE SORTERINGSFIL */
             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&TIME)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &TIME)
             RTVDTAARA  DTAARA(FIRMDT (141 10)) RTNVAR(&LIB)
             OVRDBF     FILE(SORT) TOFILE(&LIB/SORT)

             RMVM       FILE(SORT) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(SORT) MBR(&UNIK)
             OVRDBF     FILE(SORT) TOFILE(SORT) MBR(&UNIK)

    /* SKRIVE UT FAKTURA */
             CALL       PGM(SYFA27E)

             RCLRSC
             RMVM       FILE(SORT) MBR(&UNIK)
    /* */
SLUTT:       ENDPGM
