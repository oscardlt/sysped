********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 ny dg logikk  88 er ny logikk
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL SKRIVE UT STOCKRAPPORT (FARLIG GODS)
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 06-09 11-26
      *** LEDIGE INDIKATORER 44-50 53-89 93 94
      **************************************************************
      *
     FCUNDC     if   E             DISK
     FKODTFM    IF   E           K DISK
     FGSSSTK    IF   E           K DISK
     FGSSGDF    IF   E           K DISK
     FGSSORL23  IF   E           K DISK
     FGSSPAF    IF   E           K DISK
     FGSSPOF    IF   E           K DISK
     FGSSBIF    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FGSSCGF    IF   E           K DISK
     FGSSCGL02  IF   E           K DISK
     F                                     RENAME(GSSCGFR:GSSCGF02)
     FGSSCCF    IF   E           K DISK
     FGSSOLF    IF   E           K DISK
     FGSSFGF    IF   E           K DISK
N01  FGSSDGF    IF   E           K DISK
     FFAXLK     IF   E           K DISK
     FCUNDL01   UF   E           K DISK
     FKUNDL01   UF   E           K DISK
     F                                     RENAME(KUNDR:KUNDR2)
     FFIRM      IF   E           K DISK
     FFAXSEN    IF   E           K DISK
     FFAXMANP   O  A E           K DISK    USROPN
     FFAXMANT   UF A E           K DISK
     FSTED2     IF   E           K DISK
     FGSS039P   O    E             PRINTER OFLIND(*IN51)
     F                                     USROPN
     FGSS039D   CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D TAB1            S              1    DIM(6) CTDATA PERRCD(1)
     D TAB2            S             15    DIM(6) ALT(TAB1)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XTNO                   1     12
     D  XAVD                   1      4
     D  XSLASH                 5      5
     D  XOPD                   6     12
     D                 DS
     D  ORSNM                  1     30
     D  XSNM27                 1     27
     D                 DS
     D  ORDSC                  1     30
     D  XDSC27                 1     27
     D  XDSC20                 1     20
     D                 DS
     D  ORDTL                  1      8  0
     D  ORDTLÅ                 1      4  0
     D  ORDTLM                 5      6  0
     D  ORDTLD                 7      8  0
     D                 DS
     D  XDTL                   1      6  0
     D  XDTLD                  1      2  0
     D  XDTLM                  3      4  0
     D  XDTLÅ                  5      6  0
     D                 DS
     D  ORDTWL                 1      8  0
     D  ORDTWÅ                 1      4  0
     D  ORDTWM                 5      6  0
     D  ORDTWD                 7      8  0
     D                 DS
     D  XDTWL                  1      6  0
     D  XDTWLD                 1      2  0
     D  XDTWLM                 3      4  0
     D  XDTWLÅ                 5      6  0
     D                 DS
     D  XCONO1                 1     20
     D  XCONO2                21     40
     D  XCONO3                41     60
     D  XCONO4                61     80
     D  XCONO5                81    100
     D  XCONO6               101    120
     D  CO                     1   1000    DIM(50)
     D                 DS
     D  PATXT1                 1     50
     D  PATXT2                51    100
     D  PATXT3               101    150
     D  PATXT4               151    200
     D  PATXT5               201    250
     D  FT                     1    250    DIM(5)
     D                 DS
     D  GDDSC                  1     55
     D  GDDSCX                 1     48
     D                 DS
     D  USØKKN                 1     30
     D  USØKKO                 1      2
     D  URRN                   3     12
     D  Uemfa                 13     13
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     D UCMD            DS          1024
     D                 DS
     D XCMD21          C                   CONST('OVRPRTF -
     D                                     FILE(GSS039P) -
     D                                     OUTQ(')
     D XCMD22          C                   CONST('PAGESIZE(72 120) -
     D                                     CPI(15) -
     D                                     OVRFLW(66)')
     D XCMD40          C                   CONST('OVRPRTF -
     D                                     FILE(GSS039P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 132) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     FRONTMGN(0 0.4) -
     D                                     DRAWER(3) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(QFAX/QFAXOUTQ) -
     D                                     FORMTYPE(*STD)')
     D XCMD40e         C                   CONST('OVRPRTF -
     D                                     FILE(GSS039P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*scs) -
     D                                     PAGESIZE(72 132) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(SYSPED/OUTMAIL) -
     D                                     FORMTYPE(*STD)')
     D XCMD40B         C                   CONST('OVRPRTF -
     D                                     FILE(GSS039P) -
     D                                     DEVTYPE(*SCS) -
     D                                     PAGESIZE(66 120) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     OVRFLW(60) -
     D                                     OUTQ(FAX/FAXOUT) -
     D                                     FORMTYPE(*STD)')
     D XCMD60          C                   CONST('OVRPRTF -
     D                                     FILE(GSS039P) -
     D                                     PAGESIZE(72 132) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     FRONTMGN(0 0,4) -
     D                                     OVRFLW(66) -
     D                                     DRAWER(3) -
     D                                     PRTTXT(')
     D XCMD61          C                   CONST('OUTQ(')
     D XTXT01          C                   CONST('ON THE WAY     ')
     D                 DS
     D  XTID                   1     12  0
     D  XTID4                  1      4  0
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  FAXNRP                 1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  WSFAXN                 1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     D                UDS
     D  UFIRM                  1      2
     D  UBIUSI               101    110
     D  UWCNO                501    508  0
     D  UWBCD                509    513
     D  UWALL                514    514
     D  UWCG                 515    516
     D  UWLC                 517    521
     D  UWCPRL               522    522
     D  UWFC                 523    525
     D  UWPRT                526    535
     D  UWCNO2               536    543  0
     D  UWCNAM               544    573
     D  UWFAXN               574    588
     D  UWCOUN               589    590
     D  UWRET                591    596
     D  UWCVRP               597    597
     D  UWTIME               598    603  0
     D  UWDATE               606    611  0
     D  UCOVP                612    612
     D  UCOV01               613    652
     D  UCOV02               653    692
     D  UCOV03               693    732
     D  UCOV04               733    772
     D  UCOV05               773    812
     D  UCOV06               813    852
     D  UCOV07               853    892
     D  UCOV08               893    932
     D  UEMAIL               933   1002
     D  Uemailj             1003   1003
     IKUNDR
     I              BANKG                       SYBAGI
     I              POSTG                       SYPOGI
      *
     C                   EXSR      INIT
     C   33              GOTO      SLUTT2
     C     UUTFAX        CABEQ     'J'           START2
     C                   OPEN      GSS039D
     C                   MOVE      BIFC          WSFC
      *
     C     START         TAG
     C  N30              Z-ADD     7             LINNBR
     C  N30
     CANN28              Z-ADD     5             LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   EXFMT     GSS039DA
     C                   EXSR      KDTFMT
     C                   MOVEA     '00000'       *IN(95)
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '000'         *IN(41)
     C                   MOVE      '0'           *IN30
      *
     C   03              MOVE      'J'           USLUTT
     C   03              GOTO      SLUTT
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
      *
     C   04              DO                                                     1<-B
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END                                                    1<-E
      *
     C     START2        TAG
     C                   EXSR      TESTB
     C   30              GOTO      START
     C     *IN10         IFEQ      '1'
     C     WSFAXN        ANDEQ     *BLANKS
     C     EMAIL         andeq     *blanks
     C                   GOTO      START
     C                   END
     C*
     C* VED F10 KALLES FAXBITEN
     C*
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     *IN10         IFEQ      '1'                                          1<-B
     C     UUTFAX        IFNE      'J'                                           2<-B
     C                   EXSR      TEST2
     C   30              GOTO      START
     C                   EXSR      GETFC
     C     FUNK          CABEQ     'A'           START
     C                   GOTO      SLUTT
     C                   END                                                     2<-E
      *
     C                   MOVE      *BLANKS       UCMD
     C     FAXLIB        IFEQ      *BLANKS                                       2<-B
     c     email         ifeq      *blanks
     C     FAXSYS        IFEQ      'B'
     C                   MOVEL     XCMD40B       UCMD
     C                   ELSE
     C                   MOVEL     XCMD40        UCMD
     C                   END
     c                   else
     C                   MOVEL     XCMD40e       UCMD
     c                   end
     C                   ELSE                                                    2
     C     XCMD60        CAT       '.FAX':1      UCMD
     C                   CAT       WSFAXN:0      UCMD
     C                   CAT       ')':1         UCMD
     C                   CAT       XCMD61:0      UCMD
     C                   CAT       FAXLIB:0      UCMD
     C                   CAT       '/':0         UCMD
     C                   CAT       FAXUTK:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   END                                                     2<-E
      *
     C                   ELSE                                                   1
      *
     C     XCMD21        CAT       WSPRT:0       UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD22:1      UCMD
      *
     C                   END                                                    1<-E
      *
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C     STPRT         TAG
      *
     C     *in10         IFNE      '1'
     C     KEYST         KLIST
     C                   KFLD                    STRPRT
     C                   MOVE      wsprt         STRPRT
     C     KEYST         CHAIN     GSSSTK                             55
     C     *IN55         IFEQ      '0'
     C     STRF04        CHAIN     KODTFM                             55
     C                   END
     C                   END
     C* lager stringkoder for skifte av font
     C     stresc        ifne      *blanks
      *
      *
      *
      * ¤1B(¤1B(s0p10h6v0s0b0T      prøver 12 cpi
     c                   move      *blanks       stri01           70
     C     stri01        CAT       stresc:0      stri01
     C     stri01        CAT       '(':0         stri01
     C     stri01        CAT       stresc:0      stri01
     C     stri01        CAT       '(s0p15h6v0':0stri01
     C     stri01        CAT       's0b0T':0     stri01
      *
      *
      * ¤1B(¤1B(s0p15h6v0s0b0T'
     c                   move      *blanks       stri02           70
     C     stri02        CAT       stresc:0      stri02
     C     stri02        CAT       '(':0         stri02
     C     stri02        CAT       stresc:0      stri02
     C     stri02        CAT       '(s0p15h6v0':0stri02
     C     stri02        CAT       's0b0T':0     stri02
      *
      * tvinge prttrait
      * ¤&l0O
     c                   move      *blanks       stri03           70
     C     stri03        CAT       stresc:0      stri03
     C     stri03        CAT       '&l0O':0      stri03
     c                   end
      *
      *
     C                   OPEN      GSS039P
     C                   MOVE      '1'           *IN51
     C                   TIME                    XTID
      *
     C                   MOVE      *ZEROS        XCNO              8 0
     C                   MOVE      *BLANKS       XBCD              5
      *
     C   41WSCNO         IFEQ      99999999                                     1<-B
     C                   MOVE      *ZEROS        YCNO
     C                   ELSE                                                   1
     C                   MOVE      WSCNO         YCNO
     C                   MOVE      WSBCD         YBCD
     C                   END                                                    1<-E
     C   42WSBCD         IFEQ      '99999'                                      1<-B
     C                   MOVE      *BLANKS       YBCD
     C                   ELSE                                                   1
     C                   MOVE      WSBCD         YBCD
     C                   END                                                    1<-E
     C   43              DO                                                     1<-B
     C     WSCG          SETLL     GSSCGL02                           32
     C     WSCG          READE     GSSCGL02                               32
     C   32              GOTO      SLPRT
     C                   MOVE      CGCNO         YCNO
     C                   MOVE      CGCNO         WSCNO
     C                   END                                                    1<-E
      *
     C     STPRT1        TAG
     C     GORK23        SETLL     GSSORL23
     C     STPRT2        TAG
     C     WSCNO         IFEQ      99999999                                     1<-B
     C                   READ      GSSORL23                               33
     C                   ELSE                                                   1
     C     WSBCD         IFEQ      *BLANKS                                       2<-B
     C     GORX23        READE     GSSORL23                               33
     C                   ELSE                                                    2
     C     GORK23        READE     GSSORL23                               33
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C   43
     CAN 33              DO                                                     1<-B
     C     WSCG          READE     GSSCGL02                               32
     C   32              GOTO      SLPRT
     C                   MOVE      CGCNO         YCNO
     C                   MOVE      CGCNO         WSCNO
     C                   MOVE      CGCNO         KUNDNR
     C     CUND1K        CHAIN(N)  CUNDL01                            34
     C   34              MOVE      *BLANKS       KNAVN
     C                   GOTO      STPRT1
     C                   END                                                    1<-E
      *
     C  N33              DO                                                     1<-B
     C     ORST          CABEQ     'P'           STPRT2
n01  C                   setoff                                       88
     C     ORONO         CHAIN     GSSFGF                             32
n01  C   32              seton                                        88
n01  C   32ORONO         CHAIN     GSSDGF                             32
     C   32              GOTO      STPRT2
      *
     C     WSLC          IFNE      *BLANKS                                       2<-B
     C     WSLC          ANDNE     ORLC
     C                   GOTO      STPRT2
     C                   END                                                     2<-E
      *
     C     ORCNO         IFNE      XCNO                                          2<-B
     C                   MOVE      ORCNO         XCNO
     C                   MOVE      ORCNO         KUNDNR
     C                   MOVE      *BLANKS       XLC
     C                   MOVE      *BLANKS       XST
     C     CUND1K        CHAIN(N)  CUNDL01                            34
     C   34              MOVE      *BLANKS       KNAVN
     C                   MOVE      *ZEROS        XSIDE
     C                   MOVE      '1'           *IN51
     C                   END                                                     2<-E
      *
     C                   MOVE      'J'           XPRT              1
     C     ORBCD         IFNE      XBCD                                          2<-B
     C     ORBCD         CHAIN     CDBOAT                             34
     C   34              MOVE      *BLANKS       CBNAB
     C                   MOVE      ORBCD         XBCD
     C                   MOVE      *BLANKS       XLC
     C                   MOVE      *BLANKS       XST
     C                   MOVE      *ZEROS        XSIDE
     C                   MOVE      '1'           *IN51
     C                   END                                                     2<-E
      *
     C                   MOVE      *BLANKS       CO
     C     ORONO         SETLL     GSSPOF                             34
     C                   MOVE      *ZEROS        XN
     C     ORONO         READE     GSSPOF                                 34
     C     *IN34         DOWEQ     '0'
     C                   ADD       1             XN
     C                   MOVE      POCONO        CO(XN)
     C     ORONO         READE     GSSPOF                                 34
     C  N34              END
      *
     C     XCONO4        COMP      *BLANKS                            3535
     C     XCONO5        COMP      *BLANKS                            3636
     C     XCONO6        COMP      *BLANKS                            3737
      *
     C                   MOVE      ORDTLD        XDTLD
     C                   MOVE      ORDTLM        XDTLM
     C                   MOVE      ORDTLÅ        XDTLÅ
     C                   MOVE      ORDTWD        XDTWLD
     C                   MOVE      ORDTWM        XDTWLM
     C                   MOVE      ORDTWÅ        XDTWLÅ
      *
     C     ORLC          IFNE      XLC                                            3<-B
     C                   MOVE      ORLC          XLC               5
     C                   MOVE      ORST          XST               1
     C     XLC           CHAIN     STED2                              34
     C   34              MOVE      *BLANKS       XLCNV
     C   34              MOVEL     XLC           XLCNV
     C  N34              MOVE      ST2NVN        XLCNV
     C   51              ADD       1             XSIDE
     C   51*IN52         IFEQ      '0'
     C     *IN10         ANDEQ     '1'
     C                   MOVE      '1'           *IN52
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   MOVE      '0'           *IN52
     C                   ELSE
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   END
     C   51              MOVE      '0'           *IN51
     C                   WRITE     GSS039PD
     C                   END                                                      3<-E
      *
     C   51              ADD       1             XSIDE
     C   51*IN52         IFEQ      '0'
     C     *IN10         ANDEQ     '1'
     C                   MOVE      '1'           *IN52
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   MOVE      '0'           *IN52
     C                   ELSE
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   END
     C   51              MOVE      '0'           *IN51
     C     ORONO         CHAIN     GSSPAF                             34
     C   34              MOVE      'C'           PAPKD
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE     GSSOLF                                 31
     C                   EVAL      XLOK = ORPOS1
     C  N31              CAT       OLLC:1        XLOK
     C                   MOVE      XLOK          XLOKGM           20
     C                   WRITE     GSS039PB
     C     ORONO         SETLL     GSSGDF                             34
S01  C*    2             DO        6             XN                1 0            3<-B
N01  C     2             DO        50            XN                3 0            3<-B
     C     CO(XN)        IFNE      *BLANKS                                         4<-B
     C                   MOVE      CO(XN)        XCON
     C   51              ADD       1             XSIDE
     C   51*IN52         IFEQ      '0'
     C     *IN10         ANDEQ     '1'
     C                   MOVE      '1'           *IN52
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   MOVE      '0'           *IN52
     C                   ELSE
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   END
     C   51              MOVE      '0'           *IN51
     C                   IF        *IN31 = *OFF
     C     ORONO         READE     GSSOLF                                 31
     C                   IF        *IN33 = *OFF
     C                   EVAL      XLOK = ORPOS1
     C                   CAT       OLLC:1        XLOK
     C                   IF        XLOK <> XLOKGM
     C                   EVAL      GDDSC = *BLANKS
     C                   MOVE      XLOK          GDDSC
     C                   MOVE      XLOK          XLOKGM
     C                   END
     C                   END
     C                   END
     C                   IF        *IN31
     C  N34ORONO         READE     GSSGDF                                 34
     C   34              MOVE      *BLANKS       GDDSC
     C                   END
     C                   WRITE     GSS039PC
     C                   END                                                       4<-E
     C                   MOVE      *BLANKS       XSTATU
     C                   MOVE      *BLANKS       XTNO
     C                   END                                                      3<-E
      *
     C                   IF        *IN31 = *OFF
     C     ORONO         READE     GSSOLF                                 31
     C                   IF        *IN33 = *OFF
     C                   EVAL      XLOK = ORPOS1
     C                   CAT       OLLC:1        XLOK
     C                   IF        XLOK <> XLOKGM
     C                   EVAL      GDDSC = *BLANKS
     C                   MOVE      XLOK          GDDSC
     C                   MOVE      XLOK          XLOKGM
     C                   END
     C                   END
     C                   END
     C                   IF        *IN31
     C  N34ORONO         READE     GSSGDF                                 34
     C                   END
      *
     C     *IN34         DOWEQ     '0'                                            3<-B
     C     *IN31         OREQ      '0'
     C   51              ADD       1             XSIDE
     C   51*IN52         IFEQ      '0'
     C     *IN10         ANDEQ     '1'
     C                   MOVE      '1'           *IN52
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   MOVE      '0'           *IN52
     C                   ELSE                                                      4
     C                   WRITE     GSS039PA
     C                   WRITE     GSS039PA2
     C                   END                                                       4<-E
     C   51              MOVE      '0'           *IN51
     C                   WRITE     GSS039PE
     C                   IF        *IN31 = *OFF
     C     ORONO         READE     GSSOLF                                 31
     C                   IF        *IN33 = *OFF
     C                   EVAL      XLOK = ORPOS1
     C                   CAT       OLLC:1        XLOK
     C                   IF        XLOK <> XLOKGM
     C                   EVAL      GDDSC = *BLANKS
     C                   MOVE      XLOK          GDDSC
     C                   MOVE      XLOK          XLOKGM
     C                   END
     C                   END
     C                   END
     C                   IF        *IN31
     C  N34ORONO         READE     GSSGDF                                 34
     C                   END
     C                   ENDDO                                                    3<-E
      *
     C                   GOTO      STPRT2
     C                   END                                                    1<-E
      *
     C     SLPRT         TAG
     C                   CLOSE     GSS039P
      *
     C     *IN10         IFEQ      '1'                                          1<-B
     C     XPRT          ANDEQ     'J'
     C                   EXSR      SNDFAX
     C                   END                                                    1<-E
     C     UUTFAX        CABEQ     'J'           SLUTT2
      *
     C     SLUTT         TAG
     C                   CLOSE     GSS039D
      *
     C     SLUTT2        TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     WSCNO         IFNE      0
     C     WSCNO         IFEQ      99999999
     C                   MOVE      *BLANKS       WSBCD
     C                   ELSE
     C                   MOVE      WSCNO         KUNDNR
     C     CUND1K        CHAIN(N)  CUNDL01                            99
     C   99              MOVE      'GSS0005'     MSGNR
     C   99              GOTO      SLTB
     C     BICGR         IFNE      *BLANKS
     C     WSCNO         CHAIN     GSSCGF                             99
     C  N99BICGR         COMP      CGCG                               9999
     C   99              MOVE      'GSS0030'     MSGNR
     C   99              GOTO      SLTB
     C                   END
     C                   END
     C                   MOVE      '1'           *IN41
     C                   END
      *
     C                   MOVE      *BLANKS       XNAB             30
     C     WSBCD         IFNE      *BLANKS
     C     WSBCD         CHAIN     CDBOAT                             98
     C   98              MOVE      'GSS0032'     MSGNR
     C   98              GOTO      SLTB
     C                   MOVE      CBKN          YCNO
     C                   MOVE      CBNAB         XNAB
     C   41WSCNO         IFNE      99999999
     C     CBKN          COMP      WSCNO                              9898
     C   98              MOVE      'GSS0057'     MSGNR
     C   98              GOTO      SLTB
     C                   MOVE      CBKN          KUNDNR
     C     CUND1K        CHAIN(N)  CUNDL01                            33
     C                   END
     C  N41              MOVE      '1'           *IN42
     C  N98              IF        ((WSFAXN = *BLANKS) AND (EMAIL = *BLANKS))
     C                   EVAL      WSCNO2 = CBKN
     C                   EVAL      WSFAXN = CBFAX
     C                   EVAL      EMAIL  = CBEPOS
     C                   END
     C                   END
      *
     C     WSCG          IFNE      *BLANKS
     C     WSCNO         ANDEQ     0
     C     WSBCD         ANDEQ     *BLANKS
     C     WSCG          CHAIN     GSSCCF                             97
     C   97              MOVE      'GSS0016'     MSGNR
     C   97              GOTO      SLTB
     C                   MOVE      '1'           *IN43
     C                   END
      *
     C     WSPRT         COMP      *BLANKS                                96
     C   96              MOVE      'GSS0042'     MSGNR
     C   96              GOTO      SLTB
      *
     C     WSFC          CHAIN     GSSFIF                             90
     C   90              MOVE      'GSS0052'     MSGNR
     C   90              GOTO      SLTB
      *
     C     WSCNO2        IFNE      0
     C                   MOVE      WSCNO2        KUNDNR
     C     CUND1K        CHAIN(N)  CUNDL01                            95
     C   95              MOVE      'GSS0005'     MSGNR
     C   95              GOTO      SLTB
     C     WSCNAM        IFEQ      *BLANKS
     C                   MOVE      KNAVN         WSCNAM
     C                   END
     C     WSFAXN        IFEQ      *BLANKS
     c     email         andeq     *blanks
     C                   MOVEL     TFAXNR        WSFAXN
     C                   END
     C     WSCOUN        IFEQ      *BLANKS
     C                   MOVE      SYLAND        WSCOUN
     C                   END
     C                   END
      *
     C     SLTB          TAG
     C  N41
     CANN42
     CANN43              MOVE      'GSS0055'     MSGNR
     C  N41
     CANN42
     CANN43              MOVE      '1'           *IN99
     C   99              Z-ADD     5             LINNBR
     C   99              Z-ADD     22            POSNBR
     C   98              Z-ADD     6             LINNBR
     C   98              Z-ADD     22            POSNBR
     C   97              Z-ADD     8             LINNBR
     C   97              Z-ADD     22            POSNBR
     C   90              Z-ADD     11            LINNBR
     C   90              Z-ADD     22            POSNBR
     C   96              Z-ADD     13            LINNBR
     C   96              Z-ADD     22            POSNBR
     C   95              Z-ADD     15            LINNBR
     C   95              Z-ADD     22            POSNBR
     C   99
     COR 98
     COR 97
     COR 96
     COR 90
     COR 95              MOVE      '1'           *IN30
      *
     C     *IN05         IFNE      '1'
     C     *IN10         ANDNE     '1'
     C     *IN30         ANDNE     '1'
     C                   MOVE      'GSS0064'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG            1 0
      *
     C  N28
     CANN29LINNBR        IFEQ      5
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C     WSCNO         PARM      WSCNO         UKUNDN            8 0
     C                   PARM      FIFIRM        UFIRM             2
     C                   PARM                    USØKKN           30
     C* RETUR MED KONTAKTPERS
     C     USØKKO        IFEQ      'KP'
     C                   MOVE      URRN          RRN              10 0
     C     RRN           CHAIN     CUNDC                              31
     C  N31              MOVE      CCOMPN        WSCNO2
     C  N31              MOVEL     cfax          wsfaxn
     C  N31              MOVEL     CEMAIL        Email
     c     uemfa         ifeq      'F'
     C  N31              MOVEL     CFAX          wsfaxn
     c                   else
     c                   move      *blanks       wsfaxn
     c                   end
     c     uemfa         ifeq      'E'
     C  N31              MOVEL     CEMAIL        Email
     c                   else
     c                   move      *blank        email
     c                   end
     C                   END
     C                   GOTO      SLSØK
     C                   END
      *
     C  N28
     CANN29LINNBR        IFEQ      6
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     24
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSBCD
     C                   GOTO      SLSØK
     C                   END
      *
     C  N28LINNBR        IFEQ      8
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     23
     C                   CALL      'GSS002R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSCG
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     24
     C                   CALL      'GSS004R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSFC
     C                   GOTO      SLSØK
     C                   END
      *
     C  N28
     CANN29LINNBR        IFEQ      15
     C                   MOVEl     wscnam        USØKKN           30
     C                   CALL      'SOEKKUN'
     C     WSCNO2        PARM      WSCNO2        UKUNDN            8 0
     C                   PARM      FIFIRM        UFIRM             2
     C                   PARM                    USØKKN           30
     C* RETUR MED KONTAKTPERS
     C     USØKKO        IFEQ      'KP'
     C                   MOVE      URRN          RRN              10 0
     C     RRN           CHAIN     CUNDC                              31
     C  N31              MOVE      CCOMPN        WSCNO2
     C  N31              MOVEL     cfax          wsfaxn
     C  N31              MOVEL     CEMAIL        Email
     c     uemfa         ifeq      'F'
     C  N31              MOVEL     CFAX          wsfaxn
     c                   else
     c                   move      *blanks       wsfaxn
     c                   end
     c     uemfa         ifeq      'E'
     C  N31              MOVEL     CEMAIL        Email
     c                   else
     c                   move      *blank        email
     c                   end
     C                   END
     C                   GOTO      SLSØK
     C                   END
      *
      *
     C  N28
     CANN29LINNBR        IFEQ      17
     C     LO:UP         XLATE     Email         usok
     C                   CALL      'VCUNDC2R'
     C                   PARM                    FIFIRM
     C                   PARM                    USOK             30
     C                   PARM                    URRN2            10 0
     c                   parm                    epofax            1
     C     urrn2         CHAIN     CUNDC                              31
     C  N31              MOVE      CCOMPN        WSCNO2
     c     epofax        ifne      'E'
     C  N31              MOVEL     CFAX          wsfaxn
     c                   else
     c                   move      *blanks       wsfaxn
     c                   end
     c     epofax        ifne      'F'
     C  N31              MOVEL     CEMAIL        Email
     c                   else
     c                   move      *blank        email
     c                   end
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'GSS0013'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    UUTFAX            1
     C                   PARM                    USLUTT            1
      *
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     GORK23        KLIST
     C                   KFLD                    YCNO
     C                   KFLD                    YBCD
     C     GORX23        KLIST
     C                   KFLD                    YCNO
     C     GORY12        KLIST
     C                   KFLD                    ORBCD
     C                   KFLD                    ORLC
     C                   KFLD                    YST1
     C                   MOVE      '9'           YST1
     C     GORZ12        KLIST
     C                   KFLD                    ORBCD
     C                   KFLD                    ORLC
     C                   KFLD                    YST2
     C                   MOVE      '0'           YST2
     C     *LIKE         DEFINE    ORCNO         YCNO
     C     *LIKE         DEFINE    ORBCD         YBCD
     C     *LIKE         DEFINE    ORST          YST1
     C     *LIKE         DEFINE    ORST          YST2
      *
     C     UBIUSI        CHAIN     GSSBIF                             33
     C     *IN33         IFEQ      '0'
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     FIFIRM        CHAIN     FAXSEN                             38
      *
     C                   MOVE      BIPRT         WSPRT
     C                   MOVE      *ZEROS        WSCNO
     C                   MOVE      *BLANKS       XTNO
     C     BICNO         IFNE      0
     C                   MOVE      '1'           *IN28
     C                   MOVE      BICNO         WSCNO
     C                   ELSE
     C     BICGR         IFNE      *BLANKS
     C                   MOVE      '1'           *IN29
     C                   MOVE      BICGR         WSCG
     C                   END
     C                   END
      *
     C     UUTFAX        IFEQ      'J'
     C                   MOVE      UWCNO         WSCNO
     C                   MOVE      UWBCD         WSBCD
     C                   MOVE      UWCG          WSCG
     C                   MOVE      UWLC          WSLC
     C                   MOVE      UWFC          WSFC
     C                   MOVE      UWPRT         WSPRT
     C                   MOVE      UWCNO2        WSCNO2
     C                   MOVE      UWCNAM        WSCNAM
     C                   MOVE      UWFAXN        WSFAXN
     c                   move      uemail        email
     c                   move      uemailj       emailj
     C                   MOVE      UWCOUN        WSCOUN
     C                   MOVE      UWRET         FAXRET
     C                   MOVE      UWCVRP        WSCVRP
     C                   MOVE      UWTIME        WSTIME
     C                   MOVE      UWDATE        WSDATE
     C                   MOVE      UCOVP         COVP
     C                   MOVE      UCOV01        COV01
     C                   MOVE      UCOV02        COV02
     C                   MOVE      UCOV03        COV03
     C                   MOVE      UCOV04        COV04
     C                   MOVE      UCOV05        COV05
     C                   MOVE      UCOV06        COV06
     C                   MOVE      UCOV07        COV07
     C                   MOVE      UCOV08        COV08
     C                   MOVE      '1'           *IN10
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *
     C*
     C***********************************************
     C     TEST2         BEGSR
     C***********************************************
     C     KUKEY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSCNO2
      *
     C     WSCNO2        IFEQ      *ZEROS
     C     WSCNO         ANDNE     99999999
     C                   MOVE      WSCNO         WSCNO2
     C                   END
     C     KUKEY         CHAIN(N)  CUNDL01                            31
      *
     C  N31WSCOUN        IFEQ      *BLANKS
     C                   MOVE      SYLAND        WSCOUN
     C                   END
      *
     C  N31WSFAXN        IFEQ      *BLANKS
     C     EMAIL         andeq     *blanks
     C                   MOVE      TFAXNR        WSFAXN
     C                   END
      *
     C  N31WSFAXN        IFEQ      *BLANKS
     C     EMAIL         andeq     *blanks
     C                   SETON                                        30
     C   30              MOVE      'GSS0060'     MSGNR
     C   30              GOTO      SLTB2
     C                   END
      *
      * BÅDE FAX OG EPOST-ADRESSE LAGT INN
     C     wsfaxn        IFNE      *BLANKS
     C     EMail         ANDNE     *BLANKS
     C                   SETON                                        30
     C   30              MOVE      'SHU0538'     msgnr
     C   30              GOTO      SLTB2
     C                   END
      *
      *
     C     WSTIME        IFNE      *ZEROS
     C     WSDATE        ANDEQ     *ZEROS
     C                   MOVE      'GSS0062'     MSGNR
     C                   SETON                                        3091
     C                   GOTO      SLTB2
     C                   END
      *
     C     WSTIME        IFEQ      *ZEROS
     C     WSDATE        ANDNE     *ZEROS
     C                   MOVE      'GSS0062'     MSGNR
     C                   SETON                                        3091
     C                   GOTO      SLTB2
     C                   END
      *
     C     WSTIME        IFLT      0
     C     WSTIME        ORGT      235959
     C                   MOVE      'GSS0063'     MSGNR
     C                   SETON                                        3091
     C                   GOTO      SLTB2
     C                   END
      *
      *** TEST DATO
     C     WSDATE        IFNE      *ZEROS
     C                   CALL      'TESTDATO'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      92
     C   96
     CANN30              MOVE      'GSS0060'     MSGNR
     C   96              SETON                                        30
     C   30              GOTO      SLTB2
     C                   END
      *
     C     WSCOUN        IFNE      *BLANKS
     C     WSCOUN        CHAIN     FAXLK                              33
     C     FAX05A        IFEQ      FAX05B
     C                   MOVE      *BLANKS       FAXRET
     C                   END
     C                   END
      *
     C     SLTB2         ENDSR
      *
     C***********************************************
     C     GETFC         BEGSR
     C***********************************************
     C     WSCVRP        IFEQ      'J'
     C     WSCVRP        OREQ      'Y'
     C                   MOVE      'J'           COVP              1
     C                   MOVE      *BLANKS       COV01
     C                   MOVE      *BLANKS       COV03
     C                   MOVE      *BLANKS       COV04
     C                   MOVE      *BLANKS       COV07
     C                   MOVE      *BLANKS       COV08
     C*FAX COVERPAGE
     C     Email         IFEQ      *BLANKS
     C                   MOVEL     FIFT          COV05
     C                   CALL      'SYGE12CL'
     C                   PARM                    USE              10
     C                   PARM                    NVN              40
     C                   MOVEL     NVN           COV06
     C                   MOVEL     KNAVN         COV02
     C                   MOVEL     ADR1          COV03
     C                   CALL      'FAXCVP'
     C                   PARM                    COV01            40
     C                   PARM                    COV02            40
     C                   PARM                    COV03            40
     C                   PARM                    COV04            40
     C                   PARM                    COV05            40
     C                   PARM                    COV06            40
     C                   PARM                    COV07            40
     C                   PARM                    COV08            40
     C                   PARM                    FUNK              1
     C*EPOST COVERPAGE
     C                   ELSE
     C                   CALL      'EPOCVP'
     C                   PARM                    COV01
     C                   PARM                    COV02
     C                   PARM                    COV03
     C                   PARM                    COV04
     C                   PARM                    COV05
     C                   PARM                    COV06
     C                   PARM                    COV07
     C                   PARM                    COV08
     C                   PARM                    FUNK
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       FUNK
     C                   END
      *
     C     FUNK          IFNE      'A'
     C                   MOVE      'J'           UUTFAX
     C                   MOVE      WSCNO         UWCNO
     C                   MOVE      WSBCD         UWBCD
     C                   MOVE      WSCG          UWCG
     C                   MOVE      WSLC          UWLC
     C                   MOVE      WSFC          UWFC
     C                   MOVE      WSPRT         UWPRT
     C                   MOVE      WSCNO2        UWCNO2
     C                   MOVE      WSCNAM        UWCNAM
     C                   MOVE      WSFAXN        UWFAXN
     C                   MOVE      WSCOUN        UWCOUN
     C                   MOVE      FAXRET        UWRET
     C                   MOVE      WSCVRP        UWCVRP
     C                   MOVE      WSTIME        UWTIME
     C                   MOVE      WSDATE        UWDATE
     C                   MOVE      COVP          UCOVP
     C                   MOVE      COV01         UCOV01
     C                   MOVE      COV02         UCOV02
     C                   MOVE      COV03         UCOV03
     C                   MOVE      COV04         UCOV04
     C                   MOVE      COV05         UCOV05
     C                   MOVE      COV06         UCOV06
     C                   MOVE      COV07         UCOV07
     C                   MOVE      COV08         UCOV08
     C                   MOVE      email         Uemail
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SNDFAX        BEGSR
     C***********************************************
      *
      * OPPDATERER KUNDEREGISTER
      *
     C     WSFAXN        IFNE      *BLANKS
     c     email         orne      *blanks
     C     TFAXNR        IFEQ      *BLANKS
     C     KUKEY         CHAIN     CUNDL01                            33
     C  N33              MOVE      WSFAXN        TFAXNR
     C  N33              EXCEPT    UPD
     C     KUKEY         CHAIN     KUNDL01                            33
     C  N33              MOVE      WSFAXN        TFAXNR
     C  N33              EXCEPT    UPD2
     C                   END
     C                   END
     C*
     C     FAXRET        IFNE      *BLANKS
     C                   EXSR      FAXFIX
     C                   ELSE
     C                   MOVEL     WSFAXN        FAXNRP
     C                   END
      *
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
     C     WSTIME        IFNE      *ZEROS
     C     WSDATE        IFNE      *ZEROS
     C                   MOVE      *BLANKS       PTIME
     C                   MOVEL     *BLANKS       PDATE
     C                   MOVEL     WSTIME        PTIME
     C                   MOVEL     WSDATE        PDATE
     C                   END
     C                   END
     C                   MOVE      'B'           UUKODE            1
     C                   MOVEL     'STOCKREP'    DOKNAV           12
     C                   MOVE      'ORT '        DOKNAV
     C                   MOVE      *ZEROS        FAXAVD            4
     C                   MOVE      *ZEROS        FAXOPD            7
     C                   MOVE      *ZEROS        FAXTUR            8
     C                   MOVEL     'GSS039P'     FILEN            10
     C     COVP          IFEQ      ' '
     C                   MOVE      'N'           COVP
     C                   END
      *
     C     FAXSYS        IFEQ      'F'
     C     Email         ORNE      *BLANKS
     C     FAXLIB        IFEQ      *BLANKS
     C                   MOVE      'N'           EmailJ            1
     C     Email         IFNE      *BLANKS
     C                   MOVE      'J'           EmailJ
     c                   movel     'Stockreport' emne             40
     c                   CAT       XNAB:1        EMNE
     C                   END
     C                   CALL      'GSS039C2'
     C                   PARM                    COVP
     C                   PARM                    UQJOB
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    FAXNRP
     C                   PARM                    FILEN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    COV01            40
     C                   PARM                    COV02            40
     C                   PARM                    COV03            40
     C                   PARM                    COV04            40
     C                   PARM                    COV05            40
     C                   PARM                    COV06            40
     C                   PARM                    COV07            40
     C                   PARM                    COV08            40
     C                   PARM                    Email
     c                   parm                    emne
     C                   PARM                    EmailJ
     C                   ELSE
      * VED FAX400 SENDER SYSTEMET AUTOMATISK FRA UTKØ
     C                   END
      *
     c     email         ifne      *blanks
     c                   movel     'MAIL'        faxnrp
     c                   movel     email         knavn
     c                   end
     C                   MOVEL     UQUSER        MAPPE            20
     C                   CALL      'FAX013'
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    UQJOB
     C                   PARM                    FAXNRP
     C                   PARM                    DOKNAV
     C                   PARM                    MAPPE
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    KNAVN
     C                   PARM                    FAXAVD
     C                   PARM                    FAXOPD
     C                   PARM                    FAXTUR
     C                   PARM                    UUKODE
     C                   END
      *
     C     FAXSYS        IFEQ      'B'
     C     Email         ANDEQ     *BLANKS
     C     FIFIRM        CHAIN     FAXMANT                            33
     C   33              Z-ADD     1             UNIK
     C  N33              ADD       1             UNIK
     C   33              WRITE     FAXMANTR
     C  N33              UPDATE    FAXMANTR
     C                   EVAL      PRTFIL = 'GSS039P'
     C                   OPEN      FAXMANP
     C                   MOVE      UQNBR         JOBNR
     C                   EVAL      KNAVN = WSCNAM
     C                   EVAL      FINAVN = FIFT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           PUDATE
     C                   EXCEPT    SKRIV
     C                   CLOSE     FAXMANP
     C                   CALL      'GSS039C3'
     C                   PARM                    WSCNAM
     C                   PARM                    FAXNRP
     C                   PARM                    UNIK
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    PRTFIL           10
     C                   PARM                    DOKNAV
     C                   PARM                    UCOVP
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   END
      *
     C                   ENDSR
      *
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   MOVE      UWRET         FAXRET
     C                   MOVE      UWFAXN        WSFAXN
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDATE        XDTFMT            4 0
     C                   MOVEL     WSDATE        UDT1              2 0
     C                   MOVEL     XDTFMT        UDT2              2 0
     C                   MOVE      XDTFMT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     OKUNDR     E            UPD
     O                       TFAXNR
     OKUNDR2    E            UPD2
     O                       TFAXNR
     OFAXMANR   EADD         SKRIV
     O                       UNIK
     O                       FAXNRP
     O                       PTIME
     O                       PDATE
     O                       KUNDNR
     O                       KNAVN
     O                       TIL
     O                       FRA
     O                       EMNE
     O                       FINAVN
     O                       JOBNR
     O                       PUDATE
**
PPending
0On stock
1Packinglist
2Packinglist
3Proforma inv.
4Proforma inv.
