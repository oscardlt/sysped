      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TSVE012R MODULE(*LIBL/TSVE012R *LIBL/INCGI)
CRTPGM*        ACTGRP(*NEW) AUT(*USE)
      *
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     Fsvev      UF A E           K DISK    USROPN
     F                                     PREFIX(X)
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D svev_SYAVA      S              4
     D svev_SYAV       S              4  0
     D svev_SYOPA      S              7
     D svev_SYOP       S              7  0
     D svev_SYLIA      S              5
     D svev_SYLI       S              5  0
     D WMODE           S              2
     D SVEV_KOTAA      S              5
     D SVEV_KOTA       S              5  0
     D SVEV_KOT2A      S              5
     D SVEV_KOT2       S              5  0
     D SVEV_KOT3A      S              5
     D SVEV_KOT3       S              5  0
     D SVEV_KOT4A      S              5
     D SVEV_KOT4       S              5  0
     D SVEV_KOT5A      S              5
     D SVEV_KOT5       S              5  0
     D SVEV_KOSL       S              4
     D SVEV_KOS2       S              4
     D SVEV_KOS3       S              4
     D SVEV_KOS4       S              4
     D SVEV_KOS5       S              4
     D SVEV_VASL       S             70
     D SVEV_VAS2       S             70
     D SVEV_VAS3       S             70
     D SVEV_VAS4       S             70
     D SVEV_VAS5       S             70
     D SVEV_GODM       S             42
     D SVEV_GOD2       S             42
     D SVEV_GOD3       S             42
     D SVEV_GOD4       S             42
     D SVEV_GOD5       S             42
     D SVEV_VANOA      S              5
     D SVEV_VANO       S              5  0
     D SVEV_VATA       S              8
     D SVEV_VATI       S              4
     D SVEV_VAT4       S              4
     D SVEV_VAT5       S              4
     D SVEV_ULKD       S              2
     D SVEV_BRUTA      S             14
     D SVEV_BRUT       S             14  3
     D SVEV_EUP1       S              4
     D SVEV_EUP2       S              3
     D SVEV_NETOA      S             14
     D SVEV_NETO       S             14  3
     D SVEV_KONO       S              3
     D SVEV_ANKVA      S              9
     D SVEV_ANKV       S              9  0
     D SVEV_SUKO       S              5
     D SVEV_SUK6       S              5
     D SVEV_SUKB       S              5
     D SVEV_SUTX       S             70
     D SVEV_SUT2       S             70
     D SVEV_SUT3       S             70
     D SVEV_SUT4       S             70
     D SVEV_SUT5       S             70
     D SVEV_SUT6       S             70
     D SVEV_SUT7       S             70
     D SVEV_SUT8       S             70
     D SVEV_SUT9       S             70
     D SVEV_SUTA       S             70
     D SVEV_SUTB       S             70
     D SVEV_SUTC       S             70
     D SVEV_SUTD       S             70
     D SVEV_SUTE       S             70
     D SVEV_SUTF       S             70
     D SVEV_SUOKA      S             11
     D SVEV_SUOK       S             11  0
     D SVEV_SUKRA      S             11
     D SVEV_SUKR       S             11  0
     D SVEV_SUARA      S             11
     D SVEV_SUAR       S             11  0
     D SVEV_ATIN       S              3
     D SVEV_STVAA      S             11
     D SVEV_STVA2A     S             11
     D SVEV_STVA       S             11  0
     D SVEV_STVA2      S             11  0
     D SVEV_FABLA      S             11
     D SVEV_FABL       S             11  3
     D SVEV_BETK       S              1
     D SVEV_KOMR       S             70
     D SVEV_FNKD       S              4
     D SVEV_BIT1       S              4
     D SVEV_BIT2       S              4
     D SVEV_BIT3       S              4
     D SVEV_BIT4       S              4
     D SVEV_BIT5       S              4
     D SVEV_BIT6       S              4
     D SVEV_BIT7       S              4
     D SVEV_BIT8       S              4
     D SVEV_BIT9       S              4
     D SVEV_BII1       S             35
     D SVEV_BII2       S             35
     D SVEV_BII3       S             35
     D SVEV_BII4       S             35
     D SVEV_BII5       S             35
     D SVEV_BII6       S             35
     D SVEV_BII7       S             35
     D SVEV_BII8       S             35
     D SVEV_BII9       S             35
     D SVEV_CO01       S             17
     D SVEV_CO02       S             17
     D SVEV_CO03       S             17
     D SVEV_CO04       S             17
     D SVEV_CO05       S             17
     D SVEV_CO06       S             17
     D SVEV_CO07       S             17
     D SVEV_CO08       S             17
     D SVEV_CO09       S             17
     D SVEV_CO10       S             17
     D SVEV_CO11       S             17
     D SVEV_CO12       S             17
     D SVEV_CO13       S             17
     D SVEV_CO14       S             17
     D SVEV_CO15       S             17
     D SVEV_CO16       S             17
     D SVEV_CO17       S             17
     D SVEV_CO18       S             17
     D SVEV_CO19       S             17
     D SVEV_CO20       S             17
     D SVEV_TIK1       S              1
     D SVEV_TIK2       S              1
     D SVEV_TIK3       S              1
     D SVEV_TIK4       S              1
     D SVEV_TIK5       S              1
     D SVEV_TIK6       S              1
     D SVEV_TIK7       S              1
     D SVEV_TIK8       S              1
     D SVEV_TIK9       S              1
     D SVEV_TIT1       S              3
     D SVEV_TIT2       S              3
     D SVEV_TIT3       S              3
     D SVEV_TIT4       S              3
     D SVEV_TIT5       S              3
     D SVEV_TIT6       S              3
     D SVEV_TIT7       S              3
     D SVEV_TIT8       S              3
     D SVEV_TIT9       S              3
     D SVEV_TIX1       S             35
     D SVEV_TIX2       S             35
     D SVEV_TIX3       S             35
     D SVEV_TIX4       S             35
     D SVEV_TIX5       S             35
     D SVEV_TIX6       S             35
     D SVEV_TIX7       S             35
     D SVEV_TIX8       S             35
     D SVEV_TIX9       S             35
     D SVEV_LAGI       S             14
     D SVEV_LAGT       S              1
     D SVEV_LAGL       S              2
     D SVEV_CALL       S              2
     D SVEV_ERR        S              1
     D SVEV_LIGH       S              1
     D JSONstring      S          32000
     D Error           S            150

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C  N50              EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬svev_syav¬ : ¬'+%trim(%editc(svev_SYAV:'Z'))+'¬, '
        +'¬svev_syop¬ : ¬'+%trim(%editc(svev_SYOP:'Z'))+'¬, '
        +'¬svev_syli¬ : ¬'+%trim(%editc(svev_SYLI:'Z'))+'¬, '
        +'¬mode¬ : ¬'+%trim(WMODE)+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     c                   eval      JSONstring ='"lineupdate" : ['
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     svev

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      svev_SYAVA = zhbgetvar('AVD')
     C                   EVAL      svev_SYAV  = c2n2(svev_SYAVA)
     C                   EVAL      svev_SYOPA = zhbgetvar('OPD')
     C                   EVAL      svev_SYOP  = c2n2(svev_SYOPA)
     C                   EVAL      svev_SYLIA = zhbgetvar('LIN')
     C                   EVAL      svev_SYLI  = c2n2(svev_SYLIA)
     C                   EVAL      WMODE  = zhbgetvar('MODE')
     C                   EVAL      SVEV_KOTAA = zhbgetvar('SVEV_KOTA')
     C                   EVAL      SVEV_KOTA = c2n2(SVEV_KOTAA)
     C                   EVAL      SVEV_KOT2A = zhbgetvar('SVEV_KOT2')
     C                   EVAL      SVEV_KOT2 = c2n2(SVEV_KOT2A)
     C                   EVAL      SVEV_KOT3A = zhbgetvar('SVEV_KOT3')
     C                   EVAL      SVEV_KOT3 = c2n2(SVEV_KOT3A)
     C                   EVAL      SVEV_KOT4A = zhbgetvar('SVEV_KOT4')
     C                   EVAL      SVEV_KOT4 = c2n2(SVEV_KOT4A)
     C                   EVAL      SVEV_KOT5A = zhbgetvar('SVEV_KOT5')
     C                   EVAL      SVEV_KOT5 = c2n2(SVEV_KOT5A)
     C                   EVAL      SVEV_KOSL  = zhbgetvar('SVEV_KOSL')
     C                   EVAL      SVEV_KOS2  = zhbgetvar('SVEV_KOS2')
     C                   EVAL      SVEV_KOS3  = zhbgetvar('SVEV_KOS3')
     C                   EVAL      SVEV_KOS4  = zhbgetvar('SVEV_KOS4')
     C                   EVAL      SVEV_KOS5  = zhbgetvar('SVEV_KOS5')
     C                   EVAL      SVEV_VASL  = zhbgetvar('SVEV_VASL')
     C                   EVAL      SVEV_VAS2  = zhbgetvar('SVEV_VAS2')
     C                   EVAL      SVEV_VAS3  = zhbgetvar('SVEV_VAS3')
     C                   EVAL      SVEV_VAS4  = zhbgetvar('SVEV_VAS4')
     C                   EVAL      SVEV_VAS5  = zhbgetvar('SVEV_VAS5')
     C                   EVAL      SVEV_GODM  = zhbgetvar('SVEV_GODM')
     C                   EVAL      SVEV_GOD2  = zhbgetvar('SVEV_GOD2')
     C                   EVAL      SVEV_GOD3  = zhbgetvar('SVEV_GOD3')
     C                   EVAL      SVEV_GOD4  = zhbgetvar('SVEV_GOD4')
     C                   EVAL      SVEV_GOD5  = zhbgetvar('SVEV_GOD5')
     C                   EVAL      SVEV_VANOA = zhbgetvar('SVEV_VANO')
     C                   EVAL      SVEV_VANO = c2n2(SVEV_VANOA)
     C                   EVAL      SVEV_VATA  = zhbgetvar('SVEV_VATA')
     C                   EVAL      SVEV_VATI  = zhbgetvar('SVEV_VATI')
     C                   EVAL      SVEV_VAT4  = zhbgetvar('SVEV_VAT4')
     C                   EVAL      SVEV_VAT5  = zhbgetvar('SVEV_VAT5')
     C                   EVAL      SVEV_ULKD  = zhbgetvar('SVEV_ULKD')
     C                   EVAL      SVEV_BRUTA = zhbgetvar('SVEV_BRUT')
     C                   EVAL      SVEV_BRUT = c2n2(SVEV_BRUTA)
     C                   EVAL      SVEV_EUP1  = zhbgetvar('SVEV_EUP1')
     C                   EVAL      SVEV_EUP2  = zhbgetvar('SVEV_EUP2')
     C                   EVAL      SVEV_NETOA = zhbgetvar('SVEV_NETO')
     C                   EVAL      SVEV_NETO = c2n2(SVEV_NETOA)
     C                   EVAL      SVEV_KONO  = zhbgetvar('SVEV_KONO')
     C                   EVAL      SVEV_ANKVA = zhbgetvar('SVEV_ANKV')
     C                   EVAL      SVEV_ANKV = c2n2(SVEV_ANKVA)
     C                   EVAL      SVEV_SUKO  = zhbgetvar('SVEV_SUKO')
     C                   EVAL      SVEV_SUK6  = zhbgetvar('SVEV_SUK6')
     C                   EVAL      SVEV_SUKB  = zhbgetvar('SVEV_SUKB')
     C                   EVAL      SVEV_SUTX  = zhbgetvar('SVEV_SUTX')
     C                   EVAL      SVEV_SUT2  = zhbgetvar('SVEV_SUT2')
     C                   EVAL      SVEV_SUT3  = zhbgetvar('SVEV_SUT3')
     C                   EVAL      SVEV_SUT4  = zhbgetvar('SVEV_SUT4')
     C                   EVAL      SVEV_SUT5  = zhbgetvar('SVEV_SUT5')
     C                   EVAL      SVEV_SUT6  = zhbgetvar('SVEV_SUT6')
     C                   EVAL      SVEV_SUT7  = zhbgetvar('SVEV_SUT7')
     C                   EVAL      SVEV_SUT8  = zhbgetvar('SVEV_SUT8')
     C                   EVAL      SVEV_SUT9  = zhbgetvar('SVEV_SUT9')
     C                   EVAL      SVEV_SUTA  = zhbgetvar('SVEV_SUTA')
     C                   EVAL      SVEV_SUTB  = zhbgetvar('SVEV_SUTB')
     C                   EVAL      SVEV_SUTC  = zhbgetvar('SVEV_SUTC')
     C                   EVAL      SVEV_SUTD  = zhbgetvar('SVEV_SUTD')
     C                   EVAL      SVEV_SUTE  = zhbgetvar('SVEV_SUTE')
     C                   EVAL      SVEV_SUTF  = zhbgetvar('SVEV_SUTF')
     C                   EVAL      SVEV_SUOKA = zhbgetvar('SVEV_SUOK')
     C                   EVAL      SVEV_SUOK = c2n2(SVEV_SUOKA)
     C                   EVAL      SVEV_SUKRA = zhbgetvar('SVEV_SUKR')
     C                   EVAL      SVEV_SUKR = c2n2(SVEV_SUKRA)
     C                   EVAL      SVEV_SUARA = zhbgetvar('SVEV_SUAR')
     C                   EVAL      SVEV_SUAR = c2n2(SVEV_SUARA)
     C                   EVAL      SVEV_ATIN  = zhbgetvar('SVEV_ATIN')
     C                   EVAL      SVEV_STVAA = zhbgetvar('SVEV_STVA')
     C                   EVAL      SVEV_STVA = c2n2(SVEV_STVAA)
     C                   EVAL      SVEV_STVA2A = zhbgetvar('SVEV_STVA2')
     C                   EVAL      SVEV_STVA2 = c2n2(SVEV_STVA2A)
     C                   EVAL      SVEV_FABLA = zhbgetvar('SVEV_FABL')
     C                   EVAL      SVEV_FABL = c2n2(SVEV_FABLA)
     C                   EVAL      SVEV_BETK  = zhbgetvar('SVEV_BETK')
     C                   EVAL      SVEV_KOMR  = zhbgetvar('SVEV_KOMR')
     C                   EVAL      SVEV_FNKD  = zhbgetvar('SVEV_FNKD')
     C                   EVAL      SVEV_BIT1  = zhbgetvar('SVEV_BIT1')
     C                   EVAL      SVEV_BIT2  = zhbgetvar('SVEV_BIT2')
     C                   EVAL      SVEV_BIT3  = zhbgetvar('SVEV_BIT3')
     C                   EVAL      SVEV_BIT4  = zhbgetvar('SVEV_BIT4')
     C                   EVAL      SVEV_BIT5  = zhbgetvar('SVEV_BIT5')
     C                   EVAL      SVEV_BIT6  = zhbgetvar('SVEV_BIT6')
     C                   EVAL      SVEV_BIT7  = zhbgetvar('SVEV_BIT7')
     C                   EVAL      SVEV_BIT8  = zhbgetvar('SVEV_BIT8')
     C                   EVAL      SVEV_BIT9  = zhbgetvar('SVEV_BIT9')
     C                   EVAL      SVEV_BII1  = zhbgetvar('SVEV_BII1')
     C                   EVAL      SVEV_BII2  = zhbgetvar('SVEV_BII2')
     C                   EVAL      SVEV_BII3  = zhbgetvar('SVEV_BII3')
     C                   EVAL      SVEV_BII4  = zhbgetvar('SVEV_BII4')
     C                   EVAL      SVEV_BII5  = zhbgetvar('SVEV_BII5')
     C                   EVAL      SVEV_BII6  = zhbgetvar('SVEV_BII6')
     C                   EVAL      SVEV_BII7  = zhbgetvar('SVEV_BII7')
     C                   EVAL      SVEV_BII8  = zhbgetvar('SVEV_BII8')
     C                   EVAL      SVEV_BII9  = zhbgetvar('SVEV_BII9')
     C                   EVAL      SVEV_CO01  = zhbgetvar('SVEV_CO01')
     C                   EVAL      SVEV_CO02  = zhbgetvar('SVEV_CO02')
     C                   EVAL      SVEV_CO03  = zhbgetvar('SVEV_CO03')
     C                   EVAL      SVEV_CO04  = zhbgetvar('SVEV_CO04')
     C                   EVAL      SVEV_CO05  = zhbgetvar('SVEV_CO05')
     C                   EVAL      SVEV_CO06  = zhbgetvar('SVEV_CO06')
     C                   EVAL      SVEV_CO07  = zhbgetvar('SVEV_CO07')
     C                   EVAL      SVEV_CO08  = zhbgetvar('SVEV_CO08')
     C                   EVAL      SVEV_CO09  = zhbgetvar('SVEV_CO09')
     C                   EVAL      SVEV_CO10  = zhbgetvar('SVEV_CO10')
     C                   EVAL      SVEV_CO11  = zhbgetvar('SVEV_CO11')
     C                   EVAL      SVEV_CO12  = zhbgetvar('SVEV_CO12')
     C                   EVAL      SVEV_CO13  = zhbgetvar('SVEV_CO13')
     C                   EVAL      SVEV_CO14  = zhbgetvar('SVEV_CO14')
     C                   EVAL      SVEV_CO15  = zhbgetvar('SVEV_CO15')
     C                   EVAL      SVEV_CO16  = zhbgetvar('SVEV_CO16')
     C                   EVAL      SVEV_CO17  = zhbgetvar('SVEV_CO17')
     C                   EVAL      SVEV_CO18  = zhbgetvar('SVEV_CO18')
     C                   EVAL      SVEV_CO19  = zhbgetvar('SVEV_CO19')
     C                   EVAL      SVEV_CO20  = zhbgetvar('SVEV_CO20')
     C                   EVAL      SVEV_TIK1  = zhbgetvar('SVEV_TIK1')
     C                   EVAL      SVEV_TIK2  = zhbgetvar('SVEV_TIK2')
     C                   EVAL      SVEV_TIK3  = zhbgetvar('SVEV_TIK3')
     C                   EVAL      SVEV_TIK4  = zhbgetvar('SVEV_TIK4')
     C                   EVAL      SVEV_TIK5  = zhbgetvar('SVEV_TIK5')
     C                   EVAL      SVEV_TIK6  = zhbgetvar('SVEV_TIK6')
     C                   EVAL      SVEV_TIK7  = zhbgetvar('SVEV_TIK7')
     C                   EVAL      SVEV_TIK8  = zhbgetvar('SVEV_TIK8')
     C                   EVAL      SVEV_TIK9  = zhbgetvar('SVEV_TIK9')
     C                   EVAL      SVEV_TIT1  = zhbgetvar('SVEV_TIT1')
     C                   EVAL      SVEV_TIT2  = zhbgetvar('SVEV_TIT2')
     C                   EVAL      SVEV_TIT3  = zhbgetvar('SVEV_TIT3')
     C                   EVAL      SVEV_TIT4  = zhbgetvar('SVEV_TIT4')
     C                   EVAL      SVEV_TIT5  = zhbgetvar('SVEV_TIT5')
     C                   EVAL      SVEV_TIT6  = zhbgetvar('SVEV_TIT6')
     C                   EVAL      SVEV_TIT7  = zhbgetvar('SVEV_TIT7')
     C                   EVAL      SVEV_TIT8  = zhbgetvar('SVEV_TIT8')
     C                   EVAL      SVEV_TIT9  = zhbgetvar('SVEV_TIT9')
     C                   EVAL      SVEV_TIX1  = zhbgetvar('SVEV_TIX1')
     C                   EVAL      SVEV_TIX2  = zhbgetvar('SVEV_TIX2')
     C                   EVAL      SVEV_TIX3  = zhbgetvar('SVEV_TIX3')
     C                   EVAL      SVEV_TIX4  = zhbgetvar('SVEV_TIX4')
     C                   EVAL      SVEV_TIX5  = zhbgetvar('SVEV_TIX5')
     C                   EVAL      SVEV_TIX6  = zhbgetvar('SVEV_TIX6')
     C                   EVAL      SVEV_TIX7  = zhbgetvar('SVEV_TIX7')
     C                   EVAL      SVEV_TIX8  = zhbgetvar('SVEV_TIX8')
     C                   EVAL      SVEV_TIX9  = zhbgetvar('SVEV_TIX9')
     C                   EVAL      SVEV_LAGI  = zhbgetvar('SVEV_LAGI')
     C                   EVAL      SVEV_LAGT  = zhbgetvar('SVEV_LAGT')
     C                   EVAL      SVEV_LAGL  = zhbgetvar('SVEV_LAGL')
     C                   EVAL      SVEV_CALL  = zhbgetvar('SVEV_CALL')
     C                   EVAL      SVEV_ERR   = zhbgetvar('SVEV_ERR')
     C                   EVAL      SVEV_LIGH  = zhbgetvar('SVEV_LIGH')
     c                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C  N50BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end
      *
     C     svevKey       klist
     C                   kfld                    svev_SYAV
     C                   kfld                    svev_SYOP
     C                   kfld                    svev_SYLI
      *
     C   50              eval      Error = 'Invalid userID'
     C  N50              OPEN      svev

     c                   endsr
      *
      *______________________________________________________
      * TEST                                             TEST
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TEST          BEGSR
     C     WMODE         IFNE      'A'
     C     svevKey       CHAIN     svev                               55
     C                   ENDIF
      * MODE A=Add  D=Delete  U=Update
     C                   SELECT
     C     WMODE         WHENEQ    'A'
     C                   eval      Error = *blanks
     C                   EXSR      SRA
     C     WMODE         WHENEQ    'D'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRD
     C                   ENDIF
     C     WMODE         WHENEQ    'U'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRU
     C                   ENDIF
     C                   OTHER
     C                   eval      Error = 'Wrong mode'
     C                   ENDSL
     C                   ENDSR
      *______________________________________________________
      * Add                                               SRA
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
     C                   CLEAR                   svevR
     C                   EVAL      Xsvev_SYAV=svev_SYAV
     C                   EVAL      Xsvev_SYOP=svev_SYOP
     C                   EVAL      Xsvev_SYLI=svev_SYLI
     C                   WRITE     svevR
     C                   ENDSR
      *______________________________________________________
      * Delete                                            SRD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C                   DELETE    SVEVR
     C                   ENDSR
      *______________________________________________________
      * Update                                            SRU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRU           BEGSR
     C                   EVAL      XSVEV_VATI=SVEV_VATI
     C                   EVAL      XSVEV_STVA=SVEV_STVA
     C                   EVAL      XSVEV_STVA2=SVEV_STVA2
     C                   IF        SVEV_LIGH=*BLANKS
     C                   EVAL      XSVEV_KOTA=SVEV_KOTA
     C                   EVAL      XSVEV_KOT2=SVEV_KOT2
     C                   EVAL      XSVEV_KOT3=SVEV_KOT3
     C                   EVAL      XSVEV_KOT4=SVEV_KOT4
     C                   EVAL      XSVEV_KOT5=SVEV_KOT5
     C                   EVAL      XSVEV_KOSL=SVEV_KOSL
     C                   EVAL      XSVEV_KOS2=SVEV_KOS2
     C                   EVAL      XSVEV_KOS3=SVEV_KOS3
     C                   EVAL      XSVEV_KOS4=SVEV_KOS4
     C                   EVAL      XSVEV_KOS5=SVEV_KOS5
     C                   EVAL      XSVEV_VASL=SVEV_VASL
     C                   EVAL      XSVEV_VAS2=SVEV_VAS2
     C                   EVAL      XSVEV_VAS3=SVEV_VAS3
     C                   EVAL      XSVEV_VAS4=SVEV_VAS4
     C                   EVAL      XSVEV_VAS5=SVEV_VAS5
     C                   EVAL      XSVEV_GODM=SVEV_GODM
     C                   EVAL      XSVEV_GOD2=SVEV_GOD2
     C                   EVAL      XSVEV_GOD3=SVEV_GOD3
     C                   EVAL      XSVEV_GOD4=SVEV_GOD4
     C                   EVAL      XSVEV_GOD5=SVEV_GOD5
     C                   EVAL      XSVEV_VANO=SVEV_VANO
     C                   EVAL      XSVEV_VATA=SVEV_VATA
     C                   EVAL      XSVEV_VAT4=SVEV_VAT4
     C                   EVAL      XSVEV_VAT5=SVEV_VAT5
     C                   EVAL      XSVEV_ULKD=SVEV_ULKD
     C                   EVAL      XSVEV_BRUT=SVEV_BRUT
     C                   EVAL      XSVEV_EUP1=SVEV_EUP1
     C                   EVAL      XSVEV_EUP2=SVEV_EUP2
     C                   EVAL      XSVEV_NETO=SVEV_NETO
     C                   EVAL      XSVEV_KONO=SVEV_KONO
     C                   EVAL      XSVEV_ANKV=SVEV_ANKV
     C                   EVAL      XSVEV_SUKO=SVEV_SUKO
     C                   EVAL      XSVEV_SUK6=SVEV_SUK6
     C                   EVAL      XSVEV_SUKB=SVEV_SUKB
     C                   EVAL      XSVEV_SUTX=SVEV_SUTX
     C                   EVAL      XSVEV_SUT2=SVEV_SUT2
     C                   EVAL      XSVEV_SUT3=SVEV_SUT3
     C                   EVAL      XSVEV_SUT4=SVEV_SUT4
     C                   EVAL      XSVEV_SUT5=SVEV_SUT5
     C                   EVAL      XSVEV_SUT6=SVEV_SUT6
     C                   EVAL      XSVEV_SUT7=SVEV_SUT7
     C                   EVAL      XSVEV_SUT8=SVEV_SUT8
     C                   EVAL      XSVEV_SUT9=SVEV_SUT9
     C                   EVAL      XSVEV_SUTA=SVEV_SUTA
     C                   EVAL      XSVEV_SUTB=SVEV_SUTB
     C                   EVAL      XSVEV_SUTC=SVEV_SUTC
     C                   EVAL      XSVEV_SUTD=SVEV_SUTD
     C                   EVAL      XSVEV_SUTE=SVEV_SUTE
     C                   EVAL      XSVEV_SUTF=SVEV_SUTF
     C                   EVAL      XSVEV_SUOK=SVEV_SUOK
     C                   EVAL      XSVEV_SUKR=SVEV_SUKR
     C                   EVAL      XSVEV_SUAR=SVEV_SUAR
     C                   EVAL      XSVEV_ATIN=SVEV_ATIN
     C                   EVAL      XSVEV_FABL=SVEV_FABL
     C                   EVAL      XSVEV_BETK=SVEV_BETK
     C                   EVAL      XSVEV_KOMR=SVEV_KOMR
     C                   EVAL      XSVEV_FNKD=SVEV_FNKD
     C                   EVAL      XSVEV_BIT1=SVEV_BIT1
     C                   EVAL      XSVEV_BIT2=SVEV_BIT2
     C                   EVAL      XSVEV_BIT3=SVEV_BIT3
     C                   EVAL      XSVEV_BIT4=SVEV_BIT4
     C                   EVAL      XSVEV_BIT5=SVEV_BIT5
     C                   EVAL      XSVEV_BIT6=SVEV_BIT6
     C                   EVAL      XSVEV_BIT7=SVEV_BIT7
     C                   EVAL      XSVEV_BIT8=SVEV_BIT8
     C                   EVAL      XSVEV_BIT9=SVEV_BIT9
     C                   EVAL      XSVEV_BII1=SVEV_BII1
     C                   EVAL      XSVEV_BII2=SVEV_BII2
     C                   EVAL      XSVEV_BII3=SVEV_BII3
     C                   EVAL      XSVEV_BII4=SVEV_BII4
     C                   EVAL      XSVEV_BII5=SVEV_BII5
     C                   EVAL      XSVEV_BII6=SVEV_BII6
     C                   EVAL      XSVEV_BII7=SVEV_BII7
     C                   EVAL      XSVEV_BII8=SVEV_BII8
     C                   EVAL      XSVEV_BII9=SVEV_BII9
     C                   EVAL      XSVEV_CO01=SVEV_CO01
     C                   EVAL      XSVEV_CO02=SVEV_CO02
     C                   EVAL      XSVEV_CO03=SVEV_CO03
     C                   EVAL      XSVEV_CO04=SVEV_CO04
     C                   EVAL      XSVEV_CO05=SVEV_CO05
     C                   EVAL      XSVEV_CO06=SVEV_CO06
     C                   EVAL      XSVEV_CO07=SVEV_CO07
     C                   EVAL      XSVEV_CO08=SVEV_CO08
     C                   EVAL      XSVEV_CO09=SVEV_CO09
     C                   EVAL      XSVEV_CO10=SVEV_CO10
     C                   EVAL      XSVEV_CO11=SVEV_CO11
     C                   EVAL      XSVEV_CO12=SVEV_CO12
     C                   EVAL      XSVEV_CO13=SVEV_CO13
     C                   EVAL      XSVEV_CO14=SVEV_CO14
     C                   EVAL      XSVEV_CO15=SVEV_CO15
     C                   EVAL      XSVEV_CO16=SVEV_CO16
     C                   EVAL      XSVEV_CO17=SVEV_CO17
     C                   EVAL      XSVEV_CO18=SVEV_CO18
     C                   EVAL      XSVEV_CO19=SVEV_CO19
     C                   EVAL      XSVEV_CO20=SVEV_CO20
     C                   EVAL      XSVEV_TIK1=SVEV_TIK1
     C                   EVAL      XSVEV_TIK2=SVEV_TIK2
     C                   EVAL      XSVEV_TIK3=SVEV_TIK3
     C                   EVAL      XSVEV_TIK4=SVEV_TIK4
     C                   EVAL      XSVEV_TIK5=SVEV_TIK5
     C                   EVAL      XSVEV_TIK6=SVEV_TIK6
     C                   EVAL      XSVEV_TIK7=SVEV_TIK7
     C                   EVAL      XSVEV_TIK8=SVEV_TIK8
     C                   EVAL      XSVEV_TIK9=SVEV_TIK9
     C                   EVAL      XSVEV_TIT1=SVEV_TIT1
     C                   EVAL      XSVEV_TIT2=SVEV_TIT2
     C                   EVAL      XSVEV_TIT3=SVEV_TIT3
     C                   EVAL      XSVEV_TIT4=SVEV_TIT4
     C                   EVAL      XSVEV_TIT5=SVEV_TIT5
     C                   EVAL      XSVEV_TIT6=SVEV_TIT6
     C                   EVAL      XSVEV_TIT7=SVEV_TIT7
     C                   EVAL      XSVEV_TIT8=SVEV_TIT8
     C                   EVAL      XSVEV_TIT9=SVEV_TIT9
     C                   EVAL      XSVEV_TIX1=SVEV_TIX1
     C                   EVAL      XSVEV_TIX2=SVEV_TIX2
     C                   EVAL      XSVEV_TIX3=SVEV_TIX3
     C                   EVAL      XSVEV_TIX4=SVEV_TIX4
     C                   EVAL      XSVEV_TIX5=SVEV_TIX5
     C                   EVAL      XSVEV_TIX6=SVEV_TIX6
     C                   EVAL      XSVEV_TIX7=SVEV_TIX7
     C                   EVAL      XSVEV_TIX8=SVEV_TIX8
     C                   EVAL      XSVEV_TIX9=SVEV_TIX9
     C                   EVAL      XSVEV_LAGI=SVEV_LAGI
     C                   EVAL      XSVEV_LAGT=SVEV_LAGT
     C                   EVAL      XSVEV_LAGL=SVEV_LAGL
     C                   EVAL      XSVEV_CALL=SVEV_CALL
     C                   EVAL      XSVEV_ERR=SVEV_ERR
     C                   ENDIF
     C                   UPDATE    svevR
     C                   ENDSR
