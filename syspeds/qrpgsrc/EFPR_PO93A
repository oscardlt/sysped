      * Dette programmet startes fra CLP: EFPC_PO93A som i sin tur startes fra
      * Børre Thoresens fraktapplikasjon: FOP24_PGM/FPC400
      * Inputfilen er en flatfil med en recordlengde på 270 med kun et felt.
      * Syntaksen er: 1-3=Segmentnavn, 4-5=Index, 6-270 Edifact data
      */////////////////////////////////////////////////////////////////////////
     FTINNF     IF   E             DISK
     FEDIC      UF   E             DISK
     FEUNH      O  A E             DISK
     FEDIM      O  A E             DISK
     FECNT93A   O  A E             DISK
     FECOM93A   O  A E             DISK
     FECTA93A   O  A E             DISK
     FECPI93A   O  A E             DISK
     FEDOC93A   O  A E             DISK
     FEDTM93A   O  A E             DISK
     FEEQD93A   O  A E             DISK
     FEEQN93A   O  A E             DISK
     FEFTX93A   O  A E             DISK
     FEGID93A   O  A E             DISK
     FELOC93A   O  A E             DISK
     FEMEA93A   O  A E             DISK
     FEMOA93A   O  A E             DISK
     FENAD93A   O  A E             DISK
     FEPCI93A   O  A E             DISK
     FERFF93A   O  A E             DISK
     FETDT93A   O  A E             DISK
     FETOD93A   O  A E             DISK
     FETSR93A   O  A E             DISK
      *___________________________
      * Arrays for string handling
      *"""""""""""""""""""""""""""
     D                 DS
     D  WTIME                  1     14  0
     D  WTID                   1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D                 DS
     D  WDATO                  1      8  0
     D  WÅ                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
      *____________________________________
      * DS for leftjustify numericel fields
      *""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN153                  1     15  3
     D  ØA153H                 1     12
     D  ØA153X                 5     12
     D  ØA153D                13     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)
      *_________________
      * Arrays for input
      *"""""""""""""""""
     D                 DS
     D  WUNB00                 1    256
     D  WUNB00A                6     40                                         0004
     D  WUNB00B               59     93                                         0010
     D  WUNB00C              203    203                                         0035
     D                 DS
     D  WBGM00                 1    256
     D  WBGM00A                1      3                                         1001
     D  WBGM00B               45     79                                         1004
     D                 DS
     D  WDTM00                 1    256
     D  WDTM00A                1      3                                         2005
     D  WDTM00B                4     38                                         2380
     D  WDTM00C               39     41                                         2379
     D                 DS
     D  WTSR00                 1    256
     D  WTSR00A                1      3                                         4065
     D  WTSR00B               28     30                                         4219
     D  WTSR00C               37     39                                         7085
     D                 DS
     D  WMOA00                 1    256
     D  WMOA00A                1      3                                         5025
     D  WMOA00B                4     15                                         5004
     D  WMOA00C               22     24                                         6345
     D                 DS
     D  WFTX00                 1    256
     D  WFTX00A                1      3                                         4451
     D  WFTX00B               16     45                                         4440
     D  WFTX00C               51     80                                         4440
     D  WFTX00D               86    115                                         4440
     D  WFTX00E              121    150                                         4440
     D  WFTX00F              156    185                                         4440
     D                 DS
     D  WCNT00                 1    256
     D  WCNT00A                1      3                                         6069
     D  WCNT00B                4     21                                         6066
     D  WCNT00C               22     24                                         6411
     D                 DS
     D  WTOD02                 1    256
     D  WTOD02A                1      3                                         4055
     D  WTOD02B                7      9                                         4053
     D  WTOD02C               10     12                                         1131
     D                 DS
     D  WLOC02                 1    256
     D  WLOC02A                1      3                                         3227
     D  WLOC02B                4     28                                         3225
     D  WLOC02C               29     31                                         1131
     D                 DS
     D  WRFF03                 1    256
     D  WRFF03A                1      3                                         1153
     D  WRFF03B                4     38                                         1154
     D                 DS
     D  WCPI06                 1    256
     D  WCPI06A                1      3                                         1153
     D  WCPI06B               19     21                                         1154
     D                 DS
     D  WTDT08                 1    256
     D  WTDT08A                1      3                                         8051
     D  WTDT08B               21     23                                         8067
     D                 DS
     D  WLOC08                 1    256
     D  WLOC08A                1      3                                         3227
     D  WLOC08B                4     28                                         3225
     D  WLOC08C               29     31                                         1131
     D                 DS
     D  WNAD10                 1    256
     D  WNAD10A                1      3                                         3035
     D  WNAD10B                4     20                                         3039
     D  WNAD10C               24     26                                         3055
     D  WNAD10D               27     61                                         3036
     D  WNAD10E               62     96                                         3042
     D  WNAD10F               97    131                                         3042
     D  WNAD10G              132    166                                         3164
     D  WNAD10H              167    175                                         3251
     D                 DS
     D  WCTA11                 1    256
     D  WCTA11A                1      3                                         3139
     D  WCTA11B               21     55                                         3412
     D                 DS
     D  WCOM11                 1    256
     D  WCOM11A                1     25                                         3148
     D  WCOM11B               26     28                                         3155
     D                 DS
     D  WDOC12                 1    256
     D  WDOC12A                1      3                                         1001
     D                 DS
     D  WRFF14                 1    256
     D  WRFF14A                1      3                                         1153
     D  WRFF14B                4     38                                         1154
     D                 DS
     D  WGID16                 1    256
     D  WGID16A                1      2                                         1496
     D  WGID16B                6      8                                         7224
     D  WGID16C               14     16                                         7065
     D                 DS
     D  WFTX16                 1    256
     D  WFTX16A                1      3                                         4451
     D  WFTX16B               16     45                                         4440
     D                 DS
     D  WMEA19                 1    256
     D  WMEA19A                1      3                                         6311
     D  WMEA19B                4      6                                         6313
     D  WMEA19C               13     15                                         6411
     D  WMEA19D               16     22                                         6314
     D                 DS
     D  WPCI22                 1    256
     D  WPCI22A                1      3                                         4233
     D  WPCI22B                4     38                                         7102
     D                 DS
     D  WEQD34                 1    256
     D  WEQD34A                1      3                                         8053
     D  WEQD34B                4     20                                         8060
     D  WEQD34C               24     26                                         3055
     D                 DS
     D  WEQN34                 1    256
     D  WEQN34A                1     15                                         6350
      */////////////
      * MAIN LOGIC /
      */////////////
     C                   EXSR      SRINIT
     C                   EXSR      SRA
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      * SR                                                  CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR

     C                   CLEAR                   CNTR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     0             CGN
     C                   ADD       1             WCNT00X
     C                   Z-ADD     WCNT00X       CREP0

     C                   MOVEL     WCNT00A       C6069
     C                   MOVEL     WCNT00B       C6066
     C                   MOVEL     WCNT00C       C6411
     C                   WRITE     CNTR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  COM11 /
      *////////////////////////////////////////////////////////////
     C     COM11         BEGSR

     C                   CLEAR                   COMR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     11            CGN
     C                   Z-ADD     WNAD10X       CREP0
     C                   Z-ADD     1             CREP1
     C                   Z-ADD     1             CREP2

     C                   MOVEL     WCOM11A       C3148
     C                   MOVEL     WCOM11B       C3155
     C                   WRITE     COMR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  CTA11 /
      *////////////////////////////////////////////////////////////
     C     CTA11         BEGSR

     C                   CLEAR                   CTAR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     11            CGN
     C                   Z-ADD     WNAD10X       CREP0
     C                   Z-ADD     1             CREP1

     C                   MOVEL     WCTA11A       C3139
     C                   MOVEL     WCTA11B       C3412
     C                   WRITE     CTAR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  CPI06 /
      *////////////////////////////////////////////////////////////
     C     CPI06         BEGSR

     C                   CLEAR                   CPIR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     6             CGN
     C                   ADD       1             WCPI06X
     C                   Z-ADD     WCPI06X       CREP0

     C                   MOVEL     WCPI06A       C5237
     C                   MOVEL     WCPI06B       C4237
     C                   WRITE     CPIR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DOC12 /
      *////////////////////////////////////////////////////////////
     C     DOC12         BEGSR

     C                   CLEAR                   DOCR
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     12            DGN
     C                   Z-ADD     WNAD10X       DREP0
     C                   Z-ADD     1             DREP1

     C                   MOVEL     WDOC12A       D1001
     C                   WRITE     DOCR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR

     C                   CLEAR                   DTMR
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     0             DGN
     C                   Z-ADD     1             DREP0

     C                   MOVEL     WDTM00A       D2005
     C                   MOVEL     WDTM00B       D2380
     C                   MOVEL     WDTM00C       D2379
     C                   WRITE     DTMR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  EQD34 /
      *////////////////////////////////////////////////////////////
     C     EQD34         BEGSR

     C                   CLEAR                   EQDR
     C                   Z-ADD     WMN           EMN
     C                   Z-ADD     34            EGN
     C                   ADD       1             WEQD34X
     C                   Z-ADD     WEQD34X       EREP0

     C                   MOVEL     WEQD34A       E8053
     C                   MOVEL     WEQD34B       E8260
     C                   MOVEL     WEQD34C       E3055A
     C                   WRITE     EQDR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  EQN34 /
      *////////////////////////////////////////////////////////////
     C     EQN34         BEGSR

     C                   CLEAR                   EQNR
     C                   Z-ADD     WMN           EMN
     C                   Z-ADD     34            EGN
     C                   Z-ADD     WEQD34X       EREP0
     C                   Z-ADD     1             EREP1

     C                   MOVEL     WEQN34A       E6350
     C                   WRITE     EQNR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * EDIM0                                                EDIM0/
      *////////////////////////////////////////////////////////////
     C     EDIM0         BEGSR
     C                   CLEAR                   EDIMR
     C                   MOVEL     WUNB00A       M0004
     C                   MOVEL     WUNB00B       M0010
     C                   MOVEL     WUNB00C       M0035
     C                   MOVEL     U0062A        M0062
     C                   MOVEL     U0065         M0065
     C                   MOVEL     U1004         M0068
     C                   MOVEL     U1001         M1001
     C                   MOVEL     U1004         M1004
     C                   Z-ADD     WMN           MMN
     C                   MOVE      'S'           MSR
     C                   MOVEL     WDATO         MDT
     C                   MOVEL     WTID          MTM
     C                   WRITE     EDIMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR

     C                   CLEAR                   FTXR
     C                   Z-ADD     WMN           FMN
     C                   Z-ADD     0             FGN
     C                   ADD       1             WFTX00X
     C                   Z-ADD     WFTX00X       FREP0

     C                   MOVEL     WFTX00A       F4451
     C                   MOVEL     WFTX00B       F4440A
     C                   MOVEL     WFTX00C       F4440B
     C                   MOVEL     WFTX00D       F4440C
     C                   MOVEL     WFTX00E       F4440D
     C                   MOVEL     WFTX00F       F4440E
     C                   WRITE     FTXR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  FTX16 /
      *////////////////////////////////////////////////////////////
     C     FTX16         BEGSR

     C                   CLEAR                   FTXR
     C                   Z-ADD     WMN           FMN
     C                   Z-ADD     16            FGN
     C                   Z-ADD     WGID16X       FREP0
     C                   Z-ADD     1             FREP1

     C                   MOVEL     WFTX16A       F4451
     C                   MOVEL     WFTX16B       F4440A
     C                   WRITE     FTXR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  GID16 /
      *////////////////////////////////////////////////////////////
     C     GID16         BEGSR

     C                   CLEAR                   GIDR
     C                   Z-ADD     WMN           GMN
     C                   Z-ADD     16            GGN
     C                   ADD       1             WGID16X
     C                   Z-ADD     WGID16X       GREP0

     C                   MOVEL     WGID16A       G1496
     C                   MOVEL     WGID16B       G7224A
     C                   MOVEL     WGID16C       G7065A
     C                   WRITE     GIDR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  LOC02 /
      *////////////////////////////////////////////////////////////
     C     LOC02         BEGSR

     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     2             LGN
     C                   Z-ADD     1             LREP0
     C                   Z-ADD     1             LREP1

     C                   MOVEL     WLOC02A       L3227
     C                   MOVEL     WLOC02B       L3225
     C                   MOVEL     WLOC02C       L1131A
     C                   WRITE     LOCR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  LOC08 /
      *////////////////////////////////////////////////////////////
     C     LOC08         BEGSR

     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     8             LGN
     C                   Z-ADD     1             LREP0
     C                   ADD       1             WLOC08X
     C                   Z-ADD     WLOC08X       LREP1

     C                   MOVEL     WLOC08A       L3227
     C                   MOVEL     WLOC08B       L3225
     C                   MOVEL     WLOC08C       L1131A
     C                   WRITE     LOCR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MEA19 /
      *////////////////////////////////////////////////////////////
     C     MEA19         BEGSR

     C                   CLEAR                   MEAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     19            MGN
     C                   Z-ADD     WGID16X       MREP0
     C                   ADD       1             WMEA19X
     C                   Z-ADD     WMEA19X       MREP1

     C                   MOVEL     WMEA19A       M6311
     C                   MOVEL     WMEA19B       M6313
     C                   MOVEL     WMEA19C       M6411
     C                   MOVEL     WMEA19D       M6314
     C                   WRITE     MEAR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA00 /
      *////////////////////////////////////////////////////////////
     C     MOA00         BEGSR

     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     0             MGN
     C                   ADD       1             WMOA00X
     C                   Z-ADD     WMOA00X       MREP0

     C                   MOVEL     WMOA00A       M5025
     C                   MOVEL     WMOA00B       M5004
     C                   MOVEL     WMOA00C       M6345
     C                   WRITE     MOAR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  NAD10 /
      *////////////////////////////////////////////////////////////
     C     NAD10         BEGSR

     C                   CLEAR                   NADR
     C                   Z-ADD     WMN           NMN
     C                   Z-ADD     10            NGN
     C                   ADD       1             WNAD10X
     C                   Z-ADD     WNAD10X       NREP0

     C                   MOVEL     WNAD10A       N3035
     C                   MOVEL     WNAD10B       N3039
     C                   MOVEL     WNAD10C       N3055
     C                   MOVEL     WNAD10D       N3036A
     C                   MOVEL     WNAD10E       N3042A
     C                   MOVEL     WNAD10F       N3042B
     C                   MOVEL     WNAD10G       N3164
     C                   MOVEL     WNAD10H       N3251
     C                   WRITE     NADR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  PCI22 /
      *////////////////////////////////////////////////////////////
     C     PCI22         BEGSR

     C                   CLEAR                   PCIR
     C                   Z-ADD     WMN           PMN
     C                   Z-ADD     22            PGN
     C                   Z-ADD     WGID16X       PREP0
     C                   Z-ADD     1             PREP1

     C                   MOVEL     WPCI22A       P4233
     C                   MOVEL     WPCI22B       P7102A
     C                   WRITE     PCIR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF03 /
      *////////////////////////////////////////////////////////////
     C     RFF03         BEGSR

     C                   CLEAR                   RFFR
     C                   Z-ADD     WMN           RMN
     C                   Z-ADD     3             RGN
     C                   ADD       1             WRFF03X
     C                   Z-ADD     WRFF03X       RREP0

     C                   MOVEL     WRFF03A       R1153
     C                   MOVEL     WRFF03B       R1154
     C     R1153         IFNE      'BT '
     C                   WRITE     RFFR
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF14 /
      *////////////////////////////////////////////////////////////
     C     RFF14         BEGSR

     C                   CLEAR                   RFFR
     C                   Z-ADD     WMN           RMN
     C                   Z-ADD     14            RGN
     C                   Z-ADD     WNAD10X       RREP0
     C                   ADD       1             WRFF14X
     C                   Z-ADD     WRFF14X       RREP1

     C                   MOVEL     WRFF14A       R1153
     C                   MOVEL     WRFF14B       R1154
     C                   WRITE     RFFR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                    SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *______________
      * Les fraktbrev
      *""""""""""""""
     C                   READ      TINNF                                  51
     C     *IN51         DOWEQ     '0'
      *_________________
      * EDIFACT Detaljer
      *"""""""""""""""""
     C     SRA1          TAG

     C                   SELECT
     C     TISEGM        WHENEQ    'UNB'
     C                   MOVEL     TIRCD         WUNB00
     C     TISEGM        WHENEQ    'UNH'
     C                   EXSR      SRB
     C                   GOTO      SRA1
     C                   ENDSL
      *____________________
      * Les neste fraktbrev
      *""""""""""""""""""""
     C                   READ      TINNF                                  51
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                    SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_________
      * Clear DS
      *"""""""""
     C                   CLEAR                   WTDT08
     C                   Z-ADD     0             WTSR00X
     C                   Z-ADD     0             WMOA00X
     C                   Z-ADD     0             WFTX00X
     C                   Z-ADD     0             WCNT00X
     C                   Z-ADD     0             WRFF03X
     C                   Z-ADD     0             WNAD10X
     C                   Z-ADD     0             WGID16X
     C                   Z-ADD     0             WEQD34X
     C                   Z-ADD     0             WLOC08X
     C                   Z-ADD     0             WRFF14X
     C                   Z-ADD     0             WMEA19X
      *________________________
      * Retreive message number
      *""""""""""""""""""""""""
     C     1             CHAIN     EDIC                               52
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   Z-ADD     CMN           WMN
     C                   MOVE      '1'           *IN41
      *__________________________
      * Flytt input til riktig DS
      *""""""""""""""""""""""""""
     C                   READ      TINNF                                  51
     C     *IN51         DOWEQ     '0'
     C                   SELECT
     C     TISEGM        WHENEQ    'UNB'
     C                   GOTO      SRB9
     C     TISEGM        WHENEQ    'UNZ'
     C                   GOTO      SRB9
     C     TISEGM        WHENEQ    'UNH'
     C                   GOTO      SRB9
     C     TISEGM        WHENEQ    'BGM'
     C                   MOVEL     TIRCD         WBGM00
     C     TISEGM        WHENEQ    'DTM'
     C                   MOVEL     TIRCD         WDTM00
     C                   EXSR      DTM00
     C     TISEGM        WHENEQ    'TSR'
     C                   MOVEL     TIRCD         WTSR00
     C                   EXSR      TSR00
     C     TISEGM        WHENEQ    'MOA'
     C                   MOVEL     TIRCD         WMOA00
     C                   EXSR      MOA00
     C     TISEGM        WHENEQ    'FTX'
     C     WTDT08        ANDEQ     *BLANKS
     C                   MOVEL     TIRCD         WFTX00
     C                   EXSR      FTX00
     C     TISEGM        WHENEQ    'CNT'
     C                   MOVEL     TIRCD         WCNT00
     C                   EXSR      CNT00
     C     TISEGM        WHENEQ    'TOD'
     C                   MOVEL     TIRCD         WTOD02
     C                   EXSR      TOD02
     C     TISEGM        WHENEQ    'LOC'
     C     WTDT08        ANDEQ     *BLANKS
     C                   MOVEL     TIRCD         WLOC02
     C                   EXSR      LOC02
     C     TISEGM        WHENEQ    'RFF'
     C     WTDT08        ANDEQ     *BLANKS
     C                   MOVEL     TIRCD         WRFF03
     C                   EXSR      RFF03
     C     TISEGM        WHENEQ    'CPI'
     C     WTDT08        ANDEQ     *BLANKS
     C                   MOVEL     TIRCD         WCPI06
     C                   EXSR      CPI06
     C     TISEGM        WHENEQ    'TDT'
     C                   MOVEL     TIRCD         WTDT08
     C                   EXSR      TDT08
     C                   Z-ADD     0             WLOC08X
     C     TISEGM        WHENEQ    'LOC'
     C     WTDT08        ANDNE     *BLANKS
     C                   MOVEL     TIRCD         WLOC08
     C                   EXSR      LOC08
     C     TISEGM        WHENEQ    'NAD'
     C                   MOVEL     TIRCD         WNAD10
     C                   EXSR      NAD10
     C                   Z-ADD     0             WRFF14X
     C     TISEGM        WHENEQ    'CTA'
     C                   MOVEL     TIRCD         WCTA11
     C                   EXSR      CTA11
     C     TISEGM        WHENEQ    'COM'
     C                   MOVEL     TIRCD         WCOM11
     C                   EXSR      COM11
     C     TISEGM        WHENEQ    'DOC'
     C                   MOVEL     TIRCD         WDOC12
     C                   EXSR      DOC12
     C     TISEGM        WHENEQ    'RFF'
     C     WTDT08        ANDNE     *BLANKS
     C                   MOVEL     TIRCD         WRFF14
     C                   EXSR      RFF14
     C     TISEGM        WHENEQ    'GID'
     C                   MOVEL     TIRCD         WGID16
     C                   EXSR      GID16
     C                   Z-ADD     0             WMEA19X
     C     TISEGM        WHENEQ    'FTX'
     C     WTDT08        ANDNE     *BLANKS
     C                   MOVEL     TIRCD         WFTX16
     C                   EXSR      FTX16
     C     TISEGM        WHENEQ    'MEA'
     C                   MOVEL     TIRCD         WMEA19
     C                   EXSR      MEA19
     C     TISEGM        WHENEQ    'PCI'
     C                   MOVEL     TIRCD         WPCI22
     C                   EXSR      PCI22
     C     TISEGM        WHENEQ    'EQD'
     C                   MOVEL     TIRCD         WEQD34
     C                   EXSR      EQD34
     C     TISEGM        WHENEQ    'EQN'
     C                   MOVEL     TIRCD         WEQN34
     C                   EXSR      EQN34
     C     TISEGM        WHENEQ    'UNT'
     C                   EXSR      UNH00
     C                   EXSR      EDIM0
     C                   ENDSL
     C                   READ      TINNF                                  51
     C                   ENDDO
     C     SRB9          TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for init                                        SRINIT /
      *////////////////////////////////////////////////////////////
     C     SRINIT        BEGSR
      * HENTE DAGENS DATO OG TID
     C                   TIME                    WTIME
     C                   Z-ADD     WÅÅ           WÅ
     C                   Z-ADD     WDD           WD
     C                   Z-ADD     WMM           WM
      * INIT AV ARBEIDSFELT
     C     *LIKE         DEFINE    DREP0         WTSR00X
     C     *LIKE         DEFINE    DREP0         WMOA00X
     C     *LIKE         DEFINE    DREP0         WFTX00X
     C     *LIKE         DEFINE    DREP0         WCNT00X
     C     *LIKE         DEFINE    DREP0         WRFF03X
     C     *LIKE         DEFINE    DREP0         WNAD10X
     C     *LIKE         DEFINE    DREP0         WGID16X
     C     *LIKE         DEFINE    DREP0         WEQD34X
     C     *LIKE         DEFINE    DREP0         WCPI06X
     C     *LIKE         DEFINE    DREP1         WLOC08X
     C     *LIKE         DEFINE    DREP1         WRFF14X
     C     *LIKE         DEFINE    DREP1         WMEA19X
     C     *LIKE         DEFINE    UMN           WMN
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W_ØN153          15 3
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leftjustify num.fields                              SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Remove neg sign.
     C                   IF        ØN153 < 0
     C                   Z-SUB     ØN153         ØN153
     C                   ENDIF
      * Move correct value into alpha 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA153D        IFEQ      '000'
     C                   MOVE      ØA153H        ØA12
     C                   ELSE
     C                   MOVEL     ØA153X        ØA12
     C                   MOVE      ',   '        ØA12
     C                   MOVE      ØA153D        ØA12
     C                   END
      * search from left and find first sign over 0
     C     1             DO        11            ØX
     C     Ø12(ØX)       IFNE      '0'
     C                   GOTO      SRNE1
     C                   END
     C                   END
     C     SRNE1         TAG
      * Leftjustify to a new field
     C     ØA153D        IFNE      '000'
     C     ØA153X        IFEQ      '00000000'
     C                   SUB       1             ØX
     C                   ENDIF
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TDT08 /
      *////////////////////////////////////////////////////////////
     C     TDT08         BEGSR

     C                   CLEAR                   TDTR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     8             TGN
     C                   Z-ADD     1             TREP0

     C                   MOVEL     WTDT08A       T8051
     C                   MOVEL     WTDT08B       T8067
     C                   WRITE     TDTR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TOD02 /
      *////////////////////////////////////////////////////////////
     C     TOD02         BEGSR

     C                   CLEAR                   TODR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     2             TGN
     C                   Z-ADD     1             TREP0

     C                   MOVEL     WTOD02A       T4055
     C                   MOVEL     WTOD02B       T4053
     C                   MOVEL     WTOD02C       T1131
     C                   WRITE     TODR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TSR00 /
      *////////////////////////////////////////////////////////////
     C     TSR00         BEGSR

     C                   CLEAR                   TSRR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     0             TGN
     C                   ADD       1             WTSR00X
     C                   Z-ADD     WTSR00X       TREP0

     C                   MOVEL     WTSR00A       T4065
     C                   MOVEL     WTSR00B       T4219
     C                   MOVEL     WTSR00C       T7085
     C                   WRITE     TSRR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * UNH00                                               UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
     C                   CLEAR                   UNHR
     C                   Z-ADD     WMN           UMN
     C                   MOVEL     WMN           U0062A
     C                   MOVEL     'IFTMIN'      U0065
     C                   MOVEL     'S'           U0052
     C                   MOVEL     '93A'         U0054
     C                   MOVEL     'UN'          U0051
     C                   MOVEL     'NOSM12'      U0057
     C                   MOVEL     WBGM00A       U1001
     C                   MOVEL     WBGM00B       U1004
     C                   MOVEL     U0062A        U0062B
     C                   WRITE     UNHR
     C                   ENDSR
