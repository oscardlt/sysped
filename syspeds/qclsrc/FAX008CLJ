/* FACSIMILESUPPORT */
             PGM        PARM(&BPARM)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
             DCL        VAR(&COVP) TYPE(*CHAR) LEN(8)
             DCL        VAR(&COVL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&BPARM)    TYPE(*CHAR) LEN(420)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNA) TYPE(*CHAR) LEN(12)
             DCL        VAR(&DOKNA2) TYPE(*CHAR) LEN(12)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&WRKSTN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(21)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4) VALUE('0000')
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7) VALUE('0000000')
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8) VALUE('00000000')
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('D')
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&TST) TYPE(*CHAR) LEN(2)
             DCLF       FILE(FAXSEN) RCDFMT(*ALL)
             RCVF       DEV(*FILE) RCDFMT(*FILE)
             CHGVAR     VAR(&DOKNA) VALUE(%SST(&BPARM 1 12))
             CHGVAR     VAR(&DOKNA2) VALUE(%SST(&BPARM 1 12))
             CHGVAR     VAR(&TST) VALUE(%SST(&BPARM 10 2))
             CHGVAR     VAR(&MAPPE) VALUE(%SST(&BPARM 13 20))
             CHGVAR     VAR(&FAX) VALUE(%SST(&BPARM 33 21))
             CHGVAR     VAR(&PTIME) VALUE(%SST(&BPARM 54 8))
             CHGVAR     VAR(&PDATE) VALUE(%SST(&BPARM 62 8))
             CHGVAR     VAR(&NAVN) VALUE(%SST(&BPARM 70 30))
             CHGVAR     VAR(&CVP1) VALUE(%SST(&BPARM 100 40))
             CHGVAR     VAR(&CVP2) VALUE(%SST(&BPARM 140 40))
             CHGVAR     VAR(&CVP3) VALUE(%SST(&BPARM 180 40))
             CHGVAR     VAR(&CVP4) VALUE(%SST(&BPARM 220 40))
             CHGVAR     VAR(&CVP5) VALUE(%SST(&BPARM 260 40))
             CHGVAR     VAR(&CVP6) VALUE(%SST(&BPARM 300 40))
             CHGVAR     VAR(&CVP7) VALUE(%SST(&BPARM 340 40))
             CHGVAR     VAR(&CVP8) VALUE(%SST(&BPARM 380 40))
             CHGVAR     VAR(&CVP) VALUE(%SST(&BPARM 420 1))
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &QNBR)
/** JOVO     OVRPRTF    FILE(QSYSPRT) DEV(FAX3812) DRAWER(3) */
/*           OVRPRTF    FILE(QSYSPRT) DEV(FAX3812) DEVTYPE(&AFPDS) +
                          PAGESIZE(72 90) LPI(8) CPI(15) FRONTMGN(0 +
                          0) DRAWER(3) FIDELITY(*CONTENT) +
                          FNTCHRSET(QFNTCPL/C02051H0 +
                          QFNTCPL/T1DDBASE) SPOOL(*YES) +
                          OUTQ(FAX3812)    */

             PRTDOC     DOC(&DOKNA) FLR(&MAPPE) OPTIONS(*NO) +
                          OUTPUT(*PRINT)  +
                          OUTQ(QFAX/QFAXOUTQ) FORMTYPE(*STD) +
                          RESOLVE(*NO) JOBQ(*NO)

             RMVM       FILE(DOKUMENT) MBR(&UNIK)
             MONMSG     MSGID(CPF7310 CPF5815 CPF7315)
             CPYSPLF    FILE(&DOKNA) TOFILE(DOKUMENT) +
                          JOB(&QNBR/&QUSER/&QJOB) TOMBR(&UNIK) +
                          MBROPT(*ADD) CTLCHAR(*PRTCTL)

             DLTSPLF    FILE(&DOKNA) JOB(&QNBR/&QUSER/&QJOB)
             MONMSG     MSGID(CPF0000)

             OVRPRTF    FILE(LISTE)  DEVTYPE(*AFPDS) +
                          PAGESIZE(72 80) FRONTMGN(0 .2) +
                          OVRFLW(72) OUTQ(QFAX/QFAXOUTQ)

             OVRDBF     FILE(DOKUMENT) TOFILE(DOKUMENT) MBR(&UNIK)
             CALL       PGM(FAXOV)
             RMVM       FILE(DOKUMENT) MBR(&UNIK)
             MONMSG     MSGID(CPF7310 CPF5815 CPF7315)
             CALL       PGM(FAX017) PARM(&FAX)
 /* DOKUMENTNAVN OVER 10 TEGN ENDRER SEG TIL QSYSPRT */
             CHGVAR     VAR(&DOKNA) VALUE('LISTE       ')


             /* HENTER COVERPAGE PÅ AVDELING       */
             IF         COND(&CVP = 'J') THEN(CALL PGM(FAX024A) +
                          PARM(&AVD &COVP &COVL))
             IF         COND(&CVP = 'J') THEN(SNDFAX TO((&FAX &CVP2 +
                          &CVP3 &CVP4)) FILE(&DOKNA) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST) +
                          CRTCVRP(*YES) CVRPRTF(&COVL/&COVP) +
                          TITLE(&CVP1) FROM(&CVP5 &CVP6 &CVP7) +
                          COMMENT(&CVP8) FAXSNDDQ(SYSPEDF/FAXDTAQ) +
                          SNDTIME(&PTIME) SNDDATE(&PDATE))
             ELSE       CMD(SNDFAX TO((&FAX)) FILE(&DOKNA) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST) +
                          CRTCVRP(*NO) FAXSNDDQ(SYSPEDF/FAXDTAQ) +
                          SNDTIME(&PTIME) SNDDATE(&PDATE))

             CALL       PGM(FAX013) PARM(&QUSER &QNBR &QJOB +
                          &FAX &DOKNA2 &MAPPE &PTIME &PDATE &NAVN +
                          &AVD &OPD &TUR &KODE)
             ENDPGM
