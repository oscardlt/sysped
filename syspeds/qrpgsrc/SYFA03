      *
      ***************************************************************
      *** PROGRAM SKAL SKRIVE UT REGISTRERTE OPPDRAG I PERIODE    ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01 02 04-26                          ***
      *** LEDIGE INDIKATORER 27-29 32 34-97                       ***
      ***************************************************************
      *
     FHEADDT    IF   E           K DISK
     FWFILHEAD  UF A E           K DISK
     FBILLOF    IF   E           K DISK
     FBOOKING   IF   E           K DISK
     FSYFA03FM  CF   E             WORKSTN
     FSYFA03P   O    E             PRINTER OFLIND(*IN27)
     D                 DS
     D  HEDTO≈                 1      4  0
     D  HEDTOM                 5      6  0
     D  HEDTOD                 7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  XDTOD                  1      2  0
     D  XDTOM                  3      4  0
     D  XDTO≈                  5      6  0
     D  XDTOP                  1      6  0
     D                 DS
     D  WSDTFD                 1      2  0
     D  WSDTFM                 3      4  0
     D  WSDTF≈                 5      6  0
     D  WSDTF                  1      6  0
     D                 DS
     D  XDTFD                  1      2  0
     D  XDTFM                  3      4  0
     D  XDTF≈                  5      6  0
     D  XDTF                   1      6  0
     D                 DS
     D  YDTF≈                  1      4  0
     D  YDTFM                  5      6  0
     D  YDTFD                  7      8  0
     D  YDTF                   1      8  0
     D                 DS
     D  WSDTTD                 1      2  0
     D  WSDTTM                 3      4  0
     D  WSDTT≈                 5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTT≈                  5      6  0
     D  XDTT                   1      6  0
     D                 DS
     D  YDTT≈                  1      4  0
     D  YDTTM                  5      6  0
     D  YDTTD                  7      8  0
     D  YDTT                   1      8  0
     D                 DS
     D  HENAS                  1     30
     D  XNAS                   1     27
     D                 DS
     D  HENAK                  1     30
     D  XNAK                   1     27
     C*
     C                   EXSR      INIT
     C     START         TAG
     C                   EXSR      KDTFM1
     C                   EXFMT     BILDE
     C                   EXSR      KDTFM1
     C   03              GOTO      SLUTT
     C                   MOVEA     '00'          *IN(98)
     C                   SETOFF                                       30
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C*
     C                   EXSR      PRINT
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C                   MOVE      WSDTF≈        U≈≈               2 0
     C                   MOVE      WSDTFM        UMM               2 0
     C                   MOVE      WSDTFD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      99
     C   99              DO
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLTB
     C                   END
     C*
     C     WSDTT         IFEQ      0
     C                   MOVE      WSDTF         WSDTT
     C                   ELSE
     C                   MOVE      WSDTT≈        U≈≈               2 0
     C                   MOVE      WSDTTM        UMM               2 0
     C                   MOVE      WSDTTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      98
     C   98              DO
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLTB
     C                   END
     C                   END
     C*
     C                   MOVE      WSDTFD        YDTFD
     C                   MOVE      WSDTFM        YDTFM
     C                   MOVE      WSDTF≈        YDTF≈
     C     WSDTF≈        IFGT      50
     C                   MOVEL     '19'          YDTF≈
     C                   ELSE
     C                   MOVEL     '20'          YDTF≈
     C                   END
     C                   MOVE      WSDTTD        YDTTD
     C                   MOVE      WSDTTM        YDTTM
     C                   MOVE      WSDTT≈        YDTT≈
     C     WSDTT≈        IFGT      50
     C                   MOVEL     '19'          YDTT≈
     C                   ELSE
     C                   MOVEL     '20'          YDTT≈
     C                   END
     C     YDTF          COMP      YDTT                               99
     C   99              DO
     C                   MOVE      'SPD0007'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLTB
     C                   END
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C                   SETOFF                                       33
     C     HEADDK        SETLL     HEADDT
     C     STPR1         TAG
     C                   READ      HEADDT                                 33
     C  N33YDTT          COMP      HEDTOP                               33
     C  N33              DO
     C     BILLK         CHAIN     BILLOF                             31
     C  N31              MOVE      BLOB          HEOB
     C   31              DO
     C     BOOKK         CHAIN     BOOKING                            31
     C  N31              MOVE      BOOB          HEOB
     C   31              MOVE      *BLANKS       HEOB
     C                   END
     C                   WRITE     WFHEADR
     C                   GOTO      STPR1
     C                   END
     C*
     C                   SETOFF                                       33
     C                   SETON                                        27
     C                   Z-ADD     0             XSIDE
     C                   EXSR      KDTFM2
     C     WFILK         SETLL     WFILHEAD
     C     STPR2         TAG
     C                   READ      WFILHEAD                               33
     C  N33              DO
     C   27              DO
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD
     C                   SETOFF                                       27
     C                   END
     C                   EXSR      KDTFM3
     C                   WRITE     LDETALJ
     C                   GOTO      STPR2
     C                   END
     C*
     C     SLPR          ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEADDK        KLIST
     C                   KFLD                    YDTF
     C     BILLK         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     BOOKK         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     WFILK         KLIST
     C                   KFLD                    YOB
     C                   KFLD                    YOT
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C*
     C                   MOVE      *ZEROS        YAVD              4 0
     C                   MOVE      *ZEROS        YOPD              7 0
     C                   MOVE      *BLANKS       YOB               5
     C                   MOVE      *BLANKS       YOT               2
     C                   MOVE      UDAY          WSDTFD
     C                   MOVE      UMONTH        WSDTFM
     C                   MOVE      UYEAR         WSDTF≈
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        YDTF
     C                   MOVE      *ZEROS        YDTT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      WSDTFD        UDT1              2 0
     C                   MOVE      WSDTFM        UDT2              2 0
     C                   MOVE      WSDTF≈        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDTFD
     C                   MOVE      UDT2          WSDTFM
     C                   MOVE      UDT3          WSDTF≈
     C*
     C                   MOVE      WSDTTD        UDT1              2 0
     C                   MOVE      WSDTTM        UDT2              2 0
     C                   MOVE      WSDTT≈        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDTTD
     C                   MOVE      UDT2          WSDTTM
     C                   MOVE      UDT3          WSDTT≈
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      WSDTFD        UDT1              2 0
     C                   MOVE      WSDTFM        UDT2              2 0
     C                   MOVE      WSDTF≈        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XDTFD
     C                   MOVE      UDT2          XDTFM
     C                   MOVE      UDT3          XDTF≈
     C*
     C                   MOVE      WSDTTD        UDT1              2 0
     C                   MOVE      WSDTTM        UDT2              2 0
     C                   MOVE      WSDTT≈        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XDTTD
     C                   MOVE      UDT2          XDTTM
     C                   MOVE      UDT3          XDTT≈
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM3        BEGSR
     C***********************************************
     C                   MOVE      HEDTOD        UDT1              2 0
     C                   MOVE      HEDTOM        UDT2              2 0
     C                   MOVE      HEDTO≈        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XDTOD
     C                   MOVE      UDT2          XDTOM
     C                   MOVE      UDT3          XDTO≈
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
