      *
      ***************************************************************
      *** REGISTRERING INNLANDS FLYFRAKTBREV                      ***
      ***************************************************************
      *** INDICATOR 31 ON = CALL FROM SYIN10                      ***
      ***************************************************************
      *
     FFRISOK    IF A E           K DISK
     FKODFRI    IF   E           K DISK
     FDOKUI     UF A E           K DISK
     FSAMLB     IF   E           K DISK
     FHEADF     IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FKODTFC    IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTPV    IF   E           K DISK
     FKODTINP   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FTELLA     UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FLOCL01    IF   E           K DISK    USROPN
     FFIRM      IF   E           K DISK
     FLOGL05    IF   E           K DISK    USROPN
     FDIMM      UF A E           K DISK
     FSYFI10FB  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D NAV             S              3    DIM(12) CTDATA PERRCD(1)
     D HØ              S              3  2 DIM(12)
     D LE              S              3  2 DIM(12)
     D BR              S              3  2 DIM(12)
     D AN              S              3  0 DIM(12)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XSAMLB                 1      6
     D  XSDT                   1      3
     D  XLNR                   4      6  0
     D                 DS
     D  WSAWB                  1     11  0
     D  WSAWB1                 1      3  0
     D  WSAWB8                 4     11  0
     D  WSAWBA                 1      3
     D                 DS
     D  WSFRA                  1      5
     D  WSFRA1                 1      3
     D                 DS
     D  WSTIL                  1      5
     D  WSTIL1                 1      3
     D                 DS
     D  XAWB7                  1      7  0
     D  AW                     1      7  0
     D                                     DIM(7)
     D                 DS
     D  KIPB2                  1      5  2
     D  KIPB3                  6     10  2
     D  KIPB4                 11     15  2
     D  KIPB5                 16     20  2
     D  KIPB6                 21     25  2
     D  KIPB7                 26     30  2
     D  KIPB8                 31     35  2
     D  KIPB9                 36     40  2
     D  KIPB10                41     45  2
     D  KIPB11                46     50  2
     D  KIPB12                51     55  2
     D  KIPB13                56     60  2
     D  KIPB14                61     65  2
     D  KIPB15                66     70  2
     D  KIPB16                71     75  2
     D  IP                     1     75  2
     D                                     DIM(15)
     D                 DS
     D  DIXXX1                 1      7
     D  DIXXV1                 1      3
     D  DIXXV2                 4      6
     D                 DS
     D  DSDAT                  1      8  0
     D  DSAAR                  1      4  0
     D  DSMND                  5      6  0
     D  DSDAG                  7      8  0
     D                 DS
     D  DSFUEL                 1      9
     D  DSF1                   1      1
     D  DSF2                   2      2
     D  DSF3                   3      3
     D  DSF4                   4      4
     D  DSF5                   5      5
     D  DSF6                   6      6
     D  DSF7                   7      7
     D  DSF8                   8      8
     D  DSF9                   9      9
     D  DSFHEL                 1      7
     D  DSFDES                 8      9
      *____________________________________________________________
      * Definisjon av parameterlisten som brukes ved kall av SM220R
      * (automatisk booking via linje). TdV IS må være installert
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
      * AUTTRM = '1' ---> automatisk sending uten å se ekstra bildet
      * AUTTRM = annet ---> visning av ekstra bildet med opplysninger
      * OBS. Finnes det syntax feil vises ekstra bildet uansett
     D  AUTTRM                 1      1
     D  AUTPID                 2     18
     D  AUTALN                19     21  0
     D  AUTAWB                22     29  0
     D  AUTORI                30     32
     D  AUTDES                33     35
     D  AUTSDC                36     36
     D  AUTNPI                37     40  0
     D  AUTWCD                41     41
     D  AUTWGH                42     50  1
     D  AUTTPI                51     54  0
     D  AUTMAN                55     69
     D  AUTPAR                70     72
     D  AUTPCD                73     89
     D  AUTPAI                90     92
     D  AUTOFD                93     94
     D  AUTCOD                95     96
     D  AUTRAI                97     99
      * First Flight Detail
     D  AUTCAR               100    101
     D  AUTFLN               102    105
     D  XXXFLN               106    106
     D  AUTDAY               107    108  0
     D  AUTMND               109    111
     D  AUTDEP               112    114
     D  AUTARR               115    117
     D  AUTSPC               118    119
     D  AUTAID               120    133
      * Second Flight Detail
     D  AU2CAR               134    135
     D  AU2FLN               136    139
     D  XX2FLN               140    140
     D  AU2DAY               141    142  0
     D  AU2MND               143    145
     D  AU2DEP               146    148
     D  AU2ARR               149    151
     D  AU2SPC               152    153
     D  AU2AID               154    167
     D  AU2                  134    167
      * Third Flight Detail
     D  AU3CAR               168    169
     D  AU3FLN               170    173
     D  XX3FLN               174    174
     D  AU3DAY               175    176  0
     D  AU3MND               177    179
     D  AU3DEP               180    182
     D  AU3ARR               183    185
     D  AU3SPC               186    187
     D  AU3AID               188    201
     D  AU3                  168    201
      * Special Handling codes (parameter values)
     D  AUSPE1               202    204
     D  AUSP11               202    202
     D  AUSP12               203    203
     D  AUSP13               204    204
     D  AUSPE2               205    207
     D  AUSP21               205    205
     D  AUSP22               206    206
     D  AUSP23               207    207
      * Future Dimensions Information
      * Instead used to Volume
     D  AUDIM                208    240
      * Volume and Volume Measurements
     D  AUVOL                208    218
     D  AUVOLM               219    220
      * Shipment Reference Information
     D  AUTREF               221    234
     D  AUTSI1               235    246
     D  AUTSI2               247    258
      *
     D  AUTINF                 1    512
     D                 DS
     D  DIAWB                  1     11  0
     D  DIAWB3                 1      3  0
     D  DIAWB8                 4     11  0
      *____________________________________________________________
      * Definisjon av parameterlisten som brukes ved kall av TDV51C
      * (Schedule Request). TdV IS må være installert
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  BUTTRM                 1      1
     D  BUTAOR                 2      4
     D  BUTADE                 5      7
     D  BUTDA1                 8      9  0
     D  BUTMN1                10     12
     D  BUTPID                13     29
     D  BUTRA1                30     32
     D  BUTRB1                33     39
     D  BUTRC1                40     41  0
     D  BUTRA2                42     44
     D  BUTRB2                45     51
     D  BUTRC2                52     53  0
     D  BUTRA3                54     56
     D  BUTRB3                57     63
     D  BUTRC3                64     65  0
     D  BUTYKL                66     69  0
     D  BUTYAI                70     72
     D  BUTINF                 1     72
     D                 DS
     D  WREF2                  1     12
     D  WREF2A                 1      3
     D  WREF2B                 4      4
     D  WREF2C                 5     12
     D                 DS
     D  FLIG                   1      6
     D  FAA                    1      1
     D  FAB                    2      2
     D  FBA                    3      3
     D  FBB                    4      4
     D  FBC                    5      5
     D  FCC                    6      6
     D                 DS
     D  WW112                  1     11  2
     D                 DS
     D  WHØ                    1     55  0
     D                                     DIM(11)
     D  WHØ01                  1      5  0
     D  WHØ02                  6     10  0
     D  WHØ03                 11     15  0
     D  WHØ04                 16     20  0
     D  WHØ05                 21     25  0
     D  WHØ06                 26     30  0
     D  WHØ07                 31     35  0
     D  WHØ08                 36     40  0
     D  WHØ09                 41     45  0
     D  WHØ10                 46     50  0
     D  WHØ11                 51     55  0
     D                 DS
     D  WLE                    1     55  0
     D                                     DIM(11)
     D  WLE01                  1      5  0
     D  WLE02                  6     10  0
     D  WLE03                 11     15  0
     D  WLE04                 16     20  0
     D  WLE05                 21     25  0
     D  WLE06                 26     30  0
     D  WLE07                 31     35  0
     D  WLE08                 36     40  0
     D  WLE09                 41     45  0
     D  WLE10                 46     50  0
     D  WLE11                 51     55  0
     D                 DS
     D  WBR                    1     55  0
     D                                     DIM(11)
     D  WBR01                  1      5  0
     D  WBR02                  6     10  0
     D  WBR03                 11     15  0
     D  WBR04                 16     20  0
     D  WBR05                 21     25  0
     D  WBR06                 26     30  0
     D  WBR07                 31     35  0
     D  WBR08                 36     40  0
     D  WBR09                 41     45  0
     D  WBR10                 46     50  0
     D  WBR11                 51     55  0
     D                 DS
     D  WAN                    1     55  0
     D                                     DIM(11)
     D  WAN01                  1      5  0
     D  WAN02                  6     10  0
     D  WAN03                 11     15  0
     D  WAN04                 16     20  0
     D  WAN05                 21     25  0
     D  WAN06                 26     30  0
     D  WAN07                 31     35  0
     D  WAN08                 36     40  0
     D  WAN09                 41     45  0
     D  WAN10                 46     50  0
     D  WAN11                 51     55  0
      *___________________
      * DS for System Data
      *"""""""""""""""""""
     D                SDS
     D  WUSER                254    263
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C  N30
     CANN04              Z-ADD     3             LINNBR
     C  N30
     CANN04              Z-ADD     10            POSNBR
     C     WSFUEL        IFEQ      0
     C     WSVEKT        ORNE      DIVEKT
     C     WSFVKT        ORNE      DIFVKT
     C                   MOVE      *BLANKS       WSFT
     C                   MOVE      *BLANKS       WYFT
     C                   MOVE      WSVEKT        DIVEKT
     C                   MOVE      WSFVKT        DIFVKT
     C                   EXSR      FSC
     C                   ENDIF
     C                   EXFMT     BILDE01
     C                   SETOFF                                       30
     C     FITDVI        IFEQ      'J'
     C     WSAWB         ANDGT     0
     C     WSDAG1        ANDGT     0
     C     *IN03         IFEQ      *ON
     C     *IN05         OREQ      *ON
      * SJEKK OM AWB NUMMERET ER BOOKET VIA TDV IS.
     C                   MOVEL     'FFR'         WWMSID           17
     C                   MOVEL     WSAWBA        WREF2A
     C                   MOVEL     '-'           WREF2B
     C                   MOVEL     WSAWB8        WREF2C
      *           WREF2A    IFNE '154'
     C     WREF2A        IFNE      '701'
     C     LOGKY         SETLL     LOGL05                                 90
     C     *IN90         IFEQ      *OFF                                         <IKKE FUNNET
     C                   EXSR      SFFR
     C                   ENDIF                                                  <*IN90
     C                   ENDIF                                                  <WREF2A
     C                   ENDIF                                                  <*IN03
     C                   ENDIF                                                  <FITDVI
     C                   MOVE      *BLANKS       WREF2
     C                   MOVEA     '0000'        *IN(96)
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C     *IN20         IFEQ      '1'
     C     *IN21         OREQ      '1'
     C     *IN22         OREQ      '1'
     C     *IN23         OREQ      '1'
     C     *IN18         OREQ      '1'
     C     FITDVI        IFNE      'J'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      START
     C                   ENDIF
     C                   ENDIF
      *
      * KALL PÅ TDVIS LOGGFUNKSJON (SM040C)
      *
     C     *IN22         IFEQ      '1'
     C                   EXSR      VLOG
     C                   GOTO      START
     C                   END
      *
      * KALL PÅ TDVIS SCHEDUEL REQUEST
      *
     C     *IN23         IFEQ      '1'
     C                   EXSR      SFIR
     C                   GOTO      START
     C                   END
      *
      * F24=FLERE TASTER
      *
     C     *IN24         IFEQ      '1'
     C                   EXSR      UTCMDL
     C                   GOTO      START
     C                   END
     C   12
     CANN33              UPDATE    DOKUIR
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
     C                   EXSR      TESTB1
     C   30              GOTO      START
      *
      * SEND BOOKING VIA TDV IS
      *
     C     *IN20         IFEQ      '1'
     C     *IN21         OREQ      '1'
     C                   EXSR      SFFR
     C                   GOTO      START
     C                   END
      *
     C  N03
     CANN05
     CANN16
     CANN09
     CANN18              GOTO      START
      *
     C                   EXSR      MOVWSD
     C   33              WRITE     DOKUIR
     C  N33              UPDATE    DOKUIR
     C                   MOVEL     WSAWB         FSSOK
     C     FRIKEY        CHAIN     FRISOK                             77
     C   77FSKODE        CHAIN     KODFRI                             33
     C   77              IF        *IN33
     C                   MOVE      *BLANKS       FSDOKK
     C                   ELSE
     C                   MOVE      KFSODK        FSDOKK
     C                   END
     C   77              MOVE      HEDTOP        FSDTOP
     C   77              WRITE     FRISOKR
      *
      * KALL PÅ TDVIS POWER COMM AGENT OVERFØRING
      *
     C     *IN18         IFEQ      '1'
     C                   EXSR      SCOMM
     C     DOKUIK        CHAIN     DOKUI                              33
     C                   GOTO      START
     C                   END
      *
     C   09              DO
     C                   ADD       1             WSFBNR
     C                   MOVE      *ZEROS        WSAWB
     C     DOKUIK        CHAIN     DOKUI                              33
     C  N33              EXSR      MOVDWS
     C                   GOTO      START
     C                   END
      *
     C   03              Z-ADD     3             UFLAGG
     C   05              Z-ADD     5             UFLAGG
     C   16              Z-ADD     6             UFLAGG
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      * HENTER INNLANDSPRISER
      *
      *   (HEPK9 = ' ')  =  DOMESTIC AIRWAY
      *   (HEPK9 = 'J')  =  JETPAKKE
     C     HEPK9         IFEQ      'J'
     C                   MOVE      'IN2PR'       XINUNI
     C                   MOVE      'AJ'          XTAUNI
     C                   ELSE
     C     WSPREF        IFEQ      117
     C                   MOVE      'INNPR'       XINUNI
     C                   ELSE
     C                   MOVE      'IN3PR'       XINUNI
     C                   END
     C                   MOVE      'AI'          XTAUNI            2
     C                   END
     C     KODINK        CHAIN     KODTINP                            79
      *
      * TESTER SIGNATURKODE
      *
     C     KODSFK        CHAIN     KOSFR                              80
     C   80              MOVE      'SPS0011'     MSGNR
     C   80              SETON                                        30
     C   80              GOTO      SLT1
     C*
      *
      *    TEST FROM DESTINATION
      *
     C     WSFRA         CHAIN     STED2                              99
     C   99              MOVE      'SPF0008'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLT1
      *
     C     ST2SON        COMP      1                                      41
     C     ST2SON        COMP      2                                      42
     C     ST2SON        COMP      3                                      43
     C     ST2SON        COMP      4                                      44
     C     ST2SON        COMP      5                                      45
      * SKJEKKER OM VIDERØDESTINASJON  IKKE JETPAKKE
     C     HEPK9         IFEQ      'J'
     C                   SETON                                        32
     C                   ELSE
     C     KODPVK        CHAIN     KODTPV                             32
     C                   END
     C  N32              MOVE      KPVSON        ST2SON
     C   32              DO
      *
      *    TEST TO DESTINATION
      *
     C     WSTIL         CHAIN     STED2                              98
     C   98              MOVE      'SPT0009'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLT1
     C                   END
      *
      *    TEST AIRCOMPANY
      *
     C     WSAWB         IFNE      0
     C     WSPREF        COMP      WSAWB1                             9797
     C                   END
     C  N97KODFSK        CHAIN     KODTFS                             97
     C   97              MOVE      'SPF0009'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      SLT1
     C                   MOVE      KFSNAV        WSFNAV
      *
      *    TEST CUSTOM
      *
     C     WSSKNR        IFNE      0                                            1<-B
     C     KUND1K        CHAIN     CUNDL01                            96
     C   96              MOVE      'SPK0010'     MSGNR
     C   96              SETON                                        30
     C   96              GOTO      SLT1
     C     WSSNAV        IFEQ      *BLANKS                                       2<-B
     C     WSSAD1        ANDEQ     *BLANKS
     C     WSSAD2        ANDEQ     *BLANKS
     C     WSSAD3        ANDEQ     *BLANKS
     C                   MOVE      KNAVN         WSSNAV
     C                   MOVE      ADR1          WSSAD1
     C                   MOVE      ADR2          WSSAD2
     C                   MOVE      *BLANKS       WSSAD3
     C     POSTNR        IFEQ      0                                              3<-B
     C                   MOVEL     ADR3          WSSAD3
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSSAD3
     C                   MOVE      ADR3          WSSAD3
     C                   END                                                      3<-E
     C                   MOVE      TLF           WSSTLF
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *   GETS  CALCOLATED WEIGHT
      *
     C     WSFVKT        IFEQ      0
     C                   MOVE      WSVEKT        WSFVKT
     C                   END
      *
      *   GETS PRICE
      *
     C     WSTARI        IFNE      'M'                                          1<-B
      *
     C     ST2SON        IFNE      0                                             2<-B
     C     ST2SON        COMP      2                                      52
     C     ST2SON        COMP      3                                      53
     C     ST2SON        COMP      4                                      54
     C     ST2SON        COMP      5                                      55
     C                   Z-ADD     1             XNR               2 0
     C   41
     CAN 52              Z-ADD     2             XNR
     C   41
     CAN 53              Z-ADD     3             XNR
     C   41
     CAN 54              Z-ADD     4             XNR
     C   42
     CAN 52              Z-ADD     5             XNR
     C   42
     CAN 53              Z-ADD     6             XNR
     C   42
     CAN 54              Z-ADD     7             XNR
     C   43
     CAN 53              Z-ADD     8             XNR
     C   43
     CAN 54              Z-ADD     9             XNR
     C   44
     CAN 54              Z-ADD     10            XNR
     C   41
     CAN 55              Z-ADD     11            XNR
     C   42
     CAN 55              Z-ADD     12            XNR
     C   43
     CAN 55              Z-ADD     13            XNR
     C   44
     CAN 55              Z-ADD     14            XNR
     C   45
     CAN 55              Z-ADD     15            XNR
     C                   Z-ADD     IP(XNR)       WSPRIS
     C                   ELSE                                                    2
     C                   MOVE      *ZEROS        WSPRIS
     C                   END                                                     2<-E
      *
      * N32 = VIDERØDESTINASJON
      *
     C  N32              DO                                                      2<-B
     C                   ADD       KPVPRI        WSPRIS
     C                   MOVE      'V'           WSTARI
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *   END OF <WSTARI IFNE 'M'>
      *
      *  IKKE JETPAKKE
      *
     C     HEPK9         IFNE      'J'
     C     WSFVKT        MULT(H)   WSPRIS        XINPR            10 0
      *  JETPAKKE
     C                   ELSE
     C                   Z-ADD(H)  WSPRIS        XINPR
      * TILLEGG JETPAKKE OVER 20 KG
     C     WSFVKT        IFGT      KIPXX2
     C     WSFVKT        SUB       KIPXX2        XXXVK             5 0
     C     XXXVK         MULT      KIPXX1        XXXPR             5 0
     C                   ADD       XXXPR         XINPR
     C                   END
     C                   Z-ADD     XINPR         WSFRAK
     C                   END
      *IKKE JETPAKKE
     C     HEPK9         IFNE      'J'
     C     ST2SON        IFEQ      0
     C                   Z-ADD     XINPR         WSFRAK
     C                   ELSE
      *KOMBINERT VIDERØ/ANDRE + GRUNNPRIS SAS/BRÅTEN
     C     KIPB1         ADD(H)    XINPR         WSFRAK
     C                   END
      *
      * LEGGER TIL VIDERØ GRUNNPRIS
     C     WSTARI        IFEQ      'V'
     C                   ADD       KIPBVI        WSFRAK
     C                   END
     C                   END
      *
      *   GETS AWBNUMBER
      *
     C   07WSAWB         IFEQ      0
      *
     C     TELLAK        CHAIN     TELLA                              32
     C   32              GOTO      SLT1
     C     TEAFR1        COMP      TEATI1                             32
     C   32              UPDATE    TELLAR
     C   32              GOTO      SLT1
      *
     C                   MOVE      TEAFR1        XAWB7
     C                   ADD       1             TEAFR1
     C                   UPDATE    TELLAR
      *
     C                   Z-ADD     1             XN1               1 0
     C                   Z-ADD     0             XAWB1             1 0
      *
     C     XN1           DOWLE     7
     C                   MOVE      AW(XN1)       XAWB2             2 0
     C                   MOVEL     XAWB1         XAWB2
     C     XAWB2         DIV       7             XAWB1
     C                   MVR                     XAWB1
     C                   ADD       1             XN1
     C                   END
      *
     C                   MOVEL     XAWB7         XAWB8             8 0
     C                   MOVE      XAWB1         XAWB8
     C                   MOVE      XAWB8         WSAWB
     C                   MOVEL     WSPREF        WSAWB
      *
     C                   END
      *
     C                   MOVEA     '0000'        *IN(92)
     C                   MOVE      *OFF          *IN88
     C     WSCMN         IFEQ      'J'
     C     WSRUNR        IFEQ      *BLANKS
     C                   MOVE      'BBA0062'     MSGNR
     C                   MOVE      *ON           *IN95
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLT1
     C                   ENDIF
     C     WSRUN2        IFNE      *BLANKS
     C     DIXXV1        IFEQ      *BLANKS
     C                   MOVE      'BBA0061'     MSGNR
     C                   MOVE      *ON           *IN93
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLT1
     C                   ENDIF
     C                   ENDIF
     C     WSRUN3        IFNE      *BLANKS
     C     DIXXV2        IFEQ      *BLANKS
     C                   MOVE      'BBA0061'     MSGNR
     C                   MOVE      *ON           *IN88
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLT1
     C                   ENDIF
     C                   ENDIF
     C     WSRUNR        IFNE      *BLANKS
     C                   MOVEL     WSRUNR        FLIG
     C                   Z-ADD     1             FLIGNR            1 0
     C                   EXSR      FLIGTS
     C                   ENDIF
     C     WSRUN2        IFNE      *BLANKS
     C                   MOVEL     WSRUN2        FLIG
     C                   Z-ADD     2             FLIGNR
     C                   EXSR      FLIGTS
     C                   ENDIF
     C     WSRUN3        IFNE      *BLANKS
     C                   MOVEL     WSRUN3        FLIG
     C                   Z-ADD     3             FLIGNR
     C                   EXSR      FLIGTS
     C                   ENDIF
     C                   ENDIF                                                  <WSCMN
      *
     C     SLT1          TAG
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETCUR        BEGSR
      ***********************************************
     C   80              Z-ADD     2             LINNBR
     C   88              Z-ADD     4             LINNBR
     C   92              Z-ADD     3             LINNBR
     C   93              Z-ADD     4             LINNBR
     C   94              Z-ADD     3             LINNBR
     C   95              Z-ADD     3             LINNBR
     C   96              Z-ADD     5             LINNBR
     C   97              Z-ADD     4             LINNBR
     C   98              Z-ADD     3             LINNBR
     C   99              Z-ADD     3             LINNBR
      *
     C   80              Z-ADD     54            POSNBR
     C   88              Z-ADD     65            POSNBR
     C   92              Z-ADD     66            POSNBR
     C   93              Z-ADD     53            POSNBR
     C   94              Z-ADD     54            POSNBR
     C   95              Z-ADD     42            POSNBR
     C   96              Z-ADD     10            POSNBR
     C   97              Z-ADD     10            POSNBR
     C   98              Z-ADD     21            POSNBR
     C   99              Z-ADD     10            POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVUWS        BEGSR
      ***********************************************
     C     UFLAGG        IFGE      8
     C     HEGN          IFNE      *BLANKS
     C                   MOVE      HEGN          WSAWB
     C                   END
     C                   MOVE      HEKNT         WSPREF
     C                   END
     C                   MOVE      HEKNS         WSSKNR
     C                   MOVE      HESDF         WSFRA
     C                   MOVE      HESDT         WSTIL
     C                   MOVE      UCCPP         WSCCPP
     C                   MOVE      HENAS         WSSNAV
     C                   MOVE      HEADS1        WSSAD1
     C                   MOVE      HEADS2        WSSAD2
     C                   MOVE      HEADS3        WSSAD3
     C                   MOVE      USTLF         WSSTLF
     C                   MOVE      HENAK         WSKNAV
     C                   MOVE      HEADK1        WSKAD1
     C                   MOVE      HEADK2        WSKAD2
     C                   MOVE      HEADK3        WSKAD3
     C                   MOVE      UKTLF         WSKTLF
     C                   MOVE      HENT          WSANT
     C                   Z-ADD     HEVKT         WSVEKT
     C                   MOVEL     HEVS1         WSSLAG
     C                   MOVE      HEVS1         XSLAG             5
     C                   MOVEL     XSLAG         WSVSL2
     C                   Z-ADD     HEFBV         WSFVKT
     C                   MOVEL     'Utkjørin'    WSTXUT
     C                   MOVE      'g      '     WSTXUT
     C                   MOVE      HESG          WSSG
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVDWS        BEGSR
      ***********************************************
     C                   MOVE      DIST          WSST
     C                   MOVE      DIAWB         WSAWB
      * TA ALLTID MED AWB FRA OPPDRAGET-OGSÅ VED GML.
     C     UFLAGG        IFGE      8
     C     HEGN          IFNE      *BLANKS
     C                   MOVE      HEGN          WSAWB
     C                   END
     C                   MOVE      HEKNT         WSPREF
     C                   END
      *
     C                   MOVE      DIFRA         WSFRA
     C                   MOVE      DITIL         WSTIL
     C                   MOVE      DIRUNR        WSRUNR
     C                   MOVE      DICCPP        WSCCPP
     C                   MOVE      DIPREF        WSPREF
     C                   MOVE      DIFNAV        WSFNAV
     C                   MOVE      DISKNR        WSSKNR
     C                   MOVE      DISNAV        WSSNAV
     C                   MOVE      DISAD1        WSSAD1
     C                   MOVE      DISAD2        WSSAD2
     C                   MOVE      DISAD3        WSSAD3
     C                   MOVE      DISTLF        WSSTLF
     C                   MOVE      DIKNAV        WSKNAV
     C                   MOVE      DIKAD1        WSKAD1
     C                   MOVE      DIKAD2        WSKAD2
     C                   MOVE      DIKAD3        WSKAD3
     C                   MOVE      DIKTLF        WSKTLF
     C                   MOVE      DIANT         WSANT
     C                   MOVE      DIVEKT        WSVEKT
     C                   MOVE      DISLAG        WSSLAG
     C                   MOVE      DIFVKT        WSFVKT
     C                   MOVE      DITARI        WSTARI
     C                   MOVE      DIPRIS        WSPRIS
     C                   MOVE      DIMERK        WSMERK
     C                   MOVE      DIFORS        WSFORS
     C                   MOVE      DIFORA        WSFORA
     C                   MOVE      DIFRAK        WSFRAK
     C                   MOVE      DIFS          WSFS
     C                   MOVE      DITXUT        WSTXUT
     C                   MOVE      DIFPRE        WSFPRE
     C                   MOVE      DIDAG1        WSDAG1
     C                   MOVE      DIDAG2        WSDAG2
     C                   MOVE      DIDAG3        WSDAG3
     C                   MOVE      DIMLAP        WSMLAP
     C                   MOVE      DIVGEB        WSVGEB
     C                   MOVE      DIMVA         WSMVA
     C                   MOVE      DIVSL2        WSVSL2
     C                   MOVE      DIRUN2        WSRUN2
     C                   MOVE      DIRUN3        WSRUN3
     C                   MOVE      DICMN         WSCMN
     C                   MOVE      DISG          WSSG
     C                   MOVE      'J'           WSCMN
     C                   MOVE      DIFT          WSFT
     C                   MOVE      DIFUEL        WSFUEL
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWSD        BEGSR
      ***********************************************
     C                   MOVE      WSST          DIST
     C                   MOVE      WSAWB         DIAWB
     C                   MOVE      WSFRA         DIFRA
     C                   MOVE      WSTIL         DITIL
     C                   MOVE      WSRUNR        DIRUNR
     C                   MOVE      WSCCPP        DICCPP
     C                   MOVE      WSPREF        DIPREF
     C                   MOVE      WSFNAV        DIFNAV
     C                   MOVE      WSSKNR        DISKNR
     C                   MOVE      WSSNAV        DISNAV
     C                   MOVE      WSSAD1        DISAD1
     C                   MOVE      WSSAD2        DISAD2
     C                   MOVE      WSSAD3        DISAD3
     C                   MOVE      WSSTLF        DISTLF
     C                   MOVE      WSKNAV        DIKNAV
     C                   MOVE      WSKAD1        DIKAD1
     C                   MOVE      WSKAD2        DIKAD2
     C                   MOVE      WSKAD3        DIKAD3
     C                   MOVE      WSKTLF        DIKTLF
     C                   MOVE      WSANT         DIANT
     C                   MOVE      WSVEKT        DIVEKT
     C                   MOVE      WSSLAG        DISLAG
     C                   MOVE      WSFVKT        DIFVKT
     C                   MOVE      WSTARI        DITARI
     C                   MOVE      WSPRIS        DIPRIS
     C                   MOVE      WSMERK        DIMERK
     C                   MOVE      WSFORS        DIFORS
     C                   MOVE      WSFORA        DIFORA
     C                   MOVE      WSFRAK        DIFRAK
     C                   MOVE      WSFS          DIFS
     C                   MOVE      WSTXUT        DITXUT
     C                   MOVE      WSFPRE        DIFPRE
     C                   MOVE      WSDAG1        DIDAG1
     C                   MOVE      WSDAG2        DIDAG2
     C                   MOVE      WSDAG3        DIDAG3
     C                   MOVE      WSMLAP        DIMLAP
     C                   MOVE      WSVSL2        DIVSL2
     C                   MOVE      WSRUN2        DIRUN2
     C                   MOVE      WSRUN3        DIRUN3
     C                   MOVE      WSCMN         DICMN
     C                   MOVE      WSSG          DISG
     C                   MOVE      WSFT          DIFT
     C                   MOVE      WSFUEL        DIFUEL
     C   33              DO
     C                   MOVE      *ZEROS        DIVGEB
     C                   MOVE      *ZEROS        DIMVA
     C                   MOVE      *BLANKS       DIXXX2
     C                   MOVE      *BLANKS       DIXXX3
     C                   MOVE      *ZEROS        DISUM
     C                   MOVE      *BLANKS       DIXXX4
     C                   MOVE      'I'           DIRI
     C                   MOVE      UAVD          DIAVD
     C                   MOVE      UOPD          DIOPD
     C                   MOVE      WSFBNR        DIFBNR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SCOMM         BEGSR
      ***********************************************
      * Sending av singel fraktbrev som FWB til agent/kunde
      * sending av house AWB som AZB til agent/kunde
     C                   CALL      'TDV20R'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    WDUM1             3
     C                   PARM                    WDUM2             3 0
     C                   ENDSR
      ******************************************
     C     FLIGTS        BEGSR
      ******************************************
      *
      * SJEKKER FLIGHT NUMMERETS SYNTAX
      *
     C     FLIGNR        IFEQ      1
      * Carrier code must exist but flight number may be blank
     C     FAA           IFGE      'A'
     C     FAA           ANDLE     'Z'
     C     FBA           ANDEQ     *BLANK
     C     FBB           ANDEQ     *BLANK
     C     FBC           ANDEQ     *BLANK
     C     FCC           ANDEQ     *BLANK
     C                   GOTO      FLIG99
     C                   ENDIF
     C                   ELSE
      * Carrier code and flight number may be blank
     C     FLIG          IFEQ      *BLANKS
     C     FAA           ORGE      'A'
     C     FAA           ANDLE     'Z'
     C     FBA           ANDEQ     *BLANK
     C     FBB           ANDEQ     *BLANK
     C     FBC           ANDEQ     *BLANK
     C     FCC           ANDEQ     *BLANK
     C                   GOTO      FLIG99
     C                   ENDIF
     C                   ENDIF
      *
     C                   MOVE      '0'           FLIERR
     C                   SELECT
     C     FAA           WHENLT    'A'
     C     FAA           ORGT      'Z'
     C                   MOVE      '1'           FLIERR            1
     C     FBA           WHENLT    '0'
     C     FBA           ORGT      '9'
     C                   MOVE      '1'           FLIERR
     C     FBB           WHENLT    '0'
     C     FBB           ORGT      '9'
     C                   MOVE      '1'           FLIERR
     C     FBC           WHENLT    '0'
     C     FBC           ORGT      '9'
     C                   MOVE      '1'           FLIERR
     C     FCC           WHENLT    'A'
     C     FCC           ORGT      'Z'
     C     FCC           IFLT      '0'
     C     FCC           ORGT      '9'
     C     FCC           IFNE      *BLANKS
     C                   MOVE      '1'           FLIERR
     C                   ENDIF
     C                   ENDIF
     C                   ENDSL
     C     FLIERR        IFEQ      '1'
     C                   MOVE      *ON           *IN30
     C                   MOVE      'BBA0094'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   SELECT
     C     FLIGNR        WHENEQ    1
     C                   Z-ADD     35            POSNBR
     C     FLIGNR        WHENEQ    2
     C                   Z-ADD     47            POSNBR
     C     FLIGNR        WHENEQ    3
     C                   Z-ADD     59            POSNBR
     C                   ENDSL
     C                   ENDIF
      *
     C     FLIG99        TAG
     C                   ENDSR
      ***********************************************
     C     SØKKUN        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        UKN               8 0
     C                   MOVE      *BLANKS       UNA              30
     C                   CALL      'SOEKKUN'
     C                   PARM                    UKN
     C                   PARM                    UFIRM
     C                   PARM                    UNA
     C     UKN           IFNE      0
     C                   MOVE      UKN           WSSKNR
     C     KUND1K        CHAIN     CUNDL01                            34
     C     *IN34         IFEQ      '0'
     C                   MOVE      KNAVN         WSSNAV
     C                   MOVE      ADR1          WSSAD1
     C                   MOVE      ADR2          WSSAD2
     C                   MOVE      *BLANKS       WSSAD3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSSAD3
     C                   ELSE
     C                   MOVEL     POSTNR        WSSAD3
     C                   MOVE      ADR3          WSSAD3
     C                   END
     C                   MOVE      TLF           WSSTLF
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKVAD        BEGSR
      ***********************************************
     C                   CALL      'SOEKVADR'
     C                   PARM                    UFIRM
     C                   PARM                    HEKNK
     C                   PARM                    WSKNAV
     C                   PARM                    WSKAD1
     C                   PARM                    WSKAD2
     C                   PARM                    WSKAD3
     C                   PARM                    ULK               2
     C                   PARM                    UADRNR            5
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     17
     C                   EXSR      SØKKUN
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     48
     C                   EXSR      SØKVAD
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSFRA
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     21
     C     POSNBR        ANDLE     25
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSTIL
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     12
     C                   CALL      'SYFI10K'
     C                   PARM                    WSPREF
     C                   Z-ADD     5             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KODSFK        KLIST
     C                   KFLD                    XSFUNI
     C                   KFLD                    WSSG
     C     KODTWK        KLIST
     C                   KFLD                    XWUNI
     C                   KFLD                    UAVD
     C     DOKUIK        KLIST
     C                   KFLD                    XDISTA
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    WSFBNR
     C     SAMLBK        KLIST
     C                   KFLD                    XSDT
     C                   KFLD                    XLNR
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     FRIKEY        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
     C     KODFSK        KLIST
     C                   KFLD                    XFSUNI
     C                   KFLD                    WSPREF
     C     KODPVK        KLIST
     C                   KFLD                    WSFRA1
     C                   KFLD                    WSTIL1
     C     KODINK        KLIST
     C                   KFLD                    XINUNI
     C     TELLAK        KLIST
     C                   KFLD                    XTAUNI
     C                   KFLD                    WSPREF
     C                   KFLD                    KOWLAS
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSSKNR
     C     LOGKY         KLIST
     C                   KFLD                    WREF2
     C                   KFLD                    WWMSID
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD
     C                   PARM                    USG               3
     C                   PARM                    USTLF            15
     C                   PARM                    UKTLF            15
     C                   PARM                    UCCPP             2
     C                   PARM                    UMSG
      *   (UFLAGG < 8)  =  CALL FROM OTHER ODRERREGI. THAN SYIN10
      *   (UFLAGG = 8)  =  CALL FROM SYIN10 WITHOUT <F4>
      *   (UFLAGG = 9)  =  CALL FROM SYIN10 WITH <F4>
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    LE
     C                   PARM                    BR
     C                   PARM                    HØ
     C                   PARM                    AN
     C     UFLAGG        COMP      8                                  31
      *
     C     UFIRM         CHAIN     FIRM                               90
     C     FITDVI        IFEQ      'J'
     C                   MOVE      'J'           WSCMN
     C                   OPEN      LOGL05                               99
     C                   ELSE
     C                   MOVE      'N'           WSCMN
     C                   ENDIF
      *
     C                   MOVE      UAVD          FSAVD
     C                   MOVE      UOPD          FSOPD
     C                   MOVE      'IAW'         FSKODE
      *
     C                   MOVE      ' '           XXXFLN
     C                   MOVE      ' '           XX2FLN
     C                   MOVE      ' '           XX3FLN
     C                   MOVE      *ZEROS        WSAWB
     C                   MOVE      'I'           XDISTA            1
     C                   MOVE      '001'         WSFBNR
     C                   MOVE      'FS'          XFSUNI            2
     C                   MOVE      'SF'          XSFUNI            2
     C                   MOVE      'PV'          XPVUNI            2
     C                   MOVE      'W'           XWUNI             1
     C                   Z-ADD     0             X                 3 0
     C     KODTWK        CHAIN     KODTW                              33
      *
     C     HEADFK        CHAIN     HEADF                              33
      *
     C  N31              MOVE      'INNPR'       XINUNI            5
     C     DOKUIK        CHAIN     DOKUI                              33
     C   33              EXSR      MOVUWS
     C  N33              EXSR      MOVDWS
     C  N33UFLAGG        IFEQ      9
     C                   EXSR      MOVUWS
     C                   END
     C                   EXSR      UPDDIM
      * HENTER INNLANDSPRISER
      *
      *   (HEPK9 = ' ')  =  DOMESTIC AIRWAY
      *   (HEPK9 = 'J')  =  JETPAKKE
     C     HEPK9         IFEQ      'J'
     C                   MOVE      'IN2PR'       XINUNI
     C                   MOVE      'AJ'          XTAUNI
     C                   ELSE
     C     WSPREF        IFEQ      117
     C                   MOVE      'INNPR'       XINUNI
     C                   ELSE
     C                   MOVE      'IN3PR'       XINUNI
     C                   END
     C                   MOVE      'AI'          XTAUNI            2
     C                   END
     C     KODINK        CHAIN     KODTINP                            89
      *
      *
      *  -----------------------------------------------
     C     UFLAGG        IFGE      8
     C     HEHAWB        IFNE      *BLANKS
     C     HEHAWB        ANDNE     *ZEROS
     C                   MOVE      *BLANKS       WSRUNR
     C                   MOVE      *BLANKS       WSRUN2
     C                   MOVE      *BLANKS       WSRUN3
     C                   MOVE      *ZEROS        WSDAG1
     C                   MOVE      *ZEROS        WSDAG2
     C                   MOVE      *ZEROS        WSDAG3
     C     HERFA         IFNE      *BLANKS
     C                   MOVEL     HERFA         XSAMLB
     C     SAMLBK        CHAIN     SAMLB                              99
     C  N99              DO
     C                   MOVE      *BLANKS       WSRUNR
     C                   MOVE      *BLANKS       WSRUN2
     C                   MOVE      *BLANKS       WSRUN3
     C                   MOVE      *ZEROS        WSDAG1
     C                   MOVE      *ZEROS        WSDAG2
     C                   MOVE      *ZEROS        WSDAG3
     C                   END
     C                   END
     C                   END
     C                   END
      *   ----------------------------------------------
      *
     C                   EXSR      UTCMDL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SFFR          BEGSR
      ***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFFR99
     C                   ENDIF
      * Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       AUTINF                         <AUTOMATISK
     C     *IN20         IFEQ      '1'                                          <AUTOMATISK
     C                   MOVE      '1'           AUTTRM
     C                   ELSE                                                   <MED BILDE
     C                   MOVE      ' '           AUTTRM
     C                   ENDIF
     C     WREF2         IFNE      *BLANKS
     C                   MOVE      '3'           AUTTRM
     C                   ENDIF
     C                   MOVEL     *BLANKS       AUTPID                         <ADRESSE
     C                   Z-ADD     WSAWB1        AUTALN                         <AIRLINE
     C                   Z-ADD     WSAWB8        AUTAWB                         <AWB
     C                   MOVEL     WSFRA         AUTORI                         <ORIGIN AIRPORT
     C                   MOVEL     WSTIL         AUTDES                         <DEST. AIRPORT
     C                   MOVE      'T'           AUTSDC                         <SHIP.DESC.CODE
     C                   Z-ADD     WSANT         AUTNPI                         <NO. OF PIECES
     C                   MOVE      'K'           AUTWCD                         <WEIGHT CODE
     C                   Z-ADD     WSVEKT        AUTWGH                         <WEIGHT
     C                   Z-ADD     0             AUTTPI                         <T.NO.PIECES
     C     HEM3          IFNE      *ZEROS
     C                   Z-ADD(H)  HEM3          WW112
     C                   MOVEL     WW112         AUVOL
     C                   ELSE
     C                   MOVEL     *BLANKS       AUVOL
     C                   ENDIF
     C                   MOVEL     WSSLAG        AUTMAN                         <MANIFEST DESC
     C                   MOVEL     *BLANKS       AUTPAR                         <PART ID
     C                   MOVEL     *BLANKS       AUTPCD                         <PART CODE
     C                   MOVEL     *BLANKS       AUTPAI                         <PART AIRPORT
     C                   MOVEL     *BLANKS       AUTRAI                         <REQ.AIRPORT
     C                   MOVEL     *BLANKS       AUTOFD                         <REQ.OFFICE
     C                   MOVEL     *BLANKS       AUTCOD                         <REQ.COMPANY
      *
     C     WSRUNR        IFNE      *BLANKS
     C     WSRUN2        ANDEQ     *BLANKS
     C     WSRUN3        ANDEQ     *BLANKS
     C                   MOVEL     WSRUNR        AUTCAR                         <CARRIER
     C                   MOVE      WSRUNR        AUTFLN                         <FLIGHT NO.
     C                   Z-ADD     WSDAG1        AUTDAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AUTMND
     C                   MOVEL     WSFRA         AUTDEP                         <DEP.AIRPORT
     C                   MOVEL     WSTIL         AUTARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AUTSPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AUTAID                         <ALLOTMENT ID.
     C                   ENDIF                                                              D.
     C     WSRUNR        IFNE      *BLANKS
     C     WSRUN2        ANDNE     *BLANKS
     C     WSRUN3        ANDEQ     *BLANKS
     C                   MOVEL     WSRUNR        AUTCAR                         <CARRIER
     C                   MOVE      WSRUNR        AUTFLN                         <FLIGHT NO.
     C                   Z-ADD     WSDAG1        AUTDAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AUTMND
     C                   MOVEL     WSFRA         AUTDEP                         <DEP.AIRPORT
     C                   MOVEL     DIXXV1        AUTARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AUTSPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AUTAID                         <ALLOTMENT ID.
     C                   MOVEL     WSRUN2        AU2CAR                         <CARRIER
     C                   MOVE      WSRUN2        AU2FLN                         <FLIGHT NO.
     C                   Z-ADD     WSDAG2        AU2DAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AU2MND
     C                   MOVEL     DIXXV1        AU2DEP                         <DEP.AIRPORT
     C                   MOVEL     WSTIL         AU2ARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AU2SPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AU2AID                         <ALLOTMENT ID.
     C                   ENDIF                                                              D.
     C     WSRUNR        IFNE      *BLANKS
     C     WSRUN2        ANDNE     *BLANKS
     C     WSRUN3        ANDNE     *BLANKS
     C                   MOVEL     WSRUNR        AUTCAR                         <CARRIER
     C                   MOVE      WSRUNR        AUTFLN                         <FLIGHT NO.
     C                   Z-ADD     WSDAG1        AUTDAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AUTMND
     C                   MOVEL     WSFRA         AUTDEP                         <DEP.AIRPORT
     C                   MOVEL     DIXXV1        AUTARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AUTSPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AUTAID                         <ALLOTMENT ID.
     C                   MOVEL     WSRUN2        AU2CAR                         <CARRIER
     C                   MOVE      WSRUN2        AU2FLN                         <FLIGHT NO.
     C                   Z-ADD     WSDAG2        AU2DAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AU2MND
     C                   MOVEL     DIXXV1        AU2DEP                         <DEP.AIRPORT
     C                   MOVEL     DIXXV2        AU2ARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AU2SPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AU2AID                         <ALLOTMENT ID.
     C                   MOVEL     WSRUN3        AU3CAR                         <CARRIER
     C                   MOVE      WSRUN3        AU3FLN                         <FLIGHT NO.
     C                   Z-ADD     WSDAG3        AU3DAY                         <FLIGHT DAY
     C                   Z-ADD     UMONTH        ZZ                2 0
     C     AUTDAY        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       AU3MND
     C                   MOVEL     DIXXV2        AU3DEP                         <DEP.AIRPORT
     C                   MOVEL     WSTIL         AU3ARR                         <ARR.AIRPORT
     C                   MOVE      'NN'          AU3SPC                         <SPACE ALL.CODE
     C                   MOVEL     *BLANKS       AU3AID                         <ALLOTMENT ID.
     C                   ENDIF                                                              D.
      * Eventuell logikk for nye felt i bookingen (SRI)
     C                   MOVE      *BLANKS       AUTREF
     C                   MOVE      *BLANKS       AUTSI1
     C                   MOVE      *BLANKS       AUTSI2
      *
      * Sjekker om det finnes dimmension info som skal sendes over
     C     HEADFK        SETLL     DIMM
     C     HEADFK        READE(N)  DIMM                                   90
     C                   Z-ADD     0             X
     C                   MOVEA     *ZEROS        WAN
     C                   MOVEA     *ZEROS        WBR
     C                   MOVEA     *ZEROS        WLE
     C                   MOVEA     *ZEROS        WHØ
     C     *IN90         DOWEQ     *OFF
     C                   ADD       1             X
     C                   Z-ADD     DIMANT        WAN(X)
     C                   Z-ADD     DIMBRE        WBR(X)
     C                   Z-ADD     DIMLEN        WLE(X)
     C                   Z-ADD     DIMHOY        WHØ(X)
     C     X             COMP      11                                 90  90
     C  N90HEADFK        READE(N)  DIMM                                   90
     C                   ENDDO
      * Programmet venter på svar i et vist antall sekunder.
      * Kommer ikke svaret fortsetter man uten å vite det.
     C                   CALL      'SM220C2'
     C                   PARM                    AUTINF
     C                   PARM                    AUTREC            9 0
     C                   PARM                    WAN
     C                   PARM                    WBR
     C                   PARM                    WLE
     C                   PARM                    WHØ
      *
     C     SFFR99        TAG
     C                   CLOSE     LOCL01                               91
      *
     C                   ENDSR
      *
      ***********************************************
     C     VLOG          BEGSR
      ***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      VLOG99
     C                   ENDIF
     C                   CLOSE     LOCL01                               91
      *
     C                   CALL      'SM040C'
      *
     C     VLOG99        ENDSR
      ***********************************************
     C     UTCMDL        BEGSR
      ***********************************************
     C                   SELECT
     C     XCMD          WHENEQ    0
     C                   MOVE      'DIV0020'     MSGLN1
     C                   MOVE      'DIV0032'     MSGLN2
     C                   MOVE      'DIV0030'     MSGLN3
     C  N31              MOVE      'DIV0031'     MSGLN4
     C   31              MOVE      'DIV0000'     MSGLN4
     C                   MOVE      'DIV1095'     MSGLN5
     C                   MOVE      'DIV1096'     MSGLN6
     C                   MOVE      'DIV0024'     MSGLN7
     C                   ADD       1             XCMD
     C                   OTHER
     C                   MOVE      'BBA0033'     MSGLN1
     C                   MOVE      'BBA0034'     MSGLN2
     C                   MOVE      'BBA0040'     MSGLN3
     C                   MOVE      'BBA0042'     MSGLN4
     C                   MOVE      'BBA0117'     MSGLN5
     C                   MOVE      'DIV0000'     MSGLN6
     C                   MOVE      'DIV0000'     MSGLN7
     C                   Z-ADD     0             XCMD              1 0
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SFIR          BEGSR
      ***********************************************
     C                   OPEN      LOCL01                               91
     C     *IN91         IFEQ      '1'
     C                   MOVEL     'BBA0035'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SFIR99
     C                   ENDIF
      * Blanker hele parameterstrengen
     C                   MOVEL     *BLANKS       BUTINF
     C                   MOVEL     WUSER         WWUSER           17
     C     WWUSER        CHAIN     LOCL01                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     LODEFA        BUTPID                         <ADRESSE
     C                   ELSE
     C                   MOVEL     *BLANKS       BUTPID                         <ADRESSE
     C                   ENDIF
     C                   MOVEL     WSFRA         BUTAOR                         <ORIGIN AIRPORT
     C                   MOVEL     WSTIL         BUTADE                         <DEST. AIRPORT
     C                   Z-ADD     UDAY          BUTDA1
     C                   Z-ADD     UMONTH        ZZ
     C     BUTDA1        IFLT      UDAY
     C                   ADD       1             ZZ
     C     ZZ            IFGT      12
     C                   Z-ADD     1             ZZ
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     NAV(ZZ)       BUTMN1                         <FLIGHT MND
     C                   Z-ADD     0             BUTYKL
      * Kaller på program for å sende og motta Schedule Request
      * Parameter inneholder routing hvis plukket av bruker
     C                   CALL      'TDV51C'
     C                   PARM                    BUTINF
      *
      * Routingen på fraktbrevbildet skal oppdateres etter den
      * routing som bruker har valgt i TDV51R
      *
     C     BUTRA1        IFNE      *BLANKS
     C     BUTRA2        ORNE      *BLANKS
     C     BUTRA3        ORNE      *BLANKS
     C                   MOVEL     'BBA0036'     MSGNR
     C                   MOVE      *ON           *IN30
     C     BUTRA1        IFNE      *BLANKS
     C                   MOVEL     BUTRB1        WSRUNR
     C                   Z-ADD     BUTRC1        WSDAG1
     C                   ENDIF                                                  <BUTRA1
     C     BUTRA2        IFNE      *BLANKS
     C                   MOVEL     BUTRA1        DIXXV1
     C                   MOVEL     BUTRB2        WSRUN2
     C                   Z-ADD     BUTRC2        WSDAG2
     C                   ENDIF                                                  <BUTRA2
     C     BUTRA3        IFNE      *BLANKS
     C                   MOVEL     BUTRA1        DIXXV1
     C                   MOVEL     BUTRA2        DIXXV2
     C                   MOVEL     BUTRB3        WSRUN3
     C                   Z-ADD     BUTRC3        WSDAG3
     C                   ENDIF                                                  <BUTRA3
     C                   ENDIF                                                  <BUTRA1
      *
     C     SFIR99        TAG
     C                   CLOSE     LOCL01                               91
      *
     C                   ENDSR
      ***********************************************
     C     UPDDIM        BEGSR
      ***********************************************
      * Oppdaterer dimmensjoner på fraktbrevet.
      * Oppdatering skjer både ved ny og endring.
     C     AN(1)         IFGT      0
     C     HØ(1)         ANDGT     0
     C     LE(1)         ANDGT     0
     C     BR(1)         ANDGT     0
      * Sletter først de linjer som ligger inne
     C     HEADFK        SETLL     DIMM
     C     HEADFK        READE     DIMM                                   90
     C     *IN90         DOWEQ     *OFF
     C                   DELETE    DIMMR
     C     HEADFK        READE     DIMM                                   90
     C                   ENDDO
      * Skriver så de nye linjer. Satt en praktisk begrensing på 11 linjer
     C                   Z-ADD     UAVD          DIMAVD
     C                   Z-ADD     UOPD          DIMOPD
     C                   Z-ADD     AN(1)         DIMANT
     C     HØ(1)         MULT      100           DIMHOY
     C     LE(1)         MULT      100           DIMLEN
     C     BR(1)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(2)         IFGT      0
     C     HØ(2)         ANDGT     0
     C     LE(2)         ANDGT     0
     C     BR(2)         ANDGT     0
     C                   Z-ADD     AN(2)         DIMANT
     C     HØ(2)         MULT      100           DIMHOY
     C     LE(2)         MULT      100           DIMLEN
     C     BR(2)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(3)         IFGT      0
     C     HØ(3)         ANDGT     0
     C     LE(3)         ANDGT     0
     C     BR(3)         ANDGT     0
     C                   Z-ADD     AN(3)         DIMANT
     C     HØ(3)         MULT      100           DIMHOY
     C     LE(3)         MULT      100           DIMLEN
     C     BR(3)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(4)         IFGT      0
     C     HØ(4)         ANDGT     0
     C     LE(4)         ANDGT     0
     C     BR(4)         ANDGT     0
     C                   Z-ADD     AN(4)         DIMANT
     C     HØ(4)         MULT      100           DIMHOY
     C     LE(4)         MULT      100           DIMLEN
     C     BR(4)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(5)         IFGT      0
     C     HØ(5)         ANDGT     0
     C     LE(5)         ANDGT     0
     C     BR(5)         ANDGT     0
     C                   Z-ADD     AN(5)         DIMANT
     C     HØ(5)         MULT      100           DIMHOY
     C     LE(5)         MULT      100           DIMLEN
     C     BR(5)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(6)         IFGT      0
     C     HØ(6)         ANDGT     0
     C     LE(6)         ANDGT     0
     C     BR(6)         ANDGT     0
     C                   Z-ADD     AN(6)         DIMANT
     C     HØ(6)         MULT      100           DIMHOY
     C     LE(6)         MULT      100           DIMLEN
     C     BR(6)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(7)         IFGT      0
     C     HØ(7)         ANDGT     0
     C     LE(7)         ANDGT     0
     C     BR(7)         ANDGT     0
     C                   Z-ADD     AN(7)         DIMANT
     C     HØ(7)         MULT      100           DIMHOY
     C     LE(7)         MULT      100           DIMLEN
     C     BR(7)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(8)         IFGT      0
     C     HØ(8)         ANDGT     0
     C     LE(8)         ANDGT     0
     C     BR(8)         ANDGT     0
     C                   Z-ADD     AN(8)         DIMANT
     C     HØ(8)         MULT      100           DIMHOY
     C     LE(8)         MULT      100           DIMLEN
     C     BR(8)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(9)         IFGT      0
     C     HØ(9)         ANDGT     0
     C     LE(9)         ANDGT     0
     C     BR(9)         ANDGT     0
     C                   Z-ADD     AN(9)         DIMANT
     C     HØ(9)         MULT      100           DIMHOY
     C     LE(9)         MULT      100           DIMLEN
     C     BR(9)         MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(10)        IFGT      0
     C     HØ(10)        ANDGT     0
     C     LE(10)        ANDGT     0
     C     BR(10)        ANDGT     0
     C                   Z-ADD     AN(10)        DIMANT
     C     HØ(10)        MULT      100           DIMHOY
     C     LE(10)        MULT      100           DIMLEN
     C     BR(10)        MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C     AN(11)        IFGT      0
     C     HØ(11)        ANDGT     0
     C     LE(11)        ANDGT     0
     C     BR(11)        ANDGT     0
     C                   Z-ADD     AN(11)        DIMANT
     C     HØ(11)        MULT      100           DIMHOY
     C     LE(11)        MULT      100           DIMLEN
     C     BR(11)        MULT      100           DIMBRE
     C                   WRITE     DIMMR
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
     C***********************************************
     C     FSC           BEGSR
     C***********************************************
      *
      * AUTOMATISK BEREGNING AV FUEL SURCHARGE
      *
     C                   Z-ADD     WSFUEL        WXFUEL            9 2
     C                   CLEAR                   DSDAT
     C                   MOVE      UYEAR         DSAAR
     C                   MOVEL     '20'          DSAAR
     C                   MOVE      UMONTH        DSMND
     C                   MOVE      UDAY          DSDAG
     C     KODFCK        KLIST
     C                   KFLD                    YFCUNI
     C                   KFLD                    WSPREF
     C                   MOVE      'FC'          YFCUNI            2
     C     KODFCK        CHAIN     KODTFC                             66
     C     *IN66         IFEQ      *OFF
      * IKKE JETPAK
     C     HEPK9         IFEQ      'J'
     C                   Z-ADD     0             WSFUEL
     C                   MOVEL     *BLANKS       WSFT
     C                   MOVEL     *BLANKS       WYFT
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <HEPK9
      * SJEKK MINIMUMSVEKT
     C     KFCVKT        IFEQ      'A'
     C     WSVEKT        ANDLT     KFCMIN
     C                   Z-ADD     0             WSFUEL
     C                   MOVEL     *BLANKS       WSFT
     C                   MOVEL     *BLANKS       WYFT
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <KFCVKT
     C     KFCVKT        IFEQ      'C'
     C     WSFVKT        ANDLT     KFCMIN
     C                   Z-ADD     0             WSFUEL
     C                   MOVEL     *BLANKS       WSFT
     C                   MOVEL     *BLANKS       WYFT
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <KFCVKT
      * SJEKK LANDKODE - INCLUDE
     C     KFCIO1        IFEQ      'I'
     C     HELKA         IFNE      KFCLK1
     C     HELKA         ANDNE     KFCLK2
     C     HELKA         ANDNE     KFCLK3
     C     HELKA         ANDNE     KFCLK4
     C     HELKA         ANDNE     KFCLK5
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <HELKA
     C                   ENDIF                                                  <KFCIO1
      * SJEKK LANDKODE - OMIT
     C     KFCIO1        IFEQ      'O'
     C     HELKA         IFEQ      KFCLK1
     C     HELKA         OREQ      KFCLK2
     C     HELKA         OREQ      KFCLK3
     C     HELKA         OREQ      KFCLK4
     C     HELKA         OREQ      KFCLK5
     C                   GOTO      FSCSL
     C                   ENDIF                                                  <HELKA
     C                   ENDIF                                                  <KFCIO1
      * SJEKK GYLDIGHETSDATO
     C     KFCTIL        IFEQ      *ZEROS
     C                   MOVE      99999999      KFCTIL
     C                   END
     C     DSDAT         IFLE      KFCTIL
     C     DSDAT         ANDGE     KFCFRA
      * SJEKK FRAKTBEREGNINGSVEKT ELLER AKTUELL VEKT
     C     KFCVKT        IFEQ      'A'
     C     WSVEKT        MULT      KFCAVG        WSFUEL            9 2
     C                   ELSE
     C     WSFVKT        MULT      KFCAVG        WSFUEL
     C                   ENDIF                                                  <DFCVKT
     C                   MOVE      WSFUEL        DSFUEL
     C                   MOVE      WSFUEL        DSFUEL
     C     DSF1          IFEQ      '0'
     C                   MOVE      ' '           DSF1
     C     DSF2          IFEQ      '0'
     C                   MOVE      ' '           DSF2
     C     DSF3          IFEQ      '0'
     C                   MOVE      ' '           DSF3
     C     DSF4          IFEQ      '0'
     C                   MOVE      ' '           DSF4
     C     DSF5          IFEQ      '0'
     C                   MOVE      ' '           DSF5
     C     DSF6          IFEQ      '0'
     C                   MOVE      ' '           DSF6
     C                   ENDIF                                                  <DSF6
     C                   ENDIF                                                  <DSF5
     C                   ENDIF                                                  <DSF4
     C                   ENDIF                                                  <DSF3
     C                   ENDIF                                                  <DSF2
     C                   ENDIF                                                  <DSF1
     C     WYFT          IFEQ      WSFT
     C                   MOVE      *BLANKS       WSFT14
     C     DSFHEL        CAT       ',':0         WSFT14           14
     C     WSFT14        CAT       DSFDES:0      WSFT14
     C     WSFT14        CAT       'NOK':1       WSFT14
     C     KFCFTX        CAT       WSFT14:1      WSFTNY           41
     C                   MOVEL     WSFTNY        WSFT
     C                   MOVEL     WSFTNY        WXFT             41
     C                   ENDIF                                                  <WYFT
     C                   MOVEL     WSFT          WYFT             41
     C                   ENDIF                                                  <DSDAT
     C                   ENDIF                                                  <*IN66
     C     FSCSL         ENDSR
      *
**    TABELL  (NAV)  ENDRING N04BB
JAN
FEB
MAR
APR
MAY
JUN
JUL
AUG
SEP
OCT
NOV
DEC
