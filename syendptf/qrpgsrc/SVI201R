********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 CB  PTF10 Bruk svenske kroner isteden for valuta
11XXX * 02 CB  PTF11 Feil lengde på nettovekt til rapporten
12XXX * 03 YBC PTF12 Ny kolonne for urprungsland
********************************************************************
     FSVIH10    IF   E           K DISK
     FSVIV      IF   E           K DISK
     FQ         O  A F  256        DISK
N02  D ZVIV_NETO       S              9S 0
     D                 DS
     D  DATONF                 1      8S 0
     D  DATONT                 9     16S 0
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *__________________________
      * Definiere arbetsvariablar
      *""""""""""""""""""""""""""
     C     *LIKE         DEFINE    SVIH_MOKN     UVIH_MOKN
     C                   MOVE      *BLANKS       KVATNO           17
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    SVIH_SYAV
     C                   KFLD                    SVIH_SYOP
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVATNO           17
     C                   PARM                    UDATOF            8
     C                   PARM                    UDATOT            8
     C                   MOVEL     UDATOF        DATONF
     C                   MOVEL     UDATOT        DATONT
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C                   EXCEPT    UTHEAD
     C     DATONF        SETLL     SVIH10
     C                   READ      SVIH10                                 51
     C     *IN51         DOWEQ     *OFF
     C     SVIH_SYDT     IFGE      DATONF
     C     SVIH_SYDT     IFLE      DATONT
     C     SVIH_SYST     IFEQ      'G'
     C                   EXSR      SRBA
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Læs næsta varulinje
     C                   READ      SVIH10                                 51
     C  N51              ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Les varelinjer                                      SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVIV
     C     KEYA          READE     SVIV                                   52
     C     *IN52         DOWEQ     *OFF
     C     SVIV_EUP1     IFEQ      '4200'
     C     SVIV_BII1     COMP      UVATNO                                 55
     C  N55SVIV_BII2     COMP      UVATNO                                 55
     C  N55SVIV_BII3     COMP      UVATNO                                 55
     C  N55SVIV_BII4     COMP      UVATNO                                 55
     C  N55SVIV_BII5     COMP      UVATNO                                 55
     C  N55SVIV_BII6     COMP      UVATNO                                 55
     C  N55SVIV_BII7     COMP      UVATNO                                 55
     C  N55SVIV_BII8     COMP      UVATNO                                 55
     C  N55SVIV_BII9     COMP      UVATNO                                 55
     C                   IF        *IN55

     C                   SELECT
     C     SVIV_BIT1     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII1
     C     SVIV_BIT2     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII2
     C     SVIV_BIT3     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII3
     C     SVIV_BIT4     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII4
     C     SVIV_BIT5     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII5
     C     SVIV_BIT6     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII6
     C     SVIV_BIT7     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII7
     C     SVIV_BIT8     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII8
     C     SVIV_BIT9     WHENEQ    'Y041'
     C                   EVAL      KVATNO=SVIV_BII9
     C                   OTHER
     C                   EVAL      KVATNO=*BLANKS
     C                   ENDSL
     C                   IF        SVIH_VAKD='EUC'
     C                   EVAL      SVIH_VAKD='EUR'
     C                   ENDIF
N01  C                   EVAL      SVIH_VAKD='SEK'
N01  C                   EVAL      SVIV_FABL=SVIV_STVA
N02  C                   EVAL      ZVIV_NETO=SVIV_NETO
N02  C                   IF        ZVIV_NETO=*ZEROS
N02  C                   EVAL      ZVIV_NETO=1
N02  C                   ENDIF
     C                   EXCEPT    UT

     C                   ENDIF
     C                   ENDIF
     C     KEYA          READE     SVIV                                   52
     C  N52              ENDDO
     C                   ENDSR
     OQ         EADD         UTHEAD
     O                                              'Landkode'
     O                                              ';'
     O                                              'Fast verdi'
     O                                              ';'
     O                                              'Varekode'
     O                                              ';'
     O                                              'Annen kvantitet'
     O                                              ';'
     O                                              'Nettovekt'
     O                                              ';'
N03  O                                              'Ursprungsland'
N03  O                                              ';'
     O                                              'Valutakode Faktura'
     O                                              ';'
     O                                              'Fakturabeløp'
     O                                              ';'
     O                                              'Kingsrød referanse'
     O                                              ';'
     O                                              'Deklarasjonsdato'
     O                                              ';'
     O                                              'Kjøpers VAT-nummer'
     O                                              ';'
     O                                              'Fakturanr'
N03  O                                              ';'
N03  O                                              'TullID'
     OQ         EADD         UT
     O                       SVIH_MOLK            2
     O                                            3 ';'
     O                                            4 '1'
     O                                            5 ';'
     O                       SVIV_VATA           15
     O                                           16 ';'
     O                                           18 '00'
     O                       SVIV_ANKV           27
     O                                           28 ';'
     O                                           30 '00'
S02  O*                      SVIV_NETO           39
N02  O                       ZVIV_NETO           39
     O                                           40 ';'
N03  O                       SVIV_ULKD           42
N03  O                                           43 ';'
S03  O*                      SVIH_VAKD           43
N03  O                       SVIH_VAKD           46
S03  O*                      SVIV_FABL           54
N03  O                       SVIV_FABL           57
S03  O*                                          44 ';'
N03  O                                           47 ';'
S03  O*                                          53 '; '
N03  O                                           56 '; '
     O                       SVIV_SYAV
     O                                              '/'
     O                       SVIV_SYOP
     O                                              '; '
S03  O*                      SVIH_SYDT           74
N03  O                       SVIH_SYDT           77
     O                                              '; '
S03  O*                      KVATNO              92
N03  O                       KVATNO              95
     O                                              '; '
S03  O*                      SVIH_FATX          110
N03  O                       SVIH_FATX          113
     O                                              '; '
     O                       SVIH_TUID
