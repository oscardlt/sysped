     Fkodfri    IF   E           K DISK
     FDOKUF     IF   E           K DISK
     FTRAN      IF   E           K DISK
     FTRACKL02  IF   E           K DISK
     FEDIINN    IF   E           K DISK
     FFREETXT2  IF   E           K DISK
     FDOKEF     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FHEAD12    IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF12)
     FHEAD17    IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF17)
     FHEADF     IF   E           K DISK
     F                                     RENAME(HEADFR:HEADF01)
     FHEAD3     IF   E           K DISK
     FFRISOL01  IF   E           K DISK
     FFRISOK    IF   E           K DISK
     F                                     RENAME(FRISOKR:FRISOK2)
     FKODTA     IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FSNDDST    O  A E             DISK
     D TABELL          S              2  0 DIM(50) CTDATA PERRCD(1) ASCEND
     D TABTXT          S             78    DIM(50) ALT(TABELL)
     D                 DS
     D  CUSTN                  1     17
     D  HETLE                  1      6
     D  STREK                  7      7
     D  HETLL                  8     17
     D                 DS
     D  HEAVD                  1      4  0
     D  WEAVD2                 1      4
     D                 DS
     D  frttxt                 1     70
     D  frttx1                 1     37
     D  frttx2                38     70
     D                 DS
     D  DF1004                 1     35
     D  dfSNDN                 1     17
     D                 DS
     D  qvadir                 1     15
     D  qvad01                 1      1
     d  qavd                   2      5  0
     d  qopd                   7     13  0
     D                 DS
     D  HEOPD                  1      7  0
     D  WEOPD                  1      7
     D                 DS
     D  WDATO                  1      6
     D  WDTD                   1      2  0
     D  WDTM                   3      4  0
     D  WDTÅ                   5      6  0
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D XANSW1          C                   CONST('No information found')
     D XANSW2          C                   CONST('The following inform-
     D                                     ation was found for -
     D                                     your request:')
     D XANSW3          C                   CONST('====================-
     D                                     ====================-
     D                                     =============')
     D XANSW4          C                   CONST('********************-
     D                                     *** End of Info ****-
     D                                     *************')
     D IANSW1          C                   CONST('No information found')
     D IANSW2          C                   CONST('<b>The following inf-
     D                                     ormation was<BR>foun-
     D                                     d for your request')
     D IANSW3          C                   CONST('</b></font>         -
     D                                                         -
     D                                                  ')
     D IANSW4          C                   CONST('********************-
     D                                     *** End of Info ****-
     D                                     *************')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C     QTYPE         IFEQ      'ord'
     C     QTYPE         OREQ      'ORD'
     C                   MOVEL     'frisoek.'    KEYOR            10
     C                   MOVE      ': '          KEYOR            10
     C     KEYOR         CHAIN     EDIINN                             55                   33
     C  N55LO:UP         XLATE     IDATA         IDATA
     C  N55              MOVEL     IDATA         QTYPE
     C   55              MOVE      'ORD'         QTYPE
     C                   EXSR      SRB2
     C                   ELSE
     C                   EXSR      SRB
     C                   END
      * End of Info
     C*
     C     *IN61         IFEQ      '1'
     C     TCPJN         IFEQ      'J'
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ELSE
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     XANSW4        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
     C                   ENDIF
      *
      *
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    QTYPE             3
     C                   PARM                    QVALUE           15
     C                   PARM                    TCPJN             1
      *_______________
      * Definiere felt
      *"""""""""""""""
     C     *LIKE         DEFINE    HEAVD         WEAVD
     C     *LIKE         DEFINE    HEGN          WEGN
     C     *LIKE         DEFINE    HEGN          WEGN2
     C     *LIKE         DEFINE    HEHAWB        WEHAWB
     C     *LIKE         DEFINE    KFSUNI        WFSUNI
     C     *LIKE         DEFINE    KFSFNR        WFSFNR
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVEL     'FS'          WFSUNI
     C                   MOVE      '-'           STREK
     C                   MOVE      'F'           DFRI              1
     C                   MOVE      'A'           FREKOD            1
     C                   READ      FIRM                                   33
      *_______________
      * Definiere keys
      *"""""""""""""""
     C     TRANKE        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    DFTRAN
      *"""""""""""""""
     C     FREKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FREKOD
     C     DOKUKE        KLIST
     C                   KFLD                    DOKKOD            1
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    DFFBNR
     C                   move      'F'           dokkod
     c                   z-add     1             DFFBNR
     C     DOKKEY        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEAD3K        KLIST
     C                   KFLD                    WEAVD
     C                   KFLD                    WEGN
     C     XEAD3K        KLIST
     C                   KFLD                    WEAVD
     C                   KFLD                    WEGN2
     C     HEA12K        KLIST
     C                   KFLD                    WEAVD
     C                   KFLD                    WEHAWB
     C     HEA17K        KLIST
     C                   KFLD                    WERFA
     C     HEMKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     FSKEY         KLIST
     C                   KFLD                    WFSUNI
     C                   KFLD                    WFSFNR
     C     FRIKEY        KLIST
     C                   KFLD                    QTYPE
     C                   KFLD                    FSSOK
     C     FRIHEA        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     FRIKE2        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FSKODE
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRB                                                  SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C                   Z-ADD     0             WEAVD
     C                   MOVEL     QVALUE        WEGN11           11
     C                   MOVE      WEGN11        WEGN
     C                   MOVEL     QVALUE        WEGN2
     C                   MOVEL     QVALUE        WEHAWB
S01  C*                  MOVEL     QVALUE        WERFA            15
N01  C                   MOVEL     QVALUE        WERFA            35
     C     *LOVAL        SETLL     KODTA
      * LES FRA AVDELINGSREGISTER
     C                   READ      KODTA                                  51
     C     *IN51         DOWEQ     *OFF
     C     *IN61         ANDEQ     *OFF
      * LES FRA OPPDRAGSREGISTER
     C                   Z-ADD     KOAAVD        WEAVD
     C     HEA12K        CHAIN     HEAD12                             52
     C   52HEAD3K        CHAIN     HEAD3                              52
     C   52XEAD3K        CHAIN     HEAD3                              52
     C   52HEA17K        CHAIN     HEAD17                             52
     C  N52DOKKEY        CHAIN     DOKEF                              33
      *
      * BEHANDLING VED TREFF PÅ ORDRENUMMER
      * OPPDRAG FUNNET
      *
     C     *IN52         IFEQ      *OFF
      *
      * HENTER EVENTUELLT KUNDES ORDENUMMER
      *
     C                   MOVE      'ORD'         FSKODE
     C     FRIKE2        CHAIN     FRISOK                             88
      *
      *
     C     TCPJN         IFEQ      'J'
     C                   EXSR      SRBAI
     C                   ELSE
     C                   EXSR      SRBA
     C                   END
     C                   MOVE      *ON           *IN61
      *
      * START AWB-BEHANDLING VED FLERE ORDRE
      *
     C  N52QTYPE         IFEQ      'AWB'
     C     QTYPE         OREQ      'awb'
     C     NESTE         TAG
     C     HEAD3K        READE     HEAD3                                  52
     C   52HEA17K        reade     HEAD17                                 52
     C  N52DOKKEY        CHAIN     DOKEF                              33
     C  N52TCPJN         IFEQ      'J'
     C                   EXSR      SRBAI
     C                   ELSE
     C                   EXSR      SRBA
     C                   END
     C  N52              GOTO      NESTE
     C                   END
      *
      *SLUTT AWB
      *
      *
     C                   ENDIF
      *
     C                   READ      KODTA                                  51
     C                   ENDDO
      *
      *SLUTT PÅ HOVEDLØKKE
      *______________
      * INGEN TREFF !
      *""""""""""""""
     C     *IN61         IFEQ      '0'
     C                   EXSR      NOHIT
     C                   ENDIF
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  SRB2 FRI SØKEVEI                                     SRB /
      *////////////////////////////////////////////////////////////
     C     SRB2          BEGSR
     c                   movel     qvalue        qvadir
     c                   movel     qtype         qtypegm           3
     c                   movel     qvalue        frisokgm         15
     c*
     c* direkte søk
     c*
     c     qvad01        ifeq      '*'
     c     hek           klist
     c                   kfld                    qavd
     c                   kfld                    qopd
     c     hek           chain     headf                              52
     c  n52dokkey        chain     dokef                              33
     c  n52              exsr      srbai
     C                   MOVE      *ON           *IN61
     c                   else
     C                   MOVEL     QVALUE        FSSOK
     c* viser alle oppdrag med denne søkevei
     c     frikey        setll     frisol01
     c     *in40         doueq     '1'
     c                   movel     qtypegm       qtype
     c                   movel     frisokgm      fssok
     c     frikey        reade     frisol01                               40
     c     *in40         ifeq      '0'
     c*
     C  N52FRIHEA        CHAIN     HEADF                              52
     C  N52DOKKEY        CHAIN     DOKEF                              33
      *
      * BEHANDLING VED TREFF PÅ ORDRENUMMER
      *
     C     *IN52         IFEQ      *OFF
      *
     C     TCPJN         IFEQ      'J'
     C                   EXSR      SRBAI
     C                   ELSE
     C                   EXSR      SRBA
     C                   END
     C                   MOVE      *ON           *IN61
      *
     C                   ENDIF
     C                   ENDIF
     c                   enddo
     C                   ENDIF
      *
      *______________
      * INGEN TREFF !
      *""""""""""""""
     C     *IN61         IFEQ      '0'
     C                   EXSR      NOHIT
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRBA                                                SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
     C                   MOVE      HEDTD         WDTD
     C                   MOVE      HEDTM         WDTM
     C                   MOVE      HEDTÅ         WDTÅ
      * HAR NÅ ALLE VARIABLER FRA HEAD3
      * Heading
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     XANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     XANSW3        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Blank linje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * FRI SØKEVEI
     C     QTYPE         IFEQ      'ORD'
     C     QTYPE         OREQ      'ord'
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Orderno:'    RDATA
     C     RDATA         CAT       FSSOK:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      * FORTOLLET
     C     HETLE         IFNE      *ZEROS
     C     HETLE         ANDNE     *BLANKS
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Customs:'    RDATA
     C     RDATA         CAT       CUSTN:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      * Mawb
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Mawb   :'    RDATA
     c     heur          ifne      'D'
     c     heur          andne     'C'
     C                   MOVEL     'Agentrf:'    RDATA
     c                   end
     C     HEUR          IFEQ      'D'
     C     RDATA         CAT       HEGN:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   ELSE
     C     RDATA         CAT       HERFA:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   END
     C                   WRITE     E101CRR
      * Hawb
     C     HEHAWB        IFNE      *BLANKS
     C     HEHAWB        ANDNE     *ZEROS
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Hawb   :'    RDATA
     c     heur          ifne      'D'
     c     heur          andne     'C'
     C                   MOVEL     'With   :'    RDATA
     c                   end
     C     RDATA         CAT       HEHAWB:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      * Airline
     c     heur          ifeq      'D'
     C                   MOVEL     DFFSN         WFSFNR
     C     FSKEY         CHAIN     KODTFS                             53
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Airline:'    RDATA
     C     RDATA         CAT       KFSNAV:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
      * From
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'From   :'    RDATA
     C     RDATA         CAT       HESDF:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * To
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'To     :'    RDATA
     C     RDATA         CAT       HESDT:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * lokal transport
     C     DOKUKE        CHAIN     DOKUF                              33
     C     *in(33)       ifeq      '0'
     c                   exsr      ttsr2
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Loc/trs:'    RDATA
     c     heur          ifne      'D'
     c     heur          andne     'C'
     C                   MOVEL     'NO/trsp/date'RDATA
     c                   end
     C     DFTRAN        IFNE      *ZEROS
     C     TRANKE        CHAIN     TRAN                               34
     C     *IN(34)       IFEQ      '0'
     C     VMINTP        ANDNE     *BLANKS
     C     RDATA         CAT       VMINTP:1      RDATA
     C     RDATA         CAT       DFSNDN:0      RDATA
     C                   ELSE
     C     RDATA         CAT       DFSNDN:1      RDATA
     C                   END
     C                   ELSE
     C     RDATA         CAT       DFSNDN:1      RDATA
     C                   END
     C     RDATA         CAT       DFNAT:1       RDATA
     c                   move      ttdate        ttdata            8
     c  N34rdata         cat       ttdata:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
      * No/pcs
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'No/pcs :'    RDATA
     C                   Z-ADD     HENT          ØN152
     C                   EXSR      SRNE
     C     RDATA         CAT       ØAN:1         RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Weight
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Weight :'    RDATA
     C                   Z-ADD     HEVKT         ØN152
     C                   EXSR      SRNE
     C     RDATA         CAT       ØAN:1         RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Description
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Descr  :'    RDATA
     C     RDATA         CAT       HEVS1:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Date
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Date   :'    RDATA
     C     RDATA         CAT       WDATO:1       RDATA
     C     RDATA         CAT       '(ddmmy':1    RDATA
     C     RDATA         CAT       'y)':0        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Our ref
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Our ref:'    RDATA
     C     RDATA         CAT       WEAVD2:1      RDATA
     C     RDATA         CAT       '/':0         RDATA
     C     RDATA         CAT       WEOPD:0       RDATA
     C     RDATA         CAT       '/':0         RDATA
     C     RDATA         CAT       HESG:0        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Underline
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     XANSW3        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Blank linje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shipper
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Shipper:'    RDATA
     C     RDATA         CAT       HENAS:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shippers adress 1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Address:'    RDATA
     C     RDATA         CAT       HEADS1:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shippers adress 2
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Address:'    RDATA
     C     RDATA         CAT       HEADS2:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shippers adress 3
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Address:'    RDATA
     C     RDATA         CAT       HEADS3:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Blank linje, 3 stykk
     C                   DO        3
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ENDDO
      * Consignee
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Consign:'    RDATA
     C     RDATA         CAT       HENAK:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee adress 1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Address:'    RDATA
     C     RDATA         CAT       HEADK1:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee adress 2
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Address:'    RDATA
     C     RDATA         CAT       HEADK2:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee adress 3
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Address:'    RDATA
     C     RDATA         CAT       HEADK3:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Blank linje, 2 stykk
     C                   DO        2
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ENDDO
     C*
     C     HEDTMO        IFNE      *ZEROS
     C     HEDTMO        ANDNE     *BLANKS
      * Delivery date
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Delivery'    RDATA
     C     RDATA         CAT       ' date':0     RDATA
     C     RDATA         CAT       ' (ddmm':0    RDATA
     C     RDATA         CAT       'yy):':0      RDATA
     C     RDATA         CAT       HEDTMO:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Delivery time
     C     HEKLMO        IFNE      *ZEROS
     C                   MOVEL     HEKLMO        WEKLMO            4
     C                   ELSE
     C                   MOVE      *BLANKS       WEKLMO
     C                   ENDIF
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Delivery'    RDATA
     C     RDATA         CAT       ' time':0     RDATA
     C     RDATA         CAT       ' (hhmm':0    RDATA
     C     RDATA         CAT       ')  :':0      RDATA
     C     RDATA         CAT       WEKLMO:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Signed by
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Signed b'    RDATA
     C     RDATA         CAT       'y':0         RDATA
     C     RDATA         CAT       ':':13        RDATA
     C     RDATA         CAT       HESGM:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ENDIF
      * FRITEKST
     C     FREKEY        SETLL     FREETXT2                               33
      * Blank linje, HVIS FRITEKT
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
     C                   MOVEA     '0'           *IN(33)
     C     *IN33         DOWEQ     '0'
     C     FREKEY        READE     FREETXT2                               33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       RDATA
     C     FRIT          IFNE      'J'
     C                   MOVEL     'Info:'       RDATA
     C                   ELSE
     C                   MOVEL     '    :'       RDATA
     C                   END
     C                   MOVE      'J'           FRIT              1
     C     RDATA         CAT       FRTTX1:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *andre del av fritext-linjen
      *
     c     frttx2        ifne      *blanks
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     '    :'       RDATA
     C     RDATA         CAT       FRTTX2:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
     C                   END
     C                   END
      * Blank linje, HVIS FRITEKT
     C     FRIT          IFEQ      'J'
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      *______________
      * KALLER TDVIS VED FLY
      *""""""""""""""
     C     FITDVI        ifeq      'J'
     C     HEUR          IFEQ      'C'
     C     HEUR          OREQ      'D'
     C                   EXSR      TDV
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRBAI                                               SRBAI/
      *////////////////////////////////////////////////////////////
     C     SRBAI         BEGSR
     C                   MOVE      HEDTD         WDTD
     C                   MOVE      HEDTM         WDTM
     C                   MOVE      HEDTÅ         WDTÅ
      * HAR NÅ ALLE VARIABLER FRA HEAD3
      * Heading
     C                   MOVE      '</td>'       TD                5
     C                   MOVEL     '</td>'       TDTR             10
     C                   MOVE      '</tr>'       TDTR
     C                   MOVE      '</table>'    TABLE             8
     C     01            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C*                  END
     C                   MOVE      *blanks       RDATA
     C     03            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C*                  END
      * FRI SØKEVEI
     C                   MOVE      *BLANKS       RDATA
     C     05            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       FSSOK:1       RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Mawb
     C                   MOVE      *BLANKS       RDATA
     C     06            LOOKUP    TABELL        TABTXT                   33
     c     heur          ifne      'D'
     c     heur          andne     'C'
     C     38            LOOKUP    TABELL        TABTXT                   33
     c                   end
     C                   MOVEL     TABTXT        RDATA
     C     HEUR          IFEQ      'D'
     C     RDATA         CAT       HEGN:1        RDATA
     C                   ELSE
     C     RDATA         CAT       HERFA:1       RDATA
     C                   END
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * FORTOLLET
     C                   MOVE      *BLANKS       RDATA
     C     07            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       CUSTN:1       RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Hawb
     C                   MOVE      *BLANKS       RDATA
     C     08            LOOKUP    TABELL        TABTXT                   33
     c     heur          ifne      'D'
     c     heur          andne     'C'
     C     39            LOOKUP    TABELL        TABTXT                   33
     c                   end
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEHAWB:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Airline
     c     heur          ifeq      'D'
     C                   MOVEL     DFFSN         WFSFNR
     C     FSKEY         CHAIN     KODTFS                             53
     C                   MOVE      *BLANKS       RDATA
     C     09            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       KFSNAV:1      RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     e101CRR
     c                   else
     C                   MOVE      *BLANKS       RDATA
     C     36            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
      * From
     C                   MOVE      *BLANKS       RDATA
     C     10            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HESDF:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * No/pcs
     C                   MOVE      *BLANKS       RDATA
     C     11            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   Z-ADD     HENT          ØN152
     C                   EXSR      SRNE
     C     RDATA         CAT       ØAN:1         RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * To
     C                   MOVE      *BLANKS       RDATA
     C     12            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HESDT:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * lokal transport
     C     DOKUKE        CHAIN     DOKUF                              33
     C     *in(33)       ifeq      '0'
     c                   exsr      ttsr2
     C                   MOVE      *BLANKS       RDATA
     C     30            LOOKUP    TABELL        TABTXT                   33
     c     heur          ifne      'D'
     c     heur          andne     'C'
     C     40            LOOKUP    TABELL        TABTXT                   33
     c                   end
     C                   MOVEL     TABTXT        RDATA
     C     DFTRAN        IFNE      *ZEROS
     C     TRANKE        CHAIN     TRAN                               34
     C     *IN(34)       IFEQ      '0'
     C     VMINTP        ANDNE     *BLANKS
     C     RDATA         CAT       VMINTP:1      RDATA
     C     RDATA         CAT       DFSNDN:0      RDATA
     C                   ELSE
     C     RDATA         CAT       DFSNDN:1      RDATA
     C                   END
     C                   ELSE
     C     RDATA         CAT       DFSNDN:1      RDATA
     C                   END
     C     31            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       tabtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*linje 2
     C                   MOVE      *BLANKS       RDATA
     C     32            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       DFNAT:1       RDATA
     C     33            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       tabtxt:1      RDATA
     c                   move      ttdate        ttdata            8
     c  N34rdata         cat       ttdata:1      RDATA
     C     34            LOOKUP    TABELL        TABTXT                   33
     C     RDATA         CAT       tabtxt:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
      * Weight
     C                   MOVE      *BLANKS       RDATA
     C     13            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   Z-ADD     HEVKT         ØN152
     C                   EXSR      SRNE
     C     RDATA         CAT       ØAN:1         RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Description
     C                   MOVE      *BLANKS       RDATA
     C     14            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEVS1:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Date
     C                   MOVE      *BLANKS       RDATA
     C     15            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       WDATO:1       RDATA
     C     RDATA         CAT       TD:1          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Our ref
     C                   MOVE      *BLANKS       RDATA
     C     16            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       WEAVD2:1      RDATA
     C     RDATA         CAT       '/':0         RDATA
     C     RDATA         CAT       WEOPD:0       RDATA
     C     RDATA         CAT       '/':0         RDATA
     C     RDATA         CAT       HESG:0        RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C     RDATA         CAT       TABLE:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *blanks       RDATA
     C     03            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shipper
     C                   MOVE      *BLANKS       RDATA
     C     21            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HENAS:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shippers adress 1
     C                   MOVE      *BLANKS       RDATA
     C     22            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEADS1:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shippers adress 2
     C                   MOVE      *BLANKS       RDATA
     C     22            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEADS2:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Shippers adress 3
     C                   MOVE      *BLANKS       RDATA
     C     22            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEADS3:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee
     C                   MOVE      *BLANKS       RDATA
     C     23            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HENAK:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee adress 1
     C                   MOVE      *BLANKS       RDATA
     C     22            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEADK1:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee adress 2
     C                   MOVE      *BLANKS       RDATA
     C     22            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEADK2:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Consignee adress 3
     C                   MOVE      *BLANKS       RDATA
     C     22            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEADK3:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C*
     C     HEDTMO        IFNE      *ZEROS
     C     HEDTMO        ANDNE     *BLANKS
      * Delivery date
     C                   MOVE      *BLANKS       RDATA
     C     24            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HEDTMO:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Delivery time
     C     HEKLMO        IFNE      *ZEROS
     C                   MOVEL     HEKLMO        WEKLMO            4
     C                   ELSE
     C                   MOVE      *BLANKS       WEKLMO
     C                   ENDIF
     C                   MOVE      *BLANKS       RDATA
     C     25            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       WEKLMO:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Signed by
     C                   MOVE      *BLANKS       RDATA
     C     26            LOOKUP    TABELL        TABTXT                   33
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       HESGM:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ENDIF
      * FRITEKST
     C     FREKEY        SETLL     FREETXT2
     C                   MOVEA     '0'           *IN(33)
     C     *IN33         DOWEQ     '0'
     C     FREKEY        READE     FREETXT2                               33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       RDATA
     C     FRIT          IFNE      'J'
     C     27            LOOKUP    TABELL        TABTXT                   34
     C                   MOVEL     TABTXT        RDATA
     C                   ELSE
     C     28            LOOKUP    TABELL        TABTXT                   34
     C                   MOVEL     TABTXT        RDATA
     C                   END
     C                   MOVE      'J'           FRIT              1
     C     RDATA         CAT       FRTTX1:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *andre del av fritext-linjen
      *
     c     frttx2        ifne      *blanks
     C                   MOVE      *BLANKS       RDATA
     C     27            LOOKUP    TABELL        TABTXT                   34
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       FRTTX2:1      RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
     C                   END
     C                   END
      * FRIe søkeveier
     C     hemkey        SETLL     frisok
     C                   MOVEA     '0'           *IN(33)
     C     *IN33         DOWEQ     '0'
     C     hemkey        READE     FRisok                                 33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       RDATA
     C     35            LOOKUP    TABELL        TABTXT                   34
     C                   MOVEL     TABTXT        RDATA
     c*
     c* skriver først kodens tekst deretter innhold
     c*
     c     fskode        chain     kodfri                             34
     c                   movel     kfsotx        kodtxt           15
     C     RDATA         CAT       KFSOko:1      RDATA
     C     RDATA         CAT       KODTXT:1      RDATA
     C     RDATA         CAT       FSSOK:1       RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
     c                   end
     c*
      *
      *______________
      * KALLER TDVIS VED FLY
      *""""""""""""""
     C     FITDVI        ifeq      'J'
     C     HEUR          IFEQ      'C'
     C     HEUR          OREQ      'D'
     C                   EXSR      TDV
     C                   ENDIF
     C                   ENDIF
     c* sluttag
     C                   MOVE      *BLANKS       RDATA
     C     37            LOOKUP    TABELL        TABTXT                   34
     C                   MOVEL     TABTXT        RDATA
     C     RDATA         CAT       TDTR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     C                   MOVE      *BLANKS       RDATA
     C     RDATA         CAT       TABLE:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c*
     C                   MOVE      *BLANKS       RDATA
     C                   movel     '<br><br>'    RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leftjustify numerical fields                        SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * MOve correct value into Alfa 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      ',  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C                   END                                                    <-------------I
      * Scan from left and find first num over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  ikke noe funnet                                     SRNE /
      *////////////////////////////////////////////////////////////
     C     NOHIT         BEGSR
     C                   MOVE      *BLANKS       RDATA
     C     TCPJN         IFEQ      'J'
     C                   MOVEL     IANSW1        RDATA
     C                   ELSE
     C                   MOVEL     XANSW1        RDATA
     C                   END
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Qtype
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'QTYPE  :'    RDATA
     C     RDATA         CAT       QTYPE:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * QVALUE
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'QVALUE :'    RDATA
     C     RDATA         CAT       QVALUE:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TDVIS                                               TDV  /
      *////////////////////////////////////////////////////////////
     C     TDV           BEGSR
     C     HEUR          IFEQ      'C'
     C                   MOVEL     HERFA         QV               12
     C                   ELSE
     C                   MOVE      HEGN          QV11             11
     C                   MOVEL     QV11          QV
     C                   END
     C                   CALL      'EDI20R2C'
     C                   PARM                    QV
     C                   PARM                    TCPJN
     C                   ENDSR
     C***********************************************
     C     TTSR2         BEGSR
     C***********************************************
     c* henter dato for når fraktbrev var utskrevet ved kopiutskrift
     c     ttkey         klist
     C                   kfld                    heavd
     C                   kfld                    heopd
     C                   kfld                    dffbnr
     C                   kfld                    ttacti
      *
     C                   MOVE      'PRW'         TTACTI
     C     ttkey         chain     trackl02                           34
     C                   ENDSR
**
01<center>
02<table border=2  border cellspacing=2>
03<center><table WIDTH=100% border cellspacing=15 cellpadding=2>
04<tr valign=middle><td valign=middle>
05<tr><td><b>Orderno:</b></td><td>
06<td><b><u>Mawb:</u></b></td><td>
07<tr><td><b>Customs:</b></td><td>
08<td><b>Hawb:</b></td><td>
09<tr><td><b>Airline:</b></td><td>
10<td><b>From:</b></td><td>
11<tr><td><b>No/pcs:</b></td><td>
12<td><b>To:</b></td><td>
13<tr><td><b>Weight:</b></td><td>
14<td><b>Descr:</b></td><td>
15<tr><td><b>Date:</b></td><td>
16<td><b>Our ref:</b></td><td>
17<center>
18<table border=2 width=100% border cellspacing=2>
19<center><table border cellspacing=10 cellpadding=2>
20<tr valign=middle><td valign=middle>
21<tr><td><b>Shipper:</b></td><td>
22<tr><td><b>Adress:</b></td><td>
23<tr><td><b>Consign:</b></td><td>
24<tr><td><b>Del. date:</b></td><td>
25<tr><td><b>Del. time:</b></td><td>
26<tr><td><b>Signed by:</b></td><td>
27<tr><td><b>Info:</b></td><td>
28<tr><td><b> </b></td><td>
29</td></tr></table>
30<tr><td><b>Local/trs:</b></td><td>
31</td>
32<td><b>
33</b></td><td>
34</td></tr>
35<tr><td><b>Ref:</b></td><td>
36<tr><td><b> </b></td><td>
37<tr><td><b>* END ORDER *</b></td><td>
38<td><b><u>Agentref:</u></b></td><td>
39<td><b>With:</b></td><td>
40<tr><td><b>NO/trsp/date:</b></td><td>
