/**************************************************************************/
/*   KOPIERER OBJEKT TIL ENDELIG MAPPE (ARKIV SKANN MM)                    */
/**************************************************************************/
/*                                                                        */
/* OBS! FØR KOMPILERING: CRTPF FILE(QTEMP/XIFSAUT) RCDLEN(132) AUT(*ALL)  */
/*                                                                        */
/*N01 - *PUBLIC - *ALL */
/*N02 - INNDRA INDIVIDUELLE/PRIVATE AUTHORITIES.*/
/*N03 - HOPP UT VED FEIL I MOV                  */
/*N04 - OBJEKT IBRUK TESTER                     */
/*N05 - TIL-OBJEKT FINNES ALLEREDE (OG ALLE ANDRE UKJENTE FEIL..) */
             PGM   PARM(&FRA &TIL &OK)
             DCL        VAR(&MSGTXT) TYPE(*CHAR) LEN(132)
             DCL        VAR(&MSGLEN) TYPE(*DEC) LEN(5 0)
             DCL        VAR(&MSGDTA) TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGDTALEN) TYPE(*DEC) LEN(5 0)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&KEYVAR) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SENDER) TYPE(*CHAR) LEN(720)
             DCL        VAR(&FRA) TYPE(*CHAR) LEN(120)
             DCL        VAR(&TIL) TYPE(*CHAR) LEN(120)
             DCL        VAR(&OK) TYPE(*CHAR) LEN(1)


/* FORUTSETTER OK */
             CHGVAR     VAR(&OK) VALUE('J')

 NYMOV:      CPY        OBJ(&FRA) TOOBJ(&TIL) TOCCSID(277) AUT(*INDIR)
/***********************************************************************/
/*     BEHANDLING HVIS CPY IKKE FUNGERER    ****************************/
/***********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(CALLSUBR SUBR(HANDLEERR))
/***********************************************************************/
/*     OBJEKT I BRUK                        ****************************/
/***********************************************************************/
             IF         COND(&MSGID = 'CPFA09E') THEN(DO)
             DLYJOB     DLY(20)
             GOTO       CMDLBL(NYMOV)
             ENDDO
/***********************************************************************/
/*     OBJEKT FINNES IKKE                   ****************************/
/***********************************************************************/
             IF         COND(&MSGID = 'CPFA0A9') THEN(DO)
                        CHGVAR VAR(&OK) VALUE('N')
                        GOTO CMDLBL(EXIT)
             ENDDO
/***********************************************************************/
/*     ANDRE FEIL?? (TIL-FIL FINNES MM..) ALT ANNET ENN BLANK I &MSGID */
/***********************************************************************/
/*N05*/      IF         COND(&MSGID *NE '       ') THEN(DO)
/*N05*/                 CHGVAR VAR(&OK) VALUE('N')
/*N05*/                 GOTO CMDLBL(EXIT)
/*N05*/      ENDDO





/***********************************************************************/
 /*  DELETE AV FRA OBJEKT HVIS OK                                 */
/***********************************************************************/
EXIT:        IF         COND(&OK *EQ 'J') THEN(DEL OBJLNK(&FRA))

/***********************************************************************/
/*  START SUBRUTINE  HANDLEERR  */
/***********************************************************************/
             SUBR       SUBR(HANDLEERR)

             RCVMSG     MSGTYPE(*LAST) RMV(*NO) KEYVAR(&KEYVAR) +
                          MSG(&MSGTXT) MSGLEN(&MSGLEN) +
                          MSGDTA(&MSGDTA) MSGDTALEN(&MSGDTALEN) +
                          MSGID(&MSGID) SENDER(&SENDER) +
                          SENDERFMT(*LONG)
             SNDPGMMSG  MSG('Feilkode = ' *CAT &MSGID *CAT '.')
             ENDSUBR
/***********************************************************************/
/*  SLUTT SUBRUTINE  HANDLEERR  */
/***********************************************************************/
             ENDPGM
