********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P11081* 01 CB  PTF11  Varubeskrivelse 2
P11082* 02 CB  PTF10 REPETITION AV R44     70/80/10/63
P10170* 03 CB  PTF10 Legg ut oppdragsnummer i ARKIVP
P12035* 04 CB  PTF12 Nu eget utskriftsnummer 262
P12035* 05 SH  PTF12 call arkivering
P12XXX* 06 CB  PTF12 Skrev feilaktig ut null-linje
P12XXX* 07 CB  PTF12 Skriv ut statistiskt värde istället för fakturabelopp
P12XXX* 08 CB  PTF12 Ändra varukod 33B
P12XXX* 09 JOV PTF12 sikre at brutto/Netto vekt ikke er lenger enn prtf kan motta..
     FSVEV      IF   E           K DISK
     FSVEVA     IF   E           K DISK
     FSVEH      IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FSVE007P   O    E             PRINTER OFLIND(*IN27) USROPN
     FFIRM      IF   E             DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E           K DISK
     D                SDS
     D  ZUSER                254    263
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN154                  1     15  4
     D  ØA154H                 1     11
     D  ØA154D                12     15
     D                 DS
     D  ØA16                   1     16
     D  Ø16                    1     16
     D                                     DIM(16)                              Num edit
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVEHASYAV         4
     C                   PARM                    UVEHASYOP         7
     C                   PARM                    CALLTYP           1
     C                   MOVE      UVEHASYAV     UVEH_SYAV
     C                   MOVE      UVEHASYOP     UVEH_SYOP
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SVEH_SYAV     UVEH_SYAV
     C     *LIKE         DEFINE    SVEH_SYOP     UVEH_SYOP
     C     *LIKE         DEFINE    KOPUNI        UOPUNI
     C     *LIKE         DEFINE    KOPAVD        UOPAVD
     C     *LIKE         DEFINE    KOPLNR        UOPLNR
     C     *LIKE         DEFINE    KFMSD         UFMSD
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVEH_SYAV
     C                   KFLD                    UVEH_SYOP
     C     KEYB          KLIST
     C                   KFLD                    UVEH_SYAV
     C                   KFLD                    UVEH_SYOP
     C                   KFLD                    SVEV_SYLI
     C     KEYP          KLIST
     C                   KFLD                    UOPUNI
     C                   KFLD                    UOPAVD
     C                   KFLD                    UOPLNR
     C     KEYF          KLIST
     C                   KFLD                    KOPFM
     C                   KFLD                    UFMSD
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C                   EVAL      UOPUNI='P'
     C                   EVAL      UOPAVD=UVEH_SYAV
S04  C*                  EVAL      UOPLNR=252
N04  C                   EVAL      UOPLNR=262
     C                   EVAL      UFMSD=1
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD           1024
      *______________________________________
      * Hente firmaopplysninger fra spedisjon
      *""""""""""""""""""""""""""""""""""""""
     C                   READ      FIRM
      *_____________________
      * Hente printerstyring
      *"""""""""""""""""""""
     C     KEYP          CHAIN     KODTP
     C     KEYF          CHAIN     KODTFM
      *_______________
      * Printerstyring
      *"""""""""""""""
     C     CALLTYP       IFEQ      'A'
     C                   CALL      'SVE007CA'
     C                   ELSE
     C                   EVAL      UCMD='OVRPRTF FILE(SVE007P) OUTQ('
     C     UCMD          CAT       KOPNVN:0      UCMD
     C     UCMD          CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   ENDIF
     C                   OPEN      SVE007P
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Læs varuposter                                       SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     SVEH
     C                   WRITE     SVE007PA

     C     KEYA          SETLL     SVEV
     C     KEYA          READE     SVEV                                   51
     C     *IN51         DOWEQ     *OFF
     C                   EVAL      WRUBR32=SVEV_VANO
     C                   MOVEL     SVEV_VATA     WRUBR33A
S08  C*                  MOVE      SVEV_VATA     WRUBR33B
     C                   EVAL      WRUBR33C=SVEV_VATI
     C                   EVAL      WRUBR34=SVEV_ULKD
     C                   EVAL      WRUBR37A=SVEV_EUP1
     C                   MOVEL     SVEV_EUP2     WRUBR37B
N09  C                   if        SVEV_BRUT>99999999.999
N09  C                   EVAL      WRUBR35=99999999.999
N09  c                   else
     C                   EVAL      WRUBR35=SVEV_BRUT
N09  c                   endif
N09  C                   if        SVEV_NETO>99999999.999
N09  C                   EVAL      WRUBR38=99999999.999
N09  c                   else
     C                   EVAL      WRUBR38=SVEV_NETO
N09  c                   endif
     C                   EVAL      WRUBR31=SVEH_GODM
     C                   EVAL      WRUBR31B=*BLANKS
N01  C                   EVAL      WRUBR31C=*BLANKS
      *
     C                   EVAL      ØN154=SVEV_KOTA
     C                   EXSR      SRNE
      *
     C                   MOVEL     ØAN           WRUBR31B
     C     WRUBR31B      CAT       SVEV_KOSL:1   WRUBR31B
     C     WRUBR31B      CAT       SVEV_VASL:1   WRUBR31B
N01  C                   EVAL      ØN154=SVEV_KOT2
N01  C                   EXSR      SRNE
N01   *
N01  C                   MOVEL     ØAN           WRUBR31C
N01  C     WRUBR31C      CAT       SVEV_KOS2:1   WRUBR31C
N01  C     WRUBR31C      CAT       SVEV_VAS2:1   WRUBR31C
N06  C                   IF        WRUBR31C='0    '
N06  C                   EVAL      WRUBR31C=*BLANKS
N06  C                   ENDIF
     C                   EVAL      WRUBR41=SVEV_ANKV
S07  C*                  EVAL      WRUBR46=SVEV_FABL
N07  C                   EVAL      WRUBR46=SVEV_STVA
S02  C*                  EVAL      WRUBR44=SVEV_SUTX

     C                   IF        *IN27
     C                   EVAL      *IN27=*OFF
     C                   WRITE     SVE007PA
     C                   ENDIF
     C                   WRITE     SVE007PB

N02  C                   EXSR      SRBB
     C                   EXSR      SRBA
     C
     C     KEYA          READE     SVEV                                   51
     C                   ENDDO

     C                   WRITE     SVE007PZ
     C     CALLTYP       IFEQ      'C'
     C                   EXSR      ARKSR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Læs avgifter                                        SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
     C     KEYB          SETLL     SVEVA
     C     KEYB          READE     SVEVA                                  52
     C     *IN52         DOWEQ     *OFF

     C                   EVAL      WRUBR47A=SVEVA_ABK
     C                   EVAL      WRUBR47B=SVEVA_ABG
     C                   EVAL      WRUBR47C=SVEVA_ABS
     C                   EVAL      WRUBR47D=SVEVA_ABB

     C                   IF        *IN27
     C                   EVAL      *IN27=*OFF
     C                   WRITE     SVE007PA
     C                   ENDIF
     C                   WRITE     SVE007PC
     C
     C     KEYB          READE     SVEVA                                  52
     C                   ENDDO
     C                   ENDSR
N02   *////////////////////////////////////////////////////////////
N02   *  Skriv R44                                           SRBB /
N02   *////////////////////////////////////////////////////////////
N02  C     SRBB          BEGSR
N02
N02   * Særskilda upplysningar-1
N02  C     SVEV_SUKO     IFNE      *BLANKS
N02  C     SVEV_SUTX     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUKO     WRUBR44
N02  C     WRUBR44       CAT       SVEV_SUTX:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-2
N02  C     SVEV_SUT2     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT2     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-3
N02  C     SVEV_SUT3     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT3     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-4
N02  C     SVEV_SUT4     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT4     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-5
N02  C     SVEV_SUT5     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT5     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-6
N02  C     SVEV_SUK6     IFNE      *BLANKS
N02  C     SVEV_SUT6     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUK6     WRUBR44
N02  C     WRUBR44       CAT       SVEV_SUT6:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-7
N02  C     SVEV_SUT7     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT7     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-8
N02  C     SVEV_SUT8     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT8     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-9
N02  C     SVEV_SUT9     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUT9     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-10
N02  C     SVEV_SUTA     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUTA     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-11
N02  C     SVEV_SUKB     IFNE      *BLANKS
N02  C     SVEV_SUTB     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUKB     WRUBR44
N02  C     WRUBR44       CAT       SVEV_SUTB:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-12
N02  C     SVEV_SUTC     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUTC     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-13
N02  C     SVEV_SUTD     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUTD     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-14
N02  C     SVEV_SUTE     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUTE     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Særskilda upplysningar-15
N02  C     SVEV_SUTF     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_SUTF     WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-1
N02  C     SVEV_BIT1     IFNE      *BLANKS
N02  C     SVEV_BII1     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT1     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII1:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-2
N02  C     SVEV_BIT2     IFNE      *BLANKS
N02  C     SVEV_BII2     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT2     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII2:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-3
N02  C     SVEV_BIT3     IFNE      *BLANKS
N02  C     SVEV_BII3     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT3     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII3:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-4
N02  C     SVEV_BIT4     IFNE      *BLANKS
N02  C     SVEV_BII4     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT4     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII4:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-5
N02  C     SVEV_BIT5     IFNE      *BLANKS
N02  C     SVEV_BII5     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT5     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII5:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-6
N02  C     SVEV_BIT6     IFNE      *BLANKS
N02  C     SVEV_BII6     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT6     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII6:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-7
N02  C     SVEV_BIT7     IFNE      *BLANKS
N02  C     SVEV_BII7     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT7     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII7:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-8
N02  C     SVEV_BIT8     IFNE      *BLANKS
N02  C     SVEV_BII8     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT8     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII8:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Bilagda handlingar-9
N02  C     SVEV_BIT9     IFNE      *BLANKS
N02  C     SVEV_BII9     ORNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_BIT9     WRUBR44
N02  C     WRUBR44       CAT       SVEV_BII9:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Container 1 - 4
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_CO01     WRUBR44
N02  C     WRUBR44       CAT       SVEV_CO02:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_CO03:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_CO04:1   WRUBR44
N02  C     WRUBR44       IFNE      *BLANKS
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Container 5 - 8
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_CO05     WRUBR44
N02  C     WRUBR44       CAT       SVEV_CO06:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_CO07:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_CO08:1   WRUBR44
N02  C     WRUBR44       IFNE      *BLANKS
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Tidigare handlingar-1
N02  C     SVEV_TIX1     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_TIK1     WRUBR44
N02  C     WRUBR44       CAT       SVEV_TIT1:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_TIX1:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * Tidigare handlingar-2
N02  C     SVEV_TIX2     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_TIK2     WRUBR44
N02  C     WRUBR44       CAT       SVEV_TIT2:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_TIX2:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02   * LagerID
N02  C     SVEV_LAGI     IFNE      *BLANKS
N02  C                   EVAL      WRUBR44=*BLANKS
N02  C                   MOVEL     SVEV_LAGT     WRUBR44
N02  C     WRUBR44       CAT       SVEV_LAGL:1   WRUBR44
N02  C     WRUBR44       CAT       SVEV_LAGI:1   WRUBR44
N02  C                   IF        *IN27
N02  C                   EVAL      *IN27=*OFF
N02  C                   WRITE     SVE007PA
N02  C                   ENDIF
N02  C                   WRITE     SVE007PD
N02  C                   ENDIF
N02  C
N02  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *    Arkiver                                          ARKSR /
      /////////////////////////////////////////////////////////////
     C     ARKSR         BEGSR
      * SKAL DOKUMENT ARKIVERES ?
     C                   MOVE      'S3'          ARTYPE
     C     FIFIRM        CHAIN     FIRMARC                            34
     C  N34ARTYPE        CHAIN     ARKTXT                             34
     C     *IN(34)       IFEQ      '0'
     C     ARKJN         ANDEQ     'J'

     C                   Z-ADD     SVEH_AVKN     ARKUND
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      UVEH_SYAV     ARAVD
     C                   MOVE      *ZEROS        AROPD
N03  C                   MOVE      UVEH_SYOP     AROPD
     C                   MOVE      WDT           ARDATE
     C                   MOVE      WTM           ARTIME
     C                   MOVE      ZUSER         ARUSER
     C                   MOVE      UVEH_SYOP     ARUNDE
     C                   MOVEL     'S3:'         ARUNDE
     C                   WRITE     ARKIVR
N05   *_________________________
N05   * Aktivera arkivfunktionen
N05   *"""""""""""""""""""""""""
N05  C                   CALL      'ARC002CLB'
N05  C                   PARM      'S3'          WATYPE            2
N05  C                   PARM                    ARUSER
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA16
     C     ØA154D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA154H        ØA16                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA154H        ØA16                                         I
     C                   MOVE      '.    '       ØA16                                         I
     C                   MOVE      ØA154D        ØA16                                         I
     C     Ø16(16)       IFEQ      '0'
     C                   MOVE      ' '           Ø16(16)
     C     Ø16(15)       IFEQ      '0'
     C                   MOVE      ' '           Ø16(15)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        15            ØX                             <-------------I
     C     Ø16(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø16(ØX)       ØAN
      *
     C                   ENDSR
