      *
      ***********************************************************
      *** PROGRAM SKAL OVERFØRE SAD-LINJER TIL TET            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-29 32 35 36 38 45-47 50-53 55-59 61-69 71-87 94
      ***********************************************************
     FSAEH      IF   E           K DISK
     FSAEHOM    IF   E           K DISK    RENAME(SAEHR:SAEHOMR)
     FSAEV2     UF   E           K DISK
     FSAEV4     UF   E           K DISK    RENAME(SAEVR:SAEV4R)
     FTRUV      O  A E             DISK
     FWFILEEXP  UF A E           K DISK    USROPN
     D MN              S             17    DIM(20)
     D VS              S             30    DIM(20)
     D                 DS
     D  WFEVKB                 1      9  0
     D  WFEVKB123              1     12  3
     D                 DS
     D  WFEVKN                 1      9  0
     D  WFEVKN123              1     12  3
     D                 DS
     D  WFEKN1                 1     28
     D  WFEKN1A                1     24
     D  WFEKN2                29     56
     D  WFEKN2A               29     52
     D  WFEKN3                57     84
     D  WFEKN3A               57     80
     D  WFEKN4                85    112
     D  WFEKN4A               85    108
     D  WFEKN5               113    140
     D  WFEKN5A              113    136
     D  WFEKN6               141    168
     D  WFEKN6A              141    164
     D  WFEKN7               169    196
     D  WFEKN7A              169    192
     D  KN                     1    196    DIM(7) ASCEND
     D                 DS
     D  WFEVB1                 1     30
     D  WFEVB2                31     60
     D  WFEVB3                61     90
     D  WFEVB4                91    120
     D  WFEVB5               121    150
     D  VB                     1    210    DIM(7) ASCEND
     D                 DS
     D  WFETO1                 1     45
     D  WFETO1A                1     17
     D  WFETO2                46     90
     D  WFETO2A               46     62
     D  WFETO3                91    135
     D  WFETO3A               91    107
     D  WFETO4               136    180
     D  WFETO4A              136    152
     D  WFETO5               181    225
     D  WFETO5A              181    197
     D  WFETO6               226    270
     D  WFETO7               271    315
     D  WFETO8               316    360
     D  WFETO9               361    405
     D  WFETO10              406    450
     D  WFETO11              451    495
     D  WFETO12              496    540
     D  WFETO13              541    585
     D  WFETO14              586    630
     D  WFETO15              631    675
     D  TO                     1    675    DIM(15)
     D                 DS
     D  WFETC1                 1      3
     D  WFETC2                 4      6
     D  WFETC3                 7      9
     D  WFETC4                10     12
     D  WFETC5                13     15
     D  WFETC6                16     18
     D  WFETC7                19     21
     D  WFETC8                22     24
     D  WFETC9                25     27
     D  WFETC10               28     30
     D  WFETC11               31     33
     D  WFETC12               34     36
     D  WFETC13               37     39
     D  WFETC14               40     42
     D  WFETC15               43     45
     D  TC                     1     45    DIM(15)                              Cref ved komm.
     D                 DS
     D  XWFVN1                 1      6  0
     D  XWFVN2                 7      8  0
     D  WFEVNT                 1      8  0
     D                 DS
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D  SVTOPL                 1     45
     D                 DS
     D  SVVNT                  1      8  0
     D  SVFYL                  9     10
     D  SVAVT                 11     11
     D  SVAVTS                12     14
     D  SVAVTP                15     21  3
     D  XBRUD1                 1     21
     D  UDD                    5      6  0
     D                 DS
     D  WFEVT                  1      4
     D  WFEVT1                 1      4
     D                 DS
     D  WFEANT                 1      6  0
     D  WFEANT1                1      6  0
      *
     C                   EXSR      INIT
      *
     C                   EXSR      SUMVAR
      *
     C     SAEH7K        SETLL     SAEH7                              30
     C     START         TAG
     C     SAEH7K        READE     SAEH7                                  30
     C  N30SEAVD         IFNE      UAVD
     C                   GOTO      SLUTT
     C                   END
      *
     C                   SETON                                        LR
      ***********************************************
     C     SUMVAR        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTVKTB            9 0
     C                   MOVE      'J'           XORI              1
     C                   MOVE      'J'           XTOTSLT           1
      *** ---------------------------------------------
      *
     C                   IF        SESAM = 'N'
     C                   MOVE      *ZEROS        XVLN              5 0
     C     SAEV2K        SETLL     SAEV4
     C                   ELSE
     C                   MOVE      *BLANKS       XBRUD2           21
     C     SAEV2K        SETLL     SAEV2                              33
     C                   END
      *
      *** SAMSLÅING AV VARELINJER
     C     STSV          TAG
     C                   IF        SESAM = 'N'
     C     SAEV2K        READE     SAEV4                                  33
     C  N33              IF        XORI = 'J'
     C                   IF        SVNYL = 'J'
     C                   GOTO      STSV
     C                   END
     C                   ELSE
     C                   IF        SVNYL <> 'J'
     C                   GOTO      STSV
     C                   END
     C                   END
     C   33              IF        SETDN < 0 AND XORI = 'J'
     C                   EVAL      XORI = 'N'
     C     SAEV2K        SETLL     SAEV4
     C                   GOTO      STSV
     C                   END
     C  N33SVVKTB        IFEQ      0
     C     SVLN          ANDEQ     0
     C                   EXCEPT    SAEVD4
     C                   GOTO      STSV
     C                   ENDIF
     C                   ELSE
     C     SAEV2K        READE     SAEV2                                  33
     C  N33              IF        XORI = 'J'
     C                   IF        SVNYL = 'J'
     C                   GOTO      STSV
     C                   END
     C                   ELSE
     C                   IF        SVNYL <> 'J'
     C                   GOTO      STSV
     C                   END
     C                   END
     C                   END
      *** XBRUD2 <> BLANK ---> SISTE SAMSLÅENDE LINJE SKAL TIL ARB.FIL
     C   33              IF        SESAM = 'N'
     C     XVLN          IFNE      0
     C                   EXSR      REGN
     C                   END
     C                   ELSE
     C   33XBRUD2        IFNE      *BLANKS
     C                   EXSR      REGN
     C                   END
     C                   END
     C   33              IF        SETDN < 0 AND XORI = 'J'
     C                   EVAL      XORI = 'N'
     C                   MOVE      *BLANKS       XBRUD2
     C     SAEV2K        SETLL     SAEV2
     C                   GOTO      STSV
     C                   END
     C   33              GOTO      SLSV
     C                   IF        SVNYL <> 'S'
     C                   MOVE      'N'           XTOTSLT           1
     C                   END
      *
      *** XBRUD2 = BLANK ---> STARTE LINJETELLER MED 1 VED 1. RECORD
     C                   IF        SESAM = 'N'
     C     XVLN          IFEQ      0
     C                   EXSR      FLYTT
     C                   ELSE
     C     XVLN          IFNE      SVLN
     C                   EXSR      REGN
     C                   EXSR      FLYTT
     C                   END
     C                   END
     C                   MOVE      SVLN          XVLN
     C                   IF        SVLN = 0
     C                   Z-ADD     XNR           SVLN
     C                   END
     C                   EXCEPT    SAEVL4
     C                   ELSE
     C     XBRUD2        IFEQ      *BLANKS
     C                   EXSR      FLYTT
     C                   ELSE
     C                   MOVE      'N'           XUNR              1
     C     SVEH          IFEQ      'U.NR'
     C     SVEH          OREQ      'U-NR'
     C                   MOVE      'J'           XUNR
     C                   END
     C     XBRUD1        IFNE      XBRUD2
     C     XUNR          OREQ      'J'
      *** VED BRUDD OPPDATER VARELINJE PÅ ARBEIDSFIL (WFILEEXP)
     C                   EXSR      REGN
     C                   EXSR      FLYTT
     C                   END
     C                   END
      *
     C                   Z-ADD     XNR           SVLN
     C                   EXCEPT    SAEVLN
     C                   END
      *
     C                   MOVE      XBRUD1        XBRUD2
      *** TEST OM SKAL LEGGE INN MERKE & NR. PÅ DENNE VARELINJEN
     C  N49
     CAN 48SV01          COMP      'B'                                    49
      *
      *** HVIS MERKE & NR. (CONTAINERNR.) ER ULIK FRA DE FOREGÅENDE,
      *** LEGGER INN I TABELL (KN).  MAX = 7 LINJER
     C     SVFT          IFEQ      *BLANKS                                      1<-B
     C                   GOTO      STSV2B
     C                   END                                                    1<-E
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     6                                            1<-B
     C     KN(XN4)       IFEQ      SVFT                                          2<-B
     C                   GOTO      STSV2B
     C                   END                                                     2<-E
     C     KN(XN4)       IFEQ      *BLANKS                                       2<-B
     C                   GOTO      STSV2A
     C                   END                                                     2<-E
     C                   ADD       1             XN4
     C                   END                                                    1<-E
     C     STSV2A        TAG
     C     XN2           IFLT      XN4                                          1<-B
     C                   Z-ADD     XN4           XN2
     C                   END                                                    1<-E
     C                   EVAL      KN(XN4) = SVFT
      *
      *** HVIS VARESLAG ER ULIK FRA DE FOREGÅENDE,
      *** LEGGER INN I TABELL (VB).  MAX = 7 LINJER
     C     STSV2B        TAG
     C     SVVT          IFEQ      *BLANKS                                      1<-B
     C                   GOTO      STSV2
     C                   END                                                    1<-E
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     6                                            1<-B
     C     VB(XN4)       IFEQ      SVVT                                          2<-B
     C                   GOTO      STSV2
     C                   END                                                     2<-E
     C     VB(XN4)       IFEQ      *BLANKS                                       2<-B
     C                   GOTO      STSV2C
     C                   END                                                     2<-E
     C                   ADD       1             XN4
     C                   END                                                    1<-E
     C     STSV2C        TAG
     C     XN2           IFLT      XN4                                          1<-B
     C                   Z-ADD     XN4           XN2
     C                   END                                                    1<-E
     C                   MOVE      SVVT          VB(XN4)
      *
      *** ENHETS KODE LEGGES I WFEVT
     C     STSV2         TAG
     C     WFEVT         IFEQ      *BLANKS                                      1<-B
     C                   MOVE      SVEH          WFEVT
     C                   END                                                    1<-E
      *
      *** SUMMERE ANTALL ENHETER
     C                   ADD       SVNT          WFEANT
      *
      *** HVIS TILLEGGSOPPLYSNING ER ULIK FRA DE FOREGÅENDE,
      *** LEGGER INN I TABELL (TO).  MAX = 10 LINJER
     C     XN3           IFLE      10                                           1<-B
     C     SVTOPL        ANDNE     *BLANKS
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     9                                             2<-B
     C     TO(XN4)       IFEQ      SVTOPL                                         3<-B
     C                   GOTO      STSV3
     C                   END                                                      3<-E
     C                   ADD       1             XN4
     C                   END                                                     2<-E
     C                   MOVE      SVTOPL        TO(XN3)
     C                   MOVE      SVCREF        TC(XN3)
     C                   ADD       1             XN3
     C                   END                                                    1<-E
      *
     C     STSV3         TAG
      *** SUMMERE NETTO/BRUTTO VEKT
     C                   ADD       SVVKTB        WFEVKB123
     C                   ADD       SVVKTN        WFEVKN123
     C                   ADD       SVNTM         WFENTM
      *
     C                   GOTO      STSV
      *
     C     SLSV          ENDSR
      ***********************************************
     C     PRINT2        BEGSR
      ***********************************************
      *** SKRIVE TOLLDEK. PÅ DATALISTE
     C                   MOVE      *ZEROS        XN2
     C                   MOVE      *ZEROS        XN3
     C                   Z-ADD     1             XLN
     C                   SETOFF                                       33
      *
     C     SAEHK         SETLL     WFILEEXP
     C     SAEHK         READE     WFILEEXP                               33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             TVLI
     C                   MOVE      SVVNT         TVVNT
     C                   Z-ADD     SVVKTB        TVVKTB
     C                   Z-ADD     SVVKTN        TVVKTN
     C                   Z-ADD     SVNTM         TVNTEH
     C                   MOVEL     SVFT          TVMN
     C                   MOVE      SVNT          TVNT
     C                   MOVEL     SVEH          TVEH
     C                   MOVEL     SVVT          TVVT
     C                   EVAL      TVDTY = '830'
     C                   EVAL      TVDREF = %TRIM(SETLE) + ' ' + %TRIM(SETLL)
     C                   IF        ((TVLI = 1) AND (XFORHV = 'J'))                  5<-B
     C                   IF        (((THSPOM = 'A') OR                               6<-B
     C                               (THSPOM = 'C')) OR
     C                               (THKREF = *BLANKS))
     C                   WRITE     TRUVDKR
     C                   EVAL      TVDTY = '720'
     C                   EVAL      TVDREF = *BLANKS
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   EXSR      HADR12
     C                   WRITE     TRUVR
     C                   DELETE    WFILEER
     C     SAEHK         READE     WFILEEXP                               33
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     FLYTT         BEGSR
      ***********************************************
      *** FLYTTE HOVEDOPPLYSNINGER FRA HOVEDLINJE TIL ARBEIDSVARIABLER
      *** OG BLANKE DE ANDRE ARBEIDSVARIABLENE.
     C                   MOVE      SVAVD         WFEAVD
     C                   MOVE      SVTDN         WFETDN
     C                   MOVE      SVNYL         WFENYL
     C                   ADD       1             XNR
     C                   Z-ADD     1             XN2
     C                   Z-ADD     1             XN3
      *
     C                   MOVE      SVAVT         XAVT              1
     C                   MOVE      SVAVTS        WFEATS
     C                   MOVE      SVAVTP        WFEATP
     C                   MOVE      SVVNT         WFEVNT
     C                   MOVE      SVFYL         WFEFYL
     C                   MOVE      *ZEROS        WFEBL
     C                   MOVE      *BLANKS       KN
     C                   MOVE      *ZEROS        WFEANT
     C                   MOVE      *BLANKS       WFEVT
     C                   MOVE      *BLANKS       VB
     C                   MOVE      *BLANKS       TO
     C                   MOVE      *BLANKS       TC
     C                   MOVE      *ZEROS        WFEJUS
      *
     C                   MOVE      *ZEROS        WFESTB
     C                   MOVE      *ZEROS        XESTB
     C                   MOVE      *ZEROS        WFESUM
     C                   MOVE      *ZEROS        WFEVKB123
     C                   MOVE      *ZEROS        WFEVKN123
     C                   MOVE      *ZEROS        WFENTM
      *
     C                   ENDSR
      ***********************************************
     C     REGN          BEGSR
      ***********************************************
     C                   IF        WFEVKB123 < 0.5
     C                   Z-ADD     1             WFEVKB
     C                   ELSE
     C                   ADD       0,5           WFEVKB123
     C                   END
     C                   IF        WFEVKN123 < 0.5
     C                   Z-ADD     1             WFEVKN
     C                   ELSE
     C                   ADD       0,5           WFEVKN123
     C                   END
      *
      *** BEREGNE STATISTISK VERDI
     C     XESTB         IFNE      0
     C     KVAOMR        IFEQ      0
     C                   Z-ADD(H)  XESTB         WFESTB
     C                   ELSE
     C     XESTB         DIV       KVAOMR        XWORK
     C     XWORK         MULT(H)   SEVKU         WFESTB
     C                   END
     C                   IF        WFESTB = 0
     C                   EVAL      WFESTB = 1
     C                   END
     C                   END
      *
      *** 40 PÅ ---> FORDELE ANDRE KOSTNAD ETTER VEKT OG LEGGE DET INN
      ***            JUSTERING OG SUMMERE DET MED STATISTISK VERDI
     C     SEVKB         IFEQ      0
     C   40              Z-ADD     0             XWORK
     C                   ELSE
     C   40WFEVKB        DIV(H)    SEVKB         XWORK
     C                   ENDIF
     C   40XWORK         MULT(H)   SEBEL3        WFEJUS
     C   40
     CAN 96WFESTB        SUB       WFEJUS        WFESTB
     C   40
     CANN96WFESTB        ADD       WFEJUS        WFESTB
      *
      *** BEREGNE AVGIFT FOR TORSKFISKEREDERIENE
     C     XAVT          IFEQ      'X'
     C                   MOVE      ' '           AGPP
     C     WFESTB        MULT      WFEATP        XWORK
     C     AVGEK         SETLL     SADAVGE
     C     AVGEK         READE     SADAVGE                                31
     C     *IN31         DOWEQ     '0'
     C     AGDTF         IFLE      XEDT
     C     AGDTT         ANDGT     XEDT
     C                   LEAVE
     C                   END
     C     AVGEK         READE     SADAVGE                                31
     C  N31              ENDDO
     C     AGPP          IFEQ      '%'
     C     XWORK         DIV(H)    100           WFEBL
     C                   ELSE
     C     XWORK         DIV(H)    1000          WFEBL
     C                   END
     C                   END
      *
     C     SLREGN        TAG
      *** 49 PÅ -> LEGGE MERKE & NR. FRA B/L TIL DENNE VARELINJEN
     C   49
     CAN 48              EXSR      UTBL
     C                   SETOFF                                       49
      *
     C                   MOVE      XNR           WFERNR
      * SUMMERE TOTAL KOLLI
     C                   ADD       WFEANT        XTOTKL
      *** SKRIVE SAMSLÅENDE LINJER TIL ARBEIDSFIL
     C     WFKEY         CHAIN     WFILEEXP                           97
     C   97              WRITE     WFILEER
     C                   ADD       WFEVKB        XTVKTBEMMA
      *
      *** SUMMERE FORSKJELLIGE AVGIFTER
     C                   ADD       WFEBL         XTOTT
      *** SUMMERE BRUTTOVEKT
     C                   ADD       WFEVKB        XTVKTB
     C                   SETOFF                                       97
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UTDN              7
     C                   PARM                    UAVD2             4
     C                   PARM                    UTDN2             7
      *
     C     SAEHK         KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   MOVE      UAVD2         SVAVD
     C                   MOVE      UTDN2         SVTDN
      *
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
     C                   MOVE      UAVD2         TVAVD2
     C                   MOVE      UTDN2         TVTDN2
     C     SAEHK         CHAIN     SAEH                               33
      *
     C                   ENDSR
