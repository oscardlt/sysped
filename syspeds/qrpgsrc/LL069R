     FLLHEAD    IF A E           K DISK
     FLLLINE    IF A E           K DISK
     FLLHETXT   IF A E           K DISK
     FLLTELL    UF A E             DISK
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  LHFLN                  1     17
     D  LHFLN1                 1     10
     D  LHFLN2                11     15    DIM(5)
      *
     C                   EXSR      INIT
     C                   EXSR      HOVED
     C                   MOVE      '1'           *INLR
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
      *
     C     *ENTRY        PLIST
     C                   PARM                    UMN               7 0
      *
     C     LLHETXTK      KLIST
     C                   KFLD                    LLMN
     C                   KFLD                    LLVN
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     HOVED         BEGSR
      *////////////////////////////////////////////////////////////
     C                   EXSR      CHKREST
     C                   IF        XREST = 'J'
     C                   EXSR      OPDHEAD
     C                   EXSR      OPDLIN
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CHKREST       BEGSR
      *////////////////////////////////////////////////////////////
      *
     C                   MOVE      'N'           XREST             1
     C     UMN           SETLL     LLLINE
     C     UMN           READE     LLLINE                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        LLWNT0 < LLANT0
     C                   MOVE      'J'           XREST
     C                   LEAVE
     C                   END
     C     UMN           READE     LLLINE                                 33
     C                   ENDDO
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     OPDHEAD       BEGSR
      *////////////////////////////////////////////////////////////
      *
     C     1             CHAIN     LLTELL                             33                    1
     C                   IF        *IN33
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   ELSE
     C                   ADD       1             LLREC1
     C                   UPDATE    LLTELLR
     C                   END
     C     UMN           CHAIN     LLHEAD                             33
     C                   MOVE      LLREC1        LHMN
     C                   MOVE      'M'           LHOPR
     C                   MOVE      ' '           LHSTA
     C                   MOVE      ' '           LHST1
     C                   MOVE      ' '           LHST2
     C                   MOVE      ' '           LHST3
     C                   MOVE      WDT           LHTDT
      *
     C                   MOVE      *ZEROS        XRONR             5 0
     C                   IF        LHFLN1 = 'RESTORDRE:'
     C     1             DO        5             XN                5 0
     C                   IF        LHFLN2(XN) >= '0' AND LHFLN2(XN) <= '0'
     C                   MULT      10            XRONR
     C                   MOVE      LHFLN2(XN)    XRONR
     C                   END
     C                   ENDDO
     C                   END
     C                   ADD       1             XRONR
     C                   EVAL      LHFLN='RESTORDRE: '+%TRIM(%EDITC(XRONR:'Z'))
      *
     C                   MOVE      *ZEROS        LHALN
     C                   MOVE      *ZEROS        LHALG
     C                   MOVE      *ZEROS        LHAVD
     C                   MOVE      *ZEROS        LHOPD
     C                   MOVE      *ZEROS        LHFBN
     C                   MOVE      *ZEROS        LHANT0
     C                   MOVE      *ZEROS        LHANTL
     C                   MOVE      *ZEROS        LHANT1
     C                   MOVE      *BLANKS       LHAEH1
     C                   MOVE      *ZEROS        LHANT2
     C                   MOVE      *BLANKS       LHAEH2
     C                   MOVE      *ZEROS        LHANT3
     C                   MOVE      *BLANKS       LHAEH3
     C                   MOVE      *ZEROS        LHVEK
     C                   MOVE      *ZEROS        LHWVEK
     C                   MOVE      *ZEROS        LHKUB
     C                   MOVE      *ZEROS        LHWKUB
     C                   MOVE      *ZEROS        LHKLL
     C                   MOVE      *ZEROS        LHMLP
     C                   MOVE      *ZEROS        LHBPAL
     C                   MOVE      *ZEROS        LHAPAL
     C                   MOVE      *ZEROS        LHMDT
     C                   MOVE      *ZEROS        LHODT
     C                   MOVE      *ZEROS        LHPTDF
     C                   MOVE      *ZEROS        LHPTDT
     C                   MOVE      *BLANKS       LHPSG
     C                   MOVE      *ZEROS        LHRDT
     C                   MOVE      *ZEROS        LHRTD
     C                   MOVE      ZUSER         LHUSR
      *
     C                   WRITE     LLHEADR
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     OPDLIN        BEGSR
      *////////////////////////////////////////////////////////////
      *
     C                   MOVE      *ZEROS        XLIN              3 0
     C     UMN           SETLL     LLLINE
     C     UMN           READE     LLLINE                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        LLWNT0 < LLANT0
     C                   ADD       1             XLIN
      *
     C                   IF        *IN33 = *OFF
     C     LLHETXTK      CHAIN     LLHETXT                            33
     C                   MOVE      LHMN          LTMN
     C                   MOVE      XLIN          LTMN
     C                   WRITE     LLHTXTR
     C                   END
      *
     C                   MOVE      LHMN          LLMN
     C                   MOVE      XLIN          LLVN
     C                   MOVE      *ZEROS        LLPRI
     C                   MOVE      *BLANKS       LLSER
     C                   MOVE      *BLANKS       LLALLO
     C                   EVAL      LLANT0 = LLANT0 - LLWNT0
     C                   MOVE      *ZEROS        LLWNT0
     C                   MOVE      *ZEROS        LLANTL
     C                   MOVE      *ZEROS        LLWNTL
     C                   MOVE      *ZEROS        LLANT1
     C                   MOVE      *ZEROS        LLWNT1
     C                   MOVE      *BLANKS       LLAEH1
     C                   MOVE      *ZEROS        LLAEF1
     C                   MOVE      *ZEROS        LLANT2
     C                   MOVE      *ZEROS        LLWNT2
     C                   MOVE      *BLANKS       LLAEH2
     C                   MOVE      *ZEROS        LLAEF2
     C                   MOVE      *ZEROS        LLANT3
     C                   MOVE      *ZEROS        LLWNT3
     C                   MOVE      *BLANKS       LLAEH3
     C                   MOVE      *ZEROS        LLAEF3
     C                   MOVE      *ZEROS        LLVEK
     C                   MOVE      *ZEROS        LLWVEK
     C                   MOVE      *ZEROS        LLKUB
     C                   MOVE      *ZEROS        LLWKUB
     C                   MOVE      *BLANKS       LLLOK
     C                   MOVE      *ZEROS        LLNTLK
     C                   MOVE      'RESTO'       LLMKD
     C                   MOVE      *BLANKS       LLMTXT
     C                   MOVE      *ZEROS        LLPRDT
     C                   WRITE     LLLINER
     C                   END
     C     UMN           READE     LLLINE                                 33
     C                   ENDDO
      *
     C                   ENDSR
      *
