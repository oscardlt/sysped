             PGM
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BPARM) TYPE(*CHAR) LEN(442)
             DCL        VAR(&BPARM2) TYPE(*CHAR) LEN(513)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&JOBN) TYPE(*CHAR) LEN(6)
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
             DCL        VAR(&TX) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&PRTNAV) TYPE(*CHAR) LEN(10) +
                          VALUE('SYEF30P ')
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('T')
             DCL        VAR(&FAXNR) TYPE(*CHAR) LEN(21)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4) VALUE('0000')
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7) VALUE('0000000')
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8) VALUE('00000000')
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNAVN) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNA12) TYPE(*CHAR) LEN(12)
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) /* Hvis &in01 +
                          på, betyr det avslutt program fra +
                          avdelingsvalg. */
             DCL        VAR(&IN07) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in07 på, betyr uten oppdatering. */
             DCL        VAR(&IN08) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in08 på, betyr prøve manifest. */
             DCL        VAR(&FAKT) TYPE(*CHAR) LEN(1) /* Hvis &FAKT +
                          på, betyr at det skal kjøre faktura */
             DCL        VAR(&JBK) TYPE(*CHAR) LEN(1) /* Jobbkø. */
             DCLF       FILE(FAXSEN)
             RCVF       RCDFMT(*FILE)
                                                          /**/
             CALL       PGM(SYFA00) PARM(&IN01)
             IF         COND(&IN01 = '1') THEN(GOTO CMDLBL(SLUTT)) /* +
                          Hvis &IN01 på, avslutter program. */
                                                          /**/
             CALL       PGM(FAX3FR) PARM(&JBK &IN01 &IN07 &IN08 &FAKT +
                          &FAXNR &AVD &TUR &NAVN &PDATE &PTIME &TX +
                          &DOKNAVN &CVP1 &CVP2 &CVP3 &CVP4 &CVP5 +
                          &CVP6 &CVP7 &CVP8 &CVP &EPOST &EPOSTJ)
             IF         COND(&IN01 = '1') THEN(GOTO CMDLBL(SLUTT)) /* +
                          Hvis &IN01 på, avslutter program. */
                                                          /**/
             RTVJOBA    USER(&MAPPE)
             CHGVAR     VAR(&DOKNA12) VALUE(&PRTNAV)
    /* */
/*                         */
/*  EPOST                  */
/*                         */
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             CHGVAR     VAR(&BPARM2) VALUE(&PRANT *CAT &FAXNR *CAT +
                          &DOKNA12 *CAT &MAPPE *CAT &PTIME *CAT +
                          &PDATE *CAT &NAVN *CAT &AVD *CAT &OPD +
                          *CAT &TUR *CAT &KODE *CAT &CVP1 *CAT +
                          &CVP2 *CAT &CVP3 *CAT &CVP4 *CAT &CVP5 +
                          *CAT &CVP6 *CAT &CVP7 *CAT &CVP8 *CAT &CVP +
                          *CAT &EPOST *CAT &EPOSTJ)
             SBMJOB     CMD(CALL PGM(FAX030CLBE) PARM(&IN07 &IN08 +
                          &BPARM2)) JOB(SNDEMAIL) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
                          RETURN
                          ENDDO
    /*                     */
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*                         */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             CHGVAR     VAR(&BPARM) VALUE(&PRANT *CAT &FAXNR *CAT +
                          &DOKNA12 *CAT &MAPPE *CAT &PTIME *CAT +
                          &PDATE *CAT &NAVN *CAT &AVD *CAT &OPD +
                          *CAT &TUR *CAT &KODE *CAT &CVP1 *CAT +
                          &CVP2 *CAT &CVP3 *CAT &CVP4 *CAT &CVP5 +
                          *CAT &CVP6 *CAT &CVP7 *CAT &CVP8 *CAT &CVP)
    /*                     */
             SBMJOB     CMD(CALL PGM(FAX030CLB) PARM(&IN07 &IN08 +
                          &BPARM)) JOB(SNDFAXB) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             SBMJOB     CMD(CALL PGM(FAX030CLB2) PARM(&IN07 &IN08 +
                          &PRANT &FAXNR &DOKNA12 &MAPPE &PTIME +
                          &PDATE &NAVN &AVD &OPD &TUR &KODE)) +
                          JOB(SNDFAXB) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
    /* */
    /* */
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             CHGVAR     VAR(&BPARM) VALUE(&PRANT *CAT &FAXNR *CAT +
                          &DOKNA12 *CAT &MAPPE *CAT &PTIME *CAT +
                          &PDATE *CAT &NAVN *CAT &AVD *CAT &OPD +
                          *CAT &TUR *CAT &KODE *CAT &CVP1 *CAT +
                          &CVP2 *CAT &CVP3 *CAT &CVP4 *CAT &CVP5 +
                          *CAT &CVP6 *CAT &CVP7 *CAT &CVP8 *CAT &CVP)
    /*                     */
             SBMJOB     CMD(CALL PGM(FAX030CLBB) PARM(&IN07 &IN08 +
                          &BPARM)) JOB(SNDFAXB) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
                                                          /**/
SLUTT:       ENDPGM
