      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT LASTELISTE FOR SJØ-TRANSPORT ***
      ***********************************************************
     FSAD025FB  CF   E             WORKSTN
     FKODTFM    IF   E           K DISK
     FBLJOINLF  IF   E           K DISK
     FBILLOF    IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOFPR)
     FHEADF     IF   E           K DISK
     FBLV1LF    IF   E           K DISK
     F                                     RENAME(BLV1R:BLV1R1)
     FBLV2LF    IF   E           K DISK
     F                                     RENAME(BLV2R:BLV2R1)
     FKODTSI    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FSTED2     IF   E           K DISK
     FKODTP     IF   E           K DISK
     FSAD025PB  O    E             PRINTER USROPN
     D MN              S             17    DIM(99)
     D VB              S             25    DIM(99)
     D UCMD            DS          1024
     D                 DS
     D XCMD1           C                   CONST('OVRPRTF -
     D                                     FILE(SAD025PB) -
     D                                     OUTQ(')
     D XCMD2           C                   CONST('PAGESIZE(72 130) -
     D                                     CPI(15) -
     D                                     OVRFLW(72) -
     D                                     FORMTYPE(LASTELISTE)')
     D                 DS
     D  FN                     1     35  0 DIM(5)
     D  XOPDF                  1      7  0
     D  XOPDF2                 8     14  0
     D  XOPDF3                15     21  0
     D  XOPDF4                22     28  0
     D  XOPDF5                29     35  0
     D                 DS
     D  TN                     1     35  0 DIM(5)
     D  XOPDT                  1      7  0
     D  XOPDT2                 8     14  0
     D  XOPDT3                15     21  0
     D  XOPDT4                22     28  0
     D  XOPDT5                29     35  0
     D                 DS
     D  AV                     1     20  0
     D                                     DIM(5)
     D  WSAVD1                 1      4  0
     D  WSAVD2                 5      8  0
     D  WSAVD3                 9     12  0
     D  WSAVD4                13     16  0
     D  WSAVD5                17     20  0
     D                 DS
     D  OP                     1     35  0 DIM(5)
     D  WSTDN1                 1      7  0
     D  WSTDN2                 8     14  0
     D  WSTDN3                15     21  0
     D  WSTDN4                22     28  0
     D  WSTDN5                29     35  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '000000'      *IN(94)
     C                   MOVEA     '00000'       *IN(89)
     C                   SETOFF                                       80
     C   03              GOTO      SLUTT
      *
     C     KODSIK        CHAIN     KODTSI                             99
     C   99              GOTO      START
      *
     C                   MOVE      *ZEROS        FN
     C                   MOVE      *ZEROS        TN
      *
     C     WSAVD1        IFNE      0
     C                   MOVE      WSAVD1        YAVD
     C     KODTAK        CHAIN     KODTA                              98
     C   98              GOTO      START
     C     WSTDN1        COMP      0                                    9797
     C   97              GOTO      START
     C                   Z-ADD     1             XNR
     C                   EXSR      FINNR
     C                   END
      *
     C     WSAVD2        IFNE      0
     C                   MOVE      WSAVD2        YAVD
     C     KODTAK        CHAIN     KODTA                              96
     C   96              GOTO      START
     C     WSTDN2        COMP      0                                    9595
     C   95              GOTO      START
     C                   Z-ADD     2             XNR
     C                   EXSR      FINNR
     C                   END
      *
     C     WSAVD3        IFNE      0
     C                   MOVE      WSAVD3        YAVD
     C     KODTAK        CHAIN     KODTA                              94
     C   94              GOTO      START
     C     WSTDN3        COMP      0                                    9393
     C   93              GOTO      START
     C                   Z-ADD     3             XNR
     C                   EXSR      FINNR
     C                   END
      *
     C     WSAVD4        IFNE      0
     C                   MOVE      WSAVD4        YAVD
     C     KODTAK        CHAIN     KODTA                              92
     C   92              GOTO      START
     C     WSTDN4        COMP      0                                    9191
     C   91              GOTO      START
     C                   Z-ADD     4             XNR
     C                   EXSR      FINNR
     C                   END
      *
     C     WSAVD5        IFNE      0
     C                   MOVE      WSAVD5        YAVD
     C     KODTAK        CHAIN     KODTA                              90
     C   90              GOTO      START
     C     WSTDN5        COMP      0                                    8989
     C   89              GOTO      START
     C                   Z-ADD     5             XNR
     C                   EXSR      FINNR
     C                   END
      *
     C     FN(1)         COMP      0                                  7171
     C     FN(2)         COMP      0                                  7272
     C     FN(3)         COMP      0                                  7373
     C     FN(4)         COMP      0                                  7474
     C     FN(5)         COMP      0                                  7575
      *
     C                   Z-ADD     1             XNR               2 0
     C                   Z-ADD     0             XLNR              4 0
     C                   Z-ADD     0             XANTLI            2 0
     C                   Z-ADD     0             XTOTNT            7 0
     C                   Z-ADD     0             XTOTVK           12 0
     C                   Z-ADD     0             XTOTM3           10 3
     C                   Z-ADD     1             XSIDE             3 0
     C                   MOVE      *ZEROS        XLI
      *
     C     XNR           DOWLE     5
     C     AV(XNR)       IFNE      0
     C                   SETOFF                                       60
     C                   EXSR      HOVED
     C                   ADD       1             XNR
     C                   ELSE
     C                   ADD       5             XNR
     C                   END
     C                   END
      *
     C   80              WRITE     TOTLIN
     C   80              WRITE     BUNN
     C                   GOTO      START
      *
      * AVSLUTTER PROGRAMMET   KOMMER HIT KUN VED F3
     C     SLUTT         TAG
     C                   CLOSE     SAD025PB
     C                   SETON                                        LR
     C                   RETURN
      *
     C******************************************
     C     HOVED         BEGSR
     C******************************************
     C                   MOVE      AV(XNR)       YAVD
     C                   MOVE      OP(XNR)       YOPD
     C     BLJOIK        SETLL     BILLOFR
     C     STHOV         TAG
     C     WSCNR         READE     BILLOFR                                60
     C  N60BLAVD         COMP      YAVD                               6060
     C  N60BILLK         CHAIN     BILLOF                             60
     C   60              GOTO      SLHOV
      *
     C     BLLSS         CHAIN     STED2                              61
     C   61              MOVE      *BLANKS       ST2LK
     C     HEADFK        CHAIN     HEADF                              61
     C   61              MOVE      *BLANKS       HENAK
      *
     C     BLV1K         SETLL     BLV1LF
     C                   SETOFF                                       61
     C                   ADD       1             XLNR
     C                   Z-ADD     0             X1                2 0
     C                   Z-ADD     0             X2                2 0
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       VB
     C                   MOVE      *ZEROS        XNT               7 0
     C                   MOVE      *ZEROS        XVKT              9 0
     C                   MOVE      *ZEROS        XM3               9 3
     C     STHOV2        TAG
     C     BLV1K         READE     BLV1LF                                 61
     C  N61              DO
     C     BVMN          IFNE      *BLANKS
     C                   ADD       1             X1
     C                   MOVE      BVMN          MN(X1)
     C                   END
     C     BVVS          IFNE      *BLANKS
     C                   ADD       1             X2
     C                   MOVE      BVVS          VB(X2)
     C                   END
     C                   ADD       BVNT          XNT
     C                   ADD       BVVKT         XVKT
     C                   ADD       BVM3          XM3
     C                   END
     C  N61              GOTO      STHOV2
      *
     C     BLV2K         SETLL     BLV2LF
     C                   SETOFF                                       61
     C     STHOV3        TAG
     C     BLV2K         READE     BLV2LF                                 61
     C  N61BVMN          IFNE      *BLANKS
     C                   ADD       1             X1
     C                   MOVE      BVMN          MN(X1)
     C                   END
     C  N61              GOTO      STHOV3
      *
     C     X2            IFGT      X1
     C                   Z-ADD     X2            X1
     C                   END
     C     X1            IFEQ      1
     C                   ADD       1             X1
     C                   END
      *
     C  N80              WRITE     HEADER
     C  N80              SETON                                        80
      *
     C     X1            IFLE      40
     C     XANTLI        ADD       X1            XX                2 0
     C     XX            IFGE      41
     C                   Z-ADD     41            XANTLI
     C                   END
     C                   END
      *
      *** -----  SKRIV UT ANTALL, VEKT, KUBIKK OG MERKERNR, VAREBESKRIVELSE
      *
     C     XANTLI        IFGE      41
     C                   WRITE     BUNN
     C                   Z-ADD     0             XANTLI
     C                   ADD       1             XSIDE
     C                   WRITE     HEADER
     C                   END
     C                   ADD       XNT           XTOTNT
     C                   ADD       XVKT          XTOTVK
     C                   ADD       XM3           XTOTM3
     C                   ADD       1             XANTLI
     C                   MOVE      MN(1)         BVMN
     C                   MOVE      VB(1)         BVVS
     C                   ADD       1             XLI
     C                   WRITE     DETALJ1
     C                   SETOFF                                       76
     C                   MOVE      *BLANKS       XTXT1
     C     XANTLI        IFGE      41
     C                   WRITE     BUNN
     C                   Z-ADD     0             XANTLI
     C                   ADD       1             XSIDE
     C                   WRITE     HEADER
     C                   END
     C                   ADD       1             XANTLI
     C                   MOVE      MN(2)         BVMN
      *                    MOVE VB,2      BVVS
     C                   MOVE      *BLANKS       XTXT2
     C     VB(2)         IFEQ      *BLANKS
     C                   SETON                                        76
     C                   MOVE      'MOTT:'       XTXT1
     C                   MOVE      HENAK         XTXT2
     C                   ELSE
     C                   MOVEL     VB(2)         XTXT2
     C                   END
     C                   WRITE     DETALJ2
     C                   MOVE      *BLANKS       XTXT1
      *
      *** ------ SKRIV UT MERKERNR OG VAREBESKRIVELSE
      *
     C                   Z-ADD     3             X2
     C     X2            DOWLE     X1
     C     XANTLI        IFGE      41
     C                   WRITE     BUNN
     C                   Z-ADD     0             XANTLI
     C                   ADD       1             XSIDE
     C                   WRITE     HEADER
     C                   END
     C                   ADD       1             XANTLI
     C                   MOVE      MN(X2)        BVMN
      *                    MOVE VB,X2     BVVS
     C                   MOVE      *BLANKS       XTXT2
     C   76              MOVEL     VB(X2)        XTXT2
     C  N76VB(X2)        IFEQ      *BLANKS
     C                   SETON                                        76
     C                   MOVE      'MOTT:'       XTXT1
     C                   MOVE      HENAK         XTXT2
     C                   ELSE
     C                   MOVE      VB(X2)        XTXT2
     C                   END
     C                   WRITE     DETALJ3
     C                   MOVE      *BLANKS       XTXT1
     C                   ADD       1             X2
     C                   END
     C  N76              ADD       1             XANTLI
     C  N76              MOVE      'MOTT:'       XTXT1
     C  N76              WRITE     DETALJ4
      *
     C     XANTLI        IFLT      41
     C                   ADD       1             XANTLI
     C                   WRITE     TOMLIN
     C                   END
      *
     C                   GOTO      STHOV
      *
     C     SLHOV         ENDSR
      *
     C******************************************
     C     FINNR         BEGSR
     C******************************************
     C                   MOVE      AV(XNR)       YAVD
     C                   MOVE      OP(XNR)       YOPD
     C     BLJOIK        SETLL     BILLOFR
     C                   SETOFF                                       60
     C     WSCNR         READE     BILLOFR                                60
     C  N60BLAVD         COMP      YAVD                               6060
     C  N60              DO
     C                   Z-ADD     BLOPD         FN(XNR)
     C                   MOVE      '9999999'     YOPD
     C     BLJOIK        SETLL     BILLOFR
     C     WSCNR         READPE    BILLOFR                                60
     C  N60BLAVD         COMP      YAVD                               6060
     C  N60              Z-ADD     BLOPD         TN(XNR)
     C                   END
      *
     C                   ENDSR
      *
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     BLJOIK        KLIST
     C                   KFLD                    WSCNR
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     BILLK         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     BLV1K         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     BLV2K         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     HEADFK        KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    YAVD
     C     KODSIK        KLIST
     C                   KFLD                    YSIUNI
     C                   KFLD                    WSSG
     C     KODKEY        KLIST
     C                   KFLD                    WOPUNI
     C                   KFLD                    WOPAVD
     C                   KFLD                    WOPLNR
     C     *LIKE         DEFINE    KOPAVD        WOPAVD
     C     *LIKE         DEFINE    KOPUNI        WOPUNI
     C     *LIKE         DEFINE    KOPLNR        WOPLNR
     C                   Z-ADD     0             WOPAVD
     C                   MOVE      'P'           WOPUNI
     C                   Z-ADD     0             WOPLNR
      *
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'SI'          YSIUNI            2
     C                   MOVE      *ZEROS        YAVD              4 0
     C                   MOVE      *ZEROS        YOPD              7 0
     C                   MOVE      *ZEROS        AV
     C                   MOVE      *ZEROS        OP
      *
     C                   Z-ADD     UAVD          WOPAVD
     C                   Z-ADD     95            WOPLNR
     C     KODKEY        CHAIN     KODTP                              33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ENDIF
     C     XCMD1         CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD2:1       UCMD
     C                   Z-ADD     1024          UCMDL            15 5
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   OPEN      SAD025PB
     C*
      * HENT STRINGKODE
     C                   Z-ADD     95            WTSKRN            3 0
     C                   MOVE      UAVD          LOSAV2            4 0
     C                   CALL      'SYGE01'
     C                   PARM                    LOSAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C     WOPFM         IFNE      *BLANKS
     C     WOPFM         CHAIN     KODTFM                             33
     C                   END
      *
     C                   ENDSR
      *
