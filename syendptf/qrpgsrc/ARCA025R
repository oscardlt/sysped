**********************************************************************************************
      * KOBLE TIL OPPDRAG VIA FRI SØKEVEI(FILNAVN) FRA MAPPE FRISOK
**********************************************************************************************
      *       og denne bør gjerne peke på "eksternt" arkivlager med
      *       avvikende bane (f.eks /pdf/scan ) (fil ARKEXT)
**********************************************************************************************
      *
     H DFTACTGRP(*NO)
      *""""""""""""""""
      *""""""""""""""""
     D DirName         S            100A
     D EntryName       S            120A
     D EntryPath       S            256A
      *________________
      * Andre variabler
      *""""""""""""""""
     D TYPE            S              2
     D NEWFILE         S            200
     D NEWOBJ          S            200
     D UPC             C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')

     C                   EXSR      INIT
     C                   EXSR      MOV
     C                   EVAL      *inlr = *on
     C                   RETURN
      *
      ****************************************************************
     C     INIT          BEGSR
      ****************************************************************
      *
      *
     C     *entry        PLIST
     C                   PARM                    DirName
     C                   PARM                    EntryName
     C                   PARM                    EntryPath
      *
      *
     C                   ENDSR
      *
      ***********************************************************************
     C     MOV           BEGSR
      ***********************************************************************
      *
      * Hent slutt på filnavn (ex. .pdf) fra frafil
     c                   eval      par512=EntryName
     c                   call      'SYGE112'
     c                   parm                    par512          512
     c                   parm                    NEWEND           10
      *
     c                   move      'N'           Oppd              1
     c                   move      *zeros        AVD               4 0
     c                   move      *zeros        OPD               7 0
     c                   move      *zeros        TUR               8 0
     c                   move      *zeros        AVD_A             4
     c                   move      *zeros        OPD_A             7
     c                   move      *zeros        TUR_a             8
      *     ....+... 1 ..     ....+... 1 ...+..
      * eks ZH35-1234.pdf --> ZH00350001234.pdf
      * Hvis - (Bindestrek) så er det avd+oppdrag
N12  C     '-'           SCAN      EntryName     X                 3 0
N12  C     '.'           SCAN      EntryName     Y                 3 0
      * Avd/oppd...
     c                   If        X>3 and X<=7
     c                   move      'J'           Oppd              1
     C                   monitor
     C                   eval      AVD = %int(%subst(EntryName:3:X-3))
     C                   on-Error
     C                   goto      UtMov
     C                   endmon
     C                   monitor
     C                   eval      OPD = %int(%subst(EntryName:X+1:Y-1-X))      etter -..
     C                   on-Error
     C                   goto      UtMov
     C                   endmon
     c                   else
      * Tur     ...
     C                   monitor
     C                   eval      TUR = %int(%subst(EntryName:3:Y-3))          etter type..
     C                   on-Error
     C                   goto      UtMov
     C                   endmon
     c                   endif
      *
      * Kommet hit så er det OK.  Enten Avd-oppdrag eller tur
      * Uppifi type i fall de har skrevet små bokstaver
     C                   EVAL      TYPE = %subst(EntryName:1:2)
     C     LO:UPC        XLATE     TYPE          TYPE
      * Finn X = der hvor nytt mappenavn skal inn...
N12  C     '/OPPTUR_FIX' SCAN      DirName       X                 3 0
      *   AVD OPPD
     c                   if        Oppd='J'
     c                   move      AVD           AVD_A
     c                   move      OPD           OPD_A
     C                   EVAL      NEWFILE = TYPE + AVD_A + OPD_A + NEWEND
      * TIL-objekt m.rett mappe
     C                   EVAL      NEWOBJ = %subst(DirName:1:X)
     C                             +'OPPDRAG/'+ %trimr(NEWFILE)
     c                   else
      *   TUR
     c                   move      TUR           TUR_a
     C                   EVAL      NEWFILE = TYPE + TUR_A + NEWEND
      * TIL-objekt m.rett mappe
     C                   EVAL      NEWOBJ = %subst(DirName:1:X)
     C                             +'TUR/'+ %trimr(NEWFILE)
     c                   endif
      *
      *
      * Lag nytt objektnavn
      * Flytte objekt
     C                   MOVE      'J'           OkMov             1
     C                   MOVEl     EntryPath     FRA             120
     C                   MOVEl     NewObj        Til             120
     C                   CALL      'ARCAMOVC'
     C                   PARM                    FRA
     C                   PARM                    TIL
     C                   PARM                    OkMov
      *
     C     UtMov         ENDSR
