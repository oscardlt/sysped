      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TDKI012R MODULE(*LIBL/TDKI012R *LIBL/INCGI)
CRTPGM*        ACTGRP(*NEW) AUT(*USE)
      *
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FDKIV      UF A E           K DISK    USROPN
     F                                     PREFIX(X)
     FDKIH      IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D DKIV_SYAVA      S              4
     D DKIV_SYAV       S              4  0
     D DKIV_SYOPA      S              7
     D DKIV_SYOP       S              7  0
     D DKIV_SYLIA      S              2
     D DKIV_SYLI       S              2  0
     D WMODE           S              2
     D DKIV_311A       S             16
     D DKIV_311B       S             16
     D DKIV_311C       S             16
     D DKIV_311D       S             16
     D DKIV_311E       S             16
     D DKIV_312A       S             11
     D DKIV_312B       S             11
     D DKIV_312C       S             11
     D DKIV_312D       S             11
     D DKIV_312E       S             11
     D DKIV_313A       S              6S 0
     D DKIV_313B       S              6S 0
     D DKIV_313C       S              6S 0
     D DKIV_313D       S              6S 0
     D DKIV_313E       S              6S 0
     D DKIV_314A       S              2
     D DKIV_314B       S              2
     D DKIV_314C       S              2
     D DKIV_314D       S              2
     D DKIV_314E       S              2
     D DKIV_315A       S             45
     D DKIV_315B       S             45
     D DKIV_315C       S             45
     D DKIV_315D       S             45
     D DKIV_315E       S             45
     D DKIV_32         S              2S 0
     D DKIV_331        S             10
     D DKIV_332        S              4
     D DKIV_333        S              4
     D DKIV_SIKK       S              2
     D DKIV_34         S              2
     D DKIV_35         S             12S 3
     D DKIV_36         S              3
     D DKIV_37         S              7
     D DKIV_38         S              9S 0
     D DKIV_39         S              6
     D DKIV_S27        S              6
     D DKIV_401A       S              1
     D DKIV_401B       S              1
     D DKIV_401C       S              1
     D DKIV_401D       S              1
     D DKIV_401E       S              1
     D DKIV_401F       S              1
     D DKIV_401G       S              1
     D DKIV_401H       S              1
     D DKIV_401I       S              1
     D DKIV_401J       S              1
     D DKIV_401K       S              1
     D DKIV_401L       S              1
     D DKIV_401M       S              1
     D DKIV_401N       S              1
     D DKIV_401O       S              1
     D DKIV_401P       S              1
     D DKIV_401Q       S              1
     D DKIV_401R       S              1
     D DKIV_401S       S              1
     D DKIV_401T       S              1
     D DKIV_401U       S              1
     D DKIV_401V       S              1
     D DKIV_401W       S              1
     D DKIV_401X       S              1
     D DKIV_401Y       S              1
     D DKIV_402A       S              3
     D DKIV_402B       S              3
     D DKIV_402C       S              3
     D DKIV_402D       S              3
     D DKIV_402E       S              3
     D DKIV_402F       S              3
     D DKIV_402G       S              3
     D DKIV_402H       S              3
     D DKIV_402I       S              3
     D DKIV_402J       S              3
     D DKIV_402K       S              3
     D DKIV_402L       S              3
     D DKIV_402M       S              3
     D DKIV_402N       S              3
     D DKIV_402O       S              3
     D DKIV_402P       S              3
     D DKIV_402Q       S              3
     D DKIV_402R       S              3
     D DKIV_402S       S              3
     D DKIV_402T       S              3
     D DKIV_402U       S              3
     D DKIV_402V       S              3
     D DKIV_402W       S              3
     D DKIV_402X       S              3
     D DKIV_402Y       S              3
     D DKIV_403A       S             20
     D DKIV_403B       S             20
     D DKIV_403C       S             20
     D DKIV_403D       S             20
     D DKIV_403E       S             20
     D DKIV_403F       S             20
     D DKIV_403G       S             20
     D DKIV_403H       S             20
     D DKIV_403I       S             20
     D DKIV_403J       S             20
     D DKIV_403K       S             20
     D DKIV_403L       S             20
     D DKIV_403M       S             20
     D DKIV_403N       S             20
     D DKIV_403O       S             20
     D DKIV_403P       S             20
     D DKIV_403Q       S             20
     D DKIV_403R       S             20
     D DKIV_403S       S             20
     D DKIV_403T       S             20
     D DKIV_403U       S             20
     D DKIV_403V       S             20
     D DKIV_403W       S             20
     D DKIV_403X       S             20
     D DKIV_403Y       S             20
     D DKIV_411        S              3
     D DKIV_412        S              9S 0
     D DKIV_42         S             15S 0
     D DKIV_441        S             13
     D DKIV_4421       S              4
     D DKIV_4422       S              4
     D DKIV_4423       S              4
     D DKIV_4424       S              4
     D DKIV_4425       S              4
     D DKIV_4426       S              4
     D DKIV_4427       S              4
     D DKIV_4428       S              4
     D DKIV_4429       S              4
     D DKIV_442A       S             35
     D DKIV_442B       S             35
     D DKIV_442C       S             35
     D DKIV_442D       S             35
     D DKIV_442E       S             35
     D DKIV_442F       S             35
     D DKIV_442G       S             35
     D DKIV_442H       S             35
     D DKIV_442I       S             35
     D DKIV_443        S              4
     D DKIV_444A       S             20
     D DKIV_444B       S              4
     D DKIV_446Ka      S              5
     D DKIV_446Kb      S              5
     D DKIV_446Kf      S              5
     D DKIV_446Kj      S              5
     D DKIV_446Kn      S              5
     D DKIV_446Kr      S              5
     D DKIV_446Ta      S            255
     D DKIV_446Tb      S             35
     D DKIV_446Tc      S             35
     D DKIV_446Td      S             35
     D DKIV_446Te      S             35
     D DKIV_446Tf      S             35
     D DKIV_446Tg      S             35
     D DKIV_446Th      S             35
     D DKIV_446Ti      S             35
     D DKIV_446Tj      S             35
     D DKIV_446Tk      S             35
     D DKIV_446Tl      S             35
     D DKIV_446Tm      S             35
     D DKIV_446Tn      S             35
     D DKIV_446To      S             35
     D DKIV_446Tp      S             35
     D DKIV_446Tq      S             35
     D DKIV_446Tr      S             35
     D DKIV_446Ts      S             35
     D DKIV_449A       S             20
     D DKIV_449B       S             16
     D DKIV_46         S             15S 0
     D DKIV_T11B       S             15S 2
     D DKIV_T12        S             15S 2
     D DKIV_T13A       S             15S 2
     D DKIV_T13B       S             15S 2
     D DKIV_T13C       S             15S 2
     D DKIV_T14A       S             15S 2
     D DKIV_T14B       S             15S 2
     D DKIV_T14C       S             15S 2
     D DKIV_T14D       S             15S 2
     D DKIV_T15        S             15S 2
     D DKIV_T16        S             15S 2
     D DKIV_T17A       S             15S 2
     D DKIV_T17B       S             15S 2
     D DKIV_T17C       S             15S 2
     D DKIV_T18        S             15S 2
     D DKIV_T19        S             15S 2
     D DKIV_T20        S             15S 2
     D DKIV_T21A       S             35
     D DKIV_T21B       S             15S 2
     D DKIV_T22        S             15S 2
     D DKIV_T23        S             15S 2
     D DKIV_T24        S             15S 2
     D DKIV_T25A       S             35
     D DKIV_T25B       S             15S 2
     D DKIV_T25C       S              3
     D DKIV_T25D       S              7S 4
     D DKIV_28A        S              4
     D DKIV_28B        S             17
     D DKIV_28C        S              8S 0
     D DKIV_X01        S              5A
     D DKIV_X02        S             35A
     D DKIV_X03        S             35A
     D DKIV_X04        S              9S 0
     D DKIV_X05        S              5S 0
     D DKIV_X06        S              3A
     D DKIV_X07        S             11S 2
     D DKIV_ERR        S              1
     D DKIV_LIGH       S              1
     D JSONstring      S          32000
     D Error           S            150
     D WA              S             15

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C                   EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬dkiv_syav¬ : ¬'+%trim(%editc(DKIV_SYAV:'Z'))+'¬, '
        +'¬dkiv_syop¬ : ¬'+%trim(%editc(DKIV_SYOP:'Z'))+'¬, '
        +'¬dkiv_syli¬ : ¬'+%trim(%editc(DKIV_SYLI:'Z'))+'¬, '
        +'¬mode¬ : ¬'+%trim(WMODE)+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     c                   eval      JSONstring ='"lineupdate" : ['
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     DKIV
     C  N50              CLOSE     DKIH

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      WA         = zhbgetvar('AVD')
     C                   MOVEL     WA            DKIV_SYAVA
     C                   EVAL      DKIV_SYAV  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('OPD')
     C                   MOVEL     WA            DKIV_SYOPA
     C                   EVAL      DKIV_SYOP  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('LIN')
     C                   MOVEL     WA            DKIV_SYLIA
     C                   EVAL      DKIV_SYLI  = c2n2(WA)
     C                   EVAL      WMODE  = zhbgetvar('MODE')
     C                   EVAL      DKIV_311A  = zhbgetvar('DKIV_311A')
     C                   EVAL      DKIV_311B  = zhbgetvar('DKIV_311B')
     C                   EVAL      DKIV_311C  = zhbgetvar('DKIV_311C')
     C                   EVAL      DKIV_311D  = zhbgetvar('DKIV_311D')
     C                   EVAL      DKIV_311E  = zhbgetvar('DKIV_311E')
     C                   EVAL      DKIV_312A  = zhbgetvar('DKIV_312A')
     C                   EVAL      DKIV_312B  = zhbgetvar('DKIV_312B')
     C                   EVAL      DKIV_312C  = zhbgetvar('DKIV_312C')
     C                   EVAL      DKIV_312D  = zhbgetvar('DKIV_312D')
     C                   EVAL      DKIV_312E  = zhbgetvar('DKIV_312E')
     C                   EVAL      WA         = zhbgetvar('DKIV_313A')
     C                   EVAL      DKIV_313A  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_313B')
     C                   EVAL      DKIV_313B  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_313C')
     C                   EVAL      DKIV_313C  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_313D')
     C                   EVAL      DKIV_313D  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_313E')
     C                   EVAL      DKIV_313E  = c2n2(WA)
     C                   EVAL      DKIV_314A  = zhbgetvar('DKIV_314A')
     C                   EVAL      DKIV_314B  = zhbgetvar('DKIV_314B')
     C                   EVAL      DKIV_314C  = zhbgetvar('DKIV_314C')
     C                   EVAL      DKIV_314D  = zhbgetvar('DKIV_314D')
     C                   EVAL      DKIV_314E  = zhbgetvar('DKIV_314E')
     C                   EVAL      DKIV_315A  = zhbgetvar('DKIV_315A')
     C                   EVAL      DKIV_315B  = zhbgetvar('DKIV_315B')
     C                   EVAL      DKIV_315C  = zhbgetvar('DKIV_315C')
     C                   EVAL      DKIV_315D  = zhbgetvar('DKIV_315D')
     C                   EVAL      DKIV_315E  = zhbgetvar('DKIV_315E')
     C                   EVAL      WA         = zhbgetvar('DKIV_32')
     C                   EVAL      DKIV_32    = c2n2(WA)
     C                   EVAL      DKIV_331   = zhbgetvar('DKIV_331')
     C                   EVAL      DKIV_332   = zhbgetvar('DKIV_332')
     C                   EVAL      DKIV_333   = zhbgetvar('DKIV_333')
     C                   EVAL      DKIV_SIKK  = zhbgetvar('DKIV_SIKK')
     C                   EVAL      DKIV_34    = zhbgetvar('DKIV_34')
     C                   EVAL      WA         = zhbgetvar('DKIV_35')
     C                   EVAL      DKIV_35    = c2n2(WA)
     C                   EVAL      DKIV_36    = zhbgetvar('DKIV_36')
     C                   EVAL      DKIV_37    = zhbgetvar('DKIV_37')
     C                   EVAL      WA         = zhbgetvar('DKIV_38')
     C                   EVAL      DKIV_38    = c2n2(WA)
     C                   EVAL      DKIV_39    = zhbgetvar('DKIV_39')
     C                   EVAL      DKIV_S27   = zhbgetvar('DKIV_S27')
     C                   EVAL      DKIV_401A  = zhbgetvar('DKIV_401A')
     C                   EVAL      DKIV_401B  = zhbgetvar('DKIV_401B')
     C                   EVAL      DKIV_401C  = zhbgetvar('DKIV_401C')
     C                   EVAL      DKIV_401D  = zhbgetvar('DKIV_401D')
     C                   EVAL      DKIV_401E  = zhbgetvar('DKIV_401E')
     C                   EVAL      DKIV_401F  = zhbgetvar('DKIV_401F')
     C                   EVAL      DKIV_401G  = zhbgetvar('DKIV_401G')
     C                   EVAL      DKIV_401H  = zhbgetvar('DKIV_401H')
     C                   EVAL      DKIV_401I  = zhbgetvar('DKIV_401I')
     C                   EVAL      DKIV_401J  = zhbgetvar('DKIV_401J')
     C                   EVAL      DKIV_401K  = zhbgetvar('DKIV_401K')
     C                   EVAL      DKIV_401L  = zhbgetvar('DKIV_401L')
     C                   EVAL      DKIV_401M  = zhbgetvar('DKIV_401M')
     C                   EVAL      DKIV_401N  = zhbgetvar('DKIV_401N')
     C                   EVAL      DKIV_401O  = zhbgetvar('DKIV_401O')
     C                   EVAL      DKIV_401P  = zhbgetvar('DKIV_401P')
     C                   EVAL      DKIV_401Q  = zhbgetvar('DKIV_401Q')
     C                   EVAL      DKIV_401R  = zhbgetvar('DKIV_401R')
     C                   EVAL      DKIV_401S  = zhbgetvar('DKIV_401S')
     C                   EVAL      DKIV_401T  = zhbgetvar('DKIV_401T')
     C                   EVAL      DKIV_401U  = zhbgetvar('DKIV_401U')
     C                   EVAL      DKIV_401V  = zhbgetvar('DKIV_401V')
     C                   EVAL      DKIV_401W  = zhbgetvar('DKIV_401W')
     C                   EVAL      DKIV_401X  = zhbgetvar('DKIV_401X')
     C                   EVAL      DKIV_401Y  = zhbgetvar('DKIV_401Y')
     C                   EVAL      DKIV_402A  = zhbgetvar('DKIV_402A')
     C                   EVAL      DKIV_402B  = zhbgetvar('DKIV_402B')
     C                   EVAL      DKIV_402C  = zhbgetvar('DKIV_402C')
     C                   EVAL      DKIV_402D  = zhbgetvar('DKIV_402D')
     C                   EVAL      DKIV_402E  = zhbgetvar('DKIV_402E')
     C                   EVAL      DKIV_402F  = zhbgetvar('DKIV_402F')
     C                   EVAL      DKIV_402G  = zhbgetvar('DKIV_402G')
     C                   EVAL      DKIV_402H  = zhbgetvar('DKIV_402H')
     C                   EVAL      DKIV_402I  = zhbgetvar('DKIV_402I')
     C                   EVAL      DKIV_402J  = zhbgetvar('DKIV_402J')
     C                   EVAL      DKIV_402K  = zhbgetvar('DKIV_402K')
     C                   EVAL      DKIV_402L  = zhbgetvar('DKIV_402L')
     C                   EVAL      DKIV_402M  = zhbgetvar('DKIV_402M')
     C                   EVAL      DKIV_402N  = zhbgetvar('DKIV_402N')
     C                   EVAL      DKIV_402O  = zhbgetvar('DKIV_402O')
     C                   EVAL      DKIV_402P  = zhbgetvar('DKIV_402P')
     C                   EVAL      DKIV_402Q  = zhbgetvar('DKIV_402Q')
     C                   EVAL      DKIV_402R  = zhbgetvar('DKIV_402R')
     C                   EVAL      DKIV_402S  = zhbgetvar('DKIV_402S')
     C                   EVAL      DKIV_402T  = zhbgetvar('DKIV_402T')
     C                   EVAL      DKIV_402U  = zhbgetvar('DKIV_402U')
     C                   EVAL      DKIV_402V  = zhbgetvar('DKIV_402V')
     C                   EVAL      DKIV_402W  = zhbgetvar('DKIV_402W')
     C                   EVAL      DKIV_402X  = zhbgetvar('DKIV_402X')
     C                   EVAL      DKIV_402Y  = zhbgetvar('DKIV_402Y')
     C                   EVAL      DKIV_403A  = zhbgetvar('DKIV_403A')
     C                   EVAL      DKIV_403B  = zhbgetvar('DKIV_403B')
     C                   EVAL      DKIV_403C  = zhbgetvar('DKIV_403C')
     C                   EVAL      DKIV_403D  = zhbgetvar('DKIV_403D')
     C                   EVAL      DKIV_403E  = zhbgetvar('DKIV_403E')
     C                   EVAL      DKIV_403F  = zhbgetvar('DKIV_403F')
     C                   EVAL      DKIV_403G  = zhbgetvar('DKIV_403G')
     C                   EVAL      DKIV_403H  = zhbgetvar('DKIV_403H')
     C                   EVAL      DKIV_403I  = zhbgetvar('DKIV_403I')
     C                   EVAL      DKIV_403J  = zhbgetvar('DKIV_403J')
     C                   EVAL      DKIV_403K  = zhbgetvar('DKIV_403K')
     C                   EVAL      DKIV_403L  = zhbgetvar('DKIV_403L')
     C                   EVAL      DKIV_403M  = zhbgetvar('DKIV_403M')
     C                   EVAL      DKIV_403N  = zhbgetvar('DKIV_403N')
     C                   EVAL      DKIV_403O  = zhbgetvar('DKIV_403O')
     C                   EVAL      DKIV_403P  = zhbgetvar('DKIV_403P')
     C                   EVAL      DKIV_403Q  = zhbgetvar('DKIV_403Q')
     C                   EVAL      DKIV_403R  = zhbgetvar('DKIV_403R')
     C                   EVAL      DKIV_403S  = zhbgetvar('DKIV_403S')
     C                   EVAL      DKIV_403T  = zhbgetvar('DKIV_403T')
     C                   EVAL      DKIV_403U  = zhbgetvar('DKIV_403U')
     C                   EVAL      DKIV_403V  = zhbgetvar('DKIV_403V')
     C                   EVAL      DKIV_403W  = zhbgetvar('DKIV_403W')
     C                   EVAL      DKIV_403X  = zhbgetvar('DKIV_403X')
     C                   EVAL      DKIV_403Y  = zhbgetvar('DKIV_403Y')
     C                   EVAL      DKIV_411   = zhbgetvar('DKIV_411')
     C                   EVAL      WA         = zhbgetvar('DKIV_412')
     C                   EVAL      DKIV_412   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_42')
     C                   EVAL      DKIV_42    = c2n2(WA)
     C                   EVAL      DKIV_441   = zhbgetvar('DKIV_441')
     C                   EVAL      DKIV_4421  = zhbgetvar('DKIV_4421')
     C                   EVAL      DKIV_4422  = zhbgetvar('DKIV_4422')
     C                   EVAL      DKIV_4423  = zhbgetvar('DKIV_4423')
     C                   EVAL      DKIV_4424  = zhbgetvar('DKIV_4424')
     C                   EVAL      DKIV_4425  = zhbgetvar('DKIV_4425')
     C                   EVAL      DKIV_4426  = zhbgetvar('DKIV_4426')
     C                   EVAL      DKIV_4427  = zhbgetvar('DKIV_4427')
     C                   EVAL      DKIV_4428  = zhbgetvar('DKIV_4428')
     C                   EVAL      DKIV_4429  = zhbgetvar('DKIV_4429')
     C                   EVAL      DKIV_442A  = zhbgetvar('DKIV_442A')
     C                   EVAL      DKIV_442B  = zhbgetvar('DKIV_442B')
     C                   EVAL      DKIV_442C  = zhbgetvar('DKIV_442C')
     C                   EVAL      DKIV_442D  = zhbgetvar('DKIV_442D')
     C                   EVAL      DKIV_442E  = zhbgetvar('DKIV_442E')
     C                   EVAL      DKIV_442F  = zhbgetvar('DKIV_442F')
     C                   EVAL      DKIV_442G  = zhbgetvar('DKIV_442G')
     C                   EVAL      DKIV_442H  = zhbgetvar('DKIV_442H')
     C                   EVAL      DKIV_442I  = zhbgetvar('DKIV_442I')
     C                   EVAL      DKIV_443   = zhbgetvar('DKIV_443')
     C                   EVAL      DKIV_444A  = zhbgetvar('DKIV_444A')
     C                   EVAL      DKIV_444B  = zhbgetvar('DKIV_444B')
     C                   EVAL      DKIV_446Ka = zhbgetvar('DKIV_446Ka')
     C                   EVAL      DKIV_446Kb = zhbgetvar('DKIV_446Kb')
     C                   EVAL      DKIV_446Kf = zhbgetvar('DKIV_446Kf')
     C                   EVAL      DKIV_446Kj = zhbgetvar('DKIV_446Kj')
     C                   EVAL      DKIV_446Kn = zhbgetvar('DKIV_446Kn')
     C                   EVAL      DKIV_446Kr = zhbgetvar('DKIV_446Kr')
     C                   EVAL      DKIV_446Ta = zhbgetvar('DKIV_446Ta')
     C                   EVAL      DKIV_446Tb = zhbgetvar('DKIV_446Tb')
     C                   EVAL      DKIV_446Tc = zhbgetvar('DKIV_446Tc')
     C                   EVAL      DKIV_446Td = zhbgetvar('DKIV_446Td')
     C                   EVAL      DKIV_446Te = zhbgetvar('DKIV_446Te')
     C                   EVAL      DKIV_446Tf = zhbgetvar('DKIV_446Tf')
     C                   EVAL      DKIV_446Tg = zhbgetvar('DKIV_446Tg')
     C                   EVAL      DKIV_446Th = zhbgetvar('DKIV_446Th')
     C                   EVAL      DKIV_446Ti = zhbgetvar('DKIV_446Ti')
     C                   EVAL      DKIV_446Tj = zhbgetvar('DKIV_446Tj')
     C                   EVAL      DKIV_446Tk = zhbgetvar('DKIV_446Tk')
     C                   EVAL      DKIV_446Tl = zhbgetvar('DKIV_446Tl')
     C                   EVAL      DKIV_446Tm = zhbgetvar('DKIV_446Tm')
     C                   EVAL      DKIV_446Tn = zhbgetvar('DKIV_446Tn')
     C                   EVAL      DKIV_446To = zhbgetvar('DKIV_446To')
     C                   EVAL      DKIV_446Tp = zhbgetvar('DKIV_446Tp')
     C                   EVAL      DKIV_446Tq = zhbgetvar('DKIV_446Tq')
     C                   EVAL      DKIV_446Tr = zhbgetvar('DKIV_446Tr')
     C                   EVAL      DKIV_446Ts = zhbgetvar('DKIV_446Ts')
     C                   EVAL      DKIV_449A  = zhbgetvar('DKIV_449A')
     C                   EVAL      DKIV_449B  = zhbgetvar('DKIV_449B')
     C                   EVAL      WA         = zhbgetvar('DKIV_46')
     C                   EVAL      DKIV_46    = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T11B')
     C                   EVAL      DKIV_T11B  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T12')
     C                   EVAL      DKIV_T12   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T13A')
     C                   EVAL      DKIV_T13A  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T13B')
     C                   EVAL      DKIV_T13B  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T13C')
     C                   EVAL      DKIV_T13C  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T14A')
     C                   EVAL      DKIV_T14A  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T14B')
     C                   EVAL      DKIV_T14B  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T14C')
     C                   EVAL      DKIV_T14C  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T14D')
     C                   EVAL      DKIV_T14D  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T15')
     C                   EVAL      DKIV_T15   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T16')
     C                   EVAL      DKIV_T16   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T17A')
     C                   EVAL      DKIV_T17A  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T17B')
     C                   EVAL      DKIV_T17B  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T17C')
     C                   EVAL      DKIV_T17C  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T18')
     C                   EVAL      DKIV_T18   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T19')
     C                   EVAL      DKIV_T19   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T20')
     C                   EVAL      DKIV_T20   = c2n2(WA)
     C                   EVAL      DKIV_T21A  = zhbgetvar('DKIV_T21A')
     C                   EVAL      WA         = zhbgetvar('DKIV_T21B')
     C                   EVAL      DKIV_T21B  = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T22')
     C                   EVAL      DKIV_T22   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T23')
     C                   EVAL      DKIV_T23   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_T24')
     C                   EVAL      DKIV_T24   = c2n2(WA)
     C                   EVAL      DKIV_T25A  = zhbgetvar('DKIV_T25A')
     C                   EVAL      WA         = zhbgetvar('DKIV_T25B')
     C                   EVAL      DKIV_T25B  = c2n2(WA)
     C                   EVAL      DKIV_T25C  = zhbgetvar('DKIV_T25C')
     C                   EVAL      WA         = zhbgetvar('DKIV_T25D')
     C                   EVAL      DKIV_T25D  = c2n2(WA)
     C                   EVAL      DKIV_28A   = zhbgetvar('DKIV_28A')
     C                   EVAL      DKIV_28B   = zhbgetvar('DKIV_28B')
     C                   EVAL      WA         = zhbgetvar('DKIV_28C')
     C                   EVAL      DKIV_28C   = c2n2(WA)
     C                   EVAL      DKIV_X01   = zhbgetvar('DKIV_X01')
     C                   EVAL      DKIV_X02   = zhbgetvar('DKIV_X02')
     C                   EVAL      DKIV_X03   = zhbgetvar('DKIV_X03')
     C                   EVAL      WA         = zhbgetvar('DKIV_X04')
     C                   EVAL      DKIV_X04   = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('DKIV_X05')
     C                   EVAL      DKIV_X05   = c2n2(WA)
     C                   EVAL      DKIV_X06   = zhbgetvar('DKIV_X06')
     C                   EVAL      WA         = zhbgetvar('DKIV_X07')
     C                   EVAL      DKIV_X07   = c2n2(WA)
     C                   EVAL      DKIV_ERR   = zhbgetvar('DKIV_ERR')
     C                   EVAL      DKIV_LIGH  = zhbgetvar('DKIV_LIGH')
     C                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end
      *
     C     DKIVKEY       klist
     C                   kfld                    DKIV_SYAV
     C                   kfld                    DKIV_SYOP
     C                   kfld                    DKIV_SYLI
     C     DKIHKEY       klist
     C                   kfld                    DKIV_SYAV
     C                   kfld                    DKIV_SYOP
      *
     C   50              eval      Error = 'Invalid userID'
     C  N50              OPEN      DKIV
     C  N50              OPEN      DKIH

     c                   endsr
      *
      *______________________________________________________
      * TEST                                             TEST
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TEST          BEGSR
     C     WMODE         IFNE      'A'
     C     DKIVKEY       CHAIN     DKIV                               55
     C                   ENDIF
      * MODE A=Add  D=Delete  U=Update
     C                   SELECT
     C     WMODE         WHENEQ    'A'
     C                   eval      Error = *blanks
     C                   EXSR      SRA
     C     WMODE         WHENEQ    'D'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRD
     C                   ENDIF
     C     WMODE         WHENEQ    'U'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRU
     C                   ENDIF
     C                   OTHER
     C                   eval      Error = 'Wrong mode'
     C                   ENDSL
     C                   ENDSR
      *______________________________________________________
      * Add                                               SRA
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
     C                   CLEAR                   DKIvR
     C                   EVAL      XDKIv_SYAV=DKIv_SYAV
     C                   EVAL      XDKIv_SYOP=DKIv_SYOP
     C                   EVAL      XDKIv_SYLI=DKIv_SYLI
     C                   WRITE     DKIvR
     C                   ENDSR
      *______________________________________________________
      * Delete                                            SRD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C                   DELETE    DKIVR
     C                   ENDSR
      *______________________________________________________
      * Update                                            SRU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRU           BEGSR
     C                   EVAL      XDKIV_332 =DKIV_332
     C                   EVAL      XDKIV_36  =DKIV_36
     C                   EVAL      XDKIV_46  =DKIV_46
     C                   EVAL      XDKIV_ERR=DKIV_ERR
     C                   EXSR      TVD
     C                   IF        DKIV_LIGH=*BLANKS
     C                   EVAL      XDKIV_311A=DKIV_311A
     C                   EVAL      XDKIV_311B=DKIV_311B
     C                   EVAL      XDKIV_311C=DKIV_311C
     C                   EVAL      XDKIV_311D=DKIV_311D
     C                   EVAL      XDKIV_311E=DKIV_311E
     C                   EVAL      XDKIV_312A=DKIV_312A
     C                   EVAL      XDKIV_312B=DKIV_312B
     C                   EVAL      XDKIV_312C=DKIV_312C
     C                   EVAL      XDKIV_312D=DKIV_312D
     C                   EVAL      XDKIV_312E=DKIV_312E
     C                   EVAL      XDKIV_313A=DKIV_313A
     C                   EVAL      XDKIV_313B=DKIV_313B
     C                   EVAL      XDKIV_313C=DKIV_313C
     C                   EVAL      XDKIV_313D=DKIV_313D
     C                   EVAL      XDKIV_313E=DKIV_313E
     C                   EVAL      XDKIV_314A=DKIV_314A
     C                   EVAL      XDKIV_314B=DKIV_314B
     C                   EVAL      XDKIV_314C=DKIV_314C
     C                   EVAL      XDKIV_314D=DKIV_314D
     C                   EVAL      XDKIV_314E=DKIV_314E
     C                   EVAL      XDKIV_315A=DKIV_315A
     C                   EVAL      XDKIV_315B=DKIV_315B
     C                   EVAL      XDKIV_315C=DKIV_315C
     C                   EVAL      XDKIV_315D=DKIV_315D
     C                   EVAL      XDKIV_315E=DKIV_315E
     C                   EVAL      XDKIV_32  =DKIV_32
     C                   EVAL      XDKIV_331 =DKIV_331
     C                   EVAL      XDKIV_333 =DKIV_333
     C                   EVAL      XDKIV_SIKK=DKIV_SIKK
     C                   EVAL      XDKIV_34  =DKIV_34
     C                   EVAL      XDKIV_35  =DKIV_35
     C                   EVAL      XDKIV_37  =DKIV_37
     C                   EVAL      XDKIV_38  =DKIV_38
     C                   EVAL      XDKIV_39  =DKIV_39
     C                   EVAL      XDKIV_S27 =DKIV_S27
     C                   EVAL      XDKIV_401A=DKIV_401A
     C                   EVAL      XDKIV_401B=DKIV_401B
     C                   EVAL      XDKIV_401C=DKIV_401C
     C                   EVAL      XDKIV_401D=DKIV_401D
     C                   EVAL      XDKIV_401E=DKIV_401E
     C                   EVAL      XDKIV_401F=DKIV_401F
     C                   EVAL      XDKIV_401G=DKIV_401G
     C                   EVAL      XDKIV_401H=DKIV_401H
     C                   EVAL      XDKIV_401I=DKIV_401I
     C                   EVAL      XDKIV_401J=DKIV_401J
     C                   EVAL      XDKIV_401K=DKIV_401K
     C                   EVAL      XDKIV_401L=DKIV_401L
     C                   EVAL      XDKIV_401M=DKIV_401M
     C                   EVAL      XDKIV_401N=DKIV_401N
     C                   EVAL      XDKIV_401O=DKIV_401O
     C                   EVAL      XDKIV_401P=DKIV_401P
     C                   EVAL      XDKIV_401Q=DKIV_401Q
     C                   EVAL      XDKIV_401R=DKIV_401R
     C                   EVAL      XDKIV_401S=DKIV_401S
     C                   EVAL      XDKIV_401T=DKIV_401T
     C                   EVAL      XDKIV_401U=DKIV_401U
     C                   EVAL      XDKIV_401V=DKIV_401V
     C                   EVAL      XDKIV_401W=DKIV_401W
     C                   EVAL      XDKIV_401X=DKIV_401X
     C                   EVAL      XDKIV_401Y=DKIV_401Y
     C                   EVAL      XDKIV_402A=DKIV_402A
     C                   EVAL      XDKIV_402B=DKIV_402B
     C                   EVAL      XDKIV_402C=DKIV_402C
     C                   EVAL      XDKIV_402D=DKIV_402D
     C                   EVAL      XDKIV_402E=DKIV_402E
     C                   EVAL      XDKIV_402F=DKIV_402F
     C                   EVAL      XDKIV_402G=DKIV_402G
     C                   EVAL      XDKIV_402H=DKIV_402H
     C                   EVAL      XDKIV_402I=DKIV_402I
     C                   EVAL      XDKIV_402J=DKIV_402J
     C                   EVAL      XDKIV_402K=DKIV_402K
     C                   EVAL      XDKIV_402L=DKIV_402L
     C                   EVAL      XDKIV_402M=DKIV_402M
     C                   EVAL      XDKIV_402N=DKIV_402N
     C                   EVAL      XDKIV_402O=DKIV_402O
     C                   EVAL      XDKIV_402P=DKIV_402P
     C                   EVAL      XDKIV_402Q=DKIV_402Q
     C                   EVAL      XDKIV_402R=DKIV_402R
     C                   EVAL      XDKIV_402S=DKIV_402S
     C                   EVAL      XDKIV_402T=DKIV_402T
     C                   EVAL      XDKIV_402U=DKIV_402U
     C                   EVAL      XDKIV_402V=DKIV_402V
     C                   EVAL      XDKIV_402W=DKIV_402W
     C                   EVAL      XDKIV_402X=DKIV_402X
     C                   EVAL      XDKIV_402Y=DKIV_402Y
     C                   EVAL      XDKIV_403A=DKIV_403A
     C                   EVAL      XDKIV_403B=DKIV_403B
     C                   EVAL      XDKIV_403C=DKIV_403C
     C                   EVAL      XDKIV_403D=DKIV_403D
     C                   EVAL      XDKIV_403E=DKIV_403E
     C                   EVAL      XDKIV_403F=DKIV_403F
     C                   EVAL      XDKIV_403G=DKIV_403G
     C                   EVAL      XDKIV_403H=DKIV_403H
     C                   EVAL      XDKIV_403I=DKIV_403I
     C                   EVAL      XDKIV_403J=DKIV_403J
     C                   EVAL      XDKIV_403K=DKIV_403K
     C                   EVAL      XDKIV_403L=DKIV_403L
     C                   EVAL      XDKIV_403M=DKIV_403M
     C                   EVAL      XDKIV_403N=DKIV_403N
     C                   EVAL      XDKIV_403O=DKIV_403O
     C                   EVAL      XDKIV_403P=DKIV_403P
     C                   EVAL      XDKIV_403Q=DKIV_403Q
     C                   EVAL      XDKIV_403R=DKIV_403R
     C                   EVAL      XDKIV_403S=DKIV_403S
     C                   EVAL      XDKIV_403T=DKIV_403T
     C                   EVAL      XDKIV_403U=DKIV_403U
     C                   EVAL      XDKIV_403V=DKIV_403V
     C                   EVAL      XDKIV_403W=DKIV_403W
     C                   EVAL      XDKIV_403X=DKIV_403X
     C                   EVAL      XDKIV_403Y=DKIV_403Y
     C                   EVAL      XDKIV_411 =DKIV_411
     C                   EVAL      XDKIV_412 =DKIV_412
     C                   EVAL      XDKIV_42  =DKIV_42
     C                   EVAL      XDKIV_441 =DKIV_441
     C                   EVAL      XDKIV_4421=DKIV_4421
     C                   EVAL      XDKIV_4422=DKIV_4422
     C                   EVAL      XDKIV_4423=DKIV_4423
     C                   EVAL      XDKIV_4424=DKIV_4424
     C                   EVAL      XDKIV_4425=DKIV_4425
     C                   EVAL      XDKIV_4426=DKIV_4426
     C                   EVAL      XDKIV_4427=DKIV_4427
     C                   EVAL      XDKIV_4428=DKIV_4428
     C                   EVAL      XDKIV_4429=DKIV_4429
     C                   EVAL      XDKIV_442A=DKIV_442A
     C                   EVAL      XDKIV_442B=DKIV_442B
     C                   EVAL      XDKIV_442C=DKIV_442C
     C                   EVAL      XDKIV_442D=DKIV_442D
     C                   EVAL      XDKIV_442E=DKIV_442E
     C                   EVAL      XDKIV_442F=DKIV_442F
     C                   EVAL      XDKIV_442G=DKIV_442G
     C                   EVAL      XDKIV_442H=DKIV_442H
     C                   EVAL      XDKIV_442I=DKIV_442I
     C                   EVAL      XDKIV_443 =DKIV_443
     C                   EVAL      XDKIV_444A=DKIV_444A
     C                   EVAL      XDKIV_444B=DKIV_444B
     C                   EVAL      XDKIV_446Ka=DKIV_446Ka
     C                   EVAL      XDKIV_446Kb=DKIV_446Kb
     C                   EVAL      XDKIV_446Kf=DKIV_446Kf
     C                   EVAL      XDKIV_446Kj=DKIV_446Kj
     C                   EVAL      XDKIV_446Kn=DKIV_446Kn
     C                   EVAL      XDKIV_446Kr=DKIV_446Kr
     C                   EVAL      XDKIV_446Ta=DKIV_446Ta
     C                   EVAL      XDKIV_446Tb=DKIV_446Tb
     C                   EVAL      XDKIV_446Tc=DKIV_446Tc
     C                   EVAL      XDKIV_446Td=DKIV_446Td
     C                   EVAL      XDKIV_446Te=DKIV_446Te
     C                   EVAL      XDKIV_446Tf=DKIV_446Tf
     C                   EVAL      XDKIV_446Tg=DKIV_446Tg
     C                   EVAL      XDKIV_446Th=DKIV_446Th
     C                   EVAL      XDKIV_446Ti=DKIV_446Ti
     C                   EVAL      XDKIV_446Tj=DKIV_446Tj
     C                   EVAL      XDKIV_446Tk=DKIV_446Tk
     C                   EVAL      XDKIV_446Tl=DKIV_446Tl
     C                   EVAL      XDKIV_446Tm=DKIV_446Tm
     C                   EVAL      XDKIV_446Tn=DKIV_446Tn
     C                   EVAL      XDKIV_446To=DKIV_446To
     C                   EVAL      XDKIV_446Tp=DKIV_446Tp
     C                   EVAL      XDKIV_446Tq=DKIV_446Tq
     C                   EVAL      XDKIV_446Tr=DKIV_446Tr
     C                   EVAL      XDKIV_446Ts=DKIV_446Ts
     C                   EVAL      XDKIV_449A=DKIV_449A
     C                   EVAL      XDKIV_449B=DKIV_449B
     C                   EVAL      XDKIV_T11B=DKIV_T11B
     C                   EVAL      XDKIV_T12 =DKIV_T12
     C                   EVAL      XDKIV_T13A=DKIV_T13A
     C                   EVAL      XDKIV_T13B=DKIV_T13B
     C                   EVAL      XDKIV_T13C=DKIV_T13C
     C                   EVAL      XDKIV_T14A=DKIV_T14A
     C                   EVAL      XDKIV_T14B=DKIV_T14B
     C                   EVAL      XDKIV_T14C=DKIV_T14C
     C                   EVAL      XDKIV_T14D=DKIV_T14D
     C                   EVAL      XDKIV_T15 =DKIV_T15
     C                   EVAL      XDKIV_T16 =DKIV_T16
     C                   EVAL      XDKIV_T17A=DKIV_T17A
     C                   EVAL      XDKIV_T17B=DKIV_T17B
     C                   EVAL      XDKIV_T17C=DKIV_T17C
     C                   EVAL      XDKIV_T18 =DKIV_T18
     C                   EVAL      XDKIV_T19 =DKIV_T19
     C                   EVAL      XDKIV_T20 =DKIV_T20
     C                   EVAL      XDKIV_T21A=DKIV_T21A
     C                   EVAL      XDKIV_T21B=DKIV_T21B
     C                   EVAL      XDKIV_T22 =DKIV_T22
     C                   EVAL      XDKIV_T23 =DKIV_T23
     C                   EVAL      XDKIV_T24 =DKIV_T24
     C                   EVAL      XDKIV_T25A=DKIV_T25A
     C                   EVAL      XDKIV_T25B=DKIV_T25B
     C                   EVAL      XDKIV_T25C =DKIV_T25C
     C                   EVAL      XDKIV_T25D =DKIV_T25D
     C                   EVAL      XDKIV_28A  =DKIV_28A
     C                   EVAL      XDKIV_28B  =DKIV_28B
     C                   EVAL      XDKIV_28C  =DKIV_28C
     C                   EVAL      XDKIV_X01  =DKIV_X01
     C                   EVAL      XDKIV_X02  =DKIV_X02
     C                   EVAL      XDKIV_X03  =DKIV_X03
     C                   EVAL      XDKIV_X04  =DKIV_X04
     C                   EVAL      XDKIV_X05  =DKIV_X05
     C                   EVAL      XDKIV_X06  =DKIV_X06
     C                   EVAL      XDKIV_X07  =DKIV_X07
     C                   EVAL      XDKIV_ERR=DKIV_ERR
     C                   ENDIF
     C                   UPDATE    DKIVR
      * Omberegn varepost med hensyn til statistisk værdi + tv
     C                   MOVE      DKIV_SYAV     DKIV_SYAVA
     C                   MOVE      DKIV_SYOP     DKIV_SYOPA
     C                   MOVE      DKIV_SYLI     DKIV_SYLIA
     C     DKIH_GENB     IFNE      *BLANKS
     C                   CALL      'DKI072R'
     C                   PARM                    DKIV_SYAVA
     C                   PARM                    DKIV_SYOPA
     C                   PARM                    DKIV_SYLIA
     C                   ENDIF

     C                   ENDSR
      *______________________________________________________
      * Summera toldværdideklarationen                    TVD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TVD           BEGSR

     C     DKIHKEY       CHAIN     DKIH

     C                   IF        DKIV_T12=*ZEROS
     C     DKIV_42       ADD       DKIV_T11B     W11A             17 0
     C     W11A          MULT(H)   DKIH_221B     DKIV_T12
     C                   IF        DKIH_221C > 0
     C     DKIV_T12      DIV       DKIH_221C     DKIV_T12
     C                   ENDIF
     C                   ENDIF

     C                   Z-ADD     DKIV_T13A     DKIV_T18
     C                   ADD       DKIV_T13B     DKIV_T18
     C                   ADD       DKIV_T13C     DKIV_T18
     C                   ADD       DKIV_T14A     DKIV_T18
     C                   ADD       DKIV_T14B     DKIV_T18
     C                   ADD       DKIV_T14C     DKIV_T18
     C                   ADD       DKIV_T14D     DKIV_T18
     C                   ADD       DKIV_T15      DKIV_T18
     C                   ADD       DKIV_T16      DKIV_T18
     C                   ADD       DKIV_T17A     DKIV_T18
     C                   ADD       DKIV_T17B     DKIV_T18
     C                   ADD       DKIV_T17C     DKIV_T18

     C                   Z-ADD     DKIV_T19      DKIV_T23
     C                   ADD       DKIV_T20      DKIV_T23
     C                   ADD       DKIV_T21B     DKIV_T23
     C                   ADD       DKIV_T22      DKIV_T23

     C                   Z-ADD     DKIV_T12      DKIV_T24
     C                   ADD       DKIV_T18      DKIV_T24
     C                   SUB       DKIV_T23      DKIV_T24

     C                   IF        DKIV_46 = *ZEROS
     C                   EVAL      DKIV_46 = DKIV_T24
     C                   ENDIF

     C                   ENDSR
