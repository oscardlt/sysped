     D Len             S              4S 0
     D Brd             S              4S 0
     D Ant             S              7S 0
     D Pakn            S              7
     D LM              S              4S 2
     D SumBrd          S             15S 0
     D XWORK           S             15S 4
     C     *entry        PLIST
     C                   PARM                    Len
     C                   PARM                    Brd
     C                   PARM                    Ant
     C                   PARM                    Pakn                           Forpakung = RØR ??
     C                   PARM                    LM
      /free
          // LxBxH ER angitt - hvis LM IKKE er angitt bereg den
          // Hovedregel : LM=LenxBe/2,4    MEN  - div unntak

          // Hvis RØR og sum bredde <1,25 = Len / 2 (halve planet) RØR>1,25 = Len (hele planet)
            if %subst(Pakn:1:3)='RØR';
               eval sumBrd = Brd * Ant;
               if sumBrd <= 125;
                eval(h)   LM =Len/2/100;                   //Halve planet i rørenes lengde
               else;
                eval(h)   LM =Len/100;                     //Hele  planet i rørenes lengde
               endif;
            else;
          // annet enn rør..
              XWORK=0;
              eval(h) XWORK=Len*Brd/2.4/10000;                //Hoved = Len*Bre/2.4
              if XWORK > 99.99;
                LM = 99.99;
              else;
                eval(h) LM = XWORK;
              endif;
          // Bredde større enne 125 ??
              if Brd > 125;
                eval(h) LM =Len/100;                          //Unnt 1= Len (mer en havle planet)
                if Len <= 125;                                // Len under 1,25 = kan snu...
                  eval(h) LM =Brd/2/100;                      //Unnt 2= Bre/2 (halve planet)
                endif;
              else;
                if Brd <= 120 and Len > 130;                 // "tynne"(under 120)/"lange"(over 130)
                  eval(h) LM=Len/2/100;                      //    Unnt 3= Len / 2
                endif;
              endif;
            // LM = enhets-LM * antall
               XWORK= Ant*LM;
               if XWORK > 99.99;
                 LM = 99.99;
               else;
                 eval(h) LM = XWORK;
               endif;
            endif;
      /end-free
      *
     C                   MOVE      *ON           *INLR
     C                   return
