/* SENDE FRAKTBREV PÅ EMAIL       */
/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 02 JOV PTF11 LPI(12) + SIDESTØRRELSE/OVERFLOW DOBLET SYBRINGTMS */
/*                              + SIDEBREDDE- 90->100                      */
/* *********************************************************************   */
             PGM        PARM(&FI &CURTUR)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('F') /* +
                          Kode = 'F', 'T'. 'F'=fraktbrev, +
                          'T'=tollpassfraktbrev  */
             DCL        VAR(&VB) TYPE(*CHAR) LEN(1) VALUE(' ') /* +
                          Hvis &VB = 'J',  VALGBILDE              +
                          til bruker. */
             DCL        VAR(&PO) TYPE(*CHAR) LEN(1) VALUE('F') /* +
                          Hvis &PO = 'J',SORT   F=FAX             */
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) VALUE('00') +
                          /* Antall utskrifter. */
             DCL        VAR(&FI) TYPE(*CHAR) LEN(2)
             DCL        VAR(&CURTUR) TYPE(*CHAR) LEN(11)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FBNR) TYPE(*CHAR) LEN(3) VALUE('001')
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(50)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&PDF) TYPE(*CHAR) LEN(1) VALUE('N')

             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)

             CHGVAR     VAR(&AVD) VALUE(%SUBSTRING(&CURTUR 1 4))
             CHGVAR     VAR(&OPD) VALUE(%SUBSTRING(&CURTUR 5 7))
             CHGVAR     VAR(&STMF) VALUE('/syspeddev/temp/FBREV' +
                          *CAT &CURTUR *CAT '.pdf')

    /* FIX UDS */
             CHGDTAARA  DTAARA(*LDA (2 2)) VALUE(&FI)
             CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
             CHGDTAARA  DTAARA(*LDA (19 3)) VALUE('WEB')
             CHGDTAARA  DTAARA(*LDA (22 9)) VALUE(&OPD *CAT &FBNR)
             CHGDTAARA  DTAARA(*LDA (64 6)) VALUE('000000')

    /* OVERRIDE PRINTERFILE/SKRIV-FR.BEV  */
             IF         COND(&KODE = 'F') THEN(DO)
             OVRPRTF    FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 100) LPI(12) CPI(10) +
                          FRONTMGN(0.14 0) OVRFLW(70) +
                          FRONTOVL(FRAKTBRE 0.1) +
                          OUTQ(SYCGIOUTQ) FORMTYPE(*STD) HOLD(*YES) +
                          SPLFOWN(*JOB)
                          ENDDO
/*                                                               */

             IF         COND(&KODE = 'T') THEN(DO)
             OVRPRTF    FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 100) LPI(12) CPI(10) +
                          FRONTMGN(0.14 0) OVRFLW(70) +
                          FRONTOVL(TOLLPASS 0.1) +
                          OUTQ(SYCGIOUTQ) FORMTYPE(*STD) HOLD(*YES) +
                          SPLFOWN(*JOB)
                          ENDDO

             CALL       PGM(SYFA12) PARM(&PRANT &KODE &VB &PO &PDF)

             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             CVTSPLFPDF SPLF(SYFA12P) TOPDF(&STMF) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST)
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)

             DLTSPLF    FILE(ZBARC) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
    /* */
 SLUTT:      ENDPGM
