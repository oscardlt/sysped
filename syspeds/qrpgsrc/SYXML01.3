      *
      ***********************************************************
      *** PROGRAM SKAL SENDE XML-FAKTURA                      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-49 51-99                ***
      ***********************************************************
     FFIRM      IF   E           K DISK
     FXMLUFL1   UF   E           K DISK
     FECMSG     IF   E           K DISK    USROPN
     FKODWL01   IF   E           K DISK    USROPN
     FKODTA     IF   E           K DISK    USROPN
     FKODTGE    IF   E           K DISK    USROPN
     FKODTG2    IF   E           K DISK    USROPN
     FKODTSF    IF   E           K DISK    USROPN
     FCUNDL01   IF   E           K DISK    USROPN
     FFAIN      IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FFAK8      IF   E           K DISK    USROPN
     FEDIC      UF A E             DISK    USROPN
     FEDIS      O  A E             DISK    USROPN
     FEDIM      O  A E             DISK    USROPN
     FEDISE1K   O  A E             DISK    USROPN
     D TXT             S             80    DIM(178) CTDATA PERRCD(1)
     D TXT01           S             80    DIM(3) CTDATA PERRCD(1)
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  XMBR                   1     10
     D  XMBRA                  1      1
     D  XMBRB                  2      8S 0
     D                 DS
     D  WDT                    1      8
     D  WDTÅ                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  WTM                    1      6
     D  WTMH                   1      2
     D  WTMM                   3      4
     D  WTMS                   5      6
     D                 DS
     D  HEAVD                  1      4  0
     D  XXSTREKK1              5      5
     D  HEOPD                  6     10  0
     D  XXSTREKK2             11     11
     D  HESG                  12     14
     D  SYSPEDREF              1     14
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTOPÅ                1      4
     D  HEDTOPM                5      6
     D  HEDTOPD                7      8
     D                 DS
     D  FADATO                 1      8  0
     D  FADATOÅ                1      4
     D  FADATOM                5      6
     D  FADATOD                7      8
     D                 DS
     D  FADAFF                 1      8  0
     D  FADAFFÅ                1      4
     D  FADAFFM                5      6
     D  FADAFFD                7      8
     D                 DS
     D  SYKT8                  1      8
     D  SYFR02                 1      1
     D  SYKT7                  2      7
     D  SYKONT                 2      8  0
     D                 DS
     D  XMLT1                  1     44  2 DIM(11)
     D  XFMS01                 1      4  2
     D  XFMS02                 5      8  2
     D  XFMS03                 9     12  2
     D  XFMS04                13     16  2
     D  XFMS05                17     20  2
     D  XFMS06                21     24  2
     D  XFMS07                25     28  2
     D  XFMS08                29     32  2
     D  XFMS09                33     36  2
     D  XFMS10                37     40  2
     D  XFMS11                41     44  2
     D                 DS
     D  XMLT2                  1     33    DIM(11)
     D  XFMV01                 1      3
     D  XFMV02                 4      6
     D  XFMV03                 7      9
     D  XFMV04                10     12
     D  XFMV05                13     15
     D  XFMV06                16     18
     D  XFMV07                19     21
     D  XFMV08                22     24
     D  XFMV09                25     27
     D  XFMV10                28     30
     D  XFMV11                31     33
     D                 DS
     D  XMLT3                  1    143  2 DIM(11)
     D  XFMGN1                 1     13  2
     D  XFMGN2                14     26  2
     D  XFMGN3                27     39  2
     D  XFMGN4                40     52  2
     D  XFMGN5                53     65  2
     D  XFMGN6                66     78  2
     D  XFMGN7                79     91  2
     D  XFMGN8                92    104  2
     D  XFMGN9               105    117  2
     D  XFMGNA               118    130  2
     D  XFMGNB               131    143  2
     D                 DS
     D  XMLT4                  1    143  2 DIM(11)
     D  XFMGV1                 1     13  2
     D  XFMGV2                14     26  2
     D  XFMGV3                27     39  2
     D  XFMGV4                40     52  2
     D  XFMGV5                53     65  2
     D  XFMGV6                66     78  2
     D  XFMGV7                79     91  2
     D  XFMGV8                92    104  2
     D  XFMGV9               105    117  2
     D  XFMGVA               118    130  2
     D  XFMGVB               131    143  2
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C     XMLUFL1K      SETLL     XMLUFL1
     C     XMLUFL1K      READE     XMLUFL1                                50
     C   50              GOTO      SLUTT
      *
     C                   EXSR      SRINIT
      *
     C                   EXSR      SRSTART
     C                   DOW       *IN50 = *OFF
     C                   EXSR      SREMSG
     C     XMLUFL1K      READE     XMLUFL1                                50
     C  N50              IF        XFKN <> XXKN
     C                   UPDATE    XMLUFFR
     C                   LEAVE
     C                   END
     C  N50              ENDDO
     C                   EXSR      SRSLUTT
     C  N50              EXSR      SRCLOSE
     C  N50              GOTO      START
      *
     C     SLUTT         TAG
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SRINIT        BEGSR
      ***********************************************
     C                   OPEN      ECMSG
     C                   OPEN      KODWL01
     C                   OPEN      KODTA
     C                   OPEN      KODTGE
     C                   OPEN      KODTG2
     C                   OPEN      KODTSF
     C                   OPEN      CUNDL01
     C                   OPEN      FAIN
     C                   OPEN      HEADF
     C                   OPEN      FAK8
     C                   OPEN      EDIC
     C                   OPEN      EDIS
     C                   OPEN      EDIM
     C                   OPEN      EDISE1K
      *
     C     ECMSGK        CHAIN     ECMSG                              33
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
      *
     C                   MOVE      XFKN          XXKN              8 0
     C                   MOVE      *BLANKS       XXA80            80
     C                   MOVE      *ZEROS        XXAN01            1 0
     C                   MOVE      *ZEROS        XNPOS             3 0
     C                   MOVE      *BLANKS       XMBR
     C                   MOVE      'F'           XMBRA
     C                   MOVE      CSN           XMBRB
     C                   MOVE      XMBR          SEMBR
     C                   MOVE      *BLANKS       SDATA
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM
      *
     C                   EVAL      S0004 = ECIIDI
     C                   EVAL      S0010 = ECIIDC
     C                   EVAL      S0020 = SEMBR
     C                   EVAL      S0036 = 0
     C                   EVAL      SSN   = CSN
     C                   EVAL      SSR   = 'S'
     C                   EVAL      SST   = 'X'
     C                   MOVE      WDT           SDT
     C                   MOVE      WTM           STM
     C                   EVAL      SLIB  = '*LIBL'
     C                   EVAL      SFILE = 'EDISE'
     C                   EVAL      SMBR  = SEMBR
     C                   EVAL      SMBRS  = 0
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSTART       BEGSR
      ***********************************************
     C                   EVAL      SDATA = TXT(1)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(2)
     C                   CAT       TXT01(1):0    SDATA
     C                   CAT       TXT01(2):0    SDATA
     C                   CAT       TXT01(3):0    SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(4)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(5)
     C                   WRITE     EDISER
      * Orginator
     C                   EVAL      SDATA = TXT(6)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(8)
     C                   CAT       S0004:0       SDATA
     C                   CAT       TXT(9):0      SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(10)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(11)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(12):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(7)
     C                   WRITE     EDISER
      * Recipient
     C                   EVAL      SDATA = TXT(13)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(8)
     C                   CAT       S0010:0       SDATA
     C                   CAT       TXT(9):0      SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(10)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(11)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(12):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(14)
     C                   WRITE     EDISER
      * InterchangeID
     C                   EVAL      SDATA = TXT(15)
     C                   CAT       SEMBR:0       SDATA
     C                   CAT       TXT(16):0     SDATA
     C                   WRITE     EDISER
      * InterchangeTime
     C                   EVAL      SDATA = TXT(17)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(19)
     C                   CAT       'year="':1    SDATA
     C                   CAT       WDTÅ:0        SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       WDTM:0        SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       WDTD:0        SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       WDTÅ:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTM:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTD:0        SDATA
     C                   CAT       TXT(20):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(21)
     C                   CAT       'hour="':1    SDATA
     C                   CAT       WTMH:0        SDATA
     C                   CAT       '" minute="':0SDATA
     C                   CAT       WTMM:0        SDATA
     C                   CAT       '" second="':0SDATA
     C                   CAT       WTMS:0        SDATA
     C                   CAT       '" fraction':0SDATA
     C                   CAT       '="050">':0   SDATA
     C                   CAT       WTMH:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMM:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMS:0        SDATA
     C                   CAT       TXT(22):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(18)
     C                   WRITE     EDISER
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREMSG        BEGSR
      ***********************************************
     C                   MOVE      XFFN          FIFN
     C     FIFN          SETLL     FAIN
     C     FIFN          READE     FAIN                                   33
     C                   EVAL      XXAN01 = 0
      * eMessage start
     C                   EVAL      SDATA = TXT(23)
     C                   WRITE     EDISER
      * MessageType
     C                   EVAL      SDATA = TXT(25)
     C                   CAT       'Invoice':0   SDATA
     C                   CAT       TXT(26):0     SDATA
     C                   WRITE     EDISER
      * MessageVersion
     C                   EVAL      SDATA = TXT(27)
     C                   CAT       'PS-14':0     SDATA
     C                   CAT       TXT(28):0     SDATA
     C                   WRITE     EDISER
      * DokumentType
     C                   EVAL      SDATA = TXT(29)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(31)
     C                   IF        XFFK = 'F'
     C                   CAT       '380':0       SDATA
     C                   ELSE
     C                   CAT       '381':0       SDATA
     C                   END
     C                   CAT       TXT(32):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(33)
     C                   IF        XFFK = 'F'
     C                   CAT       'FAKTURA':0   SDATA
     C                   ELSE
     C                   CAT       'KREDITNOTA':0SDATA
     C                   END
     C                   CAT       TXT(34):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(30)
     C                   WRITE     EDISER
      * MessageReferance
     C                   EXSR      OPDEDIM
      *
     C                   EVAL      SDATA = TXT(35)
     C                   MOVE      MMN           XXA07             7
     C                   CAT       XXA07:0       SDATA
     C                   CAT       TXT(36):0     SDATA
     C                   WRITE     EDISER
      * MessageOriginator
     C                   EVAL      SDATA = TXT(37)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(8)
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   CAT       SYRG:0        SDATA
     C                   CAT       TXT(9):0      SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(10)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(11)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(12):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(38)
     C                   WRITE     EDISER
      * MessageRecipient
     C                   EVAL      SDATA = TXT(39)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(8)
     C                   MOVE      FAKUNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   CAT       SYRG:0        SDATA
     C                   CAT       TXT(9):0      SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(10)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(11)
     C                   CAT       'OrgNr-Avd':0 SDATA
     C                   CAT       TXT(12):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(40)
     C                   WRITE     EDISER
      * MessageContant start
     C                   EVAL      SDATA = TXT(41)
     C                   WRITE     EDISER
      *
     C                   EXSR      SREINV
      * MessageContant slutt
     C                   EVAL      SDATA = TXT(42)
     C                   WRITE     EDISER
      * eMessage slutt
     C                   EVAL      SDATA = TXT(24)
     C                   WRITE     EDISER
      * Oppdater XMLUFF
     C                   MOVE      'C'           XFST
     C                   MOVE      WDT           XFDTS
     C                   MOVE      WTM           XFTDS
     C                   UPDATE    XMLUFFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREINV        BEGSR
      ***********************************************
     C     HEADFK        CHAIN     HEADF                              33
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C                   IF        FAVAL = *BLANKS
     C                   EVAL      FAVAL = FICURR
     C                   END
      *
     C                   EVAL      XXAN01 = 0
      * Invoice start
     C                   EVAL      SDATA = TXT(43)
     C                   WRITE     EDISER
      * InvoiceDates
     C                   EVAL      SDATA = TXT(45)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(47)
     C                   CAT       'year="':1    SDATA
     C                   CAT       FADATOÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       FADATOM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       FADATOD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       FADATOÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADATOM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADATOD:0     SDATA
     C                   CAT       TXT(48):0     SDATA
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(49)
     C                   CAT       'year="':1    SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       TXT(50):0     SDATA
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(46)
     C                   WRITE     EDISER
      * InvoiceReferance start
     C                   EVAL      SDATA = TXT(51)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(53)
     C                   MOVE      FIFN          XXA06             6
     C                   CAT       XXA06:0       SDATA
     C                   CAT       TXT(54):0     SDATA
     C                   WRITE     EDISER
      * OtherReferance start
     C                   EVAL      SDATA = TXT(161)
     C                   WRITE     EDISER
      * AgentReference
     C                   IF        HERFA <> *BLANKS
     C                   EVAL      SDATA = TXT(163)
     C                   CAT       'type="Agen':1SDATA
     C                   CAT       'tReference':0SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       HERFA:0       SDATA
     C                   CAT       TXT(164):0    SDATA
     C                   WRITE     EDISER
     C                   END
      * OurReferense
     C                   EVAL      SDATA = TXT(163)
     C                   CAT       'type="Our':1 SDATA
     C                   CAT       'Reference':0 SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       SYSPEDREF:0   SDATA
     C                   CAT       TXT(164):0    SDATA
     C                   WRITE     EDISER
      * DeliveryTerms
     C                   EVAL      SDATA = TXT(163)
     C                   CAT       'type="':1    SDATA
     C                   CAT       'Delivery':0  SDATA
     C                   CAT       'Terms">':0   SDATA
     C                   CAT       HEFR:0        SDATA
     C                   CAT       TXT(164):0    SDATA
     C                   WRITE     EDISER
      * OtherReferance slutt
     C                   EVAL      SDATA = TXT(162)
     C                   WRITE     EDISER
      * InvoiceReferance slutt
     C                   EVAL      SDATA = TXT(52)
     C                   WRITE     EDISER
      *
     C                   IF        XFFK = 'K'
     C                   GOTO      STPARTIES
     C                   END
      * PaymentInfo start
     C                   EVAL      SDATA = TXT(55)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(57)
     C                   CAT       XFBB:0        SDATA
     C                   CAT       TXT(58):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(59)
     C                   CAT       XFBBT:0       SDATA
     C                   CAT       TXT(60):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(61)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(63)
     C                   CAT       XFKT:0        SDATA
     C                   CAT       TXT(64):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(62)
     C                   WRITE     EDISER
      * PaymentDueDate
     C                   EVAL      SDATA = TXT(65)
     C                   CAT       'year="':1    SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       TXT(66):0     SDATA
     C                   WRITE     EDISER
      * PaymentAmount
     C                   EVAL      SDATA = TXT(67)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   Z-ADD     XFTOT         ØN152
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(68):0     SDATA
     C                   WRITE     EDISER
      * Kid
     C                   EVAL      SDATA = TXT(69)
     C                   CAT       XFKID:0       SDATA
     C                   CAT       TXT(70):0     SDATA
     C                   WRITE     EDISER
      * CheckDigit
     C*                  Z-ADD     21            XN
     C*                  EVAL      SDATA = XFKID
     C*                  DOW       XN > 1
     C*                  IF        A80(XN) <> ' '
     C*                  MOVE      A80(XN)       XXA01             1
     C*                  LEAVE
     C*                  END
     C*                  EVAL      XN = XN - 1
     C*                  ENDDO
     C*                  EVAL      SDATA = TXT(71)
     C*                  CAT       XXA01:0       SDATA
     C*                  CAT       TXT(72):0     SDATA
     C*                  WRITE     EDISER
      * PaymentInfo slutt
     C                   EVAL      SDATA = TXT(56)
     C                   WRITE     EDISER
      *
      * Parties
     C     STPARTIES     TAG
     C                   EXSR      SRPART
      * Summery
     C                   EXSR      SRSUM
      * Details
     C                   EXSR      SRDET
      * Invoice slutt
     C                   EVAL      SDATA = TXT(44)
     C                   WRITE     EDISER
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRPART        BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
      * Parties start
     C                   EVAL      SDATA = TXT(73)
     C                   WRITE     EDISER
      * Invoicer start
     C                   EVAL      SDATA = TXT(75)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(89)
     C                   WRITE     EDISER
      *
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   EVAL      SDATA = TXT(91)
     C                   CAT       SYRG:0        SDATA
     C                   CAT       TXT(92):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(93)
     C                   CAT       'NO':0        SDATA
     C*                  IF        SYFR02 = ' '
     C*                  CAT       SYKT7:0       SDATA
     C*                  ELSE
     C*                  CAT       SYKT8:0       SDATA
     C*                  END
     C                   CAT       SYRG:0        SDATA
     C                   CAT       'MVA':0       SDATA
     C                   CAT       TXT(94):0     SDATA
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(90)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(95)
     C                   CAT       KNAVN:0       SDATA
     C                   CAT       TXT(96):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(97)
     C                   WRITE     EDISER
     C                   IF        ADR1 <> *BLANKS
     C                   EVAL      SDATA = TXT(99)
     C                   CAT       ADR1:0        SDATA
     C                   CAT       TXT(100):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      SDATA = TXT(101)
     C                   CAT       ADR2:0        SDATA
     C                   CAT       TXT(102):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        ADR3 <> *BLANKS
     C                   EVAL      SDATA = TXT(103)
     C                   CAT       ADR3:0        SDATA
     C                   CAT       TXT(104):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        POSTNR <> 0
     C                   EVAL      SDATA = TXT(105)
     C                   MOVE      POSTNR        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   WRITE     EDISER
     C                   ELSE
     C                   IF        SYPOGE <> *BLANKS
     C                   EVAL      SDATA = TXT(105)
     C                   CAT       SYPOGE:0      SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   END
     C                   EVAL      SDATA = TXT(107)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       FILAND:0      SDATA
     C                   ELSE
     C                   CAT       SYLAND:0      SDATA
     C                   END
     C                   CAT       TXT(108):0    SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(98)
     C                   WRITE     EDISER
      * Contact start
     C                   EVAL      SDATA = TXT(77)
     C                   WRITE     EDISER
      * Reference
     C     KODTSFK       CHAIN     KODTSF                             33
     C                   EVAL      SDATA = TXT(79)
     C                   CAT       KOSFNV:0      SDATA
     C                   CAT       TXT(80):0     SDATA
     C                   WRITE     EDISER
      * Email
     C*                  IF        SYEPOS <> *BLANKS
     C*                  EVAL      SDATA = TXT(81)
     C*                  CAT       SYEPOS:0      SDATA
     C*                  CAT       TXT(82):0     SDATA
     C*                  WRITE     EDISER
     C*                  END
      * Phone
     C                   IF        TLF <> *BLANKS
     C                   EVAL      SDATA = TXT(83)
     C                   CAT       TLF:0         SDATA
     C                   CAT       TXT(84):0     SDATA
     C                   WRITE     EDISER
     C                   END
      * Fax
     C                   IF        TFAXNR <> *BLANKS
     C                   EVAL      SDATA = TXT(85)
     C                   CAT       TFAXNR:0      SDATA
     C                   CAT       TXT(86):0     SDATA
     C                   WRITE     EDISER
     C                   END
      * Contact slutt
     C                   EVAL      SDATA = TXT(78)
     C                   WRITE     EDISER
      * Invoicer slutt
     C                   EVAL      SDATA = TXT(76)
     C                   WRITE     EDISER
      * Invoicee start
     C                   EVAL      SDATA = TXT(109)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(89)
     C                   WRITE     EDISER
      *
     C                   MOVE      FAKUNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   EVAL      SDATA = TXT(91)
     C                   CAT       SYRG:0        SDATA
     C                   CAT       TXT(92):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(93)
     C                   CAT       'NO':0        SDATA
     C*                  IF        SYFR02 = ' '
     C*                  CAT       SYKT7:0       SDATA
     C*                  ELSE
     C*                  CAT       SYKT8:0       SDATA
     C*                  END
     C                   CAT       SYRG:0        SDATA
     C                   CAT       'MVA':0       SDATA
     C                   CAT       TXT(94):0     SDATA
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(90)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(95)
     C                   CAT       KNAVN:0       SDATA
     C                   CAT       TXT(96):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(97)
     C                   WRITE     EDISER
     C                   IF        ADR1 <> *BLANKS
     C                   EVAL      SDATA = TXT(99)
     C                   CAT       ADR1:0        SDATA
     C                   CAT       TXT(100):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      SDATA = TXT(101)
     C                   CAT       ADR2:0        SDATA
     C                   CAT       TXT(102):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        ADR3 <> *BLANKS
     C                   EVAL      SDATA = TXT(103)
     C                   CAT       ADR3:0        SDATA
     C                   CAT       TXT(104):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        POSTNR <> 0
     C                   EVAL      SDATA = TXT(105)
     C                   MOVE      POSTNR        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   WRITE     EDISER
     C                   ELSE
     C                   IF        SYPOGE <> *BLANKS
     C                   EVAL      SDATA = TXT(105)
     C                   CAT       SYPOGE:0      SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   END
     C                   EVAL      SDATA = TXT(107)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       FILAND:0      SDATA
     C                   ELSE
     C                   CAT       SYLAND:0      SDATA
     C                   END
     C                   CAT       TXT(108):0    SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(98)
     C                   WRITE     EDISER
      * Invoicee slutt
     C                   EVAL      SDATA = TXT(110)
     C                   WRITE     EDISER
      * Supplier start
     C                   EVAL      SDATA = TXT(111)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(95)
     C                   CAT       HENAS:0       SDATA
     C                   CAT       TXT(96):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(97)
     C                   WRITE     EDISER
     C                   IF        HEADS1 <> *BLANKS
     C                   EVAL      SDATA = TXT(99)
     C                   CAT       HEADS1:0      SDATA
     C                   CAT       TXT(100):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        HEADS2 <> *BLANKS
     C                   EVAL      SDATA = TXT(101)
     C                   CAT       HEADS2:0      SDATA
     C                   CAT       TXT(102):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        HEADS3 <> *BLANKS
     C                   EVAL      SDATA = TXT(103)
     C                   CAT       HEADS3:0      SDATA
     C                   CAT       TXT(104):0    SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(105)
     C                   MOVEL     HEADS3        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   EVAL      SDATA = TXT(98)
     C                   WRITE     EDISER
      * Supplier slutt
     C                   EVAL      SDATA = TXT(112)
     C                   WRITE     EDISER
      * Buyer start
     C                   EVAL      SDATA = TXT(113)
     C                   WRITE     EDISER
      *
     C                   EVAL      SDATA = TXT(95)
     C                   CAT       HENAK:0       SDATA
     C                   CAT       TXT(96):0     SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(97)
     C                   WRITE     EDISER
     C                   IF        HEADK1 <> *BLANKS
     C                   EVAL      SDATA = TXT(99)
     C                   CAT       HEADK1:0      SDATA
     C                   CAT       TXT(100):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        HEADK2 <> *BLANKS
     C                   EVAL      SDATA = TXT(101)
     C                   CAT       HEADK2:0      SDATA
     C                   CAT       TXT(102):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   IF        HEADK3 <> *BLANKS
     C                   EVAL      SDATA = TXT(103)
     C                   CAT       HEADK3:0      SDATA
     C                   CAT       TXT(104):0    SDATA
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(105)
     C                   MOVEL     HEADK3        XXA04             4
     C                   CAT       XXA04:0       SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   WRITE     EDISER
     C                   END
     C                   EVAL      SDATA = TXT(98)
     C                   WRITE     EDISER
      * Buyer slutt
     C                   EVAL      SDATA = TXT(114)
     C                   WRITE     EDISER
      * Parties slutt
     C                   EVAL      SDATA = TXT(74)
     C                   WRITE     EDISER
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSUM         BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
      * Summary start
     C                   EVAL      SDATA = TXT(115)
     C                   WRITE     EDISER
      *
     C                   MOVE      *ZEROS        XXMVAT           13 2
     C     1             DO        11            XN01              3 0
     C                   IF        XMLT1(XN01) > 0
     C                   IF        XMLT2(XN01) = *BLANKS
     C                   EVAL      XMLT2(XN01) = FICURR
     C                   END
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT3(XN01)/100
     C                   ELSE
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT4(XN01)/100
     C                   END
     C                   END
     C                   ENDDO
      * Taxes start
     C                   EVAL      SDATA = TXT(117)
     C                   WRITE     EDISER
      *
     C                   MOVE      *ZEROS        XXMVA            13 2
     C     1             DO        11            XN01
     C                   IF        XMLT1(XN01) > 0
      * Tax start
     C                   EVAL      SDATA = TXT(119)
     C                   WRITE     EDISER
      * TaxType
     C                   EVAL      SDATA = TXT(121)
     C                   CAT       'MVA':0       SDATA
     C                   CAT       TXT(122):0    SDATA
     C                   WRITE     EDISER
      * TaxBase
     C                   EVAL      SDATA = TXT(123)
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL      ØN152 = XMLT3(XN01)
     C                   ELSE
     C                   EVAL      ØN152 = XMLT4(XN01)
     C                   END
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(124):0    SDATA
     C                   WRITE     EDISER
      * TaxPercent
     C                   EVAL      SDATA = TXT(125)
     C                   EVAL      ØN152 = XMLT1(XN01)
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(126):0    SDATA
     C                   WRITE     EDISER
      * TaxAmount
     C                   EVAL      SDATA = TXT(127)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XMLT2(XN01):0 SDATA
     C                   CAT       '">':0        SDATA
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL      ØN152 = XMLT3(XN01) * XMLT1(XN01) / 100
     C                   ELSE
     C                   EVAL      ØN152 = XMLT4(XN01) * XMLT1(XN01) / 100
     C                   END
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(128):0    SDATA
     C                   WRITE     EDISER
      * Tax slutt
     C                   EVAL      SDATA = TXT(120)
     C                   WRITE     EDISER
      *
     C                   END
     C                   ENDDO
      * TotalTax
     C                   EVAL      SDATA = TXT(129)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXMVAT
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(130):0    SDATA
     C                   WRITE     EDISER
      * TotalExclTaxes
     C                   EVAL      SDATA = TXT(131)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XFTOT - XXMVAT
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(132):0    SDATA
     C                   WRITE     EDISER
      * TotalInclTax
     C                   EVAL      SDATA = TXT(133)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       XFVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XFTOT
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(134):0    SDATA
     C                   WRITE     EDISER
      * Taxes slutt
     C                   EVAL      SDATA = TXT(118)
     C                   WRITE     EDISER
      * Summary slutt
     C                   EVAL      SDATA = TXT(116)
     C                   WRITE     EDISER
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRDET         BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
     C                   MOVE      *ZEROS        XXBEL            13 2
      * Details start
     C                   EVAL      SDATA = TXT(135)
     C                   WRITE     EDISER
      * DetailNumber
     C                   EVAL      SDATA = TXT(137)
     C                   CAT       '1':0         SDATA
     C                   CAT       TXT(138):0    SDATA
     C                   WRITE     EDISER
      *
     C                   MOVE      *ZEROS        XXLINNR           5 0
     C     STLIN         TAG
      * LineDetails start
     C                   EVAL      SDATA = TXT(139)
     C                   WRITE     EDISER
      * LineNumber
     C                   EVAL      SDATA = TXT(141)
     C                   ADD       1             XXLINNR
     C                   EVAL      ØN152 = XXLINNR
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(142):0    SDATA
     C                   WRITE     EDISER
      * ProductDetails start
     C                   EVAL      SDATA = TXT(143)
     C                   WRITE     EDISER
      * SupplierProductCode
     C                   EVAL      SDATA = TXT(145)
     C                   CAT       FAVK:0        SDATA
     C                   CAT       TXT(146):0    SDATA
     C                   WRITE     EDISER
      * SupplierProductText
     C                   EVAL      SDATA = TXT(147)
     C                   CAT       FAVT:0        SDATA
     C     KODTGEK       CHAIN     KODTGE                             33
     C     KODTG2K       CHAIN     KODTG2                             33
     C                   IF        FAVT <> *BLANKS
     C                   CAT       ',':0         SDATA
     C                   END
     C                   SELECT
     C                   WHEN      SPRAAK = 'E'
     C                   CAT       KGEENT:0      SDATA
     C                   WHEN      SPRAAK = 'T'
     C                   CAT       KG2TYT:0      SDATA
     C                   OTHER
     C                   CAT       KGENOT:0      SDATA
     C                   ENDSL
     C                   CAT       TXT(148):0    SDATA
     C                   WRITE     EDISER
      * ProductDetails slutt
     C                   EVAL      SDATA = TXT(144)
     C                   WRITE     EDISER
      * Quantities start
     C                   EVAL      SDATA = TXT(149)
     C                   WRITE     EDISER
      * QuantitiyOrdered
     C                   EVAL      SDATA = TXT(151)
     C                   CAT       'qtyType="':1 SDATA
     C                   CAT       'PCE">1':0    SDATA
     C                   CAT       TXT(152):0    SDATA
     C                   WRITE     EDISER
      * QuantitiyDeliveried
     C                   EVAL      SDATA = TXT(153)
     C                   CAT       'qtyType="':1 SDATA
     C                   CAT       'PCE">1':0    SDATA
     C                   CAT       TXT(154):0    SDATA
     C                   WRITE     EDISER
      * Quantities slutt
     C                   EVAL      SDATA = TXT(150)
     C                   WRITE     EDISER
      * LineDates start
     C                   EVAL      SDATA = TXT(155)
     C                   WRITE     EDISER
      * OtherDates start
     C                   EVAL      SDATA = TXT(157)
     C                   WRITE     EDISER
     C                   EVAL      SDATA = TXT(19)
     C                   CAT       'type="':1    SDATA
     C                   SELECT
     C                   WHEN      SPRAAK = 'E'
     C                   CAT       'OrderDate"':0SDATA
     C                   WHEN      SPRAAK = 'T'
     C                   CAT       'AuftragDat':0SDATA
     C                   CAT       'm"':0        SDATA
     C                   OTHER
     C                   CAT       'OppdragDat':0SDATA
     C                   CAT       'o"':0        SDATA
     C                   ENDSL
     C                   CAT       'year="':1    SDATA
     C                   CAT       HEDTOPÅ:0     SDATA
     C                   CAT       '" month="':0 SDATA
     C                   CAT       HEDTOPM:0     SDATA
     C                   CAT       '" day="':0   SDATA
     C                   CAT       HEDTOPD:0     SDATA
     C                   CAT       '">':0        SDATA
     C                   CAT       HEDTOPÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       HEDTOPM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       HEDTOPD:0     SDATA
     C                   CAT       TXT(20):0     SDATA
     C                   WRITE     EDISER
      * OtherDates slutt
     C                   EVAL      SDATA = TXT(158)
     C                   WRITE     EDISER
      * LineDates slutt
     C                   EVAL      SDATA = TXT(156)
     C                   WRITE     EDISER
      * LineReference start
     C                   EVAL      SDATA = TXT(159)
     C                   WRITE     EDISER
      * OtherReference start
     C                   EVAL      SDATA = TXT(161)
     C                   WRITE     EDISER
      * Reference
     C                   EVAL      SDATA = TXT(163)
     C                   CAT       'type="Our':1 SDATA
     C                   CAT       'Reference"':0SDATA
     C                   CAT       '>':0         SDATA
     C                   CAT       SYSPEDREF:0   SDATA
     C                   CAT       TXT(164):0    SDATA
     C                   WRITE     EDISER
      * OtherReference slutt
     C                   EVAL      SDATA = TXT(162)
     C                   WRITE     EDISER
      * LineReference slutt
     C                   EVAL      SDATA = TXT(160)
     C                   WRITE     EDISER
      * PriceDetails start
     C                   EVAL      SDATA = TXT(165)
     C                   WRITE     EDISER
     C                   IF        FAVAL = FICURR
     C                   EVAL      XXBEL = FABELN
     C                   ELSE
     C                   EVAL      XXBEL = FABELV
     C                   END
      * Price
     C*                  EVAL      SDATA = TXT(167)
     C*                  CAT       'type="NET"':1SDATA
     C*                  CAT       '>':0         SDATA
     C*                  EVAL      ØN152 = XXBEL
     C*                  EXSR      SRNE
     C*                  CAT       ØAN:0         SDATA
     C*                  CAT       TXT(168):0    SDATA
     C*                  WRITE     EDISER
      *
     C                   IF        FAKDM <> 'N'
      * LineTotTaxBase
     C                   EVAL      SDATA = TXT(169)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXBEL
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(170):0    SDATA
     C                   WRITE     EDISER
      * TaxPercent
     C                   EVAL      SDATA = TXT(171)
     C                   IF        FAKDM = 'J'
     C                   EVAL      MVAAVI = FITAX * 100
     C                   ELSE
     C     KODWL01K      CHAIN     KODWL01                            33
     C   33              EVAL      MVAAVI = 0
     C                   END
     C                   EVAL      ØN152 = MVAAVI
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(172):0    SDATA
     C                   WRITE     EDISER
      * LineTotTax
     C                   EVAL      SDATA = TXT(173)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      XXMVA = XXBEL * MVAAVI / 100
     C                   EVAL      ØN152 = XXMVA
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(174):0    SDATA
     C                   WRITE     EDISER
      *
     C                   ELSE
     C                   EVAL      XXMVA = 0
     C                   END
      * LineTotExclTax
     C                   EVAL      SDATA = TXT(175)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXBEL
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(176):0    SDATA
     C                   WRITE     EDISER
      * LineTotInclTax
     C                   EVAL      SDATA = TXT(177)
     C                   CAT       'currencyId':1SDATA
     C                   CAT       '="':0        SDATA
     C                   CAT       FAVAL:0       SDATA
     C                   CAT       '">':0        SDATA
     C                   EVAL      ØN152 = XXBEL + XXMVA
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(178):0    SDATA
     C                   WRITE     EDISER
      * PriceDetails slutt
     C                   EVAL      SDATA = TXT(166)
     C                   WRITE     EDISER
      * LineDetails slutt
     C                   EVAL      SDATA = TXT(140)
     C                   WRITE     EDISER
     C     FAK8K         READE     FAK8                                   33
     C  N33              GOTO      STLIN
      * Details slutt
     C                   EVAL      SDATA = TXT(136)
     C                   WRITE     EDISER
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSLUTT       BEGSR
      ***********************************************
      * PostenInterChange
     C                   EVAL      SDATA = TXT(03)
     C                   WRITE     EDISER
      *
      * Oppdater EDIS
     C                   WRITE     EDISR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRCLOSE       BEGSR
      ***********************************************
     C                   CLOSE     ECMSG
     C                   CLOSE     KODWL01
     C                   CLOSE     KODTA
     C                   CLOSE     KODTGE
     C                   CLOSE     KODTG2
     C                   CLOSE     KODTSF
     C                   CLOSE     CUNDL01
     C                   CLOSE     FAIN
     C                   CLOSE     HEADF
     C                   CLOSE     FAK8
     C                   CLOSE     EDIC
     C                   CLOSE     EDIS
     C                   CLOSE     EDIM
     C                   CLOSE     EDISE1K
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDEDIM       BEGSR
      ***********************************************
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EVAL      M0004 = S0004
     C                   EVAL      M0010 = S0010
     C                   MOVEL     CMN           M0062
     C                   EVAL      M0065 = 'INVXML'
     C                   MOVEL     XFFN          M0068
     C                   IF        XFFK = 'F'
     C                   MOVEL     '380'         M1001
     C                   ELSE
     C                   MOVEL     '381'         M1001
     C                   END
     C                   MOVEL     XFFN          M1004
     C                   EVAL      MSN = SSN
     C                   EVAL      MMN = CMN
     C                   EVAL      MSR = 'S'
     C                   EVAL      MST = 'C'
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   WRITE     EDIMR
      *
     C                   EVAL      S0036 = S0036 + 1
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
     C                   IF        ØN152 < 0
     C                   MOVE      '-'           XAN01             1
     C                   Z-SUB     ØN152         ØN152
     C                   ELSE
     C                   MOVE      ' '           XAN01
     C                   END
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      '.  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       XXA12            12
     C     Ø12(ØX)       IFEQ      '.'
     C                   SUB       1             ØX
     C                   END
     C                   MOVEA     Ø12(ØX)       XXA12
     C                   IF        XAN01 = '-'
     C                   EVAL      ØAN = XAN01
     C                   CAT       XXA12:0       ØAN
     C                   ELSE
     C                   EVAL      ØAN = XXA12
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     XMLUFL1K      KLIST
     C                   KFLD                    XXST
     C                   KFLD                    FIFIRM
     C     ECMSGK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    XFKN
     C                   KFLD                    ECSR
     C                   KFLD                    EC0065
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     FAK8K         KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C                   KFLD                    FIFN
     C     KODWL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    MOMSTW
     C                   KFLD                    FAKDM
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    FIAVD
     C     KODTGEK       KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    FAVK
     C     KODTG2K       KLIST
     C                   KFLD                    KG2UNI
     C                   KFLD                    FAVK
     C     KODTSFK       KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    HESG
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVE      ' '           XXST              1
     C                   MOVE      'A'           KOAUNI
     C                   MOVEL     'GE'          KGEUNI
     C                   MOVEL     'G2'          KG2UNI
     C                   MOVEL     'SF'          KOSFUN
     C                   MOVEL     'S'           ECSR
     C                   MOVEL     'INVXML'      EC0065
     C                   MOVE      '/'           XXSTREKK1
     C                   MOVE      '/'           XXSTREKK2
      *
     C                   ENDSR
      *
** TXT
<?xml version="1.0" encoding="ISO-8859-1" ?>                                    001
<PostenInterchange                                                              002
</PostenInterchange>                                                            003
<InterchangeType>PostenInterchange</InterchangeType>                            004
<Version>1.4-rev3</Version>                                                     005
<Originator>                                                                    006
</Originator>                                                                   007
<Address>                                                                       008
</Address>                                                                      009
<SubAddress/>                                                                   010
<AddressQualifier>                                                              011
</AddressQualifier>                                                             012
<Recipient>                                                                     013
</Recipient>                                                                    014
<InterchangeId>                                                                 015
</InterchangeId>                                                                016
<InterchangeTime>                                                               017
</InterchangeTime>                                                              018
<Date                                                                           019
</Date>                                                                         020
<Time                                                                           021
</Time>                                                                         022
<eMessage>                                                                      023
</eMessage>                                                                     024
<MessageType>                                                                   025
</MessageType>                                                                  026
<MessageVersion>                                                                027
</MessageVersion>                                                               028
<DocumentType>                                                                  029
</DocumentType>                                                                 030
<DocumentCode>                                                                  031
</DocumentCode>                                                                 032
<DocumentDescriptiveName>                                                       033
</DocumentDescriptiveName>                                                      034
<MessageReference>                                                              035
</MessageReference>                                                             036
<MessageOriginator>                                                             037
</MessageOriginator>                                                            038
<MessageRecipient>                                                              039
</MessageRecipient>                                                             040
<MessageContent>                                                                041
</MessageContent>                                                               042
<Invoice>                                                                       043
</Invoice>                                                                      044
<InvoiceDates>                                                                  045
</InvoiceDates>                                                                 046
<InvoiceDate                                                                    047
</InvoiceDate>                                                                  048
<DueDate                                                                        049
</DueDate>                                                                      050
<InvoiceReferences>                                                             051
</InvoiceReferences>                                                            052
<InvoiceNo>                                                                     053
</InvoiceNo>                                                                    054
<PaymentInfo>                                                                   055
</PaymentInfo>                                                                  056
<PaymentTermsCode>                                                              057
</PaymentTermsCode>                                                             058
<PaymentTermsText>                                                              059
</PaymentTermsText>                                                             060
<PaymentAccountInfo>                                                            061
</PaymentAccountInfo>                                                           062
<AccountNumber>                                                                 063
</AccountNumber>                                                                064
<PaymentDueDate                                                                 065
</PaymentDueDate>                                                               066
<PaymentAmount                                                                  067
</PaymentAmount>                                                                068
<KID>                                                                           069
</KID>                                                                          070
<CheckDigit>                                                                    071
</CheckDigit>                                                                   072
<Parties>                                                                       073
</Parties>                                                                      074
<Invoicer>                                                                      075
</Invoicer>                                                                     076
<Contact>                                                                       077
</Contact>                                                                      078
<Reference>                                                                     079
</Reference>                                                                    080
<Email>                                                                         081
</Email>                                                                        082
<Phone>                                                                         083
</Phone>                                                                        084
<Fax>                                                                           085
</Fax>                                                                          086
<WebAddress>                                                                    087
</WebAddress>                                                                   088
<Identifications>                                                               089
</Identifications>                                                              090
<CompanyRegNo>                                                                  091
</CompanyRegNo>                                                                 092
<CompanyVATNo>                                                                  093
</CompanyVATNo>                                                                 094
<Name>                                                                          095
</Name>                                                                         096
<PostalAddress>                                                                 097
</PostalAddress>                                                                098
<Address1>                                                                      099
</Address1>                                                                     100
<Address2>                                                                      101
</Address2>                                                                     102
<City>                                                                          103
</City>                                                                         104
<PostCode>                                                                      105
</PostCode>                                                                     106
<CountryCode>                                                                   107
</CountryCode>                                                                  108
<Invoicee>                                                                      109
</Invoicee>                                                                     110
<Supplier>                                                                      111
</Supplier>                                                                     112
<Buyer>                                                                         113
</Buyer>                                                                        114
<Summary>                                                                       115
</Summary>                                                                      116
<Taxes>                                                                         117
</Taxes>                                                                        118
<Tax>                                                                           119
</Tax>                                                                          120
<TaxType>                                                                       121
</TaxType>                                                                      122
<TaxBase>                                                                       123
</TaxBase>                                                                      124
<TaxPercent>                                                                    125
</TaxPercent>                                                                   126
<TaxAmount                                                                      127
</TaxAmount>                                                                    128
<TotalTax                                                                       129
</TotalTax>                                                                     130
<TotalExclTax                                                                   131
</TotalExclTax>                                                                 132
<TotalInclTax                                                                   133
</TotalInclTax>                                                                 134
<Details>                                                                       135
</Details>                                                                      136
<DetailNumber>                                                                  137
</DetailNumber>                                                                 138
<LineDetails>                                                                   139
</LineDetails>                                                                  140
<LineNumber>                                                                    141
</LineNumber>                                                                   142
<ProductDetails>                                                                143
</ProductDetails>                                                               144
<SupplierProductCode>                                                           145
</SupplierProductCode>                                                          146
<SupplierProductText>                                                           147
</SupplierProductText>                                                          148
<Quantities>                                                                    149
</Quantities>                                                                   150
<QuantityOrdered                                                                151
</QuantityOrdered>                                                              152
<QuantityDelivered                                                              153
</QuantityDelivered>                                                            154
<LineDates>                                                                     155
</LineDates>                                                                    156
<OtherDates>                                                                    157
</OtherDates>                                                                   158
<LineReference>                                                                 159
</LineReference>                                                                160
<OtherReference>                                                                161
</OtherReference>                                                               162
<Reference                                                                      163
</Reference>                                                                    164
<PriceDetails>                                                                  165
</PriceDetails>                                                                 166
<Price                                                                          167
</Price>                                                                        168
<LineTotalTaxBase                                                               169
</LineTotalTaxBase>                                                             170
<TaxPercent>                                                                    171
</TaxPercent>                                                                   172
<LineTotTax                                                                     173
</LineTotTax>                                                                   174
<LineTotExclTax                                                                 175
</LineTotExclTax>                                                               176
<LineTotInclTax                                                                 177
</LineTotInclTax>                                                               178
** TXT01
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"                          001
 xsi:noNamespaceSchemaLocation="D:\Bruker\Dok\Format\PostenInterchange-Complete-002
PS14C-rev3.xsd">                                                                003
