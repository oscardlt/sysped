     FFIRM      IF   E           K DISK
     FISOF      UP   E             DISK
     FTELLGE    UF A E           K DISK
     FFAK9      IF   E           K DISK
     FV10FNF    UF   E           K DISK
     D                UDS
     D  UDRIFT               301    301
      *
     C                   IF        XINIT <> 'J'
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   IF        FIFT = 'NORSK TRAILER EXPRESS A/S'
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
     C                   EVAL      FNFN = 'ISOF'
     C     FNFN          CHAIN(N)  V10FNF                             33
     C                   IF        UDRIFT = 'J'
     C                   IF        FNST = 'J'
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
     C                   ELSE
     C                   IF        FNHST = 'J'
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
     C                   END
     C                   MOVE      'J'           XINIT             1
     C                   END
      *
     C                   IF        XSAKSNR = 0
     C                   Z-ADD     500000        XSAKSNR
     C                   END
      *
     C                   IF        ISSAKN = 0
     C                   ADD       1             XSAKSNR           7 0
     C                   MOVE      XSAKSNR       ISSAKN
     C                   MOVE      'M'           ISRM
     C                   ELSE
     C                   IF        ISSAKN > XSAKSNR
     C                   MOVE      ISSAKN        XSAKSNR
     C                   END
     C                   END
      *
     C                   IF        ((ISFN <> 0) AND (ISFKN = 0))
     C     ISFN          CHAIN     FAK9                               33
     C  N33              EVAL      ISFKN = FAKUNR
     C                   END
      *
     C                   UPDATE    ISOFR
      *
     CLR                 EXSR      OPDFIL
      *
      ***********************************************
     C     OPDFIL        BEGSR
      ***********************************************
     C                   IF        FIFT <> 'NORSK TRAILER EXPRESS A/S'
     C     'ISOSAKSN'    CHAIN     TELLGE                             33
     C                   IF        XSAKSNR > 1000000
     C                   MOVE      XSAKSNR       GENO
     C                   ELSE
     C                   Z-ADD     1000001       GENO
     C                   END
     C                   IF        *IN33
     C                   EVAL      GECO = 'ISOSAKSN'
     C                   WRITE     TELLGER
     C                   ELSE
     C                   UPDATE    TELLGER
     C                   END
     C                   END
      *
     C     FNFN          CHAIN     V10FNF                             33
     C  N33              IF        UDRIFT = 'J'
     C                   MOVE      'J'           FNST
     C                   ELSE
     C                   MOVE      'N'           FNHST
     C                   END
     C  N33              UPDATE    V10FNFR
      *
     C                   ENDSR
      *
