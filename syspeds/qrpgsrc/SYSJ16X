********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 F12 = AVBRYT
********************************************************************
      *
      *****************************************************************
      * PROGRAM FOR Å TASTE COVERPAGE PÅ FAXSENDINGER               ***
      *****************************************************************
      *
     FFIRM      IF   E           K DISK
     FFAXLK     IF   E           K DISK
     FCUNDL01   UF   E           K DISK
     FKUNDL01   UF   E           K DISK
     F                                     RENAME(KUNDR:KUNDR2)
     FCUNDC     IF   E             DISK
     FSYSJ16FX  CF   E             WORKSTN
     D F4              S             75    DIM(12)
     D                 DS
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     D                 DS
     D  WSCVP1                 1     40
     D  WSCVP2                41     80
     D  WSCVP3                81    120
     D  WSCVP4               121    160
     D  WSCVP5               161    200
     D  WSCVP6               201    240
     D  WSCVP7               241    280
     D  WSCVP8               281    320
     D  WSCP1                  1    160
     D  WSCP2                161    320
     D  WSCNV                 41     70
     D  WSCAD1                81    110
     D  WSCAD2               121    150
     D  WSCAD3               161    190
     D  WSCATT               201    230
     D                 DS
     D  WSCF01                 1     75
     D  WSCF02                76    150
     D  WSCF03               151    225
     D  WSCF04               226    300
     D  WSCF05               301    375
     D  WSCF06               376    450
     D  WSCF07               451    525
     D  WSCF08               526    600
     D  WSCF09               601    675
     D  WSCF10               676    750
     D  WSCF11               751    825
     D  WSCF12               826    900
     D  F5                     1    900
     D                                     DIM(12)
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  XFAXN                  1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  WSFAXN                 1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     IKUNDR
     I              BANKG                       SYBAGI
     I              POSTG                       SYPOGI
      *
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
      *
     C     *ENTRY        PLIST
     C                   PARM                    UKN               8 0
     C     XFAXN         PARM      XFAXN         UFAXN            21
     C     WSCP1         PARM      WSCP1         UCVP1           160
     C     WSCP2         PARM      WSCP2         UCVP2           160
     C                   PARM                    UFAX              1
     C                   PARM                    UCVP              1
     C                   PARM                    UFAXTY            7
     C                   PARM                    EPOSTJ            1
     C                   PARM                    EPOST            70
     C                   PARM                    F4
N01  C                   PARM                    UFLAGG            1
      *
N01  C                   MOVE      ' '           UFLAGG
     C                   MOVE      *BLANKS       F5
     C                   MOVE      UKN           KUNDNR
     C                   READ      FIRM                                   33
     C     KUND1K        CHAIN(N)  CUNDL01                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      TFAXNR        WSFAXN
     C     SYLAND        IFNE      FILAND
     C                   MOVE      SYLAND        WSLAND
     C                   END
     C                   MOVEL     SYEPOS        EPOST
     C                   ELSE
     C                   MOVE      *BLANKS       WSFAXN
     C                   MOVEL     WSCVP2        KNAVN
     C                   END
      *
     C     UCVP          COMP      'J'                                    27
      *
     C     START         TAG
     C     UFAXTY        IFEQ      'FAXMILE'
     C                   EXFMT     BILDE01
     C                   ELSE
     C                   EXFMT     BILDE02
     C                   END
N01  C   12              MOVE      '1'           UFLAGG
N01  C   12              GOTO      SLUTT
      *
     C   04              DO
     C                   MOVE      *BLANKS       EPOFAX            1
     C     LO:UP         XLATE     EPOST         USOK
     C                   CALL      'VCUNDC2R'
     C                   PARM                    FIFIRM
     C                   PARM                    USOK             30
     C                   PARM                    URRN2            10 0
     C                   PARM                    PARMAX            1
     C                   MOVE      URRN2         RRN              10 0
     C     RRN           CHAIN     CUNDC                              33
     C  N33              DO
     C     EPOFAX        IFNE      'E'
     C                   MOVEL     CFAX          WSFAXN
     C                   ELSE
     C                   MOVE      *BLANKS       WSFAXN
     C                   END
     C     EPOFAX        IFNE      'F'
     C                   MOVEL     CEMAIL        EPOST
     C                   ELSE
     C                   MOVE      *BLANKS       EPOST
     C                   END
     C                   MOVE      CCOMPN        KUNDNR
     C                   END
     C                   GOTO      START
     C                   END
     C                   MOVE      '0'           *IN99
      *
     C     EPOST         IFEQ      *BLANKS
     C     WSFAXN        COMP      *BLANKS                                99
     C     *IN99         CABEQ     '1'           START
     C                   MOVE      *BLANKS       XFAXN
     C                   MOVEL     WSFAXN        XFAXN
     C                   MOVE      *BLANKS       FAXRET
     C     WSLAND        IFNE      *BLANKS
     C     WSLAND        CHAIN     FAXLK                              33
     C  N33FAX05A        CASNE     FAX05B        FAXFIX
     C                   ENDCS
     C                   END
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      WSFAXN        TFAXNR
     C  N33              EXCEPT    UPD
     C     KUND1K        CHAIN     KUNDL01                            33
     C  N33              MOVE      WSFAXN        TFAXNR
     C  N33              EXCEPT    UPD2
     C                   MOVE      'N'           EPOSTJ
     C                   ELSE
     C                   MOVE      'J'           EPOSTJ
     C                   MOVE      *BLANKS       WSFAXN
     C     *IN27         IFEQ      '1'
     C     *IN05         IFEQ      '1'
     C     *IN17         OREQ      '1'
     C                   CALL      'EPOCVP'
     C                   PARM                    WSCVP1
     C                   PARM                    WSCVP2
     C                   PARM                    WSCVP3
     C                   PARM                    WSCVP4
     C                   PARM                    WSCVP5
     C                   PARM                    WSCVP6
     C                   PARM                    WSCVP7
     C                   PARM                    WSCVP8
     C                   PARM                    FUNK              1
     C     FUNK          CABEQ     'A'           START
     C                   END
     C                   END
     C                   END
      *
     C     *IN05         IFEQ      '0'
     C     *IN17         ANDEQ     '0'
     C                   GOTO      START
     C                   END
     C                   MOVE      '.'           F5(12)
     C                   MOVEA     F5            F4
     C     *IN17         IFEQ      '1'
     C                   MOVE      'N'           UCVP
     C                   END
      *
N01  C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
      *
     OKUNDR     E            UPD
     O                       TFAXNR
     OKUNDR2    E            UPD2
     O                       TFAXNR
