********************************************************************
      * PROGRAM FOR PRINT AV ORDRE:
********************************************************************
      *
      *
     FFIRM      IF   E           K DISK
     FGSSORF    IF   E           K DISK
     FGSSPOF    IF   E           K DISK
     FGSSPAF    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FGSSSFF    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FGSS043P   O    E             PRINTER
     D                 DS
     D  ORDTLÅ                 1      4
     D  ORDTLM                 5      6
     D  ORDTLD                 7      8
     D  ORDTL                  1      8  0
     D                 DS
     D  ORDT2Å                 1      4
     D  ORDT2M                 5      6
     D  ORDT2D                 7      8
     D  ORDTL2                 1      8  0
     D                 DS
     D  ORDT3Å                 1      4
     D  ORDT3M                 5      6
     D  ORDT3D                 7      8
     D  ORDTL3                 1      8  0
     D                 DS
     D  ORDTWÅ                 1      4  0
     D  ORDTWM                 5      6  0
     D  ORDTWD                 7      8  0
     D  ORDTWL                 1      8  0
     D                 DS
     D  ORDTRÅ                 1      4
     D  ORDTRM                 5      6
     D  ORDTRD                 7      8
     D  ORDTR                  1      8  0
     D                 DS
     D  POLNO                  1      2  0
     D  XLN                    1      2  0
     D                 DS
     D  PRCON1                 1     20
     D  PRCON2                21     40
     D  PRCON3                41     60
     D  PRCON4                61     80
     D  PRCON5                81    100
     D  PRCON6               101    120
     D  PO                     1   1000    DIM(50)
     D                SDS
     D  UUSR                 254    263
     D*
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D*
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     DPHEAD            C                   CONST('Order entered by:')
     D*
      *
     C                   EXSR      INIT
      *
     C                   EXSR      GETORD
      *
      * skriver eventuellt logo
      *
      *
      * skriver heading
      *
     C     pdata         CAT       phead:0       pdata
     C     pdata         CAT       fift:1        pdata
     c                   write     pdet
     c                   move      *blanks       pdata
      *
      * skriver PO nummere
      *
     c                   movel     'P.O Nbrs:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     c     pdata         cat       PRCON1:2      pdata
     C     pdata         CAT       ',':2         pdata
     c     prcon2        ifne      *blank
     C     pdata         CAT       PRCON2:2      pdata
     C     pdata         CAT       ',':2         pdata
     c                   end
     c     prcon3        ifne      *blank
     c     pdata         cat       prcon3:2      pdata
     c     pdata         cat       ',':2         pdata
     c                   end
     c     prcon4        ifne      *blank
     c     pdata         cat       prcon4:2      pdata
     c     pdata         cat       ',':2         pdata
     c                   end
     c     prcon5        ifne      *blank
     c     pdata         cat       prcon5:2      pdata
     c     pdata         cat       ',':2         pdata
     c                   end
     c     prcon6        ifne      *blank
     c     pdata         cat       prcon6:2      pdata
     c     pdata         cat       ',':2         pdata
     c                   end
      *
     C     7             DO        50            XN                3 0
     C                   IF        PO(XN) <> *BLANKS
     C                   cat       PO(XN):2      pdata
     C                   cat       ',':2         pdata
     C                   END
     C                   ENDDO
      *
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      * skriver Wessel
      *
     c                   movel     'Vessel..:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C                   movel     '('           pdata
     c     pdata         cat       ORBCD:0       pdata
     C     pdata         CAT       ')':0         pdata
     C     pdata         CAT       CBNAB:2       pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      * linje med delivery dates
      *
     c                   movel     'Del.date:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C     pdata         CAT       ordtld:1      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordtlm:0      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordtlÅ:0      pdata
     c     ordt2d        ifne      '00'
     C     pdata         CAT       ',':2         pdata
     C     pdata         CAT       ordt2d:2      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordt2m:0      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordt2Å:0      pdata
     c                   end
     c     ordt3d        ifne      '00'
     C     pdata         CAT       ',':2         pdata
     C     pdata         CAT       ordt3d:2      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordt3m:0      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordt3Å:0      pdata
     c                   end
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      * linje med clients
      *
     c                   movel     'Client:.:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     c     pdata         cat       KNAVN:2       pdata
     C     pdata         CAT       ',':2         pdata
     c     adr1          ifne      *blank
     C     pdata         CAT       ADR1:2        pdata
     C     pdata         CAT       ',':2         pdata
     c                   end
     c     adr2          ifne      *blank
     c     pdata         cat       ADR2:2        pdata
     c     pdata         cat       ',':2         pdata
     c                   end
     c                   move      postnr        postnra           4
     c     pdata         cat       POSTNRA:1     pdata
     C     pdata         CAT       ADR3:1        pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      * linje med supplier
      *
     c                   movel     'Supplier:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     c     pdata         cat       SFNM:2        pdata
     C     pdata         CAT       ',':2         pdata
     c     sfad1         ifne      *blanks
     C     pdata         CAT       SFAD1:2       pdata
     C     pdata         CAT       ',':2         pdata
     c                   end
     c     sfad2         ifne      *blanks
     c     pdata         CAT       SFAD2:2       pdata
     C     pdata         CAT       ',':2         pdata
     c                   end
     c     pdata         cat       SFAD3:2       pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      * linje med phone og fax
      *
     c     sftel         ifne      *blanks
     c     sffax         orne      *blanks
     c                   movel     'Phone...:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     c     sftel         ifne      *blanks
     C     pdata         CAT       SFTEL:2       pdata
     C     pdata         CAT       ',':2         pdata
     c                   end
     c     sffax         ifne      *blanks
     C     pdata         CAT       'Fax:':2      pdata
     C     pdata         CAT       SFFAX:2       pdata
     c                   end
     c                   write     pdet
     c                   move      *blanks       pdata
     c                   end
      *
      * linje med goodsinfo
      *
     c                   movel     'Goods...:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     c*
     C                   Z-ADD     orcli         ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:2         pdata
     C     pdata         CAT       'Collies':2   pdata
     C     pdata         CAT       ORDSC:2       pdata
     C                   Z-ADD     orwt          ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:5         pdata
     C     pdata         CAT       'Kiloes':2    pdata
     c     orvol         ifne      *zeros
     C                   Z-ADD     orvol         ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:2         pdata
     C     pdata         CAT       'M3':2        pdata
     c                   end
     c                   write     pdet
     c                   move      *blanks       pdata
      *
      * valu of goods
      *
     c     orcurc        ifne      *blanks
     c                   movel     'Value...:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     c     pdata         cat       ORCURC:2      pdata
     c*
     C                   Z-ADD     oramt         ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:3         pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
     c                   end
      *
      * linje med our refs
      *
     c                   movel     'Our ref.:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C                   Z-ADD     orono         ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:3         pdata
     C     pdata         CAT       'Date:':2     pdata
     C     pdata         CAT       ordtrd:1      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordtrm:0      pdata
     C     pdata         CAT       '/':0         pdata
     C     pdata         CAT       ordtrÅ:0      pdata
     C     pdata         CAT       ',':2         pdata
     C     pdata         CAT       'Tripno:':2   pdata
     C                   Z-ADD     ortno         ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:3         pdata
     C     pdata         CAT       ',':2         pdata
     C                   Z-ADD     ortno2        ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:3         pdata
     C     pdata         CAT       ',':2         pdata
     C                   Z-ADD     ortno3        ØN152
     C                   EXSR      SRNE
     C     pdata         CAT       Øan:3         pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      *
      * linje med location
      *
     c                   movel     'Location:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C     pdata         CAT       orlc:3        pdata
     c     orlc2         ifne      *blanks
     c     pdata         cat       ',':2         pdata
     C     pdata         CAT       orlc2:3       pdata
     c                   end
     c     orlc3         ifne      *blanks
     c     pdata         cat       ',':2         pdata
     C     pdata         CAT       orlc3:3       pdata
     c                   end
     C                   WRITE     pdet
     c                   move      *blanks       pdata
      *
      *
      *
      *
      * linje med fritext
      *
     c     orft1         ifne      *blanks
     c                   movel     'Freetext:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C     pdata         CAT       orft1:3       pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
     c                   end
      *
      *
     c     orft2         ifne      *blanks
     c                   movel     'Freetext:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C     pdata         CAT       orft2:3       pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
     c                   end
      *
      *
     c     orft3         ifne      *blanks
     c                   movel     'Freetext:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C     pdata         CAT       orft3:3       pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
     c                   end
      *
      *
     c     orft4         ifne      *blanks
     c                   movel     'Freetext:'   pdata
     c                   write     pdet
     c                   move      *blanks       pdata
     C     pdata         CAT       orft4:3       pdata
     C                   WRITE     pdet
     c                   move      *blanks       pdata
     c                   end
      *
      *
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *
      *
     C***********************************************
     C     GETORD        BEGSR
     C***********************************************
      *
      * HENTER ORDRE
      *
     C     UONO          CHAIN     GSSORF                             33
      *
      * HENTER KUNDEOPPLYSNINGER
      *
     C     CUND1K        CHAIN     CUNDL01                            33
      *
      * HENTER SUPPLIER
      *
     C     ORSNO         IFNE      *ZEROS
     C     ORSNO         CHAIN     GSSSFF                             70
     C                   ELSE
     C                   MOVE      ORSNM         SFNM
     C                   END
      *
      * HENTER CBNAM
      *
     C     ORBCD         CHAIN     CDBOAT                             33
      *
      * HENTER PATXT / PAPKD
      *
     C     UONO          CHAIN     GSSPAF                             33
      *
      *
      *
      * HENTER REGISTRERTE PO/NR
      *
     C     ORONO         SETLL     GSSPOF                             33
     C     ORONO         READE     GSSPOF                                 33
     C                   MOVE      *BLANKS       PO
     C     *IN33         DOWEQ     '0'
     C                   MOVE      POCONO        PO(XLN)
     C     ORONO         READE     GSSPOF                                 33
     C  N33              END
      *
     C                   ENDSR
      *
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ORCNO
      *
     C     *ENTRY        PLIST
     C                   PARM                    UONOA             7
     C                   MOVE      UONOA         UONO              7 0
      *
     C                   READ      FIRM                                   33
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Leftjustify numerical fields                        SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * MOve correct value into Alfa 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      ',  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C                   END                                                    <-------------I
      * Scan from left and find first num over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
