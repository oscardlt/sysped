********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 YBC PTF12 VIS FRIST OG SEND EPOST
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED EL. TRANSITTERING UT       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-14 17-24             ***
      *** LEDIGE INDIKATORER 31 32 34-39 50-89 95             ***
      ***********************************************************
      *
     FTVINF     O  A E             DISK    USROPN
     FARKIVL15  IF A E           K DISK
     FTRUGH     UF   E           K DISK
     FNCTSEH    IF   E           K DISK
     FNCTSEHOPD UF   E           K DISK    RENAME(NCTSEHR:NCTSEHROPD)
     FNCTSEH01  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR01)
     FNCTSEH02  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR02)
     FNCTSEH03  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR03)
     FNCTSEH04  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR04)
     FNCTSEH05  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR05)
     FNCTSEH07  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR07)
     FNCTSEH08  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR08)
     FNCTSEH09  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR09)
     FNCTSEH11  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR11)
     FNCTSEH12  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR12)
     FNCTSEH13  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR13)
     FNCTSEH14  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR14)
     FNCTSEH15  IF   E           K DISK    RENAME(NCTSEHR:NCTSEHR15)
     FNCTSESTD  IF   E           K DISK
     FFRISOL01  IF   E           K DISK
     FFRISOK    IF   E           K DISK    RENAME(FRISOKR:FRISOKR0)
     FKALENDER  IF   E           K DISK
     FKODTA     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FEDIC      UF   E             DISK
     FEDIM      O  A E           K DISK    USROPN
     FEDIM2     IF   E           K DISK    RENAME(EDIMR:EDIMR2)
     FEDIM4     IF   E           K DISK    RENAME(EDIMR:EDIMR4)
     FFIRM      IF   E           K DISK
     FFREETXT2  UF A E           K DISK
     FSTS       IF A E           K DISK
     FNCTS010D  CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WAFT1                  1     50
     D  WAFT2                 51    100
     D  WAFT3                101    150
     D  WAFT4                151    200
     D  WAFT5                201    250
     D  FT                     1    250    DIM(5)
     D  FT2501                 1    250
     D                 DS
     D  WADT                   1      6  0
     D  WADTD                  1      2  0
     D  WADTM                  3      4  0
     D  WADTA                  5      6  0
     D                 DS
     D  FRTDT                  1      8  0
     D  FRTDTA                 1      4  0
     D  FRTDTM                 5      6  0
     D  FRTDTD                 7      8  0
     D                 DS
     D  XDTDD                  1      2  0
     D  XDTMM                  3      4  0
     D  XDTAA                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTAA2                 1      4  0
     D  XDTMM2                 5      6  0
     D  XDTDD2                 7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTSA                  5      6  0
     D  WSDTS                  1      6  0
     D                 DS
     D  XDTADD                 1      2  0
     D  XDTAMM                 3      4  0
     D  XDTAAA                 5      6  0
     D  WSDTA                  1      6  0
     D                 DS
     D  XDTSA2                 1      4  0
     D  XDTSM2                 5      6  0
     D  XDTSD2                 7      8  0
     D  XDTS                   1      8  0
     D                 DS
     D  XDTAAA2                1      4  0
     D  XDTAMM2                5      6  0
     D  XDTADD2                7      8  0
     D  XDTA                   1      8  0
     D                 DS
     D  XDTKD                  1      2  0
     D  XDTKM                  3      4  0
     D  XDTKA                  5      6  0
     D  WSDTK                  1      6  0
     D                 DS
     D  XDTKA2                 1      4  0
     D  XDTKM2                 5      6  0
     D  XDTKD2                 7      8  0
     D  XDTK                   1      8  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTTA                  5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  XDTTA2                 1      4  0
     D  XDTTM2                 5      6  0
     D  XDTTD2                 7      8  0
     D  XDTT                   1      8  0
     D                 DS
     D  THDTA                  1      4  0
     D  THDTM                  5      6  0
     D  THDTD                  7      8  0
     D  THDT                   1      8  0
     D                 DS
     D  THDDTA                 1      4  0
     D  THDDTM                 5      6  0
     D  THDDTD                 7      8  0
     D  THDDT                  1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTA2                 5      6  0
     D  WSDT2                  1      6  0
S01  D*                DS
S01  D* WSDTD2F                1      2  0
S01  D* WSDTM2F                3      4  0
S01  D* WSDTA2F                5      6  0
S01  D* WSDT2F                 1      6  0
N01  D                 DS
N01  D  WSDDTD                 1      2  0
N01  D  WSDDTM                 3      4  0
N01  D  WSDDTA                 5      6  0
N01  D  WSDDT                  1      6  0
     D                 DS
     D  FSSOK                  1     35
     D  FSSOK17                1     17
     D                 DS
     D  THVKB                  1     13  3
     D  THVKB7                 4     10  0
     D                 DS
     D  XNODI                  1      8
     D  XMMDD                  9     12
     D  XLØPNR                13     18
     D  XMLRN                  1     18
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D                SDS
     D  UUSER                254    263
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     D  VARI           S             30A   VARYING
      *
     C                   EXSR      INIT
     C                   GOTO      START
      *
     C     START0        TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START0
     C                   END
      *
     C                   EXSR      TESTB1
     C   30              GOTO      START0
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        XNAVD             4 0
     C                   MOVE      *ZEROS        XNTDN             7 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C     WSAAVD        IFEQ      0
     C     *IN48         OREQ      *ON
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        19
     C                   ADD       1             ZRECNO
     C                   EXSR      HMLRN
     C  N90              EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECN2            5 0
     C     WSAAVD        IFEQ      0
     C     *IN48         OREQ      *ON
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
     C  N94              END
     C                   END
      *
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C  N27              DO
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
      *** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTNCTSH
     C                   GOTO      START3
     C                   END
     C   08
     COR 12              EXSR      SETCUR
     C   08              GOTO      START0
     C   12              GOTO      START0
     C   15              DO
     C                   CALL      'NCTS014C'
     C                   GOTO      START3
     C                   END
     C   16              DO
     C                   EXSR      CRTNCTS2
     C                   GOTO      START
     C                   END
     C   24              DO
     C                   EXSR      CMDFT2
     C                   GOTO      START3
     C                   END
      *
     C   23              DO
     C     *IN(70)       IFEQ      '0'
     C                   MOVEA     '1'           *IN(70)
     C                   ELSE
     C                   MOVEA     '0'           *IN(70)
     C                   END
     C                   GOTO      START3
     C                   ENDDO
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C     NCTSHKN       CHAIN     NCTSEH                             33
     C   33              DO
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTA         WSDTA2
     C                   END
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2TDN         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2DTT         ORNE      0
     C     W2TRNR        ORNE      *BLANKS
     C     W2ST          ORNE      *BLANKS
     C     W2SOK         ORNE      *BLANKS
     C     W2NAK         ORNE      *BLANKS
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          COMP      1                                      06
     C     W2NR          COMP      11                                     16
     C   06
     COR 16              DO                                                       3<-B
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAAVD
     C                   END                                                       4<-B
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2TDN         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0046'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYTDN
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TRNR
     C                   MOVE      *BLANKS       W2ST
     C                   MOVE      *BLANKS       W2SOK
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C     WSAAVD        IFNE      0
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C     WSSG          IFNE      *BLANKS
     C                   MOVE      WSSG          USG
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HMLRN         BEGSR
     C***********************************************
     C     THTRNR        IFEQ      *BLANKS
     C                   MOVE      '0'           *IN55
     C                   MOVE      'N'           XMRN
     C     EDIM2K        SETLL     EDIM2
     C     STHML         TAG
     C     EDIM2A        READPE    EDIM2                                  33
     C     *IN33         IFEQ      '0'
     C     M1001         CABNE     'TET'         STHML
     C                   IF        M1225 = '999'
     C                   EVAL      WSMLRN = M0068
     C                   ELSE
     C                   MOVEL     M0068         XNODI
     C                   MOVE      M0068A        XMMDD
     C                   MOVE      M0068B        XLØPNR
     C                   MOVE      XMLRN         WSMLRN
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       WSMLRN
     C                   END
     C                   ELSE
     C                   MOVE      '1'           *IN55
     C                   MOVE      'J'           XMRN
     C                   MOVE      THTRNR        WSMLRN
     C                   END
     C     THLSTL        IFGT      0
     C                   MOVE      'J'           WSPLL
     C                   ELSE
     C                   MOVE      'N'           WSPLL
     C                   END
      *
     C                   IF        *IN40 = *OFF
     C     FRISOKK       CHAIN     FRISOK                             33
     C   33              EVAL      FSSOK = *BLANKS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SJEKKMRK      BEGSR
     C***********************************************
      *
      * SJEKK MERKING
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE(N)  FREETXT2                               33
     C  N33              MOVE      '1'           *IN29
     C   33              MOVE      '0'           *IN29
      * SJEKK MERKING
     C     NCTSHKOP      CHAIN(N)  FREETXT2                           33
     C  N33              MOVE      '1'           *IN36
     C   33              MOVE      '0'           *IN36
      * SJEKK NON-ARRIVAL MOVEMENT
     C     THST140       COMP      'J'                                    37
      * SJEKK DISCREPANCIES
     C  N37THST019       COMP      'J'                                    37
      * SJEKK RECOVERY NOTIFICATION
     C     THST035       COMP      'J'                                    38
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   CLEAR                   BILDE01
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          WSAAVD
     C                   ELSE
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C     W2TDN         IFNE      0                                            1<-B
     C                   MOVE      W2TDN         WSTDN
     C                   ELSE                                                   1
     C     W2SG          IFNE      *BLANKS                                       2<-B
     C                   MOVE      W2SG          WSSG
     C                   MOVE      W2DTT         WSDTT
     C                   MOVE      W2ST          WSST
     C                   ELSE                                                    2
     C     W2DTT         IFNE      0                                              3<-B
     C                   MOVE      W2DTT         WSDT
     C                   EVAL      WSNAK = W2NAK
     C                   ELSE                                                     3
     C     W2TRNR        IFNE      *BLANKS                                         4<-B
     C                   MOVE      W2TRNR        WSTRNR
     C                   ELSE                                                      4
     C     W2SOK         IFNE      *BLANKS                                          5<-B
     C                   EVAL      WSSOK = W2SOK
     C                   ELSE                                                       5
     C     W2NAK         IFNE      *BLANKS                                           6<-B
     C                   EVAL      WSNAK = W2NAK
     C                   ELSE                                                        6
     C                   MOVE      W2ST          WSST
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2TDN
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TRNR
     C                   MOVE      *BLANKS       W2ST
     C                   MOVE      *BLANKS       W2SOK
     C                   MOVE      *BLANKS       W2NAK
      *
     C                   MOVEA     '0000'        *IN(96)
     C                   EXSR      TESTB1
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYTDN         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          W2AVD
     C                   END
     C     WRK2K         CHAIN(N)  NCTSEHOPD                          98
     C   98              DO
     C                   MOVE      'YBC0047'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    2
     C                   EXSR      CHGNCTSH
     C     W2NR          WHENEQ    3
     C                   EXSR      CPYNCTSH
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPNCTSH
     C     W2NR          WHENEQ    6
     C                   EXSR      PRTNCTSH
     C     W2NR          WHENEQ    8
     C                   EXSR      DSPWEB
     C     W2NR          WHENEQ    9
     C                   EXSR      DSPTVI
     C     W2NR          WHENEQ    12
     C                   EXSR      faxmail
     C     W2NR          WHENEQ    14
     C                   EXSR      CSLNCTSH
     C     W2NR          WHENEQ    41
     C                   EXSR      NONNCTSH
     C     W2NR          WHENEQ    51
     C                   EXSR      arkivs
     C     W2NR          WHENEQ    54
     C                   EXSR      RELNCTSH
     C     W2NR          WHENEQ    70
     C                   EXSR      NOTNCTSH
     C                   ENDSL
      *
     C     SLTDN         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2TDN
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C                   SELECT
     C     WSNR          WHENEQ    2
     C                   MOVE      '1'           *IN99
     C                   EXSR      CHGNCTSH
     C     WSNR          WHENEQ    3
     C                   MOVE      '1'           *IN99
     C                   EXSR      CPYNCTSH
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPNCTSH
     C     WSNR          WHENEQ    6
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTNCTSH
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPWEB
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
     C     WSNR          WHENEQ    10
     C                   EXSR      FRIGIG
     C     WSNR          WHENEQ    12
     C                   MOVE      '1'           *IN99
     C                   EXSR      faxmail
     C     WSNR          WHENEQ    14
     C                   MOVE      '1'           *IN99
     C                   EXSR      CSLNCTSH
     C     WSNR          WHENEQ    16
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTNCTSH2
     C     WSNR          WHENEQ    18
     C                   EXSR      WRKFT
     C     WSNR          WHENEQ    35
     C                   MOVE      '1'           *IN99
     C                   EXSR      OPDARKIV
     C     WSNR          WHENEQ    41
     C                   MOVE      '1'           *IN99
     C                   EXSR      NONNCTSH
     C     WSNR          WHENEQ    51
     C                   MOVE      '1'           *IN99
     C                   EXSR      arkivs
     C     WSNR          WHENEQ    54
     C                   MOVE      '1'           *IN99
     C                   EXSR      RELNCTSH
     C     WSNR          WHENEQ    70
     C                   MOVE      '1'           *IN99
     C                   EXSR      NOTNCTSH
     C     WSNR          WHENEQ    99
     C                   MOVE      '1'           *IN99
     C                   EXSR      MRKST
     C                   ENDSL
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     42
     C                   MOVE      *BLANKS       UKNAVN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNK
     C                   PARM                    FIFIRM
     C                   PARM                    UKNAVN
     C                   Z-ADD     55            POSNBR
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     42
     C                   MOVE      *BLANKS       UKNAVN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    UKNAVN
     C                   Z-ADD     55            POSNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETCUR        BEGSR
      ***********************************************
     C                   Z-ADD     35            POSNBR
     C                   SELECT
     C                   WHEN      WSSOK  <> *BLANKS
     C                   Z-ADD     8             LINNBR
     C                   WHEN      WSDT   <> 0
     C                   Z-ADD     9             LINNBR
     C                   WHEN      WSTDN  <> 0
     C                   Z-ADD     10            LINNBR
     C                   WHEN      WSKNS  <> 0
     C                   Z-ADD     11            LINNBR
     C                   WHEN      WSKNK  <> 0
     C                   Z-ADD     12            LINNBR
     C                   WHEN      WSSG   <> *BLANKS
     C                   Z-ADD     13            LINNBR
     C                   WHEN      WSTRNR <> *BLANKS
     C                   Z-ADD     14            LINNBR
     C                   WHEN      WSST   <> *BLANKS
     C                   Z-ADD     16            LINNBR
     C                   WHEN      WSAKT  <> *BLANKS
     C                   Z-ADD     18            LINNBR
     C                   WHEN      WSNAK  <> *BLANKS
     C                   Z-ADD     15            LINNBR
     C                   OTHER
     C                   Z-ADD     8             LINNBR
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPNCTSH      BEGSR
     C***********************************************
     C                   MOVE      'DSP'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    THSG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGNCTSH      BEGSR
     C***********************************************
     C                   IF        THST004 = ' '
     C                   IF        (THDK = 'EXIT' OR THDK = 'ENTRY')
     C                             AND THST028 = 'J'
      * Ikke endring ved forhåndsvarsel når IE028 er mottatt.
     C                   ELSE
     C                   MOVE      'CHG'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM      THAVD         XAVD
     C                   PARM      THTDN         XTDN
     C                   PARM                    UPRO
     C                   PARM                    THSG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C                   END
     C                   END
     C     NCTSHKOP      CHAIN(N)  NCTSEHOPD                          33
      * HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      HMLRN
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYNCTSH      BEGSR
     C***********************************************
     C                   MOVE      'CPY'         XTYPE             3
     C     *LIKE         DEFINE    THAVD         XAVD
     C     *LIKE         DEFINE    THTDN         XTDN
     C                   MOVE      THAVD         XAVD
     C                   MOVE      THTDN         XTDN
     C                   CALL      'NCTS011C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              UPDATE    SUBFIL
     C     XTDN          IFNE      0
     C     XAVD          IFNE      THAVD
     C     XTDN          ORNE      THTDN
     C     NCTSHKKP      CHAIN(N)  NCTSEHOPD                          33
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTA         WSDTA2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
     C                   EXSR      HMLRN
     C  N90              EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CRTNCTSH      BEGSR
     C***********************************************
     C                   MOVE      'CRT'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'NCTS011C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     XAVD          IFNE      0
     C     XTDN          ANDNE     0
     C     NCTSHKKP      CHAIN(N)  NCTSEHOPD                          33
     C  N33              DO
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTA         WSDTA2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
     C                   EXSR      HMLRN
     C                   EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CRTNCTS2      BEGSR
     C***********************************************
     C                   MOVE      'CR2'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'NCTS011C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
      *
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTNCTSH      BEGSR
     C***********************************************
     C     THST          IFEQ      ' '
     C     THST          OREQ      'P'
     C     THST          OREQ      'Z'
     C     THTRNR        IFNE      *BLANKS
     C                   EXSR      TSTIE29
     C     XIE29         CABEQ     'N'           SLPRTNCTSH
     C                   MOVE      'PRT'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     NCTSHKOP      CHAIN(N)  NCTSEHOPD                          33
     C                   CALL      'NCTS014C'
     C                   END
     C                   END
     C     SLPRTNCTSH    TAG
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTNCTSH2     BEGSR
     C***********************************************
     C                   IF        (((THST = ' ') OR
     C                               (THST = 'C')) OR
     C                               (THST = 'N'))
     C                   MOVEL     THTRNR        XAN08             8
     C                   IF        (((XAN08 = *BLANKS) OR
     C                               (XAN08 = 'NØDPROS.')) OR
     C                               (XAN08 = 'NØDPROSE'))
     C                   CALL      'NCTS027R'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   IF        *IN90 = *OFF
     C                   MOVE      *ZEROS        WSNR
     C     NCTSHKOP      CHAIN(N)  NCTSEHOPD                          33
     C  N33              MOVE      THTRNR        WSMLRN
     C                   END
     C                   END
     C                   END
      *
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     TSTIE29       BEGSR
     C***********************************************
     C                   MOVE      'N'           XIE29             1
     C     EDIM4K1       SETLL     EDIM4
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   DOW       *IN33 = *OFF
     C                   IF        MST <> 'D' AND M1001 = 'TET' AND
     C                             M1N07 <> '928'
     C                   IF        (((M1N07 = '029') OR
     C                               (M1N07 = '045')) OR
     C                               (M1N07 = 'CTL'))
     C                   MOVE      'J'           XIE29
     C                   END
     C                   LEAVE
     C                   END
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPWEB        BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Søk på MRNnr (eksport) på WEB '
     C                   EVAL      WebType = 'MRNNR'
     C                   EVAL      WebSok  = THTRNR
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
     C***********************************************
     C     DSPTVI        BEGSR
     C***********************************************
     C                   MOVE      '2'           WIN03             1
     C                   CALL      'SAD003'
     C                   PARM      THAVD         THAVD
     C                   PARM      THTDN         THTDN
     C                   PARM                    WIN03
     C     WIN03         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKFT         BEGSR
      ***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM      THAVD         UAVD2
     C                   PARM      THTDN         UOPD2
     C                   PARM                    UFLAGG
      *
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     FRIGIG        BEGSR
     C***********************************************
     C                   IF        ((((THST = 'P') AND                          IE29 ELLER IE45
     C                                (THGBL > 0)) AND
     C                               ((THGKD <= '1') OR (THGKD = '9'))) OR
     C                               ((THST = 'M') AND (THGBL > 0)))            CONTRL-MELDING
     C                   EXSR      TSTIE29
     C     XIE29         CABEQ     'N'           SLFRIGIG
      *
     C     STFRIGIG      TAG
     C                   EXFMT     BILDE03
     C   12              GOTO      SLFRIGIG
     C  N10              GOTO      STFRIGIG
     C     NCTSHKOP      CHAIN     NCTSEHOPD                          33
     C                   Z-SUB     THGBL         THGBL
     C                   IF        M1N07 <> 'CTL'
     C                   MOVE      'Z'           THST
     C                   END
     C                   UPDATE    NCTSEHROPD
     C     THGFT1        CHAIN     TRUGH                              33
     C  N33              ADD       THGBL         TGGBLB
     C  N33              UPDATE    TRUGHR
     C                   CLEAR                   EDIMR
     C                   EVAL      M0004 = UUSER
     C                   EVAL      M0010 = UUSER
     C                   EVAL      M0062 = 'FRIGI GARANTI'
     C                   EVAL      M0065 = 'TEFRIG'
     C                   EVAL      M0068 = WSFT
     C                   EVAL      M1001 = 'TET'
     C                   EVAL      M1225 = '999'
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   OPEN      EDIM
     C                   EVAL      MMN   = CMN
     C                   EVAL      MSR   = 'S'
     C                   EVAL      MST   = 'C'
     C                   EVAL      MAVD  = THAVD
     C                   EVAL      MTDN  = THTDN
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   MOVE      WDT           M0068A
     C                   WRITE     EDIMR
     C                   CLOSE     EDIM
     C                   OPEN      TVINF
     C                   EVAL      FMN   = CMN
     C                   EVAL      FLN   = 1
     C                   MOVE      'PP'          F0077
     C                   EVAL      F0078A = 'BRUKER:'
     C                   CAT       UUSER:1       F0078A
     C                   EVAL      F0078B = 'DATO  :'
     C                   CAT       WDT:1         F0078B
     C                   EVAL      F0078C = 'TID   :'
     C                   CAT       WTM:1         F0078C
     C                   EVAL      F0078D = 'KOMM. :'
     C                   CAT       WSFT          F0078D
     C                   WRITE     TVINFF
     C                   CLOSE     TVINF
     C                   END
      *
     C     SLFRIGIG      TAG
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CSLNCTSH      BEGSR
     C***********************************************
     C*    THTRNR        IFNE      *BLANKS
     C*                  IF        THST = 'P' OR THST = 'U'
     C*                  IF        THST928 = 'J' AND
     C*                            (THST = 'c' OR THST = 'U' OR THST = 'M')
     C                   IF        (THST928 = 'J' OR
     C                              THST028 = 'J' OR THST029 = 'J')
     C                             AND
     C                             (THST = 'c' OR THST = 'U' OR THST = 'M' OR
     C                              THST = 'P')
     C                   MOVE      'CSL'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C                   END
     C*                  END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     RELNCTSH      BEGSR
      ***********************************************
     C                   IF        (THST = 'C' OR THST = 'U') AND
     C                             THTRNR <> *BLANKS
     C                   MOVE      'REL'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     NONNCTSH      BEGSR
      ***********************************************
     C                   IF        THST140 = 'J' AND THST045 <> 'J'
      * Mottatt IE140 og ikke IE045 (transit avslutt)
     C                   MOVE      'NON'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     NOTNCTSH      BEGSR
      ***********************************************
     C                   IF        THST = 'C' OR THST = 'V' OR THST = 'c'
     C                             OR THST = 'M' AND THST004 = 'J'
      * Enten mottatt IE004 eller IE060 eller IE928
     C                   MOVE      'NOT'         XTYPE             3
     C                   CALL      'NCTS011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
     C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     MRKST         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       FT
     C                   MOVE      *ZEROS        XN                3 0
     C                   MOVE      *BLANKS       WAUSER
     C                   MOVE      *ZEROS        WADT
     C     THGBL         COMP      0                                    8989
     C                   MOVE      'N'           WAFGAR
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE(N)  FREETXT2                               33
     C     *IN33         DOWEQ     '0'
     C     WAUSER        IFEQ      *BLANKS
     C                   MOVE      FRTTXT        WAUSER
     C                   MOVE      FRTDTA        WADTA
     C                   MOVE      FRTDTM        WADTM
     C                   MOVE      FRTDTD        WADTD
     C                   END
     C                   ADD       1             XN
     C                   MOVEL     FRTTXT        FT(XN)
     C     FRT2K         READE     FREETXT2                               33
     C  N33              ENDDO
     C                   MOVE      THST          WAST
     C                   MOVE      FT2501        FT2502          250
      *
     C     STMRK         TAG
     C                   EXFMT     BILDE02
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
     C   12              GOTO      SLMRK
      *
     C     WAFT1         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1864'     MSGNR
     C                   GOTO      STMRK
     C                   END
      *
     C     FT2501        IFNE      FT2502
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE     FREETXT2                               33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    FREETXTR
     C     FRT2K         READE     FREETXT2                               33
     C  N33              ENDDO
      *
     C                   MOVE      THAVD         FRTAVD
     C                   MOVE      THTDN         FRTOPD
     C                   MOVE      WDT           FRTDT
     C     1             DO        5             XN
     C     FT(XN)        IFNE      *BLANKS
     C                   Z-ADD     XN            FRTLI
     C                   MOVEL     FT(XN)        FRTTXT
     C                   MOVE      UUSER         FRTTXT
     C                   WRITE     FREETXTR
     C                   END
     C                   ENDDO
     C                   END
      *
     C     THST          IFNE      WAST
     C     WAFGAR        OREQ      'J'
     C     NCTSHKOP      CHAIN     NCTSEHOPD                          33
     C                   MOVE      WAST          THST
      *
     C                   IF        THGBL > 0
     C                   Z-SUB     THGBL         THGBL
     C     THGFT1        CHAIN     TRUGH                              33
     C                   ADD       THGBL         TGGBLB
     C  N33              UPDATE    TRUGHR
     C                   CLEAR                   EDIMR
     C                   EVAL      M0004 = UUSER
     C                   EVAL      M0010 = UUSER
     C                   EVAL      M0062 = 'FRIGI GARANTI'
     C                   EVAL      M0065 = 'TEFRIG'
     C                   EVAL      M0068 = WSFT
     C                   EVAL      M1001 = 'TET'
     C                   EVAL      M1225 = '999'
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   OPEN      EDIM
     C                   EVAL      MMN   = CMN
     C                   EVAL      MSR   = 'S'
     C                   EVAL      MST   = 'C'
     C                   EVAL      MAVD  = THAVD
     C                   EVAL      MTDN  = THTDN
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   MOVE      WDT           M0068A
     C                   WRITE     EDIMR
     C                   CLOSE     EDIM
     C                   OPEN      TVINF
     C                   EVAL      FMN   = CMN
     C                   EVAL      FLN   = 1
     C                   MOVE      'PP'          F0077
     C                   EVAL      F0078A = 'BRUKER:'
     C                   CAT       UUSER:1       F0078A
     C                   EVAL      F0078B = 'DATO  :'
     C                   CAT       WDT:1         F0078B
     C                   EVAL      F0078C = 'TID   :'
     C                   CAT       WTM:1         F0078C
     C                   EVAL      F0078D = 'KOMM. :'
     C                   CAT       WSFT          F0078D
     C                   WRITE     TVINFF
     C                   CLOSE     TVINF
     C                   END
      *
     C                   UPDATE    NCTSEHROPD
     C     STMRK2        TAG
     C                   MOVE      WDT           SSDT
     C                   MOVE      WTM           SSTM
     C     STSK          CHAIN     STS                                33
     C     *IN33         IFEQ      '0'
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   GOTO      STMRK2
     C                   END
     C                   MOVE      THAVD         SSAVD
     C                   MOVE      THTDN         SSOPD
     C                   MOVE      UUSER         SSUSR
     C                   MOVE      THSG          SSSG
     C                   MOVE      'R'           SSRTYP
     C                   MOVE      THST          SSSTG
     C                   MOVE      WAST          SSSTN
     C                   WRITE     STSR
     C                   END
      *
     C     SLMRK         TAG
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKKMRK
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KOANVN
     C     WSAAVD        IFNE      0
     C     WSTDN         ORNE      0
     C     WSAAVD        CHAIN     NCTSESTD                           99
     C  N99KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB1
     C                   MOVE      WSAAVD        UAVD
     C                   END
      *
     C                   MOVEA     '000000000'   *IN(41)
      *
     C     WSSOK         comp      *BLANKS                            4040
     C   40              EVAL      WSSOKMAX = %TRIM(WSSOK)
     C                             + '9999999999999999999999999999999999'
     C   40              GOTO      STTB1
     C     WSDT          COMP      *ZEROS                             4141
     C  N41WSNAK         COMP      *BLANKS                            4141
     C   41              GOTO      STTB1
     C     WSTDN         COMP      *ZEROS                             4242
     C   42              GOTO      STTB1
     C     WSKNS         COMP      *ZEROS                             4343
     C   43              GOTO      STTB1
     C     WSKNK         COMP      *ZEROS                             4444
     C   44              GOTO      STTB1
     C     WSSG          COMP      *BLANKS                            4545
     C   45              GOTO      STTB1
     C     WSTRNR        COMP      *BLANKS                            4646
     C   46              GOTO      STTB1
     C     WSST          COMP      *BLANKS                            4949
     C   49              GOTO      STTB1
     C     WSAKT         COMP      *BLANKS                            4848
     C   48              GOTO      STTB1
      *
     C                   MOVE      'DIV0064'     MSGNR
     C                   SETON                                        3098
     C                   EVAL      LINNBR = 9
     C                   GOTO      SLTB1
      *
     C     STTB1         TAG
     C   43              MOVE      WSKNS         KUNDNR
     C   43KUNDK         CHAIN     CUNDL01                            97
     C   97              MOVE      'SPK0035'     MSGNR
     C   44              MOVE      WSKNK         KUNDNR
     C   44KUNDK         CHAIN     CUNDL01                            96
     C   96
     CANN97              MOVE      'SPK0035'     MSGNR
     C   97
     COR 96              SETON                                        30
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
      *
     C                   IF        XSTART = 'J'
     C     USG           SETLL     NCTSEH11
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIGAAR            8 0
     C     XIGAAR        CHAIN     KALENDER                           33
     C                   READP     KALENDER                               33
     C                   MOVE      KADATE        XIGAAR
     C                   GOTO      SLSETKEY
     C                   END
      *
     C   41              DO
     C     WSDT          IFEQ      0
     C                   MOVE      *ZEROS        XDT
     C                   ELSE
     C                   MOVE      XDTDD         XDTDD2
     C                   MOVE      XDTMM         XDTMM2
     C     XDTAA         ADD       2000          XDTAA2
     C                   END
     C                   END
     C   44              DO
     C                   SELECT
     C     WSDTK         WHENEQ    0
     C                   MOVE      *ZEROS        XDTK
     C                   OTHER
     C                   MOVE      XDTKD         XDTKD2
     C                   MOVE      XDTKM         XDTKM2
     C     XDTKA         ADD       2000          XDTKA2
     C                   ENDSL
     C                   END
     C   43              DO
     C     WSDTS         IFEQ      0
     C                   MOVE      *ZEROS        XDTS
     C                   ELSE
     C                   MOVE      XDTSD         XDTSD2
     C                   MOVE      XDTSM         XDTSM2
     C     XDTSA         ADD       2000          XDTSA2
     C                   END
     C                   END
     C   45              DO
     C     WSDTT         IFEQ      0
     C                   MOVE      *ZEROS        XDTT
     C                   ELSE
     C     WSDTT         IFEQ      999999
     C                   MOVE      99999999      XDTT
     C                   ELSE
     C                   MOVE      XDTTD         XDTTD2
     C                   MOVE      XDTTM         XDTTM2
     C     XDTTA         ADD       2000          XDTTA2
     C                   END
     C                   END
     C                   END
     C   48              DO
     C     WSDTA         IFEQ      0
     C                   MOVE      *ZEROS        XDTA
     C                   ELSE
     C     WSDTA         IFEQ      999999
     C                   MOVE      99999999      XDTA
     C                   ELSE
     C                   MOVE      XDTADD        XDTADD2
     C                   MOVE      XDTAMM        XDTAMM2
     C     XDTAAA        ADD       2000          XDTAAA2
     C                   END
     C                   END
     C                   END
      *
     C     WSAAVD        IFEQ      0
     C     *IN46         ANDEQ     '0'
     C     *IN48         OREQ      '1'
     C                   EXSR      MINTRL
     C                   ELSE
     C                   EXSR      MINTRE
     C                   END
      *
     C     SLSETKEY      TAG
     C                   ENDSR
      *
     C***********************************************
     C     MINTRE        BEGSR
     C***********************************************
      * SET KEY NÅR SØK KUN I EN !!!!  AVDELING
     C   40FR1KEY        SETLL     FRISOL01
     C   41NCTSH1K       SETLL     NCTSEH01
     C   42NCTSHK        SETLL     NCTSEH
     C   43NCTSH3K       SETLL     NCTSEH03
     C   44NCTSH2K       SETLL     NCTSEH02
     C   45WSDTT         IFEQ      999999
     C     NCTSH4K       SETGT     NCTSEH04
     C                   ELSE
     C     NCTSH4K       SETLL     NCTSEH04
     C                   END
     C   46WSTRNR        SETLL     NCTSEH05
     C   49NCTSH8K       SETLL     NCTSEH08
      *
     C                   ENDSR
      *
     C***********************************************
     C     MINTRL        BEGSR
     C***********************************************
      * SET KEY NÅR SØK I ALLE !!  AVDELINGER
     C   40FR1KEY        SETLL     FRISOL01
     C   41NCTSH9K       SETLL     NCTSEH09
     C   43NCTSHA3K      SETLL     NCTSEH13
     C   44NCTSHA2K      SETLL     NCTSEH12
     C   45WSDTT         IFEQ      999999
     C     NCTSHA4K      SETGT     NCTSEH14
     C                   ELSE
     C     NCTSHA4K      SETLL     NCTSEH14
     C                   END
     C   49WSST          SETLL     NCTSEH07
     C   48XDTA          SETLL     NCTSEH15
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
      *
     C     STLESREC      TAG
     C                   IF        XSTART = 'J'
     C     USG           READE     NCTSEH11                               94
     C  N94THDT          COMP      XIGAAR                             94
     C  N94              GOTO      SLLESREC
     C                   EVAL      *IN94 = *OFF
     C                   EVAL      XSTART = 'N'
     C                   EXSR      SETKEY
     C                   END
      *
      * LES REC NÅR SØK KUN I EN !!!!  AVDELING
     C     STLREC        TAG
     C   40              DOW       *IN94 = *OFF
     C     FR1KEYE       READE     FRISOL01                               94
     C  N94WSSOKMAX      COMP      FSSOK                                94
     C  N94NCTSEHKFRI    CHAIN     NCTSEH                             33
     C  N94
     CANN33              LEAVE
     C                   ENDDO
     C   41WSAAVD        READE     NCTSEH01                               94
     C   41
     CANN94              IF        WSNAK <> *BLANKS
     C     LC:UC         XLATE     THNAK         X_THNAK          30
     C     ' '           CHECKR(E) WSNAK         NUM               2 0
     C                   EVAL      %len(VARI) = NUM
     C     NUM           SUBST     WSNAK:1       VARI
     C     VARI          SCAN      X_THNAK                                33
     C  N33              GOTO      STLREC
     C                   END
     C   42WSAAVD        READE     NCTSEH                                 94
     C   43WSAAVD        READE     NCTSEH03                               94
     C   43
     CANN94WSKNS         COMP      THKNS                              9494
     C   44WSAAVD        READE     NCTSEH02                               94
     C   44
     CANN94WSKNK         COMP      THKNK                              9494
     C   45WSDTT         IFEQ      999999
     C     WSAAVD        READPE    NCTSEH04                               94
     C  N94WSSG          COMP      THSG                               9494
     C                   ELSE
     C     WSAAVD        READE     NCTSEH04                               94
     C  N94WSSG          COMP      THSG                               9494
     C  N94              IF        WSST <> *BLANKS
     C     WSST          CABNE     THST          STLREC
     C                   END
     C                   END
     C   46              READ      NCTSEH05                               94
     C   49NCTSH8K       READE     NCTSEH08                               94
     C     SLLESREC      TAG
     C  N94              DO
     C                   IF        UIE = 'I'
     C                   IF        THDK<>'SS' AND THDK<>'ENTRY' AND THDK<>'EXIT'
     C                   IF        XSTART = 'J'
     C                   GOTO      STLESREC
     C                   ELSE
     C                   GOTO      STLREC
     C                   END
     C                   END
     C                   END
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTA         WSDTA2
     C                   MOVE      THAVD         XNAVD
     C                   MOVE      THTDN         XNTDN
S01  C*                  move      *zeros        wsdt2f
N01  C                   move      *zeros        wsddt
     C     thst          ifne      'D'
     C     thst          andne     'Z'
     C     thst          andne     'S'
S01  C*                  MOVE      THDDTD        WSDTD2F
S01  C*                  MOVE      THDDTM        WSDTM2F
S01  C*                  MOVE      THDDTA        WSDTA2F
N01  C                   MOVE      THDDTD        WSDDTD
N01  C                   MOVE      THDDTM        WSDDTM
N01  C                   MOVE      THDDTA        WSDDTA
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESRAL        BEGSR
     C***********************************************
      * LES REC NÅR SØK I ALLE !!  AVDELINGER
     C     STLRAL        TAG
     C   40              DOW       *IN94 = *OFF
     C     FR1KEYE       READE     FRISOL01                               94
     C  N94WSSOKMAX      COMP      FSSOK                                94
     C  N94NCTSEHKFRI    CHAIN     NCTSEH                             33
     C  N94
     CANN33              LEAVE
     C                   ENDDO
     C   41              READ      NCTSEH09                               94
     C   41
     CANN94              IF        WSNAK <> *BLANKS
     C     LC:UC         XLATE     THNAK         X_THNAK          30
     C     ' '           CHECKR(E) WSNAK         NUM               2 0
     C                   EVAL      %len(VARI) = NUM
     C     NUM           SUBST     WSNAK:1       VARI
     C     VARI          SCAN      X_THNAK                                33
     C  N33              GOTO      STLRAL
     C                   END
     C   43WSKNS         READE     NCTSEH13                               94
     C   44WSKNK         READE     NCTSEH12                               94
     C   45WSDTT         IFEQ      999999
     C     WSSG          READPE    NCTSEH14                               94
     C                   ELSE
     C     WSSG          READE     NCTSEH14                               94
     C                   END
     C   49WSST          READE     NCTSEH07                               94
     C   48              READ      NCTSEH15                               94
     C   48
     CANN94              IF        WSAAVD <> 0 AND WSAAVD <> THAVD
     C                   GOTO      STLRAL
     C                   END
     C   48
     CANN94              IF        WSAKTK ='X' AND THST <> 'P' AND THST <> 'N'
     C                   GOTO      STLRAL
     C                   END
     C  N94              DO
     C  N94              IF        WSST <> *BLANKS
     C     WSST          CABNE     THST          STLRAL
     C                   END
     C                   IF        UIE = 'I'
     C                   IF        THDK<>'SS' AND THDK<>'ENTRY' AND THDK<>'EXIT'
     C                   GOTO      STLRAL
     C                   END
     C                   END
     C                   IF        *IN48
     C                   MOVE      THDDTD        WSDTD2
     C                   MOVE      THDDTM        WSDTM2
     C                   MOVE      THDDTA        WSDTA2
     C                   ELSE
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTA         WSDTA2
     C                   END
S01  C*                  move      *zeros        wsdt2f
N01  C                   move      *zeros        wsddt
     C     thst          ifne      'D'
     C     thst          andne     'Z'
     C     thst          andne     'S'
S01  C*                  MOVE      THDDTD        WSDTD2F
S01  C*                  MOVE      THDDTM        WSDTM2F
S01  C*                  MOVE      THDDTA        WSDTA2F
N01  C                   MOVE      THDDTD        WSDDTD
N01  C                   MOVE      THDDTM        WSDDTM
N01  C                   MOVE      THDDTA        WSDDTA
     C                   END
     C                   MOVE      THAVD         XNAVD
     C                   MOVE      THTDN         XNTDN
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UIE               1
      *
     C     NCTSHK        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTDN
     C     NCTSHKN       KLIST
     C                   KFLD                    XNAVD
     C                   KFLD                    XNTDN
     C     NCTSHKOP      KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     NCTSHKKP      KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2TDN
     C     NCTSH1K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    XDT
     C     NCTSH2K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     NCTSH3K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     NCTSH4K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     NCTSH8K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSST
     C     NCTSH9K       KLIST
     C                   KFLD                    XDT
     C     KUNDK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    XUNIK
     C                   KFLD                    WSAAVD
     C     NCTSHA2K      KLIST
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     NCTSHA3K      KLIST
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     NCTSHA4K      KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     EDIM2K        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    X0068A
     C     EDIM2A        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     EDIM4K1       KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    MAX0B
     C     EDIM4K2       KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     FRT2K         KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    FRTKOD
     C     STSK          KLIST
     C                   KFLD                    SSDT
     C                   KFLD                    SSTM
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    UUSER
     C     NCTSEHKFRI    KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     FR1KEY        KLIST
     C                   KFLD                    WSKODE
     C                   KFLD                    WSSOK
     C     FR1KEYE       KLIST
     C                   KFLD                    WSKODE
     C     FRISOKK       KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    WSKODE
      *
     C     *LIKE         DEFINE    THPRO         UPRO
     C     *LIKE         DEFINE    FSKODE        WSKODE
     C                   MOVEL     '*CN'         WSKODE
     C                   MOVE      'A'           XUNIK             1
      *
     C                   MOVE      *BLANKS       WSSOKMAX         35
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        WSDTK
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      'X'           WSAKTK
S01  C*                  MOVE      *ZEROS        WSDT2F
N01  C                   MOVE      *ZEROS        WSDDT
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      *ZEROS        XDTS
     C                   MOVE      *ZEROS        XDTK
     C                   MOVE      *ZEROS        XDTT
     C                   MOVE      *ZEROS        THDT
     C                   MOVE      *ZEROS        WSDT2
     C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      99999999      X0068A            8 0
     C                   MOVE      'N'           FRTKOD
     C                   MOVE      'R'           XSR1              1
     C                   MOVE      '99999999'    MAX0B             8 0
     C     UIE           COMP      'I'                                    28
      *
     C                   MOVE      UAVD          WSAAVD
     C     KODTAK        CHAIN     KODTA                              30
     C                   MOVE      USG           WSSG
     C                   MOVE      '999999'      WSDTT
     C                   SETON                                        45
     C                   MOVE      'J'           XSTART            1
      *
     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
      *
     C                   EXSR      CMDFT2
     C                   ENDSR
      *
      *
      ***********************************************
     C     CMDFT2        BEGSR
      ***********************************************
     C                   SELECT
     C     XMSG13        WHENEQ    0
     C                   ADD       1             XMSG13            1 0
     C                   MOVE      'DIV0020'     MSGF31
     C                   MOVE      'DIV0021'     MSGF32
     C                   MOVE      'DIV0022'     MSGF33
      *
     C     XMSG13        WHENEQ    1
     C                   add       1             XMSG13
     C                   MOVE      'DIV0023'     MSGF31
     C                   MOVE      'SHU1037'     MSGF32
     C                   MOVE      'YBC0034'     MSGF33
      *
     C     XMSG13        WHENEQ    2
     C                   Z-ADD     0             XMSG13
     C                   MOVE      'DIV0000'     MSGF31
     C                   MOVE      'DIV0000'     MSGF32
     C                   MOVE      'YBC0033'     MSGF33
     C                   ENDSL
      *
     C                   ENDSR
      *
      *
      ***********************************************
     C     OPDARKIV      BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
     C  N90              update    subfil
     C                   IF        THST = 'U' AND THENKL = 'J'
     C     NCTSHKOP      CHAIN     ARKIVL15                           33
     C                   IF        *IN33
     C     NCTSHKOP      CHAIN     NCTSEHOPD                          33
     C                   IF        *IN33 = *OFF
     C                   EVAL      THPKL = 'J'
     C                   UPDATE    NCTSEHROPD
     C                   EVAL      ARTYPE = 'te'
     C                   EVAL      ARFIRM = FIFIRM
     C                   EVAL      ARAVD  = THAVD
     C                   EVAL      AROPD  = THTDN
     C                   EVAL      ARUSER = UUSER
     C                   WRITE     ARKIVR
     C                   CALL      'ARC002CL'
     C                   PARM                    ARTYPE
     C                   PARM                    ARUSER
     C                   PARM                    UAN01             1
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
     C  N90              update    subfil
     C                   CALL      'ARC003'
     C                   PARM      THAVD         UAVD2             4 0
     C                   PARM      THTDN         UOPD2             7 0
     C                   PARM                    URUNDE           10
     C                   ENDSR
      ***********************************************
     C     FAXMAIL       BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
     C  N90              update    subfil
S01  C*                  CALL      'FAX031CLAD'
N01  C                   CALL      'FAX033CLAD'
     C                   PARM      THAVD         UAVD2             4 0
     C                   PARM      THTDN         UOPD2             7 0
     C                   ENDSR
      *
