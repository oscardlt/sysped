********************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10003 * 01 YBC PTF10 KLARGJØR TIL EKSTERN REFERANSE
10XXX * 02 YBC PTF10 SØK PÅ TARIFF
10XXX * 03 YBC PTF10 IKKE KRAV PÅ NETTO VEKT
10XXX * 04 YBC PTF10 BEHANDLE NF PÅ SAMME MÅTE SOM NE OG VS SOM VQ
10XXX * 05 YBC PTF10 HENT SISTE KURS OG OMREGN FAKTOR
10311 * 06 YBC PTF10 DOKUMENTKODE ER ENDRET FRA 3A TIL 4A
10XXX * 07 YBC PTF10 T.O.ID = CAL --> IKKE TEST LANDKODE
10XXX * 08 YBC KAN HA FLERE OMREGNINGSFAKTOR PÅ SAMME VALUTAKODE
12XXX * 09 CB  Bytt ut gammel tolltariff med ny
12XXX * 10 CB  Bytt ut hardkodet 'ADR.' til 'ADRESS'
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11133 * 09 YBC PTF11 VEKT ER ENDRET FRA 9.1 TIL 11.3, EGET FELT FOR GARANTI
12XXX * 10 YBC PTF12 RETT FEIL I ENDRING 09
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED EL.TRANSITTERING (LINJE)      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 09-11 13-16 18 20 23 24
      *** LEDIGE INDIKATORER 32 49-51 95-97
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.      ***
      ***   OG DEFINERES I PROGRAM                               ***
      **************************************************************
      *
     FSVXSTD    IF   E           K DISK    PREFIX(STD_)
     FSVXH      UF   E           K DISK
     FSVXHFV    IF   E           K DISK
     FSVXGH     UF   E           K DISK
     FSVTVK     IF   E           K DISK
     FSVXV      UF A E           K DISK
     FSVXVAM    UF A E           K DISK
     FSVXVFV    UF   E           K DISK
     FSVXV02    IF   E           K DISK
     F                                     RENAME(SVXVR:SVXV02R)
     FSVXHL     IF   E           K DISK
     FSVXVCN    UF   E           K DISK
     FSVXVDK    UF   E           K DISK
     FSVXVFS    UF   E           K DISK
     FSVXVMN    UF   E           K DISK
     FSVXVTD    UF   E           K DISK
     FSVXVVT    UF   E           K DISK
     FSVXKODL01 IF   E           K DISK
     FSVXFKDF   IF   E           K DISK
     FSVTLK     IF   E           K DISK
N02  FSVTVS     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
S09  F*SVTAR2    IF   E           K DISK
N09  FSVTX04F   IF   E           K DISK
     FHEADF     UF   E           K DISK
     FSVEH      IF   E           K DISK
     FSVEV      IF   E           K DISK
N01  FZSVXHL01  IF   E           K DISK    RENAME(SVXHR:SVXHRZ1)
N01  FZSVXHL03  IF   E           K DISK    RENAME(SVXHR:SVXHRZ3)
N01  FZSVXVL01  UF   E           K DISK    RENAME(SVXVR:SVXVRZ)
N01  FZSVXVAM1  UF   E           K DISK    RENAME(SVXVAMR:SVXVAMRZ)
     FTURER14   IF   E           K DISK
     FSVX012D   CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     SFILE(SUBFIL2:ZRECN2)
     F                                     INFDS(FBAREA)
     D LI              S              5  0 DIM(200)
     D AV              S              4  0 DIM(200)
     D OP              S              7  0 DIM(200)
      *
     D FBAREA          DS
S09  D* WSCLOC               370    371B 0
S10  D* WSCLOC               382    383B 0
N10  D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
S09  D*                DS
S09  D* TVDREF                 1     20
S09  D* WXDREF                 1     19
S09  D*                DS
S09  D* TVVT                   1     48
S09  D* T2VT                   1     15
     D                 DS
     D  W2VNT                  1      6  0
     D  W2VNTA10               1     10
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UUR                   12     12
     D  UWS                   13     22
     D  UTVIN                 23     23
     D  UIN27                 24     24
     D  UIN36                 26     26
S09  D* UVKB                  27     35  1
N09  D  UVKB                  27     37  3
E09  D  UDK                   41     45
E09  D  UKDC                  46     46
E09  D  UALK                  47     48
E09  D  UBLK                  49     50
E09  D  UPRO                  51     58  0
E09  D  ULSTL                 59     62  0
E09  D  UZREFF                63     79
E09  D  UZUNIK                80     88  0
      * OBS! HUSK INITIERE ALLE FELTER PÅ SVX011R
     D  UPARM2                 1    128
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI
     C                   MOVE      *ZEROS        XLI
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C  N31SVV2K         SETLL     SVXV02
     C   31SVV1K         SETLL     SVXV
     C     START1        TAG
     C  N31SVHK          READE     SVXV02                                 94
     C   31SVHK          READE(N)  SVXV                                   94
     C  N94
     CAN 31              MOVE      TVLI          W3LI
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        99998
     C                   ADD       1             ZRECNO
     C     TVLI          IFGT      XLI
     C                   MOVE      TVLI          XLI               5 0
     C                   END
     C                   MOVE      TVLI          XLI2              5 0
     C                   MOVE      TVLN          WXLN
     C                   EXSR      SRSUMKL
     C                   WRITE     SUBFIL
     C  N31SVHK          READE     SVXV02                                 94
     C   31SVHK          READE(N)  SVXV                                   94
     C  N94
     CAN 31              MOVE      TVLI          W3LI
     C  N94              END
     C                   END
      *
     C     XHOPD         IFEQ      'J'
     C     ZRECNO        IFEQ      0
     C                   EXSR      HOPD
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      'N'           XHOPD
     C                   END
     C                   END
      *
     C     XHOPD2        IFEQ      'J'
     C     ZRECNO        IFEQ      0
     C                   EXSR      HOPD2
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      'N'           XHOPD2
     C                   END
     C                   END
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     ZRECNO        IFGT      1
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      ***
      *
     C                   SETOFF                                       989930
      *
      *** F03 OG 27 PÅ ---> AVBRYTTE SPØRRING
     C   03
     CAN 27              MOVE      *ZEROS        UFLAGG
     C   03
     CAN 27              GOTO      SLUTT
      *
     C   10              DO
     C                   EXSR      HOPD
     C                   GOTO      START
     C                   END
      *** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START3
     C                   END
      *
     C   03
     COR 17              DO
     C                   EXSR      PRINT
      *** F12 ---> AVBRYTTE F3/F17
     C   12              Z-ADD     4             LINNBR
     C   12              Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
      *
      *** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              GOTO      START
      *** F6  ---> LAGE NYE DETALJE LINJER
     C   06              GOTO      START5
      *** F8  ---> VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C   08              GOTO      START7
      *
      *** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94
     CAN 31SVVK          SETLL     SVXV
     C  N94
     CAN 31SVHK          READE(N)  SVXV                                   94
     C                   GOTO      START2
     C                   END
      *
      *** SJEKKE OM BRUKER HAR VALGT OPSJONER. HIVS SÅ,T UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   END
      *** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
      ***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
      *** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
      ***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
      *
      *** LAGE NYE DETALJE LINJER
     C     START5        TAG
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   EXSR      MOVB2
      *
     C     START6        TAG
     C  N30W2LI          IFGT      0
     C                   EXSR      TSTOPL
     C                   END
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000000'    *IN(75)
     C                   MOVEA     '00000000'    *IN(67)
     C                   MOVEA     '000000'      *IN(61)
     C                   MOVEA     '000'         *IN(57)
     C                   MOVEA     '0000'        *IN(52)
     C                   MOVE      '0'           *IN30
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START6
     C                   END
      *
      *** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START6
     C                   END
      *
     C   12W2LI          IFGT      0
     C                   EXSR      DLTOPL
     C                   END
      *
      *** F12 --> AVBRYTTE REGISTRERING AV NYE DETALJE LINJER.
     C  N12              DO
      *** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
      *** FEILMELDING.
     C                   EXSR      TESTB1
     C   30              GOTO      START6
     C     XNYOPD        IFEQ      'J'
     C                   EXSR      HOPD2
     C                   GOTO      START
     C                   END
      *
     C     W2LI          IFEQ      0
     C                   ADD       1             XLI
     C                   MOVE      XLI           W2LI
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      START6
     C                   END
      *
      *** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDSVV
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
      *** VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
      *** 31 PÅ    ---> SORTERE PÅ TARIFFNR. + STATUS       (SVXV02)
      *** 31 AV    ---> SORTERE PÅ REGISTRERINGS REKKEFØLGE (SVXV)
     C     START7        TAG
     C                   MOVE      *ZEROS        W3VNT
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C     W3VNT         COMP      0                                      31
     C                   MOVE      W3LI          W3LIGM            5 0
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HOPD          BEGSR
     C***********************************************
     C     UPRO          IFEQ      0
     C                   MOVE      UPRO          WSPRO
     C     STPLUK        TAG
     C                   EXFMT     HENTPRO
     C                   MOVE      '0'           *IN30
     C   12              GOTO      SLPLUK
     C     WSPRO         CHAIN     TURER14                            30
     C   30              GOTO      STPLUK
     C                   MOVE      WSPRO         UPRO
     C                   END
      *
     C                   CALL      'SVX019R'
     C                   PARM      UAVD          UAVD2             4 0
     C                   PARM      UTDN          UTDN2             7 0
     C     ULI2          PARM      XLI           ULI2              5 0
     C                   PARM      UDK           UDK2              5
     C     UPRO          PARM      UPRO          UPRO2             8 0
     C                   PARM      ULSTL         ULSTL2            4 0
     C                   PARM                    UFLAGG            1 0
      *
     C     ULI2          IFGT      XLI
     C                   MOVE      'J'           XHOPD
     C     SVHK          SETLL     SVXV
     C     SVHK          READE(N)  SVXV                                   33
     C     *IN33         DOWEQ     '0'
     C     TVLI          IFGT      XLI
     C                   EXSR      CHGSVV
     C   12              LEAVE
     C                   END
     C     SVHK          READE(N)  SVXV                                   33
     C  N33              ENDDO
     C                   MOVE      ULI2          XLI
     C                   END
      *
     C                   MOVE      'N'           XHOPD
      *
     C     SLPLUK        ENDSR
      *
     C***********************************************
     C     HOPD2         BEGSR
     C***********************************************
     C                   CLEAR                   SVEVR
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
     C     XNYOPD        IFEQ      'J'
     C                   MOVE      W2AVD2        TVAVD2
     C                   MOVE      W2TDN2        TVTDN2
     C                   MOVE      XLI           TVLI
     C                   MOVE      XLI           XLI3
     C                   ELSE
     C                   MOVE      UAVD          TVAVD2
     C                   MOVE      UTDN          TVTDN2
     C                   MOVE      *ZEROS        TVLI
     C                   MOVE      *ZEROS        XLI3              5 0
     C                   END
     C     HEDFK3        CHAIN     HEADF                              34
      * OPPDATER STATUS FOR Å VISE AT LISTE ER SKREVET
     C  N34UDK           IFEQ      'T1   '                                      1<-B
     C                   MOVE      'A'           TRTSTA
     C                   ELSE                                                   1
     C                   MOVE      'B'           TRTSTA
     C                   END                                                    1<-E
     C  N34              UPDATE    HEADFR
     C     SVEHK3        CHAIN     SVEH                               35
     C     *IN35         IFEQ      '1'                                          1<-B
     C     *IN34         IFEQ      '0'                                           2<-B
      * IKKE FINNE SAD-EKSPORT, BRUK OPPDRAGSOPPLYSNINGER
     C                   ADD       1             TVLI
     C                   Z-ADD     HEVKT         TVVKTB
     C                   MOVEL     HEGM1         TVMN
     C                   MOVE      HENT          TVNT
     C                   MOVE      HENT          TVNTEH
     C                   MOVE      *BLANKS       TVDTY
     C                   MOVE      *BLANKS       TVDREF
     C     HETLL         IFNE      *BLANKS
N06  C                   EVAL      TVDTY = '830'
     C                   MOVEL     HETLE         TVDREF
     C                   CAT       HETLL:1       TVDREF
     C                   END
     C                   EXSR      HADR11
     C                   WRITE     SVXVR
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C                   EVAL      TVALK  = SVEH_AUKD
     C                   EVAL      TVBLK  = SVEH_AUBE
N06  C                   EVAL      TVDTY = '830'
     C                   EVAL      TVDREF=SVEH_TUID
     C                   MOVE      *OFF          *IN33
     C     SVEHK3        SETLL     SVEV
     C     SVEHK3        READE     SVEV                                   34
     C  N34              DOW       *IN33 = *OFF                                  2<-B
      * HOPP OVER ALLE TILLEGGSLINJER
     C     SVEHK3        READE     SVEV                                   33
     C  N33SVEV_NETO     IFNE      0                                              3<-B
     C                   LEAVE
     C                   END                                                      3<-E
     C                   ENDDO                                                   2<-E
      *
      * IKKE FINN SAD-EKSPORT (*IN34 PÅ) ELLER FLERE VARELINJER (*IN33 AV)
     C                   IF        (*IN34 OR (*IN33 = *OFF))                     2<-B
     C   34              CLEAR                   SVEVR
     C                   ADD       1             TVLI
     C                   MOVE      TVLI          TVLN
     C                   EVAL      TVVKTB = SVEH_BRUT
     C                   EVAL      TVVKTN = 0
     C                   IF        (*IN34 OR (SVEV_SUTX = *BLANKS))               3<-B
     C                   MOVEL     HEGM1         TVMN
     C                   ELSE                                                     3
     C                   EVAL      TVMN   = SVEV_SUTX
     C                   END                                                      3<-E
     C                   EVAL      TVVT   = SVEV_VASL
     C                   EVAL      TVEH   = SVEV_KOSL
     C                   EVAL      TVNT   = SVEH_KOTA
     C                   EVAL      TVNTEH = SVEH_KOTA
     C                   IF        *IN34 = *OFF                                   3<-B
     C     SVEHK3        SETLL     SVEV
     C     SVEHK3        READE     SVEV                                   33
     C  N33              DOW       *IN33 = *OFF                                    4<-B
     C                   EVAL      TVVKTN = TVVKTN + SVEV_NETO
     C     SVEHK3        READE     SVEV                                   33
     C                   ENDDO                                                     4<-E
     C                   END                                                      3<-E
     C                   EXSR      HADR12
     C                   WRITE     SVXVR
     C                   ELSE                                                    2
      * FINN KUN EN SAD-EKSPORT LINJE ELLER FORHÅNDSVARSLING
     C     SVEHK3        SETLL     SVEV
     C     SVEHK3        READE     SVEV                                   34
     C                   ADD       1             TVLI
     C                   MOVE      TVLI          TVLN
     C                   MOVEL     SVEV_VATA     TVVNT
     C                   EVAL      TVVKTB = SVEV_BRUT
     C                   EVAL      TVVKTN = SVEV_NETO
     C                   EVAL      TVNTEH = SVEV_ANKV
     C                   EVAL      TVMN   = SVEV_SUTX
     C                   IF        SVEV_KOTA = 0                                  3<-B
     C                   EVAL      TVNT   = SVEH_KOTA
     C                   ELSE                                                     3
     C                   EVAL      TVNT   = SVEV_KOTA
     C                   END                                                      3<-E
     C                   EVAL      TVEH   = SVEV_KOSL
     C                   EVAL      TVVT   = SVEV_VASL
     C                   EXSR      HADR12
     C                   WRITE     SVXVR
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
     C                   MOVE      TVLI          XLI
     C                   MOVE      'J'           XHOPD2
     C                   MOVE      '1'           *IN40
      *
     C     SVHK          SETLL     SVXV
     C     SVHK          READE(N)  SVXV                                   33
     C     *IN33         DOWEQ     '0'
     C     TVLI          IFGT      XLI3
     C                   EXSR      CHGSVV
     C   12              LEAVE
     C                   END
     C     SVHK          READE(N)  SVXV                                   33
     C  N33              ENDDO
      *
     C                   MOVE      'N'           XHOPD2
      *
     C                   ENDSR
      *
     C***********************************************
     C     HADR11        BEGSR
     C***********************************************
     C                   MOVE      HEKNS         TVKNS
     C                   MOVE      HENAS         TVNAS
     C                   MOVE      HEADS1        TVADS1
     C                   MOVEL     HEADS3        TVPNS
     C                   MOVEL     HEADS3        TVPSS
     C                   MOVEL     'SV'          TVSKS
     C     HEUR          IFEQ      'B'                                          1<-B
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      'SE'          TVLKS
     C                   ELSE                                                   1
     C                   MOVE      HELKA         TVLKS
     C                   END                                                    1<-E
     C     HEKNS         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       TVTINS
     C                   ELSE                                                   1
     C                   MOVE      HEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   MOVE      *BLANKS       TVTINS
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      TVTINS = TVLKS + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      TVTINS = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
     C                   MOVE      HEKNK         TVKNK
     C                   MOVE      HENAK         TVNAK
     C                   MOVE      HEADK1        TVADK1
     C                   MOVEL     HEADK3        TVPNK
     C                   MOVEL     HEADK3        TVPSK
     C                   MOVEL     'SV'          TVSKK
     C     HEUR          IFEQ      'A'                                          1<-B
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVEL     'SE'          TVLKK
     C                   ELSE                                                   1
     C                   MOVEL     HELKA         TVLKK
     C                   END                                                    1<-E
     C     HEKNK         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                   1
     C                   MOVE      HEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   MOVE      *BLANKS       TVTINK
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      TVTINK = TVLKK + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      TVTINK = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
     C     TVADS1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADS1
     C                   END                                                    1<-E
     C     TVADK1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADK1
     C                   END                                                    1<-E
      *
     C                   WRITE     SVXVAMR
      *
     C                   ENDSR
      *
     C***********************************************
     C     HADR12        BEGSR
     C***********************************************
     C                   EVAL      TVKNS  = SVEH_AVKN
     C                   EVAL      TVNAS  = SVEH_AVNA
     C                   EVAL      TVADS1 = SVEH_AVA1
     C                   EVAL      TVPNS  = SVEH_AVPN
     C                   EVAL      TVPSS  = SVEH_AVPA
     C                   EVAL      TVSKS  = 'SV'
     C                   EVAL      TVLKS  = SVEH_AVLK
     C                   EVAL      TVTINS = SVEH_AVEO
     C                   EVAL      TVKNK  = SVEH_MOKN
     C                   EVAL      TVNAK  = SVEH_MONA
     C                   EVAL      TVADK1 = SVEH_MOA1
     C                   EVAL      TVPNK  = SVEH_MOPN
     C                   EVAL      TVPSK  = SVEH_MOPA
     C                   EVAL      TVSKK  = 'SV'
     C                   EVAL      TVLKK  = SVEH_MOLK
     C     TVKNK         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                   1
     C                   MOVE      TVKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   MOVE      *BLANKS       TVTINK
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      TVTINK = TVLKK + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      TVTINK = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
     C     TVADS1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADS1
     C                   END                                                    1<-E
     C     TVADK1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADK1
     C                   END                                                    1<-E
      *
     C                   WRITE     SVXVAMR
      *
     C                   ENDSR
      *
     C***********************************************
     C     HADR21        BEGSR
     C***********************************************
     C                   MOVE      HEKNS         W2KNS
     C                   MOVE      HENAS         W2NAS
     C                   MOVE      HEADS1        W2ADS1
     C                   MOVEL     HEADS3        W2PNS
     C                   MOVEL     HEADS3        W2PSS
     C                   MOVEL     'SV'          W2SKS
     C     HEUR          IFEQ      'B'                                          1<-B
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      'SE'          W2LKS
     C                   ELSE                                                   1
     C                   MOVE      HELKA         W2LKS
     C                   END                                                    1<-E
     C     HEKNS         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       W2TINS
     C                   ELSE                                                   1
     C                   MOVE      HEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   MOVE      *BLANKS       W2TINS
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      W2TINS = W2LKS + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      W2TINS = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
     C                   MOVE      HEKNK         W2KNK
     C                   MOVE      HENAK         W2NAK
     C                   MOVE      HEADK1        W2ADK1
     C                   MOVEL     HEADK3        W2PNK
     C                   MOVEL     HEADK3        W2PSK
     C                   MOVEL     'SV'          W2SKK
     C     HEUR          IFEQ      'A'                                          1<-B
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVEL     'SE'          W2LKK
     C                   ELSE                                                   1
     C                   MOVEL     HELKA         W2LKK
     C                   END                                                    1<-E
     C     HEKNK         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       W2TINK
     C                   ELSE                                                   1
     C                   MOVE      HEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   MOVE      *BLANKS       W2TINK
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      W2TINK = W2LKK + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      W2TINK = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
     C     TVADS1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           W2ADS1
     C                   END                                                    1<-E
     C     TVADK1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           W2ADK1
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      'N'           XNYOPD            1
     C     W2AVD2        IFNE      0
     C     W2TDN2        ORNE      0
     C     HEDFK2        CHAIN(N)  HEADF                              90
     C   90SVEHK2        CHAIN     SVEH                               33
     C     *IN90         IFEQ      '1'
     C     *IN33         ANDEQ     '1'
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0818'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   ELSE
     C  N90SVEHK2        CHAIN     SVEH                               33
     C                   MOVE      *OFF          *IN90
     C     *IN40         IFEQ      '0'
     C     *IN33         ANDEQ     '0'
     C                   MOVE      'J'           XNYOPD
     C                   GOTO      SLTB1
     C                   ELSE
     C     W2NAS         IFEQ      *BLANKS
     C                   EXSR      HADR21
     C                   END
     C     W2BLK         IFEQ      *BLANKS
     C     UBLK          ANDNE     HELKA
     C                   MOVE      HELKA         W2BLK
     C                   END
     C     W2VKTB        IFEQ      0
     C     W2VKTN        ANDEQ     0
     C                   Z-ADD     HEVKT         W2VKTB
     C     W2VKTB        MULT      0.9           W2VKTN
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C                   TESTN                   W2VNTI               33
     C   33              MOVE      W2VNTI        W2VNT
     C  N33              MOVE      *ZEROS        W2VNT
N02  C                   IF        ((W2VNT <> 0) AND (W2VT = *BLANKS))
N02  C                   EVAL      UVNT = W2VNTI
N02  C                   EVAL      XVNTNUL = %TRIM(W2VNTI) + '000000000'
N02  C                   EVAL      XVNTMAX = %TRIM(W2VNTI) + '999999999'
N02  C     UVNT          SETLL     SVTVS
N02  C                   READ      SVTVS                                  33
N02  C  N33XVNTMAX       COMP      SVVS_VATA                            33
N02  C  N33              EVAL      W2VT = SVVS_TXTK
N02  C  N33              IF        SVVS_VATA = XVNTNUL
N02  C                   READ      SVTVS                                  33
N02  C  N33XVNTMAX       COMP      SVVS_VATA                            33
N02  C  N33              EVAL      W2VT = SVVS_TXTK
N02  C                   END
N02  C                   END
      *
     C     W2KNS         IFNE      0
     C     W2NAS         ORNE      *BLANKS
     C                   EXSR      TESTSS
     C                   END
      *
     C     W2KNK         IFNE      0
     C     W2NAK         ORNE      *BLANKS
     C                   EXSR      TESTKK
     C                   END
      *
     C     W2VNT         IFNE      0
     C     W2FV          ORNE      *BLANKS
     C                   MOVE      '    '        W2VNTA10
N09  C     W2VNTA10      SETLL     SVTX04F
N09  C                   READ      SVTX04R                                89
     C                   MOVE      '9999'        W2VNTA10
N09  C  N89W2VNTA10      COMP      SVTX04_02                            89
     C     *IN89         IFEQ      '1'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SPT0033'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   ELSE
     C                   IF        TGGFV <> 'J'
     C     W2VNT         CHAIN     SVXFKDF                            33
     C                   IF        *IN33 = *OFF
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX1903'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN98
     C                   END
     C                   END
     C  N98W2VT          IFEQ      *BLANKS
     C                   END
     C                   END
     C                   END
      *
     C     ULSTL         IFGT      0
     C     W2VT          ANDEQ     *BLANKS
     C                   MOVEL     'SE VEDLA'    W2VT
     C     W2VT          CAT       'GTE LA':0    W2VT
     C     W2VT          CAT       'STLIST':0    W2VT
     C     W2VT          CAT       'E':0         W2VT
     C                   END
      *
     C     W2DK          IFNE      *BLANKS
     C     UDK           OREQ      'T-'
     C                   MOVE      '031'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2DK          YKODE
     C     SVK01K        CHAIN     SVXKODL01                          88
     C     *IN88         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   MOVE      'SVX0809'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     UALK          IFEQ      *BLANKS
     C     W2ALK         CHAIN     SVTLK                              87
     C     *IN87         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     50            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       W2ALK
     C                   END
      *
     C     UBLK          IFEQ      *BLANKS
     C     W2BLK         CHAIN     SVTLK                              86
     C     *IN86         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     70            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       W2BLK
     C                   END
      *
     C     W2VT          COMP      *BLANKS                                85
     C     *IN85         IFEQ      '1'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0840'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2VTSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2VTSK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          84
     C     *IN84         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     70            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   SELECT
     C     W2VKTB        WHENNE    0
     C     W2VKTN        WHENNE    0
     C     W2VKTB        IFEQ      0
     C     W2VKTN        MULT(H)   1.1           W2VKTB
     C                   END
     C                   OTHER
     C                   MOVE      '1'           *IN83
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SPV0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   ENDSL
      *
     C     W2TDT         IFNE      *BLANKS
     C     W2TDR         ORNE      *BLANKS
     C                   MOVE      '014'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2TDT         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          82
     C     *IN82         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2TDT         IFNE      *BLANKS
     C     W2TDR         COMP      *BLANKS                                81
     C     *IN81         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   MOVE      'SVX0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     *IN81         IFEQ      '0'
     C     *IN47         ANDEQ     '1'
     C     W2TDT         ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN82
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0836'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2TDSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2TDSK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          80
     C     *IN80         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     38            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2TDOS        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2TDOS        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          79
     C     *IN79         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2DTY         IFNE      *BLANKS
     C                   MOVE      '013'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2DTY         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          78
     C     *IN78         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0813'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2DREF        COMP      *BLANKS                                77
     C     *IN77         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'SVX0814'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2DSK         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2DSK         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          76
     C     *IN76         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     60            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2DOSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2DOSK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          75
     C     *IN75         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2TLO         IFNE      *BLANKS
     C                   MOVE      '039'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2TLO         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          74
     C     *IN74         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0815'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
     C  N75W2TLO         IFNE      'DG0'
     C     W2TLO         ANDNE     'DG1'
     C                   MOVE      *ZEROS        W2EXKD
     C                   MOVE      *BLANKS       W2EXLK
     C                   END
      *
     C     W2TLO         IFNE      *BLANKS
     C     W2EXLK        IFNE      *BLANKS
     C     W2EXKD        OREQ      0
N07  C     W2TLO         ANDNE     'CAL'
     C     W2EXLK        CHAIN     SVTLK                              73
     C     *IN73         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     43            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
     C                   END
      *
     C     W2MSK         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2MSK         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          72
     C     *IN72         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2EH          IFNE      *BLANKS
     C     W2EH          ANDNE     'NE'
N04  C     W2EH          ANDNE     'NF'
N04  C     W2EH          ANDNE     'VS'
     C     W2EH          ANDNE     'VQ'
     C     W2EH          ANDNE     'VG'
     C     W2EH          ANDNE     'VL'
     C     W2EH          ANDNE     'VY'
     C     W2EH          ANDNE     'VR'
     C     W2EH          ANDNE     'VO'
     C     W2MN          IFEQ      *BLANKS
N10  C                   MOVEL     'ADRESS'      W2MN
     C                   END
     C                   END

     C     *IN71         IFEQ      '0'
     C     *IN46         ANDEQ     '1'
     C     W2MN          ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN71
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0835'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END

     C     W2MNSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2MNSK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          70
     C     *IN70         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     40            POSNBR
     C                   MOVE      'SVX0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     UKDC          IFEQ      '1'
     C     *IN28         OREQ      '1'
     C     W2CNR         COMP      *BLANKS                                69
     C     *IN69         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0828'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     ULSTL         IFEQ      0
     C     W2EH          ORNE      *BLANKS
     C                   MOVE      '017'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2EH          YKODE
     C     SVK01K        CHAIN     SVXKODL01                          68
     C     *IN68         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0816'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C  N69W2EH          IFEQ      'NE'
N04  C     W2EH          OREQ      'NF'
N04  C     W2EH          OREQ      'VS'
     C     W2EH          OREQ      'VQ'
     C     W2EH          OREQ      'VG'
     C     W2EH          OREQ      'VL'
     C     W2EH          OREQ      'VY'
     C     W2EH          OREQ      'VR'
     C     W2EH          OREQ      'VO'
     C                   MOVE      *ZEROS        W2NT
     C                   END
      *
     C     W2EH          IFEQ      'NE'
N04  C     W2EH          OREQ      'NF'
     C     W2NTEH        COMP      0                                      66
     C     *IN66         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   MOVE      'SVX0825'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        W2NTEH
     C                   END
      *
      *** TEST PÅ KODE FOR FØLSOMME VARE KOMMER SENERE
     C     *IN45         IFEQ      '1'
     C     W2FV          ANDEQ     *BLANKS
     C     W2FVNT        ANDEQ     0
     C                   MOVE      '1'           *IN65
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SVX0834'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C                   ELSE
      *
     C     W2VNT         CHAIN     SVXFKDF                            33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       W2FV
     C                   MOVE      *ZEROS        W2FVNT
     C                   ELSE
     C                   MOVE      TFKODE        W2FV
     C     W2FVNT        COMP      0                                      64
     C     *IN64         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   MOVE      'SVX0817'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   END
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     TESTSS        BEGSR
     C***********************************************
     C     W2KNS         IFNE      0
     C                   MOVE      W2KNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            63
     C     *IN63         IFEQ      '1'
     C     *IN30         IFEQ      '0'
     C                   MOVE      'SPK0001'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   SETON                                        30
     C                   END
     C                   ELSE
     C                   IF        W2NAS = *BLANKS
     C                   MOVE      KNAVN         W2NAS
     C                   MOVE      ADR1          W2ADS1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2PNS
     C                   MOVEL     POSTNR        W2PNS
     C                   ELSE
     C                   MOVEL     SYPOGE        W2PNS
     C                   END
     C                   MOVE      ADR3          W2PSS
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        W2LKS
     C                   END
     C     W2TINS        IFEQ      *BLANKS
     C                   SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      W2TINS = W2LKS + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      W2TINS = EORI
     C                   ENDSL                                                   2<-E
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     W2PNS         COMP      *BLANKS                                55
     C  N30*IN55         IFEQ      '1'
     C                   MOVE      'SVX1878'     MSGNR
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETON                                        30
     C                   END
      *
     C     W2PSS         COMP      *BLANKS                                54
     C  N30*IN54         IFEQ      '1'
     C                   MOVE      'SVX1879'     MSGNR
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C     W2LKS         CHAIN     SVTLK                              61
     C     *IN61         IFEQ      '1'
     C     *IN30         IFEQ      '0'
     C                   MOVE      'SPL0001'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   SETON                                        30
     C                   END
     C                   ELSE
     C                   END
      *
     C     W2SKS         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2SKS         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          59
     C  N30*IN59         IFEQ      '1'
     C                   MOVE      'SVX0810'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTKK        BEGSR
     C***********************************************
     C     W2KNK         IFNE      0
     C                   MOVE      W2KNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            62
     C     *IN62         IFEQ      '1'
     C     *IN30         IFEQ      '0'
     C                   MOVE      'SPK0001'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     53            POSNBR
     C                   SETON                                        30
     C                   END
     C                   ELSE
     C                   IF        W2NAK = *BLANKS
     C                   MOVE      KNAVN         W2NAK
     C                   MOVE      ADR1          W2ADK1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2PNK
     C                   MOVEL     POSTNR        W2PNK
     C                   ELSE
     C                   MOVEL     SYPOGE        W2PNK
     C                   END
     C                   MOVE      ADR3          W2PSK
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        W2LKK
     C                   END
     C     W2TINK        IFEQ      *BLANKS
     C                   SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFORE <> *BLANKS) AND (SYFORE <> *ZEROS))   3<-B
     C                   EVAL      W2TINK = W2LKK + SYFOR9
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      W2TINK = EORI
     C                   ENDSL                                                   2<-E
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     W2PNK         COMP      *BLANKS                                53
     C  N30*IN53         IFEQ      '1'
     C                   MOVE      'SVX1878'     MSGNR
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     42            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C     W2PSK         COMP      *BLANKS                                52
     C  N30*IN52         IFEQ      '1'
     C                   MOVE      'SVX1879'     MSGNR
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     52            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C     W2LKK         CHAIN     SVTLK                              58
     C     *IN58         IFEQ      '1'
     C     *IN30         IFEQ      '0'
     C                   MOVE      'SPL0001'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     52            POSNBR
     C                   SETON                                        30
     C                   END
     C                   ELSE
     C                   END
      *
     C     W2SKK         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2SKK         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          57
     C  N30*IN57         IFEQ      '1'
     C                   MOVE      'SVX0810'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
      *** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
      *** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
      *** OPSJON 2 ---> ENDRE DETALJE LINJE.
      *** OPSJON 4 ---> SLETTE DETALJE LINJE.
      *** OPSJON 5 ---> VISE DETALJE LINJE
      *** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGSVV
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTSVV
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISSVV
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     VISSVV        BEGSR
     C***********************************************
     C                   SETON                                        99
      *
     C                   MOVE      TVLI          W2LI
     C                   MOVE      TVVT          W2VT
     C                   MOVE      TVVTSK        W2VTSK
     C                   MOVE      TVTDT         W2TDT
     C                   MOVE      TVTDR         W2TDR
     C                   MOVE      TVTDSK        W2TDSK
     C                   MOVE      TVTDO         W2TDO
     C                   MOVE      TVTDOS        W2TDOS
     C                   MOVE      TVDTY         W2DTY
     C                   MOVE      TVDREF        W2DREF
     C                   MOVE      TVDSK         W2DSK
     C                   MOVE      TVDO          W2DO
     C                   MOVE      TVDOSK        W2DOSK
     C                   MOVE      TVTLO         W2TLO
     C                   MOVE      TVEXKD        W2EXKD
     C                   MOVE      TVEXLK        W2EXLK
     C                   MOVE      TVMTXT        W2MTXT
     C                   MOVE      TVMSK         W2MSK
     C                   MOVE      TVMN          W2MN
     C                   MOVE      TVMNSK        W2MNSK
     C                   MOVE      TVCNR         W2CNR
     C                   MOVE      TVNT          W2NT
     C                   MOVE      TVEH          W2EH
     C                   MOVE      TVNTEH        W2NTEH
     C                   MOVE      TVFV          W2FV
     C                   MOVE      TVFVNT        W2FVNT
     C                   EXSR      TSTOPL
     C                   MOVE      W2VT          TVVT
     C                   MOVE      W2VTSK        TVVTSK
     C                   MOVE      W2TDT         TVTDT
     C                   MOVE      W2TDR         TVTDR
     C                   MOVE      W2TDSK        TVTDSK
     C                   MOVE      W2TDO         TVTDO
     C                   MOVE      W2TDOS        TVTDOS
     C                   MOVE      W2DTY         TVDTY
     C                   MOVE      W2DREF        TVDREF
     C                   MOVE      W2DSK         TVDSK
     C                   MOVE      W2DO          TVDO
     C                   MOVE      W2DOSK        TVDOSK
     C                   MOVE      W2TLO         TVTLO
     C                   MOVE      W2EXKD        TVEXKD
     C                   MOVE      W2EXLK        TVEXLK
     C                   MOVE      W2MTXT        TVMTXT
     C                   MOVE      W2MSK         TVMSK
     C                   MOVE      W2MN          TVMN
     C                   MOVE      W2MNSK        TVMNSK
     C                   MOVE      W2CNR         TVCNR
     C                   MOVE      W2NT          TVNT
     C                   MOVE      W2EH          TVEH
     C                   MOVE      W2NTEH        TVNTEH
     C                   MOVE      W2FV          TVFV
     C                   MOVE      W2FVNT        TVFVNT
     C     SVVK2         CHAIN(N)  SVXVAM                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *ZEROS        TVKNS
     C                   MOVE      *BLANKS       TVNAS
     C                   MOVE      *BLANKS       TVADS1
     C                   MOVE      *BLANKS       TVPNS
     C                   MOVE      *BLANKS       TVPSS
     C                   MOVE      *BLANKS       TVLKS
     C                   MOVE      *BLANKS       TVSKS
     C                   MOVE      *BLANKS       TVTINS
     C                   MOVE      *ZEROS        TVKNK
     C                   MOVE      *BLANKS       TVNAK
     C                   MOVE      *BLANKS       TVADK1
     C                   MOVE      *BLANKS       TVPNK
     C                   MOVE      *BLANKS       TVPSK
     C                   MOVE      *BLANKS       TVLKK
     C                   MOVE      *BLANKS       TVSKK
     C                   MOVE      *BLANKS       TVTINK
     C                   END
     C     STVIS         TAG
     C                   EXFMT     VAREL3
      *
     C   15              DO
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STVIS
     C                   END
      *
     C                   IF        XFORHV = 'J'
     C                   CALL      'SVX012RA'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    TVLI
     C                   PARM                    UIN27
     C                   PARM                    UFLAGG
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTSVV        BEGSR
     C***********************************************
     C                   Z-ADD     ZRECNO        XRECN2            4 0
     C                   MOVE      *ZEROS        LI
      *** OPERASJON 1
     C                   MOVE      TVLI          LI(1)
     C                   Z-ADD     1             XN                3 0
     C     *IN98         DOWEQ     '0'                                          1<-B
     C     STDLT1        TAG
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '4'                                           2<-B
     C                   MOVE      *ZEROS        XN2               3 0
     C     XN2           DOWLT     XN                                             3<-B
     C                   ADD       1             XN2
     C                   END                                                      3<-E
     C                   ADD       1             XN
     C                   MOVE      TVLI          LI(XN)
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *** OPERASJON 2
     C                   MOVE      '1'           *IN43
     C                   WRITE     SUBCTL2
     C                   MOVEA     '00'          *IN(43)
     C                   Z-ADD     *ZEROS        ZRECN2
     C                   MOVE      *ZEROS        XN2
     C     XN2           DOWLT     XN                                           1<-B
     C                   ADD       1             XN2
     C     SVV21         SETLL     SVXV02
     C                   SETOFF                                       44
     C     STDLT2        TAG
     C     SVV21         READE     SVXV02                                 44
     C  N44              DO                                                      2<-B
     C     LI(XN2)       IFEQ      TVLI                                           3<-B
     C                   ADD       1             ZRECN2
     C                   MOVE      TVLI          XLI2              5 0
     C                   WRITE     SUBFIL2
     C                   END                                                      3<-E
     C                   GOTO      STDLT2
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *** OPERASJON 3
     C                   Z-ADD     1             ZRECN2
     C     STDLT3        TAG
     C                   MOVEA     '11'          *IN(41)
     C                   WRITE     SUBCTL2
     C                   EXFMT     BUNN2
     C   25              GOTO      STDLT3
     C   12              Z-ADD     XRECN2        ZRECNO
     C  N12              DO                                                     1<-B
     C                   MOVE      *ZEROS        ZRECN2
     C     STDLT4        TAG
     C                   ADD       1             ZRECN2
     C     ZRECN2        CHAIN     SUBFIL2                            98
     C  N98              DO                                                      2<-B
     C     SVVK2         CHAIN     SVXV                               41
     C  N41              DO                                                       3<-B
     C                   DELETE    SVXVR
     C     SVVK2         CHAIN     SVXVAM                             41
     C  N41              DELETE    SVXVAMR
     C     SVVK2         CHAIN     SVXVFV                             41
     C  N41              DELETE    SVXVFVR
     C                   MOVE      TVLI          W2LI
     C                   EXSR      DLTOPL
      *** TVREFL > 0 ==> DENNE ER EKSTRALINJE OG SENKE ANTALL EXTRA
      ***                LINJER HOVEDLINJE HAR MED EN.
     C     TVREFL        IFGT      0                                               4<-B
     C                   MOVE      TVREFL        W2LI
     C     SVVK          CHAIN     SVXV                               33
     C  N33              ADD       1             TVREFL
     C  N33              UPDATE    SVXVR
     C                   END                                                       4<-E
     C                   GOTO      STDLT4
     C                   END                                                     2<-E
     C                   END
     C                   EXSR      MOVB1
     C                   END                                                    1<-E
     C                   SETOFF                                       4198
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGSVV        BEGSR
     C***********************************************
      *** FLYTTE DATA FRA SUBFIL TIL ARBEIDSVARIABLER
     C                   EXSR      MOVSVW
      *
     C     STCHG         TAG
     C  N30              EXSR      TSTOPL
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000000'    *IN(75)
     C                   MOVEA     '00000000'    *IN(67)
     C                   MOVEA     '000000'      *IN(61)
     C                   MOVEA     '000'         *IN(57)
     C                   MOVEA     '0000'        *IN(52)
     C                   MOVE      '0'           *IN30
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      STCHG
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN12         IFEQ      '1'
      *** F12 ---> AVBRYTTE ENDRING
     C     XHOPD         IFNE      'J'
     C     XHOPD2        ANDNE     'J'
     C                   UPDATE    SUBFIL
     C                   END
     C                   ELSE
      *** TESTE INNTASTEDE TADA. HVIS IKKE NOE FEIL, OPPDRATERE PÅ FIL
     C                   EXSR      TESTB1
     C   30              GOTO      STCHG
     C                   EXSR      OPDSVV
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSVV        BEGSR
     C***********************************************
      *** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     SVVK          CHAIN     SVXV                               33
      *** FLYTTE INNTASTET DATA TIL FIL-VARIABLER OG OPPDATERE DEM.
     C                   EXSR      MOVWSV
     C     *IN33         IFEQ      '0'
     C                   UPDATE    SVXVR
     C                   ELSE
     C                   MOVE      *ZEROS        TVLN
     C                   MOVE      *ZEROS        YLN
     C                   WRITE     SVXVR
     C                   END
      *
     C                   IF        XFORHV = 'J'
     C                   CALL      'SVX012RA'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    TVLI
     C                   PARM                    UIN27
     C                   PARM                    UFLAGG
     C                   END
      *
      *** OPPDATERE PÅ SUBFIL
     C                   MOVE      TVLI          XLI2              5 0
     C                   MOVE      TVLN          WXLN
     C                   EXSR      SRSUMKL
      *
     C     XHOPD         IFNE      'J'
     C     XHOPD2        ANDNE     'J'
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSUMKL       BEGSR
      ***********************************************
     C     TVNT          IFEQ      0
     C                   MOVE      TVNTEH        XVNTK
     C                   ELSE
     C                   MOVE      TVNT          XVNTK
     C                   END
     C                   MOVE      TVEH          XVEH
     C                   MOVE      TVMN          XTVMN            17
     C                   MOVE      TVMNSK        XTVMNSK           2
     C                   MOVE      TVEH          XTVEH             2
     C                   MOVE      TVNT          XTVNT             5 0
     C                   MOVE      TVNTEH        XTVNTEH           5 0
     C     SVVK2         SETLL     SVXVMN
     C     SVVK2         READE(N)  SVXVMN                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        TVEH <> XVEH
     C                   MOVE      '**'          XVEH
     C                   END
     C     TVNT          IFEQ      0
     C                   ADD       TVNTEH        XVNTK
     C                   ELSE
     C                   ADD       TVNT          XVNTK
     C                   END
     C     SVVK2         READE(N)  SVXVMN                                 33
     C                   ENDDO
     C                   MOVE      XTVMN         TVMN
     C                   MOVE      XTVMNSK       TVMNSK
     C                   MOVE      XTVEH         TVEH
     C                   MOVE      XTVNT         TVNT
     C                   MOVE      XTVNTEH       TVNTEH
      *
     C                   ENDSR
      *
     C***********************************************
     C     TILKOD        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      10
     C                   CALL      'SVX024R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    W2LI
     C                   PARM                    W2VT
     C                   PARM                    W2VTSK
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      12
     C                   CALL      'SVX023R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    W2LI
     C                   PARM                    W2TDT
     C                   PARM                    W2TDR
     C                   PARM                    W2TDSK
     C                   PARM                    W2TDO
     C                   PARM                    W2TDOS
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFGE      13
     C     LINNBR        ANDLE     17
     C                   CALL      'SVX020R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    W2LI
     C                   PARM                    W2DTY
     C                   PARM                    W2DREF
     C                   PARM                    W2DSK
     C                   PARM                    W2DO
     C                   PARM                    W2DOSK
     C                   PARM                    W2TLO
     C                   PARM                    W2EXKD
     C                   PARM                    W2EXLK
     C                   PARM                    W2MTXT
     C                   PARM                    W2MSK
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     27
     C     LINNBR        OREQ      20
     C                   CALL      'SVX022R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    W2LI
     C                   PARM                    W2MN
     C                   PARM                    W2MNSK
     C                   PARM                    W2EH
     C                   PARM                    W2NT
     C                   PARM                    W2NTEH
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     20
     C                   CALL      'SVX018R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    W2LI
     C                   PARM                    W2CNR
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     26
     C                   CALL      'SVX021R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    W2LI
     C                   PARM                    W2VNT
     C                   PARM                    W2FV
     C                   PARM                    W2FVNT
     C                   PARM                    UIN27
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVSVW        BEGSR
     C***********************************************
     C                   SETON                                        99
     C     XHOPD2        IFEQ      'J'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   ELSE
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   END
     C                   SETON                                        40
      *
     C                   MOVE      TVLN          YLN               5 0
     C                   MOVE      TVLI          W2LI
     C                   MOVE      TVVNT         W2VNT
     C                   MOVE      TVVNT         W2VNTI
     C                   MOVE      TVDK          W2DK
     C                   MOVE      TVALK         W2ALK
     C                   MOVE      TVBLK         W2BLK
     C                   MOVE      TVVT          W2VT
     C                   MOVE      TVVTSK        W2VTSK
     C                   MOVE      TVVKTB        W2VKTB
     C                   MOVE      TVVKTN        W2VKTN
     C                   MOVE      TVCNR         W2CNR
     C                   MOVE      TVTDO         W2TDO
     C                   MOVE      TVTDOS        W2TDOS
     C                   MOVE      TVTDT         W2TDT
     C                   MOVE      TVTDR         W2TDR
     C                   MOVE      TVTDSK        W2TDSK
     C                   MOVE      TVDTY         W2DTY
     C                   MOVE      TVDREF        W2DREF
     C                   MOVE      TVDSK         W2DSK
     C                   MOVE      TVDO          W2DO
     C                   MOVE      TVDOSK        W2DOSK
     C                   MOVE      TVTLO         W2TLO
     C                   MOVE      TVEXKD        W2EXKD
     C                   MOVE      TVEXLK        W2EXLK
     C                   MOVE      TVMTXT        W2MTXT
     C                   MOVE      TVMSK         W2MSK
     C                   MOVE      TVMN          W2MN
     C                   MOVE      TVMNSK        W2MNSK
     C                   MOVE      TVEH          W2EH
     C                   MOVE      TVNT          W2NT
     C                   MOVE      TVNTEH        W2NTEH
     C                   MOVE      TVFV          W2FV
     C                   MOVE      TVFVNT        W2FVNT
     C                   MOVE      TVAVD2        W2AVD2
     C                   MOVE      TVTDN2        W2TDN2
     C     SVVK2         CHAIN(N)  SVXVAM                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *ZEROS        W2KNS
     C                   MOVE      *BLANKS       W2NAS
     C                   MOVE      *BLANKS       W2ADS1
     C                   MOVE      *BLANKS       W2PNS
     C                   MOVE      *BLANKS       W2PSS
     C                   MOVE      *BLANKS       W2LKS
     C                   MOVE      *BLANKS       W2SKS
     C                   MOVE      *BLANKS       W2TINS
     C                   MOVE      *ZEROS        W2KNK
     C                   MOVE      *BLANKS       W2NAK
     C                   MOVE      *BLANKS       W2ADK1
     C                   MOVE      *BLANKS       W2PNK
     C                   MOVE      *BLANKS       W2PSK
     C                   MOVE      *BLANKS       W2LKK
     C                   MOVE      *BLANKS       W2SKK
     C                   MOVE      *BLANKS       W2TINK
     C                   ELSE
     C                   MOVE      TVKNS         W2KNS
     C                   MOVE      TVNAS         W2NAS
     C                   MOVE      TVADS1        W2ADS1
     C                   MOVE      TVPNS         W2PNS
     C                   MOVE      TVPSS         W2PSS
     C                   MOVE      TVLKS         W2LKS
     C                   MOVE      TVSKS         W2SKS
     C                   MOVE      TVTINS        W2TINS
     C                   MOVE      TVKNK         W2KNK
     C                   MOVE      TVNAK         W2NAK
     C                   MOVE      TVADK1        W2ADK1
     C                   MOVE      TVPNK         W2PNK
     C                   MOVE      TVPSK         W2PSK
     C                   MOVE      TVLKK         W2LKK
     C                   MOVE      TVSKK         W2SKK
     C                   MOVE      TVTINK        W2TINK
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWSV        BEGSR
     C***********************************************
     C   33              MOVE      *ZEROS        TVREFL
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
     C                   MOVE      ' '           TV01
     C                   MOVE      W2LI          TVLI
     C                   MOVE      W2VNT         TVVNT
     C                   MOVE      W2DK          TVDK
     C                   MOVE      W2ALK         TVALK
     C                   MOVE      W2BLK         TVBLK
     C                   MOVE      W2VT          TVVT
     C                   MOVE      W2VTSK        TVVTSK
     C                   MOVE      W2VKTB        TVVKTB
     C                   MOVE      W2VKTN        TVVKTN
     C                   MOVE      W2CNR         TVCNR
     C                   MOVE      W2TDO         TVTDO
     C                   MOVE      W2TDOS        TVTDOS
     C                   MOVE      W2TDT         TVTDT
     C                   MOVE      W2TDR         TVTDR
     C                   MOVE      W2TDSK        TVTDSK
     C                   MOVE      W2DTY         TVDTY
     C                   MOVE      W2DREF        TVDREF
     C                   MOVE      W2DSK         TVDSK
     C                   MOVE      W2DO          TVDO
     C                   MOVE      W2DOSK        TVDOSK
     C                   MOVE      W2TLO         TVTLO
     C                   MOVE      W2EXKD        TVEXKD
     C                   MOVE      W2EXLK        TVEXLK
     C                   MOVE      W2MTXT        TVMTXT
     C                   MOVE      W2MSK         TVMSK
     C                   MOVE      W2MN          TVMN
     C                   MOVE      W2MNSK        TVMNSK
     C                   MOVE      W2EH          TVEH
     C                   MOVE      W2NT          TVNT
     C                   MOVE      W2NTEH        TVNTEH
     C                   MOVE      W2FV          TVFV
     C                   MOVE      W2FVNT        TVFVNT
     C                   MOVE      W2AVD2        TVAVD2
     C                   MOVE      W2TDN2        TVTDN2
     C                   MOVE      *IN33         XIN33             1
     C     SVVK2         CHAIN     SVXVAM                             33
     C                   MOVE      W2KNS         TVKNS
     C                   MOVE      W2NAS         TVNAS
     C                   IF        ((W2ADS1 = *BLANKS) AND (W2NAS <> *BLANKS))
     C                   EVAL      W2ADS1 = '.'
     C                   END
     C                   MOVE      W2ADS1        TVADS1
     C                   MOVE      W2PNS         TVPNS
     C                   MOVE      W2PSS         TVPSS
     C                   MOVE      W2LKS         TVLKS
     C                   MOVE      W2SKS         TVSKS
     C                   MOVE      W2TINS        TVTINS
     C                   MOVE      W2KNK         TVKNK
     C                   MOVE      W2NAK         TVNAK
     C                   IF        ((W2ADK1 = *BLANKS) AND (W2NAK <> *BLANKS))
     C                   EVAL      W2ADK1 = '.'
     C                   END
     C                   MOVE      W2ADK1        TVADK1
     C                   MOVE      W2PNK         TVPNK
     C                   MOVE      W2PSK         TVPSK
     C                   MOVE      W2LKK         TVLKK
     C                   MOVE      W2SKK         TVSKK
     C                   MOVE      W2TINK        TVTINK
     C     *IN33         IFEQ      '1'
     C     TVKNS         IFNE      0
     C     TVNAS         ORNE      *BLANKS
     C     TVKNK         ORNE      0
     C     TVNAK         ORNE      *BLANKS
     C                   WRITE     SVXVAMR
     C                   END
     C                   ELSE
     C     TVKNS         IFNE      0
     C     TVNAS         ORNE      *BLANKS
     C     TVKNK         ORNE      0
     C     TVNAK         ORNE      *BLANKS
     C                   UPDATE    SVXVAMR
     C                   ELSE
     C                   DELETE    SVXVAMR
     C                   END
     C                   END
     C                   MOVE      XIN33         *IN33
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       TV01
     C                   MOVE      *ZEROS        TVLI
     C                   MOVE      *ZEROS        TVVNT
     C                   MOVE      *BLANKS       TVDK
     C                   MOVE      *BLANKS       TVALK
     C                   MOVE      *BLANKS       TVBLK
     C                   MOVE      *BLANKS       TVVT
     C                   MOVE      *BLANKS       TVVTSK
     C                   MOVE      *ZEROS        TVVKTB
     C                   MOVE      *ZEROS        TVVKTN
     C                   MOVE      *BLANKS       TVCNR
     C                   MOVE      *BLANKS       TVTDO
     C                   MOVE      *BLANKS       TVTDOS
     C                   MOVE      *BLANKS       TVTDT
     C                   MOVE      *BLANKS       TVTDR
     C                   MOVE      *BLANKS       TVTDSK
     C                   MOVE      *BLANKS       TVDTY
     C                   MOVE      *BLANKS       TVDREF
     C                   MOVE      *BLANKS       TVDSK
     C                   MOVE      *BLANKS       TVDO
     C                   MOVE      *BLANKS       TVDOSK
     C                   MOVE      *BLANKS       TVTLO
     C                   MOVE      *ZEROS        TVEXKD
     C                   MOVE      *BLANKS       TVEXLK
     C                   MOVE      *BLANKS       TVMTXT
     C                   MOVE      *BLANKS       TVMSK
     C                   MOVE      *BLANKS       TVMN
     C                   MOVE      *BLANKS       TVMNSK
     C                   MOVE      *BLANKS       TVEH
     C                   MOVE      *ZEROS        TVNT
     C                   MOVE      *ZEROS        TVNTEH
     C                   MOVE      *BLANKS       XVEH
     C                   MOVE      *ZEROS        XVNTK
     C                   MOVE      *BLANKS       TVFV
     C                   MOVE      *ZEROS        TVFVNT
     C                   MOVE      *ZEROS        TVAVD2
     C                   MOVE      *ZEROS        TVTDN2
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVEA     '00'          *IN(28)
     C                   MOVEA     '0000'        *IN(45)
     C                   MOVE      *ZEROS        W2LI
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *BLANKS       W2VNTI
     C                   MOVE      *BLANKS       W2DK
     C                   MOVE      *BLANKS       W2ALK
     C                   MOVE      *BLANKS       W2BLK
     C                   MOVE      *BLANKS       W2VT
     C                   MOVE      *BLANKS       W2VTSK
     C                   MOVE      *ZEROS        W2VKTB
     C                   MOVE      *ZEROS        W2VKTN
     C                   MOVE      *BLANKS       W2CNR
     C                   MOVE      *BLANKS       W2TDO
     C                   MOVE      *BLANKS       W2TDOS
     C                   MOVE      *BLANKS       W2TDT
     C                   MOVE      *BLANKS       W2TDR
     C                   MOVE      *BLANKS       W2TDSK
     C                   MOVE      *BLANKS       W2DTY
     C                   MOVE      *BLANKS       W2DREF
     C                   MOVE      *BLANKS       W2DSK
     C                   MOVE      *BLANKS       W2DO
     C                   MOVE      *BLANKS       W2DOSK
     C                   MOVE      *BLANKS       W2TLO
     C                   MOVE      *ZEROS        W2EXKD
     C                   MOVE      *BLANKS       W2EXLK
     C                   MOVE      *BLANKS       W2MTXT
     C                   MOVE      *BLANKS       W2MSK
     C                   MOVE      *BLANKS       W2MN
     C                   MOVE      *BLANKS       W2MNSK
     C                   MOVE      *BLANKS       W2EH
     C                   MOVE      *ZEROS        W2NT
     C                   MOVE      *ZEROS        W2NTEH
     C                   MOVE      *BLANKS       W2FV
     C                   MOVE      *ZEROS        W2FVNT
     C                   MOVE      *ZEROS        W2AVD2
     C                   MOVE      *ZEROS        W2TDN2
     C                   MOVE      *ZEROS        W2KNS
     C                   MOVE      *BLANKS       W2NAS
     C                   MOVE      *BLANKS       W2ADS1
     C                   MOVE      *BLANKS       W2PNS
     C                   MOVE      *BLANKS       W2PSS
     C                   MOVE      *BLANKS       W2LKS
     C                   MOVE      *BLANKS       W2SKS
     C                   MOVE      *BLANKS       W2TINS
     C                   MOVE      *ZEROS        W2KNK
     C                   MOVE      *BLANKS       W2NAK
     C                   MOVE      *BLANKS       W2ADK1
     C                   MOVE      *BLANKS       W2PNK
     C                   MOVE      *BLANKS       W2PSK
     C                   MOVE      *BLANKS       W2LKK
     C                   MOVE      *BLANKS       W2SKK
     C                   MOVE      *BLANKS       W2TINK
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C   17              Z-ADD     2             UFLAGG            1 0
     C   03              Z-ADD     3             UFLAGG            1 0
      *
     C                   MOVE      *ZEROS        AV
     C                   MOVE      *ZEROS        OP
     C                   MOVE      *ZEROS        WSTBL
     C                   MOVE      '0'           *IN99
      *
     C                   MOVE      'N'           XKOLLI            1
     C     SVHK          SETLL     SVXV
     C     SVHK          READE(N)  SVXV                                   33
     C     *IN33         IFEQ      '1'
     C                   MOVE      '1'           *IN12
     C                   MOVE      'SVX0841'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLPRT
     C                   ELSE
     C     W2EH          IFNE      'NE'
N04  C     W2EH          ANDNE     'NF'
N04  C     W2EH          ANDNE     'VS'
     C     W2EH          ANDNE     'VQ'
     C     W2EH          ANDNE     'VG'
     C     W2EH          ANDNE     'VL'
     C     W2EH          ANDNE     'VY'
     C     W2EH          ANDNE     'VR'
     C     W2EH          ANDNE     'VO'
     C                   MOVE      'J'           XKOLLI            1
     C     TVNT          IFEQ      0
     C                   Z-ADD     TVNTEH        XNTT              5 0
     C                   ELSE
     C                   Z-ADD     TVNT          XNTT
     C                   END
     C                   END
     C     *IN33         DOWEQ     '0'
      *
     C     SVEHK3        CHAIN     SVEH                               33
     C                   IF        (*IN33 OR
     C                             ((*IN33 = *OFF) AND (SVEH_FABL = 0)))
     C                   MOVE      '1'           *IN99
     C                   ELSE
     C     1             DO        200           XNR3              3 0
     C                   SELECT
     C                   WHEN      ((TVAVD2 = 0) AND (TVTDN2 = 0))
     C                   LEAVE
     C                   WHEN      ((TVAVD2 = AV(XNR3)) AND (TVTDN2 = OP(XNR3)))
     C                   LEAVE
     C                   WHEN      AV(XNR3) = 0
     C                   MOVE      TVAVD2        AV(XNR3)
     C                   MOVE      TVTDN2        OP(XNR3)
     C                   LEAVE
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     TVVT          IFEQ      *BLANKS
     C                   MOVE      '1'           *IN12
     C                   MOVE      'SVX0833'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLPRT
     C                   END
     C     W2EH          IFNE      'NE'
N04  C     W2EH          ANDNE     'NF'
N04  C     W2EH          ANDNE     'VS'
N04  C     W2EH          ANDNE     'VS'
     C     W2EH          ANDNE     'VQ'
     C     W2EH          ANDNE     'VG'
     C     W2EH          ANDNE     'VL'
     C     W2EH          ANDNE     'VY'
     C     W2EH          ANDNE     'VR'
     C     W2EH          ANDNE     'VO'
     C                   MOVE      'J'           XKOLLI            1
     C     TVNT          IFEQ      0
     C                   ADD       TVNTEH        XNTT
     C                   ELSE
     C                   ADD       TVNT          XNTT
     C                   END
     C                   END
     C     SVHK          READE(N)  SVXV                                   33
     C  N33              ENDDO
     C                   END
      *
     C     XNTT          IFEQ      0
     C     XKOLLI        ANDEQ     'J'
     C                   MOVE      '1'           *IN12
     C                   MOVE      'SPN0003'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLPRT
     C                   END
      *
     C     ULSTL         IFGT      0
     C     SVHK          SETLL     SVXHL
     C     SVHK          READE     SVXHL                                  33
     C     *IN33         IFEQ      '1'
     C                   MOVE      '1'           *IN12
     C                   MOVE      'SVX0842'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLPRT
     C                   END
     C                   END
      *
     C                   IF        (((THGKD <> 2) AND (THGKD <> 4)) OR
     C                               (THGBL = 0))
     C     UAVD          CHAIN     SVXSTD                             33
     C                   MOVE      *ZEROS        XBEL1            11 0
     C     1             DO        200           XNR3
     C                   IF        AV(XNR3) = 0
     C                   LEAVE
     C                   END
     C                   MOVE      AV(XNR3)      SVEH_SYAV
     C                   MOVE      OP(XNR3)      SVEH_SYOP
     C     SVEHK         CHAIN     SVEH                               33
N05  C     SVTVKK        SETGT     SVTVK
N05  C     SVEH_VAKD     READPE    SVTVK                                  33
N08  C                   DOW       *IN33 = *OFF
N08  C                   IF        SVEH_SYDT>= SVVK_DTS
N08  C                   LEAVE
N08  C                   END
N08  C     SVEH_VAKD     READPE    SVTVK                                  33
N08  C                   ENDDO
     C                   IF        SVEH_VAKU = 0
     C                   EVAL(H)   XBEL1 = SVEH_FABL * SVVK_KRS / SVVK_OMR
     C                   ELSE
     C                   EVAL(H)   XBEL1 = SVEH_FABL * SVEH_VAKU / SVVK_OMR
     C                   END
     C                   ADD       XBEL1         WSTBL
     C                   ENDDO
     C                   IF        THGBL = 0
N09  C  N99              EVAL(H)   WSGBL = WSTBL * STD_THGPR / 100
     C                   ELSE
     C                   Z-ADD     THGBL         WSGBL
     C                   END
      * OMREGN BELØP
     C                   IF        THGVK <> 'SEK'
N08  C     SVTVKKTR      SETLL     SVTVK
N08  C     THGVK         READPE    SVTVK                                  33
     C                   DOW       *IN33 = *OFF
N08  C                   IF        THDT >= SVVK_DTS
N08  C                   LEAVE
N08  C                   END
N08  C     THGVK         READPE    SVTVK                                  33
     C                   ENDDO
     C                   EVAL(H)   WSTBL = WSTBL / SVVK_KRS * SVVK_OMR
     C                   END
      *
N09  C                   IF        STD_THGPR = 0
     C                   Z-ADD     30            WSGPR
     C                   ELSE
N09  C                   EVAL      WSGPR = STD_THGPR
     C                   END
     C     STPRT         TAG
     C                   MOVE      WSGBL         XSGBL            13 2
N09  C                   MOVE      WSGPR         XSGPR             5 2
     C                   EXFMT     TSTGRBL
     C   10              DO
     C                   CALL      'SVX026R'
     C                   PARM                    WSTBL
     C                   PARM                    THGVK
     C                   PARM                    FICURR
     C                   PARM                    UFLAGG
     C                   EVAL(H)   WSGBL = WSTBL * WSGPR / 100
     C                   GOTO      STPRT
     C                   END
     C   12              GOTO      SLPRT
     C                   IF        ((WSGPR <> XSGPR) AND (WSGBL = XSGBL))
     C                   EVAL(H)   WSGBL = WSTBL * WSGPR / 100
     C                   GOTO      STPRT
     C                   END
     C                   IF        TGGBL <> 0
     C                   EVAL      XBEL1 = WSGBL + TGGBLB - THGBL
     C                   IF        XBEL1 > TGGBL
     C                   EXFMT     VARSLING
     C                   MOVE      '1'           *IN12
     C                   GOTO      SLPRT
     C                   END
     C     WSGBL         CABEQ     0             STPRT
     C     SVHK          CHAIN     SVXH                               33
     C                   EVAL      XBEL1 = WSGBL - THGBL
     C                   MOVE      WSGBL         THGBL
     C                   UPDATE    SVXHR
      * OPPDATER TOTAL PÅ NY GARANTI
     C  N33              IF        ((THGFT1 <> *BLANKS) AND
     C                             ((THGKD <= 1) OR
     C                               (THGKD >= 6)))
     C     THGFT1        CHAIN     SVXGH                              33
     C                   IF        *IN33 = *OFF
     C                   EVAL      TGGBLB = TGGBLB + XBEL1
     C                   UPDATE    SVXGHR
     C                   IF        TGGBLB > TGGBL
     C                   Z-ADD     100           XPRM
     C                   ELSE
     C     TGGBLB        DIV       TGGBL         XPRM              5 2
     C                   MULT      100           XPRM
     C                   END
     C                   IF        ((XPRM > TGPRM) AND (TGPRM <> 0))
     C                   EXFMT     VARSLING
     C                   END
     C                   END
     C                   END
     C                   ELSE
     C     SVHK          CHAIN     SVXH                               33
     C                   IF        *IN33 = *OFF
     C                   MOVE      WSGBL         THGBL
     C                   UPDATE    SVXHR
     C                   END
     C                   END
     C                   END
      *
     C     SLPRT         ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    W2KNS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     53
     C     POSNBR        ANDLE     60
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    W2KNK
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     17
N02  C                   IF        W2VNTI = *BLANKS
N02  C                   EVAL      UVNT = *ZEROS
N02  C                   ELSE
     C                   EVAL      UVNT = W2VNTI
N02  C                   END
     C                   EVAL      UIE  = 'E'
N02  C                   CALL      'SVT004R'
     C                   PARM                    UVNT             10
     C                   PARM                    WDT
     C                   PARM                    UIE               1
     C                   EVAL      W2VNTI = UVNT
N02  C                   IF        W2VT = *BLANKS
N02  C                   EVAL      XVNTNUL = %TRIM(UVNT) + '000000000'
N02  C                   EVAL      XVNTMAX = %TRIM(UVNT) + '999999999'
N02  C     UVNT          SETLL     SVTVS
N02  C                   READ      SVTVS                                  33
N02  C  N33XVNTMAX       COMP      SVVS_VATA                            33
N02  C  N33              EVAL      W2VT = SVVS_TXTK
N02  C                   END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '031'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     W2DK          UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2DK
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     51
     C                   CALL      'SVT003R'
     C                   PARM                    UTYP              3
     C                   PARM                    UIE               1
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      W2ALK = UKD
     C                   END
     C                   Z-ADD     70            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     70
     C     POSNBR        ANDLE     71
     C                   CALL      'SVT003R'
     C                   PARM                    UTYP              3
     C                   PARM                    UIE               1
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      W2BLK = UKD
     C                   END
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     70
     C     POSNBR        ANDLE     71
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2VTSK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2VTSK
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     15
     C                   MOVE      '014'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2TDT         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2TDT
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     38
     C     POSNBR        ANDLE     39
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2TDSK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2TDSK
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2TDOS        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2TDOS
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     12
     C                   MOVE      '013'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2DTY         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2DTY
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     61
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2DSK         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2DSK
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     51
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2DOSK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2DOSK
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     12
     C                   MOVE      '039'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2TLO         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2TLO
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     43
     C     POSNBR        ANDLE     44
     C                   CALL      'SVT003R'
     C                   PARM                    UTYP
     C                   PARM                    UIE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      W2EXLK = UKD
     C                   END
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     70
     C     POSNBR        ANDLE     71
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2MSK         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2MSK
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     41
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2MNSK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE            10
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2MNSK
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     11
     C                   MOVE      '017'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2EH          UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2EH
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEDFK2        KLIST
     C                   KFLD                    W2AVD2
     C                   KFLD                    W2TDN2
     C     HEDFK3        KLIST
     C                   KFLD                    TVAVD2
     C                   KFLD                    TVTDN2
     C     SVEHK2        KLIST
     C                   KFLD                    W2AVD2
     C                   KFLD                    W2TDN2
     C     SVEHK3        KLIST
     C                   KFLD                    TVAVD2
     C                   KFLD                    TVTDN2
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SVHK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SVEHK         KLIST
     C                   KFLD                    SVEH_SYAV
     C                   KFLD                    SVEH_SYOP
     C     SVVK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W2LI
     C     SVV1K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3LI
     C     SVVK1         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    XLI2
     C     SVVK2         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    TVLI
     C     SVV2K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3VNT
     C     SVV21         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SVK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
N05  C     SVTVKK        KLIST
N05  C                   KFLD                    SVEH_VAKD
N05  C                   KFLD                    XSVVK_DTS
N05  C     *LIKE         DEFINE    SVVK_DTS      XSVVK_DTS
N05  C                   EVAL      XSVVK_DTS = 99999999
N08  C     SVTVKKTR      KLIST
N08  C                   KFLD                    THGVK
N08  C                   KFLD                    XSVVK_DTS
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
N01  C     ZSVXHL01K     KLIST
N01  C                   KFLD                    UZREFF
N01  C                   KFLD                    UZUNIK
N01  C     ZSVXHL03K     KLIST
N01  C                   KFLD                    UAVD
N01  C                   KFLD                    UTDN
N01  C     ZSVXVL01K     KLIST
N01  C                   KFLD                    UZREFF
N01  C                   KFLD                    UZUNIK
N01  C                   KFLD                    XLI
N01  C     ZSVXVAM1K     KLIST
N01  C                   KFLD                    UZREFF
N01  C                   KFLD                    UZUNIK
N01  C                   KFLD                    TVLI
      *
     C     *ENTRY        PLIST
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      UIN27         *IN27
     C                   MOVE      UIN36         *IN36
     C                   MOVE      *ZEROS        XLI
      *** UUR = 'F' -> SJØSPEDISJON
     C     UUR           COMP      'F'                                    60
     C  N60UUR           COMP      'G'                                    60
      *
N02  C     *LIKE         DEFINE    SVVS_VATA     XVNTNUL
N02  C     *LIKE         DEFINE    SVVS_VATA     XVNTMAX
     C                   MOVE      *ZEROS        TVLI
     C                   MOVE      *BLANKS       W2VNTA10
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *ZEROS        TVVNT
     C                   MOVE      'A'           UIE               1
     C                   MOVE      'GCY'         UTYP              3
     C  N27UPRO          IFGT      0
     C     ULSTL         ORGT      0
     C     HEADFK        CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '1'
     C                   MOVE      'J'           XHOPD             1
     C                   MOVE      'N'           XHOPD2            1
     C                   ELSE
     C                   MOVE      'J'           XHOPD2
     C                   END
     C                   ELSE
     C                   MOVE      'J'           XHOPD2
     C                   END
     C                   MOVEA     '01'          *IN(31)
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           UIDAG             8 0
N01   *
N01  C  N27              IF        UZREFF = *BLANKS
N01  C     ZSVXHL03K     CHAIN     ZSVXHL03                           33
N01  C  N33              MOVE      THUNIK        UZUNIK
N01  C  N33              MOVE      THREFF        UZREFF
N01  C                   END
N01   *
     C     SVHK          CHAIN(N)  SVXH                               33
     C     SVHK          CHAIN     SVXHFV                             33
     C  N33              MOVE      'J'           XFORHV            1
     C     THGFT1        CHAIN(N)  SVXGH                              33
N01   *
N01  C  N27              IF        ((UZUNIK <> 0) AND (UZREFF <> *BLANKS))
N01   * UZUNIK<0 ---> HAR VÆRT PÅ EN ANNEN DEKLARASJON FØR.
N01   *               SETT PÅ REGENERERINGS MERKE.
N01   * UZUNIK>0 ---> FØRST GANG BLE PLUKKET. PLUKKE ALLE VARELINJER.
N01   *               I TILFELLE BRUDD PÅ FØRST PLUKKING, GJENTA JOBB
N01   *               DERFRA.
N01  C                   IF        UZUNIK < 0
N01  C                   Z-SUB     UZUNIK        UZUNIK
N01  C                   MOVE      'J'           XREGTV            1
N01  C                   ELSE
N01  C                   MOVE      'N'           XREGTV            1
N01  C                   END
N01  C                   EXSR      HZFIL
N01  C                   END
      *
     C                   ENDSR
      *
N01   ******************************************
N01  C     HZFIL         BEGSR
N01   ******************************************
N01  C                   MOVE      'J'           XGENTV            1
N01  C                   Z-ADD     99999         W2LI
N01  C     SVVK          SETGT     SVXV
N01  C     SVHK          READPE    SVXV                                   33
N01  C   33              MOVE      *ZEROS        XLI
N01  C  N33              MOVE      TVLI          XLI
N01   *
N01  C     ZSVXVL01K     SETLL     ZSVXVL01
N01  C     STHZF1        TAG
N01  C     ZSVXHL01K     READE     ZSVXVL01                               33
N01  C  N33              IF        ((TVAVD <> 0) AND (XREGTV = 'N'))
N01  C                   EXCEPT    DUMZSVV
N01  C                   GOTO      STHZF1
N01  C                   ELSE
N01  C                   MOVE      '1'           *IN93
N01  C                   WRITE     SUBCTL
N01  C                   MOVEA     '01'          *IN(93)
N01  C                   EXSR      MOVB2
N01  C                   WRITE     NYWRK
N01  C                   END
N01   *
N01  C                   DOW       *IN33 = *OFF
N01  C                   EXSR      MOVSVW
N01  C     ZSVXVAM1K     CHAIN(N)  ZSVXVAM1                           33
N01  C                   MOVE      TVLI          XTVLIAM           5 0
N01  C                   IF        *IN33 = *OFF
N01  C                   MOVE      TVKNS         W2KNS
N01  C                   MOVE      TVNAS         W2NAS
N01  C                   MOVE      TVADS1        W2ADS1
N01  C                   MOVE      TVPNS         W2PNS
N01  C                   MOVE      TVPSS         W2PSS
N01  C                   MOVE      TVLKS         W2LKS
N01  C                   MOVE      TVSKS         W2SKS
N01  C                   MOVE      TVTINS        W2TINS
N01  C                   MOVE      TVKNK         W2KNK
N01  C                   MOVE      TVNAK         W2NAK
N01  C                   MOVE      TVADK1        W2ADK1
N01  C                   MOVE      TVPNK         W2PNK
N01  C                   MOVE      TVPSK         W2PSK
N01  C                   MOVE      TVLKK         W2LKK
N01  C                   MOVE      TVSKK         W2SKK
N01  C                   MOVE      TVTINK        W2TINK
N01  C                   END
N01  C                   GOTO      STHZF3
N01  C     STHZF2        TAG
N01  C  N30              EXSR      TSTOPL
N01  C                   EXFMT     VARELI
N01  C                   MOVEA     '000000000000'*IN(79)
N01  C                   MOVEA     '000000000000'*IN(67)
N01  C                   MOVEA     '000000000000'*IN(55)
N01  C                   MOVEA     '000'         *IN(52)
N01  C   12              EXCEPT    DUMZSVV
N01  C   12              GOTO      SLHZF
N01  C   04              DO
N01  C                   EXSR      SØKDTA
N01  C                   GOTO      STHZF2
N01  C                   END
N01   *
N01  C     STHZF3        TAG
N01  C                   EXSR      TESTB1
N01  C   30              GOTO      STHZF2
N01  C                   ADD       1             XLI
N01  C                   MOVE      XLI           W2LI
N01  C                   EXSR      OPDSVV
N01   *
N01  C                   EXCEPT    OPDZSVV
N01  C                   MOVE      XTVLIAM       TVLI
N01  C     ZSVXVAM1K     CHAIN     ZSVXVAM1                           33
N01  C                   IF        *IN33 = *OFF
N01  C                   MOVE      UAVD          TVAVD
N01  C                   MOVE      UTDN          TVTDN
N01  C                   UPDATE    SVXVAMRZ
N01  C                   END
N01  C     STHZF4        TAG
N01  C     ZSVXHL01K     READE     ZSVXVL01                               33
N01  C  N33              IF        ((TVAVD <> 0) AND (XREGTV = 'N'))
N01  C                   EXCEPT    DUMZSVV
N01  C                   GOTO      STHZF4
N01  C                   END
N01  C  N33              END
N01   *
N01  C     SLHZF         TAG
N01  C                   MOVE      'N'           XGENTV            1
N01   *
N01  C                   ENDSR
N01   *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(28)
     C                   MOVEA     '0000'        *IN(45)
      *
     C                   MOVE      TVLI          XTLI              5 0
     C                   MOVE      TVCNR         XTCNR            17
     C                   MOVE      TVDTY         XTDTY             3
     C                   MOVE      TVDREF        XTDREF           20
     C                   MOVE      TVDSK         XTDSK             2
     C                   MOVE      TVDO          XTDO             26
     C                   MOVE      TVDOSK        XTDOSK            2
     C                   MOVE      TVMTXT        XTMTXT           48
     C                   MOVE      TVMSK         XTMSK             2
     C                   MOVE      TVTLO         XTTLO             3
     C                   MOVE      TVEXKD        XTEXKD            1 0
     C                   MOVE      TVEXLK        XTEXLK            2
     C                   MOVE      TVFV          XTFV              2
     C                   MOVE      TVFVNT        XTFVNT           11 3
     C                   MOVE      TVMN          XTMN             17
     C                   MOVE      TVMNSK        XTMNSK            2
     C                   MOVE      TVEH          XTEH              2
     C                   MOVE      TVNT          XTNT              5 0
     C                   MOVE      TVNTEH        XTNTEH            5 0
     C                   MOVE      TVTDT         XTTDT             6
     C                   MOVE      TVTDR         XTTDR            20
     C                   MOVE      TVTDSK        XTTDSK            2
     C                   MOVE      TVTDO         XTTDO            26
     C                   MOVE      TVTDOS        XTTDOS            2
     C                   MOVE      TVVT          XTVT             48
     C                   MOVE      TVVTSK        XTVTSK            2
      *
      *** TEST OM FLERE CONTAINERNR (RUBR. 31) FINNES
     C     SVVK          SETLL     SVXVCN
     C     SVVK          READE(N)  SVXVCN                                 33
     C  N33              SETON                                        28
      *** TEST OM FLERE DOKUMENTER (RUBR. 44) FINNES
     C     SVVK          SETLL     SVXVDK
     C     SVVK          READE(N)  SVXVDK                                 33
     C  N33              SETON                                        29
      *** TEST OM FLERE FØLSOMME VARER FINNES
     C     SVVK          SETLL     SVXVFS
     C     SVVK          READE(N)  SVXVFS                                 33
     C  N33              SETON                                        45
      *** TEST OM FLERE MERKE & NR (RUBR. 31) FINNES
     C     SVVK          SETLL     SVXVMN
     C     SVVK          READE(N)  SVXVMN                                 33
     C  N33              SETON                                        46
      *** TEST OM FLERE TIDLIGERE DOKUMENTER (RUBR. 40) FINNES
     C     SVVK          SETLL     SVXVTD
     C     SVVK          READE(N)  SVXVTD                                 33
     C  N33              SETON                                        47
      *** TEST OM FLERE VAREBEKSRIVELSESLINJER (RUBR. 31) FINNES
     C     SVVK          SETLL     SVXVVT
     C     SVVK          READE(N)  SVXVVT                                 33
     C  N33              SETON                                        48
      *
     C                   MOVE      XTLI          TVLI
     C                   MOVE      XTCNR         TVCNR
     C                   MOVE      XTDTY         TVDTY
     C                   MOVE      XTDREF        TVDREF
     C                   MOVE      XTDSK         TVDSK
     C                   MOVE      XTDO          TVDO
     C                   MOVE      XTDOSK        TVDOSK
     C                   MOVE      XTMTXT        TVMTXT
     C                   MOVE      XTMSK         TVMSK
     C                   MOVE      XTTLO         TVTLO
     C                   MOVE      XTEXKD        TVEXKD
     C                   MOVE      XTEXLK        TVEXLK
     C                   MOVE      XTFV          TVFV
     C                   MOVE      XTFVNT        TVFVNT
     C                   MOVE      XTMN          TVMN
     C                   MOVE      XTMNSK        TVMNSK
     C                   MOVE      XTEH          TVEH
     C                   MOVE      XTNT          TVNT
     C                   MOVE      XTNTEH        TVNTEH
     C                   MOVE      XTTDT         TVTDT
     C                   MOVE      XTTDR         TVTDR
     C                   MOVE      XTTDSK        TVTDSK
     C                   MOVE      XTTDO         TVTDO
     C                   MOVE      XTTDOS        TVTDOS
     C                   MOVE      XTVT          TVVT
     C                   MOVE      XTVTSK        TVVTSK
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTOPL        BEGSR
     C***********************************************
      *** SLETTE CONTAINERNR PGA. AVBRYT NY REGISTRERING
     C     SVVK          SETLL     SVXVCN
     C     SVVK          READE     SVXVCN                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXVCNR
     C     SVVK          READE     SVXVCN                                 33
     C  N33              ENDDO
      *** SLETTE DOKUMENTER PGA. AVBRYT NY REGISTRERING
     C     SVVK          SETLL     SVXVDK
     C     SVVK          READE     SVXVDK                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXVDKR
     C     SVVK          READE     SVXVDK                                 33
     C  N33              ENDDO
      *** SLETTE FØLSOMME VARER PGA. AVBRYT NY REGISTRERING
     C     SVVK          SETLL     SVXVFS
     C     SVVK          READE     SVXVFS                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXVFSR
     C     SVVK          READE     SVXVFS                                 33
     C  N33              ENDDO
      *** SLETTE MERKE & NR PGA. AVBRYT NY REGISTRERING
     C     SVVK          SETLL     SVXVMN
     C     SVVK          READE     SVXVMN                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXVMNR
     C     SVVK          READE     SVXVMN                                 33
     C  N33              ENDDO
      *** SLETTE TIDLIGERE DOKUMENTER PGA. AVBRYT NY REGISTRERING
     C     SVVK          SETLL     SVXVTD
     C     SVVK          READE     SVXVTD                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXVTDR
     C     SVVK          READE     SVXVTD                                 33
     C  N33              ENDDO
      *** SLETTE VAREBESKRIVELSER PGA. AVBRYT NY REGISTRERING
     C     SVVK          SETLL     SVXVVT
     C     SVVK          READE     SVXVVT                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXVVTR
     C     SVVK          READE     SVXVVT                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
     C                   IF        THGBL = 0
N09  C  N99              EVAL(H)   WSGBL = WSTBL * STD_THGPR / 100
     C                   ELSE
     C                   Z-ADD     THGBL         WSGBL
     C                   END
      *
N01  OSVXVRZ    E            OPDZSVV
N01  O                       TVAVD
N01  O                       TVTDN
N01  O          E            DUMZSVV
