      *
     H DATEDIT(*YMD)
     FECNI921   IF   E           K DISK
     FECNT921   IF   E           K DISK
     FEFTX921   IF   E           K DISK
     FEGDS921   IF   E           K DISK
     FEGID921   IF   E           K DISK
     FELOC921   IF   E           K DISK
     FEMEA921   IF   E           K DISK
     FENAD921   IF   E           K DISK
     FEPCI921   IF   E           K DISK
     FEQUA902   IF   E           K DISK
     FERFF921   IF   E           K DISK
     FETDT921   IF   E           K DISK
     FETOD921   IF   E           K DISK
     FFREETXT   IF A E             DISK
     FFRISOK    IF A E             DISK
     FHEADF     IF A E             DISK
     FDOKUF     O    E             DISK
     FDOKUFV    O    E             DISK
     FTURER     IF A E             DISK
     FTELL      UF   E           K DISK
     FKUNKO9    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FHEDUMMY   IF   E           K DISK
     F                                     RENAME(HEADFR:DUMMY)
     D A               S              1    DIM(79)
     D B               S              1    DIM(18)
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D                 DS
     D  TUDT                   1      8  0
     D  TUDTÅ                  1      4  0
     D  TUDTM                  5      6  0
     D  TUDTD                  7      8  0
      *________________________
      * DS for decimal handling
      *""""""""""""""""""""""""
     D                 DS
     D  ZDEC                   1      7  6
     D  ZDEC6                  2      7
     D  ZHEL                  11     22  0
      */////////////
      * MAIN LOGIC /
      */////////////
      *___________
      * Initiering
      *"""""""""""
     C                   EXSR      INIT
      *________
      * CONVERT
      *""""""""
     C                   EXSR      RTVD
     C                   RETURN
      *////////////////////////////////////////////////////////////
      *                                                      INIT /
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
     C  N99
     CAN 99              READ      HEADF                                  99
     C  N99
     CAN 99              READ      FREETXT                                99
     C  N99
     CAN 99              READ      EQUA902                                99
     C  N99
     CAN 99              READ      TURER                                  99
     C  N99
     CAN 99              READ      FRISOK                                 99
     C     KEYMS0        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN0
     C     KEYMS1        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN1
     C                   KFLD                    ZREPB0
     C     KEYMS2        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN2
     C                   KFLD                    ZREPC0
     C                   KFLD                    ZREPC1
     C     KEYMS3        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN3
     C                   KFLD                    ZREPD0
     C                   KFLD                    ZREPD1
     C                   KFLD                    ZREPD2
     C     KEYMS4        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN4
     C                   KFLD                    ZREPE0
     C                   KFLD                    ZREPE1
     C                   KFLD                    ZREPE2
     C                   KFLD                    ZREPE3
     C     KEYMS5        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN5
     C                   KFLD                    ZREPF0
     C                   KFLD                    ZREPF1
     C                   KFLD                    ZREPF2
     C                   KFLD                    ZREPF3
     C                   KFLD                    ZREPF4
     C     KEYQUA        KLIST
     C                   KFLD                    ZUALTA
     C                   KFLD                    ZUALCO
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUKUN2
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    WSOPD
     C     *LIKE         DEFINE    NMN           ZMN
     C     *LIKE         DEFINE    NGN           ZGN0
     C     *LIKE         DEFINE    NGN           ZGN1
     C     *LIKE         DEFINE    NGN           ZGN2
     C     *LIKE         DEFINE    NGN           ZGN3
     C     *LIKE         DEFINE    NGN           ZGN4
     C     *LIKE         DEFINE    NGN           ZGN5
     C     *LIKE         DEFINE    NREP0         ZREPB0
     C     *LIKE         DEFINE    NREP0         ZREPC0
     C     *LIKE         DEFINE    NREP1         ZREPC1
     C     *LIKE         DEFINE    NREP0         ZREPD0
     C     *LIKE         DEFINE    NREP1         ZREPD1
     C     *LIKE         DEFINE    NREP2         ZREPD2
     C     *LIKE         DEFINE    NREP0         ZREPE0
     C     *LIKE         DEFINE    NREP1         ZREPE1
     C     *LIKE         DEFINE    NREP2         ZREPE2
     C     *LIKE         DEFINE    NREP3         ZREPE3
     C     *LIKE         DEFINE    NREP0         ZREPF0
     C     *LIKE         DEFINE    NREP1         ZREPF1
     C     *LIKE         DEFINE    NREP2         ZREPF2
     C     *LIKE         DEFINE    NREP3         ZREPF3
     C     *LIKE         DEFINE    NREP4         ZREPF4
     C     *LIKE         DEFINE    NREP0         ZREPG0
     C     *LIKE         DEFINE    NREP1         ZREPG1
     C     *LIKE         DEFINE    NREP2         ZREPG2
     C     *LIKE         DEFINE    NREP3         ZREPG3
     C     *LIKE         DEFINE    NREP4         ZREPG4
     C     *LIKE         DEFINE    NREP5         ZREPG5
     C     *LIKE         DEFINE    NREP0         ZREPH0
     C     *LIKE         DEFINE    NREP1         ZREPH1
     C     *LIKE         DEFINE    NREP2         ZREPH2
     C     *LIKE         DEFINE    NREP3         ZREPH3
     C     *LIKE         DEFINE    NREP4         ZREPH4
     C     *LIKE         DEFINE    NREP5         ZREPH5
     C     *LIKE         DEFINE    NREP6         ZREPH6
     C     *LIKE         DEFINE    NREP0         ZREPI0
     C     *LIKE         DEFINE    NREP1         ZREPI1
     C     *LIKE         DEFINE    NREP2         ZREPI2
     C     *LIKE         DEFINE    NREP3         ZREPI3
     C     *LIKE         DEFINE    NREP4         ZREPI4
     C     *LIKE         DEFINE    NREP5         ZREPI5
     C     *LIKE         DEFINE    NREP6         ZREPI6
     C     *LIKE         DEFINE    NREP7         ZREPI7
     C     *LIKE         DEFINE    NREP0         ZREPJ0
     C     *LIKE         DEFINE    NREP1         ZREPJ1
     C     *LIKE         DEFINE    NREP2         ZREPJ2
     C     *LIKE         DEFINE    NREP3         ZREPJ3
     C     *LIKE         DEFINE    NREP4         ZREPJ4
     C     *LIKE         DEFINE    NREP5         ZREPJ5
     C     *LIKE         DEFINE    NREP6         ZREPJ6
     C     *LIKE         DEFINE    NREP7         ZREPJ7
     C     *LIKE         DEFINE    NREP8         ZREPJ8
     C     *LIKE         DEFINE    QUALTA        ZUALTA
     C     *LIKE         DEFINE    QUALCO        ZUALCO
     C     *LIKE         DEFINE    HESG          ÆESG
     C     *LIKE         DEFINE    HEAVD         ÆEAVD
     C     *LIKE         DEFINE    HEPRO         ÆEPRO
     C     *LIKE         DEFINE    HENAA         ÆENAA
     C     *LIKE         DEFINE    TUKNA         ÆKNA
     C     *LIKE         DEFINE    N3039         WMS
     C     *LIKE         DEFINE    KUINTN        WUINTN
     C     *LIKE         DEFINE    KUNDNR        WKUNDN
     C     *LIKE         DEFINE    HEOPD         WSOPD
     C                   Z-ADD     0             WSOPD
     C     *ENTRY        PLIST
     C                   PARM                    ZMN
     C                   PARM                    ÆEAVD
     C                   PARM                    ÆEPRO
     C                   PARM                    ÆESG
     C                   PARM                    ÆKNA
     C                   PARM                    ÆEGN             11
     C                   READ      FIRM                                   20
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED400     RTVD /
      *////////////////////////////////////////////////////////////
     C     RTVD          BEGSR
      *____________
      * HENTE TURNR
      *""""""""""""
     C                   Z-ADD     ÆEAVD         HEAVD
     C                   MOVE      'N'           WCRT
     C     ÆEPRO         IFEQ      0
     C                   MOVE      'Y'           WCRT              1
     C     HEAVD         CHAIN     TELL                               90
     C   90              Z-ADD     0             HEAVD
     C   90HEAVD         CHAIN     TELL                               90
     C                   Z-ADD     ÆEAVD         HEAVD
     C                   Z-ADD     TETURN        ÆEPRO
     C                   ADD       1             TETURN
     C                   UPDATE    TELLR
     C                   CLEAR                   TURERR
     C                   Z-ADD     ÆEAVD         TUAVD
     C                   Z-ADD     ÆEPRO         TUPRO
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          TUDTÅ
     C                   ELSE
     C     UYEAR         ADD       2000          TUDTÅ
     C                   END
     C                   MOVE      UMONTH        TUDTM
     C                   MOVE      UDAY          TUDTD
     C                   Z-ADD     ÆKNA          TUKNA
     C                   MOVEL     ÆESG          TUSG
     C                   ENDIF
      *_______________________
      * READ ALL MAIN SEGMENTS
      *"""""""""""""""""""""""
      * CNT00
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     ECNT921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECNT921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   MOVEA     C6066         A
     C                   EXSR      GETNUM
     C                   SELECT
     C     C6069         WHENEQ    '10 '
     C                   Z-ADD     ZNUM          TUAO
     C     C6069         WHENEQ    '11 '
     C                   Z-ADD     ZNUM          TUTS
     C     C6069         WHENEQ    '7  '
     C                   Z-ADD     ZNUM          TUTVKT
     C                   ENDSL
      *
     C     KEYMS0        READE     ECNT921                                51
     C  N51              ENDDO
     C                   ENDIF
      * RFF01
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     1             ZGN0
     C     KEYMS0        CHAIN     ERFF921                            51
     C     *IN51         IFEQ      '1'
     C                   MOVE      *BLANKS       R1154
     C                   ENDIF
     C                   MOVEL     R1154         TUTARF
      * TDT05
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     5             ZGN0
     C     KEYMS0        CHAIN     ETDT921                            20
     C     *IN20         IFEQ      '0'
      *
     C                   MOVEL     T8178         TUBILN
     C                   MOVEL     T8179         TULK
     C                   MOVEL     T3128         TUNAT
     C                   MOVEA     T8067         A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          TUTRMA
      *
     C                   ENDIF
      * LOC05
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     5             ZGN1
     C                   Z-ADD     1             ZREPB0
     C     KEYMS1        SETLL     ELOC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   SELECT
     C     L3227         WHENEQ    '5  '
     C                   MOVEL     L3224         TUSDF
     C     L3227         WHENEQ    '8  '
     C                   MOVEL     L3224         TUSDT
     C                   ENDSL
      *
     C     KEYMS1        READE     ELOC921                                51
     C  N51              ENDDO
     C                   ENDIF
      * NAD09
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     9             ZGN1
     C                   Z-ADD     1             ZREPB0
     C     KEYMS1        SETLL     ENAD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ENAD921                                51
     C     *IN51         DOWEQ     '0'
      *
     C     N3035         IFEQ      'MS '
     C                   MOVEL     N3124A        ÆENAA
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        ÆENAA
     C                   ENDIF
     C                   ENDIF
      *
     C     KEYMS1        READE     ENAD921                                51
     C  N51              ENDDO
     C                   ENDIF
      *_________
      * LAGE TUR
      *"""""""""
     C     WCRT          IFEQ      'Y'
      *
     C                   WRITE     TURERR
      *
     C                   ENDIF
      *___________________
      * READ CONSIGNEMENTS
      *"""""""""""""""""""
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     15            ZGN0
     C     KEYMS0        SETLL     ECNI921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECNI921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   SELECT
     C     C1312         WHENNE    '0   '
      * Da er det snakk om kun enkeltsendinger med en HEADF
      * og ingen fordelingsfraktbrev.
     C                   EXSR      RTVDB
     C     C1312         WHENEQ    '0   '
      * Da er det snakk om fordelingssendinger med en HEADF
      * og fraktbrevene genereres i RTVDC
     C                   EXSR      RTVDB
      * RTVDC genererer et fraktbrev per CNI segment som ikke har
      * nummer 9999 eller 0. Alle andre nummre vil være fordelings
      * fraktbrev som hører til en hovedsending med 0 i C1312.
     C                   EXSR      RTVDC
     C                   ENDSL
      *
     C     KEYMS0        READE     ECNI921                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED400    RTVDB /
      *////////////////////////////////////////////////////////////
     C     RTVDB         BEGSR
      *__________
      * INZ HEADF
      *""""""""""
     C                   CLEAR                   HEADFR
     C                   Z-ADD     ÆEAVD         HEAVD
     C     HEADFK        CHAIN     HEDUMMY                            90
     C     HEAVD         CHAIN     TELL                               90
     C   90              Z-ADD     0             HEAVD
     C   90HEAVD         CHAIN     TELL                               90
     C                   Z-ADD     ÆEAVD         HEAVD
     C                   Z-ADD     TEOPDN        HEOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   MOVE      'A'           HEUR
     C                   MOVEL     ÆESG          HESG
     C                   Z-ADD     ÆEPRO         HEPRO
     C                   MOVEL     ÆENAA         HENAA
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          HEDTÅ
     C                   ELSE
     C     UYEAR         ADD       2000          HEDTÅ
     C                   END
     C                   MOVE      UMONTH        HEDTM
     C                   MOVE      UDAY          HEDTD
     C                   MOVE      HEDTOP        HEDTR
     C                   MOVEL     R1154         HERFA
     C                   MOVEL     C1312         HEPOS1
     C                   MOVEL     TUBILN        HEHAWB
     C                   Z-ADD     TUTRMA        HETRM
     C                   Z-ADD     ÆKNA          HEKNA
     C                   MOVEL     TULK          HETRI
     C                   MOVEL     ÆEGN          HEGN
      *___________
      * INZ FRISOK
      *"""""""""""
     C                   Z-ADD     HEAVD         FSAVD
     C                   Z-ADD     HEOPD         FSOPD
      *____________
      * INZ FREETXT
      *""""""""""""
     C                   Z-ADD     HEAVD         FRTAVD
     C                   Z-ADD     HEOPD         FRTOPD
     C                   Z-ADD     HEDTR         FRTDT
     C     *LIKE         DEFINE    FRTLI         WRTLI
     C                   Z-ADD     0             WRTLI
      *________________
      * WRITE TO FRISOK
      *""""""""""""""""
     C                   MOVEL     'CNO'         FSKODE
     C                   MOVEL     *BLANKS       FSSOK
     C                   MOVEL     C1004         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
      *_________________
      * WRITE TO FREETXT
      *"""""""""""""""""
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     'CONS.NO:'    FRTTXT
     C                   MOVEL     *BLANKS       FRTTXT
     C                   MOVE      C1004         FRTTXT
     C                   WRITE     FREETXTR
      *__________________
      * READ ALL SEGMENTS
      *""""""""""""""""""
     C                   Z-ADD     CREP0         ZREPB0
     C*                    EXSR MOA15
     C                   EXSR      FTX15
     C                   EXSR      LOC16
     C                   EXSR      TOD17
     C                   EXSR      RFF18
     C*                    EXSR CPI21
     C                   EXSR      NAD25
     C                   EXSR      GID31
      *___________________
      * WRITE TO SYSPED400
      *"""""""""""""""""""
     C                   WRITE     HEADFR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED400    RTVDC /
      *////////////////////////////////////////////////////////////
     C     RTVDC         BEGSR
      * Les inn neste record for å få tak i første fraktbrev på fordelingen
     C     KEYMS0        READE     ECNI921                                51
      * Fordelingsoppdraget er ferdig når det er EOF eller ...
     C     *IN51         DOWEQ     *OFF
      * når det kommer inn nytt singel eller fordelingsoppdrag.
     C     C1312         IFEQ      '9999'
     C     C1312         OREQ      '0   '
      * Les en bakover for å stille filpeker riktig.
     C     KEYMS0        READPE    ECNI921                                51
     C                   LEAVE
     C                   ENDIF
      *__________
      * INZ DOKUF
      *""""""""""
     C                   CLEAR                   DOKUFR
     C                   Z-ADD     ÆEAVD         DFAVD
     C                   Z-ADD     HEOPD         DFOPD
     C                   MOVE      ' '           DFST
     C                   MOVEL     ÆESG          DFSG
     C                   MOVEA     C1312         A
     C                   EXSR      GETNUM
     C     ZNUM          ADD       1             DFFBNR                         FRAKTB.NR
     C                   MOVEL     HEKNS         DFKNS
      *__________
      * INZ DOKUFV
      *""""""""""
     C                   CLEAR                   DOKUFVR
     C                   Z-ADD     ÆEAVD         FVAVD
     C                   Z-ADD     HEOPD         FVOPD
     C                   MOVE      ' '           FVST
     C                   MOVE      'F'           FVRI
     C                   Z-ADD     DFFBNR        FVFBNR                         FRAKTB.NR
      *___________
      * INZ FRISOK
      *"""""""""""
     C                   Z-ADD     HEAVD         FSAVD
     C                   Z-ADD     HEOPD         FSOPD
      *____________
      * INZ FREETXT
      *""""""""""""
     C                   Z-ADD     HEAVD         FRTAVD
     C                   Z-ADD     HEOPD         FRTOPD
     C                   Z-ADD     HEDTR         FRTDT
     C                   Z-ADD     0             WRTLI
      *________________
      * WRITE TO FRISOK
      *""""""""""""""""
     C                   MOVEL     'CNO'         FSKODE
     C                   MOVEL     C1004         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
      *_________________
      * WRITE TO FREETXT
      *"""""""""""""""""
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     'CONS.NO:'    FRTTXT
     C                   MOVE      C1004         FRTTXT
     C                   WRITE     FREETXTR
      *__________________
      * READ ALL SEGMENTS
      *""""""""""""""""""
     C                   Z-ADD     CREP0         ZREPB0
      *                    EXSR MOA15S
      *                    EXSR FTX15S
     C                   EXSR      LOC16S
     C                   EXSR      TOD17S
     C                   EXSR      RFF18S
      *                    EXSR CPI21S
     C                   EXSR      NAD25S
     C                   EXSR      GID31S
      *___________________
      * WRITE TO SYSPED400
      *"""""""""""""""""""
     C                   MOVEL     WWMÅL         DFMÅL
     C                   WRITE     DOKUFR
     C     KEYMS0        READE     ECNI921                                51
     C                   ENDDO                                                  <*IN51
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX15                                               FTX15 /
      *////////////////////////////////////////////////////////////
     C     FTX15         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     15            ZGN1
     C     KEYMS1        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     F4451         WHENEQ    'SPH'
     C     F4440A        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440A        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440B        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440B        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440C        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440C        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440D        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440D        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440E        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440E        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4451         WHENEQ    'ABN'
     C     F4440A        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440A        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440B        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440B        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440C        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440C        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440D        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440D        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440E        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440E        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C                   ENDSL
      *
     C     KEYMS1        READE     EFTX921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX15S                                              FTX15S/
      *////////////////////////////////////////////////////////////
     C     FTX15S        BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     15            ZGN1
     C     KEYMS1        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     F4451         WHENEQ    'SPH'
     C     F4440A        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440A        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440B        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440B        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440C        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440C        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440D        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440D        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440E        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440E        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4451         WHENEQ    'ABN'
     C     F4440A        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440A        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440B        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440B        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440C        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440C        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440D        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440D        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C     F4440E        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440E        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
     C                   ENDSL
      *
     C     KEYMS1        READE     EFTX921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX33                                               FTX33 /
      *////////////////////////////////////////////////////////////
     C     FTX33         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     33            ZGN3
     C     KEYMS3        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX921                                54
     C     *IN54         DOWEQ     '0'
      *
     C     F4451         IFEQ      'AAA'
     C                   MOVEL     F4440A        HEVS2
     C                   ENDIF
      *
     C     KEYMS3        READE     EFTX921                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX33S                                              FTX33S/
      *////////////////////////////////////////////////////////////
     C     FTX33S        BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     33            ZGN3
     C     KEYMS3        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX921                                54
     C     *IN54         DOWEQ     '0'
      *
     C     F4451         IFEQ      'AAA'
     C                   MOVEL     F4440A        DFVS
     C                   MOVEL     F4440A        FVVT
     C                   ENDIF
      *
     C     KEYMS3        READE     EFTX921                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GDS33                                               GDS33 /
      *////////////////////////////////////////////////////////////
     C     GDS33         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     33            ZGN2
     C     KEYMS2        SETLL     EGDS921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EGDS921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   Z-ADD     GREP0         ZREPD0
     C                   Z-ADD     GREP1         ZREPD1
     C                   Z-ADD     GREP2         ZREPD2
     C                   EXSR      FTX33
      *
     C     KEYMS2        READE     EGDS921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GDS33S                                              GDS33S/
      *////////////////////////////////////////////////////////////
     C     GDS33S        BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     33            ZGN2
     C     KEYMS2        SETLL     EGDS921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EGDS921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   Z-ADD     GREP0         ZREPD0
     C                   Z-ADD     GREP1         ZREPD1
     C                   Z-ADD     GREP2         ZREPD2
     C                   EXSR      FTX33S
      *
     C     KEYMS2        READE     EGDS921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GID31                                               GID31 /
      *////////////////////////////////////////////////////////////
     C     GID31         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     31            ZGN1
     C     KEYMS1        SETLL     EGID921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EGID921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEA     G7224A        A
     C                   EXSR      GETNUM
     C                   ADD       ZNUM          HENT
     C                   MOVEL     G7064A        HEVS1
      *
     C                   Z-ADD     GREP0         ZREPC0
     C                   Z-ADD     GREP1         ZREPC1
     C                   EXSR      GDS33
     C                   EXSR      MEA34
     C                   EXSR      PCI37
     C*                    EXSR DGS44
      *
     C     KEYMS1        READE     EGID921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GID31S VARELINJE                                    GID31S/
      *////////////////////////////////////////////////////////////
     C     GID31S        BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     31            ZGN1
     C     KEYMS1        SETLL     EGID921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EGID921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEA     G7224A        A
     C                   EXSR      GETNUM
     C                   ADD       ZNUM          DFNT
     C                   Z-ADD     ZNUM          FVANT
     C                   MOVEL     G7064A        DFGM
     C                   MOVEL     G7064A        FVPAKN
      *
     C                   Z-ADD     GREP0         ZREPC0
     C                   Z-ADD     GREP1         ZREPC1
     C                   EXSR      GDS33S
     C                   EXSR      MEA34S
     C                   EXSR      PCI37S
     C*                    EXSR DGS44S
      * SKRIV TIL DOKUFV
     C                   WRITE     DOKUFVR
     C     KEYMS1        READE     EGID921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * LOC16                                               LOC16 /
      *////////////////////////////////////////////////////////////
     C     LOC16         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     ELOC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     KEYMS1        READE     ELOC921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * LOC16S                                              LOC16S/
      *////////////////////////////////////////////////////////////
     C     LOC16S        BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     ELOC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     KEYMS1        READE     ELOC921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * MEA34                                               MEA34 /
      *////////////////////////////////////////////////////////////
     C     MEA34         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     34            ZGN2
     C     KEYMS2        SETLL     EMEA921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMEA921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   MOVEA     M6314         A
     C                   EXSR      GETNUM
     C                   SELECT
     C     M6311         WHENEQ    'WT '
     C     M6313         ANDEQ     'AAG'
     C                   Z-ADD     ZNUM          HEVKT
     C     M6311         WHENEQ    'LMT'
     C     M6313         ANDEQ     'Z04'
     C                   Z-ADD     ZNUM          HELM
     C     M6311         WHENEQ    'VOL'
     C     M6313         ANDEQ     'Z02'
     C                   Z-ADD     ZNUM          HEM3
     C                   ENDSL
      *
     C     KEYMS2        READE     EMEA921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * MEA34S                                              MEA34S/
      *////////////////////////////////////////////////////////////
     C     MEA34S        BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     34            ZGN2
     C     KEYMS2        SETLL     EMEA921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMEA921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   MOVEA     M6314         A
     C                   EXSR      GETNUM
     C                   SELECT
     C     M6311         WHENEQ    'WT '
     C     M6313         ANDEQ     'AAG'
     C                   ADD       ZNUM          DFVKT
     C                   Z-ADD     ZNUM          FVVKT
     C     M6311         WHENEQ    'PAL'
     C     M6313         ANDEQ     'WT '
     C                   ADD       ZNUM          DFVKTF
     C     M6311         WHENEQ    'VOL'
     C     M6313         ANDEQ     'Z01'
     C                   ADD       ZNUM          WWMÅL             9 3
     C                   Z-ADD     ZNUM          FVVOL
     C     M6311         WHENEQ    'LMT'
     C     M6313         ANDEQ     'Z03'
     C                   Z-ADD     ZNUM          FVLM
     C                   ENDSL
      *
     C     KEYMS2        READE     EMEA921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * NAD25                                               NAD25 /
      *////////////////////////////////////////////////////////////
     C     NAD25         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     25            ZGN1
     C     KEYMS1        SETLL     ENAD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ENAD921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     N3039         WUINTN
     C     WUINTN        CHAIN     KUNKO9                             20
     C  N20KUNKEY        CHAIN     CUNDL01                            20
     C     *IN20         IFEQ      '1'
     C                   Z-ADD     0             KUKUN2
     C                   ENDIF
     C                   SELECT
     C     N3035         WHENEQ    'CZ'                                         GODSAVSENDER
     C     N3039         IFNE      *BLANKS
     C     KUKUN2        ANDGT     0
     C                   Z-ADD     KUKUN2        HEKNS
     C                   Z-ADD     KUKUN2        HEKNSF
     C                   ENDIF
     C     N3124A        IFNE      *BLANKS
     C                   MOVEL     N3124A        HENAS
     C                   MOVEL     N3124A        HENASF
     C                   ENDIF
     C     N3124B        IFNE      *BLANKS
     C                   MOVEL     N3124B        HEADS1
     C                   ENDIF
     C     N3124C        IFNE      *BLANKS
     C                   MOVEL     N3124C        HEADS2
     C                   ENDIF
     C     N3124D        IFNE      *BLANKS
     C                   MOVEL     N3124D        HEADS3
     C                   ENDIF
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        HENAS
     C                   MOVEL     N3036A        HENASF
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C                   MOVEL     N3042A        HEADS1
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C                   MOVEL     N3251         HESDFF
     C                   MOVEL     N3251         WEADS1            9
     C                   MOVEL     N3164         WEADS2           21
     C                   MOVEL     WEADS1        HEADS3
     C                   MOVE      WEADS2        HEADS3
     C                   ENDIF
     C     N3035         WHENEQ    'CN'                                         LEV.ADR
     C     N3039         IFNE      *BLANKS
     C     KUKUN2        ANDGT     0
     C                   Z-ADD     KUKUN2        HEKNK
     C                   ENDIF
     C     N3124A        IFNE      *BLANKS
     C                   MOVEL     N3124A        HENAK
     C                   ENDIF
     C     N3124B        IFNE      *BLANKS
     C                   MOVEL     N3124B        HEADK1
     C                   ENDIF
     C     N3124C        IFNE      *BLANKS
     C                   MOVEL     N3124C        HEADK2
     C                   ENDIF
     C     N3124D        IFNE      *BLANKS
     C                   MOVEL     N3124D        HEADK3
     C                   ENDIF
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        HENAK
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C                   MOVEL     N3042A        HEADK1
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C                   MOVEL     N3251         HESDVT
     C                   MOVEL     N3251         WEADS1
     C                   MOVEL     N3164         WEADS2
     C                   MOVEL     WEADS1        HEADK3
     C                   MOVE      WEADS2        HEADK3
     C                   ENDIF
     C     N3035         WHENEQ    'BY'                                         KJØP.FAKT
     C     N3039         IFNE      *BLANKS
     C     KUKUN2        ANDGT     0
     C                   Z-ADD     KUKUN2        HEKNKF
     C                   ENDIF
     C     N3124A        IFNE      *BLANKS
     C                   MOVEL     N3124A        HENAKF
     C                   ENDIF
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        HENAKF
     C                   ENDIF
      *
     C     HENAK         IFEQ      *BLANKS
     C     N3039         IFNE      *BLANKS
     C     KUKUN2        ANDGT     0
     C                   Z-ADD     KUKUN2        HEKNK
     C                   ENDIF
     C     N3124A        IFNE      *BLANKS
     C                   MOVEL     N3124A        HENAK
     C                   ENDIF
     C     N3124B        IFNE      *BLANKS
     C                   MOVEL     N3124B        HEADK1
     C                   ENDIF
     C     N3124C        IFNE      *BLANKS
     C                   MOVEL     N3124C        HEADK2
     C                   ENDIF
     C     N3124D        IFNE      *BLANKS
     C                   MOVEL     N3124D        HEADK3
     C                   ENDIF
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        HENAK
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C                   MOVEL     N3042A        HEADK1
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C                   MOVEL     N3251         HESDVT
     C                   MOVEL     N3251         WEADS1
     C                   MOVEL     N3164         WEADS2
     C                   MOVEL     WEADS1        HEADK3
     C                   MOVE      WEADS2        HEADK3
     C                   ENDIF
     C                   ENDIF
      *
     C                   ENDSL
      *
     C     KEYMS1        READE     ENAD921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * NAD25S                                              NAD25S/
      *////////////////////////////////////////////////////////////
     C     NAD25S        BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     25            ZGN1
     C     KEYMS1        SETLL     ENAD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ENAD921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     N3039         WUINTN
     C     WUINTN        CHAIN     KUNKO9                             20
     C  N20KUNKEY        CHAIN     CUNDL01                            20
     C     *IN20         IFEQ      '1'
     C                   Z-ADD     0             KUKUN2
     C                   ENDIF
     C                   SELECT
      *
     C     N3035         WHENEQ    'BY'                                         KJØP.FAKT
     C     N3039         IFNE      *BLANKS
     C     KUKUN2        ANDGT     0
     C                   MOVEL     KUKUN2        DFKNM
     C                   ENDIF
     C     N3124A        IFNE      *BLANKS
     C*                  MOVEL     N3124A        DFNAM
     C                   MOVEL     N3124A        DFNAVM
     C                   ENDIF
     C     N3124B        IFNE      *BLANKS
     C*                  MOVEL     N3124B        DFADM1
     C                   MOVEL     N3124B        DFAD1M
     C                   ENDIF
     C     N3124C        IFNE      *BLANKS
     C*                  MOVEL     N3124C        DFADM2
     C                   MOVEL     N3124C        DFAD2M
     C                   ENDIF
     C     N3036A        IFNE      *BLANKS
     C*                  MOVEL     N3036A        DFNAM
     C                   MOVEL     N3036A        DFNAVM
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C*                  MOVEL     N3042A        DFADM1
     C                   MOVEL     N3042A        DFAD1M
     C                   ENDIF
     C     N3042B        IFNE      *BLANKS
     C*                  MOVEL     N3042B        DFADM2
     C                   MOVEL     N3042B        DFAD2M
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C*                  MOVEL     N3251         DFADM2
     C                   MOVEL     N3251         DFAD2M
     C                   ENDIF
      *
     C     N3035         WHENEQ    'CN'                                         LEV.ADR
     C     N3124A        IFNE      *BLANKS
     C*                  MOVEL     N3124A        DFADL
     C                   MOVEL     N3124A        DFNAVL
     C                   ENDIF
     C     N3124B        IFNE      *BLANKS
     C*                  MOVEL     N3124B        DFADU
     C                   MOVEL     N3124B        DFAD1L
     C                   ENDIF
     C     N3124C        IFNE      *BLANKS
     C*                  MOVEL     N3124C        DFADUP
     C                   MOVEL     N3124C        DFAD2L
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C*                  MOVEL     N3042A        DFADL
     C                   MOVEL     N3042A        DFNAVL
     C                   ENDIF
     C     N3042B        IFNE      *BLANKS
     C*                  MOVEL     N3042B        DFADU
     C                   MOVEL     N3042B        DFAD1L
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C*                  MOVEL     N3251         DFADUP
     C                   MOVEL     N3251         DFAD2L
     C                   ENDIF
     C                   ENDSL
      *
     C     KEYMS1        READE     ENAD921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * PCI37                                               PCI37 /
      *////////////////////////////////////////////////////////////
     C     PCI37         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     37            ZGN2
     C     KEYMS2        SETLL     EPCI921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EPCI921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   MOVEL     P7102A        HEGM1
     C                   MOVEL     P7102B        HEGM2
      *
     C     KEYMS2        READE     EPCI921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * PCI37S                                              PCI37S/
      *////////////////////////////////////////////////////////////
     C     PCI37S        BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     37            ZGN2
     C     KEYMS2        SETLL     EPCI921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EPCI921                                53
     C     *IN53         DOWEQ     '0'
      *
      *                    MOVELP7102A    DFGM
      *
     C     KEYMS2        READE     EPCI921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF18                                               RFF18 /
      *////////////////////////////////////////////////////////////
     C     RFF18         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     18            ZGN1
     C     KEYMS1        SETLL     ERFF921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF921                                52
     C     *IN52         DOWEQ     '0'
      *________________
      * WRITE TO FRISOK
      *""""""""""""""""
     C     R1153         IFEQ      'CU '
     C                   MOVEL     'CU '         FSKODE
     C                   MOVEL     *BLANKS       FSSOK
     C                   MOVEL     R1154         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     C                   ENDIF
     C     R1153         IFEQ      'IC '
     C                   MOVEL     'IC '         FSKODE
     C                   MOVEL     *BLANKS       FSSOK
     C                   MOVEL     R1154         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     C                   ENDIF
      *
     C     KEYMS1        READE     ERFF921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF18S                                              RFF18S/
      *////////////////////////////////////////////////////////////
     C     RFF18S        BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     18            ZGN1
     C     KEYMS1        SETLL     ERFF921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF921                                52
     C     *IN52         DOWEQ     '0'
      *________________
      * WRITE TO FRISOK
      *""""""""""""""""
     C     R1153         IFEQ      'CU '
     C                   MOVEL     'CU '         FSKODE
     C                   MOVEL     *BLANKS       FSSOK
     C                   MOVEL     R1154         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     C                   ENDIF
     C     R1153         IFEQ      'IC '
     C                   MOVEL     'IC '         FSKODE
     C                   MOVEL     *BLANKS       FSSOK
     C                   MOVEL     R1154         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     C                   ENDIF
      *
     C     KEYMS1        READE     ERFF921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TOD17                                               TOD17 /
      *////////////////////////////////////////////////////////////
     C     TOD17         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     17            ZGN1
     C     KEYMS1        SETLL     ETOD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETOD921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     T4053         HEFR
      *
     C     KEYMS1        READE     ETOD921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TOD17S                                              TOD17S/
      *////////////////////////////////////////////////////////////
     C     TOD17S        BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     17            ZGN1
     C     KEYMS1        SETLL     ETOD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETOD921                                52
     C     *IN52         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     ETOD921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Get numerical value                               GETNUM /
      *////////////////////////////////////////////////////////////
     C     GETNUM        BEGSR
     C                   MOVE      *ZEROS        ZHEL
     C                   MOVE      *ZEROS        ZDEC
     C                   MOVE      *ZEROS        B
     C                   Z-ADD     1             AX                2 0
     C                   Z-ADD     1             BX                2 0
      * Get Integer
     C     A(AX)         DOWGE     '0'
     C     ZHEL          MULT      10            ZHEL
     C                   MOVE      A(AX)         ZHEL
     C                   ADD       1             AX
     C                   ENDDO
      * Decimal point ?
     C     A(AX)         IFEQ      '.'
     C     A(AX)         OREQ      ','
     C                   ADD       1             AX
     C     A(AX)         DOWGE     '0'
     C                   MOVE      A(AX)         B(BX)
     C                   ADD       1             AX
     C                   ADD       1             BX
     C                   ENDDO
     C                   MOVEA     B             ZDEC6
     C                   ENDIF
      * Concatenate
     C                   Z-ADD     ZHEL          ZNUM             18 6
     C                   ADD       ZDEC          ZNUM
     C                   ENDSR
