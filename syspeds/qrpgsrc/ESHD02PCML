      *********************************************************************
     H PGMINFO(*PCML:*MODULE)
     FBRIDF     IF   E           K DISK
     FMSGKL01   IF   E           K DISK
     D ANTSND          s              5  0
     D MaxSND          s              5  0
     D ANTRCD          s              5  0
     D MaxRCD          s              5  0
     D INEXTEXT        s            100
     D UPC             C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     D EDHD02par       PR                  extpgm(ESHD02PCML)
     D    USER                       10A   const
     D    FRADATN                     8P 0 const
     D    TILDATN                     8P 0 const
     D    VISALLE                     1A   const
     D    VISONSKE                    1A   const
     D    VISKL                       1A   const
     D    KUNUSR                      1A   const
     D    MSGKNR                      8A   dim(99) options(*varsize)
     D    MSGNAM                     30A   dim(99) options(*varsize)
     D    MSGREF                      9P 0 dim(99) options(*varsize)
     D    MSGSTA                      3A   dim(99) options(*varsize)
     D    MSGPRO                    512A   dim(99) options(*varsize)
     D    MSGLØS                    512A   dim(99) options(*varsize)
     D EDHD02par       PI
     D    USER                       10A   const
     D    FRADATN                     8P 0 const
     D    TILDATN                     8P 0 const
     D    VISALLE                     1A   const
     D    VISONSKE                    1A   const
     D    VISKL                       1A   const
     D    KUNUSR                      1A   const
     D    MSGKNR                      8A   dim(99) options(*varsize)
     D    MSGNAM                     30A   dim(99) options(*varsize)
     D    MSGREF                      9P 0 dim(99) options(*varsize)
     D    MSGSTA                      3A   dim(99) options(*varsize)
     D    MSGPRO                    512A   dim(99) options(*varsize)
     D    MSGLØS                    512A   dim(99) options(*varsize)
      *
     c     *like         define    MSGKNR        ArrKNR
     c     *like         define    MSGNAM        ArrNAM
     c     *like         define    MSGREF        ArrREF
     c     *like         define    MSGSTA        ArrSTA
     c     *like         define    MSGPRO        ArrPRO
     c     *like         define    MSGLØS        ArrLØS
     C     USER          CHAIN     BRIDF                              50
     c                   call      'ESGETPAR'
     c                   parm                    BIBRID
     c                   parm                    BIFIRM
     c                   parm                    BIKUNR
     c                   parm                    BIKNG
     c                   parm                    RowHead          10
     c                   parm                    Odd              10
     c                   parm                    Even             10
     c                   parm                    LogoImg          50
     c                   parm                    XSPRÅK            2
     c                   parm                    XINTERN           1
     c                   parm                    ParmDS1        1024
     c                   parm                    ParmDS2        1024
     c                   parm                    ParmDS3        1024
     C     XINTERN       Ifeq      'J'
     c                   eval      INEXTEXT ='Kun saksbeh: '
     c                             +'<input type=text name="KUNUSR" '
     C                             +'value="'+%trim(KUNUSR)
     C                             +'" size=10 maxlength=10>'
     C                   else
     c                   eval      INEXTEXT ='KUNDENR: <b>'
     c                             +%trim(%editc(BIKUNR:'Z'))+' '
     C                             +%trim(BIBESK)+'</B>'
     C                   endif
      *
     C                   Z-add     50            MaxSnd
     C                   Z-add     2000          MaxRcd
      *
     C                   Move      *zeros        AntSnd
     C                   Move      *zeros        AntRcd
      *
     c     *loval        setll     MSGKL01
     c                   Read      MSGKL01                                35
      *
     c     *IN35         doweq     '0'
     C                   Add       1             AntRcd
     C     AntRcd        CabGe     MaxRcd        Utles
      * div filter
     c     XINTERN       Ifne      'J'
     C     BIKUNR        CabNe     MSGKNR        NextRec
     c                   else
     c     KUNUSR        ifne      *blanks
     C     KUNUSR        CabNe     MSGSAH        NextRec
     c                   endif
     c                   end
     c     VisAlle       Ifne      'Y'
      * A=NY , AB = Åpnet av konsulent, AC-Besvart av konsulent (tilbake til 'Eier')
     c                   movel     MSGSTA        MSGSTA1           1
     C     MSGSTA1       CabNe     'A'           NextRec
     c                   endif
     c     VisOnske      Ifne      'Y'
     C     MSGMKO1       Cabeq     'O'           NextRec
     c                   endif
     c     FRADATN       Ifne      *zeros
     C     MSGDAT        Cablt     FRADATN       NextRec
     c                   end
     c     TILDATN       Ifne      *zeros
     C     MSGDAT        Cabgt     TILDATN       NextRec
     c                   end
     C                   exsr      Setrow
     C                   Add       1             AntSnd
     C     AntSnd        CabGe     MaxSnd        Utles
      *
     c     NextRec       Tag
     c                   Read      MSGKL01                                35
     c                   enddo
      *
      *
     C     UTLES         TAG
      *
     C                   eval      *inlr = *on
     C                   return
      *
      *=====================================================================
      *  Set variable data for section /$row
      *=====================================================================
     C     Setrow        begsr
      *
     c                   move      *blanks       Status           50
     c                   select
     c     MSGSTA        wheneq    'A  '
     c                   eval      Status = 'Ny'
     c     MSGEAV        ifne      *blanks                                      Endret av/eier
     c                   eval      Status = 'Påbegynt'
     c                   endif
     c     MSGTBR        ifne      *blanks                                      Endret av/eier
     c                   eval      Status = 'Videresendt'
     c                   endif
     c     MSGSTA        wheneq    'AB '                                        Åpnet av  konsulent
     c     MSGSTA        oreq      'AC '                                        Tilbake til trond
     c                   eval      Status = 'Påbegynt'
     c     MSGSTA        wheneq    'FER'
     c                   eval      Status = 'Avsluttet'
     c     MSGSTA        wheneq    '999'
     c                   eval      Status = 'Slettet'
     c                   other
     c                   eval      Status = 'UKJ: '+MSGSTA
     c                   endsl
     C     XINTERN       Ifeq      'J'
     c                   eval      Status = %trim(status)
     c                             +'<b> '+MSGSAH+'</b>'
     C                   endif
      *
     C                   MOVEL     20            DATO              8 0
     C                   MOVE      MSGDAT        DATO
     c     VisKl         ifeq      'Y'
     c                   movel     MSGTID        TID4              4 0
     c                   movel     DATO          MSGDATKL         12 0
     c                   move      TID4          MSGDATKL
     C                   end
      *
     c                   move      *blanks       MeldKo           12
     c                   select
     c     MSGMKO        wheneq    'FA'
     c                   eval      MeldKo = 'Feil, Pri A'
     c     MSGMKO        wheneq    'FB'
     c                   eval      MeldKo = 'Feil, Pri B'
     c     MSGMKO        wheneq    'FC'
     c                   eval      MeldKo = 'Feil, Pri C'
     c     MSGMKO        wheneq    'OA'
     c                   eval      MeldKo = 'Ønske, Pri A'
     c     MSGMKO        wheneq    'OB'
     c                   eval      MeldKo = 'Ønske, Pri B'
     c     MSGMKO        wheneq    'OC'
     c                   eval      MeldKo = 'Ønske, Pri C'
     c                   other
     c                   eval      MeldKo = 'UKJ: '+MSGMKO
     c                   endsl
     c                   eval      ArrKNR(AntRcd)= MSGKNR
     c                   eval      ArrNAM(AntRcd)= MSGNAM
     c                   eval      ArrREF(AntRcd)= MSGREF
     c                   eval      ArrSTA(AntRcd)= MSGSTA
     c                   eval      ArrPRO(AntRcd)= MSGPRO
     c                   eval      ArrLØS(AntRcd)= MSGLØS
     C                   endsr
      *
      *
