********************************************************************
      * PRINT MERKELAPPER FOR EN TUR / ETT OPPDRAG ELLER ETT FRAKTBERV
      *    A. VED PRINT PÅ TUR PRINTES KUN DE SOM IKKE ER PRINTET FØR
      *    B. VED PRINT PÅ OPPDRAG PRINTES DET ENTEN PÅ ALLE FR.BREV PÅ OPPDRAGET (UBETINGET)
      *           ELLER VED 0 FR.BREV PRINTES DET BASERT PÅ OPPDRAGET
      *    C. VED PRINT PÅ FR.BREV PRINTES DET PÅ AKUELT FRAKTBREV (UBETINGET)
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 JOV PTF11 På Oppd/Frbr nivå skriv ubetinget av status..
12XXX * 02 SH  PTF12 print av 1 lapp
12XXX * 03 JOV PTF12 kall med 'HE' kan ødelegge fr.nrnr(->0 ) annens parametervariabel
********************************************************************
     FTURER14   IF   E           K DISK
     FHEAD14    IF   E           K DISK
     FDOKUF     UF   E           K DISK
     FTRAN      IF   E           K DISK
     FFIRM      IF   E           K DISK
      *
     C                   EXSR      INIT
      *
      *
      * kun ett fraktbrev
     c     UFBR          ifge      1
     c     UFbr          andlt     999
     C     DOKUFKETT     Chain     DOKUF                              33
     c  N33              exsr      EttFbr
     c                   goto      slutt
     c                   end
      *
      * kun ett oppdrag ...
     c     Uopd          ifge      1
N01  c                   move      'J'           Tst0Fbr           1
     c                   exsr      EttOpd
     c                   goto      slutt
     c                   end
      *
      * Alle oppdrag på en tur
     c     Utur          ifge      1
     c                   exsr      EnTur
     c                   goto      slutt
     c                   end
      *
     c     Slutt         tag
     C                   SETON                                        LR
     C                   RETURN
      *
      ******************************************
     C     EnTur         BEGSR
      ******************************************
     C* FOR ALLE OPPD PÅ TUREN
     C     utur          SETLL     HEAD14
     C     utur          READE     HEAD14                                 35
     C     *IN35         DOWEQ     '0'
N01  c                   move      'N'           Tst0Fbr
     C                   MOVE      HEAVD         DFAVD
     C                   MOVE      HEOPD         DFOPD
     C                   exsr      EttOpd
     C     utur          READE     HEAD14                                 35
     C                   END
     c                   endsr
      ******************************************
     C     EttOpd        BEGSR
      ******************************************
     C* FOR ALLE Fraktbrev på oppdraget
     C     DOKUFKey      SETLL     DOKUF
     C     DOKUFKey      READE     DOKUF                                  35
     C     *IN35         DOWEQ     '0'
     c                   exsr      EttFbr
     C     DOKUFKey      READE     DOKUF                                  35
     C                   END
      *
N01  C                   if        Tst0Fbr='J' and AntFb = 0
N01  C                   EXSR      PRTLAB
N01  c                   endif
      *
     c                   endsr
      ******************************************
     C     EttFbr        BEGSR
      ******************************************
      * print hvis..
      *       På turnivå  kun de som ikke er printet før / på oppdragsnivå - ubetinget
N01  c                   add       1             AntFb
S01  C*    DFST          IFEQ      ' '
S01  C*    DFKDME        ANDEQ     'S'
N01  C                   IF        DFST=' ' AND DFKDME='S'
N01  C                             OR UTUR = 0
     C                   EXSR      PRTLAB
     C                   MOVE      'P'           DFKDME
     C                   END
     C                   UPDATE    DOKUFR
     c                   endsr
      ******************************************
     C     PRTLAB        BEGSR
      ******************************************
      *
N01  c     AntFb         ifgt      *zeros
     C     DFNTLA        IFEQ      *ZEROS
     C                   MOVE      DFNT          DFNTLA
     C                   END
N01  C     TRAKEY        CHAIN     TRAN                               39
N01  c                   else
N01  c                   move      'HE'          VMLAYO                         basert på Headf
N01  C                   move      *zeros        DFFBNR
N01  c                   endif
      * POSTEN krever egen label
      * Finn via transps layout om det er posten
S01  C*    TRAKEY        CHAIN     TRAN                               39
     C                   SELECT
     C     VMLAYO        WHENEQ    'PO'
     C     VMLAYO        OREQ      'P4'
N01  C     DFKNM         OREQ      '0413898'                                    TG mypack via BRING
     C     ELTRON        IFEQ      'N'
     C                   CALL      'SYFA12SP'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
S03  C*                  PARM                    DFFBNR
N03  C                   PARM      DFFBNR        xxFBNR            3 0
     C                   PARM                    UUKOPI
N02  C                   PARM                    CLID
     C                   ELSE
     C                   CALL      'SYFA12SF'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
S03  C*                  PARM                    DFFBNR
N03  C                   PARM      DFFBNR        xxFBNR            3 0
     C                   PARM                    UUKOPI
N02  C                   PARM                    CLID
     C                   END
     C                   OTHER
     c* annet = standard label
     C     ELTRON        IFEQ      'N'
     C                   CALL      'SYFA12SN'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
S03  C*                  PARM                    DFFBNR
N03  C                   PARM      DFFBNR        xxFBNR            3 0
     C                   PARM                    UUKOPI
N02  C                   PARM                    CLID
     C                   ELSE
     C                   CALL      'SYFA12SE'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
S03  C*                  PARM                    DFFBNR
N03  C                   PARM      DFFBNR        xxFBNR            3 0
     C                   PARM                    UUKOPI
N02  C                   PARM                    CLID
     C                   END
     C                   ENDSL
      *
     C     MERKS9        ENDSR
      *
      ******************************************
     C     INIT          BEGSR
      ******************************************
     C     *ENTRY        PLIST
     C                   PARM                    UUAVD             4
     C                   PARM                    UUOPD             7
     C                   PARM                    UUFBR             3
     C                   PARM                    UUTUR             8
     C                   PARM                    UPRT67           10
     C                   PARM                    UPT67            10
     C                   PARM                    UALLE             1
     C                   PARM                    CLID             35
      *
     C                   MOVE      UUAVD         UAVD              4 0
     C                   MOVE      UUOPD         UOPD              7 0
     C                   MOVE      UUFBR         UFBR              3 0
     C                   MOVE      UUTUR         UTUR              8 0
     C                   MOVE      UAVD          DFAVD
     C                   MOVE      UOPD          DFOPD
     C                   MOVE      UFBR          DFFBNR
      *
     c                   select
     C     UALLE         wheneq    'J'
     c                   MOVE      'N'           UUKOPI            1
     c                   other
     c                   MOVE      'J'           UUKOPI
     c                   end
      *
     C                   MOVE      'N'           ELTRON            1
     C     UPT67         IFEQ      'ELTRON'
     C                   MOVE      'J'           ELTRON
     C                   END
      *
     C     *loval        setll     FIRM
     c                   read      FIRM
     c                   move      FIFIRM        UFIRM             2
      *
     c     TraKey        klist
     c                   kfld                    FIFIRM
     c                   kfld                    DFTRAN
      * Key for alle på et oppdrag
     c     DOKUFKey      klist
     c                   kfld                    DFRI
     c                   kfld                    DFAVD
     c                   kfld                    DFOPD
      * Key for ETT fraktbrev
     c     DOKUFKETT     klist
     c                   kfld                    DFRI
     c                   kfld                    DFAVD
     c                   kfld                    DFOPD
     c                   kfld                    DFFBNR
      *
     c                   move      'F'           DFRI
N01  c                   move      *zeros        AntFb             5 0
      *
     C                   ENDSR
