      *
      ************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE VAREKODERS KOSTNADSPROSENT ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 02 04-09 11-24                    ***
      *** LEDIGE INDIKATORER 27-58 61-96                       ***
      ************************************************************
      *
     FKODTA     IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FSYPRO     UF A E           K DISK
     FSYFA16FM  CF   E             WORKSTN
     F                                     SLN(LINJE)
     C*
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     KODGEK        KLIST
     C                   KFLD                    WGEUNI
     C                   KFLD                    WSVKOD
     C     SYPROK        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSVKOD
     C*
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVE      'GE'          WGEUNI            2
     C     START         TAG
     C                   EXFMT     BILDE01
     C   03              GOTO      SLUTT
     C     KODTAK        CHAIN     KODTA                              99
     C   99              GOTO      START
     C*
     C                   MOVE      *BLANKS       WSVKOD
     C     SYPROK        SETLL     SYPRO
     C                   EXSR      LES
     C*
     C     START2        TAG
     C                   EXFMT     VARELI
     C*
     C   03              GOTO      SLUTT
     C   01              DO
     C                   MOVE      *ZEROS        WSAAVD
     C                   MOVE      *BLANKS       WSVKOD
     C                   MOVE      *ZEROS        WSPROS
     C                   GOTO      START
     C                   END
     C   10              DO
     C     SYPROK        CHAIN     SYPRO                              97
     C   97              GOTO      START2
     C                   DELETE    SYPR
     C     SYPROK        SETLL     SYPRO
     C                   MOVE      *BLANKS       WSVKOD
     C                   MOVE      *ZEROS        WSPROS
     C                   MOVE      *ZEROS        RULLB
     C                   EXSR      LES
     C                   GOTO      START2
     C                   END
     C   25              DO
     C                   EXSR      LES
     C                   GOTO      START2
     C                   END
     C   26              DO
     C                   EXSR      DOWN
     C                   GOTO      START2
     C                   END
     C*
     C                   EXSR      TESTB1
     C                   GOTO      START2
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     KODGEK        CHAIN     KODTGE                             99
     C     WSPROS        COMP      0                                    9898
     C*
     C  N99
     CANN98              DO
     C     SYPROK        CHAIN     SYPRO                              60
     C                   MOVE      WSAAVD        SYAVD
     C                   MOVE      WSVKOD        SYVKOD
     C                   MOVE      WSPROS        SYPROS
     C   60              WRITE     SYPR
     C  N60              UPDATE    SYPR
     C     SYPROK        SETLL     SYPRO
     C                   MOVE      *BLANKS       WSVKOD
     C                   MOVE      *ZEROS        WSPROS
     C                   MOVE      *ZEROS        RULLB
     C                   EXSR      LES
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LES           BEGSR
     C***********************************************
     C                   Z-ADD     4             LINJE
     C                   SETOFF                                       60
     C                   MOVE      *ZEROS        RULLF             2 0
     C                   WRITE     HEADER
     C*
     C     STLES         TAG
     C     WSAAVD        READE     SYPRO                                  60
     C  N60              UPDATE    SYPR
     C  N60              SUB       1             RULLB                59
     C  N60
     CAN 59              GOTO      STLES
     C   60              MOVE      WSVKOD        GVKOD             3
     C   60              MOVE      '999'         WSVKOD
     C   60SYPROK        SETLL     SYPRO
     C   60              MOVE      GVKOD         WSVKOD
     C  N60              DO
     C                   WRITE     SUBFIL
     C                   ADD       1             RULLF
     C                   ADD       1             LINJE
     C     LINJE         COMP      20                                 60
     C  N60              GOTO      STLES
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DOWN          BEGSR
     C***********************************************
     C                   Z-ADD     20            LINJE
     C                   SETOFF                                       60
     C                   MOVE      *ZEROS        RULLB             2 0
     C                   WRITE     HEADER
     C*
     C     STDOW         TAG
     C                   READP     SYPRO                                  60
     C  N60              UPDATE    SYPR
     C  N60WSAAVD        COMP      SYAVD                              6060
     C  N60              SUB       1             RULLF                59
     C  N60
     CAN 59              GOTO      STDOW
     C   60              MOVE      WSVKOD        GVKOD
     C   60              MOVE      *BLANKS       WSVKOD
     C   60SYPROK        SETLL     SYPRO
     C   60              MOVE      GVKOD         WSVKOD
     C  N60              DO
     C                   WRITE     SUBFIL
     C                   ADD       1             RULLB
     C                   SUB       1             LINJE
     C     LINJE         COMP      4                                    60
     C  N60              GOTO      STDOW
     C                   END
     C*
     C                   ENDSR
     C*
