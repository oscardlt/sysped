/* INNFØRT INFOPRINTSERVER */
/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 YBC PTF10 RETT FEIL PGA. INNFØRING AV INFOPRINTERSERVER      */
/* 10326 * 02 YBC PTF10 SVENSK TOLLAGER                                    */
/* ********************************************************************    */
             PGM        PARM(&GN &PKOD)
             DCL        VAR(&BANE0) TYPE(*CHAR) LEN(11) +
                          VALUE('/tollarkiv/')
             DCL        VAR(&BANE9) TYPE(*CHAR) LEN(4) VALUE('.pdf')
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&GN) TYPE(*CHAR) LEN(15)
             DCL        VAR(&PKOD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&P1) TYPE(*CHAR) LEN(2)
             DCL        VAR(&P2) TYPE(*CHAR) LEN(1)
             DCL        VAR(&P3) TYPE(*CHAR) LEN(1)
             DCL        VAR(&P4) TYPE(*CHAR) LEN(1)
             DCL        VAR(&P5) TYPE(*CHAR) LEN(1)
             DCL        VAR(&P6) TYPE(*CHAR) LEN(1)
             DCL        VAR(&P7) TYPE(*CHAR) LEN(1)
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(21)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10) VALUE('LISTE')
             DCL        VAR(&KNAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(5)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&DONAV) TYPE(*CHAR) LEN(12)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&PDF) TYPE(*CHAR) LEN(4) VALUE('*YES')
             DCL        VAR(&LTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70) +
                          VALUE('svein.huse@systema.no')
             DCL        VAR(&EMNE) TYPE(*CHAR) LEN(70) +
                          VALUE('GODSJOURNAL')
/*______________*/
/* LES FIRMAFIL */
/*""""""""""""""*/
             DCLF       FILE(FIRMARC) RCDFMT(*ALL)
             RCVF       DEV(*FILE) RCDFMT(*FILE)
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
    /*                                    */
    /* SKRIVER UT LISTE                   */
    /*                                    */
/*                        LPI(8) CPI(15) OVRFLW(72) PAGRTT(90) + */

             /* OVERRIDE     */
/*S01        OVRPRTF    FILE(LISTE) DEVTYPE(*AFPDS) PAGESIZE(72 198) +
                          LPI(8) CPI(15) OVRFLW(72) PAGRTT(90) +
                          FRONTOVL(SYSPED/GODSJ) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)            */
/*N01*/      OVRPRTF    FILE(LISTE) DEVTYPE(*AFPDS) PAGESIZE(64 160) +
                          LPI(8) CPI(15) OVRFLW(62) PAGRTT(90) +
                          FRONTOVL(SYSPED/GODSJ) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)
             CALL       PGM(SYTL06) PARM(&GN &PKOD)

/*                                       */
/* KALLER PROGRAMMET SOM SENDER EPOSTEN  */
/*                                       */
/*                                       */
/*S02        CHGVAR     VAR(&BANE) VALUE(&BANE0 *CAT &PKOD *CAT &GN +
                          *CAT &BANE9)    */
/*N02*/      CHGVAR     VAR(&BANE) VALUE(&BANE0 *TCAT &PKOD *TCAT &GN +
                          *TCAT &BANE9)
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/* LAGER PDF OG LEGGER I MAPPE          */
/* UTEN INFOPRINT                        */
/*                                       */
             IF         COND(&ARCINF = 'N') THEN(DO)
             CVTSPLFPDF SPLF(LISTE) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE)
             ENDDO
/* LAGER PDF OG LEGGER I MAPPE          */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&ARCINF = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANE)
             ENDDO
             RMVLIBLE   LIB(MMAIL)
             CALL       PGM(SYTL08) PARM(&BANE)
             DLTSPLF    FILE(LISTE) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
             RETURN
             CALL       PGM(FAXEPMMCL) PARM(&QUSER &QNBR &QJOB &FILEN +
                          &EPOST &EMNE +
                          &CVP1 &CVP2 &CVP3 &CVP4 &CVP5 +
                          &CVP6 &CVP7 &CVP8 &PDF)

 SLUTT:      ENDPGM
