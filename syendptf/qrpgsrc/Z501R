********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10001 * 01 YBC PTF10 REORGANISERE Z-FILER FOR TET
10XXX * 02 YBC PTF10 REORGANISERE ZAVDJ
10015 * 03 YBC PTF10 REORGANISERE ZTRACKF
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11006 * 04 YBC PTF11 NYE FILER ZOKUDGS OG ZOKUFE
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12053 * 05 YBC PTF12 FLERE FELTER ER UTVIDET.
12099 * 06 CB  PTF12 FEIL I PTF
********************************************************************
********************************************************************
     H DATEDIT(*YMD)
      ***********************************************************
      *** PROGRAMMET REORGANISERER ALLE Z-FILER MED EN        ***
      *** OPPDRAGSDATO SOM ER ELDRE ENN DEN SOM KOMMER SOM    ***
      *** PARAMETER.                                          ***
      *** OPPDRAGSDATO I ZEADF BLIR SATT NÅR OPPDRAG PLUKKES  ***
      *** OG GENERERES I SYFA10. (SYOP01R, 20R OG 30R)        ***
      ***                                                     ***
      *** PROGRAMMET BLIR KALT FRA Z500C.                     ***
      ***                                                     ***
      ***********************************************************
      *
     FZEADL01   UF   E           K DISK
     FZADFL01   UF   E           K DISK
     FZADHL01   UF   E           K DISK
     FZADVL01   UF   E           K DISK
N02  FZADVJ     UF   E           K DISK
     FZAEFL01   UF   E           K DISK
     F                                     RENAME(SADFR:SAEFR)
     FZAEHL01   UF   E           K DISK
     FZAEVL01   UF   E           K DISK
     F                                     PREFIX(E_)
N01  FZTRUHL02  UF   E           K DISK
N01  FZTRUVL02  UF   E           K DISK
N01  FZTRUVAM2  UF   E           K DISK
     FZOKUFL1   UF   E           K DISK
     FZOKUFM1   UF   E           K DISK
     FZOKUFV1   UF   E           K DISK
N04  FZOKUDGS1  UF   E           K DISK
N04  FZOKUFEL1  UF   E           K DISK
     FZOK29L1   UF   E           K DISK
     FZOK36L1   UF   E           K DISK
     FZREETXT1  UF   E           K DISK
     FZNADSL1   UF   E           K DISK
     FZAKTL01   UF   E           K DISK
     FZRISOL01  UF   E           K DISK
N03  FZTRACKL1  UF   E           K DISK
     D                 DS
     D  HEUNIK                 1      9  0
     D  SIUNIK                 1      9  0
     D  SEUNIK                 1      9  0
     D  SVUNIK                 1      9  0
N01  D  THUNIK                 1      9  0
N01  D  TVUNIK                 1      9  0
     D                 DS
     D  HEREFF                 1     17
     D  SIREFF                 1     17
     D  SEREFF                 1     17
     D  SVREFF                 1     17
N01  D  THREFF                 1     17
N01  D  TVREFF                 1     17
N05  ISADVR
N05  I              SVBELT                      I_SVBELT
      *______________________
      * Start
      *""""""""""""""""""""""
     C                   EXSR      INIT
      *
     C     *LOVAL        SETLL     ZEADL01
     C                   READ      ZEADL01                              5353
     C     *IN53         DOWEQ     '0'
     C     HEDTOP        IFLT      DATE
     C     HEST          ANDEQ     'P'
      * Sletter alle poster i Z-filene som er eldre en X antall dager
      * og har status som indikerer at posten er plukket og generert
     C                   DELETE    HEADFR
     C                   EXSR      SLETT
     C                   ENDIF
     C                   READ      ZEADL01                              5353
     C                   ENDDO
      *
     C     *LOVAL        SETLL     ZADHL01
     C                   READ      ZADHL01                                53
     C                   DOW       *IN53 = *OFF
     C                   IF        (((SIAVD <> 0) AND
     C                               (SITDN <> 0)) AND
     C                               (SIST <> ' '))
     C                   DELETE    SADHR
     C                   EXSR      SLTSAD1
     C                   ENDIF
     C                   READ      ZADHL01                                53
     C                   ENDDO
      *
     C     *LOVAL        SETLL     ZADVL01
     C                   READ      ZADVL01                                53
     C                   DOW       *IN53 = *OFF
     C                   IF        ((SVAVD <> 0) AND
     C                              (SVTDN <> 0))
S06   *
S06  C*    ZADVJK        SETLL     ZADVJ
S06  C*    ZADVJK        READE     ZADVJ                                  53
S06  C*                  DOW       *IN53 = *OFF
S06  C*                  DELETE    SADVJR
S06  C*    ZADVJK        READE     ZADVJ                                  53
S06  C*                  ENDDO
S06   *
N06   *
N06  C     ZADVJK        SETLL     ZADVJ
N06  C     ZADVJK        READE     ZADVJ                                  57
N06  C                   DOW       *IN57 = *OFF
N06  C                   DELETE    SADVJR
N06  C     ZADVJK        READE     ZADVJ                                  57
N06  C                   ENDDO
N06   *
     C                   DELETE    SADVR
     C                   EXSR      SLTSAD2
     C                   ENDIF
     C                   READ      ZADVL01                                53
     C                   ENDDO
      *
     C     *LOVAL        SETLL     ZAEHL01
     C                   READ      ZAEHL01                                53
     C                   DOW       *IN53 = *OFF
     C                   IF        (((SEAVD <> 0) AND
     C                               (SETDN <> 0)) AND
     C                               (SEST <> ' '))
     C                   DELETE    SAEHR
     C                   EXSR      SLTSAE1
     C                   ENDIF
     C                   READ      ZAEHL01                                53
     C                   ENDDO
      *
     C     *LOVAL        SETLL     ZAEVL01
     C                   READ      ZAEVL01                                53
     C                   DOW       *IN53 = *OFF
     C                   IF        ((SVAVD <> 0) AND
     C                              (SVTDN <> 0))
     C                   DELETE    SAEVR
     C                   EXSR      SLTSAE2
     C                   ENDIF
     C                   READ      ZAEVL01                                53
     C                   ENDDO
N01   *
N01  C     *LOVAL        SETLL     ZTRUHL02
N01  C                   READ      ZTRUHL02                               53
N01  C                   DOW       *IN53 = *OFF
N01  C                   IF        ((THAVD <> 0) AND
N01  C                              (THTDN <> 0))
N01  C                   DELETE    TRUHR
N01  C                   EXSR      SLTTET1
N01  C                   ENDIF
N01  C                   READ      ZTRUHL02                               53
N01  C                   ENDDO
N01   *
N01  C     *LOVAL        SETLL     ZTRUVL02
N01  C                   READ      ZTRUVL02                               53
N01  C                   DOW       *IN53 = *OFF
N01  C                   IF        ((TVAVD <> 0) AND
N01  C                              (TVTDN <> 0))
N01  C                   DELETE    TRUVR
N01  C                   EXSR      SLTTET2
N01  C                   ENDIF
N01  C                   READ      ZTRUVL02                               53
N01  C                   ENDDO
      *
     C     ENDPGM        TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     ZKEY          KLIST
     C                   KFLD                    HEUNIK
     C                   KFLD                    HEREFF
N02  C     ZADVJK        KLIST
N02  C                   KFLD                    SVREFF
N02  C                   KFLD                    SVUNIK
N02  C                   KFLD                    SVLI
      *
     C     *ENTRY        PLIST
     C                   PARM                    PDATO             6
      *
     C     PDATO         IFEQ      *BLANKS
     C     PDATO         OREQ      *ZEROS
     C                   MOVE      *ZEROS        DATE              8 0
     C                   ELSE
     C     PDATO         IFGT      '501231'
     C                   MOVEL     '19'          DATE
     C                   ELSE
     C                   MOVEL     '20'          DATE
     C                   END
     C                   MOVE      PDATO         DATE
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     SLETT         BEGSR
      ***********************************************
      *
     C     ZKEY          CHAIN     ZADFL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    SADFR
     C     ZKEY          READE     ZADFL01                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZADHL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    SADHR
     C     ZKEY          READE     ZADHL01                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZADVL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    SADVR
     C     ZKEY          READE     ZADVL01                              5353
     C                   ENDDO
      *
      *
     C     ZKEY          CHAIN     ZAEFL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    SAEFR
     C     ZKEY          READE     ZAEFL01                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZAEHL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    SAEHR
     C     ZKEY          READE     ZAEHL01                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZAEVL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    SAEVR
     C     ZKEY          READE     ZAEVL01                              5353
     C                   ENDDO
N01   *
N01  C     ZKEY          CHAIN     ZTRUHL02                           5353
N01  C     *IN53         DOWEQ     '0'
N01  C                   DELETE    TRUHR
N01  C     ZKEY          READE     ZTRUHL02                             5353
N01  C                   ENDDO
N01   *
N01  C     ZKEY          CHAIN     ZTRUVL02                           5353
N01  C     *IN53         DOWEQ     '0'
N01  C                   DELETE    TRUVR
N01  C     ZKEY          READE     ZTRUVL02                             5353
N01  C                   ENDDO
N01   *
N01  C     ZKEY          CHAIN     ZTRUVAM2                           5353
N01  C     *IN53         DOWEQ     '0'
N01  C                   DELETE    TRUVAMR
N01  C     ZKEY          READE     ZTRUVAM2                             5353
N01  C                   ENDDO
      *
     C     ZKEY          CHAIN     ZOKUFL1                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    DOKUFR
     C     ZKEY          READE     ZOKUFL1                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZOKUFM1                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    DOKUFMR
     C     ZKEY          READE     ZOKUFM1                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZOKUFV1                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    DOKUFVR
     C     ZKEY          READE     ZOKUFV1                              5353
     C                   ENDDO
N04   *
N04  C     ZKEY          CHAIN     ZOKUFEL1                           5353
N04  C     *IN53         DOWEQ     '0'
N04  C                   DELETE    DOKUFER
N04  C     ZKEY          READE     ZOKUFEL1                             5353
N04  C                   ENDDO
N04   *
N04  C     ZKEY          CHAIN     ZOKUDGS1                           5353
N04  C     *IN53         DOWEQ     '0'
N04  C                   DELETE    DOKUDGSR
N04  C     ZKEY          READE     ZOKUDGS1                             5353
N04  C                   ENDDO
      *
     C     ZKEY          CHAIN     ZOK29L1                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    DOK29R
     C     ZKEY          READE     ZOK29L1                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZOK36L1                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    DOK36R
     C     ZKEY          READE     ZOK36L1                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZREETXT1                           5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    FREETXTR
     C     ZKEY          READE     ZREETXT1                             5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZNADSL1                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    NADSR
     C     ZKEY          READE     ZNADSL1                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZAKTL01                            5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    FAKTR
     C     ZKEY          READE     ZAKTL01                              5353
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZRISOL01                           5353
     C     *IN53         DOWEQ     '0'
     C                   DELETE    FRISOKR
     C     ZKEY          READE     ZRISOL01                             5353
     C                   ENDDO
N03   *
N03  C     ZKEY          CHAIN     ZTRACKL1                           5353
N03  C     *IN53         DOWEQ     '0'
N03  C                   DELETE    TRACKFR
N03  C     ZKEY          READE     ZTRACKL1                             5353
N03  C                   ENDDO
      *
     C                   ENDSR
      ***********************************************
     C     SLTSAD1       BEGSR
      ***********************************************
      *
     C     ZKEY          CHAIN     ZADFL01                            53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    SADFR
     C     ZKEY          READE     ZADFL01                                53
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZADVL01                            53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    SADVR
     C     ZKEY          READE     ZADVL01                                53
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     SLTSAD2       BEGSR
      ***********************************************
      *
     C     ZKEY          CHAIN     ZADFL01                            53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    SADFR
     C     ZKEY          READE     ZADFL01                                53
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     SLTSAE1       BEGSR
      ***********************************************
      *
     C     ZKEY          CHAIN     ZAEFL01                            53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    SAEFR
     C     ZKEY          READE     ZAEFL01                                53
     C                   ENDDO
      *
     C     ZKEY          CHAIN     ZAEVL01                            53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    SAEVR
     C     ZKEY          READE     ZAEVL01                                53
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     SLTSAE2       BEGSR
      ***********************************************
      *
     C     ZKEY          CHAIN     ZAEFL01                            53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    SAEFR
     C     ZKEY          READE     ZAEFL01                                53
     C                   ENDDO
      *
     C                   ENDSR
      *
N01   ***********************************************
N01  C     SLTTET1       BEGSR
N01   ***********************************************
N01   *
N01  C     ZKEY          CHAIN     ZTRUVL02                           53
N01  C                   DOW       *IN53 = *OFF
N01  C                   DELETE    TRUVR
N01  C     ZKEY          READE     ZTRUVL02                               53
N01  C                   ENDDO
N01   *
N01  C     ZKEY          CHAIN     ZTRUVAM2                           53
N01  C                   DOW       *IN53 = *OFF
N01  C                   DELETE    TRUVAMR
N01  C     ZKEY          READE     ZTRUVAM2                               53
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     SLTTET2       BEGSR
N01   ***********************************************
N01   *
N01  C     ZKEY          CHAIN     ZTRUVAM2                           53
N01  C                   DOW       *IN53 = *OFF
N01  C                   DELETE    TRUVAMR
N01  C     ZKEY          READE     ZTRUVAM2                               53
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
N01   *
