     FXMLRCVF   IF   E           K DISK
     FZTELL     UF   E           K DISK
     FDKEVZ     O  A E             DISK
     C                   EXSR      INIT
     C                   EXSR      SRX01
     C                   EXSR      SRSNDCW1
     C                   EVAL      *INLR = *ON
     C                   RETURN
      ***********************************************
     C     SRX01         BEGSR
      ***********************************************
     C                   EVAL      X001_XRLEV1 = 1
     C                   EVAL      X001_XRLEV2 = 1
     C                   EVAL      X001_XRLEV3 = 0
      *
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'DataContext'                          2
      * <DataContext> -> Hent unik CW1-referanse
     C                   EXSR      SRX02A
     C                   WHEN      XRNV = 'CommercialInfo'                       2
      * <CommercialInfo> -> Fakturainfo og varelinje info
     C                   EXSR      SRX02B
     C                   WHEN      XRNV = 'MessageType'                          2
      * <MessageType> -> Sjekk om det er import eller eksport
     C                   WHEN      XRNV = 'OwnerRef'                             2
      * <OwnerRef> -> Andre referanse
     C     FRISOKK       CHAIN     FRISOK                             33
     C                   EVAL      FSSOK  = XRVERD
     C                   IF        *IN33                                          3<-B
     C                   EVAL      FSKODE = 'ORD'
     C                   MOVE      WDT           FSDTOP
     C                   WRITE     FRISOKR
     C                   ELSE                                                     3
     C                   UPDATE    FRISOKR0
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'OuterPacks'                           2
      * <OuterPacks> -> Total kolli
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SENTK
     C                   WHEN      XRNV = 'PortOfDestination'                    2
      * <PortOfDestination> -> Destinasjon
     C                   EXSR      SRX02C
     C                   WHEN      XRNV = 'ShipmentIncoTerm'                     2
      * <ShipmentIncoTerm> -> Lveringsvilkår
     C                   EXSR      SRX02D
     C                   WHEN      XRNV = 'TotalWeight'                          2
      * <TotalWeight> -> Total vekt
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SEVKB
     C                   WHEN      XRNV = 'TotalWeightUnit'                      2
      * <TotalWeightUnit> -> Vekt enhet
     C                   EXSR      SRX02E
     C                   WHEN      XRNV = 'TransportMode'                        2
      * <TransportMode> -> Transportmåte
     C                   EXSR      SRX02F
     C                   WHEN      XRNV = 'TransportNationality'                 2
      * <TransportNationality> -> Transportmiddels nasjonalitet
     C                   EXSR      SRX02G
     C                   WHEN      XRNV = 'VesselName'                           2
     C                             OR XRNV = 'VoyageFlightNo'
     C                   EVAL      SETRID = XRVERD
     C                   WHEN      XRNV = 'OrganizationAddressCollection'        2
      * <OrganizationAddressCollection> -> Avsender og mottaker
     C                   EXSR      SRX02H
     C                   EXSR      SROPDHOD
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X001_XRLEV2
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX01         ENDSR
      *
      ***********************************************
     C     SRX02A        BEGSR
      ***********************************************
      * <DataContext> -> Hent unik CW1-referanse
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'DataSourceCollection'                 2
      * <DataSourceCollectionignment>
     C                   EXSR      SRX03A1
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02A        ENDSR
      *
      ***********************************************
     C     SRX03A1       BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * <DataSource>
     C                   WHEN      XRNV = 'DataSource'                           2
     C                   EXSR      SRX04A11
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03A1       ENDSR
      *
      ***********************************************
     C     SRX04A11      BEGSR
      ***********************************************
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Key'                                  2
      * <Key>
     C                   EVAL      FSSOK = XRVERD
     C     FRISOL01K     CHAIN     FRISOL01                           33
     C                   IF        *IN33                                          3<-B
     C                   EVAL      SEAVD = 501
     C     SEAVD         CHAIN     STANDE                             33
     C                   ADD       1             SETDN
     C                   UPDATE    STANDER
     C                   SUB       1             SETDN
     C                   MOVE      WDT           SEDT
     C                   EVAL      SEST   = ' '
     C                   EVAL      SESG   = 'CW1'
N11  C                   EVAL      SESAM  = '1'
N11  C                   EVAL      SEFVK  = 0,9
     C                   EVAL      FSKODE = '*CE'
     C                   EVAL      FSDTOP = SEDT
     C                   WRITE     FRISOKR
     C                   EVAL      FSKODE = '*CA'
     C                   EVAL      FSSOK  = X_S0004
     C                   WRITE     FRISOKR
     C                   EVAL      FSKODE = '*CM'
     C                   EVAL      FSSOK  = X_S0010
     C                   WRITE     FRISOKR
     C                   EVAL      FSSOK = XRVERD
     C                   END                                                      3<-E
     C                   EVAL      XOK = 'J'
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X004_XRLEV5
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XOK = 'N'
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
      *
     C     SLX04A11      ENDSR
      *
      ***********************************************
     C     SRX02B        BEGSR
      ***********************************************
      * <CommercialInfo> -> Faktura og varelinje
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'CommercialChargeCollection'           2
      * <CommercialChargeCollection>
     C                   EXSR      SRX03B1
     C                   WHEN      XRNV = 'CommercialInvoiceCollection'          2
      * <CommercialInvoiceCollection>
     C                   EXSR      SRX03B2
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02B        ENDSR
      *
      ***********************************************
     C     SRX03B1       BEGSR
      ***********************************************
      * <CommercialChargeCollection>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03B1       ENDSR
      *
      ***********************************************
     C     SRX03B2       BEGSR
      ***********************************************
      * <CommercialInvoiceCollection>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * <CommercialInvoice>
     C                   WHEN      XRNV = 'CommercialInvoice'                    2
     C                   EXSR      SRX04B21
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03B2       ENDSR
      *
      ***********************************************
     C     SRX04B21      BEGSR
      ***********************************************
      * <CommercialInvoice>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'InvoiceNumber'                        2
      * <InvoiceNumber>
     C                   EVAL      SEFIF = XRVERD
     C                   WHEN      XRNV = 'InvoiceAmount'                        2
      * <InvoiceAmount>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SEBEL1
     C                   WHEN      XRNV = 'InvoiceCurrency'                      2
      * <InvoiceCurrency>
     C                   EXSR      SRX05B211
     C                   WHEN      XRNV = 'InvoiceDate'                          2
      * <InvoiceDate>
     C                   EVAL      SEFIDA = %SUBST(XRVERD:1:4)
     C                   EVAL      SEFIDM = %SUBST(XRVERD:6:2)
     C                   EVAL      SEFIDD = %SUBST(XRVERD:9:2)
     C                   WHEN      XRNV = 'CommercialInvoiceLineCollection'      2
      * <CommercialInvoiceLineCollection>
     C                   EXSR      SRX05B212
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X004_XRLEV5
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX04B21      ENDSR
      *
      ***********************************************
     C     SRX05B211     BEGSR
      ***********************************************
      * <InvoiceCurrency>
      *
     C                   EVAL      X005_XRLEV1 = XRLEV1
     C                   EVAL      X005_XRLEV2 = XRLEV2
     C                   EVAL      X005_XRLEV3 = XRLEV3
     C                   EVAL      X005_XRLEV4 = XRLEV4
     C                   EVAL      X005_XRLEV5 = XRLEV5
     C                   EVAL      X005_XRLEV6 = 1
     C                   EVAL      X005_XRLEV7 = 0
      *
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
      * <Code>
     C                   EVAL      SEVAL1 = XRVERD
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X005_XRLEV6
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX05B211     ENDSR
      *
      ***********************************************
     C     SRX05B212     BEGSR
      ***********************************************
      * <CommercialInvoiceLineCollection>
      *
     C                   EVAL      X005_XRLEV1 = XRLEV1
     C                   EVAL      X005_XRLEV2 = XRLEV2
     C                   EVAL      X005_XRLEV3 = XRLEV3
     C                   EVAL      X005_XRLEV4 = XRLEV4
     C                   EVAL      X005_XRLEV5 = XRLEV5
     C                   EVAL      X005_XRLEV6 = 1
     C                   EVAL      X005_XRLEV7 = 0
      *
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'CommercialInvoiceLine'                2
      * <CommercialInvoiceLine>
     C                   EXSR      SRX06B2121
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X005_XRLEV6
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX05B212     ENDSR
      *
      ***********************************************
     C     SRX06B2121    BEGSR
      ***********************************************
      * <CommercialInvoiceLine>
      *
     C                   EVAL      X006_XRLEV1 = XRLEV1
     C                   EVAL      X006_XRLEV2 = XRLEV2
     C                   EVAL      X006_XRLEV3 = XRLEV3
     C                   EVAL      X006_XRLEV4 = XRLEV4
     C                   EVAL      X006_XRLEV5 = XRLEV5
     C                   EVAL      X006_XRLEV6 = XRLEV6
     C                   EVAL      X006_XRLEV7 = 1
     C                   EVAL      X006_XRLEV8 = 0
      *
     C     XMLKEY06      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'LineNo'                               2
      * <LineNo>
     C                   EVAL      XSVLI = XSVLI + 1
     C                   EVAL      SVLI = XSVLI
     C                   WHEN      XRNV = 'CountryOfOrigin'                      2
      * <CountryOfOrigin>
     C                   EXSR      SRX07B21211
     C                   WHEN      XRNV = 'CustomsQuantity'                      2
      * <CustomsQuantity>
     C                   IF        SVNT01 = 0
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVNTM
     C                   Z-ADD     XTAL          SVNT01
     C                   END
     C                   WHEN      XRNV = 'CustomsQuantityUnit'                  2
      * <CustomsQuantityUnit>
     C                   EVAL      SVEH01 = 'PK'
     C                   WHEN      XRNV = 'Description'                          2
      * <Description>
     C                   EVAL      SVVT01 = XRVERD
     C                   WHEN      XRNV = 'HarmonisedCode'                       2
      * <HarmonisedCode>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVVNT
     C                   WHEN      XRNV = 'InvoiceQuantity'                      2
      * <InvoiceQuantity>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   IF        XTAL > 0
     C                   Z-ADD     XTAL          SVNTM
     C                   Z-ADD     XTAL          SVNT01
     C                   END
     C                   WHEN      XRNV = 'InvoiceQuantityUnit'                  2
      * <InvoiceQuantityUnit>
     C                   EVAL      SVEH01 = 'PK'
     C                   WHEN      XRNV = 'LinePrice'                            2
      * <LinePrice>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVBELT
     C                   WHEN      XRNV = 'NetWeight'                            2
      * <NetWeight>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVVKTN
     C                   WHEN      XRNV = 'NetWeightUnit'                        2
      * <NetWeightUnit>
     C                   EXSR      SRX07B21212
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X006_XRLEV7
     C     XMLKEY06      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        SVLI > 0                                     1<-B
     C                   EXSR      SROPDLIN
     C                   END                                                    1<-E
      *
     C     SLX06B2121    ENDSR
      *
      ***********************************************
     C     SRX07B21211   BEGSR
      ***********************************************
      * <CountryOfOrigin>
      *
     C                   EVAL      X007_XRLEV1 = XRLEV1
     C                   EVAL      X007_XRLEV2 = XRLEV2
     C                   EVAL      X007_XRLEV3 = XRLEV3
     C                   EVAL      X007_XRLEV4 = XRLEV4
     C                   EVAL      X007_XRLEV5 = XRLEV5
     C                   EVAL      X007_XRLEV6 = XRLEV6
     C                   EVAL      X007_XRLEV7 = XRLEV7
     C                   EVAL      X007_XRLEV8 = 1
     C                   EVAL      X007_XRLEV9 = 0
      *
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
      * <Code>
     C                   EVAL      SVFYL = XRVERD
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X007_XRLEV8
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX07B21211   ENDSR
      *
      ***********************************************
     C     SRX07B21212   BEGSR
      ***********************************************
      * <NetWeightUnit>
      *
     C                   EVAL      X007_XRLEV1 = XRLEV1
     C                   EVAL      X007_XRLEV2 = XRLEV2
     C                   EVAL      X007_XRLEV3 = XRLEV3
     C                   EVAL      X007_XRLEV4 = XRLEV4
     C                   EVAL      X007_XRLEV5 = XRLEV5
     C                   EVAL      X007_XRLEV6 = XRLEV6
     C                   EVAL      X007_XRLEV7 = XRLEV7
     C                   EVAL      X007_XRLEV8 = 1
     C                   EVAL      X007_XRLEV9 = 0
      *
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
      * <Code>
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD = 'KG'                                  3
     C                   WHEN      XRVERD = 'G'                                   3
     C                   EVAL      SVVKTN = SVVKTN * 1000
     C                   LEAVE
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X007_XRLEV8
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX07B21212   ENDSR
      *
      ***********************************************
     C     SRX02C        BEGSR
      ***********************************************
      * <PortOfDestination>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   EVAL      SELKB = %SUBST(XRVERD:1:2)
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02C        ENDSR
      *
      ***********************************************
     C     SRX02D        BEGSR
      ***********************************************
      * <ShipmentIncoTerm>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   EVAL      SELV = XRVERD
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02D        ENDSR
      *
      ***********************************************
     C     SRX02E        BEGSR
      ***********************************************
      * <TotalWeightUnit>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD= 'KG'                                   3
     C                   WHEN      XRVERD= 'G'                                    3
     C                   EVAL      SEVKB = SEVKB * 1000
     C                   ENDSL                                                    3<-E
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02E        ENDSR
      *
      ***********************************************
     C     SRX02F        BEGSR
      ***********************************************
      * <TransportNationality>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD= 'ROA'                                  3
     C                   EVAL      SETRM = 30
     C                   WHEN      XRVERD= 'SEA'                                  3
     C                   EVAL      SETRM = 10
     C                   WHEN      XRVERD= 'AIR'                                  3
     C                   EVAL      SETRM = 40
     C                   WHEN      XRVERD= 'MAI'                                  3
     C                   EVAL      SETRM = 50
     C                   WHEN      XRVERD= 'RAI'                                  3
     C                   EVAL      SETRM = 20
     C                   ENDSL                                                    3<-E
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02F        ENDSR
      *
      ***********************************************
     C     SRX02G        BEGSR
      ***********************************************
      * <TransportNationality>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   EVAL      SELKT = XRVERD
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02G        ENDSR
      *
      ***********************************************
     C     SRX02H        BEGSR
      ***********************************************
      * <OrganizationAddressCollection>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'OrganizationAddress'                  2
     C                   EXSR      SRX03H1
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02H        ENDSR
      *
      ***********************************************
     C     SRX03H1       BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'AddressType'                          2
      * <AddressType>
     C                   EVAL      XADRTYPE = XRVERD
     C                   WHEN      XRNV = 'CompanyName'                          2
      * <CompanyName>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   EVAL      SENAS = XRVERD
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   EVAL      SENAK = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Address1'                             2
      * <Address1>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   EVAL      SEADS1 = XRVERD
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   EVAL      SEADK1 = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Address2'                             2
      * <Address2>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   EVAL      SEADS2 = XRVERD
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   EVAL      SEADK2 = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'City'                                 2
      * <City>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   IF        SEADS3 = *BLANKS                                4<-B
     C                   EVAL      SEADS3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SEADS3 = %TRIM(SEADS3) + ' ' + %TRIM(XRVERD)
     C                   END                                                       4-E
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   IF        SEADK3 = *BLANKS                                4<-B
     C                   EVAL      SEADK3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SEADK3 = %TRIM(SEADK3) + ' ' + %TRIM(XRVERD)
     C                   END                                                       4-E
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'PostCode'                             2
      * <PostCode>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   IF        SEADS3 = *BLANKS                                4<-B
     C                   EVAL      SEADS3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SEADS3 = %TRIM(XRVERD) + ' ' + %TRIM(SEADS3)
     C                   END                                                       4-E
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   IF        SEADK3 = *BLANKS                                4<-B
     C                   EVAL      SEADK3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SEADK3 = %TRIM(XRVERD) + ' ' + %TRIM(SEADK3)
     C                   END                                                       4-E
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03H1       ENDSR
      *
      ***********************************************
     C     KNVTAL        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTAL
     C     1             DO        15            XN                3 0          1<-B
     C                   IF        ((XT(XN) = *BLANKS) OR (XT(XN) = '.'))        2<-B
     C                   LEAVE
     C                   ENDIF                                                   2<-E
     C                   MULT      10            XTALH
     C                   MOVE      XT(XN)        XTALH
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XT(XN) = '.'                                 1<-B
     C                   ADD       1             XN
     C                   MOVE      XT(XN)        XTALD1
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                 2<-B
     C                   MOVE      XT(XN)        XTALD2
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                  3<-B
     C                   MOVE      XT(XN)        XTALD3
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDLIN      BEGSR
      ***********************************************
     C                   EVAL      SVAVD = SEAVD
     C                   EVAL      SVTDN = SETDN
     C                   EVAL      SVLN  = SVLI
      *
     C     SADAVGEK      SETLL     SADAVGE
     C     SADAVGEK      READE     SADAVGE                                33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   IF        AGDTF <= SEDT AND AGDTT >= SEDT               2<-B
     C                   EVAL      SVAVT  = 'X'
     C                   EVAL      SVAVTS = AGSKV
     C                   EVAL      SVAVTP = AGSATS
     C                   LEAVE
     C                   END                                                     2<-E
     C     SADAVGEK      READE     SADAVGE                                33
     C                   ENDDO                                                  1<-E
      *
     C                   SELECT                                                 1<-B
     C                   WHEN      SVFYL = '91'                                 1
     C     KODTS2KV      CHAIN     KODTS2                             33
     C  N33              EVAL      SVPRE  = KS2PRE
     C                   WHEN      SVFYL = '99'                                 1
     C                   EVAL      SVPRE  = *BLANKS
     C                   OTHER                                                  1
     C                   EVAL      SVPRE  = 'C'
     C                   ENDSL                                                  1<-E
      *
     C                   SELECT                                                 1<-B
     C                   WHEN      ((SVVKTB = 0) AND (SVVKTN = 0))              1
     C                   EVAL      SVVKTB = 1
     C                   EVAL      SVVKTN = 1
     C                   WHEN      SVVKTB = 0                                   1
     C                   EVAL(H)   SVVKTB = SVVKTN * 1.1
     C                   WHEN      SVVKTN = 0                                   1
     C                   EVAL(H)   SVVKTN = SVVKTN * 0.9
     C                   ENDSL                                                  1<-E
      *
      * UNDERSTELLSNR SKAL LIGGE PÅ HOVEDLINJE
     C     1             DO        7             XN1               3 0          1<-B
     C                   IF        DOK1(XN1) = 'VI'                              2<-B
     C                   EVAL      SVEH01  = 'U.NR'
     C                   EVAL      SVNT01  = 1
     C                   EVAL      SVFT01  = DOK2(XN1)
     C     XN1           DO        6             XN2               3 0           2<-B
     C                   EVAL      DOK1(XN2) = DOK1(XN2+1)
     C                   EVAL      DOK2(XN2) = DOK2(XN2+1)
     C                   ENDDO                                                   2<-E
     C                   EVAL      DOK1(7) = *BLANKS
     C                   EVAL      DOK2(7) = *BLANKS
     C                   LEAVE
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
     C                   WRITE     DKEVZR
      *
     C                   CLEAR                   DKEVZR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDHOD      BEGSR
      ***********************************************
      *
     C     KODTLBK       CHAIN     KODTLB                             33
     C  N33              MOVE      KLBKT         SELV2
     C  N33              IF        KLBHAD = 'A'                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      SEADK3 <> *BLANKS                             2
     C                   MOVEL     SEADK3        SELVT
     C                   WHEN      SEADK2 <> *BLANKS                             2
     C                   MOVEL     SEADK2        SELVT
     C                   OTHER                                                   2
     C                   MOVEL     SEADK1        SELVT
     C                   ENDSL                                                   2<-E
     C                   ELSE                                                   1
      * KLBHAD = 'M'
     C                   SELECT                                                  2<-B
     C                   WHEN      SEADS3 <> *BLANKS                             2
     C                   MOVEL     SEADS3        SELVT
     C                   WHEN      SEADS2 <> *BLANKS                             2
     C                   MOVEL     SEADS2        SELVT
     C                   OTHER                                                   2
     C                   MOVEL     SEADK1        SELVT
     C                   ENDSL                                                   2<-E
      *
     C                   END                                                    1<-E
      *
     C     KODTS2K       CHAIN     KODTS2                             33
     C  N33              IF        KS2PRE = 'A'  OR KS2PRE = 'B' OR
     C                             KS2PRE = 'C'
     C                   MOVE      'EU'          SEDTY
     C                   ELSE
     C                   MOVE      'EX'          SEDTY
     C                   END
      *
     C                   EVAL      SELKA = 'NO'
     C                   EVAL      SELKT = 'NO'
     C                   EVAL      SEKDC = '0'
     C                   MOVE      *ZEROS        SEKDH
     C                   MOVE      *ZEROS        SEMP
     C                   MOVE      *BLANKS       SEDTØ
     C                   MOVE      *BLANKS       SE0035
     C                   MOVE      WDT           SEDT
     C                   MOVE      'I'           SESKI
      *
     C                   MOVE      'CW1'         SESG
     C     KODTSIK       CHAIN     KODTSI                             33
     C  N33              EVAL      SETARF = KSINAV
     C   33              EVAL      SETARF = 'CARGO WISE 1'
     C                   MOVE      'B'           SEUR
     C                   MOVE      ' '           SEST
     C                   Z-ADD     3             SEMP
      *
     C                   WRITE     SAEHR
     C                   WRITE     SAEHTLR
      *
     C                   EXSR      SROPDEDIM
      *
     C                   EXSR      SROPDTT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDEDIM     BEGSR
      ***********************************************
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EVAL      M0004 = X_S0004
     C                   EVAL      M0010 = X_S0010
     C                   MOVEL     CMN           M0062
     C                   EVAL      M0065 = 'UNISHI'
     C                   EVAL      M0068 = S0020 + '-EXP'
     C                   MOVEL     '830'         M1001
     C                   EVAL      M1004 = S0020
     C                   EVAL      M1225 = 'SHI'
     C                   EVAL      M1N07 = 'EXP'
     C                   EVAL      MSN = SSN
     C                   EVAL      MMN = CMN
     C                   EVAL      MSR = 'R'
     C                   EVAL      MST = 'C'
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   WRITE     EDIMR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDTT       BEGSR
      ***********************************************
      *
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   EVAL      TTUSER = ZUSER
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   EVAL      TTNAME = 'SYXML51'
     C                   EVAL      TTTEXT = 'SAD document export is entered by '
     C                             + 'CW1 shipment EXPORT'
     C                   EVAL      TTTEXL = 'SAD dokument export er laget av '
     C                             + 'CW1 shipment EXPORT'
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSNDCW1      BEGSR
      ***********************************************
     C                   IF        SEAVD <> 0
      * Send UniversalEvent til CW1 etter mottak av shipment
     C                   MOVE      SEAVD         UAVD              4
     C                   MOVE      SETDN         UTDN              7
     C                   MOVE      'EXP'         UIE               3
     C                   CALL      'SYXML52'
     C                   PARM                    USN
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    UIE
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    USN               9
      *
     C     FRISOKK       KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    F00_FSKODE
     C     *LIKE         DEFINE    FSKODE        F00_FSKODE
     C                   EVAL      F00_FSKODE = 'ORD'
     C     FRISOL01K     KLIST
     C                   KFLD                    F01_FSKODE
     C                   KFLD                    FSSOK
     C     *LIKE         DEFINE    FSKODE        F01_FSKODE
     C                   EVAL      F01_FSKODE = '*CR'
     C     KODTLBK       KLIST
     C                   KFLD                    KLBUNI
     C                   KFLD                    SELV
     C     KODTSIK       KLIST
     C                   KFLD                    KSIUNI
     C                   KFLD                    SESG
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    SELKB
     C     KODTS2KV      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    SVLK
     C     KODTVAL2K1    KLIST
     C                   KFLD                    XSEVAL1
     C                   KFLD                    XDTVKU
     C     XMLKEY01      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X001_XRLEV1
     C                   KFLD                    X001_XRLEV2
     C                   KFLD                    X001_XRLEV3
     C     XMLKEY02      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X002_XRLEV1
     C                   KFLD                    X002_XRLEV2
     C                   KFLD                    X002_XRLEV3
     C                   KFLD                    X002_XRLEV4
     C     XMLKEY03      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEY04      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X004_XRLEV1
     C                   KFLD                    X004_XRLEV2
     C                   KFLD                    X004_XRLEV3
     C                   KFLD                    X004_XRLEV4
     C                   KFLD                    X004_XRLEV5
     C                   KFLD                    X004_XRLEV6
     C     XMLKEY05      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X005_XRLEV1
     C                   KFLD                    X005_XRLEV2
     C                   KFLD                    X005_XRLEV3
     C                   KFLD                    X005_XRLEV4
     C                   KFLD                    X005_XRLEV5
     C                   KFLD                    X005_XRLEV6
     C                   KFLD                    X005_XRLEV7
     C     XMLKEY06      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X006_XRLEV1
     C                   KFLD                    X006_XRLEV2
     C                   KFLD                    X006_XRLEV3
     C                   KFLD                    X006_XRLEV4
     C                   KFLD                    X006_XRLEV5
     C                   KFLD                    X006_XRLEV6
     C                   KFLD                    X006_XRLEV7
     C                   KFLD                    X006_XRLEV8
     C     XMLKEY07      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X007_XRLEV1
     C                   KFLD                    X007_XRLEV2
     C                   KFLD                    X007_XRLEV3
     C                   KFLD                    X007_XRLEV4
     C                   KFLD                    X007_XRLEV5
     C                   KFLD                    X007_XRLEV6
     C                   KFLD                    X007_XRLEV7
     C                   KFLD                    X007_XRLEV8
     C                   KFLD                    X007_XRLEV9
     C     SADAVGEK      KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    AGAKD
      *
     C     *LIKE         DEFINE    SEAVD         XAVD
     C     *LIKE         DEFINE    SETDN         XTDN
     C     *LIKE         DEFINE    SEBEL1        XSEBEL1
     C     *LIKE         DEFINE    SEFIF         XSEFIF
     C     *LIKE         DEFINE    SVLI          XSVLI
     C     *LIKE         DEFINE    SEVAL1        XSEVAL1
     C     *LIKE         DEFINE    XRLEV1        X001_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X001_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X001_XRLEV3
     C     *LIKE         DEFINE    XRLEV1        X002_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X002_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X002_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X002_XRLEV4
     C     *LIKE         DEFINE    XRLEV1        X003_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X003_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X003_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X003_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X003_XRLEV5
     C     *LIKE         DEFINE    XRLEV1        X004_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X004_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X004_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X004_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X004_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X004_XRLEV6
     C     *LIKE         DEFINE    XRLEV1        X005_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X005_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X005_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X005_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X005_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X005_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X005_XRLEV7
     C     *LIKE         DEFINE    XRLEV1        X006_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X006_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X006_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X006_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X006_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X006_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X006_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X006_XRLEV8
     C     *LIKE         DEFINE    XRLEV1        X007_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X007_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X007_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X007_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X007_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X007_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X007_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X007_XRLEV8
     C     *LIKE         DEFINE    XRLEV9        X007_XRLEV9

     C                   MOVE      USN           XRSN
     C                   MOVE      *BLANKS       XMSGTXT         200

     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT08             8 0
     C                   MOVE      WDT           XDTVKU            8 0

     C                   CLEAR                   DKEVZR
     C                   ENDSR
