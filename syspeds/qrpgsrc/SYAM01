********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 skriver til arkiv
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED AMETAAVREGNING                ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER                                     ***
      *** 61 BASIS AMETA                                         ***
      *** 62 UTVIDET AMETA                                       ***
      **************************************************************
      *
N01  FARKTXT    IF   E           K DISK
N01  FFIRMARC   IF   E           K DISK
N01  FARKIVP    O  A E             DISK
     FCUNDL01   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FAMWTUAG   IF   E           K DISK
     FTURER14   IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKODT≈     IF   E           K DISK
     FAMGEBYR   IF   E           K DISK
     FAMANDEL   IF   E           K DISK
     FAMLOSSK   IF   E           K DISK
     FVALUAL01  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FTELLFA    UF   E           K DISK
     FFAK2      UF A E           K DISK
     FAMHE      UF A E           K DISK
     FAMDE      UF A E           K DISK
     FAMDEWRK   UF A E           K DISK
     FAMGE      UF A E           K DISK
     FAMGEWRK   UF A E           K DISK
     FAMSAML    O  A E           K DISK
     FFAIN      O  A E           K DISK
     FAMFAKWRK  O  A E           K DISK
     FSYAM01FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     D GEB             S              3    DIM(60)
N01   *___________________________
N01   * Finner username
N01   *"""""""""""""""""""""""""""
N01  D                SDS
N01  D  ZJOB                 244    253
N01  D  ZUSER                254    263
N01  D  ZJOBNR               264    269  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UDT                   30     35  0
     D  UHOD                  47     47
     D  UBBS                  48     48
     D  WF                   101    310  0
     D                                     DIM(35)
     D  WT                   311    566  0
     D                                     DIM(32)
     D  WA                   567    822  0
     D                                     DIM(32)
     D  UGN                  981    995
     D                 DS
     D  DSTXT                  1     26
     D  DSTXT1                 1      7
     D  DSTXT2                 8     14
     D  DSTXT3                15     26
     D                 DS
     D  DSNVN                  1     30
     D  DSNVN1                 1     10
     D  DSNVN2                11     11
     D  DSNVN3                12     30
     D                 DS
EV5  D  W2PER                  1      6  0
NV5  D  W2PERC                 1      2  0
EV5  D  W2PER≈                 3      4  0
EV5  D  W2PERM                 5      6  0
     D                 DS
EV5  D  MINPER                 1      6  0
NV5  D  MINCC                  1      2  0
EV5  D  MIN≈R                  3      4  0
EV5  D  MINMND                 5      6  0
SV5  D*           DS
SV5  D*                                       1   40KPER
SV5  D*                                       1   20K≈R
SV5  D*                                       3   40KMND
     D                 DS
     D  DSBDAT                 1      6  0
     D  DSBDD                  1      2  0
     D  DSBMM                  3      4  0
     D  DSB≈≈                  5      6  0
NV5  D                 DS
NV5  D  TUDT                   1      8  0
NV5  D  TUDT≈                  1      4  0
NV5  D  TUDTM                  5      6  0
NV5  D  TUDTD                  7      8  0
NV5  D                 DS
NV5  D  TUDTT                  1      8  0
NV5  D  TUDTT≈                 1      4  0
NV5  D  TUDTTM                 5      6  0
NV5  D  TUDTTD                 7      8  0
NV5  D                 DS
NV5  D  W2ADAT                 1      6  0
NV5  D  W2ADD                  1      2  0
NV5  D  W2AMM                  3      4  0
NV5  D  W2A≈≈                  5      6  0
NV5  D                 DS
NV5  D  X2ADAT                 1      8  0
NV5  D  X2A≈≈                  1      4  0
NV5  D  X2AMM                  5      6  0
NV5  D  X2ADD                  7      8  0
NV5  D                 DS
NV5  D  W2BDAT                 1      6  0
NV5  D  W2BDD                  1      2  0
NV5  D  W2BMM                  3      4  0
NV5  D  W2B≈≈                  5      6  0
NV5  D                 DS
NV5  D  X2BDAT                 1      8  0
NV5  D  X2B≈≈                  1      4  0
NV5  D  X2BMM                  5      6  0
NV5  D  X2BDD                  7      8  0
     D                 DS
     D  KSBELA                 1     17  4
     D                 DS
     D  KSBELE                 1     17  4
SV5  D*           DS
SV5  D*                                       1   60XDATO
SV5  D*                                       1   20XMND
SV5  D*                                       3   40XDAG
SV5  D*                                       5   60XAAR
     D                 DS
EV5  D  WDATO                  1      8  0
EV5  D  WAAR                   1      4  0
EV5  D  WMND                   5      6  0
EV5  D  WDAG                   7      8  0
NV5  D                 DS
NV5  D  XFFDT                  1      6  0
NV5  D  XFFDTD                 1      2  0
NV5  D  XFFDTM                 3      4  0
NV5  D  XFFDT≈                 5      6  0
NV5  D                 DS
NV5  D  FADAFF                 1      8  0
NV5  D  FADAF≈                 1      4  0
NV5  D  FADAFM                 5      6  0
NV5  D  FADAFD                 7      8  0
      *
N01  D                 DS
N01  D  XULTID                 1     14  0
N01  D  XULTM                  1      6  0
N01  D  XULDD                  7      8  0
N01  D  XULMM                  9     10  0
N01  D  XUL≈≈                 11     14  0
N01  D                 DS
N01  D  UL≈≈                   1      4  0
N01  D  ULMM                   5      6  0
N01  D  ULDD                   7      8  0
N01  D  ULDT                   1      8  0
      *
     C     *ENTRY        PLIST
     C                   PARM                    UIN10             1
     C                   PARM                    UTURNR            8 0
     C                   PARM                    UAGENT            8 0
     C     IX            PARM      IX            IX                2 0
     C                   MOVE      '0'           UIN10
      *
     C                   EXSR      INIT
      *
     C     CHOISE        TAG
     C                   CLEAR                   WNETDF
     C                   CLEAR                   TONETN
     C                   CLEAR                   WKLUM2
     C                   CLEAR                   RSDIFF
     C                   CLEAR                   TOVEKT
      *
     C                   CLEAR                   TONETN
     C                   CLEAR                   WKLUMP
     C                   CLEAR                   WKLUM2
     C                   CLEAR                   TKLUMP
     C                   CLEAR                   XKLUM2
     C                   CLEAR                   WFORN
     C                   CLEAR                   WFORDF
     C                   CLEAR                   WNETDF
     C                   CLEAR                   WNET
     C                   CLEAR                   WANET
     C                   CLEAR                   WLNET
      *
     C                   CLEAR                   ZRECNO
     C                   CLEAR                   MRECNO
     C                   CLEAR                   ANTF1
     C                   CLEAR                   ANTF2
     C                   Z-ADD     04            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      UTURNR        W1TNR
     C                   MOVE      UAGENT        W1KNA
     C                   MOVEL     W1TNR         W1AVD
      *
      **  AVSLUTT
      *
     C                   CLEAR                   BILDE2
     C                   EXSR      TESTB1
     C   30              GOTO      CHOISE
      *
     C                   Z-ADD     W1TNR         W2TNR
     C                   Z-ADD     W1TNR         UTURNR
     C     CHOIS2        TAG
     C                   Z-ADD     07            LINNBR
     C                   Z-ADD     14            POSNBR
     C     CHOIS3        TAG
     C     W2KNA         IFEQ      *ZERO
     C                   CLEAR                   W2NAVN
     C                   MOVE      'DIV2547'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     04            LINNBR
     C                   Z-ADD     14            POSNBR
      *                    GOTO SLTB2
     C                   END
     C                   CLEAR                   *IN12
     C     XAHST         IFEQ      '6'
     C                   SETON                                        77
     C                   Z-ADD     06            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   END
     C                   EXFMT     BILDE2
     C     *IN03         IFEQ      '1'
     C                   SETOFF                                       3077
     C                   EXSR      RSETAM
     C                   GOTO      SLUTT
     C                   END                                                    <*IN03
     C     *IN12         IFEQ      '1'
     C                   SETOFF                                       3077
     C                   EXSR      RSETAM
     C                   GOTO      SLUTT
     C                   END                                                    <*IN12
     C                   EXSR      TESTB2
     C   30              GOTO      CHOIS3
      *  SUBFILE CLEAR
     C     START         TAG
     C                   EXSR      BLANKW
     C                   CLEAR                   TOVEKT
     C                   CLEAR                   TEI999
     C                   CLEAR                   TEU999
     C                   CLEAR                   TAI999
     C                   CLEAR                   TAU999
     C                   CLEAR                   TOEINT
     C                   CLEAR                   TOEUTG
     C                   CLEAR                   TOAINT
     C                   CLEAR                   TOAUTG
     C                   MOVEA     '00'          *IN(91)
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   CLEAR                   XUNR
     C                   CLEAR                   XPOS1
     C                   CLEAR                   WUNR
     C                   CLEAR                   ZRECNO
     C                   CLEAR                   MRECNO
      * FINN ALLE OPPDRAG P≈ TUREN
     C     AMWKEY        SETLL     AMWTUAG
     C     HELES         TAG
     C     AMWKEY        READE     AMWTUAG                                34
     C     *IN34         IFEQ      *OFF
     C     HEADWK        CHAIN     HEADF                              51
     C                   ENDIF
     C     *IN34         IFEQ      '1'
      * TREKKING/FERJE ETC. INN HER
     C                   CLEAR                   *IN07
     C                   GOTO      START2
     C                   END
     C     *IN47         IFEQ      '1'
     C     XPOS1         ANDNE     HEPOS1
     C                   CLEAR                   WUNR
     C                   CLEAR                   XUNR
     C                   END                                                    <*IN47
     C                   MOVEL     HEPOS1        XPOS1
     C                   MOVE      '1'           *IN47
     C     START1        TAG
      * LES ALLE FAKTURALINJENE P≈ OPPDRAGET
     C     FAK2K         SETLL     FAK2
     C                   SETOFF                                           38
      * HENTER INNTEKTER/KOSTNADER PR. TUR/POSISJON
     C     FALES         TAG
     C     *IN07         IFEQ      '0'
     C     *IN39         IFEQ      '0'
     C                   EXSR      LESAME
     C                   GOTO      START2
     C                   ELSE
     C                   ADD       1             XUNR
      * BLANK TABELL HER ---------->
     C                   CLEAR                   GEB
     C                   MOVE      *ZEROS        GX                2 0
     C                   EXSR      LESFAK
     C                   END                                                    <*IN39
     C                   END                                                    <*IN07
     C     *IN07         IFEQ      '1'
      * HENT AGENTOPPLYSNINGER
     C     AMANKY        CHAIN     AMANDEL                            31
     C     *IN31         IFEQ      *OFF
      * VALUTA AGENT
     C     AAVALA        IFNE      *BLANKS
     C                   MOVE      AAVALA        W2VALA
     C                   ELSE
     C                   MOVE      AAVAL         W2VALA
     C                   END                                                    <AAVALA
      * VALUTA EGEN
     C     AAVALE        IFNE      *BLANKS
     C                   MOVE      AAVALE        W2VALE
     C                   ELSE
     C                   MOVE      AAVAL         W2VALE
     C                   END                                                    <AAVALE
     C                   ENDIF                                                  <*IN31
      *
     C                   ADD       1             XUNR
      * BLANK TABELL HER ---------->
     C                   CLEAR                   GEB
     C                   MOVE      *ZEROS        GX
     C                   EXSR      LESFAK
     C                   END                                                    <*IN07
      *  SKRIV SUBFILE
     C                   ADD       1             WUNR
     C                   ADD       1             ZRECNO
     C                   ADD       1             MRECNO
     C                   EXSR      MOVS0
     C     SFPOSN        IFEQ      '9999'
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C                   MOVE      '0'           *IN44
     C                   END                                                    <SFPOSN
     C                   WRITE     SUBFIL
     C                   MOVEA     '100'         *IN(80)
     C                   EXSR      UPDWRK
     C                   CLEAR                   SFEINT
     C                   CLEAR                   SFEUTG
     C                   CLEAR                   SFAINT
     C                   CLEAR                   SFAUTG
     C                   GOTO      HELES
      *
     C     START2        TAG
     C                   EXSR      K9999
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   Z-ADD     1             ZRECNO
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     MRECNO        IFEQ      0
     C                   Z-ADD     8             POSNBR
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   MOVE      '1'           *IN(94)
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   EXFMT     BUNN
     C                   END
      *
     C                   SETOFF                                       9899
      * AVSLUTT
     C     *IN03         IFEQ      '1'
      * LEGG UT I AMETAFILER
     C     MRECNO        IFNE      *ZEROS
     C                   EXSR      AMETA1
     C                   END                                                    <MRECNO
     C                   GOTO      SLUTT
     C                   END                                                    <*IN03
      * FRISK OPP
     C     *IN05         IFEQ      '1'
     C                   EXSR      LESWRK
     C                   Z-ADD     1             ZRECNO
     C                   GOTO      START3
     C                   END                                                    <*IN05
      * NY LINJE
     C     *IN06         IFEQ      '1'
     C                   EXSR      NYLIN
     C                   MOVEA     '010'         *IN(80)
     C                   EXSR      UPDWRK
      *
     C                   EXSR      LESWRK
     C                   GOTO      START3
     C                   END                                                    <*IN06
      * HENT ORIGINALE DATA
     C     *IN07         IFEQ      '1'
     C                   CLEAR                   WUNR
     C                   CLEAR                   XUNR
     C                   EXSR      BLANKW
     C                   GOTO      START
     C                   END                                                    <*IN07
      * LEGG UT I AMETAFILER, TIL FAKTURERING
      * OG FORDEL UTGIFTER
     C     *IN10         IFEQ      '1'
     C                   EXSR      RESULT
     C                   EXSR      KLUMP
     C                   EXSR      AMETA
n01  C     arkjn         ifeq      'J'
n01  c                   exsr      arkivsr
n01  c                   end
     C                   MOVE      '1'           UIN10
     C                   GOTO      SLUTT
     C                   END                                                    <*IN10
      * FOREG≈ENDE BILDE / NYTT SÿK
     C   12              GOTO      CHOIS2
      *
     C                   SETOFF                                       94
      * SE RESULTATAVREGNING
     C     *IN13         IFEQ      '1'
     C                   EXSR      RESULT
     C                   EXFMT     AVREGN
     C                   GOTO      START3
     C                   END                                                    <*IN13
      * ROLLUP
     C     *IN25         IFEQ      '1'
     C                   MOVE      '0'           *IN25
     C                   MOVE      '1'           *IN94
     C                   GOTO      START3
     C                   END                                                    <*IN25
      * ROLLDOWN
     C     *IN26         IFEQ      '1'
     C                   MOVE      '0'           *IN25
     C                   MOVE      '1'           *IN94
     C                   GOTO      START3
     C                   END                                                    <*IN26
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   EXSR      LESWRK
     C                   END
      *
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C/EJECT
      ***********************************************
     C     ADDS1         BEGSR
      ***********************************************
      *   BASIS AMETA
      *
      *   VANLIG LINJE
     C     FASK          IFNE      'A'
     C     KGESTA        IFEQ      'A'
     C     W2VALK        IFEQ      'NOK'
     C                   ADD       FABELN        SFEINT
     C                   ADD       FABELN        TOEINT
     C                   ELSE
     C                   ADD       FABELV        SFEINT
     C                   ADD       FABELV        TOEINT
     C                   END                                                    <W2VALK
     C                   END                                                    <KGESTA
     C                   END                                                    <FASK
      *   AGENT LINJE
     C     FASK          IFEQ      'A'
     C     W2VALK        IFEQ      'NOK'
     C                   ADD       FABELN        SFEUTG
     C                   ADD       FABELN        TOEUTG
     C                   ELSE
     C                   ADD       FABELV        SFEUTG
     C                   ADD       FABELV        TOEUTG
     C                   ENDIF                                                  <W2VALK
     C                   END                                                    <FASK
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     ADDS2         BEGSR
      ***********************************************
      *   UTVIDET AMETA
     C                   MOVE      *OFF          *IN27
      *
     C     SFKEY         KLIST
     C                   KFLD                    W2KNA
     C                   KFLD                    W2IMEX
     C                   KFLD                    FAVK
     C                   KFLD                    WIK               1
     C                   MOVE      *OFF          *IN76
      * GEBYRET DEFINERT SOM  I N N T E K T  ? ? ?
     C                   CLEAR                   AXGER
     C                   MOVE      'I'           WIK
     C                   MOVE      *OFF          *IN74
     C     SFKEY         CHAIN     AMGEBYR                            74
      * SJEKK OM GEBYRET SKAL MED P≈ DENNE FRANKATUR
     C     *IN74         IFEQ      *OFF
     C     HEFR          IFEQ      AGFR01
     C     HEFR          OREQ      AGFR02
     C     HEFR          OREQ      AGFR03
     C     HEFR          OREQ      AGFR04
     C     HEFR          OREQ      AGFR05
     C     HEFR          OREQ      AGFR06
     C     HEFR          OREQ      AGFR07
     C     HEFR          OREQ      AGFR08
     C     HEFR          OREQ      AGFR09
     C     HEFR          OREQ      AGFR10
     C     HEFR          OREQ      AGFR11
     C     HEFR          OREQ      AGFR12
     C     HEFR          OREQ      AGFR13
     C     HEFR          OREQ      AGFR14
     C     HEFR          OREQ      AGFR15
     C     HEFR          OREQ      AGFR16
     C     HEFR          OREQ      AGFR17
     C     HEFR          OREQ      AGFR18
     C     HEFR          OREQ      AGFR19
     C     HEFR          OREQ      AGFR20
     C                   MOVE      *OFF          *IN74
     C                   MOVE      *ON           *IN76
     C                   ELSE
     C                   MOVE      *ON           *IN74
     C                   ENDIF                                                  <HEFR
     C                   ENDIF                                                  <*IN74
      * SJEKK OM GEBYRET SKAL MED N≈R DET ER LOSSEKODE
     C     *IN74         IFEQ      *OFF
     C     AALOSS        IFEQ      'J'
     C                   MOVE      *ON           *IN74
     C                   MOVE      *OFF          *IN76
     C     HEKDPL        CHAIN     AMLOSSK                            73
     C     *IN73         IFEQ      *OFF
     C     FAVK          IFEQ      ALGE01
     C     FAVK          OREQ      ALGE02
     C     FAVK          OREQ      ALGE03
     C     FAVK          OREQ      ALGE04
     C     FAVK          OREQ      ALGE05
     C     FAVK          OREQ      ALGE06
     C     FAVK          OREQ      ALGE07
     C     FAVK          OREQ      ALGE08
     C     FAVK          OREQ      ALGE09
     C     FAVK          OREQ      ALGE10
     C     FAVK          OREQ      ALGE11
     C     FAVK          OREQ      ALGE12
     C     FAVK          OREQ      ALGE13
     C     FAVK          OREQ      ALGE14
     C     FAVK          OREQ      ALGE15
     C     FAVK          OREQ      ALGE16
     C     FAVK          OREQ      ALGE17
     C     FAVK          OREQ      ALGE18
     C     FAVK          OREQ      ALGE19
     C     FAVK          OREQ      ALGE20
     C                   MOVE      *OFF          *IN74
     C                   MOVE      *ON           *IN76
     C                   ELSE
     C                   MOVE      *ON           *IN74
     C                   ENDIF                                                  <FAVK
     C                   ENDIF                                                  <*IN73
     C                   ENDIF                                                  <AALOSS
     C                   ENDIF                                                  <*IN74
      *
     C     *IN74         IFEQ      *OFF
      * I N N T E K T   FRA AGENT AVTALE
     C     FASK          IFEQ      'A'
      * FLYTT TIL TABELL HER --------->
     C                   ADD       1             GX
     C                   MOVE      FAVK          GEB(GX)
      * AGENT SIDE
     C     AGIKAG        IFEQ      'A'
     C     W2VALA        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXAINT
     C                   ADD       FABELN        SFAINT
     C                   ADD       FABELN        TOAINT
     C                   ELSE
     C                   Z-ADD     FABELV        AXAINT
     C                   ADD       FABELV        SFAINT
     C                   ADD       FABELV        TOAINT
     C                   ENDIF                                                   <W2VALA
     C                   ELSE
      * EGEN SIDE
     C     W2VALE        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXEINT
     C                   ADD       FABELN        SFEINT
     C                   ADD       FABELN        TOEINT
     C                   ELSE
     C                   Z-ADD     FABELV        AXEINT
     C                   ADD       FABELV        SFEINT
     C                   ADD       FABELV        TOEINT
     C                   ENDIF                                                  <W2VALE
     C                   END                                                    <AGIKAG
     C                   END                                                    <FASK
      * I N N T E K T   FRA ANDRE LINJER
     C     FASK          IFNE      'A'
      * SJEKK HER OM AGENTAVTALE ALLEREDE ER BRUKT.
      * HVIS IKKE BRUK K LINJE.
     C     FAVK          LOOKUP    GEB                                    27
     C     *IN27         IFEQ      *OFF
     C     AGIKAG        IFEQ      'A'
     C     W2VALA        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXAINT
     C                   ADD       FABELN        SFAINT
     C                   ADD       FABELN        TOAINT
     C                   ELSE
     C                   Z-ADD     FABELV        AXAINT
     C                   ADD       FABELV        SFAINT
     C                   ADD       FABELV        TOAINT
     C                   ENDIF                                                  <W2VALA
     C                   ELSE
     C     W2VALE        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXEINT
     C                   ADD       FABELN        SFEINT
     C                   ADD       FABELN        TOEINT
     C                   ELSE
     C                   Z-ADD     FABELV        AXEINT
     C                   ADD       FABELV        SFEINT
     C                   ADD       FABELV        TOEINT
     C                   ENDIF                                                  <W2VALE
     C                   ENDIF                                                  <AGIKAG
     C                   END                                                    <*IN27
     C                   END                                                    <FASK
     C                   END                                                    <*IN74
      *
      * GEBYRET DEFINERT SOM  K O S T N A D  ? ? ?
     C                   MOVE      'K'           WIK
     C                   MOVE      *OFF          *IN75
     C     SFKEY         CHAIN     AMGEBYR                            75
      * SJEKK OM GEBYRET SKAL MED P≈ DENNE FRANKATUR
     C     *IN75         IFEQ      *OFF
     C     HEFR          IFEQ      AGFR01
     C     HEFR          OREQ      AGFR02
     C     HEFR          OREQ      AGFR03
     C     HEFR          OREQ      AGFR04
     C     HEFR          OREQ      AGFR05
     C     HEFR          OREQ      AGFR06
     C     HEFR          OREQ      AGFR07
     C     HEFR          OREQ      AGFR08
     C     HEFR          OREQ      AGFR09
     C     HEFR          OREQ      AGFR10
     C     HEFR          OREQ      AGFR11
     C     HEFR          OREQ      AGFR12
     C     HEFR          OREQ      AGFR13
     C     HEFR          OREQ      AGFR14
     C     HEFR          OREQ      AGFR15
     C     HEFR          OREQ      AGFR16
     C     HEFR          OREQ      AGFR17
     C     HEFR          OREQ      AGFR18
     C     HEFR          OREQ      AGFR19
     C     HEFR          OREQ      AGFR20
     C                   MOVE      *OFF          *IN75
     C                   MOVE      *ON           *IN76
     C                   ELSE
     C                   MOVE      *ON           *IN75
     C                   ENDIF                                                  <HEFR
     C                   ENDIF                                                  <*IN75
      * SJEKK OM GEBYRET SKAL MED N≈R DET ER LOSSEKODE
     C     *IN75         IFEQ      *OFF
     C     AALOSS        IFEQ      'J'
     C                   MOVE      *ON           *IN75
     C                   MOVE      *OFF          *IN76
     C     HEKDPL        CHAIN     AMLOSSK                            73
     C     *IN73         IFEQ      *OFF
     C     FAVK          IFEQ      ALGE01
     C     FAVK          OREQ      ALGE02
     C     FAVK          OREQ      ALGE03
     C     FAVK          OREQ      ALGE04
     C     FAVK          OREQ      ALGE05
     C     FAVK          OREQ      ALGE06
     C     FAVK          OREQ      ALGE07
     C     FAVK          OREQ      ALGE08
     C     FAVK          OREQ      ALGE09
     C     FAVK          OREQ      ALGE10
     C     FAVK          OREQ      ALGE11
     C     FAVK          OREQ      ALGE12
     C     FAVK          OREQ      ALGE13
     C     FAVK          OREQ      ALGE14
     C     FAVK          OREQ      ALGE15
     C     FAVK          OREQ      ALGE16
     C     FAVK          OREQ      ALGE17
     C     FAVK          OREQ      ALGE18
     C     FAVK          OREQ      ALGE19
     C     FAVK          OREQ      ALGE20
     C                   MOVE      *OFF          *IN75
     C                   MOVE      *ON           *IN76
     C                   ELSE
     C                   MOVE      *ON           *IN75
     C                   ENDIF                                                  <FAVK
     C                   ENDIF                                                  <*IN73
     C                   ENDIF                                                  <AALOSS
     C                   ENDIF                                                  <*IN75
      *
     C     *IN75         IFEQ      *OFF
      * K O S T N A D   FRA AGENT AVTALE
     C     FASK          IFEQ      'A'
     C     AGIKAG        IFEQ      'A'
      * AGENT SIDE
     C     W2VALA        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXAUTG
     C                   ADD       FABELN        SFAUTG
     C                   ADD       FABELN        TOAUTG
     C                   ELSE
     C                   Z-ADD     FABELV        AXAUTG
     C                   ADD       FABELV        SFAUTG
     C                   ADD       FABELV        TOAUTG
     C                   ENDIF                                                  <W2VALA
     C                   ELSE
      * EGEN SIDE
     C     W2VALE        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXEUTG
     C                   ADD       FABELN        SFEUTG
     C                   ADD       FABELN        TOEUTG
     C                   ELSE
     C                   Z-ADD     FABELV        AXEUTG
     C                   ADD       FABELV        SFEUTG
     C                   ADD       FABELV        TOEUTG
     C                   ENDIF                                                  <W2VALE
     C                   ENDIF                                                  <AGIKAG
     C                   END                                                    <FASK
      * K O S T N A D    FRA ANDRE LINJER
     C     FASK          IFNE      'A'
     C     AGIKAG        IFEQ      'A'
     C     W2VALA        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXAUTG
     C                   ADD       FABELN        SFAUTG
     C                   ADD       FABELN        TOAUTG
     C                   ELSE
     C                   Z-ADD     FABELV        AXAUTG
     C                   ADD       FABELV        SFAUTG
     C                   ADD       FABELV        TOAUTG
     C                   ENDIF                                                  <W2VALA
     C                   ELSE
     C     W2VALE        IFEQ      'NOK'
     C                   Z-ADD     FABELN        AXEUTG
     C                   ADD       FABELN        SFEUTG
     C                   ADD       FABELN        TOEUTG
     C                   ELSE
     C                   Z-ADD     FABELV        AXEUTG
     C                   ADD       FABELV        SFEUTG
     C                   ADD       FABELV        TOEUTG
     C                   ENDIF                                                  <W2VALE
     C                   ENDIF                                                  <AGIKAG
     C                   END                                                    <FASK
     C                   END                                                    <*IN75
      *
     C     *IN76         IFEQ      *ON
     C     *IN27         ANDEQ     *OFF
     C                   MOVE      W1TNR         AXTUNR
     C                   MOVE      W1KNA         AXKNA
     C                   MOVEL     HEPOS1        AXPOS
     C                   MOVE      XUNR          AXUNR
     C                   MOVE      FAAVD         AXAVD
     C                   MOVE      FAOPD         AXOPD
     C                   MOVE      FALI          AXLI
     C                   MOVE      FAVK          AXVK
     C                   WRITE     AXGER
     C                   END                                                    <*IN76
      *
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     AMETA         BEGSR
      * AVSLUTTET MED F10
      ***********************************************
     C                   CLEAR                   ANTF3
      * HENT FAKTURANUMMER VED ENKELTFAKTURA
     C                   MOVE      *ZEROS        FAFAKT
     C     FIFIRM        CHAIN     tellfa                             33
     C     *IN33         IFEQ      '0'
     C     WSFAKT        IFEQ      ' '
     C                   MOVE      FIFNR         FAFAKT
     C                   ADD       1             FIFNR
     C                   ENDIF                                                  <WSFAKT
      *
     C                   UPDATE    tellfar
     C                   END                                                    <*IN33
      * FINNER BETBET OG FORFALLSDATO
     C                   MOVE      *ZEROS        FADAFF
NV5  C                   MOVE      *ZEROS        XFFDT
     C                   MOVE      *BLANKS       BETTXT           30
     C                   CALL      'SYFA20A'
SV5  C*                    PARM           FADAFF
NV5  C     XFFDT         PARM      XFFDT         UFFDT             6 0
     C                   PARM                    BETTXT
     C                   PARM                    FIFIRM
     C                   PARM                    BETBET
NV5  C                   MOVE      XFFDTD        FADAFD
NV5  C                   MOVE      XFFDTM        FADAFM
NV5  C                   MOVE      XFFDT≈        FADAF≈
NV5  C     XFFDT≈        IFGT      50
NV5  C                   MOVEL     '19'          FADAF≈
NV5  C                   ELSE
NV5  C                   MOVEL     '20'          FADAF≈
NV5  C                   END
      * SLETTER ALLE EKSISTERENDE AMETALINJER
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C                   MOVE      *BLANKS       ZPOS
     C                   MOVE      *ZEROS        ZUNR
     C     AMDEKY        SETLL     AMDE                               40
     C     *IN40         DOWEQ     '0'
     C     AMDEKT        READE     AMDE                                   40
     C  N40              DELETE    AMDE
     C                   ENDDO
      * LEGGER UT I AMETAFILER
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W2KNA         ZKNA
     C     AMHEKY        CHAIN     AMHE                               40
     C     *IN10         IFEQ      '1'
     C                   MOVE      '3'           AHST
     C                   ELSE
     C                   MOVE      '1'           AHST
     C                   END                                                    <*IN10
     C                   MOVE      W1TNR         AHTUNR
     C                   MOVE      W2KNA         AHKNA
     C                   MOVE      W2VALK        AHVALS
     C                   Z-ADD     W2KURS        AHKURS
     C                   MOVE      W2VALA        AHVALA
     C                   Z-ADD     W2KURA        AHKURA
     C                   MOVE      W2VALE        AHVALE
     C                   Z-ADD     W2KURE        AHKURE
     C                   MOVE      W2PERM        AHDTMP
     C                   MOVE      W2PER≈        AHDT≈P
NV5  C                   MOVE      W2PERC        AHDTCP
     C                   MOVE      W2AGNT        AHDEL
     C                   MOVE      W2BILN        AHBILN
SV5  C*                    MOVE W2ADAT    AHADAT
NV5  C                   MOVE      X2ADAT        AHADAT
     C                   MOVE      W2AREF        AHAREF
     C                   MOVE      W2EREF        AHEREF
     C                   MOVE      W2ENH         AHENH
SV5  C*                    MOVE W2BDAT    AHBDAT
NV5  C                   MOVE      X2BDAT        AHBDAT
     C                   MOVE      W2KNT         AHKNT
     C                   MOVE      W2TRAN        AHTRAN
     C                   MOVE      W2TRKO        AHTRKO
     C                   MOVE      W2TRKP        AHTRKP
     C                   MOVE      W2FERJ        AHFERJ
     C                   MOVE      W2FERP        AHFERP
     C                   MOVE      W2TREK        AHTREK
     C                   MOVE      W2TREP        AHTREP
     C                   MOVE      W2DIV         AHDIV
     C                   MOVE      W2DIVP        AHDIVP
     C                   MOVE      W2DIVT        AHDIVT
     C                   MOVE      W2DIV2        AHDIV2
     C                   MOVE      W2DIVQ        AHDIVQ
     C                   MOVE      W2DIVU        AHDIVU
     C                   MOVE      W2TYPE        AHTYPE
     C                   MOVE      FAFAKT        AHFAKT
     C                   ADD       1             IX
     C                   MOVE      FAFAKT        WF(IX)
     C                   MOVE      AHTUNR        WT(IX)
     C                   MOVE      AHKNA         WA(IX)
      * SKRIV AMFAKWRK VED ENKELTFAKTURA
     C     WSFAKT        IFEQ      ' '
     C                   MOVE      FAFAKT        AFFAKT
     C                   MOVE      AHTUNR        AFTUNR
     C                   MOVE      W2KNA         AFKNA
     C                   WRITE     AMFAKR
     C                   ENDIF                                                  <WSFAKT
      * OPPDATER AMHE
     C     *IN40         IFEQ      '0'
     C                   UPDATE    AMHER
     C                   ELSE
     C                   WRITE     AMHER
     C                   END                                                    <*IN40
      * SKRIV ALLE LINJER P≈ OPPDRAGET
     C                   Z-ADD     0             SUBREC            5 0
     C     SUBLES        TAG
     C                   ADD       1             SUBREC
     C     SUBREC        CHAIN     SUBFIL                             37
     C     *IN37         IFEQ      '0'
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVEL     SFPOS7        ZPOS
     C                   MOVE      SFUNR         ZUNR
     C     *IN10         IFEQ      '1'
     C                   MOVE      '3'           ADST
     C                   EXSR      FORDEL
     C                   ELSE
     C                   MOVE      '1'           ADST
     C                   MOVE      *ZEROS        WFORN
     C                   MOVE      *ZEROS        ADNETN
     C                   MOVE      *ZEROS        ADFORN
     C                   END                                                    <*IN10
     C                   MOVE      W1TNR         ADTUNR
     C                   MOVE      W1KNA         ADKNA
     C                   MOVEL     SFPOS7        ADPOS
     C                   MOVE      SFUNR         ADUNR
     C                   MOVE      SFAVD         ADAVD
     C                   MOVE      SFOPD         ADOPD
     C                   MOVE      SFVEKT        ADVKT
     C                   Z-ADD     SFVOL         ADM3
     C                   MOVE      SFVTXT        ADVTXT
     C                   MOVE      SFFRAN        ADFR
     C                   MOVE      SFTXT         ADTXT
     C                   MOVE      SFEINT        ADEINT
     C                   MOVE      SFEUTG        ADEUTG
     C                   MOVE      SFAINT        ADAINT
     C                   MOVE      SFAUTG        ADAUTG
     C                   WRITE     AMDER
     C     SFPOSN        IFEQ      '9999'
     C                   GOTO      SUBLES
     C                   END                                                    <SFPOSN
      * SLETTER A-LINJER I FAKT
     C                   MOVE      ADAVD         ZEAVD
     C                   MOVE      ADOPD         ZEOPD
     C                   MOVE      'A'           ZESK
     C     DLTFAK        TAG
     C     FAK2KA        READE     FAK2                                   28
     C     *IN28         IFEQ      '0'
     C                   DELETE    FAKTR
     C                   GOTO      DLTFAK
     C                   END                                                    <*IN28
      * LEGGER UT EN LINJE FOR FAKTURA
     C                   MOVE      *BLANKS       FA01
     C                   MOVE      ADAVD         FAAVD
     C                   MOVE      ADOPD         FAOPD
     C                   MOVE      'X'           FASK
     C                   MOVE      'AME'         FAVK
     C                   MOVE      *BLANKS       FAVT
     C                   MOVE      W2VALK        FAVAL
     C                   MOVE      W2VALK        FACURI
     C                   MOVE      AHFAKT        FAFAKT
     C                   MOVE      'N'           FAKDM
     C                   MOVE      *BLANKS       FAKDUL
     C                   MOVE      *BLANKS       FA01B
     C                   MOVE      *BLANKS       FAKDUK
     C                   MOVE      *ZEROS        FABELU
     C                   MOVE      AHKNA         FAKUNR
     C                   MOVE      *ZEROS        FAJOUR
NV5  C                   MOVE      AHDTCP        FACC
     C                   MOVE      AHDT≈P        FA≈R
     C                   MOVE      AHDTMP        FAMND
     C                   MOVE      *ZEROS        FAFRBN
SV5  C*                    MOVE UDATE     XDATO
SV5  C*                    MOVE XDAG      WDAG
SV5  C*                    MOVE XMND      WMND
SV5  C*                    MOVE XAAR      WAAR
NV5  C                   MOVE      UDAY          WDAG
NV5  C                   MOVE      UMONTH        WMND
NV5  C                   MOVE      UYEAR         WAAR
NV5  C     UYEAR         IFGT      50
NV5  C                   MOVEL     '19'          WAAR
NV5  C                   ELSE
NV5  C                   MOVEL     '20'          WAAR
NV5  C                   END
     C     WSFAKT        IFEQ      ' '
     C                   MOVE      'P'           FAKDA
     C                   MOVE      'F'           FAOPKO
     C                   MOVE      WDATO         FADATO
     C                   ELSE
     C                   MOVE      'C'           FAKDA
     C                   MOVE      ' '           FAOPKO
     C                   MOVE      *ZEROS        FADATO
     C                   ENDIF                                                  <WSFAKT
     C                   MOVE      *ZEROS        FAAVDR
     C                   MOVE      *ZEROS        FAB∆R
     C                   MOVE      *ZEROS        FALEVN
      *  SKRIVER FAKTURALINJE MED LINJENS NETTO
     C     ADNETN        MULT      -1            FABELV
      *  AVREGNINGSVALUTA = 'NOK'
     C     W2VALK        IFEQ      'NOK'
     C                   Z-ADD     FABELV        FABELN
     C                   ELSE
      *  AVREGNINGSVALUTA IKKE = 'NOK'
     C     FABELV        MULT      W2KURS        FABELN
     C     FABELN        DIV       WXFAK         FABELN
     C                   ENDIF                                                  <W2VALK
      *  FINNER LINJENUMMER FOR FAKTURAFIL
     C                   MOVE      FAAVD         XXAVD
     C                   MOVE      FAOPD         XXOPD
     C                   MOVE      *ZEROS        XXLI
     C                   CALL      'SYGE06'
     C                   PARM                    XXAVD
     C                   PARM                    XXOPD
     C                   PARM                    XXLI
     C                   MOVE      XXLI          FALI
     C                   WRITE     FAKTR
      *  FINNER LINJENUMMER FOR FAKTURAFIL
     C                   ADD       1             FALI
      *  SKRIVER FAKTURALINJE MED LINJENS ANDEL AV KLUMPSUM
      *  HVIS IKKE LIK NULL
     C     ADFORN        IFNE      *ZEROS
     C     ADFORN        MULT      -1            FABELV
      *  AVREGNINGSVALUTA = 'NOK'
     C     W2VALK        IFEQ      'NOK'
     C                   Z-ADD     FABELV        FABELN
     C                   ELSE
      *  AVREGNINGSVALUTA IKKE = 'NOK'
     C     FABELV        MULT      W2KURS        FABELN
     C     FABELN        DIV       WXFAK         FABELN
     C                   ENDIF                                                  <W2VALK
     C                   MOVE      TXTKST        FAVT
     C                   WRITE     FAKTR
     C                   ENDIF                                                  <ADFORN
      * SKRIV AMSAML VED SAMLEFAKTURA
     C     WSFAKT        IFNE      ' '
     C                   MOVE      FAAVD         SAAVD
     C                   MOVE      FIFIRM        SAFIRM
     C                   MOVE      FAKUNR        SAKN
     C                   MOVE      W1TNR         SAPRO
     C                   MOVE      FAOPD         SAOPD
     C                   MOVE      'X'           SASK
     C                   MOVE      *BLANKS       SAXXX
     C                   WRITE     SAMLR
     C                   ENDIF                                                  <WSFAKT
      * SKRIV RECORD I FAIN VED ENKELTFAKTURA
     C     WSFAKT        IFEQ      ' '
     C                   Z-ADD     FAFAKT        FIFN
     C                   Z-ADD     ADAVD         FIAVD
     C                   Z-ADD     ADOPD         FIOPD
     C                   WRITE     FAINR
     C                   ENDIF                                                  <WSFAKT
     C                   GOTO      SUBLES
     C                   END                                                    <*IN37
      *
     C                   EXSR      WRK2AG
      *
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     AMETA1        BEGSR
      * AVSLUTTET MED F3
      ***********************************************
      * SLETTER ALLE EKSISTERENDE AMETALINJER
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C                   MOVE      *BLANKS       ZPOS
     C                   MOVE      *ZEROS        ZUNR
     C     AMDEKY        SETLL     AMDE                               40
     C     *IN40         DOWEQ     '0'
     C     AMDEKT        READE     AMDE                                   40
     C  N40              DELETE    AMDE
     C                   ENDDO
      * LEGGER UT I AMETAFILER
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W2KNA         ZKNA
     C     AMHEKY        CHAIN     AMHE                               40
     C     *IN10         IFEQ      '1'
     C                   MOVE      '3'           AHST
     C                   ELSE
     C                   MOVE      '1'           AHST
     C                   END                                                    <*IN10
     C                   MOVE      W1TNR         AHTUNR
     C                   MOVE      W2KNA         AHKNA
     C                   MOVE      W2VALK        AHVALS
     C                   Z-ADD     W2KURS        AHKURS
     C                   MOVE      W2VALA        AHVALA
     C                   Z-ADD     W2KURA        AHKURA
     C                   MOVE      W2VALE        AHVALE
     C                   Z-ADD     W2KURE        AHKURE
     C                   MOVE      W2PERM        AHDTMP
     C                   MOVE      W2PER≈        AHDT≈P
NV5  C                   MOVE      W2PERC        AHDTCP
     C                   MOVE      W2AGNT        AHDEL
     C                   MOVE      W2BILN        AHBILN
SV5  C*                    MOVE W2ADAT    AHADAT
NV5  C                   MOVE      X2ADAT        AHADAT
     C                   MOVE      W2AREF        AHAREF
     C                   MOVE      W2EREF        AHEREF
     C                   MOVE      W2ENH         AHENH
SV5  C*                    MOVE W2BDAT    AHBDAT
NV5  C                   MOVE      X2BDAT        AHBDAT
     C                   MOVE      W2KNT         AHKNT
     C                   MOVE      W2TRAN        AHTRAN
     C                   MOVE      W2TRKO        AHTRKO
     C                   MOVE      W2TRKP        AHTRKP
     C                   MOVE      W2FERJ        AHFERJ
     C                   MOVE      W2FERP        AHFERP
     C                   MOVE      W2TREK        AHTREK
     C                   MOVE      W2TREP        AHTREP
     C                   MOVE      W2DIV         AHDIV
     C                   MOVE      W2DIVP        AHDIVP
     C                   MOVE      W2DIVT        AHDIVT
     C                   MOVE      W2DIV2        AHDIV2
     C                   MOVE      W2DIVQ        AHDIVQ
     C                   MOVE      W2DIVU        AHDIVU
     C                   MOVE      W2TYPE        AHTYPE
     C                   MOVE      FAFAKT        AHFAKT
     C                   ADD       1             IX
     C                   MOVE      FAFAKT        WF(IX)
     C                   MOVE      AHTUNR        WT(IX)
     C                   MOVE      AHKNA         WA(IX)
      * OPPDATER AMHE
     C     *IN40         IFEQ      '0'
     C                   UPDATE    AMHER
     C                   ELSE
     C                   WRITE     AMHER
     C                   END                                                    <*IN40
      * SKRIV ALLE LINJER P≈ OPPDRAGET
     C                   Z-ADD     0             SUBREC            5 0
     C     SUBLS1        TAG
     C                   ADD       1             SUBREC
     C     SUBREC        CHAIN     SUBFIL                             37
     C     *IN37         IFEQ      '0'
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVEL     SFPOS7        ZPOS
     C                   MOVE      SFUNR         ZUNR
     C                   MOVE      '1'           ADST
     C                   MOVE      W1TNR         ADTUNR
     C                   MOVE      W1KNA         ADKNA
     C                   MOVEL     SFPOS7        ADPOS
     C                   MOVE      SFUNR         ADUNR
     C                   MOVE      SFAVD         ADAVD
     C                   MOVE      SFOPD         ADOPD
     C                   MOVE      SFVEKT        ADVKT
     C                   Z-ADD     SFVOL         ADM3
     C                   MOVE      SFVTXT        ADVTXT
     C                   MOVE      SFFRAN        ADFR
     C                   MOVE      SFTXT         ADTXT
     C                   MOVE      SFEINT        ADEINT
     C                   MOVE      SFEUTG        ADEUTG
     C                   MOVE      SFAINT        ADAINT
     C                   MOVE      SFAUTG        ADAUTG
     C                   MOVE      *ZEROS        ADNETN
     C                   MOVE      *ZEROS        ADFORN
     C                   WRITE     AMDER
     C                   GOTO      SUBLS1
     C                   END                                                    <*IN37
      *
     C                   EXSR      WRK2AG
      *
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     ATEXT         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       W2TYPT
     C     W2TYPE        IFEQ      'P'
     C                   MOVEL     'POOL    '    W2TYPT
     C                   ENDIF                                                  <W2TYPE
     C     W2TYPE        IFEQ      'F'
     C                   MOVEL     'FRANKATU'    W2TYPT
     C                   MOVE      'RAVHENG.'    W2TYPT
     C                   ENDIF                                                  <W2TYPE
     C     W2TYPE        IFEQ      'H'
     C                   MOVEL     'HUS-HUS '    W2TYPT
     C                   ENDIF                                                  <W2TYPE
     C     W2TYPE        IFEQ      ' '
     C                   MOVEL     'HUS-HUS '    W2TYPT
     C                   ENDIF                                                  <W2TYPE
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     BDEL          BEGSR
      ***********************************************
     C                   Z-ADD     W2AGNT        PAPRO1
     C     GTDIFF        MULT      W2AGNT        PADEL            15 2
     C     PADEL         DIV       100           PADEL
     C                   MVR                     WREST             2 0868785
     C                   Z-ADD     PADEL         PABEL1
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     BGEV          BEGSR
      ***********************************************
     C     W2TYPE        IFNE      'P'
     C                   Z-ADD     KSAINT        GTDIFF           13 2
     C                   ADD       KSAUTG        GTDIFF
     C                   ADD       KSEINT        GTDIFF
     C                   ADD       KSEUTG        GTDIFF
     C                   ELSE
     C     SMEINT        SUB       SM9999        GTDIFF
     C                   ENDIF                                                  <W2TYPE
     C     GTDIFF        IFGT      *ZERO
     C                   MOVE      '0'           *IN50
     C                   ELSE
     C                   MOVE      '1'           *IN50
     C                   END                                                    <GTDIFF
     C                   Z-ADD     GTDIFF        GTBEL1
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     BLANKA        BEGSR
      ***********************************************
     C     ZTUNR         CHAIN     AMHE                               40
     C  N40              DELETE    AMHE
      *
     C                   CLEAR                   *IN40
     C     ZTUNR         SETLL     AMDE                                   40
     C     STRBLA        TAG
     C     ZTUNR         READE     AMDE                                   40
     C   40              GOTO      ENDBLA
     C                   DELETE    AMDE
     C                   GOTO      STRBLA
     C     ENDBLA        ENDSR
     C/EJECT
      ***********************************************
     C     BLANKW        BEGSR
      ***********************************************
     C                   CLEAR                   *IN40
     C     ZNULL         SETLL     AMDEWRK                                40
     C     STRBL1        TAG
     C                   READ      AMDEWRK                                40
     C   40              GOTO      STRBL2
     C                   DELETE    AMDEWRK
     C                   GOTO      STRBL1
      *
     C     STRBL2        TAG
     C                   CLEAR                   *IN40
     C     ZNULL         SETLL     AMGEWRK                                40
     C     STRBL3        TAG
     C                   READ      AMGEWRK                                40
     C   40              GOTO      ENDBLN
     C                   DELETE    AMGEWRK
     C                   GOTO      STRBL3
     C     ENDBLN        ENDSR
     C/EJECT
      ***********************************************
     C     BRES          BEGSR
      ***********************************************
     C     W2TYPE        IFNE      'P'
     C     PADEL         SUB       KSBELA        RSDIFF           13 2
     C                   ELSE
     C     PADEL         SUB       SMEUTG        RSDIFF
     C                   ENDIF                                                  <W2TYPE
     C     RSDIFF        IFGT      0
     C                   Z-ADD     RSDIFF        RSBEL1
     C                   MOVEA     '10'          *IN(55)
     C                   ELSE
     C     RSDIFF        MULT      -1            RSBEL2
     C                   MOVEA     '01'          *IN(55)
     C                   END                                                    <RSDIFF
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     BSALDO        BEGSR
      ***********************************************
      *
      *  BEREGNER SALDO OG OMREGNET TIL KURS
      *
      * AGENT RESULTAT
     C     SMAINT        SUB       SMAUTG        SLADIF           13 2
     C     W2VALA        IFEQ      W2VALK
     C     SLADIF        MULT      1             KSBELA
     C                   ELSE
      * AGENT VALUTA IKKE = 'NOK'
     C     W2VALA        IFEQ      'NOK'
     C     SLADIF        MULT      WXFAK         KSBELA
     C     KSBELA        DIV       W2KURS        KSBELA
     C                   ELSE
      * AGENT VALUTA  = 'NOK'
     C     SLADIF        MULT      W2KURS        KSBELA
     C     KSBELA        DIV       WXFAK         KSBELA
     C                   ENDIF                                                  <W2VALA
     C                   ENDIF                                                  <W2VALA
     C     SLADIF        IFGT      *ZERO
     C                   Z-ADD     SLADIF        SLAINT
     C                   Z-ADD     0             SLAUTG
     C                   Z-ADD     KSBELA        KSAINT
     C                   Z-ADD     0             KSAUTG
     C                   MOVEA     '10'          *IN(51)
     C                   ELSE
     C                   Z-ADD     0             SLAINT
     C                   Z-ADD     SLADIF        SLAUTG
     C                   Z-ADD     0             KSAINT
     C                   Z-ADD     KSBELA        KSAUTG
     C                   MOVEA     '01'          *IN(51)
     C                   ENDIF                                                  <SLADIF
      * EGET RESULTAT
     C     SMEINT        SUB       SMEUTG        SLEDIF           13 2
     C     W2VALE        IFEQ      W2VALK
     C     SLEDIF        MULT      1             KSBELE
     C                   ELSE
      * EGEN VALUTA IKKE = 'NOK'
     C     W2VALE        IFEQ      'NOK'
     C     SLEDIF        MULT      WXFAK         KSBELE
     C     KSBELE        DIV       W2KURS        KSBELE
     C                   ELSE
      * EGEN VALUTA  = 'NOK'
     C     SLEDIF        MULT      W2KURS        KSBELE
     C     KSBELE        DIV       WXFAK         KSBELE
     C                   ENDIF                                                  <W2VALE
     C                   ENDIF                                                  <W2VALE
     C     SLEDIF        IFGT      *ZERO
     C                   Z-ADD     SLEDIF        SLEINT
     C                   Z-ADD     0             SLEUTG
     C                   Z-ADD     KSBELE        KSEINT
     C                   Z-ADD     0             KSEUTG
     C                   MOVEA     '10'          *IN(53)
     C                   ELSE
     C                   Z-ADD     0             SLEINT
     C                   Z-ADD     SLEDIF        SLEUTG
     C                   Z-ADD     0             KSEINT
     C                   Z-ADD     KSBELE        KSEUTG
     C                   MOVEA     '01'          *IN(53)
     C                   ENDIF                                                  <SLEDIF
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     FORDEL        BEGSR
      ***********************************************
     C     SFPOSN        IFNE      '9999'
     C                   ADD       1             ANTF3             4 0
      *  BEREGNER NETTO FOR LINJEN I NOK
      *  LEGGER  ÿREDIFFERANSEN INN I SISTE LINJE
      *  FÿR POSISJON 9999
      *
      *  AGENTS NETTO
     C     SFAINT        SUB       SFAUTG        WANET            17 6
      *
     C     W2VALA        IFNE      W2VALK
      * AGENT VALUTA  = 'NOK'
     C     W2VALA        IFEQ      'NOK'
     C     WANET         MULT      WXFAK         WANET
     C     WANET         DIV       W2KURS        WANET
     C                   ELSE
      * AGENT VALUTA IKKE = 'NOK'
     C     WANET         MULT      W2KURS        WANET
     C     WANET         DIV       WXFAK         WANET
     C                   ENDIF                                                  <W2VALA
     C                   ENDIF                                                  <W2VALA
      * EGEN NETTO
     C     SFEINT        SUB       SFEUTG        WENET            17 6
      *
     C     W2VALE        IFNE      W2VALK
      * EGEN VALUTA  = 'NOK'
     C     W2VALE        IFEQ      'NOK'
     C     WENET         MULT      WXFAK         WENET
     C     WENET         DIV       W2KURS        WENET
     C                   ELSE
      * EGEN VALUTA IKKE = 'NOK'
     C     WENET         MULT      W2KURS        WENET
     C     WENET         DIV       WXFAK         WENET
     C                   ENDIF                                                  <W2VALE
     C                   ENDIF                                                  <W2VALE
      *  LINJENS NETTO I NOK
     C     WANET         ADD       WENET         WLNET            17 6
      *  AGENT ANDEL
     C     WLNET         MULT      W2AGNT        WANET2           17 6
     C     WANET2        DIV       100           WANET2
      *  EGET RESULTAT P≈ LINJEN
     C     WANET2        SUB       WANET         WNET             17 6
      *
     C     WNET          MULT(H)   1             ADNETN
     C                   ADD       ADNETN        TONETN           15 2
      *  LEGGER  ÿREDIFFERANSEN INN I SISTE LINJE
      *  FÿR POSISJON 9999
     C     ANTF3         IFEQ      ANTF1
     C     RSDIFF        SUB       WKLUM2        WNETDF           13 2
     C     WNETDF        SUB       TONETN        WNETDF
     C                   ADD       WNETDF        ADNETN
     C                   END                                                    <ANTF3
      *  FORDELER KLUMPSUM UT P≈ LINJENE
     C     SFVEKT        DIV       TOVEKT        WFAK99           10 9
     C     WKLUM2        MULT(H)   WFAK99        WFORN            13 2
     C                   Z-ADD     WFORN         ADFORN
     C                   ADD       WFORN         TKLUMP           15 2
     C     ANTF3         IFEQ      ANTF1
     C     WKLUM2        SUB       TKLUMP        WFORDF           13 2
     C                   ADD       WFORDF        ADFORN
     C                   END                                                    <ANTF2
     C                   END                                                    <SFPOSN
     C     SFPOSN        IFEQ      '9999'
     C                   Z-ADD     0             ADNETN
     C                   Z-ADD     0             ADFORN
     C                   END                                                    <SFPOSN
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     HENTMS        BEGSR
      ***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
      *
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     HENTSR        BEGSR
      ***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   ENDDO                                                  <98 DO
     C     ZRECNO        DIV       5             LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     9             LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END                                                    <XLIN
      *    OPTION 2=ENDRE
     C     WSNRO         IFEQ      '2'                                          ENDRE
     C                   MOVE      ' '           WSNRO
     C                   MOVE      '1'           *IN99
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     29            POSNBR
     C     TENDRE        TAG
     C     SFPOSN        IFEQ      '9999'
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C                   MOVE      '0'           *IN44
     C                   END                                                    <SFPOSN
     C                   EXFMT     CHGLIN
      *  TEST FOR GYLDIG FRANKATUR
     C   12              GOTO      SLHENT
      *
     C                   EXSR      TESTLI
     C     *IN30         IFEQ      '1'
     C                   GOTO      TENDRE
     C                   END                                                    <*IN30
      *
     C                   UPDATE    SUBFIL
     C                   MOVEA     '010'         *IN(80)
     C                   EXSR      UPDWRK
     C                   END                                                    <WSNRO
      *    OPTION 4=SLETTE
     C     WSNRO         IFEQ      '4'                                          SLETTE
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     02            POSNBR
     C                   MOVE      '1'           *IN99
     C     SFPOSN        IFEQ      '9999'
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C                   MOVE      '0'           *IN44
     C                   END                                                    <SFPOSN
     C                   EXFMT     DLTLIN
     C   12              GOTO      SLHENT
     C                   UPDATE    SUBFIL
     C                   MOVEA     '001'         *IN(80)
     C                   EXSR      UPDWRK
     C                   END                                                    <WSNRO
      *    OPTION 5=VISE KOMPONENTER
     C     WSNRO         IFEQ      '5'
     C     *IN61         ANDEQ     *ON
     C                   MOVE      ' '           WSNRO
     C                   ENDIF                                                  <WSNRO
     C     WSNRO         IFEQ      '5'                                          ENDRE
     C                   MOVE      ' '           WSNRO
     C                   MOVE      '1'           *IN99
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     29            POSNBR
      *
     C                   MOVE      W2TNR         PTNR              8
     C                   MOVE      SFAVD         PAVD              4
     C                   MOVE      SFOPD         POPD              7
     C                   MOVE      W2KNA         PKNA              8
     C                   MOVEL     W2NAVN        PNAVN            30
     C                   MOVE      W2IMEX        PIMEX             1
     C                   MOVEL     SFPOS7        PPOSN
     C                   MOVE      SFUNR         PUNR              8
     C                   MOVE      SFVEKT        PVEKT             5
     C                   MOVE      SFVOL         PVOL              7
     C                   MOVE      SFVTXT        PTXT              2
     C                   MOVE      SFFRAN        PFRAN             3
     C                   CALL      'SYAM01A'
     C                   PARM                    PTNR
     C                   PARM                    PAVD
     C                   PARM                    POPD
     C                   PARM                    PKNA
     C                   PARM                    PNAVN
     C                   PARM                    PIMEX
     C                   PARM                    PPOSN
     C                   PARM                    PUNR
     C                   PARM                    PEINT
     C                   PARM                    PEUTG
     C                   PARM                    PAINT
     C                   PARM                    PAUTG
     C                   PARM                    PVEKT
     C                   PARM                    PTXT
     C                   PARM                    PFRAN
     C                   PARM                    PVOL
      *
     C                   MOVE      PEINT         SFEINT
     C                   MOVE      PEUTG         SFEUTG
     C                   MOVE      PAINT         SFAINT
     C                   MOVE      PAUTG         SFAUTG
     C                   UPDATE    SUBFIL
     C                   MOVEA     '010'         *IN(80)
     C                   EXSR      UPDWRK
     C                   END                                                    <WSNRO
      *    OPTION 6=SE OPPDRAG
     C     WSNRO         IFEQ      '6'
     C                   EXSR      SEOPD
     C                   MOVE      *ON           *IN78
     C                   END                                                    <WSNRO
      *    OPTION 7=SE FAKTURA
     C     WSNRO         IFEQ      '7'
     C                   MOVE      '1'           *IN99
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   EXSR      SEFAK
     C                   MOVE      *ON           *IN78
     C                   MOVEA     '010'         *IN(80)
     C                   END                                                    <WSNRO
      *
     C                   END                                                    <*IN98
      *
     C     SLHENT        TAG
     C                   ADD       8             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *LIKE         DEFINE    SFEINT        PEINT
     C     *LIKE         DEFINE    SFEUTG        PEUTG
     C     *LIKE         DEFINE    SFAINT        PAINT
     C     *LIKE         DEFINE    SFAUTG        PAUTG
     C     *LIKE         DEFINE    SFEINT        DFEINT
     C     *LIKE         DEFINE    SFEUTG        DFEUTG
     C     *LIKE         DEFINE    SFAINT        DFAINT
     C     *LIKE         DEFINE    SFAUTG        DFAUTG
     C     *LIKE         DEFINE    SFEINT        TEI999
     C     *LIKE         DEFINE    SFEUTG        TEU999
     C     *LIKE         DEFINE    SFAINT        TAI999
     C     *LIKE         DEFINE    SFAUTG        TAU999
     C     *LIKE         DEFINE    LINNBR        OLDLIN
     C     *LIKE         DEFINE    POSNBR        OLDPOS
     C     *LIKE         DEFINE    ZRECNO        MRECNO
     C     *LIKE         DEFINE    ZRECNO        XRECNO
     C     *LIKE         DEFINE    SFUNR         WUNR
     C     *LIKE         DEFINE    SFUNR         XUNR
     C     *LIKE         DEFINE    HEPOS1        XPOS1
     C     *LIKE         DEFINE    HEPOS1        PPOSN
     C     *LIKE         DEFINE    SFVEKT        TOVEKT          + 2
     C     *LIKE         DEFINE    AHST          XAHST
     C     *LIKE         DEFINE    FAAVD         XXAVD
     C     *LIKE         DEFINE    FAOPD         XXOPD
     C     *LIKE         DEFINE    FALI          XXLI
     C     *LIKE         DEFINE    HEKNA         W1KNA
     C     *LIKE         DEFINE    HEAVD         W1AVD
     C     *LIKE         DEFINE    OMRFAK        WXFAK
     C     *LIKE         DEFINE    RSDIFF        MSDIFF
     C     *LIKE         DEFINE    TONETN        MONETN
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL KODT≈
      *--------------------------------------------------------------
     C     KOD≈K2        KLIST
     C                   KFLD                    WS≈UNI
SV5  C*                    KFLD           KO≈MND
NV5  C                   KFLD                    KO≈CC
     C                   KFLD                    KO≈≈R
NV5  C                   KFLD                    KO≈MND
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL CUNDL01
      *--------------------------------------------------------------
     C     *LIKE         DEFINE    FIRMA         ZFIRMA
     C     *LIKE         DEFINE    KUNDNR        ZKUNDN
     C     KUNKEY        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    ZKUNDN
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL HEADF
      *--------------------------------------------------------------
     C     HEADFK        KLIST
     C                   KFLD                    SFAVD
     C                   KFLD                    SFOPD
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL HEADF
      *--------------------------------------------------------------
     C     HEADWK        KLIST
     C                   KFLD                    WAAVD
     C                   KFLD                    WAOPD
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL AMWTUAG (workfile oppdrag pr tur/agent)
      *--------------------------------------------------------------
     C     AMWKEY        KLIST
     C                   KFLD                    W1TNR
     C                   KFLD                    W1KNA
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL VALUAL01
      *--------------------------------------------------------------
     C     *LIKE         DEFINE    VALKOD        ZVALKO
     C     VALKEY        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    ZVALKO
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL FAK2
      *--------------------------------------------------------------
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
     C     *LIKE         DEFINE    HEAVD         ZEAVD
     C     *LIKE         DEFINE    HEOPD         ZEOPD
     C     *LIKE         DEFINE    FASK          ZESK
     C     FAK2KA        KLIST
     C                   KFLD                    ZEAVD
     C                   KFLD                    ZEOPD
     C                   KFLD                    ZESK
      *
     C     FAKKEY        KLIST
     C                   KFLD                    ZEAVD
     C                   KFLD                    ZEOPD
      *-------------------- -----------------------------------------
      * DEFINERER NÿKKEL TIL KODTGE
      *--------------------------------------------------------------
     C     *LIKE         DEFINE    FAVK          ZAVK
     C     KODGEK        KLIST
     C                   KFLD                    YGEUNI
     C                   KFLD                    ZAVK
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL KODTFR
      *--------------------------------------------------------------
     C     KODFRK        KLIST
     C                   KFLD                    YFRUNI
     C                   KFLD                    SFFRAN
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL AMHE
      *--------------------------------------------------------------
     C     *LIKE         DEFINE    AHTUNR        ZTUNR
     C     *LIKE         DEFINE    AHKNA         ZKNA
     C     AMHEKY        KLIST
     C                   KFLD                    ZTUNR
     C                   KFLD                    ZKNA
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL AMDE (AMDEWRK)
      *--------------------------------------------------------------
     C     *LIKE         DEFINE    AHTUNR        ZNULL
     C     *LIKE         DEFINE    ADPOS         ZPOS
     C     *LIKE         DEFINE    ADUNR         ZUNR
     C     AMDEKY        KLIST
     C                   KFLD                    ZTUNR
     C                   KFLD                    ZKNA
     C                   KFLD                    ZPOS
     C                   KFLD                    ZUNR
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL AMDE (TURNUMMER)
      *--------------------------------------------------------------
     C     AMDEKT        KLIST
     C                   KFLD                    ZTUNR
     C                   KFLD                    ZKNA
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL AMGE (TURNUMMER)
      *--------------------------------------------------------------
     C     AMGEKY        KLIST
     C                   KFLD                    ZTUNR
     C                   KFLD                    ZKNA
      *--------------------------------------------------------------
      * DEFINERER NÿKKEL TIL AMANDEL
      *--------------------------------------------------------------
     C     AMANKY        KLIST
     C                   KFLD                    ZKUNDN
      *
     C                   CLEAR                   ZNULL
      *
NV5  C                   CLEAR                   TURERR
NV5  C                   MOVE      *ZEROS        W2PER
NV5  C                   MOVE      *ZEROS        MINPER
NV5  C                   MOVE      *ZEROS        DSBDAT
NV5  C                   MOVE      *ZEROS        W2ADAT
NV5  C                   MOVE      *ZEROS        X2ADAT
NV5  C                   MOVE      *ZEROS        W2BDAT
NV5  C                   MOVE      *ZEROS        X2BDAT
NV5  C                   MOVE      *ZEROS        TUDT≈
NV5  C                   MOVE      *ZEROS        TUDTT≈
NV5  C                   MOVE      *ZEROS        WDATO
NV5  C                   MOVE      *ZEROS        TUDT
NV5  C                   MOVE      *ZEROS        TUDTT
     C                   MOVE      ' '           YSFST             1
     C                   MOVE      *ZEROS        YYPER≈            2 0
     C                   MOVE      *ZEROS        YYPERM            2 0
     C                   MOVE      *ZEROS        YYRUND            8 0
     C                   MOVE      *ZEROS        YYPRO             8 0
     C                   MOVE      ' '           YYKDM             1
     C                   MOVE      'DIV2525'     XMSGNR            7
     C                   Z-ADD     3             XLEVEL            1 0
     C                   Z-ADD     0             XRETUR            1 0
     C                   Z-ADD     20            XMSGL             4 0
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          TXTKST           20
      *
     C     IX            IFEQ      0
     C                   CLEAR                   WF
     C                   CLEAR                   WT
     C                   CLEAR                   WA
     C                   ENDIF                                                  <IX
      *
     C                   MOVE      'GE'          YGEUNI            2
     C                   MOVE      'FR'          YFRUNI            2
     C                   MOVE      '≈'           WS≈UNI            1
      *
     C                   READ      FIRM                                   33
      *
n01  C     FIFIRM        CHAIN     FIRMARC                            33
n01  C     *IN33         IFEQ      '0'
n01  C     'aa'          chain     arktxt                             33
n01  c                   end
     C     UTI           ENDSR
     C/EJECT
      ***********************************************
     C     PERIOD        BEGSR
      ***********************************************
SV5  C*                    MOVE 99        MINMND
SV5  C*                    MOVE 50        MIN≈R
NV5  C                   Z-ADD     195012        MINPER
     C                   MOVE      *ZEROS        KO≈MND
     C                   MOVE      *ZEROS        KO≈≈R
NV5  C                   MOVE      *ZEROS        KO≈CC
     C     KOD≈K2        SETLL     KODT≈                              33
SV5  C*          PERLES    TAG
SV5  C*                    READ KODT≈                    33
NV5  C     WS≈UNI        READE     KODT≈                                  33
     C     *IN33         IFEQ      *OFF
SV5  C*                    MOVE KO≈MND    KMND
SV5  C*                    MOVE KO≈≈R     K≈R
SV5  C*          KPER      IFLT MINPER
SV5  C*                    MOVE KPER      MINPER
SV5  C*                    ENDIF                           <KPER
SV5  C*                    GOTO PERLES
NV5  C                   MOVE      KO≈CC         MINCC
NV5  C                   MOVE      KO≈≈R         MIN≈R
NV5  C                   MOVE      KO≈MND        MINMND
     C                   ENDIF                                                  <*IN33
     C     W2PER         IFLT      MINPER
     C                   MOVE      MINPER        W2PER
     C                   ENDIF                                                  <W2PER
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     KLUMP         BEGSR
      ***********************************************
      *  BEREGNER TOTAL KLUMPSUM I NOK
     C     TAI999        SUB       TAU999        WKLUMP           17 6
     C     WKLUMP        MULT      W2KURS        WKLUMP
     C     WKLUMP        DIV       WXFAK         WKLUMP
     C                   ADD       TEI999        WKLUMP
     C     WKLUMP        SUB       TEU999        WKLUMP
      *  BEREGNER AGENTS ANDEL AV KLUMPSUM I NOK
     C     WKLUMP        MULT      W2AGNT        XKLUM2           17 6
     C     XKLUM2        DIV       100           XKLUM2
     C     XKLUM2        MULT(H)   1             WKLUM2           13 2
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     K9999         BEGSR
      ***********************************************
      *  POS 9999 UNR 96 = TR.KOST
      *           UNR 97 = FERJE
      *           UNR 98 = TREKKING
      *           UNR 99 = DIVERSE
      *           UNR 95 = DIVERSE 2
      *  SLETT AMDE + AMDEWRK POS 9999 UNR 96-99 OG BYGG OPP NYE P≈
      *  GRUNNLAG AV OPPLYSNINGER FRA BILDE2
      *
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C                   MOVEL     *BLANKS       ZPOS
     C                   MOVEL     '9999'        ZPOS
     C                   MOVE      95            ZUNR
     C                   MOVE      *OFF          *IN40
     C     AMDEKY        CHAIN     AMDE                               40
     C  N40              DELETE    AMDE
     C     AMDEKY        CHAIN     AMDEWRK                            40
     C  N40              DELETE    AWDER
     C                   MOVE      96            ZUNR
     C                   MOVE      *OFF          *IN40
     C     AMDEKY        CHAIN     AMDE                               40
     C  N40              DELETE    AMDE
     C     AMDEKY        CHAIN     AMDEWRK                            40
     C  N40              DELETE    AWDER
     C                   MOVE      97            ZUNR
     C     AMDEKY        CHAIN     AMDE                               40
     C  N40              DELETE    AMDE
     C     AMDEKY        CHAIN     AMDEWRK                            40
     C  N40              DELETE    AWDER
     C                   MOVE      98            ZUNR
     C     AMDEKY        CHAIN     AMDE                               40
     C  N40              DELETE    AMDE
     C     AMDEKY        CHAIN     AMDEWRK                            40
     C  N40              DELETE    AWDER
     C                   MOVE      99            ZUNR
     C     AMDEKY        CHAIN     AMDE                               40
     C  N40              DELETE    AMDE
     C     AMDEKY        CHAIN     AMDEWRK                            40
     C  N40              DELETE    AWDER
      *
     C                   MOVE      94            WUNR
      *  SKRIV SUBFILE
     C     KK95          TAG
     C                   ADD       1             WUNR
      *
     C     WUNR          IFEQ      95
     C     W2DIV2        ANDEQ     *ZEROS
     C                   GOTO      KK95
     C                   ENDIF                                                  <WUNR
      *
     C     WUNR          IFEQ      96
     C     W2TRKO        ANDEQ     *ZEROS
     C                   GOTO      KK95
     C                   ENDIF                                                  <WUNR
      *
     C     WUNR          IFEQ      97
     C     W2FERJ        ANDEQ     *ZEROS
     C                   GOTO      KK95
     C                   ENDIF                                                  <WUNR
      *
     C     WUNR          IFEQ      98
     C     W2TREK        ANDEQ     *ZEROS
     C                   GOTO      KK95
     C                   ENDIF                                                  <WUNR
      *
     C     WUNR          IFEQ      99
     C     W2DIV         ANDEQ     *ZEROS
     C                   GOTO      KK99
     C                   ENDIF                                                  <WUNR
      *
     C                   ADD       1             ZRECNO
     C                   ADD       1             MRECNO
     C                   EXSR      MOV999
     C                   MOVE      '1'           *IN44
     C                   WRITE     SUBFIL
     C                   MOVEA     '100'         *IN(80)
     C                   EXSR      UPDWRK
     C     WUNR          IFLT      99
     C                   GOTO      KK95
     C                   ENDIF                                                  <WUNR
      *
     C     KK99          TAG
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     LESAME        BEGSR
      ***********************************************
      * ---------------------------------------------
      * LES ALLE AMETALINJER
      * """""""""""""""""""""""""""""""""""""""""""""
     C                   CLEAR                   ANTF1
     C                   CLEAR                   ANTF2
     C                   MOVE      AHTUNR        ZTUNR
     C                   MOVE      AHKNA         ZKNA
     C     AMHEKY        SETLL     AMDE                                   38
     C     AMTAG1        TAG
     C                   MOVE      AHTUNR        ZTUNR
     C     AMHEKY        READE     AMDE                                   38
      *   DISPLAY SUBFILE
     C   38              GOTO      ENDAME
      *   IKKE TA MED KOSTNADER FRA BILDE - BYGG OPP P≈ NYTT
     C     ADPOS         IFEQ      '9999'
     C     ADUNR         IFGE      95
     C     ADUNR         ANDLE     99
     C                   GOTO      AMTAG1
     C                   END                                                    <ADUNR
     C                   END                                                    <ADPOS
      *
     C                   ADD       1             ZRECNO
     C                   ADD       1             MRECNO
     C                   ADD       1             ANTF2
     C                   EXSR      MOVS1
     C     SFPOSN        IFEQ      '9999'
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C                   MOVE      '0'           *IN44
     C                   ADD       1             ANTF1
     C                   END                                                    <SFPOSN
     C                   WRITE     SUBFIL
     C                   MOVEA     '100'         *IN(80)
     C                   EXSR      UPDWRK
      * FLERE AMETALINJER P≈ DENNE TUR
     C                   GOTO      AMTAG1
      *
     C     ENDAME        TAG
      *
      * FLYTT ALLE LINJER FRA AMGE TIL AMGEWRK
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C     AMGEKY        SETLL     AMGE                               40
     C     *IN40         DOWEQ     '0'
     C     AMGEKY        READE     AMGE                                   40
     C     *IN40         IFEQ      '0'
     C                   MOVE      AGST          AXST
     C                   MOVE      AGTUNR        AXTUNR
     C                   MOVE      AGKNA         AXKNA
     C                   MOVEL     AGPOS         AXPOS
     C                   MOVE      AGUNR         AXUNR
     C                   MOVE      AGAVD         AXAVD
     C                   MOVE      AGOPD         AXOPD
     C                   MOVE      AGLI          AXLI
     C                   MOVE      AGVK          AXVK
     C                   MOVE      AGEINT        AXEINT
     C                   MOVE      AGEUTG        AXEUTG
     C                   MOVE      AGAINT        AXAINT
     C                   MOVE      AGAUTG        AXAUTG
     C     AXPOS         IFNE      '9999'
     C                   WRITE     AXGER
     C                   ENDIF                                                  <AXPOS
     C                   ENDIF                                                  <*IN40
     C                   ENDDO                                                  <*IN40
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     LESFAK        BEGSR
      ***********************************************
      * ---------------------------------------------
      * LES ALLE GEBYR SOM SKAL MED P≈ AMETA (A OG B)
      * """""""""""""""""""""""""""""""""""""""""""""
     C                   CLEAR                   SFEINT
     C                   CLEAR                   SFEUTG
     C                   CLEAR                   SFAINT
     C                   CLEAR                   SFAUTG
     C     FATAG1        TAG
     C                   READ(N)   FAK2                                   38
     C   38              GOTO      ENDFAK
     C  N38FAAVD         COMP      HEAVD                              3535
     C  N38FAOPD         COMP      HEOPD                              3535
     C     *IN35         IFEQ      '0'
     C     FAKDA         IFEQ      'D'                                          *SLETTET?
     C                   GOTO      FATAG1
     C                   END                                                    <FAKDA
      * IKKE TA MED LINJER FRA KOSTNADSFÿRING
     C     FAKDA         IFEQ      'K'                                          *KOSTNAD?
     C                   GOTO      FATAG1
     C                   END                                                    <FAKDA
      * GEBYRET DEFINERT TIL ≈ V∆RE MED P≈ AMETAAVREGNING ?
     C                   MOVE      FAVK          ZAVK
     C     KODGEK        CHAIN     KODTGE                             36
     C   36              MOVE      ' '           KGESTA
     C     *IN61         IFEQ      *ON
     C                   EXSR      ADDS1
     C                   ELSE
     C                   EXSR      ADDS2
     C                   END                                                    <*IN35
      * FLERE FAKTLINJER P≈ DETTE OPPDRAGET
     C                   GOTO      FATAG1
     C                   END                                                    <*IN35
      *
     C     ENDFAK        TAG
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     LESWRK        BEGSR
      ***********************************************
      * ---------------------------------------------
      * LES ALLE AMETALINJER P≈ WORKFILE
      * """""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      ZRECNO        XRECNO
     C                   CLEAR                   TOVEKT
     C                   CLEAR                   TEI999
     C                   CLEAR                   TEU999
     C                   CLEAR                   TAI999
     C                   CLEAR                   TAU999
     C                   CLEAR                   TOEINT
     C                   CLEAR                   TOEUTG
     C                   CLEAR                   TOAINT
     C                   CLEAR                   TOAUTG
      *
     C                   CLEAR                   ZRECNO
     C                   CLEAR                   MRECNO
     C                   CLEAR                   ANTF1
     C                   CLEAR                   ANTF2
     C                   MOVEA     '00'          *IN(91)
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   MOVE      W2TNR         ZTUNR
     C     ZTUNR         SETLL     AMDEWRK                                38
     C     WRKTAG        TAG
     C     ZTUNR         READE     AMDEWRK                                38
      *   DISPLAY SUBFILE
     C   38              GOTO      ENDWRK
      *
     C                   ADD       1             ZRECNO
     C                   ADD       1             MRECNO
     C                   ADD       1             ANTF2             4 0
     C                   EXSR      MOVW1
     C                   MOVE      ' '           WSNRO
     C     SFPOSN        IFEQ      '9999'
     C                   MOVE      *BLANKS       SFST
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C     HEADFK        CHAIN     HEADF                              72
     C     *IN72         IFEQ      *OFF
     C                   MOVE      HEST          SFST
     C                   ELSE
     C                   MOVE      ' '           SFST
     C                   END                                                    <*IN72
     C                   MOVE      '0'           *IN44
     C                   ADD       1             ANTF1             4 0
     C                   END                                                    <SFPOSN
     C                   WRITE     SUBFIL
     C     ZTUNR         IFEQ      AWTUNR
     C     ZKNA          ANDEQ     AWKNA
     C     ZPOS          ANDEQ     AWPOS
     C     ZUNR          ANDEQ     AWUNR
     C                   MOVE      ZRECNO        XRECNO
     C                   END                                                    <ZTUNR
      * FLERE AMETALINJER P≈ DENNE TUR
     C                   GOTO      WRKTAG
      *
     C     ENDWRK        TAG
     C     XRECNO        IFGT      MRECNO
     C                   MOVE      MRECNO        ZRECNO
     C                   ELSE
     C                   MOVE      XRECNO        ZRECNO
     C                   END
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     MOVB0         BEGSR
      ***********************************************
     C                   CLEAR                   W1TNR
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     MOVS0         BEGSR
      ***********************************************
     C                   MOVEL     HEPOS1        SFPOSN
     C                   MOVEL     HEPOS1        SFPOS7
     C                   MOVE      WUNR          SFUNR
     C                   MOVE      HEAVD         SFAVD
     C                   MOVE      HEOPD         SFOPD
     C                   MOVE      HEST          SFST
     C                   Z-ADD     HEVKT         SFVEKT
     C                   ADD       HEVKT         TOVEKT
     C     HELM          MULT      AALKG         XFBV1             9 0
     C     HEM3          MULT      AAKKG         XFBV2             9 0
     C     XFBV2         IFGE      XFBV1
     C                   Z-ADD     HEM3          SFVOL
     C                   MOVE      'M3'          SFVTXT
     C                   ELSE
     C                   Z-ADD     HELM          SFVOL
     C                   MOVE      'LM'          SFVTXT
     C                   END                                                    <HEM3
     C     SFVOL         IFEQ      *ZERO
     C                   MOVE      '  '          SFVTXT
     C                   END                                                    <SFVOL
     C                   MOVE      HEFR          SFFRAN
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVE      HEAVD         UAVD
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     MOVS1         BEGSR
      ***********************************************
     C                   MOVEL     ADPOS         SFPOSN
     C                   MOVEL     ADPOS         SFPOS7
     C                   MOVE      ADUNR         SFUNR
     C                   MOVE      ADAVD         SFAVD
     C                   MOVE      ADOPD         SFOPD
     C     HEADFK        CHAIN     HEADF                              72
     C     *IN72         IFEQ      *OFF
     C                   MOVE      HEST          SFST
     C                   ELSE
     C                   MOVE      ' '           SFST
     C                   END                                                    <*IN72
     C                   MOVE      ADVKT         SFVEKT
     C                   Z-ADD     ADM3          SFVOL
     C                   MOVE      ADVTXT        SFVTXT
     C                   MOVE      ADFR          SFFRAN
     C                   MOVE      ADTXT         SFTXT
     C                   MOVE      ADEINT        SFEINT
     C                   MOVE      ADEUTG        SFEUTG
     C                   MOVE      ADAINT        SFAINT
     C                   MOVE      ADAUTG        SFAUTG
     C     SFPOSN        IFNE      '9999'
     C                   MOVE      ADAVD         UAVD
     C                   END                                                    <SFPOSN
     C     SFPOSN        IFEQ      '9999'
     C                   ADD       SFEINT        TEI999
     C                   ADD       SFEUTG        TEU999
     C                   ADD       SFAINT        TAI999
     C                   ADD       SFAUTG        TAU999
     C                   END                                                    <SFPOSN
     C                   ADD       SFVEKT        TOVEKT
     C                   ADD       SFEINT        TOEINT
     C                   ADD       SFEUTG        TOEUTG
     C                   ADD       SFAINT        TOAINT
     C                   ADD       SFAUTG        TOAUTG
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     MOVW1         BEGSR
      ***********************************************
     C                   MOVEL     AWPOS         SFPOSN
     C                   MOVEL     AWPOS         SFPOS7
     C                   MOVE      AWUNR         SFUNR
     C                   MOVE      AWAVD         SFAVD
     C                   MOVE      AWOPD         SFOPD
     C                   MOVE      AWVKT         SFVEKT
     C                   Z-ADD     AWM3          SFVOL
     C                   MOVE      AWVTXT        SFVTXT
     C                   MOVE      AWFR          SFFRAN
     C                   MOVE      AWTXT         SFTXT
     C                   MOVE      AWEINT        SFEINT
     C                   MOVE      AWEUTG        SFEUTG
     C                   MOVE      AWAINT        SFAINT
     C                   MOVE      AWAUTG        SFAUTG
     C     AWPOS         IFNE      '9999'
     C                   MOVE      AWAVD         UAVD
     C                   END                                                    <AWPOS
     C     SFPOSN        IFEQ      '9999'
     C                   ADD       SFEINT        TEI999
     C                   ADD       SFEUTG        TEU999
     C                   ADD       SFAINT        TAI999
     C                   ADD       SFAUTG        TAU999
     C                   END                                                    <SFPOSN
     C                   ADD       SFVEKT        TOVEKT
     C                   ADD       SFEINT        TOEINT
     C                   ADD       SFEUTG        TOEUTG
     C                   ADD       SFAINT        TOAINT
     C                   ADD       SFAUTG        TOAUTG
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     MOV999        BEGSR
      ***********************************************
     C                   MOVEL     *BLANKS       SFPOSN
     C                   MOVEL     *BLANKS       SFPOS7
     C                   MOVEL     '9999'        SFPOSN
     C                   MOVEL     '9999'        SFPOS7
     C                   MOVE      WUNR          SFUNR
     C                   MOVE      *ZEROS        SFVEKT
     C                   MOVE      *BLANKS       SFVOL
     C                   MOVE      *BLANKS       SFVTXT
     C                   MOVE      *BLANKS       SFFRAN
     C                   MOVE      *ZEROS        SFAVD
     C                   MOVE      *ZEROS        SFOPD
     C                   MOVE      *BLANKS       SFST
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVE      *ZEROS        SM9999           13 2
     C                   CLEAR                   SFEINT
     C                   CLEAR                   SFEUTG
     C                   CLEAR                   SFAINT
     C                   CLEAR                   SFAUTG
      * DIVERSE 2
     C     WUNR          IFEQ      95
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     W2DIVU        SFTXT
     C     W2DIVQ        IFEQ      'A'
     C                   Z-ADD     W2DIV2        SFAUTG
     C                   ADD       W2DIV2        TOAUTG
     C                   ADD       W2DIV2        TAU999
     C                   SUB       W2DIV2        SM9999
     C                   ELSE
     C                   Z-ADD     W2DIV2        SFEUTG
     C                   ADD       W2DIV2        TOEUTG
     C                   ADD       W2DIV2        TEU999
     C                   ADD       W2DIV2        SM9999
     C                   ENDIF                                                  <W2DIVQ
     C                   ENDIF                                                  <WUNR
      * TR.KOSTN
     C     WUNR          IFEQ      96
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     'TR.KOST'     SFTXT
     C     SPRAAK        IFEQ      'E'
     C                   CLEAR                   DSTXT
     C                   MOVEL     'TRUCK C'     DSTXT1
     C                   MOVEL     'OST    '     DSTXT2
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     DSTXT         SFTXT
     C                   ENDIF                                                  <SPRAAK
     C     W2TRKP        IFEQ      'A'
     C                   Z-ADD     W2TRKO        SFAUTG
     C                   ADD       W2TRKO        TOAUTG
     C                   ADD       W2TRKO        TAU999
     C                   SUB       W2TRKO        SM9999
     C                   ELSE
     C                   Z-ADD     W2TRKO        SFEUTG
     C                   ADD       W2TRKO        TOEUTG
     C                   ADD       W2TRKO        TEU999
     C                   ADD       W2TRKO        SM9999
     C                   ENDIF                                                  <W2TRKP
     C                   ENDIF                                                  <WUNR
      * FERJE
     C     WUNR          IFEQ      97
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     'FERJE'       SFTXT
     C     SPRAAK        IFEQ      'E'
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     'FERRY  '     SFTXT
     C                   ENDIF                                                  <SPRAAK
     C     W2FERP        IFEQ      'A'
     C                   Z-ADD     W2FERJ        SFAUTG
     C                   ADD       W2FERJ        TOAUTG
     C                   ADD       W2FERJ        TAU999
     C                   SUB       W2FERJ        SM9999
     C                   ELSE
     C                   Z-ADD     W2FERJ        SFEUTG
     C                   ADD       W2FERJ        TOEUTG
     C                   ADD       W2FERJ        TEU999
     C                   ADD       W2FERJ        SM9999
     C                   ENDIF                                                  <W2FERP
     C                   ENDIF                                                  <WUNR
      * TREKKING
     C     WUNR          IFEQ      98
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     'TREKKING'    SFTXT
     C     SPRAAK        IFEQ      'E'
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     'HAULAGE'     SFTXT
     C                   ENDIF                                                  <SPRAAK
     C     W2TREP        IFEQ      'A'
     C                   Z-ADD     W2TREK        SFAUTG
     C                   ADD       W2TREK        TOAUTG
     C                   ADD       W2TREK        TAU999
     C                   SUB       W2TREK        SM9999
     C                   ELSE
     C                   Z-ADD     W2TREK        SFEUTG
     C                   ADD       W2TREK        TOEUTG
     C                   ADD       W2TREK        TEU999
     C                   ADD       W2TREK        SM9999
     C                   ENDIF                                                  <W2TREP
     C                   ENDIF                                                  <WUNR
      * DIVERSE
     C     WUNR          IFEQ      99
     C                   MOVE      *BLANKS       SFTXT
     C                   MOVEL     W2DIVT        SFTXT
     C     W2DIVP        IFEQ      'A'
     C                   Z-ADD     W2DIV         SFAUTG
     C                   ADD       W2DIV         TOAUTG
     C                   ADD       W2DIV         TAU999
     C                   SUB       W2DIV         SM9999
     C                   ELSE
     C                   Z-ADD     W2DIV         SFEUTG
     C                   ADD       W2DIV         TOEUTG
     C                   ADD       W2DIV         TEU999
     C                   ADD       W2DIV         SM9999
     C                   ENDIF                                                  <W2DIVP
     C                   ENDIF                                                  <WUNR
      * SKRIV WORK DETALJ RECORD - AMGEWRK
     C                   MOVE      W1TNR         AXTUNR
     C                   MOVE      W1KNA         AXKNA
     C                   MOVEL     *BLANKS       AXPOS
     C                   MOVEL     '9999'        AXPOS
     C                   MOVE      WUNR          AXUNR
     C                   MOVE      *ZEROS        AXAVD
     C                   MOVE      *ZEROS        AXOPD
     C                   Z-ADD     WUNR          AXLI
     C                   MOVE      *BLANKS       AXVK
     C                   MOVE      SFEINT        AXEINT
     C                   MOVE      SFEUTG        AXEUTG
     C                   MOVE      SFAINT        AXAINT
     C                   MOVE      SFAUTG        AXAUTG
     C                   WRITE     AXGER
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     NYLIN         BEGSR
      ***********************************************
     C                   MOVE      '1'           *IN99
     C                   MOVE      LINNBR        OLDLIN
     C                   MOVE      POSNBR        OLDPOS
     C                   CLEAR                   ADDLIN
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     06            POSNBR
     C     NYLI1         TAG
     C                   EXFMT     ADDLIN
     C                   MOVE      '0'           *IN30
     C   12              GOTO      ENDNY
      *
     C     SFUNR         IFEQ      *ZEROS
     C                   ADD       1             SFUNR
     C                   ENDIF                                                  <SFUNR
      *
     C     NYLI2         TAG
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C                   MOVEL     SFPOSN        ZPOS
     C                   MOVEL     SFPOSN        SFPOS7
     C                   MOVE      SFUNR         ZUNR
     C     AMDEKY        CHAIN(N)  AWDER                              88
     C     *IN88         IFEQ      *OFF
     C                   MOVE      '0'           *IN88
     C                   ADD       1             SFUNR
     C                   GOTO      NYLI2
     C                   END                                                    <*IN88
     C                   EXSR      TESTLI
     C     *IN30         IFEQ      '1'
     C                   GOTO      NYLI1
     C                   END                                                    <*IN30
      *
     C                   ADD       1             MRECNO
     C                   MOVE      ZRECNO        XRECNO
     C                   MOVE      MRECNO        ZRECNO
     C     SFPOSN        IFEQ      '9999'
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C                   MOVE      '0'           *IN44
     C                   END                                                    <SFPOSN
      * G≈ TIL DETALJER KUN VED UTVIDET AMETA
     C     *IN62         IFEQ      *ON
     C                   MOVE      W2TNR         PTNR              8
     C                   MOVE      SFAVD         PAVD              4
     C                   MOVE      SFOPD         POPD              7
     C                   MOVE      W2KNA         PKNA              8
     C                   MOVEL     W2NAVN        PNAVN            30
     C                   MOVE      W2IMEX        PIMEX             1
     C                   MOVEL     SFPOS7        PPOSN
     C                   MOVE      SFUNR         PUNR              8
     C                   MOVE      SFVEKT        PVEKT             5
     C                   MOVE      SFVOL         PVOL              7
     C                   MOVE      SFVTXT        PTXT              2
     C                   MOVE      SFFRAN        PFRAN             3
     C                   CALL      'SYAM01A'
     C                   PARM                    PTNR
     C                   PARM                    PAVD
     C                   PARM                    POPD
     C                   PARM                    PKNA
     C                   PARM                    PNAVN
     C                   PARM                    PIMEX
     C                   PARM                    PPOSN
     C                   PARM                    PUNR
     C                   PARM                    PEINT
     C                   PARM                    PEUTG
     C                   PARM                    PAINT
     C                   PARM                    PAUTG
     C                   PARM                    PVEKT
     C                   PARM                    PTXT
     C                   PARM                    PFRAN
     C                   PARM                    PVOL
      *
     C                   MOVE      PEINT         SFEINT
     C                   MOVE      PEUTG         SFEUTG
     C                   MOVE      PAINT         SFAINT
     C                   MOVE      PAUTG         SFAUTG
     C                   ENDIF                                                  <*IN62
     C                   WRITE     SUBFIL
     C                   MOVEA     '100'         *IN(80)
     C                   EXSR      UPDWRK
     C                   MOVE      XRECNO        ZRECNO
      *
     C     ENDNY         TAG
     C                   MOVE      OLDLIN        LINNBR
     C                   MOVE      OLDPOS        POSNBR
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     RESULT        BEGSR
      ***********************************************
     C                   MOVE      W2VALK        W2VALN
     C                   MOVE      TOEINT        SMEINT
     C                   MOVE      TOEUTG        SMEUTG
     C                   MOVE      TOAINT        SMAINT
     C                   MOVE      TOAUTG        SMAUTG
     C                   EXSR      BSALDO
     C                   EXSR      BGEV
     C                   EXSR      BDEL
     C                   EXSR      BRES
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     RSETAM        BEGSR
      ***********************************************
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C     AMHEKY        CHAIN     AMHE                               39
     C     *IN39         IFEQ      '0'
     C     UIN10         IFEQ      '0'
     C                   MOVE      '1'           AHST
     C                   END                                                    <UIN10
     C                   UPDATE    AMHER
     C                   END                                                    <*IN39
     C     SLTRS         ENDSR
     C/EJECT
      ***********************************************************************
      * SE FAKTURA                                                          *
      ***********************************************************************
     C     SEFAK         BEGSR
      *
     C                   MOVE      *ZEROS        DUMFLA            1 0
     C                   CALL      'SYFM21B'
     C                   PARM                    FIFIRM
     C                   PARM                    SFAVD
     C                   PARM                    SFOPD
     C                   PARM                    DUMFLA
      *
     C                   MOVE      ' '           WSNRO
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************************************
      * SE OPPDRAG                                                          *
      ***********************************************************************
     C     SEOPD         BEGSR
      *
     C                   MOVE      *ZEROS        DUMFLA            1 0
     C                   CALL      'SYFM21A'
     C                   PARM                    FIFIRM
     C                   PARM                    SFAVD
     C                   PARM                    SFOPD
     C                   PARM                    DUMFLA
      *
     C                   MOVE      ' '           WSNRO
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *
     C                   MOVEA     '0000'        *IN(29)
     C                   MOVEA     '00000000'    *IN(70)
      * SJEKK OM AMETA FINNES FRA FÿR
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C     AMHEKY        CHAIN(N)  AMHE                               39
     C     *IN39         IFEQ      *OFF
     C                   MOVEL     'ENDRING'     W2NY
     C                   ELSE
     C                   MOVEL     'NY     '     W2NY
     C                   ENDIF                                                  <*IN39
      * HENT AGENTNAVN,VALUTAKODE OG BILAGSDATO
     C                   MOVE      FIFIRM        ZFIRMA
     C                   MOVE      W1KNA         ZKUNDN
      *
     C     KUNKEY        CHAIN     CUNDL01                            35
     C     *IN35         IFEQ      *OFF
     C                   MOVE      W1KNA         W2KNA
     C                   CLEAR                   DSNVN
     C                   MOVEL     KNAVN         DSNVN1
     C                   MOVEL     '/'           DSNVN2
     C                   MOVEL     ADR3          DSNVN3
     C                   MOVE      DSNVN         W2NAVN
     C                   ELSE
     C                   CLEAR                   W2KNA
     C                   CLEAR                   W2NAVN
     C                   CLEAR                   W2VALK
     C                   CLEAR                   W2KURS
     C                   CLEAR                   W2VALA
     C                   CLEAR                   W2KURA
     C                   CLEAR                   W2VALE
     C                   CLEAR                   W2KURE
     C                   CLEAR                   VALKOD
     C                   CLEAR                   W2VALA
     C                   CLEAR                   W2VALE
     C                   END                                                    <*IN35
      *
     C                   MOVEL     W1TNR         W2EREF
      * HENT AGENTOPPLYSNINGER
     C     AMANKY        CHAIN     AMANDEL                            31
     C     *IN31         IFEQ      *OFF
     C                   MOVE      AADEL         W2AGNT
      * VALUTA AVREGNING
     C                   MOVE      AAVAL         W2VALK
     C     AAVALE        IFNE      'NOK'
     C                   MOVE      AAVALE        ZVALKO
     C                   Z-ADD     AAKURE        W2KURS
     C                   ELSE
     C                   MOVE      AAVALA        ZVALKO
     C                   Z-ADD     AAKURA        W2KURS
     C                   END                                                    <AAVALE
      * VALUTA AGENT
     C                   MOVE      AAVALA        W2VALA
     C                   Z-ADD     AAKURA        W2KURA
      * VALUTA EGEN
     C                   MOVE      AAVALE        W2VALE
     C                   Z-ADD     AAKURE        W2KURE
      *
     C                   MOVE      AATYPE        W2TYPE
     C                   EXSR      ATEXT
     C     AAUTV         IFEQ      'J'
     C                   MOVE      *OFF          *IN61
     C                   MOVE      *ON           *IN62
     C                   MOVEL     'UTVIDET '    W2AMT
     C                   MOVE      'AMETA   '    W2AMT
     C                   ELSE
     C                   MOVE      *ON           *IN61
     C                   MOVE      *OFF          *IN62
     C                   MOVEL     'BASIS AM'    W2AMT
     C                   MOVE      'ETA     '    W2AMT
     C                   ENDIF                                                  <AAUTV
     C                   ELSE
     C                   MOVE      050           W2AGNT
     C                   MOVE      *BLANKS       ZVALKO
     C                   MOVE      *BLANKS       W2VALK
     C                   MOVE      *ZEROS        W2KURS
     C                   MOVE      *BLANKS       W2VALA
     C                   MOVE      *ZEROS        W2KURA
     C                   MOVE      *BLANKS       W2VALE
     C                   MOVE      *ZEROS        W2KURE
     C                   MOVE      *BLANKS       W2TYPE
     C                   MOVE      *BLANKS       W2TYPT
     C                   MOVE      *ON           *IN61
     C                   MOVE      *OFF          *IN62
     C                   END                                                    <*IN31
      * HENT OMREGNINGSFAKTOR
     C     VALKEY        CHAIN     VALUAL01                           29
     C     *IN29         IFEQ      *ON
     C                   Z-ADD     100           WXFAK
     C                   ELSE
     C                   Z-ADD     OMRFAK        WXFAK
     C     W2KURS        IFEQ      *ZERO
     C                   Z-ADD     VALKU1        W2KURS
     C                   ENDIF                                                  <W2KURS
     C                   ENDIF                                                  <*IN29
      * HENT BILNUMMER
     C     W1TNR         CHAIN     TURER14                            32
     C     *IN32         IFEQ      '0'
     C                   MOVEL     TUBILN        W2BILN
     C                   END                                                    <*IN32
      * HENT TRANSPORTÿRNAVN
     C                   MOVE      FIFIRM        ZFIRMA
     C     *IN39         IFEQ      '0'
     C                   MOVE      AHKNT         ZKUNDN
     C                   ELSE
     C     TUKNT2        IFNE      *ZEROS
     C                   MOVE      TUKNT2        ZKUNDN
     C                   ELSE
     C                   MOVE      TUKNT         ZKUNDN
     C                   END
     C                   END                                                    <*IN39
     C     KUNKEY        CHAIN     CUNDL01                            35
     C     *IN35         IFEQ      '0'
     C                   MOVE      KUNDNR        W2KNT
     C                   MOVE      KNAVN         W2TRAN
     C                   ELSE
     C                   CLEAR                   W2KNT
     C                   CLEAR                   W2TRAN
     C                   END                                                    <*IN35
     C                   MOVE      TUDT≈         DSB≈≈
     C                   MOVE      TUDTM         DSBMM
     C                   MOVE      TUDTD         DSBDD
      *
     C                   MOVE      ' '           W2IMEX
      * FINN FÿRSTE OPPDRAG P≈ TUREN
     C     AMWKEY        SETLL     AMWTUAG
     C     AMWKEY        READE     AMWTUAG                                34
     C     HEADWK        CHAIN     HEADF                              51
      *
     C                   MOVEL     HERFA         W2AREF
     C     TUBILN        IFEQ      *BLANKS
     C                   MOVEL     HEHAWB        W2BILN
     C                   END                                                    <TUBILN
      * IMPORT
     C     HEUR          IFEQ      'A'
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVE      'I'           W2IMEX            1
     C                   MOVE      *ZEROS        W2ADAT
     C                   MOVE      DSBDAT        W2BDAT
     C                   END                                                    <HEUR
      * EXPORT
     C     HEUR          IFEQ      'B'
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      'E'           W2IMEX
     C                   MOVE      DSBDAT        W2ADAT
     C                   MOVE      *ZEROS        W2BDAT
     C                   END                                                    <HEUR
      *
     C                   MOVEL     DSBMM         W2PERM
     C                   MOVEL     DSB≈≈         W2PER≈
NV5  C     W2PER≈        IFGT      50
NV5  C                   MOVEL     '19'          W2PERC
NV5  C                   ELSE
NV5  C                   MOVEL     '20'          W2PERC
NV5  C                   END
      * TRANSP.MODUL
     C     HEUR          IFEQ      'H'
      * AVGJÿR IMPORT (ELLER INNLAND)/EKSPORT VIA TILLAND I TUR
     C                   MOVEL     TUSONT        TILLAN            2
     C     TILLAN        IFEQ      FILAND
     C                   MOVE      'I'           W2IMEX
     C                   ELSE
     C                   MOVE      'E'           W2IMEX
     C                   END
     C                   MOVE      DSBDAT        W2ADAT
      * TILDATO I EGNE FELT
SV5  C*                    MOVE TUDT≈T    XXMM≈≈  40
SV5  C*                    MOVELTUDTMT    XXMM≈≈
SV5  C*                    MOVELTUDTDT    W2BDAT
SV5  C*                    MOVE XXMM≈≈    W2BDAT
NV5  C                   MOVE      TUDTT≈        W2B≈≈
NV5  C                   MOVE      TUDTTM        W2BMM
NV5  C                   MOVE      TUDTTD        W2BDD
      * PERIODE I EGNE FELT
     C                   MOVEL     TURMND        W2PERM
     C                   MOVEL     TURAAR        W2PER≈
NV5  C                   MOVEL     TURACC        W2PERC
     C                   END                                                    <HEUR
     C                   EXSR      PERIOD
      * SJEKK OM AMETA FINNES FRA FÿR
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C     AMHEKY        CHAIN     AMHE                               39
     C     *IN39         IFEQ      *OFF
     C                   MOVE      AHKNA         W2KNA
     C                   MOVE      AHVALS        W2VALK
     C     AHVALE        IFNE      'NOK'
     C                   MOVE      AHVALE        ZVALKO
     C                   Z-ADD     AHKURE        W2KURS
     C                   ELSE
     C                   MOVE      AHVALA        ZVALKO
     C                   Z-ADD     AHKURA        W2KURS
     C                   END                                                    <AHVALE
      * HENT OMREGNINGSFAKTOR
     C                   MOVE      W2VALK        ZVALKO
     C                   MOVE      AHVALA        W2VALA
     C                   Z-ADD     AHKURA        W2KURA
     C                   MOVE      AHVALE        W2VALE
     C                   Z-ADD     AHKURE        W2KURE
     C     VALKEY        CHAIN     VALUAL01                           29
     C     *IN29         IFEQ      *OFF
     C                   MOVE      100           WXFAK
     C                   END                                                    <*IN29
      *
     C                   Z-ADD     AHKURS        W2KURS
     C                   MOVE      AHDTMP        W2PERM
     C                   MOVE      AHDT≈P        W2PER≈
NV5  C                   MOVE      AHDTCP        W2PERC
     C                   MOVE      AHDEL         W2AGNT
     C                   MOVE      AHBILN        W2BILN
SV5  C*                    MOVE AHADAT    W2ADAT
NV5  C                   MOVE      AHADAT        X2ADAT
NV5  C                   MOVE      X2ADD         W2ADD
NV5  C                   MOVE      X2AMM         W2AMM
NV5  C                   MOVE      X2A≈≈         W2A≈≈
     C                   MOVE      AHAREF        W2AREF
     C                   MOVE      AHEREF        W2EREF
     C                   MOVE      AHENH         W2ENH
     C                   MOVE      AHENH         W2ENH
SV5  C*                    MOVE AHBDAT    W2BDAT
NV5  C                   MOVE      AHBDAT        X2BDAT
NV5  C                   MOVE      X2BDD         W2BDD
NV5  C                   MOVE      X2BMM         W2BMM
NV5  C                   MOVE      X2B≈≈         W2B≈≈
     C                   MOVE      AHKNT         W2KNT
     C                   MOVE      AHTRAN        W2TRAN
     C                   MOVE      AHTRKO        W2TRKO
     C                   MOVE      AHTRKP        W2TRKP
     C                   MOVE      AHFERJ        W2FERJ
     C                   MOVE      AHFERP        W2FERP
     C                   MOVE      AHTREK        W2TREK
     C                   MOVE      AHTREP        W2TREP
     C                   MOVE      AHDIV         W2DIV
     C                   MOVE      AHDIVP        W2DIVP
     C                   MOVE      AHDIVT        W2DIVT
     C                   MOVE      AHDIV2        W2DIV2
     C                   MOVE      AHDIVQ        W2DIVQ
     C                   MOVE      AHDIVU        W2DIVU
     C                   EXSR      ATEXT
     C                   MOVE      AHST          XAHST
     C                   MOVE      '2'           AHST
     C                   UPDATE    AMHER
     C                   END                                                    <*IN39
      *  INPUTDATA OK
     C     SLTB1         ENDSR
     C/EJECT
      ***********************************************
     C     TESTB2        BEGSR
      ***********************************************
      *
      * VALUTA AVREGNING
     C     W2VALE        IFNE      'NOK'
     C                   MOVE      W2VALE        ZVALKO
     C                   Z-ADD     W2KURE        W2KURS
     C                   ELSE
     C                   MOVE      W2VALA        ZVALKO
     C                   Z-ADD     W2KURA        W2KURS
     C                   END                                                    <AAVALE
      *
     C                   MOVEA     '0'           *IN(30)
     C                   MOVEA     '00000000'    *IN(70)
      * PERIODE
     C     W2PERM        IFEQ      *ZERO
SV5  C*          W2PER≈    OREQ *ZEROS
     C                   MOVE      'DIV2264'     MSGNR
     C                   SETON                                        3071
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLTB2
NV5  C     W2PER≈        IFGT      50
NV5  C                   MOVE      '19'          W2PERC
NV5  C                   ELSE
NV5  C                   MOVE      '20'          W2PERC
NV5  C                   END
     C                   END
     C                   SETOFF                                       77
     C     W2VALA        IFEQ      *BLANKS
     C                   MOVE      'TRO0495'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLTB2
     C                   END                                                     <W2VALA
     C     W2KURA        IFEQ      *ZEROS
     C                   MOVE      'TRO0495'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLTB2
     C                   END                                                     <W2KURA
     C     W2VALE        IFEQ      *BLANKS
     C                   MOVE      'TRO0495'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLTB2
     C                   ENDIF                                                  <W2VALE
     C     W2KURE        IFEQ      *ZEROS
     C                   MOVE      'TRO0495'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLTB2
     C                   ENDIF                                                  <W2KURE
     C     W2VALK        IFEQ      *BLANKS
     C                   MOVE      'TRO0495'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLTB2
     C                   ENDIF                                                  <W2VALK
      * SETT NY KURS/VALUTA VED ENDRING I BILDE
     C     W2VALE        IFNE      'NOK'
     C                   MOVE      W2VALE        ZVALKO
     C                   Z-ADD     W2KURE        W2KURS
     C                   ELSE
     C                   MOVE      W2VALA        ZVALKO
     C                   Z-ADD     W2KURA        W2KURS
     C                   END                                                    <W2VALE
      * HENT OMREGNINGSFAKTOR
     C     VALKEY        CHAIN     VALUAL01                           29
     C     *IN29         IFEQ      *ON
     C                   Z-ADD     100           WXFAK
     C                   ELSE
     C                   Z-ADD     OMRFAK        WXFAK
     C                   ENDIF                                                  <*IN29
     C     W2KNA         IFEQ      *ZERO
     C                   CLEAR                   W2NAVN
     C                   MOVE      'DIV2547'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     04            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C     W2KNA         IFNE      *ZERO
     C                   MOVE      W2KNA         ZKUNDN
     C     KUNKEY        CHAIN     CUNDL01                            35
     C     *IN35         IFEQ      '0'
     C                   MOVE      SFAKT         WSFAKT            1
     C                   CLEAR                   DSNVN
     C                   MOVEL     KNAVN         DSNVN1
     C                   MOVEL     '/'           DSNVN2
     C                   MOVEL     ADR3          DSNVN3
     C                   MOVEL     DSNVN         W2NAVN
     C                   ELSE
     C                   MOVE      ' '           WSFAKT
     C                   CLEAR                   W2NAVN
     C                   MOVE      'DIV2548'     MSGNR
     C                   SETON                                        307177
     C                   Z-ADD     06            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLTB2
     C                   END                                                    <WKNA
     C                   END                                                    <*IN35
      *
     C     W2VALE        IFNE      'NOK'
     C                   Z-ADD     W2KURE        W2KURS
     C                   MOVE      W2VALE        ZVALKO
     C                   ELSE
     C                   Z-ADD     W2KURA        W2KURS
     C                   MOVE      W2VALA        ZVALKO
     C                   END                                                    <W2VALE
      * HENT OMREGNINGSFAKTOR
     C     VALKEY        CHAIN     VALUAL01                           29
     C     *IN29         IFEQ      *OFF
     C                   Z-ADD     OMRFAK        WXFAK
     C                   ELSE
     C                   Z-ADD     100           WXFAK
     C                   ENDIF                                                  <*IN29
NV5   *
NV5  C                   MOVE      W2ADD         X2ADD
NV5  C                   MOVE      W2AMM         X2AMM
     C                   Z-ADD     W2A≈≈         X2A≈≈
NV5  C     W2A≈≈         IFGT      50
     C                   MOVEL     '19'          X2A≈≈
NV5  C                   ELSE
     C                   MOVEL     '20'          X2A≈≈
NV5  C                   END
NV5  C                   MOVE      W2BDD         X2BDD
NV5  C                   MOVE      W2BMM         X2BMM
     C                   Z-ADD     W2B≈≈         X2B≈≈
NV5  C     W2B≈≈         IFGT      50
     C                   MOVEL     '19'          X2B≈≈
NV5  C                   ELSE
     C                   MOVEL     '20'          X2B≈≈
NV5  C                   END
      *  INPUTDATA OK
     C     SLTB2         ENDSR
     C/EJECT
      ***********************************************
     C     TESTLI        BEGSR
      ***********************************************
      * FRANKATUR
     C                   MOVE      '0'           *IN30
     C     SFPOSN        IFNE      '9999'
     C     SFAVD         IFEQ      0
     C     SFOPD         OREQ      0
     C                   MOVE      'DIV2555'     MSGNR
     C                   Z-ADD     16            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN36
     C                   GOTO      SLTLI
     C                   END                                                    <*SFAVD
     C     KODFRK        CHAIN     KODTFR                             36
     C     *IN36         IFNE      '0'
     C                   MOVE      'DIV2482'     MSGNR
     C                   Z-ADD     50            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN36
     C                   GOTO      SLTLI
     C                   END                                                    <*IN36
     C                   END                                                    <SFPOSN
     C     SLTLI         ENDSR
     C/EJECT
      ***********************************************
     C     UPDWRK        BEGSR
      ***********************************************
     C                   SETOFF                                       83
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C                   MOVEL     SFPOS7        ZPOS
     C                   MOVE      SFUNR         ZUNR
      *  ENDRING
     C     *IN81         IFEQ      '1'
     C     AMDEKY        CHAIN     AWDER                              83
     C                   END                                                    <*IN81
      *
     C                   MOVE      '2'           AWST
     C                   MOVE      W2TNR         AWTUNR
     C                   MOVE      W1KNA         AWKNA
     C                   MOVEL     SFPOS7        AWPOS
     C                   MOVE      SFUNR         AWUNR
     C                   MOVE      SFAVD         AWAVD
     C                   MOVE      SFOPD         AWOPD
     C                   MOVE      SFVEKT        AWVKT
     C                   Z-ADD     SFVOL         AWM3
     C                   MOVE      SFVTXT        AWVTXT
     C                   MOVE      SFFRAN        AWFR
     C                   MOVE      SFTXT         AWTXT
     C                   MOVE      SFEINT        AWEINT
     C                   MOVE      SFEUTG        AWEUTG
     C                   MOVE      SFAINT        AWAINT
     C                   MOVE      SFAUTG        AWAUTG
      *  NY LINJE
     C     *IN80         IFEQ      '1'
     C                   WRITE     AWDER
     C                   END                                                    <*IN80
      *  ENDRING
     C     *IN81         IFEQ      '1'
     C  N83              UPDATE    AWDER
     C                   END                                                    <*IN81
      *  SLETTING
     C     *IN82         IFEQ      '1'
     C     AMDEKY        CHAIN     AWDER                              83
     C  N83              DELETE    AWDER
     C                   END                                                    <*IN82
     C                   MOVEA     '0000'        *IN(80)
     C                   ENDSR
     C/EJECT
      ***********************************************
     C     WRK2AG        BEGSR
      ***********************************************
      *
      * FLYTT FRA AMGEWRK TIL AMGE
      *
      * SLETTER ALLE EKSISTERENDE LINJER I AMGE
      * P≈ DENNE TUR/AGENT
      *
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C     AMGEKY        SETLL     AMGE                               40
     C     *IN40         DOWEQ     '0'
     C     AMGEKY        READE     AMGE                                   40
     C  N40              DELETE    AMGE
     C                   ENDDO
      * FLYTT ALLE LINJER FRA AMGEWRK TIL AMGE
     C                   MOVE      W1TNR         ZTUNR
     C                   MOVE      W1KNA         ZKNA
     C     AMGEKY        SETLL     AMGEWRK                            40
     C     *IN40         DOWEQ     '0'
     C     AMGEKY        READE     AMGEWRK                                40
     C     *IN40         IFEQ      '0'
     C                   MOVE      AXST          AGST
     C                   MOVE      AXTUNR        AGTUNR
     C                   MOVE      AXKNA         AGKNA
     C                   MOVEL     AXPOS         AGPOS
     C                   MOVE      AXUNR         AGUNR
     C                   MOVE      AXAVD         AGAVD
     C                   MOVE      AXOPD         AGOPD
     C                   MOVE      AXLI          AGLI
     C                   MOVE      AXVK          AGVK
     C                   MOVE      AXEINT        AGEINT
     C                   MOVE      AXEUTG        AGEUTG
     C                   MOVE      AXAINT        AGAINT
     C                   MOVE      AXAUTG        AGAUTG
     C                   WRITE     AMGER
     C                   ENDIF                                                  <*IN40
     C                   ENDDO                                                  <*IN40
     C                   ENDSR
N01   ***********************************************************
N01  C     arkivsr       begsr
N01   ***********************************************************
N01  C                   TIME                    XULTID
N01  C                   MOVE      XULDD         ULDD
N01  C                   MOVE      XULMM         ULMM
N01  C                   MOVE      XUL≈≈         UL≈≈
N01  C                   MOVE      FIFIRM        ARFIRM
N01  C                   MOVE      UAVD          ARAVD
N01  C                   MOVE      *zeros        AROPD
N01  C                   MOVEL     FAFAKT        ARUNDE
N01  C                   MOVE      'aa'          ARTYPE
N01  C                   MOVE      ZUSER         ARUSER
N01  C                   MOVE      ULDT          ARDATE
N01  C                   MOVE      XULTM         ARTIME
N01  C                   MOVE      FAKUNR        ARKUND
N01  C                   WRITE     ARKIVR
N01  C                   ENDSR
