********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 SH  PTF12 ikke kalle tstuser derdet gjøres
12XXX * 02 SH  PTF12 volum med 3 desimaler
      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/SS207 MODULE(*LIBL/SS207
CRTPGM*        *LIBL/CHECKUSR *LIBL/INCGI) ACTGRP(CGI) AUT(*USE)
      *
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FHLBFIL    UF A E           K DISK    USROPN
     FGSSORF    UF   E           K DISK    USROPN
      *********************************************************************
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *
      * Client input variables
     D SubmPressed     s              1
     D lng             s              2
     D BckGnd          s             10
     D UsrSpcName      s             10
     D WSUSER          s             10
     D WSNA            S             30
     D AVSLUTT         s              1
     D WSONO           s              7
     D BWSONO          s              7  0
     D WSVOL           s              5
     D BWSVOL          s              5  2
N02  D BWSVOLW         s              8  3
N02  D BWSVOLX         s              8  2
     D WSCLI           s              5
     D BWSCLI          s              5  0
     D WSWT            s              7
     D BWSWT           s              7  1
     D WSL01           s              3
     D WSL02           s              3
     D WSL03           s              3
     D WSL04           s              3
     D WSL05           s              3
     D WSL06           s              3
     D WSL07           s              3
     D WSL08           s              3
     D WSL09           s              3
     D WSL10           s              3
     D WSL11           s              3
     D WSL12           s              3
     D WSL13           s              3
     D WSL14           s              3
     D WSL15           s              3
     D WSL16           s              3
     D WSL17           s              3
     D WSB01           s              3
     D WSB02           s              3
     D WSB03           s              3
     D WSB04           s              3
     D WSB05           s              3
     D WSB06           s              3
     D WSB07           s              3
     D WSB08           s              3
     D WSB09           s              3
     D WSB10           s              3
     D WSB11           s              3
     D WSB12           s              3
     D WSB13           s              3
     D WSB14           s              3
     D WSB15           s              3
     D WSB16           s              3
     D WSB17           s              3
     D WSH01           s              3
     D WSH02           s              3
     D WSH03           s              3
     D WSH04           s              3
     D WSH05           s              3
     D WSH06           s              3
     D WSH07           s              3
     D WSH08           s              3
     D WSH09           s              3
     D WSH10           s              3
     D WSH11           s              3
     D WSH12           s              3
     D WSH13           s              3
     D WSH14           s              3
     D WSH15           s              3
     D WSH16           s              3
     D WSH17           s              3
     D WSA01           s              3
     D WSA02           s              3
     D WSA03           s              3
     D WSA04           s              3
     D WSA05           s              3
     D WSA06           s              3
     D WSA07           s              3
     D WSA08           s              3
     D WSA09           s              3
     D WSA10           s              3
     D WSA11           s              3
     D WSA12           s              3
     D WSA13           s              3
     D WSA14           s              3
     D WSA15           s              3
     D WSA16           s              3
     D WSA17           s              3
     D WSV01           s              8
     D WSV02           s              8
     D WSV03           s              8
     D WSV04           s              8
     D WSV05           s              8
     D WSV06           s              8
     D WSV07           s              8
     D WSV08           s              8
     D WSV09           s              8
     D WSV10           s              8
     D WSV11           s              8
     D WSV12           s              8
     D WSV13           s              8
     D WSV14           s              8
     D WSV15           s              8
     D WSV16           s              8
     D WSV17           s              8
      *Array for fri-tekster
     D PGM             C                   CONST('SYSPED/CHECKUSR')
      * Variables used to load the external html source member
     D Lib             s             10
     D Fn              s             10
     D Mbr             s             10
      * Other variables
      *
     D Spaces          s             12a   inz('&nbsp;&nbsp;')
     D                 DS
     D BWSL01                  1      3  0
     D BWSL02                  4      6  0
     D BWSL03                  7      9  0
     D BWSL04                 10     12  0
     D BWSL05                 13     15  0
     D BWSL06                 16     18  0
     D BWSL07                 19     21  0
     D BWSL08                 22     24  0
     D BWSL09                 25     27  0
     D BWSL10                 28     30  0
     D BWSL11                 31     33  0
     D BWSL12                 34     36  0
     D BWSL13                 37     39  0
     D BWSL14                 40     42  0
     D BWSL15                 43     45  0
     D BWSL16                 46     48  0
     D BWSL17                 49     51  0
     D LEN                     1     51  0 DIM(17)
     D                 DS
     D BWSB01                  1      3  0
     D BWSB02                  4      6  0
     D BWSB03                  7      9  0
     D BWSB04                 10     12  0
     D BWSB05                 13     15  0
     D BWSB06                 16     18  0
     D BWSB07                 19     21  0
     D BWSB08                 22     24  0
     D BWSB09                 25     27  0
     D BWSB10                 28     30  0
     D BWSB11                 31     33  0
     D BWSB12                 34     36  0
     D BWSB13                 37     39  0
     D BWSB14                 40     42  0
     D BWSB15                 43     45  0
     D BWSB16                 46     48  0
     D BWSB17                 49     51  0
     D BRE                     1     51  0 DIM(17)
     D                 DS
     D BWSH01                  1      3  0
     D BWSH02                  4      6  0
     D BWSH03                  7      9  0
     D BWSH04                 10     12  0
     D BWSH05                 13     15  0
     D BWSH06                 16     18  0
     D BWSH07                 19     21  0
     D BWSH08                 22     24  0
     D BWSH09                 25     27  0
     D BWSH10                 28     30  0
     D BWSH11                 31     33  0
     D BWSH12                 34     36  0
     D BWSH13                 37     39  0
     D BWSH14                 40     42  0
     D BWSH15                 43     45  0
     D BWSH16                 46     48  0
     D BWSH17                 49     51  0
     D HOY                     1     51  0 DIM(17)
     D                 DS
     D BWSA01                  1      3  0
     D BWSA02                  4      6  0
     D BWSA03                  7      9  0
     D BWSA04                 10     12  0
     D BWSA05                 13     15  0
     D BWSA06                 16     18  0
     D BWSA07                 19     21  0
     D BWSA08                 22     24  0
     D BWSA09                 25     27  0
     D BWSA10                 28     30  0
     D BWSA11                 31     33  0
     D BWSA12                 34     36  0
     D BWSA13                 37     39  0
     D BWSA14                 40     42  0
     D BWSA15                 43     45  0
     D BWSA16                 46     48  0
     D BWSA17                 49     51  0
     D ANT                     1     51  0 DIM(17)
     D                 DS
     D BWSV01                  1      7  1
     D BWSV02                  8     14  1
     D BWSV03                 15     21  1
     D BWSV04                 22     28  1
     D BWSV05                 29     35  1
     D BWSV06                 36     42  1
     D BWSV07                 43     49  1
     D BWSV08                 50     56  1
     D BWSV09                 57     63  1
     D BWSV10                 64     70  1
     D BWSV11                 71     77  1
     D BWSV12                 78     84  1
     D BWSV13                 85     91  1
     D BWSV14                 92     98  1
     D BWSV15                 99    105  1
     D BWSV16                106    112  1
     D BWSV17                113    119  1
     D VKT                     1    119  1 DIM(17)
     D                 DS
     D FIL1                    1      3  0
     D FIL2                    4      6  0
     D FIL3                    7      9  0
     D FIL4                   10     12  0
     D FIL5                   13     15  0
     D FIL6                   16     18  0
     D FIL7                   19     21  0
     D FIL8                   22     24  0
     D FIL9                   25     27  0
     D FIL10                  28     30  0
     D FIL11                  31     33  0
     D FIL12                  34     36  0
     D FIL13                  37     39  0
     D FIL14                  40     42  0
     D FIL15                  43     45  0
     D FIL16                  46     48  0
     D FIL17                  49     51  0
     D LEN2                    1     51  0 DIM(17)
     D                 DS
     D FIB1                    1      3  0
     D FIB2                    4      6  0
     D FIB3                    7      9  0
     D FIB4                   10     12  0
     D FIB5                   13     15  0
     D FIB6                   16     18  0
     D FIB7                   19     21  0
     D FIB8                   22     24  0
     D FIB9                   25     27  0
     D FIB10                  28     30  0
     D FIB11                  31     33  0
     D FIB12                  34     36  0
     D FIB13                  37     39  0
     D FIB14                  40     42  0
     D FIB15                  43     45  0
     D FIB16                  46     48  0
     D FIB17                  49     51  0
     D BRE2                    1     51  0 DIM(17)
     D                 DS
     D FIH1                    1      3  0
     D FIH2                    4      6  0
     D FIH3                    7      9  0
     D FIH4                   10     12  0
     D FIH5                   13     15  0
     D FIH6                   16     18  0
     D FIH7                   19     21  0
     D FIH8                   22     24  0
     D FIH9                   25     27  0
     D FIH10                  28     30  0
     D FIH11                  31     33  0
     D FIH12                  34     36  0
     D FIH13                  37     39  0
     D FIH14                  40     42  0
     D FIH15                  43     45  0
     D FIH16                  46     48  0
     D FIH17                  49     51  0
     D HOY2                    1     51  0 DIM(17)
     D                 DS
     D FIA1                    1      3  0
     D FIA2                    4      6  0
     D FIA3                    7      9  0
     D FIA4                   10     12  0
     D FIA5                   13     15  0
     D FIA6                   16     18  0
     D FIA7                   19     21  0
     D FIA8                   22     24  0
     D FIA9                   25     27  0
     D FIA10                  28     30  0
     D FIA11                  31     33  0
     D FIA12                  34     36  0
     D FIA13                  37     39  0
     D FIA14                  40     42  0
     D FIA15                  43     45  0
     D FIA16                  46     48  0
     D FIA17                  49     51  0
     D ANT2                    1     51  0 DIM(17)
     D                 DS
     D FIV1                    1      7  2
     D FIV2                    8     14  2
     D FIV3                   15     21  2
     D FIV4                   22     28  2
     D FIV5                   29     35  2
     D FIV6                   36     42  2
     D FIV7                   43     49  2
     D FIV8                   50     56  2
     D FIV9                   57     63  2
     D FIV10                  64     70  2
     D FIV11                  71     77  2
     D FIV12                  78     84  2
     D FIV13                  85     91  2
     D FIV14                  92     98  2
     D FIV15                  99    105  2
     D FIV16                 106    112  2
     D FIV17                 113    119  2
     D VKT2                    1    119  2 DIM(17)
      *
      *
      *
      /copy syspeds/qrpgsrcpy,prolog3
      *
      * Get program start time for calculating execution time
     C                   time                    timedata1
      * Parse input / cvt to numeric
     C                   exsr      Parse
      * File open / keys
     C                   EXSR      INIT
     C                   IF        UINN = 'N'
     C                   GOTO      SLUTT
     C                   END
      *
      * Hvis første kall OG en...
     c     SubmPressed   IFEQ      'Y'
     C                   EXSR      OPDORD
     c                   ELSE
     c                   exsr      GetData
     c                   END
      * Read output skeleton html member into memory
     C                   exsr      LoadHtml
      * Set section variables
     C                   exsr      SetTop
      * Send section top
     C                   callp     wrtsection('top')
      * Send section bot
      *
     C                   callp     wrtsection('bot')
      * Quit
     C     SLUTT         TAG
     C                   exsr      Exit
      *
     C                   eval      *inlr = *on
     C                   return
      *
      *
      *=====================================================================
      * Parse input / cvt to numeric
      *=====================================================================
     C     Parse         begsr
     C                   eval      SubmPressed = zhbgetvar('SubmPressed')
     C                   eval      lng     = zhbgetvar('lng')
     C                   eval      BckGnd  = zhbgetvar('bckgnd')

     C                   eval      WSUSER  = zhbgetvar('USER')
     C                   EVAL      UsrSpcName  = zhbgetvar('UsrSpcName')
     C                   eval      WSNA    = zhbgetvar('WSNA')
     C                   eval      WSONO   = zhbgetvar('WSONO')
     C                   eval      BWSONO  = c2n2(WSONO)
      *
     C                   eval      WSVOL   = zhbgetvar('WSVOL')
s02  C*                  eval      BWSVOL  = c2n2(WSVOL)
n02   * flytter til felt 8,3 langt
n02  C                   eval      BWSVOLW  = c2n2(WSVOL)
n02   * flytter til felt 8,2 langt
n02  c                   z-add(h)  bwsvolw       bwsvolx
n02   * ved move får vi vel ikke besksjed om at felt er for lite
n02  c                   move      bwsvolx       bwsvol
     C                   eval      WSCLI   = zhbgetvar('WSCLI')
     C                   eval      BWSCLI  = c2n2(WSCLI)
     C                   eval      WSWT    = zhbgetvar('WSWT')
     C                   eval      BWSWT   = c2n2(WSWT)
      *
     C                   eval      WSL01   = zhbgetvar('WSL01')
     C                   eval      BWSL01  = c2n2(WSL01)
     C                   eval      WSL02   = zhbgetvar('WSL02')
     C                   eval      BWSL02  = c2n2(WSL02)
     C                   eval      WSL03   = zhbgetvar('WSL03')
     C                   eval      BWSL03  = c2n2(WSL03)
     C                   eval      WSL04   = zhbgetvar('WSL04')
     C                   eval      BWSL04  = c2n2(WSL04)
     C                   eval      WSL05   = zhbgetvar('WSL05')
     C                   eval      BWSL05  = c2n2(WSL05)
     C                   eval      WSL06   = zhbgetvar('WSL06')
     C                   eval      BWSL06  = c2n2(WSL06)
     C                   eval      WSL07   = zhbgetvar('WSL07')
     C                   eval      BWSL07  = c2n2(WSL07)
     C                   eval      WSL08   = zhbgetvar('WSL08')
     C                   eval      BWSL08  = c2n2(WSL08)
     C                   eval      WSL09   = zhbgetvar('WSL09')
     C                   eval      BWSL09  = c2n2(WSL09)
     C                   eval      WSL10   = zhbgetvar('WSL10')
     C                   eval      BWSL10  = c2n2(WSL10)
     C                   eval      WSL11   = zhbgetvar('WSL11')
     C                   eval      BWSL11  = c2n2(WSL11)
     C                   eval      WSL12   = zhbgetvar('WSL12')
     C                   eval      BWSL12  = c2n2(WSL12)
     C                   eval      WSL13   = zhbgetvar('WSL13')
     C                   eval      BWSL13  = c2n2(WSL13)
     C                   eval      WSL14   = zhbgetvar('WSL14')
     C                   eval      BWSL14  = c2n2(WSL14)
     C                   eval      WSL15   = zhbgetvar('WSL15')
     C                   eval      BWSL15  = c2n2(WSL15)
     C                   eval      WSL16   = zhbgetvar('WSL16')
     C                   eval      BWSL16  = c2n2(WSL16)
     C                   eval      WSL17   = zhbgetvar('WSL17')
     C                   eval      BWSL17  = c2n2(WSL17)
     C                   eval      WSB01   = zhbgetvar('WSB01')
     C                   eval      BWSB01  = c2n2(WSB01)
     C                   eval      WSB02   = zhbgetvar('WSB02')
     C                   eval      BWSB02  = c2n2(WSB02)
     C                   eval      WSB03   = zhbgetvar('WSB03')
     C                   eval      BWSB03  = c2n2(WSB03)
     C                   eval      WSB04   = zhbgetvar('WSB04')
     C                   eval      BWSB04  = c2n2(WSB04)
     C                   eval      WSB05   = zhbgetvar('WSB05')
     C                   eval      BWSB05  = c2n2(WSB05)
     C                   eval      WSB06   = zhbgetvar('WSB06')
     C                   eval      BWSB06  = c2n2(WSB06)
     C                   eval      WSB07   = zhbgetvar('WSB07')
     C                   eval      BWSB07  = c2n2(WSB07)
     C                   eval      WSB08   = zhbgetvar('WSB08')
     C                   eval      BWSB08  = c2n2(WSB08)
     C                   eval      WSB09   = zhbgetvar('WSB09')
     C                   eval      BWSB09  = c2n2(WSB09)
     C                   eval      WSB10   = zhbgetvar('WSB10')
     C                   eval      BWSB10  = c2n2(WSB10)
     C                   eval      WSB11   = zhbgetvar('WSB11')
     C                   eval      BWSB11  = c2n2(WSB11)
     C                   eval      WSB12   = zhbgetvar('WSB12')
     C                   eval      BWSB12  = c2n2(WSB12)
     C                   eval      WSB13   = zhbgetvar('WSB13')
     C                   eval      BWSB13  = c2n2(WSB13)
     C                   eval      WSB14   = zhbgetvar('WSB14')
     C                   eval      BWSB14  = c2n2(WSB14)
     C                   eval      WSB15   = zhbgetvar('WSB15')
     C                   eval      BWSB15  = c2n2(WSB15)
     C                   eval      WSB16   = zhbgetvar('WSB16')
     C                   eval      BWSB16  = c2n2(WSB16)
     C                   eval      WSB17   = zhbgetvar('WSB17')
     C                   eval      BWSB17  = c2n2(WSB17)
     C                   eval      WSH01   = zhbgetvar('WSH01')
     C                   eval      BWSH01  = c2n2(WSH01)
     C                   eval      WSH02   = zhbgetvar('WSH02')
     C                   eval      BWSH02  = c2n2(WSH02)
     C                   eval      WSH03   = zhbgetvar('WSH03')
     C                   eval      BWSH03  = c2n2(WSH03)
     C                   eval      WSH04   = zhbgetvar('WSH04')
     C                   eval      BWSH04  = c2n2(WSH04)
     C                   eval      WSH05   = zhbgetvar('WSH05')
     C                   eval      BWSH05  = c2n2(WSH05)
     C                   eval      WSH06   = zhbgetvar('WSH06')
     C                   eval      BWSH06  = c2n2(WSH06)
     C                   eval      WSH07   = zhbgetvar('WSH07')
     C                   eval      BWSH07  = c2n2(WSH07)
     C                   eval      WSH08   = zhbgetvar('WSH08')
     C                   eval      BWSH08  = c2n2(WSH08)
     C                   eval      WSH09   = zhbgetvar('WSH09')
     C                   eval      BWSH09  = c2n2(WSH09)
     C                   eval      WSH10   = zhbgetvar('WSH10')
     C                   eval      BWSH10  = c2n2(WSH10)
     C                   eval      WSH11   = zhbgetvar('WSH11')
     C                   eval      BWSH11  = c2n2(WSH11)
     C                   eval      WSH12   = zhbgetvar('WSH12')
     C                   eval      BWSH12  = c2n2(WSH12)
     C                   eval      WSH13   = zhbgetvar('WSH13')
     C                   eval      BWSH13  = c2n2(WSH13)
     C                   eval      WSH14   = zhbgetvar('WSH14')
     C                   eval      BWSH14  = c2n2(WSH14)
     C                   eval      WSH15   = zhbgetvar('WSH15')
     C                   eval      BWSH15  = c2n2(WSH15)
     C                   eval      WSH16   = zhbgetvar('WSH16')
     C                   eval      BWSH16  = c2n2(WSH16)
     C                   eval      WSH17   = zhbgetvar('WSH17')
     C                   eval      BWSH17  = c2n2(WSH17)
     C                   eval      WSA01   = zhbgetvar('WSA01')
     C                   eval      BWSA01  = c2n2(WSA01)
     C                   eval      WSA02   = zhbgetvar('WSA02')
     C                   eval      BWSA02  = c2n2(WSA02)
     C                   eval      WSA03   = zhbgetvar('WSA03')
     C                   eval      BWSA03  = c2n2(WSA03)
     C                   eval      WSA04   = zhbgetvar('WSA04')
     C                   eval      BWSA04  = c2n2(WSA04)
     C                   eval      WSA05   = zhbgetvar('WSA05')
     C                   eval      BWSA05  = c2n2(WSA05)
     C                   eval      WSA06   = zhbgetvar('WSA06')
     C                   eval      BWSA06  = c2n2(WSA06)
     C                   eval      WSA07   = zhbgetvar('WSA07')
     C                   eval      BWSA07  = c2n2(WSA07)
     C                   eval      WSA08   = zhbgetvar('WSA08')
     C                   eval      BWSA08  = c2n2(WSA08)
     C                   eval      WSA09   = zhbgetvar('WSA09')
     C                   eval      BWSA09  = c2n2(WSA09)
     C                   eval      WSA10   = zhbgetvar('WSA10')
     C                   eval      BWSA10  = c2n2(WSA10)
     C                   eval      WSA11   = zhbgetvar('WSA11')
     C                   eval      BWSA11  = c2n2(WSA11)
     C                   eval      WSA12   = zhbgetvar('WSA12')
     C                   eval      BWSA12  = c2n2(WSA12)
     C                   eval      WSA13   = zhbgetvar('WSA13')
     C                   eval      BWSA13  = c2n2(WSA13)
     C                   eval      WSA14   = zhbgetvar('WSA14')
     C                   eval      BWSA14  = c2n2(WSA14)
     C                   eval      WSA15   = zhbgetvar('WSA15')
     C                   eval      BWSA15  = c2n2(WSA15)
     C                   eval      WSA16   = zhbgetvar('WSA16')
     C                   eval      BWSA16  = c2n2(WSA16)
     C                   eval      WSA17   = zhbgetvar('WSA17')
     C                   eval      BWSA17  = c2n2(WSA17)
     C                   eval      WSV01   = zhbgetvar('WSV01')
     C                   eval      BWSV01  = c2n2(WSV01)
     C                   eval      WSV02   = zhbgetvar('WSV02')
     C                   eval      BWSV02  = c2n2(WSV02)
     C                   eval      WSV03   = zhbgetvar('WSV03')
     C                   eval      BWSV03  = c2n2(WSV03)
     C                   eval      WSV04   = zhbgetvar('WSV04')
     C                   eval      BWSV04  = c2n2(WSV04)
     C                   eval      WSV05   = zhbgetvar('WSV05')
     C                   eval      BWSV05  = c2n2(WSV05)
     C                   eval      WSV06   = zhbgetvar('WSV06')
     C                   eval      BWSV06  = c2n2(WSV06)
     C                   eval      WSV07   = zhbgetvar('WSV07')
     C                   eval      BWSV07  = c2n2(WSV07)
     C                   eval      WSV08   = zhbgetvar('WSV08')
     C                   eval      BWSV08  = c2n2(WSV08)
     C                   eval      WSV09   = zhbgetvar('WSV09')
     C                   eval      BWSV09  = c2n2(WSV09)
     C                   eval      WSV10   = zhbgetvar('WSV10')
     C                   eval      BWSV10  = c2n2(WSV10)
     C                   eval      WSV11   = zhbgetvar('WSV11')
     C                   eval      BWSV11  = c2n2(WSV11)
     C                   eval      WSV12   = zhbgetvar('WSV12')
     C                   eval      BWSV12  = c2n2(WSV12)
     C                   eval      WSV13   = zhbgetvar('WSV13')
     C                   eval      BWSV13  = c2n2(WSV13)
     C                   eval      WSV14   = zhbgetvar('WSV14')
     C                   eval      BWSV14  = c2n2(WSV14)
     C                   eval      WSV15   = zhbgetvar('WSV15')
     C                   eval      BWSV15  = c2n2(WSV15)
     C                   eval      WSV16   = zhbgetvar('WSV16')
     C                   eval      BWSV16  = c2n2(WSV16)
     C                   eval      WSV17   = zhbgetvar('WSV17')
     C                   eval      BWSV17  = c2n2(WSV17)
      *
     C                   endsr
      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   CLOSE     BRIDF
     C                   close     HLBFIL
     C                   close     GSSORF
     C                   return
     C                   endsr
      *=====================================================================
      * Read output skeleton html member into memory
      *=====================================================================
     C     LoadHtml      begsr
     C                   eval      Lib = '*LIBL'
     C                   eval      Fn  = 'HTMLSRC'
     C                   eval      Mbr = 'SS207'
     C                   callp     gethtml(fn:lib:mbr:'/CGITAG/')
     C                   endsr
      *=====================================================================
      *  Set variable data for section /$top
      *=====================================================================
     C     SetTop        begsr
      *
      * Repeat national language for the next invocation
     C                   callp     updhtmlvar('LNG':lng:
     C                             InitHTMLVars)
      * Repeat background color for the next invocation
     C                   callp     updhtmlvar('TXTCOLOR':'black')
     C                   callp     updhtmlvar('BOLD':' ')
     C                   callp     updhtmlvar('BGCOLOR':BIFARG)
     C                   callp     updhtmlvar('LINK':'0000FF')
     C                   callp     updhtmlvar('VLINK':'FF0000')
     C                   callp     updhtmlvar('ALINK':'00FF00')
      * KUNDE
BODY C                   callp     updhtmlvar('BODYCLASS':'class='+BIFARG)
     C                   callp     updHtmlVar('USER':WSUSER)
     C                   callp     updHtmlVar('UsrSpcName':UsrSpcName)
     C                   callp     updHtmlVar('WSNA':WSNA)
     C                   callp     updHtmlVar('KUNDE':
     C                             %trim(%editc(BIKUNR:'Z')))
     C                   callp     updHTMLvar('sdato':
     C                             %trim(%editw(BIDTV:'    .  .  ')))
     C                   callp     updHTMLvar('stid':
     C                             %trim(%editw(BITIDV:'  .  .  ')))
      *
     C                   callp     updhtmlvar('WSONO':
     C                             %trim(%editc(BWSONO:'Z')))
     C                   callp     updhtmlvar('WSVOL':
     C                             %trim(%editc(BWSVOL:'4')))
     C                   callp     updhtmlvar('WSCLI':
     C                             %trim(%editc(BWSCLI:'Z')))
     C                   callp     updhtmlvar('WSWT':
     C                             %trim(%editc(BWSWT:'4')))
     C                   callp     updhtmlvar('AVSLUTT':AVSLUTT)
      *
     C                   callp     updhtmlvar('WSL01':
     C                             %trim(%editc(BWSL01:'Z')))
     C                   callp     updhtmlvar('WSL02':
     C                             %trim(%editc(BWSL02:'Z')))
     C                   callp     updhtmlvar('WSL03':
     C                             %trim(%editc(BWSL03:'Z')))
     C                   callp     updhtmlvar('WSL04':
     C                             %trim(%editc(BWSL04:'Z')))
     C                   callp     updhtmlvar('WSL05':
     C                             %trim(%editc(BWSL05:'Z')))
     C                   callp     updhtmlvar('WSL06':
     C                             %trim(%editc(BWSL06:'Z')))
     C                   callp     updhtmlvar('WSL07':
     C                             %trim(%editc(BWSL07:'Z')))
     C                   callp     updhtmlvar('WSL08':
     C                             %trim(%editc(BWSL08:'Z')))
     C                   callp     updhtmlvar('WSL09':
     C                             %trim(%editc(BWSL09:'Z')))
     C                   callp     updhtmlvar('WSL10':
     C                             %trim(%editc(BWSL10:'Z')))
     C                   callp     updhtmlvar('WSL11':
     C                             %trim(%editc(BWSL11:'Z')))
     C                   callp     updhtmlvar('WSL12':
     C                             %trim(%editc(BWSL12:'Z')))
     C                   callp     updhtmlvar('WSL13':
     C                             %trim(%editc(BWSL13:'Z')))
     C                   callp     updhtmlvar('WSL14':
     C                             %trim(%editc(BWSL14:'Z')))
     C                   callp     updhtmlvar('WSL15':
     C                             %trim(%editc(BWSL15:'Z')))
     C                   callp     updhtmlvar('WSL16':
     C                             %trim(%editc(BWSL16:'Z')))
     C                   callp     updhtmlvar('WSL17':
     C                             %trim(%editc(BWSL17:'Z')))
     C                   callp     updhtmlvar('WSB01':
     C                             %trim(%editc(BWSB01:'Z')))
     C                   callp     updhtmlvar('WSB02':
     C                             %trim(%editc(BWSB02:'Z')))
     C                   callp     updhtmlvar('WSB03':
     C                             %trim(%editc(BWSB03:'Z')))
     C                   callp     updhtmlvar('WSB04':
     C                             %trim(%editc(BWSB04:'Z')))
     C                   callp     updhtmlvar('WSB05':
     C                             %trim(%editc(BWSB05:'Z')))
     C                   callp     updhtmlvar('WSB06':
     C                             %trim(%editc(BWSB06:'Z')))
     C                   callp     updhtmlvar('WSB07':
     C                             %trim(%editc(BWSB07:'Z')))
     C                   callp     updhtmlvar('WSB08':
     C                             %trim(%editc(BWSB08:'Z')))
     C                   callp     updhtmlvar('WSB09':
     C                             %trim(%editc(BWSB09:'Z')))
     C                   callp     updhtmlvar('WSB10':
     C                             %trim(%editc(BWSB10:'Z')))
     C                   callp     updhtmlvar('WSB11':
     C                             %trim(%editc(BWSB11:'Z')))
     C                   callp     updhtmlvar('WSB12':
     C                             %trim(%editc(BWSB12:'Z')))
     C                   callp     updhtmlvar('WSB13':
     C                             %trim(%editc(BWSB13:'Z')))
     C                   callp     updhtmlvar('WSB14':
     C                             %trim(%editc(BWSB14:'Z')))
     C                   callp     updhtmlvar('WSB15':
     C                             %trim(%editc(BWSB15:'Z')))
     C                   callp     updhtmlvar('WSB16':
     C                             %trim(%editc(BWSB16:'Z')))
     C                   callp     updhtmlvar('WSB17':
     C                             %trim(%editc(BWSB17:'Z')))
     C                   callp     updhtmlvar('WSH01':
     C                             %trim(%editc(BWSH01:'Z')))
     C                   callp     updhtmlvar('WSH02':
     C                             %trim(%editc(BWSH02:'Z')))
     C                   callp     updhtmlvar('WSH03':
     C                             %trim(%editc(BWSH03:'Z')))
     C                   callp     updhtmlvar('WSH04':
     C                             %trim(%editc(BWSH04:'Z')))
     C                   callp     updhtmlvar('WSH05':
     C                             %trim(%editc(BWSH05:'Z')))
     C                   callp     updhtmlvar('WSH06':
     C                             %trim(%editc(BWSH06:'Z')))
     C                   callp     updhtmlvar('WSH07':
     C                             %trim(%editc(BWSH07:'Z')))
     C                   callp     updhtmlvar('WSH08':
     C                             %trim(%editc(BWSH08:'Z')))
     C                   callp     updhtmlvar('WSH09':
     C                             %trim(%editc(BWSH09:'Z')))
     C                   callp     updhtmlvar('WSH10':
     C                             %trim(%editc(BWSH10:'Z')))
     C                   callp     updhtmlvar('WSH11':
     C                             %trim(%editc(BWSH11:'Z')))
     C                   callp     updhtmlvar('WSH12':
     C                             %trim(%editc(BWSH12:'Z')))
     C                   callp     updhtmlvar('WSH13':
     C                             %trim(%editc(BWSH13:'Z')))
     C                   callp     updhtmlvar('WSH14':
     C                             %trim(%editc(BWSH14:'Z')))
     C                   callp     updhtmlvar('WSH15':
     C                             %trim(%editc(BWSH15:'Z')))
     C                   callp     updhtmlvar('WSH16':
     C                             %trim(%editc(BWSH16:'Z')))
     C                   callp     updhtmlvar('WSH17':
     C                             %trim(%editc(BWSH17:'Z')))
     C                   callp     updhtmlvar('WSA01':
     C                             %trim(%editc(BWSA01:'Z')))
     C                   callp     updhtmlvar('WSA02':
     C                             %trim(%editc(BWSA02:'Z')))
     C                   callp     updhtmlvar('WSA03':
     C                             %trim(%editc(BWSA03:'Z')))
     C                   callp     updhtmlvar('WSA04':
     C                             %trim(%editc(BWSA04:'Z')))
     C                   callp     updhtmlvar('WSA05':
     C                             %trim(%editc(BWSA05:'Z')))
     C                   callp     updhtmlvar('WSA06':
     C                             %trim(%editc(BWSA06:'Z')))
     C                   callp     updhtmlvar('WSA07':
     C                             %trim(%editc(BWSA07:'Z')))
     C                   callp     updhtmlvar('WSA08':
     C                             %trim(%editc(BWSA08:'Z')))
     C                   callp     updhtmlvar('WSA09':
     C                             %trim(%editc(BWSA09:'Z')))
     C                   callp     updhtmlvar('WSA10':
     C                             %trim(%editc(BWSA10:'Z')))
     C                   callp     updhtmlvar('WSA11':
     C                             %trim(%editc(BWSA11:'Z')))
     C                   callp     updhtmlvar('WSA12':
     C                             %trim(%editc(BWSA12:'Z')))
     C                   callp     updhtmlvar('WSA13':
     C                             %trim(%editc(BWSA13:'Z')))
     C                   callp     updhtmlvar('WSA14':
     C                             %trim(%editc(BWSA14:'Z')))
     C                   callp     updhtmlvar('WSA15':
     C                             %trim(%editc(BWSA15:'Z')))
     C                   callp     updhtmlvar('WSA16':
     C                             %trim(%editc(BWSA16:'Z')))
     C                   callp     updhtmlvar('WSA17':
     C                             %trim(%editc(BWSA17:'Z')))
     C                   callp     updhtmlvar('WSV01':
     C                             %trim(%editc(BWSV01:'4')))
     C                   callp     updhtmlvar('WSV02':
     C                             %trim(%editc(BWSV02:'4')))
     C                   callp     updhtmlvar('WSV03':
     C                             %trim(%editc(BWSV03:'4')))
     C                   callp     updhtmlvar('WSV04':
     C                             %trim(%editc(BWSV04:'4')))
     C                   callp     updhtmlvar('WSV05':
     C                             %trim(%editc(BWSV05:'4')))
     C                   callp     updhtmlvar('WSV06':
     C                             %trim(%editc(BWSV06:'4')))
     C                   callp     updhtmlvar('WSV07':
     C                             %trim(%editc(BWSV07:'4')))
     C                   callp     updhtmlvar('WSV08':
     C                             %trim(%editc(BWSV08:'4')))
     C                   callp     updhtmlvar('WSV09':
     C                             %trim(%editc(BWSV09:'4')))
     C                   callp     updhtmlvar('WSV10':
     C                             %trim(%editc(BWSV10:'4')))
     C                   callp     updhtmlvar('WSV11':
     C                             %trim(%editc(BWSV11:'4')))
     C                   callp     updhtmlvar('WSV12':
     C                             %trim(%editc(BWSV12:'4')))
     C                   callp     updhtmlvar('WSV13':
     C                             %trim(%editc(BWSV13:'4')))
     C                   callp     updhtmlvar('WSV14':
     C                             %trim(%editc(BWSV14:'4')))
     C                   callp     updhtmlvar('WSV15':
     C                             %trim(%editc(BWSV15:'4')))
     C                   callp     updhtmlvar('WSV16':
     C                             %trim(%editc(BWSV16:'4')))
     C                   callp     updhtmlvar('WSV17':
     C                             %trim(%editc(BWSV17:'4')))
      *
     C                   endsr
      *
      *=====================================================================
      *  Hent data fra fra fil ved først "syklus"  / endring av post
      *=====================================================================
     C     GetData       begsr
      *
     C     BWSONO        CHAIN(N)  HLBFIL                             33
     C     1             DO        17            XN
     C                   IF        *IN33
     C                   EVAL      LEN(XN) = 0
     C                   EVAL      BRE(XN) = 0
     C                   EVAL      HOY(XN) = 0
     C                   EVAL      ANT(XN) = 0
     C                   EVAL      VKT(XN) = 0
     C                   ELSE
     C                   EVAL      LEN(XN) = LEN2(XN)
     C                   EVAL      BRE(XN) = BRE2(XN)
     C                   EVAL      HOY(XN) = HOY2(XN)
     C                   EVAL      ANT(XN) = ANT2(XN)
     C                   EVAL      VKT(XN) = VKT2(XN)
     C                   END
     C                   ENDDO
      *
     C                   endsr
      *
      *=====================================================================
      *  Oppdater oppdrag
      *=====================================================================
     C     OPDORD        begsr
      *
     C                   EVAL      BWSVOL = 0
     C                   EVAL      BWSCLI = 0
     C                   EVAL      BWSWT  = 0
     C     BWSONO        CHAIN     HLBFIL                             33
      *
     C     1             DO        17            XN                3 0
     C                   EVAL      LEN2(XN) = LEN(XN)
     C                   EVAL      BRE2(XN) = BRE(XN)
     C                   EVAL      HOY2(XN) = HOY(XN)
     C                   EVAL      ANT2(XN) = ANT(XN)
     C                   EVAL      VKT2(XN) = VKT(XN)
     C                   EVAL(H)   BWSVOL = BWSVOL +
     C                             LEN(XN) * BRE(XN) * HOY(XN) / 1000000 *
     C                             ANT(XN)
     C                   EVAL(H)   BWSCLI = BWSCLI + ANT(XN)
     C                   EVAL(H)   BWSWT  = BWSWT  + VKT(XN)
     C                   ENDDO
      *
     C                   IF        *IN33
     C                   EVAL      ORONO  = BWSONO
     C                   WRITE     HLBFILR
     C                   ELSE
     C                   UPDATE    HLBFILR
     C                   END
      *
     C     BWSONO        CHAIN     GSSORF                             33
     C                   IF        *IN33 = *OFF
     C                   EVAL      ORVOL = BWSVOL
     C                   EVAL      ORCLI = BWSCLI
     C                   EVAL      ORWT  = BWSWT
     C                   UPDATE    GSSORFR
     C                   END
      *
     C                   EVAL      AVSLUTT = 'Y'
      *
     C                   endsr
      *
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
     C                   OPEN      BRIDF
s01  C*                  EXSR      TSTUSER
     C     WSUSER        CHAIN     BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
n01  C                   EXSR      TSTUSER
      *
     C                   OPEN      HLBFIL
     C                   OPEN      GSSORF
      *
     C                   EVAL      AVSLUTT = ' '
      *
     C                   endsr
      *
      *////////////////////////////////////////////////////////////
     C     TSTUSER       BEGSR
      *////////////////////////////////////////////////////////////
      /copy syspeds/qrpgsrcpy,tstuser
      *
     C                   endsr
