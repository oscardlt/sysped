      *********************************************************************
      *  Henter data fra fil og skriver xml-dokument
      *  kall på program: http://XXX.XXX.XXX.XXX/SYCGIP/MITTPGM.pgm?user=NN
      *  XXX.XXX.XXX.XXX ER KUNDENS IP-ADRESSE
      *  MITTPGM BYTTES MED PROGRAMMET MAN LAGER
      *********************************************************************
CRTPG *  CRTPGM SYSPED/MITTPGM MODULE(*LIBL/MITTPGM
CRTPG *         *LIBL/INCGI) ACTGRP(*NEW) AUT(*USE)
      *
      *********************************************************************
      * MAIN PROGRAM FLOW
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *--------------------------------------------------------------------
     FBRIDF     IF   E           K DISK    USROPN
tmp  F*XXXX     IF   E           K DISK    usropn
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *--------------------------------------------------------------------
     D WSUSER          S             10
     D XMLstring       S          32000
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prolog3
      *--------------------------------------------------------------------
      *
      * Parse input
     C                   exsr      Parse
      * Initiering
     C                   EXSR      INIT
      *
      * Hent XML output-dok/ skriv top + linjer
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/WS_XML.html':
     C                             '/CGITAG/')
      *
     C                   callp     wrtsection('top')
      *******************************************************************
      * her starter utlegging av XML
      *******************************************************************
      /free
        XMLstring='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');

        XMLstring='<GetKTant>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');

        XMLstring='<AntOppd>'+%trim(%editc(AntOpd:'Z'))+'</AntOppd>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');

        XMLstring='<AntTurer>'+%trim(%editc(AntTur:'Z'))+'</AntTurer>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');

        XMLstring='</GetKTant>';
        updhtmlvar2('XMLstring':%addr(XMLstring):%len(XMLstring));
        wrtsection('XMLlin');
      /end-free
      *
     C                   EXSR      EXIT
     C                   return
      ******************************************************************************
     C     Parse         begsr
      ******************************************************************************
      * Parse input   Bruker er fast NN + sndnr
      *
     C                   eval      WSUSER  = zhbgetvar('USER')
     c     WSUSER        ifeq      *blanks
     C                   eval      WSUSER  = 'NN'
     c                   endif
     C                   endsr
      ******************************************************************************
     C     INIT          begsr
      ******************************************************************************
      *
     C                   OPEN      BRIDF
     C     WSUSER        CHAIN     BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
      * -----------------------------------
      * henter inn data fra fil
      * -----------------------------------
tmp  C*                  OPEN      xxx
      *
tmp  C*    *loval        SETLL     xxx
tmp  C*                  read      xxx
     c                   z-add     100000        AntOpd            7 0
     c                   z-add     10000         AntTur            7 0
      *
tmp  C*                  close     xxx
     C                   endsr
      *******************************************************************************
     C     EXIT          begsr
      *******************************************************************************
      *  AVSLUTT
tmp  C                   close     BRIDF
     C                   callp     wrtsection('*fini')
     C                   eval      *inlr = *on
      *
     C                   endsr
