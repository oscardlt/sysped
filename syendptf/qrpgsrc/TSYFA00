**FREE
ctl-opt dftactgrp(*no);
dcl-f firm;
dcl-f multkodt keyed;
dcl-ds *N DtAArA(*AUtO);
  fifirm char(2);
  kovfir char(2);
  kovpro char(1) pos(13);
  uavd zoned(4) pos(15);
  usg char(3);
  upro zoned(8);
  udt12 zoned(2);
  udtm2 zoned(2);
  udtd2 zoned(2);
  udato2 zoned(6) pos(30);
  uhod char(1) pos(47);
  ubbs char(1);
  WSMS1 char(2);
  WSMS2 char(2);
  WSMS3 char(2);
  WSMS4 char(2);
  WSMS5 char(2);
  WSMS6 char(2);
  ULG   char(1);
  UEKSP char(1);
  UIKKE char(1);
  UDTÅ1 zoned(2);
  UDTM1 zoned(2);
  UDTD1 zoned(2);
  udato1 zoned(6) pos(64);
  UOT1  char(2);
  UOT2  char(2);
  UOT3  char(2);
  UOT4  char(2);
  UOT5  char(2);
  USUM  char(1);
  UAWB  char(1);
  uopd zoned(7);
  ufbnr zoned(3);
  XBLA1 char(165) pos(92);
  XBLA2 char(144) pos(257);
  UWSID char(10);
  XBLA3 char(100);
  filfb char(1) pos(509);
  filtb char(1);
  uprt24 char(10) pos(561);
  upt24  char(10);
  uprt26 char(10);
  upt26  char(10);
  uprt0  char(10);
  upt0   char(10);
  uprt1  char(10);
  upt1   char(10);
  uprt2  char(10);
  upt2   char(10);
  uprt3  char(10);
  upt3   char(10);
  uprt4  char(10);
  upt4   char(10);
  uprt5  char(10);
  upt5   char(10);
  uprt6  char(10);
  upt6   char(10);
  uprt7  char(10);
  upt7   char(10);
  uprt8  char(10);
  upt8   char(10);
  uprt9  char(10);
  upt9   char(10);
  uprt10 char(10);
  upt10  char(10);
  uprt11 char(10);
  upt11  char(10);
  uprt12 char(10);
  upt12  char(10);
  uprt13 char(10);
  upt13  char(10);
  uprt14 char(10);
  upt14  char(10);
  uprt19 char(10);
  upt19  char(10);
  uprt67 char(10);
  upt67  char(10);
  uprt57 char(10);
  upt57  char(10);
  uprt73 char(10);
  upt73  char(10);
  ugn    char(15);
end-ds;
     // Prototype for tsyfa00
dcl-pr tsyfa00;
  wssg_ like(wssg);
  wsavd_ like(wsavd);
  wspro_  like(wspro);
  wsopd_  like(wsopd);
  wgn_   like(wgn);
  wsprt_ like(wsprt);
  wsprt2_ like(wsprt2);
end-pr;
     // *Entry Interface for Main Procedure
dcl-pi tsyfa00;
  wssg char(3);
  wsavd packed(4);
  wspro packed(8);
  wsopd packed(8);
  wgn char(15);
  wsprt char(10);
  wsprt2 char(10);
end-pi;
dcl-s in99 char(1);
     //_____
     // Init
     //"""""
Chain ('V':Wsavd) KOVR;
  if %found;
    Chain ('W':Wsavd) KOWR;
    if %found;
      Chain ('H':Wsavd) KOWR;
      if %found;
        in99 = '1';
      endif;
    endif;
  endif;
     //___
     // ?
     //"""
if in99 = '1';
     // Oppdragsformular
  if wsof = 'J';
    Chain ('P':Wsavd 13) Kopr;
      if %found;
        uprt13 = kopnvn;
        upt13  = kopty;
      endif;
  endif;
     // Vanlig fraktbrev
  if wsvf = 'J';
    Chain ('P':Wsavd 6) Kopr;
      if %found;
        uprt6 = kopnvn;
        upt6  = kopty;
      endif;
    Chain ('P':Wsavd 8) Kopr;
      if %found;
        uprt8 = kopnvn;
        upt8  = kopty;
      endif;
    Chain ('P':Wsavd 9) Kopr;
      if %found;
        uprt9 = kopnvn;
        upt9  = kopty;
      endif;
    Chain ('P':Wsavd 10) Kopr;
      if %found;
        uprt10 = kopnvn;
        upt10  = kopty;
      endif;
    Chain ('P':Wsavd 19) Kopr;
      if %found;
        uprt19 = kopnvn;
        upt19  = kopty;
      endif;
    Chain ('P':Wsavd 57) Kopr;
      if %found;
        uprt57 = kopnvn;
        upt57  = kopty;
      endif;
    Chain ('P':Wsavd 67) Kopr;
      if %found;
        uprt67 = kopnvn;
        upt67  = kopty;
      endif;
  endif;
     // Tollpassfraktbrev
  if wstpfb = 'J';
    Chain ('P':Wsavd 8) Kopr;
      if %found;
        uprt8 = kopnvn;
        upt8  = kopty;
      endif;
    Chain ('P':Wsavd 9) Kopr;
      if %found;
        uprt9 = kopnvn;
        upt9  = kopty;
      endif;
    Chain ('P':Wsavd 10) Kopr;
      if %found;
        uprt10 = kopnvn;
        upt10  = kopty;
      endif;
    Chain ('P':Wsavd 14) Kopr;
      if %found;
        uprt14 = kopnvn;
        upt14  = kopty;
      endif;
    Chain ('P':Wsavd 57) Kopr;
      if %found;
        uprt57 = kopnvn;
        upt57  = kopty;
      endif;
    Chain ('P':Wsavd 67) Kopr;
      if %found;
        uprt67 = kopnvn;
        upt67  = kopty;
      endif;
  endif;
     // Forpassing SAD
  if wsfp = 'J';
    Chain ('P':Wsavd 80) Kopr;
      if %found;
        uprt0 = kopnvn;
        upt0  = 'tolldek-1'
      endif;
  endif;
     // Innenlands flyfraktbrev
  if wsiffb = 'J';
    Chain ('P':Wsavd 1) Kopr;
      if %found;
        uprt1 = kopnvn;
        upt1  = kopty;
      endif;
    Chain ('P':Wsavd 2) Kopr;
      if %found;
        uprt2 = kopnvn;
        upt2  = kopty;
      endif;
    Chain ('P':Wsavd 3) Kopr;
      if %found;
        uprt3 = kopnvn;
        upt3  = kopty;
      endif;
  endif;
     // Losseliste
  if wsloss = 'J';
    Chain ('P':Wsavd 11) Kopr;
      if %found;
        uprt11 = kopnvn;
        upt11  = kopty;
      endif;
    Chain ('P':Wsavd 12) Kopr;
      if %found;
        uprt12 = kopnvn;
        upt12  = kopty;
      endif;
    Chain ('P':Wsavd 67) Kopr;
      if %found;
        uprt67 = kopnvn;
        upt67  = kopty;
      endif;
  endif;
     // Ferdigmeldte fakturar
  if wsffak = 'J';
    Chain ('P':Wsavd 4) Kopr;
      if %found;
        uprt4 = kopnvn;
        upt4  = kopty;
      endif;
    Chain ('P':Wsavd 19) Kopr;
      if %found;
        uprt19 = kopnvn;
        upt19  = kopty;
      endif;
    Chain ('P':Wsavd 73) Kopr;
      if %found;
        uprt73 = kopnvn;
        upt73  = kopty;
      endif;
  endif;
     // Fakturar med inntastet oppdragstyper
  if wsms1 <> ' ';
    Chain ('P':Wsavd 4) Kopr;
      if %found;
        uprt4 = kopnvn;
        upt4  = kopty;
      endif;
    Chain ('P':Wsavd 19) Kopr;
      if %found;
        uprt19 = kopnvn;
        upt19  = kopty;
      endif;
    Chain ('P':Wsavd 24) Kopr;
      if %found;
        uprt24 = kopnvn;
        upt24  = kopty;
      endif;
    Chain ('P':Wsavd 73) Kopr;
      if %found;
        uprt73 = kopnvn;
        upt73  = kopty;
      endif;
  endif;
endif;
     //____________
     // Fyll ut UDS
     //""""""""""""
uavd   = wsavd;
usg    = wssg;
upro   = wspro;
uopd   = wsopd;
ufbnr  = *zeros;
ugn    = wgn;
uprt0  = wsprt;
uprt1  = wsprt;
uprt2  = wsprt;
uprt3  = wsprt;
uprt4  = wsprt;
uprt5  = wsprt;
uprt6  = wsprt;
uprt7  = wsprt;
uprt11 = wsprt;
uprt12 = wsprt;
uprt13 = wsprt;
uprt14 = wsprt;
uprt19 = wsprt;
uprt24 = wsprt;
uprt73 = wsprt;
uprt8  = wsprt2;
uprt9  = wsprt2;
uprt10 = wsprt2;
uprt67 = wsprt2;
uprt57 = wsprt2;
  if uprt0 = *blanks;
    uprt0 = 'QPRINT';
  endif;
  if upt0 = *blanks;
    upt0 = '*STD';
  endif;
  if uprt1 = *blanks;
    uprt1 = 'QPRINT';
  endif;
  if upt1 = *blanks;
    upt1 = '*STD';
  endif;
  if uprt2 = *blanks;
    uprt2 = 'QPRINT';
  endif;
  if upt2 = *blanks;
    upt2 = '*STD';
  endif;
  if uprt3 = *blanks;
    uprt3 = 'QPRINT';
  endif;
  if upt3 = *blanks;
    upt3 = '*STD';
  endif;
  if uprt4 = *blanks;
    uprt4 = 'QPRINT';
  endif;
  if upt4 = *blanks;
    upt4 = '*STD';
  endif;
  if uprt5 = *blanks;
    uprt5 = 'QPRINT';
  endif;
  if upt5 = *blanks;
    upt5 = '*STD';
  endif;
  if uprt6 = *blanks;
    uprt6 = 'QPRINT';
  endif;
  if upt6 = *blanks;
    upt6 = '*STD';
  endif;
  if uprt7 = *blanks;
    uprt7 = 'QPRINT';
  endif;
  if upt7 = *blanks;
    upt7 = '*STD';
  endif;
  if uprt8 = *blanks;
    uprt8 = 'QPRINT';
  endif;
  if upt8 = *blanks;
    upt8 = '*STD';
  endif;
  if uprt9 = *blanks;
    uprt9 = 'QPRINT';
  endif;
  if upt9 = *blanks;
    upt9 = '*STD';
  endif;
  if uprt10 = *blanks;
    uprt10 = 'QPRINT';
  endif;
  if upt10 = *blanks;
    upt10 = '*STD';
  endif;
  if uprt11 = *blanks;
    uprt11 = 'QPRINT';
  endif;
  if upt11 = *blanks;
    upt11 = '*STD';
  endif;
  if uprt12 = *blanks;
    uprt12 = 'QPRINT';
  endif;
  if upt12 = *blanks;
    upt12 = '*STD';
  endif;
  if uprt13 = *blanks;
    uprt13 = 'QPRINT';
  endif;
  if upt13 = *blanks;
    upt13 = '*STD';
  endif;
  if uprt14 = *blanks;
    uprt14 = 'QPRINT';
  endif;
  if upt14 = *blanks;
    upt14 = '*STD';
  endif;
  if uprt19 = *blanks;
    uprt19 = 'QPRINT';
  endif;
  if upt19 = *blanks;
    upt19 = '*STD';
  endif;
  if uprt57 = *blanks;
    uprt57 = 'QPRINT';
  endif;
  if upt57 = *blanks;
    upt57 = '*STD';
  endif;
  if uprt67 = *blanks;
    uprt67 = 'QPRINT';
  endif;
  if upt67 = *blanks;
    upt67 = '*STD';
  endif;
  if uprt73 = *blanks;
    uprt73 = 'QPRINT';
  endif;
  if upt73 = *blanks;
    upt73 = '*STD';
  endif;
read firm;
*inlr=*on;
