      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT MANIFEST (VISE B/L OG OPPD.) ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-49 51-93 95-99                ***
      ***********************************************************
      *
     FBILLOFL3  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF3L)
     FBILLOFL4  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF4L)
     FBILLOFL9  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOF9L)
     D                 DS
     D  XDTÅ                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  LSH                    1     25
     D                                     DIM(5)
     D  LSH2                   1     25
     D                 DS
     D  LOH                    1     50
     D                                     DIM(10)
     D  LOH2                   1     50
      *
     C                   EXSR      INIT
      *
     C                   EXSR      FHAVN1
     C                   EXSR      FHAVN2
     C                   EXSR      FHAVN3
      *
     C                   MOVE      LSH2          ULSH
     C                   MOVE      LOH2          ULOH
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     FHAVN1        BEGSR
     C***********************************************
      *--------------------------------------------------------
      * FINN HAVN VIA BLLSH OG BLVH MED AVGANGSDATO OG LOKALBÅT
      *--------------------------------------------------------
     C     BILLLK        SETLL     BILLOFL4
     C     BILLLK        READE     BILLOFL4                               94
     C     *IN94         DOWEQ     '0'
     C     BLST          IFNE      ' '
     C     BLST          ANDNE     'P'
     C     BLST          ANDNE     'X'
     C                   GOTO      STFH11
     C                   END
     C     BLLSH         CABEQ     *BLANKS       STFH11
     C     BLVH          CABEQ     *BLANKS       STFH11
     C   50UREIS         CABNE     BLREIS        STFH11
      *
     C     ULSH          IFEQ      *BLANKS
      * TEST MOT LOSSEHAVN HVIS DET ER OPPGITT
     C     ULOH          IFNE      *BLANKS
     C     1             DO        10            XN
     C     LOH(XN)       IFNE      *BLANKS
     C     LOH(XN)       CABEQ     BLVH          STFH13
     C                   END
     C                   ENDDO
     C                   GOTO      STFH11
     C     STFH13        TAG
     C                   END
      *
     C     1             DO        5             XN                3 0
     C                   SELECT
     C     LSH(XN)       WHENEQ    *BLANKS
     C                   MOVE      BLLSH         LSH(XN)
     C                   GOTO      STFH12
     C     LSH(XN)       WHENEQ    BLLSH
     C                   GOTO      STFH12
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     STFH12        TAG
     C     ULOH          IFEQ      *BLANKS
      * TEST MOT LASTEHAVN HVIS DET ER OPPGITT
     C     ULSH          IFNE      *BLANKS
     C     1             DO        5             XN
     C     LSH(XN)       IFNE      *BLANKS
     C     LSH(XN)       CABEQ     BLLSH         STFH14
     C                   END
     C                   ENDDO
     C                   GOTO      STFH11
     C     STFH14        TAG
     C                   END
      *
     C     1             DO        10            XN
     C                   SELECT
     C     LOH(XN)       WHENEQ    *BLANKS
     C                   MOVE      BLVH          LOH(XN)
     C                   GOTO      STFH11
     C     LOH(XN)       WHENEQ    BLVH
     C                   GOTO      STFH11
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     STFH11        TAG
     C     BILLLK        READE     BILLOFL4                               94
     C  N94              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     FHAVN2        BEGSR
     C***********************************************
      *-----------------------------------------------------------
      * FINN HAVN VIA BLLSH OG BLLOH MED AVGANGSDATO OG OVERSJØBÅT
      * OG VIA-HAVN = BLANK
      *-----------------------------------------------------------
     C     BILLLK        SETLL     BILLOFL3
     C     BILLLK        READE     BILLOFL3                               94
     C     *IN94         DOWEQ     '0'
     C     BLST          IFNE      ' '
     C     BLST          ANDNE     'P'
     C     BLST          ANDNE     'X'
     C                   GOTO      STFH21
     C                   END
     C     BLVH          CABNE     *BLANKS       STFH21
     C     BLLSH         CABEQ     *BLANKS       STFH21
     C     BLLOH         CABEQ     *BLANKS       STFH21
     C   50UREIS         CABNE     BLREIS        STFH21
      *
     C     ULSH          IFEQ      *BLANKS
      * TEST MOT LOSSEHAVN HVIS DET ER OPPGITT
     C     ULOH          IFNE      *BLANKS
     C     1             DO        10            XN
     C     LOH(XN)       IFNE      *BLANKS
     C     LOH(XN)       CABEQ     BLLOH         STFH23
     C                   END
     C                   ENDDO
     C                   GOTO      STFH21
     C     STFH23        TAG
     C                   END
      *
     C     1             DO        5             XN                3 0
     C                   SELECT
     C     LSH(XN)       WHENEQ    *BLANKS
     C                   MOVE      BLLSH         LSH(XN)
     C                   GOTO      STFH22
     C     LSH(XN)       WHENEQ    BLLSH
     C                   GOTO      STFH22
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     STFH22        TAG
     C     ULOH          IFEQ      *BLANKS
      * TEST MOT LASTEHAVN HVIS DET ER OPPGITT
     C     ULSH          IFNE      *BLANKS
     C     1             DO        5             XN
     C     LSH(XN)       IFNE      *BLANKS
     C     LSH(XN)       CABEQ     BLLSH         STFH24
     C                   END
     C                   ENDDO
     C                   GOTO      STFH21
     C     STFH24        TAG
     C                   END
      *
     C     1             DO        10            XN
     C                   SELECT
     C     LOH(XN)       WHENEQ    *BLANKS
     C                   MOVE      BLLOH         LOH(XN)
     C                   GOTO      STFH21
     C     LOH(XN)       WHENEQ    BLLOH
     C                   GOTO      STFH21
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     STFH21        TAG
     C     BILLLK        READE     BILLOFL3                               94
     C  N94              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     FHAVN3        BEGSR
     C***********************************************
      *-----------------------------------------------------------
      * FINN HAVN VIA BLVH OG BLLOH MED VIA-HAVNDATO OG OVERSJØBÅT
      *-----------------------------------------------------------
     C     BILLLK        SETLL     BILLOFL9
     C     BILLLK        READE     BILLOFL9                               94
     C     *IN94         DOWEQ     '0'
     C     BLST          IFNE      ' '
     C     BLST          ANDNE     'P'
     C     BLST          ANDNE     'X'
     C                   GOTO      STFH31
     C                   END
     C     BLVH          CABEQ     *BLANKS       STFH31
     C     BLLOH         CABEQ     *BLANKS       STFH31
     C   50UREIS         CABNE     BLREIS        STFH31
      *
     C     ULSH          IFEQ      *BLANKS
      * TEST MOT LOSSEHAVN HVIS DET ER OPPGITT
     C     ULOH          IFNE      *BLANKS
     C     1             DO        10            XN
     C     LOH(XN)       IFNE      *BLANKS
     C     LOH(XN)       CABEQ     BLLOH         STFH33
     C                   END
     C                   ENDDO
     C                   GOTO      STFH31
     C     STFH33        TAG
     C                   END
      *
     C     1             DO        5             XN                3 0
     C                   SELECT
     C     LSH(XN)       WHENEQ    *BLANKS
     C                   MOVE      BLVH          LSH(XN)
     C                   GOTO      STFH32
     C     LSH(XN)       WHENEQ    BLVH
     C                   GOTO      STFH32
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     STFH32        TAG
     C     ULOH          IFEQ      *BLANKS
      * TEST MOT LASTEHAVN HVIS DET ER OPPGITT
     C     ULSH          IFNE      *BLANKS
     C     1             DO        5             XN
     C     LSH(XN)       IFNE      *BLANKS
     C     LSH(XN)       CABEQ     BLVH          STFH34
     C                   END
     C                   ENDDO
     C                   GOTO      STFH31
     C     STFH34        TAG
     C                   END
      *
     C     1             DO        10            XN
     C                   SELECT
     C     LOH(XN)       WHENEQ    *BLANKS
     C                   MOVE      BLLOH         LOH(XN)
     C                   GOTO      STFH31
     C     LOH(XN)       WHENEQ    BLLOH
     C                   GOTO      STFH31
     C                   ENDSL
     C                   ENDDO
     C                   END
      *
     C     STFH31        TAG
     C     BILLLK        READE     BILLOFL9                               94
     C  N94              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BILLLK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UBK
     C                   KFLD                    XDT
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UBK               5
     C                   PARM                    UREIS            14
     C                   PARM                    UDT               6 0
     C                   PARM                    ULSH             25
     C                   PARM                    ULOH             50
      *
     C                   MOVE      ULSH          LSH2
     C                   MOVE      ULOH          LOH2
     C     UREIS         COMP      *BLANKS                            5050
     C                   MOVEL     UDT           XMMDD             4 0
     C                   MOVEL     XMMDD         UDT1              2 0
     C                   MOVE      XMMDD         UDT2              2 0
     C                   MOVE      UDT           UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
      *
     C                   MOVE      UDT1          XDTD
     C                   MOVE      UDT2          XDTM
     C     UDT3          IFGT      50
     C     UDT3          ADD       1900          XDTÅ
     C                   ELSE
     C     UDT3          ADD       2000          XDTÅ
     C                   END
      *
     C                   ENDSR
     C*
