      *********************************************************************
      * PROGRAM BEHANDLER INPUT FRA SS001 OG VISER ORDRE
CRTPG+*  CRTPGM SYSPED/SS002 MODULE(*LIBL/SS002
CRTPGM*        *LIBL/CHECKUSR *LIBL/INCGI) ACTGRP(CGI) AUT(*USE)
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 LES POST I WRKCGI MED KEY
10XXX * 02 YBC PTF10 VISE RETUR/STRATEGISK KODE
10XXX * 03 YBC PTF10 EXCEL/CSV-download
10XXX * 04 YBC PTF10 KUN SPØR PÅ BEGRENSET BÅTKODER
10XXX * 05 YBC PTF10 VIS ORST=3 SOM PÅ LAGER OG ONWAY
10XXX * 06 YBC PTF10 DELE STATUS I FLERE KATAGORI
10XXX * 07 YBC PTF10 VIS Y ELLER N FOR FARLIG GOODS
10XXX * 08 SH  PTF10 hvis HEGN ikke er utfyllt ta AWBNO fra frisok
10XXX * 09 SH  PTF10 hvise dokument på subfilen
10XXX * 10 SH  PTF10 for liten baatarray pdfarray
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 11 YBC PTF12 Glemte å sette USROPN på en del filer
12XXX * 12 YBC PTF12 Søk båt via alle kunder i kundegruppe
********************************************************************
      *
      *********************************************************************
      * MAIN PROGRAM FLOW
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
     FFRISOK    IF   E           K DISK    USROPN
     FBATGR     IF   E           K DISK    USROPN
     FGSSORF    IF   E           K DISK    USROPN
     FGSSORL12  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORFR12)
     FGSSORL13  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORFR13)
     FGSSORL16  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORFR16)
     FGSSPOF    IF   E           K DISK    USROPN
     FGSSPOl01  IF   E           K DISK    USROPN
     F                                     RENAME(GSSPOFR:GSSPOFR01)
     FGSSPOL02  IF   E           K DISK    USROPN
     F                                     RENAME(GSSPOFR:GSSPOF02)
     FGSSPAF    IF   E           K DISK    USROPN
     FGSSRFF    IF   E           K DISK    USROPN
     FGSSTRF    IF   E           K DISK    USROPN
N07  FGSSDGF    IF   E           K DISK    USROPN
N07  FGSSFGF    IF   E           K DISK    USROPN
N12  FGSSCGF    IF   E           K DISK    USROPN
N12  FGSSCGL02  IF   E           K DISK    USROPN
N12  F                                     RENAME(GSSCGFR:GSSCRFR2)
     FWRKCGI    UF a E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FCDBOAT    IF   E           K DISK    USROPN
     FKOFAST    IF   E           K DISK    USROPN
     FFIRM      IF   E           K DISK    USROPN
     FBRPARF    IF   E           k disk    usropn
     FBRIDF     UF   E           K DISK    USROPN
E11  FARKIVL11  IF   E           K DISK    USROPN
E11  FARKEXT    IF   E           K DISK    USROPN
E11  FARKTXT    IF   E           K DISK    USROPN
E11  FFIRMARC   IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Prototype defintions and standard system API error structure
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      *--------------------------------------------------------------------
      * Variables common to CGI programs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,variables3
      *--------------------------------------------------------------------
      * Variables received from the input string
      * for bakgrunnsfarge
     D OddEven         s             10
     D wsboagr         s              7
     D lng             s              2
     D BckGnd          s             10
     D UsrSpcName      s             10
     D WSUSER          S             10
     D WSNA            S             30
     D WSKDB           S              5
     D WSSTD           S              5
     D WSST            S              1
     D WSST_I          S              1
     D W2ST            S             30
     D WSCON           S             20
     D WSVEN           S             20    varying
     D WSCONT          S             20
     D WSCONT2         S             20
     D WSONO           S              7
     D WSTNO           S             11
     D RDATF           S             10
     D RDATFN          S              8  0
     D RDATT           S             10
     D RDATTN          S              8  0
     D SDATF           S             10
     D SDATFN          S              8  0
     D SDATT           S             10
     D SDATTN          S              8  0
     D TXTCOL          S             10
N12  D KG              S              8  0 DIM(50)
     D lstbrd          s              1
     D WINT            s              6
     D GrpNr           s              8
     D PGM             C                   CONST('SYSPED/CHECKUSR')
     D IfsMultIndicators...
     d                 ds
     D  NoErrors                       n
     D  NameTooLong                    n
     D  NotAccessible                  n
     D  NoFilesUsable                  n
     D  DupSections                    n
     D  FileIsEmpty                    n
      * Variables received from the input string
      * and converted to numeric
     D zeros           s             15a   inz('000000000000000')
     D NIER            s             20A   INZ('99999999999999999999')
     D l1              s              3s 0
     D l2              s              3s 0
      * Number of records matching search criteria
     DRecordCnt        s              5S 0
      *
     D Lib             s             10
     D Fn              s             10
     D Mbr             s             10
      *
     D ItemCount       s             10i 0
     D i               s             10i 0
     D Spaces          s             12a   inz('&nbsp;&nbsp;')
     D                 DS
     D  ORTNO                  1     11  0
     D  HEAVD                  1      4  0
     D  HEOPD                  5     11  0
     D                 DS
     D  HEGN                   1     15
     D  HEGN04                 1      4
     D  HEGN03                 5      7
     D  HEGN08                 8     15
     D  HEGN515                5     15
     D                 DS
     D  PAVRDA                 1     50
     D  PAVRDA01               6     15
     D                 DS
     D  DataDs                 1    220
     D  POCONO                 1     20
     D  ORLC                  25     29
     D  ORSNM                 31     60
     D  ORDTL                 63     70  0
     D  ORSTAT                72    101
     D  ORCLI                103    107  0
     D  ORWT                 111    117  1
N04  D                 DS
s10  D* BCD                    1     50    DIM(10)
s10  D* BCD50                  1     50
s10  D  BCD                    1    500    DIM(100)
s10  D  BCD500                 1    500
N09  D                 DS
s20  D* updf                   1   4000    DIM(20)
s20  D* updfall                1   4000
N10  D                 DS
N10  D  updf1                  1    200
N10  D  updf2                201    400
N10  D  updf3                401    600
N10  D  updf4                601    800
N10  D  updf5                801   1000
N10  D  updf6               1001   1200
N10  D  updf7               1201   1400
N10  D  updf8               1401   1600
N10  D  updf9               1601   1800
N10  D  updf10              1801   2000
N10  D  updf11              2001   2200
N10  D  updf12              2201   2400
N10  D  updf13              2401   2600
N10  D  updf14              2601   2800
N10  D  updf15              2801   3000
N10  D  updf16              3001   3200
N10  D  updf17              3201   3400
N10  D  updf18              3401   3600
N10  D  updf19              3601   3800
N10  D  updf20              3801   4000
N10  D  updf21              4001   4200
N10  D  updf22              4201   4400
N10  D  updf23              4401   4600
N10  D  updf24              4601   4800
N10  D  updf25              4801   5000
N10  D  updf26              5001   5200
N10  D  updf27              5201   5400
N10  D  updf28              5401   5600
N10  D  updf29              5601   5800
N10  D  updf30              5801   6000
N10  D  updf31              6001   6200
N10  D  updf32              6201   6400
N10  D  updf33              6401   6600
N10  D  updf34              6601   6800
N10  D  updf35              6801   7000
N10  D  updf36              7001   7200
N10  D  updf37              7201   7400
N10  D  updf38              7401   7600
N10  D  updf39              7601   7800
N10  D  updf40              7801   8000
N10  D  updf                   1   8000    DIM(40)
N09  D                 DS
N09  D  ATString               1    192
N09  D  ATString1              1     48
N09  D  ATString2             49     96
N09  D  ATString3             97    144
N09  D  ATString4            145    192
N09  D  AT                     1    192    DIM(64)
N09  D                 DS
N09  D  A2                     1    128    DIM(64)
      *--------------------------------------------------------------------
      * Prolog common to CGI programs
      * -Receive input from the remote browser
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prolog3
      *=====================================================================******
      * MAIN PROCESS LINE
      *=====================================================================******
      * Get program start time for calculating execution time
     C                   time                    timedata1
      * Parse input
     C                   exsr      Parse
      *
     C                   EXSR      INIT
     C                   CALLB     PGM
     C                   PARM                    BIBRID
     C                   PARM                    UsrSpcName
     C                   PARM                    UINN              1
     C                   IF        UINN = 'N'
     C                   GOTO      SLUTT
     C                   END
     C     WSUSER        CHAIN     BRIDF                              50
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           BIDTF
     C                   MOVE      WTM           BITIDF
     C                   UPDATE    BRIDFR
     c     wsboagr       ifne      *blanks
     c                   exsr      chgusr
     c                   end
      * Set output skeleton html member name
     C                   exsr      SetSkl
     C                   callp     gethtml(fn:lib:mbr:'/CGITAG/')
      * Retrieve environment variables
     C                   exsr      RtvEnvVar
      *------------------                                                   ******
      * Write HTML sections
      *
      * 1-Section /$top
     C                   exsr      SetTop
     C                   callp     wrtsection('top')
      * 3-Section /$tablestr
     C                   exsr      SetTabStr
     C                   callp     updHTMLvar('ROWHEAD':RowHead)
     C                   callp     wrtsection('tablestr')
      * 4-Sections /$tablerow
     C                   SELECT
      *
      * søk container
      *
     C                   WHEN      WSCON <> *BLANKS
     c                   exsr      setllpo
     C     STRLES01      TAG
     c                   exsr      lespo
      *
     C  N50POONO         CHAIN     GSSORF                               50
     C  N50              IF        WSKDB = 'ALL'
     C     ORCNO         CABNE     BIKUNR        STRLES01
     C                   ELSE
     C     ORBCD         CABNE     WSKDB         STRLES01
     C                   END
     C  N50WSSTD         IFNE      'ALL'
     C     ORLC          CABNE     WSSTD         STRLES01
     C                   END
      *
     C                   WHEN      ((XAGENT = 'J') AND (WSKDB = 'ALL'))
     C     WSSTD         SETLL     GSSORL16
     C     WSSTD         READE     GSSORL16                               50
      *
      * alle båter
      *
     C                   WHEN      WSKDB = 'ALL'
N12  C                   MOVE      *ZEROS        KG
N12  C     BIKUNR        CHAIN     GSSCGF                             33
N12  C                   IF        *IN33
N12  C                   EVAL      KG(1) = BIKUNR
N12  C                   ELSE
N12  C     CGCG          SETLL     GSSCGL02
N12  C     CGCG          READE     GSSCGL02                               33
N12  C                   MOVE      *ZEROS        XN                3 0
N12  C                   DOW       *IN33
N12  C                   ADD       1             XN
N12  C                   EVAL      KG(XN) = CGCNO
N12  C     CGCG          READE     GSSCGL02                               33
N12  C                   ENDDO
N12  C                   END
S12  C*    BIKUNR        SETLL     GSSORL13
N12  C                   Z-ADD     1             XN
N12  C     KG(XN)        SETLL     GSSORL13
     C     STRLES011     TAG
S12  C*    BIKUNR        READE     GSSORL13                               50
N12  C     KG(XN)        READE     GSSORL13                               50
     C  N50              IF        WSSTD <> 'ALL'
     C     ORLC          CABNE     WSSTD         STRLES011
     C                   END
N12  C   50              ADD       1             XN
N12  C   50              IF        KG(XN) <> 0
N12  C     KG(XN)        SETLL     GSSORL13
N12  C                   GOTO      STRLES011
N12  C                   END
      *
      * WSVEN ne ALL
      *
     C                   WHEN      WSSTD <> 'ALL'
     C     GSSOR12K      SETLL     GSSORL12
     C     GSSOR12K      READE     GSSORL12                               50
     C                   OTHER
     C     WSKDB         SETLL     GSSORL12
     C     WSKDB         READE     GSSORL12                               50
     C                   ENDSL
      *
      *  START HOVEDLØKKE
      *
     C     *IN50         DOWEQ     '0'
      * TEST STATUS
     C     ORST          CABEQ     'D'           LESNESTE
s10  C*                  IF        BCD50 <> *BLANKS
n10  C                   IF        BCD500 <> *BLANKS
s10  C*    1             DO        10            XN                3 0
n10  C     1             DO        100           XN                3 0
N04  C                   SELECT
N04  C                   WHEN      BCD(XN) = *BLANKS
N04  C                   GOTO      LESNESTE
N04  C                   WHEN      ((BCD(XN) = ORBCD) AND (BIKUNR = ORCNO))
N04  C                   LEAVE
N04  C                   ENDSL
N04  C                   ENDDO
N04  C                   END
      * TEST leverandør
     C     wsven         ifne      *blanks
     C     wsven         SCAN      ORSNM                                  34
     c     *IN34         CaBEQ     *OFF          LESNESTE
     c                   end
     C     wsboagr       IFNE      *BLANKS
     C     XAGENT        ANDNE     'J'
     C     BATGRKEY      CHAIN     BATGR                              34
     C   34              GOTO      LESNESTE
     C                   END
      * Rec dato fra/til
     C     RDATFN        IFNE      *ZEROS
     C     ORDTL         ANDLT     RDATFN
     C                   GOTO      LESNESTE
     C                   END
     C     RDATTN        IFNE      *ZEROS
     C     ORDTL         ANDGT     RDATTN
     C                   GOTO      LESNESTE
     C                   END
      *
      * wsst = 0 eller A
      *
     C                   SELECT
     C                   WHEN      ((WSST = '0') OR                             IN STOCK
     C                              (WSST = 'A'))                               IN STOCK (PARTIAL)
     C     ORST          CABLT     '0'           LESNESTE
S05  C*    ORST          CABGT     '2'           LESNESTE
N05  C     ORST          CABGT     '3'           LESNESTE
     C                   WHEN      WSST = 'B'                                   SHIPPED
S05  C*    ORST          CABLT     '2'           LESNESTE
N05  C     ORST          CABLT     '4'           LESNESTE
     C                   WHEN      WSST = 'C'                                   KUN IN WORK
     C     ORST          CABLT     '1'           LESNESTE
     C     ORST          CABGT     '2'           LESNESTE
     C                   WHEN      WSST = 'P'                                   PRE-REGISTRATIONS
     C     ORST          CABNE     'P'           LESNESTE
     C                   ENDSL
      * HENT ORDRE
     C                   IF        WSCON = *BLANKS
     C     ORONO         SETLL     GSSPOF
     C     ORONO         READE     GSSPOF                                 33
     C   33              GOTO      LESNESTE
     C                   END
      * TEST DELLEVERING
     C     ORONO         CHAIN     GSSPAF                             33
     C                   IF        *IN33
     C                   MOVE      'C'           PAPKD
     C                   MOVE      *BLANKS       PATXT1
     C                   MOVE      *BLANKS       PATXT2
     C                   MOVE      *BLANKS       PATXT3
     C                   MOVE      *BLANKS       PATXT4
     C                   MOVE      *BLANKS       PATXT5
     C                   END
     C                   IF        WSST = 'A'
     C     PAPKD         CABEQ     'C'           LESNESTE
     C                   END
      *
     C     ORTNO         CHAIN     GSSTRF                             33
     C   33              MOVE      *ZEROS        TRDTS
      * SHI dato fra/til
     C     SDATFN        IFNE      *ZEROS
     C     TRDTS         ANDLT     SDATFN
     C                   GOTO      LESNESTE
     C                   END
     C     SDATTN        IFNE      *ZEROS
     C     TRDTS         ANDGT     SDATTN
     C                   GOTO      LESNESTE
     C                   END
     C     HEADFK        CHAIN     HEADF                              33
     C   33              MOVE      *BLANKS       HEGN
     C   33              MOVE      *BLANKS       HEDTMO
     C   33              MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       FSSOK
     C  N33FRIKEY        CHAIN     FRISOK                             34
      *
     C     wsboagr       IFNE      *BLANKS
     C     XAGENT        ANDNE     'J'
     C     BATGRKEY      CHAIN     BATGR                              34
     C   34              GOTO      LESNESTE
     C                   END
      *
     C                   exsr      SetTabRow
N09  C                   EXSR      HENTDOK
     C                   callp     wrtsection('tablerow')
     C                   IF        FITDVI = 'J'
     C                   callp     wrtsection('tabrow2')
     C                   ELSE
     C                   callp     wrtsection('tabrow1')
     C                   END
     C                   callp     wrtsection('tabrow3')
      *
     C     LESNESTE      TAG
     C                   SELECT
     C                   WHEN      WSCON <> *BLANKS
     C     STRLES02      TAG
     c                   exsr      lespo
     C  N50POONO         CHAIN     GSSORF                               50
     C  N50              IF        WSKDB = 'ALL'
     C     ORCNO         CABNE     BIKUNR        STRLES02
     C                   ELSE
     C     ORBCD         CABNE     WSKDB         STRLES02
     C                   END
     C     wsboagr       IFNE      *BLANKS
     C     XAGENT        ANDNE     'J'
     C     BATGRKEY      CHAIN     BATGR                                34
     C   34              GOTO      STRLES02
     C                   END
     C  N50WSSTD         IFNE      'ALL'
     C     ORLC          CABNE     WSSTD         STRLES02
     C                   END
      *
     C                   WHEN      ((XAGENT = 'J') AND (WSKDB = 'ALL'))
     C     WSSTD         READE     GSSORL16                               50
      *
      * kdb = ALL
      *
     C                   WHEN      WSKDB = 'ALL'
     C     STRLES021     TAG
S12  C*    BIKUNR        READE     GSSORL13                               50
N12  C     KG(XN)        READE     GSSORL13                               50
     C  N50              IF        WSSTD <> 'ALL'
     C     ORLC          CABNE     WSSTD         STRLES021
     C                   END
N12  C   50              ADD       1             XN
N12  C   50              IF        KG(XN) <> 0
N12  C     KG(XN)        SETLL     GSSORL13
N12  C                   GOTO      STRLES021
N12  C                   END
      *
      * WSSTD = ALL
      *
     C                   WHEN      WSSTD <> 'ALL'
     C     GSSOR12K      READE     GSSORL12                               50
     C                   OTHER
     C     WSKDB         READE     GSSORL12                               50
     C                   ENDSL
     C  N50              ENDDO
      *
      * 5-Section /$tableend
     C                   callp     wrtsection('tableend')
      *
      * 6-Section /$endhtml
     C     endhtml       tag
     C                   exsr      SetEnd
     C     SLUTT         tag
     C                   callp     wrtsection('endhtml')
      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
     C                   EXSR      EXIT
     C                   return
      *=====================================================================******
      * Parse input
      *=====================================================================******
     C     Parse         begsr
     C                   eval      wsboagr   = zhbgetvar('wsboagr')
     C                   eval      wsboagr = uppify(wsboagr)
     C                   MOVE      'N'           XFEIL             1
     C                   eval      lng     = zhbgetvar('lng')
     C                   eval      BckGnd  = zhbgetvar('bckgnd')
     C                   eval      lstbrd  = zhbgetvar('lstbrd')
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   eval      WINTEG  = c2n2(WINT)
     C                   IF        WINTEG  = 0
     C                   eval      WINTEG   = random(1:999999)
     C                   MOVE      WINTEG        WINT
     C                   END
     C                   EVAL      UsrSpcName  = zhbgetvar('UsrSpcName')
     C                   EVAL      WSNA    = zhbgetvar('WSNA')
     C                   EVAL      WSKDB   = zhbgetvar('WSKDB')
     C                   EVAL      WSSTD   = zhbgetvar('WSSTD')
     C                   EVAL      WSST    = zhbgetvar('WSST')
     C                   EVAL      WSST_I  = zhbgetvar('WSST')
     C                   EVAL      WSCON   = zhbgetvar('WSCON')
     C                   EVAL      WSCON   = uppify(WSCON)
     C                   EVAL      WSVEN   = zhbgetvar('WSVEN')
     C                   EVAL      WSVEN   = uppify(WSVEN)
     C                   EVAL      WSCONT  = WSCON
     C                   IF        WSCON <> *BLANKS
     C                   EVAL      WSST = '*'
     C                   END
     C                   CAT       NIER:0        WSCONT
     C                   eval      RDATF   = zhbgetvar('RDATF')
     C                   eval      RDATFN  = c2n2(RDATF)
     C                   eval      RDATT   = zhbgetvar('RDATT')
     C                   eval      RDATTN  = c2n2(RDATT)
     C                   eval      SDATF   = zhbgetvar('SDATF')
     C                   eval      SDATFN  = c2n2(SDATF)
     C                   eval      SDATT   = zhbgetvar('SDATT')
     C                   eval      SDATTN  = c2n2(SDATT)
      *
     C                   endsr
      *=====================================================================******
      *  Set output variables for section /$top
      *  (search criteria)
      *=====================================================================******
     C     SetTop        begsr
      * Repeat national language for the next invocation
     C                   callp     updhtmlvar('LNG':lng:
     C                             InitHTMLVars)
     C                   callp     updHtmlVar('wsboagr':wsboagr)
      * Color for text, background, links, visited links, active links
     C                   callp     updhtmlvar('TXTCOLOR':'black')
     C                   callp     updhtmlvar('BOLD':' ')
     C                   callp     updhtmlvar('BGCOLOR':BIFARG)
     C                   callp     updhtmlvar('LINK':'0000FF')
     C                   callp     updhtmlvar('VLINK':'FF0000')
     C                   callp     updhtmlvar('ALINK':'00FF00')
BODY C                   callp     updhtmlvar('BODYCLASS':'class='+BIFARG)
OddEvC                   callp     updHTMLvar('LogoImg':LogoImg)
     C                   callp     updhtmlvar('USER':WSUSER)
     C                   callp     updhtmlvar('WSNA':WSNA)
     C                   callp     updhtmlvar('KUNDE':
     C                             %trim(%editc(BIKUNR:'Z')))
     C                   callp     updhtmlvar('WINT':WINT)
     C                   callp     updHtmlVar('UsrSpcName':UsrSpcName)
     C                   callp     updHTMLvar('sdato':
     C                             %trim(%editw(BIDTV:'    .  .  ')))
     C                   callp     updHTMLvar('stid':
     C                             %trim(%editw(BITIDV:'  .  .  ')))
     C                   IF        WSCON <> *BLANKS
     C                   callp     updhtmlvar('WSKDB':'ALL')
     C                   callp     updhtmlvar('WSNAB':' ')
     C                   ELSE
     C                   callp     updhtmlvar('WSKDB':WSKDB)
     C                   callp     updhtmlvar('WSNAB':CBNAB)
     C                   END
     C                   callp     updhtmlvar('WSSTD':WSSTD)
     C                   callp     updhtmlvar('WSST':WSST_I)
     C                   callp     updhtmlvar('WSCON':WSCON)
     C                   callp     updhtmlvar('WSVEN':WSVEN)
     C     RDATFN        Ifeq      *Zeros
     C                   callp     updHTMLvar('RDATF':' ')
     c                   else
     C                   callp     updHTMLvar('RDATF':
     C                             %trim(%editw(RDATFN:'    .  .  ')))
     c                   end
     C     RDATTN        Ifeq      *Zeros
     C                   callp     updHTMLvar('RDATT':' ')
     c                   else
     C                   callp     updHTMLvar('RDATT':
     C                             %trim(%editw(RDATTN:'    .  .  ')))
     c                   end
     C     SDATFN        Ifeq      *Zeros
     C                   callp     updHTMLvar('SDATF':' ')
     c                   else
     C                   callp     updHTMLvar('SDATF':
     C                             %trim(%editw(SDATFN:'    .  .  ')))
     c                   end
     C     SDATTN        Ifeq      *Zeros
     C                   callp     updHTMLvar('SDATT':' ')
     c                   else
     C                   callp     updHTMLvar('SDATT':
     C                             %trim(%editw(SDATTN:'    .  .  ')))
     c                   end
     C                   SELECT
     C                   WHEN      WSST = '*'
     C                   EVAL      W2ST = 'ALL'
     C                   WHEN      WSST = '0'
     C                   EVAL      W2ST = 'ON STOCK'
     C                   WHEN      WSST = 'A'
     C                   EVAL      W2ST = 'ON STOCK (PARTIAL)'
     C                   WHEN      WSST = 'B'
     C                   EVAL      W2ST = 'SHIPPED'
     C                   WHEN      WSST = 'B'
     C                   EVAL      W2ST = 'IN WORK ONLY'
     C                   WHEN      WSST = 'P'
     C                   EVAL      W2ST = 'PRE-REGISTRATIONS'
     C                   END
     C                   callp     updhtmlvar('W2ST':W2ST)
      * Kun oppdatering av PICK, Fix i WRKCGI for senere visning av liste
     C                   EXSR      OPDWCGI
     C                   move      *blanks       PickHead        100
     C                   move      *blanks       PickList        100
     C     PickOK        Ifeq      'Y'
     C     WSKDB         Andne     'ALL'
     C     WSSTD         Andne     'ALL'
      * Pick-buton som kolonnheader, (trykk på den = oppdater pick/unpick)
     C                   eval      PickHead='<INPUT TYPE="SUBMIT" '+
     C                             'VALUE="Pick">'
      * Sjekk om det finne plukkede på denne båten - vis  button for å lage liste
     C                   EXSR      TSTWCGI
     C                   end
     C                   callp     updHTMLvar('PickHead':PickHead)
     C                   callp     updHTMLvar('PickList':PickList)
     C                   callp     updHTMLvar('KEY2':XBCDLC)
      *
     C                   callp     updhtmlvar('RFREFHOD':RFREFHOD)
N03  C                   callp     updhtmlvar('RFREFH2':RFREFH2)
      *
     C                   endsr
      *=====================================================================******
      *  Set output variables for section /$tablestr (table start)
      *=====================================================================******
     C     SetTabStr     begsr
     C     lstbrd        ifeq      'Y'
     C                   callp     updhtmlvar('LB':'0')
     C                   else
     C                   callp     updhtmlvar('LB':'1')
     C                   endif
      *
     C                   endsr
      *=====================================================================******
      *  Set output variables for section /$tablerow (table row)
      *=====================================================================******
     C     SetTabRow     begsr
     C     HEADFK        CHAIN     HEADF                              33
     C   33              MOVE      *BLANKS       HEGN
     C   33              MOVE      *BLANKS       HEDTMO
     C   33              MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       FSSOK
     C  N33FRIKEY        CHAIN     FRISOK                             34
     c     OddEven       IFEQ      ODD
     c                   eval      OddEven = EVEN
     c                   else
     c                   eval      OddEven = ODD
     c                   end
     C                   callp     updHTMLvar('ODDEVEN':OddEven)
SXX  C*                  callp     updhtmlvar('ORONO':
SXX  C*                            %trim(%editc(ORONO:'Z')))
     C                   MOVE      ORONO         WSONO
NXX  C                   callp     updhtmlvar('ORONO':WSONO)
     C                   callp     updhtmlvar('WSONO':WSONO)
N07  C     ORONO         CHAIN     GSSDGF                             33
N07  C   33ORONO         CHAIN     GSSFGF                             33
N07  C   33              callp     updhtmlvar('WSDG':'N')
N07  C  N33              callp     updhtmlvar('WSDG':'Y')
     C                   callp     updhtmlvar('POCONO':POCONO)
     C                   if        WSCON <> *BLANKS
     c                   clear                   w1cono          360
     c                   movel     pocono        w1cono
N03  c                   clear                   w1cono2         360
N03  c                   movel     pocono        w1cono2
     c                   else
     C                   exsr      hentpo
     c                   end
     C     ORBCD         CHAIN     CDBOAT                             33
     C                   callp     updhtmlvar('WSNAB2':CBNAB)
N02  C                   callp     updhtmlvar('ORRTNG':ORRTNG)
     C                   callp     updhtmlvar('w1CONO':w1CONO)
N03  C                   callp     updhtmlvar('w1CONO2':w1CONO2)
     C                   callp     updhtmlvar('ORBCD':ORBCD)
     C                   callp     updhtmlvar('ORLC':ORLC)
      *
     C                   IF        XXUTREF <> *BLANKS
     C     ORONO         SETLL     GSSRFF
     C     ORONO         READE     GSSRFF                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        RFKD  = XXUTREF
     C                   LEAVE
     C                   END
     C     ORONO         READE     GSSRFF                                 33
     C                   ENDDO
     C   33              MOVE      *BLANKS       RFREF
     C*                  EVAL      RFREFDET = '<td>'
     C*                  CAT       RFREF:0       RFREFDET
     C*                  CAT       '</td>':0     RFREFDET
     C                   EVAL      RFREFDET = RFREF
N03  C                   EVAL      RFREFD2  = RFREF
     C                   END
     C                   callp     updhtmlvar('RFREFDET':RFREFDET)
N03  C                   callp     updhtmlvar('RFREFD2':RFREFD2)
      *
     C                   MOVE      *BLANKS       ORSTAT           30
     C                   SELECT
     C                   WHEN      ORST = 'P'
N06  C                   SELECT
N06  c                   WHEN      ORRTNG = 'S'
N06  C                   EVAL      ORSTAT = 'PRE-REG/DO NOT SEND'
N06  c                   WHEN      ORRTNG = 'R'
N06  C                   EVAL      ORSTAT = 'PRE-REG / RETURN'
N06  C                   OTHER
     C                   EVAL      ORSTAT = 'PRE-REGISTRATIONS'
N06  C                   ENDSL
     C                   EVAL      TXTCOL = 'DEEPGREEN'
     C                   WHEN      ((ORST = '0') AND (PAPKD = 'C'))
N06  C                   SELECT
N06  c                   WHEN      ORRTNG = 'S'
N06  C                   EVAL      ORSTAT = 'IN STOCK/DO NOT SEND'
N06  c                   WHEN      ORRTNG = 'R'
N06  C                   EVAL      ORSTAT = 'IN STOCK/RETURN'
N06  c                   OTHER
     C                   EVAL      ORSTAT = 'IN STOCK'
N06  C                   ENDSL
     C                   EVAL      TXTCOL = 'BLACK'
     C                   WHEN      ((ORST = '0') AND (PAPKD = 'P'))
     C                   EVAL      ORSTAT = 'IN STOCK (PARTIAL)'
     C                   EVAL      TXTCOL = 'BLACK'
     C                   WHEN      ((ORST = '0') AND (PAPKD = ' '))
     C                   EVAL      ORSTAT = 'IN STOCK (PARTIAL, NOT COMPL.)'
     C                   EVAL      TXTCOL = 'PINK'
     C                   WHEN      ((ORST = '1') OR (ORST = '2'))
     C                   IF        PAPKD = 'C'
     C                   EVAL      ORSTAT = 'IN WORK'
     C                   EVAL      TXTCOL = 'GREEN'
     C                   ELSE
     C                   EVAL      ORSTAT = 'IN WORK (PARTIAL)'
     C                   EVAL      TXTCOL = 'RED'
     C                   END
      * delivered ved status 6
     C                   When      ((ORST = '6') AND (HEDTMO <> '        '))
     C                   IF        PAPKD = 'C'
     C                   EVAL      ORSTAT = 'DELIVERED'
     C     ORSTAT        CAT       hedtmo:1      ORSTAT
     C     ORSTAT        CAT       'To:':1       ORSTAT
     C     ORSTAT        CAT       hesgm:1       ORSTAT
     C                   EVAL      TXTCOL = 'LILAC'
     C                   ELSE
     C                   EVAL      ORSTAT = 'DELIVERED (PARTIAL)'
     C     ORSTAT        CAT       hedtmo:1      ORSTAT
     C     ORSTAT        CAT       'To:':1       ORSTAT
     C     ORSTAT        CAT       hesgm:1       ORSTAT
     C                   EVAL      TXTCOL = 'YELLOW'
     C                   END
N05  C                   WHEN      ORST = '3'
N05  C                   IF        PAPKD = 'C'
N05  C                   EVAL      ORSTAT = 'ONWAY'
N05  C                   EVAL      TXTCOL = 'LILAC'
N05  C                   ELSE
N05  C                   EVAL      ORSTAT = 'ONWAY (PARTIAL)'
N05  C                   EVAL      TXTCOL = 'YELLOW'
N05  C                   END
     C                   WHEN      ORST > '2'
     C                   IF        PAPKD = 'C'
     C                   EVAL      ORSTAT = 'SHIPPED'
     C                   EVAL      TXTCOL = 'LILAC'
     C                   ELSE
     C                   EVAL      ORSTAT = 'SHIPPED (PARTIAL)'
     C                   EVAL      TXTCOL = 'YELLOW'
     C                   END
     C                   ENDSL
     C                   callp     updhtmlvar('TXTCOL':TXTCOL)
     C                   callp     updhtmlvar('ORSTAT':ORSTAT)
     C                   IF        ORDTL = 0
     C                   callp     updhtmlvar('ORDTL':
     C                             %trim(%editW(ORDTWL:'    .  .  ')))
     C                   ELSE
     C                   callp     updhtmlvar('ORDTL':
     C                             %trim(%editW(ORDTL:'    .  .  ')))
     C                   END
     C                   callp     updhtmlvar('ORCLI':
     C                             %trim(%editc(ORCLI:'Z')))
     C                   callp     updhtmlvar('ORWT':
     C                             %trim(%editc(ORWT:'4')))
     C                   callp     updhtmlvar('ORSNM':ORSNM)
     C                   callp     updhtmlvar('ORTNO':
     C                             %trim(%editc(ORTNO:'Z')))
     C                   MOVE      ORTNO         WSTNO
     C                   callp     updhtmlvar('WSTNO':WSTNO)
     C                   callp     updhtmlvar('ORCURC':ORCURC)
     C                   callp     updhtmlvar('ORAMT':
     C                             %trim(%editc(ORAMT:'4')))
     C                   callp     updhtmlvar('TRDTS':
     C                             %trim(%editW(TRDTS:'    .  .  ')))
     C     HEGN515       IFEQ      '00000000000'
     C                   MOVE      *BLANKS       HEGN
     C                   end
     C                   IF        HEGN04 = *BLANKS
     C                   MOVE      *BLANKS       KFKOD
     C                   MOVEL     HEGN03        KFKOD
     C     KOFASTK       CHAIN     KOFAST                             33
     C   33KOFASTK2      CHAIN     KOFAST                             33
     C                   MOVE      *BLANKS       XTXT            200
     C                   MOVE      KFTXTE        XTXTA             1
     C                   MOVE      ' '           KFTXTE
     C                   MOVEL     KFTXT         XTXT
     C                   CAT       KFTXTE:0      XTXT
     C                   MOVEL     HEGN03        KFKOD1
     C     KOFASTK1      CHAIN     KOFAST                             33
     C                   IF        *IN33 = *OFF
     C                   MOVE      KFTXTE        XTXTA             1
     C                   MOVE      ' '           KFTXTE
     C                   CAT       KFTXT:0       XTXT
     C                   CAT       KFTXTE:0      XTXT
     C                   ENDIF
     C                   IF        XTXTA = 'A'
     C                   CAT       HEGN08:0      XTXT
     C                   ENDIF
     C                   ELSE
     C     KOFASTK2      CHAIN     KOFAST                             33
     C                   MOVE      *BLANKS       XTXT
     C                   MOVEL     KFTXT         XTXT
     C                   ENDIF
s08  C*                  callp     updhtmlvar('HEGN':HEGN)
     C                   callp     updhtmlvar('FSSOK':FSSOK)
N08  C     HEGN515       ifeq      '00000000000'
N08  C                   MOVE      'AWB'         FSKODE
N08  c     frikey        chain     frisok                             33
N08  C  N33              MOVEL     FSSOK         HEGN
N08  C                   MOVE      'ORD'         FSKODE
N08  C                   END
n08  C                   callp     updhtmlvar('HEGN':HEGN)
     C                   callp     updhtmlvar('TRACKING':XTXT)
      * Plukke ordre til liste...
     C                   move      *blanks       PickDet         100
     C     PickOK        IFEQ      'Y'
     C     WSKDB         Andne     'ALL'
     C     WSSTD         Andne     'ALL'
     C                   MOVE      WSONO         WSONOA            7
     C                   EVAL      PickDet='<input type="checkbox" '+
     C                             'name="WSONOA" value="'+WSONOA+'">&nbsp;'
      *
     C                   Movel     ORBCD         XBCDLC           10
     C                   Move      ORLC          XBCDLC
     C                   eval      WKEY2    =    XBCDLC
     C                   MOVE      ORONO         WKEY2
     c     WCgiKey       Chain     WRKCGI                             33
     C     *in33         ifeq      *ON
     C                   EVAL      PickDet=%trim(PickDet)+'<b> </b>'
     C                   else
     C                   EVAL      PickDet=%trim(PickDet)+'<b>X</b>'
     C                   Movel     DataDs        WData
     C                   update    WRKCGIR
     C                   end
     C                   end
     C                   callp     updHTMLvar('PickDet':PickDet)
      *
     C                   endsr
      *=====================================================================******
      *  Set output variables for section /$foundsome (some Recds were found)
      *=====================================================================******
     C     SetFndSome    begsr
      * Repeat background color
     C                   callp     updhtmlvar('BCKGND':bckgnd)
      *
     C                   endsr
      *=====================================================================******
      *  Set output variables for section /$endhtml
      *=====================================================================******
     C     SetEnd        begsr
      * Server protocol
     C                   callp     updhtmlvar('PROTOCOL':S_Protocol)
      * Compute run time
     C                   time                    timedata2
     C     timedata2     subdur    timedata1     ms:*ms
     C                   eval      sec = ms / 1000000
     C                   callp     updhtmlvar('runtime':
     C                             %trim(%editw(sec:'     0 .   ')))
      *
     C                   endsr
      *=====================================================================******
      * Set html output skeleton member before its read into memory
      *=====================================================================******
     C     SetSkl        begsr
      *------------------
      * Set html output skeleton member
     C                   eval      lng = uppify(lng)
      * "HTMLSRC  " er dft = NORSK, ved å trykke på FLAGGET i inng.
      * kan dette endre stil "HTMLSRCXX" avh. av støttede språk
cccccC                   eval      IfsMultIndicators = gethtmlifsmult(
cccccC                             '/syspeddev/html/Header/eSpedTop.html -
cccccC                             /syspeddev/html/SS002.html -
cccccC                             /syspeddev/html/Footer/eSpedBot.html':
cccccC                             '/CGITAG/')
      *------------------
     C                   endsr
      *=====================================================================******
      *  Retrieve environment variables
      *=====================================================================******
     C     RtvEnvVar     begsr
      * Use getenvp to get this server's protocol and name
     C                   eval      S_Protocol =getenv('SERVER_PROTOCOL':
     C                             qusec)
     C                   eval      S_Name     =getenv('SERVER_NAME':
     C                             qusec)
      *
     C                   endsr
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
     C                   OPEN      BRIDF
     C     WSUSER        CHAIN(N)  BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   CALLB     'INCGI'
     C                   PARM                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
     C                   open      BATGR                                50
     C                   open      GSSORF                               50
     C                   open      GSSORL12                             50
     C                   open      GSSORL13                             50
     C                   open      GSSORL16                             50
     C                   open      GSSPOF                               50
     C                   open      GSSPOL01                             50
     C                   open      GSSPOL02                             50
     C                   open      GSSPAF                               50
     C                   open      GSSTRF                               50
     C                   open      GSSRFF                               50
N07  C                   open      GSSDGF                               50
N07  C                   open      GSSFGF                               50
N12  C                   open      GSSCGF                               50
N12  C                   open      GSSCGL02                             50
     C                   open      WRKCGI
     C                   open      FIRM
     C                   open      HEADF
     C                   open      FRISOK
     C                   OPEN      CDBOAT
     C                   OPEN      KOFAST
     C                   OPEN      BRPARF
N09  C                   open      ARKIVL11                             50
N09  C                   open      ARKTXT                               50
N09  C                   open      ARKEXT                               50
N09  C                   open      FIRMARC                              50
      *
      *
OddEv * hent Parametre som går igjen i mange prog:
OddEv *      Odd/Even/Rowhead-farger,Logobilde,Språk,Intern/Ekstern bru
OddEvc                   call      'ESGETPAR'
OddEvc                   parm                    BIBRID
OddEvc                   parm                    BIFIRM
OddEvc                   parm                    BIKUNR
OddEvc                   parm                    BIKNG
OddEvc                   parm                    RowHead          10
OddEvc                   parm                    Odd              10
OddEvc                   parm                    Even             10
OddEvc                   parm                    LogoImg          50
OddEvc                   parm                    XSPRÅK            2
OddEvc                   parm                    XINTERN           1
OddEvc                   parm                    ParmDS1        1024
OddEvc                   parm                    ParmDS2        1024
OddEvc                   parm                    ParmDS3        1024
     c                   move      odd           odd9              9
     c                   move      even          even9             9
     c                   move      rowhead       rowhead9          9
     c                   move      *blanks       odd
     c                   move      *blanks       even
     c                   move      *blanks       rowhead
     c                   movel     odd9          odd
     c                   movel     even9         even
     c                   movel     rowhead9      rowhead
     c     wsboagr       ifne      *blanks
     c                   exsr      chgusr
     c                   end
      *
     C     BATGRKEY      klist
     C                   kfld                    wsboagr
     C                   kfld                    ORBCD
     C     BATGRKE2      klist
     C                   kfld                    wsboagr
     C     GSSOR12K      klist
     C                   kfld                    WSKDB
     C                   kfld                    WSSTD
     C     WCgiKey       klist
     C                   kfld                    WINTEG
     C                   kfld                    WKEY2
     C     HEADFK        klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C     FRIKEY        klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C                   kfld                    FSKODE
     C                   MOVE      'ORD'         FSKODE
     C     KOFASTK       klist
     C                   kfld                    KFTYP
     C                   kfld                    KFKOD
     C                   MOVEL     'WEBETRACK'   KFTYP
     C     KOFASTK1      klist
     C                   kfld                    KFTYP
     C                   kfld                    KFKOD1            5
     C                   MOVEL     '   **'       KFKOD1
     C     KOFASTK2      klist
     C                   kfld                    KFTYP
     C                   kfld                    KFKOD2            5
     C                   MOVEL     'OTHER'       KFKOD2
     C     BrParKey      klist
     C                   kfld                    PABRID
     C                   kfld                    PAKUNR
     C                   kfld                    PAID
     C                   MOVE      BIBRID        PABRID
     C                   MOVE      *zeros        PAKUNR
     C                   MOVE      'SSPLM'       PAID
     C     BrParKey      CHAIN     BRPARF                             33
     c  N33              move      'Y'           PickOK            1
      *
     C                   MOVE      'SSREF'       PAID
     C     BrParKey      CHAIN     BRPARF                             33
     C  N33              MOVEL     PAVRDA        XXUTREF           5
     C   33              MOVE      *BLANKS       XXUTREF
     C                   IF        XXUTREF = *BLANKS
     C                   MOVE      *BLANKS       RFREFHOD         45
N03  C                   MOVE      *BLANKS       RFREFH2          45
     C                   ELSE
     C                   IF        PAVRDA01 = *BLANKS
     C                   EVAL      PAVRDA01 = 'Reference'
     C                   END
     C                   EVAL      RFREFHOD = '<td align=left>'
     C                   CAT       PAVRDA01:0    RFREFHOD
     C                   CAT       '</td>':0     RFREFHOD
N03  C                   EVAL      RFREFH2  = PAVRDA
     C                   END
     C                   MOVE      *BLANKS       RFREFDET         45
N03  C                   MOVE      *BLANKS       RFREFD2          45
      *
     C                   MOVE      'SSAGT'       PAID
     C     BrParKey      CHAIN     BRPARF                             33
     C  N33              MOVE      'J'           XAGENT            1
N01   *
N01  C                   MOVE      'SSBCD'       PAID
N01  C     BrParKey      CHAIN(N)  BRPARF                             33
s10  C* N33              MOVEL     PAVRDA        BCD50
s10  C*  33              MOVEL     *BLANKS       BCD50
n10  C  N33              MOVEL     PAVRDA        BCD500
n10  C   33              MOVEL     *BLANKS       BCD500
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     WSKDB         CHAIN     CDBOAT                             33
      *
N09  C     ARKEXTK       KLIST
n09  C                   KFLD                    FIFIRM
n09  C                   KFLD                    ARCEXT
n09  C     ARKIVL11K     KLIST
n09  C                   KFLD                    ARSTAT
n09  C                   KFLD                    ARUNDE
n09  C                   MOVE      'A'           ARSTAT
n09  C                   EVAL      ARUNDE = 'SS:'
      *
     C                   endsr
      *
      *=====================================================================******
     C     OPDWCGI       begsr
      * Checkbox ticked = legg til om den ikke finnes / fjern om den finnes
     C                   eval      ItemCount = ZhbGetVarCnt('WSONOA')
     C                   eval      i = 1
     C     i             DOWLE     ItemCount
     C                   eval      WSONOA  = ZhbGetVar('WSONOA':i)
     C                   Movel     WSKDB         XBCDLC           10
     C                   Move      WSSTD         XBCDLC
     C                   eval      WKEY2    =    XBCDLC
     C                   MOVE      WSONOA        WKEY2
     C     WCgiKey       CHAIN     WRKCGI                             33
     C   33              Write     WRKCGIR
     C  N33              Delete    WRKCGIR
     C                   eval      i = i +1
     C                   ENDDO
     C
     C                   endsr
      *=====================================================================******
     C     TSTWCGI       begsr
      * Finnes valgte poster for denne båten/lokasjonen
     C                   Movel     WSKDB         XBCDLC           10
     C                   Move      WSSTD         XBCDLC
     C                   eval      WKEY2    =    XBCDLC
     C     WCgiKey       setll     WRKCGI
S01  C*                  Read      WRKCGI                                 33
N01  C     WINTEG        READE     WRKCGI                                 33
     C                   Movel     wkey2         Wkey2_10         10
     C     *in33         Ifeq      *OFF
     c     XBCDLC        andeq     WKEY2_10
     C                   eval      PickList='<INPUT TYPE="BUTTON" ' +
     C                                      'VALUE="Print/send Pick List" '+
     C                                      'onClick="GoToPlist()">'
     C                   END
     C
     C                   endsr
      *=====================================================================******
      *  AVSLUTT
      *=====================================================================******
     C     EXIT          begsr
     C                   close     BRIDF
     C                   close     BATGR
     C                   close     GSSORF
     C                   close     GSSORL12
     C                   close     GSSORL13
     C                   close     GSSORL16
     C                   close     GSSPOF
     C                   close     GSSPOL01
     C                   close     GSSPOL02
     C                   close     GSSPAF
     C                   close     GSSTRF
     C                   close     GSSRFF
N07  C                   close     GSSDGF
N07  C                   close     GSSFGF
N12  C                   close     GSSCGF
N12  C                   close     GSSCGL02
     C                   close     WRKCGI
     C                   close     FIRM
     C                   close     HEADF
     C                   close     FRISOK
     C                   close     CDBOAT
     C                   close     KOFAST
     C                   close     BRPARF
N09  C                   close     ARKIVL11
N09  C                   close     ARKTXT
N09  C                   close     ARKEXT
N09  C                   close     FIRMARC
     C                   eval      *inlr = *on
      *
     C                   endsr
      *=====================================================================******
     C     hentpo        begsr
      *
     c                   setoff                                       51
     c                   clear                   w1cono
N03  c                   clear                   w1cono2
     C     ORONO         SETLL     GSSPOF
     C     ORONO         READE     GSSPOF                                 51
     c                   movel     pocono        w1cono
N03  c                   movel     pocono        w1cono2
     C                   if        WSCON = *BLANKS
     c     *IN51         DOWEQ     '0'
     C     ORONO         READE     GSSPOF                                 51
     C  n51w1cono        CAT       '<br>':0      w1cono
     C  n51w1cono        CAT       pocono:0      w1cono
N03  C  n51              CAT       ',':0         w1cono2
N03  C  n51              CAT       pocono:0      w1cono2
     c  n51              enddo
     c                   endif
     c                   endsr
      ****************************************************************************
     C     setllpo       begsr
      ****************************************************************************
      *
     c                   CALL      'GSS051R'
     c                   parm                    wscon
     c                   parm                    wsco2            20
     C                   EVAL      WSCONT2 = WSCO2
     C                   CAT       NIER:0        WSCONT2
      *
      * leser i fil1 eller 2 avhengig om søkebegrep finnes direkte
      *
     c                   setoff                                       33
     c     wscon         setll     gsspol01
     c*
     c     lesnypo       tag
     C     WSCON         reade     gsspol01                               33
     C  N33POONO         CHAIN     GSSORF                             33
     C  N33              IF        WSKDB = 'ALL'
     C     ORCNO         CABNE     BIKUNR        lesnypo
     C                   ELSE
     C     ORBCD         CABNE     WSKDB         lesnypo
     C                   END
     c                   move      'N'           podir             1
     c  N33              move      'J'           podir             1
     C     WSCON         SETLL     GSSPOL01
     C     WSCO2         SETLL     GSSPOL02
     C                   endsr
      ****************************************************************************
     C     lespo         begsr
      ****************************************************************************
     c     podir         ifeq      'J'
     C                   READ      GSSPOL01                               50
     C  N50WSCONT        COMP      POCONO                               50
     c                   else
     C                   READ      GSSPOL02                               50
     C  N50WSCONT2       COMP      POCON2                               50
     c                   end
     c                   endsr
      *
      ****************************************************************************
     C     chgusr        begsr
      ****************************************************************************
      *bytter evenbtuelt bikunr **************************************************
      *
     C                   IF        XAGENT <> 'J'
     C     BATGRKE2      CHAIN     BATGR                              34
     c     *in(34)       ifne      '1'
     c                   z-add     bakunr        bikunr
     c                   end
     C                   END
     c                   endsr
      ***********************************************
N09  C     genbane       BEGSR
N09   ***********************************************
N09  C     ARTYPE        CHAIN     ARKTXT                             33
N09  C     ARKLAG        IFNE      *blanks
N09  C                   MOVE      ARKLAG        ARCEXT
N09  C     ARKEXTK       CHAIN     ARKEXT                             33
N09  C                   ELSE
N09  C     FIFIRM        CHAIN     FIRMARC                            33
N09  C                   END
N09   * genererer bane for lagring
N09  C                   movel     '<a href="'   UPDF(XN)
N09  C                   CAT       '/':0         UPDF(XN)
N09  C                   CAT       ARCANE:0      UPDF(XN)
N09  C                   CAT       '/':0         UPDF(XN)
N09  C                   CAT       ARLINK:0      UPDF(XN)
N09  C                   CAT       '" target="':0UPDF(XN)
N09  C                   CAT       'SyPDFWind': 0UPDF(XN)
N09  C                   CAT       '">':0        UPDF(XN)
N09  C                   IF        ARRFK = *BLANKS
N09  C                   CAT       'DOC':0       UPDF(XN)
N09  C                   MOVE      XN            XAN               3
N09  C                   CAT       XAN:0         UPDF(XN)
N09  C                   ELSE
N09  C                   CAT       ARRFK:0       UPDF(XN)
N09  C                   END
N09  C                   CAT       '<img src="':0UPDF(XN)
N09  C                   CAT       '/syspeddev':0UPDF(XN)
N09  C                   CAT       '/PDF.gif"':0 UPDF(XN)
N09  C                   CAT       'ALT="':1     UPDF(XN)
N09  C                   CAT       artxt:0       UPDF(XN)
N09  C                   CAT       '"></a>':0    UPDF(XN)
N09   *
N09  C                   ENDSR
N09   *
N09   ***********************************************
N09  C     HENTDOK       BEGSR
N09   ***********************************************
n09  C                   MOVE      ORONO         ARUNDE
N09   * Vis kun dokumeter bruker er autorisert for å se...
N09  C                   move      *blanks       ATString
N09  C                   MOVE      'ARKTY'       PAID
N09  C     BrParKey      chain     BRPARF                             33
N09  C                   IF        *IN33
N09  C                   MOVE      'ZO'          A2(1)
N09  C                   ELSE
N09  C                   movel     Pavrda        ATstring1
N09  C     BrParKey      READE     BRPARF                                 33
N09  C  N33              movel     Pavrda        ATstring2
N09  C  N33BrParKey      READE     BRPARF                                 33
N09  C  N33              movel     Pavrda        ATstring3
N09  C  N33BrParKey      READE     BRPARF                                 33
N09  C  N33              movel     Pavrda        ATstring4
N09  C     1             DO        64            ln                2 0
N09  C                   movea     AT(ln)        A2(ln)
N09  C                   ENDDO
N09  C                   END
N09   *
N09  C                   Z-ADD     1             XN                3 0
N09  C                   MOVEA     *BLANKS       UPDF
N09  C     ARKIVL11K     SETLL     ARKIVL11
N09  C     ARKIVL11K     READE     ARKIVL11                               33
N09  C                   DOW       *IN33 = *OFF
N09  C     artype        lookup    A2                                     33
N09  C                   IF        *IN33
N09  C                   ADD       1             XN
N09  C                   EXSR      GENBANE
N09  C                   END
N09  C     ARKIVL11K     READE     ARKIVL11                               33
N10  C  N33XN            comp      40                                     33
N09  C                   ENDDO
N09   *
s10  C*                  callp     updHTMLvar('W1UPDF':UPDFall)
n10  C                   callp     updHTMLvar('UPDF1':UPDF1)
n10  C                   callp     updHTMLvar('UPDF2':UPDF2)
n10  C                   callp     updHTMLvar('UPDF3':UPDF3)
n10  C                   callp     updHTMLvar('UPDF4':UPDF4)
n10  C                   callp     updHTMLvar('UPDF5':UPDF5)
n10  C                   callp     updHTMLvar('UPDF6':UPDF6)
n10  C                   callp     updHTMLvar('UPDF7':UPDF7)
n10  C                   callp     updHTMLvar('UPDF8':UPDF8)
n10  C                   callp     updHTMLvar('UPDF9':UPDF9)
n10  C                   callp     updHTMLvar('UPDF10':UPDF10)
 10  C                   callp     updHTMLvar('UPDF11':UPDF11)
n10  C                   callp     updHTMLvar('UPDF12':UPDF12)
n10  C                   callp     updHTMLvar('UPDF13':UPDF13)
n10  C                   callp     updHTMLvar('UPDF14':UPDF14)
n10  C                   callp     updHTMLvar('UPDF15':UPDF15)
n10  C                   callp     updHTMLvar('UPDF16':UPDF16)
n10  C                   callp     updHTMLvar('UPDF17':UPDF17)
n10  C                   callp     updHTMLvar('UPDF18':UPDF18)
n10  C                   callp     updHTMLvar('UPDF19':UPDF19)
n10  C                   callp     updHTMLvar('UPDF20':UPDF20)
n10  C                   callp     updHTMLvar('UPDF21':UPDF21)
n10  C                   callp     updHTMLvar('UPDF22':UPDF22)
n10  C                   callp     updHTMLvar('UPDF23':UPDF23)
n10  C                   callp     updHTMLvar('UPDF24':UPDF24)
n10  C                   callp     updHTMLvar('UPDF25':UPDF25)
n10  C                   callp     updHTMLvar('UPDF26':UPDF26)
n10  C                   callp     updHTMLvar('UPDF27':UPDF27)
n10  C                   callp     updHTMLvar('UPDF28':UPDF28)
n10  C                   callp     updHTMLvar('UPDF29':UPDF29)
n10  C                   callp     updHTMLvar('UPDF30':UPDF30)
n10  C                   callp     updHTMLvar('UPDF31':UPDF31)
n10  C                   callp     updHTMLvar('UPDF32':UPDF32)
n10  C                   callp     updHTMLvar('UPDF33':UPDF33)
n10  C                   callp     updHTMLvar('UPDF34':UPDF34)
n10  C                   callp     updHTMLvar('UPDF35':UPDF35)
n10  C                   callp     updHTMLvar('UPDF36':UPDF36)
n10  C                   callp     updHTMLvar('UPDF37':UPDF37)
n10  C                   callp     updHTMLvar('UPDF38':UPDF38)
n10  C                   callp     updHTMLvar('UPDF39':UPDF39)
n10  C                   callp     updHTMLvar('UPDF40':UPDF40)
N09   *
N09  C                   ENDSR
N09   *
