********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10003 * 01 YBC PTF10 KLARGJØR TIL EKSTERN REFERANSE
********************************************************************
      ************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE PRINTERSTYRING NCTS        ***
      ************************************************************
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FDKTKD     IF   E           K DISK
     FKODTS4    IF   E           K DISK
     FEDII      IF   E           K DISK
     FDKXSTD    UF A E           K DISK
     FDKXKODL01 IF   E           K DISK
     FDKXSTDFV  UF A E           K DISK
     FDKXGH     IF   E           K DISK
     FDKXGD     IF   E           K DISK
     FDKTVK     IF   E           K DISK
     FDKXTB     IF   E           K DISK
     FDKX003D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  THDTÅ                  1      4  0
     D  THDTM                  5      6  0
     D  THDTD                  7      8  0
     D  THDT                   1      8  0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
     C                   IF        MODE = 'E'
     C                   MOVE      UAVD          WSAAVD
     C                   GOTO      STARTB
     C                   END
      *
     C     START         TAG
     C                   EXFMT     DK003D01
     C   03              GOTO      SLUTT
     C     STARTB        TAG
     C     KODTAK        CHAIN     KODTA                              99
     C   99              GOTO      START
     C                   EXSR      HENT
      *
     C     START2        TAG
     C                   EXFMT     DK003D02
     C                   MOVEA     '0000000'     *IN(93)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      *
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     10            POSNBR
     C     START3        TAG
     C                   EXFMT     DK003D03
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '000000000000'*IN(76)
     C                   MOVEA     '000000000000'*IN(64)
     C                   MOVE      '0'           *IN(63)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START3
     C                   END
     C   12              GOTO      START2
      *
     C                   EXSR      TESTB3
     C   30              GOTO      START3
     C                   EXSR      OPDSVS
      *
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     13            POSNBR
     C     START4        TAG
     C                   EXFMT     DK003D04
     C                   MOVEA     '000000000000'*IN(89)
     C                   MOVEA     '00000000000' *IN(78)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA4
     C                   GOTO      START4
     C                   END
     C   12              GOTO      START3
      *
     C                   EXSR      TESTB4
     C   30              GOTO      START4
     C                   EXSR      OPDSVSFV
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C     WSAAVD        CHAIN(N)  DKXSTD                             60
     C     *IN60         IFEQ      '1'
     C                   EXSR      MOVEB
     C                   EXSR      MOVEBFV
     C                   ELSE
     C                   EXSR      MOVEW
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSNTTD        IFEQ      0
     C                   Z-ADD     1             WSNTTD
     C                   END
     C     WSNTLL        IFEQ      0
     C                   Z-ADD     1             WSNTLL
     C                   END
     C     WSFMLL        IFNE      'N'
     C                   MOVE      'J'           WSFMLL
     C                   END
      *
     C     WSTDN         COMP      0                                    9898
     C   98
     CANN30              MOVE      'SPT0023'     MSGNR
     C   98              SETON                                        30
      *
     C     W0004         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN95
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
      *
     C     W0010         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN94
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
     C     WSDK          IFNE      *BLANKS
     C                   MOVE      '031'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDK          YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          99
     C   99              MOVE      'DKX0809'     MSGNR
     C   99              SETON                                        30
     C                   END
      *
     C     WSKNS         IFNE      0
     C                   MOVE      WSKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            98
     C     *IN98         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSADS1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNS
     C                   MOVEL     POSTNR        WSPNS
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNS
     C                   END
     C                   MOVE      ADR3          WSPSS
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKS
     C                   END
     C                   IF        WSTINS = *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTINS = 'SE' + SYFORE
     C                   ELSE
     C                   EVAL      WSTINS = SYLAND + SYFORE
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINS = EORI
     C                   ENDSL
     C                   END
     C                   END
     C                   END
      *
     C*    WSALK         IFNE      *BLANKS
     C*                  MOVEL     WSALK         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              97
     C*  97
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  97              SETON                                        30
     C*                  END
      *
     C*    WSBLK         IFNE      *BLANKS
     C*                  MOVEL     WSBLK         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              96
     C*  96
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  96              SETON                                        30
     C*                  END
      *
     C*    WSLKS         IFNE      *BLANKS
     C*                  MOVEL     WSLKS         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              95
     C*  95
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  95              SETON                                        30
     C*                  END
      *
     C     WSSKS         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKS         YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          94
     C   94
     CANN30              MOVE      'DKX0810'     MSGNR
     C   94              SETON                                        30
     C                   END
      *
     C     WSKNK         IFNE      0
     C                   MOVE      WSKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            93
     C     *IN93         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSADK1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNK
     C                   MOVEL     POSTNR        WSPNK
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNK
     C                   END
     C                   MOVE      ADR3          WSPSK
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKK
     C                   END
     C                   IF        WSTINK = *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTINK = 'SE' + SYFORE
     C                   ELSE
     C                   EVAL      WSTINK = SYLAND + SYFORE
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINK = EORI
     C                   ENDSL
     C                   END
     C                   END
     C                   END
      *
     C*    WSTALK        IFNE      *BLANKS
     C*                  MOVEL     WSTALK        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              92
     C*  92
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  92              SETON                                        30
     C*                  END
      *
     C     WSTASK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTASK        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          91
     C   91
     CANN30              MOVE      'DKX0810'     MSGNR
     C   91              SETON                                        30
     C                   END
      *
     C*    WSTGLK        IFNE      *BLANKS
     C*                  MOVEL     WSTGLK        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              90
     C*  90
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  90              SETON                                        30
     C*                  END
      *
     C     WSTGSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTGSK        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          89
     C   89
     CANN30              MOVE      'DKX0810'     MSGNR
     C   89              SETON                                        30
     C                   END
      *
     C*    WSLKK         IFNE      *BLANKS
     C*                  MOVEL     WSLKK         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              88
     C*  88
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  88              SETON                                        30
     C*                  END
      *
     C     WSSKK         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKK         YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          87
     C   87
     CANN30              MOVE      'DKX0810'     MSGNR
     C   87              SETON                                        30
     C                   END
      *
     C     WSTRMI        IFNE      0
     C     KODS4KI       CHAIN     KODTS4                             63
     C   63
     CANN30              MOVE      'SPT0030'     MSGNR
     C   63              SETON                                        30
     C                   END
      *
     C     WSTRM         IFNE      0
     C     KODS4K        CHAIN     KODTS4                             86
     C   86
     CANN30              MOVE      'SPT0030'     MSGNR
     C   86              SETON                                        30
     C                   END
      *
     C     WSKNA         IFNE      0
     C                   MOVE      WSKNA         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            85
     C     *IN85         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSADA1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNA
     C                   MOVEL     POSTNR        WSPNA
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNA
     C                   END
     C                   MOVE      ADR3          WSPSA
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKA
     C                   END
     C                   IF        WSTINA = *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTINA = 'SE' + SYFORE
     C                   ELSE
     C                   EVAL      WSTINA = SYLAND + SYFORE
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINA = EORI
     C                   ENDSL
     C                   END
     C                   END
     C                   END
      *
     C     WSNPNS        CHAIN     DKXTB                              64
     C  N30              IF        *IN64
     C                   MOVE      'DKX1934'     MSGNR
     C                   SETON                                        30
     C                   END
      *
     C*    WSLKA         IFNE      *BLANKS
     C*                  MOVEL     WSLKA         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              84
     C*  84
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  84              SETON                                        30
     C*                  END
      *
     C*    WSSKA         IFNE      *BLANKS
     C*                  MOVE      '012'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSSKA         YKODE
     C*    DKXK01K       CHAIN     DKXKODL01                          83
     C*  83
     C*NN30              MOVE      'DKX0810'     MSGNR
     C*  83              SETON                                        30
     C*                  END
      *
     C     WSCATS        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSCATS        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          82
     C   82
     CANN30              MOVE      'DKX0810'     MSGNR
     C   82              SETON                                        30
     C                   END
      *
     C     WSTSD1        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD1        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          81
     C   81
     CANN30              MOVE      'DKX0810'     MSGNR
     C   81              SETON                                        30
     C                   END
      *
     C     WSTSD2        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD2        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          80
     C   80
     CANN30              MOVE      'DKX0810'     MSGNR
     C   80              SETON                                        30
     C                   END
      *
     C     WSTSD3        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD3        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   79
     CANN30              MOVE      'DKX0810'     MSGNR
     C   79              SETON                                        30
     C                   END
      *
     C     WSTSD4        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD4        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   78
     CANN30              MOVE      'DKX0810'     MSGNR
     C   78              SETON                                        30
     C                   END
      *
     C     WSTSD5        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD5        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   77
     CANN30              MOVE      'DKX0810'     MSGNR
     C   77              SETON                                        30
     C                   END
      *
     C     WSTSD6        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD6        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   76
     CANN30              MOVE      'DKX0810'     MSGNR
     C   76              SETON                                        30
     C                   END
      *
     C     WSTSD7        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD7        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   75
     CANN30              MOVE      'DKX0810'     MSGNR
     C   75              SETON                                        30
     C                   END
      *
     C     WSTSD8        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD8        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   74
     CANN30              MOVE      'DKX0810'     MSGNR
     C   74              SETON                                        30
     C                   END
      *
     C                   IF        WSGFT1 <> *BLANKS
     C                   IF        ((WSGKD <= 1) OR (WSGKD >= 6))
     C*    WSGFT1        CHAIN     DKXGH                              67
     C*                  IF        *IN67
     C*  67              MOVE      'DKX1900'     MSGNR
     C*                  SETON                                        30
     C*                  ELSE
     C*                  MOVE      TGGTY         WSGKD
     C*                  MOVE      TGGVK         WSGVK
     C*                  END
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        TGGBL
     C                   END
      *
     C     WSGADK        IFNE      *BLANKS
     C                   IF        ((WSGKD <= 1) OR (WSGKD >= 6))
     C                   IF        WSGFT1 = *BLANKS
     C*                  MOVE      '105'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSGADK        YKODE
     C*    DKXK01K       CHAIN     DKXKODL01                          79
     C                   ELSE
     C*    WSGADK        COMP      TGAKNY                             7373
     C*  73DKXGDK        CHAIN     DKXGD                              73
     C                   END
     C   73
     CANN30              MOVE      'DKX0811'     MSGNR
     C   73              SETON                                        30
     C                   END
     C                   END
      *
     C                   SELECT
     C                   WHEN      WSGBL = 0
     C                   MOVE      '1'           *IN66
     C  N30              MOVE      'DKX1911'     MSGNR
     C                   WHEN      ((WSGKD <= 1) OR (WSGKD >= 6))
     C     WSGBL         COMP      100                                66
     C   66
     CANN30              MOVE      'DKX1909'     MSGNR
     C                   OTHER
     C     WSGBL         COMP      1000                                 66
     C   66
     CANN30              MOVE      'DKX1912'     MSGNR
     C                   ENDSL
     C   66              MOVE      '1'           *IN30
      *
     C*                  IF        WSGVK <> *BLANKS
     C*    WSGVK         CHAIN     KDTVK                              65
     C*  65
     C*NN30              MOVE      'SPV0001'     MSGNR
     C*  65              MOVE      '1'           *IN30
     C*                  END
      *
     C     WSTSB         IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSB         YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   72
     CANN30              MOVE      'DKX0811'     MSGNR
     C   72              SETON                                        30
     C                   END
      *
     C     WSDKR         IFNE      *BLANKS
     C                   MOVE      '047'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDKR         YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   70
     CANN30              MOVE      'DKX0810'     MSGNR
     C   70              SETON                                        30
     C                   END
      *
     C     WSDFSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDFSK        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   69
     CANN30              MOVE      'DKX0810'     MSGNR
     C   69              SETON                                        30
     C                   END
      *
     C     WSSKFD        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKFD        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          79
     C   68
     CANN30              MOVE      'DKX0810'     MSGNR
     C   68              SETON                                        30
     C                   END
      *
     C     WSDSK         IFNE      *BLANKS
     C*                  MOVE      '012'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSDSK         YKODE
     C*    DKXK01K       CHAIN     DKXKODL01                          71
     C*  71
     C*NN30              MOVE      'DKX0810'     MSGNR
     C*  71              SETON                                        30
     C                   END
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   68              Z-ADD     22            LINNBR
     C   68              Z-ADD     25            POSNBR
     C   69              Z-ADD     21            LINNBR
     C   69              Z-ADD     78            POSNBR
     C   70              Z-ADD     21            LINNBR
     C   70              Z-ADD     13            POSNBR
     C   71              Z-ADD     22            LINNBR
     C   71              Z-ADD     69            POSNBR
     C   72              Z-ADD     20            LINNBR
     C   72              Z-ADD     67            POSNBR
     C   65              Z-ADD     20            LINNBR
     C   65              Z-ADD     46            POSNBR
     C   66              Z-ADD     20            LINNBR
     C   66              Z-ADD     28            POSNBR
     C   73              Z-ADD     19            LINNBR
     C   73              Z-ADD     69            POSNBR
     C   67              Z-ADD     19            LINNBR
     C   67              Z-ADD     8             POSNBR
     C   74              Z-ADD     18            LINNBR
     C   74              Z-ADD     69            POSNBR
     C   75              Z-ADD     18            LINNBR
     C   75              Z-ADD     60            POSNBR
     C   76              Z-ADD     18            LINNBR
     C   76              Z-ADD     51            POSNBR
     C   77              Z-ADD     18            LINNBR
     C   77              Z-ADD     42            POSNBR
     C   78              Z-ADD     18            LINNBR
     C   78              Z-ADD     33            POSNBR
     C   79              Z-ADD     18            LINNBR
     C   79              Z-ADD     24            POSNBR
     C   80              Z-ADD     18            LINNBR
     C   80              Z-ADD     15            POSNBR
     C   81              Z-ADD     18            LINNBR
     C   81              Z-ADD     6             POSNBR
     C   82              Z-ADD     17            LINNBR
     C   82              Z-ADD     57            POSNBR
     C   83              Z-ADD     17            LINNBR
     C   83              Z-ADD     32            POSNBR
     C   84              Z-ADD     17            LINNBR
     C   84              Z-ADD     12            POSNBR
     C   64              Z-ADD     16            LINNBR
     C   64              Z-ADD     77            POSNBR
     C   85              Z-ADD     13            LINNBR
     C   85              Z-ADD     13            POSNBR
     C   86              Z-ADD     12            LINNBR
     C   86              Z-ADD     51            POSNBR
     C   87              Z-ADD     12            LINNBR
     C   87              Z-ADD     32            POSNBR
     C   88              Z-ADD     12            LINNBR
     C   88              Z-ADD     12            POSNBR
     C   89              Z-ADD     11            LINNBR
     C   89              Z-ADD     74            POSNBR
     C   90              Z-ADD     11            LINNBR
     C   90              Z-ADD     71            POSNBR
     C   91              Z-ADD     8             LINNBR
     C   91              Z-ADD     74            POSNBR
     C   92              Z-ADD     8             LINNBR
     C   92              Z-ADD     71            POSNBR
     C   93              Z-ADD     8             LINNBR
     C   93              Z-ADD     13            POSNBR
     C   94              Z-ADD     7             LINNBR
     C   94              Z-ADD     32            POSNBR
     C   95              Z-ADD     7             LINNBR
     C   95              Z-ADD     12            POSNBR
     C   96              Z-ADD     6             LINNBR
     C   96              Z-ADD     56            POSNBR
     C   97              Z-ADD     5             LINNBR
     C   97              Z-ADD     56            POSNBR
     C   98              Z-ADD     3             LINNBR
     C   98              Z-ADD     13            POSNBR
     C   99              Z-ADD     2             LINNBR
     C   99              Z-ADD     10            POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB4        BEGSR
      ***********************************************
     C                   IF        WSSPOM <> *BLANKS
     C                   MOVE      '096'         YUNIK
     C                   EVAL      YKODE = WSSPOM
     C     DKXK01K       CHAIN     DKXKODL01                          97
     C   97              MOVE      'DKX1943'     MSGNR
     C   97              SETON                                        30
     C                   END
      *
     C                   IF        WSTKBM <> *BLANKS
     C                   MOVE      '116'         YUNIK
     C                   EVAL      YKODE = WSTKBM
     C     DKXK01K       CHAIN     DKXKODL01                          96
     C   96              MOVE      'DKX1945'     MSGNR
     C   96              SETON                                        30
     C                   END
      *
     C                   IF        WSLOSDSK <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   EVAL      YKODE = WSLOSDSK
     C     DKXK01K       CHAIN     DKXKODL01                          95
     C   95
     CANN30              MOVE      'DKX0810'     MSGNR
     C   95              SETON                                        30
     C                   END
      *
     C*                  IF        WSLKR1 <> *BLANKS
     C*                  MOVEL     WSLKR1        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              94
     C*  94
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  94              SETON                                        30
     C*                  END
      *
     C*                  IF        WSLKR2 <> *BLANKS
     C*                  MOVEL     WSLKR2        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              93
     C*  93
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  93              SETON                                        30
     C*                  END
      *
     C*                  IF        WSLKR3 <> *BLANKS
     C*                  MOVEL     WSLKR3        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              92
     C*  92
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  92              SETON                                        30
     C*                  END
      *
     C*                  IF        WSLKR4 <> *BLANKS
     C*                  MOVEL     WSLKR4        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              91
     C*  91
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  91              SETON                                        30
     C*                  END
      *
      *
     C                   IF        WSKNSS <> 0
     C                   MOVE      WSKNSS        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            86
     C                   IF        *IN86
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   IF        WSTINSS = *BLANKS
     C                   IF        EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTINSS = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      WSTINSS = SYLAND + SYFOR9
     C                   END
     C                   END
     C                   ELSE
     C                   EVAL      WSTINSS = EORI
     C                   END
     C                   END
     C                   MOVE      KNAVN         WSNASS
     C                   MOVE      ADR1          WSADSS1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNSS
     C                   MOVEL     POSTNR        WSPNSS
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNSS
     C                   END
     C                   MOVE      ADR3          WSPSSS
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKSS
     C                   END
     C                   END
     C                   END
      *
     C*                  IF        WSLKSS <> *BLANKS
     C*                  MOVEL     WSLKSS        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              85
     C*  85
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  85              SETON                                        30
     C*                  END
      *
     C                   IF        WSSKSS <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVEL     WSSKSS        YKODE
     C     DKXK01K       CHAIN     DKXKODL01                          84
     C   84
     CANN30              MOVE      'DKX0810'     MSGNR
     C   84              SETON                                        30
     C                   END
      *
     C                   IF        WSKNKS <> 0
     C                   MOVE      WSKNKS        KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            83
     C                   IF        *IN83
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   IF        WSTINKS = *BLANKS
     C                   IF        EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTINKS = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      WSTINKS = SYLAND + SYFOR9
     C                   END
     C                   END
     C                   ELSE
     C                   EVAL      WSTINKS = EORI
     C                   END
     C                   END
     C                   MOVE      KNAVN         WSNAKS
     C                   MOVE      ADR1          WSADKS1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNKS
     C                   MOVEL     POSTNR        WSPNKS
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNKS
     C                   END
     C                   MOVE      ADR3          WSPSKS
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKKS
     C                   END
     C                   END
     C                   END
      *
     C*                  IF        WSLKKS <> *BLANKS
     C*                  MOVEL     WSLKKS        DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              82
     C*  82
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  82              SETON                                        30
     C*                  END
      *
     C                   IF        WSSKKS <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   EVAL      YKODE = WSSKKS
     C     DKXK01K       CHAIN     DKXKODL01                          81
     C   81
     CANN30              MOVE      'DKX0810'     MSGNR
     C   81              SETON                                        30
     C                   END
      *
     C                   IF        WSKNT <> 0
     C                   MOVE      WSKNT         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            80
     C                   IF        *IN80
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   IF        WSTINT = *BLANKS
     C                   IF        EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      WSTINT = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      WSTINT = SYLAND + SYFOR9
     C                   END
     C                   END
     C                   ELSE
     C                   EVAL      WSTINT = EORI
     C                   END
     C                   END
     C                   MOVE      KNAVN         WSNAT
     C                   MOVE      ADR1          WSADT1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNT
     C                   MOVEL     POSTNR        WSPNT
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNT
     C                   END
     C                   MOVE      ADR3          WSPST
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKT
     C                   END
     C                   END
     C                   END
      *
     C*                  IF        WSLKT <> *BLANKS
     C*                  MOVEL     WSLKT         DKKD_KD
     C*    DKTKDK        CHAIN     DKTKD                              79
     C*  79
     C*NN30              MOVE      'SPL0001'     MSGNR
     C*  79              SETON                                        30
     C*                  END
      *
     C                   IF        WSSKT <> *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   EVAL      YKODE = WSSKT
     C     DKXK01K       CHAIN     DKXKODL01                          78
     C   78
     CANN30              MOVE      'DKX0810'     MSGNR
     C   78              SETON                                        30
     C                   END
      *
     C   30              EXSR      SETCUR4
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETCUR4       BEGSR
      ***********************************************
     C   78              Z-ADD     17            LINNBR
     C   78              Z-ADD     72            POSNBR
     C   79              Z-ADD     17            LINNBR
     C   79              Z-ADD     52            POSNBR
     C   80              Z-ADD     15            LINNBR
     C   80              Z-ADD     22            POSNBR
     C   81              Z-ADD     14            LINNBR
     C   81              Z-ADD     72            POSNBR
     C   82              Z-ADD     14            LINNBR
     C   82              Z-ADD     52            POSNBR
     C   83              Z-ADD     12            LINNBR
     C   83              Z-ADD     22            POSNBR
     C   84              Z-ADD     11            LINNBR
     C   84              Z-ADD     72            POSNBR
     C   85              Z-ADD     11            LINNBR
     C   85              Z-ADD     52            POSNBR
     C   86              Z-ADD     9             LINNBR
     C   86              Z-ADD     22            POSNBR
     C   87              Z-ADD     7             LINNBR
     C   87              Z-ADD     47            POSNBR
     C   88              Z-ADD     7             LINNBR
     C   88              Z-ADD     44            POSNBR
     C   89              Z-ADD     7             LINNBR
     C   89              Z-ADD     41            POSNBR
     C   90              Z-ADD     7             LINNBR
     C   90              Z-ADD     38            POSNBR
     C   91              Z-ADD     7             LINNBR
     C   91              Z-ADD     35            POSNBR
     C   92              Z-ADD     7             LINNBR
     C   92              Z-ADD     32            POSNBR
     C   93              Z-ADD     7             LINNBR
     C   93              Z-ADD     29            POSNBR
     C   94              Z-ADD     7             LINNBR
     C   94              Z-ADD     26            POSNBR
     C   95              Z-ADD     6             LINNBR
     C   95              Z-ADD     61            POSNBR
     C   96              Z-ADD     3             LINNBR
     C   96              Z-ADD     79            POSNBR
     C   97              Z-ADD     3             LINNBR
     C   97              Z-ADD     64            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVEW         BEGSR
     C***********************************************
     C                   MOVE      THTDN         WSTDN
     C                   MOVE      THENKL        WSENKL
     C                   MOVE      THDK          WSDK
     C                   MOVE      THKNA         WSKNA
     C                   MOVE      THNAA         WSNAA
     C                   MOVE      THADA1        WSADA1
     C                   MOVE      THPNA         WSPNA
     C                   MOVE      THPSA         WSPSA
     C                   MOVE      THLKA         WSLKA
     C                   MOVE      THSKA         WSSKA
     C                   MOVE      THTINA        WSTINA
     C                   MOVE      THKNS         WSKNS
     C                   MOVE      THNAS         WSNAS
     C                   MOVE      THADS1        WSADS1
     C                   MOVE      THPNS         WSPNS
     C                   MOVE      THPSS         WSPSS
     C                   MOVE      THLKS         WSLKS
     C                   MOVE      THSKS         WSSKS
     C                   MOVE      THTINS        WSTINS
     C                   MOVE      THKNK         WSKNK
     C                   MOVE      THNAK         WSNAK
     C                   MOVE      THADK1        WSADK1
     C                   MOVE      THPNK         WSPNK
     C                   MOVE      THPSK         WSPSK
     C                   MOVE      THLKK         WSLKK
     C                   MOVE      THSKK         WSSKK
     C                   MOVE      THTINK        WSTINK
     C                   MOVE      THBLK         WSBLK
     C                   MOVE      THLSD         WSLSD
     C                   MOVE      THLASD        WSLASD
     C                   MOVE      THLAS2        WSLAS2
     C                   MOVE      THALK         WSALK
     C                   MOVE      THTRM         WSTRM
     C                   MOVE      THTRMI        WSTRMI
     C                   MOVE      THTAID        WSTAID
     C                   MOVE      THTASK        WSTASK
     C                   MOVE      THTALK        WSTALK
     C                   MOVE      THTGID        WSTGID
     C                   MOVE      THTGSK        WSTGSK
     C                   MOVE      THTGLK        WSTGLK
     C                   MOVE      THSKFD        WSSKFD
     C                   MOVE      THCATS        WSCATS
     C                   MOVE      THCDT         WSCDT
     C                   MOVEL     THCNA         WSCNA
     C                   MOVEL     THCNR         WSCNR
     C                   MOVE      THTSD1        WSTSD1
     C                   MOVE      THTSD2        WSTSD2
     C                   MOVE      THTSD3        WSTSD3
     C                   MOVE      THTSD4        WSTSD4
     C                   MOVE      THTSD5        WSTSD5
     C                   MOVE      THTSD6        WSTSD6
     C                   MOVE      THTSD7        WSTSD7
     C                   MOVE      THTSD8        WSTSD8
     C                   MOVE      THTSB         WSTSB
     C                   MOVE      THDDT         WSDDT
     C                   MOVE      THDFKD        WSDFKD
     C                   MOVE      THDFSK        WSDFSK
     C                   MOVE      THDKR         WSDKR
     C                   MOVE      THDANT        WSDANT
     C                   MOVE      THGKD         WSGKD
     C                   MOVE      THGFT1        WSGFT1
     C                   MOVE      THGFT2        WSGFT2
     C                   MOVE      THGADK        WSGADK
     C                   Z-ADD     THGBL         WSGBL
     C                   MOVE      THGVK         WSGVK
     C                   MOVE      THGBGI        WSGBGI
     C                   MOVE      THGBGU        WSGBGU
     C                   MOVE      THKDC         WSKDC
     C                   MOVEL     THTSN1        WSTSN1
     C                   MOVEL     THTSN2        WSTSN2
     C                   MOVE      THLSTL        WSLSTL
     C                   MOVE      THVPOS        WSVPOS
     C                   MOVE      THNTK         WSNTK
     C                   MOVE      THVKB         WSVKB
     C                   MOVE      THDST         WSDST
     C                   MOVE      THDSK         WSDSK
     C                   MOVE      THNTTD        WSNTTD
     C                   MOVE      THNTLL        WSNTLL
     C                   MOVE      THFMLL        WSFMLL
     C                   MOVE      THNPNS        WSNPNS
     C                   MOVE      S0004         W0004
     C                   MOVE      S0010         W0010
     C                   MOVE      S0026         W0026
     C                   MOVE      S0035         W0035
N01  C                   MOVE      THEKST        WSEKST
      *
     C     WSAAVD        CHAIN     DKXSTDFV                           33
     C                   IF        *IN33
     C                   EXSR      MOVEBFV
     C                   ELSE
     C                   MOVE      THSIK         WSSIK
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      THTMA         WSTMA
     C                   MOVE      THSPOM        WSSPOM
     C                   MOVE      THTKBM        WSTKBM
     C                   MOVE      THKREF        WSKREF
     C                   MOVE      THTREF        WSTREF
     C                   MOVE      THLOSD        WSLOSD
     C                   MOVE      THLOSDSK      WSLOSDSK
     C                   MOVE      THLKR1        WSLKR1
     C                   MOVE      THLKR2        WSLKR2
     C                   MOVE      THLKR3        WSLKR3
     C                   MOVE      THLKR4        WSLKR4
     C                   MOVE      THLKR5        WSLKR5
     C                   MOVE      THLKR6        WSLKR6
     C                   MOVE      THLKR7        WSLKR7
     C                   MOVE      THLKR8        WSLKR8
     C                   MOVE      THKNSS        WSKNSS
     C                   MOVE      THTINSS       WSTINSS
     C                   MOVE      THNASS        WSNASS
     C                   MOVE      THADSS1       WSADSS1
     C                   MOVE      THPNSS        WSPNSS
     C                   MOVE      THPSSS        WSPSSS
     C                   MOVE      THLKSS        WSLKSS
     C                   MOVE      THSKSS        WSSKSS
     C                   MOVE      THKNKS        WSKNKS
     C                   MOVE      THTINKS       WSTINKS
     C                   MOVE      THNAKS        WSNAKS
     C                   MOVE      THADKS1       WSADKS1
     C                   MOVE      THPNKS        WSPNKS
     C                   MOVE      THPSKS        WSPSKS
     C                   MOVE      THLKKS        WSLKKS
     C                   MOVE      THSKKS        WSSKKS
     C                   MOVE      THKNT         WSKNT
     C                   MOVE      THTINT        WSTINT
     C                   MOVE      THNAT         WSNAT
     C                   MOVE      THADT1        WSADT1
     C                   MOVE      THPNT         WSPNT
     C                   MOVE      THPST         WSPST
     C                   MOVE      THLKT         WSLKT
     C                   MOVE      THSKT         WSSKT
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVEB         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      'N'           WSENKL
     C                   MOVE      *BLANKS       WSDK
     C                   MOVE      *ZEROS        WSKNA
     C                   MOVE      *BLANKS       WSNAA
     C                   MOVE      *BLANKS       WSADA1
     C                   MOVE      *BLANKS       WSPNA
     C                   MOVE      *BLANKS       WSPSA
     C                   MOVE      *BLANKS       WSLKA
     C                   MOVE      *BLANKS       WSSKA
     C                   MOVE      *BLANKS       WSTINA
     C                   MOVE      *ZEROS        WSKNS
     C                   MOVE      *BLANKS       WSNAS
     C                   MOVE      *BLANKS       WSADS1
     C                   MOVE      *BLANKS       WSPNS
     C                   MOVE      *BLANKS       WSPSS
     C                   MOVE      *BLANKS       WSLKS
     C                   MOVE      *BLANKS       WSSKS
     C                   MOVE      *BLANKS       WSTINS
     C                   MOVE      *ZEROS        WSKNK
     C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      *BLANKS       WSADK1
     C                   MOVE      *BLANKS       WSPNK
     C                   MOVE      *BLANKS       WSPSK
     C                   MOVE      *BLANKS       WSLKK
     C                   MOVE      *BLANKS       WSSKK
     C                   MOVE      *BLANKS       WSTINK
     C                   MOVE      *BLANKS       WSBLK
     C                   MOVE      *BLANKS       WSLSD
     C                   MOVE      *BLANKS       WSLASD
     C                   MOVE      *BLANKS       WSLAS2
     C                   MOVE      *BLANKS       WSALK
     C                   MOVE      *ZEROS        WSTRM
     C                   MOVE      *ZEROS        WSTRMI
     C                   MOVE      *BLANKS       WSTAID
     C                   MOVE      *BLANKS       WSTASK
     C                   MOVE      *BLANKS       WSTALK
     C                   MOVE      *BLANKS       WSTGID
     C                   MOVE      *BLANKS       WSTGSK
     C                   MOVE      *BLANKS       WSTGLK
     C                   MOVE      *BLANKS       WSSKFD
     C                   MOVE      *BLANKS       WSCATS
     C                   MOVE      *ZEROS        WSCDT
     C                   MOVE      *BLANKS       WSCNA
     C                   MOVE      *BLANKS       WSCNR
     C                   MOVE      *BLANKS       WSTSD1
     C                   MOVE      *BLANKS       WSTSD2
     C                   MOVE      *BLANKS       WSTSD3
     C                   MOVE      *BLANKS       WSTSD4
     C                   MOVE      *BLANKS       WSTSD5
     C                   MOVE      *BLANKS       WSTSD6
     C                   MOVE      *BLANKS       WSTSD7
     C                   MOVE      *BLANKS       WSTSD8
     C                   MOVE      *BLANKS       WSTSB
     C                   MOVE      *ZEROS        WSDDT
     C                   MOVE      *BLANKS       WSDFKD
     C                   MOVE      *BLANKS       WSDFSK
     C                   MOVE      *BLANKS       WSDKR
     C                   MOVE      *ZEROS        WSDANT
     C                   MOVE      *BLANKS       WSGKD
     C                   MOVE      *BLANKS       WSGFT1
     C                   MOVE      *BLANKS       WSGFT2
     C                   MOVE      *BLANKS       WSGADK
     C                   Z-ADD     30            WSGBL
     C                   MOVE      *BLANKS       WSGVK
     C                   MOVE      *ZEROS        WSGBGI
     C                   MOVE      *BLANKS       WSGBGU
     C                   MOVE      *ZEROS        WSKDC
     C                   MOVE      *BLANKS       WSTSN1
     C                   MOVE      *BLANKS       WSTSN2
     C                   MOVE      *ZEROS        WSLSTL
     C                   MOVE      *ZEROS        WSVPOS
     C                   MOVE      *ZEROS        WSNTK
     C                   MOVE      *ZEROS        WSVKB
     C                   MOVE      *BLANKS       WSDST
     C                   MOVE      *BLANKS       WSDSK
     C                   Z-ADD     1             WSNTTD
     C                   Z-ADD     1             WSNTLL
     C                   MOVE      'J'           WSFMLL
     C                   MOVE      *BLANKS       WSNPNS
     C                   MOVE      *BLANKS       W0004
     C                   MOVE      *BLANKS       W0010
     C                   MOVE      *BLANKS       W0026
     C                   MOVE      *BLANKS       W0035
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVEBFV       BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        WSSIK
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      *ZEROS        WSTMA
     C                   MOVE      *BLANKS       WSSPOM
     C                   MOVE      *BLANKS       WSTKBM
     C                   MOVE      *BLANKS       WSKREF
     C                   MOVE      *BLANKS       WSTREF
     C                   MOVE      *BLANKS       WSLOSD
     C                   MOVE      *BLANKS       WSLOSDSK
     C                   MOVE      *BLANKS       WSLKR1
     C                   MOVE      *BLANKS       WSLKR2
     C                   MOVE      *BLANKS       WSLKR3
     C                   MOVE      *BLANKS       WSLKR4
     C                   MOVE      *BLANKS       WSLKR5
     C                   MOVE      *BLANKS       WSLKR6
     C                   MOVE      *BLANKS       WSLKR7
     C                   MOVE      *BLANKS       WSLKR8
     C                   MOVE      *ZEROS        WSKNSS
     C                   MOVE      *BLANKS       WSTINSS
     C                   MOVE      *BLANKS       WSNASS
     C                   MOVE      *BLANKS       WSADSS1
     C                   MOVE      *BLANKS       WSPNSS
     C                   MOVE      *BLANKS       WSPSSS
     C                   MOVE      *BLANKS       WSLKSS
     C                   MOVE      *BLANKS       WSSKSS
     C                   MOVE      *ZEROS        WSKNKS
     C                   MOVE      *BLANKS       WSTINKS
     C                   MOVE      *BLANKS       WSNAKS
     C                   MOVE      *BLANKS       WSADKS1
     C                   MOVE      *BLANKS       WSPNKS
     C                   MOVE      *BLANKS       WSPSKS
     C                   MOVE      *BLANKS       WSLKKS
     C                   MOVE      *BLANKS       WSSKKS
     C                   MOVE      *ZEROS        WSKNT
     C                   MOVE      *BLANKS       WSTINT
     C                   MOVE      *BLANKS       WSNAT
     C                   MOVE      *BLANKS       WSADT1
     C                   MOVE      *BLANKS       WSPNT
     C                   MOVE      *BLANKS       WSPST
     C                   MOVE      *BLANKS       WSLKT
     C                   MOVE      *BLANKS       WSSKT
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSVS        BEGSR
     C***********************************************
     C     WSAAVD        CHAIN     DKXSTD                             60
     C                   EXSR      MOVESV
     C   60              WRITE     DKXSTDR
     C  N60              UPDATE    DKXSTDR
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDSVSFV      BEGSR
      ***********************************************
     C     WSAAVD        CHAIN     DKXSTDFV                           60
     C                   EXSR      MOVETRFV
     C   60              WRITE     DKXSTFVR
     C  N60              UPDATE    DKXSTFVR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVESV        BEGSR
     C***********************************************
     C                   MOVE      WSAAVD        THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      UDAY          THDTD
     C                   MOVE      UMONTH        THDTM
     C     UYEAR         ADD       2000          THDTÅ
     C                   MOVE      WSENKL        THENKL
     C                   MOVE      WSDK          THDK
     C                   MOVE      WSKNA         THKNA
     C                   MOVE      WSNAA         THNAA
     C                   MOVE      WSADA1        THADA1
     C                   MOVE      WSPNA         THPNA
     C                   MOVE      WSPSA         THPSA
     C                   MOVE      WSLKA         THLKA
     C                   MOVE      WSSKA         THSKA
     C                   MOVE      WSTINA        THTINA
     C                   MOVE      WSKNS         THKNS
     C                   MOVE      WSNAS         THNAS
     C                   MOVE      WSADS1        THADS1
     C                   MOVE      WSPNS         THPNS
     C                   MOVE      WSPSS         THPSS
     C                   MOVE      WSLKS         THLKS
     C                   MOVE      WSSKS         THSKS
     C                   MOVE      WSTINS        THTINS
     C                   MOVE      WSKNK         THKNK
     C                   MOVE      WSNAK         THNAK
     C                   MOVE      WSADK1        THADK1
     C                   MOVE      WSPNK         THPNK
     C                   MOVE      WSPSK         THPSK
     C                   MOVE      WSLKK         THLKK
     C                   MOVE      WSSKK         THSKK
     C                   MOVE      WSTINK        THTINK
     C                   MOVE      WSBLK         THBLK
     C                   MOVE      WSLSD         THLSD
     C                   MOVE      WSLASD        THLASD
     C                   MOVE      WSLAS2        THLAS2
     C                   MOVE      WSALK         THALK
     C                   MOVE      WSTRM         THTRM
     C                   MOVE      WSTRMI        THTRMI
     C                   MOVE      WSTAID        THTAID
     C                   MOVE      WSTASK        THTASK
     C                   MOVE      WSTALK        THTALK
     C                   MOVE      WSTGID        THTGID
     C                   MOVE      WSTGSK        THTGSK
     C                   MOVE      WSTGLK        THTGLK
     C                   MOVE      WSSKFD        THSKFD
     C                   MOVE      WSCATS        THCATS
     C                   MOVE      WSCDT         THCDT
     C                   MOVEL     WSCNA         THCNA
     C                   MOVEL     WSCNR         THCNR
     C                   MOVE      WSTSD1        THTSD1
     C                   MOVE      WSTSD2        THTSD2
     C                   MOVE      WSTSD3        THTSD3
     C                   MOVE      WSTSD4        THTSD4
     C                   MOVE      WSTSD5        THTSD5
     C                   MOVE      WSTSD6        THTSD6
     C                   MOVE      WSTSD7        THTSD7
     C                   MOVE      WSTSD8        THTSD8
     C                   MOVE      WSTSB         THTSB
     C                   MOVE      WSDDT         THDDT
     C                   MOVE      WSDFKD        THDFKD
     C                   MOVE      WSDFSK        THDFSK
     C                   MOVE      WSDKR         THDKR
     C                   MOVE      WSDANT        THDANT
     C                   MOVE      WSGKD         THGKD
     C                   MOVE      WSGFT1        THGFT1
     C                   MOVE      WSGFT2        THGFT2
     C                   MOVE      WSGADK        THGADK
     C                   Z-ADD     WSGBL         THGBL
     C                   MOVE      WSGVK         THGVK
     C                   MOVE      WSGBGI        THGBGI
     C                   MOVE      WSGBGU        THGBGU
     C                   MOVE      WSKDC         THKDC
     C                   MOVEL     WSTSN1        THTSN1
     C                   MOVEL     WSTSN2        THTSN2
     C                   MOVE      WSLSTL        THLSTL
     C                   MOVE      WSVPOS        THVPOS
     C                   MOVE      WSNTK         THNTK
     C                   MOVE      WSVKB         THVKB
     C                   MOVE      WSDST         THDST
     C                   MOVE      WSDSK         THDSK
     C                   MOVE      WSNTTD        THNTTD
     C                   MOVE      WSNTLL        THNTLL
     C                   MOVE      WSFMLL        THFMLL
     C                   MOVE      WSNPNS        THNPNS
     C                   MOVE      W0004         S0004
     C                   MOVE      W0010         S0010
     C                   MOVE      W0026         S0026
     C                   MOVE      W0035         S0035
N01  C                   MOVE      WSEKST        THEKST
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVETRFV      BEGSR
      ***********************************************
     C                   MOVE      WSAAVD        THAVD
     C                   MOVE      WSSIK         THSIK
     C                   MOVE      *ZEROS        THDTA
     C                   MOVE      WSTMA         THTMA
     C                   MOVE      WSSPOM        THSPOM
     C                   MOVE      WSTKBM        THTKBM
     C                   MOVE      WSKREF        THKREF
     C                   MOVE      WSTREF        THTREF
     C                   MOVE      WSLOSD        THLOSD
     C                   MOVE      WSLOSDSK      THLOSDSK
     C                   MOVE      WSLKR1        THLKR1
     C                   MOVE      WSLKR2        THLKR2
     C                   MOVE      WSLKR3        THLKR3
     C                   MOVE      WSLKR4        THLKR4
     C                   MOVE      WSLKR5        THLKR5
     C                   MOVE      WSLKR6        THLKR6
     C                   MOVE      WSLKR7        THLKR7
     C                   MOVE      WSLKR8        THLKR8
     C                   MOVE      WSKNSS        THKNSS
     C                   MOVE      WSTINSS       THTINSS
     C                   MOVE      WSNASS        THNASS
     C                   MOVE      WSADSS1       THADSS1
     C                   MOVE      WSPNSS        THPNSS
     C                   MOVE      WSPSSS        THPSSS
     C                   MOVE      WSLKSS        THLKSS
     C                   MOVE      WSSKSS        THSKSS
     C                   MOVE      WSKNKS        THKNKS
     C                   MOVE      WSTINKS       THTINKS
     C                   MOVE      WSNAKS        THNAKS
     C                   MOVE      WSADKS1       THADKS1
     C                   MOVE      WSPNKS        THPNKS
     C                   MOVE      WSPSKS        THPSKS
     C                   MOVE      WSLKKS        THLKKS
     C                   MOVE      WSSKKS        THSKKS
     C                   MOVE      WSKNT         THKNT
     C                   MOVE      WSTINT        THTINT
     C                   MOVE      WSNAT         THNAT
     C                   MOVE      WSADT1        THADT1
     C                   MOVE      WSPNT         THPNT
     C                   MOVE      WSPST         THPST
     C                   MOVE      WSLKT         THLKT
     C                   MOVE      WSSKT         THSKT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * DEKLARASJONSTYPE
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      '031'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSDK          UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSDK
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVSENDERSNR
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVSENDERSLANDKODE
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSALK = UKD
     C*                  END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * BESTEMMELESLANDKODE
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSBLK = UKD
     C*                  END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL AVSENDER
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLKS = UKD
     C*                  END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL AVSENDER
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKS         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKS
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * MOTTAKERSNR
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNK
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     43            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     71
     C     POSNBR        ANDLE     72
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSTALK = UKD
     C*                  END
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     75
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTASK        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTASK
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED GRENSE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     71
     C     POSNBR        ANDLE     72
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSTGLK = UKD
     C*                  END
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL TRANSPORTMIDDEL VED GRENSE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     75
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTGSK        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTGSK
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL MOTTAKER
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLKK = UKD
     C*                  END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL MOTTAKER
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKK         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKK
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TRANSPORTMÅTE
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRMI
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TRANSPORTMÅTE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRM
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * HOVEDANSVARLIGNR
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNA
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL HOVEDANSVARLIG
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLKA = UKD
     C*                  END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL HOVEDANSVARLIG
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKA         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKA
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVGANGSTOLLSTED
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     57
     C     POSNBR        ANDLE     64
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSCATS        UKODE
     C                   MOVE      'AVG'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSCATS
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-1
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD1        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD1
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-2
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD2        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD2
     C                   Z-ADD     24            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-3
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     24
     C     POSNBR        ANDLE     31
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD3        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD3
     C                   Z-ADD     33            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-4
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD4        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD4
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-5
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     49
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD5        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD5
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-6
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     58
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD6        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD6
     C                   Z-ADD     60            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-7
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     67
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD7        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD7
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-8
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     76
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD8        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD8
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * ADGANGSKODE FOR GARANTI
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     72
     C                   MOVE      '105'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSGADK        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSGADK
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     37
     C                   CALL      'KDT007R'
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   EVAL      WSGVK = UKD
     C                   ENDIF
     C                   Z-ADD     67            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * BESTEMMELSESTEDS TOLLSTED
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     67
     C     POSNBR        ANDLE     74
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSB         UKODE
     C                   MOVE      'ANK'         UTYPE             3
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSB
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL DEKLARASJON
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     70
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDSK         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSDSK
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * KONTROLL RESULTAT
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     14
     C                   MOVE      '047'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDKR         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSDKR
     C                   Z-ADD     22            POSNBR
     C                   END
      * SPRÅKKODE TIL FORSEGLING
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDFSK        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSDFSK
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE PÅ FØLGEDOKUMENTER
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     26
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKFD        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKFD
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     SØKDTA4       BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * SPESIELLE OMSTENDIGHETER
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     64
     C     POSNBR        ANDLE     64
     C                   MOVE      '096'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSSPOM        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSPOM
     C                   Z-ADD     79            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * TRANSPORTKOSTNADS BETALINGSMÅTE
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     79
     C     POSNBR        ANDLE     79
     C                   MOVE      '116'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSTKBM        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTKBM
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * SPRÅKKODE TIL LOSSESTED
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     61
     C     POSNBR        ANDLE     62
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSLOSDSK      UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSLOSDSK
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * LANDKODE TIL REISERUTE 1
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     27
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLKR1 = UKD
     C*                  END
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * LANDKODE TIL REISERUTE 2
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     30
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLKR2 = UKD
     C*                  END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * LANDKODE TIL REISERUTE 3
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C*                  CALL      'KDT003R'
     C*                  PARM                    DKKD_TYP
     C*                  PARM                    DKKD_IE
     C*                  PARM                    WDT
     C*                  PARM                    UKD              10
     C*                  IF        UKD <> *BLANKS
     C*                  EVAL      WSLKR3 = UKD
     C*                  END
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * AVSENDERSNR SIKKERHET
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNSS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * SPRÅKKODE TIL AVSENDER SIKKERHET
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKSS        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKSS
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * MOTTAKERSNR SIKKERHET
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNKS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * SPRÅKKODE TIL MOTTAKER SIKKERHET
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKKS        UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKKS
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * TRANSPORTØR
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNT
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      * SPRÅKKODE TIL TRANSPORTØR
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKT         UKODE
     C                   CALL      'DKX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSSKT
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK4
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK4        ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    MODE              1
      *
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     DKXK01K       KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C*    DKTKDK        KLIST
     C*                  KFLD                    DKKD_IE
     C*                  KFLD                    DKKD_TYP
     C*                  KFLD                    DKKD_KD
     C     KODS4K        KLIST
     C                   KFLD                    KS4UNI
     C                   KFLD                    WSTRM
     C     KODS4KI       KLIST
     C                   KFLD                    KS4UNI
     C                   KFLD                    WSTRMI
     C     DKXGDK        KLIST
     C                   KFLD                    WSGFT1
     C                   KFLD                    WSGADK
      *
     C                   MOVE      'A'           WSAUNI            1
     C*                  MOVE      'GCY'         DKKD_TYP
     C*                  MOVE      'A'           DKKD_IE
     C                   MOVEL     'S4'          KS4UNI
     C                   MOVE      *ZEROS        THDT
     C                   MOVE      *ZEROS        WSDDT
     C                   MOVE      *ZEROS        THDDT
     C                   MOVE      *BLANKS       WSCNA
     C                   MOVE      *BLANKS       WSCNR
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   30
      *
     C                   ENDSR
      *
