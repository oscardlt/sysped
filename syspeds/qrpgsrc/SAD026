********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 UDS ER ENDRET
********************************************************************
      *
      *************************************************************
      *** PROGRAM SKAL SKRIVE UT STATISTIKK AV AVSENDER/MOTTAKER***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER      ***
      *** LEDIGE INDIKATORER 01 02 04-26                        ***
      *** LEDIGE INDIKATORER 27-39 42-87 89-96                  ***
      *************************************************************
      *
     Fsysthlp   IF   E             DISK
N01  FKODTA     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FSAEH2     IF   E           K DISK
     FSAEH3     IF   E           K DISK
     F                                     RENAME(SAEHR:SAEH3R)
     FSAD026FM  CF   E             WORKSTN
     FDATALIST  O    F  132        PRINTER OFLIND(*INOF)
     F                                     FORMLEN(48)
     F                                     FORMOFL(42)
     D                 DS
     D  XÅRF2                  1      4  0
     D  XMNDF2                 5      6  0
     D  XDAGF2                 7      8  0
     D  XDATOF                 1      8  0
     D                 DS
     D  XÅRT2                  1      4  0
     D  XMNDT2                 5      6  0
     D  XDAGT2                 7      8  0
     D  XDATOT                 1      8  0
     D                 DS
     D  XDAGF                  1      2  0
     D  XMNDF                  3      4  0
     D  XÅRF                   5      6  0
     D  WSDTF                  1      6  0
     D                 DS
     D  XDAGT                  1      2  0
     D  XMNDT                  3      4  0
     D  XÅRT                   5      6  0
     D  WSDTT                  1      6  0
     D                UDS
S01  D* UAVD                   1      4  0
S01  D* UAVDNV                10     42
N01  D  UAVD                  15     18  0
     C*
N01  C     KODTAK        KLIST
N01  C                   KFLD                    KOAUNI
N01  C                   KFLD                    UAVD
N01  C                   MOVE      'A'           KOAUNI
     C     SAEH2K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSKNF
     C                   KFLD                    XDATOF
     C     SAEH3K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSKNF
     C                   KFLD                    XDATOF
     C     *ENTRY        PLIST
     C                   PARM                    UIN01             1
     C     LASER         PARM      LASER         LASER             1
     C     STRING        PARM      STRING        STRING            5
     C     COPY          PARM      COPY          COPY              2 0
     C*
N01  C     KODTAK        CHAIN     KODTA                              33
N01  C  N33              EVAL      UAVDNV = KOANVN
     C     STRING        IFNE      *BLANKS
     C     STRING        CHAIN     KODTFM                             33
     C                   END
     C     LASER         IFEQ      'A'
     C                   SETON                                        88
     C                   END
     C                   MOVE      *ZEROS        UIN01
     C                   MOVE      *ZEROS        WSDTF
     C                   MOVE      *ZEROS        WSDTT
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     c   01              do
     c                   movel     'sad026'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START
     c                   end
     C                   SETOFF                                       30
     C                   SETOFF                                       999897
     C   03              GOTO      SLUTT
     C   12              MOVE      '1'           UIN01
     C   12              MOVE      *ZEROS        UAVD
     C   12              GOTO      SLUTT
     C*
     C     WSDTF         IFEQ      0
     C                   Z-ADD     010151        WSDTF
     C                   END
     C                   MOVE      XDAGF         XDAGF2
     C                   MOVE      XMNDF         XMNDF2
     C     XÅRF          IFGT      50
     C     XÅRF          ADD       1900          XÅRF2
     C                   ELSE
     C     XÅRF          ADD       2000          XÅRF2
     C                   END
     C                   MOVE      XDAGT         XDAGT2
     C                   MOVE      XMNDT         XMNDT2
     C     XÅRT          IFGT      50
     C     XÅRT          ADD       1900          XÅRT2
     C                   ELSE
     C     XÅRT          ADD       2000          XÅRT2
     C                   END
     C     XDATOF        COMP      XDATOT                             99
     C   99              MOVE      'SPD0007'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      START
     C     WSKL          COMP      ' '                                    98
     C   98              MOVE      'SPA0023'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      START
     C     WSKNF         COMP      WSKNT                              97
     C   97              MOVE      'SPK0032'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      START
     C*
     C                   EXSR      PRINT
     C                   MOVE      'SHU0731'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XTKG              9 0
     C                   MOVE      *ZEROS        XTANT             6 0
     C                   MOVE      *ZEROS        XTKGT             9 0
     C                   MOVE      *ZEROS        XTANTT            6 0
     C                   MOVE      *ZEROS        XKNK              8 0
     C                   MOVE      *ZEROS        XKNS              8 0
     C*
     C     WSKL          COMP      'A'                                    40
     C     WSDETJ        COMP      'J'                                8888
     C   40SAEH2K        SETLL     SAEH2
     C  N40SAEH3K        SETLL     SAEH3
     C                   EXCEPT    DLHEAD
     C*
     C     STPRI         TAG
     C   40UAVD          READE     SAEH2                                  60
     C  N40UAVD          READE     SAEH3                                  60
     C   40
     CANN60SEKNK         COMP      WSKNT                              60
     C  N40
     CANN60SEKNS         COMP      WSKNT                              60
     C*
     C  N60              DO
     C     SEDT          COMP      XDATOF                             31  31
     C   31SEDT          COMP      XDATOT                               3131
     C*
     C   31              DO
     C   40XKNK          IFNE      0
     C     XKNK          COMP      SEKNK                              4141
     C   41              EXSR      BRUDD
     C                   END
     C  N40XKNS          IFNE      0
     C     XKNS          COMP      SEKNS                              4141
     C   41              EXSR      BRUDD
     C                   END
     C   40              MOVE      SEKNK         XKNK
     C  N40              MOVE      SEKNS         XKNS
     C   40              MOVE      SENAK         XNAK             30
     C  N40              MOVE      SENAS         XNAS             30
     C                   ADD       1             XTANT
     C                   ADD       SEVKB         XTKG
     C*
     C   OF
     CAN 88              EXCEPT    DLHEAD
     C   88              EXCEPT    DLDET
     C                   END
     C*** END PÅ <31 DO>
     C*
     C                   GOTO      STPRI
     C*
     C                   END
     C*** END PÅ <N60 DO>
     C*
     C                   EXSR      BRUDD
     C                   EXCEPT    DLTOT
     C                   MOVE      *ZEROS        WSKNF
     C                   MOVE      *ZEROS        WSKNT
     C                   MOVE      ' '           WSKL
     C                   MOVE      ' '           WSDETJ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     BRUDD         BEGSR
     C***********************************************
     C                   ADD       XTANT         XTANTT
     C                   ADD       XTKG          XTKGT
     C   OF              EXCEPT    DLHEAD
     C                   EXCEPT    DLBRU
     C                   MOVE      *ZEROS        XTKG
     C                   MOVE      *ZEROS        XTANT
     C*
     C                   ENDSR
     C***********************************************
     C     HELPSR        BEGSR
     C***********************************************
     c
     c                   move      *blanks       pcocmd           70
     c     1             chain     systhlp                            33
     c     *in(33)       ifeq      '0'
      *
      * intern
     c                   movel     'http://'     pcocmd
     C     pcocmd        CAT       systip:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       systba:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       hlpna:0       pcocmd
     C     pcocmd        CAT       '.htm':0      pcocmd
      *
     c                   call      'SYGE34CL'
     c                   parm                    pcocmd
     c                   end
     C                   ENDSR
     C*
     O*
     ODATALIST  E            DLHEAD           01
     O                       KFMT1               75
     ODATALIST  E            DLHEAD           02
     O                       KFMT2               75
     O               88                          90 '¤&l'
     O               88      COPY                92
     O               88                          93 'X'
     O               88                         100 '¤(s12H'
     O               88                         106 '¤&l1O'
     ODATALIST  E            DLHEAD           03
     O               88                          10 '¤&a-3R'
     O               88                          35 '¤(12U¤(s0p12h0s3b4099T'
     ODATALIST  E            DLHEAD           03
     O               88                          24 '¤*c3350A¤*c190B¤*c11G¤*c'
     O               88                          26 '2P'
     ODATALIST  E            DLHEAD           05
     O                                           24 'STATISTIKK-UTSKRIFT     '
     O                                           34 'FRA DATO'
     O                       WSDTF         Y     42
     O                                           52 'TIL DATO'
     O                       WSDTT         Y     61
     O               40                          81 'A V S E N D E R'
     O              N40                          81 'M O T T A K E R'
     O                                           90 'FRA NR'
     O                       WSKNF         Z    100
     O                                          110 'TIL NR'
     O                       WSKNT         Z    120
     O          E            DLHEAD           06
     O                                            8 'NUMMER'
     O                                           15 'NAVN'
     O                                           50 'ANT/DEK'
     O                                           65 'ANT. KG'
     O          E            DLHEAD           07
     O                                           24 '------------------------'
     O                                           48 '------------------------'
     O                                           72 '------------------------'
     O                                           96 '------------------------'
     O                                          120 '------------------------'
     O          E            DLHEAD         1 07
     O               88                          25 '¤(12U¤(s0p12h0s0b4099T'
     O          E            DLDET          2
     O               40      XKNK          Z      8
     O              N40      XKNS          Z      8
     O               40      XNAK                40
     O              N40      XNAS                40
     O                       SETDN         Z     50
     O                       SEVKB         Z     65
     O          E            DLBRU       0  0
     O               40      XKNK          Z      8
     O              N40      XKNS          Z      8
     O               40      XNAK                40
     O              N40      XNAS                40
     O                       XTANT         Z     50
     O                       XTKG          Z     65
     O          E            DLBRU          2
     O               40      XKNK          Z      8
     O              N40      XKNS          Z      8
     O               40      XNAK                40
     O              N40      XNAS                40
     O                       XTANT         ZB    50
     O                       XTKG          ZB    65
     O          E            DLTOT       2
     O                                           27 'TOTALER FOR ALLE SELEKTE'
     O                                           51 'RTE MUMMER              '
     O                       XTANTT        Z     50
     O                       XTKGT         Z     65
