********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11011 * 02 YBC PTF11 SKILLE IMPORT OR EKSPORT
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE BOOKING (DEL-2)                 ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01 02 05-11 13 15-26                   ***
      *** LEDIGE INDIKATORER 27 28 31 32 34-52 55-97                ***
      *****************************************************************
      *
N02  FBILLOF    IF   E           K DISK
     FBOOKING   IF   E           K DISK
     FBOOKIN2   UF A E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFREETXT   IF   E           K DISK
     FFRATXT    IF   E           K DISK
     FSYSJ50FC  CF   E             WORKSTN INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  BODTRÅ                 1      4  0
     D  BODTRM                 5      6  0
     D  BODTRD                 7      8  0
     D  BODTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C  N30
     CANN04
     CANN18              Z-ADD     4             LINNBR
     C  N30
     CANN04
     CANN18              Z-ADD     19            POSNBR
     C*
     C*** TEST OM DET ER OPPLYSNINGER TIL OPPDRAG/KUNDER
     C                   EXSR      TSTOPL
     C                   EXFMT     BILDE
     C                   SETOFF                                       3099
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C   12              DO
     C                   Z-ADD     1             UFLAGG
     C                   GOTO      SLUTT
     C                   END
     C* VIS KUNDEOPPLYSNINGER
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START
     C                   END
     C* FREETEXT
     C   18              DO
     C                   EXSR      VISFRE
     C                   GOTO      START
     C                   END
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C                   EXSR      OPDBK2
     C*
     C  N03              GOTO      START
     C                   Z-ADD     3             UFLAGG
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C*
     C*** TEST STEVEDOR
     C     WSKNS         IFEQ      0
     C     WSKNVH        ANDEQ     0
      *** TEST OM BRUKER HAR UTFYLLT MINST ET FELT.
     C     WSNAS         COMP      *BLANKS                                99
     C   99WSADL         COMP      *BLANKS                                99
     C   99WSIMCO        COMP      *BLANKS                                99
     C   99WSPGNO        COMP      *BLANKS                                99
     C   99WSUNNO        COMP      *BLANKS                                99
     C   99WSCOC         COMP      *BLANKS                                99
     C   99WSFP          COMP      *BLANKS                                99
     C   99WSPG          COMP      *BLANKS                                99
     C   99WSKDA         COMP      *BLANKS                                99
     C   99WSKDM         COMP      *BLANKS                                99
     C   99WSKDN         COMP      *BLANKS                                99
     C   99WSNT1         COMP      *ZEROS                                 99
     C   99WSVT1         COMP      *BLANKS                                99
     C   99WSVS1         COMP      *BLANKS                                99
     C   99WSVKB1        COMP      *ZEROS                                 99
     C   99WSVKN1        COMP      *ZEROS                                 99
     C   99WSM31         COMP      *ZEROS                                 99
     C   99WSNT2         COMP      *ZEROS                                 99
     C   99WSVT2         COMP      *BLANKS                                99
     C   99WSVS2         COMP      *BLANKS                                99
     C   99WSVKB2        COMP      *ZEROS                                 99
     C   99WSVKN2        COMP      *ZEROS                                 99
     C   99WSM32         COMP      *ZEROS                                 99
     C   99WSNT3         COMP      *ZEROS                                 99
     C   99WSVT3         COMP      *BLANKS                                99
     C   99WSVS3         COMP      *BLANKS                                99
     C   99WSVKB3        COMP      *ZEROS                                 99
     C   99WSVKN3        COMP      *ZEROS                                 99
     C   99WSM33         COMP      *ZEROS                                 99
     C   99WSNT4         COMP      *ZEROS                                 99
     C   99WSVT4         COMP      *BLANKS                                99
     C   99WSVS4         COMP      *BLANKS                                99
     C   99WSVKB4        COMP      *ZEROS                                 99
     C   99WSVKN4        COMP      *ZEROS                                 99
     C   99WSM34         COMP      *ZEROS                                 99
     C   99WSFRP         COMP      *BLANKS                                99
     C   99WSHSNR        COMP      *BLANKS                                99
     C   99WSEMS         COMP      *BLANKS                                99
     C   99WSMFAG        COMP      *BLANKS                                99
     C   99WSMP          COMP      *BLANKS                                99
     C   99WSTLF         COMP      *BLANKS                                99
     C   99WSKNVH        COMP      *ZEROS                                 99
     C   99WSNAVH        COMP      *BLANKS                                99
     C   99              DO
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      'DIV3898'     MSGNR
     C                   END
      *
     C                   ELSE
      *
     C     WSKNS         IFNE      0
     C                   MOVE      WSKNS         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            99
     C  N99              MOVE      KNAVN         WSNAS
     C   99              DO
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      'SPK0129'     MSGNR
     C                   END
     C                   END
      *
     C     WSKNVH        IFNE      0
     C                   MOVE      WSKNVH        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            98
     C  N98              MOVE      KNAVN         WSNAVH
     C   98
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      'SPK0008'     MSGNR
     C                   END
     C                   END
      *
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBKW        BEGSR
     C***********************************************
     C                   MOVE      B2KNS         WSKNS
     C                   MOVE      B2NAS         WSNAS
     C                   MOVE      B2ADL         WSADL
     C                   MOVE      B2KDA         WSKDA
     C                   MOVE      B2KDM         WSKDM
     C                   MOVE      B2KDN         WSKDN
     C                   MOVE      B2IMCO        WSIMCO
     C                   MOVE      B2PGNO        WSPGNO
     C                   MOVE      B2UNNO        WSUNNO
     C                   MOVE      B2COC         WSCOC
     C                   MOVE      B2FP          WSFP
     C                   MOVE      B2PG          WSPG
     C                   MOVE      B2NT1         WSNT1
     C                   MOVE      B2VT1         WSVT1
     C                   MOVE      B2VS1         WSVS1
     C                   MOVE      B2VKB1        WSVKB1
     C                   MOVE      B2VKN1        WSVKN1
     C                   MOVE      B2M31         WSM31
     C                   MOVE      B2NT2         WSNT2
     C                   MOVE      B2VT2         WSVT2
     C                   MOVE      B2VS2         WSVS2
     C                   MOVE      B2VKB2        WSVKB2
     C                   MOVE      B2VKN2        WSVKN2
     C                   MOVE      B2M32         WSM32
     C                   MOVE      B2NT3         WSNT3
     C                   MOVE      B2VT3         WSVT3
     C                   MOVE      B2VS3         WSVS3
     C                   MOVE      B2VKB3        WSVKB3
     C                   MOVE      B2VKN3        WSVKN3
     C                   MOVE      B2M33         WSM33
     C                   MOVE      B2NT4         WSNT4
     C                   MOVE      B2VT4         WSVT4
     C                   MOVE      B2VS4         WSVS4
     C                   MOVE      B2VKB4        WSVKB4
     C                   MOVE      B2VKN4        WSVKN4
     C                   MOVE      B2M34         WSM34
     C                   MOVE      B2FRP         WSFRP
     C                   MOVE      B2HSNR        WSHSNR
     C                   MOVE      B2EMS         WSEMS
     C                   MOVE      B2MFAG        WSMFAG
     C                   MOVE      B2MP          WSMP
     C                   MOVE      B2TLF         WSTLF
     C                   MOVE      B2KNVH        WSKNVH
     C                   MOVE      B2NAVH        WSNAVH
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBK2        BEGSR
     C***********************************************
     C     BOOK2K        CHAIN     BOOKIN2                            33
     C                   EXSR      MOVWBK
     C  N33              UPDATE    BOOKIN2R
     C   33              DO
     C                   MOVE      BOAVD         B2AVD
     C                   MOVE      BOOPD         B2OPD
     C                   WRITE     BOOKIN2R
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWBK        BEGSR
     C***********************************************
     C                   MOVE      WSKNS         B2KNS
     C                   MOVE      WSNAS         B2NAS
     C                   MOVE      WSADL         B2ADL
     C                   MOVE      WSKDA         B2KDA
     C                   MOVE      WSKDM         B2KDM
     C                   MOVE      WSKDN         B2KDN
     C                   MOVE      WSIMCO        B2IMCO
     C                   MOVE      WSPGNO        B2PGNO
     C                   MOVE      WSUNNO        B2UNNO
     C                   MOVE      WSCOC         B2COC
     C                   MOVE      WSFP          B2FP
     C                   MOVE      WSPG          B2PG
     C                   MOVE      WSNT1         B2NT1
     C                   MOVE      WSVT1         B2VT1
     C                   MOVE      WSVS1         B2VS1
     C                   MOVE      WSVKB1        B2VKB1
     C                   MOVE      WSVKN1        B2VKN1
     C                   MOVE      WSM31         B2M31
     C                   MOVE      WSNT2         B2NT2
     C                   MOVE      WSVT2         B2VT2
     C                   MOVE      WSVS2         B2VS2
     C                   MOVE      WSVKB2        B2VKB2
     C                   MOVE      WSVKN2        B2VKN2
     C                   MOVE      WSM32         B2M32
     C                   MOVE      WSNT3         B2NT3
     C                   MOVE      WSVT3         B2VT3
     C                   MOVE      WSVS3         B2VS3
     C                   MOVE      WSVKB3        B2VKB3
     C                   MOVE      WSVKN3        B2VKN3
     C                   MOVE      WSM33         B2M33
     C                   MOVE      WSNT4         B2NT4
     C                   MOVE      WSVT4         B2VT4
     C                   MOVE      WSVS4         B2VS4
     C                   MOVE      WSVKB4        B2VKB4
     C                   MOVE      WSVKN4        B2VKN4
     C                   MOVE      WSM34         B2M34
     C                   MOVE      WSFRP         B2FRP
     C                   MOVE      WSHSNR        B2HSNR
     C                   MOVE      WSEMS         B2EMS
     C                   MOVE      WSMFAG        B2MFAG
     C                   MOVE      WSMP          B2MP
     C                   MOVE      WSTLF         B2TLF
     C                   MOVE      WSKNVH        B2KNVH
     C                   MOVE      WSNAVH        B2NAVH
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     POSNBR        IFGE      19
     C     POSNBR        ANDLE     26
     C                   SELECT
     C     LINNBR        WHENEQ    4
     C   54              MOVE      SOTXT1        XSKMOT            8
     C   54              MOVE      WSKNS         XSKKNR            8 0
     C   54              GOTO      STVISO
     C     LINNBR        WHENEQ    6
     C   53              MOVE      SOTXT2        XSKMOT
     C   53              MOVE      WSKNVH        XSKKNR
     C   53              GOTO      STVISO
     C                   ENDSL
     C                   END
     C*
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
     C*
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR
     C                   PARM                    XSKMOT
     C                   PARM                    UFLAGG
     C                   PARM                    HEUR01
     C*
     C*
     C     SLVISO        ENDSR
     C*
S01  C***********************************************
S01  C*    SØKKUN        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNS
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNVH
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     POSNBR        IFGE      19
     C     POSNBR        ANDLE     26
     C     LINNBR        IFEQ      4
S01  C*                  EXSR      SØKKUN
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAS
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      6
S01  C*                  EXSR      SØKKUN
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNVH
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAVH
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BOOKK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     BOOK2K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     BOK2K2        KLIST
     C                   KFLD                    BOAVDK
     C                   KFLD                    BOOPDK
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     FREETK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     FRATXK        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    HEUR01            1
     C                   MOVE      'F'           HEUR01            1
     C     FRAT2K        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    HEUR02            1
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C                   MOVE      *ZEROS        YFXLNR            2 0
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        BODTR
     C*
     C                   MOVE      'DIV3161'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT1            8
     C                   MOVE      'DIV3905'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C*
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   SETOFF                                       33
     C                   READ      FIRM                                   33
     C*
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              EXSR      KDTFMT
     C     BOOK2K        CHAIN     BOOKIN2                            33
     C   33BOAVDK        IFNE      0
     C     BOK2K2        CHAIN     BOOKIN2                            33
     C                   END
     C  N33              EXSR      MOVBKW
     C  N33              UPDATE    BOOKIN2R
N02  C     BOOKK         CHAIN     BILLOF                             33
N02  C  N33              MOVE      BLUR          HEUR01
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BODTRD        UDT1              2 0
     C                   MOVE      BODTRM        UDT2              2 0
     C                   MOVE      BODTRÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C     FREETK        SETLL     FREETXT
     C     FREETK        READE     FREETXT                                29
     C*
     C     WSKNS         IFNE      0
     C                   MOVE      WSKNS         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        54
     C                   END
     C*
     C     WSKNVH        IFNE      0
     C                   MOVE      WSKNVH        KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        53
     C                   END
     C*
     C                   ENDSR
     C*
