      *
      ***********************************************************
      *** PROGRAM SKAL KONVERTERE TOLLSTEDSKODER              ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05-11 13-26                ***
      *** LEDIGE INDIKATORER 27-98                            ***
      ***********************************************************
     FSVXKODL01 UF A E           K DISK
     FSVTKD     IF   E           K DISK
     FPARTTCL1  IF   E           K DISK
     FSVX005D   CF   E             WORKSTN
     D TABELL          S              1    DIM(26) CTDATA PERRCD(1) ASCEND
     D TABTXT          S              1    DIM(26) ALT(TABELL)
     D                 DS
     D  TXT1                   1     35
     D  TXT2                   1     35    DIM(35)
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVE      '0'           *IN99
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLK = UKD
     C                   END
     C     WSLK          CABEQ     *BLANKS       START
     C                   END
      *
     C                   EVAL      SVKD_KD = WSLK
     C     SVTKDK        CHAIN     SVTKD                              99
     C     *IN99         IFEQ      '1'
     C                   MOVE      'SPL0013'     MSGNR
     C                   GOTO      START
     C                   END
      *
     C                   MOVEL     WSLK          PL1KEY            8
     C                   MOVEL     WSLK          PL1KEY2           8
     C     PL1KEY        SETLL     PARTTCL1
     C                   READ      PARTTCL1                               33
     C  N33PL1KEY2       COMP      N13036A                              33
      *
     C     START2        TAG
     C                   EXFMT     BILDE02
     C                   MOVE      '0'           *IN99
      *                                                                3
     C   12              GOTO      START
      *
     C     WS01          IFEQ      ' '
     C     WS02          ANDEQ     ' '
     C     WS03          ANDEQ     ' '
     C     WS04          ANDEQ     ' '
     C                   MOVE      'SVX1840'     MSGNR
     C                   MOVE      '1'           *IN99
     C                   GOTO      START2
     C                   END
      *
      * SLETT GAMLE TOLLSTEDSKODER
     C                   MOVEL     WSLK          XKKODE
     C                   MOVEL     WSLK          XKKODE2
     C     SVXKODL1K     SETLL     SVXKODL01
     C     XKUNIK        READE     SVXKODL01                              33
     C  N33XKKODE2       COMP      TKKODE                               33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SVXKODFR
     C     XKUNIK        READE     SVXKODL01                              33
     C  N33XKKODE2       COMP      TKKODE                               33
     C  N33              ENDDO
      *
      * LAGER NYE TOLLSTEDSKODER
     C                   MOVE      *BLANKS       XXKODE           10
     C                   MOVE      '106'         TKUNIK
     C     PL1KEY        SETLL     PARTTCL1
     C                   READ      PARTTCL1                               33
     C  N33PL1KEY2       COMP      N13036A                              33
     C                   DOW       *IN33 = *OFF
     C                   MOVEL     N13036A       XXKODE2          10
     C                   IF        XXKODE2 <> XXKODE
     C                   IF        XXTXTN <> *BLANKS
     C                   MOVEL     XXKODE        TKKODE
     C                   MOVEL     XXTXTN        TXT1
     C     1             DO        35            XNR               3 0
     C                   MOVE      TXT2(XNR)     XTEGN             1
     C     XTEGN         LOOKUP    TABELL        TABTXT                   33
     C                   IF        *IN33 = *ON
     C                   MOVE      TABTXT        TXT2(XNR)
     C                   END
     C                   ENDDO
     C                   MOVEL     TXT1          TKTXTN
     C                   MOVEL     XXTXTE        TXT1
     C     1             DO        35            XNR               3 0
     C                   MOVE      TXT2(XNR)     XTEGN             1
     C     XTEGN         LOOKUP    TABELL        TABTXT                   33
     C                   IF        *IN33 = *ON
     C                   MOVE      TABTXT        TXT2(XNR)
     C                   END
     C                   ENDDO
     C                   MOVEL     TXT1          TKTXTE
     C     F44453A       IFEQ      'DES'
     C     F44453B       OREQ      'DES'
     C     F44453C       OREQ      'DES'
     C     F44453D       OREQ      'DES'
     C     F44453E       OREQ      'DES'
     C     F44453F       OREQ      'DES'
     C                   MOVE      'J'           TKANK
     C                   ELSE
     C                   MOVE      'N'           TKANK
     C                   END
     C     F44453A       IFEQ      'DEP'
     C     F44453B       OREQ      'DEP'
     C     F44453C       OREQ      'DEP'
     C     F44453D       OREQ      'DEP'
     C     F44453E       OREQ      'DEP'
     C     F44453F       OREQ      'DEP'
     C                   MOVE      'J'           TKAVG
     C                   ELSE
     C                   MOVE      'N'           TKAVG
     C                   END
     C     F44453A       IFEQ      'TRA'
     C     F44453B       OREQ      'TRA'
     C     F44453C       OREQ      'TRA'
     C     F44453D       OREQ      'TRA'
     C     F44453E       OREQ      'TRA'
     C     F44453F       OREQ      'TRA'
     C                   MOVE      'J'           TKTRS
     C                   ELSE
     C                   MOVE      'N'           TKTRS
     C                   END
     C                   WRITE     SVXKODFR
     C                   MOVE      *BLANKS       XXKODE
     C                   MOVE      *BLANKS       XXDATO            8
     C                   MOVE      *BLANKS       XXTXTN
     C                   END
     C                   END
     C                   IF        F24440B > XXDATO
     C                   MOVE      XXKODE2       XXKODE
     C                   MOVEL     F24440B       XXDATO
     C                   SELECT
     C                   WHEN      WS01 = 'X'
     C                   MOVEL     L43224C1      XXTXTN           35
     C                   MOVEL     L43224C1      XXTXTE           35
     C                   WHEN      WS02 = 'X'
     C                   MOVEL     L43224C2      XXTXTN
     C                   MOVEL     L43224C2      XXTXTE
     C                   WHEN      WS03 = 'X'
     C                   MOVEL     T24052B       XXTXTN
     C                   MOVEL     T24052B       XXTXTE
     C                   WHEN      WS04 = 'X'
     C                   MOVEL     T24052D       XXTXTN
     C                   MOVEL     T24052D       XXTXTE
     C                   ENDSL
     C                   END
     C                   IF        F24440C = '0'
     C                   MOVE      *BLANKS       XXKODE
     C                   MOVE      *BLANKS       XXDATO            8
     C                   MOVE      *BLANKS       XXTXTN
     C                   END
     C                   READ      PARTTCL1                               33
     C  N33PL1KEY2       COMP      N13036A                              33
     C  N33              ENDDO
      *
     C                   IF        XXTXTN <> *BLANKS
     C                   MOVEL     XXKODE        TKKODE
     C                   MOVEL     XXTXTN        TXT1
     C     1             DO        35            XNR               3 0
     C                   MOVE      TXT2(XNR)     XTEGN             1
     C     XTEGN         LOOKUP    TABELL        TABTXT                   33
     C                   IF        *IN33 = *ON
     C                   MOVE      TABTXT        TXT2(XNR)
     C                   END
     C                   ENDDO
     C                   MOVEL     TXT1          TKTXTN
     C                   MOVEL     XXTXTE        TXT1
     C     1             DO        35            XNR               3 0
     C                   MOVE      TXT2(XNR)     XTEGN             1
     C     XTEGN         LOOKUP    TABELL        TABTXT                   33
     C                   IF        *IN33 = *ON
     C                   MOVE      TABTXT        TXT2(XNR)
     C                   END
     C                   ENDDO
     C                   MOVEL     TXT1          TKTXTE
     C     F44453A       IFEQ      'DES'
     C     F44453B       OREQ      'DES'
     C     F44453C       OREQ      'DES'
     C     F44453D       OREQ      'DES'
     C     F44453E       OREQ      'DES'
     C     F44453F       OREQ      'DES'
     C                   MOVE      'J'           TKANK
     C                   ELSE
     C                   MOVE      'N'           TKANK
     C                   END
     C     F44453A       IFEQ      'DEP'
     C     F44453B       OREQ      'DEP'
     C     F44453C       OREQ      'DEP'
     C     F44453D       OREQ      'DEP'
     C     F44453E       OREQ      'DEP'
     C     F44453F       OREQ      'DEP'
     C                   MOVE      'J'           TKAVG
     C                   ELSE
     C                   MOVE      'N'           TKAVG
     C                   END
     C     F44453A       IFEQ      'TRA'
     C     F44453B       OREQ      'TRA'
     C     F44453C       OREQ      'TRA'
     C     F44453D       OREQ      'TRA'
     C     F44453E       OREQ      'TRA'
     C     F44453F       OREQ      'TRA'
     C                   MOVE      'J'           TKTRS
     C                   ELSE
     C                   MOVE      'N'           TKTRS
     C                   END
     C                   WRITE     SVXKODFR
     C                   END
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     SVTKDK        KLIST
     C                   KFLD                    SVKD_IE
     C                   KFLD                    SVKD_TYP
     C                   KFLD                    SVKD_KD
     C     SVXKODL1K     KLIST
     C                   KFLD                    XKUNIK            3
     C                   KFLD                    XKKODE           10
      *
     C                   MOVE      'GCY'         SVKD_TYP
     C                   MOVE      'A'           SVKD_IE
     C                   MOVE      '106'         XKUNIK
     C                   MOVE      '106'         TKUNIK
     C                   MOVE      '9999999999'  XKKODE2          10
     C                   MOVE      '99999999'    PL1KEY2           8
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTD               6
      *
     C                   ENDSR
      *
**
aA
bB
cC
dD
eE
fF
gG
hH
iI
jJ
kK
lL
mM
nN
oO
pP
qQ
rR
sS
tT
uU
vV
wW
xX
yY
zZ
