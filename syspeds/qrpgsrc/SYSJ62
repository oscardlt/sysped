********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE LOKALKONNOSSEMENT         ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24          ***
      *** LEDIGE INDIKATORER 28 29 31 32 34-39 41-78 95-97    ***
      ***********************************************************
      *
     FBLLOKSTD  UF A E           K DISK
     FBLLOKST2  IF   E           K DISK    RENAME(BLLOKSTR:BLLOKS2R)
     FFIRM      IF   E           K DISK
     FCDBLF     IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYSJ62FM  CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XDLT                   1      7
     D  BENA                   1     30
     D                 DS
     D  BEDTÅ                  1      4  0
     D  BEDTM                  5      6  0
     D  BEDTD                  7      8  0
     D  BEDT                   1      8  0
     D                 DS
     D  WEDTD                  1      2  0
     D  WEDTM                  3      4  0
     D  WEDTÅ                  5      6  0
     D  WEDT                   1      6  0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     W2NA          SETLL     BLLOKST2
     C     START1        TAG
     C                   READ      BLLOKST2                               94
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   READ      BLLOKST2                               94
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       989930
     C*
     C   03              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE NY
     C   06              DO
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     24            POSNBR
     C                   GOTO      START5
     C                   END
     C*** SØK
     C   08              GOTO      START6
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   27WSNR          IFEQ      '1'
     C                   GOTO      SLUTT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
     C*
     C*** LAGE NY
     C     START5        TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE01
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000'       *IN(78)
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START5
     C                   END
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C  N12              EXSR      OPDBL
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C                   GOTO      START3
     C*
     C*** SØK
     C     START6        TAG
     C                   EXFMT     SØKLNR
     C   12              GOTO      START3
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C*
     C*** LOKALKONNOSSEMENTNR.
     C  N40              DO
     C     WSOPDL        COMP      0                                      90
     C   90              MOVE      'SPL0105'     MSGNR
     C  N90              DO
     C     WSOPDL        CHAIN     BLLOKSTD                           33
     C  N33              DO
     C                   UPDATE    BLLOKSTR
     C                   SETON                                        90
     C                   MOVE      'SPL0106'     MSGNR
     C                   END
     C                   END
     C   90              Z-ADD     3             LINNBR
     C   90              Z-ADD     24            POSNBR
     C   90              SETON                                        30
     C                   END
     C*
     C*** BESKRIVELSE AV LOKALKONNOSSEMENT
     C     WSNA          COMP      *BLANKS                                89
     C   89
     CANN30              DO
     C                   MOVE      'SPN0103'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
     C   89              SETON                                        30
     C*
     C*** AVSENDER
     C     WSKNA         IFNE      0
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            88
     C   88
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0126'     MSGNR
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     6             POSNBR
     C                   END
     C  N88WSNAA         IFEQ      *BLANKS
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSAD1A
     C                   MOVE      ADR2          WSAD2A
     C                   MOVE      *BLANKS       WSAD3A
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSAD3A
     C                   ELSE
     C                   MOVEL     POSTNR        WSAD3A
     C                   MOVE      ADR3          WSAD3A
     C                   END
     C                   END
     C                   END
     C*
     C*** MOTTAGER
     C     WSKNM         IFNE      0
     C                   MOVE      WSKNM         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            87
     C   87
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0126'     MSGNR
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     6             POSNBR
     C                   END
     C  N87WSNAM         IFEQ      *BLANKS
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSAD1M
     C                   MOVE      ADR2          WSAD2M
     C                   MOVE      *BLANKS       WSAD3M
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSAD3M
     C                   ELSE
     C                   MOVEL     POSTNR        WSAD3M
     C                   MOVE      ADR3          WSAD3M
     C                   END
     C                   END
     C                   END
     C*
     C*** NOTIFY
     C     WSKNN         IFNE      0
     C                   MOVE      WSKNN         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            86
     C   86
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0126'     MSGNR
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     6             POSNBR
     C                   END
     C  N86WSNAN         IFEQ      *BLANKS
     C                   MOVE      KNAVN         WSNAN
     C                   MOVE      ADR1          WSAD1N
     C                   MOVE      ADR2          WSAD2N
     C                   MOVE      *BLANKS       WSAD3N
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSAD3M
     C                   ELSE
     C                   MOVEL     POSTNR        WSAD3N
     C                   MOVE      ADR3          WSAD3N
     C                   END
     C                   END
     C                   END
     C*
     C*** LAYOUT AV BILL OF LADING
     C     WSKDP         IFNE      *BLANKS
     C     WSKDP         CHAIN     CDBLF                              85
     C   85
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0130'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   END
     C                   END
     C*
     C*** SHIPPERS ACCOUNT
     C     WSKDSA        COMP      ' '                                8484
     C   84WSKDSA        COMP      'X'                                8484
     C   84
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0127'     MSGNR
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     37            POSNBR
     C                   END
     C*
     C*** RECEIVERS ACCOUNT
     C     WSKDRA        COMP      ' '                                8383
     C   83WSKDRA        COMP      'X'                                8383
     C   83
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0127'     MSGNR
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     37            POSNBR
     C                   END
     C*
     C*** THROUGHFREIGHT
     C     WSKDTF        COMP      ' '                                8282
     C   82WSKDTF        COMP      'X'                                8282
     C   82
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0127'     MSGNR
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     37            POSNBR
     C                   END
     C*
     C*** COLL./PPD.
     C     WSKDCP        COMP      ' '                                8181
     C   81WSKDCP        COMP      'C'                                8181
     C   81WSKDCP        COMP      'P'                                8181
     C   81
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPK0128'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   END
     C*
     C*** STED
     C     WSSD          IFNE      *BLANKS
     C     WSSD          CHAIN     STED2                              80
     C   80
     CANN30              DO
     C                   SETON                                        30
     C                   MOVE      'SPS0107'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   END
     C                   END
     C*
     C*** TEST DATO
     C     WSDT          IFNE      0
     C                   MOVE      WSDTÅ         UÅÅ               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      79
     C   79
     CANN30              DO
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     64            POSNBR
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBL         BEGSR
     C***********************************************
     C     WSOPDL        CHAIN     BLLOKSTD                           33
     C                   EXSR      MOVWBL
     C   33              WRITE     BLLOKSTR
     C  N33              UPDATE    BLLOKSTR
     C*
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   EXSR      MOVB2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C   27WSNR          IFEQ      '1'
     C                   MOVE      BEOPDL        UOPDL
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              MOVE      'SPF0018'     MSGNR
     C   98              SETON                                            30
     C   98              GOTO      SLHENT
     C                   EXSR      CHGBL
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              MOVE      'SPF0018'     MSGNR
     C   98              SETON                                            30
     C   98              GOTO      SLHENT
     C                   EXSR      DLTBL
     C   12              GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     4             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLTBL         BEGSR
     C***********************************************
     C                   SETON                                        99
     C     BEOPDL        CHAIN     BLLOKSTD                           33
     C  N33              UPDATE    BLLOKSTR
     C*
     C                   EXSR      KDTFM2
     C                   EXFMT     BILDE02
     C  N12              DO
     C     BEOPDL        CHAIN     BLLOKSTD                           33
     C  N33              DELETE    BLLOKSTR
     C                   EXSR      MOVB1
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGBL         BEGSR
     C***********************************************
     C                   EXSR      MOVBLW
     C                   SETON                                        99
     C     STCHG         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE01
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000'       *IN(78)
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
     C   12              DO
     C                   UPDATE    SUBFIL
     C                   EXSR      MOVB2
     C                   END
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
     C  N12              EXSR      OPDBL
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBLW        BEGSR
     C***********************************************
     C     BEOPDL        CHAIN     BLLOKSTD                           33
     C  N33              DO
     C                   UPDATE    BLLOKSTR
     C                   MOVE      BEOPDL        WSOPDL
     C                   MOVE      BENA          WSNA
     C                   MOVE      BEKNA         WSKNA
     C                   MOVE      BENAA         WSNAA
     C                   MOVE      BEAD1A        WSAD1A
     C                   MOVE      BEAD2A        WSAD2A
     C                   MOVE      BEAD3A        WSAD3A
     C                   MOVE      BEKNM         WSKNM
     C                   MOVE      BENAM         WSNAM
     C                   MOVE      BEAD1M        WSAD1M
     C                   MOVE      BEAD2M        WSAD2M
     C                   MOVE      BEAD3M        WSAD3M
     C                   MOVE      BEKNN         WSKNN
     C                   MOVE      BENAN         WSNAN
     C                   MOVE      BEAD1N        WSAD1N
     C                   MOVE      BEAD2N        WSAD2N
     C                   MOVE      BEAD3N        WSAD3N
     C                   MOVE      BEKDP         WSKDP
     C                   MOVE      BEMN          WSMN
     C                   MOVE      BEFT          WSFT
     C                   MOVE      BEKDSA        WSKDSA
     C                   MOVE      BEKDRA        WSKDRA
     C                   MOVE      BEKDTF        WSKDTF
     C                   MOVE      BEKDCP        WSKDCP
     C                   MOVE      BENTBS        WSNTBS
     C                   MOVE      BESD          WSSD
     C                   MOVE      BEDTD         WSDTD
     C                   MOVE      BEDTM         WSDTM
     C                   MOVE      BEDTÅ         WSDTÅ
     C                   END
     C                   SETON                                        40
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     33            POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWBL        BEGSR
     C***********************************************
     C                   MOVE      WSOPDL        BEOPDL
     C                   MOVE      WSNA          BENA
     C                   MOVE      WSKNA         BEKNA
     C                   MOVE      WSNAA         BENAA
     C                   MOVE      WSAD1A        BEAD1A
     C                   MOVE      WSAD2A        BEAD2A
     C                   MOVE      WSAD3A        BEAD3A
     C                   MOVE      WSKNM         BEKNM
     C                   MOVE      WSNAM         BENAM
     C                   MOVE      WSAD1M        BEAD1M
     C                   MOVE      WSAD2M        BEAD2M
     C                   MOVE      WSAD3M        BEAD3M
     C                   MOVE      WSKNN         BEKNN
     C                   MOVE      WSNAN         BENAN
     C                   MOVE      WSAD1N        BEAD1N
     C                   MOVE      WSAD2N        BEAD2N
     C                   MOVE      WSAD3N        BEAD3N
     C                   MOVE      WSKDP         BEKDP
     C                   MOVE      WSMN          BEMN
     C                   MOVE      WSFT          BEFT
     C                   MOVE      WSKDSA        BEKDSA
     C                   MOVE      WSKDRA        BEKDRA
     C                   MOVE      WSKDTF        BEKDTF
     C                   MOVE      WSKDCP        BEKDCP
     C                   MOVE      WSNTBS        BENTBS
     C                   MOVE      WSSD          BESD
     C                   MOVE      WSDTD         BEDTD
     C                   MOVE      WSDTM         BEDTM
     C     WSDT          IFEQ      0
     C                   MOVE      *ZEROS        BEDT
     C                   ELSE
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          BEDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          BEDTÅ
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        BEOPDL
     C                   MOVE      *BLANKS       BENA
     C                   MOVE      '*DELETE'     XDLT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *ZEROS        WSOPDL
     C                   MOVE      *BLANKS       WSNA
     C                   MOVE      *ZEROS        WSKNA
     C                   MOVE      *BLANKS       WSNAA
     C                   MOVE      *BLANKS       WSAD1A
     C                   MOVE      *BLANKS       WSAD2A
     C                   MOVE      *BLANKS       WSAD3A
     C                   MOVE      *ZEROS        WSKNM
     C                   MOVE      *BLANKS       WSNAM
     C                   MOVE      *BLANKS       WSAD1M
     C                   MOVE      *BLANKS       WSAD2M
     C                   MOVE      *BLANKS       WSAD3M
     C                   MOVE      *ZEROS        WSKNN
     C                   MOVE      *BLANKS       WSNAN
     C                   MOVE      *BLANKS       WSAD1N
     C                   MOVE      *BLANKS       WSAD2N
     C                   MOVE      *BLANKS       WSAD3N
     C                   MOVE      *BLANKS       WSKDP
     C                   MOVE      *BLANKS       WSMN
     C                   MOVE      *BLANKS       WSFT
     C                   MOVE      *BLANKS       WSKDSA
     C                   MOVE      *BLANKS       WSKDRA
     C                   MOVE      *BLANKS       WSKDTF
     C                   MOVE      *BLANKS       WSKDCP
     C                   MOVE      *BLANKS       WSNTBS
     C                   MOVE      *ZEROS        WSDT
     C*
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    SØKKUN        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNA
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNM
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    WSKNN
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
S01  C*                  EXSR      SØKKUN
S01  C*                  Z-ADD     10            LINNBR
S01  C*                  Z-ADD     19            POSNBR
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAA
N01  C                   Z-ADD     6             LINNBR
N01  C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
S01  C*                  EXSR      SØKKUN
S01  C*                  Z-ADD     10            LINNBR
S01  C*                  Z-ADD     19            POSNBR
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNM
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAM
N01  C                   Z-ADD     8             LINNBR
N01  C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
S01  C*                  EXSR      SØKKUN
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNN
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAN
N01  C                   Z-ADD     8             LINNBR
N01  C                   Z-ADD     6             POSNBR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     14
     C     POSNBR        ANDLE     21
S01  C*                  EXSR      SØKKUN
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAS
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     24            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   Z-ADD     1             UFLAGG
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     23
     C                   CALL      'SYSJ14A'
     C                   PARM                    WSKDP
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     55
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSD
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     64            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    UOPDL             7 0
     C     UFLAGG        COMP      1                                      27
     C*
S01  C*                  Z-ADD     3             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C                   MOVE      *ZEROS        BEDT
     C                   MOVE      *ZEROS        WSDT
     C*
S01  C*                  MOVE      'DIV3110'     XMSGNR            7            MELDING-ID
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIVÅ
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV3159'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*                  MOVE      'DIV3160'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT3            8
     C*
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   SETOFF                                       33
     C                   READ      FIRM                                   33
     C*
     C   27              WRITE     NYWRK
     C   27              EXFMT     SØKLNR
     C*
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    HENTMS        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    XMSG             62
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      BEDTD         UDT1              2 0
     C                   MOVE      BEDTM         UDT2              2 0
     C                   MOVE      BEDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WEDTD
     C                   MOVE      UDT2          WEDTM
     C                   MOVE      UDT3          WEDTÅ
     C*
     C                   ENDSR
     C*
