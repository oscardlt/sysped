********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 ARKIVERING
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT FREIGHT MANIFEST             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 35-99                      ***
      ***********************************************************
      *
     FFRMDOC    UF   E           K DISK
     FFRMDOC1   IF   E           K DISK
     FFRMDOC2   IF   E           K DISK
     FFRMDOC3   IF   E           K DISK
     FBILLOF    IF   E           K DISK
     FBOOKING   IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FFIRM      IF   E           K DISK
N01  FARKTXT    IF   E           K DISK
N01  FFIRMARC   IF   E           K DISK
N01  FARKIVL03  IF   E           K DISK    RENAME(ARKIVR:ARKIVR03)
N01  FARKIVP    O  A E             DISK    USROPN
     FSYSJ26P   O    E             PRINTER
     D                 DS
     D  FMFT11                 1     30
     D  FMFT12                31     60
     D  FMFT13                61     90
     D  FMFT14                91    120
     D  FMFT15               121    150
     D  FMFT16               151    180
     D  FMFT17               181    210
     D  FMFT18               211    240
     D  FMFT19               241    270
     D  FMFT1A               271    300
     D  FT1                    1    300
     D                                     DIM(10)
     D                 DS
     D  FMKU11                 1      7  4
     D  FMKU12                 8     14  4
     D  FMKU13                15     21  4
     D  FMKU14                22     28  4
     D  FMKU15                29     35  4
     D  FMKU16                36     42  4
     D  FMKU17                43     49  4
     D  FMKU18                50     56  4
     D  FMKU19                57     63  4
     D  FMKU1A                64     70  4
     D  KU1                    1     70  4
     D                                     DIM(10)
     D                 DS
     D  FMVA11                 1      3
     D  FMVA12                 4      6
     D  FMVA13                 7      9
     D  FMVA14                10     12
     D  FMVA15                13     15
     D  FMVA16                16     18
     D  FMVA17                19     21
     D  FMVA18                22     24
     D  FMVA19                25     27
     D  FMVA1A                28     30
     D  VA1                    1     30
     D                                     DIM(10)
     D                 DS
     D  FMPR11                 1     13  2
     D  FMPR12                14     26  2
     D  FMPR13                27     39  2
     D  FMPR14                40     52  2
     D  FMPR15                53     65  2
     D  FMPR16                66     78  2
     D  FMPR17                79     91  2
     D  FMPR18                92    104  2
     D  FMPR19               105    117  2
     D  FMPR1A               118    130  2
     D  PR1                    1    130  2
     D                                     DIM(10)
     D                 DS
     D  FMCO11                 1     13  2
     D  FMCO12                14     26  2
     D  FMCO13                27     39  2
     D  FMCO14                40     52  2
     D  FMCO15                53     65  2
     D  FMCO16                66     78  2
     D  FMCO17                79     91  2
     D  FMCO18                92    104  2
     D  FMCO19               105    117  2
     D  FMCO1A               118    130  2
     D  CO1                    1    130  2
     D                                     DIM(10)
     D                 DS
     D  FMVA21                 1      3
     D  FMVA22                 4      6
     D  FMVA23                 7      9
     D  FMVA24                10     12
     D  FMVA25                13     15
     D  VA2                    1     15
     D                                     DIM(5)
     D                 DS
     D  FMPR21                 1     13  2
     D  FMPR22                14     26  2
     D  FMPR23                27     39  2
     D  FMPR24                40     52  2
     D  FMPR25                53     65  2
     D  PR2                    1     65  2
     D                                     DIM(5)
     D                 DS
     D  FMKU21                 1      7  4
     D  FMKU22                 8     14  4
     D  FMKU23                15     21  4
     D  FMKU24                22     28  4
     D  FMKU25                29     35  4
     D  KU2                    1     35  4
     D                                     DIM(5)
     D                 DS
     D  FMVA2A                 1      3
     D  FMVA2B                 4      6
     D  FMVA2C                 7      9
     D  FMVA2D                10     12
     D  FMVA2E                13     15
     D  V22                    1     15
     D                                     DIM(5)
     D                 DS
     D  FMP221                 1     13  2
     D  FMP222                14     26  2
     D  FMP223                27     39  2
     D  FMP224                40     52  2
     D  FMP225                53     65  2
     D  P22                    1     65  2
     D                                     DIM(5)
     D                 DS
     D  FMVA31                 1      3
     D  FMVA32                 4      6
     D  FMVA33                 7      9
     D  FMVA34                10     12
     D  FMVA35                13     15
     D  FMVA36                16     18
     D  FMVA37                19     21
     D  FMVA38                22     24
     D  FMVA39                25     27
     D  FMVA3A                28     30
     D  FMVA3B                31     33
     D  VA3                    1     33
     D                                     DIM(11)
     D                 DS
     D  FMAM31                 1     13  2
     D  FMAM32                14     26  2
     D  FMAM33                27     39  2
     D  FMAM34                40     52  2
     D  FMAM35                53     65  2
     D  FMAM36                66     78  2
     D  FMAM37                79     91  2
     D  FMAM38                92    104  2
     D  FMAM39               105    117  2
     D  FMAM3A               118    130  2
     D  FMAM3B               131    143  2
     D  AM3                    1    143  2
     D                                     DIM(11)
     D                 DS
     D  FMKU31                 1      7  4
     D  FMKU32                 8     14  4
     D  FMKU33                15     21  4
     D  FMKU34                22     28  4
     D  FMKU35                29     35  4
     D  FMKU36                36     42  4
     D  FMKU37                43     49  4
     D  FMKU38                50     56  4
     D  FMKU39                57     63  4
     D  FMKU3A                64     70  4
     D  FMKU3B                71     77  4
     D  KU3                    1     77  4
     D                                     DIM(11)
     D                 DS
     D  FMLC31                 1     13  2
     D  FMLC32                14     26  2
     D  FMLC33                27     39  2
     D  FMLC34                40     52  2
     D  FMLC35                53     65  2
     D  FMLC36                66     78  2
     D  FMLC37                79     91  2
     D  FMLC38                92    104  2
     D  FMLC39               105    117  2
     D  FMLC3A               118    130  2
     D  FMLC3B               131    143  2
     D  LC3                    1    143  2
     D                                     DIM(11)
     D                 DS
     D  FMNAA                  1     30
     D  FMNAA2                 1     28
     D  FMNAA3                 1     30
     D                 DS
     D  FMDTÅ                  1      4  0
     D  FMDTM                  5      6  0
     D  FMDTD                  7      8  0
     D  FMDT                   1      8  0
     D                 DS
     D  XDTD                   1      2  0
     D  XDTM                   3      4  0
     D  XDTÅ                   5      6  0
     D  XDT                    1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
N01  D                SDS
N01  D  UUSER                254    263
     C*
     C                   EXSR      INIT
      *
     C     FRMDOK        SETLL     FRMDOC
     C     START         TAG
     C     UAVD          READE     FRMDOC                                 33
     C  N33UOPDT         COMP      FMOPD                                33
     C  N33              DO
     C     BILLK         CHAIN     BILLOF                             34
     C  N34USG           IFNE      'ALL'
     C     USG           ANDNE     BLSG
     C                   EXCEPT    UPDFRM
     C                   GOTO      START
     C                   END
     C   34              EXCEPT    UPDFRM
     C   34              GOTO      START
      *
     C     BILLK         CHAIN     BOOKING                            34
     C   34              MOVE      *BLANKS       BOREFN
     C                   MOVE      *BLANKS       FT1
     C                   MOVE      *ZEROS        KU1
     C                   MOVE      *BLANKS       VA1
     C                   MOVE      *ZEROS        PR1
     C                   MOVE      *ZEROS        CO1
     C                   MOVE      *BLANKS       VA2
     C                   MOVE      *ZEROS        PR2
     C                   MOVE      *ZEROS        KU2
     C                   MOVE      *ZEROS        P22
     C                   MOVE      *BLANKS       VA3
     C                   MOVE      *ZEROS        AM3
     C                   MOVE      *ZEROS        KU3
     C                   MOVE      *ZEROS        LC3
      *
     C     FRMD1K        SETLL     FRMDOC1                            34
     C     START1        TAG
     C     FRMD1K        READE     FRMDOC1                                34
     C  N34              EXSR      MOVFW1
     C  N34              GOTO      START1
     C     FRMD2K        SETLL     FRMDOC2                            34
     C     START2        TAG
     C     FRMD2K        READE     FRMDOC2                                34
     C  N34              EXSR      MOVFW2
     C  N34              GOTO      START2
     C     FRMD3K        SETLL     FRMDOC3                            34
     C     START3        TAG
     C     FRMD3K        READE     FRMDOC3                                34
     C  N34              EXSR      MOVFW3
     C  N34              GOTO      START3
      *
     C     FMOB          CHAIN     CDBOAT                             34
     C   34              MOVE      *BLANKS       CBNAB
     C   34              MOVEL     FMOB          CBNAB
     C                   MOVE      FMDTÅ         XDTÅ
     C                   MOVE      FMDTM         XDTM
     C                   MOVE      FMDTD         XDTD
     C     FMBLNR        IFEQ      *BLANKS
     C     BLBLNR        IFEQ      *BLANKS
     C                   MOVE      BLBBLN        FMBLNR
     C                   ELSE
     C                   MOVE      BLBLNR        FMBLNR
     C                   END
     C                   END
     C                   WRITE     PFMANIF
     C                   MOVE      'P'           FMST
     C                   EXCEPT    UPDFRM
N01   *
N01  C                   exsr      arkivsr
N01   *
     C                   GOTO      START
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     MOVFW1        BEGSR
     C******************************************
     C                   MOVE      FMLN          XN                2 0
     C                   MOVE      FMFT1         FT1(XN)
     C                   MOVE      FMKU1         KU1(XN)
     C                   MOVE      FMVA1         VA1(XN)
     C                   MOVE      FMPR1         PR1(XN)
     C                   MOVE      FMCO1         CO1(XN)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVFW2        BEGSR
     C******************************************
     C                   MOVE      FMLN          XN
     C                   MOVE      FMKU2         KU2(XN)
     C                   MOVE      FMVA2         VA2(XN)
     C                   MOVE      FMPR2A        PR2(XN)
     C                   MOVE      FMPR2B        P22(XN)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVFW3        BEGSR
     C******************************************
     C                   MOVE      FMLN          XN
     C                   MOVE      FMKU3         KU3(XN)
     C                   MOVE      FMVA3         VA3(XN)
     C                   MOVE      FMAM3         AM3(XN)
     C                   MOVE      FMLC3         LC3(XN)
     C*
     C                   ENDSR
     C*
N01   *=====================================================================
N01  C     ARKIVSR       BEGSR
N01   *=====================================================================
N01  C     ARKIVL03K     CHAIN     ARKIVL03                           33
N01  C                   IF        *IN33
N01  C     UFIRM         CHAIN     FIRMARC                            33
N01  C                   IF        *IN33 = *OFF
N01  C     'bo'          CHAIN     ARKTXT                             33
N01  C  N33              IF        ARKJN = 'J'
N01   *
N01  C                   OPEN      ARKIVP
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      UFIRM         ARFIRM
N01  C                   MOVE      BOAVD         ARAVD
N01  C                   MOVE      BOOPD         AROPD
N01  C                   EVAL      ARUNDE = XARUNDE
N01  C                   MOVE      'bo'          ARTYPE
N01  C                   MOVE      UUSER         ARUSER
N01  C                   MOVE      WDT           ARDATE
N01  C                   MOVE      WTM           ARTIME
N01  C                   MOVE      *ZEROS        ARKUND
N01  C                   WRITE     ARKIVR
N01  C                   CLOSE     ARKIVP
N01  C                   CALL      'ARC002CLB'
N01  C                   PARM                    ARTYPE
N01  C                   PARM                    ARUSER
N01  C                   END
N01  C                   END
N01  C                   END
N01   *
N01  C                   ENDSR
N01   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     FRMDOK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPDF
     C     FRMD1K        KLIST
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C     FRMD2K        KLIST
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C     FRMD3K        KLIST
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C     BILLK         KLIST
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
N01  C     ARKIVL03K     KLIST
N01  C                   KFLD                    XARTYPE
N01  C                   KFLD                    BOAVD
N01  C                   KFLD                    BOOPD
N01  C                   KFLD                    XARUNDE
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UOPDF2            7
     C                   PARM                    UOPDT2            7
      *
     C                   TESTN                   UOPDF2               34
     C   34              MOVE      UOPDF2        UOPDF             7 0
     C  N34              MOVE      '9999999'     UOPDF
     C                   SETOFF                                       34
     C                   TESTN                   UOPDT2               34
     C   34              MOVE      UOPDT2        UOPDT             5 0
     C  N34              MOVE      UOPDF         UOPDT
      *
N01  C                   MOVE      'bo'          XARTYPE           2
N01  C                   MOVEL     'FM'          XARUNDE          10
     C                   MOVE      *ZEROS        FMDT
     C                   MOVE      *ZEROS        XDT
      *
     C     FIFIRM        SETLL     FIRM                               34
     C                   READ      FIRM                                   34
     C     1             DO        5             XN
     C                   MOVE      FICURR        V22(XN)
     C                   END
     C                   MOVE      FICURR        FMVALC
     C                   MOVE      FICURR        FMVATL
     C*
     C                   ENDSR
     C*
     OFRMDOCR   E            UPDFRM
     O                       FMST
