********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 IKKE HENT TOLL OG MOMS FRA TYRING
11XXX * 02 YBC PTF11 IKKE SLÅ SAMME VARELINJER
11XXX * 03 YBC PTF11 EKSPEDISJONSENHET OG FAKTURANR
11XXX * 04 YBC PTF11 HENT PVA OG MF FRA SADVARE
11XXX * 05 YBC PTF11 HENT TIDLIGERE LØPENR FRA tk3logdta/doctxtd
11XXX * 06 YBC PTF11 HENT LAGRINGSKODE SIKDLS FRA CUSHDR.AGAU
11174 * 07 YBC PTF11 TILLEGGSLINJER MED SAMME POST
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 08 YBC PTF12 OPPDATER SKJERMBILDE ETTER ENDRING
12053 * 09 YBC PTF12 FLERE BELØP-FELTER ER ENDRET FOR Å TA STØRRE VERDI
12239 * 10 YBC PTF12 Indonesia og Ecuador har egen tollsats
12243 * 11 YBC PTF12 Storbritania bruker tollsats fra første kolonne av 2
********************************************************************
      ***********************************************************
      *** PROGRAM SKAL LAGE SAD-IMPORT VIA TYRINGS DATABASE   **
      ***********************************************************
      *
     FSHPDOCSND UF   E             DISK
     FSHPDOC    IF   E           K DISK    RENAME(SHPDOCR:SHPDOCRX)
     FCUSHDR    IF   E           K DISK
     FCUSDET    IF   E           K DISK
     FDOCADRH   IF   E           K DISK
     FSHPADRH   IF   E           K DISK
     FDOCATTDOCDIF   E           K DISK
     FDOCCLIDM  IF   E           K DISK
     FDOCCLID   IF   E           K DISK
     FDOCAMOUH  IF   E           K DISK
     FDOCAMOUD  IF   E           K DISK
     FDOCREFH   IF   E           K DISK    PREFIX(Y)
N05  FDOCTXTD   IF   E           K DISK    PREFIX(DT_)
     FTRACKF    O  A E           K DISK
     FFRISOL01  IF A E           K DISK
     FSADH      UF A E           K DISK
     FSADV      UF A E           K DISK
     FSADF      UF A E           K DISK
     FSADVARE   IF   E           K DISK
     FSTANDI    UF   E           K DISK
     FFIRM      IF   E           K DISK
     FSADSD     IF   E           K DISK
     FTARI      IF   E           K DISK
     FTARIPVA   IF   E           K DISK
     FKODTSI    IF   E           K DISK
N06  FKODTSD    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTS8    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FCUNDL01   IF   E           K DISK    PREFIX(C1_)
     FCUNDMAF   IF   E           K DISK
     FEDIM1     UF A E           K DISK
     FEDIM2     IF   E           K DISK    RENAME(EDIMR:EDIMR2)
     FEDIM4     IF   E           K DISK    RENAME(EDIMR:EDIMR4)
     FEDIC      UF   E             DISK
     FTVIND     UF A E           K DISK
     FKODTVAL2  IF   E           K DISK
     D FT              S             17    DIM(7)
     D TO              S             17    DIM(5)
     D RF              S              3    DIM(5)
     D                SDS
     D  UUSR                 254    263
     D                 DS
     D  SHPN                   1     10  0
     D  DOCN                  11     20  0
     D  XREF                   1     20
N03  D                 DS
N03  D  DCLPLACE               1     35
N03  D  DCL_1                  1      1
N03  D  DCL_2                  2      2
N03  D  DCL_3                  3      3
N03  D  DCL_4                  4      4
N03  D  DCL_5                  5      5
N03  D  DCL_6                  6      6
     D                 DS
     D  SIAVD                  1      4  0
     D  SITDN                  5     11  0
     D  SISG                  12     14
     D  X14S                   1     14
     D                 DS
     D  X0068Æ                 1      9  0
     D  X0068A                10     17  0
     D  X0068B                18     23  0
     D  X0068C                24     25  0
     D  X0068Å                 2     25
     D  XN068Å                 1     25
     D                 DS
     D  SITRT                  1      7  0
     D  SISLAA                 1      1  0
     D  SIDFVF                 2      2  0
     D*
     D*** SI28 I SADH ER TATT I BRUK (FØRST 15 POS.)
     D*** PGA. ENDRING AV REGISTER BESKRIVELSE (SE SADH)
     D*** GJØR VI FØLGENDE DOBBEL DEFINISJON.
     D                 DS
     D  SI28                   1     28
     D  SIBELC                 1     11  2
     D  SIRAB                 12     15  2
     D  SIRABX                12     15
     D  SIRABY                15     15
     D  SI27                   1     27
     D* SPLITTER GODSNUMMER
     D                 DS
     D  WSGN                   1     15
     D  XXGN1                  5      5
     D  XXGN11                 5     15
     D  XXGN10                 6     15
     D  XXGN1B                 7      7
     D  XXGN8                  8     15
      *
     D                 DS
     D  C1_SYRG                1     14
     D  C1_SYFORE              1     11
     D                 DS
     D  KS8FTX                 1     52
     D  KS8MIL                52     52
     D  KS8ØRE                51     51
     D                 DS
     D  W2VNT                  1      8  0
     D  W2LK                   9     10
     D  W2TN                  11     11
     D  W2PRE                 12     12
     D  W2AS                  13     19  2
     D  W2PVA                 20     20
     D  W2MFR                 21     21
     D  W2VF                  22     22
     D  W2BRUD                 1     22
     D                 DS
     D  W2AKD1                 1      2
     D  W2AKD2                 3      4
     D  W2AKD3                 5      6
     D  W2AKD4                 7      8
     D  W2AKD5                 9     10
     D  W2AKD6                11     12
     D  W2AKD7                13     14
     D  AKD                    1     14    DIM(7)
     D                 DS
     D  W2ASV1                 1      3
     D  W2ASV2                 4      6
     D  W2ASV3                 7      9
     D  W2ASV4                10     12
     D  W2ASV5                13     15
     D  W2ASV6                16     18
     D  W2ASV7                19     21
     D  ASV                    1     21    DIM(7)
     D                 DS
     D  W2ASA1                 1      7S 2
     D  W2ASA2                 8     14S 2
     D  W2ASA3                15     21S 2
     D  W2ASA4                22     28S 2
     D  W2ASA5                29     35S 2
     D  W2ASA6                36     42S 2
     D  W2ASA7                43     49S 2
     D  ASA                    1     49  2 DIM(7)
     D                 DS
     D  W2FT01                 1     28
     D  W2FT02                29     56
     D  W2FT03                57     84
     D  W2FT04                85    112
     D  W2FT05               113    140
     D  W2FT06               141    168
     D  W2FT07               169    196
     D  VFT                    1    224    DIM(8)
     D                 DS
     D  W2NT01                 1      6  0
     D  W2NT02                 7     12  0
     D  W2NT03                13     18  0
     D  W2NT04                19     24  0
     D  W2NT05                25     30  0
     D  W2NT06                31     36  0
     D  W2NT07                37     42  0
     D  VNT                    1     48  0 DIM(8)
     D                 DS
     D  W2EH01                 1      4
     D  W2EH02                 5      8
     D  W2EH03                 9     12
     D  W2EH04                13     16
     D  W2EH05                17     20
     D  W2EH06                21     24
     D  W2EH07                25     28
     D  VEH                    1     32    DIM(8)
     D                 DS
     D  W2VT01                 1     30
     D  W2VT02                31     60
     D  W2VT03                61     90
     D  W2VT04                91    120
     D  W2VT05               121    150
     D  VVT                    1    240    DIM(8)
     D                 DS
     D  W2TOP1                 1     17
     D  W2TOP2                18     34
     D  W2TOP3                35     51
     D  W2TOP4                52     68
     D  W2TOP5                69     85
     D  W2TOP6                86    102
     D  W2TOP7               103    119
     D  W2TOP8               120    136
     D  W2TOP9               137    153
     D  W2TOP10              154    170
     D  TOP                    1    187    DIM(11)
     D                 DS
     D  W2CRE1                 1      3
     D  W2CRE2                 4      6
     D  W2CRE3                 7      9
     D  W2CRE4                10     12
     D  W2CRE5                13     15
     D  W2CRE6                16     18
     D  W2CRE7                19     21
     D  W2CRE8                22     24
     D  W2CRE9                25     27
     D  W2CRE10               28     30
     D  TCR                    1     33    DIM(11)
     D                 DS
     D  SVAKD1                 1      2
     D  SVAKD2                 3      4
     D  SVAKD3                 5      6
     D  SVAKD4                 7      8
     D  SVAKD5                 9     10
     D  SVAKD6                11     12
     D  SVAKD7                13     14
     D  SVAKD8                15     16
     D  SVAKD                  1     16    DIM(8)
     D                 DS
     D  SVASV1                 1      3
     D  SVASV2                 4      6
     D  SVASV3                 7      9
     D  SVASV4                10     12
     D  SVASV5                13     15
     D  SVASV6                16     18
     D  SVASV7                19     21
     D  SVASV8                22     24
     D  SVASV                  1     24    DIM(8)
     D                 DS
     D  SVASA1                 1      7  2
     D  SVASA2                 8     14  2
     D  SVASA3                15     21  2
     D  SVASA4                22     28  2
     D  SVASA5                29     35  2
     D  SVASA6                36     42  2
     D  SVASA7                43     49  2
     D  SVASA8                50     56  2
     D  SVASA                  1     56  2 DIM(8)
     D                 DS
E09  D  SVAGR1                 1     13  2
E09  D  SVAGR2                14     26  2
E09  D  SVAGR3                27     39  2
E09  D  SVAGR4                40     52  2
E09  D  SVAGR5                53     65  2
E09  D  SVAGR6                66     78  2
E09  D  SVAGR7                79     91  2
E09  D  SVAGR8                92    104  2
E09  D  SVAGR                  1    104  2 DIM(8)
     D                 DS
E09  D  SVABL1                 1     13  2
E09  D  SVABL2                14     26  2
E09  D  SVABL3                27     39  2
E09  D  SVABL4                40     52  2
E09  D  SVABL5                53     65  2
E09  D  SVABL6                66     78  2
E09  D  SVABL7                79     91  2
E09  D  SVABL8                92    104  2
E09  D  SVABL                  1    104  2 DIM(8)
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  SVFT                   1    224    DIM(8)
     D                 DS
     D  SVNT01                 1      6  0
     D  SVNT02                 7     12  0
     D  SVNT03                13     18  0
     D  SVNT04                19     24  0
     D  SVNT05                25     30  0
     D  SVNT06                31     36  0
     D  SVNT07                37     42  0
     D  SVNT                   1     48  0 DIM(8)
     D                 DS
     D  SVEH01                 1      4
     D  SVEH02                 5      8
     D  SVEH03                 9     12
     D  SVEH04                13     16
     D  SVEH05                17     20
     D  SVEH06                21     24
     D  SVEH07                25     28
     D  SVEH                   1     32    DIM(8)
     D                 DS
     D  SVVT01                 1     30
     D  SVVT02                31     60
     D  SVVT03                61     90
     D  SVVT04                91    120
     D  SVVT05               121    150
     D  SVVT                   1    240    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  SVTOP                  1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  SVTCR                  1     33    DIM(11)

     C                   EXSR      INIT

     C                   READ      SHPDOCSND                              33
     C                   DOW       *IN33 = *OFF

     C                   EXSR      OPDHOD
     C                   EXSR      CIFSR
     C                   EXSR      OPDLIN
     C                   EXSR      SNDTVIN
     C                   EVAL      DOCSTATUS='Q2'
     C                   UPDATE    SHPDOCR
     C                   EVAL      UJN='J'
     C                   LEAVE

     C                   READ      SHPDOCSND                              33
     C                   ENDDO

     C                   MOVE      '1'           *INLR
     C                   RETURN
      ***********************************************
     C     OPDHOD        BEGSR
      ***********************************************
     C                   EVAL      FSSOK = XREF
     C     FRISOL01K     CHAIN     FRISOL01                           33
     C                   IF        *IN33
     C                   EVAL      SIAVD = 1
     C     SIAVD         CHAIN     STANDI                             33
     C                   MOVE      SITDN         XSITDN            7 0
     C                   ADD       1             SITDN
     C                   UPDATE    STANDIR
     C                   MOVE      ' '           SIST
     C                   MOVE      SIAVD         FSAVD
     C                   MOVE      XSITDN        FSOPD
     C                   WRITE     FRISOKR
     C                   MOVE      XSITDN        SITDN
     C                   MOVE      WDT           SIDT
     C                   MOVE      *ZEROS        SIBELC
     C                   MOVE      *ZEROS        SIRAB
     C                   EVAL      WSIVKB=*ZEROS
N02  C                   Z-ADD     1             SISLAA
N02  C                   Z-ADD     1             SIDFVF
     C                   WRITE     SADHR
     C                   EXSR      TTSR
     C                   ELSE
     C     SADHK         CHAIN     SADH                               33
     C                   CLEAR                   SADHR
     C     FSAVD         CHAIN(N)  STANDI
     C                   MOVE      FSAVD         SIAVD
     C                   MOVE      FSOPD         SITDN
     C                   MOVE      WDT           SIDT
     C                   MOVE      *ZEROS        SIBELC
     C                   MOVE      *ZEROS        SIRAB
N02  C                   Z-ADD     1             SISLAA
N02  C                   Z-ADD     1             SIDFVF
     C                   EVAL      WSIVKB=*ZEROS
     C                   UPDATE    SADHR
     C                   EXSR      TTSR2
     C     SADHK         SETLL     SADV
     C     SADHK         READE     SADV                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADVR
     C     SADHK         READE     SADV                                   33
     C                   ENDDO
     C     SADHK         SETLL     SADF
     C     SADHK         READE     SADF                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADFR
     C     SADHK         READE     SADF                                   33
     C                   ENDDO
     C                   END
      *
     C     SADHK         CHAIN     SADH                               33
     C     KODTAK        CHAIN     KODTA                              33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   MOVE      C1_SYFORE     XSYFORE          11
      *
      * LES HEADING
     C     SHPDOCK       CHAIN     SHPDOC                             33
     C     CUSHDRK       CHAIN     CUSHDR                             33
N03   * OPPDATE NIL-NR PÅ FRISØKEVEI
N03  C                   EVAL      FSKODE = 'NIL'
N03  C                   EVAL      FSSOK  = REFEXT1
N03  C                   WRITE     FRISOKR
N03  C                   EVAL      FSKODE = '*CR'

     C                   EVAL      SIDTY  = 'EU'
     C                   EVAL      SIDP   = 40
     C                   EXSR      GETPROC
     C                   EVAL      SINTK  = COLLIN

      * AVSENDER
     C     DOCADRHK1     CHAIN     DOCADRH                            33
     C   33SHPADRHK1     CHAIN     SHPADRH                            33
     C                   IF        *IN33
     C                   EVAL      SINAS  = *BLANKS
     C                   EVAL      SIADS1 = *BLANKS
     C                   EVAL      SIADS2 = *BLANKS
     C                   EVAL      SIADS3 = *BLANKS
     C                   ELSE
     C                   EVAL      SINAS  = FNAME
     C                   EVAL      SIADS1 = ADR1
     C                   EVAL      SIADS2 = ADR2
     C                   EVAL      SIADS3 = %TRIM(ZIP) + ' ' + %TRIM(CITY)
     C                   END
      *
      * MOTTAKER
     C     DOCADRHK2     CHAIN     DOCADRH                            33
     C   33SHPADRHK2     CHAIN     SHPADRH                            33
     C                   IF        *IN33
     C                   EVAL      SIRG   = *BLANKS
N08  C                   EVAL      SIMVA  = *BLANKS
     C                   EVAL      SINAK  = *BLANKS
     C                   EVAL      SIADK1 = *BLANKS
     C                   EVAL      SIADK2 = *BLANKS
     C                   EVAL      SIADK3 = *BLANKS
     C                   ELSE
     C*                  EVAL      SIRG   = %TRIM(VATCOUC) + %TRIM(VATNO)
     C                   EVAL      SIRG   = %TRIM(VATNO)
N08  C                   EVAL      SIMVA  = 'J'
     C                   EVAL      SINAK  = FNAME
     C                   EVAL      SIADK1 = ADR1
     C                   EVAL      SIADK2 = ADR2
     C                   EVAL      SIADK3 = %TRIM(ZIP) + ' '+ %TRIM(CITY)
     C                   END
      *
      * DEKLARANT
     C     DOCADRHK3     CHAIN     DOCADRH                            33
     C   33SHPADRHK3     CHAIN     SHPADRH                            33

     C                   SELECT
     C     DOCOWNER      WHENEQ    'NIJEDI'
     C                   EVAL      SISG   = 'JED'
     C     DOCOWNER      WHENEQ    'NILENI'
     C                   EVAL      SISG   = 'LEN'
     C     DOCOWNER      WHENEQ    'NIANST'
     C                   EVAL      SISG   = 'ANS'
     C     DOCOWNER      WHENEQ    'NIMAGR'
     C                   EVAL      SISG   = 'MAG'
     C                   OTHER
     C                   EVAL      SISG   = 'JED'
     C                   ENDSL

     C     KODTSIK       CHAIN     KODTSI                             33
     C                   EVAL      SITARF = KSINAV
     C                   EVAL      SILKA  = CODP
     C                   EVAL      SILKA  = 'SE'
     C                   EVAL      SITRID = IDMCB
     C                   EVAL      SILKT  = COMCB
     C                   EVAL      SILV='DDP'
     C                   EVAL      SILV2='DDP'
     C                   EVAL      SILVT='SANDE'
N06  C                   IF        AGAU <> *BLANKS
N06  C                   EVAL      SIKDLS = AGAU
N06  C     SIKDLS        CHAIN     KODTSD                             33
N06  C  N33              EVAL      SILS   = KSDTXT
N06  C   33              EVAL      SILS   = *BLANKS
N06  C                   END
      *
     C     DOCAMOUHK     CHAIN     DOCAMOUH                           33
     C                   EVAL      SIVAL3 = CURC
     C                   EVAL      SIBEL3 = AMOUNT
     C*                  EVAL      SIVKU  = KURS
     C                   EVAL      *IN33=*OFF
     C     KODVAK        SETGT     KODTVAL2
     C     SIVAL3        READPE    KODTVAL2                               33
     C  N33              EVAL      SIVKU  = KVAKRS
     C   33              EVAL      SIVKU  = *ZEROS
     C                   EVAL      SILS   = AGAU
     C*                  EVAL      SIVKB  = GRWG
S03  C*                  MOVEL     REFOWN        SIFIF
S03  C*    SIFIF         CAT       '/':1         SIFIF
S03  C*    SIFIF         CAT       REFEXT1:1     SIFIF
N03  C     HODEK         CHAIN     DOCATTDOCD                         33
N03  C                   DOW       *IN33 = *OFF
N03  C                   IF        DOCR = 1 AND ATTDCODE = 'DOCPROD' AND
N03  C                             (ATTDOCQ = ' ' OR ATTDOCQ = 'N380')
N03  C                   EVAL      SIFIF = 'F' + %TRIM(ATTDOCR)
N03  C                   END
N03  C     HODEK         READE     DOCATTDOCD                             33
N03  C                   ENDDO
     C                   MOVEL     DOCDATE       SIFID
      * Godsnummer
     C     DOCREFHK      CHAIN     DOCREFH                            33
     C  N33              MOVEL     YREF          SIGN
     C   33              MOVE      *BLANKS       SIGN
      *
     C                   UPDATE    SADHR
      *
     C                   ENDSR
      *
      ***********************************************
     C     CIFSR         BEGSR
      ***********************************************
     C     SADHK         CHAIN     SADH                               33
      *
     C                   MOVE      *ZEROS        XBEL8            11 2
      *
      *** OMREGN FAKTURASUM TIL NORSK KRONE
      *** OG LEGG DETTE PÅ CIFSUM (XBEL4)
     C     KVAOMR        IFNE      0
     C     SIBEL3        MULT      SIVKU         XWORK            16 5
      *   AVRUND CIFSUM
E09  C     XWORK         DIV(H)    KVAOMR        XFAKNO           11 0          DEF. BILDE05
E09  C                   Z-ADD     XFAKNO        XBEL4            11 0
     C                   END
      *
      *** OMREGN FRAKT TIL NORSK KRONE
      *** OG LEGG DETTE PÅ CIFSUM (XBEL4)
     C*    SIBEL1        IFNE      0
     C*    SIBEL1        MULT(H)   XKRS1         XKOSTN
     C*    XKOSTN        DIV(H)    XOMR1         XKOSTN
     C*                  Z-ADD     XKOSTN        XBEL8
     C*                  ADD(H)    XKOSTN        XBEL4
     C*    SIDP          IFEQ      49
     C*                  MULT(H)   0.2           XKOSTN
     C*                  END
     C*                  ADD(H)    XKOSTN        XBELS             9 0
     C*                  END
     C*                  MOVE      *ZEROS        XKOSTN
     C*
      *** OMREGN ANDRE KOSTNAD TIL NORSK KRONE
      *** OG LEGG DETTE PÅ CIFSUM (XBEL4)
     C*    XBEL2         IFNE      0
     C*    XBEL2         MULT(H)   XKRS2         XKOSTN
     C*    XKOSTN        DIV(H)    XOMR2         XKOSTN
     C*    SIDP          IFEQ      49
     C*                  MULT(H)   0.2           XKOSTN
     C*                  END
     C*    SIFTG2        IFEQ      '+'
     C*    SIFTG2        OREQ      'P'
     C*                  ADD(H)    XKOSTN        XBEL4
     C*                  ELSE
     C*                  SUB(H)    XKOSTN        XBEL4
     C*                  END
     C*                  END
     C*                  Z-ADD(H)  XKOSTN        XBEL9            11 2
     C*
      *** SJEKK OM FORSIKRING SKAL BEREGNES
     C*    KLBFOK        IFEQ      'A'
     C*    XBEL4         MULT      KLBPRM        XWORK
     C*    XWORK         DIV(H)    1000          XBELA             7 0
     C*    SIDP          IFEQ      49
     C*                  MULT(H)   0.2           XBELA
     C*                  END
     C*                  ELSE
     C*                  MOVE      *ZEROS        XBELA
     C*                  END
     C*                  ADD       XBELA         XBEL4
     C*                  ADD       XBELA         XBELS
      *
     C                   MOVE      XBEL4         SIBEL4
     C*                  MOVE      XBEL9         SIBEL9
     C                   UPDATE    SADHR
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDLIN        BEGSR
      ***********************************************
     C                   EVAL      XSVLI  = 0
     C                   EVAL      XSVREFL = 0
     C     CUSDETK       SETLL     CUSDET
     C     CUSDETK       READE     CUSDET                                 33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   CLEAR                   SADVR
     C                   EVAL      WLEVENR = 1
     C*                  MOVEL     COMMCODE      WVARENR
     C                   MOVEL     RSV1          WVARENR
     C     VAREKEY       CHAIN     SADVARE                            51
     C                   EVAL      SVAVD = SIAVD
     C                   EVAL      SVTDN = SITDN
     C                   EVAL      XSVLI = XSVLI + 1
     C                   EVAL      SVLI = XSVLI
N02  C                   EVAL      SVLN = SVLI
     C                   EVAL      XSVREFL = XSVLI
N05  C   51              EVAL      SVPRE = ' '
N05  C  N51              IF        SVLK = 'NO' AND (SVPRE = 'A' OR SVPRE = 'B')
N05  C                   EVAL      SVPRE = 'C'
N05  C                   END
     C  N51              EVAL      SVVF = W2VF
     C   51              EVAL      SVVF = '1'
     C  N51              MOVEL     W2VNTI        SVVNT
     C*  51              MOVEL     COMMCODE      SVVNT
     C   51              MOVEL     RSV1          SVVNT

     C                   IF        *IN51                                         2<-B
     C     SVVNT         CHAIN     TARI                               33
     C                   IF        *IN33                                          3<-B
     C                   MOVE      00            SVVNT
     C                   MOVE      SVVNT         XSVVNT            8 0
     C                   MOVE      99            XSVVNT
     C     SVVNT         SETLL     TARI
     C                   READ      TARI                                   33
     C  N33TATANR        COMP      XSVVNT                             33
     C                   IF        *IN33                                           4<-B
     C*                  MOVEL     COMMCODE      SVVNT
     C                   MOVEL     RSV1          SVVNT
     C                   ELSE                                                      4
     C                   MOVE      TATANR        SVVNT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   ENDIF                                                   2<-E

     C  N51              MOVEL     W2LK          SVLK
     C  N51              MOVEL     W2TN          SVTN
     C   51              MOVEL     ORIGCOUC      SVLK
     C                   MOVEL     ORIGCOUC      SVLK
     C  N51              EVAL      SVPRE = W2PRE
     C   51              EVAL      SVPRE = 'B'
     C                   EVAL      SVVKTB = GROSSW
     C                   IF        SVVKTB = 0
     C                   EVAL      SVVKTB = 1
     C                   ENDIF
     C                   ADD       SVVKTB        WSIVKB
     C                   EVAL      SVVKTN = NETW
     C                   IF        SVVKTN = 0                                    2<-B
     C                   EVAL(H)   SVVKTN = SVVKTB * 0,9
     C                   END                                                     2<-E
     C  N51              MOVEL     VAREBE        SVVT
     C                   EVAL      SVNTM = SUPPLUNIT
      *
     C     DOCAMOUDK     SETLL     DOCAMOUD
     C     DOCAMOUDK     READE     DOCAMOUD                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        AMOUCODE='ITEMPRICE'                           3<-B
     C                   EVAL      SVBELT = AMOUNT
     C                   LEAVE
     C                   END                                                      3<-E
     C     DOCAMOUDK     READE     DOCAMOUD                               33
     C                   ENDDO                                                   2<-E
      *
     C     LINJEK        CHAIN     DOCATTDOCD                         41
     C                   IF        *IN41 = *OFF                                  2<-B
     C                   EVAL      SVCRE1 = ATTDOCQ
     C                   IF        SVCRE1 = *BLANKS                               3<-B
     C                   EVAL      SVCRE1 = 'SER'
     C                   ENDIF                                                    3<-E
     C                   EVAL      SVTOP1 = ATTDOCR
     C                   END                                                     2<-E
     C                   IF        *IN51=*OFF
     C                   EVAL      SVCRE1 = W2CRE1
     C                   EVAL      SVTOP1 = W2TOP1
     C                   ENDIF
N05   *
N05  C                   MOVE      'N'           XTIDLIGLNOK       1
N05  C                   EVAL      XSVTOP1 = *BLANKS
N05   * HENT TIDLIGERE LØPENR OG LEGG INN XSVTOA
N05  C     DOCTXTDK      CHAIN     DOCTXTD                            33
N05  C                   DOW       *IN33 = *OFF
N05  C                   IF        DT_TXTCODE='ADDINFO' AND DT_TXTTXT<>*BLANKS
N05  C                   EVAL      XSVTOP1 = DT_TXTTXT
N05  C                   MOVE      'J'           XGJINN            1
N05  C                   LEAVE
N05  C                   END
N05  C     DOCTXTDK      READE     DOCTXTD                                33
N05  C                   ENDDO
N05  C                   IF        XSVTOP1 <> *BLANKS
N05  C                   EVAL      AKD = *BLANKS
N05  C                   EVAL      ASV = *BLANKS
N05  C                   EVAL      ASA = *ZEROS
N05  C                   EVAL      SVPVA = 'F'
N05  C                   EVAL      SVMFR = 'F'
N05  C                   IF        SVCRE1 = *BLANKS
N05  C                   MOVE      'J'           XTIDLIGLNOK
N05  C                   EVAL      SVCRE1 = 'DOK'
N05  C                   EVAL      SVTOP1 = XSVTOP1
N05  C                   END
N05  C                   END
      *
     C     LINJEK        CHAIN     DOCCLIDM                           42
     C  N42              EVAL      SVFT = MARK
     C                   MOVE      *BLANKS       SVFT01
     C                   MOVEL     WVARENR       SVFT01
      *
     C     LINJEK        CHAIN     DOCCLID                            33
     C  N33              EVAL      SVNT01 = COLLIN
     C  N33              EVAL      SVEH01 = COLLI
N01   *
N01   * FJERN TOLL OG MOMS FRA TYRING
N01  C  N511             DO        7             XN03              1 0           2<-B
N01  C                   IF        AKD(XN03) = 'TL' OR AKD(XN03) = 'MV'           3<-B
N01  C                   MOVE      XN03          XN04              1 0
N01  C                   DOW       XN04 < 7                                        4<-B
N01  C     XN04          ADD       1             XN05              1 0
N01  C                   MOVE      AKD(XN05)     AKD(XN04)
N01  C                   MOVE      ASV(XN05)     ASV(XN04)
N01  C                   MOVE      ASA(XN05)     ASA(XN04)
N01  C                   ADD       1             XN04
N01  C                   ENDDO                                                     4<-E
N01  C                   MOVE      *BLANKS       AKD(7)
N01  C                   MOVE      *BLANKS       ASV(7)
N01  C                   MOVE      *ZEROS        ASA(7)
N01  C                   END                                                      3<-E
N01  C                   ENDDO                                                   2<-E
      *
     C                   EXSR      TESTB1
      *
     C  N51              MOVE      W2MFR         SVMFR
     C  N51              EXSR      SRAVG
      *
     C*                  WRITE     SADVR
      *
     C                   EVAL      FT = *BLANKS
     C                   EVAL      TO = *BLANKS
     C                   EVAL      RF = *BLANKS
     C                   MOVE      *ZEROS        XN01              1 0
     C                   MOVE      *ZEROS        XN02              1 0
     C                   MOVE      *ZEROS        XN03              1 0
     C                   MOVE      *ZEROS        XN11              1 0
     C                   MOVE      *ZEROS        XN12              1 0
     C                   Z-ADD     1             XN13              1 0
     C
     C                   IF        *IN51=*OFF
     C     2             DO        5             XN
     C                   IF        TOP(XN) <> *BLANKS
     C                   ADD       1             XN01
     C                   EVAL      RF(XN01) = TCR(XN)
     C                   EVAL      TO(XN01) = TOP(XN)
     C                   ENDIF
     C                   ENDDO
     C                   ENDIF
N05   *
N05  C                   IF        XTIDLIGLNOK = 'N' AND XSVTOP1 <> *BLANKS
N05  C                   ADD       1             XN01
N05  C                   EVAL      RF(XN01) = 'DOK'
N05  C                   EVAL      TO(XN01) = XSVTOP1
N05  C                   MOVE      'J'           XTIDLIGLNOK
N05  C                   MOVE      'J'           XGJINN            1
N05  C                   END
     C
     C                   DOW       *IN41 = *OFF OR *IN42 = *OFF                  2<-B
     C  N41LINJEK        READE     DOCATTDOCD                             41
     C  N41              IF        XN01 = 5                                       3<-B
     C                   EVAL      *IN41 = *ON
     C                   ELSE                                                     3
     C                   EVAL      XN01 = XN01 + 1
     C*                  EVAL      TO(XN01) = ATTDOCQ
     C*                  EVAL      RF(XN01) = ATTDOCR
     C                   END                                                      3<-E
     C  N42LINJEK        READE     DOCCLIDM                               42
     C  N42              IF        XN02 = 7                                       3<-B
     C                   EVAL      *IN42 = *ON
     C                   ELSE                                                     3
     C                   EVAL      XN02 = XN02 + 1
     C                   EVAL      FT(XN02) = MARK
     C                   END                                                      3<-E
     C                   ENDDO                                                   2<-E
      *
     C                   WRITE     SADVR
      *
     C     CUSDETK       READE     CUSDET                                 33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
     C     SIDP          COMP      47                                     46
     C  N46SIDP          COMP      70                                     46
     C  N46SIDP          COMP      71                                     46
     C  N46SIDP          COMP      72                                     46
     C  N46SIDP          COMP      73                                     46
     C  N46SIDP          COMP      74                                     46
     C  N46SIDP          COMP      76                                     46
     C  N46SIDP          COMP      77                                     46
     C   46              MOVE      'F'           SVPVA
     C   46              MOVE      *ZEROS        SVAS
     C   46              MOVE      'F'           SVMFR
      *
     C     SIDP          IFEQ      57
     C     SVCRE1        OREQ      'M2'
     C                   MOVE      'F'           SVMFR
     C                   END
     C     SIDP          IFGE      60
     C     SIDP          ANDLE     69
     C                   MOVE      'F'           SVPVA
     C                   END
      *
      *** CHAIN OPPRINNELSESLAND / TARIFFNR (FOR Å KUNNE SETTE PREF)
     C     KODTS2K       CHAIN     KODTS2                             33
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   87
     C     *IN87         DOWEQ     '0'
     C     TADATO        IFLE      SIDT
     C     TADTS         ANDEQ     0
     C     TADATO        ORLE      SIDT
     C     TADTS         ANDGE     SIDT
     C                   LEAVE
     C                   END
     C     TARIK         READPE    TARI                                   87
     C  N87              ENDDO
      * DERSOM LANDKODEN TILLATER PREFERANSE OG DET IKKE ER BEVISST
      * SATT "N" FOR INGEN PREF. ER PREF "P" DEFAULT (KOLONNE ETTER LK)
      * (MEN PREF SKAL IKKE SETTES DERSOM VARENR ER FRITT "I SEG SELV")
      * (PREF PÅ VARE SOM ER FRI I KOL. 1  GAV FEIL I TVINN - ENNÅ????)
     C     SVTN          IFEQ      ' '
     C     SVPRE         ANDEQ     ' '
     C     SIDP          IFEQ      71
      * TRANSIT/FRILAGER....
     C     KS2PRE        IFEQ      ' '
     C                   MOVE      'N'           SVPRE
     C                   ELSE
     C                   MOVE      'J'           SVPRE
     C                   END
     C                   ELSE
      * ... ANNET (IKKE PROS 71.)
     C* VED REISEGODS BEHOLD ' '(->N) I PREF ELLERS SETT PREF ETTER LK
     C     SVVNT         IFEQ      *ZEROS
     C     SIDP          ANDEQ     44
     C     SITST         ANDEQ     9
     C                   MOVE      'N'           SVPRE
     C                   ELSE
     C                   MOVE      KS2PRE        SVPRE
     C  N87              IF        ((SVPRE ='A') OR (SVPRE = 'B'))
     C                   IF        TAORDB = TAEFB
     C                   EVAL      SVPRE = 'N'
     C                   END
     C                   END
     C                   END
     C     SVPRE         IFEQ      'B'
     C     SVLK          ANDNE     'CH'
     C     SVLK          ANDNE     'LI'
     C     SVLK          ANDNE     'RO'
     C     SVLK          ANDNE     'BG'
     C     TAEØSB        ANDLE     TAEFB
     C                   MOVE      'A'           SVPRE
     C                   END
     C     SVPRE         IFEQ      'C'
     C     SVLK          ANDNE     'CH'
     C     SVLK          ANDNE     'LI'
     C     TAEØSB        ANDLE     TAEFTB
     C                   MOVE      'A'           SVPRE
     C                   END
     C                   END
     C                   END
      *
     C                   IF        SVCRE1 = 'M2'                                MVA FRITAK
     C                   MOVE      'F'           SVMFR
     C                   END
      *
      * FLYTTEGODS PÅ PROS 44 / TRANSTYPE =9 - OK MED 0 I TARIFFNR
     C     SVVNT         IFEQ      *ZEROS
     C     SITST         ANDEQ     9
     C                   MOVE      'F'           SVPVA                           ALLTID FRI
     C                   MOVE      *OFF          *IN87
     C                   MOVE      *BLANKS       TASTK
     C                   MOVE      *BLANKS       TAKAP
     C                   MOVE      *BLANKS       TAKAPA
     C                   END
      *
      *** TASTET PREF GIS HØYERE PRIORITET ENN M-FRI (OG ORDINÆR-FRI)
      ***   DERSOM "ØVRIGE KAPITAL HENVENDELSE" VISER TIL M BEHANDLES
      ***   VARE SOM MASKIN-FRI
     C                   MOVEL     TAKAPA        TAKAP2            1
     C     TAKAP         IFNE      'M'
     C     TAKAP2        ANDEQ     'M'
     C                   MOVE      'M'           TAKAP
     C                   END
      *
     C     TAKAP         IFEQ      'M'
     C     SVPRE         IFEQ      ' '
     C     SVPRE         OREQ      'N'
     C                   MOVE      'M'           SVTN
     C                   END
     C                   END
      *
     C     SVPRE         IFNE      ' '
     C     SVPRE         ANDNE     'N'
     C     SVPRE         ANDNE     'J'
      * VED 'G'  SETTES FRI VED BLANK KODE
     C     SVPRE         IFEQ      'G'
     C     SVPVA         ANDEQ     ' '
     C                   MOVE      'F'           SVPVA
     C                   END
     C                   END
      *
     C                   IF        ((SVPVA <> 'F') AND (SVAS = 0))
     C*                  CALL      'SAD061H'
     C*                  PARM      TATANR        U2TANR            8 0
     C*                  PARM      TADATO        U2DATO            8 0
     C*                  PARM                    SVPVA
     C*    SVAS          PARM      SVAS          U2SATS            5 2
     C*                  PARM      SVBELT        U2BL             11 2
     C*                  PARM      SVVKTN        U2VKT             9 0
     C*                  PARM      SVNTM         U2STK             7 0
     C*                  PARM                    SVPRE
     C*                  PARM                    SVLK
     C*                  PARM                    KS2MO
     C                   END
      *
     C  N46SVAS          IFEQ      0
     C                   EXSR      TATEST
     C                   END
      *
     C     SVPVA         IFEQ      'P'
     C                   MOVE      '%'           XEH2              1
     C                   ELSE
     C                   MOVE      ' '           XEH2
     C                   END
      *
     C     SVPRE         IFEQ      ' '
     C                   MOVE      'N'           SVPRE
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TATEST        BEGSR
      ***********************************************
     C     TARIPVAK      CHAIN     TARIPVA                            33
     C                   IF        *IN33
     C                   EVAL      TAEØSK = ' '
     C                   EVAL      TATSJK = ' '
     C                   EVAL      TATYRK = ' '
     C                   EVAL      TAISRK = ' '
     C                   EVAL      TAELLK = ' '
     C                   EVAL      TABULK = ' '
     C                   EVAL      TAPOLK = ' '
     C                   EVAL      TAROMK = ' '
     C                   EVAL      TAUNGK = ' '
     C                   EVAL      TASLOK = ' '
     C                   EVAL      TAMULK = ' '
     C                   EVAL      TAOULK = ' '
     C                   EVAL      TAGRLK = ' '
     C                   EVAL      TAFÆRK = ' '
     C                   EVAL      TAISTK = ' '
     C                   EVAL      TAMARK = ' '
     C                   EVAL      TAMEXK = ' '
     C                   EVAL      TAVGAK = ' '
     C                   EVAL      TAN01K = ' '
     C                   EVAL      TAN02K = ' '
     C                   EVAL      TAN03K = ' '
     C                   EVAL      TAN04K = ' '
     C                   EVAL      TAN05K = ' '
     C                   EVAL      TAN06K = ' '
     C                   EVAL      TAN07K = ' '
     C                   EVAL      TAN08K = ' '
     C                   EVAL      TAN09K = ' '
     C                   EVAL      TAN10K = ' '
     C                   END
      *
     C     SVPVA         IFEQ      'F'
     C                   MOVE      *ZEROS        SVAS
     C                   ELSE
     C                   MOVE      TAORDK        SVPVA
     C                   MOVE      TAORDB        SVAS
     C     SVPRE         IFEQ      'A'
     C                   MOVE      TAEØSB        SVAS
     C                   IF        TAEØSK <> ' '
     C                   EVAL      W2PVA = TAEØSK
     C                   END
     C                   ELSE
     C     SVPRE         IFEQ      'B'
     C     SVPRE         OREQ      'F'
     C                   MOVE      TAEFB         SVAS
     C                   IF        TAEFK <> ' '
     C                   EVAL      W2PVA = TAEFK
     C                   END
     C                   ELSE
     C     SVPRE         IFEQ      'C'
     C     SVPRE         OREQ      'E'
     C                   MOVE      TAEFTB        SVAS
     C                   IF        TAEFTK <> ' '
     C                   EVAL      W2PVA = TAEFTK
     C                   END
     C                   ELSE
     C     SVPRE         IFNE      'J'
     C     SVPRE         ANDNE     'N'
     C                   EXSR      TATES2
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     SVAS          IFEQ      0
     C                   MOVE      'F'           SVPVA
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TATES2        BEGSR
      ***********************************************
      * HELE SUBRUTINE ER OMSKREVET
     C                   SELECT
S10  C*    SVLK          WHENEQ    'HR'                                         KROATIA
N10  C     SVLK          WHENEQ    'SZ'                                         SWAZILAND
     C                   MOVE      TATSJB        SVAS
     C                   IF        TATSJK <> ' '
     C                   EVAL      W2PVA = TATSJK
     C                   END
     C     SVLK          WHENEQ    'TR'                                         TYRKIA
     C                   MOVE      TATYRB        SVAS
     C                   IF        TATYRK <> ' '
     C                   EVAL      W2PVA = TATYRK
     C                   END
     C     SVLK          WHENEQ    'IL'                                         ISRAEL
     C                   MOVE      TAISRB        SVAS
     C                   IF        TAISRK <> ' '
     C                   EVAL      W2PVA = TAISRK
     C                   END
     C     SVLK          WHENEQ    'SG'                                         SINGAPORE
     C                   MOVE      TAELLB        SVAS
     C                   IF        TAELLK <> ' '
     C                   EVAL      W2PVA = TAELLK
     C                   END
     C     SVLK          WHENEQ    'CL'                                         CHILE
     C                   MOVE      TABULB        SVAS
     C                   IF        TABULK <> ' '
     C                   EVAL      W2PVA = TABULK
     C                   END
     C     SVLK          WHENEQ    'MK'                                         MAKEDONIA
     C                   MOVE      TAPOLB        SVAS
     C                   IF        TAPOLK <> ' '
     C                   EVAL      W2PVA = TAPOLK
     C                   END
     C     SVLK          WHENEQ    'KR'                                         SÖR KOREA
     C                   MOVE      TAROMB        SVAS
     C                   IF        TAROMK <> ' '
     C                   EVAL      W2PVA = TAROMK
     C                   END
     C     SVLK          WHENEQ    'JO'                                         JORDAN
     C                   MOVE      TAUNGB        SVAS
     C                   IF        TAUNGK <> ' '
     C                   EVAL      W2PVA = TAUNGK
     C                   END
     C     SVLK          WHENEQ    'TN'                                         TUNISIA
     C                   MOVE      TASLOB        SVAS
     C                   IF        TASLOK <> ' '
     C                   EVAL      W2PVA = TASLOK
     C                   END
     C     SVLK          WHENEQ    'GL'                                         GRÖNLAND
     C                   MOVE      TAGRLB        SVAS
     C                   IF        TAGRLK <> ' '
     C                   EVAL      W2PVA = TAGRLK
     C                   END
     C     SVLK          WHENEQ    'FO'                                         FÄRÖYENE
     C                   MOVE      TAFÆRB        SVAS
     C                   IF        TAFÆRK <> ' '
     C                   EVAL      W2PVA = TAFÆRK
     C                   END
     C     SVLK          WHENEQ    'IN'                                         INDIA
     C     SVLK          OREQ      'LK'                                         SRI LANKA
     C     SVLK          OREQ      'TH'                                         THAILAND
     C                   MOVE      TAISTB        SVAS
     C                   IF        TAISTK <> ' '
     C                   EVAL      W2PVA = TAISTK
     C                   END
     C     SVLK          WHENEQ    'MA'                                         MAROKKO
     C                   MOVE      TAMARB        SVAS
     C                   IF        TAMARK <> ' '
     C                   EVAL      W2PVA = TAMARK
     C                   END
     C     SVLK          WHENEQ    'MX'                                         MEXICO
     C                   MOVE      TAMEXB        SVAS
     C                   IF        TAMEXK <> ' '
     C                   EVAL      W2PVA = TAMEXK
     C                   END
     C     SVLK          WHENEQ    'PS'                                         VESTBREDDEN OG GAZA
     C                   MOVE      TAVGAB        SVAS
     C                   IF        TAVGAK <> ' '
     C                   EVAL      W2PVA = TAVGAK
     C                   END
     C     SVLK          WHENEQ    'LN'                                         LIBANON
     C                   MOVE      TAN01B        SVAS
     C                   IF        TAN01K <> ' '
     C                   EVAL      W2PVA = TAN01K
     C                   END
     C     SVLK          WHENEQ    'EG'                                         EGYPT
     C                   MOVE      TAN03B        SVAS
     C                   IF        TAN03K <> ' '
     C                   EVAL      W2PVA = TAN03K
     C                   END
     C     SVLK          WHENEQ    'CA'                                         CANADA
     C                   MOVE      TAN04B        SVAS
     C                   IF        TAN04K <> ' '
     C                   EVAL      W2PVA = TAN04K
     C                   END
N10  C     SVLK          WHENEQ    'RS'                                         SERBIA
N10  C                   MOVE      TAN05B        SVAS
N10  C                   IF        TAN05K <> ' '
N10  C                   EVAL      W2PVA = TAN05K
N10  C                   END
N10  C     SVLK          WHENEQ    'AL'                                         ALBANIA
N10  C                   MOVE      TAN06B        SVAS
N10  C                   IF        TAN06K <> ' '
N10  C                   EVAL      W2PVA = TAN06K
N10  C                   END
N10  C     SVLK          WHENEQ    'UA'                                         UKRAINA
N10  C                   MOVE      TAN07B        SVAS
N10  C                   IF        TAN07K <> ' '
N10  C                   EVAL      W2PVA = TAN07K
N10  C                   END
N10  C     SVLK          WHENEQ    'PE'                                         PERU
N10  C                   MOVE      TAN08B        SVAS
N10  C                   IF        TAN08K <> ' '
N10  C                   EVAL      W2PVA = TAN08K
N10  C                   END
N10  C     SVLK          WHENEQ    'ME'                                         MONTENEGRO
N10  C                   MOVE      TAN09B        SVAS
N10  C                   IF        TAN09K <> ' '
N10  C                   EVAL      W2PVA = TAN09K
N10  C                   END
N10   * HONG KONG
N10  C     SVLK          WHENEQ    'HK'                                         HONG KONG
N10  C                   MOVE      TAN10B        SVAS
N10  C                   IF        TAN10K <> ' '
N10  C                   EVAL      W2PVA = TAN10K
N10  C                   END
N10   *
N10   * GCC LAND
N10   * FORENEDE ARABISK EMIRATER  AE
N10   * BAHRAIN                    BH
N10   * SAUDI ARABIA               SA
N10   * OMAN                       OM
N10   * QATAR                      QA
N10   * KUWAIT                     KW
N10   *
N10   *
N10   *
N10   *
N10  C     SVLK          WHENEQ    'AE'                                         FORENEDE ARABISK EMI
N10  C     SVLK          OREQ      'BH'                                         BAHRAIN
N10  C     SVLK          OREQ      'SA'                                         SAUDI ARABIA
N10  C     SVLK          OREQ      'OM'                                         OMAN
N10  C     SVLK          OREQ      'QA'                                         QATAR
N10  C     SVLK          OREQ      'KW'                                         KUWAIT
N10  C                   MOVE      TAN13B        SVAS
N10  C                   IF        TAN13K <> ' '
N10  C                   EVAL      W2PVA = TAN13K
N10  C                   END
N10   *
N10   *
N10   * PANAMA
N10  C     SVLK          WHENEQ    'PA'                                         PANAMA
N10  C                   MOVE      TAN14B        SVAS
N10  C                   IF        TAN14K <> ' '
N10  C                   EVAL      W2PVA = TAN14K
N10  C                   END
N10   *
N10   * COSTA RICA
N10  C     SVLK          WHENEQ    'CR'                                         COSTA RICA
N10  C                   MOVE      TAN15B        SVAS
N10  C                   IF        TAN15K <> ' '
N10  C                   EVAL      W2PVA = TAN15K
N10  C                   END
N10   *
N10   * COLOMBIA
N10  C     SVLK          WHENEQ    'CO'                                         COLOMBIA
N10  C                   MOVE      TAN16B        SVAS
N10  C                   IF        TAN16K <> ' '
N10  C                   EVAL      W2PVA = TAN16K
N10  C                   END
N10   *
N10   * GEORGIA
N10  C     SVLK          WHENEQ    'GE'                                         GEORGIA
N10  C                   MOVE      TAN17B        SVAS
N10  C                   IF        TAN17K <> ' '
N10  C                   EVAL      W2PVA = TAN17K
N10  C                   END
N10   *
N10   * BOSNA HERCEGOVINA
N10  C     SVLK          WHENEQ    'BA'                                         BOSNA HERCEGOVINA
N10  C                   MOVE      TAN18B        SVAS
N10  C                   IF        TAN18K <> ' '
N10  C                   EVAL      W2PVA = TAN18K
N10  C                   END
N10   *
N10   * FILIPPINENE
N10  C     SVLK          WHENEQ    'PH'                                         FILIPPINENE
N10  C                   MOVE      TAN19B        SVAS
N10  C                   IF        TAN19K <> ' '
N10  C                   EVAL      W2PVA = TAN19K
N10  C                   END
N10   *
N10   * STORBRITANIA EØS
S11  C*    SVLK          WHENEQ    '??'                                         STORBRITANIA EØS
N11  C     SVLK          WHENEQ    'GB'                                         STORBRITANIA
N10  C                   MOVE      TAN20B        SVAS
N10  C                   IF        TAN20K <> ' '
N10  C                   EVAL      W2PVA = TAN20K
N10  C                   END
S11   *
S11   * STORBRITANIA EF
S11  C*    SVLK          WHENEQ    '??'                                         STORBRITANIA EF
S11  C*                  MOVE      TAN21B        SVAS
S11  C*                  IF        TAN21K <> ' '
S11  C*                  EVAL      W2PVA = TAN21K
S11  C*                  END
N10   *
N10   * INDONESIA
N10  C     SVLK          WHENEQ    'ID'                                         INDONESIA
N10  C                   MOVE      TAN22B        SVAS
N10  C                   IF        TAN22K <> ' '
N10  C                   EVAL      W2PVA = TAN22K
N10  C                   END
N10   *
N10   * ECUARDOR
N10  C     SVLK          WHENEQ    'EC'                                         ECUARDOR
N10  C                   MOVE      TAN23B        SVAS
N10  C                   IF        TAN23K <> ' '
N10  C                   EVAL      W2PVA = TAN23K
N10  C                   END
N10  C     W2LK          WHENEQ    'BW'                                         BOTSWANA
N10  C     W2LK          OREQ      'NA'                                         NAMIBIA
N10  C     W2LK          OREQ      'SZ'                                         SWAZILAND
N10  C                   MOVE      TAN11B        SVAS
N10  C                   IF        TAN11K <> ' '
N10  C                   EVAL      W2PVA = TAN11K
N10  C                   END
     C     KS2MO         WHENEQ    'M'                                          MINST UTVIKLEDE LAND
     C                   MOVE      TAMULB        SVAS
     C                   IF        TAMULK <> ' '
     C                   EVAL      W2PVA = TAMULK
     C                   END
     C     KS2MO         WHENEQ    'O'                                          ORDINÄRE UTV.LAND
     C                   MOVE      TAOULB        SVAS
     C                   IF        TAOULK <> ' '
     C                   EVAL      W2PVA = TAOULK
     C                   END
     C     KS2MO         WHENEQ    'S'                                          SACU
     C                   MOVE      TAOULB        SVAS
     C                   IF        TAOULK <> ' '
     C                   EVAL      W2PVA = TAOULK
     C                   END
N10  C     KS2MO         WHENEQ    'L'                                          LAVERE M.INNT.LAND
N10  C                   MOVE      TAN12B        SVAS
N10  C                   IF        TAN12K <> ' '
N10  C                   EVAL      W2PVA = TAN12K
N10  C                   END
     C                   ENDSL
      *
     C                   ENDSR
      *
      ******************************************
     C     SRAVG         BEGSR
      ******************************************
     C     SIBEL3        IFNE      0
     C     SIBEL4        DIV(H)    SIBEL3        XTVFAK           17 9
     C                   END
     C     SIBELR        IFNE      0
     C     SIBEL3        ANDNE     0
     C     SIBELS        DIV(H)    SIBEL3        XTVFA2           17 9
     C                   ELSE
     C                   MOVE      *ZEROS        XTVFA2
     C                   END
     C     XTVFA2        IFEQ      0
     C     SVBELT        MULT(H)   XTVFAK        XPROGR            9 0
     C                   ELSE
     C     SVBELT        MULT(H)   XTVFA2        XPROGR            9 0
     C                   END
     C                   Z-ADD     SVVKTN        XVEKGR            9 0
     C                   Z-ADD     SVNTM         XSTKGR            9 0
      *
     C     1             DO        7             XN                3 0
     C                   IF        AKD(XN) <> *BLANKS
     C                   EVAL      SVAKD(XN) = AKD(XN)
     C                   EVAL      SVASV(XN) = ASV(XN)
     C                   EVAL      SVASA(XN) = ASA(XN)
     C                   EVAL      SDKDAÆ = SVAKD(XN)
     C                   EVAL      SDKDSÆ = SVASV(XN)
     C                   EXSR      SRAVG2
     C                   END
     C                   ENDDO
      *
     C                   ENDSR
      *
      ******************************************
     C     SRAVG2        BEGSR
      ******************************************
     C     SADSDK1       SETLL     SADSD
     C     SADSDK2       READPE    SADSD                                  33
      *
     C                   IF        *IN33 = *OFF AND                             1<-B
     C                             SDDTF <= WDT80 AND SDDTT >= WDT80
N04  C                   IF        W2PVA <> ' ' AND XN = 1 AND
N04  C                             (W2CRE1 = 'UTB' OR W2CRE2 = 'UTB' OR
N04  C                              W2CRE3 = 'UTB' OR W2CRE4 = 'UTB' OR
N04  C                              W2CRE5 = 'UTB')
N04  C                   EVAL      SVPVA  = W2PVA
N04  C                   EVAL      SVAS   = W2AS
N04  C                   END
N04  C                   IF        W2MFR <> ' ' AND XN = 1
N04  C                   EVAL      SVMFR  = W2MFR
N04  C                   END
     C                   EVAL      SVASA(XN) = SDBLSÆ
     C                   IF        ASA(XN) > *ZEROS
     C                   EVAL      SVASA(XN) = ASA(XN)
     C                   ENDIF
     C     KODTS8K       CHAIN     KODTS8                             33
     C  N33              SELECT                                                  2<-B
     C     KS8STY        WHENEQ    '%'                                           2
     C                   Z-ADD     XPROGR        SVAGR(XN)
     C     KS8STY        WHENEQ    'P'                                           2
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      'K'
     C                   Z-ADD     XVEKGR        SVAGR(XN)
     C     KS8STY        WHENEQ    'G'                                           2
     C     XVEKGR        MULT      1000          SVAGR(XN)
     C     KS8STY        WHENEQ    'D'                                           2
     C                   EVAL(H)   SVAGR(XN) = XSTKGR / 12 + 0.5
     C     KS8STY        WHENEQ    'T'                                           2
     C                   EVAL(H)   SVAGR(XN) = XVEKGR / 1000 + 0.5
     C                   OTHER                                                   2
     C     KS8STY        IFNE      'M'                                            3<-B
     C     KS8STY        ANDNE     'A'
     C     KS8STY        ANDNE     'B'
     C                   Z-ADD     XSTKGR        SVAGR(XN)
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
      *
     C*    SVBLSÆ        IFEQ      0                                             2<-B
N04  C*                  IF        SVKDAÆ <> 'RT'
     C                   SELECT                                                  2<-B
     C                   WHEN      SVASA(XN) = 0                                 2
     C                   Z-ADD     KS8SAT        SVASA(XN)
     C                   WHEN      SVASA(XN) < 0                                 2
     C                   Z-ADD     0             SVASA(XN)
     C                   END                                                     2<-E
N04  C*                  END
     C                   MOVE      KS8STY        XEH2Æ             1
     C                   MOVE      KS8ØRE        XS8ØRE            1
     C     ASA(XN)       IFEQ      99999,99                                      2<-B
     C                   MOVE      *ZEROS        SVABL(XN)
     C                   ELSE                                                    2
     C     XEH2Æ         COMP      ' '                                    33
     C  N33XEH2Æ         COMP      'K'                                    33
     C  N33XEH2Æ         COMP      'G'                                    33
     C  N33XEH2Æ         COMP      'M'                                    33
     C  N33XEH2Æ         COMP      'D'                                    33
     C  N33XEH2Æ         COMP      'T'                                    33
     C  N33XEH2Æ         COMP      'L'                                    33
     C  N33XEH2Æ         COMP      'A'                                    33
     C  N33XEH2Æ         COMP      'B'                                    33
     C   33              EVAL      SVABL(XN) = SVAGR(XN) * SVASA(XN)
     C     XEH2Æ         COMP      '%'                                    33
     C  N33XEH2Æ         COMP      'H'                                    33
     C   33              EVAL      SVABL(XN) = SVAGR(XN) * SVASA(XN) / 100
     C     XEH2Æ         COMP      'P'                                    33
     C   33              EVAL      SVABL(XN) = SVAGR(XN) * SVASA(XN) / 1000
     C     XS8ØRE        COMP      '*'                                    33
     C   33              DIV(H)    100           SVABL(XN)
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SNDTVIN       BEGSR
      ***********************************************
     C                   EXSR      FINMTY
     C     SADHK         CHAIN     SADH                               33
     C                   MOVE      'Q'           SIST
     C                   EVAL      SIWS = 'TVINR'
     C                   MOVE      *ZEROS        SIMP
     C*                  MOVE      *ZEROS        X9DTØ
     C                   MOVE      *ZEROS        SIDTØ
     C                   MOVE      *ZEROS        SIBELD
     C                   MOVE      'J'           SIPKL
     C                   MOVE      W1N07         SIMF
     C                   MOVE      W9N01         SIMP
     C                   MOVE      'J'           SIPKL
     C                   EVAL      SIVKB=WSIVKB
     C                   UPDATE    SADHR
     C                   EXSR      KOMLIN
      *
     C                   ENDSR
      *
      ***********************************************
     C     FINMTY        BEGSR
      ***********************************************
     C                   MOVE      'N'           XBMI              1
     C                   MOVE      'N'           XINST             1
      *
      *** FINNER SANSYNLIG MELDINGSTYPE UTFRA LOGGELEMENT OG
      ***   FUNKSJONTASTER
     C                   Z-ADD     3             W9N01             1 0
      *
     C     M2KDCK        SETLL     EDIM2                              33
     C     STFMTY        TAG
     C     M2KD2K        READPE    EDIM2                                  33
     C  N33M1001         IFEQ      '830'                                        1<-B
     C     MST           OREQ      'D'
     C     MSR           OREQ      'S'
     C     M1N07         OREQ      'DFI'
     C     M1N07         OREQ      'DII'
     C     M1N07         OREQ      'DPU'
     C     M1N07         OREQ      'DKO'
     C     M0068C        OREQ      0
     C     M0068C        CABEQ     0             STFMTY
     C     MSR           IFEQ      'S'
     C     XINST         ANDEQ     'N'
     C     M1N07         IFEQ      'DMA'
     C     M1N07         OREQ      'DEN'
      * DENNE TOLLDEK. KAN VÆRE INNSTIKK HVIS MELDING FØR DENNE
      * ER EN 'DUA' FRA TOLLVESENET.
     C                   MOVE      'J'           XINST             1
     C                   END
     C                   END
     C                   GOTO      STFMTY
     C                   ELSE                                                   1
     C     M1N07         IFEQ      'DME'                                         2<-B
     C     SIMI          IFEQ      'I'                                            3<-B
     C                   GOTO      STFMTY
     C                   ELSE                                                     3
     C                   MOVE      'DKO'         W1N07             3
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     M0065         IFEQ      'NCUMUA'                                       3<-B
     C     M1N07         OREQ      'DUA'
      * INNSTIKK
     C*    *IN28         IFEQ      '1'                                             4<-B
     C*    XINST         OREQ      'J'
     C*                  MOVE      'J'           XBMI
     C*    SIDP          IFEQ      40                                               5<-B
     C*    SIDP          OREQ      41
     C*                  MOVE      'DEN'         W1N07
     C*                  ELSE                                                       5
     C*                  MOVE      'DMA'         W1N07
     C*                  END                                                        5<-E
     C*                  ELSE                                                      4
     C                   MOVE      'DKO'         W1N07
     C*                  END                                                       4<-E
     C                   ELSE                                                     3
     C     M1N07         IFEQ      'DIU'                                           4<-B
     C                   MOVE      '1'           *IN33
     C                   MOVE      '1'           *IN99
     C                   ELSE                                                      4
     C     M1N07         IFEQ      'DTK'                                            5<-B
     C                   MOVE      'DOM'         W1N07
     C                   ELSE                                                       5
     C                   MOVE      '1'           *IN33
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C   33SIDP          IFNE      40
     C     SIDP          ANDNE     41
     C     SIDP          ANDNE     49
     C                   MOVE      'DMA'         W1N07
     C                   ELSE
     C                   MOVE      'DFU'         W1N07
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     KOMLIN        BEGSR
      ***********************************************
      *
      * HENT SISTE DATO/SEKVENSNR./VERSJONSNR.
      *   1. HVIS DET FINNES OG IKKE ER 'IU', ØKER VERSJONSNR. MED 1
      *   2. HVIS DET IKKE PKT.1, HENTER NY DATO/SEKV.NR./VERSJONSNR.
     C     MAKDCK        SETLL     EDIM4                              31
      * FOR Å FÅ UNIK NUMMERERING PÅ ALLE TVINNSAKER SKAL VERSJ.NR ØKER
      * ALLTID (OGSÅ VED FEIL I INP.KTR.!!! - NÅR NY SAK I TVINN (ELLER
      * BARE DFI HITTIL SKAL NY DATO/SEKV.NR./V.NR. ALLTID TILDELES))
     C                   MOVE      *ZEROS        Æ0068C            2 0
     C     STKL          TAG
     C     MAKD2K        READPE    EDIM4                                  31
     C  N31M0065         IFNE      'CUSDEC'                                     1<-B
     C     M0065         ANDNE     'CUSRES'
     C                   GOTO      STKL
     C                   END                                                    1<-E
     C  N31MST           IFEQ      'D'                                          1<-B
     C     M1001         OREQ      '830'
     C     M0068C        OREQ      0
     C                   GOTO      STKL
     C                   END                                                    1<-E
     C  N31Æ0068C        IFEQ      0                                            1<-B
     C                   MOVE      M0068C        Æ0068C
     C                   END                                                    1<-E
     C  N31M1N07         IFEQ      'DFI'                                        1<-B
     C     M1N07         OREQ      'DII'
     C     M1N07         OREQ      'DPU'
     C                   GOTO      STKL
     C                   END                                                    1<-E
     C  N31M1N07         IFEQ      'DIU'                                        1<-B
     C                   MOVE      '1'           *IN31
     C                   ELSE                                                   1
     C     Æ0068C        ADD       1             M0068C
     C                   END                                                    1<-E
      *
      *** HENT NY DATO/SEKVENS/VERSJON
     C   31              DO
     C                   MOVEL     WDT           M0068A
      *** HENT SEKVENSNR.
     C     TVINDK        CHAIN     TVIND                              32
     C   32              Z-ADD     M0068A        D0068A
     C   32              Z-ADD     0             D0068B
     C                   ADD       1             D0068B
     C   32              WRITE     TVINDF
     C  N32              UPDATE    TVINDF
     C                   MOVE      D0068B        M0068B
      *** VERSJONSNR. SETTES LIK 1.
     C                   Z-ADD     1             M0068C
     C                   END
      *
      *** HENTE MELDINGSNR
     C     1             CHAIN     EDIC                               32
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EXSR      MOVKD1
     C     TVIM1K        SETLL     EDIM1                              32
     C     STKL3         TAG
     C     TVIM1K        READE     EDIM1                                  32
     C  N32M0065         IFEQ      'CUSDEC'
     C     M1001         ANDEQ     '929'
     C                   DELETE    EDIMR
     C                   ELSE
     C                   UPDATE    EDIMR
     C                   GOTO      STKL3
     C                   END
     C                   EXSR      MOVKD2
      *
N05  C*                  IF        XGJINN = 'J'
N05   * stop for å sjekke feil ved gjeninnførsel
N05  C*                  EVAL      MST = 'X'
N05  C*                  END
     C                   WRITE     EDIMR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVKD1        BEGSR
      ***********************************************
     C                   MOVE      M0068A        X0068A
     C                   MOVE      M0068B        X0068B
     C                   MOVE      M0068C        X0068C
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVKD2        BEGSR
      ***********************************************
     C                   EVAL      M0004 = 'NO119801'
     C                   EVAL      M0010 = 'NO000101'
     C*                  MOVE      W0035         M0035
     C                   EVAL      M0062 = X14S
     C                   MOVE      'CUSDEC'      M0065
     C                   MOVE      X0068A        M0068A
     C                   MOVE      X0068B        M0068B
     C                   MOVE      X0068C        M0068C
     C                   MOVE      *BLANKS       M0068
     C                   MOVE      XSYFORE       X0068Æ
     C                   Z-ADD     959231591     X0068Æ
     C                   MOVEL     XN068Å        M0068
     C                   MOVE      *ZEROS        M0068D
     C                   MOVE      *ZEROS        M0068E
     C                   MOVE      *ZEROS        M0068F
     C                   MOVE      '929'         M1001
     C                   MOVE      *BLANKS       M1004
     C                   SELECT
     C     W1N07         WHENEQ    'DFU'
     C                   MOVEL     '9  '         M1225
     C     W1N07         WHENEQ    'DMA'
     C                   MOVEL     'ZZ '         M1225
     C     W1N07         WHENEQ    'DFO'
     C                   MOVEL     '14 '         M1225
     C     W1N07         WHENEQ    'DEN'
     C                   MOVEL     '2  '         M1225
     C     W1N07         WHENEQ    'DKO'
     C                   MOVEL     '4  '         M1225
     C     W1N07         WHENEQ    'DOM'
     C                   MOVEL     '18 '         M1225
     C                   ENDSL
     C*                  MOVE      SIDTØ         M2005B
N01  C                   MOVE      *ZEROS        M2005B
     C                   Z-ADD     959231591     M3039D
S03  C*                  Z-ADD     20601         M3039E
N03  C                   IF        (DCL_1 >= '0' AND DCL_1 <= '9') AND
N03  C                             (DCL_2 >= '0' AND DCL_2 <= '9') AND
N03  C                             (DCL_3 >= '0' AND DCL_3 <= '9') AND
N03  C                             (DCL_4 >= '0' AND DCL_4 <= '9') AND
N03  C                             (DCL_5 >= '0' AND DCL_5 <= '9') AND
N03  C                             (DCL_6 >= '0' AND DCL_6 <= '9')
N03  C                   MOVEL     DCLPLACE      M3039E
N03  C                   ELSE
N03  C                   Z-ADD     0             M3039E
N03  C                   END
     C                   MOVE      *ZEROS        M5004D
     C                   MOVE      W1N07         M1N07
     C                   MOVE      *BLANKS       M1N08
      *
      *** SJEKK AT BEHANDLINGSPRIORITET ER INNENFOR INTERVALLET
     C     W9N01         IFLT      1
     C                   Z-ADD     1             M9N01
     C                   ELSE
     C     W9N01         IFGT      4
     C                   Z-ADD     4             M9N01
     C                   ELSE
     C                   MOVE      W9N01         M9N01
     C                   END
     C                   END
      *
     C                   MOVE      *ZEROS        MSN
     C                   Z-ADD     CMN           MMN
     C                   MOVE      'S'           MSR
     C                   MOVE      *BLANKS       MST
     C                   MOVE      *ZEROS        MDT
     C                   MOVE      *ZEROS        MTM
     C                   MOVE      SIAVD         MAVD
     C                   MOVE      SITDN         MTDN
     C                   MOVE      SIFRBN        MFFBNR
     C*                  MOVE      WVEN          MVEN
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UJN               1
     C                   EVAL      UJN='N'
     C     SADHK         KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     SADVK         KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    SVLI
     C     FRISOL01K     KLIST
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
     C                   EVAL       FSKODE = '*CR'
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    SIAVD
     C                   MOVE      'A'           KOAUNI
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     M2KDCK        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C                   KFLD                    MAX0D
     C     M2KD2K        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     MAKDCK        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C                   KFLD                    MAX0D
     C     MAKD2K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C     TVIM1K        KLIST
     C                   KFLD                    X1STA
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C     TVINDK        KLIST
     C                   KFLD                    M0068A
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    SVLK
     C     TARIK         KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    TATAR
     C     TARIKM        KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    TATAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
     C     TARIPVAK      KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    TADATO
     C     SADSDK1       KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    SDKDAÆ
     C                   KFLD                    SDKDSÆ
     C                   KFLD                    XSDDTF
     C     SADSDK2       KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    SDKDAÆ
     C                   KFLD                    SDKDSÆ
     C     CUNDMAFK      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    SIKNK
     C                   KFLD                    SDKDAÆ
      *
     C     SHPDOCK       KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C     CUSHDRK       KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C     SHPADRHK1     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    ADRCODEAVS
     C     *LIKE         DEFINE    ADRCODE       ADRCODEAVS
     C                   EVAL      ADRCODEAVS = 'CONSIGNOR'
     C     SHPADRHK2     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    ADRCODEMOT
     C     *LIKE         DEFINE    ADRCODE       ADRCODEMOT
     C                   EVAL      ADRCODEMOT = 'CONSIGNEE'
     C     SHPADRHK3     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    ADRCODEDEK
     C     *LIKE         DEFINE    ADRCODE       ADRCODEDEK
     C                   EVAL      ADRCODEDEK = 'DECLARANT'
     C     DOCADRHK1     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    ADRCODEAVS
     C     DOCADRHK2     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    ADRCODEMOT
     C     DOCADRHK3     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    ADRCODEDEK
     C     CUSDETK       KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
N03  C     HODEK         KLIST
N03  C                   KFLD                    CMPY
N03  C                   KFLD                    WHSE
N03  C                   KFLD                    SHPN
N03  C                   KFLD                    DOCN
N05  C     DOCTXTDK      KLIST
N05  C                   KFLD                    CMPY
N05  C                   KFLD                    WHSE
N05  C                   KFLD                    SHPN
N05  C                   KFLD                    DOCN
N05  C                   KFLD                    DOCR
     C     LINJEK        KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    DOCR
     C     DOCAMOUHK     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    WAMOUCODE
     C     DOCAMOUDK     KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    DOCR
     C     DOCREFHK      KLIST
     C                   KFLD                    CMPY
     C                   KFLD                    WHSE
     C                   KFLD                    SHPN
     C                   KFLD                    DOCN
     C                   KFLD                    WREFCODE
     C     KODTSIK       KLIST
     C                   KFLD                    KSIUNI
     C                   KFLD                    SISG
     C     KODTS8K       KLIST
     C                   KFLD                    SDKDAÆ
     C                   KFLD                    SDKDSÆ
     C     VAREKEY       KLIST
     C                   KFLD                    WLEVENR
     C                   KFLD                    WVARENR
     C     KODVAK        KLIST
     C                   KFLD                    SIVAL3
     C                   KFLD                    WDT80
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C                   MOVEL     WTM           TTTIME
      *
     C     *LIKE         DEFINE    SVLI          XSVLI
     C     *LIKE         DEFINE    SVREFL        XSVREFL
     C     *LIKE         DEFINE    SVTOP1        XSVTOP1
     C     *LIKE         DEFINE    MSR           XSR1
     C     *LIKE         DEFINE    MSR           XSR2
     C     *LIKE         DEFINE    MST           X1STA
     C     *LIKE         DEFINE    LEVENR        WLEVENR
     C     *LIKE         DEFINE    VARENR        WVARENR
     C     *LIKE         DEFINE    YREFCODE      WREFCODE
     C     *LIKE         DEFINE    AMOUCODE      WAMOUCODE
     C     *LIKE         DEFINE    SIVKB         WSIVKB
     C*                  MOVE      'S'           XSR               1
     C*                  MOVE      'R'           XSR1              1
     C*                  MOVE      *ZEROS        MIN0B             8 0
     C*                  MOVE      *ZEROS        MIN0C             6 0
     C*                  MOVE      *ZEROS        MIN0D             2 0
     C                   MOVE      '99999999'    MAX0B             8 0
     C                   MOVE      '999999'      MAX0C             6 0
     C                   MOVE      '99'          MAX0D             2 0
     C                   MOVE      *ZEROS        M0068A
     C                   MOVE      'S2 '         KS2UNI
     C                   MOVE      'SI'          KSIUNI
     C                   MOVE      'R'           XSR1
     C                   MOVE      'S'           XSR2
     C                   MOVE      ' '           X1STA
     C                   MOVE      '99999999'    XSDDTF            8 0
     C                   MOVEL     'OTHREF'      WREFCODE
     C                   MOVEL     'INVOIC'      WAMOUCODE
      *
     C                   MOVE      *ZEROS        SIRAB
     C                   MOVE      *ZEROS        SIBELC
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
      ***********************************************
     C     TTSR          BEGSR
      ***********************************************
     C                   MOVE      SIAVD         TTAVD
     C                   MOVE      SITDN         TTOPD
     C                   MOVE      'STS'         TTACTI
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      UUSR          TTUSER
     C                   EVAL      TTTEXT = 'SAD document entered'
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     TTSR2         BEGSR
      ***********************************************
     C                   MOVE      SIAVD         TTAVD
     C                   MOVE      SITDN         TTOPD
     C                   MOVE      'STS'         TTACTI
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      UUSR          TTUSER
     C                   EVAL      TTTEXT = 'SAD document changed'
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     GETPROC       BEGSR
      ***********************************************
     C                   EVAL      XSVLI  = 0
     C                   EVAL      XSVREFL = 0
     C                   EVAL      *IN34=*OFF
     C     CUSDETK       SETLL     CUSDET
     C     CUSDETK       READE     CUSDET                                 34
     C     *IN34         IFEQ      *OFF
     C     PROC1         ANDNE     *BLANKS
     C                   SELECT
     C     PROC1         WHENEQ    '3171'
     C                   EVAL      SIDP   = 60
     C                   OTHER
     C                   EVAL      SIDP   = 40
     C                   ENDSL
     C                   ENDIF
     C                   ENDSR
