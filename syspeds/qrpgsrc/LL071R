********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11176 * 01 YBC PTF11 TILLEGGSLINJER MED SAMME POST
********************************************************************
     FLLHEAD07  IF   E           K DISK    USROPN
     FLLLINE    IF   E           K DISK    USROPN
     FLLSERL02  IF   E           K DISK    USROPN
     FLLAGJD02  IF   E           K DISK    USROPN
     FLLAGJL01  IF   E           K DISK    USROPN
     FLLLISF    IF   E           K DISK    USROPN
     FLLTARF    UF A E           K DISK    USROPN
     FLLMRF     IF   E           K DISK    USROPN
     FTARI      IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FSAEH      IF   E           K DISK
     FSAEV      O    E             DISK
     FLL071D    CF   E             WORKSTN
     D                 DS
     D  LTTANR                 1     20
     D  T1                     1     20
     D                                     DIM(20)
     D                 DS
     D  XTTANR                 1     20
     D  T2                     1     20
     D                                     DIM(20)
     D                 DS
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D  SVTO                   1     45
N01  D                 DS
N01  D  SVFT01                 1     28
N01  D  SVFT02                29     56
N01  D  SVFT03                57     84
N01  D  SVFT04                85    112
N01  D  SVFT05               113    140
N01  D  SVFT06               141    168
N01  D  SVFT07               169    196
N01  D  SVFT                   1    224    DIM(8)
N01  D                 DS
N01  D  SVTOP1                 1     17
N01  D  SVTOP2                18     34
N01  D  SVTOP3                35     51
N01  D  SVTOP4                52     68
N01  D  SVTOP5                69     85
N01  D  SVTOP6                86    102
N01  D  SVTOP7               103    119
N01  D  SVTOP8               120    136
N01  D  SVTOP9               137    153
N01  D  SVTOP10              154    170
N01  D  SVTOP                  1    187    DIM(11)
N01  D                 DS
N01  D  SVCRE1                 1      3
N01  D  SVCRE2                 4      6
N01  D  SVCRE3                 7      9
N01  D  SVCRE4                10     12
N01  D  SVCRE5                13     15
N01  D  SVCRE6                16     18
N01  D  SVCRE7                19     21
N01  D  SVCRE8                22     24
N01  D  SVCRE9                25     27
N01  D  SVCRE10               28     30
N01  D  SVTCR                  1     33    DIM(11)
     D                 DS
     D  MRGN                   1     15
     D  XXGN                  15     15
      *
     C                   EXSR      INIT
      *
     C     LH07K         CHAIN     SAEH                               33
     C     LH07K         SETLL     LLHEAD07
     C     LH07K         READE     LLHEAD07                               33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C                   MOVE      'J'           UOK
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE     LLLINE                                 34
     C     *IN34         DOWEQ     '0'                                           2<-B
     C     LD02K         CHAIN     LLAGJD02                           36
     C     LJ01K         CHAIN     LLAGJL01                           36
     C     LMRFK         CHAIN     LLMRF                              36
     C  N36XXGN          COMP      *BLANKS                                36
     C   36              GOTO      XNESTE
     C     LLWVEK        IFGT      0                                              3<-B
     C                   MOVEL     LLVB          SVVT01
     C                   MOVE      *BLANKS       SVTOA
     C                   MOVE      *BLANKS       SVTOB
S01  C*                  MOVE      *BLANKS       SVCREF
N01  C                   MOVE      *BLANKS       SVTOP
N01  C                   MOVE      *BLANKS       SVTCR
     C     LTARK         CHAIN(N)  LLTARF                             35
     C     *IN35         IFEQ      '0'                                             4<-B
     C                   MOVE      LTFYL         SVFYL
     C                   MOVE      *ZEROS        XN2               3 0
     C     1             DO        20            XN                3 0              5<-B
     C     T1(XN)        IFGE      '0'                                               6<-B
     C     T1(XN)        ANDLE     '9'
     C                   ADD       1             XN2
     C                   MOVE      T1(XN)        T2(XN2)
     C                   END                                                         6<-E
     C                   ENDDO                                                      5<-E
     C     XN2           IFGE      8                                                5<-B
     C                   MOVEL     XTTANR        SVVNT
     C                   END                                                        5<-E
S01  C*                  MOVEL     LTTO          SVTOA
S01  C*    SVTOA         IFNE      *BLANKS
N01  C                   MOVEL     LTTO          SVTOP1
N01  C     SVTOP1        IFNE      *BLANKS                                          5<-B
     C     LTCRE         IFEQ      *BLANKS                                           6<-B
S01  C*                  MOVE      'TXT'         SVCREF
N01  C                   MOVE      'TXT'         SVCRE1
     C                   ELSE                                                        6
S01  C*                  MOVE      LTCRE         SVCREF
N01  C                   MOVE      LTCRE         SVCRE1
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   ELSE                                                      4
     C                   MOVE      *BLANKS       LTMOT
     C                   MOVE      *BLANKS       SVFYL
     C                   MOVE      *ZEROS        SVVNT
     C                   MOVE      LLANR         SVTOB
N01  C                   EVAL      SVEXR03 = LLANR
     C                   END                                                       4<-E
     C     LLWVEK        IFLT      1                                               4<-B
     C                   Z-ADD     1             SVVKTB
     C                   ELSE                                                      4
     C                   Z-ADD(H)  LLWVEK        SVVKTB
     C                   END                                                       4<-E
     C     SVVKTB        MULT(H)   0.9           SVVKTN
     C                   IF        LTMOT = 'J'                                     4<-B
     C                   Z-ADD     LLPRI         SVBELT
S01  C*                  Z-ADD     1             SVNT
S01  C*                  MOVE      'U.NR'        SVEH
N01  C                   Z-ADD     1             SVNT01
N01  C                   MOVE      'U.NR'        SVEH01
     C                   Z-ADD     1             SVNTM
     C     LLWNT0        SUB       1             XXNT              7 0
     C                   ELSE                                                      4
S01  C*                  MOVE      *ZEROS        SVNT
S01  C*                  MOVE      *BLANKS       SVEH
N01  C                   MOVE      *ZEROS        SVNT01
N01  C                   MOVE      *BLANKS       SVEH01
N01  C                   MOVE      *BLANKS       SVFT
     C     LLPRI         MULT      LLWNT0        SVBELT
     C                   MOVE      LLWNT0        SVNTM
     C                   END                                                       4<-E
     C                   ADD       1             SVLI
     C                   ADD       1             SVLN
     C     LS02K         SETLL     LLSERL02
     C     LS02K         READE     LLSERL02                               35
S01  C*    *IN35         IFEQ      '0'
S01  C*                  MOVEL     SNSN          SVFT
S01  C*    LS02K         READE     LLSERL02                               35
S01  C*                  ELSE
S01  C*                  MOVE      *BLANKS       SVFT
S01  C*                  END
N01  C                   Z-ADD     0             XN1               3 0
N01  C                   DOW       *IN33 = *OFF                                    4<-B
N01  C                   IF        SNSN <> *BLANKS                                  5<-B
N01  C                   ADD       1             XN1
N01  C                   IF        XN1 > 7                                           6<-B
N01  C                   LEAVE
N01  C                   END                                                         6<-E
N01  C                   EVAL      SVFT(XN1) = SNSN
N01  C                   END                                                        5<-E
N01  C     LS02K         READE     LLSERL02                               35
N01  C                   ENDDO                                                     4<-E
      *
     C     LLPRI         IFEQ      0                                               4<-B
     C                   IF        LTMOT = 'J'                                      5<-B
     C                   Z-ADD     VAVERD        SVBELT
S01  C*                  Z-ADD     1             SVNT
S01  C*                  MOVE      'U.NR'        SVEH
N01  C                   Z-ADD     1             SVNT01
N01  C                   MOVE      'U.NR'        SVEH01
     C                   Z-ADD     1             SVNTM
     C     LLWNT0        SUB       1             XXNT              7 0
     C                   ELSE                                                       5
S01  C*                  MOVE      *ZEROS        SVNT
S01  C*                  MOVE      *BLANKS       SVEH
N01  C                   MOVE      *ZEROS        SVNT01
N01  C                   MOVE      *BLANKS       SVEH01
     C     VAVERD        MULT      LLWNT0        SVBELT
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C     VAFAR         IFEQ      *BLANKS                                         4<-B
     C                   MOVEL     'NOK'         VAFAR
     C                   END                                                       4<-E
     C     VAFAR         IFNE      SEVAL1                                          4<-B
     C                   MOVEL     VAFAR         KVAKOD
     C     KODVAK        SETGT     KODTVAL2
     C     KVAKOD        READPE    KODTVAL2                               33
     C     SVBELT        MULT      KVAKRS        XBL              17 6
     C     XBL           DIV(H)    KVAOMR        SVBELT
     C                   END                                                       4<-E
     C     VAMN          SETLL     LLLISF
     C                   MOVE      *BLANKS       SVTO
N01  C                   MOVE      *BLANKS       SVTOP
N01  C                   IF        SVTOP1 = *BLANKS                                4<-B
N01  C                   Z-ADD     0             XN1               3 0
N01  C                   ELSE                                                      4
N01  C                   Z-ADD     1             XN1
N01  C                   END                                                       4<-E
     C     VAMN          READE     LLLISF                                 36
     C     *IN36         DOWEQ     '0'                                             4<-B
     C     LIREFE        IFNE      *BLANKS                                          5<-B
S01  C*                  MOVEL     LITXT         SVTO
S01  C*                  MOVEL     LIREFE        SVCREF
N01  C                   ADD       1             XN1
N01  C                   EVAL      SVTOP(XN1) = LITXT
N01  C                   EVAL      SVTCR(XN1) = LIREFE
N01  C                   IF        XN1 = 10                                          6<-B
     C                   LEAVE
N01  C                   END                                                         6<-E
     C                   END                                                        5<-E
     C     VAMN          READE     LLLISF                                 36
     C  N36              ENDDO                                                     4<-E
      *
     C     SVFYL         IFEQ      *BLANKS                                         4<-B
     C                   MOVE      '91'          SVFYL
     C                   END                                                       4<-E
     C     SVVNT         IFEQ      0                                               4<-B
     C                   MOVE      *BLANKS       WSVNTI
     C                   MOVE      *ZEROS        WSVNT
     C     STTANR        TAG
     C                   EXFMT     BILDE
     C                   MOVE      '0'           *IN99
     C     *IN04         IFEQ      '1'                                              5<-B
     C                   CALL      'SAD010A'
     C                   PARM                    WSVNTI
     C                   PARM                    WDT80
     C                   END                                                        5<-E
     C                   TESTN                   WSVNTI               36
     C   36              MOVE      WSVNTI        WSVNT
     C                   MOVE      WSVNT         TATANR
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE(N) TARI                                   99
     C     *IN99         DOWEQ     '0'                                              5<-B
     C     TADATO        IFLE      WDT80                                             6<-B
     C                   LEAVE
     C                   END                                                         6<-E
     C     TARIK         READPE(N) TARI                                   99
     C  N99              ENDDO                                                      5<-E
     C   99              GOTO      STTANR
     C     LTARK         CHAIN     LLTARF                             33
     C     *IN33         IFEQ      '0'                                              5<-B
     C                   MOVEL     WSVNT         LTTANR
     C                   UPDATE    LLTARFR
     C                   ELSE                                                       5
     C                   CLEAR                   LLTARFR
     C                   MOVE      LHGRP         LTGRUP
     C                   MOVE      LHPNR         LTPNR
     C                   MOVE      LLANR         LTANR
     C                   MOVE      'NO'          LTLK
     C                   MOVEL     WSVNT         LTTANR
     C                   MOVE      '91'          LTFYL
     C                   WRITE     LLTARFR
     C                   END                                                        5<-E
     C                   MOVE      WSVNT         SVVNT                             4<-E
     C                   END
      *
     C                   WRITE     SAEVR
      *
     C  N35              IF        LTMOT <> 'J'                                    4<-B
     C                   MOVE      *BLANKS       SVVT01
     C                   MOVE      *BLANKS       SVTOA
     C                   MOVE      *BLANKS       SVTOB
N01  C                   MOVE      *BLANKS       SVTOP
S01  C*                  MOVE      *BLANKS       SVCREF
N01  C                   MOVE      *BLANKS       SVTCR
N01  C                   MOVE      *BLANKS       SVFT
     C                   MOVE      *ZEROS        SVVKTB
     C                   MOVE      *ZEROS        SVVKTN
     C                   MOVE      *ZEROS        SVBELT
     C                   MOVE      *ZEROS        SVNTM
     C                   MOVE      SVLI          SVLN
     C                   END
N01  C                   Z-ADD     0             XN1               3 0             4<-E
N01  C  N35              ADD       1             SVLI
     C     *IN35         DOWEQ     '0'                                             4<-B
S01  C*                  ADD       1             SVLI
S01  C*                  MOVEL     SNSN          SVFT
S01  C*                  WRITE     SAEVR
N01  C                   IF        SNSN <> *BLANKS                                  5<-B
N01  C                   ADD       1             XN1
N01  C                   IF        XN1 > 7                                           6<-B
N01  C                   WRITE     SAEVR
N01  C                   MOVE      *BLANKS       SVFT
N01  C                   EVAL      XN1 = 1
N01  C                   END                                                         6<-E
N01  C                   EVAL      SVFT(XN1) = SNSN
N01  C                   END                                                        5<-E
     C     LS02K         READE     LLSERL02                               35
     C  N35              ENDDO                                                     4<-E
N01  C                   IF        XN1 > 0                                         4<-B
N01  C                   WRITE     SAEVR
N01  C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     XNESTE        TAG
     C     LHMN          READE     LLLINE                                 34     2<-E
     C  N34              ENDDO
     C     LH07K         READE     LLHEAD07                               33
     C  N33              ENDDO                                                  1<-E
      *
     C                   CLOSE     LLHEAD07
     C                   CLOSE     LLLINE
     C                   CLOSE     LLSERL02
     C                   CLOSE     LLAGJD02
     C                   CLOSE     LLAGJL01
     C                   CLOSE     LLLISF
     C                   CLOSE     LLTARF
     C                   CLOSE     LLMRF
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UOPD              7
     C                   PARM                    UDT               8
     C                   PARM                    UKN               8
     C                   PARM                    UOK               1
      *
     C     LH07K         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XOPD
     C     LD02K         KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    LLMN
     C                   KFLD                    LLVN
     C     LJ01K         KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    VDMN
     C     LS02K         KLIST
     C                   KFLD                    LLMN
     C                   KFLD                    LLVN
     C     LTARK         KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    LLANR
     C                   KFLD                    LTLK
     C     LMRFK         KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMRNR
     C     TARIK         KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    X2TAR
     C     TARIKM        KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    X2TAR             3
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
     C     KODVAK        KLIST
     C                   KFLD                    KVAKOD
     C                   KFLD                    XDT
      *
     C                   OPEN      LLHEAD07                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   OPEN      LLLINE                               33
     C                   OPEN      LLSERL02                             33
     C                   OPEN      LLAGJD02                             33
     C                   OPEN      LLAGJL01                             33
     C                   OPEN      LLLISF                               33
     C                   OPEN      LLTARF                               33
     C                   OPEN      LLMRF                                33
      *
     C                   MOVE      UAVD          XAVD              4 0
     C                   MOVE      UOPD          XOPD              7 0
     C                   MOVE      UDT           XDT               8 0
     C                   MOVE      UKN           XKN               8 0
     C                   MOVE      'N'           UOK
     C                   MOVE      UAVD          SVAVD
     C                   MOVE      UOPD          SVTDN
     C                   MOVE      'NO'          LTLK
     C                   WRITE     WINDOWSZ
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
      *
     C                   ENDSR
      *
