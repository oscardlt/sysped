      *
      **************************************************************
      *** PROGRAM FOR Å SKRIVE LAGERTELLELISTE                   ***
      **************************************************************
      *
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FLLAGJL05  IF   E           K DISK
     FLLAGJS05  IF   E           K DISK
     F                                     RENAME(LLAGJR:LLAGJRS5)
     FLLAGJL03  IF   E           K DISK
     F                                     RENAME(LLAGJR:LLAGJR3)
     FLLAGJS03  IF   E           K DISK
     F                                     RENAME(LLAGJR:LLAGJRS3)
     FLLAGJL02  IF   E           K DISK
     F                                     RENAME(LLAGJR:LLAGJR2)
     FLLAGJS02  IF   E           K DISK
     F                                     RENAME(LLAGJR:LLAGJRS2)
     FLLAGJD01  IF   E           K DISK
     FLLVARE01  IF   E           K DISK
     FLLLTLL01  O  A E           K DISK
     FLLTELL    UF A E             DISK
     FLL046P    O    E             PRINTER OFLIND(*IN01)
     D                 DS
     D  FRADAT                 1      8  0
     D  WSDATF                 3      8  0
     D                 DS
     D  TILDAT                 1      8  0
     D  WSDATT                 3      8  0
     D                 DS
     D  LTVARE                 1     35
     D  LTVARX                 1     30
     D                 DS
     D  LTBATC                 1     25
     D  LTBATX                 1     15
     D                 DS
     D  LTLLOK                 1     25
     D  LTLOK1                 1      5
     D  LTLOK2                 6     25
     D                 DS
     D  XTID                   1      6  0
     D  XDTD                   7      8  0
     D  XDTM                   9     10  0
     D  XDTÅ                  11     14  0
     D  XTIME                  1     14  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
      *
     C     *ENTRY        PLIST
     C                   PARM                    WSGRUA            8            GRUPPE
     C                   PARM                    WSKJEA            8            KUNDE/KJEDE
     C                   PARM                    WSDT              8            OPPTELLINGSDATO
     C                   PARM                    WSARTF           15            ARTIKKEL FRA
     C                   PARM                    WSARTT           15            ARTIKKEL TIL
     C                   PARM                    WSLAGF           25            LAG.LOK. FRA
     C                   PARM                    WSLAGT           25            LAG.LOK. TIL
     C                   PARM                    FRADAA            8            DATO FRA
     C                   PARM                    TILDAA            8            DATO TIL
     C                   PARM                    WSSORT            1            TVUNGEN SORT
      *
     C     LTLKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C     ARTKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    WSARTF
     C     LAGKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    WSLAGF
     C     DATKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    FRADAT
     C     REQKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C     DETKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMN
     C     VARKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAANR
     C     KUNKEG        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    VAGRUP
     C     KUNKEK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    VAKJED
      *
      *
     C                   MOVE      *ZEROS        GTOPOS            9 0
     C                   MOVE      *ZEROS        GTOSAL            9 0
     C                   MOVE      *ZEROS        GTOUPL            9 0
     C                   TIME                    XTIME
     C                   MOVE      XDTD          XIDAGD
     C                   MOVE      XDTM          XIDAGM
     C                   MOVE      XDTÅ          XIDAGÅ
     C                   MOVE      WSDT          XDT
     C     XDT           COMP      XIDAG                              5454
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   30
      *
     C                   MOVE      WSGRUA        VAGRUP
     C                   MOVE      WSKJEA        VAKJED
     C                   MOVE      FRADAA        FRADAT
     C                   MOVE      TILDAA        TILDAT
     C     4             CHAIN     LLTELL                             30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     1             LLREC1
     C                   WRITE     LLTELLR
     C                   ELSE
     C                   ADD       1             LLREC1
     C                   UPDATE    LLTELLR
     C                   END
     C                   MOVE      LLREC1        LTLNR
      *
     C     KUNKEK        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNKJE           30
      *
     C     KUNKEG        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNGRU           30
      *
      * 51 ON  = SORT PÅ ARTIKKEL
      * 52 ON  = SORT PÅ LAGERLOKASJON
      * 53 ON  = SORT PÅ INNLEGGSDATO
     C                   MOVEA     '000'         *IN(51)
      *
     C                   SELECT
     C                   WHEN      WSSORT = '1'
     C                   IF        ((WSARTF = *BLANKS) AND (WSARTT = *BLANKS))
     C                   EVAL      WSARTT = '999999999999999'
     C                   END
     C                   WHEN      WSSORT = '2'
     C                   IF        ((WSLAGF = *BLANKS) AND (WSLAGT = *BLANKS))
     C                   EVAL      WSLAGT = '9999999999999999999999999'
     C                   END
     C                   WHEN      WSSORT = '3'
     C                   IF        ((FRADAT = 0) AND (TILDAT = 0))
     C                   EVAL      TILDAT = 99999999
     C                   END
     C                   ENDSL
      * TVUNGEN SORTERING..
     C     WSSORT        IFNE      ' '
     C     WSSORT        COMP      '1'                                    51
     C     WSSORT        COMP      '2'                                    52
     C     WSSORT        COMP      '3'                                    53
     C                   ELSE
      * ELLER FØRSTE UTFYLTE SELEKSJON ER SØKEVEI..
     C                   SELECT
     C     WSARTF        WHENNE    *BLANKS
     C                   MOVE      '1'           *IN51
     C     WSLAGF        WHENNE    *BLANKS
     C                   MOVE      '1'           *IN52
     C                   OTHER
     C                   MOVE      '1'           *IN53
     C                   ENDSL
     C                   END
      *
      * *IN01=SIDEBRUDD (FRAMTVING PÅ 1. SIDE)
     C                   MOVE      *ON           *IN01
     C                   MOVE      'N'           XLISTE            1
     C     WSLAGF        IFEQ      '*ALL'
     C     *IN52         OREQ      '1'
     C     WSARTF        ANDEQ     '*ALL'
     C                   MOVEL     *BLANKS       WSLAGF
     C                   MOVEL     '99999999'    WSLAGT
     C                   END
     C     WSARTF        IFEQ      '*ALL'
     C                   MOVEL     *BLANKS       WSARTF
     C                   MOVEL     '99999999'    WSARTT
     C                   END
      *
     C                   SELECT
      * 51 = SORT PÅ ART
     C     *IN51         WHENEQ    '1'
     C   54ARTKEY        SETLL     LLAGJL03                               39
     C  N54ARTKEY        SETLL     LLAGJS03                               39
      * 52 = SORT PÅ LAGERLOK
     C     *IN52         WHENEQ    '1'
     C   54LAGKEY        SETLL     LLAGJL05                               39
     C  N54LAGKEY        SETLL     LLAGJS05                               39
      * 53 = SORT PÅ DATO
     C     *IN53         WHENEQ    '1'
     C   54DATKEY        SETLL     LLAGJL02                               39
     C  N54DATKEY        SETLL     LLAGJS02                               39
     C                   ENDSL
      *
     C     NYLIN         TAG
      *
     C                   SELECT
     C     *IN51         WHENEQ    '1'
     C   54REQKEY        READE     LLAGJL03                               39
     C  N54REQKEY        READE     LLAGJS03                               39
     C     *IN52         WHENEQ    '1'
     C   54REQKEY        READE     LLAGJL05                               39
     C  N54REQKEY        READE     LLAGJS05                               39
     C     *IN53         WHENEQ    '1'
     C   54REQKEY        READE     LLAGJL02                               39
     C  N54REQKEY        READE     LLAGJS02                               39
     C                   ENDSL
      *
     C     *IN39         IFEQ      *OFF                                         B1
     C   54VADATO        CABGE     XDT           NYLIN
      *
      * SJEKK NØKKELBASERTE VERDIER (TILVERDIER) - HOPP UT.
     C                   SELECT
     C     *IN51         WHENEQ    '1'
     C     VAANR         IFGT      WSARTT
     C                   GOTO      SLUTT
     C                   ENDIF
     C     *IN52         WHENEQ    '1'
     C     VALLOK        IFGT      WSLAGT
     C                   GOTO      SLUTT
     C                   ENDIF
     C     *IN53         WHENEQ    '1'
     C     VADATO        IFGT      TILDAT
     C                   GOTO      SLUTT
     C                   ENDIF
     C                   ENDSL
     C     WSARTT        IFGT      *BLANKS
     C     WSARTF        IFGT      VAANR
     C     WSARTT        ORLT      VAANR
     C                   GOTO      NYLIN
     C                   ENDIF
     C                   ENDIF
     C     WSLAGT        IFGT      *BLANKS
     C     WSLAGF        IFGT      VALLOK
     C     WSLAGT        ORLT      VALLOK
     C                   GOTO      NYLIN
     C                   ENDIF
     C                   ENDIF
     C     TILDAT        IFGT      0
     C     FRADAT        IFGT      VADATO
     C     TILDAT        ORLT      VADATO
     C                   GOTO      NYLIN
     C                   ENDIF
     C                   ENDIF
      *
      * SJEKK ANDRE FILTER, HOPP TIL NESTE
      * FRA/TIL ARTIKKEL
      * (PR I DAG ER ART.NR ALLTID KEY HVIS DEN I DET HELE TATT ER
      *  GJØR DENNE TESTEN NØDVENDIG)
      *  FYLLT UT, MEN FRAMTIDIG LØSNING MED VALG AV TVUNGEN SORTERING
     C     *IN51         IFNE      '1'
     C     WSARTF        IFNE      *BLANKS
     C     VAANR         ANDLT     WSARTF
     C                   GOTO      NYLIN
     C                   ENDIF
     C     WSARTT        IFNE      *BLANKS
     C     VAANR         ANDGT     WSARTT
     C                   GOTO      NYLIN
     C                   ENDIF
     C                   END
      * FRA/TIL LAGERLOKASJON
     C     *IN52         IFNE      '1'
     C     WSLAGF        IFNE      *BLANKS
     C     VALLOK        ANDLT     WSLAGF
     C                   GOTO      NYLIN
     C                   ENDIF
     C     WSLAGT        IFNE      *BLANKS
     C     VALLOK        ANDGT     WSLAGT
     C                   GOTO      NYLIN
     C                   ENDIF
     C                   END
      * FRA/TIL DATO...
     C     *IN53         IFNE      '1'
     C     FRADAT        IFNE      *ZEROS
     C     VADATO        ANDLT     FRADAT
     C                   GOTO      NYLIN
     C                   ENDIF
     C     TILDAT        IFNE      *ZEROS
     C     VADATO        ANDGT     TILDAT
     C                   GOTO      NYLIN
     C                   ENDIF
     C                   END
      *
      * HENT SALDO PÅ GITT DATO
     C     *IN54         IFEQ      '1'
      * SUMMER ANTALL KOLLI PÅ UTLEVERTE
     C     DETKEY        SETLL     LLAGJD01
     C     DETKEY        READE     LLAGJD01                               33
     C     *IN33         DOWEQ     '0'
     C     VDLDAT        IFGT      XDT
     C                   ADD       VDLANT        VASALD
     C                   END
     C     DETKEY        READE     LLAGJD01                               33
     C  N33              ENDDO
      *
     C     VASALD        CABLE     0             NYLIN
      *
     C     LVANR         IFNE      VAANR
     C     VARKEY        CHAIN     LLVARE01                           33
     C                   END
      *
     C                   END
      *
      * OVERFLOW
     C     *IN01         IFEQ      *ON
     C                   WRITE     HEAD                                 01
     C                   MOVE      'J'           XLISTE
     C                   END
      * SKRIV TIL ARBEIDSFIL
     C                   MOVE      'N'           LTSTAT
     C                   MOVE      VAGRUP        LTGRUP
     C                   MOVE      VAKJED        LTKJED
     C                   MOVE      VAGRUP        LTGRUP
     C                   MOVE      VAMN          LTMN
     C                   MOVE      VAHK          LTHK
     C                   MOVE      VAANR         LTANR
     C                   MOVE      VAANRL        LTANRL
     C                   MOVE      VAFAR         LTFAR
     C                   MOVE      VASIZ         LTSIZ
     C                   MOVE      VASALD        LTSALD
     C                   MOVE      *ZEROS        LTOPTS
     C                   MOVE      *ZEROS        LTDIFF
     C                   MOVE      VAVARE        LTVARE
     C                   MOVE      VADATO        LTDATO
     C                   MOVE      VALLOK        LTLLOK
     C                   MOVE      WSDT          LTLTDT
     C                   MOVE      VASENR        LTBATC
      * DOBBELTTREKT STREK FØR NESTE POST KUN NÅR SUBDETALJER SKRIVES
     C                   WRITE     DETALJ                               01
     C                   WRITE     LLLTLR
      *
     C                   GOTO      NYLIN
     C                   ENDIF                                                  E1
      *
     C     SLUTT         TAG
     C     XLISTE        IFEQ      'J'
     C                   WRITE     BUNN
     C                   END
     C                   SETON                                        LR
      *
