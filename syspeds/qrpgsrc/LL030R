     FLL030D    CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKUNKO2    IF   E           K DISK
     FLLGRPK05  IF   E           K DISK
     FLLHEAD07  IF   E           K DISK
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D                 DS
     D  WSTDT1                 1      6  0
     D  WSTDD1                 1      2  0
     D  WSTDM1                 3      4  0
     D  WSTDÅ1                 5      6  0
     D                 DS
     D  WSTDT2                 1      6  0
     D  WSTDD2                 1      2  0
     D  WSTDM2                 3      4  0
     D  WSTDÅ2                 5      6  0
     D                 DS
     D  WSTDT3                 1      6  0
     D  WSTDD3                 1      2  0
     D  WSTDM3                 3      4  0
     D  WSTDÅ3                 5      6  0
     D                 DS
     D  WSTDT4                 1      6  0
     D  WSTDD4                 1      2  0
     D  WSTDM4                 3      4  0
     D  WSTDÅ4                 5      6  0
     D                 DS
     D  WSTDT5                 1      6  0
     D  WSTDD5                 1      2  0
     D  WSTDM5                 3      4  0
     D  WSTDÅ5                 5      6  0
     D                 DS
     D  XTDT                   1      8  0
     D  XTDÅ                   1      4  0
     D  XTDM                   5      6  0
     D  XTDD                   7      8  0
     D                 DS
     D  WSUTE1                 1      1
     D  WSUTE2                 2      2
     D  WSUTE3                 3      3
     D  WSUTE4                 4      4
     D  WSUTE5                 5      5
     D  UT                     1      5
     D                 DS
     D  U1PARM                 1    256
     D  U1GRP                  1      8
     D  U1PNR                  9     16
     D  U1BNR                 17     33
     D  U1PAK                 34     50
     D  U1ORDR                51     67
     D  U1FLN                 68     84
     D  U1TDT                 85     92
     D  U1ALN                 93     99
     D  U1AVD                100    103
     D  U1OPD                104    110
     D  U1UT                 111    115
     D  U1FIRM               116    117
     D  U1ANR                118    132
     D  U1FLAG               256    256
      *
     C                   EXSR      INIT
     C     UMODE         IFEQ      'S'
     C                   MOVE      UGRP          WSGRP
     C                   MOVE      UPNR          WSPNR
     C                   GOTO      START1
     C                   END
      *
     C     START         TAG
     C  N04
     CANN30              Z-ADD     7             LINNBR
     C  N04
     CANN30              Z-ADD     16            POSNBR
     C                   EXFMT     LL030D1
     C                   MOVEA     '00'          *IN(98)
     C                   MOVE      '0'           *IN30
      *
     C     *IN03         CABEQ     '1'           SLUTT
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDT1
     C                   GOTO      START
     C                   END
      *
     C     START1        TAG
     C                   EXSR      TESTB1
     C     *IN30         CABEQ     '1'           START
      *
      *
     C                   EXSR      MOVB
     C     START2        TAG
     C                   EXFMT     LL030D2
     C                   MOVEA     '0000000'     *IN(93)
     C                   MOVE      '0'           *IN30
      *
     C     *IN03         CABEQ     '1'           SLUTT
     C     *IN12         CABEQ     '1'           START
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDT2
     C                   GOTO      START2
     C                   END
      *
     C                   EXSR      TESTB2
     C     *IN30         CABEQ     '1'           START2
      *
     C                   MOVE      WSGRP         U1GRP
     C                   MOVE      WSPNR         U1PNR
     C                   MOVE      WSBNR         U1BNR
     C                   MOVE      WSPAK         U1PAK
     C                   MOVE      WSORDR        U1ORDR
     C                   MOVE      WSFLN         U1FLN
     C                   MOVE      XTDT          U1TDT
     C                   MOVE      WSALN         U1ALN
     C                   MOVE      WSAVD         U1AVD
     C                   MOVE      WSOPD         U1OPD
     C                   MOVE      UT            U1UT
     C                   MOVE      FIFIRM        U1FIRM
     C                   MOVE      WSANR         U1ANR
     C                   MOVE      *ZEROS        U1FLAG
      *
     C     WSANR         IFEQ      *BLANKS
     C                   CALL      'LL031R'
     C     U1PARM        PARM      U1PARM        U2PARM          256
     C                   ELSE
     C                   CALL      'LL032R'
     C     U1PARM        PARM      U1PARM        U2PARM
     C                   END
      *
     C     U1FLAG        CABEQ     '1'           START2
      *
     C     SLUTT         TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     CUN1GK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSGRP
     C     CUN1PK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSPNR
     C     KUNKOK        KLIST
     C                   KFLD                    WSPNR
     C                   KFLD                    WSBNR
     C     LH07K         KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UMODE             1
     C                   PARM                    UGRP              8
     C                   PARM                    UPNR              8
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   MOVE      'D'           WSUTE1
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     MOVB          BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      *BLANKS       WSBNR
     C                   MOVE      999999        WSTDT1
     C                   MOVE      *BLANKS       WSPAK
     C                   MOVE      *ZEROS        WSTDT2
     C                   MOVE      *BLANKS       WSORDR
     C                   MOVE      *ZEROS        WSTDT3
     C                   MOVE      *BLANKS       WSFLN
     C                   MOVE      *ZEROS        WSTDT4
     C                   MOVE      *BLANKS       WSALN
     C                   MOVE      *ZEROS        WSAVD
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *BLANKS       WSANR
     C                   MOVE      *ZEROS        WSTDT5
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     32            POSNBR
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TESTB1        BEGSR
      *////////////////////////////////////////////////////////////
     C     WSPNR         COMP      0                                      98
     C  N98WSPNR         CHAIN     LLGRPK05                           98
     C     *IN98         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     16            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV0825'     MSGNR
     C                   GOTO      SLTB1
     C                   ELSE
     C                   MOVE      GKGRP         WSGRP
     C                   END
      *
     C     WSGRP         IFEQ      0
     C                   MOVE      *BLANKS       WSGNV
     C                   ELSE
     C     CUN1GK        CHAIN     CUNDL01                            99
     C     *IN99         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     16            POSNBR
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     CUN1PK        CHAIN     CUNDL01                            98
     C     *IN98         IFEQ      '0'
     C                   MOVE      KNAVN         WSPNV
     C                   ELSE
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     16            POSNBR
     C     *IN99         IFEQ      '0'
     C                   MOVE      'SPK0001'     MSGNR
     C                   END
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     SLTB1         TAG
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TESTB2        BEGSR
      *////////////////////////////////////////////////////////////
     C     WSBNR         IFEQ      *BLANKS
     C     WSPAK         ANDEQ     *BLANKS
     C     WSORDR        ANDEQ     *BLANKS
     C     WSFLN         ANDEQ     *BLANKS
     C     WSALN         ANDEQ     0
     C     WSAVD         ANDEQ     0
     C     WSOPD         ANDEQ     0
     C     WSANR         ANDEQ     *BLANKS
     C                   MOVE      'YBC0654'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
      *
     C                   MOVE      *ZEROS        UDD               2 0
     C                   MOVE      *ZEROS        UMM               2 0
     C                   MOVE      *ZEROS        UÅÅ               2 0
      *
     C     WSBNR         IFNE      *BLANKS
     C     KUNKOK        CHAIN     KUNKO2                             99
     C     *IN99         IFEQ      '1'
     C                   MOVE      'YBC0584'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C     WSTDT1        IFNE      999999
     C     WSTDT1        ANDNE     0
     C                   CALL      'TESTDATO'
     C                   PARM      WSTDD1        UDD               2 0
     C                   PARM      WSTDM1        UMM               2 0
     C                   PARM      WSTDÅ1        UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      98
     C     *IN98         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C                   END
     C                   END
      *
     C     WSPAK         IFNE      *BLANKS
     C     WSTDT2        ANDNE     0
     C                   CALL      'TESTDATO'
     C                   PARM      WSTDD2        UDD               2 0
     C                   PARM      WSTDM2        UMM               2 0
     C                   PARM      WSTDÅ2        UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      97
     C     *IN97         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C                   END
      *
     C     WSORDR        IFNE      *BLANKS
     C     WSTDT3        ANDNE     0
     C                   CALL      'TESTDATO'
     C                   PARM      WSTDD3        UDD               2 0
     C                   PARM      WSTDM3        UMM               2 0
     C                   PARM      WSTDÅ3        UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      96
     C     *IN96         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C                   END
      *
     C     WSFLN         IFNE      *BLANKS
     C     WSTDT4        ANDNE     0
     C                   CALL      'TESTDATO'
     C                   PARM      WSTDD4        UDD               2 0
     C                   PARM      WSTDM4        UMM               2 0
     C                   PARM      WSTDÅ4        UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      95
     C     *IN95         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C                   END
      *
     C     WSAVD         IFNE      0
     C     WSOPD         ORNE      0
     C     LH07K         SETLL     LLHEAD07
     C     LH07K         READE     LLHEAD07                               94
     C     *IN94         IFEQ      '1'
     C                   MOVE      'YBC0653'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   END
     C                   END
      *
     C     WSANR         IFNE      *BLANKS
     C     WSTDT5        ANDNE     0
     C                   CALL      'TESTDATO'
     C                   PARM      WSTDD5        UDD               2 0
     C                   PARM      WSTDM5        UMM               2 0
     C                   PARM      WSTDÅ5        UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      93
     C     *IN93         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C                   END
      *
     C     UDD           IFEQ      0
     C                   MOVE      *ZEROS        XTDT
     C                   ELSE
     C     UÅÅ           IFGT      50
     C     UÅÅ           ADD       1900          XTDÅ
     C                   ELSE
     C     UÅÅ           ADD       2000          XTDÅ
     C                   END
     C                   MOVE      UMM           XTDM
     C                   MOVE      UDD           XTDD
     C                   END
      *
     C     SLTB2         ENDSR
      *
      ***********************************************
     C     SØKDT1        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     16
     C     POSNBR        ANDLE     23
     C                   MOVE      'SØKGRP  '    UTYPE             8
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRP
     C                   PARM                    WSPNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSØK1
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     16
     C     POSNBR        ANDLE     23
     C                   MOVE      WSGRP         UTYPE
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRP
     C                   PARM                    WSPNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSØK1
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK1        ENDSR
      *
      ***********************************************
     C     SØKDT2        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     48
     C                   CALL      'SYFA81B'
     C                   PARM      WSPNR         UPNR2             8 0
     C                   PARM                    WSBNR            17
     C                   PARM                    UKN               8 0
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     46
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   CALL      'LL002R'
     C                   PARM      WSGRP         UGRP2             8 0
     C                   PARM      WSPNR         UPNR2
     C                   PARM                    WSANR
     C                   PARM                    UANRL            15
     C                   PARM                    UFLAGG
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK2        ENDSR
      *
