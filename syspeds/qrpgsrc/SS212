********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 BIAKT=L ER ENDRET TIL ≈ TESTE AUTORISASJON
********************************************************************
      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/SS212 MODULE(*LIBL/SS212 *LIBL/INCGI)
CRTPGM*         ACTGRP(CGI) AUT(*USE)
      *
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FCDBOAT    IF   E           K DISK    USROPN
     FCDBOATLF  IF   E           K DISK    USROPN
     F                                     RENAME(CDBOATR:CDBOATRLF)
     FSTED2     IF   E           K DISK    USROPN
     FGSSTWL02  UF A E           K DISK    USROPN
     FGSSTRF    UF A E           K DISK    USROPN
     FGSSORL21  IF   E           K DISK    USROPN
     FGSSCGF    IF   E           K DISK    USROPN
     FHEADF     UF A E           K DISK    USROPN
     FCUNDL01   IF   E           K DISK    USROPN
     FVALUL01   IF   E           K DISK    USROPN
     FTELL      UF   E           K DISK    USROPN
     FBRPARF    IF   E           K DISK    USROPN
     FFIRMARC   IF   E           K DISK    USROPN
     FARKTXT    IF   E           K DISK    USROPN
     FARKEXT    IF   E           K DISK    USROPN
     FARKIVL02  IF   E           K DISK    USROPN
      *********************************************************************
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
      *
      * Client input variables
     D user            s             10
     D UsrSpcName      s             10
     D WSSTART         s              1
     D WSCAN           s              1
     D WSTNO           s             11
     D WBTNO           s             11  0
     D WSFRAMES        s              1
     D WSKDB           s              5
     D WSAD1           s             30
     D WSAD2           s             30
     D WSAD3           s             30
     D WSAD4           s             30
     D WSAD5           s             30
     D WSAD6           s             30
     D WSDTL           s             10
     D WSTML           s              5
     D WSDTS           s             10
     D WSLOCT          s              5
     D WSCURC          s              3
     D WSFT1           s             70
     D WSFT2           s             70
     D WSDW            s             15
     D WSGN            s             11
     D WSFN11          s              3
     D WSFN12          s              7
     D WSFN13          s              2
     D WBFN13          s              2  0
     D WSFN21          s              3
     D WSFN22          s              7
     D WSFN23          s              2
     D WBFN23          s              2  0
     D WSFN31          s              3
     D WSFN32          s              7
     D WSFN33          s              2
     D WBFN33          s              2  0
     D WSVAL           s              3
     D WSBLC           s             12
     D WBBLC           s             11  2
     D WSWT            s              8
     D WBWT            s              7  1
     D WSM3            s              8
     D WBM3            s              7  3
     D FMELDNR         S              2
     D FEILMELDING     S             80
     D EMNE            S             44
     D SENDER          S             17
     D CMD             S           5000
     D MELD            S           5000
      *
     D OddEven         s             10
      *
     D FEIL01          C                   CONST('Vessel code is not valid.')
     D FEIL02          C                   CONST('Receiver can not be blank.')
     D FEIL03          C                   CONST('Delivery date is not valid.')
     D FEIL04          C                   CONST('Delivery time is not valid.')
     D FEIL05          C                   CONST('Dispatch date is not valid.')
     D FEIL06          C                   CONST('Location is not valid.')
     D FEIL07          C                   CONST('Currency code is not valid.')
     D FEIL08          C                   CONST('Way of delivery has to be -
     D                                     given.')
     D FEIL09          C                   CONST('Currency code is not valid.')
     D FEIL10          C                   CONST('Surcharge has to given.')
      * For xlate mellom Upper Case og Lower Case
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ∆ÿ≈')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzÊ¯Â')
     D                 DS
     D WBDTL≈                  1      4  0
     D WBDTLM                  5      6  0
     D WBDTLD                  7      8  0
     D WBDTL                   1      8  0
     D                 DS
     D WBTMLH                  1      2  0
     D WBTMLM                  3      4  0
     D WBTML                   1      4  0
     D                 DS
     D WBDTS≈                  1      4  0
     D WBDTSM                  5      6  0
     D WBDTSD                  7      8  0
     D WBDTS                   1      8  0
     D                 DS
     D VALKOD                  1      3
     D VALTEK                  6     20
     D VALTXT                  1     20
      *
     D XBANE           S             50
     D                 DS
     D  updf1                  1    400
     D  updf2                401    800
     D  updf3                801   1200
     D  updf4               1201   1600
     D  updf5               1601   2000
     D  updf6               2001   2400
     D  updf7               2401   2800
     D  updf8               2801   3200
     D  updf9               3201   3600
     D  updf10              3601   4000
     D  updf11              4001   4400
     D  updf12              4401   4800
     D  updf13              4801   5200
     D  updf14              5201   5600
     D  updf15              5601   6000
     D  updf16              6001   6400
     D  updf17              6401   6800
     D  updf18              6801   7200
     D  updf19              7201   7600
     D  updf20              7601   8000
     D  updf21              8001   8400
     D  updf22              8401   8800
     D  updf23              8801   9200
     D  updf24              9201   9600
     D  updf25              9601  10000
     D  updf26             10001  10400
     D  updf27             10401  10800
     D  updf28             10801  11200
     D  updf29             11201  11600
     D  updf30             11601  12000
     D  updf31             12001  12400
     D  updf32             12401  12800
     D  updf33             12801  13200
     D  updf34             13201  13600
     D  updf35             13601  14000
     D  updf36             14001  14400
     D  updf37             14401  14800
     D  updf38             14801  15200
     D  updf39             15201  15600
     D  updf40             15601  16000
     D  updf                   1  16000    DIM(40)
      *
      /copy syspeds/qrpgsrcpy,prolog3
      *
      * Get program start time for calculating execution time
     C                   time                    timedata1
      * Parse input / cvt to numeric
     C                   exsr      Parse
      * File open / keys
     C                   EXSR      INIT
      *
     C                   SELECT
     C                   WHEN      WSSTART = 'J'
     C                   IF        WBTNO = 0
     C                   EXSR      SRBLANK
     C                   ELSE
     C                   EXSR      SRGET
     C                   END
     C                   WHEN      WSCAN   = 'J'
     C                   EXSR      TESTB1
     C                   IF        FEILMELDING = *BLANKS
     C                   EXSR      SREND
     C                   END
     C                   WHEN      WSCAN   = 'Y'
     C                   EXSR      SREND
     C                   OTHER
     C                   EXSR      TESTB1
     C                   ENDSL
      *
     C                   IF        ((FMELDNR = *BLANKS) AND (WSSTART <> 'J'))
     C                   EXSR      SRUPD
     C                   ELSE
     C                   MOVE      WSKDB         TRBCD
     C                   MOVE      WSCURC        TWCURC
     C                   MOVE      WSVAL         TWVAL
     C                   END
      *
      * Read output skeleton html member into memory
     C                   exsr      LoadHtml
      * Set section variables
     C                   exsr      Settop
     C                   callp     wrtsection('top')
     C                   EXSR      HENTDOK
      * B≈TKODE
     C                   exsr      HENTBCD
      * VALUTAKODE
     C                   exsr      HENTCUR
      * LEVERINGSM≈TE
     C                   exsr      HENTLM
      * VALUTAKODE FLYFRAKT
     C                   exsr      HENTVAL
      * Quit
      * Compute run time
     C                   time                    timedata2
     C     timedata2     subdur    timedata1     ms:*ms
     C                   eval      sec = ms / 1000000
     C                   callp     updhtmlvar('runtime':
     C                             %trim(%editw(sec:'     0 .   ')))
      *
     C                   callp     wrtsection('bot')
     C                   exsr      Exit
      *
     C                   eval      *inlr = *on
     C                   return
      *
      *
      *=====================================================================
      * Parse input / cvt to numeric
      *=====================================================================
     C     Parse         begsr
      * Parse variables from QUERY_STRING environment variable
     C                   eval      user     = zhbgetvar('user')
     C                   EVAL      UsrSpcName  = zhbgetvar('UsrSpcName')
     C                   eval      WSTNO    = zhbgetvar('WSTNO')
     C                   EVAL      WBTNO    = c2n2(WSTNO)
     C                   eval      WSFRAMES = zhbgetvar('FRAMES')
     C                   eval      WSSTART  = zhbgetvar('WSSTART')
     C                   eval      WSCAN    = zhbgetvar('WSCAN')
     C                   eval      WSKDB    = zhbgetvar('WSKDB')
     C                   eval      WSAD1    = zhbgetvar('WSAD1')
     C     LC:UC         XLATE     WSAD1         WSAD1
     C                   eval      WSAD2    = zhbgetvar('WSAD2')
     C     LC:UC         XLATE     WSAD2         WSAD2
     C                   eval      WSAD3    = zhbgetvar('WSAD3')
     C     LC:UC         XLATE     WSAD3         WSAD3
     C                   eval      WSAD4    = zhbgetvar('WSAD4')
     C     LC:UC         XLATE     WSAD4         WSAD4
     C                   eval      WSAD5    = zhbgetvar('WSAD5')
     C     LC:UC         XLATE     WSAD5         WSAD5
     C                   eval      WSAD6    = zhbgetvar('WSAD6')
     C     LC:UC         XLATE     WSAD6         WSAD6
     C                   eval      WSDTL    = zhbgetvar('WSDTL')
     C                   EVAL      WBDTL    = c2n2(WSDTL)
     C                   eval      WSTML    = zhbgetvar('WSTML')
     C                   EVAL      WBTML    = c2n2(WSTML)
     C                   eval      WSDTS    = zhbgetvar('WSDTS')
     C                   EVAL      WBDTS    = c2n2(WSDTS)
     C                   eval      WSLOCT   = zhbgetvar('WSLOCT')
     C     LC:UC         XLATE     WSLOCT        WSLOCT
     C                   eval      WSCURC   = zhbgetvar('WSCURC')
     C                   eval      WSFT1    = zhbgetvar('WSFT1')
     C     LC:UC         XLATE     WSFT1         WSFT1
     C                   eval      WSFT2    = zhbgetvar('WSFT2')
     C     LC:UC         XLATE     WSFT2         WSFT2
     C                   eval      WSDW     = zhbgetvar('WSDW')
     C     LC:UC         XLATE     WSDW          WSDW
     C                   eval      WSGN     = zhbgetvar('WSGN')
     C     LC:UC         XLATE     WSGN          WSGN
     C                   eval      WSFN11   = zhbgetvar('WSFN11')
     C     LC:UC         XLATE     WSFN11        WSFN11
     C                   eval      WSFN12   = zhbgetvar('WSFN12')
     C     LC:UC         XLATE     WSFN12        WSFN12
     C                   eval      WSFN13   = zhbgetvar('WSFN13')
     C                   EVAL      WBFN13   = c2n2(WSFN13)
     C                   eval      WSFN21   = zhbgetvar('WSFN21')
     C     LC:UC         XLATE     WSFN21        WSFN21
     C                   eval      WSFN22   = zhbgetvar('WSFN22')
     C     LC:UC         XLATE     WSFN22        WSFN22
     C                   eval      WSFN23   = zhbgetvar('WSFN23')
     C                   EVAL      WBFN23   = c2n2(WSFN23)
     C                   eval      WSFN31   = zhbgetvar('WSFN31')
     C     LC:UC         XLATE     WSFN31        WSFN31
     C                   eval      WSFN32   = zhbgetvar('WSFN32')
     C     LC:UC         XLATE     WSFN32        WSFN32
     C                   eval      WSFN33   = zhbgetvar('WSFN33')
     C                   EVAL      WBFN33   = c2n2(WSFN33)
     C                   eval      WSVAL    = zhbgetvar('WSVAL')
     C                   eval      WSBLC    = zhbgetvar('WSBLC')
     C                   EVAL      WBBLC    = c2n2(WSBLC)
     C                   eval      WSWT     = zhbgetvar('WSWT')
     C                   EVAL      WBWT     = c2n2(WSWT)
     C                   eval      WSM3     = zhbgetvar('WSM3')
     C                   EVAL      WBM3     = c2n2(WSM3)
      *
     C                   eval      FEILMELDING = *BLANKS
     C                   eval      FMELDNR     = *BLANKS
      *
     C                   endsr
      *
      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   CLOSE     BRIDF
     C                   CLOSE     GSSTWL02
     C                   CLOSE     GSSTRF
     C                   CLOSE     GSSORL21
     C                   CLOSE     GSSCGF
     C                   CLOSE     HEADF
     C                   CLOSE     CUNDL01
     C                   CLOSE     VALUL01
     C                   CLOSE     TELL
     C                   CLOSE     STED2
     C                   CLOSE     CDBOAT
     C                   CLOSE     CDBOATLF
     C                   CLOSE     BRPARF
     C                   CLOSE     FIRMARC
     C                   CLOSE     ARKTXT
     C                   CLOSE     ARKEXT
     C                   CLOSE     ARKIVL02
      *
     C                   endsr
      *
      *=====================================================================
      * Read output skeleton html member into memory
      *=====================================================================
     C     LoadHtml      begsr
     C                   callp     gethtml('HTMLSRC':
     C                             '*LIBL':
     C                             'SS212':'/CGITAG/')
     C                   endsr
      *=====================================================================
      *  Set variable data for section /$top
      *=====================================================================
     C     SetTop        begsr
      *
OddEvC                   callp     updHTMLvar('ROWHEAD':RowHead)
OddEvC                   callp     updHTMLvar('LogoImg':LogoImg)
BODY C                   callp     updhtmlvar('BODYCLASS':'class='+BIFARG)
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHtmlVar('UsrSpcName':UsrSpcName)
     C                   callp     updHtmlVar('WSTNO':
     C                             %trim(%editc(WBTNO:'L')))
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
      *
     C                   callp     updHTMLvar('WSAD1':WSAD1)
     C                   callp     updHTMLvar('WSAD2':WSAD2)
     C                   callp     updHTMLvar('WSAD3':WSAD3)
     C                   callp     updHTMLvar('WSAD4':WSAD4)
     C                   callp     updHTMLvar('WSAD5':WSAD5)
     C                   callp     updHTMLvar('WSAD6':WSAD6)
     C                   callp     updHtmlVar('WSDTL':
     C                             %trim(%editw(WBDTL:'    .  .  ')))
     C                   callp     updHtmlVar('WSTML':
     C                             %trim(%editw(WBTML:'  :  ')))
     C                   callp     updHtmlVar('WSDTS':
     C                             %trim(%editw(WBDTS:'    .  .  ')))
     C                   callp     updHTMLvar('WSLOCT':WSLOCT)
     C                   callp     updHTMLvar('WSFT1':WSFT1)
     C                   callp     updHTMLvar('WSFT2':WSFT2)
     C                   callp     updHTMLvar('WSDW':WSDW)
     C                   callp     updHTMLvar('WSGN':WSGN)
     C                   callp     updHTMLvar('WSFN11':WSFN11)
     C                   callp     updHTMLvar('WSFN12':WSFN12)
     C                   callp     updHtmlVar('WSFN13':
     C                             %trim(%editc(WBFN13:'Z')))
     C                   callp     updHTMLvar('WSFN21':WSFN21)
     C                   callp     updHTMLvar('WSFN22':WSFN22)
     C                   callp     updHtmlVar('WSFN23':
     C                             %trim(%editc(WBFN23:'Z')))
     C                   callp     updHTMLvar('WSFN31':WSFN31)
     C                   callp     updHTMLvar('WSFN32':WSFN32)
     C                   callp     updHtmlVar('WSFN33':
     C                             %trim(%editc(WBFN33:'Z')))
     C                   callp     updHtmlVar('WSBLC':
     C                             %trim(%editc(WBBLC:'4')))
     C                   callp     updHtmlVar('WSWT':
     C                             %trim(%editc(WBWT:'4')))
     C                   callp     updHtmlVar('WSM3':
     C                             %trim(%editc(WBM3:'4')))
      *
     C                   callp     updhtmlvar('FEILMELDING':
     C                             FEILMELDING)
     C                   callp     updhtmlvar('FMELDNR':FMELDNR)
      *
     C                   endsr
      *
      *=====================================================================******
      *  SRBLANK
      *=====================================================================******
     C     SRBLANK       begsr
      *
     C                   EVAL      WBTNO  = 0
     C                   EVAL      WSAD1  = *BLANKS
     C                   EVAL      WSAD2  = *BLANKS
     C                   EVAL      WSAD3  = *BLANKS
     C                   EVAL      WSAD4  = *BLANKS
     C                   EVAL      WSAD5  = *BLANKS
     C                   EVAL      WSAD6  = *BLANKS
     C                   EVAL      WBDTL  = *ZEROS
     C                   EVAL      WBTML  = *ZEROS
     C                   EVAL      WBDTS  = *ZEROS
     C                   EVAL      WSLOCT = *BLANKS
     C                   EVAL      WSFT1  = *BLANKS
     C                   EVAL      WSFT2  = *BLANKS
     C                   EVAL      WSDW   = *BLANKS
     C                   EVAL      WSGN   = *BLANKS
     C                   EVAL      WSFN11 = *BLANKS
     C                   EVAL      WSFN12 = *BLANKS
     C                   EVAL      WBFN13 = *ZEROS
     C                   EVAL      WSFN21 = *BLANKS
     C                   EVAL      WSFN22 = *BLANKS
     C                   EVAL      WBFN23 = *ZEROS
     C                   EVAL      WSFN31 = *BLANKS
     C                   EVAL      WSFN32 = *BLANKS
     C                   EVAL      WBFN33 = *ZEROS
     C                   EVAL      WBBLC  = *ZEROS
     C                   EVAL      WBWT   = *ZEROS
     C                   EVAL      WBM3   = *ZEROS
      *
     C                   endsr
      *
      *=====================================================================******
      *  SRGET
      *=====================================================================******
     C     SRGET         begsr
      *
     C     WBTNO         CHAIN(N)  GSSTRF                             33
     C                   IF        ((((TRST <> ' ') AND
     C                                (TRST <> '1')) AND
     C                                (TRST <> '2')) AND
     C                                (TRST <> '3'))
     C                   EXSR      SREND
     C                   GOTO      SRGETEND
     C                   END
      *
     C                   EVAL      WSKDB  = TRBCD
     C     WSKDB         CHAIN(N)  CDBOAT                             33
     C                   EVAL      WSAD1  = TRAD1
     C                   EVAL      WSAD2  = TRAD2
     C                   EVAL      WSAD3  = TRAD3
     C                   EVAL      WSAD4  = TRAD4
     C                   EVAL      WSAD5  = TRAD5
     C                   EVAL      WSAD6  = TRAD6
     C                   EVAL      WBDTL  = TRDTL
     C                   EVAL      WBDTS  = TRDTS
     C                   EVAL      WSLOCT = TRLOCT
     C                   EVAL      WSDW   = TRDW
     C                   MOVEL     WBTNO         HEAVD
     C                   MOVE      WBTNO         HEOPD
     C     HEADFK        CHAIN(N)  HEADF                              33
     C                   MOVE      HEGN          WSGN
     C     WBTNO         CHAIN(N)  GSSTWL02                           33
     C                   EVAL      WSFT1  = TWFT1
     C                   EVAL      WSFT2  = TWFT2
     C                   EVAL      WSCURC = TWCURC
     C                   EVAL      WSFN11 = TWFN11
     C                   EVAL      WSFN12 = TWFN12
     C                   EVAL      WBFN13 = TWFN13
     C                   EVAL      WSFN21 = TWFN21
     C                   EVAL      WSFN22 = TWFN22
     C                   EVAL      WBFN23 = TWFN23
     C                   EVAL      WSFN31 = TWFN31
     C                   EVAL      WSFN32 = TWFN32
     C                   EVAL      WBFN33 = TWFN33
     C                   EVAL      WSVAL  = TWVAL
     C                   EVAL      WBBLC  = TWBLC
     C                   EVAL      WBWT   = TWWT
     C                   EVAL      WBM3   = TWM3
      *
     C     SRGETEND      ENDSR
      *
      *=====================================================================******
      *  TESTB1
      *=====================================================================******
     C     TESTB1        begsr
      *
     C     WSKDB         CHAIN     CDBOAT                             33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL01
     C                   EVAL      FMELDNR     = '01'
     C                   MOVE      *BLANKS       CBNAB
     C                   GOTO      SLTB1
     C                   END
      *
     C                   IF        WSAD1  = *BLANKS
     C                   EVAL      FEILMELDING = FEIL02
     C                   EVAL      FMELDNR     = '02'
     C                   GOTO      SLTB1
     C                   END
      *
     C                   MOVE      WBDTLD        UDD               2 0
     C                   MOVE      WBDTLM        UMM               2 0
     C                   MOVE      WBDTL≈        U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   MOVEL     FEIL03        FEILMELDING
     C                   MOVE      '03'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
      *
     C                   IF        WBTML <> 0
     C                   IF        ((WBTMLH > 23) OR (WBTMLM > 59))
     C                   MOVEL     FEIL04        FEILMELDING
     C                   MOVE      '04'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      *
     C                   MOVE      WBDTSD        UDD               2 0
     C                   MOVE      WBDTSM        UMM               2 0
     C                   MOVE      WBDTS≈        U≈≈               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   MOVEL     FEIL05        FEILMELDING
     C                   MOVE      '05'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
      *
     C                   IF        ((WSLOCT <> *BLANKS) OR (WSKDB = *BLANKS))
     C     WSLOCT        CHAIN     STED2                              33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL06
     C                   EVAL      FMELDNR     = '06'
     C                   GOTO      SLTB1
     C                   END
     C                   END
     C                   IF        ((WSLOCT = *BLANKS) AND (WBTNO <> 0))
     C     WBTNO         SETLL     GSSORL21
     C     WBTNO         READE     GSSORL21                               33
     C  N33              MOVE      ORBCD         XORBCD            5
     C                   DOW       *IN33 = *OFF
     C                   IF        ORBCD <> XORBCD
     C                   EVAL      FEILMELDING = FEIL06
     C                   EVAL      FMELDNR     = '06'
     C                   GOTO      SLTB1
     C                   END
     C     WBTNO         READE     GSSORL21                               33
     C                   ENDDO
     C                   END
      *
     C                   IF        WSCURC = *BLANKS
     C                   EVAL      FEILMELDING = FEIL07
     C                   EVAL      FMELDNR     = '07'
     C                   GOTO      SLTB1
     C                   END
      *
     C                   IF        WSDW = *BLANKS
     C                   EVAL      FEILMELDING = FEIL08
     C                   EVAL      FMELDNR     = '08'
     C                   GOTO      SLTB1
     C                   END
      *
     C                   IF        ((WSVAL = *BLANKS) AND
     C                               (WBBLC <> 0))
     C                   EVAL      FEILMELDING = FEIL09
     C                   EVAL      FMELDNR     = '09'
     C                   GOTO      SLTB1
     C                   END
     C                   IF        ((WSVAL <> *BLANKS) AND
     C                               (WBBLC = 0))
     C                   EVAL      FEILMELDING = FEIL10
     C                   EVAL      FMELDNR     = '10'
     C                   GOTO      SLTB1
     C                   END
      *
     C     SLTB1         ENDSR
      *
      *=====================================================================******
      *  SRUPD
      *=====================================================================******
     C     SRUPD         begsr
     C                   IF        WBTNO = 0
     C                   MOVE      'SSAVD'       PAID
     C     BrParKey      CHAIN     BRPARF                             33
     C                   Z-ADD     PAVRDN        TEAVD
     C     TEAVD         CHAIN     TELL                               33
     C                   MOVEL     TEAVD         WBTNO
     C                   MOVE      TEOPDN        WBTNO
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   END
      *
     C                   MOVE      'SSFIR'       PAID
     C     BrParKey      CHAIN     BRPARF                             33
     C                   MOVEL     PAVRDA        TRFC
      *
     C     WBTNO         CHAIN     GSSTRF                             33
     C  N33              IF        ((((TRST <> ' ') AND
     C                                (TRST <> '1')) AND
     C                                (TRST <> '2')) AND
     C                                (TRST <> '3'))
     C                   UPDATE    GSSTRFR
     C     WBTNO         CHAIN(N)  GSSTWL02                           33
     C                   GOTO      SRUPDEND
     C                   END
     C                   MOVE      WSKDB         TRBCD
     C                   MOVE      CBKN          TRCNO
     C                   MOVE      WSAD1         TRAD1
     C                   MOVE      WSAD2         TRAD2
     C                   MOVE      WSAD3         TRAD3
     C                   MOVE      WSAD4         TRAD4
     C                   MOVE      WSAD5         TRAD5
     C                   MOVE      WSAD6         TRAD6
     C                   MOVE      WBDTL         TRDTL
     C                   MOVE      WBTML         TRTML
     C                   MOVE      WBDTS         TRDTS
     C                   MOVE      XTWLC         TRLOCF
     C                   MOVE      WSLOCT        TRLOCT
     C                   MOVE      WSDW          TRDW
     C                   EVAL      TRMFT1 = 'DEL. BY: '
     C                             + TRDW
     C                   SELECT
     C                   WHEN      WSDW = 'AIRFREIGHT'
     C                   EVAL      TRMFT2 = 'AWBNO  : '
     C                             + WSGN
     C                   WHEN      WSDW = 'TRUCK'
     C                   EVAL      TRMFT2 = 'TRUCK  : '
     C                             + WSGN
     C                   WHEN      WSDW = 'SEAFREIGHT'
     C                   EVAL      TRMFT2 = 'B/L NO : '
     C                             + WSGN
     C                   OTHER
     C                   EVAL      TRMFT2 = 'AWBNO  : '
     C                             + WSGN
     C                   ENDSL
     C                   IF        *IN33
     C                   MOVE      '1'           TRST
     C                   MOVE      WBTNO         TRTNO
     C                   WRITE     GSSTRFR
      *
     C                   IF        XEPMOTT <> *BLANKS
     C                   EXSR      SNDEMAIL
     C                   END
      *
     C                   MOVE      'W'           TWTYP
     C                   MOVE      TRTNO         TWTNO
     C                   MOVE      TRLOCF        TWLC
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           TWDTR
     C                   MOVE      USER          TWUSR
     C                   MOVE      WSFT1         TWFT1
     C                   MOVE      WSFT2         TWFT2
     C                   MOVE      WSCURC        TWCURC
     C                   MOVE      WSFN11        TWFN11
     C                   MOVE      WSFN12        TWFN12
     C                   MOVE      WBFN13        TWFN13
     C                   MOVE      WSFN21        TWFN21
     C                   MOVE      WSFN22        TWFN22
     C                   MOVE      WBFN23        TWFN23
     C                   MOVE      WSFN31        TWFN31
     C                   MOVE      WSFN32        TWFN32
     C                   MOVE      WBFN33        TWFN33
     C                   MOVE      WSVAL         TWVAL
     C                   MOVE      WBBLC         TWBLC
     C                   MOVE      WBWT          TWWT
     C                   MOVE      WBM3          TWM3
     C                   WRITE     GSSTWFR
     C                   MOVEL     TRTNO         HEAVD
     C                   MOVE      TRTNO         HEOPD
     C                   MOVE      'U'           HEST
     C                   MOVE      'S'           HEUR
     C                   MOVE      WSGN          HEGN
     C                   MOVE      WDT           HEDTOP
     C                   MOVE      HEDTOP        HEDTR
     C                   MOVE      *ZEROS        HEHAWB
     C                   EXSR      SRMOVE
     C                   WRITE     HEADFR
     C                   ELSE
     C                   UPDATE    GSSTRFR
     C     WBTNO         CHAIN     GSSTWL02                           33
     C                   MOVE      WSFT1         TWFT1
     C                   MOVE      WSFT2         TWFT2
     C                   MOVE      WSCURC        TWCURC
     C                   MOVE      WSFN11        TWFN11
     C                   MOVE      WSFN12        TWFN12
     C                   MOVE      WBFN13        TWFN13
     C                   MOVE      WSFN21        TWFN21
     C                   MOVE      WSFN22        TWFN22
     C                   MOVE      WBFN23        TWFN23
     C                   MOVE      WSFN31        TWFN31
     C                   MOVE      WSFN32        TWFN32
     C                   MOVE      WBFN33        TWFN33
     C                   MOVE      WSVAL         TWVAL
     C                   MOVE      WBBLC         TWBLC
     C                   MOVE      WBWT          TWWT
     C                   MOVE      WBM3          TWM3
     C                   UPDATE    GSSTWFR
     C                   MOVEL     TRTNO         HEAVD
     C                   MOVE      TRTNO         HEOPD
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      WSGN          HEGN
     C     HEUR          IFEQ      'S'
     C                   EXSR      SRMOVE
     C                   END
     C                   UPDATE    HEADFR
     C                   END
      *
     C     SRUPDEND      ENDSR
      *
      *=====================================================================******
      *  SRMOVE
      *=====================================================================******
     C     SRMOVE        begsr
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   IF        *IN33 = *OFF
     C                   MOVE      TRCNO         HEKNS
     C                   MOVE      KNAVN         HENAS
     C                   MOVE      ADR1          HEADS1
     C                   MOVE      ADR2          HEADS2
     C                   MOVE      *BLANKS       HEADS3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          HEADS3
     C                   ELSE
     C                   MOVEL     POSTNR        HEADS3
     C                   MOVE      ADR3          HEADS3
     C                   END
     C                   END
     C                   MOVE      TRAD1         HENAK
     C                   MOVE      TRAD2         HEADK1
     C                   MOVE      TRAD3         HEADK2
     C                   MOVE      TRAD4         HEADK3
     C     TRLOCF        IFNE      *BLANKS
     C                   MOVE      TRLOCF        HESDF
     C                   MOVE      TRLOCT        HESDT
     C                   END
     C     TROT          IFNE      *BLANKS
     C                   MOVE      TROT          HEOT
     C                   MOVE      TRFR          HEFR
     C                   END
      *
     C                   ENDSR
      *
      *=====================================================================******
      *  SREND
      *=====================================================================******
     C     SREND         begsr
      *
     C                   callp     gethtml('HTMLSRC':
     C                             '*LIBL':
     C                             'SS212IC':'/CGITAG/')
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
     C                   callp     wrtsection('top')
     C                   exsr      Exit
     C                   eval      *inlr = *on
     C                   return
      *
     C                   endsr
      *
      *=====================================================================
      * HENT B≈TKODE
      *=====================================================================
     C     HENTBCD       begsr
      *
     C                   IF        TRBCD = *BLANKS
     C                   callp     updhtmlvar('CBNAB':'-- Select vesselcode --')
     C                   callp     updhtmlvar('CBKDB':'')
     C                   callp     wrtsection('typsltrow')
     C                   ELSE
     C     TRBCD         CHAIN     CDBOAT                             33
     C                   callp     updhtmlvar('CBNAB':CBNAB)
     C                   callp     updhtmlvar('CBKDB':CBKDB)
     C                   callp     wrtsection('typsltrow')
     C                   END
      *
     C     *LOVAL        SETLL     CDBOATLF
     C                   READ      CDBOATLF                               40
     C     *IN40         DOWEQ     '0'
     C                   IF        TRBCD <> CBKDB
     C                   SELECT
     C                   WHEN      ((XCG = *BLANKS) AND (CBLK <> '  '))
     C                   callp     updhtmlvar('CBNAB':CBNAB)
     C                   callp     updhtmlvar('CBKDB':CBKDB)
     C                   callp     wrtsection('typsltrow')
     C                   WHEN      ((CBKN = BIKUNR) AND (CBLK <> '  '))
     C                   callp     updhtmlvar('CBNAB':CBNAB)
     C                   callp     updhtmlvar('CBKDB':CBKDB)
     C                   callp     wrtsection('typsltrow')
     C                   WHEN      XCG <> *BLANKS
     C     CBKN          SETLL     GSSCGF
     C     CBKN          READE     GSSCGF                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        ((XCG = CGCG) AND (CBLK <> '  '))
     C                   callp     updhtmlvar('CBNAB':CBNAB)
     C                   callp     updhtmlvar('CBKDB':CBKDB)
     C                   callp     wrtsection('typsltrow')
     C                   LEAVE
     C                   END
     C     CBKN          READE     GSSCGF                                 33
     C                   ENDDO
     C                   ENDSL
     C                   END
     C                   READ      CDBOATLF                               40
     C  N40              ENDDO
      *
     C                   callp     wrtsection('typsltend')
      *
     C                   endsr
      *
      *=====================================================================
      * HENT VALUTAKODE
      *=====================================================================
     C     HENTCUR       begsr
      *
     C                   IF        TWCURC = *BLANKS
     C                   callp     updhtmlvar('VALTEK':'--- Choose a currency +
     C                             ---')
     C                   callp     updhtmlvar('VALKOD':'')
     C                   callp     wrtsection('typvalrow')
     C                   ELSE
     C     VALUL01K      CHAIN     VALUL01                            33
     C                   callp     updhtmlvar('VALTEK':VALTXT)
     C                   callp     updhtmlvar('VALKOD':VALKOD)
     C                   callp     wrtsection('typvalrow')
     C                   END
      *
     C     BIFIRM        SETLL     VALUL01
     C     BIFIRM        READE     VALUL01                                40
     C     *IN40         DOWEQ     '0'
     C                   IF        TWCURC <> VALKOD
     C                   callp     updhtmlvar('VALTEK':VALTXT)
     C                   callp     updhtmlvar('VALKOD':VALKOD)
     C                   callp     wrtsection('typvalrow')
     C                   END
     C     BIFIRM        READE     VALUL01                                40
     C  N40              ENDDO
      *
     C                   callp     wrtsection('typvalend')
      *
     C                   endsr
      *
      *=====================================================================
      * HENT LEVERINGSM≈TE
      *=====================================================================
     C     HENTLM        begsr
      *
     C                   IF        TRDW = *BLANKS
     C                   EVAL      TRDW = WSDW
     C                   END
      *
     C                   IF        TRDW = *BLANKS
     C                   callp     updhtmlvar('WSDWTXT':'AIRFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'AIRFREIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'TRUCK')
     C                   callp     updhtmlvar('WSDWKD':'TRUCK')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'SEAFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'SEAFEIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   ELSE
     C                   callp     updhtmlvar('WSDWTXT':TRDW)
     C                   callp     updhtmlvar('WSDWKD':TRDW)
     C                   callp     wrtsection('DWvalrow')
     C                   SELECT
     C                   WHEN      TRDW = 'AIRFREIGHT'
     C                   callp     updhtmlvar('WSDWTXT':'TRUCK')
     C                   callp     updhtmlvar('WSDWKD':'TRUCK')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'SEAFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'SEAFEIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   WHEN      TRDW = 'TRUCK'
     C                   callp     updhtmlvar('WSDWTXT':'AIRFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'AIRFREIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'SEAFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'SEAFEIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   WHEN      TRDW = 'SEAFREIGHT'
     C                   callp     updhtmlvar('WSDWTXT':'AIRFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'AIRFREIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'TRUCK')
     C                   callp     updhtmlvar('WSDWKD':'TRUCK')
     C                   callp     wrtsection('DWvalrow')
     C                   OTHER
     C                   callp     updhtmlvar('WSDWTXT':'AIRFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'AIRFREIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'TRUCK')
     C                   callp     updhtmlvar('WSDWKD':'TRUCK')
     C                   callp     wrtsection('DWvalrow')
     C                   callp     updhtmlvar('WSDWTXT':'SEAFREIGHT')
     C                   callp     updhtmlvar('WSDWKD':'SEAFEIGHT')
     C                   callp     wrtsection('DWvalrow')
     C                   ENDSL
     C                   END
      *
     C                   callp     wrtsection('DWvalend')
      *
     C                   endsr
      *
      *=====================================================================
      * HENT VALUTAKODE FOR FLYFRAKT
      *=====================================================================
     C     HENTVAL       begsr
      *
     C                   IF        TWVAL = *BLANKS
     C                   callp     updhtmlvar('VALTEKF':'*NONE')
     C                   callp     updhtmlvar('VALKODF':'')
     C                   callp     wrtsection('typvalrowF')
     C                   ELSE
     C     VALUL01KF     CHAIN     VALUL01                            33
     C                   callp     updhtmlvar('VALTEKF':VALTXT)
     C                   callp     updhtmlvar('VALKODF':VALKOD)
     C                   callp     wrtsection('typvalrowF')
     C                   END
      *
     C     BIFIRM        SETLL     VALUL01
     C     BIFIRM        READE     VALUL01                                40
     C     *IN40         DOWEQ     '0'
     C                   IF        TWVAL <> VALKOD
     C                   callp     updhtmlvar('VALTEKF':VALTXT)
     C                   callp     updhtmlvar('VALKODF':VALKOD)
     C                   callp     wrtsection('typvalrowF')
     C                   END
     C     BIFIRM        READE     VALUL01                                40
     C  N40              ENDDO
      *
     C                   IF        TWVAL <> *BLANKS
     C                   callp     updhtmlvar('VALTEKF':'*NONE')
     C                   callp     updhtmlvar('VALKODF':'')
     C                   callp     wrtsection('typvalrowF')
     C                   END
      *
     C                   callp     wrtsection('typvalendF')
      *
     C                   endsr
      *
      *=====================================================================******
      * Send MEDLING TIL BRUKER
      *=====================================================================******
     C     SNDEMAIL      begsr
      *
     C                   Z-ADD     1024          CMDL             15 5
     C                   EVAL      SENDER = '*CURRENT'
     C                   MOVE      TRTNO         XTRTNO           11
     C                   MOVE      TRTNO         HEOPD
     C                   MOVEL     TRTNO         HEAVD
      * Emne
     C                   Eval      EMNE = 'New trip is created '
     C                                    + %trim(XTRTNO)
      *
     C                   EVAL      MELD = 'New trip is created by '
     C                             + %trim(BIBRID) + '/' + %trim(BIBESK)
     C                             + ':/NAWB No. ' + %trim(WSGN)
     C                             + ':/P:/PThis message is created '
     C                             + 'automaticly by the booking system.'
     C                             + ':/NPlease do not reply!'
      *
      * param for tointnet og longmsg mÂ vÊre i apostrofer ( hex 7D )
      * (strenger i single-parametere som inneholder blank el. spesialtegn)
     C                   eval      cmd = 'SNDDST TYPE(*LMSG) TOINTNET('
     C                             +'('+ X'7D' + %trim(XEPMOTT) + X'7D' +')) +
     C                             DSTD('+ X'7D' + %trim(EMNE) + X'7D' + ') +
     C                             LONGMSG('+ X'7D' + %trim(MELD) + X'7D' +') +
     C                             USRID('+  %trim(SENDER) +') SNDFMT(*NOCHG)'
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    CMD
     C                   PARM                    CMDL
      *
     C                   ENDSR
      *
      *=====================================================================
      *  HENT DOKUMENTER
      *=====================================================================
     C     HENTDOK       BEGSR
     C                   MOVE      *BLANKS       UPDF
     C     WBTNO         CABEQ     0             SLHENTDOK
     C                   MOVEL     WBTNO         ARAVD
     C                   MOVE      WBTNO         AROPD
      *
     C     ARKIVL02K     SETLL     ARKIVL02
     C     ARKIVL02K     READE     ARKIVL02                               33
     C                   MOVE      *ZEROS        XN                3 0
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN
     C                   EVAL      UPDF(XN) = '<a href="'
     C                   CAT       XBANE:0       UPDF(XN)
     C                   CAT       ARLINK:0      UPDF(XN)
     C                   CAT       '" target="':0UPDF(XN)
     C                   CAT       'SyPDFWind': 0UPDF(XN)
     C                   CAT       '">':0        UPDF(XN)
     C                   IF        ARRFK = *BLANKS
     C                   CAT       'DOC':0       UPDF(XN)
     C                   MOVE      XN            XAN               3
     C                   CAT       XAN:0         UPDF(XN)
     C                   ELSE
     C                   CAT       ARRFK:0       UPDF(XN)
     C                   END
     C                   CAT       '<img src="':0UPDF(XN)
     C                   CAT       '/syspeddev':0UPDF(XN)
     C                   CAT       '/PDF.gif"':0 UPDF(XN)
     C                   CAT       'ALT="':1     UPDF(XN)
     C                   CAT       'DOC':0       UPDF(XN)
     C                   CAT       XAN:0         UPDF(XN)
     C                   CAT       '"></a>':0    UPDF(XN)
      *
S01  C*                  IF        ((XBIAKT = 'L') OR (XAGENT = 'J'))
N01  C                   IF        ((XAUT = 'L') OR (XAGENT = 'J'))
     C                   EVAL      UPDF(XN) = %trim(UPDF(XN))
     C                             + ' <a href="#" OnClick="DltDoc('
     C                             + 'this.form,'
     C                             + %trim(XAPSTR)
     C                             + %trim(XBANE) + %trim(ARLINK)
     C                             + %trim(XAPSTR) + ',' + %trim(XAPSTR)
     C                             + %trim(ARRFK)
     C                             + %trim(XAPSTR)
     C                             + ')"> <img src="/syspeddev/DeleteX.gif"'
     C                             + ' width=13 height=13 border=0>'
     C                   END
      *
     C     XN            COMP      40                                 33  33
     C  N33ARKIVL02K     READE     ARKIVL02                               33
     C                   ENDDO
      *
     C     SLHENTDOK     TAG
     C                   callp     updHTMLvar('UPDF1':UPDF1)
     C                   callp     updHTMLvar('UPDF2':UPDF2)
     C                   callp     updHTMLvar('UPDF3':UPDF3)
     C                   callp     updHTMLvar('UPDF4':UPDF4)
     C                   callp     updHTMLvar('UPDF5':UPDF5)
     C                   callp     updHTMLvar('UPDF6':UPDF6)
     C                   callp     updHTMLvar('UPDF7':UPDF7)
     C                   callp     updHTMLvar('UPDF8':UPDF8)
     C                   callp     updHTMLvar('UPDF9':UPDF9)
     C                   callp     updHTMLvar('UPDF10':UPDF10)
     C                   callp     updHTMLvar('UPDF11':UPDF11)
     C                   callp     updHTMLvar('UPDF12':UPDF12)
     C                   callp     updHTMLvar('UPDF13':UPDF13)
     C                   callp     updHTMLvar('UPDF14':UPDF14)
     C                   callp     updHTMLvar('UPDF15':UPDF15)
     C                   callp     updHTMLvar('UPDF16':UPDF16)
     C                   callp     updHTMLvar('UPDF17':UPDF17)
     C                   callp     updHTMLvar('UPDF18':UPDF18)
     C                   callp     updHTMLvar('UPDF19':UPDF19)
     C                   callp     updHTMLvar('UPDF20':UPDF20)
     C                   callp     updHTMLvar('UPDF21':UPDF21)
     C                   callp     updHTMLvar('UPDF22':UPDF22)
     C                   callp     updHTMLvar('UPDF23':UPDF23)
     C                   callp     updHTMLvar('UPDF24':UPDF24)
     C                   callp     updHTMLvar('UPDF25':UPDF25)
     C                   callp     updHTMLvar('UPDF26':UPDF26)
     C                   callp     updHTMLvar('UPDF27':UPDF27)
     C                   callp     updHTMLvar('UPDF28':UPDF28)
     C                   callp     updHTMLvar('UPDF29':UPDF29)
     C                   callp     updHTMLvar('UPDF30':UPDF30)
     C                   callp     updHTMLvar('UPDF31':UPDF31)
     C                   callp     updHTMLvar('UPDF32':UPDF32)
     C                   callp     updHTMLvar('UPDF33':UPDF33)
     C                   callp     updHTMLvar('UPDF34':UPDF34)
     C                   callp     updHTMLvar('UPDF35':UPDF35)
     C                   callp     updHTMLvar('UPDF36':UPDF36)
     C                   callp     updHTMLvar('UPDF37':UPDF37)
     C                   callp     updHTMLvar('UPDF38':UPDF38)
     C                   callp     updHTMLvar('UPDF39':UPDF39)
     C                   callp     updHTMLvar('UPDF40':UPDF40)
      *
     C                   ENDSR
      *
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
     C                   OPEN      BRIDF
     C     USER          CHAIN     BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt pÂ user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
      *
OddEv * hent Parametre som gÂr igjen i mange prog:
OddEv *      Odd/Even/Rowhead-farger,Logobilde,SprÂk,Intern/Ekstern bruker,  mm
OddEvc                   call      'ESGETPAR'
OddEvc                   parm                    BIBRID
OddEvc                   parm                    BIFIRM
OddEvc                   parm                    BIKUNR
OddEvc                   parm                    BIKNG
OddEvc                   parm                    RowHead          10
OddEvc                   parm                    Odd              10
OddEvc                   parm                    Even             10
OddEvc                   parm                    LogoImg          50
OddEvc                   parm                    XSPR≈K            2
OddEvc                   parm                    XINTERN           1
OddEvc                   parm                    ParmDS1        1024
OddEvc                   parm                    ParmDS2        1024
OddEvc                   parm                    ParmDS3        1024
      *
     C                   OPEN      GSSTWL02
     C                   OPEN      GSSTRF
     C                   OPEN      GSSORL21
     C                   OPEN      GSSCGF
     C                   OPEN      HEADF
     C                   OPEN      CUNDL01
     C                   OPEN      VALUL01
     C                   OPEN      TELL
     C                   OPEN      STED2
     C                   OPEN      CDBOAT
     C                   OPEN      CDBOATLF
     C                   OPEN      BRPARF
     C                   OPEN      FIRMARC
     C                   OPEN      ARKTXT
     C                   OPEN      ARKEXT
     C                   OPEN      ARKIVL02
      *
     C     HEADFK        klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C     CUNDL01K      klist
     C                   kfld                    BIFIRM
     C                   kfld                    TRCNO
     C     VALUL01K      klist
     C                   kfld                    BIFIRM
     C                   kfld                    TWCURC
     C     VALUL01KF     klist
     C                   kfld                    BIFIRM
     C                   kfld                    TWVAL
     C     ARKIVL02K     klist
     C                   kfld                    ARSTAT
     C                   kfld                    ARAVD
     C                   kfld                    AROPD
     C                   MOVE      'A'           ARSTAT
     C     ARKLAGK       KLIST
     C                   KFLD                    BIFIRM
     C                   KFLD                    ARKLAG
     C     BrParKey      klist
     C                   kfld                    PABRID
     C                   kfld                    PAKUNR
     C                   kfld                    PAID
     C                   MOVE      BIBRID        PABRID
     C                   MOVE      *zeros        PAKUNR
     C                   MOVE      *BLANKS       VALTXT
      * Brukeren kan kun jobbe for f¯lgende Attestasjonskode.
     C                   MOVE      'SSLOC'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVEL     PAVRDA        XTWLC             5
     C                   MOVE      'SSKGR'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVEL     PAVRDA        XCG               2
     C                   MOVE      'EPOST'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVEL     PAVRDA        XEPMOTT          50
     C                   MOVE      'SSAGT'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVE      'J'           XAGENT            1
N01  C                   MOVE      'AUTOR'       PAID
N01  C     BrParKey      chain     BRPARF                             33
N01  C                   IF        *IN33
N01  C                   MOVE      'N'           XAUT              1
N01  C                   ELSE
N01  C                   MOVEL     PAVRDA        XAUT
N01  C                   END
     C     'ZO'          CHAIN     ARKTXT                             33
     C                   IF        ARKLAG = *BLANKS
     C     BIFIRM        READE     FIRMARC                                50
     C                   ELSE
     C     ARKLAGK       CHAIN     ARKEXT                             33
     C                   END
     C                   EVAL      XBANE = '/' + %TRIM(ARCANE) + '/'
S01  C*                  MOVE      BIAKT         XBIAKT            1
     C                   BITON     '123457'      XAPSTR            1
     C                   BITOFF    '06'          XAPSTR
      *
     C                   endsr
      *
