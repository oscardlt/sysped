     H DEBUG(*YES)
      **************************************************************
      * UTSKRIFT AV GODSLISTE/MANIFEST LAND/"TURKONVOLUTT"
      * OBS! HENTER KUN EN STRING-KODE - EVT ANT COPIES MÅ VÆRE
      *      LAGT INN SOM PCL5 (&lnX der n=ant på OPTRA) el. annet.
      **************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 POSISJON FLYTTING I UDS
10XXX * 02 YBC PTF10 RETT FEIL PÅ ADRESSER
10XXX * 03 sh  PTF10 arkiverer også flere ganger ved annet enn innland
10XXX * 04 YBC PTF10 RETTELSE ETTER UTVIDELSE AV OPPDRAGSNR
10XXX * 05 jov PTF10 markering av kollibarcode uavh. av KFMPOS / uthevet i overskrift
10XXX * 06 sh  PTF10 posnummer borte i printerfil
10XXX * 07 JOV PTF10 Når først post etter agentbrudd hadde pos blank ble den printet 2 ganger
      * 08 JOV PTF10 STREKKODESTYRING PARAM PÅ FIRMA (samme som losseliste land import)
10XXX * 09 YBC PTF10 HENT LISTENR 23 VED LIGGENDE GODSLISTE
10172 * 10 SH  PTF10 norsk text til Track and trace
10172 * 11 SH  PTF10 track and trace på turnivå
10195 * 12 JOV PTF10 Fritekst på TURHeader i toppen av liste (kun side 1)
10195 * 13 SH  PTF10 FLYTTET LITT PÅ BARKODER I DDS
*******--------------------------------------------------------------------
10195 * 14 SH  PTF11 sikrer barcodwe flytting
      * 15 JOV PTF11 Skriv også ved tom liste
11XXX * 16 YBC PTF11 FEILRETTING PÅ ENDRING 15
11XXX * 17 SH  PTF11 HERFA / HERFK  *SYNYTMS*
11XXX * 18 SH  PTF11 ikke track and rtrace ved arkivering
11XXX * 19 SH  PTF11 BRUDDA = 'F' = fritt laget
11XXX * 20 SH  PTF11 frafax = C   er samlecmr
11XXX * 21 SH  PTF11 finne firmakode tidligr
11XXX * 22 SH  PTF12 sjekker at sendingsnummer er numerisk
11XXX * 23 SH  PTF12 VED EPOSTDIR OG BRUDD AGENT CLOSE OPEN SPOOLFILE
      ************************************************************************
N19  FCUNDC03   IF   E           K DISK
N19  FSAMCMRH   IF   E           K DISK
N19  FSAMCMRD   IF   E           K DISK
     FVADR      IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVL03  IF A E           K DISK
     FARKTXT    IF   E           K DISK
     FTRACKF    O  A E           K DISK
     FTRAVH1    IF   E           K DISK
     FTRAN      IF   E           K DISK
     FHETRIU    IF   E           K DISK
     FKOSBU     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FHESTED    IF   E           K DISK
     FHODE      IF   E           K DISK
     FFREETXT2  IF   E           K DISK
N12  FFREETUR2  IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTH     IF   E           K DISK
     FHEADF     UF   E           K DISK
     F                                     RENAME(HEADFR:HEADFR2)
     FHEAD14    IF   E           K DISK
     F                                     RENAME(HEADFR:HEADFR3)
     FFRISOK    IF   E           K DISK
     FDOKUFM    IF   E           K DISK
     FFAK2      UF A E           K DISK
     FTURER     UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTG2    IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FKODFRI    IF   E           K DISK
N08  FDOKUF     IF   E           K DISK
     FDOKUF99   IF   E           K DISK
N08  F                                     RENAME(DOKUFR:DOK99FR)
     FSYPROD    IF   E           K DISK
     FStsTur    IF   E           K DISK
     FStsOPD    IF   E           K DISK
     FStsFbr    IF   E           K DISK
N08  FSYPARL1   IF   E           K DISK
S23  F*YFA55PF  O    E             PRINTER OFLIND(*IN90)
n23  FSYFA55PF  O    E             PRINTER OFLIND(*IN90) usropn
S23  F*YFA55CP  O    E             PRINTER
n23  FSYFA55CP  O    E             PRINTER usropn
     D HO              S             80    DIM(7)
     D HE              S             80    DIM(7)
     D HT              S             80    DIM(7)
     D KNA             S              8  0 DIM(40)
     D HN              S             11  0 DIM(999)
     D                 DS
     D HP                      1    560    DIM(7)
     D  HP1                    1     80
     D  HP2                   81    160
     D  HP3                  161    240
     D  HP4                  241    320
     D  HP5                  321    400
     D  HP6                  401    480
     D  HP7                  481    560
     D                 DS
     D  STR                    1     75
     D                                     DIM(75)
     D  KFMT1                  1     75
     D  KFMT2                 76    150
     D  KFMT12                 1    120
     D                 DS
     D  DFS                    1     10
     D                                     DIM(10)
     D  FSDOKK                 1     10
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
N08  D                 DS
N08  D  HXSNDN                 1     20
N08  D  HXSNDNB                1     20
N08  D                 DS
N08  D  HEAVDOPD               1     12
N08  D  HEAVDOPDB              1     12
N08  D    HEAVDA               1      4
N08  D     Strek               5      5    INZ('_')
N08  D    HEOPDA               6     12                                         OBS! ER alt 7 lang!!
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
     D  HEFT1C                 1     30
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  DSSOK                  1     35
     D  DSAVD                  1      4  0
     D  DSOPD                  5     11  0
     D                 DS
     D  DATOTU                 1      6  0
     D  XUDTD                  1      2  0
     D  XUDTM                  3      4  0
     D  XUDTÅ                  5      6  0
     D                 DS
     D  TUDT                   1      8  0
     D  TUDTÅ                  1      4  0
     D  TUDTM                  5      6  0
     D  TUDTD                  7      8  0
     D                 DS
     D  HEPOS1                 1      7
     D  HEPOSA                 1      3
     D                 DS
     D  TUXXX2                 1      4
     D  TUPLUT                 1      2
     D  TUPLIN                 3      4
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  KNAVN                  1     30
     D  KNAVN25                1     25
      * dobbeltdefinert pga printerfil
     D                 DS
     D  HESG                   1      3
     D  HESGX                  1      3
     D                 DS
     D  HENAK                  1     30
     D  HENAK29                1     29
     D                 DS
     D  HEADK1                 1     30
S02  D* HEADK1X29              1     29
N02  D  HEADK129               1     29
     D                 DS
     D  HEADK2                 1     30
S02  D* HEADK2X29              1     29
N02  D  HEADK229               1     29
     D                 DS
     D  HEADK3                 1     30
     D  HEADK329               1     29
     D  HEADK3X29              1     29
     D                 DS
     D  HENAS                  1     30
     D  HENAS29                1     29
     D                 DS
     D  HEADS1                 1     30
S02  D* HEADS1X29              1     29
N02  D  HEADS129               1     29
     D                 DS
     D  HEADS2                 1     30
S02  D* HEADS2X29              1     29
N02  D  HEADS229               1     29
     D                 DS
     D  HEADS3                 1     30
     D  HEADS329               1     29
     D  HEADS3X29              1     29
     D                 DS
     D  HEGM1                  1     15
     D  HEGM1X                 1     15
     D                 DS
     D  HEGM2                  1     15
     D  HEGM2X                 1     15
     D                 DS
     D  HEVS1                  1     25
     D  HEVS1X                 1     25
     D                 DS
     D  HEVS2                  1     25
     D  HEVS2X                 1     25
     D                 DS
     D  DFNAVM                 1     30
     D  DFNAVM29               1     29
     D                 DS
     D  DFAD1M                 1     30
     D  DFAD1M28               1     28
     D                 DS
     D  TUSDF                  1     20
     D  TUSDFX                 1     20
     D  TUSDFY                 1     20
     D                 DS
     D  TUETD                  1      8  0
     D  TUETDÅ                 1      4  0
     D  TUETDM                 5      6  0
     D  TUETDD                 7      8  0
     D                 DS
     D  XETD                   1      6  0
     D  XETDD                  1      2  0
     D  XETDM                  3      4  0
     D  XETDÅ                  5      6  0
     D                 DS
     D  TUETA                  1      8  0
     D  TUETAÅ                 1      4  0
     D  TUETAM                 5      6  0
     D  TUETAD                 7      8  0
     D                 DS
     D  XETA                   1      6  0
     D  XETAD                  1      2  0
     D  XETAM                  3      4  0
     D  XETAÅ                  5      6  0
     D                UDS
     D  FIRMA                  3      4
     D  WAVDUU                15     18  0
     D  WTUR                  22     29  0
     D  CMR                   30     30
     D  INS1                  56     85
     D  STAR                  55     55
     D  ULKOD                 56     60
     D  LASGOD                61     61
     D  KUNNYE                62     62
S01  D* VED2                  86    115
S01  D* INS2                 116    145
S01  D* VED3                 146    175
S01  D* INS3                 176    205
S01  D* INS4                 206    235
S01  D* CFRANK               236    238
N01  D  VED2                  96    125
N01  D  INS2                 126    155
N01  D  VED3                 156    185
N01  D  INS3                 186    215
N01  D  INS4                 216    245
N01  D  CFRANK               246    248
     D  LEV1                 265    294
     D  LEV2                 295    324
     D  LEV3                 325    354
     D  LEV4                 355    384
     D  CSTED                385    410
     D  CDATO                411    416  0
     D  CDATOX               411    416  0
     D  CDATOY               411    416  0
     D  VED1                 417    446
N23  D  UPRT11               821    830
     D  BRUDDA               961    961
      *
     C                   EXSR      INIT
      *

      *
      *
     C                   EXSR      HODES
     C*
     C                   MOVE      *ZEROS        PRANT
     C                   MOVE      *ZEROS        POSNR             3 0
     C                   TIME                    TID               6 0
      *
      * FINNER FØRSTE ORDRE FOR Å SE OM DET ER FRA TRANSP.MODULEN
      *
      *
     C     UUPRO         SETLL     HEAD14
     C     UUPRO         READE     HEAD14                                 33
     C   33              MOVE      ' '           HEUR
     C*
      *
      * HVIS GODSLISTE, TR.MOD INNLAND, TILDEL POS-NR(DENNE AGENT)
      *
     C     *IN47         IFEQ      *ON
     C                   CALL      'SYFA55P'
     C                   PARM                    HEPRO
     C                   PARM                    HEKNA
     C                   END
      *
      * HENTER OPPLYSNINGER FRA TURREGISTER
      * OPPDATERER TURREGISTER MED STATUS = G HVIS FRA SPEDISJON
      * SETTER "KONVOLUTTSTATUS" TIL 'P' DERSOM FRA TRANSP.MODUL
      *
     C                   MOVE      *OFF          *IN92
     C     TUKEY         CHAIN     TURER                              60
     C  N60HEUR          IFEQ      ' '
     C     TUKNT2        ANDNE     *ZEROS
     C                   MOVE      'H'           HEUR
     C                   END
      *
      * ikke transport disponering
      *
     C     HEUR          IFNE      'H'
     C                   MOVE      *OFF          *IN45
     C     TUST          IFNE      'F'
     C                   MOVE      'G'           TUST
     C                   END
     C                   ELSE
      *
      * HEUR = H transportdisponerig
      * benytter tutst1 for versjonsnummer
      *
      *
     C                   MOVE      *ON           *IN45
     C* TILLAND=NORGE (ENTEN IMPORT ELLER INNLAND - IKKE SETT POS.NR.)
     C     HETRI         COMP      'NO'                                   75
     C                   MOVE      *ZEROS        TRATOT
     C  N47
     CANN48              MOVE      'P'           TUTST1
     C     *IN47         IFEQ      '1'
     C     TUTST1        IFGE      '1'
     C     TUTST1        ANDLE     '8'
     C                   MOVE      *ON           *IN92
     C                   MOVE      TUTST1        TMP1              1 0
     C     VERSJO        IFEQ      'J'
     C                   ADD       1             TMP1
     C                   exsr      GetTratot
     C                   END
     C                   MOVE      TMP1          TUTST1
     C                   END
     C     TUTST1        IFEQ      ' '
     C                   MOVE      '1'           TUTST1
     C     VERSJO        IFEQ      'J'
     C                   exsr      GetTratot
     C                   END
     C                   END
     C                   END
     C  N48              MOVE      HEKNA         TUKNA
     C     *IN47         IFEQ      '1'
     C     TUST          IFEQ      ' '
     C                   MOVE      'A'           TUST
     C                   END
      *                  setts
      * PALL-LAGER SKAL OPPDATERES..
      *
     C     PALLJN        IFEQ      'J'
     C     *IN47         ANDEQ     '1'
     C     BELJN         ANDEQ     'T'
     C     FRAFAX        ANDEQ     'N'
     C     TUXXX1        COMP      'X'                                4949
     C                   END
     C                   END
     C                   END
     C*
     C*
     C     FRAFAX        IFEQ      'N'
n19  C     BRUDDA        ANDNE     'F'
     C                   EXCEPT    OPDTUR
     c*
      * ikke ved laste liste
     C  N46              EXSR      ARKIVSR
n11  C                   move      'T'           tts               1
n11  c                   exsr      ttsr
n11  c                   move      ' '           tts
     C                   ELSE
n19  C     BRUDDA        IFEQ      'F'
s20  C*    FRAFAX        ANDEQ     'N'
n20  C     FRAFAX        IFEQ      'N'
n20  C     FRAFAX        OREQ      'C'
n19  C  N46              EXSR      ARKIVSR
n20  c                   end
n19  c                   end
     C                   EXCEPT    OPDTUD
     C                   END
     C*
     C   60              MOVE      *BLANKS       TUTARF
     C   60              MOVE      *BLANKS       TUBILN
     C   60              MOVE      *BLANKS       TUHENG
     C   60              MOVE      *BLANKS       TUNAT
      * HENTER TRANSPORTØRBELØP
      *Hvis ennå ikke avregnet, trtype  0 - hent avr.tall til estimert
     C  N60BELJN         IFEQ      'T'
      * GENERERING FLYTTET OPP/ EGEN SR / GJØRES KUN VED ORIGINAL
     C     TRANKE        CHAIN     TRAN                               32
     C  N60
     CANN32VMINCR        IFEQ      0                                            AVREGNES
     C     VMINCR        OREQ      4                                            AVREGN.PR SEND.
     C     VMINCR        OREQ      3                                            REGN. MEN SKJEMA
     C     TUKEY         CHAIN     TRAVH1                             32
     C     *IN32         IFEQ      '0'
      * LEGG INN NY VERDI.......
     C                   Z-SUB     THTOT         TRATOT            9 2
     C                   END
     C                   END
     C                   END
     C*
     C* HENTER OPPLYSNINGER FRA KUNDEREGISTER
     C* VELGER DERMED SPRÅK HEADING
     C*
     C                   MOVE      *ZEROS        KUNDNR
     C  N60              MOVE      TUKNA         KUNDNR
     C     UKNRA         IFNE      *ZEROS                                       1<-B
     C     UKNRA         ANDNE     *BLANKS
     C                   MOVE      UKNRA         KUNDNR
     C                   MOVE      UKNRA         FOKNA
     C                   ELSE                                                   1
     C  N33HEUR          IFNE      'H'                                           2<-B
     C     KUNDNR        ANDEQ     *ZEROS
     C     HEKNA         IFEQ      *ZEROS                                         3<-B
     C     STHAGT        TAG
     C     UUPRO         READE     HEAD14                                 33
     C  N33HEKNA         CABEQ     0             STHAGT
     C                   END                                                      3<-E
     C  N33              MOVE      HEKNA         KUNDNR
     C  N33              MOVE      HEKNA         FOKNA
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C                   EXSR      BRUAG
     C*
     C   60              MOVE      *BLANKS       KNAVN
     C*
     C     UKNRA         IFEQ      *ZEROS
     C     UKNRA         OREQ      *BLANKS
     C                   MOVE      *ZEROS        KUNDNR
     C                   END
     C*
     C*
     C     UUPROK        SETLL     HEAD14
     C*
     C     STL           TAG
     C                   SETOFF                                       33
     C     UUPRO         READE     HEAD14                                 33
     C   33              DO
     C                   SETON                                        50         SISTE SIDE
     C                   EXSR      BRUSR
     C                   GOTO      SLUTT
     C                   END
     C*
     C*
     C* GÅR TIL OPPDRAG HVIS STATUS = S
     C*
     C     HEST          IFEQ      'S'
     C                   GOTO      STL
     C                   END
     C*
     C* IKKE ANDRE ENN EKSPORT OG TRANSPMODUL
     C* (AV HENSYN TIL EVT RUNDTUR SOM STARTER MED IMPORT I SPEDMODUL)
     C*
     C     HEUR          IFNE      'B'
     C     HEUR          ANDNE     'H'
     C                   GOTO      STL
     C                   END
n19  C     BRUDDA        IFEQ      'F'
n19  C     SAMCMRDKH     CHAIN     SAMCMRD                            34
n19  C   34              GOTO      STL
n19  C                   END
     C* LASTELISTE INNLAND
     C* BEDT OM KUNNYE OG/ELLER KUN FOR GITT LAGERPOSISJON
     C     *IN46         IFEQ      *ON
     C     KUNNYE        IFEQ      'J'
     C     HXLLST        ANDEQ     'X'
     C                   GOTO      STL
     C                   END
     C     KUNLAG        IFNE      '*ALL '
     C     HXLKOD        ANDNE     KUNLAG
     C                   GOTO      STL
     C                   END
     C                   END
     C*
     C*
     C* VED FORDELINGSOPPDRAG FLYTTES INNTEKT PÅ INLANDSOPPDRAG
     C* TIL UTGIFT PÅ IMPORTOPPDRAG
     C*
     C                   EXSR      GENIK
     C*
     C* SETTER POSISJON PÅ OPPDRAGET
     C* (MEN IKKE VED 75- ON= FRA TRANSPMODUL - IMPORT/INNLAND)
     C* DET VIL SI TILLAND NORGE
     C*
     C  N75              ADD       1             ON                3 0
     C  N75              MOVEL     HEAVD         HN(ON)
     C  N75              MOVE      HEOPD         HN(ON)
     C*
     C* HENT KUBIK FRA HEADTR VED TRANSPORTMODULOPPDRAG.
     C*
     C*
     C* SKRIVER TOTAL HVIS BESTILLT PR AGENT
     C*
     C     HEKNA         IFNE      FOKNA
      *
     C     BRUDDA        IFEQ      'J'
     C                   EXSR      BRUSR
     C                   MOVE      HEKNA         KUNDNR
     C     UKNRA         IFNE      *ZEROS
     C                   GOTO      SLUTT
     C                   END
     C                   EXSR      BRUAG
     C                   END
      *
      * V/INNLAND - POS.PR AGENT/DATO-OPPDATERING OGSÅ NÅR UBRUTT LISTE
     C     *IN47         IFEQ      *ON
     C                   CALL      'SYFA55P'
     C                   PARM                    HEPRO
     C                   PARM                    HEKNA
      *
N07   * dersom bruddoppdraget hadde blank i pos har det nå fått (001) - hindre dobbelprint
N07   * readPrevious + read sikrer at en får rett oppdrag/posisjon i current detaljpost.
      *
N07  c     HEPOS1        ifeq      *blanks
N07  C     UUPRO         READPE    HEAD14                                 33
N07  C  N33UUPRO         READE     HEAD14                                 33
N07  C                   endif
     C                   END
     C                   MOVE      HEKNA         FOKNA             8 0
     C                   END
     C*
N19  C     CPRINT        IFNE      'N'
s20  C*    FRAFAX        OREQ      'J'
N20  C     FRAFAX        IFNE      'C'
     C                   EXSR      PRINT
     C                   GOTO      STL
N20  C                   END
N19  C                   END
     C*
     C*
     C     SLUTT         TAG
     C*
      * GODSLISTE INNLAND - SKRIV EVT MANKO +
     C     *IN47         IFEQ      '1'
     C     *IN44         ANDNE     '1'
     C                   EXSR      MANKO
     C                   END
     C* OPPDATER PALLE-REGNSKAP
     C     *IN49         IFEQ      '1'
     C                   ADD       TPEXTR        TPALLT
     C     TPALLT        IFNE      *ZEROS
      * 1. PALL-LAGER-HOLDER AVGIR,    TRANSPORTØR MOTTAR
      * KODE: K=KUNDE, T=TRANSP. ' '= PALLEPARTS-NR
     C                   Z-ADD     1             XXAVGI            8 0
     C                   MOVE      ' '           XXAVGK            1
     C                   Z-ADD     TUKNT2        XXMOTT            8 0
     C                   MOVE      'T'           XXMOTK            1
     C                   MOVE      ' '           XXVIA             1
     C                   Z-ADD     TPALLT        XXANT             5 0
     C                   MOVEL     TUBILN        XXBILN           10
     C                   MOVE      'B'           XXBEIE            1
     C                   MOVEL     'TUR:'        XXTXTX           12
     C                   MOVE      TUPRO         XXTXTX
     C                   MOVEL     XXTXTX        XXTXT            20
     C                   MOVE      '0'           XXFLAG            1
     C                   CALL      'SYPA11'
     C                   PARM                    XXAVGI
     C                   PARM                    XXAVGK
     C                   PARM                    XXMOTT
     C                   PARM                    XXMOTK
     C                   PARM                    XXVIA                          X=VIA LAG.HO
     C                   PARM                    XXANT
     C                   PARM                    XXBILN
     C                   PARM                    XXBEIE
     C                   PARM                    XXTXT
     C                   PARM                    XXFLAG
      * (TIDLIGERE BLE "STATUS" OPPDAT OGSÅ NÅR 0 I PALL.)
      * OPPDATER KODE I TURREGISTER (TUPLUT ER NÅ SAMLET FRA OPPD+EXTR)
     C     TUKEY         CHAIN     TURER                              60
     C  N60              MOVE      'X'           TUXXX1
     C  N60              MOVE      TPALLT        TUPLUT
     C  N60              EXCEPT    OPDTUP
     C                   END
     C                   END
     C*
     C* OPPDATERER POSISJONER
     C*
     C  N75              EXSR      OPPOS
     C*
N23  C                   CLOSE     SYFA55CP
N23  C                   CLOSE     SYFA55pf
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     GetTraTot     BEGSR
     C******************************************
     C  N60BELJN         IFEQ      'T'
     C     TUAVRE        IFNE      'X'
     C                   MOVE      'N'           XXVIS             1
     C                   CALL      'SYTR12A'
     C                   PARM                    UUAVD
     C                   PARM                    UUPRO
     C                   PARM                    XXVIS
     C                   PARM                    N4                4 0
S04  C*                  PARM                    N5                5 0
N04  C                   PARM                    N7                7 0
     C                   PARM                    N8                8 0
     C                   END
     C                   END
     C                   endsr
     C******************************************
     C     DELHELM       BEGSR
     C******************************************
      * Skytestatuser
      * ' ' = 'Påbegynt åpen'
      * 'X' = 'Ferdig alt OK'
      * 'M' = 'Ferd. m/manko'
      * 'N' = 'Nattportmanko'
      * 'G' = 'Godkj. manko'
     C     STSTURKEY     CHAIN     STSTUR                             33
     C     *in33         cabeq     '1'           UtMankoD
     C     STSTAT        cabeq     'X'           UtMankoD
     C     STSTURKEY     Setll     STSFBR
     C     STSTURKEY     READE     STSFBR                                 33
     C     *in33         DoWeq     *OFF
     C     SFSTAT        cabeq     'X'           NxtStsOD                    OK SKUTT
     C     SFSTAT        cabeq     'Y'           NxtStsOD                    OK MANUELT
     C                   MOVE      SFAVD         HEAVD
     C                   MOVE      SFOPD         HEOPD
     C     HEAKE2        CHAIN(N)  HEADF                              33
     C     *in33         cabeq     '1'           NxtStsOD
     C     HEPRO         cabne     UUPRO         NxtStsOD
      * HELMANKO  -< FJERN FRA TUREN...
     C     SFANKK        IFEQ      *ZEROS                                    HELMANKO
     C                   CALL      'SYGE21B'
     C                   PARM                    HEPRO
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    XXFLAGG           1
     C                   END
     C     NxtStsOD      TAG
     C     STSTURKEY     READE     STSFBR                                 33
     C                   END
     C     UtMankoD      ENDSR
     C******************************************
     C     MANKO         BEGSR
     C******************************************
     C     STSTURKEY     CHAIN     STSTUR                             33
     C     *in33         cabeq     '1'           UtManko
     C     STSTAT        cabeq     'X'           UtManko
     C                   move      ' '           MANKHIND          1
      *** OBS!!! her hentes tall fra stsfbr/stscli
      **  MEN disse kan være feil pga manuelle godkjenninger....
     C     STSTURKEY     Setll     STSFBR
     C     STSTURKEY     READE     STSFBR                                 33
     C     *in33         DoWeq     *OFF
     C     SFSTAT        cabeq     'X'           NxtStsO
     C     SFSTAT        cabeq     'Y'           NxtStsO
     C     STSOPDKEY     CHAIN     STSOPD                             33
     C  N33SOSTAT        cabeq     'X'           NxtStsO                     OK SKUTT
     C  N33SOSTAT        cabeq     'Y'           NxtStsO                     OK MANU
     C                   MOVE      SFAVD         HEAVD
     C                   MOVE      SFOPD         HEOPD
     C     HEAKE2        CHAIN(N)  HEADF                              33
     C     *in33         cabeq     '1'           NxtStsO
     C                   move      *zeros        XXANKM            4 0
     C                   EVAL      XXANKM = SFANKI - SFANKK
     C                   MOVE      *OFF          *IN51
     C     SFANKK        COMP      *ZEROS                                 52*HELMANKO
     C     SFANKI        IFEQ      *ZEROS
     C                   Z-ADD     HENT          SFANKI
     C                   MOVE      *ON           *IN51                      *IKKE MERKET
     C                   END
      * hel-manko skal KUN printes på NATTPORTLISTER
     C     TUTST3        IFEQ      ' '
     C     *IN52         andeq     *on
     C                   goto      NxtStsO
     C                   end
     c     MANKHIND      Ifeq      ' '
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     MANKHEA
     C                   move      'X'           MANKHIND
     C                   end
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     MANKDET
     C     NxtStsO       TAG
     C     STSTURKEY     READE     STSFBR                                 33
     C                   END
     C     UtManko       ENDSR
     C******************************************
     C     OPPOS         BEGSR
     C******************************************
     C*
     C* OPPDATERER POSISJONER
     C*
     C* (MEN IKKE VED 75- ON= FRA TRANSPMODUL - IMPORT/INNLAND)
     C*
     C                   Z-ADD     1             ON
     C     STOPP         TAG
     C     HN(ON)        IFNE      *ZEROS
     C                   MOVEL     HN(ON)        HEAVD
     C                   MOVE      HN(ON)        HEOPD
     C     HEAKE2        CHAIN     HEADF                              33
     C  N33              MOVE      *BLANKS       HEPOS1
     C  N33              MOVEL     ON            HEPOS1
     C  N33              EXCEPT    OPDHEA
     C                   ADD       1             ON                3 0
     C                   GOTO      STOPP
     C                   END
     C                   ENDSR
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C*
     C* TAR VARE PÅ SISTE OPPDRAG FOR CHAIN I CMR-RUTINE
     C*
     C                   MOVE      HEAVD         CMRAVD            4 0
     C                   MOVE      HEOPD         CMROPD            7 0
      *
      * HENTER STRINGKODE
      *
N09  C                   IF        KOHLS2 = 'L'
N09  C                   Z-ADD     23            WTSKRN                         Godsliste (Liggende)
N09  C                   ELSE
     C                   Z-ADD     22            WTSKRN            3 0          Godsliste (Stående)
N09  C                   END
     C   46              Z-ADD     20            WTSKRN            3 0          Lasteliste (Stående)
     C                   MOVE      UUAVD         CMRAV2            4 0
     C                   CALL      'SYGE01'
     C                   PARM                    CMRAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C*IKKE FAX VED STINGKODE
     C     FRAFAX        IFEQ      'J'
     C                   MOVE      *BLANKS       WOPFM
     C                   END
     C     WOPFM         IFNE      *BLANKS
      * Utskrift med stringformularer.
     C     WOPFM         CHAIN     KODTFM                             60
     C* SKRIV TURNR SOM STREK-KODE?
     C     KFMPOS        IFNE      *ZEROS
     C                   MOVE      KFMPOS        NN                2 0
      * Hvis tegn forran strekkode er * så skal  * også bak.... (LEADING PÅ 3 OF 9 )
     c                   move      ' '           Etter
     c     NN            sub       1             NX
     c     str(NX)       Ifeq      '*'
     c                   move      '*'           Etter             1
     c                   end
      * strekkode-pos + 9 blank=skillearks-kode (ZG hardkodet), ellers kun turnr
     C     NN            add       9             Nx                2 0
     c     STR(NX)       ifeq      ' '
     C                   move      'J'           ZG                1
     c                   movea     'ZG'          STR(NN)
     C                   add       2             NN
     C                   else
     C                   move      'N'           ZG                1
     C     NN            add       7             Nx
     C                   end
     C                   MOVEA     AUPRO         STR(NN)
     C     Etter         ifeq      '*'
     c                   add       1             NX
     C                   MOVEA     '*'           STR(Nx)
     C                   end
      * side 2 ... når det er barkode-string - blank
     C     SIDENO        Ifgt      0
     c     1             do        NX            NN
     c                   movea     ' '           STR(NN)
     C                   end
     C                   end
     C                   END
      * Utskrift uten stringformularer.
     C                   ELSE
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   MOVE      *BLANKS       KFMT3
     C                   END
     C* TESTER OM KAN UTFØRES/UNNTAKSORDNING SKAL SKRIVES
     C*
     C     HETLKU        COMP      'X'                                    98
     C     HETLKU        COMP      'U'                                    97
      * HEADER VED FØRSTE POSISJON..
S12  C*    NR            CASEQ     *ZEROS        NEWPAGE
s12  C*                  ENDCS
N12  C     NR            IFEQ      *ZEROS
N12  C                   exsr      NEWPAGE
N12  C                   exsr      TurFreet                                     TURFRITEKST KUN S.1
N12  C                   ENDIF
     C                   ADD       1             NR                5 0
     C                   ADD       1             POSNR
     C     HEKDL         COMP      *BLANKS                            7777
      * INNLAND - EKSTRA LINJE DERSOM MERKE2 OG/ELLER VS2 ER UTFYLT
     C                   MOVE      *OFF          *IN74
     C     *IN48         IFEQ      *ON
     C     HEVS1         COMP      'KLL'                                  80
     C     HEGM2         COMP      *BLANKS                            7676
     C     HEVS2         COMP      *BLANKS                            7878
     C   76              MOVE      *ON           *IN74
     C   78              MOVE      *ON           *IN74
     C                   END
     C     FIRAVR        IFNE      'J'
     C                   EXSR      OMREGN
     C                   ELSE
     C                   Z-ADD     HEFBV         BVEKT
     C                   END
     C     HEAKE2        CHAIN     HESTED                             33
     C  N33              MOVEL     HSFROM        HESDF
     C  N33              MOVEL     HSTO          HESDT
      *
      *
      * MARKER OM POSISJONEN HAR STREKKODEMERKING
     C                   MOVE      *BLANKS       BARCOD            8
     C                   MOVE      *BLANKS       BARCO2            4
s05  C**   KFMPOS        IFNE      *ZEROS
     C     DOKFMK        SETLL     DOKUFM
     C     DOKFMK        READE     DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
     C     FMST          IFEQ      'I'
     C     FMST          oreq      'E'
     C                   MOVE      'BARCODE!'    BARCOD            8
     C                   MOVE      'BCO!'        BARCO2
     C                   GOTO      UTBAR
     C                   END
     C     DOKFMK        READE     DOKUFM                                 33
     C                   END
     C     UTBAR         TAG
s05  C**                 END
      * Ved lasteliste innland - Hent avs.adresse fra bestillende oppdr
     C     *in46         IFEQ      *ON
     C     TROPD0        andne     *zeros
     C                   call      'SYFA55DUA'
     C                   PARM                    TRAVD0
     C                   PARM                    TROPD0
     C                   PARM                    HENAS
     C                   PARM                    HEADS1
     C                   PARM                    HEADS2
     C                   PARM                    HEADS3
     C                   end
      * SKRIV POSISJONEN...
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
N17  C* fikser referanse avs/mot
N17  C                   MOVE      HERFA         XXRFA
N17  C     HEUR          IFEQ      'H'
N17  C     TRKDFF        ANDEQ     'K'
N17  C     HERFK         ANDNE     *blanks
N17  C                   MOVEL     HERFK         XXRFA
N17  C                   end
N17  C     XXRFA         comp      *blanks                            9494
     C                   WRITE     DET1
      * OPPDATER T&T (MEN IKKE VED LASTELISTE)
     C     FIURBL        IFEQ      'J'
     C     *IN46         ANDEQ     *OFF
N18  c     FRAFAX        ANDNE     'J'
     C                   EXSR      TTSR
     C                   END
      *
     C     *IN46         IFEQ      *ON
     C     HEAKE2        CHAIN     HEADF                              33
     C  N33              MOVE      'X'           HXLLST
     C  N33              UPDATE    HEADFR2
     C                   END
      * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE LIK L)
     C     HEAKE2        SETLL     FRISOK
     C     HEAKE2        READE     FRISOK                                 91
     C     *IN91         DOWEQ     '0'
     C                   SORTA     DFS
     C     DFS(10)       IFNE      ' '
     C     'G'           LOOKUP    DFS                                    91
     C     *IN91         IFEQ      '1'
     C     FSKODE        CHAIN     KODFRI                             91
     C     *IN91         IFEQ      '0'
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     DETFS
     C                   END
     C                   END
     C                   END
     C*
     C     HEAKE2        READE     FRISOK                                 91
     C                   END
      *
      * OG UTLEV.FORBEHOLD
     C     HEKFT1        IFEQ      *BLANKS
     C     HEFT1A        ANDNE     *BLANKS
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     DETUFB
     C                   END
      *
     C* SKRIVER FRIE LINJER
     C     FREETK        SETLL     FREETXT2
     C     FRIST         TAG
     C     FREETK        READE     FREETXT2                               91
     C  N91*IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C  N91              WRITE     DET2
     C  N91              GOTO      FRIST
      *
      * SKRIVER BELØPSLINJER
     C     BELJN         IFEQ      'J'
      *
     C     FAK2KE        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    WASK
     C     KEYKGE        KLIST
     C                   KFLD                    WUNI
     C                   KFLD                    FAVK
      *
     C     FAK2KE        SETLL     FAK2
     C     FAK2KE        READE     FAK2                                   62
     C     *IN62         IFEQ      *OFF
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     DET5
     C                   ENDIF
      *
      *
     C     *IN62         DOWEQ     *OFF
     C                   MOVE      *BLANKS       WAVT
      *
     C     FAVT          IFEQ      *BLANKS
     C                   SELECT
     C     *IN70         WHENEQ    *ON                                          Engelsk tekst
     C                   MOVEL     'GE'          WUNI
     C     KEYKGE        CHAIN     KODTGE                             64
     C     *IN64         IFEQ      *OFF
     C                   MOVEL     KGEENT        WAVT
     C                   ENDIF                                                  <- *IN64
     C     *IN79         WHENEQ    *ON                                          Tysk tekst
     C                   MOVEL     'G2'          WUNI
     C     KEYKGE        CHAIN     KODTG2                             64
     C     *IN64         IFEQ      *OFF
     C                   MOVEL     KG2TYT        WAVT
     C                   ENDIF                                                  <- *IN64
     C                   OTHER
     C                   MOVEL     'GE'          WUNI
     C     KEYKGE        CHAIN     KODTGE                             64
     C     *IN64         IFEQ      *OFF
     C                   MOVEL     KGENOT        WAVT
     C                   ENDIF                                                  <- *IN64
     C                   ENDSL
     C                   ELSE
     C                   MOVEL     FAVT          WAVT
     C                   ENDIF                                                  <- FAVT
     C     HEVALK        IFEQ      FICURR
     C                   MOVEL     HEVALK        WVALK
     C                   Z-ADD     FABELN        WFABEL
     C                   ELSE
     C                   MOVEL     FAVAL         WVALK
     C                   Z-ADD     FABELV        WFABEL
     C                   ENDIF                                                  <- FAVT
      *
     C     WFABEL        IFNE      *ZEROS
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     DET4
     C                   ENDIF                                                  <- WFABEL
     C     FAK2KE        READE     FAK2                                   62
     C                   ENDDO
      *
     C                   ENDIF                                                  <- BELJN
      *
      *
      * HENT EVT. FORFRAKT VIA REKVISISJON.
      *
     C     TRIKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXSLAG            2
      *
     C                   MOVE      *ZEROS        AGEDET            9 2
      *
     C     BELJN         IFEQ      'A'
      *
     C                   MOVE      'FF'          XXSLAG
     C     TRIKEY        CHAIN     HETRIU                             31
     C     *IN31         IFEQ      '0'
     C     TIBURF        ANDNE     *ZEROS
     C     TIBURF        CHAIN     KOSBU                              31
     C     *IN31         IFEQ      '0'
     C                   ADD       BUBL          AGEDET
     C                   END
     C                   END
      * HENT EVT. VIDEREFR VIA REKVISISJON.
     C                   MOVE      'VF'          XXSLAG
     C     TRIKEY        CHAIN     HETRIU                             31
     C     *IN31         IFEQ      '0'
     C     TIBURF        ANDNE     *ZEROS
     C     TIBURF        CHAIN     KOSBU                              31
     C     *IN31         IFEQ      '0'
     C                   ADD       BUBL          AGEDET
     C                   END
     C                   END
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     DET6
     C                   END
      *
      * Barcode pr fraktbrev ??
N08  c     LOSBA         Ifeq      'J'                                          alle fbr (el av-opd)
N08  c     LOSBA         oreq      'O'                                          O=kun Avd-Oppdrnr.
N08  C     WOPLAS        ifeq      'P'
N08  C     WOPLAS        oreq      'F'
N08  c                   exsr      BarCode
N08  c                   end
N08  c                   end
      *
     C                   WRITE     DET3
      *
      * DISTRIBUSJONSADRESSER
     C     DADRJN        IFEQ      'J'
     C                   MOVE      *ON           *IN72
     C                   MOVE      'U'           WRI               1              STATUS
     C                   EXSR      PRTDIS
     C     *IN72         IFEQ      *ON
     C                   MOVE      'V'           WRI               1              STATUS
     C                   EXSR      PRTDIS
     C                   END
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     SUMADR
     C                   ENDIF                                                  <DADRJN
      *
     C                   ADD       1             ANTOPD
     C                   ADD       HEVKT         TVEKT             9 0
     C                   ADD       HEM3          TM3               7 3
     C                   ADD       HENT          TANTAL            7 0
     C                   ADD       BVEKT         TBVEKT            9 0
      *
     C     *IN46         IFEQ      '1'
     C     *IN49         OREQ      '1'
     c                   ADD       HxPALL        TPALL             5 0
     c                   ADD       HxPALL        TPALLT            5 0
     C                   END
     C                   ENDSR
N12  C******************************************
N12  C     TurFreet      BEGSR
N12  C******************************************
N12  c                   Move      *zeros        aTurFt            2 0
N12  C     FREETTK       SETLL     FREETUR2
N12  C     FREETTK       READE     FREETUR2                               91
N12  C     *IN91         doweq     '0'
N12  c                   add       1             aTurFt
N12  c     aTurFt        ifeq      1
N12  C                   WRITE     HEAD2SS                                      Turinfo Start/slutt
N12  C                   endif
N12  C                   WRITE     HEAD2
N12  C     FREETTK       READE     FREETUR2                               91
N12  C                   enddo
N12  c     aTurFt        ifge      1
N12  C                   WRITE     HEAD2SS                                      Turinfo Start/slutt
N12  C                   endif
N12  C                   ENDSR
N08  C******************************************
N08  C     Barcode       BEGSR
N08  C******************************************
N08   * Barcode pr fr.brev - enten far tr.modul innland(kun ett) eller dokuf/frisok
N08  C                   movea     '000'         *in(91)
N08  c     LOSBA         Ifeq      'J'
N08  c     HXSNDN        ifeq      *blanks
N08  c     DokKey        chain     DOKUF                              91
n14  c  n91df1004        ifne      *blanks
s14  c* n91              eval      HXSNDN = '401' + DF1004
s14  c* n91              move      *on           *in92
n14  c                   eval      HXSNDN = '401' + DF1004
n14  c                   move      *on           *in92
N22   * tester om sendingsnummer er numerisk
N22  C                   TESTN                   HXSNDN               91
N22  C                   IF        *IN91=*OFF
n22  c                   move      *off          *in92
N22  C                   move      *blanks       HXSNDN
N22  C                   ENDIF
n14  c                   end
     c     HXSNDN        ifeq      *blanks
     c     IFBKey        chain     FRISOK                             91
n14  c  n91fssok         ifne      *blanks
s14  c* n91              eval      HXSNDN = '401' + FSSOK
s14  c* n91              move      *on           *in93
n14  c                   eval      HXSNDN = '401' + FSSOK
n14  c                   move      *on           *in93
N22   * tester om sendingsnummer er numerisk
N22  C                   TESTN                   HXSNDN               91
N22  C                   IF        *IN91=*OFF
n22  c                   move      *off          *in93
N22  C                   move      *blanks       HXSNDN
N22  C                   ENDIF
n14  c                   end
N08  c                   end
N08  c                   end
N08  c                   else
N08  c                   eval      HXSNDN = *blanks
N08  c                   end
N08   *
N08  c     NextBar       tag
N08  C     HXsndn        ifne      *blanks
N08  c     BarLR         ifeq      'L'
N08  c                   write     BarLeft
N08  c                   else
N08  c                   write     BarRight
N08  c                   end
N14  c                   else
N14  c                   move      HEAVD         HEAVDA
N14  c                   move      *zeros        HEOPDA
N14  c                   move      HEOPD         HEOPDA
N14  c     BarLR         ifeq      'L'
N14  c                   write     BarLeftO
N14  c                   else
N14  c                   write     BarRightO
N14  c                   end
N08  c                   end
N08  c*
N08  c     BarLR         ifeq      'L'
N08  c                   move      'R'           BarLR
N08  c                   else
N08  c                   move      'L'           BarLR
N08  c                   end
N08   * spredning?
N08  c     *in91         ifeq      *off
N08  c     *in92         ifeq      *on
N08  c     DokKey        reade     DOKUF                                  91
N08  c  n91              eval      HXSNDN = '401' + DF1004
N08  c  n91              write     BarSpace
N08  c  n91              goto      NextBar
N08  c                   end
N08  c     *in93         ifeq      *on
N08  c     IFBKey        reade     FRISOK                                 91
N08  c  n91              eval      HXSNDN = '401' + FSSOK
N08  c  n91              write     BarSpace
N08  c  n91              goto      NextBar
N08  c                   end
N08  c                   end
N08   *
N08  C*
N08  C                   ENDSR
N08  C*
     C******************************************
     C     PRTDIS        BEGSR
     C******************************************
     C*
e08  C     DOKKEY99      SETLL     DOKUF99
     C     DISTRT        TAG
e08  C     DOKKEY99      READE     DOKUF99                                71
     C     *IN71         IFEQ      *OFF
      * Låner indik. 71 for skriv/ikke TRANSP INSTRUKS
     C     DFLEVI        COMP      *BLANKS                            7171
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     DETADR
     C                   MOVE      *OFF          *IN72
     C                   GOTO      DISTRT
     C                   ENDIF                                                  <*IN71
     C                   ENDSR
     C*
     C******************************************
     C     OMREGN        BEGSR
     C******************************************
     C* FORHØYER VEKTBEREGNING - UNDER 1000 KG TIL NÆRMESTE  10 KG
     C* ELLERS TIL NÆRM. 100 KG
     C*
     C     HEFBV         IFLT      1000                                         *VEKT UNDER 1000 KG
     C     HEFBV         ADD       9             BVEKT             9 0           -rund opp til nærm-
     C                   MOVE      '0'           BVEKT                            este 10.
     C                   ELSE                                                   *VEKT LIK/OVER 1000.
     C     HEFBV         ADD       99            BVEKT                            10 eller mer: rund
     C                   MOVE      '00'          BVEKT                            til nærmeste 100kg
     C                   END                                                     ..?) ER LIK 1
     C*                                                    *SÅ SANT PRIS IKKE
     C*
     C                   ENDSR
     C*
     C******************************************
     C     UTCMR         BEGSR
     C******************************************
     C     VADRK         CHAIN     VADR                               33
     C   33              DO
     C                   MOVE      KNAVN         MNAVN            30
     C                   MOVE      ADR1          MADR1            30
     C                   MOVE      ADR2          MADR2            30
     C                   MOVE      *BLANKS       MADR3            30
     C     POSTNR        IFEQ      0                                              3<-B
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          MADR3
     C                   ELSE                                                     3
     C                   MOVE      ENGAD3        MADR3
     C                   END
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        MADR3
     C                   MOVE      ADR3          MADR3
     C                   END                                                      3<-E
     C                   END
     C  N33              DO                                                       3<-B
     C                   MOVE      VADRNA        MNAVN            30
     C                   MOVE      VADRN1        MADR1
     C                   MOVE      VADRN2        MADR2
     C                   MOVE      VADRN3        MADR3
     C                   END                                                      3<-E
     C*
     C*
     C* FINNER OM AVDELINGENS KUNDENUMMER
     C*
     C*
     C     KOAKEY        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    KOAAVD
     C                   MOVE      'A'           KOAUNI
     C                   MOVE      UUAVD         KOAAVD
     C     KOAKEY        CHAIN     KODTA                              60
     C   60              EXSR      MOVEB
     C   60              GOTO      SLCMR
     C*
     C                   MOVE      KOAKNR        KUNDNR
     C     KUNKEY        CHAIN     CUNDL01                            60
     C   60              EXSR      MOVEB
     C*
     C     SLCMR         TAG
     C*
     C* FINNER FRANKATURTEXT
     C*
     C*
     C     KFRKEY        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    KFRKOD
     C                   MOVE      'FR'          KOVUNI
     C                   MOVE      CFRANK        KFRKOD
     C     KFRKEY        CHAIN     KODTFR                             60
     C     ANTOPD        COMP      1                                      07
     C*
     C     CMRKEY        KLIST
     C                   KFLD                    CMRAVD
     C                   KFLD                    CMROPD
     C*
     C   07CMRKEY        CHAIN(N)  HEADF                              33
     C*
     C     TM3           COMP      *ZEROS                             56
     C                   EXSR      KDTFM1
      * SKRIV UT
     C                   Z-ADD     24            WTSKRN            3 0
     C                   MOVE      UUAVD         CMRAV2            4 0
     C                   CALL      'SYGE01'
     C                   PARM                    CMRAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C     FRAFAX        IFEQ      'J'
N20  C     FRAFAX        oreq      'C'
     C                   MOVE      *BLANKS       WOPFM
     C                   END
     C     WOPFM         IFNE      *BLANKS
      * Utskrift med stringformularer.
     C     WOPFM         SETLL     KODTFM
     C     WOPFM         READE     KODTFM                                 60
     C     *IN60         DOWEQ     *OFF
     C                   WRITE     SKCMR
     C     WOPFM         READE     KODTFM                                 60
     C  N60              ENDDO
      *
     C                   ELSE
      * Utskrift uten stringformularer.
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   MOVE      *BLANKS       KFMT3
     C                   WRITE     SKCMR
     C                   ENDIF
     C                   EXSR      KDTFM1
     C*
     C                   MOVE      *ZEROS        TM3
     C                   ENDSR
     C*
     C******************************************
     C     MOVEB         BEGSR
     C******************************************
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *BLANKS       ADR3
     C                   MOVE      *ZEROS        POSTNR
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      TUDTD         UDT1              2 0
     C                   MOVE      TUDTM         UDT2              2 0
     C                   MOVE      TUDTÅ         UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XUDTD
     C                   MOVE      UDT2          XUDTM
     C                   MOVE      UDT3          XUDTÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      CDATO         XDTFMT            4 0
     C                   MOVEL     CDATO         UDT1
     C                   MOVEL     XDTFMT        UDT2
     C                   MOVE      XDTFMT        UDT3
     C                   EXSR      KDTFMT
     C                   MOVEL     UDT1          CDATO
     C                   MOVEL     UDT2          XDTFMT
     C                   MOVE      UDT3          XDTFMT
     C                   MOVE      XDTFMT        CDATO
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     C*
      *************************************************************
     C     NEWPAGE       BEGSR
      *************************************************************
     C                   EXSR      KDTFM1
     C                   ADD       1             SIDENO
     C     SIDENO        IFGT      1
     C                   MOVE      *ON           *IN73
     C                   ENDIF                                                  <SIDENO
     C                   WRITE     HEAD1
     C                   move      *OFF          *IN90
     C                   EXSR      KDTFM1
     C                   ENDSR
     C******************************************
     C     GENIK         BEGSR
     C***********************************************
     C*
     C* GENERER UTGIFT PÅ IMPOTROPPDRAG
     C*
     C     FRISKK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YKODE             3
     C                   MOVE      'GAV'         YKODE
     C     FRISKK        CHAIN     FRISOK                             63
     C     *IN63         IFEQ      *OFF
     C                   MOVE      FSSOK         DSSOK
     C                   MOVE      DSAVD         YAVD              4 0
     C                   MOVE      DSOPD         YOPD              7 0
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     FAK2K         SETLL     FAK2
     C     LESFAK        TAG
     C     FAK2K         READE     FAK2                                   62
     C     *IN62         IFEQ      *OFF
     C                   MOVE      YAVD          FAAVD
     C                   MOVE      YOPD          FAOPD
     C*
     C*  FINNER LINJENUMMER FOR FAKTURAFIL
     C*
     C                   MOVE      FAAVD         XGAVD             4 0
     C                   MOVE      FAOPD         XGOPD             7 0
     C                   MOVE      *ZEROS        XGLI              5 0
     C                   CALL      'SYGE06'
     C                   PARM                    XGAVD
     C                   PARM                    XGOPD
     C                   PARM                    XGLI
     C                   MOVE      XGLI          FALI
     C     FABELN        MULT      -1            FABELN
     C     FABELV        MULT      -1            FABELV
     C                   MOVE      HEAVD         FAKUNR
     C                   WRITE     FAKTR
     C                   GOTO      LESFAK
     C                   ENDIF                                                  <*IN62 FAK2
     C                   ENDIF                                                  <*IN63 FRISOK
     C                   ENDSR
     C*
     C***********************************************
     C     HODES         BEGSR
     C***********************************************
     C*
     C* FINNER OM AVDELING HAR HEADING
     C*
     C*
     C     KOHKEY        KLIST
     C                   KFLD                    KOHUNI
     C                   KFLD                    KOHAVD
     C                   MOVEL     'H'           KOHUNI
     C                   MOVE      UUAVD         KOHAVD
     C     KOHKEY        CHAIN     KODTH                              33
     C     KOHGOD        COMP      'J'                                    06
     C*
     C* HENTER HODEOPPLYSNINGER  FOR DOKUMENTET
     C*
     C     HOKEY         KLIST
     C                   KFLD                    HONET
     C                   KFLD                    HOAVD
     C                   MOVEL     ' '           HONET
     C                   MOVE      UUAVD         HOAVD
     C   06HOKEY         CHAIN     HODE                               33
     C   06
     CANN33              MOVE      HOHT1         HO(1)
     C   06
     CANN33              MOVE      HOHT2         HO(2)
     C   06
     CANN33              MOVE      HOHT3         HO(3)
     C   06
     CANN33              MOVE      HOHT4         HO(4)
     C   06
     CANN33              MOVE      HOHT5         HO(5)
     C   06
     CANN33              MOVE      HOHT6         HO(6)
     C   06
     CANN33              MOVE      HOHT7         HO(7)
     C   06              MOVE      'T'           HONET
     C   06HOKEY         CHAIN     HODE                               33
     C   06
     CANN33              MOVE      HOHT1         HT(1)
     C   06
     CANN33              MOVE      HOHT2         HT(2)
     C   06
     CANN33              MOVE      HOHT3         HT(3)
     C   06
     CANN33              MOVE      HOHT4         HT(4)
     C   06
     CANN33              MOVE      HOHT5         HT(5)
     C   06
     CANN33              MOVE      HOHT6         HT(6)
     C   06
     CANN33              MOVE      HOHT7         HT(7)
     C   06
     CAN 33              MOVE      HO            HT
     C   06              MOVEL     'E'           HONET
     C   06HOKEY         CHAIN     HODE                               33
     C   06
     CANN33              MOVE      HOHT1         HE(1)
     C   06
     CANN33              MOVE      HOHT2         HE(2)
     C   06
     CANN33              MOVE      HOHT3         HE(3)
     C   06
     CANN33              MOVE      HOHT4         HE(4)
     C   06
     CANN33              MOVE      HOHT5         HE(5)
     C   06
     CANN33              MOVE      HOHT6         HE(6)
     C   06
     CANN33              MOVE      HOHT7         HE(7)
     C   06
     CAN 33              MOVE      HO            HE
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
N23  C                   OPEN      SYFA55CP
N23  C                   OPEN      SYFA55pf
      *
     C     *LIKE         DEFINE    FAVT          WAVT
     C     *LIKE         DEFINE    FASK          WASK
     C                   MOVE      'K'           WASK
     C     *LIKE         DEFINE    KGEUNI        WUNI
     C     *LIKE         DEFINE    FAVAL         WVALK
     C     *LIKE         DEFINE    FABELV        WFABEL
     C*
     C     *ENTRY        PLIST
     C                   PARM                    AUAVD             4
     C                   PARM                    AUPRO             8
     C                   PARM                    UKNRA             8
     C                   PARM                    BELJN             1
     C                   PARM                    FRAFAX            1
     C                   PARM                    DADRJN            1
n21  C                   READ      FIRM                                   33
n21  C                   MOVE      FIFIRM        FIRMA
      * INDIKATOR 65 = FAX/EMAIL/ARKIVERING
     C     FRAFAX        COMP      'J'                                    65
     C                   MOVE      AUAVD         UUAVD             4 0
     C                   MOVE      AUPRO         UUPRO             8 0
     C* 48 ON - DIREKTE-KALL FRA INNLAND LASTELISTE ELLER GODSLISTE.
      *
     C     STAR          IFEQ      '*'
      * KODE V= ØK VERSJ.NR (UTSKR FRA BOKS / ELLER F2 PÅ GITT TUR)
     C                   MOVE      'N'           VERSJO            1
     C     LASGOD        IFEQ      'V'
     C                   MOVE      'J'           VERSJO
     C                   MOVE      'G'           LASGOD
     C                   END
     C     LASGOD        COMP      'L'                                    46
     C     LASGOD        COMP      'G'                                    47
     C     *IN46         IFEQ      *ON
     C                   MOVE      ULKOD         KUNLAG            5
     C                   MOVE      *BLANKS       ULKOD
     C                   END
     C     *IN46         IFEQ      *ON
     C     *IN47         OREQ      *ON
     C                   MOVE      *ON           *IN48
     C                   MOVE      'N'           DADRJN
     C                   END
     C                   END
     C*
     C     UUPROK        KLIST
     C                   KFLD                    UUPRO
     C                   KFLD                    KUNDNR
     C*
     C*
     C     TUKEY         KLIST
     C                   KFLD                    UUAVD
     C                   KFLD                    UUPRO
     C*
     C     KUNKEY        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    KUNDNR
     C     VADRK         KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    KUNADR
     C                   KFLD                    XVADRN
     C                   MOVE      '00001'       XVADRN            5 0
     C*
     C*
     C     TRANKE        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    TUKNT2
     C*
     C*
     C     TRANK2        KLIST
     C                   KFLD                    FIRMA
     C                   KFLD                    TUKNT2
     C*
     C     HEAKEY        KLIST
     C                   KFLD                    UUPRO
     C*
     C     HEAKE2        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C*
     C     arkkey        KLIST
     C                   KFLD                    ARTYPE
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPD
     C                   KFLD                    ARUNDE
     C*
N08  C     BarKey        KLIST
N08  C                   KFLD                    XXPAKN            8 0
N08  C                   KFLD                    XXPAID            5
N08  C                   movel     'LOSBA'       XXPAID
N08  C     IFBKey        KLIST
N08  C                   KFLD                    HEAVD
N08  C                   KFLD                    HEOPD
N08  C                   KFLD                    IFBKODE
N08  C                   move      'IFB'         IFBKODE           3
N08  C     DOKKey        KLIST
N08  C                   KFLD                    DFRI
N08  C                   KFLD                    HEAVD
N08  C                   KFLD                    HEOPD
N08  C                   move      'F'           DFRI
N08  c     BarKey        chain     SYPARL1                            33
N08  C  N33              MOVEL     SYVRDA        LOSBA             1
N08  C                   move      'L'           BarLR             1
     C*
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXSKKO            1
     C                   MOVE      'G'           XXSKKO
N12  C     FREETTK       KLIST
N12  C                   KFLD                    UUAVD
N12  C                   KFLD                    UUPRO
N12  C                   KFLD                    XXSKKO
     C     STSTURKEY     KLIST
     C                   KFLD                    STTYPE
     C                   KFLD                    UUPRO
     C     STSOPDKEY     KLIST
     C                   KFLD                    STTYPE
     C                   KFLD                    UUPRO
     C                   KFLD                    SFAVD
     C                   KFLD                    SFOPD
N19  C     CUNDCK        KLIST
N19  C                   KFLD                    FIRMA
N19  C                   KFLD                    mail30           30
N19  C                   KFLD                    SAMKUN
N19  C                   EVAL      mail30='*GODSLISTE'
N19  C     SAMCMRDKH     KLIST
N19  C                   KFLD                    SAMLOP
N19  C                   KFLD                    HEAVD
N19  C                   KFLD                    HEOPD
N19  C     SAMCMRHK      KLIST
N19  C                   KFLD                    UUPRO
N19  C                   KFLD                    SAMLOP
N19  C     BRUDDA        IFEQ      'F'
N19  C                   MOVE      UKNRA         SAMLOP
N19  C                   MOVE      *BLANKS       UKNRA
N19  C     SAMCMRHK      CHAIN     SAMCMRH                            33
N19  C     CUNDCK        CHAIN     CUNDC03                            33
N19  C                   END
     C* SYINN 200689- NY VARIABEL FOR Å TELLE ANTALL UTSKREVET
     C                   MOVE      *ZEROS        ANTOPD            3 0
     C                   Z-ADD     0             POSISJ            4 0
     C                   Z-ADD     0             PRANT             3 0
     C*
s21  C*                  READ      FIRM                                   33
s21  C*                  MOVE      FIFIRM        FIRMA
     C                   CALL      'DATFM1'
     C                   PARM                    FIDTFM
     C                   PARM                    UDATO1            6 0
     C                   PARM                    UDATO2            6 0
     C                   PARM                    UDATO3            6 0
     C*
     C* FINNER OM AVDELING HAR AVRUNDING
     C*
     C     KOVKEY        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C                   MOVE      'V'           KOVUNI
     C                   MOVE      UUAVD         KOVAVD
     C     KOVKEY        CHAIN     KODTV                              33
     C                   MOVE      KOVAVR        FIRAVR            1
      *
e08  C     DOKKEY99      KLIST
     C                   KFLD                    WRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVE      'U'           WRI               1              STATUS
     C                   Z-ADD     0             SIDENO            3 0
     C     DOKFMK        KLIST
     C                   KFLD                    XRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVE      'F'           XRI               1
     C*
     C                   MOVE      'N'           PALLJN            1
     C                   MOVEL     'SYPALL  '    PRODNA           15
     C     PRODNA        CHAIN     SYPROD                             33
     C  N33PRINST        IFEQ      'J'
     C                   MOVE      'J'           PALLJN
     C                   END
     C                   MOVE      *ZEROS        XETD
     C                   MOVE      *ZEROS        XETA
      *
     C     TUKEY         CHAIN(N)  TURER                              33
      * GODSLISTE INNLAND - ETTER AVSL. MED MANKO - FJERN EVT HELMANO,
      *  SETT FLAGG  FRA 2 -> N = NATTMANKO FERDIG BEHANDL$T
     C     *IN33         IFEQ      '0'
     C     *IN47         ANDEQ     '1'
     C     TUTST3        ANDEQ     '2'
     C                   EXSR      DELHELM
      *  SETT FLAGG  FRA 2 -> N = NATTMANKO FERDIG BEHANDLET
     C     TUKEY         CHAIN     TURER                              33
     C                   MOVE      'N'           TUTST3
     C                   UPDATE    TURERR
     C                   END
     C     TUTST3        COMP      '1'                                    44
      * Fra PDA - ta Userid fra UDS  (låner INS2 fra CMR)
     C     ZUSER         IFEQ      'QTMHHTTP'
     C                   MOVEL     INS2          PDAUSR           10
     C                   END
      *
      * Strekkode ved P=PDF/F=AFP - dette BØR parameterstyres (SYPARF?) - foreløpig hardkodet
      * Iverksett som kundespesial ved å åpne hardkoding..  (AUPRO8, AUPRO10)
     C                   Z-ADD     22            WTSKRN            3 0          Godsliste (Stående)
     C   46              Z-ADD     20            WTSKRN            3 0          Lasteliste (Stående)
     C                   MOVE      UUAVD         CMRAV2            4 0
     C                   CALL      'SYGE01B'
     C                   PARM                    CMRAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C                   PARM                    WOPLAS            1
      *
     C                   MOVE      *BLANKS       AUPRO8            8
     C                   MOVE      *BLANKS       AUPRO10          10
e05  C                   MOVE      AUPRO         AUPRO8
e05  C*                  MOVEL     'ZL'          AUPRO10
e05  C*                  MOVE      AUPRO         AUPRO10
N05  C                   MOVE      AUPRO8        AUPRO82           8            dobbeldef for prtf.
N05  C                   MOVE      AUPRO10       AUPRO102         10            dobbeldef for prtf.
     C     WOPLAS        ifeq      'P'
     C     WOPLAS        oreq      'F'
     c     AUPRO10       comp      *blanks                            4242      Arkiv-strekkode
     c  N42AUPRO8        comp      *blanks                            4343      PDA-strekkode
     c                   end
     C                   ENDSR
     C*
     C***********************************************
     C     BRUSR         BEGSR
     C***********************************************
     C*
     C*
n15  C*  Ved null oppdrag - skriv heading/bunn (tom liste )
N16  C                   IF        (BRUDDA = 'J' AND ANTOPD > 0) OR
N16  C                             BRUDDA <> 'J'
n15  C     ANTOPD        Ifeq      *ZEROS
n15  C                   exsr      NEWPAGE
n15  C                   exsr      TurFreet                                     TURFRITEKST KUN S.1
n15  c                   endif
s15  C*    ANTOPD        IFGT      *ZEROS
     C                   Z-ADD     1             PRANT                                I
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     PTOT1
     C   46*IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C   46              WRITE     PTOTIL                                        BYTTEPALLER
      * NÅR ENNÅ IKKE AVREGNET - TUPLUT BRUKES FOR Å MELLOMLAGRE EKSTRA
      * LEGGES TIL PÅ PALLSUM SISTE SIDE
     C     *IN50         IFEQ      *ON                                           SISTE SIDE
     C                   MOVE      *ZEROS        TPEXTR            2 0
     C                   TESTN                   TUPLUT               33
     C   33              MOVE      TUPLUT        TPEXTR
     C                   ADD       TPEXTR        TPALL
     C                   END
     C     BELJN         IFEQ      'T'
     C     *IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C                   WRITE     PTOTT
     C   47*IN90         CASEQ     '1'           NEWPAGE
     C                   ENDCS
     C   47              WRITE     PTOTI                                         KVIT. INNL.
     C                   END
s15  C*                  END
N16  C                   END
     C*
     C     CMR           IFEQ      'J'
     C                   EXSR      UTCMR
     C                   READP     HEAD14                                 33
     C                   READ      HEAD14                                 33
     C                   END
     C*
     C     CMR           IFEQ      'K'
     C                   EXSR      UTCMR
     C                   READP     HEAD14                                 33
     C                   READ      HEAD14                                 33
     C                   END
     C*
n23  C     UPRT11        IFEQ      'EPOSTDIR'
N23  C     BRUDDA        ANDEQ     'J'
N23  C                   CLOSE     SYFA55CP
N23  C                   CLOSE     SYFA55PF
N23  C                   OPEN      SYFA55CP
N23  C                   OPEN      SYFA55PF
N23  C                   END
     C                   Z-ADD     0             TPALL
     C                   Z-ADD     0             TVEKT
     C                   Z-ADD     0             TBVEKT
     C                   Z-ADD     0             TANTAL
     C*
     C                   Z-ADD     0             NR
     C                   Z-ADD     0             POSNR
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     BRUAG         BEGSR
     C***********************************************
     C*BRUDD PÅ AGENT
     C*
     c                   z-add     kundnr        kunadr            8 0
     C* FINNER NY KUNDE
     C*
     C     KUNKEY        CHAIN     CUNDL01                            60
     C*
     C*DERSOM FRA TRANSPORTMODUL - ALLTID PÅ NORSK
     C*
     C     HEUR          IFEQ      'H'
     C                   MOVE      ' '           SPRAAK
     C                   END
     C  N60              IF        TUSG = 'WEB'
     C                   EVAL      SPRAAK = 'E'
     C                   MOVE      *ON           *IN41
     C                   MOVE      TUETDD        XETDD
     C                   MOVE      TUETDM        XETDM
     C                   MOVE      TUETDÅ        XETDÅ
     C                   MOVE      TUETAD        XETAD
     C                   MOVE      TUETAM        XETAM
     C                   MOVE      TUETAÅ        XETAÅ
     C                   END
     C  N60SPRAAK        COMP      'E'                                    70
     C  N60SPRAAK        COMP      'T'                                    79
     C     SPRAAK        IFEQ      'E'
     C                   MOVE      HE            HP
     C                   ELSE
     C     SPRAAK        IFEQ      'T'
     C                   MOVE      HT            HP
     C                   ELSE
     C                   MOVE      HO            HP
     C                   END
     C                   END
     C*
     C                   ENDSR
      *
      *
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
     C     *IN47         IFEQ      '1'                                            *INNLAND
     C     *IN92         ANDEQ     '1'                                            *VER 1+
     C     VERSJO        ANDEQ     'N'                                            *KOPI
     C                   GOTO      UTTT                                           HOPP UT
     C                   END
      *
n11  c     tts           ifeq      'T'
n11  c                   move      tuavd         ttavd
n11  c                   move      tupro         tttur
n11  c                   move      *zeros        ttopd
n11  c                   else
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
n11  c                   move      *zeros        tttur
n11  c                   end
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      'MAN'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVEL     ZUSER         TTUSER
     C     TUKNT2        IFNE      *ZEROS
     C                   MOVEL     TUKNT2        TUKNT
     C                   End
n11  c     *IN46         ifeq      '0'
     C                   EVAL      TTTEXT = 'Manifest printed, Transp: '
     C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n10  C                   EVAL      TTTEXL = 'Godsliste skrevet Transp: '
n10  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n11  c                   else
n11  C                   EVAL      TTTEXT = 'Loadinglist printed, Transp: '
n11  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n11  C                   EVAL      TTTEXL = 'Lasteliste skrevet Transp: '
n11  C                             + %trim(%editc(TUKNT:'Z')) + ' ' + TUNAT
n11  c                   end
     C     HEKNA         IFNE      *ZEROS
     C                   MOVEL     ' Agent: '    XXTEXT           16
     C                   MOVE      '        '    XXTEXT
     C                   MOVE      HEKNA         XXTEXT
     C                   MOVE      XXTEXT        TTTEXT
n10  C                   MOVE      XXTEXT        TTTEXL
     C                   END
     C                   WRITE     TRACKFR
     C     UTTT          TAG
     C                   ENDSR
     C*************************************************************************
     C     arkivsr       begsr
     C*************************************************************************
      *
      * arkiv
      *
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      'go'          ARTYPE
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      *ZEROS        ARAVD
     C                   MOVE      *ZEROS        AROPD
     C                   MOVEL     TUPRO         ARUNDE9           9
     c                   move      tutst1        arunde9
     c                   movel     arunde9       arunde
     c
      *
N03  C     *in48         ifeq      '1'
     C     ARKKEY        CHAIN     arkivl03                           33
N03  c                   else
N03  c                   seton                                        33
N03  C                   end
     C     *IN33         IFEQ      '1'
     C     FIFIRM        CHAIN     FIRMARC                            33
     C  N33ARTYPE        CHAIN     ARKTXT                             33
     C     *IN33         IFEQ      '0'
     C     ARKJN         ANDEQ     'J'
     C                   MOVE      ZUSER         ARUSER
     C                   MOVE      ULDT          ARDATE
     C                   MOVE      XULTM         ARTIME
     c     tuknt2        ifne      *zeros
     C     TRANKE        CHAIN     TRAN                               32
     c                   else
     C     TRANK2        CHAIN     TRAN                               32
     c                   end
     C                   MOVE      VMTRKU        ARKUND
     C  N32              MOVE      VMTRKU        ARKUND
      * cmr til arkiv
N19  C     cmr           ifeq      'J'
N19  C     SAMLOP        ANDNE     0
N19  C                   move      samkun        arkund
N19  C                   move      samlop        aropd
N19  C                   END
     C                   WRITE     ARKIVR
     C                   END
     C                   END
     C                   ENDSR
      ** INTERN PRINTEROUTPUT GODSLIST +  CMR-BREV FYSISK FJERNET
     OTURERR    E            OPDTUR
     O                       TUST
     O                       TUTST1
     OTURERR    E            OPDTUP
     O                       TUXXX1
     O                       TUXXX2
     OTURERR    E            OPDTUD
     OHEADFR2   E            OPDHEA
     O                       HEPOS1
