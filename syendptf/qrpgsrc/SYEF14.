********************************************************************
      *   PRINT av AWB
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 type 'F'(AFP)  lik behandling som P (PDF)
10XXX * 02 sh  PTF10 skjermbilde
10XXX * 03 sh  PTF10 skjermbilde
10XXX * 04 sh  PTF10 siste track and trace dato
10XXX * 05 sh  PTF10 tosidig utskrift kode D
10XXX * 06 sh  PTF10 TDFLASCH
10XXX * 07 sh  PTF10 coloader indikator 55
10172 * 08 SH  PTF10 norsk text til Track and trace
10172 * 09 SH  PTF10 benytter nå 9 tegn av hawbnr
10172 * 10 SH  PTF10 other charges utvidet fra 6-9 gebyr
10172 * 11 SH  PTF10 OVERSTYRE FLYFRAKTMERKELAPP
      * ------------------------------------------------------------
10172 * 12 SH  PTF11 F=fulltsett ved epost
10172 * 13 SH PTF11 Utkrift av merkelapp
xxxxx * 14 SH PTF11 arkivere labels
xxxxx * 15 SH PTF11 5 ekstra felt i dokeq
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
xxxxx * 16 JOV PTF12 Siste ledd i IATA-kode kom ikke med ved arkivering (= kopi)
********************************************************************
N07  FSYPARL1   IF   E           K DISK
     FFREETXT2  IF   E           K DISK
     Fvadr      IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E             DISK
     FKODTFLP   IF   E           K DISK
     FTRACKL02  IF A E           K DISK
     FHEADF     UF   E           K DISK
     FDOKEQ     IF   E           K DISK
     FDOKEFIM   IF   E           K DISK
     FDOKEF     UF   E           K DISK
     FDOKEF1    IF   E           K DISK
     F                                     RENAME(DOKEFR:DOKEFR2)
     FCUNDL01   IF   E           K DISK
     FFAK2      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FHLOGO     IF   E           K DISK
     FELOGO     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FTELLA     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTG2    IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FKODTDIS   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCNFF      UF   E             DISK    USROPN
     FLABF      IF A E             DISK    USROPN
     FISUL01    IF   E           K DISK    USROPN
     FPARL01    IF   E           K DISK    USROPN
     FDOLAF     UF A E             DISK
     F                                     INFDS(DOLADS)
     FMCAWF     IF   E           K DISK
     FSYEF14FM  CF   E             WORKSTN USROPN
     FSYEF14P   O    E             PRINTER
     FDOKOTH    UF A E           K DISK
     FKODTASID  IF   E           K DISK
     FMERKL1    O    F   50        PRINTER
     F                                     FORMLEN(18)
     F                                     FORMOFL(18)
     FMERKL2    O    F   50        PRINTER
     F                                     FORMLEN(24)
     F                                     FORMOFL(24)
     D KA1             S              4  0 DIM(6)
     D WR1             S              1    DIM(9)
     D WR2             S              1    DIM(17)
     D WR3             S              1    DIM(30)
     D AR1             S              1    DIM(30)
     D AR2             S              1    DIM(30)
     D RE              S              1    DIM(88)
     D RE1             S              1    DIM(44)
     D RE2             S              1    DIM(44)
     D                 DS
     D  TEAC11                 1      1
     D  TEAC21                 2      2
     D  TEAC34                 3      6
     D  TEAC74                 7     10
     D  TEAACC                 1     10
     D                 DS
     D  KFAC11                 1      1
     D  KFAC21                 2      2
     D  KFAC34                 3      6
     D  KFAC74                 7     10
     D  KFSAC                  1     10
     D                 DS
     D  KFS012                 1      2
     D  KFS031                 3      3
     D  KFS041                 4      4
     D  KFS051                 5      5
     D  KFS064                 6      9
     D  KFS101                10     10
     D  KFS114                11     14
     D  XKFSAC                 1     14
     D                 DS
     D  XMOMS                  1      9  2
     D  YMOMS                  1      9  2
      *
      * DOBBELTDEFINERINGER GRUNNET EKSTERN PRINTERFIL
      *
     D                 DS
     D  AREF06                 1      6
     D  HESAML                 1      6
     D                 DS
     D  DFROA1                 1      3
     D  ZFROA1                 1      3
     D  DFROA2                 4      6
     D  ZFROA2                 4      6
     D  DFROA3                 7      9
     D  ZFROA3                 7      9
     D  DFBLT                 40     48  2
     D  ZFBLT                 40     48  2
     D  DFBLA                 49     57  2
     D  ZFBLA                 49     57  2
     D  XCACOL                58     66  2
     D  YCACOL                58     66  2
     D  XCAPRE                67     75  2
     D  YCAPRE                67     75  2
     D                 DS
     D  FN                     1     90  2 DIM(9)
     D  FN01                   1     10  2
     D  FN02                  11     20  2
     D  FN03                  21     30  2
     D  FN04                  31     40  2
     D  FN05                  41     50  2
     D  FN06                  51     60  2
     D  FN07                  61     70  2
     D  FN08                  71     80  2
     D  FN09                  81     90  2
     D                 DS
     D  FK                     1     63    DIM(9)
     D  FK01                   1      7
     D  FK02                   8     14
     D  FK03                  15     21
     D  FK04                  22     28
     D  FK05                  29     35
     D  FK06                  36     42
     D  FK07                  43     49
     D  FK08                  50     56
     D  FK09                  57     63
     D                 DS
     D  WSOP1                  1      7  0
     D  WSOP2                  8     14  0
     D  WSOP3                 15     21  0
     D  WSOP4                 22     28  0
     D  WSOP5                 29     35  0
     D  WSOP6                 36     42  0
     D  WSOP7                 43     49  0
     D  WSOP8                 50     56  0
     D  WSOP9                 57     63  0
     D  WSOP10                64     70  0
     D  WSOP11                71     77  0
     D  WSOP12                78     84  0
     D  WSOP13                85     91  0
     D  WSOP14                92     98  0
     D  WSOP15                99    105  0
     D  WSOP16               106    112  0
     D  WSOP17               113    119  0
     D  WSOP18               120    126  0
     D  WSOP19               127    133  0
     D  WSOP20               134    140  0
     D  NØ                     1    140  0 DIM(20)
     D                 DS
     D  WSLO1                  1      3  0
     D  WSLO2                  4      6  0
     D  WSLO3                  7      9  0
     D  WSLO4                 10     12  0
     D  WSLO5                 13     15  0
     D  WSLO6                 16     18  0
     D  WSLO7                 19     21  0
     D  WSLO8                 22     24  0
     D  WSLO9                 25     27  0
     D  WSLO10                28     30  0
     D  WSLO11                31     33  0
     D  WSLO12                34     36  0
     D  WSLO13                37     39  0
     D  WSLO14                40     42  0
     D  WSLO15                43     45  0
     D  WSLO16                46     48  0
     D  WSLO17                49     51  0
     D  WSLO18                52     54  0
     D  WSLO19                55     57  0
     D  WSLO20                58     60  0
     D  NL                     1     60  0 DIM(20)
     D                 DS
     D  XARKB                  5      6  0
     D  XARKH                  8      9  0
     D  XARK                   1     10
     D                 DS
     D  XAWB41                 1      4  0
     D  XAWB42                 6      9  0
     D  XAWB9                  1      9
     D                 DS
     D  XPAR1H                 1      2  0
     D  XPAR1D                 4      5  0
     D  XPAR2H                 7      8  0
     D  XPAR2D                10     11  0
     D  XPAR                   1     11
     D                 DS
     D  XFLY1                  1      3
     D  FL                     1      3    DIM(3)
     D                 DS
     D  KA                     1     24    DIM(6)
     D  DFNT1                  1      4
     D  DFNT2                  5      8
     D  DFNT3                  9     12
     D  DFNT4                 13     16
     D  DFNT5                 17     20
     D  DFNT6                 21     24
     D                 DS
     D  VE                     1     42  1 DIM(6)
     D  DFVKT1                 1      7  1
     D  DFVKT2                 8     14  1
     D  DFVKT3                15     21  1
     D  DFVKT4                22     28  1
     D  DFVKT5                29     35  1
     D  DFVKT6                36     42  1
     D                 DS
     D  RA                     1      6    DIM(6)
     D  DFRC1                  1      1
     D  DFRC2                  2      2
     D  DFRC3                  3      3
     D  DFRC4                  4      4
     D  DFRC5                  5      5
     D  DFRC6                  6      6
     D                 DS
     D  IT                     1     24    DIM(6)
     D  DFCOM1                 1      4
     D  DFCOM2                 5      8
     D  DFCOM3                 9     12
     D  DFCOM4                13     16
     D  DFCOM5                17     20
     D  DFCOM6                21     24
     D                 DS
     D  FV                     1     42  1 DIM(6)
     D  DFFBV1                 1      7  1
     D  DFFBV2                 8     14  1
     D  DFFBV3                15     21  1
     D  DFFBV4                22     28  1
     D  DFFBV5                29     35  1
     D  DFFBV6                36     42  1
     D                 DS
     D  MI                     1      6    DIM(6)
     D  DFRK1                  1      1
     D  DFRK2                  2      2
     D  DFRK3                  3      3
     D  DFRK4                  4      4
     D  DFRK5                  5      5
     D  DFRK6                  6      6
     D                 DS
     D  PR                     1     48  2 DIM(6)
     D  DFRPR1                 1      8  2
     D  DFRPR2                 9     16  2
     D  DFRPR3                17     24  2
     D  DFRPR4                25     32  2
     D  DFRPR5                33     40  2
     D  DFRPR6                41     48  2
     D                 DS
     D  BE                     1     60  2 DIM(6)
     D  DFBLT1                 1     10  2
     D  DFBLT2                11     20  2
     D  DFBLT3                21     30  2
     D  DFBLT4                31     40  2
     D  DFBLT5                41     50  2
     D  DFBLT6                51     60  2
     D                 DS
     D  VA                     1    250    DIM(10)
     D  DFVS1                  1     25
     D  DFVS2                 26     50
     D  DFVS3                 51     75
     D  DFVS4                 76    100
     D  DFVS5                101    125
     D  DFVS6                126    150
     D  DFVS7                151    175
     D  DFVS8                176    200
     D  DFVS9                201    225
     D  DFVS10               226    250
     D                 DS
s15  D* T25                    1    250    DIM(10)
n15  D  T25                    1    300    DIM(12)
     D  DFqS7                  1     25
     D  DFqS8                 26     50
     D  DFqS9                 51     75
     D  DFqS10                76    100
     D  DQVS11               101    125
     D  DQVS12               126    150
     D  DQVS13               151    175
n15  D  DQVS14               176    200
n15  D  DQVS15               201    225
n15  D  DQVS16               226    250
n15  D  DQVS17               251    275
n15  D  DQVS18               276    300
     D                 DS
     D  KOAIAT                 1      7  0
     D  XIAT1                  1      2  0
     D  XIAT2                  3      3  0
     D  XIAT3                  4      7  0
     D                 DS
     D  DFROB1                 1      7
     D  XROB12                 1      2
     D                 DS
     D  DFROB2                 1      7
     D  XROB22                 1      2
     D                 DS
     D  DFROB3                 1      7
     D  XROB32                 1      2
     D                 DS
     D  HEGN                   1     15
     D  HEGN11                 5     15
     D  XGN1                   5      5
     D  XGN2                   6      6
     D  XGN3                   7      7
     D  XGN4                   8      8
     D  XGN5                   9      9
     D  XGN6                  10     10
     D  XGN7                  11     11
     D  XGN8                  12     12
     D  XGN9                  13     13
     D  XGN10                 14     14
     D  XGN11                 15     15
     D  XGN                    8     15
     D  WHEGN3                 5      7
     D  WHEGN8                 8     15
     D                 DS
     D  HEHAWB                 1      9
     D  XHAWB                  4      9  0
     D  XHAWB1                 4      4  0
     D  XHAWB2                 5      5  0
     D  XHAWB3                 6      6  0
     D  XHAWB4                 7      7  0
     D  XHAWB5                 8      8  0
     D  XHAWB6                 9      9  0
     D                 DS
     D  HESDF                  1      5
     D  XSDF1                  1      1
     D  XSDF2                  2      2
     D  XSDF3                  3      3
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
     D                 DS
     D  WRK2T3                 1    142
     D  WRK2A                  1     65
     D  WRK2B                 66    130
     D  WRK2C                131    142
     D                 DS
     D  FIN                    1    245    DIM(7)
     D  DFINF1                 1     35
     D  DFINF2                36     70
     D  DQINF3                71    105
     D  DQINF4               106    140
     D  DQINF5               141    175
     D  DQINF6               176    210
     D  DQINF7               211    245
     D                 DS
     D  DATT1                  1      2
     D  DATT2                  3      4
     D  DATT3                  5      6
     D  DATT                   1      6
     D                 DS            14
     D PRICAR          C                   CONST('PRIORITY CARGO')
     D EUROPE          C                   CONST('EuropeXpress')
N06  D TDFLAS          C                   CONST('TD flash      ')
     D                 DS
     D  AWBDES                 1     14
     D  WHESDT                 4      6
     D                 DS
     D  ROUTIN                 1     16
     D  WWA                    1      3
     D  WWB                    5     11
     D  WWC                   12     12
     D  WWD                   13     14
     D                 DS
     D  WARECA                 1      9  0
     D                 DS
     D  ELT1                   1     22
     D  ZLT1                   1     22
     D  ELT117                 1     17
     D                 DS
     D  KOWXXX                 1     41
     D  KOWFET                 1      1
     D                 DS
     D  XAWBI1                 1     17
     D  ZAWBI1                 1     17
     D                 DS
     D  XAWBI2                 1     15
     D  ZAWBI2                 1     15
     D                 DS
     D  XAWBI3                 1     12
     D  ZAWBI3                 1     12
     D                 DS
     D  dato06                 1      6  0
     D  ttaar                  1      2  0
     D  ttmnd                  3      4  0
     D  ttdag                  5      6  0
     D                 DS
     D  wsdato                 1      6  0
     D  wsdd                   1      2  0
     D  wsmm                   3      4  0
     D  wsaa                   5      6  0
     D                 DS            24
     D FTXT            C                   CONST('AS AGENT FOR THE -
     D                                     CARRIER')
     D                 DS            12
     D FTXT2           C                   CONST('AS AGENT FOR')
     D                 DS            11
     D FTXT3           C                   CONST('AS CARRIER,')
     D                 DS            11
     D NUM             C                   CONST(' 0123456789')
      *
      * Get recordnumber from file
     D DOLADS          DS
     D  DORECN               397    400B 0
     D                UDS
     D  UFIRM                  1      2
     D  USG                   19     21
     D  UDT                   30     35  0
     D  UGN                   36     46
     D  UHOD                  47     47
     D  UBBS                  48     48
N11  D  UPRT68               981    990
N11  D  UPT68                991   1000
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                SDS
     D  WUSER                254    263
     IDOLAR
     I              LAISTX                      DOISTX
      *
     C                   EXSR      INIT
      *
     C                   SETOFF                                       27
      ******************************************
      *** UIN08 = 1  -->  KOPIER FLYFRAKTBREV
      ******************************************
     C     UIN08         IFEQ      '1'
     C                   OPEN      SYEF14FM
     C                   MOVEL     UAVD          DFAVD
     C                   EXFMT     BILDE01
     C   03              GOTO      SLUTT
     C                   Z-ADD     0             WN
      *
     C     START         TAG
      *
     C     WN            IFEQ      20
     C                   GOTO      SLUTT
     C                   ELSE
     C                   ADD       1             WN
     C     NØ(WN)        IFEQ      0
     C                   GOTO      START
     C                   END
     C                   MOVE      NØ(WN)        DFOPD
     C     NL(WN)        IFEQ      0
     C                   Z-ADD     1             NL(WN)
     C                   END
     C                   MOVE      NL(WN)        DFLOP
     C                   MOVE      NØ(WN)        WSOPD
     C                   MOVE      NL(WN)        WSLOP
     C                   END
     C                   EXSR      KOPI
     C                   GOTO      START
     C                   END
      *********************************************************
      *** UIN08 = 0  -->  SKRIV UT ORGINALE FLYFRAKTBREV
      *********************************************************
     C     UIN08         IFEQ      '0'
     C     DOKF1K        SETLL     DOKEF1
     C     STARTO        TAG
     C     DOKF1K        READE     DOKEF1                                 44
     C  N44              DO
     C     HEADFK        CHAIN(N)  HEADF                              33
     C     IMPKEY        CHAIN     DOKEFIM                            33
     C   33              move      ' '           domoms
     C     HEGN11        IFEQ      *ZEROS
     C     HEGN11        OREQ      *BLANKS
     C                   GOTO      STARTO
     C                   END
     C     DFRI          COMP      'F'                                    45
     C   45DFSG          COMP      USG                                    45
     C   45UOPD          IFNE      0
     C     UOPD          COMP      DFOPD                                  45
     C   45UAVD          COMP      DFAVD                                  45
     C                   END
      *
     C                   SETOFF                                       5051
     C   45              DO
s16  C*    KODTAK        CHAIN     KODTA                              33
s16  C*                  MOVE      *BLANKS       XIAT4             5
s16  C*    KOAIA2        IFNE      *ZEROS
s16  C*                  MOVEL     '/'           XIAT4
s16  C*                  MOVE      KOAIA2        XIAT4
s16  C*                  END
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   EXSR      PRINT
      * PDFUTSKRIFT
     C     CALLTY        IFEQ      'P'
N01  C     CALLTY        oreq      'F'
N05  C     CALLTY        oreq      'D'
     c                   z-add     1             kopinr            2 0
     C                   exsr      ovlsr
     C                   END
     C                   SETON                                        27
      * KOPI2-9 VED PDF UTSKRIFT
      * PDFUTSKRIFT
     C     CALLTY        IFEQ      'P'
N01  C     CALLTY        oreq      'F'
N05  C     CALLTY        oreq      'D'
     c                   z-add     2             kopinr            2 0
     C                   exsr      ovlsr0
     C                   ELSE
     C                   EXSR      PRINT
     C                   END
     C                   SETOFF                                       27
      * OPPDATER MVA I DOKEF
     C   61DOKEFK        CHAIN     DOKEF                              33
     C   61
     CANN33              Z-ADD     XMOMS         DFBLAV
     C   61
     CANN33              UPDATE    DOKEFR
      *
      * UTFØRER RUTINER FOR Å SENDE FRAKTBREV ELEKTRONISK
      *
     C     *IN77         IFEQ      '1'
     C     DFCMN         IFEQ      'J'
     C     DFCMN         OREQ      'Y'
     C     DFCMN         OREQ      'j'
     C     DFCMN         OREQ      'y'
     C                   EXSR      OPNFIL                                       <Åpne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      WRTFWB                                       <Call FWB pgm.
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ENDIF                                                  <DFCMN
     C                   ENDIF                                                  <*IN77
      *
     C     DOKEFK        CHAIN     DOKEF                              33
     C                   MOVE      'P'           DFST
     C   51              MOVE      'P'           DFKDME
     C   61              Z-ADD     XMOMS         DFBLAV
     C                   UPDATE    DOKEFR
     C                   EXSR      SUMOTH
     C     HEADFK        CHAIN     HEADF                              33
     C     HEUR          IFEQ      'D'
     C     HEUR          OREQ      'H'
     C                   MOVE      'P'           HEPK8
     C                   ELSE
     C                   MOVE      'P'           HEPK5
     C                   END
     C                   UPDATE    HEADFR
      * track & trace
     C                   EXSR      TTSR
     C     FIFIRM        CHAIN     FIRMARC                            33
N14  C     *in33         ifeq      '0'
     C     'aw'          chain     arktxt                             33
     C     *IN33         IFEQ      '0'
     C     arkjn         andeq     'J'
     c     heavd         andne     0
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      HEAVD         ARAVD
     C                   MOVE      HEOPD         AROPD
     C                   MOVEL     DFLOP         ARUNDE
     C                   MOVE      'aw'          ARTYPE
     C                   MOVE      WUSER         ARUSER
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      ULDT          ARDATE
     C                   MOVE      XULTM         ARTIME
     C                   MOVE      HEKNS         ARKUND
     c     arkund        ifeq      0
     c                   move      heknsf        arkund
     c                   end
     C                   WRITE     ARKIVR
     C                   END
N14  C     'al'          chain     arktxt                             33
N14  C     *IN33         IFEQ      '0'
N14  C     arkjn         andeq     'J'
N14  c     heavd         andne     0
N14  C                   MOVE      FIFIRM        ARFIRM
N14  C                   MOVE      HEAVD         ARAVD
N14  C                   MOVE      HEOPD         AROPD
N14  C                   MOVEL     DFLOP         ARUNDE
N14  C                   MOVE      'al'          ARTYPE
N14  C                   MOVE      WUSER         ARUSER
N14  C                   TIME                    XULTID
N14  C                   MOVE      XULDD         ULDD
N14  C                   MOVE      XULMM         ULMM
N14  C                   MOVE      XULÅÅ         ULÅÅ
N14  C                   MOVE      ULDT          ARDATE
N14  C                   MOVE      XULTM         ARTIME
N14  C                   MOVE      HEKNS         ARKUND
N14  c     arkund        ifeq      0
N14  c                   move      heknsf        arkund
N14  c                   end
N14  C                   WRITE     ARKIVR
N14  C                   END
N14  C                   END
     C                   END
     C*
     C                   GOTO      STARTO
     C                   END
     C                   END
      *
      *** UIN08 = M  -->  MAIL AV FLYFRAKTBREV
     C     UIN08         IFEQ      'M'
     C                   EXSR      KOPIM
     C                   END
      *
      *
     C     SLUTT         TAG
     C     UIN08         IFEQ      '1'
     C                   CLOSE     SYEF14FM
     C                   END
     C                   MOVE      XPRANT        UPRANT
     C                   SETON                                        LR
     C                   RETURN
      *
      ******************************************
     C     KOPI          BEGSR
      ******************************************
     C     STKOPI        TAG
     C     DOKEFK        CHAIN(N)  DOKEF                              44
     C  N44DFST          COMP      'P'                                4444
     C   44              EXFMT     BILDE02
     C   44WSOPD         IFEQ      0
     C                   GOTO      SLKOPI
     C                   ELSE
     C                   MOVE      WSOPD         DFOPD
     C                   GOTO      STKOPI
     C                   END
      *
     c                   exsr      sumoth
s16  C*    KOAIA2        IFNE      *ZEROS
s16  C*                  MOVEL     '/'           XIAT4
s16  C*                  MOVE      KOAIA2        XIAT4
s16  C*                  END
     C                   EXSR      PRINT
      * PDFUTSKRIFT ELLER ARKIVERING
     C     CALLTY        IFEQ      'P'
N01  C     CALLTY        oreq      'F'
N05  C     CALLTY        oreq      'D'
     c                   z-add     1             kopinr            2 0
     C                   exsr      ovlsr
     C                   END
     C     HEGN11        IFEQ      *ZEROS
     C     HEGN11        OREQ      *BLANKS
     C                   EXFMT     BILDE03
     C                   GOTO      SLKOPI
     C                   END
     C                   SETON                                        27
      * PDF
     C     CALLTY        IFEQ      'P'
N01  C     CALLTY        oreq      'F'
N05  C     CALLTY        oreq      'D'
     c                   z-add     2             kopinr            2 0
     C                   exsr      ovlsr0
     C                   ELSE
     C                   EXSR      PRINT
     C                   END
     C                   SETOFF                                       27
      *
     C     SLKOPI        ENDSR
      *
      ******************************************
     C     KOPIM         BEGSR
      ******************************************
     C     DOKEFK        CHAIN(N)  DOKEF                              44
      *
     c                   exsr      sumoth
     C  N44              EXSR      PRINT
      * ved MAIL alltid  pdf
     c                   z-add     1             kopinr            2 0
     C                   exsr      ovlsr
      *
N12  C     CALLTY        ifeq      'F'
n12  c                   z-add     2             kopinr            2 0
n12  C                   exsr      ovlsr0
n12  C                   end
     C                   ENDSR
      *
     C******************************************
     C     PRINT         BEGSR
     C******************************************
N16  C     KODTAK        CHAIN     KODTA                              33
N16  C                   MOVE      *BLANKS       XIAT4             5
N16  C     KOAIA2        IFNE      *ZEROS
N16  C                   MOVEL     '/'           XIAT4
N16  C                   MOVE      KOAIA2        XIAT4
N16  C                   END
     C     KODTWK        CHAIN     KODTW                              33
     C     KOWFET        COMP      'J'                                    46
      *
     C   27              GOTO      TAG01
     C     'DISPU'       CHAIN     KODTDIS                            33
     c                   exsr      sumotha
     C                   MOVE      *ZEROS        XTDUA             9 2
      *
     C     HEADFK        CHAIN(N)  HEADF                              33
     c                   move      'J'           import            1
     C     IMPKEY        CHAIN     DOKEFIM                            33
     C   33              move      ' '           domoms
     c   33              move      'N'           import            1
     C     KEYFLP        CHAIN     KODTFLP                            33
     C     HEKNS         IFNE      *ZEROS                                         1 B
     C     KEYKUS        CHAIN     CUNDL01                            33
     c     *in33         ifeq      *off
     C     import        andeq     'J'
     c                   exsr      avsend
     c                   end
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   END                                                     1<-E
     C     HEGN11        IFEQ      *ZEROS
     C     HEGN11        OREQ      *BLANKS
     C                   GOTO      SLPRIN
     C                   END
     C     HEGN11        IFGT      *ZEROS
     C                   MOVEL     XGN           XAWB41
     C                   MOVE      XGN           XAWB42
     C                   ELSE
     C                   MOVE      *ZEROS        XAWB41
     C                   MOVE      *ZEROS        XAWB42
     C                   END
      *
      * GETS COUNTRY IN FULL TEXT
      *
     C                   MOVE      *BLANKS       KJLAND
     C                   MOVE      *BLANKS       SELAND
     C                   MOVE      HELKS         ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C  N33              MOVE      KLKNVN        SELAND           30
     C     DQAD4         IFEQ      *BLANKS
     C                   MOVE      HELKK         ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C  N33              MOVE      KLKNVN        KJLAND           30
     C                   END
      *
     C     HEHAWB        COMP      *ZEROS                                 77
      *
      * UTFØRES KUN VED SINGLE INDIKATOR 77
      * GJØRESELLERS VED UTSKRIFT AV MASTER
      *
     C  N50
     CAN 77DFKDME        IFEQ      'J'
     C                   EXSR      PRINT2
     C                   SETON                                        5051
     C                   END
      *
      *SY* NY KODE REGISTRERING FOR BEGGE TYPER
      *
     C  N50
     CAN 77DFKDME        IFEQ      'B'
     C                   EXSR      PRINT2
     C                   SETON                                        5051
     C                   END
      *
      * UTFØRER RUTINE FOR Å SKRIVE BARCODE MERKELAPP
      * HVIS DET ER BEDT OM DET. KUN SINGEL
     C     *IN77         IFEQ      '1'
     C     DFKDME        IFEQ      'S'
N13  C     UPT68         IFEQ      'PDF'
N13  C                   exsr      printmp
N13  C                   SETON                                        5051
N13  C                   else
     C     FITDVI        IFEQ      'J'
     C                   MOVE      *OFF          *IN90
     C                   EXSR      OPNFIL                                       <Åpne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      PRINT3                                       <Write Label data
     C     *IN90         IFEQ      '0'
     C                   EXSR      SNDTA2                                       <Send dataq
     C                   SETON                                        5051
     C                   ENDIF                                                  <*IN90
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ELSE
     C                   EXSR      PRINT4
     C                   SETON                                        5051
     C                   ENDIF                                                  <FITDVI
N13  C                   ENDIF                                                  <*IN77
     C                   ELSE
     C                   MOVE      *ON           *IN90
     C                   ENDIF                                                  <DFKDME
     C                   ENDIF                                                  <*IN77
     C*
     C                   MOVE      *ZEROS        XDISBL            5 0
     C*
     C     HEHAWB        IFEQ      *ZEROS
     C     DFFSN         CHAIN     ELOGO                              33
     C                   ELSE
     C     KOWLAS        CHAIN     HLOGO                              33
     C     *IN33         IFEQ      *OFF
     C                   MOVEL     HLT1          ELT1
     C                   MOVEL     HLT2          ELT2
     C                   MOVEL     HLT3          ELT3
     C                   MOVEL     HLT4          ELT4
     C                   MOVEL     HLT5          ELT5
     C                   MOVEL     HLT6          ELT6
     C                   ELSE
     C     999           CHAIN     ELOGO                              33
     C                   ENDIF
     C                   END
     C     KODFSK        CHAIN     KODTFS                             33
     C                   MOVE      *BLANKS       XKFSAC
     C     KFAC11        IFEQ      'C'
     C                   MOVE      '60'          KFS012
     C                   MOVE      '-'           KFS031
     C                   MOVE      KFAC21        KFS041
     C                   MOVE      '-'           KFS051
     C                   MOVE      KFAC34        KFS064
     C                   MOVE      '/'           KFS101
     C                   MOVE      KFAC74        KFS114
     C                   ELSE
     C                   MOVEL     KFSAC         XKFSAC
     C                   END
     C     HEADFK        CHAIN     MCAWF                              33
      *
     C     KOWLAS        IFNE      ' '
     C     TELLAK        CHAIN     TELLA                              33
     C  N33TEAACC        IFNE      *BLANKS
     C     TEAC11        IFEQ      'C'
     C                   MOVE      '60'          KFS012
     C                   MOVE      '-'           KFS031
     C                   MOVE      TEAC21        KFS041
     C                   MOVE      '-'           KFS051
     C                   MOVE      TEAC34        KFS064
     C                   MOVE      '/'           KFS101
     C                   MOVE      TEAC74        KFS114
     C                   ELSE
     C                   MOVE      *BLANKS       XKFSAC
     C                   MOVEL     TEAACC        XKFSAC
     C                   END
     C                   END
     C                   END
      *
     C     XROB12        COMP      KFSKD2                             7979
     C  N77              SETON                                        79
      *
     C     HESDF         CHAIN     STED2                              66
     C  N66              MOVE      ST2NVN        ZFRAFL           30
     C     HESDT         CHAIN     STED2                              66
     C                   MOVEL     ST2NVN        WW2NVN
      *
     C     KODSFK        CHAIN     KODTSF                             33
     C     DFBELF        COMP      0                                      40
      *
     C                   MOVE      *BLANKS       FK
     C                   MOVE      *ZEROS        FN
      *
      * finner due agent beløp
      *
     C     DFCCPP        COMP      'CC'                                   70
      *
      * ved CC summeres fakturalinjer F ved singel  K ved samlast
      *
     C   70              EXSR      SUM
     C   70              Z-ADD     XTKJØ         XTDUA
     c   70              add       wsblda        xtdua
      *
      * ved PP tas beløp summer fra filen other-charges
      * denne er summer i wsblda
      *
     c  N70              z-add     wsblda        xtdua
      *
      *
      * SKAL BELØP MOT CARRIER PÅ MOTSATT SIDE
      * MED HENSYN TIL CC/PP
      *
     C                   MOVE      *ZEROS        XCAPRE
     C                   MOVE      *ZEROS        XCACOL
      *
     C   70DFKDDC        IFEQ      'P'
     C                   Z-ADD     DFBLDC        XCAPRE            9 2
     C                   MOVE      *ZEROS        DFBLDC
     C                   END
     C  N70DFKDDC        IFEQ      'C'
     C                   Z-ADD     DFBLDC        XCACOL            9 2
     C                   MOVE      *ZEROS        DFBLDC
     C                   END
      *
     C   70XCAPRE        COMP      *ZEROS                             35
     C  N70XCACOL        COMP      *ZEROS                             35
      *
      * HOPPES HIT VED PRINT AV 2. SIDE FLYFRAKT
      *
     C     TAG01         TAG
      *
      * HENTE TILLEGGSOPPLYSNINGER
      *
n07  c                   setoff                                       55
n07  c                   move      *blanks       XIATCO
n07  c                   move      *blanks       KSIDCO
     C     DOKEQK        CHAIN     DOKEQ                              88
n07  c     *in88         ifeq      '0'
n07  c     dqcol         andne     *zeros
n07  c                   seton                                        55
n07  c                   move      dqcol         koaknr
n07  c     kund1k        chain     cundl01                            33
n07  C  N33              MOVEL     ADR3          XFRAFL           30
n07  c     sypark        chain     syparl1                            33
n07  c  N33              movel     syvrda        XIATCO
n07  c     sypark2       chain     syparl1                            33
n07  c  N33              movel     syvrda        KSIDCO
n07  c                   end
     C   88              DO
     C                   MOVE      *BLANKS       DQNA
     C                   MOVE      *BLANKS       DQAD1
     C                   MOVE      *BLANKS       DQAD2
     C                   MOVE      *BLANKS       DQAD3
     C                   MOVE      *BLANKS       DQAD4
     C                   MOVE      *BLANKS       DQINFD
     C                   MOVE      *BLANKS       DQINF3
     C                   MOVE      *BLANKS       DQINF4
     C                   MOVE      *BLANKS       DQINF5
     C                   MOVE      *BLANKS       DQINF6
     C                   MOVE      *BLANKS       DQINF7
     C                   MOVE      *BLANKS       DQINF8
     C                   MOVE      *BLANKS       DQINF9
     C                   MOVE      *BLANKS       DQVS11
     C                   MOVE      *BLANKS       DQVS12
     C                   MOVE      *BLANKS       DQVS13
     C                   MOVE      *BLANKS       WPINFD
     C                   END
     C  N88              DO
     C                   MOVE      DQNA          HENAK
     C                   MOVE      DQAD1         HEADK1
     C                   MOVE      DQAD2         HEADK2
     C                   MOVE      DQAD3         HEADK3
     C                   MOVEL     DQINFD        WPINFD
     C                   END
      *
     C                   MOVEL     DFINFC        WPINFC
     C*
     C     DFTLFS        COMP      *BLANKS                            8888
     C     DFTLFK        COMP      *BLANKS                            8989
     C                   EXSR      ZSTART
     C     DFAVD         CHAIN     KODTASID                           75
     C   75              MOVE      *BLANKS       KSIDNR
     C                   WRITE     PRT2
     C                   WRITE     PRTDE0
     C*
     C                   Z-ADD     1             XN                2 0
     C*
      * IN67 på medfører print av AS AGREED
     C     DFRK1         ifeq      'A'
     C                   MOVE      *ON           *IN67
     C                   ENDIF
     C     STARP         TAG
     C     XN            IFGT      2
     C                   MOVE      *OFF          *IN67
     C                   ENDIF
     C     XN            IFEQ      2
     C     BE(2)         ANDEQ     *ZEROS
     C     PR(2)         ANDEQ     *ZEROS
     C                   MOVE      *OFF          *IN67
     C                   ENDIF
     C                   MOVE      KA(XN)        XWRKKA            4
     C     NUM           CHECK     KA(XN)        NUMCHK            1 0
     C     NUMCHK        IFGT      0
     C                   MOVE      *OFF          *IN30
     C                   ELSE
     C                   MOVE      *ON           *IN30
     C                   ENDIF
     C*
     C     VE(XN)        IFGT      *ZEROS
     C                   MOVE      'K'           XKILOA            1
     C                   ELSE
     C                   MOVE      *BLANKS       XKILOA
     C                   END
     C*
     C                   Z-ADD     BE(XN)        WRKBA            10 2
     C*
     C* BASISPRISBEREGNING
     C*
     C*
     C     MI(XN)        COMP      'P'                                    32
     C                   MOVE      *OFF          *IN28
     C                   EXSR      MOVKA
     C                   WRITE     PRTDE2
     C     MI(1)         IFEQ      'P'
     C     XN            ANDEQ     4
     C     MI(1)         OREQ      'D'
     C     XN            ANDEQ     4
     C                   WRITE     PRIO2
     C                   END
     C     MI(1)         IFEQ      'X'
     C     XN            ANDEQ     4
     C                   WRITE     PRIO3
     C                   END
     C                   MOVE      XWRKKA        KA(XN)
     C                   Z-ADD     WRKBA         BE(XN)
     C                   ADD       1             XN
     C     XN            COMP      6                                  33
     C  N33              GOTO      STARP
      * IN67 på medfører print av AS AGREED
     C     DFRK1         ifeq      'A'
     C                   MOVE      *ON           *IN67
     C                   ENDIF
      *
     c                   move      DFVS7         DFqS7
     c                   move      DFVS8         DFqS8
     c                   move      DFVS9         DFqS9
     c                   move      DFVS10        DFqS10
     c                   exsr      fri
      *
      * FINNER DISPURSMENTFEE
      *
     C   27              GOTO      TAG02
      *
     C   70XTDUA         COMP      KDSBL1                               33
     C   70
     CAN 33              Z-ADD     KDSBL2        XDISBL            5 0
     C   70
     CANN33XTDUA         MULT      KDSPRO        XDISBL
     C   70
     CANN33XDISBL        COMP      KDSBL3                               34
     C   70
     CANN33
     CAN 34              Z-ADD     KDSBL3        XDISBL
     C   70XTDUA         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        XDISBL
     C                   END
     C     HELKA         IFEQ      'NO'
     C     HELKS         ANDEQ     'NO'
     C                   Z-ADD     0             XDISBL
     C                   END
      *
      * SKJEKKER OM IKKE DISP-FEE SKAL VÆRE MED DUE CARRIER
      *
     C                   MOVE      ST2LK         ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C     KLKDIS        COMP      'N'                                    34
     C   34              MOVE      *ZEROS        XDISBL
     C     HEHAWB        IFNE      *ZEROS
     C                   MOVE      *ZEROS        XDISBL
     C                   END
      *
     C                   ADD       XDISBL        DFBLDC
      * LEGG TIL RECORD FOR DISP-FEE I DOKOTH
     C                   MOVEL     'DB'          WO1331
     C     OTHKEY        CHAIN     DOKOTH                             66
     C  N66DFBLDC        SUB       DO1333        DFBLDC
     C  N66              DELETE    DOKOTR
     C     XDISBL        IFGT      0
     C                   CLEAR                   DOKOTR
     C                   Z-ADD     DFAVD         DOAVD
     C                   Z-ADD     DFOPD         DOOPD
     C                   Z-ADD     DFlop         DOlop
     C     DFCCPP        IFEQ      'CC'
     C                   MOVEL     'C'           DO1322
     C                   ELSE
     C     DFCCPP        IFEQ      'PP'
     C                   MOVEL     'P'           DO1322
     C                   ENDIF                                                  <WSCCPP
     C                   ENDIF                                                  <WSCCPP
     C                   MOVEL     'DB'          DO1331
     C                   MOVEL     'C'           DO1332
     C                   Z-ADD     XDISBL        DO1333
     C                   WRITE     DOKOTR
     C                   ENDIF
      *
      * MC     SKAL DUE CARRIER
      *
     C     DFBLT         ADD       DFBLDC        XBELTO            9 2
     C                   ADD       DFBLA         XBELTO
     C                   ADD       XTDUA         XBELTO
     C     DFBLA         COMP      *ZEROS                             36
     C     XTDUA         COMP      *ZEROS                             38
     C     DFBLDC        COMP      *ZEROS                             39
      *
     C     TAG02         TAG
      *
     C                   EXSR      REMBUR
     C                   EXSR      KDTFMT
     C                   EXSR      EDTOTH
     C  N27              EXSR      MOMSSR
     C  N70
     CANN67              WRITE     PRTTO2
     C  N70
     CAN 67              WRITE     ARTTO2
     C   70
     CANN67              WRITE     PRTTO3
     C   70
     CAN 67              WRITE     ARTTO3
     C     SLPRIN        ENDSR
     C*
     C******************************************
     C     MOVKA         BEGSR
     C******************************************
     C                   Z-ADD     1             X3                1 0
     C     X3            DOWLE     6
     C                   MOVE      KA(X3)        TESTSH            1
     C     TESTSH        IFGE      '0'
     C     TESTSH        ANDLE     '9'
     C                   MOVE      KA(X3)        KA1(X3)
     C                   ELSE
     C                   MOVE      *ZEROS        KA1(X3)
     C                   END
     C                   ADD       1             X3
     C                   END
     C*
     C                   MOVE      KA1(XN)       KA1CXN            4 0
     C                   MOVE      KA(XN)        KACXN             4
     C                   MOVE      VE(XN)        VECXN             7 1
     C                   MOVE      RA(XN)        RACXN             1
     C                   MOVE      IT(XN)        ITCXN             4
     C                   MOVE      FV(XN)        FVCXN             7 1
     C                   MOVE      PR(XN)        PRCXN             8 2
     C                   MOVE      BE(XN)        BECXN            10 2
     C                   MOVE      VA(XN)        VACXN            25
     C                   ENDSR
     C*
     C******************************************
     C     PRINT2        BEGSR
     C******************************************
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     HESDT         XFLY1
     C                   MOVE      DFROA1        XFLY2             3
     C                   MOVE      DFROA2        XFLY3             3
     C                   ELSE
     C                   MOVE      *BLANKS       XFLY3
     C     DFROA2        IFNE      *BLANKS
     C                   MOVE      DFROA2        XFLY1
     C                   MOVE      DFROA1        XFLY2
     C                   ELSE
     C                   MOVE      *BLANKS       XFLY2
     C                   MOVE      DFROA1        XFLY1
     C                   END
     C                   END
     C                   Z-ADD     1             XANTL             3 0
     C     XANTL         DOWLE     DFNTT
     C                   EXCEPT    MLAP
     C     DFKDME        IFEQ      'B'
     C                   EXCEPT    MLAP2
     C                   END
     C                   ADD       1             XANTL
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT3        BEGSR
     C******************************************
      * LABEL PRINT MED BARCODE (TDV IS)
     C                   MOVE      WHEGN3        WNHEG3            3 0
     C     WNHEG3        CHAIN     ISUL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     ISPART        LAPAID
     C                   MOVEL     'LAI'         LAMEID
     C     1             CHAIN     CNFF                               90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   ADD       1             CNRECN
     C                   UPDATE    CNFR
     C                   Z-ADD     CNRECN        LARECN
s11   * HENT PRINTER NAVN
s11  C*                  CALL      'SYGE01'
s11  C*                  PARM                    DFAVD
s11  C*                  PARM      068           WUSKNR            3 0
s11  C*                  PARM                    WOPNVN           10
s11  C*                  PARM                    WOPTY            10
s11  C*                  PARM                    WOPHEA            1
s11  C*                  PARM                    WKOPFM
      * NÅ GJELDER UDS STYRINGEN AV PRINTER
N11  C                   MOVEL     UPRT68        WOPNVN           10
N11  C                   MOVEL     UPT68         WOPTY            10
     C                   MOVEL     WOPNVN        LAPRID
     C                   Z-ADD     DFNTT         LANUMC
     C     ISPART        CHAIN     PARL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     LABNAM        LAISTX
     C     DFRK1         IFEQ      'P'
     C     DFRK1         OREQ      'D'
     C     DFRK2         OREQ      'P'
     C     DFRK3         OREQ      'P'
     C     DFRK4         OREQ      'P'
     C     DFRK5         OREQ      'P'
     C     DFRK6         OREQ      'P'
     C                   MOVEL     PRICAR        LASERC
     C                   ELSE                                                   <WHEGN3
     C     DFRK1         IFEQ      'X'
     C     DFRK2         OREQ      'X'
     C     DFRK3         OREQ      'X'
     C     DFRK4         OREQ      'X'
     C     DFRK5         OREQ      'X'
     C     DFRK6         OREQ      'X'
     C                   MOVEL     EUROPE        LASERC
N06  C                   ELSE                                                   <WHEGN3
N06  C     DFRK1         IFEQ      'Z'
N06  C     DFRK2         OREQ      'Z'
N06  C     DFRK3         OREQ      'Z'
N06  C     DFRK4         OREQ      'Z'
N06  C     DFRK5         OREQ      'Z'
N06  C     DFRK6         OREQ      'Z'
N06  C                   MOVEL     TDFLAS        LASERC
     C                   ELSE
     C                   MOVEL     *BLANKS       LASERC
N06  C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     HESDF         WHESDT
     C                   MOVEL     WHEGN3        AWBDES
     C                   MOVE      WHEGN8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     HESDT         LADCTY
     C                   Z-ADD     DFNTT         LANUMP
     C                   Z-ADD     DFVKTT        LAWGHT
     C                   MOVEL     DFINFA        LAHAIN
     C                   MOVEL     HENAS         LASHP1
     C                   MOVEL     HEADS1        LASHP2
     C                   MOVEL     HEADS2        LASHP3
     C                   MOVEL     HEADS3        LASHP4
     C                   MOVEL     HENAK         LACNE1
     C                   MOVEL     HEADK1        LACNE2
     C                   MOVEL     HEADK2        LACNE3

     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     DFROA1        IFNE      *BLANKS
     C                   MOVEL     DFROA1        WWA
     C                   MOVEL     DFROB1        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     DFROA2        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA2        WWA
     C                   MOVEL     DFROB2        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA3        WWA
     C                   MOVEL     DFROB3        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   MOVE      HEGN11        WWAWB            11 0
     C                   Z-ADD     WWAWB         LAAWBN
     C                   Z-ADD     WWAWB         LAAWB2
     C                   MOVEL     *ZEROS        LAHNUM
     C                   MOVEL     *ZEROS        LAHWGT
     C                   MOVE      *BLANK        LAHCDE
      *
     C                   WRITE     LABR
      *
     C     ENDPR3        ENDSR
      *
      ******************************************
     C     PRINT4        BEGSR
      ******************************************
     C                   OPEN      ISUL01                               90
     C  N90              OPEN      PARL01                               90
     C                   MOVE      WHEGN3        WNHEG3
     C     WNHEG3        CHAIN     ISUL01                             90
     C  N90ISPART        CHAIN     PARL01                             90
     C                   CLOSE     ISUL01                               90
     C                   CLOSE     PARL01                               90
      * LABEL PRINT MED BARCODE. STANDARD SYSPED400
s11   * HENT PRINTER NAVN
s11  C*                  CALL      'SYGE01'
s11  C*                  PARM                    DFAVD
s11  C*                  PARM      068           WUSKNR
s11  C*                  PARM                    WOPNVN
s11  C*                  PARM                    WOPTY
s11  C*                  PARM                    WOPHEA
s11  C*                  PARM                    WKOPFM
     C* NÅ GJELDER UDS STYRINGEN AV PRINTER
N11  C                   MOVEL     UPRT68        WOPNVN
N11  C                   MOVEL     UPT68         WOPTY
      * SJEKK OM DET ER KORREKT PRINTER ANGITT I PAPIRTYPE
     C     WOPTY         IFEQ      'ZEBRA 95'
N11  C     WOPTY         OREQ      'ZEBRA   '
     C     WOPTY         OREQ      'STRIPE  '
     C     WOPTY         OREQ      'ELTRON  '
     C                   CLEAR                   DOLAR
     C     *IN90         IFEQ      *ON
     C     LABNAM        OREQ      *BLANKS
     C                   MOVEL     FIKRTN        DOISTX
     C                   ELSE
     C                   MOVEL     LABNAM        DOISTX
     C                   ENDIF
     C                   MOVEL     WOPNVN        LAPRID
     C                   Z-ADD     DFNTT         LANUMC
     C                   MOVEL     *BLANKS       LAISTX
     C     DFRK1         IFEQ      'P'
     C     DFRK1         OREQ      'D'
     C     DFRK2         OREQ      'P'
     C     DFRK3         OREQ      'P'
     C     DFRK4         OREQ      'P'
     C     DFRK5         OREQ      'P'
     C     DFRK6         OREQ      'P'
     C                   MOVEL     PRICAR        LASERC
     C                   ELSE
     C     DFRK1         IFEQ      'X'
     C     DFRK2         OREQ      'X'
     C     DFRK3         OREQ      'X'
     C     DFRK4         OREQ      'X'
     C     DFRK5         OREQ      'X'
     C     DFRK6         OREQ      'X'
     C                   MOVEL     EUROPE        LASERC
N06  C                   ELSE                                                   <WHEGN3
N06  C     DFRK1         IFEQ      'Z'
N06  C     DFRK2         OREQ      'Z'
N06  C     DFRK3         OREQ      'Z'
N06  C     DFRK4         OREQ      'Z'
N06  C     DFRK5         OREQ      'Z'
N06  C     DFRK6         OREQ      'Z'
N06  C                   MOVEL     TDFLAS        LASERC
     C                   ELSE
     C                   MOVEL     *BLANKS       LASERC
N06  C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     HESDF         WHESDT
     C                   MOVEL     WHEGN3        AWBDES
     C                   MOVE      WHEGN8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     HESDT         LADCTY
     C                   Z-ADD     DFNTT         LANUMP
     C                   Z-ADD     DFVKTT        LAWGHT
     C                   MOVEL     DFINFA        LAHAIN
     C                   MOVEL     HENAS         LASHP1
     C                   MOVEL     HEADS1        LASHP2
     C                   MOVEL     HEADS2        LASHP3
     C                   MOVEL     HEADS3        LASHP4
     C                   MOVEL     HENAK         LACNE1
     C                   MOVEL     HEADK1        LACNE2
     C                   MOVEL     HEADK2        LACNE3
     C                   MOVEL     HEADK3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     DFROA1        IFNE      *BLANKS
     C                   MOVEL     DFROA1        WWA
     C                   MOVEL     DFROB1        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     DFROA2        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA2        WWA
     C                   MOVEL     DFROB2        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA3        WWA
     C                   MOVEL     DFROB3        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   MOVE      HEGN11        WWAWB            11 0
     C                   Z-ADD     WWAWB         LAAWBN
     C                   Z-ADD     WWAWB         LAAWB2
     C                   MOVEL     *ZEROS        LAHNUM
     C                   MOVEL     *ZEROS        LAHWGT
     C                   MOVE      *BLANK        LAHCDE
     C                   Z-ADD     DFAVD         LAAVD
     C                   Z-ADD     DFOPD         LAOPD
     C                   MOVE      DFSG          LASIGN
      *
     C                   WRITE     DOLAR
      *
     C                   CALL      'SYLA01C'
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    WOPTY
     C                   PARM                    WOPNVN
      *
     C     DORECN        CHAIN     DOLAR                              90
     C     *IN90         IFEQ      *OFF
     C                   DELETE    DOLAR
     C                   ENDIF
      *
     C                   ENDIF                                                  <WOPTY
      *
     C     ENDPR4        ENDSR
N13   ******************************************
N13  C     PRINTMP       BEGSR
N13   ******************************************
N13   * merkelapper i pdf
N13   *
N13  c                   move      dfavd         dfavda            4
N13  c                   move      dfopd         dfopda            7
N13  c                   move      dflop         dflopa            3
N13  c                   move      *blanks       dfsama            6
N13  c                   call      'SYEF14MCL'
N13  c                   parm                    dfavda
N13  c                   parm                    dfopda
N13  c                   parm                    dflopa
N13  c                   parm                    dfsama
N13  C                   PARM                    UPRT68
N13  c                   endsr
      ******************************************
     C     SUM           BEGSR
      ******************************************
     C                   MOVE      *BLANKS       FK
     C                   MOVE      *ZEROS        FN
     C                   Z-ADD     1             XN2               2 0
      *
     C  N77              MOVE      'K'           YSK
     C   77              MOVE      'F'           YSK
     C     HEVALK        COMP      FICURR                             7171
     C     FAK2K         SETLL     FAK2
     C                   EXSR      SUM2
     C                   Z-ADD     XBRUTT        XTKJØ             9 2
      *
     C                   ENDSR
      *
      ******************************************
     C     SUM2          BEGSR
      ******************************************
     C                   MOVE      *BLANKS       FK
     C                   MOVE      *ZEROS        FN
     C                   MOVE      *ZEROS        XTOTAL            9 2
     C                   MOVE      *ZEROS        XMVAGR            9 2
     C                   SETOFF                                       33
      *
     C     STVALI        TAG
     C     FAK2K         READE     FAK2                                   33
     C  N33FAKDM         COMP      'J'                                    34
     C  N33FAKDA         IFNE      'K'                                          0<-B
     C  N33FAKDA         IFNE      'C'
     C  N33FAVK          IFNE      'FFE'                                        1<-B
     C  N33FAVK          IFNE      'FFN'                                        1<-B
     C     FAVK          IFNE      'MC '                                         2<-B
     C     FAOPKO        IFNE      'D'
     C     FAKDA         ANDNE     'D'
     C  N71              ADD       FABELN        XTOTAL
     C   71              ADD       FABELV        XTOTAL
     C     XN2           IFLE      9                                              3<-B
     C     KODG2K        CHAIN     KODTG2                             42
     C  N42              MOVE      KG2KRT        FK(XN2)
      *  UNDERTRYKKE DESIMALER - FARLIG VED INSTALLASJON I F.EKS USA. (DOLLAR)
      *                    MOVE FABELN    FN,XN2
     C  N71              Z-ADD     FABELN        FN(XN2)
     C   71              Z-ADD     FABELV        FN(XN2)
     C                   ADD       1             XN2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C                   END                                                    0<-E
     C                   END                                                    0<-E
     C                   END                                                    0<-E
     C  N33              GOTO      STVALI
      * VARIABLE VAT
      *
     C                   Z-ADD     XTOTAL        XBRUTT            9 2
      *
     C                   ENDSR
      ******************************************
     C     MOMSSR        BEGSR
      ******************************************
     C                   SETOFF                                       61
     C                   Z-ADD     0             XMOMS             9 2
      *
      * momsstyring ved landkoder
      *
     C     HELKA         IFEQ      'NO'
     C     domoms        andeq     ' '

     C     HELKS         ANDEQ     'NO'
     C     HESDT         ANDNE     'LYR  '
     C                   MOVE      FITAX         FITAXN            4 4
     C     XBELTO        MULT(H)   FITAXN        XMOMS
     C                   ADD       XMOMS         XBELTO
     C                   SETON                                        61
     C                   END
      *
      * tvunget styring  moms
      *
     C     DOMOMS        IFEQ      'J'
     C                   MOVE      FITAX         FITAXN            4 4
     C     XBELTO        MULT(H)   FITAXN        XMOMS
     C                   ADD       XMOMS         XBELTO
     C                   SETON                                        61
     C                   END
     C                   ENDSR
      ******************************************
     C     REMBUR        BEGSR
      ******************************************
      * Feltet for REF og Signatur er nå endret slik at REF skrives
      * ut lenger opp på fraktbrevet og man har tre linjer tilgjengelig
      * for flyselskap, agent, dato, sted, signatur og ledetekst.
      *
      * Dato, sted og signatur skrives fast på den nederste av disse
      * tre linjene. To linjer på 44 pos. brukes da til å skrive ut
      * ledetekst, flyselskap og agent. Dette redigeres utover disse
      * to linjene.
      * For HAWB er det en litt anderledes tekst på utskriften.
      * 77 = på --> singelutskrift.
     C                   Z-ADD     30            XX                3 0
     C                   MOVEL     *BLANKS       REW              88
     C                   MOVEA     *BLANKS       RE1
     C                   MOVEA     *BLANKS       RE2
     C     *IN77         IFEQ      *ON
     C                   MOVEL     FTXT          REW
     C     KFSNAV        IFEQ      *BLANKS
     C                   MOVEL     '...'         KFSNAV
     C                   END
     C                   MOVEA     KFSNAV        RE1
     C                   ELSE
     C                   MOVEL     FTXT3         REW
     C                   GOTO      REM02
     C                   ENDIF
     C     RE1(XX)       DOWEQ     *BLANK
     C                   SUB       1             XX
     C                   ENDDO
     C                   ADD       1             XX
     C                   MOVE      ','           RE1(XX)
     C                   MOVEA     RE1           REW2             31
     C     REW           CAT(P)    REW2:1        REW
     C     REM02         TAG
     C                   MOVEL     KNAVN         REW2
     C     REW           CAT(P)    REW2:1        REW
      *
     C                   MOVEA     REW           RE
     C                   Z-ADD     88            RT                3 0
     C     RE(RT)        DOWEQ     *BLANK
     C                   SUB       1             RT
     C                   ENDDO
     C     RT            IFLE      44
     C                   ADD       1             RT
     C                   ENDIF
     C     REMTAG        TAG
     C     RT            IFLE      44
     C     1             DO        RT            XX
     C                   MOVE      RE(XX)        RE1(XX)
     C                   ENDDO                                                  <1
     C                   Z-ADD     1             YY                3 0
     C     RT            DO        88            XX
     C                   MOVE      RE(XX)        RE2(YY)
     C                   ADD       1             YY
     C     YY            IFGT      44
     C                   LEAVE
     C                   ENDIF
     C                   ENDDO                                                  <RT
     C                   ELSE                                                   <RT
     C     RE(RT)        DOUEQ     *BLANK
     C                   SUB       1             RT
     C                   ENDDO
     C                   GOTO      REMTAG
     C                   ENDIF                                                  <RT
     C                   MOVEA     RE1           LIN01            44
     C                   MOVEA     RE2           LIN02            44
     C                   ENDSR
      ********************************************************************D260
     C     ZSTART        BEGSR
      ********************************************************************
     C                   MOVE      HESDF         XFRA9             9
     C                   MOVEL     XFRA9         XAWBI1           17
     C                   MOVEL     DFFSN         XAWBI1
     C                   MOVE      XAWB9         XAWBI1
     C                   MOVEL     DFFSN         XAWBI2           15
     C                   MOVE      XAWB9         XAWBI2
     C                   MOVEL     HESDF         XAWBI3           12
S09  C*                  MOVE      HEHAWB        XAWB6             6
N09  C                   MOVE      HEHAWB        XAWB9b            9
S09  C*                  MOVE      XAWB6         XAWBI3
N09  C                   MOVE      XAWB9b        XAWBI3
     C                   MOVEL     XARK          XPARM            80
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
N07  C     SYPARK        KLIST
N07  C                   KFLD                    DQCOL
N07  C                   KFLD                    PARID1
N07  c                   move      'IATAK'       PARID1            5
N07  C     SYPARK2       KLIST
N07  C                   KFLD                    DQCOL
N07  C                   KFLD                    PARID2
N07  c                   move      'IDAIR'       PARID2            5
     C     HEADFK        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C     IMPKEY        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFLOP
     C     DOKEQK        KLIST
     C                   KFLD                    DQRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFLOP
     C     DOKEFK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFLOP
     C     DOKF1K        KLIST
     C                   KFLD                    YST
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KOAKNR
     C     KEYKUS        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    HEKNS
     C     VADRK         KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    HEKNS
     C                   kfld                    va1               5 0
     c                   z-add     1             va1
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YSK
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    DFAVD
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    DFAVD
     C     KODG2K        KLIST
     C                   KFLD                    YG2UNI
     C                   KFLD                    FAVK
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    DFSG
     C     KODFSK        KLIST
     C                   KFLD                    YFSUNI
     C                   KFLD                    DFFSN
     C     TELLAK        KLIST
     C                   KFLD                    YTAUNI
     C                   KFLD                    DFFSN
     C                   KFLD                    KOWLAS
     C     KODLKK        KLIST
     C                   KFLD                    YLKUNI
     C                   KFLD                    ST2LKX            2
     C     KEYFLP        KLIST
     C                   KFLD                    YFLPUN
     C                   KFLD                    TRSTA4
     C                   MOVE      'FLPR'        YFLPUN            4
     C     OTHKEY        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFLOP
     C                   KFLD                    WO1331
     C                   KFLD                    WO1332
     C     *LIKE         DEFINE    DO1331        WO1331
     C     *LIKE         DEFINE    DO1332        WO1332
     C                   MOVEL     'DB'          WO1331
     C                   MOVEL     'C'           WO1332
      *
     C     *ENTRY        PLIST
     C                   PARM                    UIN08             1
     C                   PARM                    UPRANT            2
     C                   PARM                    UAVDA             4
     C                   PARM                    UOPDA             7
     C                   PARM                    ULOPA             3
     C                   PARM                    CALLTY            1
     C                   MOVE      UAVDA         UAVD              4 0
     C                   MOVE      UOPDA         UOPD              7 0
     C                   MOVE      ULOPA         ULOP              3 0
     C     UIN08         IFEQ      'M'
     C                   MOVE      UAVD          DFAVD
     C                   MOVE      UOPD          DFOPD
     C                   MOVE      ULOP          DFLOP
     C                   END
      *
     C                   MOVE      'F'           DFRI              1
     C                   MOVE      'Q'           DQRI              1
     C                   MOVE      ' '           YST               1
     C                   MOVE      ' '           YSK               1
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'AE'          YTAUNI            2
     C                   MOVE      'G2'          YG2UNI            2
     C                   MOVE      'LK '         YLKUNI            3
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      'FS'          YFSUNI            2
     C                   MOVE      *ZEROS        XPRANT            2 0
     C                   MOVEL     WUSER         WWUSER           17
s11  C*                  MOVE      *BLANKS       WKOPFM            5
     C                   Z-ADD     0             XMOMS             9 2
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      UAVD          DFAVD
     C     KODTAK        CHAIN     KODTA                              33
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVEL     ADR3          WWPLAC           24
     C                   MOVEL     ADR3          XFRAF2           15
     C                   MOVEL     ADR3          XFRAFL           30
      *
      * KALLES KUN EN GANG
      *
     C                   MOVEL     '    -   '    XAWBI2
     C                   MOVEL     '    -'       XAWBI3
      *
     C                   MOVEL     *BLANKS       PGID             17
     C                   MOVEL     *BLANKS       PGIDNE           35
     C                   MOVEL     *BLANKS       PGPACP           17
     C                   MOVEL     *BLANKS       PGPACA           35
     C                   MOVEL     *BLANKS       PGCPAI           17
     C                   MOVEL     *BLANKS       PGCPAA           35
     C                   MOVEL     *BLANKS       PGMTM1            1
     C                   MOVEL     *BLANKS       PGMTM2            1
     C                   MOVEL     *BLANKS       PGMTM3            1
     c                   move      *zeros        wsdato
      *
     C                   ENDSR
      ***********************************************
     C     KDTFMT        BEGSR
      ***********************************************
      *
      * skjekk track and trace
      *
     c     trkey         klist
     c                   kfld                    dfavd
     c                   kfld                    dfopd
     c                   kfld                    ttfbnr
     c                   kfld                    ttacti
     C     uin08         ifne      '0'
     c                   move      'PRA'         ttacti
s04  c*    trkey         setll     trackl02
s04  c*    trkey         reade     trackl02                               33
n04  c     trkey         setgt     trackl02
n04  c     trkey         readpe    trackl02                               33
     c     *in(33)       ifeq      '0'
     c     wsdato        ifne      0
     C                   MOVE      wsdd          UDT1              2 0
     C                   MOVE      wsmm          UDT2              2 0
     C                   MOVE      wsaa          UDT3              2 0
     c                   else
     c                   move      ttdate        dato06            6 0
     C                   MOVE      ttdag         UDT1              2 0
     C                   MOVE      ttmnd         UDT2              2 0
     C                   MOVE      ttaar         UDT3              2 0
     c                   END
     c                   goto      utfmt
     c                   end
     c                   end
     C                   MOVE      UDAY          UDT1              2 0
     C                   MOVE      UMONTH        UDT2              2 0
     C                   MOVE      UYEAR         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
      *
     C     utfmt         ENDSR
      ***********************************************
     C     OPNFIL        BEGSR
      ***********************************************
      * DUMMY READ AV FILER
     C  N90
     CAN 90              READ      LABF                                   90
      * ÅPNER FILER
     C     FITDVI        IFEQ      'N'
     C                   MOVE      '1'           *IN90
     C                   ELSE
     C                   OPEN      CNFF                                 90
     C  N90              OPEN      LABF                                 90
     C  N90              OPEN      ISUL01                               90
     C  N90              OPEN      PARL01                               90
     C                   ENDIF
     C* HVIS ÅPNING AV FILER GIKK GALT KAN IKKE RUTINEN UTFØRES
     C     *IN90         CABEQ     '1'           OPNF99
     C* HVIS ALT GIKK GREIT KAN RUTINEN UTFØRES
     C     OPNF99        ENDSR
     C***********************************************
     C     WRTFWB        BEGSR
     C***********************************************
     C                   MOVEL     *BLANKS       WRK
     C     11            SUBST     HEGN:5        WRK
     C                   EXSR      CHKNUM
     C     *IN91         IFEQ      '0'
     C     *IN92         ANDEQ     '0'
     C     3             SUBST     HEGN:5        W0211A            3
     C                   MOVEL     W0211A        W0211             3 0
     C     W0211         CHAIN     ISUL01                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     ISPART        PGID
     C                   ELSE
     C                   MOVEL     *BLANKS       PGID
     C                   ENDIF
     C     1             CHAIN(N)  CNFF                               90
     C     *IN90         IFEQ      *OFF
     C     CNCOD1        ANDEQ     'Y'
     C                   MOVEL     'CCS'         PGID
     C                   ENDIF
     C                   CALL      'TDV13R'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    DFLOP
     C                   PARM      *BLANKS       AWB              11
     C                   PARM                    PGID
     C                   PARM                    PGIDNE
     C                   PARM                    PGPACP
     C                   PARM                    PGPACA
     C                   PARM                    PGCPAI
     C                   PARM                    PGCPAA
     C                   PARM                    PGMTM1
     C                   PARM                    PGMTM2
     C                   PARM                    PGMTM3
      *
     C                   ENDIF
      *
     C                   ENDSR
      ***********************************************
     C     SNDTA2        BEGSR
      ***********************************************
     C                   MOVEL     'SMADTARQ'    QTNAME           10
     C                   MOVEL     '*LIBL'       QTLIB            10
     C                   Z-ADD     9             QTLEN             5 0
     C                   MOVE      *BLANKS       QTFIEL            9
     C                   Z-ADD     LARECN        WARECA
     C                   MOVE      WARECA        QTFIEL
     C                   Z-ADD     9             QKILEN            3 0
     C                   MOVE      *BLANKS       QKEY              9
     C                   MOVEL     'LAI'         QKEY
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QTNAME
     C                   PARM                    QTLIB
     C                   PARM                    QTLEN
     C                   PARM                    QTFIEL
     C                   PARM                    QKILEN
     C                   PARM                    QKEY
      *
     C                   ENDSR
      ***********************************************
     C     CLOFIL        BEGSR
      ***********************************************
      * CLOSER FILER
     C                   CLOSE     CNFF                                 90
     C                   CLOSE     LABF                                 90
     C                   CLOSE     ISUL01                               90
     C                   CLOSE     PARL01                               90
      *
     C                   ENDSR
      ***********************************************
     C     CHKNUM        BEGSR
      ***********************************************
     C                   MOVE      *OFF          *IN91
     C                   Z-ADD     30            ÆX                3 0
     C                   Z-ADD     30            ÆY                3 0
     C                   MOVEA     *BLANKS       AR1
     C                   MOVEA     *BLANKS       AR2
     C                   MOVEA     WRK           AR1
     C     WRK           CABEQ     *BLANKS       CHK99                    92
      * POSISJONER TIL SISTE TEGN I FELTET
     C     AR1(ÆX)       DOWEQ     *BLANK
     C                   SUB       1             ÆX
     C                   ENDDO
      * ERSTATT BLANK MED NULL OG SJEKK OM DET BARE ER TALL
     C     ÆX            DOWGT     0
     C     AR1(ÆX)       IFEQ      *BLANK
     C                   MOVE      '0'           AR1(ÆX)
     C                   ENDIF
     C     AR1(ÆX)       IFGE      '0'
     C     AR1(ÆX)       ANDLE     '9'
     C                   MOVE      AR1(ÆX)       AR2(ÆY)
     C                   SUB       1             ÆX
     C                   SUB       1             ÆY
     C                   ELSE                                                   <AR1,ÆX
      * FELTET INNEHOLDER IKKE BARE TALL. 91 BLIR SATT PÅ
     C                   MOVE      *ON           *IN91
     C                   GOTO      CHK99
     C                   END                                                    <AR1,ÆX
     C                   ENDDO                                                  <ÆX
      * FYLL OPP RESTEN AV FELTET MED NULL
     C     ÆY            DOWGT     0
     C                   MOVE      '0'           AR2(ÆY)
     C                   SUB       1             ÆY
     C                   ENDDO
      *
     C                   MOVEA     AR2           WRK              30
      *
     C     CHK99         ENDSR
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      'PRA'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      WUSER         TTUSER
     C   77              MOVEL     'Airwaybi'    XXTE16           16
     C   77              MOVE      'll print'    XXTE16
     C  N77              MOVEL     'House-ai'    XXTE16           16
     C  N77              MOVE      'rwaybill'    XXTE16
     C                   MOVEL     XXTE16        XXTE32           32
     C                   MOVEL     'printed '    XXTE16
     C                   MOVE      '(int)   '    XXTE16
     C                   MOVE      XXTE16        XXTE32
     C                   MOVEL     XXTE32        TTTEXT
     C                   MOVE      *BLANKS       XXTE32
     C                   MOVE      HEGN11        XXTE32
     C  N77              MOVEL     HEHAWB        XXTE32
     C                   MOVE      XXTE32        TTTEXT
n08  C   77              MOVEL     'Flyfrakt'    XXTE16           16
n08  C   77              MOVE      'brev int'    XXTE16
n08  C  N77              MOVEL     'Husfrakt'    XXTE16           16
n08  C  N77              MOVE      'brev    '    XXTE16
n08  C                   MOVEL     XXTE16        XXTE32           32
n08  C                   MOVEL     'printed '    XXTE16
n08  C                   MOVE      '(int)   '    XXTE16
n08  C                   MOVE      XXTE16        XXTE32
n08  C                   MOVEL     XXTE32        TTTEXL
n08  C                   MOVE      *BLANKS       XXTE32
n08  C                   MOVE      HEGN11        XXTE32
n08  C  N77              MOVEL     HEHAWB        XXTE32
n08  C                   MOVE      XXTE32        TTTEXL
     C                   WRITE     TRACKFR
     C                   ENDSR
     C***********************************************
     C     EDTOTH        BEGSR
     C***********************************************
      * EDITER 2 STRENGER MED OTHER CHARGES
     C                   CALL      'SYGE16R'
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFLOP
     C                   PARM                    DFFTO
     C                   PARM                    DFFT
N16  C                   PARM                    DFFT3
     C                   ENDSR
      *
     C***********************************************
     C     SUMOTH        BEGSR
     C***********************************************
     c
     C                   Z-ADD     0             wsbldc            9 2
     c                   setoff                                       66
      *
      * SUMMER OTHER CHARGES DUE CARRIER
      *
     C     HEADFK        SETLL     DOKOTH
     C     HEADFK        READE(N)  DOKOTH                                 66
     C     *in(66)       doweq     '0'
      *
     C     DO1332        IFEQ      'C'
     C                   ADD       DO1333        wsbldc
     C                   ENDIF
      *
     C     HEADFK        READE(N)  DOKOTH                                 66
     C  N66              ENDDO
      *oppdater til slutt
     C     DOKEFK        CHAIN     DOKEF                              44
     c  N44              z-add     wsbldc        dfbldc
     c  N44              update    dokefr
     C                   ENDSR
     C***********************************************
     C     SUMOTHA       BEGSR
     C***********************************************
      * summerer other charges due agent
      *
     C                   Z-ADD     0             wsblda            9 2
     c                   setoff                                       66
      *
      *
     C     HEADFK        SETLL     DOKOTH
     C     HEADFK        READE(N)  DOKOTH                                 66
     C     *in(66)       doweq     '0'
      *
     C     DO1332        IFEQ      'A'
     C                   ADD       DO1333        wsblda
     C                   ENDIF
      *
     C     HEADFK        READE(N)  DOKOTH                                 66
     C  N66              ENDDO
     C                   ENDSR
     c********************************************************
     C     avsend        begsr
     c********************************************************
     C                   MOVE      TLF           DFTLFS
     C                   move      syland        helks
     C     HELKS         IFEQ      *BLANKS
     C                   EVAL      HELKS='NO'
     C                   ENDIF
     c     vadrk         chain     vadr                               33
     C     *in33         ifeq      '0'                                            3<-B
     C                   MOVE      VADRNA        henas
     C                   MOVE      VADRN1        heADS1
     C                   MOVE      VADRN2        heADS2
     C                   MOVE      VADRN3        heADS3
     C     VALAND        IFNE      '  '
     C                   MOVE      VALAND        heLKS
     c                   end
     C                   else                                                     3<-E
     C                   MOVE      KNAVN         heNAS
     C                   MOVE      ADR1          heADS1
     C                   MOVE      ADR2          heADS2
     C                   MOVE      *BLANKS       heADS3
     C     POSTNR        IFEQ      0                                              3<-B
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          heADS3
     C                   ELSE                                                     3
     C                   MOVE      ENGAD3        heADS3
     C                   END
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        heADS3
     C                   MOVE      ADR3          heADS3
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C                   ENDSR                                                   2<-E
     c**************************************************
     c     fri           begsr
     c**************************************************
     C*
     C*
     C                   z-add     0             nrv               2 0
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XXSKKO            1
     C                   MOVE      'M'           XXSKKO
     C* SKRIVER FRIE LINJER
     C     FREETK        SETLL     FREETXT2
     C     FRIST         TAG
     C     FREETK        READE     FREETXT2                               91
     C  N91nrv           iflt      10
     c  N91              add       1             nrv
     c  N91              move      t25(nrv)      tx25
     C  N91              write     prtfrt
     C  N91              GOTO      FRIST
     c                   end
      *
      * skriver eventuellt resten av varetekstene
      *
     c                   add       1             nrv
s15  c*    nrv           iflt      8
n15  c     nrv           iflt      19
s15  c*    8             sub       nrv           nre               1 0
n15  c     13            sub       nrv           nre               2 0
     c     nrv           do        nre           nrv
     c     t25(nrv)      ifne      *blanks
     c                   MOVEL     t25(nrv)      TX25
N15  c     nrv           ifne      12
     C                   WRITE     PRTDE3
n15  c                   move      *blanks       TX25
n15  c                   end
     c                   end
     c                   end
     c                   end
     c                   endsr
     c*****************************************************
     c     ovlsr0        begsr
     c*****************************************************
     C                   MOVEL     'AW  '        OVL04             4
     C                   DO        9
     C                   EXSR      PRINT
     C                   MOVE      kopinr        OVL04
     C                   MOVEL     OVL04         AW01
     C                   write     ovl
     C                   ADD       1             KOPINR
     C                   END
     c                   endsr
     c*****************************************************
     c     ovlsr         begsr
     c*****************************************************
     C                   MOVEL     'AW  '        OVL04             4
     C                   MOVE      kopinr        OVL04
     C                   MOVEL     OVL04         AW01
     C                   write     ovl
     c                   endsr
     OMERKL1    E            MLAP             06
     O                       XGN1                 5
     O                       XGN2                 7
     O                       XGN3                 9
     O                       XGN4                12
     O                       XGN5                14
     O                       XGN6                16
     O                       XGN7                18
     O                       XGN8                21
     O                       XGN9                23
     O                       XGN10               25
     O                       XGN11               27
     O               77      DFNTT         Z     36
     O               77      DFVKTT        4     46
     O          E            MLAP             09
     O                       FL(1)                5
     O                       FL(2)                7
     O                       FL(3)                9
     O                       XFLY2               36
     O                       XFLY3               45
     O          E   N77      MLAP             12
     O                       XSDF1                5
     O                       XSDF2                7
     O                       XSDF3                9
     O                       XHAWB1              11
     O                       XHAWB2              13
     O                       XHAWB3              15
     O                       XHAWB4              17
     O                       XHAWB5              19
     O                       XHAWB6              21
     O                       DFNTT         Z     36
     O                       DFVKTT        4     46
     OMERKL2    E            MLAP2            04
     O                       HENAK               35
     O          E            MLAP2            06
     O                       HEADK1              35
     O          E            MLAP2            08
     O                       HEADK2              35
     O          E            MLAP2            10
     O                       HEADK3              35
