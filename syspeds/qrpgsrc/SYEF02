********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE FLYFRAKT-PRISER (KUNDE)   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-11 13-24             ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-64 71-90    ***
      ***                    95-97 99                         ***
      ***********************************************************
      *
     FVALUL01   IF   E           K DISK
     FKUFAST    IF   E           K DISK
     FKODTFFR   UF A E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYEF02FM  CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     C*
     C                   EXSR      INIT
     C*
     C     START0        TAG
S01  c*                  z-add     11            linnbr
S01  c*                  z-add     17            posnbr
N01  C  N04              z-add     11            linnbr
N01  C  N04              z-add     17            posnbr
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   SETOFF                                       9930
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
N01  C                   GOTO      START0
     C                   END
     c                   exsr      testb01
     C   30              GOTO      START0
      *
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   EXSR      MOVBY
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     KODFF1        SETLL     KODTFFR
     C     START1        TAG
     C     KEYEQU        READE(N)  KODTFFR                                94
      *
     C     START2        TAG
      *
     C  N94              DO
     c     w2sdf         ifne      *blanks
     c     w2sdf         andne     kffsdf
     c                   goto      start1
     c                   end
      *
     c     w2sdt         ifne      *blanks
     c     w2sdt         andne     kffsdt
     c                   goto      start1
     c                   end
      *
     C                   DO        15
     C                   ADD       1             ZRECNO
     c     keyfs         chain     kodtfs                             33
     C  N33              MOVEL     KFSNAV        WSNA
     C   33              MOVE      *BLANKS       WSNA
     C                   WRITE     SUBFIL
     c     lesny         tag
     C     KEYEQU        READE(N)  KODTFFR                                94
     c  n94w2sdf         ifne      *blanks
     c     w2sdf         andne     kffsdf
     c                   goto      lesny
     c                   end
      *
     c  n94w2sdt         ifne      *blanks
     c     w2sdt         andne     kffsdt
     c                   goto      lesny
     c                   end
      *
     C  N94              EXSR      MOVKY
     C  N94              END
     C                   END
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C*
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C                   SETOFF                                       98
     C*
     C*** EXIT
     C     ST41          TAG
     C   03              GOTO      Start0
     C*
     C*** REFRESH
     C   05              GOTO      START
     C*
     C*** CREATE
     C   06              GOTO      START5
     C*** SEARCH
     C   08              GOTO      START6
     C*
     C*** DELETE
     C   10              GOTO      START7
     C*** ROLL
     C   25              DO
     C                   SETOFF                                       2594
     C                   Z-ADD     YRECNO        ZRECNO
     C     KODFF3        SETLL     KODTFFR
     C     KEYEQU        READE(N)  KODTFFR                                94
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENT
     C   98              GOTO      START3
     C                   END
     C*
     C*** DELETE
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C                   EXFMT     VAREL3
     C  N12              DO
     C     KODFF2        CHAIN     KODTFFR                            33
     C  N33              DELETE    KODTFFRR
     C                   EXSR      MOVB1
     C                   MOVE      '*DEL '       KFFSDF
     C                   END
     C                   UPDATE    SUBFIL
     C                   GOTO      START3
     C                   END
     C*
     C*** CHANGE / CREATE
     C     START5        TAG
     C                   MOVE      22            LINNBR
     C  N30
     CANN04
     CANN40              Z-ADD     2             POSNBR
     C  N30
     CANN04
     CAN 40              Z-ADD     32            POSNBR
     C                   EXFMT     VARELI
     C                   SETOFF                                       30
     C                   MOVEA     '000000'      *IN(65)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   04              EXSR      SØKDTA
     C   04              GOTO      START5
     C   12              DO
     C   40              UPDATE    SUBFIL
     C                   SETOFF                                       40
     C                   EXSR      MOVB2
     C                   GOTO      START3
     C                   END
     C                   EXSR      TESTB1
     C   30              GOTO      START5
     C                   GOTO      START3
     C*
     C*** SEARCH
     C     START6        TAG
     C                   MOVE      22            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C                   GOTO      START
     C*
     C*** DELETE
     C     START7        TAG
     C                   EXFMT     DLTAVT
     C   12              GOTO      START3
     C  N05              GOTO      START7
     C                   EXSR      AVTSLETT
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
      *
      * N40 =  NY
      *
     C  N40              DO
     C*
     C*** TEST OM PRODUKTSKODE
     C                   MOVEL     WSPT          XUKOD
     C     KUFASK        CHAIN     KUFAST                             73
     C  N30*IN73         IFEQ      '1'
     C                   MOVE      'YBC0360'     MSGNR
     C                   SETON                                        30
     C                   END
      *
     C     WSSDF         CHAIN     STED2                              69
     C   69
     CANN30              MOVE      'SPS0012'     MSGNR
     C   69              SETON                                        30
     C     WSSDT         CHAIN     STED2                              68
     C   68
     CANN30              MOVE      'SPS0013'     MSGNR
     C   68              SETON                                        30
     C     WSKD          COMP      ' '                                    66
     C   66
     CANN30              MOVE      'SPK0025'     MSGNR
     C   66              SETON                                        30
     C     KODFFK        CHAIN     KODTFFR                            33
     C  N33              DO
     C                   MOVE      'SPK0024'     MSGNR
     C                   SETON                                        3067
     C                   END
     C                   END
      *
      * SLUTT NY RECORD
      *
     C*** TEST CURRANCYCODE
     C     WSVAL         IFNE      *BLANKS                                      1<-B
     C     KODVAK        CHAIN     VALUL01                            65
     C   65
     CANN30              MOVE      'SPV0001'     MSGNR
     C   65              SETON                                        30
     C                   END                                                    1<-E
      *
     C   30              GOTO      SLTB
     C*
     C*** UPDATE FILE AND SUBFILE
     C     KODFFK        CHAIN     KODTFFR                            33
     C                   EXSR      MOVWFF
     C  N33              UPDATE    KODTFFRR
     C   33              WRITE     KODTFFRR
     C   40              UPDATE    SUBFIL
     C  N40              DO
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     c     keyfs         chain     kodtfs                             33
     C  N33              MOVEL     KFSNAV        WSNA
     C   33              MOVE      *BLANKS       WSNA
     C                   WRITE     SUBFIL
     C                   END
     C                   WRITE     SUBCTL
     C                   SETOFF                                       40
     C                   EXSR      MOVB2
     C*
     C     SLTB          TAG
     C   30              DO
     C   65              Z-ADD     55            POSNBR
     C   67              Z-ADD     6             POSNBR
     C   66              Z-ADD     34            POSNBR
     C   68              Z-ADD     15            POSNBR
     C   69              Z-ADD     6             POSNBR
     C   70              Z-ADD     6             POSNBR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '2'
     C     KFFSDF        COMP      '*DEL '                                98
     C   98              GOTO      SLHENT
     C                   EXSR      MOVFFW
     C                   MOVE      ' '           WSNR
     C                   SETON                                        40
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '4'
     C     KFFSDF        COMP      '*DEL '                                98
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                        30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KFFKD
     C                   MOVE      *ZEROS        KFFLY
     C                   MOVE      *ZEROS        KFFKN
     C                   MOVE      *BLANKS       WSNA
     C                   MOVE      *BLANKS       KFFSDF
     C                   MOVE      *BLANKS       KFFSDT
     C                   MOVE      *ZEROS        KFFTVK
     C                   MOVE      *ZEROS        KFFBL
     C                   MOVE      *ZEROS        KFFBL2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSTVK
     C                   MOVE      *ZEROS        WSBL
     C                   MOVE      *ZEROS        WSBL2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVFFW        BEGSR
     C***********************************************
     C                   MOVE      KFFKD         WSKD
     C                   MOVE      KFFLY         WSFLY
     C                   MOVE      KFFPT         WSPT
     C                   MOVE      KFFVAL        WSVAL
     C                   MOVE      KFFKN         WSKN
     C                   MOVE      KFFSDF        WSSDF
     C                   MOVE      KFFSDT        WSSDT
     C                   MOVE      KFFTVK        WSTVK
     C                   MOVE      KFFBL         WSBL
     C                   MOVE      KFFBL2        WSBL2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWFF        BEGSR
     C***********************************************
     C   33              DO
     C                   MOVE      WSKD          KFFKD
     C                   MOVE      WSFLY         KFFLY
     C                   MOVE      WSPT          KFFPT
     C                   MOVE      WSKN          KFFKN
     C                   MOVE      WSSDF         KFFSDF
     C                   MOVE      WSSDT         KFFSDT
     C                   MOVE      WSTVK         KFFTVK
     C                   END
     C*
     C                   MOVE      WSBL          KFFBL
     C                   MOVE      WSBL2         KFFBL2
     C                   MOVE      WSVAL         KFFVAL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKN
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNRK
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     11            LINNBR
N01   *
N01  C     LINNBR        IFEQ      16
N01  C     POSNBR        ANDGE     17
N01  C     POSNBR        ANDLE     24
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNRK
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     20            LINNBR
N01  C                   Z-ADD     8             POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      11
N01  C     POSNBR        ANDGE     17
N01  C     POSNBR        ANDLE     24
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKN
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     16            LINNBR
N01  C                   Z-ADD     17            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C*
     C     POSNBR        IFEQ      2
     C                   MOVEL     WSPT          XUKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    XUTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XUKOD
     C                   MOVEL     XUKOD         WSPT
     C                   Z-ADD     5             POSNBR
     C                   GOTO      SLSØK
     C                   END
S01  C*    LINNBR        IFEQ      8
S01  C*    POSNBR        ANDGE     8
S01  C*    POSNBR        ANDLE     15
S01  C*                  EXSR      SØKKUN
S01  C*                  GOTO      SLSØK
S01  C*                  END
     C*
     C     POSNBR        IFGE      9
     C     POSNBR        ANDLE     13
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDF
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     57
     C                   MOVE      'J'           USØK              1
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSVAL
     C                   GOTO      SLSØK
     C                   END
     C*
     C     POSNBR        IFGE      15
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDT
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         TAG
     C   30ZRECNO        IFEQ      0
     C                   WRITE     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBY         BEGSR
     C***********************************************
     C                   MOVE      W2FLY         YFLY
     C                   MOVE      W2PT          YPT
     C                   MOVE      W2SDF         YSDF
     C                   MOVE      W2SDT         YSDT
     C                   MOVE      W2KD          YKD
     C                   MOVE      W2TVK         YTVK
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVKY         BEGSR
     C***********************************************
     C                   MOVE      KFFLY         YFLY
     C                   MOVE      KFFPT         YPT
     C                   MOVE      KFFKN         YKN
     C                   MOVE      KFFSDF        YSDF
     C                   MOVE      KFFSDT        YSDT
     C                   MOVE      KFFKD         YKD
     C                   MOVE      KFFTVK        YTVK
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C     KUFASK        KLIST
     C                   KFLD                    XUTYP
     C                   KFLD                    XUKOD
     C                   MOVEL     'PRODTYPE'    XUTYP
     C     *LIKE         DEFINE    KFTYP         XUTYP
     C     *LIKE         DEFINE    KFKOD         XUKOD
     C                   MOVE      'N'           UUPDAT            1
     C     *LIKE         DEFINE    KFTYP         XKFTYP
     C     *LIKE         DEFINE    KFKOD         XKFKOD
      *
     C     KEYFS         KLIST
     C                   KFLD                    KFUNI             2
     C                   KFLD                    KFFLY
     c                   move      'FS'          KFUNI
     C     KEYEQU        KLIST
     C                   KFLD                    WSKN
     C     KODFFK        KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    WSPT
     C                   KFLD                    WSFLY
     C                   KFLD                    WSSDF
     C                   KFLD                    WSSDT
     C                   KFLD                    WSKD
     C                   KFLD                    WSTVK
     C     KODFF1        KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    W2PT
     C                   KFLD                    W2FLY
     C                   KFLD                    W2SDF
     C                   KFLD                    W2SDT
     C                   KFLD                    W2KD
     C                   KFLD                    W2TVK
     C     KODFF2        KLIST
     C                   KFLD                    KFFKN
     C                   KFLD                    KFFPT
     C                   KFLD                    KFFLY
     C                   KFLD                    KFFSDF
     C                   KFLD                    KFFSDT
     C                   KFLD                    KFFKD
     C                   KFLD                    KFFTVK
     C     KODFF3        KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    YPT
     C                   KFLD                    YFLY
     C                   KFLD                    YSDF
     C                   KFLD                    YSDT
     C                   KFLD                    YKD
     C                   KFLD                    YTVK
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKN
     C     KUND1Kk       KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    wsknrk
     C     KUND12        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KFFKN
     C     KODVAK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSVAL
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C*
     C                   MOVE      *ZEROS        YFLY              3 0
     C                   MOVE      *blanks       YPT               1
     C                   MOVE      *ZEROS        YKN               8 0
     C                   MOVE      *BLANKS       YSDF              5
     C                   MOVE      *BLANKS       YSDT              5
     C                   MOVE      *BLANKS       YKD               1
     C                   MOVE      *ZEROS        YTVK              5 0
     C*
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
S01  C*                  MOVE      'DIV1188'     XMSGNR            7            MELDING-ID
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIVÅ
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    SOTXT1            8
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*                  MOVE      SOTXT1        SOTXT2            8
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB01       BEGSR
     C***********************************************
     c                   setoff                                       30
     C     KUND1K        CHAIN     CUNDL01                            99
     C   99              DO
     C                   MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   END
     C*
     C*** WSKNRK <> 0  -->  KOPIERING AV AVTALE
     C     WSKNRK        IFNE      0
     c                   setoff                                       33
     C     WSKN          SETLL     kodtffr
     C     wskn          READE(N)  kodtffr                                33
     C  N33              DO
     C                   MOVE      'SPK0048'     MSGNR
     C                   SETON                                        9930
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   END
     C*
     C     KUND1KK       CHAIN     CUNDL01                            97
     C   97              DO
     C                   MOVE      'SPK0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   END
     C* har fra kunde avtale
     C     wsknrk        SETLL     kodtffr
     c                   setoff                                       96
     C     wsknrk        READE(N)  kodtffr                                96
     C   96              DO
     C  N30              MOVE      'SPA0028'     MSGNR
     C  N30              Z-ADD     16            LINNBR
     C  N30              Z-ADD     17            POSNBR
     C                   SETON                                        3097
     C                   END
     C  N30              EXSR      AVTKP
     C                   END
     C  N30wsfra         ifne      *blanks
     C     wstil         andne     *blanks
     c     wsfra         andne     wstil
     c     wskn          andne     0
     c                   exsr      avtkp2
     c                   end
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     AVTKP         BEGSR
     C***********************************************
     c     keygt         klist
     c                   kfld                    wsknrk
     c                   kfld                    KFFPT
     c                   kfld                    KFFLY
     c                   kfld                    KFFSDF
     c                   kfld                    KFFSDT
     c                   kfld                    KFFKD
     c                   kfld                    KFFTVK
     c                   setoff                                       33
     C     wsknrk        SETLL     kodtffr
     c     *in33         doweq     '0'
     C     wsknrk        READE(N)  kodtffr                                33
     c     *in33         ifeq      '0'
     c                   move      wskn          KFFKN
     c                   write     kodtffrr
     c     keygt         setgt     kodtffr
     c                   end
     c                   end
     C*
     C                   ENDSR
     C***********************************************
     C     AVTKP2        BEGSR
     C***********************************************
     c                   setoff                                       33
     C     KEYEQU        SETLL     kodtffr
     c     *in33         doweq     '0'
     C     KEYEQU        READE(N)  kodtffr                                33
     c     *in33         ifeq      '0'
     c     kffsdf        andeq     wsfra
     c                   eval      kffsdf=wstil
     c                   write     kodtffrr
     c                   end
     c                   end
     C*
     C                   ENDSR
     C***********************************************
     C     AVTSLETT      BEGSR
     C***********************************************
     c                   setoff                                       33
     C     KEYEQU        SETLL     kodtffr
     c     *in33         doweq     '0'
     C     KEYEQU        READE     kodtffr                                33
     c     *in33         ifeq      '0'
     c                   delete    kodtffrr
     c                   end
     c                   end
     C*
     C                   ENDSR
