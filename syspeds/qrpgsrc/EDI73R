     FE101CR    IF   E             DISK
     FE101C     O  A E             DISK
     D RCVDTA          DS           500
     D  RCVDT1                 1    250
     D  RCVDT2               251    500
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1    250
     D                                     DIM(250)                             Input string
     D  ADS                    1    250
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1     80
     D                                     DIM(80)                              Output string
     D  RDATA                  1     80
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *__________________
      * Define Workfields
      *""""""""""""""""""
     C                   Z-ADD     0             AX                3 0          Index for A
     C                   Z-ADD     1             BX                3 0          Index for B
     C                   Z-ADD     0             AXV               3 0          Leftindx A
     C                   Z-ADD     0             AXH               3 0          Rightindx A
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRB                                                  SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *
     C                   READ      OSRCVD                                 51
     C     *IN51         DOWEQ     '0'
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     RCVDT1        ADS
     C     *IN61         IFEQ      '1'
     C                   Z-ADD     1             AXV
     C                   ELSE
     C     'UNB'         SCAN      ADS           AXV                      62
     C     *IN62         IFEQ      '0'
     C                   Z-ADD     1             AXV
     C                   ENDIF
     C                   MOVE      '1'           *IN61
     C                   END
     C                   Z-ADD     250           AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     RCVDT2        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     250           AXH
     C                   EXSR      SRÅ
      *
     C                   READ      OSRCVD                                 51
     C  N51              END
      *
     C     BX            IFGT      1
     C     RDATA         ANDNE     *BLANKS
     C                   WRITE     E101CRR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_______________
      * Find positions
      *""""""""""""""""
     C     SRÅ01         TAG
      *
     C     AXH           IFGT      AXV
     C     A(AXH)        ANDEQ     *BLANKS
     C                   SUB       1             AXH
     C                   GOTO      SRÅ01
     C                   ENDIF
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV
     C                   MOVE      A(AXV)        WCHAR
      * Move to output string
     C     WCHAR         IFGE      *BLANKS
     C                   MOVE      WCHAR         B(BX)
     C                   ADD       1             BX
     C                   ENDIF
      * If arrayindex for output array is over 80 Then add a record
     C     BX            IFGT      80
     C     WCHAR         OREQ      X'15'
     C                   WRITE     E101CRR
     C                   Z-ADD     1             BX
     C                   MOVE      *BLANKS       RDATA
     C                   ELSE
     C     BX            IFGT      1
     C     WCHAR         ANDEQ     X'15'
     C                   WRITE     E101CRR
     C                   Z-ADD     1             BX
     C                   MOVE      *BLANKS       RDATA
     C                   ENDIF
     C                   ENDIF
      *
     C                   ENDDO
      *
     C                   ENDSR
