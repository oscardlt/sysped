********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 ¯kt coverpage til 80 tegn
10XXX * 02 SH  PTF10 bane ¯kt til 140   gjort direkte uten merking
10XXX * 03 SH  PTF10 feil i datastruktur
10XXX * 04 SH  PTF10 byttet logisk fil for rekkef¯lge
10XXX * 05 SH  PTF10 bryter ved 30 vedlegg
10XXX * 06 SH  PTF10 eptex1 blank flytter eptex2 til venstre
10XXX * 07 SH  PTF10 utvidet arksrc
10XXX * 08 SH  PTF10 nye parametre
10XXX * 09 SH  PTF10 eptil ¯kt til 70
10XXX * 10 SH  PTF10 cvp¯kt + 4 nye
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      * 11 JOV PTF12 Datafelt i ARKSRC 80 -> 160
********************************************************************
      *
     Farklogh   O  A E             DISK
     Farklogd   O  A E             DISK
     Farklogt   UF a E           K DISK
     Farksrc    O    E             DISK
     F                                     RENAME(arksrc:arcdat)
s04  F*rkepo    IF   E           K DISK
n04  Farkepol2  uF   E           K DISK
N07  D CrLf            c                   x'0D25'
     D                 DS
     D  BA                     1   4200
     D                                     DIM(30)
     D  BANE1                  1    140
     D  BANE2                141    280
     D  BANE3                281    420
s03  D* BANE4                491    560
n03  D  BANE4                421    560
     D  BANE5                561    700
     D  BANE6                701    840
     D  BANE7                841    980
     D  BANE8                981   1120
     D  BANE9               1121   1260
     D  BAN10               1261   1400
     D  BAN11               1401   1540
     D  BAN12               1541   1680
     D  BAN13               1681   1820
     D  BAN14               1821   1960
     D  BAN15               1961   2100
     D  BAN16               2101   2240
     D  BAN17               2241   2380
     D  BAN18               2381   2520
     D  BAN19               2521   2660
     D  BAN20               2661   2800
     D  BAN21               2801   2940
     D  BAN22               2941   3080
     D  BAN23               3081   3220
     D  BAN24               3221   3360
     D  BAN25               3361   3500
     D  BAN26               3501   3640
     D  BAN27               3641   3780
     D  BAN28               3781   3920
     D  BAN29               3921   4060
     D  BAN30               4061   4200
     D                 DS
     D  eptext                 1     77
     D  eptex1                 1     15
     D  eptex2                16     75
     D                 DS
     D  XULTID                 1     14  0
     D  eptime                 1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XUL≈≈                 11     14  0
     D  XULDDMM                7     10  0
     D  XUL≈≈2                13     14  0
     D                 DS
     D  UL≈≈                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  epdate                 1      8  0
     D                 DS
s07  D* srcdta                 1     80
n07  D  srcdta                 1    160
s11  D* epdata                 1     80
n11  D  epdata                 1    160
     D  src008                 1      8
     D                SDS
     D  UUSER                254    263
     C     *ENTRY        PLIST
s10  C*                  PARM                    DATA2            40
s10  C*                  PARM                    DATA3            40
s10  C*                  PARM                    DATA4            40
s10  C*                  PARM                    DATA5            40
s10  C*                  PARM                    DATA6            40
s10  C*                  PARM                    DATA7            40
s10  C*                  PARM                    DATA8            40
n10  C                   PARM                    DATA2            80
n10  C                   PARM                    DATA3            80
n10  C                   PARM                    DATA4            80
n10  C                   PARM                    DATA5            80
n10  C                   PARM                    DATA6            80
n10  C                   PARM                    DATA7            80
n10  C                   PARM                    DATA8            80
n10  C                   PARM                    DATA9            80
n10  C                   PARM                    DATA10           80
n10  C                   PARM                    DATA11           80
n10  C                   PARM                    DATA12           80
     C                   PARM                    ie                1
s01  C*                  PARM                    epcove           40
n01  C                   PARM                    epcove           80
s09  C*                  PARM                    eptil            50
n09  C                   PARM                    eptil            70
     C                   PARM                    epauto            1
     C                   PARM                    Ubane1          140
     C                   PARM                    Ubane2          140
     C                   PARM                    Ubane3          140
     C                   PARM                    Ubane4          140
     C                   PARM                    Ubane5          140
     C                   PARM                    Ubane6          140
     C                   PARM                    Ubane7          140
     C                   PARM                    Ubane8          140
     C                   PARM                    Ubane9          140
     C                   PARM                    Uban10          140
     C                   PARM                    Uban11          140
     C                   PARM                    Uban12          140
     C                   PARM                    Uban13          140
     C                   PARM                    Uban14          140
     C                   PARM                    Uban15          140
     C                   PARM                    Uban16          140
     C                   PARM                    Uban17          140
     C                   PARM                    Uban18          140
     C                   PARM                    Uban19          140
     C                   PARM                    Uban20          140
     C                   PARM                    Uban21          140
     C                   PARM                    Uban22          140
     C                   PARM                    Uban23          140
     C                   PARM                    Uban24          140
     C                   PARM                    Uban25          140
     C                   PARM                    Uban26          140
     C                   PARM                    Uban27          140
     C                   PARM                    Uban28          140
     C                   PARM                    Uban29          140
     C                   PARM                    Uban30          140
n05  c                   PARM                    flere             1
      *
n08  c                   PARM                    av                4
n08  c                   PARM                    op                7
n08  c                   PARM                    tu                8
n08  c                   PARM                    ku                8
n08  c                   move      av            EPAVD
n08  c                   move      op            EPOPD
n08  c                   move      tu            EPTUR
n08  c                   move      ku            EPKUND
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XUL≈≈         UL≈≈
     c                   move      uuser         epuser
      *
      * henter neste teller
      *
     c                   move      'A'           eptelk
     c     keytel        klist
     c                   kfld                    eptelk
     c     keytel        chain     arklogt                            33
     c                   add       1             epunik
     c  N33              update    arklogtr
     c   33              write     arklogtr
      *
      * skriver f¯rste loggpost
      *
     c                   movel     epcove        srcdta
n05  c     flere         ifeq      'J'
n05  C     'continue'    scan      epcove                                 35
n05  c  N35srcdta        cat       'continue':2  srcdta
n05  c  N35epcove        cat       'continue':2  epcove
n05  c                   end
n05  c                   move      'N'           flere
     c                   write     arkloghr
     c                   write     arklogdr
      *
      * skriver linker
      *
s04  c*    uuser         setll     arkepo
n04  c     uuser         setll     arkepol2
     c     *in(33)       doueq     '1'
s04  c*    uuser         reade     arkepo                                 33
n04  c     uuser         reade     arkepol2                               33
N05  c  N33epn           ifeq      30
N05  c                   move      'J'           flere
n05  c                   seton                                        33
n05  c                   end
     c     *in(33)       ifeq      '0'
     C     EPBANE        ifne      *blanks
     c     epn           andlt     30
     c                   add       1             epn               2 0
     c                   move      epbane        ba(epn)
     c                   end
      *
     c                   move      *blanks       srcdta
n05  c                   delete    arkepor
n05  c     eptext        ifne      *blanks
n06  c     eptext        andne     '.'
N06  c     eptex1        ifeq      *blanks
N06  c                   movel     eptex2        SRCDTA
N06  c                   else
     C                   MOVEl     eptext        SRCDTA
N06  c                   end
     c                   add       1             srcseq
     C                   WRITE     arcdat
     c                   write     arklogdr
n05  c                   end
     c                   move      *blanks       srcdta
     C     EPBANE        ifeq      *blanks
     c     ie            ifeq      'I'
     C                   MOVEl     eplink        SRCDTA
n02  C                   MOVE      eplink        SR0072           72
     c                   else
     C                   MOVEl     epline        SRCDTA
n02  C                   MOVE      epline        SR0072
     c                   end
     c                   end
     c                   add       1             srcseq
n05  c     srcdta        ifne      *blanks
     C                   WRITE     arcdat
     c                   write     arklogdr
n05  c                   end
n02  c     sr0072        ifne      *blanks
n02  c                   eval      srcdta=sr0072
n02  c                   add       1             srcseq
n02  C                   WRITE     arcdat
n02  c                   write     arklogdr
n02  c                   end
     c                   end
     c                   end
      *
     c                   move      *blanks       srcdta
      *
     C     DATA2         IFNE      *BLANKS
     c                   add       1             srcseq
     C                   MOVEL     DATA2         SRCDTA
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
     C     DATA3         IFNE      *BLANKS
     c                   add       1             srcseq
     C                   MOVEL     DATA3         SRCDTA
     c                   add       1             srcseq
      * lagt punktum for linjeskift
     c     src008        ifeq      '.       '
     c                   move      *blanks       srcdta
     c                   end
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
     C     DATA4         IFNE      *BLANKS
N06  C     DATA4         andne     '.'
     c                   add       1             srcseq
     C                   MOVEL     DATA4         SRCDTA
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
     C     DATA5         IFNE      *BLANKS
N06  C     DATA5         andne     '.'
     c                   add       1             srcseq
     C                   MOVEL     DATA5         SRCDTA
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
     C     DATA6         IFNE      *BLANKS
N06  C     DATA6         andne     '.'
     c                   add       1             srcseq
     C                   MOVEL     DATA6         SRCDTA
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
     C     DATA7         IFNE      *BLANKS
N06  C     DATA7         andne     '.'
     c                   add       1             srcseq
     C                   MOVEL     DATA7         SRCDTA
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
     C     DATA8         IFNE      *BLANKS
N06  C     DATA8         andne     '.'
     c                   add       1             srcseq
     C                   MOVEL     DATA8         SRCDTA
     C                   WRITE     arcdat
     c                   write     arklogdr
     C                   END
n10  C     DATA9         IFNE      *BLANKS
n10  C     DATA9         andne     '.'
n10  c                   add       1             srcseq
n10  C                   MOVEL     DATA9         SRCDTA
n10  C                   WRITE     arcdat
n10  c                   write     arklogdr
n10  C                   END
n10  C     DATA10        IFNE      *BLANKS
n10  C     DATA10        andne     '.'
n10  c                   add       1             srcseq
n10  C                   MOVEL     DATA10        SRCDTA
n10  C                   WRITE     arcdat
n10  c                   write     arklogdr
n10  C                   END
n10  C     DATA11        IFNE      *BLANKS
n10  C     DATA11        andne     '.'
n10  c                   add       1             srcseq
n10  C                   MOVEL     DATA11        SRCDTA
n10  C                   WRITE     arcdat
n10  c                   write     arklogdr
n10  C                   END
n10  C     DATA12        IFNE      *BLANKS
n10  C     DATA12        andne     '.'
n10  c                   add       1             srcseq
n10  C                   MOVEL     DATA12        SRCDTA
n10  C                   WRITE     arcdat
n10  c                   write     arklogdr
n10  C                   END
     C                   MOVE      BANE1         UBANE1
     C                   MOVE      BANE2         UBANE2
     C                   MOVE      BANE3         UBANE3
     C                   MOVE      BANE4         UBANE4
     C                   MOVE      BANE5         UBANE5
     C                   MOVE      BANE6         UBANE6
     C                   MOVE      BANE7         UBANE7
     C                   MOVE      BANE8         UBANE8
     C                   MOVE      BANE9         UBANE9
     c                   MOVE      BAN10         UBAN10
     C                   MOVE      BAN11         UBAN11
     C                   MOVE      BAN12         UBAN12
     C                   MOVE      BAN13         UBAN13
     C                   MOVE      BAN14         UBAN14
     C                   MOVE      BAN15         UBAN15
     C                   MOVE      BAN16         UBAN16
     C                   MOVE      BAN17         UBAN17
     C                   MOVE      BAN18         UBAN18
     C                   MOVE      BAN19         UBAN19
     C                   MOVE      BAN20         UBAN20
     C                   MOVE      BAN21         UBAN21
     C                   MOVE      BAN22         UBAN22
     C                   MOVE      BAN23         UBAN23
     C                   MOVE      BAN24         UBAN24
     C                   MOVE      BAN25         UBAN25
     C                   MOVE      BAN26         UBAN26
     C                   MOVE      BAN27         UBAN27
     C                   MOVE      BAN28         UBAN28
     C                   MOVE      BAN29         UBAN29
     C                   MOVE      BAN30         UBAN30
     c     bane1         ifne      *blanks
     c                   movel     'attached '   EPDATA
     c                   eval      EPDATA = 'attachment'
     c                   add       1             srcseq
     c                   write     arklogdr
S02  c*    1             do        9             nr                2 0
n02  c     1             do        30            nr                2 0
     c     ba(nr)        ifne      *blanks
     c                   movel     ba(nr)        EPDATA
s11  c*                  move      ba(nr)        EP0060           60
     c                   write     arklogdr
s11   * lenke lenger enn 80 tegn
s11  c*    ep0060        ifne      *blanks
s11  c*                  eval      epdata=EP0060
s11  c*                  write     arklogdr
s11  c*                  end
     c                   end
     c                   end
     c                   end
     C                   SETON                                        LR
     C                   RETURN
