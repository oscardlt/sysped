      *
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE E.F. MANIFEST (GoodsItem)   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-02 06-08 10 11 13-26
      *** LEDIGE INDIKATORER 27-29 31 32 34-48 50-81          ***
      ***********************************************************
      *
     FSADEXIL1  UF A E           K DISK
Njov FSADEXHL1  IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FTARI      IF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FSAD166D   CF   E             WORKSTN INFDS(FBAREA)
     D                SDS
     D  UUSR                 254    263
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
      *
     C                   EXSR      INIT
      *...............................................
      * BILDE-1 INNLESING AV HOVED OPPLYSNINGER AV TUR
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '000000000000'*IN(88)
sjov C*                  MOVE      '0'           *IN87
njov C                   MOVE      '00'          *IN86
     C                   EVAL      *IN30 = *OFF
      *
      *  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ UT
     C   12              GOTO      SLUTT
      *
      * ----------- T E S T   B I L D E 0 1 ----------
     C                   EXSR      TESTB1
     C   30              GOTO      START
      *
     C                   EXSR      OPDOPD
      *
     C     SLUTT         TAG
     C                   SELECT
     C                   WHEN      *IN12
     C                   EVAL      UFLAGG = 1
     C                   OTHER
     C                   EVAL      UFLAGG = 0
     C                   ENDSL
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * SØK
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     16
     C                   MOVE      '749'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSGTY         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSGTY
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     51
     C                   CALL      'SAD061F'
     C                   PARM                    WSVAL
     C                   PARM                    XDT
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     16
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLK
     C                   PARM                    USPED
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     76
     C                   MOVE      '017'         TKUNIK
     C                   MOVEL     WSNTEH        TKKODE
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     TKKODE        WSNTEH
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     44
     C                   MOVE      '756'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSROE         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSROE
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     23
     C                   MOVE      '719'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSCKD         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSCKD
     C                   Z-ADD     40            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     47
     C                   MOVE      WSVNT         UVNT              8
     C                   CALL      'SAD062A'
     C                   PARM                    UVNT
     C                   PARM                    XDT
     C                   MOVE      UVNT          WSVNT
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     61            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   MOVE      '750'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSPTYP        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSPTYP
     C                   Z-ADD     62            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     62
     C     POSNBR        ANDLE     63
     C                   CALL      'SYFI10L'
     C                   PARM                    WSPLK
     C                   PARM                    USPED
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     18
     C                   MOVE      '751'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSPTM         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSPTM
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      * Godstype
     C**   WSGTY         COMP      *BLANKS                                99
     C                   if        WSGTY <> *blanks
     C                   EVAL      TKUNIK = '749'
     C                   EVAL      TKKODE =WSGTY
     C     TRKODL01K     CHAIN     TRKODL01                           99
     c                   endif
      * Beløp
     C     WSBL          COMP      0                                      98
      * Varebeskrivelse
     C     WSVAL         CHAIN     KODTVAL2                           97
      * Opprinnelses land
     C                   EVAL      KS2LK = WSLK
     C     KODTS2K       CHAIN     KODTS2                             96
      * Merking
     C**   WSMK          COMP      *BLANKS                                95
      * Kolli enhet
     C*                  IF        WSNT <> 0 OR WSNTEH <> *BLANKS
     C                   EVAL      TKUNIK = '017'
     C                   EVAL      TKKODE = WSNTEH
     C     TRKODL01K     CHAIN     TRKODL01                           94
     C*                  END
      * UCR
sjov C*    WSUCR         COMP      *BLANKS                                88
sjov C                   setoff                                       88
      * Økonomioperatørs rolle
     C                   IF        WSROE <> *BLANKS
     C                   EVAL      TKUNIK = '756'
     C                   EVAL      TKKODE = WSROE
     C     TRKODL01K     CHAIN     TRKODL01                           87
     C                   END
      * Varebeskrivelse
     C     WSVT          COMP      *BLANKS                                93
      * Tariffnr
     C     WSVNT         CHAIN     TARI                               92
      * Brutto og nettovekt
     C     WSCVKB        COMP      0                                      91
     C   90WSCVKN        COMP      0                                      91
      *
     C                   SELECT
     C                   WHEN      WSCVKB = 0 AND WSCVKN <> 0
     C                   EVAL      WSCVKB = WSCVKN * 1,1
     C                   WHEN      WSCVKN = 0 AND WSCVKB <> 0
     C                   EVAL      WSCVKN = WSCVKN * 0,9
     C                   ENDSL
      * Farligods enhet
     C                   IF        WSUNNR <> *BLANKS
     C     WSUNIT        COMP      *BLANKS                            90
     C                   END
      * Passiv kjøretøy nasjonalitet
     C                   IF        WSPMRK <> *BLANKS OR WSPLK <> *BLANKS
     C                   EVAL      KS2LK = WSPLK
     C     KODTS2K       CHAIN     KODTS2                             89
     C                   END
njov C                   if        EHPRT = 'TRANSIT_IMPORT'
njov C     WSLIT         COMP      *zeros                                 86
njov C                   endif
      *
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG          BEGSR
      ***********************************************
     C   99              DO
     C                   MOVE      'YBC2173'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   98
     CANN30              DO
     C                   MOVE      'YBC2174'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   END
      *
     C   97
     CANN30              DO
     C                   MOVE      'SPV0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   END
      *
     C   96
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   95
     CANN30              DO
     C                   MOVE      'YBC2175'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   END
      *
     C   94
     CANN30              DO
     C                   MOVE      'YBC2176'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     75            POSNBR
     C                   END
      *
     C   88
     CANN30              DO
     C                   MOVE      'YBC2191'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   87
     CANN30              DO
     C                   MOVE      'YBC2192'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     42            POSNBR
     C                   END
      *
     C   93
     CANN30              DO
     C                   MOVE      'YBC2177'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   92
     CANN30              DO
     C                   MOVE      'YBC2178'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     40            POSNBR
     C                   END
      *
     C   91
     CANN30              DO
     C                   MOVE      'SPV0002'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     61            POSNBR
     C                   END
      *
     C   90
     CANN30              DO
     C                   MOVE      'YBC2179'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   END
      *
     C   89
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     62            POSNBR
     C                   END
      *
njov C   86
njov CANN30              DO
njov C                   MOVE      'JOV1802'     MSGNR
njov C                   SETON                                        30
njov C                   Z-ADD     15            LINNBR
njov C                   Z-ADD     52            POSNBR
njov C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVEXW        BEGSR
      ***********************************************
     C                   EVAL      WSLI    = EILI
     C                   EVAL      WSLIT   = EILIT
      *
     C                   EVAL      WSGTY   = EIGTY
     C                   EVAL      WSBL    = EIBL
     C                   EVAL      WSVAL   = EIVAL
     C                   EVAL      WSLK    = EILK
      *
     C                   EVAL      WSMK    = EIMK
     C                   EVAL      WSNT    = EINT
     C                   EVAL      WSNTEH  = EINTEH
      *
     C                   EVAL      WSUCR   = EIUCR
     C                   EVAL      WSRGE   = EIRGE
     C                   EVAL      WSROE   = EIROE
      *
     C                   EVAL      WSVT    = EIVT
     C                   EVAL      WSCKD   = EICKD
     C                   EVAL      WSVNT   = EIVNT
     C                   EVAL      WSCVKB  = EICVKB
     C                   EVAL      WSCVKN  = EICVKN
      *
     C                   EVAL      WSUNNR  = EIUNNR
     C                   EVAL      WSUNIT  = EIUNIT
      * Passiv kjøretøy
     C                   EVAL      WSPMRK  = EIPMRK
     C                   EVAL      WSPTYP  = EIPTYP
     C                   EVAL      WSPLK   = EIPLK
     C                   EVAL      WSPTM   = EIPTM
     C                   EVAL      WSPTMT  = EIPTMT
      *
     C                   EVAL      WSCNR   = EICNR
      *
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWEX        BEGSR
      ***********************************************
     C                   EVAL      EILI    = WSLI
     C                   IF        EILID   = 0
     C                   EVAL      EILID   = WSLI
     C                   END
     C                   EVAL      EILIT   = WSLIT
      *
     C                   EVAL      EIGTY   = WSGTY
     C                   EVAL      EIBL    = WSBL
     C                   EVAL      EIVAL   = WSVAL
     C                   EVAL      EILK    = WSLK
      *
     C                   EVAL      EIMK    = WSMK
     C                   EVAL      EINT    = WSNT
     C                   EVAL      EINTEH  = WSNTEH
      *
     C                   EVAL      EIUCR   = WSUCR
     C                   EVAL      EIRGE   = WSRGE
     C                   EVAL      EIROE   = WSROE
      *
     C                   EVAL      EIVT    = WSVT
     C                   EVAL      EICKD   = WSCKD
     C                   EVAL      EIVNT   = WSVNT
     C                   EVAL      EICVKB  = WSCVKB
     C                   EVAL      EICVKN  = WSCVKN
      *
     C                   EVAL      EIUNNR  = WSUNNR
     C                   EVAL      EIUNIT  = WSUNIT
      * Passiv kjøretøy
     C                   EVAL      EIPMRK  = WSPMRK
     C                   EVAL      EIPTYP  = WSPTYP
     C                   EVAL      EIPLK   = WSPLK
     C                   EVAL      EIPTM   = WSPTM
     C                   EVAL      EIPTMT  = WSPTMT
      *
     C                   EVAL      EICNR   = WSCNR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVSAW        BEGSR
      ***********************************************
     C                   EVAL      EIPRO   = UPRO
     C                   EVAL      EIAVD   = UAVD
     C                   EVAL      EITDN   = UTDN
     C                   EVAL      WSLI    = EILI
     C                   EVAL      WSLIT   = 0
     C                   EVAL      EIST    = *BLANKS
      *
     C                   EVAL      WSGTY   = *BLANKS
     C                   EVAL      WSBL    = 0
     C                   EVAL      WSVAL   = *BLANKS
     C                   EVAL      WSLK    = *BLANKS
      *
     C                   EVAL      WSMK    = *BLANKS
     C                   EVAL      WSNT    = 0
     C                   EVAL      WSNTEH  = *BLANKS
      *
     C                   EVAL      WSUCR   = *BLANKS
     C                   EVAL      WSRGE   = *BLANKS
     C                   EVAL      WSROE   = *BLANKS
      *
     C                   EVAL      WSVT    = *BLANKS
     C                   EVAL      WSCKD   = *BLANKS
     C                   EVAL      WSVNT   = 0
     C                   EVAL      WSCVKB  = 0
     C                   EVAL      WSCVKN  = 0
      *
     C                   EVAL      WSUNNR  = *BLANKS
     C                   EVAL      WSUNIT  = *BLANKS
      * Passiv kjøretøy
     C                   EVAL      WSPMRK  = *BLANKS
     C                   EVAL      WSPTYP  = *BLANKS
     C                   EVAL      WSPLK   = *BLANKS
     C                   EVAL      WSPTM   = *BLANKS
     C                   EVAL      WSPTMT  = *BLANKS
      *
     C                   EVAL      WSCNR   = *BLANKS
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDOPD        BEGSR
      ***********************************************
      *
     C     SADEXIL1K     CHAIN     SADEXIL1                           33
     C                   IF        *IN33
     C                   MOVE      'A'           XOPDEXIF          1
     C                   ELSE
     C                   MOVE      'U'           XOPDEXIF
     C                   END
      *
      * FLYTTER SKJERMVARIABLE TIL FILVARIABLE
      *
     C                   EXSR      MOVWEX
      *
     C                   SELECT
     C                   WHEN      XOPDEXIF = 'U'
     C                   UPDATE    SADEXIFR
     C                   WHEN      XOPDEXIF = 'A'
     C                   WRITE     SADEXIFR
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C                   EVAL      KS2UNI = 'S2'
     C     TRKODL01K     KLIST
     C                   KFLD                    TKUNIK
     C                   KFLD                    TKKODE
     C                   EVAL      TKUNIK = '017'
     C     SADEXIL1K     KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    EILI
     C     SADEXIL1KM1   KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    EILI
     C     SADEXIL1KM2   KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPRO              8 0
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    ULI               5 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVE      WDT           XDT               8 0
     C                   MOVE      'N'           USPED             1
      *
     C     UTYPE         COMP      'DSP'                                  49
      *
njov C     SADEXIL1KM2   chain     SADEXHL1
     C                   IF        UTYPE = 'DSP' OR UTYPE = 'CHG'
     C                   MOVE      ULI           EILI
     C     SADEXIL1K     CHAIN(N)  SADEXIL1                           33
     C                   EXSR      MOVEXW
     C                   ELSE
     C                   EVAL      EILI = 99999
     C     SADEXIL1KM1   SETLL     SADEXIL1
     C     SADEXIL1KM2   READPE(N) SADEXIL1                               33
     C                   IF        *IN33
     C                   EVAL      EILI = 1
     C                   ELSE
     C                   EVAL      EILI = EILI + 1
     C                   END
     C                   EXSR      MOVSAW
     C                   END
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
