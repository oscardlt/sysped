      *
      *    OPPDATER STATISTIKK
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 JOV PTF12 Update direkte på FAK3 i leseloop (ikke chain via fakt i fall dupl. lnr)
      *              kall syst35 uansett rufsete, tar første ved dupliket, MEN unngår OMMAT og OMMAT
      * 02 jov PTF12 Reverserer 01 (subprog syst35 OGSÅ UPDATE/recordlås) NÅ= lesesloop på FAKT
********************************************************************
     FFAKT      UF   E           K DISK
     FFAK3      IF   E           K DISK
     F                                     RENAME(FAKTR:FAKT3R)
     FKODTV     IF   E           K DISK
     FHEAD1     UF   E           K DISK
     FSTATREK   IF   E           K DISK
      *
      * HVIS REGENERERING AV STATISTIKK ER PÅ GANG, HOPP UT
     C     'A'           CHAIN     STATREK                            33
     C  N33STRST         COMP      'F'                                    33
     C  N33              SETON                                        LR
     C  N33              RETURN
      *
     C     FAKTKO        KLIST
     C                   KFLD                    FAAVD
     C                   KFLD                    FAOPD
     C                   KFLD                    FALI
     C     FAK3K         KLIST
     C                   KFLD                    YOPKO             1
     C                   KFLD                    FAFAKT
     C                   KFLD                    FAKUNR
     C                   KFLD                    FAAVD
     C                   KFLD                    FAOPD
     C                   MOVE      'T'           YOPKO
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C     HEAD1K        KLIST
     C                   KFLD                    KOVAVD
     C                   KFLD                    YST               1
     C                   MOVE      'T'           YST
     C     HEADFK        KLIST
     C                   KFLD                    FAAVD
     C                   KFLD                    FAOPD
      *
     C                   MOVE      *ZEROS        FAFAKT
     C                   MOVE      *ZEROS        FAKUNR
     C                   MOVE      'N'           XXOPD             1
     C                   MOVE      'N'           UEND              1
     C                   MOVE      'N'           UTREKK            1
      *
      * OPPDATER BASERT PÅ FAKTURALINJER
      * (Hvis oppd. ikke er stat.beh. før oppdateres også ant,vekt..)
     C     FAK3K         SETLL     FAK3                               33
      *
     C     START         TAG
     C     YOPKO         READE     FAK3                                   33
     C  N33              DO                                                     1<-B
     C                   EXSR      OPDSTA
S01  C*    FAKTKO        CHAIN     FAKT                               32
S01  C* N32              MOVE      'O'           FAOPKO
S01  C* N32              EXCEPT    OPDFAK
N01  C     FAKTKO        SETLL     FAKT
N01  C     FAKTKO        READE     FAKT
N01  C                   DOW       not %eof(fakt)
N01  C                   MOVE      'O'           FAOPKO
N01  C                   EXCEPT    OPDFAK
N01  C     FAKTKO        READE     FAKT
N01  C                   ENDDO
      *
     C                   GOTO      START
     C                   END                                                    1<-E
      *
      * OPPDATER ANTALL OG VEKT AV 0-OPPDRAG PÅ STATISTIKK
      * OPPDATER ANTALL OG VEKT AV 0-OPPDRAG PÅ STATISTIKK
     C                   MOVE      'J'           XXOPD
     C                   MOVE      *ZEROS        FALI
     C     KODTVK        SETLL     KODTV                              33
     C     START2        TAG
     C                   READ      KODTV                                  33
     C   33              GOTO      SLUTT
      *
     C     HEAD1K        SETLL     HEAD1                              34
     C     START3        TAG
     C     HEAD1K        READE     HEAD1                                  34
     C  N34              DO
     C                   MOVE      'O'           HEST
     C                   EXCEPT    OPDHE1
     C                   MOVE      HEAVD         FAAVD
     C                   MOVE      HEOPD         FAOPD
     C                   EXSR      OPDSTA
     C                   GOTO      START3
     C                   END
     C                   GOTO      START2
     C* ET SISTE KALL MED "J" I UEND KUN FOR Å CLOSE FILER (SETT LR)
     C     SLUTT         TAG
     C                   MOVE      'J'           UEND              1
     C                   EXSR      OPDSTA
      *
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     OPDSTA        BEGSR
     C***********************************************
     C                   CALL      'SYST35'
     C                   PARM                    FAAVD
     C                   PARM                    FAOPD
     C                   PARM                    FALI
     C                   PARM                    XXOPD
     C                   PARM                    UEND
     C                   PARM                    UTREKK
     C*
     C                   ENDSR
     C*
     OFAKTR     E            OPDFAK
     O                       FAOPKO
     OHEADFR    E            OPDHE1
     O                       HEST
