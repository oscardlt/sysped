/* BLUEFAX        */
             PGM        PARM(&IN07 &IN08 &BPARM)
             DCL        VAR(&UFAX) TYPE(*CHAR) LEN(1) VALUE('J')
             DCL        VAR(&BPARM) TYPE(*CHAR) LEN(442)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&JOBN) TYPE(*CHAR) LEN(6)
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
             DCL        VAR(&TX) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&PRTNAV) TYPE(*CHAR) LEN(10) +
                          VALUE('SYEF30P ')
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('T')
             DCL        VAR(&FAXNR) TYPE(*CHAR) LEN(21)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4) VALUE('0000')
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7) VALUE('0000000')
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8) VALUE('00000000')
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNAVN) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNA12) TYPE(*CHAR) LEN(12)
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) /* Hvis &in01 +
                          på, betyr det avslutt program fra +
                          avdelingsvalg. */
             DCL        VAR(&IN07) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in07 på, betyr uten oppdatering. */
             DCL        VAR(&IN08) TYPE(*LGL) LEN(1) VALUE('1') /* +
                          Hvis &in08 på, betyr prøve manifest. */
             DCL        VAR(&FAKT) TYPE(*CHAR) LEN(1) /* Hvis &FAKT +
                          på, betyr at det skal kjøre faktura */
             DCL        VAR(&JBK) TYPE(*CHAR) LEN(1) /* Jobbkø. */
             CHGVAR     VAR(&PRANT) VALUE(%SST(&BPARM 1 2))
             CHGVAR     VAR(&FAXNR) VALUE(%SST(&BPARM 3 21))
             CHGVAR     VAR(&DOKNA12) VALUE(%SST(&BPARM 24 12))
             CHGVAR     VAR(&MAPPE) VALUE(%SST(&BPARM 36 20))
             CHGVAR     VAR(&PTIME) VALUE(%SST(&BPARM 56 8))
             CHGVAR     VAR(&PDATE) VALUE(%SST(&BPARM 64 8))
             CHGVAR     VAR(&NAVN) VALUE(%SST(&BPARM 72 30))
             CHGVAR     VAR(&AVD) VALUE(%SST(&BPARM 102 4))
             CHGVAR     VAR(&OPD) VALUE(%SST(&BPARM 106 7))
             CHGVAR     VAR(&TUR) VALUE(%SST(&BPARM 113 8))
             CHGVAR     VAR(&KODE) VALUE(%SST(&BPARM 121 1))
             CHGVAR     VAR(&CVP1) VALUE(%SST(&BPARM 122 40))
             CHGVAR     VAR(&CVP2) VALUE(%SST(&BPARM 162 40))
             CHGVAR     VAR(&CVP3) VALUE(%SST(&BPARM 202 40))
             CHGVAR     VAR(&CVP4) VALUE(%SST(&BPARM 242 40))
             CHGVAR     VAR(&CVP5) VALUE(%SST(&BPARM 282 40))
             CHGVAR     VAR(&CVP6) VALUE(%SST(&BPARM 322 40))
             CHGVAR     VAR(&CVP7) VALUE(%SST(&BPARM 362 40))
             CHGVAR     VAR(&CVP8) VALUE(%SST(&BPARM 402 40))
             CHGVAR     VAR(&CVP) VALUE(%SST(&BPARM 442 1))
                                                          /**/

             OVRPRTF    FILE(SYEF30P) DEVTYPE(*SCS) PAGESIZE(70 80) +
                          LPI(6) CPI(10) OUTQ(FAX/FAXOUT) +
                          FORMTYPE(*STD)

             RTVJOBA    NBR(&JOBN)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &JOBN)
             RMVM       FILE(SUMMAN) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(SUMMAN) MBR(&UNIK)
             MONMSG     MSGID(CPF7306)
             OVRDBF     FILE(SUMMAN) TOFILE(SUMMAN) MBR(&UNIK)
             RMVM       FILE(SUMMAN) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(SUMMAN) MBR(&UNIK)
             MONMSG     MSGID(CPF7306)
             OVRDBF     FILE(SUMMAN) TOFILE(SUMMAN) MBR(&UNIK)
             RMVM       FILE(SUMMAN) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(SUMMAN) MBR(&UNIK)
             MONMSG     MSGID(CPF7306)
             OVRDBF     FILE(SUMMAN) TOFILE(SUMMAN) MBR(&UNIK)
             CALL       PGM(SYEK30) PARM(&IN07 &IN08 &PRANT &UFAX)
             RMVM       FILE(SUMMAN) MBR(&UNIK)
    /* ----------------------------------------------------------- */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&DOKNA12) VALUE(&DOKNAVN)
             CHGVAR     VAR(&MAPPE) VALUE(&QUSER)
             CHGVAR     VAR(&DOKNA12) VALUE(&PRTNAV)

             IF         COND(&CVP = 'J') THEN(FAX/SNDFAXSPLF +
                          FILE(&DOKNA12) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST) RCP((&FAXNR *N &NAVN)) +
                          CPGPAG(*DFT) CPGTXT(&CVP1 &CVP2 &CVP3 +
                          &CVP4 &CVP5 &CVP6 &CVP7 &CVP8))
             ELSE       CMD(FAX/SNDFAXSPLF FILE(&DOKNA12) +
                          JOB(&QNBR/&QUSER/&QJOB) SPLNBR(*LAST) +
                          RCP((&FAXNR *N &NAVN)))


             CALL       PGM(FAX013) PARM(&QUSER &QNBR &QJOB +
                          &FAXNR &DOKNA12 &MAPPE &PTIME &PDATE +
                          &NAVN &AVD &OPD &TUR &KODE)
    /* */
                                                          /**/
SLUTT:       ENDPGM
