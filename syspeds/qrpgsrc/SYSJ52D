      *
      *****************************************************************
      *** PROGRAM SKAL SPØRRE PÅ BILL OF LADING (LOKAL)             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 02 04-09 13-26                         ***
      *** LEDIGE INDIKATORER 27-32 34-99                            ***
      *****************************************************************
      *
     FBOOKING   IF   E           K DISK
     FBLLOK     IF   E           K DISK
     FSYSJ52FD  CF   E             WORKSTN
     D                 DS
     D  BODTRÅ                 1      4  0
     D  BODTRM                 5      6  0
     D  BODTRD                 7      8  0
     D  BODTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  BODTOÅ                 1      4  0
     D  BODTOM                 5      6  0
     D  BODTOD                 7      8  0
     D  BODTO                  1      8  0
     D                 DS
     D  WSDTOD                 1      2  0
     D  WSDTOM                 3      4  0
     D  WSDTOÅ                 5      6  0
     D  WSDTO                  1      6  0
     D                 DS
     D  BODTLÅ                 1      4  0
     D  BODTLM                 5      6  0
     D  BODTLD                 7      8  0
     D  BODTL                  1      8  0
     D                 DS
     D  WSDTLD                 1      2  0
     D  WSDTLM                 3      4  0
     D  WSDTLÅ                 5      6  0
     D  WSDTL                  1      6  0
     D                 DS
     D  BODTTÅ                 1      4  0
     D  BODTTM                 5      6  0
     D  BODTTD                 7      8  0
     D  BODTT                  1      8  0
     D                 DS
     D  WSDTTD                 1      2  0
     D  WSDTTM                 3      4  0
     D  WSDTTÅ                 5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  BODTPÅ                 1      4  0
     D  BODTPM                 5      6  0
     D  BODTPD                 7      8  0
     D  BODTP                  1      8  0
     D                 DS
     D  WSDTPD                 1      2  0
     D  WSDTPM                 3      4  0
     D  WSDTPÅ                 5      6  0
     D  WSDTP                  1      6  0
     D                 DS
     D  BODTEÅ                 1      4  0
     D  BODTEM                 5      6  0
     D  BODTED                 7      8  0
     D  BODTE                  1      8  0
     D                 DS
     D  WSDTED                 1      2  0
     D  WSDTEM                 3      4  0
     D  WSDTEÅ                 5      6  0
     D  WSDTE                  1      6  0
     D                 DS
     D  BODTSÅ                 1      4  0
     D  BODTSM                 5      6  0
     D  BODTSD                 7      8  0
     D  BODTS                  1      8  0
     D                 DS
     D  WSDTSD                 1      2  0
     D  WSDTSM                 3      4  0
     D  WSDTSÅ                 5      6  0
     D  WSDTS                  1      6  0
     D                 DS
     D  BODTBÅ                 1      4  0
     D  BODTBM                 5      6  0
     D  BODTBD                 7      8  0
     D  BODTB                  1      8  0
     D                 DS
     D  WSDTBD                 1      2  0
     D  WSDTBM                 3      4  0
     D  WSDTBÅ                 5      6  0
     D  WSDTB                  1      6  0
     D                 DS
     D  BODTAÅ                 1      4  0
     D  BODTAM                 5      6  0
     D  BODTAD                 7      8  0
     D  BODTA                  1      8  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAÅ                 5      6  0
     D  WSDTA                  1      6  0
     D                 DS
     D  BEDTÅ                  1      4  0
     D  BEDTM                  5      6  0
     D  BEDTD                  7      8  0
     D  BEDT                   1      8  0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                UDS
     D  UFIRM                  1      2
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     C*
     C   01
     COR 03
     COR 12              GOTO      SLUTT
     C   10
     COR 11              DO
     C                   EXSR      TILV
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      3                                      03
     C  N01
     CANN03              GOTO      START
     C                   GOTO      SLUTT
     C                   END
     C*
     C                   Z-ADD     0             UFLAGG
     C*
     C     SLUTT         TAG
     C   01              Z-ADD     1             UFLAGG
     C   03              Z-ADD     3             UFLAGG
     C   12              Z-ADD     9             UFLAGG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TILV          BEGSR
     C***********************************************
     C                   MOVE      WSDTR         UDTR              6 0
     C   11              GOTO      STTV2
     C*
     C     STTV1         TAG
     C                   CALL      'SYSJ52E'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UDTR
     C                   PARM                    BOSG
     C                   PARM                    BOUKE
     C                   PARM                    BOAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      6
     C                   GOTO      STTV2
     C                   ELSE
     C                   GOTO      SLTV
     C                   END
     C*
     C     STTV2         TAG
     C                   CALL      'SYSJ52F'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UDTR
     C                   PARM                    BOSG
     C                   PARM                    BOUKE
     C                   PARM                    BOAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      5
     C                   GOTO      STTV1
     C                   END
     C*
     C     SLTV          ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BOOKK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     BLLOKK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
     C                   Z-ADD     0             UFLAGG
     C*
     C                   MOVE      *ZEROS        BODTR
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        BODTO
     C                   MOVE      *ZEROS        WSDTO
     C                   MOVE      *ZEROS        BODTL
     C                   MOVE      *ZEROS        WSDTL
     C                   MOVE      *ZEROS        BODTT
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        BODTP
     C                   MOVE      *ZEROS        WSDTP
     C                   MOVE      *ZEROS        BODTE
     C                   MOVE      *ZEROS        WSDTE
     C                   MOVE      *ZEROS        BODTS
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        BODTB
     C                   MOVE      *ZEROS        WSDTB
     C                   MOVE      *ZEROS        BODTA
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      *ZEROS        BEDT
     C                   MOVE      *ZEROS        WSDT
     C*
     C     BOOKK         CHAIN     BOOKING                            33
     C     BLLOKK        CHAIN     BLLOK                              33
     C                   EXSR      KDTFMT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BODTRD        UDT1              2 0
     C                   MOVE      BODTRM        UDT2              2 0
     C                   MOVE      BODTRÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   MOVE      BODTOD        UDT1              2 0
     C                   MOVE      BODTOM        UDT2              2 0
     C                   MOVE      BODTOÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTOD
     C                   MOVE      UDT2          WSDTOM
     C                   MOVE      UDT3          WSDTOÅ
     C*
     C                   MOVE      BODTLD        UDT1              2 0
     C                   MOVE      BODTLM        UDT2              2 0
     C                   MOVE      BODTLÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTLD
     C                   MOVE      UDT2          WSDTLM
     C                   MOVE      UDT3          WSDTLÅ
     C*
     C                   MOVE      BODTTD        UDT1              2 0
     C                   MOVE      BODTTM        UDT2              2 0
     C                   MOVE      BODTTÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTTD
     C                   MOVE      UDT2          WSDTTM
     C                   MOVE      UDT3          WSDTTÅ
     C*
     C                   MOVE      BODTPD        UDT1              2 0
     C                   MOVE      BODTPM        UDT2              2 0
     C                   MOVE      BODTPÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTPD
     C                   MOVE      UDT2          WSDTPM
     C                   MOVE      UDT3          WSDTPÅ
     C*
     C                   MOVE      BODTED        UDT1              2 0
     C                   MOVE      BODTEM        UDT2              2 0
     C                   MOVE      BODTEÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTED
     C                   MOVE      UDT2          WSDTEM
     C                   MOVE      UDT3          WSDTEÅ
     C*
     C                   MOVE      BODTSD        UDT1              2 0
     C                   MOVE      BODTSM        UDT2              2 0
     C                   MOVE      BODTSÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTSD
     C                   MOVE      UDT2          WSDTSM
     C                   MOVE      UDT3          WSDTSÅ
     C*
     C                   MOVE      BODTBD        UDT1              2 0
     C                   MOVE      BODTBM        UDT2              2 0
     C                   MOVE      BODTBÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTBD
     C                   MOVE      UDT2          WSDTBM
     C                   MOVE      UDT3          WSDTBÅ
     C*
     C                   MOVE      BODTAD        UDT1              2 0
     C                   MOVE      BODTAM        UDT2              2 0
     C                   MOVE      BODTAÅ        UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTAD
     C                   MOVE      UDT2          WSDTAM
     C                   MOVE      UDT3          WSDTAÅ
     C*
     C                   MOVE      BEDTD         UDT1              2 0
     C                   MOVE      BEDTM         UDT2              2 0
     C                   MOVE      BEDTÅ         UDT3              2 0
     C                   EXSR      KDTFM2
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
