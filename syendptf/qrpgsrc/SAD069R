********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 sh  PTF12 tar høyde for omberegninger
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL LISTE OPP DAGSOPPGJØR MED TOLL, MVA OG AVGIFT **
      *****************************************************************
      *
     FEDIM8     IF   E           K DISK
     FSADH      IF   E           K DISK
n01  FSADHOM    IF   E           K DISK
N01  F                                     RENAME(SADHR:SADHROM)
     FFRISOK    IF   E           K DISK
     FKALENDER  IF   E           K DISK
     FSAD069D   CF   E             WORKSTN USROPN
     FSAD069P   O    E             PRINTER OFLIND(*IN27)
     D                SDS
     D  UUSR                 254    263
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTA                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTA                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  XIDAGD                 1      2  0
     D  XIDAGM                 3      4  0
     D  XIDAGA                 5      6  0
     D  XIDAG                  1      6  0
     D                 DS
     D  WDTA                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D  WDT                    1      8
     D                 DS
     D  FSSOK                  1     35
     D  FSSOK20                1     20
N01  D                 DS
N01  D  BE                     1    220s 2
N01  D                                     DIM(20)                              I/O. oppd.type
N01  D  SIBL01                 1     11S 2
N01  D  SIBL02                12     22S 2
N01  D  SIBL03                23     33S 2
N01  D  SIBL04                34     44S 2
N01  D  SIBL05                45     55S 2
N01  D  SIBL06                56     66S 2
N01  D  SIBL07                67     77S 2
N01  D  SIBL08                78     88S 2
N01  D  SIBL09                89     99S 2
N01  D  SIBL10               100    110S 2
N01  D  SIBL11               111    121S 2
N01  D  SIBL12               122    132S 2
N01  D  SIBL13               133    143S 2
N01  D  SIBL14               144    154S 2
N01  D  SIBL15               155    165S 2
N01  D  SIBL16               166    176S 2
N01  D  SIBL17               177    187S 2
N01  D  SIBL18               188    198S 2
N01  D  SIBL19               199    209S 2
N01  D  SIBL20               210    220S 2
N01  D                 DS
N01  D  KO                     1     40
N01  D                                     DIM(20)                              I/O. oppd.type
N01  D  SITY01                 1      2
N01  D  SITY02                 3      4
N01  D  SITY03                 5      6
N01  D  SITY04                 7      8
N01  D  SITY05                 9     10
N01  D  SITY06                11     12
N01  D  SITY07                13     14
N01  D  SITY08                15     16
N01  D  SITY09                17     18
N01  D  SITY10                19     20
N01  D  SITY11                21     22
N01  D  SITY12                23     24
N01  D  SITY13                25     26
N01  D  SITY14                27     28
N01  D  SITY15                29     30
N01  D  SITY16                31     32
N01  D  SITY17                33     34
N01  D  SITY18                35     36
N01  D  SITY19                37     38
N01  D  SITY20                39     40
      *
     C                   EXSR      INIT
      *
     C                   IF        UBATCH <> 'J'
     C                   OPEN      SAD069D
      *
     C     START         TAG
     C                   EXFMT     BILDE
     C                   EVAL      *IN99 = *OFF
     C                   EVAL      *IN30 = *OFF
     C   03              GOTO      SLUTT
      *
     C                   MOVE      WSDTD         XDAG              2 0
     C                   MOVE      WSDTM         XMND              2 0
     C                   MOVE      WSDTA         XAAR              2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDAG
     C                   PARM                    XMND
     C                   PARM                    XAAR
     C                   PARM                    FLAGG             1 0
     C                   IF        FLAGG = 1
     C                   EVAL      *IN99 = *ON
     C                   EVAL      *IN30 = *ON
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      START
     C                   END
      *
     C                   CLOSE     SAD069D
     C                   EVAL      XDTA = 2000 + WSDTA
     C                   EVAL      XDTM = WSDTM
     C                   EVAL      XDTD = WSDTD
     C                   END
      *
      *
     C                   WRITE     SAD069P01
     C                   EVAL      TOPD = 0
     C                   EVAL      TTOL = 0
     C                   EVAL      TMVA = 0
     C                   EVAL      TAVG = 0
     C     XDT           SETLL     EDIM8
     C     XDT           READE     EDIM8                                  33
     C                   DOW       *IN33 = *OFF
s01  C*                  IF        M1001 = '929' AND M1N07 = 'DTK'
n01  C                   IF        M1001 = '929'
n01  C                   IF        M1N07 = 'DTK' OR M1N07 = 'DEB'
     C     SADHK         CHAIN     SADH                               33
n01  C                   IF        M1N07 = 'DEB'
N01  C     SADHK         CHAIN     SADHOM                             33
n01  c                   move      *zeros        sibel5
n01  c                   move      *zeros        sibel6
n01  c                   move      *zeros        sibel7
N01  c     1             do        20            nr                2 0
N01  c     ko(nr)        ifeq      'MV'
N01  c                   add       be(nr)        sibel6
n01  c                   else
n01  c                   add       be(nr)        sibel5
n01  c                   end
n01  c                   end
n01  C                   Z-ADD     SIBLTT        SIBEL7
n01  c                   z-sub     MTDN          MTDN
n01  C                   END
S01  C* N33              IF        SIST = 'P' AND SIKDDK = 'D' AND
N01  C  N33              IF        SIST = 'P' AND SIKDDK = 'D'
     C                   IF        SIBEL7 >= 50 OR SIBEL7 <= -50
     C     FRISOKK       CHAIN     FRISOK                             33
     C   33              EVAL      FSSOK = *BLANKS
     C   27              WRITE     SAD069P01
     C   27              EVAL      *IN27 = *OFF
     C                   WRITE     SAD069P02
     C                   EVAL      TOPD = TOPD + 1
     C                   EVAL      TTOL = TTOL + SIBEL5
     C                   EVAL      TMVA = TMVA + SIBEL6
     C                   EVAL      TAVG = TAVG + SIBEL7
     C                   END
     C                   END
n01  C                   END
n01  C                   END
     C     XDT           READE     EDIM8                                  33
     C                   ENDDO
      *
     C   27              WRITE     SAD069P01
     C   27              EVAL      *IN27 = *OFF
     C                   WRITE     SAD069P03
      *
     C     SLUTT         TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     SADHK         KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C     FRISOKK       KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C                   KFLD                    FSKODE
      *
     C     *ENTRY        PLIST
     C                   PARM                    UBATCH            1
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM               6
     C                   MOVE      WDTA          XIDAGA
     C                   MOVE      WDTM          XIDAGM
     C                   MOVE      WDTD          XIDAGD
     C                   MOVE      WDT           XDT
     C     XDT           CHAIN     KALENDER                           33
     C                   READP     KALENDER                               33
     C                   MOVE      KADATE        XDT
     C                   MOVE      XDTA          WSDTA
     C                   MOVE      XDTM          WSDTM
     C                   MOVE      XDTD          WSDTD
     C                   EVAL      FSKODE = '*CR'
      *
     C                   ENDSR
      *
