********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 beregne turkostnader med kode C i wsnr
10XXX * 02 SH  PTF10 nytt dangerous goods logikk
10XXX * 03 YBC PTF10 OPPDATER 4 PÅ STATUS VED BÅTKODE=*ALL
10XXX * 04 SH  PTF10 FÅ MED FLIGHT DETAILS
10027 * 05 YBC PTF10 ORDRETYPE
10XXX * 06 YBC PTF10 HENT NY TRIP STATUS ETTER UTSKRIFT PROF.FAKTURA
10XXX * 07 YBC PTF10 SKRIV ORDRETYPE PÅ MERKELAPP
10XXX * 08 YBC PTF10 NYE OPSJONER M OG T
10XXX * 09 SH  PTF10 awbno fra fri søkevei
10XXX * 10 SH  PTF10 bilde står ved endring fritekst
10XXX * 11 YBC PTF10 LOGG ENDRINGER AV GSSTRF
10027 * 12 YBC PTF10 ORDRETYPE, RETTELSE PÅ ENDRING 5
10217 * 13 YBC PTF10 FLERE DEFAULT PRINTER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 14 YBC PTF11 MANGLE PARAMETER VED KALL AV GSS033R
11XXX * 15 SH  PTF11 fjerner bølanke før og etter slasjer i fritekst flight
11XXX * 16 YBC PTF11 TØM GSS035W FØR OPPDATERING
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED PROFORMAFAKTURA
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 04 06-22 24
      *** LEDIGE INDIKATORER 28 29 32 34-40 48-89 95-97
      **************************************************************
      *
N09  FFRISOK    IF   E           K DISK
     FHEADF     IF   E           K DISK
N04  FDOKEF     IF   E           K DISK
     FGSS035W   UF A E           K DISK    USROPN
     FGSSOLL01  IF   E           K DISK
     FGSSTRF    UF   E           K DISK
     FGSSTRL11  IF   E           K DISK
     F                                     RENAME(GSSTRFR:GSSTRF11)
     FGSSTRL12  IF   E           K DISK
     F                                     RENAME(GSSTRFR:GSSTRF12)
     FGSSTRL13  IF   E           K DISK
     F                                     RENAME(GSSTRFR:GSSTRF13)
     FGSSTRL14  IF   E           K DISK
     F                                     RENAME(GSSTRFR:GSSTRF14)
     FGSSTRL15  IF   E           K DISK
     F                                     RENAME(GSSTRFR:GSSTRF15)
     FGSSTRL16  IF   E           K DISK
     F                                     RENAME(GSSTRFR:GSSTRF16)
     FGSSBIF    IF   E           K DISK
     FGSSCGF    IF   E           K DISK
N08  FGSSRFF    IF A E           K DISK
N08  FGSSORL21  IF   E           K DISK    RENAME(GSSORFR:GSSORF21)
     FGSSORL22  IF   E           K DISK
     FGSSPOF    IF   E           K DISK
N11  FGSSLGTF   O  A E             DISK
     FCDBOAT    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FGSS030D   CF   E             WORKSTN
     F                                     SFILE(GSS030DA:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D XFT01           C                   CONST('DEL. BY:')
     D XFT02           C                   CONST('TRUCK NO:')
     D XFT03           C                   CONST('AWBNO:')
     D                 DS
     D  XFT11                  1     10
     D  XFT12                 13     27
     D  WSFT1                  1     70
     D                 DS
     D  XFT21                  1     10
     D  XFT22                 13     19
     D  XFT23                 20     20
     D  XFT24                 21     28
     D  XFT25                 13     27
     D  WSFT2                  1     70
     D                 DS
     D  TRAD1                  1     30
     D  XTRAD1                 1     28
     D                 DS
     D  TRDTLÅ                 1      4  0
     D  TRDTLM                 5      6  0
     D  TRDTLD                 7      8  0
     D  TRDTL                  1      8  0
     D                 DS
     D  WXDTLD                 1      2  0
     D  WXDTLM                 3      4  0
     D  WXDTLÅ                 5      6  0
     D  WXDTL                  1      6  0
     D                 DS
     D  TRDTSÅ                 1      4  0
     D  TRDTSM                 5      6  0
     D  TRDTSD                 7      8  0
     D  TRDTS                  1      8  0
     D                 DS
     D  WXDTSD                 1      2  0
     D  WXDTSM                 3      4  0
     D  WXDTSÅ                 5      6  0
     D  WXDTS                  1      6  0
     D                 DS
     D  ORDTLÅ                 1      4  0
     D  ORDTLM                 5      6  0
     D  ORDTLD                 7      8  0
     D  ORDTL                  1      8  0
     D                 DS
     D  UPDTLD                 1      2
     D  UPDTLM                 3      4
     D  UPDTLÅ                 5      6
     D  UPDTL                  1      6
     D                 DS
     D  UPO                    1   1000    DIM(50)
     D  UPCON1                 1     20
     D  UPCON2                21     40
     D  UPCON3                41     60
     D  UPCON4                61     80
     D  UPCON5                81    100
     D  UPCON6               101    120
     D                 DS
     D  OLMN                   1     35
     D  OLMN01                 1      1
     D  OLMN02                 1      2
     D  OLMN03                 3      4
     D                SDS
     D  UUSER                254    263
     D SAVUDS         UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UBIUSI               101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
N13  D  UBIPRP               149    158
N13  D  UBIPRI               159    168
      *
     C                   EXSR      INIT
     C   33              GOTO      SLUTT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN(93)
     C                   WRITE     GSS030DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *BLANKS       WSNR
     C                   MOVE      *ZEROS        XTNO             11 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C                   EXSR      LESREC
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C                   MOVE      TRDTLD        WXDTLD
     C                   MOVE      TRDTLM        WXDTLM
     C                   MOVE      TRDTLÅ        WXDTLÅ
     C                   MOVE      TRDTSD        WXDTSD
     C                   MOVE      TRDTSM        WXDTSM
     C                   MOVE      TRDTSÅ        WXDTSÅ
     C                   WRITE     GSS030DA
     C                   MOVE      ZRECNO        XRECNO            5 0
     C                   EXSR      LESREC
     C  N94              END
     C                   END
      *
     C     START3        TAG
     C  N30              Z-ADD     5             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS030DG
     C                   ELSE
     C                   WRITE     GSS030DC
     C                   EXFMT     GSS030DB
     C                   END
      *
      *** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C     W2BCD         IFEQ      *BLANKS
     C     W2CNO         ANDEQ     0
     C                   GOTO      START3
     C                   END
     C                   END
     C   05              GOTO      START
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C  N94XTNO          CHAIN(N)  GSSTRF                             25
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      *BLANKS                                      1<-B
     C     W2TNO         ORNE      0
     C     W2BCD         ORNE      *BLANKS
     C     W2CNO         ORNE      0
     C     W2NR          IFEQ      *BLANKS                                       2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2TNO         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'GSS0047'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYOPT
     C                   END                                                      3<-E
     C                   MOVE      *ZEROS        W2TNO
     C                   MOVE      *BLANKS       W2BCD
     C                   MOVE      *ZEROS        W2CNO
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HHENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     YTNO          COMP      0                                  4141
     C   41              GOTO      SLTB2
     C     YBCD          COMP      *BLANKS                            4242
     C   42              GOTO      SLTB2
     C     YCNO          COMP      0                                  4343
     C   43              GOTO      SLTB2
      *
     C     SLTB2         TAG
     C   41UBICNO        IFNE      0
     C                   MOVE      '0'           *IN41
     C                   MOVE      '1'           *IN44
     C                   ELSE
     C     UBICGR        IFNE      *BLANKS
     C                   MOVE      '0'           *IN41
     C                   MOVE      '1'           *IN46
     C                   END
     C                   END
     C   42UBICNO        IFNE      0
     C                   MOVE      '0'           *IN42
     C                   MOVE      '1'           *IN45
     C                   ELSE
     C     UBICGR        IFNE      *BLANKS
     C                   MOVE      '0'           *IN42
     C                   MOVE      '1'           *IN47
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        YTNO
     C                   MOVE      *BLANKS       YBCD
     C                   MOVE      *ZEROS        YCNO
     C     W2TNO         IFNE      0
     C                   MOVE      W2TNO         YTNO
     C                   END
     C     W2BCD         IFNE      *BLANKS
     C                   MOVE      W2BCD         YBCD
     C                   END
     C     W2CNO         IFNE      YCNO
     C     UBICNO        IFNE      0
     C                   MOVE      UBICNO        W2CNO
     C                   END
     C                   MOVE      W2CNO         YCNO
     C                   END
      *
     C                   MOVE      *ZEROS        W2TNO
     C                   MOVE      *BLANKS       W2BCD
     C                   MOVE      *ZEROS        W2CNO
      *
     C                   MOVEA     '0000000'     *IN(41)
     C                   EXSR      TESTB
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYOPT         BEGSR
     C***********************************************
     C     W2TNO         CHAIN(N)  GSSTRF                             98
     C  N98TRST          IFNE      '2'
     C     TRST          COMP      '3'                                9898
     C                   END
     C   98              MOVE      'GSS0048'     MSGNR
     C   98              GOTO      SLOPT
     C     UBICGR        IFNE      *BLANKS                                      1<-B
     C     TRCNO         CHAIN     GSSCGF                             98
     C  N98CGCG          COMP      UBICGR                             9898
     C   98              MOVE      'GSS0029'     MSGNR
     C   98              GOTO      SLOPT
     C                   END                                                    1<-E
     C     UBICNO        IFNE      0                                            1<-B
     C     UBICNO        ANDNE     TRCNO
     C                   MOVE      '1'           *IN98
     C                   MOVE      'GSS0030'     MSGNR
     C                   GOTO      SLOPT
     C                   END                                                    1<-E
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    '1'
     C     TRST          ANDGE     '2'
     C                   EXSR      CHGTR
     C     W2NR          WHENEQ    '2'
     C     TRST          ANDGE     '2'
     C                   EXSR      EDTTR
     C     W2NR          WHENEQ    '5'
     C                   EXSR      DSPTR
     C     W2NR          WHENEQ    '6'
     C     TRST          ANDGE     '2'
     C                   EXSR      PRTTR
     C     W2NR          WHENEQ    '7'
     C                   EXSR      CPYPL
     C     W2NR          WHENEQ    '9'
     C     TRST          ANDEQ     '3'
     C                   EXSR      CFMTR
     C     W2NR          WHENEQ    'P'
     C                   EXSR      PLKTR
N02  C     W2NR          WHENEQ    'D'
N02  C                   EXSR      DGSR
     C     W2NR          WHENEQ    'A'
     C                   EXSR      arkivsr
     C     W2NR          WHENEQ    'I'
     C                   EXSR      BOXINF
     C     W2NR          WHENEQ    'L'
     C                   EXSR      PRTML
N01  C     W2NR          WHENEQ    'C'
N01  C                   EXSR      BERFAK
N01  C  N90              MOVE      *BLANKS       WSNR
N01  C  N90              UPDATE    GSS030DA
N08  C     W2NR          WHENEQ    'M'
N08  C                   MOVE      ' '           XRTMJA
N08  C                   EXSR      GETMRN
     C                   OTHER
     C                   MOVE      'GSS0009'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDSL
      *
     C     SLOPT         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *BLANKS       W2NR
      *
     C                   ENDSR
      *
     C***********************************************
     C     HHENT         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVE      '0'           *IN99
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS030DA                               98
     C   98              DO
     C   99              MOVE      '0'           *IN98
     C                   GOTO      SLHENT
     C                   END
      *
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              1 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C     TRTNO         CHAIN(N)  GSSTRF                             33
     c     trst          ifeq      'X'
     c     wsnr          ifeq      '2'
     c     wsnr          oreq      '1'
     C                   MOVE      'GSS0070'     MSGNR
     c                   SETON                                        9830
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS030DA
     C                   GOTO      SLHENT
     c                   end
     c                   end
     C                   SELECT
     C     WSNR          WHENEQ    '1'
     C     TRST          ANDGE     '2'
     C                   EXSR      CHGTR
     C     WSNR          WHENEQ    '2'
     C     TRST          ANDGE     '2'
     C                   EXSR      EDTTR
     C     WSNR          WHENEQ    '5'
     C                   EXSR      DSPTR
     C     WSNR          WHENEQ    '6'
     C     TRST          ANDGE     '2'
     C                   EXSR      PRTTR
     C     WSNR          WHENEQ    '7'
     C                   EXSR      CPYPL
     C     WSNR          WHENEQ    '9'
     C     TRST          ANDEQ     '3'
     C                   EXSR      CFMTR
     C     WSNR          WHENEQ    'P'
     C                   EXSR      PLKTR
N02  C     WSNR          WHENEQ    'D'
N02  C                   EXSR      DGSR
     C     WSNR          WHENEQ    'A'
     C                   EXSR      arkivsr
     C     WSNR          WHENEQ    'I'
     C                   EXSR      BOXINF
     C     WSNR          WHENEQ    'L'
     C                   EXSR      PRTML
     C     WSNR          WHENEQ    'B'
     C                   EXSR      PRTBML
N01  C     WSNR          WHENEQ    'C'
N01  C                   EXSR      BERFAK
N01  C  N90              MOVE      *BLANKS       WSNR
N01  C  N90              UPDATE    GSS030DA
N08  C     WSNR          WHENEQ    'M'
N08  C                   MOVE      ' '           XRTMJA
N08  C                   EXSR      GETMRN
N08  C     WSNR          WHENEQ    'T'
N08  C                   EXSR      PRTLABEL
     C                   OTHER
     C                   MOVE      '1'           *IN98
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS030DA
     C                   GOTO      SLHENT
     C                   ENDSL
     C                   MOVE      '1'           *IN99
      *
     C                   END
      *
     C     SLHENT        TAG
     C                   MOVE      '0'           *IN99
     C   98MSGNR         IFEQ      *BLANKS
     C                   MOVE      'GSS0009'     MSGNR
     C                   END
     C   98              MOVE      '1'           *IN30
     C  N30              Z-ADD     5             LINNBR
     C   30              ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C   41YTNO          IFEQ      99999999999
     C     GTRK01        SETGT     GSSTRL11
     C                   ELSE
     C     GTRK01        SETLL     GSSTRL11
     C                   END
     C   42GTRK02        SETGT     GSSTRL12
     C   43GTRK03        SETGT     GSSTRL13
     C   44YTNO          IFEQ      99999999999
     C     GTRK04        SETGT     GSSTRL13
     C                   ELSE
     C     GTRK04        SETLL     GSSTRL13
     C                   END
     C   45GTRK05        SETGT     GSSTRL14
     C   46YTNO          IFEQ      99999999999
     C     GTRK06        SETGT     GSSTRL15
     C                   ELSE
     C     GTRK06        SETLL     GSSTRL15
     C                   END
     C   47GTRK07        SETGT     GSSTRL16
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
     C     STLF          TAG
     C   41YTNO          IFEQ      99999999999
     C                   READP     GSSTRL11                               94
     C                   ELSE
     C                   READ      GSSTRL11                               94
     C                   END
     C   42YBCD          READPE    GSSTRL12                               94
     C   43YCNO          READPE    GSSTRL13                               94
     C   44YTNO          IFEQ      99999999999
     C     UBICNO        READPE    GSSTRL13                               94
     C                   ELSE
     C     UBICNO        READE     GSSTRL13                               94
     C                   END
     C   45GTRX05        READPE    GSSTRL14                               94
     C   46YTNO          IFEQ      99999999999
     C     UBICGR        READPE    GSSTRL15                               94
     C                   ELSE
     C     UBICGR        READE     GSSTRL15                               94
     C                   END
     C   47GTRX07        READPE    GSSTRL16                               94
     C  N94              MOVE      TRTNO         XTNO
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     GTRK01        KLIST
     C                   KFLD                    YTNO
     C     *LIKE         DEFINE    TRTNO         YTNO
     C     GTRK02        KLIST
     C                   KFLD                    YBCD
     C                   KFLD                    YTNO2
     C     *LIKE         DEFINE    TRBCD         YBCD
     C     *LIKE         DEFINE    TRTNO         YTNO2
     C                   Z-ADD     99999999999   YTNO2
     C     GTRK03        KLIST
     C                   KFLD                    YCNO
     C                   KFLD                    YTNO2
     C     *LIKE         DEFINE    TRCNO         YCNO
     C     GTRK04        KLIST
     C                   KFLD                    UBICNO
     C                   KFLD                    YTNO
     C     GTRK05        KLIST
     C                   KFLD                    UBICNO
     C                   KFLD                    YBCD
     C                   KFLD                    YTNO2
     C     GTRX05        KLIST
     C                   KFLD                    UBICNO
     C                   KFLD                    YBCD
     C     GTRK06        KLIST
     C                   KFLD                    UBICGR
     C                   KFLD                    YTNO
     C     GTRK07        KLIST
     C                   KFLD                    UBICGR
     C                   KFLD                    YBCD
     C                   KFLD                    YTNO2
     C     GTRX07        KLIST
     C                   KFLD                    UBICGR
     C                   KFLD                    YBCD
     C     KODVAK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSCUR
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSKNC
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ORCNO
      *
     C                   MOVE      '2'           UMODE             1
     C                   MOVE      'P'           WSNYL
     C                   MOVE      'N'           WSFAX
     C                   MOVE      'N'           WSCOMM
     C     UBIUSI        CHAIN     GSSBIF                             33
     C     *IN33         IFEQ      '0'
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      *ZEROS        WXDTL
     C                   MOVE      *ZEROS        WXDTS
     C                   MOVE      *ZEROS        TRDTL
     C                   MOVE      *ZEROS        TRDTS
     C                   Z-ADD     1             WSCPY
     C     *DTAARA       DEFINE    *LDA          SAVUDS
     C                   IN        SAVUDS
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      FICURR        UCURR
     C                   MOVE      BICGR         UBICGR
     C                   MOVE      BICNO         UBICNO
     C                   MOVE      BIFC          UBIFC
     C                   MOVE      BIPRT         UBIPRT
     C                   MOVE      BIPRTM        UBIPRM
N13  C                   MOVE      BIPRTP        UBIPRP
N13  C                   MOVE      BIPRTI        UBIPRI
     C                   OUT       SAVUDS
S13  C*                  MOVE      BIPRT         WSPRT
     C                   MOVE      BIPRTM        WSMLP
     C                   Z-ADD     99999999999   YTNO
     C                   EXSR      TESTB
     C                   END
     C                   MOVE      UBIPRM        WSPRTM
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGTR         BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C                   MOVE      'EDT'         UTYPE             3
     C                   MOVE      TRTNO         UTNO
     C                   CALL      'GSS021R'
     C                   PARM                    UTNO
     C                   PARM                    UTYPE
     C                   PARM                    UMODE
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPTR         BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C                   MOVE      'DSP'         UTYPE             3
     C                   MOVE      TRTNO         UTNO
     C     *LIKE         DEFINE    TRTNO         UTNO
     C                   CALL      'GSS021R'
     C                   PARM                    UTNO
     C                   PARM                    UTYPE
     C                   PARM                    UMODE
      *
     C                   ENDSR
      *
     C***********************************************
     C     EDTTR         BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C                   Z-ADD     2             UFLAGG
     C                   MOVE      'EDT'         UTYPE             3
     C                   MOVE      TRTNO         UTNO
     c                   move      trst          uuusta            1
     c                   move      trst          UFLAGG
     C     TRTNO         CHAIN     GSSTRF                             33
     c  n33              move      'X'           trst
     c  n33              update    gsstrfr
     C                   CALL      'GSS023R'
     C                   PARM                    UTNO
     C                   PARM                    UTYPE
     C                   PARM                    UMODE
     C                   PARM                    UFLAGG            1 0
      *
     C     TRTNO         CHAIN     GSSTRF                             33
     c                   IF        TRST = 'X'
     c  N33              move      uuusta        trst
     c                   END
     c  N33              update    gsstrfr
     C                   ENDSR
      *
     C***********************************************
     C     PRTTR         BEGSR
     C***********************************************
N10  C     PRTTRS0       TAG
     C                   MOVE      '0'           *IN99
     C                   MOVE      '0'           *IN31
     C                   MOVE      'GSS0056'     MSGHN
     C                   MOVE      FICURR        WSCUR
     C     TRTNO         CHAIN(N)  GSSTRF                             33
     C     TRMFT1        IFEQ      *BLANKS
N04  C     TRMFT2        OREQ      *BLANKS
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
N09  C     FRIKEY        KLIST
N09  C                   KFLD                    HEAVD
N09  C                   KFLD                    HEOPD
N09  C                   KFLD                    FSKODE
N09  C                   move      'AWB'         FSKODE
     C                   MOVEL     TRTNO         HEAVD
     C                   MOVE      TRTNO         HEOPD
     C     HEADFK        CHAIN     HEADF                              99
S10  C*                  MOVE      *BLANKS       WSFT1
S10  C*                  MOVE      *BLANKS       WSFT2
N10  C     wsft1         ifeq      *blanks
     C                   MOVEL     XFT01         XFT11
     C                   MOVE      TRDW          XFT12
N10  C                   END
N10  C     wsft2         ifeq      *blanks
     C     HEUR          IFEQ      'A'
     C     HEUR          OREQ      'B'
     C                   MOVEL     XFT02         XFT21
     C                   MOVEL     HEGN          XFT25
     C                   ELSE
s04  C*                  MOVEL     XFT03         XFT21
s04  C*                  MOVEL     HEGN          XFT22
S04  C*                  MOVE      '-'           XFT23
s04  C*                  MOVE      HEGN          XFT24
N04  c                   eval      wsft2=xft03
N04  c                   move      hegn          hegn11           11
N09  c     hegn11        ifeq      '00000000000'
N09  c     frikey        chain     frisok                             99
N09  c  N99WSFT2         CAT       FSSOK:1       WSFT2
N09  c                   else
N04  c                   movel     hegn11        hegn11a           3
N04  c                   move      hegn11        hegn11b           8
N04  C     WSFT2         CAT       HEGN11A:1     WSFT2
N04  C     WSFT2         CAT       '-':0         WSFT2
N04  C     WSFT2         CAT       HEGN11B:0     WSFT2
N09  C                   end
N04  C     DOKEK         KLIST
N04  C                   KFLD                    DFRI
N04  C                   KFLD                    HEAVD
N04  C                   KFLD                    HEOPD
N04  C                   MOVE      'F'           DFRI
N04  C     DOKEK         CHAIN     DOKEF                              33
N04  C     *IN33         IFEQ      '0'
N04  C     DFROC1        IFNE      0
N04  C                   MOVE      DFROC1        DFROC1A           2
N04  C                   END
N04  C     DFROC2        IFNE      0
N04  C                   MOVE      DFROC2        DFROC2A           2
N04  C                   END
N04  C     DFROC3        IFNE      0
N04  C                   MOVE      DFROC3        DFROC3A           2
N04  C                   END
N04  C     WSFT2         CAT       'FLIGHT:':1   WSFT2
N04  C     WSFT2         CAT       DFROA1:1      WSFT2
N04  C     WSFT2         CAT       DFROB1:1      WSFT2
s15  C*    WSFT2         CAT       '/':1         WSFT2
n15  C     WSFT2         CAT       '/':0         WSFT2
s15  C*    WSFT2         CAT       DFROC1A:1     WSFT2
n15  C     WSFT2         CAT       DFROC1A:0     WSFT2
N04  C     WSFT2         CAT       DFROA2:1      WSFT2
N04  C     WSFT2         CAT       DFROB2:1      WSFT2
s15  C*    WSFT2         CAT       '/':1         WSFT2
n15  C     WSFT2         CAT       '/':0         WSFT2
s15  C*    WSFT2         CAT       DFROC2A:1     WSFT2
n15  C     WSFT2         CAT       DFROC2A:0     WSFT2
N04  C     WSFT2         CAT       DFROA3:1      WSFT2
N04  C     WSFT2         CAT       DFROB3:1      WSFT2
s15  C*    WSFT2         CAT       '/':1         WSFT2
n15  C     WSFT2         CAT       '/':0         WSFT2
s15  C*    WSFT2         CAT       DFROC3A:1     WSFT2
n15  C     WSFT2         CAT       DFROC3A:0     WSFT2
N04  C                   END
     C                   END
N10  C                   END
     C                   ELSE
     C                   MOVE      TRMFT1        WSFT1
     C                   MOVE      TRMFT2        WSFT2
     C                   END
     C                   MOVE      'N'           WSML
     C     TRBCD         COMP      *BLANKS                                27
     C  N27TRLOCF        COMP      *BLANKS                            2727
     C  N27TRLOCT        COMP      *BLANKS                            2727
N05  C                   MOVE      ' '           WSTYPE
N13  C                   MOVE      BIPRTI        WSPRT
      *
     C     STPRT         TAG
     C                   EXFMT     GSS030DY
     C                   MOVE      '0'           *IN99
     C   04              DO
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C     WSKNC         PARM      WSKNC         UKNC80            8 0
     C                   PARM                    UFIRM
     C                   PARM                    USØKKN
     C                   GOTO      STPRT
     C                   END
     C   12              GOTO      SLPRT
     C     WSPRT         COMP      *BLANKS                                99
     C   99              GOTO      STPRT
     C     KODVAK        CHAIN     VALUL01                            98
     C   98              GOTO      STPRT
     C     WSCOMM        IFEQ      'Y'
     C     WSKNC         ANDNE     0
     C     CUND1K        CHAIN     CUNDL01                            97
     C   97              GOTO      STPRT
     C                   END
      *
N10  C     TRMFT1        IFNE      WSFT1
N10  C     TRMFT2        ORNE      WSFT2
N10  C     TRTNO         CHAIN     GSSTRF                             33
N11  C  N33              EXSR      SRLOG
N10  C  N33              MOVE      WSFT1         TRMFT1
N10  C  N33              MOVE      WSFT2         TRMFT2
N10  C  N33              UPDATE    GSSTRFR
N10  C                   GOTO      PRTTRS0
N10  C                   end
     C                   MOVE      'AV'          XCONT             2
     C     TRTNO         SETLL     GSSOLL01
     C     TRTNO         READE     GSSOLL01                               33
     C  N33              IF        ((OLMN01 = 'C') AND (OLMN03 = ': '))
     C                   MOVE      'CT'          XCONT
     C                   MOVE      'N'           WSFAX
     C                   END
     C                   OUT       SAVUDS
      *
     C     TRTNO         CHAIN     GSSTRF                             33
N11  C  N33              IF        WSFT1 <> TRMFT1 OR WSFT2 <> TRMFT2
N11  C                   EXSR      SRLOG
N11  C                   END
     C                   MOVE      WSFT1         TRMFT1
     C                   MOVE      WSFT2         TRMFT2
     C                   UPDATE    GSSTRFR
     C                   SELECT
     C     WSNYL         WHENEQ    'P'
     C     WSNYL         OREQ      'O'
     C                   MOVE      'PRT'         UTYPE
     C     WSNYL         WHENEQ    'L'
     C                   MOVE      'PRL'         UTYPE
     C                   ENDSL
     C                   MOVE      WSKNC         UKNC              8
     C                   MOVE      TRCNO         UCNO2             8
     C                   MOVE      TRTNO         UTNO2            11
      *
     C     WSFAX         IFEQ      'Y'
     C     WSNYL         IFEQ      'P'
     C     WSNYL         OREQ      'L'
     C                   MOVE      '2'           UMOD              1
     C                   ELSE
     C                   MOVE      '3'           UMOD
     C                   END
     C                   CALL      'GSS034C'
     C                   PARM                    UCNO2
     C                   PARM                    UUTFAX            1
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
N05  C                   PARM                    WSTYPE
     C                   PARM                    WSCUR
     C                   PARM                    UMOD
     C                   PARM                    WSCOMM
     C                   PARM                    UKNC
     C     UUTFAX        CABEQ     'J'           STPRT2
     C                   GOTO      STPRT
     C                   END
      *
     C     WSCPY         IFEQ      0
     C                   Z-ADD     1             WSCPY
     C                   END
     C                   MOVE      WSCPY         UCPY
      *
     C     WSML          IFEQ      'Y'
N16  C                   MOVE      WSMLP         XXMLP            10
N16  C                   MOVE      WSFTXT        XXFTXT           30
N16  C                   MOVE      WSKOPI        XXKOPI            1 0
N16  C                   MOVEL     TRTNO         HEAVD
N16  C                   MOVE      TRTNO         HEOPD
N16  C     HEADFK        CHAIN     HEADF                              33
     C                   OPEN      GSS035W
     C     TRTNO         CHAIN     GSS035W                            33
     C     *IN33         IFEQ      '0'
N16  C                   CLEAR                   GSS035WR
N16  C     TRTNO         CHAIN(N)  GSSTRF                             33
N16  C                   MOVE      TRTNO         W3TNO
N16  C                   EVAL      W3NAB = 'MAIN LABEL'
N16  C                   MOVE      TRAD1         W3AD1
N16  C                   MOVE      TRAD2         W3AD2
N16  C                   MOVE      TRAD3         W3AD3
N16  C                   MOVE      TRAD4         W3AD4
N16  C                   MOVE      TRAD5         W3AD5
N16  C                   MOVE      TRAD6         W3AD6
N16  C                   MOVE      TRFC          W3FC
N16  C                   MOVE      WXDTL         W3DTL
N16  C                   MOVE      HENT          W3CLT
N16  C                   Z-ADD     HEVKT         W3VKT
N16  C                   MOVE      HESDT         W3SDT
N16  C                   MOVE      XXMLP         WSMLP
N16  C                   MOVE      XXFTXT        WSFTXT
N16  C                   MOVE      XXKOPI        WSKOPI
     C                   UPDATE    GSS035WR
     C                   ELSE
     C                   MOVE      TRTNO         W3TNO
     C                   WRITE     GSS035WR
     C                   END
     C                   CLOSE     GSS035W
N08  C                   ELSE
N08  C                   IF        WSML = 'A'
N08  C                   EXSR      PRTLABEL
N08  C                   END
     C                   END
      *
     C     WSNYL         IFEQ      'P'
     C     WSNYL         OREQ      'L'
     C                   IF        XCONT = 'CT'
     C                   MOVE      'PRC'         UTYPE
     C                   MOVEL     'CT'          WSPOS1
     C                   END
     C                   CALL      'GSS031R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    WSPRT
N05  C                   PARM                    WSTYPE
     C                   PARM                    WSCUR
     C                   PARM                    UCPY
     C                   PARM                    WSFAX
     C                   PARM                    WSCOMM
     C                   PARM                    UKNC
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    WSPOS1
     C                   PARM                    WSPOS2
     C                   PARM                    WSPOS3
     C                   ELSE
     C                   CALL      'GSS033R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    WSPRT
N05  C                   PARM                    WSTYPE
     C                   PARM                    UCPY
     C                   PARM                    WSFAX
N14  C                   PARM                    UQJOB            10
N14  C                   PARM                    UQUSER           10
N14  C                   PARM                    UQNBR             6
     C                   END
      *
     C     STPRT2        TAG
     C  N90              MOVE      '1'           *IN99
S06  C* N90              MOVE      '3'           TRST
N06  C  N90TRTNO         CHAIN(N)  GSSTRF                             33
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C     SLPRT         ENDSR
      *
     C***********************************************
     C     PRTBML        BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN99
     C                   MOVE      '0'           *IN31
     C                   MOVE      'GSS0056'     MSGHN
      *
     C     STPRTBM       TAG
     C                   EXFMT     GSS030DI
     C                   MOVE      '0'           *IN89
     C   12              GOTO      SLPRTBM
     C     WSPRTM        COMP      *BLANKS                                89
     C   89              GOTO      STPRTBM
     C                   MOVE      'M'           UMOD
     C                   IF        WSBOXN = 0
     C                   MOVEL     '*ALL'        WSPRTM1          10
     C                   ELSE
     C                   MOVEL     WSBOXN        WSPRTM1          10
     C                   END
     C                   MOVE      TRTNO         UTNO2
     C                   CALL      'GSS026R'
     C                   PARM                    UTNO2
     C                   PARM                    WSPRTM1
     C                   PARM                    WSPRTM
     C                   PARM                    WSSORT
     C                   PARM                    WSFAX
     C                   PARM                    UMOD
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    UUSER
      *
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C     SLPRTBM       ENDSR
      *
     C***********************************************
     C     CPYPL         BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN99
     C                   MOVE      '1'           *IN31
     C                   MOVE      'GSS0058'     MSGHN
N05  C                   MOVE      ' '           WSTYPE
N05  C                   EVAL      WSPRT = BIPRT
     C     STCPY         TAG
     C                   EXFMT     GSS030DX
     C                   MOVE      '0'           *IN99
     C   12              GOTO      SLCPY
     C     WSPRT         COMP      *BLANKS                                99
     C   99              GOTO      STCPY
      *
     C                   MOVE      'CPY'         UTYPE
     C                   MOVE      TRCNO         UCNO2             8
     C                   MOVE      TRTNO         UTNO2            11
      *
     C     WSFAX         IFEQ      'Y'
     C                   MOVE      '1'           UMOD
     C                   CALL      'GSS034C'
     C                   PARM                    UCNO2
     C                   PARM                    UUTFAX            1
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
N05  C                   PARM                    WSTYPE
     C                   PARM                    WSCUR
     C                   PARM                    UMOD
     C                   PARM                    WSCOMM
     C                   PARM                    UKNC
     C     UUTFAX        CABEQ     'J'           STCPY2
     C                   GOTO      STCPY
     C                   END
      *
     C     WSCPY         IFEQ      0
     C                   Z-ADD     1             WSCPY
     C                   END
     C                   MOVE      WSCPY         UCPY              1
      *
     C                   CALL      'GSS022R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    UCPY
     C                   PARM                    WSPRT
     C                   PARM                    WSFAX
      *
     C     STCPY2        TAG
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C     SLCPY         ENDSR
      *
     C***********************************************
     C     CFMTR         BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C   23              DO
N08  C                   MOVE      '0'           *IN12
N08  C                   SELECT
N08  C                   WHEN      TRLOCF = 'RTM'
N08  C                   MOVE      'J'           XRTMJA            1
N08  C                   MOVE      'MRNO '       WSKD
N08  C                   EXSR      SJEKKMRN
N08  C                   WHEN      TRLOCT = 'RTM'
N08  C                   MOVE      'J'           XRTMJA
N08  C                   MOVE      'MRNI '       WSKD
N08  C                   EXSR      SJEKKMRN
N08  C                   OTHER
N08   * DIREKT TRIP (SJEKK OM DET ER UTG$ENDE FRA RTM)
N08  C                   MOVE      'N'           XRTMJA
N08  C     TRTNO         SETLL     GSSORL21
N08  C     TRTNO         READE     GSSORL21                               33
N08  C  N33              IF        ORLC = 'RTM'                                 TRIP FRA RTM
N08  C                   MOVE      'MRNO '       WSKD
N08  C                   MOVE      'J'           XRTMJA
N08  C                   EXSR      SJEKKMRN
N08  C                   END
N08  C                   ENDSL
N08  C                   MOVE      *BLANKS       WSTYPE
N08   *
     C                   MOVE      *BLANKS       WSFAX
     C                   MOVE      'CFM'         UTYPE
     C                   MOVE      TRTNO         UTNO2
     C     TRTNO         CHAIN(N)  GSSTRF                             33
     C     TRBCD         IFEQ      *BLANKS
     C     TRLOCF        ORNE      *BLANKS
     C     TRLOCT        ANDNE     *BLANKS
     C                   MOVE      '*NEW '       WSPOS1
     C                   MOVE      *BLANKS       WSPOS2
     C                   MOVE      *BLANKS       WSPOS3
N05  C                   MOVE      *BLANKS       WSTYPE
S12  C*    TRLOCF        COMP      'RTM'                                  51
N12  C     TRLOCT        COMP      'RTM'                                  51
     C                   MOVE      '0'           *IN99
     C     STCFM         TAG
     C                   EXFMT     GSS030DD
     C                   MOVE      '0'           *IN99
     C   12              GOTO      SLCFM
     C     WSPOS1        COMP      *BLANKS                                99
     C   99              GOTO      STCFM
     C                   END
N08   *
N08  C                   MOVE      'J'           XMRNOK            1
N08  C                   SELECT
N08  C                   WHEN      (((XRTMJA = 'J') AND
N08  C                               (WSTYPE = 'T')) AND
N08  C                               (WSKD = 'MRNI'))
N08  C                   EXSR      GETMRN
N08  C                   WHEN      ((XRTMJA = 'J') AND (XIKKEOK = 'J'))
N08  C                   EXSR      GETMRN
N08  C                   ENDSL
N08   * NON-TRANFER TRIP --> IKKE LOV Å AVSLUTTE HVIS MRN-NR IKKE OPPGITT.
N08  C   12TRBCD         IFNE      *BLANKS
N08  C     TRLOCF        ANDEQ     *BLANKS
N08  C     TRLOCT        ANDEQ     *BLANKS
N08  C                   GOTO      SLCFM
N08  C                   END
N08   *
     C                   CALL      'GSS031R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    WSPRT
N05  C                   PARM                    WSTYPE
     C                   PARM                    WSCUR
     C                   PARM                    UCPY
     C                   PARM                    WSFAX
     C                   PARM                    WSCOMM
     C                   PARM                    UKNC
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    WSPOS1
     C                   PARM                    WSPOS2
     C                   PARM                    WSPOS3
     C                   SELECT
     C                   WHEN      UTYPE = 'CF4'
     C                   MOVE      '4'           TRST
N03  C                   WHEN      TRBCD = '*ALL'
N03  C                   MOVE      '4'           TRST
     C                   WHEN      UTYPE = 'CF6'
     C                   MOVE      '6'           TRST
     C                   OTHER
     C                   ENDSL
     C                   MOVE      'CFM'         UTYPE
     C                   END
      *
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C     SLCFM         ENDSR
      *
     C***********************************************
     C     PLKTR         BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN99
     C                   MOVE      'F'           WSSORT
     C                   MOVE      'N'           WSFAX
N05  C                   MOVE      ' '           WSTYPE
N13  C                   EVAL      WSPRT = BIPRTP
     C     STPLK         TAG
     C                   EXFMT     GSS030DZ
     C                   MOVE      '0'           *IN99
     C   12              GOTO      SLPLK
     C     WSPRT         COMP      *BLANKS                                99
     C   99              GOTO      STPLK
      *
     C                   MOVE      'PRT'         UTYPE
     C                   MOVE      TRTNO         UTNO2            11
      *
     C                   MOVE      'J'           UKOPI             1
      *
     C                   SELECT
     C     WSSORT        WHENEQ    'L'
     C     WSSORT        OREQ      'O'
     C     WSSORT        OREQ      'B'
     C                   CALL      'GSS025R'
     C                   PARM                    UTNO2
     C                   PARM                    WSPRT
     C                   PARM                    WSSORT
     C                   PARM                    UKOPI
     C                   PARM                    UUSER
     C     WSSORT        WHENEQ    'P'
     C     WSSORT        OREQ      'F'
     C     WSSORT        IFEQ      'P'
     C                   MOVE      'N'           WSFAX
     C                   END
     C     WSFAX         IFEQ      'Y'
     C                   MOVE      TRCNO         UCNO2             8
     C                   MOVE      '5'           UMOD              1
     C                   CALL      'GSS034C'
     C                   PARM                    UCNO2
     C                   PARM                    UUTFAX            1
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
N05  C                   PARM                    WSTYPE
     C                   PARM                    UVALK             3
     C                   PARM                    UMOD              1
     C                   PARM                    UCOMM             1
     C                   PARM                    UKNC              8
     C                   ELSE
     C                   MOVE      '1'           UMOD              1
     C                   MOVE      '*JOB'        WSPRT2           10
     C                   CALL      'GSS026R'
     C                   PARM                    UTNO2
     C                   PARM                    WSPRT
     C                   PARM                    WSPRT2
     C                   PARM                    WSSORT
     C                   PARM                    WSFAX
     C                   PARM                    UMOD
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
     C                   PARM                    UUSER
     C                   END
     C                   ENDSL
      *
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C     SLPLK         ENDSR
      *
N02  C***********************************************
N02  C     DGSR          BEGSR
N02  C***********************************************
N02   *
N02   *
N02  C                   CALL      'GSS076C'
N02  C                   PARM                    WSPRT
N02  C                   PARM                    TRTNO
N02   *
N02  C  N90              MOVE      '1'           *IN99
N02  C  N90              MOVE      *BLANKS       WSNR
N02  C  N90              UPDATE    GSS030DA
N02  C                   ENDSR
     C***********************************************
     C     arkivsr       BEGSR
     C***********************************************
     C                   MOVEl     TRTNO         uavd              4 0
     C                   MOVE      TRTNO         uopd              7 0
     C                   CALL      'ARC003'
     C                   PARM                    uavd
     C                   PARM                    uopd
     C                   PARM                    URUNDE           10
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
     C                   ENDSR
      *
     C***********************************************
     C     BOXINF        BEGSR
     C***********************************************
     C                   MOVE      TRTNO         UTNO
     C                   CALL      'GSS047R'
     C                   PARM                    UTNO
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTML         BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN99
     C     STPML         TAG
     C                   EXFMT     GSS030DH
     C                   MOVE      '0'           *IN89
     C   12              GOTO      SLPML
     C     WSPRTM        COMP      *BLANKS                                89
     C   89              GOTO      STPML
      *
     C     TRTNO         SETLL     GSSORL22
     C     TRTNO         READE     GSSORL22                               33
     C                   DOW       *IN33 = *OFF
     C                   MOVE      ORONO         UPONO             7
     C                   MOVE      ORDTLD        UPDTLD
     C                   MOVE      ORDTLM        UPDTLM
     C                   MOVE      ORDTLÅ        UPDTLÅ
     C     ORBCD         CHAIN     CDBOAT                             33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   MOVE      *BLANKS       UPO
     C                   MOVE      *ZEROS        XN                3 0
     C     ORONO         SETLL     GSSPOF
     C     ORONO         READE     GSSPOF                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      POCONO        UPO(XN)
     C     ORONO         READE     GSSPOF                                 33
     C  N33              ENDDO
     C                   CALL      'GSS011RP'
     C                   PARM                    WSPRTM                         PRINTNAVN
     C                   PARM                    UPONO                          INTER ORDRENR
N07  C                   PARM                    ORTYPE                         ORDRETYPE
     C                   PARM                    CBNAB                          BÅTNAVN
     C                   PARM                    KNAVN                          KUNDENAVN
     C                   PARM                    ORSNM                          LEVERANDØR
     C                   PARM                    UPDTL                          LEV.DATO
     C                   PARM                    ORCLI                          ANTALL KOLLI
     C                   PARM                    UPCON1                         P.O.NR 1
     C                   PARM                    UPCON2                         P.O.NR 2
     C                   PARM                    UPCON3                         P.O.NR 3
     C                   PARM                    UPCON4                         P.O.NR 4
     C                   PARM                    UPCON5                         P.O.NR 5
     C                   PARM                    UPCON6                         P.O.NR 6
     C     TRTNO         READE     GSSORL22                               33
     C  N33              ENDDO
      *
     C  N90              MOVE      '1'           *IN99
     C  N90              MOVE      *BLANKS       WSNR
     C  N90              UPDATE    GSS030DA
      *
     C     SLPML         ENDSR
      *
N01  C***********************************************
N01  C     BERFAK        BEGSR
N01  C***********************************************
N01  C                   MOVE      TRTNO         UTNO
N01  C                   CALL      'GSS049C'
N01  C                   PARM                    PAR07             7 0
N01  C                   PARM                    UTNO             11 0
N01   *
N01  C                   ENDSR
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
     C                   Z-ADD     1             UFLAGG            1 0
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     48
     C     POSNBR        ANDLE     52
     C                   CALL      'SYSJ11A'
     C                   PARM                    W2BCD
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     54
     C     POSNBR        ANDLE     61
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    W2CNO
     C                   PARM                    UFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'GSS0013'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
N08  C***********************************************
N08  C     SJEKKMRN      BEGSR
N08  C***********************************************
N08  C                   MOVE      'N'           XIKKEOK           1
N08   *
N08  C     TRTNO         SETLL     GSSORL21
N08  C     TRTNO         READE     GSSORL21                               33
N08  C                   DOW       *IN33 = *OFF
N08  C                   IF        ORTYPE = 'T'
N08  C     ORONO         SETLL     GSSRFF
N08  C     ORONO         READE     GSSRFF                                 33
N08  C                   DOW       *IN33 = *OFF
N08  C                   IF        RFKD = WSKD
N08  C                   EVAL      WSMRN = RFREF
N08  C                   LEAVE
N08  C                   END
N08  C     ORONO         READE     GSSRFF                                 33
N08  C  N33              ENDDO
N08  C   33              MOVE      'J'           XIKKEOK
N08  C   33              GOTO      SLSJMRN
N08  C                   END
N08  C     TRTNO         READE     GSSORL21                               33
N08  C  N33              ENDDO
N08   *
N08  C     SLSJMRN       ENDSR
N08   *
N08  C***********************************************
N08  C     GETMRN        BEGSR
N08  C***********************************************
N08  C     GSSRFFK       KLIST
N08  C                   KFLD                    ORONO
N08  C                   KFLD                    XRFLNO
N08  C                   Z-ADD     999           XRFLNO            3 0
N08  C                   MOVE      '0'           *IN99
N08  C                   MOVE      'N'           XMRNOK
N08   *
N08  C                   SELECT                                                 1<-B
N08  C                   WHEN      TRLOCF = 'RTM'
N08  C                   MOVE      'MRNO '       WSKD
N08  C                   WHEN      TRLOCT = 'RTM'
N08  C                   MOVE      'MRNI '       WSKD
N08  C                   OTHER
N08  C     TRTNO         SETLL     GSSORL21
N08  C     TRTNO         READE     GSSORL21                               33
N08  C   33              GOTO      STMRN2
N08  C                   IF        ORLC = 'RTM'
N08  C                   MOVE      'MRNO '       WSKD
N08  C                   ELSE
N08  C                   GOTO      STMRN2
N08  C                   END
N08  C                   ENDSL                                                  1<-E
N08  C                   MOVE      *BLANKS       WSMRN
N08   *
N08  C     STMRN         TAG
N08  C                   EXFMT     GSS030DJ
N08  C                   MOVEA     '00'          *IN(98)
N08  C   12              GOTO      STMRN2
N08  C     WSKD          COMP      'MRNI'                             9999
N08  C   99WSKD          COMP      'MRNO'                             9999
N08  C   99              GOTO      STMRN
N08  C     WSMRN         COMP      *BLANKS                                98
N08  C  N98              MOVE      WSMRN         WSMRN01           1
N08  C  N98WSMRN01       COMP      *BLANKS                                98
N08  C   98              GOTO      STMRN
N08   *
N08   * OPPDATER MRN-NR P$ GSSRFF
N08  C                   CALL      'SYGE15C'
N08  C                   PARM                    WDT               8
N08  C                   PARM                    WTM               6
N08  C     TRTNO         SETLL     GSSORL21
N08  C     TRTNO         READE     GSSORL21                               33
N08  C                   DOW       *IN33 = *OFF                                 1<-B
N08  C                   IF        WSKD = 'MRNI'                                 2<-B
N08  C     GSSRFFK       SETLL     GSSRFF
N08  C     ORONO         READPE    GSSRFF                                 33
N08  C  N33              ADD       1             RFLNO
N08  C   33              Z-ADD     1             RFLNO
N08  C                   MOVE      ORONO         RFONO
N08  C                   MOVE      'M'           RFEDI
N08  C                   MOVE      WSKD          RFKD
N08  C                   EVAL      RFREF = WSMRN
N08  C                   MOVE      WDT           RFDTR
N08  C                   MOVE      *ZEROS        RFDTE
N08  C                   WRITE     GSSRFFR
N08  C                   ELSE                                                    2
N08  C                   IF        ORTYPE = 'T'                                   3<-B
N08  C                   MOVE      *ZEROS        RFLNO
N08  C     ORONO         SETLL     GSSRFF
N08  C     ORONO         READE     GSSRFF                                 33
N08  C                   DOW       *IN33 = *OFF                                    4<-B
N08  C                   IF        ((RFKD = WSKD) AND (RFREF = WSMRN))              5<-B
N08  C                   LEAVE
N08  C                   END                                                        5<-E
N08  C     ORONO         READE     GSSRFF                                 33
N08  C  N33              ENDDO                                                     4<-E
N08  C                   IF        *IN33                                           4<-B
N08  C                   MOVE      ORONO         RFONO
N08  C                   ADD       1             RFLNO
N08  C                   MOVE      'M'           RFEDI
N08  C                   MOVE      WSKD          RFKD
N08  C                   EVAL      RFREF = WSMRN
N08  C                   MOVE      WDT           RFDTR
N08  C                   MOVE      *ZEROS        RFDTE
N08  C                   WRITE     GSSRFFR
N08  C                   END                                                       4<-E
N08  C                   END                                                      3<-E
N08  C                   END                                                     2<-E
N08  C     TRTNO         READE     GSSORL21                               33
N08  C  N33              ENDDO                                                  1<-E
N08   *
N08  C     STMRN2        TAG
N08  C  N90              IF        XRTMJA = ' '
N08  C                   MOVE      '1'           *IN99
N08  C                   MOVE      *BLANKS       WSNR
N08  C                   UPDATE    GSS030DA
N08  C                   END
N08  C                   MOVE      'J'           XMRNOK
N08   *
N08  C     SLMRN         ENDSR
N08   *
N08  C***********************************************
N08  C     PRTLABEL      BEGSR
N08  C***********************************************
N08  C                   MOVE      WSMLP         XXMLP            10
N08  C                   MOVE      WSFTXT        XXFTXT           30
N08  C                   MOVE      WSKOPI        XXKOPI            1 0
N08  C                   MOVEL     TRTNO         HEAVD
N08  C                   MOVE      TRTNO         HEOPD
N08  C     HEADFK        CHAIN     HEADF                              33
N08  C                   OPEN      GSS035W
N08  C     TRTNO         CHAIN     GSS035W                            33
N08  C  N33              DELETE    GSS035WR
N08  C                   CLEAR                   GSS035WR
N08  C     TRTNO         CHAIN(N)  GSSTRF                             33
N08  C                   MOVE      TRTNO         W3TNO
N08  C                   EVAL      W3NAB = 'MAIN LABEL'
N08  C                   MOVE      TRAD1         W3AD1
N08  C                   MOVE      TRAD2         W3AD2
N08  C                   MOVE      TRAD3         W3AD3
N08  C                   MOVE      TRAD4         W3AD4
N08  C                   MOVE      TRAD5         W3AD5
N08  C                   MOVE      TRAD6         W3AD6
N08  C                   MOVE      TRFC          W3FC
N08  C                   MOVE      WXDTL         W3DTL
N08  C                   MOVE      HENT          W3CLT
N08  C                   Z-ADD     HEVKT         W3VKT
N08  C                   MOVE      HESDT         W3SDT
N08  C                   MOVE      XXMLP         WSMLP
N08  C                   MOVE      XXFTXT        WSFTXT
N08  C                   MOVE      XXKOPI        WSKOPI
N08  C                   WRITE     GSS035WR
N08  C                   MOVE      TRTNO         UTNO2
N08  C                   CALL      'GSS035R'
N08  C                   PARM                    UTNO2
N08  C                   CLOSE     GSS035W
N08   *
N08  C                   ENDSR
N08   *
N11   ***********************************************
N11  C     SRLOG         BEGSR
N11   ***********************************************
N11  C                   CALL      'SYGE15C'
N11  C                   PARM                    WDT               8
N11  C                   PARM                    WTM               6
N11  C                   MOVE      WDT           TLDT
N11  C                   MOVE      WTM           TLTID
N11  C                   MOVE      WDT           TLHDT
N11  C                   MOVE      WTM           TLHTID
N11  C                   EVAL      TLUSER = UUSER
N11  C                   EVAL      TLPGM  = 'GSS030R'
N11  C                   EVAL      TLLEV  = 0
N11  C                   EVAL      TLFTYP = '*PINV'
N11  C                   EVAL      TLTNO  = TRTNO
N11  C                   IF        WSFT1  <> TRMFT1
N11  C                   EVAL      TLTXT  = 'Flight number is changed.'
N11  C                   EVAL      TLNGM  = 0
N11  C                   EVAL      TLNNY  = 0
N11  C                   EVAL      TLAGM  = 'From ' + %trim(WSFT2)
N11  C                   EVAL      TLANY  = 'To ' + %trim(TRMFT2)
N11  C                   WRITE     GSSLGTFR
N11  C                   END
N11  C                   IF        WSFT2  <> TRMFT2
N11  C                   EVAL      TLTXT  = 'AWB number is changed.'
N11  C                   EVAL      TLNGM  = 0
N11  C                   EVAL      TLNNY  = 0
N11  C                   EVAL      TLAGM  = 'From ' + %trim(WSFT2)
N11  C                   EVAL      TLANY  = 'To ' + %trim(TRMFT2)
N11  C                   WRITE     GSSLGTFR
N11  C                   END
N11   *
N11  C                   ENDSR
N11   *
