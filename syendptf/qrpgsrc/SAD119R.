      *
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE KURERMANIFEST DEFAULT (HODE)***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-02 06-08 10 11 13-26
      *** LEDIGE INDIKATORER 27-29 31 32 34-47 50-79          ***
      ***********************************************************
      *
     FSADKMDEF  UF A E           K DISK
     FTELL      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FTRAN      IF   E           K DISK
     FKODTS2    IF   E           K DISK
     F*KODTS4    IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FSAD119D   CF   E             WORKSTN INFDS(FBAREA)
     D                SDS
     D  UUSR                 254    263
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSATDDD                1      2  0
     D  WSATDDM                3      4  0
     D  WSATDDA                5      6  0
     D  WSATDD                 1      6  0
     D                 DS
     D  KMATDDA                1      4  0
     D  KMATDDM                5      6  0
     D  KMATDDD                7      8  0
     D  KMATDD                 1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRA                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  KMDTRA                 1      4  0
     D  KMDTRM                 5      6  0
     D  KMDTRD                 7      8  0
     D  KMDTR                  1      8  0
     D                 DS
     D  WSATDTH                1      2  0
     D  WSATDTM                3      4  0
     D  WSATDTS                5      6  0
     D  WSATDT                 1      6  0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
      *...............................................
      * BILDE-1 INNLESING AV HOVED OPPLYSNINGER AV TUR
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '00000000'    *IN(80)
     C                   SETOFF                                       30
      *
     C   03              GOTO      SLUTT
      *
      *  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
      *  12 = AVBRYT
     C   12              GOTO      SLUTT
      *
     C                   IF        *IN49 = *OFF                                 IKKE VISNINGSMODUS
      * ----------- T E S T   B I L D E 0 1 ----------
     C                   EXSR      TESTB1
     C   30              GOTO      START
      *
     C                   EXSR      OPDTUR
     C                   END
      *
     C     SLUTT         TAG
     C                   SELECT
     C                   WHEN      *IN03
     C                   EVAL      UFLAGG = 3
     C                   WHEN      *IN12
     C                   EVAL      UFLAGG = 1
     C                   OTHER
     C                   EVAL      UFLAGG = 0
     C                   ENDSL
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * SØK DEKLARANT
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKND
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAD
     C                   IF        WSKND <> 0
     C                   EXSR      TESTD
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     91
     C     POSNBR        ANDLE     92
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKD
     C                   PARM                    USPED
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     16
     C*                  CALL      'SAD061I'
     C*                  PARM                    WSTM
     C                   eval      KFTYP='SADKMMODTR'
     C                   MOVE      'N'           UUPDAT            1
     C                   MOVE      *BLANKS       XKFKOD            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XKFKOD
     C                   MOVEL     XKFKOD        WSTM
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   EVAL      UKODE = WSTD1
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTD1
     C                   Z-ADD     38            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     38
     C     POSNBR        ANDLE     45
     C                   EVAL      UKODE = WSTDA
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTDA
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      * FRISØK TRANSPORTØR
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     30
     C                   CALL      'SYTR04A'
     C                   PARM                    WSKNC
     C                   IF        WSKNC <> 0
     c                   exsr      testC
     c                   end
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     91
     C     POSNBR        ANDLE     92
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKC
     C                   PARM                    USPED
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *
      *** TEST AVDELING
     C  N48WSAVD         CHAIN     TELL                               99
      *
      *** TEST DEKLARANT
     C     WSKND         IFNE      0
     C                   EXSR      TESTD
     C                   END
      *
     C     WSRGD         COMP      *BLANKS                                97
     C     WSNAD         COMP      *BLANKS                                96
     C*    WSADD1        COMP      *BLANKS                                95
     C     WSADD3        COMP      *BLANKS                                94
      *
     C                   IF        WSLKD <> *BLANKS
     C     KODTS2KD      CHAIN     KODTS2                             93
     C                   END
      *
     C                   IF        WSCMD <> *BLANKS AND WSCMDT = *BLANKS
     C                   EVAL      *IN92 = *ON
     C                   END
      *
     C                   IF        WSTM <> 0
     C*    KODTS4K       CHAIN     KODTS4                             91
     C                   eval      KFTYP='SADKMMODTR'
     c                   eval      KFKOD=*blanks
     C                   MOVEL     WSTM          KFKOD
     C     KOFASTkey     CHAIN     KOFAST                             91
     C                   END
      *
     C                   IF        WSATDD <> 0
     C                   MOVE      WSATDDD       XAR               2 0
     C                   MOVE      WSATDDM       XMN               2 0
     C                   MOVE      WSATDDD       XDG               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDG
     C                   PARM                    XMN
     C                   PARM                    XAR
     C                   PARM                    FLAGG             1 0
     C     FLAGG         COMP      1                                      90
     C                   END
      *
     C                   IF        WSATDTS >= 24 OR WSATDTM >= 60
     C                             OR WSATDTS >= 60
     C                   EVAL      *IN89 = *ON
     C                   END
      *
     C                   IF        WSTD1 <> *BLANKS
     C                   EVAL      UKODE = WSTD1
     C     TRKODL01K     CHAIN     TRKODL01                           88
     C                   END
      *
     C                   IF        WSTDA <> *BLANKS
     C                   EVAL      UKODE = WSTDA
     C     TRKODL01K     CHAIN     TRKODL01                           88
     C                   END
      *
      *** TEST TRANSPORTØR
     C     WSKNC         IFNE      0
     C                   EXSR      TESTC
     C                   END
      *
     C                   IF        *IN33 AND *IN33 = *OFF
     C     WSRGC         COMP      *BLANKS                                85
     C     WSNAC         COMP      *BLANKS                                84
     C     WSADC1        COMP      *BLANKS                                83
     C     WSADC3        COMP      *BLANKS                                82
      *
     C                   IF        WSLKC <> *BLANKS
     C     KODTS2KC      CHAIN     KODTS2                             81
     C                   END
     C                   END
      *
     C                   IF        WSCMC <> *BLANKS AND WSCMCT = *BLANKS
     C                   EVAL      *IN80 = *ON
     C                   END
      *
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG          BEGSR
      ***********************************************
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              DO
     C                   SETON                                        30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     7             POSNBR
     C                   END
     C   98
     CANN30              DO
     C                   MOVE      'YBC2037'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   97
     CANN30              DO
     C                   MOVE      'YBC2038'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
     C   96
     CANN30              DO
     C                   MOVE      'YBC2039'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   95
     CANN30              DO
     C                   MOVE      'YBC2040'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     46            POSNBR
     C                   END
     C   94
     CANN30              DO
     C                   MOVE      'YBC2041'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   END
     C   93
     CANN30              DO
     C                   MOVE      'YBC2042'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     91            POSNBR
     C                   END
     C   92
     CANN30              DO
     C                   MOVE      'YBC2043'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
     C   91
     CANN30              DO
     C                   MOVE      'SPT0030'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   90
     CANN30              DO
     C                   MOVE      'YBC2044'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
     C   89
     CANN30              DO
     C                   MOVE      'YBC2045'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     85            POSNBR
     C                   END
     C   88
     CANN30              DO
     C                   MOVE      'YBC1768'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   87
     CANN30              DO
     C                   MOVE      'YBC1768'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     38            POSNBR
     C                   END
     C   86
     CANN30              DO
     C                   MOVE      'YBC2046'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   85
     CANN30              DO
     C                   MOVE      'YBC2047'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
     C   84
     CANN30              DO
     C                   MOVE      'YBC2048'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   83
     CANN30              DO
     C                   MOVE      'YBC2049'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     46            POSNBR
     C                   END
     C   82
     CANN30              DO
     C                   MOVE      'YBC2050'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     56            POSNBR
     C                   END
     C   81
     CANN30              DO
     C                   MOVE      'YBC2051'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     91            POSNBR
     C                   END
     C   80
     CANN30              DO
     C                   MOVE      'YBC2052'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVKMW        BEGSR
      ***********************************************
     C                   MOVE      KMAVD         WSAVD
     C                   MOVE      KMDTRD        WSDTRD
     C                   MOVE      KMDTRM        WSDTRM
     C                   MOVE      KMDTRA        WSDTRA
     C                   MOVE      KMKND         WSKND
     C                   MOVE      KMRGD         WSRGD
     C                   MOVE      KMNAD         WSNAD
     C                   MOVE      KMADD1        WSADD1
     C                   MOVE      KMADD2        WSADD2
     C                   MOVE      KMPND         WSPND
     C                   MOVE      KMADD3        WSADD3
     C                   MOVE      KMLKD         WSLKD
     C                   MOVE      KMCMD         WSCMD
     C                   MOVE      KMCMDT        WSCMDT
     C                   MOVE      KMTM          WSTM
     C                   MOVE      KMTRID        WSTRID
     C                   MOVE      KMATDDD       WSATDDD
     C                   MOVE      KMATDDM       WSATDDM
     C                   MOVE      KMATDDA       WSATDDA
     C                   MOVE      KMATDT        WSATDT
     C                   MOVE      KMTRRF        WSTRRF
     C                   MOVE      KMTD1         WSTD1
     C                   MOVE      KMTDA         WSTDA
     C                   MOVE      KMKNC         WSKNC
     C                   MOVE      KMRGC         WSRGC
     C                   MOVE      KMNAC         WSNAC
     C                   MOVE      KMADC1        WSADC1
     C                   MOVE      KMADC2        WSADC2
     C                   MOVE      KMPNC         WSPNC
     C                   MOVE      KMADC3        WSADC3
     C                   MOVE      KMLKC         WSLKC
     C                   MOVE      KMCMC         WSCMC
     C                   MOVE      KMCMCT        WSCMCT
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWKM        BEGSR
      ***********************************************
     C                   MOVE      WSDTRD        KMDTRD
     C                   MOVE      WSDTRM        KMDTRM
     C                   MOVE      WSDTRA        KMDTRA
     C                   MOVE      WSKND         KMKND
     C                   MOVE      WSRGD         KMRGD
     C                   MOVE      WSNAD         KMNAD
     C                   MOVE      WSADD1        KMADD1
     C                   MOVE      WSADD2        KMADD2
     C                   MOVE      WSPND         KMPND
     C                   MOVE      WSADD3        KMADD3
     C                   MOVE      WSLKD         KMLKD
     C                   MOVE      WSCMD         KMCMD
     C                   MOVE      WSCMDT        KMCMDT
     C                   MOVE      WSTM          KMTM
     C                   MOVE      WSTRID        KMTRID
     C                   MOVE      WSATDDD       KMATDDD
     C                   MOVE      WSATDDM       KMATDDM
     C                   MOVE      WSATDDA       KMATDDA
     C                   MOVE      WSATDT        KMATDT
     C                   MOVE      WSTRRF        KMTRRF
     C                   MOVE      WSTD1         KMTD1
     C                   MOVE      WSTDA         KMTDA
     C                   MOVE      WSKNC         KMKNC
     C                   MOVE      WSRGC         KMRGC
     C                   MOVE      WSNAC         KMNAC
     C                   MOVE      WSADC1        KMADC1
     C                   MOVE      WSADC2        KMADC2
     C                   MOVE      WSPNC         KMPNC
     C                   MOVE      WSADC3        KMADC3
     C                   MOVE      WSLKC         KMLKC
     C                   MOVE      WSCMC         KMCMC
     C                   MOVE      WSCMCT        KMCMCT
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTD         BEGSR
      ***********************************************
     C                   MOVE      WSKND         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            98
     C  N98kundnr        comp      0                                      98
     C  N98              DO
     C                   MOVE      KNAVN         WSNAD
     C                   MOVE      ADR1          WSADD1
     C                   MOVE      ADR2          WSADD2
     C                   EVAL      WSADD3 = ADR3
     C                   EVAL      WSPND  = *BLANKS
     C     POSTNR        IFEQ      0
     C                   EVAL      WSPND = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPND
     C                   END
     C                   IF        SYFOR9 <> *ZEROS
     C                   EVAL      WSRGD = SYRG
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTC         BEGSR
      ***********************************************
     C                   MOVE      WSKNC         KUNDNR
     C     KUND1K        CHAIN     TRAN                               86
     C  N86KUND1K        CHAIN     CUNDL01                            86
     C  N86kundnr        comp      0                                      86
     C  N86              DO
     C                   MOVE      KNAVN         WSNAC
     C                   MOVE      ADR1          WSADC1
     C                   MOVE      ADR2          WSADC2
     C                   EVAL      WSADC3 = ADR3
     C                   EVAL      WSPNC  = *BLANKS
     C     POSTNR        IFEQ      0
     C                   EVAL      WSPNC = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPNC
     C                   END
     C                   IF        SYFOR9 <> *ZEROS
     C                   EVAL      WSRGC = SYRG
     C                   END
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDTUR        BEGSR
      ***********************************************
      *
      * henter neste nummer
      *
     C     WSAVD         CHAIN     SADKMDEF                           33
      *
      * FLYTTER SKJERMVARIABLE TIL FILVARIABLE
      *
     C                   EXSR      MOVWKM
      *
      * 33 ER PÅ VED NY TUR
      *
     C                   IF        *IN33                                        1<-B
     C                   EVAL      KMAVD  = WSAVD
     C                   MOVE      WDT           KMDTR
     C                   WRITE     SADKMDEFR
     C                   ELSE
     C                   UPDATE    SADKMDEFR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTS2KD      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSLKD
     C     KODTS2KC      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSLKC
     C*    KODTS4K       KLIST
     C*                  KFLD                    KS4UNI
     C*                  KFLD                    WSTM
     C     KOFASTkey     KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C     TRKODL01K     KLIST
     C                   KFLD                    UUNIK
     C                   KFLD                    UKODE
      *
     C     *LIKE         DEFINE    KMAVD         UAVD
     C     *LIKE         DEFINE    TKUNIK        UUNIK
     C     *LIKE         DEFINE    TKKODE        UKODE
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVE      'N'           USPED             1
     C                   EVAL      KS2UNI = 'S2'
     C*                  EVAL      KS4UNI = 'S4'
     C                   EVAL      UUNIK  = '106'
     C                   MOVE      'ANK'         UTYPE2            3
     C                   EVAL      WSDTR  = 0
     C                   EVAL      WSATDD = 0
     C                   EVAL      WSATDT = 0
     C                   EVAL      KMDTR  = 0
     C                   EVAL      KMATDD = 0
      *
     C     UTYPE         COMP      'DSP'                                  49
     C     UTYPE         COMP      'CHG'                                  48
      *
     C                   EVAL      WSAVD  = UAVD
     C     UAVD          CHAIN     TELL                               33
     C  N33              EVAL      KMPRO = TETURN
     C     UAVD          CHAIN(N)  SADKMDEF                           33
     C                   IF        *IN33
     C                   EVAL      KMDTR  = 0
     C                   EVAL      KMATDD = 0
     C                   END
     C                   EXSR      MOVKMW
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
