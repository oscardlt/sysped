      *
********************************************************************
      * PRINT FRAKTBREV
      * OBS! VED LAYOUT-ENDRING REKOMP OGSÅ SYFA12B
TMP49 * TIPS V/ENDRING R38: *IN49 ON = PRINT LINJETELLER PÅ SLUTTEN AV HVER LINJE(SØK TMP49 I POS 1)
      **************************************************************
      * INDIKATORER
      * 50 = TOLLPASSFRAKTBREV
      * 51 = FAXBESTILLING
      * 52 = PDF DIREKTEUTSKRIFT
      * 53 = Midlertidig brev for hjelp/kontroll ved lossing
      *
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 alvorlig feil arkivering
10XXX * 02 SH  PTF10 tillater ' ' i mlapp ved kopi
10XXX * 03 SH  PTF10 tollpassfraktbrev
10XXX * 04 JOV PTF10 Mlappkode S -> P ved print (mange printer i forkant/fra andre steder)
10XXX * 05 SH  PTF10 ikke lese på turnummer 0
10XXX * 06 JOV PTF10 Hvis innland hentes utsted.-dato fra HEDTR (evt fra T&T ED2..)
P9XXX * 07 JOV PTF10 BOOKINGREF 2 TIL VENSTRE
P9XXX * 08 JOV PTF10 Ved TOLLPASS er print av GODSNR mm flyttet opp for å forenkle(unngå sidebrudd)
P9XXX * 09 JOV PTF10 Ved bestilling på turnr-via HEAD14(for å få samme rekkef som lasteliste)
      *              DET BØR RYDDES KRAFTIG I BRUK AV UPO IFEQ 'T'... (BRUKES UPO = J AV NOEN ???)
      * 10 JOV PTF10 TG MYPACK via BRING - hardkodet på kundenr 0413898
      * 11 JOV PTF10 R38 - tekst fra Oppdrags notisblokk (R / G) samt fra DOK36(Tr-info)
10172 * 12 SH  PTF10 norsk text til Track and trace
      * 13 SH  PTF10 noen feil i rutinen ettoppdrag
      * 14 SH  PTF10 skriver allikevel merkelapp (selv om utlev-forbehold hindrer brev/edi..)
10188 * 15 JOV PTF10 LABEL PÅ LASER/A4 DERSOM J/P/F I KOPLAS
10188 * 16 JOV PTF10 Frie søkeveier - kode R skal i R38
      * 17 JOV PTF10 skriv fraktbrev basert på oppdrag dersom UPO=O
      * 18 JOV PTF10 Rydde etter PTF09 - Utfør også status U=Utenlands( EDI, print er ikke klar..)
10XXX * 19 YBC PTF10 SEND IFTMIN D.04A TIL BRING (NESTEN SAMME SOM POSTEN D.04A)
      * 20 JOV PTF10 10 ->15 varel. på både Fr.brev/Tollpass(Tp før 5). På bekostn av fritekst..
      * %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      * 21 JOV PTF11 FEIL I SENDNR FRI SØKEVEI dersom tildelt i SYFA12!!
      * 22 SH  PTF11 hvis fraktbrev arkiveres og N i print ikke skriv ut
      * 23 JOV PTF11 Utleveringsforbehold skal ikke indre intern DUP-overføring
      * 24 JOV PTF11 Print farlig gods info fra varelinjenivå i bunnen av R38 - BRINGTMS-prosjekt.
      *    OBS!!!!   Printerfil 6->12 LPI, skriver normalt kun på annenhver linje, men ved MYE INFO
      *              i R38 (=N75) så skrives det på hver linje = dobbelt så tett
      *              foreløpig satt et tak på 30 varelinjer...(+ tekst + ++)
      * 25 JOV PTF11 Index i tillegg til Unnr / embgrp som key i ADRUNNRF
      * 26 JOV PTF11 TOLLPASS FRA WEBLINK - DOKUF-POST FINNES (utvidet / ogå sved vanlif FB)
      * 27 SH  PTF11 videreutviklet etterfrav til å bli oppkrav
      * 28 SH  PTF11 rettelse 27
      * 29 JOV PTF11 Skriv Fvekst også ved mue tekst / ADR
      * 30 SH  PTF11 merker postoppkrav med P i fakda + track & trace
      * 31 JOV PTF11 Liten korr på PTF17
      * %%%%%%
      * 32 JOV PTF12 HVIS VARELINJER FINNES - SKRIV  LINJER UBETINGET - OGSÅ VED 1 !!!
12038 * 33 JOV PTF12 antallsfil utvidet 7.0 -> 10.3  i ADR-registetr
12039 * 34 JOV PTF12 ved LxBxH gitt på varelinjenivå - prioriter det forram DM3/LM
12040 * 35 JOV PTF12 HVIS Sender=Avds kundenr / sett avd/oppdrag som senders ref
      * 36 SH  PTF12 unngå fakturanr hvis ingen linjer
12042 * 37 JOV PTF12 skriv "Advisering: 99999999 " ved ZAD (9999...=SMSnr)
      * 38 SH  PTF12 utøket tmpdm3
12039 * 39 JOV PTF12 Feil i PTF34 / justerer for å få på plass STOOOR volum
12039 * 40 SH  PTF12 bytter fraktbrev i arkiv
12039 * 41 SH  PTF12 div spoolfil
12039 * 42 SH  PTF12 nye parametre til mlapppgm
12XXX * 43 YBC PTF12 AVSENDERS ADR-3 TREFFER OPPDRAGSREF.
      ***************************************************************************************
N22  FCUNDC03   IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E             DISK
S40  F*RKIVl02  IF   E           K DISK
N40  FARKIVl02  UF   E           K DISK
     F                                     RENAME(arkivr:arkiv02r)
     FTRACKF    O  A E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FKODTFT    IF   E           K DISK
     FKODTV     IF   E           K DISK
N17  FKODTFR    IF   E           K DISK
N35  FKODTA     IF   E           K DISK
     FHEADF     UF   E           K DISK
     FHEAD14    IF   E           K DISK
     F                                     RENAME(headfr:hefr14)
     FFIRM      IF   E           K DISK
N27  FFIRKID    IF   E           K DISK
     FTELLFA    UF   E           K DISK
     FFIRFB     UF   E           K DISK
     FFAIN      O  A E             DISK
     FFAK2      IF   E           K DISK
     F                                     RENAME(FAKTR:FAK2R)
     FFAKT      UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FDOKUF     UF   E           K DISK
     FDOKUF1    IF   E           K DISK
     F                                     RENAME(DOKUFR:DOKUFR1)
     FDOKUF2    IF   E           K DISK
     F                                     RENAME(DOKUFR:DOKUFR2)
     FDOKUF4    IF   E           K DISK
     F                                     RENAME(DOKUFR:DOKUFR4)
     FDOKUF5    IF   E           K DISK
     F                                     RENAME(DOKUFR:DOKUFR5)
     FDOKUF6    IF   E           K DISK
     F                                     RENAME(DOKUFR:DOKUFR6)
     FDOKUFV    IF   E           K DISK
N24  FDOKUFVF   IF   E           K DISK
N24  FADRUNNRF  IF   E           K DISK
     FDOKUFM    IF   E           K DISK
     FDOKUDGS   IF   E           K DISK
     FTRAN      UF   E           K DISK
     FFRISOK    IF A E           K DISK
     FKODFRI    IF   E           K DISK
S11  F*OK29     IF A E           K DISK
N11  FDOK29     IF   E           K DISK
N11  FDOK36     IF   E           K DISK
N11  FFREETXT2  IF   E           K DISK
N37  FDOKUFE    IF   E           K DISK
     FKOSTA1    IF   E           K DISK
     FSYFA12FM  CF   E             WORKSTN USROPN
     FSYFA12P   O    E             PRINTER
     FMLAPP     O    F   75        PRINTER OFLIND(*INOA)
     F                                     FORMLEN(30)
     F                                     FORMOFL(30)
     FPAKKET    O    F   75        PRINTER OFLIND(*INOG)
     F                                     FORMLEN(24)
     F                                     FORMOFL(24)
     FLLAPP     O    F   75        PRINTER OFLIND(*INOB)
     F                                     FORMLEN(18)
     F                                     FORMOFL(18)
     FFØLGE     O    F   75        PRINTER OFLIND(*INOC)
     F                                     FORMLEN(24)
     F                                     FORMOFL(24)
     FBEDRIFT   O    F   80        PRINTER OFLIND(*INOF)
     F                                     FORMLEN(30)
     F                                     FORMOFL(30)
      *Array for fjerning av foranstilte 0 i tallverdi
     D NUM             S              1    DIM(9)
      *Array for faste tekster i R.38
     D TX              S             70    DIM(10)
      *Arrays for gebyrlinjer ved etterkrav
     D T               S             20    DIM(10)
     D B               S              9  2 DIM(10)
     D M               S              1    DIM(10)
      *Arrays for merke/varebeskr. fra BL ved sjø-oppdrag
     D MNX             S             17    DIM(20)
     D VSX             S             25    DIM(20)
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  UUSR                 254    263
N43  D                 DS
N43  D  DFAD3S                 1     30
N43  D  DFAD3S26               1     26
     D                 DS
     D  OPDREF                 1     17
     D  XXAVD                  1      4  0
     D  STREK1                 5      5
     D  XXOPD                  6     12  0
     D  STREK2                13     13
     D  DFSG                  14     16
N27  D                 DS
N27  D  WKID                   1     19
N27  D  KIDKUN                 1      8  0
N27  D  KIDFAK                 9     15  0
n27  D  XNULL                 16     19  0
     D                 DS
     D  TURREF                 1     17
     D  HEPRO                  1      8  0
     D  STREK3                 9      9
     D  HEOPD                 10     16  0
     D  HESG                  17     19
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
N24  D                 DS
N24  D  R36VKT                 1      9  0
N24  D  R36VKTX                1      9  0
N24  D                 DS
N24  D  R37DM3                 1      7  0
N24  D  R37DM3X                1      7  0
N34  D                 DS
N34  D DSLBH                   1     18
N34  D  DSLEN                  1      4
N34  D  oxx1                   6      6    inz('x')
N34  D  DSBRD                  7     10
N34  D  oxx2                  12     12    inz('x')
N34  D  DSHOY                 13     16
N34  D  oxx3                  17     18    inz('Cm')
N34  D                 DS
N34  D DSDM3LM                 1     18
E39  D  DSDM3                  1      7
E39  D  DSDMTX                 8     10
N34  D  DSLM                  11     15
E39  D  DSLMTX                16     17
N34   * standalone wrkfelt
s38  D* TmpDm3                        5S 0
n38  D  TmpDm3                        7S 0
     D                 DS
     D  WSOP1                  1      7  0
     D  WSOP2                  8     14  0
     D  WSOP3                 15     21  0
     D  WSOP4                 22     28  0
     D  WSOP5                 29     35  0
     D  WSOP6                 36     42  0
     D  WSOP7                 43     49  0
     D  WSOP8                 50     56  0
     D  WSOP9                 57     63  0
     D  WSOP10                64     70  0
     D  WSOP11                71     77  0
     D  WSOP12                78     84  0
     D  WSOP13                85     91  0
     D  WSOP14                92     98  0
     D  WSOP15                99    105  0
     D  WSOP16               106    112  0
     D  WSOP17               113    119  0
     D  WSOP18               120    126  0
     D  WSOP19               127    133  0
     D  WSOP20               134    140  0
     D  WSOP21               141    147  0
     D  WSOP22               148    154  0
     D  WSOP23               155    161  0
     D  WSOP24               162    168  0
     D  WSOP25               169    175  0
     D  WSOP26               176    182  0
     D  WSOP27               183    189  0
     D  WSOP28               190    196  0
     D  WSOP29               197    203  0
     D  WSOP30               204    210  0
     D  WSOP31               211    217  0
     D  WSOP32               218    224  0
     D  WSOP33               225    231  0
     D  WSOP34               232    238  0
     D  WSOP35               239    245  0
     D  WF                     1    245  0 DIM(35)
     D                 DS
     D  WSD001                 1      3  0
     D  WSD002                 4      6  0
     D  WSD003                 7      9  0
     D  WSD004                10     12  0
     D  WSD005                13     15  0
     D  WSD006                16     18  0
     D  WSD007                19     21  0
     D  WSD008                22     24  0
     D  WSD009                25     27  0
     D  WSD010                28     30  0
     D  WSD011                31     33  0
     D  WSD012                34     36  0
     D  WSD013                37     39  0
     D  WSD014                40     42  0
     D  WSD015                43     45  0
     D  WSD016                46     48  0
     D  WSD017                49     51  0
     D  WSD018                52     54  0
     D  WSD019                55     57  0
     D  WSD020                58     60  0
     D  WSD021                61     63  0
     D  WSD022                64     66  0
     D  WSD023                67     69  0
     D  WSD024                70     72  0
     D  WSD025                73     75  0
     D  WSD026                76     78  0
     D  WSD027                79     81  0
     D  WSD028                82     84  0
     D  WSD029                85     87  0
     D  WSD030                88     90  0
     D  WSD031                91     93  0
     D  WSD032                94     96  0
     D  WSD033                97     99  0
     D  WSD034               100    102  0
     D  WSD035               103    105  0
     D  WU                     1    105  0
     D                                     DIM(35)
N27  D                 DS
N27  D  XFFDTD                 1      2  0
N27  D  XFFDTM                 3      4  0
N27  D  XFFDTÅ                 5      6  0
N27  D  XFFDT                  1      6  0
N27  D                 DS
N27  D  FADAFÅ                 1      4  0
N27  D  FADAFM                 5      6  0
N27  D  FADAFD                 7      8  0
N27  D  FADAFF                 1      8  0
     D                 DS
     D  KFMT1                  1     75
     D  STR                    1     75
     D                                     DIM(75)
      *________________
      * DS for mottaker
      *""""""""""""""""
     D                 DS
     D  DF1004                 1     35
     D  WSSNDN                 1     10
     D  WSSN17                 1     17
     D  WSSN16                 1     16
     D  WSSND1                 1      9
     D  WSSND2                10     10
     D  WSSNDT                11     11
     D                 DS
     D  WS1004                 1     35
     D  WSSNDA                 1      2
     D  WSSNDB                 3      7
     D  WSSNDC                 8     17
     D  WSSNDI                 1     17
      *
     D                 DS
     D  DFBREF                 1     17
N08  D  DFBREFX                1     17
     D  WSBRTX                 1      5
     D  WSBRAV                 6      9
     D  WSBRST                10     10
     D  WSBROP                11     17
N08  D                 DS
N08  D  DFSREF                 1     17
N08  D  DFSREFX                1     17
     D                 DS
     D  OpprDs                 1     17
     D  OpprTx                 1      3
     D  TRAVD0                 4      7  0
     D  OpprSt1                8      8
     D  TROPD0                 9     15  0
     D                 DS
     D  KOVXXX                 1      8
     D  KOVTPK                 2      3
     D  KOVFBS                 4      4
     D  KOVTPS                 5      5
     D  KOVFBK                 6      7
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UEKSP                 62     62
     D  UDT                   64     69  0
V10  D  UOPD                  82     88  0
V10  D  UFBNR                 89     91  0
     D  UPRT6                721    730
     D  UPRT7                741    750
     D  UPRT14               881    890
     D  UGN                  981    995
      *
     D MERKNA          C                   CONST('M E R K N A D E R:')
     D XTETT           C                   CONST('SPEDITØR-ETTERK.')
     D XTSTAN          C                   CONST('ANDRE GEBYRER   ')
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D  XULDDMM                7     10  0
     D  XULÅÅ2                13     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  DFDTUÅÅ                1      4  0
     D  DFDTUÅÅ2               3      4  0
     D  DFDTUMM                5      6  0
     D  DFDTUDD                7      8  0
     D  DFDTU                  1      8  0
     D                 DS
     D  PDATDD                 1      2  0
     D  PDATMM                 3      4  0
     D  PDATÅÅ                 5      6  0
     D  PDATE1                 1      6  0
      *POSTENS BEDRIFTSPAKKE - VISSE FELT LAGRET I FRITEKST
     D                 DS
     D  DFVT1                  1     40
     D  QVT1                   1     40
     D  BEDFLE                 1      7
     D                 DS
     D  DFVT2                  1     40
     D  QVT2                   1     40
     D  BEDDAT                 1      6
     D  BEDDAG                 1      2
     D  BEDMND                 3      4
     D  BEDÅR                  5      6
     D                 DS
     D  DFVT3                  1     40
     D  BEDEXP                 1      1
     D                 DS
     D  DFVT4                  1     40
     D  BEDFR1                 1     28
      *
      *
     C                   EXSR      INIT
      *
      * Send fax
     C     UPO           IFEQ      'F'                                          FAX/ARKIV
     C     UPO           OREQ      'M'                                          MIDLERTIDIG
     C                   EXSR      FAXSR
     C                   GOTO      SLUTT
     C                   END
      *
      *
      * BESTILLING ONLINE VIA WS-BILDE
      *
     C     UVB           IFEQ      'J'
     C     UVB           OREQ      'K'
     C                   OPEN      SYFA12FM
     c     uvb           ifeq      'K'
     C                   move      'N'           wsml
     c                   end
     C                   MOVE      *ZEROS        WF
     C     1             DO        35            NU                2 0
     C                   Z-ADD     1             WU(NU)
     C                   END
     C     START         TAG
     C                   EXFMT     BILDE
     C  N03              DO
     C                   EXSR      TESTB
     C   30              GOTO      START
     C                   EXSR      PRINTB
     C                   END
     C                   CLOSE     SYFA12FM
     C                   GOTO      SLUTT
     C                   END
      *
      *
      * Utvalg via enkeltoppdrag??
      *
     C     UOPD          IFNE      *ZEROS
     C                   Z-ADD     UAVD          YAVD
     C                   Z-ADD     UOPD          YOPD
     C     HEADFK        CHAIN(N)  HEADF                              33
S18  C*    *IN33         IFNE      '1'
S18  C*                  EXSR      ETTOPPDRAG
S18  C*    LETVIDERE     IFEQ      'N'
S18  C*                  GOTO      SLUTT
S18  C*                  END
S18  C*                  END
N18  C  N33              EXSR      ETTOPPDRAG
N18  C                   GOTO      SLUTT
     C                   END
      *
N09   * via TURNUMMER
N09  C     UPO           IFEQ      'T'
N09  C     UPRO          IFNE      *ZEROS
N09  C     UPRO          SETLL     head14
N09  C     UPRO          READE     head14                                 33
N09  c     *in33         doweq     '0'
N09  C                   Z-ADD     HEAVD         YAVD
N09  C                   Z-ADD     HEOPD         YOPD
N09  C                   EXSR      ETTOPPDRAG
N09  C     UPRO          READE     head14                                 33
N09  C                   enddo
N09  C                   END
N09  C                   GOTO      SLUTT
N09  C                   END
      *
      * Utvalg via DOKUF med status ' ' + "Filter"
      * ALLTID EN AVD. Enten sortert stigende på oppdnr/fb.nr, eller postnr
      * Leser spesifikt på gitt signatur hvis ikke "ALL"
     C     USG           IFNE      'ALL'
     C     UPO           IFNE      'J'
     C     YSTSGAVD      SETLL     DOKUF4                                       Stat/Sign/avd/oppdr.
     C                   ELSE
     C     YSTSGAVD      SETLL     DOKUF5                                       Stat/Sign/avd/postnr
     C                   ENDIF
     C                   ELSE
     C     UPO           IFNE      'J'
S18   * Tur ER håndtert lenger opp
S18  C*    UPO           IFEQ      'T'
s18  C*    ' '           SETLL     DOKUF1                                       På tvers av avdeling
S18  C*                  ELSE
     C     YSTAVD        SETLL     DOKUF1                                       Stat/avd/oppdr...
S18  C*                  END
     C                   ELSE
     C     YSTAVD        SETLL     DOKUF2                                       Stat/avd/postnr..
     C                   ENDIF
     C                   ENDIF
      *
     C     START2        TAG
      *
     C     USG           IFNE      'ALL'
     C     UPO           IFNE      'J'
     C     YSTSGAVD      READE     DOKUF4                                 33
     C                   ELSE
     C     YSTSGAVD      READE     DOKUF5                                 33
     C                   ENDIF                                                  <UPO
     C                   ELSE
     C     UPO           IFNE      'J'
S18   * Tur ER håndtert lenger opp
S18  C*    UPO           IFEQ      'T'
S18  C*    ' '           READE     DOKUF1                                 33
S18  C*                  ELSE
     C     YSTAVD        READE     DOKUF1                                 33
S18  C*                  END
     C                   ELSE
     C     YSTAVD        READE     DOKUF2                                 33
     C                   ENDIF                                                  <UPO
     C                   ENDIF
     C   33              GOTO      SLUTT
      *
      *  Aktuelt fraktbrev er lest Hent oppdrag
     C                   Z-ADD     DFAVD         YAVD
     C                   Z-ADD     DFOPD         YOPD
     C     START3        TAG
     C                   SETOFF                                       32
     C     HEADFK        CHAIN(N)  HEADF                              3632
     C   36              GOTO      START2
     C   32              DO
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      START3
     C                   END
S18   *
S18   * denne ER håndtert lenger opp - leseloop på HEAD14
S18   * ALT PÅ EN TUR???
S18  C*    UPO           IFEQ      'T'
S18  C*    UPRO          IFNE      HEPRO
S18  C*    HEPRO         OREQ      *ZEROS
S18  C*                  GOTO      START2
S18  C*                  END
S18  C*                  ELSE
S18   * ELLER.. SKJEKKER OM TURNR ELLER OPPDR.NR  ER TASTET
S18  C*    UPRO          IFNE      0
S18  C*    UPRO          ANDNE     HEPRO
S18  C*                  GOTO      START2
S18  C*                  END
S18  C*    UOPD          IFNE      0
S18  C*    UOPD          ANDNE     HEOPD
S18  C*                  GOTO      START2
S18  C*                  END
S18  C*                  END
      *
      * SKJEKKER OM GODSNR ER TASTET
     C     UGN           IFNE      *BLANKS
     C     UGN           IFNE      HEGN
     C                   GOTO      START2
     C                   END
     C     UDT           IFNE      0
     C     UDT8          ANDGT     HEDTOP
     C                   GOTO      START2
     C                   END
     C                   END
      *
      * TESTE STATUS VED ETTERKRAV
     C     DFKDE         IFEQ      'X'
     C     HEST          ANDNE     ' '
     C                   GOTO      START2
     C                   END
      *
     C* UTLEV.FORB.H. SOM IKKE ER AVKVITTERT - HVIS EDI  /IKKE SEND
     C     HEFT1A        IFNE      *BLANKS                                       FORBEH...
     C     HEKFT1        ANDEQ     *BLANKS                                       IKKE KVITTE
     C     DFCMN         ANDNE     ' '                                           IKKE PÅ...
     C     DFCMN         ANDNE     'N'                                             PAPIR...
     c     uvb           andne     'K'
n23  C     TRAKEY        CHAIN(N)  TRAN                               39
n23  c     *in39         IFEQ      *ON                                           men hvis DUP, OK
n23  C     VMLAYO        orne      'DU'                                          ikke DUP=ikke send
     C                   GOTO      START2
n23  C                   END
     C                   END
      *
      * Hent DOKUF i update-mode/skriv.
     C     START4        TAG
     C                   SETOFF                                       32
     C     DOKUFX        CHAIN     DOKUF                              3632
     C   36              GOTO      START2
     C   32              DO
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      START4
     C                   END
      **
     C                   EXSR      HOVED
      * Flere??
     C                   GOTO      START2
      *
      *
     C     SLUTT         TAG
     C                   MOVE      XPRANT        UPRANT
      * legg tilbake UDS-signatur (når "ALL" er simulert")
     C     UPO           IFEQ      'T'
     C                   MOVE      USGGM         USG
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     ETTOPPDRAG    BEGSR
      ***********************************************
S18  C**                 MOVE      'J'           LETVIDERE         1
s13  C* UTLEV.FORB.H. SOM IKKE ER AVKVITTERT - HVIS EDI  /IKKE SEND
s13  C*    HEFT1A        IFNE      *BLANKS                                       FORBEH...
s13  C*    HEKFT1        ANDEQ     *BLANKS                                       IKKE KVITTE
s13  C*    DFCMN         ANDNE     ' '                                           IKKE PÅ...
s13  C*    DFCMN         ANDNE     'N'                                             PAPIR...
s13  c*    uvb           andne     'K'
s13  C*                  MOVE      'N'           LETVIDERE
s13  C*                  GOTO      UTETTOPD
s13  C*                  END
      * SKRIV ALLE UUTSKREVNE FRAKTBREV PÅ AKTUELT OPPDRAG
N18  c     ettOpp        tag
     C     UPO           IFNE      'J'
     C     DOKUFZ        SETLL     DOKUF1
     C     DOKUFZ        READE     DOKUF1                                 33
     c                   else
     C     dokufz6       SETLL     DOKUF6
     C     dokufz6       READE     DOKUF6                                 33
     c                   end
      * fant inget vanlig/status blank - prøv status U = Utenlads-brev(EDI , print blir jo kål)
N18  C     *in33         ifeq      '1'
N18  C     YST1          andeq     ' '
N18  c                   move      'U'           Yst1                           Utenlands???
N18  c                   goto      ettOpp
N18  c                   endif
     C     *IN33         DOWEQ     '0'
n13  C     start4b       tag
     C     DOKUFX        CHAIN     DOKUF                              3632
     C     *IN36         IFEQ      *OFF
     C   32              DO
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
s13  C*                  GOTO      START4
n13  C                   GOTO      START4B
     C                   END
S18  C*                  MOVE      'N'           LETVIDERE
n13  C* UTLEV.FORB.H. SOM IKKE ER AVKVITTERT - HVIS EDI  /IKKE SEND
n13  C     HEFT1A        IFNE      *BLANKS                                       FORBEH...
n13  C     HEKFT1        ANDEQ     *BLANKS                                       IKKE KVITTE
n13  C     DFCMN         ANDNE     ' '                                           IKKE PÅ...
n13  C     DFCMN         ANDNE     'N'                                             PAPIR...
n13  c     uvb           andne     'K'
S18  C*                  MOVE      'N'           LETVIDERE
n14  c     dfkdme        ifeq      'S'
n14  c                   exsr      merksr
n14  c                   end
n23  C     TRAKEY        CHAIN(N)  TRAN                               39
n23  c     *in39         IFEQ      *ON                                           men hvis DUP, OK
n23  C     VMLAYO        orne      'DU'                                          ikke DUP=ikke send
n13  C                   GOTO      LESNESTE
n23  C                   END
n13  C                   END
     C                   EXSR      HOVED
     C                   END
n13  C     lesneste      tag
     C     UPO           IFNE      'J'
     C     DOKUFZ        READE     DOKUF1                                 33
     c                   else
     C     dokufz6       READE     DOKUF6                                 33
     C                   END
     C                   END
N18  c                   move      ' '           Yst1
     C     UTETTOPD      ENDSR
      *
      ***********************************************
     C     TESTB         BEGSR
      ***********************************************
     C                   Z-ADD     1             XN                2 0
     C                   SETOFF                                       30
     C                   Z-ADD     UAVD          YAVD
      *
     C     XN            DOWLE     35
     C     WF(XN)        IFNE      0
     C                   Z-ADD     WF(XN)        YOPD
     C     HEADFK        CHAIN(N)  HEADF                              30
     C   30              MOVE      'SPO0002'     MSGNR
     C   30              GOTO      SLTB
      *
     C                   Z-ADD     WU(XN)        YFBNR
     C     DOKUFK        CHAIN(N)  DOKUF                              30
      * Tr-modul innland  og kun merkelapp trenger ikke fraktbrev
     c     *in30         ifeq      '1'
     c     WSFB          andne     'J'
     c     HXSNDN        andne     *blanks
     c                   setoff                                       30
     c                   end
     C   30              MOVE      'SHU0501'     MSGNR
     C   30              GOTO      SLTB
      *
      * Test om det er 'P' på DFST  ved kopiutskrift
     C                   IF        UVB = 'K'
     C                   IF        WSFB = 'J'
     C     DFST          COMP      'P'                                3030
     C   30              MOVE      'SHU0502'     MSGNR
     C   30              GOTO      SLTB
     C                   END
     C                   ELSE
      * Ved original testes....
     C     DFST          COMP      ' '                                3030
     C   30              MOVE      'SHU0502'     MSGNR
     C   30              GOTO      SLTB
      *
     C     DFKDE         IFEQ      'X'
     C     HEST          ANDNE     ' '
     C                   SETON                                        30
     C   30              MOVE      'SHU0503'     MSGNR
     C   30              GOTO      SLTB
     C                   END
     C                   END
      *
     C     UKODE         IFEQ      'T'
     C     DFTOLL        COMP      0                                      30
     C                   ELSE
     C     DFTOLL        COMP      0                                  3030
     C                   END
     C   30              MOVE      'SHU0504'     MSGNR
     C   30              GOTO      SLTB
      *
      *
     C                   END
     C                   ADD       1             XN
     C                   END
      *
     C     SLTB          ENDSR
      *
      ******************************************
     C     FAXSR         BEGSR
      ******************************************
     C                   MOVE      *ON           *IN51
     C     UPO           IFEQ      'M'
     C                   MOVE      *OFF          *IN51
     C                   MOVE      *ON           *IN53
     C                   END
     C                   MOVE      'K'           UVB
     C                   Z-ADD     UAVD          YAVD
V10  C*                  MOVEL     UPRO          YOPD
     c                   movel     UPRO          YPRO
V10  C*                  MOVE      UPRO          YFBNR
V10  C                   MOVE      UOPD          YOPD
V10  C                   MOVE      UFBNR         YFBNR
      *
     c
     C     STPRBF        TAG
     C                   SETOFF                                       32
     C     HEADFK        CHAIN(N)  HEADF                              3032
     C   32              DO
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      STPRBF
     C                   END
      *
N26   * utskrift fra web vil oftest togså ha skapt dokuf (fra okt 2015..) ...
N26  C     URLOPD        IFEQ      'J'
N26  C     DOKUFK        CHAIN(N)  DOKUF                              33
N26  C  N33              MOVE      ' '           URLOPD
N26  C                   ENDIF
N17   * UPO = O = SKAP PDF BASERT PÅ OPPDRAG UTEN AT DOKUF TRENGS FINNES
N17  C     URLOPD        IFEQ      'J'
N17  C                   EXSR      HE2DF
N17  C                   ELSE
     C     DOKUFK        CHAIN     DOKUF                              3032
     C     *IN30         IFEQ      *ON
     C     *IN53         ANDEQ     *ON                                      Midlertidig Fbr
     C                   GOTO      UTFAX
     C                   END
     C   30              GOTO      faxtur
      *
      * oppdaterer dato hvis fax er første som gjøres med fraktbrev
      *
     c  n30dfdtu         ifeq      *zeros
     c                   move      uldt          dfdtu
n06  c     uldtI         ifne      *zeros
n06  c                   move      uldtI         dfdtu
n06  c                   endif
     c                   update    dokufr
     C     DOKUFK        CHAIN     DOKUF                              3032
     c                   end
     c*
     c*
     C   30              goto      utfax
     c*
N17  C                   END
N26   * Hent faste tekster til R-38
N26  C                   CALL      'SYFA12F'
N26  C                   PARM                    UFIRM
N26  C                   PARM                    DFAVD
N26  C                   PARM                    DFOPD
N26  C                   PARM                    DFFBNR
N26  C                   PARM                    U38TXT          700
N26  C                   MOVEA     U38TXT        TX
      *
     c*
     C  N30              EXSR      HOVED
      *
N01  C                   goto      utfax
      *
      * prøver å faxe for en hel tur
      *
     C     faxtur        tag
      *
     C                   z-add     1             yfbnr
     c                   setoff                                       33
N05  c     ypro          ifne      0
     C     TURKE         SETLL     head14
     C     *in(33)       doweq     '0'
     C     TURKE         READE     head14                                 33
     c     *in(33)       ifeq      '0'
     C     DOKUFK        CHAIN     DOKUF                              3032
      *
      * oppdaterer dato hvis fax er første som gjøres med fraktbrev
      *
     c  n30dfdtu         ifeq      *zeros
     c                   move      uldt          dfdtu
n06  c     uldtI         ifne      *zeros
n06  c                   move      uldtI         dfdtu
n06  c                   endif
     c                   update    dokufr
     C     DOKUFK        CHAIN     DOKUF                              3032
     c                   end
     c*
     C  N30              EXSR      HOVED
     c                   setoff                                       33
     c                   end
     c                   end
N05  c                   end
     c*
     C     UTFAX         ENDSR
      *
N17   ******************************************
N17  C     HE2DF         BEGSR
N17   ******************************************
N17   * FAKER DF-DATA BASERT PÅ HEADF (INNLAND)
N17  c                   move      'F'           DFRI
N17  c                   move      HEAVD         DFAVD
N17  c                   move      HEOPD         DFOPD
N17  c     YFBNR         ifeq      *zeros
N17  c                   z-add     1             YFBNR
N17  c                   endif
N17  c                   move      YFBNR         DFFBNR
N17  c                   move      HEDTOP        DFDTU
N17  C                   MOVEL     HENAS         DFNAVS
N17  C                   MOVEL     HEADS1        DFAD1S
N17  C                   MOVEL     HEADS3        TMPPUL            4
N17  C                   TESTN                   TMPPUL               34
N17  C     *IN34         IFEQ      '1'
N17  C                   MOVE      TMPPUL        DFPNLS
N17  C                   end
N17  C                   MOVE      HEADS3        TMPAD325         25
N17  C                   MOVEL     TMPAD325      DFAD3S
N17  C                   MOVEL     HENAK         DFNAVM
N17  C                   MOVEL     HEADK1        DFAD1M
N17  C                   MOVEL     HEADK3        DFAD3M
N17  C                   MOVEL     HENAK         DFNAVL
N17  C                   MOVEL     HEADK1        DFAD1L
N17  C                   MOVE      *ZEROS        DFPOUL                          UTL.POSTNR
N17  C                   MOVEL     HEADK3        TMPPUL            4
N17  C                   TESTN                   TMPPUL               34
N17  C     *IN34         IFEQ      '1'
N17  C                   MOVE      TMPPUL        DFPOUL                          UTL.POSTNR
N17  C                   MOVE      HEADK3        TMPAD325         25
N17  C                   MOVEL     TMPAD325      DFADUL
N17  C                   else
N17  C                   MOVEL     HEADK3        DFADUL
N17  C                   end
N17   * Tilsted er TERMINAL-postnr - leveres til terminal
N17   * hardkodet for ramberg - bør vedlikeholdes i parameter/dedikert fil over terminaladresse
N17  c     HESDT         ifeq      '3000'
N17  c     HESDT         oreq      '3020'
N17  c     HESDVT        oreq      '3000'
N17  c     HESDVT        oreq      '3020'
N17  c                   eval      DFNAVL = %subst(HENAA:1:9)
N17  c                                    + ' C/O RAMBERG TERMINAL'
N17  c                   eval      DFAD1L ='SVEND HAUGS GT 11'
N17  c                   eval      DFPOUL = 3013
N17  c                   eval      DFADUL ='DRAMMEN'
N17  c                   endif
N17  c     HESDT         ifeq      '1000'
N17  c     HESDT         oreq      '2018'
N17  c     HESDVT        oreq      '1000'
N17  c     HESDVT        oreq      '2018'
N17  c                   eval      DFNAVL = %subst(HENAA:1:9)
N17  c                                    + ' C/O RAMBERG TERMINAL'
N17  c                   eval      DFAD1L ='GNEISV. 4'
N17  c                   eval      DFPOUL = 2020
N17  c                   eval      DFADUL ='SKEDSMOKORSET'
N17  c                   endif
N17  c     HESDT         ifeq      '1405'
N17  c     HESDT         oreq      '1418'
N17  c     HESDVT        oreq      '1405'
N17  c     HESDVT        oreq      '1418'
N17  c                   eval      DFNAVL = %subst(HENAA:1:9)
N17  c                                    + ' C/O RAMBERG TERMINAL'
N17  c                   eval      DFAD1L ='SNIPTJERNVEIEN 2'
N17  c                   eval      DFPOUL = 1405
N17  c                   eval      DFADUL ='SKEDSMOKORSET'
N17  c                   endif
N17   *    Belastningskode utfra CC/PP på frankatur
N17  C     KODFRK        CHAIN     KODTFR                             33
N17  C                   SELECT
N17  C     KFRCP         WHENEQ    'PP'
S31  C*    KFRCP         OREQ      'S '
N31  C     HEFR          OREQ      'S '
N17  C                   MOVEL     'S'           DFBELA            1
N17  C     KFRCP         WHENEQ    'CC'
S31  C*    KFRCP         OREQ      'M '
N31  C     HEFR          OREQ      'M '
N17  C                   MOVEL     'M'           DFBELA
N17  C                   OTHER
N17  C                   MOVEL     'S'           DFBELA
N17  C                   END
N17  C                   MOVEL     HERFA         DFSREF
N26  C                   MOVEL     HERFK         DFMREF
N17  C                   EVAL      DFNAT  = FIKRTN                              Transp=Eget Firma???
N17  C                   EVAL      DF1004 = %subst(HXSNDN:4:17)
N17  C                   EVAL      DFGM   = HEGM1
N17  C                   EVAL      DFGM2  = HEGM2
N17  C                   EVAL      DFNT   = HENT
N17  C                   EVAL      DFVS   = HEVS1
N17  C                   EVAL      DFVS2  = HEVS2
N17  C                   EVAL      DFVKT  = HEVKT
N17  C                   EVAL      DFM3   = HEM3
N17  C                   EVAL      DFLM   = HELM
N26  C                   EVAL      DFVKTF = HEFBV
N17  c*
N17  C                   ENDSR
      ******************************************
     C     PRINTB        BEGSR
      ******************************************
     C                   Z-ADD     1             XN
     C                   Z-ADD     UAVD          YAVD
      *
     C     XN            DOWLE     35
     C     WF(XN)        IFNE      0
     C                   MOVE      WF(XN)        YOPD
     C                   Z-ADD     WU(XN)        YFBNR
      *
     C     STPRB         TAG
     C                   SETOFF                                       32
     C     HEADFK        CHAIN(N)  HEADF                              3032
     C   30              GOTO      SLPRT
     C   32              DO
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      STPRB
     C                   END
      *
     C     HEPRO         COMP      *ZEROS                                 88
      * SJEKK OM KOSTNADSFØRING BRUKES.
      * HVIS DEN BRUKES, SKAL REF BRUKES SOM OM HEPRO = 0
     C     HEPRO         IFGT      *ZEROS
     C     'O'           SETLL     KOSTA1                             90
     C     *IN90         IFEQ      *OFF
     C                   MOVE      *ON           *IN88
     C                   ENDIF
     C                   ENDIF
      *
     C     ALLFOR        IFEQ      'J'
     C     DOKUFY        SETLL     DOKUF
     C                   END
     C     STPRB2        TAG
     C                   SETOFF                                       32
     C     ALLFOR        IFNE      'J'
     C  N30DOKUFK        CHAIN     DOKUF                              3032
      * Kun merkelapp   Tr-modul innland - trenger ikke fraktbrev (LABEL BASERT PÅ HEADF)
     c     *in30         ifeq      '1'
     c     WSFB          andne     'J'
     c     HXSNDN        andne     *blanks
     c                   setoff                                       30
     c                   MOVE      'S'           DFKDME
     c                   MOVE      *ZEROS        DFTRAN
     c                   MOVE      HEAVD         DFAVD
     c                   MOVE      HEOPD         DFOPD
     c                   MOVE      *ZEROS        DFFBNR
     c                   MOVE      'HE'          VMLAYO
     c                   end
      * Kun merkelapp, fraktbrevet finnes, men er et DUP-fraktbrev (kolli ligger på distr..)
     c     *in30         ifeq      '0'
     c     WSFB          andne     'J'
     c     WSBRTX        andeq     'U.op:'
     c                   MOVE      'S'           DFKDME
     c                   MOVE      *ZEROS        DFTRAN
     c                   MOVE      WSBRAV        DFAVD
     c                   MOVE      WSBROP        DFOPD
     c                   MOVE      *ZEROS        DFFBNR
     c                   MOVE      'HE'          VMLAYO
     c                   end
     C                   ELSE
     C     DOKUFY        READE     DOKUF                                  30
     C                   END
      *
     C   30              GOTO      SLPRT
     C   32              DO
     C                   Z-ADD     5             USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      STPRB2
     C                   END
      *
     C     UVB           IFNE      'K'
     C     DFST          COMP      ' '                                3030
     C                   END
      *
     C* UTLEV.FORB.H. SOM IKKE ER AVKVITTERT - HVIS EDI  /IKKE SEND
     C  N30HEFT1A        IFNE      *BLANKS                                       FORBEH...
     C     HEKFT1        ANDEQ     *BLANKS                                       IKKE KVITTE
     C     DFCMN         ANDNE     ' '                                           IKKE PÅ...
     C     DFCMN         ANDNE     'N'                                             PAPIR...
     c     uvb           andne     'K'
n23  C     TRAKEY        CHAIN(N)  TRAN                               39
n23  c     *in39         IFEQ      *ON                                           men hvis DUP, OK
n23  C     VMLAYO        orne      'DU'                                          ikke DUP=ikke send
     C                   MOVE      '1'           *IN30
N23  C                   END
     C                   END
      *
     C   30              GOTO      SLPRT
      *
      * KALLER OPP PRINTRUTINEN
     c     wsfb          ifne      'N'
     C                   EXSR      HOVED
     c                   else
     c     wsml          ifeq      'J'
     c                   exsr      merksr
     c                   end
     c                   end
      *
     C     ALLFOR        IFEQ      'J'
     C                   GOTO      STPRB2
     C                   END
     C                   END
     C                   ADD       1             XN
     C                   END
      *
     C     SLPRT         ENDSR
      *
     C***********************************************
     C     GETSND        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       XOVERM            1
     C*
     C     DFFBNR        IFEQ      1
     C*  dersom det finne EN og bare en  IFB, så benytt dette
     C                   MOVE      DFAVD         FSAVD
     C                   MOVE      DFOPD         FSOPD
     C                   MOVE      'IFB'         FSKODE
     C     FRIKEYIFB     setll     FRISOK
     C     FRIKEYIFB     reade     FRISOK                                 33
     C     *in33         IFEQ      *OFF
     C     FRIKEYIFB     reade     FRISOK                                 33
     C     *in33         IFEQ      *ON
     C                   MOVEL     FSSOK         DF1004
     C                   goto      SlGetS
     C                   end
     C                   end
     C                   end
      * HENTER FRAKTBREVNUMMER
      *  PRIMÆRT FRA AKTUELL TRANSPORTØR/SEKUNDÆRT FRA FIRMA
     C* DET MESTE AV SR OMSKREVET...
     C                   MOVE      *ZEROS        VMRECN
     C     TRAKEY        CHAIN     TRAN                               89
     C     *IN89         IFEQ      '0'
     C     VMRECM        IFEQ      0
     C     VMRECM        ORGT      VMRECN
     C     VMRECN        IFNE      *ZEROS
     C                   ADD       1             VMRECN
     C                   END
     C                   UPDATE    TRANR
     C                   ELSE
     C                   UPDATE    TRANR
     C                   MOVE      'J'           XOVERM
     C                   GOTO      SLGETS
     C                   END
     C                   END
      *
      * FREMDELES 0 - SJEKK FIRMA...
     C     VMRECN        IFEQ      *ZEROS
     C     FIFIRM        CHAIN     FIRFB                              89
     C     *IN89         IFEQ      '0'
     C     FIRECN        IFNE      *ZEROS
     C                   ADD       1             FIRECN
     C                   MOVE      FIRECN        VMRECN
     C                   MOVE      FISNLA        VMSNLA
     C                   MOVE      FISNLE        VMSNLE
     C                   END
     C                   UPDATE    FIRFBR
     C                   END
     C                   END
      *
     C* OPPDATER KUN HVIS ULIK 0.
     C     VMRECN        IFNE      *ZEROS
     C                   MOVE      VMRECN        WSSND1
     C                   MOVE      *ZEROS        XBAK              1 0
     C                   MOVE      *ZEROS        UPAR21           21
     C                   MOVE      WSSND1        UPAR21
      * POSTEN HAR IKKE MODULUS 10, MEN MODULUS 11
     c*
     C     VMSNLA        IFEQ      *ZEROS
     C                   CALL      'SYGE09'
     C                   PARM                    UPAR21
     C                   PARM                    XBAK
     C                   ELSE
     C                   MOVEL     VMRECN        WSSNDC
     C                   MOVE      VMSNLA        WSSNDA
     C                   MOVE      VMSNLE        WSSNDB
     C                   MOVE      *ZEROS        UAN22            22
     C                   MOVE      WSSNDI        UAN22
     C                   CALL      'SYGE08'
     C                   PARM                    UAN22
     C                   MOVE      UAN22         WSSNDI
     C                   MOVEL     WS1004        DF1004
     C                   MOVE      WSSNDC        WSSNDN
     C                   MOVE      WSSNDI        XBAK
     C                   END
     C                   ENDIF
     C                   MOVE      XBAK          WSSND2
N21
N21   * snuing flyttet forran lagring av fri søkevei..
N21   * SNUR OM HVIS SENDINGSNUMEMR ER 17 TEGN
N21  C     VMSNLA        IFNE      *ZEROS
N21  C                   MOVE      WSSNDN        WSSNDC
N21  C                   MOVE      VMSNLA        WSSNDA
N21  C                   MOVE      VMSNLE        WSSNDB
N21  C                   MOVEL     WS1004        DF1004
N21  C                   END
      * OGSÅ FRI SØKEVEI..
     C                   MOVE      DFAVD         FSAVD
     C                   MOVE      DFOPD         FSOPD
     C                   MOVE      'IFB'         FSKODE
     C                   MOVEL     DF1004        FSSOK
     C     FSKEY         CHAIN     FRISOK                             89
     C   89FSKODE        CHAIN     KODFRI                             33
     C   89              IF        *IN33
     C                   MOVE      *BLANKS       FSDOKK
     C                   ELSE
     C                   MOVE      KFSODK        FSDOKK
     C                   END
     C   89              MOVE      HEDTOP        FSDTOP
     C   89              WRITE     FRISOKR
S21   *
S21   * snuing flyttet forran lagring av fri søkevei..
S21   * SNUR OM HVIS SENDINGSNUMEMR ER 17 TEGN
S21  C*    VMSNLA        IFNE      *ZEROS
S21  C*                  MOVE      WSSNDN        WSSNDC
S21  C*                  MOVE      VMSNLA        WSSNDA
S21  C*                  MOVE      VMSNLE        WSSNDB
S21  C*                  MOVEL     WS1004        DF1004
S21  C*                  END
     C     SLGETS        TAG
     C                   ENDSR
      ******************************************
     C     HOVED         BEGSR
      ******************************************
      *
      * Ukode = T, KJØR  TOLLPASS, 50 ON./ ellers (F) KJØR FRAKTBREV 50 OFF
     C     UKODE         COMP      'T'                                    50
     C     *IN50         IFEQ      *ON
     C     DFTOLL        ANDEQ     *ZEROS
     C                   EXCEPT    DUMDOK
     C                   GOTO      UTHOVED
     C                   END
     C     *IN50         IFEQ      *OFF
     C     DFTOLL        ANDNE     *ZEROS
     C                   EXCEPT    DUMDOK
     C                   GOTO      UTHOVED
     C                   END
N35   * Fra V12-Senders Ref fra oppdraget-> sneder ref i fr.brev.  Dette er OK ved REN INNLAND.
N35   * MEN mange som har både innland OG spedisjon får problem
N35   * dersom avdelingens kundenr er avsender kan en betrakte det som spedisjon - overstyr
N35   * (denne logikk burde kanskje inn i SYFI10A mm - men enklere å overstyre brutalt..)
N35  c                   if        HEUR = 'H' and DFSREF = HERFA
N35  c     KODTAK        chain     KODTA
N35  c                   if        %found (kodta)
N35  c                             and KOAKNR = DFKNSS
N35  c                   eval      DFSREF = *blanks                             = settes lenger ned
N35  c                   endif
N35  c                   endif
N06   * utsteder i innland er oppdragsgiver,og Utstedelsesdato er dermed avvikende
N06  c                   move      *zeros        ULDTI             8 0
N06  c     HXSNDN        IFNE      *blanks
N06  c                   move      HEDTR         ULDTI             8 0
N06  c                   move      HEAVD         TTAVD
N06  c                   move      HEOPD         TTOPD
N06  c                   call      'SYGE46'
N06  c                   parm                    TTAVD
N06  c                   parm                    TTOPD
N06  c                   parm                    xxxBNR            3 0
N06  c                   parm      'ED2'         TTACTI
N06  c                   parm      'F'           xxtype            1
N06  c                   parm                    xxdate            8 0
N06  c                   parm                    xxtime            6 0
N06  C                   parm                    xxant             5 0
N06  c     xxdate        ifne      *zeros
N06  C                   move      xxdate        ULDTI
N06  c                   end
N06  c                   endif
      * Utføre Dup FØR print slik at referanse kommer med...
     C     UVB           IFNE      'K'
     C     DFCMN         ANDEQ     'Y'
     C     WSBRTX        ANDNE     'U.op:'
     C     TRAKEY        CHAIN(N)  TRAN                               39
     c     *in39         IFEQ      *OFF
     C     VMLAYO        ANDEQ     'DU'
     C                   EXCEPT    DUMDOK
     C                   Move      'N'           XXVIS             1
     C     ELTRON        IFEQ      'J'
     C                   Move      'E'           XXVIS             1            Lån XXVIS for LABTYP
     C                   END
     C                   CALL      'SYTR11'
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    XXVIS
     C     DOKUFX        CHAIN     DOKUF                              3632
     C                   END
     C                   END
      * Evt peker til bestillende oppdrag...
     C     DFBref        Ifeq      *blanks
     C     TRopd0        andne     *zeros
     C                   move      OpprDS        DFBref
     C                   end
      *
      * SETT VISSE INDIKATORE SOM STYRER UTSKRIFT
      *
      * Etterkrav (SOM FAKTURA mot transportør)
     C     DFKDE         COMP      'X'                                    61
      *
      * VARE-ETTERKRAV / COD (GJERNE PÅ VEGNE AV SENDER)
     C     *IN61         IFEQ      '0'
     C     DFBELE        ANDNE     *ZEROS
      * KONTO..
     C                   MOVE      DFPRO2        EBANKG
     C                   EVAL      DFPRO2 = 'OBS! ** ETTERKRAV / COD ** OBS!'
      * LEV-INSTRUKS
     C                   MOVEL     DFLEVI        TELEFON          15
     C                   EVAL      DFLEVI = 'E.KRAV/COD!! Tlf: '+TELEFON
     C                   END
N37   * ZAD i DFPRO1 = Rambberg advisering..
N37  c                   if        DFPRO1 = 'ZAD'
N37  C                   eval      FE_N3035 = 'DP'
N37  C     DOKUFEKEY     CHAIN     DOKUFE                             33
N37  C   33              eval      FE_N3035 = 'CN'
N37  C   33DOKUFEKEY     CHAIN     DOKUFE                             33
N37  C                   if        *in33='0' and FE_C3148D<>*blanks
N37  c                   eval      DFPRO1 = 'ZAD Advisering: ' + FE_C3148D
N37  C                   endif
N37  C                   endif
      *Belastes: 46 ON=Sender, 47 ON=Mottaker 48 ON=Annen
     C     DFBELA        COMP      'S'                                    46
     C     DFBELA        COMP      'M'                                    47
     C     DFBELA        COMP      'A'                                    48
      *
      * HVIS PROSJ = 0 BENYTT AVD/OPD SOM REF  (88 ON)
     C     HEPRO         COMP      *ZEROS                                 88
      * HVIS KOSTNADSFØRING BRUKES, SKAL AVD/OPD BRUKES SELV OM TURNR FINNES
     C     *IN88         IFEQ      *OFF
     C     'O'           SETLL     KOSTA1                             90
     C     *IN90         IFEQ      *OFF
     C                   MOVE      *ON           *IN88
     C                   ENDIF
     C                   ENDIF
      * Hvis Senders REF blank. sett avd/oppd/sign
      * eller turnr + opdnr (hvis på tur og ikke bruk av kostn.modul)
     C                   MOVE      DFAVD         XXAVD
     C                   MOVE      DFOPD         XXOPD
     C     DFSREF        IFEQ      *BLANKS
     C     *IN88         IFEQ      '1'
     C                   MOVE      OPDREF        DFSREF
     C                   ELSE
     C                   MOVE      TURREF        DFSREF
     C                   END
     C                   END
      *
     C     HETRM         COMP      *ZEROS                             4040
N08  C  N40HETRC         COMP      *ZEROS                             4040
N08  C   40*IN50         IFEQ      '1'
N08  C                   ADD       1             LINJE
N08  C                   ENDIF
      *
     C     HEKFT1        COMP      *BLANKS                                45
     C   45HEFT1A        COMP      *BLANKS                            4545
      *
     C     HEPOS2        COMP      *ZEROS                             3737
      *
      *
     C     WSSND1        IFEQ      *ZEROS
     C     WSSND1        OREQ      *BLANKS
     C     FIFBNR        IFEQ      'J'
     C     FIFBNR        OREQ      'U'
     C                   EXSR      GETSND
      * Fikk ikke tildelt nr. hverken fra transp.eller firma...
     C     XOVERM        IFEQ      'J'
     C                   MOVE      'X'           DFST
     C                   EXCEPT    OVMDOK
     C                   GOTO      UTHOVED
     C                   END
     C                   END
     C                   Else
      * NR finnes, sørg for at  det ligger i FRISOK
     C                   MOVE      DFAVD         FSAVD
     C                   MOVE      DFOPD         FSOPD
     C                   MOVE      'IFB'         FSKODE
     C                   MOVEL     DF1004        FSSOK
     C     FSKEY         CHAIN     FRISOK                             89
     C   89FSKODE        CHAIN     KODFRI                             33
     C   89              IF        *IN33
     C                   MOVE      *BLANKS       FSDOKK
     C                   ELSE
     C                   MOVE      KFSODK        FSDOKK
     C                   END
     C   89              MOVE      HEDTOP        FSDTOP
     C   89              WRITE     FRISOKR
     C                   END
      *
      * Utstedelsesdato
     C     UVB           IFNE      'K'
     C                   MOVE      ULDT          DFDTU
     C                   MOVE      DTDMÅ         PDATE1
n06  c     uldtI         ifne      *zeros
n06  c                   move      uldtI         dfdtu
n06  C                   MOVE      DFDTUDD       PDATDD
n06  C                   MOVE      DFDTUMM       PDATMM
n06  C                   MOVE      DFDTUÅÅ2      PDATÅÅ
n06  c                   endif
     c                   ELSE
     C                   MOVE      DFDTUDD       PDATDD
     C                   MOVE      DFDTUMM       PDATMM
     C                   MOVE      DFDTUÅÅ2      PDATÅÅ
     C                   END
      *
     C     DFKDME        COMP      'F'                                    65
     C     DFKDME        COMP      'L'                                    66
      *
     C     *IN61         IFEQ      *ON
     C                   MOVE      DFKNSS        YKN
     C     KUND1K        CHAIN     CUNDL01                            41
     C     UVB           IFNE      'K'
     C  N41              EXSR      BETSR
     C                   EXSR      HENTNR
     C                   END
     C                   EXSR      VALI
N30  C     UVB           IFNE      'K'
N30  C                   EXSR      TTSRP
N30  C                   END
     C                   END
      *
      * Ved kode A/F/B i merkelapps-felt skal selve fraktbrevet ikke skrives
     C     DFKDME        IFNE      'A'                                          1<-B
     C     DFKDME        ANDNE     'F'
     C                   EXSR      UTFBR
     C                   END                                                    1<-E
      *
     C                   ADD       1             XPRANT
      *
      * ikke merkelapp oppdater ved fax
      *
     c     upo           ifeq      'F'
     c     *in53         oreq      *on
     c                   goto      uthoved
     c                   end
      *
      * UPDATES FILES
     C                   EXSR      OPPDAT
      *
      * Label printing
N02  c     uvb           ifeq      'K'
N02  c     DFKDME        andeq     ' '
N02  c                   move      'S'           DFKDME
N02  c                   end
     C     DFKDME        IFNE      ' '
     C     DFKDME        andne     'N'
     C                   EXSR      MERKSR
     C                   END
      *
      * IND: 65=POSTPAKKELAPP
     C     *IN65         IFNE      '1'
     C     UVB           ANDNE     'K'
     C     DFCMN         ANDEQ     'Y'
     C                   EXSR      SRCMN
     C                   END
      *
     C     UTHOVED       ENDSR
      *
      ******************************************
     C     GETVL         BEGSR
      ******************************************
N29   * DFVKTA er vekt i hjelpevariabel/alfa for å  dynamisk i linje 111 ved lang R38/ADR
N29  C                   move      *blanks       DFVKTFA           9
      * LINJE holde rede på hvor en står ETTER siste write
     C*                  Z-ADD     28            LINJE             2 0
S24  C*                  Z-ADD     30            LINJE             2 0
S29  C*                  Z-ADD     60            LINJE             3 0
N29  C                   Z-ADD     61            LINJE             3 0
N24   * 75 ON  = Normal - skriver på annenhver linje - og med 12 LPI blir det da som før (max 32)
N24   * 75 OFF = Fortettet - skriver på hver linje - og med 12 LPI blir det da dobbelt så mange
N24  C                   exsr      TSTR38
N24  C*                  eval      *in75 = *off
N24  C*                  eval      *in75 = *on
      * 34 ON = SKRIV HIGHLIGHTET BUNNTOTAL (HVIS LINJER ER SKREVET)
     C                   MOVE      *OFF          *IN34
      * SJEKK OM DET ER MER ENN XX  LINJER
     C                   MOVE      *ZEROS        X2                3 0
     C     DOKUVK        SETLL     DOKUFV                             33
     C     DOKUVK        READE     DOKUFV                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             X2
s20  C*  50X2            CABGT     5             UTGVL
s20  C* N50X2            CABGT     10            UTGVL
N20  C*    X2            CABGT     15            UTGVL
N20  C   75X2            CABGT     15            UTGVL                          Normal
N20  C  N75X2            CABGT     30            UTGVL                          Linjedobling
     C     DOKUVK        READE     DOKUFV                                 33
     C                   END
      * Ved 0 eller 1 linje (= skapt automatisk ved f10), ikke skriv linjer
N32  C*    X2            CABLE     1             UTGVL
N32  C     X2            CABEQ     0             UTGVL
      *
      * DET FANTES LINJER OG DET ER PLASS TIL Å SKRIVE DETALJERT....
     C     DOKUVK        SETLL     DOKUFV                             33
     C     STGVL         TAG
     C     DOKUVK        READE     DOKUFV                                 33
     C     *IN33         DOWEQ     '0'
     C                   Z-ADD     1             FMMKNR
     C                   Z-ADD     1             FMLONR
     C     DOKUFMKEY     CHAIN     DOKUFM                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     FMMRK1        R33MRK
     C                   ELSE
     C                   MOVE      *BLANKS       R33MRK
     C                   END
     C                   Z-ADD     FVANT         R34ANT
s24  C*                  MOVEL     FVPAKN        R35VSL
s24  C*                  MOVEL     FVVT          XVS              19
s24  C*                  MOVEL     XVS           R35VSL
N24  C                   eval      R35VSL = %trim(FVPAKN)+' '+FVVT
     C                   Z-ADD     FVVKT         R36VKT
S34  C*    FVVOL         IFGT      0
S34  C*    FVVOL         MULT      1000          R37DM3
S34  C*                  MOVE      'DM3'         R37TXT
S34  C*                  ELSE
S34  C*                  MOVE      *ZEROS        R37DM3
S34  C*                  MOVE      *BLANKS       R37TXT
S34  C*                  END
S34  C*    FVLM          IFGT      0
S34  C*                  Z-ADD     FVLM          R37LM
S34  C*                  MOVE      'LM'          R37TX2
S34  C*                  ELSE
S34  C*                  MOVE      *ZEROS        R37LM
S34  C*                  MOVE      *BLANKS       R37TX2
S34  C*                  END
N34  c                   eval      R37TXT = *blanks
N34  c                   if        FVlen <> 0
N34  C                   eval      DSLEN = %trimr(%editc(FVLEN:'Z'))
N34  C                   eval      DSBRD = %trimr(%editc(FVBRD:'Z'))
N34  C                   eval      DSHOY = %trimr(%editc(FVHOY:'Z'))
N34  c                   eval      R37TXT= DSLBH
N34  c                   else
N34  c                   eval      DSDM3LM= *blanks
N34  c                   if        FVVOL <> 0
N34  c                   eval      TmpDm3= FVVOL*1000
N34  C                   eval      DSDM3 = %trimr(%editc(TmpDm3:'Z'))
E39  C                   eval      DSDMTX = 'dm3'
N34  c                   endif
N34  c                   if        FVLM  <> 0
N34  C                   eval      DSLM  = %trimr(%editw(FVLM:'0 ,  '))
N34  C                   eval      DSLMTX= 'Lm'
N34  c                   endif
N34  c                   eval      R37TXT= DSDM3LM
N34  c                   endif
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
      *  51 off = vanlig / 51 on = fax  52 ON = PDF DIREKTE
     C     pdfdir        ifeq      'J'
S08  C*                  WRITE     VARELIF
N08  C                   WRITE     VARELIP
     C                   else
     C  N51              WRITE     VARELI
     C   51              WRITE     VARELIF
     C                   END
     C     DOKUVK        READE     DOKUFV                                 33
     C                   END
      * SKRIV STREK / HIGHLIGHT BUNNTOTAL
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   WRITE     VARELIU
     C                   MOVE      *ON           *IN34
      *
     C     UTGVL         TAG
      * Skriv TOTALER hentet fra selve fraktbrevet
N24   * dersom det er skrevet varelinjer - ikke skriv merke/vareslag på sumposten
N32  c*                  IF        X2>1
S34  C*                  IF        X2>0
S34  C*                  move      *blanks       DFGM
S34  C*                  move      *blanks       DFVS
S34  C*                  move      *blanks       DFGM2
S34  C*                  move      *blanks       DFVS2
S34  C*                  endif
     C                   MOVEL     DFGM          R33MRK
     C                   Z-ADD     DFNT          R34ANT
S34  C*                  MOVEL     DFVS          R35VSL
N34  C                   EVAL      R35VSL = DFVS
     C                   Z-ADD     DFVKT         R36VKT
S34   * via Nye datastrukturer
S34  C*    DFM3          IFGT      0
S34  C*    DFM3          MULT      1000          R37DM3
S34  C*                  MOVE      'DM3'         R37TXT
S34  C*                  ELSE
S34  C*                  MOVE      *ZEROS        R37DM3
S34  C*                  MOVE      *BLANKS       R37TXT
S34  C*                  END
S34  C*    DFLM          IFGT      0
S34  C*                  Z-ADD     DFLM          R37LM
S34  C*                  MOVE      'LM'          R37TX2
S34  C*                  ELSE
S34  C*                  MOVE      *ZEROS        R37LM
S34  C*                  MOVE      *BLANKS       R37TX2
S34  C*                  END
N34  c                   eval      DSDM3LM= *blanks
N34  c                   eval      R37TXT = *blanks
N34  c                   if        DFM3  <> 0
N34  c                   eval      TmpDm3= DFM3*1000
N34  C                   eval      DSDM3 = %trimr(%editc(TmpDm3:'Z'))
E39  C                   eval      DSDMTX= 'dm3'
N34  c                   endif
N34  c                   if        DFLM  <> 0
N34  C                   eval      DSLM  = %trimr(%editw(DFLM:'0 ,  '))
N34  C                   eval      DSLMTX= 'Lm'
N34  c                   endif
N34  c                   eval      R37TXT= DSDM3LM
N34  c*
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C     pdfdir        ifeq      'J'
S08  C*                  WRITE     VARELIF
N08  C                   WRITE     VARELIP
     C                   else
      *  51 off = vanlig / 51 on = fax
     C  N51              WRITE     VARELI
     C   51              WRITE     VARELIF
     C                   END
      *
     C                   MOVE      *ZEROS        R34ANT
     C                   MOVE      *ZEROS        R36VKT
S34  C*                  MOVE      *ZEROS        R37DM3
S34  C*                  MOVE      *ZEROS        R37LM
S34  C*                  MOVE      *BLANKS       R37TXT
S34  C*                  MOVE      *BLANKS       R37TX2
N34  c                   eval      R37TXT = *blanks
     C     DFGM2         IFNE      *BLANKS
     C     DFVS2         ORNE      *BLANKS
     C                   MOVEL     DFGM2         R33MRK
S34  C*                  MOVEL     DFVS2         R35VSL
N34  C                   EVAL      R35VSL = DFVS2
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C     pdfdir        ifeq      'J'
s08  C*                  WRITE     VARELIF
N08  C                   WRITE     VARELIP
     C                   else
      *  51 off = vanlig / 51 on = fax
     C  N51              WRITE     VARELI
     C   51              WRITE     VARELIF
     C                   END
     C                   END
      *
      * Ved sjøoppdrag, ikke merke/nr/vareslag angitt, ikke varelinjer
      *  hent merke/nr vareslag fra BL
     C     HEUR          IFEQ      'F'
     C     HEUR          OREQ      'G'
     C     DFGM          IFEQ      *BLANKS
     C     DFVS          ANDEQ     *BLANKS
     C     *IN34         ANDEQ     *OFF
     C                   MOVE      *BLANKS       MNX
     C                   MOVE      *BLANKS       VSX
     C                   CALL      'SAD61PBL'
     C                   PARM      HEAVD         UAVD2             4 0
     C                   PARM      HEOPD         UOPD2             7 0
     C                   PARM                    UNR               2 0
     C                   PARM                    MNX
     C                   PARM                    UNR2              2 0
     C                   PARM                    VSX
      *
     C     1             DO        20            X3                3 0
     C     MNX(X3)       IFNE      *BLANKS
     C     VSX(X3)       ORNE      *BLANKS
     C                   MOVEL     MNX(X3)       R33MRK
     C                   MOVEL     VSX(X3)       R35VSL
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
      *  51 off = vanlig / 51 on = fax
     C     pdfdir        ifeq      'J'
s08  C*                  WRITE     VARELIF
N08  C                   WRITE     VARELIP
     C                   else
     C  N51              WRITE     VARELI
     C   51              WRITE     VARELIF
     C                   end
S24  C*    LINJE         IFGE      36
N24  C     LINJE         IFGE      99
     C                   LEAVE
     C                   END
     C                   END
     C                   ENDDO
     C                   END
     C                   END
      *
      *
      * POSISJONER TIL RUBR 38
s08  C*    LINJE         DOWLT     36
N24  C     LINJE         DOWLT     76
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   WRITE     BLANKLIN
     C                   END
      * Ved FAX/Epost(IKKE v/PDFdir)-en ekstra linje UTEN å telle (for at Fvekt skal treffe)
N08  C     *IN51         Ifeq      *on
N08  C     *IN52         andeq     *off
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
N24  C                   ADD       1             LINJE
N08  C                   WRITE     BLANKLIN
N08  C                   END
      * VED TOLLPASS xx LINJER EKSTRA
     C     *IN50         IFEQ      *ON
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
N24  C                   ADD       1             LINJE
N24  C                   WRITE     BLANKLIN
N08  c                   eval      PosNr= HEPOS1
N08  c     HEPOS2        ifne      *zeros
N08  c                   eval      PosNr= %trim(HEPOS1)+'/'
N08  c                             + %trim(%editc(HEPOS2:'Z'))
N08  c                   endif
N08  C                   ADD       5             LINJE
     C                   WRITE     UFORT
     C                   END
      *
     C                   ENDSR
N24   ******************************************
N24  C     TSTR38        BEGSR
N24   ******************************************
N24   * Sjekk volum i Rubr 38 - 75 ON=Lite/nomal skriftstørrelse  , 75 OFF=Mye/linjedobling
N24  C                   MOVE      *on           *in75
N24  c                   move      *zeros        AntLin            3 0
N24   *
N24   * ETTEKRA ER DET VEL INGEN SOM BENYTTER - IKKE TESTET, MEN TAR DA UANSETT LINJEDOBLING
N24  c                   if        *IN61 = *on
N24  c                   move      *off          *in75
N24  c                   goto      endTstVl
N24  c                   endif
N24   *
N24  C     DOKUVK        SETLL     DOKUFV                             33
N24  C     DOKUVK        READE     DOKUFV                                 33
N24  C     *IN33         DOWEQ     '0'
N24  c                   add       1             AntLin
N24  C     DOKUVK        READE     DOKUFV                                 33
N24  c                   ENDDO
N24   * mellom 15 og 30 linjer er uansett vilkår for utvidet visning
N24  c                   if        AntLin > 15 and  AntLin < 31
N24  c                   move      *off          *in75
N24  c                   goto      endTstVl
N24  c                   endif
N24   * Mer enn 30 = vis kun tolaler
N24  c                   if        AntLin > 30
N24  c                   z-add     0             AntLin
N24  c                   endif
N24   * add totaler
N24  c                   if        AntLin > 1
N24  c                   add       1             AntLin                         strek ---------
N24  c                   endif
N24  c                   add       1             AntLin                         DFGM1 mm
N24  c                   if        DFGM2 <> *blanks
N24  c                   add       1             AntLin
N24  c                   endif
N24   * add for tollpass
N24  c                   if        *in50 = *on
N24  c                   add       5             AntLin
N24  c                   endif
N24   * Linjer til R38 - TIL KUNDE
N24  C     R29KEY        SETLL     DOK29
N24  C     R29KEY        READE     DOK29                                  90
N24  C     *IN90         DOWEQ     *OFF
N24   * logikk flyttet til sr R38Linwrt / FYSISK slettet herfra RUBR38 for bedre oversikt
N24  c                   add       1             AntLin
N24  C     R29KEY        READE     DOK29                                  90
N24  C                   END
N24   * add for Oppdragsnotis  Kunde
N24  C                   MOVE      'R'           FRTKOD
N24  C     FreeKey       Setll     FREETXT2
N24  C     FreeKey       Reade     FREETXT2                               90
N24  C     *IN90         DOWEQ     *OFF
N24  c                   add       1             AntLin
N24  C     FreeKey       Reade     FREETXT2                               90
N24  C                   END
N24   * Linjer til R38 - TIL TRANSP- fra fraktbrevs notisblok type F17
N24  c                   move      'N'           mldTran           1
N24  C     R29KEY        Setll     DOK36
N24  C     R29KEY        READE     DOK36                                  90
N24  C     *IN90         DOWEQ     *OFF
N24  c                   add       1             AntLin
N24  c                   move      'J'           mldTran
N24  C     R29KEY        READE     DOK36                                  90
N24  C                   END
N24   * add for Oppdragsnotis Transp
N24  C                   MOVE      'G'           FRTKOD
N24  C     FreeKey       Setll     FREETXT2
N24  C     FreeKey       Reade     FREETXT2                               90
N24  C     *IN90         DOWEQ     *OFF
N24  c                   add       1             AntLin
N24  c                   move      'J'           mldTran
N24  C     FreeKey       Reade     FREETXT2                               90
N24  C                   END
N24  c                   if        MldTran = 'J'
N24  c                   add       1             AntLin
N24  c                   endif
N24   * Farlig-gods.(skrives uansett med linjedobling, plassbehov er tilnærmet div 2 + 2 )
N24  c                   move      'N'           PrintAdr
N24  c                   move      *zeros        AntADRlin
N24  c                   EXSR      ADRLIN
N24  c                   if        AntAdrlin > 1
N24  c                   eval      AntAdrlin = (AntAdrlin/2)+2                  ikke presist men..
N24  c                   add       AntADRlin     AntLin
N24  c                   endif
N24   *
N24   *
N24   * TOTALPLASS uten linjedobling = 32 linjer   (m/linjedobling fra lin 61->125 = 64 linjer)
N24  c                   if        AntLin > 32
N24  c                   move      *off          *in75
N24  c                   endif
N24   *
N24  C     endTstVl      ENDSR
N24   *
      ******************************************
     C     VALI          BEGSR
      ******************************************
      * AKKUMULERER LINJER I ARRAY.
     C                   SETOFF                                       63
     C                   MOVE      *ZEROS        B
     C                   MOVE      *BLANKS       M
     C                   MOVE      *BLANKS       T
     C                   MOVE      *ZEROS        XMVAGR
     C                   MOVE      *ZEROS        XTOTAL
     C                   MOVE      'K'           YSK
     C                   Z-ADD     1             XN2               2 0
      *
     C     FAK2K         SETLL     FAK2
      *
     C     STV           TAG
     C     FAK2K         READE     FAK2                                   63
     C  N63              DO
     C     FAKDA         IFEQ      'K'                                          *KOSTNADSLIN
     C     FAKDA         OREQ      'C'                                          *KREDITNOTA
     C     FAKDA         OREQ      'D'                                          *SLETTEDE
     C                   GOTO      STV
     C                   END
      *
      * ORIGINAL!!!
      * OPPDATER MED FAKT.NR                                                UL
     C     UVB           IFNE      'K'
     C     FAOPKO        IFNE      ' '
     C                   GOTO      STV
     C                   END
     C     FAKTK         CHAIN     FAKT                               36
     C                   MOVE      HEKNKF        FAKUNR
N30  C                   MOVE      'P'           FAKDA
      * transportørs kundenummer
s28  C*    VMTRKU        IFNE      *ZEROS
s28  C*                  MOVE      VMTRKU        FAKUNR
s28  C*                  END
s28  C*                  MOVE      'X'           FASK
     C                   MOVE      XFN           FAFAKT
     C                   MOVE      'F'           FAOPKO
     C                   MOVE      UMONTH        FAMND
     C                   MOVE      UYEAR         FAÅR
     C                   IF        UYEAR > 50
     C                   EVAL      FACC = 19
     C                   ELSE
     C                   EVAL      FACC = 20
     C                   ENDIF
     C                   MOVE      DFDTU         FADATO
      *FIKSER FORFALL
S27  C*                  IF        XFFDT > 501231
S27  C*                  EVAL      FADAFF = XFFDT + 19000000
S27  C*                  ELSE
S27  C*                  EVAL      FADAFF = XFFDT + 20000000
S27  C*                  ENDIF
N27  C                   MOVE      XFFDTD        FADAFD
N27  C                   MOVE      XFFDTM        FADAFM
N27  C                   MOVE      XFFDTÅ        FADAFÅ
N27  C     XFFDTÅ        IFGT      50
N27  C                   MOVEL     '19'          FADAFÅ
N27  C                   ELSE
N27  C                   MOVEL     '20'          FADAFÅ
N27  C                   END
     C                   EXCEPT    OPDFAK
     C                   ELSE
      * KOPI....
     C                   MOVE      FAFAKT        XFN
     C                   MOVE      FADAFF        PXFFDT            6 0
     C                   CALL      'DATFM2'
     C                   PARM                    FIDTFM
     C                   PARM                    PXFFDT
     C                   END
      *
      * For mange linjer... legg i "ØVRIGE"
     C     XN2           COMP      8                                  36
     C  N36FAVT          COMP      *BLANKS                                35
     C  N36
     CAN 35KODGEK        CHAIN     KODTGE                             35
     C   36              MOVEL     XTSTAN        T(XN2)
     C     HEVALK        IFEQ      FICURR
     C                   ADD       FABELN        B(XN2)
     C                   ADD       FABELN        XTOTAL
     C                   ELSE
     C                   ADD       FABELV        B(XN2)
     C                   ADD       FABELV        XTOTAL
     C                   END
      *
     C                   MOVE      FAKDM         M(XN2)
     C  N36FAVT          IFNE      *BLANKS
     C                   MOVEL     FAVT          T(XN2)
     C                   ELSE
     C                   MOVEL     KGENOT        T(XN2)
     C                   END
      *
      * TAX ?
      *
     C     FAKDM         IFEQ      'J'
     C     FICURR        IFEQ      HEVALK
     C                   ADD       FABELN        XMVAGR            8 2
     C                   ELSE
     C                   ADD       FABELV        XMVAGR
     C                   END
     C                   END
     C  N36              ADD       1             XN2
     C                   GOTO      STV
     C                   END
      *
     C     XN2           IFGT      1
      * VARIABLE VAT
     C                   MOVE      FITAX         FITAXB            4 4
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     FADATO        ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAXB            4 4
     C                   END
     C     XMVAGR        MULT(H)   FITAXB        XMOMSX            8 2
     C                   Z-ADD     XMOMSX        XPMOMS            8 2
     C                   ADD       XMOMSX        XTOTAL            9 2
     C                   END
     C                   Z-ADD     XTOTAL        DFBELE
N27   * hente kid
N27  c     dfbele        ifne      *zeros
N27  c                   exsr      mod10
N27  C                   MOVEL     NYKID         DFFRKU
N27  C                   MOVE      KIDBEL        DFFRKU
N27  c                   exsr      arksr2
N27  c                   end
      *
     C                   ENDSR
      ******************************************
     C     ETTERKRAV     BEGSR
      ******************************************
      * SKRIVER ETTERKTAVSLINER TIL R38. HENTET FRA AKKUMULERT ARRAY
      * Header+linje 1/2  (SPACE 2 FØR GIR EN LINJE LUFT, TILSAM. 4 LINJER)
     C                   ADD       4             LINJE
     C                   WRITE     EKRHEA
      * Øvrige linjer
     C     3             DO        10            XN2
     C     B(XN2)        IFNE      *ZEROS
     C                   MOVE      T(XN2)        TEKST
     C                   MOVE      B(XN2)        BELØP
     C                   MOVE      M(XN2)        MOMSKO
     C                   ADD       1             LINJE
     C                   WRITE     EKRLIN
     C                   ADD       1             XN2
     C                   END
     C                   END
      * Moms-linje
     C     XPMOMS        IFNE      *ZEROS
     C                   ADD       1             LINJE
     C                   WRITE     EKRMOMS
     C                   END
      * En linje luft etter faktura-delen
     C                   ADD       1             LINJE
     C                   WRITE     BLANKLIN
      *
     C                   ENDSR                                                  1<-E
      *
      ******************************************
     C     RUBR38        BEGSR
      ******************************************
N24   * Beregn evt behov for ADR-linjer i bunnen
N24  c                   move      'N'           PrintAdr          1
N24  c                   move      *zeros        AntADRlin         3 0
N24  c                   EXSR      ADRLIN
N24  c     124           sub       AntAdrlin     MaxLin            3 0
     C     *IN50         IFEQ      *ON
     C                   MOVE      KOVTPK        KOVXXK            2
     C                   ELSE
     C                   MOVE      KOVFBK        KOVXXK
     C                   END
      * Først evt FAST AVD-tekst på TOLLPASS/vanlig (+ EN LINJE LUFT)
     C*    *IN50         IFEQ      *ON
     C*    KOVTPK        ANDNE     *BLANKS
     C     KOVXXK        IFNE      *BLANKS
     C                   MOVE      'N'           TPKJN             1
     C     KOVXXK        SETLL     KODTFT
     C     KOVXXK        READE     KODTFT                                 90
     C     *IN90         DOWEQ     *OFF
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   WRITE     R38TPK
     C                   MOVE      'J'           TPKJN             1
     C     KOVXXK        READE     KODTFT                                 90
     C                   END
     C     TPKJN         IFEQ      'J'
      * Skriv "luft-linje" kun ved FB (ved TP er det plassmangel)
     C     *IN50         IFEQ      *OFF
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   WRITE     BLANKLIN
     C                   END
     C                   END
     C                   END
      *
      * Deretter evt FASTE verdier  (er hentet til array TX)
     C                   Z-ADD     10            NR                2 0
     C     TX(NR)        DOWEQ     *BLANKS
     C                   SUB       1             NR
     C     NR            CABEQ     0             UTFAS
     C                   END
      * Fantes minst 1 - skriv
     C                   Z-ADD     1             N2                2 0
     C     N2            DOWLE     NR
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   MOVE      TX(N2)        D29TXT
     C                   WRITE     R38LIN
     C                   ADD       1             N2
     C                   END
      *
     C     UTFAS         TAG
      *
      * FARLIG GODS??
     C     DGSJN         IFEQ      'J'
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = '** FARLIG GODS **'
     C                   WRITE     R38LIN
     C     DGS8351       IFNE      *BLANKS
     C     DGS8078       ORNE      *BLANKS
     C     DGS8092       ORNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = 'HZ Code ID/Page/Code V:'
     C                   CAT       DGS8351:1     D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS8078:1     D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS8092:1     D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS7124       IFNE      *ZEROS
     C     DGS7088       ORNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   MOVE      DGS7124       TMPUN             4
     C                   EVAL      D29TXT = 'UNDG numb./Flash point:'
     C                   CAT       TMPUN:1       D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS7088:1     D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS7106       IFNE      *ZEROS
     C     DGS6411       ORNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   MOVE      DGS7106       TMPSF             3
     C                   EVAL      D29TXT = 'Shipm. Flash.pt/qualif:'
     C                   CAT       TMPSF:1       D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS6411:1     D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS8339       IFNE      *BLANKS
     C     DGS8364       ORNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = 'Packing group / EMS no:'
     C                   CAT       DGS8339:1     D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS8364:1     D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS8410       IFNE      *BLANKS
     C     DGS8126       ORNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = 'MFAG / Trem card numb.:'
     C                   CAT       DGS8410:1     D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS8126:1     D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS8158       IFNE      *BLANKS
     C     DGS8186       ORNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = 'HZ id upper/lower part:'
     C                   CAT       DGS8158:1     D29TXT
     C                   CAT       '/':1         D29TXT
     C                   CAT       DGS8186:1     D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS4440F      IfNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = 'Tech. name:'
     C                   CAT       DGS4440F:1    D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS4440A      IfNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = 'Addi. info:'
     C                   CAT       DGS4440A:1    D29TXT
     C                   WRITE     R38LIN
     C                   END
     C     DGS4440B      IfNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = DGS4440B
     C                   WRITE     R38LIN
     C                   END
     C     DGS4440C      IfNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = DGS4440C
     C                   WRITE     R38LIN
     C                   END
     C     DGS4440D      IfNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = DGS4440D
     C                   WRITE     R38LIN
     C                   END
     C     DGS4440E      IfNE      *BLANKS
N24  C   75              ADD       1             LINJE
N24  C   75              WRITE     BLANKLIN
     C                   ADD       1             LINJE
     C                   EVAL      D29TXT = DGS4440E
     C                   WRITE     R38LIN
     C                   END
     C                   END
      * Linjer til R38 - TIL KUNDE - fra frakbrevs notisblok type F18
     C     R29KEY        SETLL     DOK29
     C     R29KEY        READE     DOK29                                  90
     C     *IN90         DOWEQ     *OFF
N11   * logikk flyttet til sr R38Linwrt / FYSISK slettet herfra RUBR38 for bedre oversikt
N11  C                   exsr      R38LINwrt
     C     R29KEY        READE     DOK29                                  90
     C                   END
      *
N11
N11   * Linjer til R38 - TIL KUNDE - fra Oppdrags notisblokk R
N11  C                   MOVE      'R'           FRTKOD
N11  C     FreeKey       Setll     FREETXT2
N11  C     FreeKey       Reade     FREETXT2                               90
N11  C     *IN90         DOWEQ     *OFF
N11  C                   eval      D29TXT = FRTTXT
N11  C                   exsr      R38LINwrt
N11  C     FreeKey       Reade     FREETXT2                               90
N11  C                   END
      *
N11  C                   Move      'J'           PrtTRhead         1
N11   * Linjer til R38 - TIL TRANSP- fra fraktbrevs notisblok type F17
N11  C     R29KEY        Setll     DOK36
N11  C     R29KEY        READE     DOK36                                  90
N11  C     *IN90         DOWEQ     *OFF
N11  C                   eval      D29TXT = D36TXT
N11  C                   exsr      R38LINwrt
N11  C     R29KEY        READE     DOK36                                  90
N11  C                   END
N11   *
N11
N11   * Linjer til R38 - TIL Transp- fra Oppdrags notisblokk G
N11  C                   MOVE      'G'           FRTKOD
N11  C     FreeKey       Setll     FREETXT2
N11  C     FreeKey       Reade     FREETXT2                               90
N11  C     *IN90         DOWEQ     *OFF
N11  C                   eval      D29TXT = FRTTXT
N11  C                   exsr      R38LINwrt
N11  C     FreeKey       Reade     FREETXT2                               90
N11  C                   END
N16   * Linjer til R38 - fra Fri søkevei - kode R
N16  C     HEADFK        Setll     FRISOK
s24  C*    HEADFK        Reade(N)  FRISOK                                 90
N24  C     HEADFK        Reade     FRISOK                                 90
N16  C     *IN90         DOWEQ     *OFF
N16  c     'R'           scan      FSDOKK                                 90
N16  c     *in90         ifeq      *on
N16  C     FSKODE        CHAIN     KODFRI                             33
N16  C                   eval      D29TXT = %trim(KFSOTX)+' '+FSSOK
N16  C                   exsr      R38LINwrt
N16  C                   endif
s24  C*    HEADFK        Reade(N)  FRISOK                                 90
N24  C     HEADFK        Reade     FRISOK                                 90
N16  C                   END
      *
N24   * evt linjeadr på slutten.....
N24  c                   if        AntADRlin > 0
N24  c                   move      'J'           PrintAdr          1
N24  c                   move      *zeros        AntADRlin         3 0
N24  c                   EXSR      ADRLIN
N24  c                   endif
     C                   ENDSR
      *
N11
N11   ******************************************
N11  C     R38LINwrt     BEGSR
N11   ******************************************
N29   * gammel utgått logikk fysisk fjernet for bedre oversikt
     C     LINJE         IFGE      MaxLin
     C                   goto      Ut38Lin
     C                   END
      * blanke bakerste del når en kommer i R39-40...-boksen  (men kun ved normalfont)
     C     LINJE         IFGT      108
     C     *in75         andeq     *ON                                          Normalfont
     C                   MOVE      BLANK20       D29TXT
     C                   END
      *
      * blanklinje først ved annenhver
     C   75              ADD       1             LINJE
     C   75LINJE         IFEQ      111
     C                   eval      DFVKTFA = %trimr(%editc(DFVKT:'Z'))
     C                   else
     C                   eval      DFVKTFA = *blanks
     C                   endif
     C   75              WRITE     BLANKLIN
      *
      *
      * Skal TR-info head skrives før den leste linja??(i så fall er linjetekst bevart i TMPTXT)
     C     PrtTRhead     ifeq      'J'
     c                   move      *blanks       TMPTXT           70
     c                   eval      TMPTXT = D29TXT
     c                   eval      D29TXT = '** Melding til transportør **'
     C                   ADD       1             LINJE
     C     LINJE         IFEQ      111
     C                   eval      DFVKTFA = %trimr(%editc(DFVKT:'Z'))
     C                   else
     C                   eval      DFVKTFA = *blanks
     C                   endif
     C                   WRITE     R38LIN
     c                   eval      PrtTRhead = 'N'
      * blanklinje ved annenhver
     C   75              ADD       1             LINJE
     C   75LINJE         IFEQ      111
     C                   eval      DFVKTFA = %trimr(%editc(DFVKT:'Z'))
     C                   else
     C                   eval      DFVKTFA = *blanks
     C                   endif
     C   75              WRITE     BLANKLIN
      * legg tilbake tempteksten
     c                   eval      D29TXT = TMPTXT
     c                   endif
      *
      * SELVE LINJA en kom inn i SR med ...
     C                   ADD       1             LINJE
     C     LINJE         IFEQ      111
     C                   eval      DFVKTFA = %trimr(%editc(DFVKT:'Z'))
     C                   else
     C                   eval      DFVKTFA = *blanks
     C                   endif
     C                   WRITE     R38LIN
      *
     C     Ut38Lin       ENDSR
      *
N24
N24   ******************************************
N24  C     ADRLIN        BEGSR
N24   ******************************************
N24  c                   move      *blanks       FFANTKA           5
N33  c*                  move      *blanks       FFANTEA           7
N33  c                   move      *blanks       FFANTEA          11
N24  c                   move      *blanks       UNbesk1          21
N24  c                   move      *blanks       MerkeCont        12
N24   *
N24   * Hvis PrinMode - skriveloop til en kommer til startpunkt for ADR-linjer
N24  c                   if        PrintAdr <>'N'
N24  c     LINJE         dowlt     Maxlin
N24  C                   ADD       1             LINJE
N29  C     LINJE         IFEQ      111
N29  C                   eval      DFVKTFA = %trimr(%editc(DFVKT:'Z'))
N29  C                   else
N29  C                   eval      DFVKTFA = *blanks
N29  C                   endif
N24  C                   WRITE     BLANKLIN
N24  c                   enddo
N24  c                   endif
N24   *
N24   * Når PrintAdr = 'N' er det kun sjekk for å finne ant linjer det er behov for..
N24  C     FarlKey       SETLL     DOKUFVF
N24  C     FarlKey       READE     DOKUFVF                                33
N24  C     *in33         DOWEQ     '0'
N24  C     UnNrKeyF      chain     ADRUNNRF                           33
N24   * kontroll...
N24  c                   if        PrintAdr = 'N'
N24  c                   if        AntADRlin= 0                                 Først,head(2)+Oversk
N24  c                   add       3             AntADRlin
N24  c                   endif
N24  c                   add       1             AntADRlin                      Hovedlinja m 21 txt
N24  c                   if        %subst(ADTEXT:22)<>*blanks
N24  c                   add       1             AntADRlin                      extra pga mer enn 21
N24  c                   endif
N24  c                   if        %subst(ADTEXT:103)<>*blanks
N24  c                   add       1             AntADRlin                      extra pga mer enn102
N24  c                   endif
N24  c                   else
N24   *Print..
N24  C                   Z-ADD     FFLINR        FVLINR
N24  C                   Z-ADD     1             FMMKNR
N24  C                   Z-ADD     1             FMLONR
N24  C     DOKUFMKEY     CHAIN     DOKUFM                             33
N24  C  N33              MOVEL     FMMRK1        MerkeCont
N24  c                   if        AntADRlin= 0                                 Først?head(2)+Oversk
N24  C                   ADD       1             LINJE
N24  C                   WRITE     BLANKLIN
N24  C                   ADD       1             LINJE
N24  C                   WRITE     R38FARH                                      FARLIG-header
N24  c                   eval      FARLTXT='UnNr Beskrivesle.......... '        Kolonne-overskrift
N24  c                             +'Klas FareSeddel EmGr TunellRest '
S33  c*                            +'Ant.K Mengde Enh Cont-ID'
N33  c                             +'Ant.K Mengde     Enh Cont-ID'
N24  C                   ADD       1             LINJE
N24  c                   add       1             AntADRlin
N24  C                   WRITE     R38FARL
N24  c                   endif
N24   * .. Lin 1 (besk 1-20)
N24  c                   eval      FFANTKA = %trimr(%editc(FFANTK:'Z'))
S33  c*                  eval      FFANTEA = %trimr(%editc(FFANTE:'Z'))
N33  c                   eval      FFANTEA =
N33  c                                   %trimr(%editw(FFANTE:'     0 ,   '))
N24  c                   eval      UNbesk1 = %subst(ADTEXT:1:21)                21 første tegn...
N24  c                   eval      FARLTXT= ADUNNR+' '+UNBESK1+' '+FFKLAS+' '
N24  c                             +FFSEDD+' '+FFEMBG+'  '+FFTRES+' '+FFANTKA
N24  c                             +FFANTEA+' '+FFENH+' '+MerkeCont
N24  C                   ADD       1             LINJE
N24  c                   add       1             AntADRlin
N24  C                   WRITE     R38FARL
N24   * .. Ekstra  pga lang tekst (besk 22-102)
N24  c                   if        %subst(ADTEXT:21)<>*blanks
N24  c                   eval      FARLTXT='     '+ %subst(ADTEXT:22:83)
N24  C                   ADD       1             LINJE
N24  c                   add       1             AntADRlin
N24  C                   WRITE     R38FARL
N24  c                   endif
N24   * .. Ekstra  pga lang tekst (besk 103-150)
N24  c                   if        %subst(ADTEXT:103)<>*blanks
N24  c                   eval      FARLTXT='     '+ %subst(ADTEXT:103)
N24  C                   ADD       1             LINJE
N24  c                   add       1             AntADRlin
N24  C                   WRITE     R38FARL
N24  c                   endif
N24  c                   endif
N24  C     FarlKey       READE     DOKUFVF                                33
N24  C  N33              ENDDO
N24  C                   ENDSR
      ******************************************
     C     MERKSR        BEGSR
      ******************************************
     c     uvb           ifeq      'K'
     c     DFKDME        andeq     ' '
     c                   move      'S'           DFKDME
     c                   end
      * Kode P=  S-merkelapp ER alt skrevet, Kopi->S, Orig->Hopp ut
     C     DFKDME        IFEQ      'P'
     C     uvb           ifeq      'K'
     C                   move      'S'           DFKDME
     C                   else
     c                   goto      merks9
     C                   end
     C                   end
      * KOPI-KJØRING OG NEI TIL MERKELAPP - HOPP UT..
     c     uvb           ifeq      'K'
     c     wsml          andeq     'N'
     c                   goto      merks9
     c                   end
      * EGEN PARAMETER FOR FRAKTB
     c     uvb           ifeq      'K'
     c                   move      'J'           UUKOPI
     c                   else
     c                   MOVE      'N'           UUKOPI
     c                   end
      *
     C                   Z-ADD     1             XANTM             4 0
      *
     C     DFNTLA        IFEQ      *ZEROS
     C                   MOVE      DFNT          DFNTLA
     C                   END
     C     STM           TAG
     C     DFKDME        IFEQ      'S'
     C     TRAKEY        CHAIN(N)  TRAN                               39
     C* Ved DUP printes merkelappene på Dup-oppdraget (SYTR11)
     C     VMLAYO        CABEQ     'DU'          merks9
     C                   SELECT
N15   * på laserprinter.. - ETT prog(foreløpig ??)  for ulike..
N15  c     LABLAS        WHENEQ    'J'
N15  C                   CALL      'SYFA12SA'
N15  C                   PARM                    UFIRM
N15  C                   PARM                    VMLAYO
N15  C                   PARM                    DFAVD
N15  C                   PARM                    DFOPD
N15  C                   PARM                    DFFBNR
N15  C                   PARM                    UUKOPI            1
N42  C                   PARM                    UKLID            35
      * på labelprinter.. - ulike prog for ulike
     C     VMLAYO        WHENEQ    'PO'
     C     VMLAYO        OREQ      'P4'
N19  C     VMLAYO        OREQ      'BR'
N10  C     DFKNM         OREQ      '0413898'                                    TG mypack via BRING
      * POSTEN-LAPP FORUTSETTER!!! AT EAN-TELLEVERK FINNES...
     C     ELTRON        IFEQ      'N'
     C                   CALL      'SYFA12SP'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    UUKOPI            1
N42  C                   PARM                    UKLID            35
     C                   ELSE
     C                   CALL      'SYFA12SF'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    UUKOPI            1
N42  C                   PARM                    UKLID            35
     C                   END
     C                   OTHER
      * EAN-VARIANT SKRIVES KUN HVIS EAN-TELLEVERK FINNES...
     C     FIFIRM        CHAIN(N)  FIRFB                              89
     C     FIIDNR        IFNE      *ZEROS
     c*
     C     ELTRON        IFEQ      'N'
     C                   CALL      'SYFA12SN'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    UUKOPI            1
N42  C                   PARM                    UKLID            35
     C                   ELSE
     C                   CALL      'SYFA12SE'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    UUKOPI            1
N42  C                   PARM                    UKLID            35
     C                   END
     C                   ELSE
      * EAN-TELLEVERK FINNE IKKE - SKRIV "GAMMEL TYPE"
     C                   CALL      'SYFA12S'
     C                   PARM                    UFIRM
     C                   PARM                    VMLAYO
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
N42  C                   PARM                    UKLID            35
     C                   END
     C                   ENDSL
     C                   GOTO      MERKS9
     C                   ENDIF
     C     DFKDME        IFEQ      'A'
     C                   EXSR      UTPAK
     C                   ELSE
     C  N65
     CANN66              EXSR      UTMMRK
     C   65              EXSR      UTFØLB
     C   66              EXSR      UTLMRK
     C                   END
     C                   ADD       1             XANTM
     C     XANTM         IFLE      DFNTLA
     C                   GOTO      STM
     C                   END
      *
     C     MERKS9        ENDSR
      *
      ******************************************
     C     HENTNR        BEGSR
      ******************************************
      * TESTER OM DER ER VARELINJER
      *
     C                   SETOFF                                       63
     C                   MOVE      'K'           YSK
      *
     C     FAK2K         SETLL     FAK2
      *
N36  c     lesnyl        tag
     C     FAK2K         READE     FAK2                                   63
N36   * status må være blank
N36  C  N63FAOPKO        IFNE      ' '
N36  C                   GOTO      lesnyl
N36  C                   end
N36   * ikke kostnad samlefaktura slettet
N36  C  N63FAKDA         IFEQ      'K'
N36  C     FAKDA         OREQ      'C'
n36  C     FAKDA         OREQ      'D'
n36  c                   goto      lesnyl
n36  c                   end
      *
     C   63              MOVE      *ZEROS        XFN
     C  N63              DO
     C     UFIRM         CHAIN     FIRM                               44
     C  N44UFIRM         CHAIN     TELLFA
     C  N44              DO
     C                   MOVE      FIFNR         XFN               7 0
     C                   ADD       1             FIFNR
     C                   UPDATE    TELLFAR
     C                   MOVE      XFN           FIFN
     C                   MOVE      HEAVD         FIAVD
     C                   MOVE      HEOPD         FIOPD
     C                   WRITE     FAINR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     BETSR         BEGSR
      ***********************************************
      *
      *** FINNER BETBET OG FORFALLSDATO
     C                   MOVE      *ZEROS        XFFDT             6 0
     C                   MOVE      *BLANKS       BETTXT           30
     C                   CALL      'SYFA20A'
S27  C*                  PARM                    XFFDT
N27  C                   PARM                    XFFDTNY           6 0
     C                   PARM                    BETTXT
     C                   PARM                    UFIRM
     C                   PARM                    BETBET
N27  c                   move      xffdtny       xffdt
      *
      * CHANGES DATE TO INHOUSE LAYOUT
      *
     C                   MOVE      XFFDT         PXFFDT            6 0
     C                   CALL      'DATFM2'
     C                   PARM                    FIDTFM
     C                   PARM                    PXFFDT
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPPDAT        BEGSR
      ***********************************************
      * KOPI...
     C     UVB           IFEQ      'K'                                          1<-B
     C                   EXCEPT    DUMDOK
     C                   ELSE                                                   1
      * ORIGINAL....
N18  c     DFST          ifeq      'U'
N18  C                   MOVE      'V'           DFST                           Utenlands=U->V
N18  c                   else
     C                   MOVE      'P'           DFST
N18  c                   endif
N04  c     DFKDME        ifeq      'S'
N04  c                   move      'P'           DFKDME
     C                   EXCEPT    OPDDOK
N04  c                   move      'S'           DFKDME
N04  c                   else
N04  C                   EXCEPT    OPDDOK
N04  c                   endif
      *
     C   61              DO                                                      2<-B
     C                   MOVE      'F'           HEST
     C                   END                                                     2<-E
      *
     C                   MOVE      HEST          XST               1
     C     STOPD         TAG
     C                   SETOFF                                       32
     C     HEADFK        CHAIN     HEADF                              3032
     C   30              GOTO      SLOPD
     C   32              DO                                                      2<-B
     C                   Z-ADD     15            USEC              3 0
     C                   CALL      'DLYJBSEC'
     C                   PARM                    USEC
     C                   GOTO      STOPD
     C                   END                                                     2<-E
     C                   MOVE      XST           HEST
     C                   MOVE      'P'           HEPK1
     C                   EXCEPT    OPDHEA
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END                                                    1<-E
     C                   END                                                    1<-E
      *
     C     SLOPD         ENDSR
      *
      ******************************************
     C     UTFBR         BEGSR
      ******************************************
      * PAPIR PRINT?? HVIS KOPI  SKRIV ALLTID...
     C     UVB           IFNE      'K'
      * ELLERS SKRIV KUN HVIS KOMMUNIKASJON ER NEI (BLANK)
     C     DFCMN         ANDNE     'N'
     C     DFCMN         ANDNE     ' '
     C     *IN50         IFEQ      *OFF
      * Vanlig FB
     C     KOVFBS        IFEQ      'N'
     C     KOVFBS        OREQ      ' '
     C                   GOTO      SKIPPR
     C                   END
     C                   ELSE
      * Tollpass
     C     KOVTPS        IFEQ      'N'
     C     KOVTPS        OREQ      ' '
     C                   GOTO      SKIPPR
     C                   END
     C                   END
     C                   END
N22   *
N22   * SJEKK OM NEI I PRINT PÅ EPOSTMOTTAGER
N22   *
N22  C     CUNDCK        CHAIN     CUNDC03                            33
N22  C   33CUNDCK2       CHAIN     CUNDC03                            33
N22  C     *in33         ifeq      '0'
N22  C     UVB           ANDNE     'K'
N22  c     CPRINT        ANDEQ     'N'
n22  C     arkjn         ifeq      'J'
n22  C     *IN53         andeq     '0'
n22  c                   exsr      arksr
n22  c                   end
N22  C                   GOTO      SKIPPR
N22  C                   END
      *
      * Hent faste tekster til R-38
     C                   CALL      'SYFA12F'
     C                   PARM                    UFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    U38TXT          700
     C                   MOVEA     U38TXT        TX
      *
      * FARLIG GODS??
     C                   MOVE      'N'           DGSJN             1
     C     DGSKEY        CHAIN     DOKUDGS                            33
     C     *IN33         IFEQ      *OFF
     C     DGS8351       IFNE      *BLANKS
     C     DGS8078       ORNE      *BLANKS
     C     DGS8092       ORNE      *BLANKS
     C     DGS7124       ORNE      *ZEROS
     C     DGS7088       ORNE      *BLANKS
     C     DGS7106       ORNE      *ZEROS
     C     DGS6411       ORNE      *BLANKS
     C     DGS8339       ORNE      *BLANKS
     C     DGS8364       ORNE      *BLANKS
     C     DGS8410       ORNE      *BLANKS
     C     DGS8126       ORNE      *BLANKS
     C     DGS8158       ORNE      *BLANKS
     C     DGS8186       ORNE      *BLANKS
     C     DGS4440A      ORNE      *BLANKS
     C     DGS4440B      ORNE      *BLANKS
     C     DGS4440C      ORNE      *BLANKS
     C     DGS4440D      ORNE      *BLANKS
     C     DGS4440E      ORNE      *BLANKS
     C     DGS4440F      ORNE      *BLANKS
     C                   MOVE      'J'           DGSJN
     C                   EVAL      DFPRO2 = '** FARLIG GODS ** (Se R.38)'
     C                   END
     C                   END
     C     UEKSP         IFEQ      'J'
     C                   Z-ADD     7             WSPLNR            3 0
     C                   ELSE
     C     UKODE         IFEQ      'F'
     C                   Z-ADD     6             WSPLNR
     C                   ELSE
     C                   Z-ADD     14            WSPLNR
     C                   END
     C                   END
     C     KODTPK        CHAIN     KODTP                              41
      *
      * IKKE STRINGKODE VED FAX OG PDFDIREKTE
      *
     c     UPO           IFEQ      'F'
     c                   MOVE      *blanks       kopfm
     c                   end
      *
      *
      * skriver dokument uten stringkode
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
      *
     c                   exsr      utfbr2
      *
      * skriver dokument med stringkode
      *
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM1         TAG
     C     KOPFM         READE     KODTFM                                 42
     C   42              MOVE      *ZEROS        KFMSD
      *
      * skriver dokument hvis stringkode mangler
      *
     c     *in42         ifeq      '1'
     c     *in43         andeq     '0'
     c                   exsr      utfbr2
     c                   goto      skippr
     c                   end
      *
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     c     *in53         Ifeq      *on                                          midlert. brev.
     C     KFMSD         ANDGT     1
     C                   GOTO      SKIPPR
     C                   END

      * PAPIR PRINT?? HVIS KOPI  SKRIV ALLTID...
     C     UVB           IFNE      'K'
      * ELLERS SKRIV KUN HVIS KOMMUNIKASJON ER NEI (BLANK)
     C     DFCMN         ANDNE     'N'
     C     DFCMN         ANDNE     ' '
     C     *IN50         IFEQ      *OFF
      * Vanlig FB - SKIPP NÅR EX 1 ER SKREVET??
     C     KOVFBS        IFEQ      '1'
     C     KFMSD         ANDGT     1
     C                   GOTO      SKIPPR
     C                   END
     C                   ELSE
      * Tollpass  - SKIPP NÅR EX 1 ER SKREVET??
     C     KOVTPS        IFEQ      '1'
     C     KFMSD         ANDGT     1
     C                   GOTO      SKIPPR
     C                   END
     C                   END
     C                   END
      *
      * legger sendingsnummer inn i stringkoden
     c     KFMPOS        ifne      *zeros
      *kyozera ind 38  1.parameter er uten modulus
     C     '!R!'         SCAN      KFMT1                                  38
      *
     c     WSSNDT        ifeq      *blanks
     c  N38              movea     wssndn        str(kfmpos)
     c   38              movea     wssnd1        str(kfmpos)
      *parameter 2
     C   38KFMPOS        add       10            kyp               2 0
     c   38str(kyp)      ifeq      ','
     c                   add       2             kyp
     c                   movea     wssndn        str(kyp)
     c                   else
     C   38              add       11            kyp               2 0
     c   38str(kyp)      ifeq      ','
     c                   add       2             kyp
     c                   movea     wssndn        str(kyp)
     c                   end
     c                   end
     c                   else
      *nytt langt fraktbrevnummer
     c                   movel     401           snd20            20
     c                   move      wssn17        snd20
     c                   movea     snd20         str(kfmpos)
      *parameter 2
     C   38KFMPOS        add       21            kyp               2 0
     c   38str(kyp)      ifeq      ','
     c                   add       2             kyp
     c                   movea     snd20         str(kyp)
     c                   end
     c                   end
     c                   end
      *
      * skriver 2 stringkodelinjer foran fraktbrev
     C                   WRITE     FBREVH1
     C                   WRITE     FBREVH2
      *
      * skriver selve fraktbrevet
     C                   exsr      utfbr2
     C                   GOTO      STFM1
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SKIPPR        ENDSR
      *
      ******************************************
     C     UTFBR2        BEGSR
      ******************************************
      * fraktbrevnummer må være numerisk
      *
     c     wssndt        ifne      *blank
     C                   TESTN                   WSSN17               31
     C     *IN31         IFne      '1'
     C                   MOVE      *zeros        WSSN17
     C                   end
     c                   else
     C                   TESTN                   WSSNDN               31
     C     *IN31         IFne      '1'
     C                   MOVE      *zeros        WSSNDN
     C                   end
     C                   end
      * fikser hvis 10 nummer i fbnr
     c     wssndn        ifeq      *zeros
     c     wssndn        oreq      *blanks
     c                   move      *zeros        wssn17
     c                   end
      * Skriv fast "header-del"
     C     UPO           IFNE      'F'
      * Vanlig fraktbrev / Tollpass
     c     pdfdir        ifne      'J'
     C                   WRITE     FBREV
     c                   else
     c                   setoff                                       71
     c     wssndt        ifeq      *blank
     c                   seton                                        71
     c                   move      wssndn        WSSN10
     C                   WRITE     FAXLAY
     c                   else
     C                   MOVEL     '401'         WSSN20
     C                   MOVE      WSSN17        WSSN20
     C                   WRITE     FAXLAY
     c                   end
     c                   end
     C     arkjn         ifeq      'J'
     C     *IN53         andeq     '0'
     c                   exsr      arksr
     c                   end
     C                   ELSE
      * Fax..
     c                   setoff                                       71
     c     wssndt        ifeq      *blank
     c                   seton                                        71
     c                   move      wssndn        WSSN10
     C                   WRITE     FAXLAY
     c                   else
     C                   MOVEL     '401'         WSSN20
     C                   MOVE      WSSN17        WSSN20
     C                   WRITE     FAXLAY
     c                   end
     C                   END
      *
      * Skriv fast varelinjer (ant/vekt...)
     C                   EXSR      GETVL
      *
      * Skriv evt etterkravslinjer
     C   61              EXSR      ETTERKRAV
      *
      * Skriv Fritekstlinjer i rubr 28.
     C                   EXSR      RUBR38
      *
s08  C* Ved valig fraktbrev, Skriv FVEKT dersom ikke alt gjort i RUBR38
s08  C*    *IN50         IFEQ      '0'
s08  C*    LINJE         IFLT      54
s08  C*                  WRITE     FVEKT
s08  C*                  END
s08  C*                  ELSE
s08  C* Ved tollpass, Skriv bunn.  Fast layout f.o.m Godsnr-linja
s08  C*(men ved fax er linjenr start ulikt. TPBUNNV/TPBUNNF = posisjonering)
s08  C*    pdfdir        ifeq      'J'
s08  C*                  WRITE     TPBUNNF
s08  C*                  else
s08  C* N51              WRITE     TPBUNNV
s08  C*  51              WRITE     TPBUNNF
s08  C*                  END
s08  C*                  WRITE     TPBUNN
s08  C*                  WRITE     FVEKT
s08  C*                  END
N24  C*    LINJE         IFLT      55
N24  C     LINJE         IFLT      110
N08  C                   WRITE     FVEKT
N08  C                   END
     C     KFMT3         ifne      *blanks
     C                   WRITE     FBREVH3
     c                   end
     C     PDFDIR        IFEQ      'J'
     C     *in50         ifeq      '0'
     C                   MOVEL     'FB1'         OVL03             3
     C                   else
     C                   MOVEL     'FB1'         OVL03
     C                   END
     C     KFMSD         IFNE      0
     C                   MOVE      KFMSD         OVL03
     C                   END
     C                   MOVEL     OVL03         FB01
     C                   write     ovl
     C                   END
      *
     C                   ENDSR
      *
      ******************************************
     C     UTFØLB        BEGSR
      ******************************************
     C                   Z-ADD     10            WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              41
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   MOVE      *BLANKS       KFMT3
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C                   EXCEPT    FØLBR
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM2         TAG
     C     KOPFM         READE     KODTFM                                 42
     C   42              MOVE      *ZEROS        KFMSD
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C                   EXCEPT    FØLBR
     C                   GOTO      STFM2
     C                   END                                                     2<-E
     C   42
     CANN43              EXCEPT    FØLBR
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ******************************************
     C     UTPAK         BEGSR
      ******************************************
     C                   Z-ADD     57            WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              41
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   MOVE      *BLANKS       KFMT3
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C                   EXCEPT    PPAKK
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM3         TAG
     C     KOPFM         READE     KODTFM                                 42
     C   42              MOVE      *ZEROS        KFMSD
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C                   EXCEPT    PPAKK
     C                   GOTO      STFM3
     C                   END                                                     2<-E
     C   42
     CANN43              EXCEPT    PPAKK
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ******************************************
     C     UTLMRK        BEGSR
      ******************************************
     C                   Z-ADD     9             WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              41
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   MOVE      *BLANKS       KFMT3
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C                   EXCEPT    LMERK
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM4         TAG
     C     KOPFM         READE     KODTFM                                 42
     C   42              MOVE      *ZEROS        KFMSD
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C                   EXCEPT    LMERK
     C                   GOTO      STFM4
     C                   END                                                     2<-E
     C   42
     CANN43              EXCEPT    LMERK
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ******************************************
     C     UTMMRK        BEGSR
      ******************************************
     C                   Z-ADD     8             WSPLNR            3 0
     C     KODTPK        CHAIN     KODTP                              41
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C                   MOVE      *BLANKS       KFMT3
      *
     C     KOPFM         IFEQ      *BLANKS                                      1<-B
     C                   EXCEPT    MERKL
     C                   ELSE                                                   1
     C                   MOVEA     '00'          *IN(42)
     C     KOPFM         SETLL     KODTFM
     C     STFM5         TAG
     C     KOPFM         READE     KODTFM                                 42
     C   42              MOVE      *ZEROS        KFMSD
     C  N42              DO                                                      2<-B
     C                   MOVE      '1'           *IN43
     C                   EXCEPT    MERKL
     C                   GOTO      STFM5
     C                   END                                                     2<-E
     C   42
     CANN43              EXCEPT    MERKL
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
TMP49 * OBS IKKE FJERN DENNE LINJEN,
TMP49 *     NYTTIG FOR TEST DEBUG:   NÅR 49 ER ON VIL DET I POSISJON 77/78
TMP49 *     AV FRAKTBREVET BLI SKREVET LINJENR (SOM PROGRAMMET TROR DET ER PÅ)
TMP49C                   MOVE      *OFF          *IN49                          IKKE PRINT LINJENR
TMP49C*                  MOVE      *ON           *IN49                          PRINT LINJENR
      *
N22  C     CUNDCK        KLIST
N22  C                   KFLD                    FIFIRM
N22  C                   KFLD                    CTYPE1           30
N22  C                   KFLD                    DFKNSM
N22  C                   eval      ctype1='*FRAKTBREV'
N22  C     CUNDCK2       KLIST
N22  C                   KFLD                    FIFIRM
N22  C                   KFLD                    CTYPE1           30
N22  C                   KFLD                    KUNDE0            8 0
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    WSPLNR
     C                   MOVE      'P'           WSPUNI            1
N17  C     KODFRK        KLIST
N17  C                   KFLD                    KFRUNI
N17  C                   KFLD                    HEFR
N17  C                   MOVE      'FR'          KFRUNI
      *
     C     YSTSGAVD      KLIST
     C                   KFLD                    YST1
     C                   KFLD                    USG
     C                   KFLD                    UAVD
      *
     C     YSTAVD        KLIST
     C                   KFLD                    YST1
     C                   KFLD                    UAVD
      *
     C     DOKUFZ        KLIST
     C                   KFLD                    YST1
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
      *
     C     DOKUFZ6       KLIST
     C                   KFLD                    YST1
     C                   KFLD                    USG
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
     C     HEADFK        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
      *
      *
     C     TURke         KLIST
     C                   KFLD                    YPRO              8 0
      *
     C     FAK2K         KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    YSK
      *
     C     FAKTK         KLIST
     C                   KFLD                    FAAVD
     C                   KFLD                    FAOPD
     C                   KFLD                    FALI
      *
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    YKN
      *
     C     KODTSK        KLIST
     C                   KFLD                    YTSUNI
     C                   KFLD                    DFTOLL
      *
     C     KODGEK        KLIST
     C                   KFLD                    YGEUNI
     C                   KFLD                    FAVK
      *
     C     DOKUFK        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YFBNR
     C*
     C     DOKUVK        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
      *
     C     DOKUFMKEY     KLIST
     C                   KFLD                    FVRI
     C                   KFLD                    FVAVD
     C                   KFLD                    FVOPD
     C                   KFLD                    FVFBNR
     C                   KFLD                    FVLINR
     C                   KFLD                    FMMKNR
     C                   KFLD                    FMLONR
      *
     C     DOKUFY        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
     C     DOKUFX        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
N37  C     DOKUFEKEY     KLIST
N37  C                   KFLD                    DFAVD
N37  C                   KFLD                    DFOPD
N37  C                   KFLD                    DFFBNR
N37  C                   KFLD                    FE_N3035
      *
N24  C     FarlKey       KLIST
N24  C                   KFLD                    DFAVD
N24  C                   KFLD                    DFOPD
N24  C                   KFLD                    DFFBNR
N24   *
N24  C     UnNrKeyF      KLIST
N24  C                   KFLD                    FFUNNR
N24  C                   KFLD                    FFEMBG
N25  C                   KFLD                    FFINDX
N24   *
     C     TRAKEY        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    DFTRAN
      *
     C     FSKEY         KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
     C     FRIKEYIFB     KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    FSKODE
      *
     C     R29KEY        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
N11  C     FreeKey       KLIST
N11  C                   KFLD                    DFAVD
N11  C                   KFLD                    DFOPD
N11  C                   KFLD                    FRTKOD
     C     DGSKEY        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
     C                   KFLD                    DGSLINR
     C                   Z-ADD     99            DGSLINR
      *
     C     KODVKK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    UAVD
N35   *
N35  C     KODTAK        KLIST
N35  C                   KFLD                    KOAUNI
N35  C                   KFLD                    HEAVD
N35  C                   MOVE      'A'           KOAUNI
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPRANT            2
     C                   PARM                    UKODE             1
     C                   PARM                    UVB               1
     C                   PARM                    UPO               1
     C                   PARM                    PDFDIR            1
     C     PDFDIR        COMP      'J'                                    52
      *
     C     UPRO          IFNE      *ZEROS
     C     UPO           andne     'F'
     C     UPO           andne     'M'
     c                   move      'T'           upo
     c                   end
      * UPO = T = Kjør ALLE fraktbrev på gitt turnr (avh. av avd/sign)
     C     UPO           IFEQ      'T'
     C                   MOVE      USG           USGGM             3
     C                   MOVE      'ALL'         USG
     C                   END
N17  C     UPO           IFEQ      'O'
N17  C                   MOVE      'F'           UPO                            F= Fax/arkiv
S26   ** omgjort til test om dokuf finnes uavh av type ....
N26  C**   UKODE         IFNE      'T'                                          V/TTollp fins DOKUF
N17  C                   MOVE      'J'           URLOPD            1
N26  C**                 ENDIF
N17  C                   END
      *
      * Ukode = T, KJØR  TOLLPASS, 50 ON./ ellers     KJØR FRAKTBREV 50 OFF
     C     UKODE         COMP      'T'                                    50
      *
     c                   move      'J'           wsfb
     C                   move      'J'           wsml
     C                   MOVE      *ZEROS        YAVD              4 0
     C                   MOVE      *ZEROS        YOPD              7 0
     C                   MOVE      ' '           YSK               1
     C                   MOVE      *ZEROS        YKN               8 0
     C                   MOVE      'TST'         YTSUNI            3
     C                   MOVE      'GE'          YGEUNI            2
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      'F'           YRI               1
     C                   Z-ADD     1             YFBNR             3 0
     C                   MOVE      *ZEROS        XPRANT            2 0
     C                   MOVEA     *BLANKS       T
     C                   MOVEA     *ZEROS        B
     C                   MOVEA     *BLANKS       M
     C                   MOVE      *ZEROS        HEAVD
     C                   MOVE      *ZEROS        HEOPD
     C                   MOVE      *BLANKS       HESG
     C                   MOVE      *ZEROS        HEPRO
     C                   MOVE      *ZEROS        XFN
N27  C                   MOVE      *ZEROS        WKID
N43  C                   MOVE      *BLANKS       DFAD3S
     C                   MOVE      *BLANKS       DFAD3M
     C                   MOVE      *BLANKS       DFFASE
     C                   MOVE      *BLANKS       HEGN
     C                   MOVE      *BLANKS       HEPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   MOVE      *ZEROS        PXFFDT
N27  C                   MOVE      *ZEROS        XFFDT
N27  C                   MOVE      *ZEROS        FADAFF
     C                   MOVE      *ZEROS        PDATE1
     C                   MOVE      *ZEROS        DFDTU
N24  C                   MOVE      *ZEROS        R36VKT
N24  C                   MOVE      *ZEROS        R37DM3
     C                   MOVE      *BLANKS       HEFR
     C                   MOVE      *ZEROS        XTOTAL
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVE      UDT           UDT8              8 0
     C                   IF        UDT > 501231
     C                   MOVEL     '19'          UDT8
     C                   ELSE
     C                   MOVEL     '20'          UDT8
     C                   ENDIF
      *
     C                   MOVEL     '/'           STREK1
     C                   MOVEL     '/'           STREK2
     C                   MOVEL     '/'           STREK3
S11  C*                  MOVE      *BLANKS       BLANK20          20
N11  C                   MOVE      *BLANKS       BLANK20          17
      * Opprinnelse - i DFBref
     C                   MOVEL     'Op:'         OpprTx
     C                   MOVE      *zeros        TRAVD0
     C                   MOVEL     '/'           OpprSt1
     C                   MOVE      *zeros        TROPD0
     C*                  MOVEL     '/'           OpprSt2
      *
      *
     C                   MOVE      ' '           YST1              1
      *
     C     UFIRM         CHAIN     FIRM                               33
     C     UFIRM         CHAIN(N)  FIRFB                              33
     C     'sb'          chain     arktxt                             33
      *
     C     KODVKK        CHAIN     KODTV                              33
      *
      * HENT DATO/KLOKKESLETT
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
      * ULDT er nå dagens dato i form HHÅÅMMDD
     C                   MOVEL     XULDDMM       DTDMÅ             6 0
     C                   MOVE      XULÅÅ2        DTDMÅ
      * DTDMÅ er nå dagens dato i form DDMMÅÅ
      *
      * hent printerstyring for merkelapp (STRIPE eller ELTRON??)
     C                   Z-ADD     67            WSPLNR
     C                   MOVE      *BLANKS       KOPTY
     C                   MOVE      'N'           ELTRON            1
     C     KODTPK        CHAIN     KODTP                              33
     C     KOPTY         IFEQ      'ELTRON'
     C                   MOVE      'J'           ELTRON
     C                   END
N15   * label på laser/A4..
N15  C     KOPLAS        IFEQ      'J'
N15  C     KOPLAS        oreq      'P'
N15  C     KOPLAS        oreq      'F'
N15  C                   MOVE      'J'           LABLAS            1
N15  C                   END
     C
      *
     C                   ENDSR
      *
      */////////////////////////////////////////////////////////////////////////
      *// LEGG UT RECORD I MSG-LOGG ISTEDEN FOR Å SKRIVE UT                   //
      */////////////////////////////////////////////////////////////////////////
     C     SRCMN         BEGSR
     C     arkjn         ifeq      'J'
     c                   exsr      arksr
     c                   end
     C     TRAKEY        CHAIN(N)  TRAN                               39
     C     *IN39         IFEQ      *OFF
     C                   SELECT
     C     VMLAYO        WHENEQ    'TG'
     C                   CALL      'SYFA12TG'
     C                   PARM                    UFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C     VMLAYO        WHENEQ    'LG'
     C                   CALL      'SYFA12LG'
     C                   PARM                    UFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C     VMLAYO        WHENEQ    'PO'
     C                   CALL      'SYFA12PO'
     C                   PARM                    UFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C     VMLAYO        WHENEQ    'P4'
     C                   CALL      'SYFA12PO04'
     C                   PARM                    UFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
N19  C     VMLAYO        WHENEQ    'BR'
N19  C                   CALL      'SYFA12BR'
N19  C                   PARM                    UFIRM
N19  C                   PARM                    DFAVD
N19  C                   PARM                    DFOPD
N19  C                   PARM                    DFFBNR
     C     VMLAYO        WHENEQ    'MC'
     C                   CALL      'SYFA12MC'
     C                   PARM                    UFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   ENDSL
     C                   ENDIF
     C                   ENDSR
      *
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
     C                   MOVE      DFFBNR        TTFBNR
     C                   MOVE      'PRW'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      UUSR          TTUSER
     C                   MOVEL     'Printed '    XXTEXT           16
     C                   MOVE      'Waybill '    XXTEXT
     C                   MOVEL     XXTEXT        TTTEXT
N12  C                   EVAL      TTTEXL='Skrevet fraktbrev'
     C                   MOVE      *blanks       YYTEXT           50
N12  C                   MOVE      *blanks       YYTEXL           50
     c     dfcmn         ifne      ' '
     c     dfcmn         andne     'N'
     C                   eval      YYTEXT = 'EDI to: ' + DFNAT
N12  C                   eval      YYTEXL = 'EDI til: ' + DFNAT
     c                   end
     C                   MOVE      WSSN17        YYTEXT
     C                   MOVE      YYTEXT        TTTEXT
N12  C                   MOVE      WSSN17        YYTEXL
N12  C                   MOVE      YYTEXL        TTTEXL
     C                   WRITE     TRACKFR
     C                   ENDSR
N30  C***********************************************
N30  C     TTSRP         BEGSR
N30  C***********************************************
N30  C                   MOVE      HEAVD         TTAVD
N30  C                   MOVE      HEOPD         TTOPD
N30  C                   MOVE      DFFBNR        TTFBNR
N30  C                   MOVE      'PKR'         TTACTI
N30  C                   MOVE      ULDT          TTDATE
N30  C                   MOVE      XULTM         TTTIME
N30  C                   MOVE      TTDATE        TTDATL
N30  C                   MOVE      TTTIME        TTTIML
N30  C                   MOVE      UUSR          TTUSER
N30  c                   EVAL      TTTEXT = 'COD generated - Amount:'
N30  C                             +%trim(%editc(DFBELE:'J'))
N30  c                             + ' Invno:'
N30  C                             +%trim(%editc(XFN:'Z'))
N30  c                   EVAL      TTTEXL = 'COD generert - Beløp:'
N30  C                             +%trim(%editc(DFBELE:'J'))
N30  c                             + ' Faktn:'
N30  C                             +%trim(%editc(XFN:'Z'))
N30  C                   WRITE     TRACKFR
N30  C                   ENDSR
     C***********************************************
     C     Arksr         BEGSR
     C***********************************************
     C     keya02        klist
     C                   kfld                    arstat
     C                   kfld                    aravd
     C                   kfld                    aropd
     C                   kfld                    artype
     C                   kfld                    arunde
     c     kfmsd         iflt      2
     C     FIFIRM        CHAIN     FIRMARC                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      DFAVD         ARAVD
     C                   MOVE      DFOPD         AROPD
     C                   MOVEL     DFFBNR        ARUN04            4
     C                   MOVE      'F'           ARUN04
     C     DFTOLL        IFNE      0
     C                   MOVE      'T'           ARUN04
     C                   END
     C                   MOVEL     ARUN04        ARUNDE
     C                   MOVE      'sb'          ARTYPE
     C                   MOVE      UUSR          ARUSER
     C                   MOVE      ULDT          ARdate
     C                   MOVE      xultm         ARtime
     C                   Z-ADD     DFKNSM        ARKUND
     C     keya02        chain     arkivl02                           33
N40  c     *in33         ifeq      '1'
S40  C*  33              WRITE     ARKIVR
n40  C                   WRITE     ARKIVR
N40  C                   ELSE
N40  C                   EXSR      DELARK
N40  C                   MOVE      ' '           ARSTAT
N40  C                   UPDATE    ARKIV02R
N40  C                   END
     C                   END
     C                   END
     C                   ENDSR
N27  C***********************************************
N27  C     Arksr2        BEGSR
N27  C***********************************************
N27   * arkiver faktura
N27   *
N27  C                   MOVE      FIFIRM        ARFIRM
N27  C                   MOVE      DFAVD         ARAVD
N27  C                   MOVE      DFOPD         AROPD
N27  C                   MOVEL     FAFAKT        ARUNDE
N27  C                   MOVE      'fa'          ARTYPE
N27  C                   MOVE      UUSR          ARUSER
N27  C                   MOVE      ULDT          ARDATE
N27  C                   MOVE      XULTM         ARTIME
N27  C                   MOVE      FAKUNR        ARKUND
N27  C                   WRITE     ARKIVR
N27  C                   ENDSR
N27   **************************************************************************
N27  C     MOD10         BEGSR                                                                 D150
N27   **************************************************************************
N27  C                   MOVE      FAKUNR        KIDKUN
N27  C                   MOVE      FAFAKT        KIDFAK
N27  C                   MOVE      *ZEROS        XNULL
N27  C                   MOVE      *ZEROS        UPAR21           21
N27  C                   move      *blanks       nykid            20
N27   * kid 8 lang
N27  C     UFIRM         CHAIN     FIRKID                             33
N27  c     *in33         ifeq      '0'
n27  C                   MOVE      FAFAKT        UPAR21
N27  C                   CALL      'SYGE09'
N27  C                   PARM                    UPAR21
N27  C                   PARM                    UMOD              1 0
n27  C                   MOVEL     FAFAKT        KID8              8
n27  C                   MOVE      UMOD          KID8
n27  C                   MOVEL     KID8          NYKID
n27  C                   else
N27   * kid 20 lang
N27  C                   MOVE      WKID          UPAR21
N27  C                   CALL      'SYGE09'
N27  C                   PARM                    UPAR21
N27  C                   PARM                    UMOD              1 0
N27  C                   MOVEl     WKID          NYKID
N27  C                   MOVE      UMOD          NYKID
N27  C                   END
     C* HENTER MODULUS TIL BELØP
     C                   MOVEL     DFBELE        BELKR             7 0
     C                   MOVE      DFBELE        BELOR             2 0
     C                   MOVE      *ZEROS        UPAR21           21
     C                   MOVE      *ZEROS        UPAR19           19
     C                   MOVE      BELKR         UPAR19
     C                   MOVEL     UPAR19        UPAR21
     C                   MOVE      BELOR         UPAR21
     C                   CALL      'SYGE09'
     C                   PARM                    UPAR21
     C                   PARM                    UMOD              1 0
     C                   MOVE      UMOD          KIDBEL            1
N27  C                   ENDSR                                                                 D150
N40  C***********************************************
N40  C     DELARK        BEGSR
N40  C***********************************************
N40  C*
N40  c                   move      *blanks       fradok           70
N40  c                   movel     arcane        fradok
N40  C     fradok        CAT       '/':0         fradok
N40  C     fradok        CAT       arlink:0      fradok
N40  C     fradok        CAT       '.pdf':0      fradok
N40  c                   call      'ARC041C1'
N40  c                   parm                    fradok
N40  c                   endsr
     OFØLGE     E            FØLBR            01
     O                       KFMT1               75
     O          E            FØLBR            01
     O                       KFMT2               75
     O          E            FØLBR            01
     O                       KFMT3               75
     O          E            FØLBR            02
     O                       DFNAVS              35
     O          E            FØLBR            03
     O                       DFAD1S              35
     O          E            FØLBR            04
     O                       DFAD2S              35
     O          E            FØLBR            06
     O                       DFPNLS              09
     O                       DFAD3S              39
     O          E            FØLBR            11
     O                       DFNAVM              35
     O          E            FØLBR            13
     O                       DFAD1M              35
     O          E            FØLBR            15
     O                       DFPOUL               9
     O                       DFADUL              40
     OPAKKET    E            PPAKK            01
     O                       KFMT1               75
     O          E            PPAKK            01
     O                       KFMT2               75
     O          E            PPAKK            01
     O                       KFMT3               75
     O          E            PPAKK            03
     O                       DFNAVM              37
     O          E            PPAKK            04
     O                       DFAD1M              37
     O                       UDAY                40
     O                                           41 '/'
     O                       UMONTH              43
     O                                           44 '/'
     O                       UYEAR               46
     O          E            PPAKK            05
     O                       DFAD2M              37
     O          E            PPAKK            06
     O                                           13 'Ref nr:'
     O                       HEAVD               18
     O                                           19 '/'
     O                       HEOPD               26
     OLLAPP     E            LMERK            01
     O                       KFMT1               75
     O          E            LMERK            01
     O                       KFMT2               75
     O          E            LMERK            01
     O                       KFMT3               75
     O          E            LMERK            01
     O                                           15 'Avsender:'
     O                                           15 'Avsender:'
     O          E            LMERK            02
     O                       DFNAVS              35
     O          E            LMERK            03
     O                       DFAD1S              35
     O          E            LMERK            04
     O                       DFAD2S              35
     O          E            LMERK            06
     O                       DFPNLS              09
     O                       DFAD3S              40
     O          E            LMERK            07
     O              N50                          15 'Mottaker:'
     O              N50                          15 'Mottaker:'
     O               50                          15 'Speditør:'
     O               50                          15 'Speditør:'
     O          E            LMERK            08
     O                       DFNAVM              35
     O          E            LMERK            10
     O                       DFAD1M              35
     O               61                          49 'Utl.forbe-'
     O               61                          49 'Utl.forbe-'
     O          E            LMERK            11
     O               61                          48 'hold  Kr.'
     O               61                          48 'hold  Kr.'
     O          E            LMERK            12
     O                       DFAD3M              36
     O               61      XTOTAL        J     48
     O               61      XTOTAL        J     48
     O               61      XTOTAL        J     48
     O          E            LMERK            13
     O              N50                          15 'Lev.adr: '
     O              N50                          15 'Lev.adr: '
     O               50                          19 'End.mottaker:'
     O               50                          19 'End.mottaker:'
     O                                           48 'Ant.kolli'
     O                                           48 'Ant.kolli'
      * NY LINJE MED NAVN... ØVRIGE 1 LINJE NED
     O          E            LMERK            14
     O                       DFNAVL              35
     O          E            LMERK            15
     O                       DFAD1L              35
     O                       DFNT          Z     46
     O          E            LMERK            16
     O                       DFPOUL               9
     O                       DFADUL              40
     O          E            LMERK            17
     O               50                          35 'UFORTOLLET GODS !'
     O          E            LMERK            17
     O               50                          35 'UFORTOLLET GODS !'
     O          E            LMERK            17
     O               50                          35 'UFORTOLLET GODS !'
     OMLAPP     E            MERKL            01
     O                       KFMT1               75
     O          E            MERKL            01
     O                       KFMT2               75
     O          E            MERKL            01
     O                       KFMT3               75
     OMLAPP     E            MERKL            05
     O                       DFNAVS              40
     O          E            MERKL            06
     O                       DFAD1S              40
     O          E            MERKL            07
     O                       DFAD2S              40
     O          E            MERKL            09
     O                       DFPNLS              14
     O                       DFAD3S              44
     O          E            MERKL            11
     O                       DFNAVM              40
     O          E            MERKL            13
     O                       DFAD1M              40
     O          E            MERKL            15
     O                       DFAD3M              40
     O          E            MERKL            17
     O                       DFAD1L              40
     O          E            MERKL            19
     O                       DFPOUL              14
     O                       DFADUL              45
     O          E            MERKL            21
     O                       DFOVER              27
     O          E            MERKL            25
     O                                            2 '.'
     O          E            MERKL            29
     O                       DFNT          Z     20
     O               61      XTOTAL        J     40
     OFAKTR     E            OPDFAK
N27  O                       FASK
     O                       FAOPKO
     O                       FAKUNR
     O                       FAFAKT
     O                       FACC
     O                       FAÅR
     O                       FAMND
     O                       FADATO
     O                       FADAFF
N30  O                       FAKDA
     OHEADFR    E            OPDHEA
     O                       HEST
     O                       HEPK1
     ODOKUFR    E            DUMDOK
     ODOKUFR    E            OPDDOK
     O                       DFST
N04  O                       DFKDME
     O                       DFDTU
     O                       DFBELE
N27  O                       DFFRKU
     O                       DF1004
     O          E            OVMDOK
     O                       DFST
