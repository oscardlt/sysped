********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK PÅ LEVERANDØRS VARENR
10XXX * 02 JOV PTF10 Vis GN/MRN uavhengig av M-rap-status
10XXX * 03 JOV PTF10 Vis også MOTTAKER sammen med GN/MRN
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
11XXX * 04 JOV PTF11 INNFØRT FELTER FOR FRAKT VEDR INNLEGG PÅ TOLLAGER
11XXX * 05 JOV PTF11 OPT. M = Mot-rap.header - Arb m / see avh av status
11XXX * 06 YBC PTF11 OPSJON D = VIS SAMMENSLÅINGS DETALJE
11XXX * 07 JOV PTF11 Ved ENDERING av varenummer på 'åpen' post fiks også i subregister
********************************************************************
     H DATEDIT(*YMD)
      ***********************************************************
      *** REGISTRERING AV VARNER LAGER                        ***
      ***********************************************************
      *
     FLLTELL    UF A E             DISK
     FLLVARE01  UF   E           K DISK
     FLLVARE03  IF   E           K DISK    RENAME(LLVARER:LLVARER3)
     FLLAGFLOG  O  A E             DISK
     FLLSERL03  UF   E           K DISK
N04  FLLAGJFEU  UF A E           K DISK
     FLLAGJL01  UF A E           K DISK
     FLLAGJL02  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL2)
     FLLAGJL03  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL3)
     FLLAGJL04  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL4)
     FLLAGJL06  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL6)
     FLLAGJL07  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL7)
N01  FLLAGJL12  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL12)
     FLLAGJL99  IF   E           K DISK    RENAME(LLAGJR:LLAGJRL9)
     FLLAGJS02  IF   E           K DISK    RENAME(LLAGJR:LLAGJRS2)
     FLLAGJS03  IF   E           K DISK    RENAME(LLAGJR:LLAGJRS3)
     FLLAGJS04  IF   E           K DISK    RENAME(LLAGJR:LLAGJRS4)
     FLLAGJS06  IF   E           K DISK    RENAME(LLAGJR:LLAGJRS6)
N01  FLLAGJS12  IF   E           K DISK    RENAME(LLAGJR:LLAGJRS12)
     FLLAGJD01  IF A E           K DISK
     FLLLSDF    IF   E           K DISK
     FLLGRPK05  IF   E           K DISK
     FLLTKF     IF   E           K DISK
     FLLULLF    IF   E           K DISK
     FLLMRF     IF   E           K DISK
     FLLMRFL01  IF   E           K DISK    RENAME(LLMRFR:LLMRFR01)
     FLLMRFL03  IF   E           K DISK    RENAME(LLMRFR:LLMRFR03)
     FLLMRFL04  IF   E           K DISK    RENAME(LLMRFR:LLMRFR04)
     FLLMRFL09  IF   E           K DISK    RENAME(LLMRFR:LLMRFR09)
     FLLMRFL10  IF   E           K DISK    RENAME(LLMRFR:LLMRFR10)
     FLLLISF    IF   E           K DISK
     FLLAUTF    IF   E           K DISK
     FKODTVA    IF   E           K DISK
     FKUFAST    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FHEADF     IF   E           K DISK
     FLL020D    CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     F                                     SFILE(SUBFIL:ZRECNO)
      ***********************************************************
     D LC              S             25    DIM(999)
     D PL              S             20    DIM(999)
     D                 DS
     D  MXFELT                 1     30
     D  MX                     1     30
     D                                     DIM(30)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  DATOF                  1      8  0
     D  SEDATF                 3      8  0
     D  SEFHH                  1      2  0
     D  SEFÅÅ                  3      4  0
     D  SEFMM                  5      6  0
     D  SEFDD                  7      8  0
     D                 DS
     D  DATOT                  1      8  0
     D  SEDATT                 3      8  0
     D  SETHH                  1      2  0
     D  SETÅÅ                  3      4  0
     D  SETMM                  5      6  0
     D  SETDD                  7      8  0
     D                 DS
S01  D* SEX                    1      4
N01  D  SEX                    1      5
     D  SEXDAT                 1      1
     D  SEXART                 2      2
     D  SEXLOK                 3      3
     D  SEXSEN                 4      4
N01  D  SEXARL                 5      5
     D                 DS
     D  WTIME                  1     14  0
     D  WTM                    1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D                 DS
     D  DATO                   1      8  0
     D  DTÅ                    1      4  0
     D  DTM                    5      6  0
     D  DTD                    7      8  0
     D                 DS
     D  XXVARE                 1     35
     D  XSLETT                 1      6
     D  XXVA19                17     35
     D                 DS
     D  WRDATO                 1      8  0
     D  WRDATÅ                 1      4  0
     D  WRDATM                 5      6  0
     D  WRDATD                 7      8  0
     D                 DS
     D  WRULDT                 1      8  0
     D  WRULDÅ                 1      4  0
     D  WRULDM                 5      6  0
     D  WRULDD                 7      8  0
     D                 DS
     D  WRPRDT                 1      8  0
     D  WRPRDÅ                 1      4  0
     D  WRPRDM                 5      6  0
     D  WRPRDD                 7      8  0
     D                 DS
     D  WRDTV                  1      8  0
     D  WRDTVÅ                 1      4  0
     D  WRDTVM                 5      6  0
     D  WRDTVD                 7      8  0
     D                 DS
     D  WRLLOK                 1     25
     D  WRLOK1                 1      5
     D  WRLOK2                 6     25
     D  LS                     6     14
     D                                     DIM(9)
     D  LS2                   15     25
     D  LS2L                   6      7
     D  LS2B                   8      9
     D  LS2H                  10     11
     D  LS3L                   6      8
     D  LS3B                   9     11
     D  LS3H                  12     14
     D                 DS
     D  SELLOK                 1     25
     D  SELOK1                 1      5
     D  SELOK2                 6     25
     D                 DS
     D  WRAN01                 1      5  0
     D  WRAN00                 1      5  0
     D                 DS
     D  MRGN                   1     15
     D  XXGN                  15     15
     D                 DS
     D  UPARM2                 1     64
     D  UGRUP                  1      8
     D  UKJED                  9     16
     D  UMRNR                 17     21
     D  UOPT                  22     22
     D  UKOPI                 23     23
      *______________________
      * Initiering
      *""""""""""""""""""""""
     C                   EXSR      INIT
     C     UMRNRA        IFEQ      *ZEROS
     C                   MOVE      '0'           *IN28
     C                   ELSE
     C                   CLEAR                   VARELI
     C                   MOVE      '1'           *IN28
     C                   MOVE      UGRPA         SEGRUP
     C     SEGRUP        IFEQ      0
     C                   MOVE      *BLANKS       NVNGRU
     C                   ELSE
     C                   MOVE      SEGRUP        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNGRU
     C                   END
     C                   MOVE      UPNRA         SEKJED
     C                   MOVE      SEKJED        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNKJE
     C                   MOVE      UMRNRA        SEMRNR
     C                   MOVE      ' '           SESAL
     C     SESAL         COMP      '+'                                    50
     C                   MOVE      *ZEROS        XMN
     C                   MOVE      'J'           SELOK
     C                   MOVE      '0'           *IN50
S01  C*                  MOVEA     '0000100'     *IN(52)
N01  C                   MOVEA     '00001000'    *IN(52)
     C                   Z-ADD     1             MODUS             1 0
     C                   MOVEA     '00'          *IN(42)
     C                   MOVE      SEGRUP        VAGRUP
     C                   MOVE      SEKJED        VAKJED
     C                   MOVE      NVNGRU        XXNGRU           30
     C                   MOVE      NVNKJE        XXNKJE           30
     C                   GOTO      START
     C                   END
      *
     C     BG1           TAG
     C                   EXSR      SØK
      *
     C     SEKJED        CHAIN     LLAUTF                             33
     C                   IF        *IN33 = *OFF
     C     LLAUTFK       KLIST
     C                   KFLD                    SEKJED
     C                   KFLD                    ZUSER
     C     LLAUTFK       CHAIN     LLAUTF                             33
     C   33              GOTO      ENDPGM
     C                   END
     C                   MOVE      SEKJED        KFTYP
      *
      *___________________________
      * Hovedlogikk
      *"""""""""""""""""""""""""""
      *______________
      * Clear Subfil
      *""""""""""""""
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      ' '           WSNR
      *
      * MERKE OM BRUKER BENYTTER SØKEVEI AV MOTTAKSRAPPORTNR
     C     *IN56         IFEQ      '0'
     C                   MOVE      'N'           XSØKMR            1
     C                   ELSE
     C                   MOVE      'J'           XSØKMR
     C                   END
      *_____________
      * Fyll Subfil
      *"""""""""""""
     C                   EXSR      SETKEY
      *
     C     START1        TAG
     C                   DO        14
     C     ST11          TAG
     C                   EXSR      LESREC
      *
     C     *IN94         IFEQ      '0'
     C  N56
     CANN57
     CANN63
     CANN64
     CANN58              EXSR      SELECT
     C     SELOK         IFEQ      'U'
     C                   GOTO      UTSUB
     C                   END
     C     SELOK         IFEQ      'N'
     C                   GOTO      ST11
     C                   END
      *  MODUS 1 = ARTNR, LAGERLOKASJON   42 *OFF  43 *OFF
      *  MODUS 2 = VAREBESKR              42 *ON   43 *OFF
      *  MODUS 3 = BATCHNR                42 *ON   43 *ON
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL
      *
     C     XMN           IFNE      0
     C     XMN           ANDEQ     VAMN
      * HIGHLIGHT PÅ DENNE NYREGISTRERTE LINJEN OG FJERN NYREG. MERKET.
     C                   MOVE      *ZEROS        XMN
     C                   MOVE      '1'           *IN51
     C                   END
      *
     C                   ADD       1             ZRECNO
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   WRITE     SUBFIL
     C                   MOVE      '0'           *IN51
     C                   ENDIF                                                  <*IN94
     C  N94              ENDDO                                                  <DO 14
      *
     C  N94XMN           CABNE     0             START1
      *
     C     UTSUB         TAG
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
      *________________
      * Display Subfil
      *""""""""""""""""
     C     START3        TAG
     C  N30              Z-ADD     7             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
      * TOM SUBFIL....
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NOREC
     C                   ELSE                                                   <ZRECNO
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   ENDIF                                                  <ZRECNO
      *
     C                   MOVEA     '0000000'     *IN(30)
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030C'
     C                   GOTO      START3
     C                   END
     C                   SETOFF                                       9998
      *
      * MODUS VIS VARETEKSY / ART.NR
     C     *IN07         IFEQ      *ON
      *  MODUS 1 = ARTNR, LAGERLOKASJON     42 *OFF  43 *OFF
      *  MODUS 2 = VAREBESKR                42 *ON   43 *OFF
      *  MODUS 3 = BATCHNR                  42 *ON   43 *ON
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   Z-ADD     2             MODUS             1 0
     C                   MOVEA     '10'          *IN(42)
     C     MODUS         WHENEQ    2
     C                   Z-ADD     3             MODUS
     C                   MOVEA     '11'          *IN(42)
     C     MODUS         WHENEQ    3
     C                   Z-ADD     1             MODUS
     C                   MOVEA     '00'          *IN(42)
     C                   ENDSL
     C                   GOTO      START
     C                   ENDIF                                                  <*IN07
      *** F3=Gå ut
     C     *IN03         IFEQ      '1'
     C                   GOTO      ENDPGM
     C                   ENDIF                                                  <*IN03
      *** F5=FORNY
     C     *IN05         IFEQ      '1'
     C                   GOTO      START
     C                   ENDIF                                                  <*IN05
      *** F6=Lag ny
     C     *IN06         IFEQ      '1'
     C     *IN28         ANDEQ     '0'
     C     *IN16         OREQ      '1'
     C     *IN28         ANDEQ     '0'
     C   16              MOVE      *ZEROS        VAMRNR
     C   16              MOVE      *ZEROS        WRMRNR
     C                   EXSR      LAGNY
     C     *IN12         IFEQ      '0'
     C     XSØKMR        ANDEQ     'N'
      * HVIS BRUKER BENYTTER IKKE SØKEVEI AV MOTTAKSRAPPORTNR, TVUNGER
      * PROGRAM TIL DENNE SØKEVEIEN.
     C                   MOVE      '0'           *IN50
     C                   MOVE      *BLANKS       SESAL
     C                   MOVE      'J'           SELOK
     C                   MOVEA     '0000100'     *IN(52)
     C                   MOVE      VAMRNR        SEMRNR
     C                   MOVE      VAMN          XMN               7 0
     C                   GOTO      START
     C                   END
     C                   GOTO      START3
     C                   ENDIF                                                  <*IN06
      *** F11=UTSKRIFT AV MOTTAKSRAPPORT
     C   11WRMRNR        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C     LLMRFL01K     CHAIN     LLMRFL01                           90
     C                   IF        *IN90
     C                   MOVE      'N'           WRPRØV
     C                   MOVE      'J'           UKOPI
     C                   ELSE
     C                   MOVE      'J'           WRPRØV
     C                   MOVE      'N'           UKOPI
     C                   END
     C                   EXFMT     MOTRAP
     C     *IN12         IFEQ      '0'
     C                   MOVE      SEGRUP        UGRUP
     C                   MOVE      SEKJED        UKJED
     C                   MOVE      WRMRNR        UMRNR
     C     WRPRØV        IFEQ      'J'
     C                   MOVE      '9'           UOPT
     C                   ELSE
     C                   MOVE      '6'           UOPT
     C                   END
     C                   CALL      'LL027C2'
     C                   PARM      UPARM2        UPARM1           64
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      START3
     C                   END
     C                   ENDIF                                                  <*WRMRNR
      *** AVSLUTT
     C     *IN28         IFEQ      '1'
     C     *IN12         ANDEQ     '1'
     C                   GOTO      ENDPGM
     C                   END
      *** Søk
     C     *IN28         IFEQ      '0'
     C     *IN08         IFEQ      *ON
     C     *IN12         OREQ      *ON
     C                   GOTO      BG1
     C                   ENDIF                                                  <*IN08
     C                   ENDIF
      *** Roll
     C     *IN25         IFEQ      '1'
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      '0'           *IN25
     C                   GOTO      START1
     C                   ENDIF                                                  <*IN25
      *** Finn valg
     C     ZRECNO        IFNE      0
     C                   EXSR      GETOPT
     C                   IF        WSNR = 'X'
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      START
     C                   END
     C                   END
     C                   GOTO      START3
      *
     C     ENDPGM        TAG
     C                   MOVE      XFLAGG        UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SETKEY        BEGSR
      ***********************************************
      * 50 ON = KUN POSTER MED SALDO ULIK 0 (OFF = UAVHENGIG AV SALDO)
      * 50 OFF= HVIS SESAL ' ' -> VIS ALLE POSTER
      * 50 OFF= HVIS SESAL '0' -> VIS KUN POSTER MED SALDO 0
     C     *IN50         IFEQ      '0'
     C   52GODKE2        SETLL     LLAGJL02                           77
     C   53GODKE3        SETLL     LLAGJL03                           77
N01  C   59GODKE12       SETLL     LLAGJL12                           77
     C   54GODKE4        SETLL     LLAGJL04                           77
     C   55GODKE6        SETLL     LLAGJL06                           77
     C   56GODKE7        SETLL     LLAGJL07                           77
     C   57              DO
     C     LKREFK        SETLL     LLMRFL03                           77
     C     LKREFK        READE     LLMRFL03                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C   94              MOVE      *ZEROS        MRMRNR
     C                   END
     C   58              DO
     C     LLREFK        SETLL     LLMRFL04                           77
     C     LLREFK        READE     LLMRFL04                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C   94              MOVE      *ZEROS        MRMRNR
     C                   END
     C   63              DO
     C     LGNK          SETLL     LLMRFL09                           77
     C     LGNK          READE     LLMRFL09                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C   94              MOVE      *ZEROS        MRMRNR
     C                   END
     C   64              DO
     C     LTRNRK        SETLL     LLMRFL10                           77
     C     LTRNRK        READE     LLMRFL10                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C   94              MOVE      *ZEROS        MRMRNR
     C                   END
     C                   ELSE
     C   52GODKE2        SETLL     LLAGJS02                           77
     C   53GODKE3        SETLL     LLAGJS03                           77
N01  C   59GODKE12       SETLL     LLAGJS12                           77
     C   54GODKE4        SETLL     LLAGJS04                           77
     C   55GODKE6        SETLL     LLAGJS06                           77
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     LESREC        BEGSR
      ***********************************************
     C     *IN50         IFEQ      '0'
      *
     C     NEXT          TAG
     C   52KEY1E         READE     LLAGJL02                               94
     C   53KEY1E         READE     LLAGJL03                               94
N01  C   59KEY1E         READE     LLAGJL12                               94
     C   54KEY1E         READE     LLAGJL04                               94
     C   55KEY1E         READE     LLAGJL06                               94
     C   56GODKE7        READE     LLAGJL07                               94
      *
     C   57              DO
     C     LMRK          READE     LLAGJL07                               94
     C     *IN94         IFEQ      '1'
     C     LKREFK        READE     LLMRFL03                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C  N94              GOTO      NEXT
     C                   END
     C                   END
      *
     C   58              DO
     C     LMRK          READE     LLAGJL07                               94
     C     *IN94         IFEQ      '1'
     C     LLREFK        READE     LLMRFL04                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C  N94              GOTO      NEXT
     C                   END
     C                   END
      *
     C   63              DO
     C     LMRK          READE     LLAGJL07                               94
     C     *IN94         IFEQ      '1'
     C     LGNK          READE     LLMRFL09                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C  N94              GOTO      NEXT
     C                   END
     C                   END
      *
     C   64              DO
     C     LMRK          READE     LLAGJL07                               94
     C     *IN94         IFEQ      '1'
     C     LTRNRK        READE     LLMRFL10                               94
     C  N94LMRK          SETLL     LLAGJL07                           77
     C  N94              GOTO      NEXT
     C                   END
     C                   END
      *
     C   56
     CANN94
     COR 57
     CANN94
     COR 63
     CANN94
     COR 64
     CANN94
     COR 58
     CANN94              DO
     C                   MOVE      VAMRNR        WRMRNR
     C                   MOVE      VALLOK        WRLLOK
     C                   MOVE      VAVERD        WRVERD
     C                   MOVE      VADATO        WRDATO
     C                   MOVE      VAAVD         WRAVD
     C                   MOVE      VAOPD         WROPD
     C                   END
      *
     C     *IN94         IFEQ      '0'
     C     SESAL         ANDEQ     '0'
     C     VASALD        ANDNE     *ZEROS
     C                   GOTO      NEXT
     C                   END
      *
     C                   ELSE
      *
     C   52KEY1E         READE     LLAGJS02                               94
     C   53KEY1E         READE     LLAGJS03                               94
N01  C   59KEY1E         READE     LLAGJS12                               94
     C   54KEY1E         READE     LLAGJS04                               94
     C   55KEY1E         READE     LLAGJS06                               94
      *
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     GETOPT        BEGSR
      ***********************************************
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   ENDIF                                                  <*IN98
     C                   MOVEA     '000000'      *IN(30)
     C                   MOVEA     '00'          *IN(45)
      ***  BLANK
     C     XSLETT        IFNE      '*SLETT'
     C     WSNR          IFEQ      ' '
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   ELSE                                                   <WSNR
      *
     C                   SELECT
      *** 2=Endre
     C     WSNR          WHENEQ    '2'
     C     VASTAT        ANDNE     'X'
     C     VADATO        ANDEQ     99999999
     C     *IN28         ANDEQ     '0'
     C                   EXSR      ENDRE
      *** 4=Slette
     C     WSNR          WHENEQ    '4'
     C     VASTAT        ANDNE     'X'
     C     *IN28         ANDEQ     '0'
     C                   EXSR      SLETTE
      *** 5=Vis
     C     WSNR          WHENEQ    '5'
     C                   EXSR      VISE
      *** 6=ENDRE LAGERLOK. M.M
     C     WSNR          WHENEQ    '6'
     C     VASTAT        ANDNE     'X'
     C     *IN28         ANDEQ     '0'
     C                   EXSR      ENDRE2
      *** 8 DETALJER UPDATE-MODUS
     C     WSNR          WHENEQ    '8'
     C     VASTAT        ANDNE     'X'
     C     *IN28         ANDEQ     '0'
     C                   EXSR      ARBEID
      *** 9 DETALJER SPØRRE-MODUS
     C     WSNR          WHENEQ    '9'
     C                   EXSR      VISE2
      *** A AKTIVERER
     C     WSNR          WHENEQ    'A'
     C                   EXSR      AKTIV
N06   *** D VIS SAMSLÅINGS DETALJE
N06  C     WSNR          WHENEQ    'D'
N06  C                   EXSR      VISDET
      *** V VISE ARTIKKEL
     C     WSNR          WHENEQ    'V'
     C                   EXSR      VISART
      *** S ARBEID MED SERIENR
     C     WSNR          WHENEQ    'S'
     C                   EXSR      WRKSER
      *** L ARBEID MED LISENS
     C     WSNR          WHENEQ    'L'
     C                   EXSR      WRKLIS
      *** X SPLITT INNLEGG
     C     WSNR          WHENEQ    'X'
     C                   EXSR      SPLITT
     C                   GOTO      ENDGET
     C     WSNR          WHENEQ    'E'
     C                   EXSR      ENDRE3
     C                   GOTO      ENDGET
N05  C     WSNR          WHENEQ    'M'
N05  C                   EXSR      SRMRAP
N05  C                   GOTO      ENDGET
      *
     C                   ENDSL
      *
     C     *IN12         IFEQ      '1'
     C     *IN30         OREQ      '1'
     C                   GOTO      ENDGET
     C                   ENDIF                                                  <*IN12
     C                   ENDIF                                                  <WSNR
     C                   ENDIF                                                  <XSLETT
      *
     C                   ENDDO
      *
     C     ENDGET        TAG
      *
     C                   ENDSR
      *
      ***********************************************
     C     SELECT        BEGSR
      ***********************************************
      * UTVERDI SELOK: N=LES NESTE
      *                U=HOPP UT AV LESELOOP (FORBI MAX PÅ GITT KEY)
      *
     C                   MOVE      'N'           SELOK             1
      *
      * FRA DATO UTFYLT
     C     DATOF         IFNE      *ZERO
     C     VADATO        ANDLT     DATOF
     C                   GOTO      UTSEL
     C                   ENDIF
      *
      * TIL DATO UTFYLT
     C     DATOT         IFNE      *ZERO
     C     VADATO        ANDGT     DATOT
     C     *IN52         IFEQ      '1'
     C                   MOVE      '1'           *IN94
     C                   MOVE      'U'           SELOK
     C                   ENDIF
     C                   GOTO      UTSEL
     C                   ENDIF
      * ART.NR  UTFYLT
     C     SEARTN        IFNE      *BLANKS
     C     *IN53         IFEQ      '1'
     C     VAANR         ANDGT     MXARTN
     C                   MOVE      '1'           *IN94
     C                   MOVE      'U'           SELOK
     C                   GOTO      UTSEL
     C                   ENDIF
     C     VAANR         IFLT      SEARTN
     C     VAANR         ORGT      MXARTN
     C                   GOTO      UTSEL
     C                   ENDIF
     C                   ENDIF
N01   * LEV.ART.NR  UTFYLT
N01  C     SEARTL        IFNE      *BLANKS
N01  C     *IN59         IFEQ      '1'
N01  C     VAANRL        ANDGT     MXARTL
N01  C                   MOVE      '1'           *IN94
N01  C                   MOVE      'U'           SELOK
N01  C                   GOTO      UTSEL
N01  C                   ENDIF
N01  C     VAANRL        IFLT      SEARTL
N01  C     VAANRL        ORGT      MXARTL
N01  C                   GOTO      UTSEL
N01  C                   ENDIF
N01  C                   ENDIF
      * LAGERLOK  UTFYLT
     C     SELLOK        IFNE      *BLANKS
     C     *IN54         IFEQ      '1'
     C     VALLOK        ANDGT     MXLLOK
     C                   MOVE      '1'           *IN94
     C                   MOVE      'U'           SELOK
     C                   GOTO      UTSEL
     C                   ENDIF
     C     VALLOK        IFLT      SELLOK
     C     VALLOK        ORGT      MXLLOK
     C                   GOTO      UTSEL
     C                   ENDIF
     C                   ENDIF
      * BATCHNR  UTFYLT
     C     SESENR        IFNE      *BLANKS
     C     *IN55         IFEQ      '1'
     C     VASENR        ANDGT     MXSENR
     C                   MOVE      '1'           *IN94
     C                   MOVE      'U'           SELOK
     C                   GOTO      UTSEL
     C                   ENDIF
     C     VASENR        IFLT      SESENR
     C     VASENR        ORGT      MXSENR
     C                   GOTO      UTSEL
     C                   ENDIF
     C                   ENDIF
      * TEST ARTIKKELGRUPPE
     C     SEAG          IFNE      *BLANKS
     C     LLVA2K        CHAIN(N)  LLVARE01                           33
     C     SEAG          IFNE      LVAG01
     C     SEAG          ANDNE     LVAG02
     C     SEAG          ANDNE     LVAG03
     C     SEAG          ANDNE     LVAG04
     C     SEAG          ANDNE     LVAG05
     C                   GOTO      UTSEL
     C                   ENDIF
     C                   ENDIF
      *
      * PASSERTE ALLE TESTER - SELEKSON = OK
     C                   MOVE      'J'           SELOK
      *
     C     UTSEL         ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    UGRPA             8
     C                   PARM                    UPNRA             8
     C                   PARM                    UMRNRA            5
     C                   PARM                    UFLAGG            1
     C     UFLAGG        IFEQ      'B'
     C                   MOVE      '1'           *IN27
     C                   MOVE      'B'           XFLAGG            1
     C                   ELSE
     C     UFLAGG        COMP      'J'                                2727
     C                   MOVE      ' '           XFLAGG
     C                   END
     C* UFLAGG INN = UPDATEMODUS (27 ON = SPØRRING)
      *
     C                   Z-ADD     0             ZRECNO            4 0
      *
     C                   MOVE      *ZEROS        DATOT
     C     *LIKE         DEFINE    SEARTN        MXARTN
N01  C     *LIKE         DEFINE    SEARTL        MXARTL
     C     *LIKE         DEFINE    SELLOK        MXLLOK
     C     *LIKE         DEFINE    SESENR        MXSENR
     C     *LIKE         DEFINE    WROANT        GMSALD
     C     *LIKE         DEFINE    WROANT        SALD
N07  C     *LIKE         DEFINE    VAANR         GMANR
      *
      *
     C     KEY1          KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMN
     C     KEY1E         KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C     LLVARK        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    WRANR
     C     LLVA2K        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAANR
     C     LLV03K        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    WRANRL
     C     LAG99K        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    WRANR
     C                   KFLD                    WRHK              3
     C                   KFLD                    WRDATO
     C     LLAGJD01K1    KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMN
     C                   KFLD                    XVDVNSIST
     C                   Z-ADD     999           XVDVNSIST         3 0
     C     LLAGJD01K2    KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMN
     C     GODKE2        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    DATOF
     C     GODKE3        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SEARTN
     C                   KFLD                    DATOF
N01  C     GODKE12       KLIST
N01  C                   KFLD                    VAGRUP
N01  C                   KFLD                    VAKJED
N01  C                   KFLD                    SEARTL
N01  C                   KFLD                    DATOF
     C     GODKE4        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SELLOK
     C                   KFLD                    DATOF
     C     GODKE6        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SESENR
     C                   KFLD                    DATOF
     C     GODKE7        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SEMRNR
     C     LKREFK        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SEKREF
     C     LLREFK        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SELREF
     C     LGNK          KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SEGN
     C     LTRNRK        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    SETRNR
     C     LMRK          KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    MRMRNR
      *
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YYKNR             8 0
     C     HEADFK        KLIST
     C                   KFLD                    WRAVD
     C                   KFLD                    WROPD
      *
     C     MRKEY         KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMRNR
     C     LMRFK         KLIST
     C                   KFLD                    WRGRUP
     C                   KFLD                    WRKJED
     C                   KFLD                    WRMRNR
     C     LLMRFL01K     KLIST
     C                   KFLD                    SEGRUP
     C                   KFLD                    SEKJED
     C                   KFLD                    WRMRNR
      *
     C     LULLK         KLIST
     C                   KFLD                    WRLOK1
     C                   KFLD                    WRLOK2
     C     KODVAK        KLIST
     C                   KFLD                    KVAUNI
S04  C*                  KFLD                    WRVAL
S04  C                   KFLD                    XXVAL             3
     C                   MOVE      'VA'          KVAUNI
     C     KUFASTK       KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    VAST2
     C                   MOVEL     'LS'          KFTYP
      *
     C                   MOVE      *BLANKS       SELLOK
      * 50 ON= KUN SALDO ULIK 0 / F.O.M. DATO
     C                   MOVE      '+'           SESAL
     C                   MOVE      *ZEROS        SEDATF
     C                   MOVE      *ZEROS        WRAN01
      * HENT DAGENS DATO
     C                   TIME                    WTIME
     C                   MOVE      WDD           DTD
     C                   MOVE      WMM           DTM
     C                   MOVE      WÅÅ           DTÅ
     C                   Z-ADD     DATO          IDAG              8 0
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
      *
     C                   ENDSR
      ***********************************************
     C     SØK           BEGSR
      ***********************************************
     C                   CLEAR                   VARELI
      *
     C     SEKJED        IFEQ      *ZEROS
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   ELSE
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
      *
     C     STSØK         TAG
     C     SEGRUP        COMP      0                                      49
     C                   EXFMT     BILDE01
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030C'
     C                   GOTO      STSØK
     C                   END
     C                   SETOFF                                       9998
      *
     C     *IN03         IFEQ      *ON
     C                   SETON                                        LR
     C                   RETURN
     C                   ENDIF                                                  <*IN03
     C     *IN04         IFEQ      *ON
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     LINNBR        IFEQ      8
     C     LINNBR        OREQ      9
     C     LINNBR        IFEQ      8
     C                   MOVE      'SØKGRP  '    UTYPE             8
     C                   ELSE
     C                   MOVE      SEGRUP        UTYPE
     C     SEGRUP        IFEQ      *ZEROS
     C                   MOVE      99999999      SEGRUP
     C                   END
     C                   END
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    SEGRUP
     C                   PARM                    SEKJED
     C     SEGRUP        IFEQ      99999999
     C                   MOVE      *ZEROS        SEGRUP
     C                   END
     C     SEGRUP        IFNE      0
     C                   MOVE      SEGRUP        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNGRU
     C                   END
     C                   MOVE      SEKJED        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNKJE
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     24
     C                   MOVE      *ZEROS        URMRNR            5 0
     C                   MOVE      'J'           USPØR             1
     C                   CALL      'LL023R'
     C                   PARM      SEGRUP        URGRUP            8 0
     C                   PARM      SEKJED        URKJED            8 0
     C                   PARM                    NVNKJE
     C     SEMRNR        PARM      SEMRNR        URMRNR
     C                   PARM                    USPØR
     C                   END
     C                   GOTO      STSØK
     C                   END
      *
     C     SEKJED        CHAIN     LLGRPK05                           30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'JOV0825'     MSGNR
     C                   GOTO      STSØK
     C                   ELSE
     C                   MOVE      GKGRP         SEGRUP
     C                   END
     C*
      * GYLDIG KUNDENR... GRUPPE
     C     SEGRUP        IFEQ      0
     C                   MOVE      *BLANKS       NVNGRU
     C                   ELSE
     C                   MOVE      SEGRUP        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C     *IN30         IFEQ      '1'
     C                   MOVE      *BLANKS       NVNGRU
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'JOV0824'     MSGNR
     C                   GOTO      STSØK
     C                   ELSE
     C                   MOVEL     KNAVN         NVNGRU
     C                   END
     C                   END
      *             ... KJEDE
     C                   MOVE      SEKJED        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C     *IN30         IFEQ      '1'
     C                   MOVE      *BLANKS       NVNKJE
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'JOV0825'     MSGNR
     C                   GOTO      STSØK
     C                   ELSE
     C                   MOVEL     KNAVN         NVNKJE
     C                   END
      *
     C     *IN10         IFEQ      '1'
     C                   MOVE      SEGRUP        UGRPA
     C                   MOVE      SEKJED        UPNRA
     C                   MOVE      *ZEROS        UMRNRA
     C                   MOVE      'B'           UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C                   MOVE      *ZEROS        XMN
     C                   MOVE      'J'           SELOK
      *
      * + FOR KUN GODSNR MED SALDO ULIK 0.
     C     SESAL         COMP      '+'                                    50
     C                   MOVEA     '0000000'     *IN(52)
     C                   MOVEA     '00'          *IN(63)
     C*_________________________________________________________
     C*   Sett indikator for hvilken fil som skal leses
     C*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SEX           IFNE      *BLANKS
     C* Når Tvungen søkevei er valgt - finn første X
     C* (men tillegssjekk på utfylt begrep må også gjøres)
      *
      *
     C     SEXDAT        IFNE      ' '
     C     SEDATF        ANDNE     *ZEROS
     C                   MOVE      '1'           *IN52
     C                   GOTO      SLTSØK
     C                   END
      *
     C     SEXART        IFNE      ' '
     C     SEARTN        ANDNE     *BLANKS
     C                   MOVE      '1'           *IN53
     C                   GOTO      SLTSØK
     C                   END
N01   *
N01  C     SEXARL        IFNE      ' '
N01  C     SEARTL        ANDNE     *BLANKS
N01  C                   MOVE      '1'           *IN59
N01  C                   GOTO      SLTSØK
N01  C                   END
      *
     C     SEXLOK        IFNE      ' '
     C     SELLOK        ANDNE     *BLANKS
     C                   MOVE      '1'           *IN54
     C                   GOTO      SLTSØK
     C                   END
      *
     C     SEXSEN        IFNE      ' '
     C     SESENR        ANDNE     *BLANKS
     C                   MOVE      '1'           *IN55
     C                   GOTO      SLTSØK
     C                   END
      *
     C                   ELSE
      * ART.NR
     C     SEARTN        IFNE      *BLANKS
     C                   MOVE      '1'           *IN53
     C                   GOTO      SLTSØK
     C                   END
N01   * ART.NR
N01  C     SEARTL        IFNE      *BLANKS
N01  C                   MOVE      '1'           *IN59
N01  C                   GOTO      SLTSØK
N01  C                   END
      * LAGERLOKASJON
     C     SELLOK        IFNE      *BLANKS
     C                   MOVE      '1'           *IN54
     C                   GOTO      SLTSØK
     C                   END
      * BATCHNR
     C     SESENR        IFNE      *BLANKS
     C                   MOVE      '1'           *IN55
     C                   GOTO      SLTSØK
     C                   END
     C                   END
      *
      * MOTTAKSRAPPORTNR
     C     SEMRNR        IFNE      0
     C                   MOVE      '0'           *IN50
     C                   MOVE      *BLANKS       SESAL
     C                   MOVE      '1'           *IN56
     C                   GOTO      SLTSØK
     C                   END
      * KUNDEREF TIL MOTTAKSRAPPORT
     C     SEKREF        IFNE      *BLANKS
     C                   MOVE      '0'           *IN50
     C                   MOVE      *BLANKS       SESAL
     C                   MOVE      '1'           *IN57
     C                   GOTO      SLTSØK
     C                   END
      * LEVERANDØRSREF. TIL MOTTAKSRAPPORT
     C     SELREF        IFNE      *BLANKS
     C                   MOVE      '0'           *IN50
     C                   MOVE      *BLANKS       SESAL
     C                   MOVE      '1'           *IN58
     C                   GOTO      SLTSØK
     C                   END
      * GODSNR. TIL MOTTAKSRAPPORT
     C     SEGN          IFNE      *BLANKS
     C                   MOVE      '0'           *IN50
     C                   MOVE      *BLANKS       SESAL
     C                   MOVE      '1'           *IN63
     C                   GOTO      SLTSØK
     C                   END
      * MRN-NR. TIL MOTTAKSRAPPORT
     C     SETRNR        IFNE      *BLANKS
     C                   MOVE      '0'           *IN50
     C                   MOVE      *BLANKS       SESAL
     C                   MOVE      '1'           *IN64
     C                   GOTO      SLTSØK
     C                   END
      *
     C* INGEN søkevei valgt -> DATO...
     C                   MOVE      '1'           *IN52
      *
     C     SLTSØK        TAG
      *
      * HVIS DATOBEGRENSNING - LEGG I ÅRHUNDRE
      * FRA-DATO
     C     SEDATF        IFNE      *ZERO
     C     SEFÅÅ         IFGT      50
     C                   MOVE      19            SEFHH
     C                   ELSE
     C                   MOVE      20            SEFHH
     C                   ENDIF                                                  <SEFÅÅ
     C                   ELSE
     C                   MOVE      *ZEROS        SEFHH
     C                   ENDIF                                                  <SEDATF
      *
      * TIL-DATO
     C     SEDATT        IFNE      *ZERO
     C     SETÅÅ         IFGT      50
     C                   MOVE      19            SETHH
     C                   ELSE
     C                   MOVE      20            SETHH
     C                   ENDIF                                                  <SETÅÅ
     C                   ELSE
     C                   MOVE      *ZEROS        SETHH
     C                   ENDIF                                                  <SEDATT
      *
      * KLARGJØR MAX-FELT VED BEGRENSNINGER
      * ART.NR  UTFYLT
     C     SEARTN        IFNE      *BLANKS
     C                   MOVEL     SEARTN        MXFELT
     C                   Z-ADD     15            XN                2 0
     C     MX(XN)        DOWEQ     ' '
     C                   MOVE      '9'           MX(XN)
     C                   SUB       1             XN
     C                   END
     C                   MOVEL     MXFELT        MXARTN
     C                   ENDIF                                                  <SEARTN
N01   * LE.VART.NR  UTFYLT
N01  C     SEARTL        IFNE      *BLANKS
N01  C                   MOVEL     SEARTL        MXFELT
N01  C                   Z-ADD     15            XN                2 0
N01  C     MX(XN)        DOWEQ     ' '
N01  C                   MOVE      '9'           MX(XN)
N01  C                   SUB       1             XN
N01  C                   END
N01  C                   MOVEL     MXFELT        MXARTL
N01  C                   ENDIF                                                  <SEARTL
      * LAGERLOK. UTFYLT
     C     SELLOK        IFNE      *BLANKS
     C                   MOVEL     SELLOK        MXFELT
     C                   Z-ADD     25            XN                2 0
     C     MX(XN)        DOWEQ     ' '
     C                   MOVE      '9'           MX(XN)
     C                   SUB       1             XN
     C                   END
     C                   MOVEL     MXFELT        MXLLOK
     C                   ENDIF                                                  <SELLOK
      * BATCHNR UTFYLT
     C     SESENR        IFNE      *BLANKS
     C                   MOVEL     SESENR        MXFELT
     C                   Z-ADD     25            XN                2 0
     C     MX(XN)        DOWEQ     ' '
     C                   MOVE      '9'           MX(XN)
     C                   SUB       1             XN
     C                   END
     C                   MOVEL     MXFELT        MXSENR
     C                   ENDIF                                                  <SESENR
      * DFT MODUS ER 1 - ARTNR...
     C     *IN55         IFEQ      '1'
     C                   Z-ADD     3             MODUS
     C                   MOVEA     '11'          *IN(42)
     C                   ELSE
     C                   Z-ADD     1             MODUS             1 0
     C                   MOVEA     '00'          *IN(42)
     C                   END
     C* GRUPPE/KJEDE ER FAST..
     C                   MOVE      SEGRUP        VAGRUP
     C                   MOVE      SEKJED        VAKJED
     C                   MOVE      NVNGRU        XXNGRU           30
     C                   MOVE      NVNKJE        XXNKJE           30
     C                   ENDSR
      ***********************************************
     C     ENDRE         BEGSR
      ***********************************************
     C                   MOVE      'CHG'         XTYPE             3
     C                   MOVE      *BLANKS       LC
     C                   MOVE      *BLANKS       PL
      * Endr. ikke tillatt dersom mottaksrapp.(annet enn prøve) skrevet
     C                   MOVE      ' '           PRTMRA            1
     C     VAMRNR        IFNE      *ZEROS
     C     MRKEY         CHAIN     LLMRF                              88
     C  N88              MOVE      MRST          PRTMRA
     C                   END
      *
     C     *IN27         IFEQ      '0'                                          1<-B
     C     VAOANT        ANDEQ     VASALD
     C     PRTMRA        ANDEQ     ' '
     C                   MOVE      *OFF          *IN41                           IKKE PROTEC
     C                   MOVE      *OFF          *IN46                           .. ALLE
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C     *IN88         IFEQ      *OFF                                          2<-B
      * MANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVVAW"
     C                   EXSR      MOVVAW
     C                   ENDIF                                                   2<-E
     C                   MOVE      VAST2         WRST2
     C     VAST2         COMP      ' '                                2929
     C                   IF        *IN29
     C     KUFASTK       CHAIN     KUFAST                             33
     C                   IF        *IN39
     C                   MOVE      *BLANKS       WRST2N
     C                   ELSE
     C                   MOVEL     KFTXT         WRST2N
     C                   END
     C                   END
     C                   Z-ADD     05            LINNBR
     C                   Z-ADD     20            POSNBR
     C     END01         TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '000000'      *IN(30)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     *IN04         IFEQ      '1'                                           2<-B
     C                   EXSR      SØKV
     C                   GOTO      END01
     C                   END                                                     2<-E
      *
     C     *IN02         IFEQ      '1'                                           2<-B
     C                   CALL      'LL030C'
     C                   GOTO      END01
     C                   END                                                     2<-E
      *
     C     *IN07         IFEQ      '1'                                           2<-B
     C     LLVARK        CHAIN(N)  LLVARE01                           33
     C     *IN33         IFEQ      '0'                                            3<-B
     C                   EXSR      MOVFH
     C                   MOVE      '0'           *IN39
     C                   END                                                      3<-E
     C                   GOTO      END01
     C                   END                                                     2<-E
     C                   SETOFF                                       9998
      *
     C   03              MOVE      '1'           *INLR
     C   03              RETURN
     C   12              GOTO      END99
      *
     C                   EXSR      TSTB20
     C   30              GOTO      END01
      * UFLAG2 = 1  -->  BRUKER HAR IKKE GITT LAGERPOS. TIL ALLE PALLER
     C     UFLAG2        CABEQ     1             END01
     C     WRMRNR        IFEQ      0
     C                   EXSR      HMRNR
     C     WRMRNR        CABEQ     0             END01
     C                   END
      * Oppdaterer posten
      *
     C     KEY1          CHAIN     LLAGJL01                           88
     C     *IN88         IFEQ      '0'                                           2<-B
N07  c                   move      VAANR         GMANR
      * MANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVWVA"
     C                   EXSR      MOVWVA
     C                   UPDATE    LLAGJR
N04  C     KEY1          CHAIN     LLAGJFEU                           89
N04  C                   MOVE      WROPLK        VAOPLK
N04  C                   MOVE      WRFVUE        VAFVUE
N04  C                   MOVE      WRFRUE        VAFRUE
N04  C                   MOVE      WRFVIE        VAFVIE
N04  C                   MOVE      WRFRIE        VAFRIE
N04  C   89              WRITE     LLAGJEUR
N04  C  N89              UPDATE    LLAGJEUR
N07  c                   if        VAANR <> GMANR
N07  c     VAMN          setll     LLSERL03
N07  c     VAMN          reade     LLSERL03                               33
N07  c     *IN33         DOWEQ     '0'
N07  c                   eval      SNANR = VAANR
N07  c                   update    LLSERR
N07  c     VAMN          reade     LLSERL03                               33
N07  c                   enddo
N07  c                   endif
     C     XALARM        IFEQ      'J'                                            3<-B
     C                   EXFMT     ALARM2
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E
     C                   MOVE      '1'           *IN51
      *
     C     END99         TAG
     C                   MOVE      *OFF          *IN62
      *
     C                   ELSE                                                   1
     C   27              MOVE      'JOV0823'     MSGNR
     C  N27              MOVE      'JOV0826'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   END                                                    1<-E
     C                   MOVE      *BLANK        WSNR
     C                   SELECT                                                 1<-B
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL                                                  1<-E
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   MOVE      '0'           *IN51
      * LAGE NYE LINJER PGA. PALL-LAGER
     C  N12LC(1)         IFNE      *BLANKS
     C                   EXSR      NYPOS
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     ENDRE2        BEGSR
      ***********************************************
     C                   MOVE      'CH2'         XTYPE             3
     C     *IN27         IFEQ      '0'                                          1<-B
     C                   MOVE      *ON           *IN45                           IKKE DELETE
     C                   MOVE      *ON           *IN41                           IKKE PROTEC
     C                   MOVE      *ON           *IN46                           IKKE ALLE
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C     *IN88         IFEQ      *OFF                                          2<-B
      * MANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVVAW"
     C                   EXSR      MOVVAW
     C                   ENDIF                                                   2<-E
     C                   MOVE      VAST2         WRST2
     C     VAST2         COMP      ' '                                2929
     C                   IF        *IN29
     C     KUFASTK       CHAIN     KUFAST                             33
     C                   IF        *IN39
     C                   MOVE      *BLANKS       WRST2N
     C                   ELSE
     C                   MOVEL     KFTXT         WRST2N
     C                   END
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C     END201        TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '000000'      *IN(30)
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     *IN04         IFEQ      '1'
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   EXSR      SØKV
     C                   GOTO      END201
     C                   END
      *
     C     *IN02         IFEQ      '1'                                           2<-B
     C                   CALL      'LL030C'
     C                   GOTO      END201
     C                   END                                                     2<-E
      *
     C     *IN07         IFEQ      '1'                                           2<-B
     C     LLVARK        CHAIN(N)  LLVARE01                           33
     C     *IN33         IFEQ      '0'                                            3<-E
     C                   EXSR      MOVFH
     C                   MOVE      '0'           *IN39
     C                   END                                                      3<-E
     C                   GOTO      END201
     C                   END                                                     2<-E
     C                   SETOFF                                       9998
      *
     C   03              MOVE      '1'           *INLR
     C   03              RETURN
     C   12              GOTO      END299
      *
     C                   EXSR      TSTB20
     C   30              GOTO      END201
      * Oppdaterer posten
      *
     C     KEY1          CHAIN     LLAGJL01                           88
     C     *IN88         IFEQ      '0'                                           2<-B
      * MANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVWVA"
     C                   EXSR      MOVWVA
     C                   UPDATE    LLAGJR
N04  C     KEY1          CHAIN     LLAGJFEU                           89
N04  C                   MOVE      WROPLK        VAOPLK
N04  C                   MOVE      WRFVUE        VAFVUE
N04  C                   MOVE      WRFRUE        VAFRUE
N04  C                   MOVE      WRFVIE        VAFVIE
N04  C                   MOVE      WRFRIE        VAFRIE
N04  C   89              WRITE     LLAGJEUR
N04  C  N89              UPDATE    LLAGJEUR
     C     XALARM        IFEQ      'J'                                            3<-B
     C                   EXFMT     ALARM2
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E
      *
     C     END299        TAG
     C                   MOVE      *OFF          *IN62
      *
     C                   ELSE                                                   1
     C                   MOVE      'JOV0823'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   END                                                    1<-E
     C                   MOVE      *BLANK        WSNR
     C                   SELECT                                                 1<-B
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL                                                  1<-E
     C                   MOVE      '1'           *IN51
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   MOVE      '0'           *IN51
      * LAGE NYE LINJER PGA. PALL-LAGER
     C  N12LC(1)         IFNE      *BLANKS
     C                   EXSR      NYPOS
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     ENDRE3        BEGSR
      ***********************************************
     C     KUFASTK       CHAIN     KUFAST                             33
     C                   MOVE      VAST2         WGST2
     C  N33              MOVEL     KFTXT         WGST2N
     C   33              MOVE      *BLANKS       WGST2N
     C                   MOVE      *BLANKS       WNST2
     C                   MOVE      *BLANKS       WNST2N
      *
     C     END301        TAG
     C                   EXFMT     CHGST2
     C                   MOVE      '0'           *IN(90)
      *
     C                   IF        *IN12
     C     KEY1          CHAIN(N)  LLAGJL01                           33
     C                   GOTO      END302
     C                   END
     C                   IF        *IN04
     C                   MOVE      ' '           UUPDAT            1
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    WNST2
     C                   IF        WNST2 <> *BLANKS
     C                   MOVE      WNST2         VAST2
     C     KUFASTK       CHAIN     KUFAST                             90
     C  N90              MOVEL     KFTXT         WNST2N
     C   90              MOVE      'YBC1920'     MSGNR
     C   90              MOVE      *BLANKS       WNST2N
     C                   END
     C                   GOTO      END301
     C                   END
      *
     C     WNST2         CABEQ     *BLANKS       END301
     C                   MOVE      WNST2         VAST2
     C     KUFASTK       CHAIN     KUFAST                             90
     C   90              MOVE      'YBC1920'     MSGNR
     C   90              GOTO      END301
     C                   IF        WNST2 <> WGST2
     C     KEY1          CHAIN     LLAGJL01                           33
     C                   WRITE     LAGFLOGR
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTD               6
     C                   MOVE      WNST2         VAST2
     C                   MOVE      ZUSER         VABUSE
     C                   MOVE      WDT           VABDAT
     C                   MOVE      WTM           VABKL
     C                   UPDATE    LLAGJR
     C                   END
      *
     C     END302        TAG
     C                   MOVE      *BLANK        WSNR
     C                   SELECT                                                 1<-B
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL                                                  1<-E
     C                   MOVE      '1'           *IN51
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   MOVE      '0'           *IN51
      *
     C                   ENDSR
n05   ***********************************************
n05  C     SRMRAP        BEGSR
n05   ***********************************************
n05   *
n05  c     VAMRNR        ifne      *zeros
n05  C                   CALL      'LL023R'
n05  C                   PARM      SEGRUP        URGRUP            8 0
n05  C                   PARM      SEKJED        URKJED            8 0
n05  C                   PARM                    NVNKJE
n05  C                   PARM      VAMRNR        URMRNR
n05  C                   PARM      'M'           USPØR
n05  c                   endif
n05  C                   MOVE      *BLANK        WSNR
n05  C                   UPDATE    SUBFIL
n05  C                   ENDSR
n05   *
      ***********************************************
     C     LAGNY         BEGSR
      ***********************************************
     C                   MOVE      'CRT'         XTYPE             3
     C                   MOVE      '0'           *IN39
     C     MRKEY         CHAIN     LLMRF                              88
     C     MRST          IFEQ      *BLANKS
     C     *IN88         ANDEQ     '0'
     C                   MOVE      WRMRNR        VAMRNR
     C                   MOVE      WRLLOK        VALLOK
     C                   MOVE      WRVERD        VAVERD
     C                   MOVE      WRLLT         VALLT
     C                   MOVE      WRDATO        VADATO
     C                   MOVE      WRAVD         VAAVD
     C                   MOVE      WROPD         VAOPD
     C                   ELSE
     C                   MOVE      *ZEROS        VAMRNR
     C                   MOVE      *BLANKS       VALLOK
     C                   MOVE      *ZEROS        VAVERD
     C                   MOVE      *BLANKS       VALLT
     C                   MOVE      *ZEROS        VADATO
     C                   MOVE      *ZEROS        VAAVD
     C                   MOVE      *ZEROS        VAOPD
     C                   END
     C                   MOVE      *BLANKS       LC
     C                   MOVE      *BLANKS       PL
     C                   MOVE      *ON           *IN88                            =NY
     C                   MOVE      *OFF          *IN46                           .. ALLE
     C                   CLEAR                   VARELI
     C                   MOVE      VAGRUP        WRGRUP
     C                   MOVE      VAKJED        WRKJED
     C                   MOVE      XXNGRU        NVNGRU
     C                   MOVE      XXNKJE        NVNKJE
     C                   MOVE      VAMRNR        WRMRNR
     C                   MOVEL     VALLOK        WRLOK1
     C     VADATO        IFEQ      0
     C                   MOVE      99999999      WRDATO
     C                   ELSE
     C                   MOVE      VADATO        WRDATO
     C                   END
     C                   MOVE      VAAVD         WRAVD
     C                   MOVE      VAOPD         WROPD
     C                   MOVE      VAFBNR        WRFBNR
     C                   MOVE      *OFF          *IN29
      *
     C                   MOVE      *OFF          *IN41
     C                   Z-ADD     05            LINNBR
     C                   Z-ADD     20            POSNBR
     C     WRMRNR        IFEQ      0
     C                   MOVE      '1'           *IN04
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      LAG02
     C                   END
     C     LAG01         TAG
     C                   EXFMT     VARELI
     C                   MOVE      *OFF          *IN30
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C                   MOVEA     '000000'      *IN(30)
     C*
     C     LAG02         TAG
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKV
     C  N30UFLAG2        IFEQ      0
     C                   EXSR      MOVFH
     C                   END
     C                   GOTO      LAG01
     C                   END
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030C'
     C                   GOTO      LAG01
     C                   END
     C                   SETOFF                                       9998
      *
     C   03              MOVE      '1'           *INLR
     C   03              RETURN
     C   12              GOTO      LAG99
     C     WRMRNR        IFEQ      0
     C     WRANRL        ANDNE     *BLANKS
     C                   EXSR      HMRNR
     C     WRMRNR        CABEQ     0             LAG01
     C                   END
     C                   EXSR      TSTB20
     C   30              GOTO      LAG01
      * UFLAG2 = 1  -->  BRUKER HAR IKKE GITT LAGERPOS. TIL ALLE PALLER
     C     UFLAG2        CABEQ     1             LAG01
      *
      * TEST OM VARE ER INNLAGT FØR
     C     LAG99K        CHAIN     LLAGJL99                           33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'J'           WSSVAR
     C                   EXFMT     ALARM
     C     WSSVAR        IFEQ      'N'
     C                   Z-ADD     17            LINNBR
     C                   GOTO      LAG01
     C                   END
     C                   END
      * HVIS MOTTAKSRAPPORTNR = 0, HENT NUMMER.
     C     WRMRNR        IFEQ      0
     C                   EXSR      HMRNR
     C     WRMRNR        CABEQ     0             LAG01
     C                   EXSR      TSTB20
     C   30              GOTO      LAG01
     C                   END
      * HENT NESTE NR
     C                   CLEAR                   LLAGJR
     C                   MOVE      SEGRUP        VAGRUP
     C                   MOVE      SEKJED        VAKJED
     C     3             CHAIN     LLTELL                             33
     C                   IF        *IN33
     C     1             CHAIN(N)  LLTELL                             33
     C                   IF        *IN33
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   END
     C     2             CHAIN(N)  LLTELL                             33
     C                   IF        *IN33
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   END
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   ELSE
     C                   ADD       1             LLREC1
     C                   UPDATE    LLTELLR
     C                   END
     C                   MOVE      LLREC1        VAMN
      * Skriver posten
     C                   MOVE      ' '           VASTAT
      * M,ANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVWVA"
     C                   EXSR      MOVWVA
     C                   WRITE     LLAGJR
N04  C     KEY1          CHAIN     LLAGJFEU                           89
N04  C                   MOVE      WROPLK        VAOPLK
N04  C                   MOVE      WRFVUE        VAFVUE
N04  C                   MOVE      WRFRUE        VAFRUE
N04  C                   MOVE      WRFVIE        VAFVIE
N04  C                   MOVE      WRFRIE        VAFRIE
N04  C   89              WRITE     LLAGJEUR
     C     LVSN          IFEQ      'I'
     C                   CALL      'LL018R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAANR
     C                   PARM                    VALLOK
     C                   PARM                    VAMN
     C                   PARM                    VAOANT
     C                   END
      *
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      '1'           *IN51
     C                   WRITE     SUBFIL
     C                   MOVE      '0'           *IN51
      * LAGE NYE LINJER PGA. PALL-LAGER
     C     LC(1)         IFNE      *BLANKS
     C                   EXSR      NYPOS
     C                   END
      *
     C     LAG99         TAG
     C                   ENDSR
      *
      ***********************************************
     C     SLETTE        BEGSR
      ***********************************************
     C                   MOVE      'DLT'         XTYPE             3
     C                   MOVE      '0'           *IN39
      * Slett ikke tillatt dersom mottaksrapp.(annet enn prøve) skrevet
     C                   MOVE      ' '           PRTMRA            1
     C     VAMRNR        IFNE      *ZEROS
     C     MRKEY         CHAIN     LLMRF                              88
     C  N88              MOVE      MRST          PRTMRA
     C                   END
     C     *IN27         IFEQ      '0'                                          1<-B
     C     VAOANT        ANDEQ     VASALD
     C     PRTMRA        ANDEQ     ' '
     C                   MOVE      *ON           *IN44
     C                   MOVE      *ON           *IN41
     C                   MOVE      *ON           *IN61
     C     SLET1         TAG
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C     *IN88         IFEQ      *OFF                                          2<-B
      * MANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVVAW"
     C                   EXSR      MOVVAW
     C                   ENDIF                                                   2<-E
     C                   MOVE      VAST2         WRST2
     C     VAST2         COMP      ' '                                2929
     C                   IF        *IN29
     C     KUFASTK       CHAIN     KUFAST                             33
     C                   IF        *IN39
     C                   MOVE      *BLANKS       WRST2N
     C                   ELSE
     C                   MOVEL     KFTXT         WRST2N
     C                   END
     C                   END
     C                   Z-ADD     05            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   EXFMT     VARELI
     C                   MOVEA     '000000'      *IN(30)
     C   03              MOVE      '1'           *INLR
     C   03              RETURN
     C   12              GOTO      SLET99
      *
      * Oppdaterer posten
      *
     C     KEY1          CHAIN     LLAGJL01                           88
     C     *IN88         IFEQ      '0'                                           2<-B
     C     VAMN          SETLL     LLSERL03
     C     VAMN          READE     LLSERL03                               33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    LLSERR
     C     VAMN          READE     LLSERL03                               33
     C  N33              ENDDO
     C                   DELETE    LLAGJR
N04  C     KEY1          CHAIN     LLAGJFEU                           89
N04  C  N89              DELETE    LLAGJEUR
     C     VADATO        IFNE      99999999
     C     LLVARK        CHAIN     LLVARE01                           33
     C                   SUB       VASALD        LVSALD
     C                   UPDATE    LLVARER
     C                   END
     C                   CLEAR                   LLAGJR
     C                   MOVE      SEGRUP        VAGRUP
     C                   MOVE      SEKJED        VAKJED
     C                   MOVE      *BLANKS       XXVARE
     C                   MOVEL     '*SLETT'      XXVARE
     C                   ENDIF                                                   2<-E
      *
     C     SLET99        TAG
     C                   MOVE      *OFF          *IN61
      *
     C                   ELSE                                                   1
     C   27              MOVE      'JOV0823'     MSGNR
     C  N27              MOVE      'YBC1735'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   END                                                    1<-E
     C                   MOVE      *BLANK        WSNR
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISE          BEGSR
      ***********************************************
     C                   MOVE      'DSP'         XTYPE             3
     C                   MOVE      '0'           *IN39
     C                   MOVE      *BLANK        WSNR
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
      *
     C                   SETOFF                                       9998
      *
     C                   MOVE      *ON           *IN45
     C                   MOVE      *ON           *IN41
      *
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C     *IN88         IFEQ      *OFF
      * MANGE LINJER ER FLYTTET TIL SUBRUTINE "MOVVAW"
     C                   EXSR      MOVVAW
     C                   ENDIF                                                  <*IN88
     C                   MOVE      VAST2         WRST2
     C     VAST2         COMP      ' '                                2929
     C                   IF        *IN29
     C     KUFASTK       CHAIN     KUFAST                             33
     C                   IF        *IN39
     C                   MOVE      *BLANKS       WRST2N
     C                   ELSE
     C                   MOVEL     KFTXT         WRST2N
     C                   END
     C                   END
     C                   Z-ADD     05            LINNBR
     C                   Z-ADD     20            POSNBR
     C     STVIS         TAG
     C                   EXFMT     VARELI
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030C'
     C                   GOTO      STVIS
     C                   END
     C                   SETOFF                                       9998
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISE2         BEGSR
      ***********************************************
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C                   MOVE      'N'           UFLAGG
     C                   CALL      'LL021R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAMN
     C                   PARM                    UFLAGG
      *
     C     UFLAGG        IFEQ      '3'
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   END
     C                   MOVE      *BLANK        WSNR
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     AKTIV         BEGSR
      ***********************************************
     C     VADATO        IFEQ      99999999
     C     KEY1          CHAIN     LLAGJL01                           88
     C     MRKEY         CHAIN     LLMRF                              88
     C                   IF        MRGN = '*GN*'
     C                   MOVE      'N'           XAKTIV            1
     C                   MOVE      'YBC1917'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   ELSE
      *
     C     XXGN          COMP      ' '                                    88
     C     *IN88         IFEQ      '0'
     C                   MOVE      'N'           XAKTIV            1
     C     VAMN          SETLL     LLLISF
     C     VAMN          READE     LLLISF                                 88
     C     *IN88         DOWEQ     '0'
     C     LIKD          IFEQ      'FAK'
     C     LITXT         ANDNE     *BLANKS
     C                   MOVE      'J'           XAKTIV
     C                   LEAVE
     C                   END
     C     VAMN          READE     LLLISF                                 88
     C  N88              ENDDO
     C                   ELSE
     C                   MOVE      'J'           XAKTIV
     C                   END
      *
     C                   IF        XAKTIV = 'J'
     C     LLVA2K        CHAIN(N)  LLVARE01                           33
     C                   IF        LVSN   = 'I'
     C                   MOVE      *ZEROS        XANTSN            7 0
     C     VAMN          SETLL     LLSERL03
     C     VAMN          READE(N)  LLSERL03                               33
     C                   DOW       *IN33 = *OFF
     C                   IF        SNST = ' '
     C                   MOVE      'N'           XAKTIV
     C                   MOVE      'YBC1922'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   END
     C                   ADD       1             XANTSN
     C     VAMN          READE(N)  LLSERL03                               33
     C                   ENDDO
     C                   IF        XANTSN <> VASALD
     C                   MOVE      'N'           XAKTIV
     C                   MOVE      'YBC1918'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   END
     C                   END
     C                   ELSE
     C                   MOVE      'YBC1919'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   END
      *
     C                   END
      *
     C     XAKTIV        IFEQ      'J'
     C                   MOVE      MRDT          VADATO
     C     LLVA2K        CHAIN     LLVARE01                           88
     C                   ADD       VASALD        LVSALD
     C                   UPDATE    LLVARER
     C                   END
     C                   UPDATE    LLAGJR
     C                   END
     C                   MOVE      ' '           WSNR
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
N06   ***********************************************
N06  C     VISDET        BEGSR
N06   ***********************************************
N06  C                   MOVE      ' '           WSNR
N06  C     VAST2         COMP      ' '                                4848
N06  C   48VAST2         COMP      'A'                                4848
N06  C                   UPDATE    SUBFIL
N06  C                   Z-ADD     1             UFLAG2            1 0
N06  C                   CALL      'LL082R'
N06  C                   PARM                    VAGRUP
N06  C                   PARM                    VAKJED
N06  C                   PARM                    VAMN
N06  C                   PARM                    UFLAGG
N06   *
N06  C                   ENDSR
N06   *
      ***********************************************
     C     VISART        BEGSR
      ***********************************************
     C                   MOVE      ' '           WSNR
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   Z-ADD     1             UFLAG2            1 0
     C                   CALL      'LL002R'
     C                   PARM      VAGRUP        UGRP              8 0
     C                   PARM      VAKJED        UPNR              8 0
     C                   PARM                    VAANR
     C                   PARM                    UANRL            15
     C                   PARM                    UTXT             40
     C                   PARM                    UFLAG2
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKSER        BEGSR
      ***********************************************
     C     VAOANT        IFGT      900000
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0875'     MSGNR
     C                   ELSE
     C                   MOVE      ' '           WSNR
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   CALL      'LL018R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAANR
     C                   PARM                    VALLOK
     C                   PARM                    VAMN
     C                   PARM                    VAOANT
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKLIS        BEGSR
      ***********************************************
     C     VAOANT        IFGT      900000
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0875'     MSGNR
     C                   ELSE
     C                   MOVE      ' '           WSNR
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   CALL      'LL074R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAMN
     C                   PARM                    VAMRNR
     C                   PARM                    VAANR
     C                   PARM                    VAVARE
     C                   PARM      VASALD        USALD             7 0
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SPLITT        BEGSR
      ***********************************************
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C                   IF        (((VAOANT <> 0) AND
     C                               (VAOANT = VASALD)) AND
     C                               (VADATO = 99999999))
     C                   CALL      'LL067R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAMN
     C                   PARM                    VAOANT
     C                   PARM                    VALLOK
     C                   PARM                    UFLAGG            1
      *
     C                   IF        UFLAGG = '1'
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVFH         BEGSR
      ***********************************************
     C                   MOVE      LVVKT0        WRVKT0
     C                   MOVE      LVKUB0        WRKUB0
     C                   MOVE      LVVKF0        WRVKF0
     C                   MOVE      LVKUF0        WRKUF0
     C                   MOVE      LVVKT1        WRVKT1
     C                   MOVE      LVKUB1        WRKUB1
     C                   MOVE      LVVKF1        WRVKF1
     C                   MOVE      LVKUF1        WRKUF1
     C                   MOVE      LVAN01        WRAN01
     C                   MOVE      LVVKT2        WRVKT2
     C                   MOVE      LVKUB2        WRKUB2
     C                   MOVE      LVVKF2        WRVKF2
     C                   MOVE      LVKUF2        WRKUF2
     C                   MOVE      LVAN02        WRAN02
     C                   MOVE      LVAN12        WRAN12
     C                   MOVE      LVVKT3        WRVKT3
     C                   MOVE      LVKUB3        WRKUB3
     C                   MOVE      LVVKF3        WRVKF3
     C                   MOVE      LVKUF3        WRKUF3
     C                   MOVE      LVAN03        WRAN03
     C                   MOVE      LVAN23        WRAN23
     C                   MOVE      LVMIN         WRMIN
     C     *IN04         IFEQ      '0'
     C                   Z-ADD     35            POSNBR
     C                   SELECT
     C     WRSAE0        WHENGT    0
     C                   Z-ADD     10            LINNBR
     C     WRSAE1        WHENGT    0
     C                   Z-ADD     11            LINNBR
     C     WRSAE2        WHENGT    0
     C                   Z-ADD     12            LINNBR
     C                   OTHER
     C                   Z-ADD     13            LINNBR
     C                   ENDSL
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVVAW        BEGSR
      ***********************************************
     C                   MOVE      VAMRNR        WRMRNR
     C                   MOVE      VAGRUP        WRGRUP
     C                   MOVE      VAKJED        WRKJED
N04  C                   clear                   WROPLK
N04  C                   clear                   WRFVUE
N04  C                   clear                   WRFRUE
N04  C                   clear                   WRFVIE
N04  C                   clear                   WRFRIE
N04  C     KEY1          CHAIN(N)  LLAGJFEU                           89
N04  C     *in89         ifeq      *off
N04  C                   MOVE      VAOPLK        WROPLK
N04  C                   MOVE      VAFVUE        WRFVUE
N04  C                   MOVE      VAFRUE        WRFRUE
N04  C                   MOVE      VAFVIE        WRFVIE
N04  C                   MOVE      VAFRIE        WRFRIE
N04  C                   endif
     C                   MOVE      *BLANKS       WRGN
     C                   MOVE      *BLANKS       WRTRNR
N03  C                   MOVE      *BLANKS       WRMOTT
s02  C*    LLMRFL01K     CHAIN     LLMRFL01                           90
n02  C     LLMRFL01K     CHAIN     LLMRF                              90
     C  N90              MOVE      MRGN          WRGN
     C  N90              MOVE      MRTRNR        WRTRNR
N03  C  N90              MOVE      MRMOTT        WRMOTT
     C                   MOVE      VAHK          WRHK
     C                   MOVE      VAANR         WRANR
     C                   MOVE      VAANRL        WRANRL
     C                   MOVEL     VAFAR         WRVAL
     C                   MOVE      VAVARE        WRVARE
     C                   MOVE      VALLOK        WRLLOK
     C                   MOVE      VAVERD        WRVERD
     C                   MOVE      VALLT         WRLLT
     C                   MOVE      VAOANT        WROANT
     C                   MOVE      VADATO        WRDATO
     C                   MOVE      VADTV         WRDTV
     C                   MOVE      VAULDT        WRULDT
     C                   MOVE      VAPRDT        WRPRDT
     C                   MOVE      VASPRI        WRSPRI
     C                   MOVE      VAANKT        WRANKT
     C                   MOVE      VAVKTS        WRVKTS
     C                   MOVE      VAKUBS        WRKUBS
     C                   MOVE      VAVKT0        WRVKT0
     C                   MOVE      VAKUB0        WRKUB0
     C                   MOVE      VAVKF0        WRVKF0
     C                   MOVE      VAKUF0        WRKUF0
     C                   MOVE      VAVKT1        WRVKT1
     C                   MOVE      VAKUB1        WRKUB1
     C                   MOVE      VAVKF1        WRVKF1
     C                   MOVE      VAKUF1        WRKUF1
     C                   MOVE      VAAN01        WRAN01
     C                   MOVE      VAVKT2        WRVKT2
     C                   MOVE      VAKUB2        WRKUB2
     C                   MOVE      VAVKF2        WRVKF2
     C                   MOVE      VAKUF2        WRKUF2
     C                   MOVE      VAAN02        WRAN02
     C                   MOVE      VAAN12        WRAN12
     C                   MOVE      VAVKT3        WRVKT3
     C                   MOVE      VAVKF3        WRVKF3
     C                   MOVE      VAKUF3        WRKUF3
     C                   MOVE      VAKUB3        WRKUB3
     C                   MOVE      VAAN03        WRAN03
     C                   MOVE      VAAN23        WRAN23
     C                   MOVE      VAMIN         WRMIN
     C     LLVARK        CHAIN(N)  LLVARE01                           39
     C     LVVKT0        IFNE      WRVKT0
     C     LVKUB0        ORNE      WRKUB0
     C     LVVKF0        ORNE      WRVKF0
     C     LVKUF0        ORNE      WRKUF0
     C     LVVKT1        ORNE      WRVKT1
     C     LVKUB1        ORNE      WRKUB1
     C     LVVKF1        ORNE      WRVKF1
     C     LVKUF1        ORNE      WRKUF1
     C     LVAN01        ORNE      WRAN01
     C     LVVKT2        ORNE      WRVKT2
     C     LVKUB2        ORNE      WRKUB2
     C     LVVKF2        ORNE      WRVKF2
     C     LVKUF2        ORNE      WRKUF2
     C     LVAN02        ORNE      WRAN02
     C     LVAN12        ORNE      WRAN12
     C     LVVKT3        ORNE      WRVKT3
     C     LVKUB3        ORNE      WRKUB3
     C     LVVKF3        ORNE      WRVKF3
     C     LVKUF3        ORNE      WRKUF3
     C     LVAN03        ORNE      WRAN03
     C     LVAN23        ORNE      WRAN23
     C     LVMIN         ORNE      WRMIN
     C                   MOVE      '1'           *IN39
     C                   ELSE
     C                   MOVE      '0'           *IN39
     C                   END
     C                   MOVE      VASAE0        WRSAE0
     C                   MOVE      VASAE1        WRSAE1
     C                   MOVE      VASAE2        WRSAE2
     C                   MOVE      VASAE3        WRSAE3
     C                   MOVE      VASENR        WRSENR
     C                   MOVE      VAPLID        WRPLID
     C                   MOVE      VAAVD         WRAVD
     C                   MOVE      VAOPD         WROPD
     C                   MOVE      VAFBNR        WRFBNR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWVA        BEGSR
      ***********************************************
     C                   MOVE      WRMRNR        VAMRNR
     C                   MOVE      'N'           XALARM            1
      *
     C     XTYPE         IFEQ      'CHG'
     C     XTYPE         OREQ      'CH2'
     C     WRVKT0        IFNE      VAVKT0
     C     WRKUB0        ORNE      VAKUB0
     C     WRVKF0        ORNE      VAVKF0
     C     WRKUF0        ORNE      VAKUF0
     C     WRVKT1        ORNE      VAVKT1
     C     WRKUB1        ORNE      VAKUB1
     C     WRVKF1        ORNE      VAVKF1
     C     WRKUF1        ORNE      VAKUF1
     C     WRVKT2        ORNE      VAVKT2
     C     WRKUB2        ORNE      VAKUB2
     C     WRVKF2        ORNE      VAVKF2
     C     WRKUF2        ORNE      VAKUF2
     C     WRVKT3        ORNE      VAVKT3
     C     WRKUB3        ORNE      VAKUB3
     C     WRVKF3        ORNE      VAVKF3
     C     WRKUF3        ORNE      VAKUF3
     C     WRAN01        ORNE      VAAN01
     C     WRAN02        ORNE      VAAN02
     C     WRAN12        ORNE      VAAN12
     C     WRAN03        ORNE      VAAN03
     C     WRAN23        ORNE      VAAN23
     C     WRMIN         ORNE      VAMIN
     C                   CALL      'LL029R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAMN
     C                   PARM                    WRVKT0
     C                   PARM                    WRKUB0
     C                   PARM                    WRVKT1
     C                   PARM                    WRKUB1
     C                   PARM                    WRVKT2
     C                   PARM                    WRKUB2
     C                   PARM                    WRVKT3
     C                   PARM                    WRKUB3
     C     WRAN01        PARM      WRAN01        URAN01            5 0
     C                   PARM                    WRAN02
     C                   PARM                    WRAN12
     C                   PARM                    WRAN03
     C                   PARM                    WRAN23
     C                   PARM                    WRMIN
     C                   PARM                    UFLAG2
     C     UFLAG2        IFEQ      1
     C                   MOVE      'J'           XALARM            1
     C                   ELSE
     C                   WRITE     LAGFLOGR
     C                   END
     C                   ELSE
     C     WRANR         IFNE      VAANR
     C     WRANRL        ORNE      VAANRL
     C     WRVARE        ORNE      VAVARE
     C     WRVAL         ORNE      VAFAR
     C     WRLLOK        ORNE      VALLOK
     C     WRLLT         ORNE      VALLT
     C     WROANT        ORNE      VAOANT
     C     WRSAE0        ORNE      VASAE0
     C     WRSAE1        ORNE      VASAE1
     C     WRSAE2        ORNE      VASAE2
     C     WRSAE3        ORNE      VASAE3
     C     WRVERD        ORNE      VAVERD
     C     WRDATO        ORNE      VADATO
     C     WRULDT        ORNE      VAULDT
     C     WRPRDT        ORNE      VAPRDT
     C     WRANKT        ORNE      VAANKT
     C     WRSPRI        ORNE      VASPRI
     C     WRDTV         ORNE      VADTV
     C     WRSENR        ORNE      VASENR
     C     WRPLID        ORNE      VAPLID
     C     WRAVD         ORNE      VAAVD
     C     WROPD         ORNE      VAOPD
     C     WRFBNR        ORNE      VAFBNR
     C                   WRITE     LAGFLOGR
     C                   END
     C                   END
     C                   END
      *
     C                   MOVE      WRHK          VAHK
      *
      * LOGG AV LOKASJONBYTTING
     C                   IF        ((XTYPE <> 'CRT') AND (VALLOK <> WRLLOK))
     C     LLAGJD01K1    SETLL     LLAGJD01
     C     LLAGJD01K2    READPE    LLAGJD01                               33
     C                   IF        *IN33
     C                   Z-ADD     1             XVDVN             3 0
     C                   ELSE
     C     VDVN          ADD       1             XVDVN
     C                   END
     C                   CLEAR                   LLAGJDR
     C                   MOVE      VAGRUP        VDGRUP
     C                   MOVE      VAKJED        VDKJED
     C                   MOVE      VAMN          VDMN
     C                   MOVE      XVDVN         VDVN
     C                   MOVE      VASALD        VDLANT
     C                   MOVE      VASALD        VDSAE0
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTD               6
     C                   MOVE      WDT           VDLDAT
     C                   EVAL      VDTEXT = VALLOK
     C                   MOVE      ZUSER         VDBUSE
     C                   MOVE      WDT           VDBDAT
     C                   MOVE      WTD           VDBKL
     C                   EVAL      VDLTYP = 'FLYTT'
     C                   WRITE     LLAGJDR
     C                   ADD       1             VDVN
     C                   Z-SUB     VASALD        VDLANT
     C                   Z-SUB     VASALD        VDSAE0
     C                   EVAL      VDTEXT = WRLLOK
     C                   WRITE     LLAGJDR
     C                   END
      *
     C                   MOVE      WRLLOK        VALLOK
     C                   MOVE      WRVERD        VAVERD
     C                   MOVE      WRLLT         VALLT
     C                   MOVE      WROANT        VAOANT
     C     XTYPE         IFEQ      'CHG'
     C     VADATO        ANDNE     99999999
     C     LLVA2K        CHAIN     LLVARE01                           33
     C                   SUB       VASALD        LVSALD
     C                   UPDATE    LLVARER
     C                   END
     C                   MOVE      WRANR         VAANR
     C                   MOVE      WRANRL        VAANRL
     C                   MOVEL     WRVAL         VAFAR
     C                   MOVE      WRVARE        VAVARE
     C     XTYPE         IFNE      'CH2'
     C     WRDATO        IFNE      99999999
     C     LLVARK        CHAIN     LLVARE01                           33
     C                   ADD       WROANT        LVSALD
     C                   UPDATE    LLVARER
     C                   END
     C                   Z-ADD     WROANT        VASALD
     C                   END
     C                   MOVE      WRDATO        VADATO
     C                   MOVE      WRULDT        VAULDT
     C                   MOVE      WRPRDT        VAPRDT
     C                   MOVE      WRSPRI        VASPRI
     C                   MOVE      WRANKT        VAANKT
     C                   MOVE      WRDTV         VADTV
     C                   MOVE      WRVKTS        VAVKTS
     C                   MOVE      WRKUBS        VAKUBS
     C                   MOVE      WRVKT0        VAVKT0
     C                   MOVE      WRKUB0        VAKUB0
     C                   MOVE      WRVKF0        VAVKF0
     C                   MOVE      WRKUF0        VAKUF0
     C                   MOVE      WRVKT1        VAVKT1
     C                   MOVE      WRKUB1        VAKUB1
     C                   MOVE      WRVKF1        VAVKF1
     C                   MOVE      WRKUF1        VAKUF1
     C                   MOVE      WRAN01        VAAN01
     C                   MOVE      WRVKT2        VAVKT2
     C                   MOVE      WRKUB2        VAKUB2
     C                   MOVE      WRVKF2        VAVKF2
     C                   MOVE      WRKUF2        VAKUF2
     C                   MOVE      WRAN02        VAAN02
     C                   MOVE      WRAN12        VAAN12
     C                   MOVE      WRVKT3        VAVKT3
     C                   MOVE      WRKUB3        VAKUB3
     C                   MOVE      WRVKF3        VAVKF3
     C                   MOVE      WRKUF3        VAKUF3
     C                   MOVE      WRAN03        VAAN03
     C                   MOVE      WRAN23        VAAN23
     C                   MOVE      WRMIN         VAMIN
     C                   MOVE      WRSAE0        VASAE0
     C                   MOVE      WRSAE1        VASAE1
     C                   MOVE      WRSAE2        VASAE2
      * VED PALL-LAGER SKAL LIKE MANGE LINJER SOM ANTALL PALLER LAGES.
     C     LC(1)         IFEQ      *BLANKS
     C                   MOVE      WRSAE3        VASAE3
     C                   ELSE
     C     VASAE0        IFGT      0
     C     VASAE1        ORGT      0
     C     VASAE2        ORGT      0
     C                   MOVE      *ZEROS        VASAE3
     C                   ELSE
     C                   Z-ADD     1             VASAE3
     C                   END
      * NY STK = TOTAL STK - (TOTAL PALLER - 1)*(ANTALL STK PR PALL)
     C                   SUB       1             WRSAE3
     C     WRAN03        MULT      WRSAE3        WRSAE3
     C     WROANT        SUB       WRSAE3        VAOANT
     C                   SUB       WRSAE3        VASALD
      * BEREGN TOTAL VEKT OG KUBIKK PÅ NYTT
     C     VASAE0        MULT      VAVKT0        VAVKTS
     C     VASAE1        MULT      VAVKT1        XVKTS             7 2
     C                   ADD       XVKTS         VAVKTS
     C     VASAE2        MULT      VAVKT2        XVKTS
     C                   ADD       XVKTS         VAVKTS
     C     VASAE3        MULT      VAVKT3        XVKTS
     C                   ADD       XVKTS         VAVKTS
     C     VASAE0        MULT      VAKUB0        VAKUBS
     C     VASAE1        MULT      VAKUB1        XKUBS             7 4
     C                   ADD       XKUBS         VAKUBS
     C     VASAE2        MULT      VAKUB2        XKUBS
     C                   ADD       XKUBS         VAKUBS
     C     VASAE3        MULT      VAKUB3        XKUBS
     C                   ADD       XKUBS         VAKUBS
     C                   END
     C                   MOVE      WRSENR        VASENR
     C                   MOVE      WRPLID        VAPLID
     C                   MOVE      WRAVD         VAAVD
     C                   MOVE      WROPD         VAOPD
     C                   MOVE      ZUSER         VABUSE
     C                   TIME                    WTIME
     C                   MOVE      WDD           DTD
     C                   MOVE      WMM           DTM
     C                   MOVE      WÅÅ           DTÅ
     C                   Z-ADD     DATO          VABDAT
     C                   Z-ADD     WTM           VABKL
      *
     C                   ENDSR
      *
      ***********************************************
     C     ARBEID        BEGSR
      ***********************************************
     C     *IN27         IFEQ      '1'
     C                   MOVE      'JOV0823'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   ELSE
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C                   MOVE      'J'           UFLAGG            1
     C                   CALL      'LL021R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAMN
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      '3'
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   END
     C                   END
      *
     C                   MOVE      *BLANK        WSNR
     C     KEY1          CHAIN(N)  LLAGJL01                           88
     C                   SELECT
     C     MODUS         WHENEQ    1
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VALLOK        XXVA19
     C     MODUS         WHENEQ    2
     C                   MOVE      VAVARE        XXVARE
     C     MODUS         WHENEQ    3
     C                   MOVE      *BLANKS       XXVARE
N01  C                   IF        *IN59
N01  C                   MOVEL     VAANRL        XXVARE
N01  C                   ELSE
     C                   MOVEL     VAANR         XXVARE
N01  C                   END
     C                   MOVEL     VASENR        XXVA19
     C                   ENDSL
     C                   MOVE      '1'           *IN51
     C     VAST2         COMP      ' '                                4848
     C   48VAST2         COMP      'A'                                4848
     C                   UPDATE    SUBFIL
     C                   MOVE      '0'           *IN51
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKV          BEGSR
      ***********************************************
     C  N41LINNBR        IFEQ      2
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     24
     C                   EXSR      HMRNR
     C     *IN41         IFEQ      '0'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   ELSE
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C                   GOTO      SLSØKV
     C                   END
      *
     C  N41LINNBR        IFEQ      5
     C                   MOVE      *ZEROS        UFLAG2            1 0
     C                   CALL      'LL002R'
     C                   PARM      WRGRUP        UGRP              8 0
     C                   PARM      WRKJED        UPNR              8 0
     C                   PARM                    WRANR
     C                   PARM                    WRANRL
     C                   PARM                    UTXT             40
     C                   PARM                    UFLAG2
     C     LLVARK        CHAIN(N)  LLVARE01                           30
     C     *IN30         IFEQ      '0'
     C                   MOVEL     LVVB          WRVARE
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
     C                   GOTO      SLSØKV
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     24
     C                   CALL      'LL006R'
     C                   PARM                    WRLOK1
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØKV
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     58
     C     POSNBR        ANDLE     60
     C                   CALL      'LL008R'
     C                   PARM                    WRLLT
     C  N41              Z-ADD     9             LINNBR
     C  N41              Z-ADD     20            POSNBR
     C                   GOTO      SLSØKV
     C                   END
      *
N04
N04  C     LINNBR        IFEQ      15
N04  C     POSNBR        ANDGE     39
N04  C     POSNBR        ANDLE     40
N04  C                   CALL      'SAD061F'
N04  C                   PARM                    WRFVUE
N04  C                   PARM                    USIDT             8 0
N04  C                   Z-ADD     15            LINNBR
N04  C                   Z-ADD     57            POSNBR
N04  C                   GOTO      SLSØKV
N04  C                   END
N04   *
N04  C     LINNBR        IFEQ      15
N04  C     POSNBR        ANDGE     76
N04  C     POSNBR        ANDLE     80
N04  C                   CALL      'SAD061F'
N04  C                   PARM                    WRFVIE
N04  C                   PARM                    USIDT             8 0
N04  C                   Z-ADD     16            LINNBR
N04  C                   Z-ADD     20            POSNBR
N04  C                   GOTO      SLSØKV
N04  C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     39
     C     POSNBR        ANDLE     40
     C                   CALL      'SAD061F'
     C                   PARM                    WRVAL
     C                   PARM                    USIDT             8 0
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØKV
     C                   END
      *
     C     SLSØKV        ENDSR
      *
      ***********************************************
     C     HMRNR         BEGSR
      ***********************************************
     C                   MOVE      'N'           USPØR             1
     C                   CALL      'LL023R'
     C                   PARM      WRGRUP        URGRUP            8 0
     C                   PARM      WRKJED        URKJED            8 0
     C                   PARM                    NVNKJE
     C     WRMRNR        PARM      WRMRNR        URMRNR            5 0
     C                   PARM                    USPØR
      *
     C                   ENDSR
      *
      ***********************************************
     C     TSTB20        BEGSR
      ***********************************************
      * 46 *ON KUN VISSE FELT  ENDRES / TESTES
      *
     C     *IN46         IFEQ      *OFF                                         1<-B
     C                   MOVE      ' '           LVAKT
     C     LLVARK        CHAIN(N)  LLVARE01                           30
     C     *IN30         IFEQ      '1'                                           2<-B
     C     WRANRL        ANDNE     *BLANKS
     C     LLV03K        CHAIN     LLVARE03                           30
     C  N30LLV03K        READE     LLVARE03                               33
     C  N30
     CANN33              MOVE      '1'           *IN30
     C                   END                                                     2<-E
     C  N30LVVKT0        COMP      0                                      30
     C  N30LVAKT         COMP      'I'                                    30
     C     *IN30         IFEQ      '1'                                           2<-B
     C                   Z-ADD     5             LINNBR
     C     WRANR         IFNE      *BLANKS                                        3<-B
     C     WRANRL        OREQ      *BLANKS
     C                   Z-ADD     20            POSNBR
     C                   IF        LVAKT = 'I'
     C                   MOVE      'YBC1914'     MSGNR
     C                   ELSE
     C                   MOVE      'JOV0810'     MSGNR
     C                   END
     C                   ELSE                                                     3
     C                   Z-ADD     60            POSNBR
     C                   IF        LVAKT = 'I'
     C                   MOVE      'YBC1914'     MSGNR
     C                   ELSE
     C                   MOVE      'YBC0686'     MSGNR
     C                   END
     C                   END                                                      3<-E
     C                   GOTO      UTTST
     C                   ELSE                                                    2
     C                   MOVEL     LVANR         WRANR
     C                   MOVEL     LVANRL        WRANRL
     C                   MOVEL     LVVB          WRVARE
     C     XTYPE         IFEQ      'CRT'                                          3<-B
     C                   EXSR      MOVFH
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * TEST LAGERLOKASJON FLYTTET LENGER OPP
      * TEST LAGERPOSISJON
     C     WRLLOK        IFEQ      *BLANKS
     C                   MOVE      LVLLOK        WRLLOK
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C     WRLLOK        IFEQ      *BLANKS
     C                   MOVE      'YBC0674'     MSGNR
     C                   ELSE
     C                   Z-ADD     26            POSNBR
     C     WRLOK2        IFEQ      *BLANKS
     C                   MOVE      'YBC0669'     MSGNR
     C                   ELSE
     C                   MOVE      'DIV0000'     MSGNR
     C                   END
     C                   END
     C                   MOVE      '1'           *IN30
     C                   GOTO      UTTST
     C                   ELSE
     C     LULLK         CHAIN     LLULLF                             33
     C     LSLENG        IFNE      0
      * NÅR LXBXH ER ANGITT INNEH. FILA UGYLDIGE POSISJONER...
     C     *IN33         IFEQ      '0'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   MOVE      'YBC1721'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   ELSE
      * LXBXH IKKE ANGITT.   FILA INNEHOLDER GYLDIGE POSISJONER...
      * EVT FEILMELD DERSOM IKKE I FILA??
     C     *IN33         IFEQ      '1'
     C                   END
     C                   END
     C     WRLOK1        CHAIN     LLLSDF                             33
     C     *IN33         IFEQ      '0'
     C     WRLLT         IFEQ      *BLANKS
     C                   MOVE      LSLLT         WRLLT
     C                   END
     C     WRLOK2        IFEQ      *BLANKS
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   MOVE      'YBC0669'     MSGNR
     C                   GOTO      UTTST
     C                   ELSE
     C     LSLENG        IFNE      0
     C     LSLENG        IFGE      100
     C     LSBRED        ORGE      100
     C     LSHØYD        ORGE      100
     C                   Z-ADD     9             XN
     C                   ELSE
     C                   Z-ADD     6             XN
     C                   END
     C     1             DO        XN            XN2
     C     LS(XN2)       IFLT      '0'
     C     LS(XN2)       ORGT      '9'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   MOVE      'YBC0867'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   ENDDO
     C                   MOVE      *ZEROS        XSLENG            3 0
     C                   MOVE      *ZEROS        XSBRED            3 0
     C                   MOVE      *ZEROS        XSHØYD            3 0
     C     LSLENG        IFGE      100
     C     LSBRED        ORGE      100
     C     LSHØYD        ORGE      100
     C                   MOVE      LS3L          XSLENG
     C                   MOVE      LS3B          XSBRED
     C                   MOVE      LS3H          XSHØYD
     C                   ELSE
     C                   MOVE      LS2L          XSLENG
     C                   MOVE      LS2B          XSBRED
     C                   MOVE      LS2H          XSHØYD
     C                   END
     C     LSLENG        IFLT      XSLENG
     C     LSBRED        ORLT      XSBRED
     C     LSHØYD        ORLT      XSHØYD
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   MOVE      'YBC0867'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   MOVE      *BLANKS       LS2
     C                   END
     C                   END
     C                   ELSE
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'YBC0674'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   END
      * TEST MOT LOKASJONSTYPE FLYTTE LENGER OPP
     C     WRLLT         CHAIN     LLTKF                              30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     58            POSNBR
     C                   MOVE      'YBC0786'     MSGNR
     C                   GOTO      UTTST
     C                   END
      *
      *
     C     *IN46         IFEQ      *OFF
     C     WROANT        IFEQ      0
     C     WRSAE0        ANDEQ     0
     C     WRSAE1        ANDEQ     0
     C     WRSAE2        ANDEQ     0
     C     WRSAE3        ANDEQ     0
     C     WROANT        ORLT      0
     C     WRSAE0        ORLT      0
     C     WRSAE1        ORLT      0
     C     WRSAE2        ORLT      0
     C     WRSAE3        ORLT      0
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0586'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      UTTST
     C                   END
     C                   END
      *
      * TEST OM ANTALL STYKK SAMSVARER MED ENHETER M.M.
     C     LLVARK        CHAIN(N)  LLVARE01                           30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'JOV0810'     MSGNR
     C                   GOTO      UTTST
     C                   END
      *
     C     *IN46         IFEQ      *OFF
     C     LVSN          ANDEQ     'I'
     C     WROANT        ANDGT     900000
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'YBC0875'     MSGNR
     C                   GOTO      UTTST
     C                   END
      *
     C     *IN46         IFEQ      *OFF
     C                   MOVE      WROANT        SALD
     C                   ELSE
     C                   MOVE      VASALD        SALD
     C                   END
      *
     C                   MOVE      'N'           XBEGGE            1
     C  N30SALD          IFNE      0
     C     WRSAE0        IFNE      0
     C     WRSAE1        ORNE      0
     C     WRSAE2        ORNE      0
     C     WRSAE3        ORNE      0
     C                   MOVE      'J'           XBEGGE
     C                   MOVE      SALD          GMSALD
     C                   MOVE      *ZEROS        SALD
     C                   END
     C                   END
      *
      * BEREGN ANTALL STYKK ELLER ANDRE ALTERNATIVE ENHETER.
     C  N30SALD          IFEQ      0
     C                   Z-ADD     WRSAE0        SALD
     C     WRSAE1        IFNE      0
     C     WRSAE1        MULT      WRAN01        XNT05             5 0
     C                   ADD       XNT05         SALD
     C                   END
     C     WRSAE2        IFNE      0
     C     WRSAE2        MULT      WRAN02        XNT05
     C                   ADD       XNT05         SALD
     C                   END
     C     WRSAE3        IFNE      0
     C     WRSAE3        MULT      WRAN03        XNT05
     C                   ADD       XNT05         SALD
     C                   END
     C                   MOVE      *ZEROS        XNT05
     C                   ELSE
     C     WRAN03        IFGT      0
     C     SALD          DIV       WRAN03        WRSAE3
     C                   MVR                     WRSAE0
     C                   ELSE
     C                   MOVE      SALD          WRSAE0
     C                   END
     C     WRAN02        IFGT      0
     C     WRSAE0        DIV       WRAN02        WRSAE2
     C                   MVR                     WRSAE0
     C                   END
     C     WRAN01        IFGT      0
     C     WRSAE0        DIV       WRAN01        WRSAE1
     C                   MVR                     WRSAE0
     C                   END
     C                   END
      *
     C  N30XBEGGE        IFEQ      'J'
     C     *IN23         ANDNE     '1'
     C     SALD          ANDNE     GMSALD
     C                   MOVE      GMSALD        SALD
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0600'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   END
      *
     C     *IN46         IFEQ      *OFF
     C     *IN23         IFEQ      *ON
     C                   MOVE      GMSALD        WROANT
     C                   ELSE
     C                   MOVE      SALD          WROANT
     C                   END
     C                   END
      *
      * TEST OM ENHET IKKE SKAL BRUKES.
     C     WRAN01        IFEQ      0
     C     WRSAE1        ANDNE     0
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0592'     MSGNR
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     35            POSNBR
     C                   END
     C     WRAN02        IFEQ      0
     C     WRSAE2        ANDNE     0
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0592'     MSGNR
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     35            POSNBR
     C                   END
     C     WRAN03        IFEQ      0
     C     WRSAE3        ANDNE     0
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0592'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     35            POSNBR
     C                   END
      * TEST ANTALL PASSER MED LAVESTE SALGSENEHT
     C  N30              SELECT
     C     WRMIN         WHENGT    0
     C     WRSAE0        ANDGT     0
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0593'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     35            POSNBR
     C     WRMIN         WHENEQ    1
     C     WRSAE1        COMP      0                                      87
     C   87WRAN02        IFGT      0
     C     WRSAE2        COMP      0                                      87
     C                   END
     C   87WRAN03        IFGT      0
     C     WRSAE3        COMP      0                                      87
     C                   END
     C   87              MOVE      'YBC0589'     MSGNR
     C     WRMIN         WHENEQ    2
     C     WRSAE1        COMP      0                                  8787
     C   87              MOVE      'YBC0587'     MSGNR
     C  N87WRSAE2        COMP      0                                      86
     C  N87
     CAN 86WRAN03        IFGT      0
     C     WRSAE3        COMP      0                                      86
     C                   END
     C   86              MOVE      'YBC0588'     MSGNR
     C     WRMIN         WHENEQ    3
     C     WRSAE1        COMP      0                                  8787
     C   87              MOVE      'JOV0844'     MSGNR
     C     WRSAE2        COMP      0                                  8686
     C   86              MOVE      'YBC0590'     MSGNR
     C     WRSAE3        COMP      0                                      85
     C   85              MOVE      'YBC0591'     MSGNR
     C                   ENDSL
      *
     C  N30
     CAN 87
     CORN30
     CAN 86
     CORN30
     CAN 85              DO
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     35            POSNBR
     C                   SELECT
     C     *IN87         WHENEQ    '1'
     C                   Z-ADD     11            LINNBR
     C     *IN86         WHENEQ    '1'
     C                   Z-ADD     12            LINNBR
     C     *IN85         WHENEQ    '1'
     C                   Z-ADD     13            LINNBR
     C                   ENDSL
     C                   END
      *
     C  N30WRAVD         IFNE      0
     C     WROPD         ANDNE     0
     C     HEADFK        CHAIN     HEADF                              30
     C     *IN30         IFEQ      '1'
N04YBC                   IF        XTYPE = 'CH2'
N04YBC                   EVAL      *IN30 = *OFF
N04YBC                   ELSE
     C                   MOVE      'SPO0001'     MSGNR
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     39            POSNBR
N04YBC                   END
     C                   END
     C                   END
      *
      * SALDO I VEKT / KUBIKK REBEREGNES ALLTID ETTER ANT.ENH..
     C     *LIKE         DEFINE    WRVKTS        TMPVKT
     C     *LIKE         DEFINE    WRKUBS        TMPKUB
     C                   MOVE      *ZEROS        WRVKTS
     C                   MOVE      *ZEROS        WRKUBS
     C     WRSAE3        MULT(H)   WRVKT3        TMPVKT
     C     WRSAE3        MULT(H)   WRKUB3        TMPKUB
     C                   ADD       TMPVKT        WRVKTS
     C                   ADD       TMPKUB        WRKUBS
      *
     C     WRSAE2        MULT(H)   WRVKT2        TMPVKT
     C     WRSAE2        MULT(H)   WRKUB2        TMPKUB
     C                   ADD       TMPVKT        WRVKTS
     C                   ADD       TMPKUB        WRKUBS
      *
     C     WRSAE1        MULT(H)   WRVKT1        TMPVKT
     C     WRSAE1        MULT(H)   WRKUB1        TMPKUB
     C                   ADD       TMPVKT        WRVKTS
     C                   ADD       TMPKUB        WRKUBS
      *
     C     WRSAE0        MULT(H)   WRVKT0        TMPVKT
     C     WRSAE0        MULT(H)   WRKUB0        TMPKUB
     C                   ADD       TMPVKT        WRVKTS
     C                   ADD       TMPKUB        WRKUBS
      *
     C  N30LSTYPE        IFEQ      'P'
     C     WRSAE3        ANDGT     1000
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     35            POSNBR
     C                   MOVE      'YBC0670'     MSGNR
     C                   GOTO      UTTST
     C                   END
      *
N04   * Frakt utenfor  EU / valuta
N04  c     WRFRUE        IFNE      *zeros
N04  c     WRFVUE        orne      *blanks
N04  C                   MOVE      WRFVUE        XXVAL
N04  C     KODVAK        CHAIN     KODTVA                             30
N04  C     *IN30         IFEQ      '1'
N04  C                   Z-ADD     15            LINNBR
N04  C                   Z-ADD     39            POSNBR
N04  C                   MOVE      'SPV0001'     MSGNR
N04  C                   GOTO      UTTST
N04  C                   END
N04  C                   END
N04   * Frakt innenfor EU / valuta
N04  c     WRFRIE        IFNE      *zeros
N04  c     WRFVIE        orne      *blanks
N04  c     WRFVIE        ifeq      *blanks
N04  C                   MOVE      WRFVUE        WRFVIE
N04  c                   ENDIF
N04  C                   MOVE      WRFVIE        XXVAL
N04  C     KODVAK        CHAIN     KODTVA                             30
N04  C     *IN30         IFEQ      '1'
N04  C                   Z-ADD     15            LINNBR
N04  C                   Z-ADD     76            POSNBR
N04  C                   MOVE      'SPV0001'     MSGNR
N04  C                   GOTO      UTTST
N04  C                   END
N04  C                   END
      *
     C     WRMRNR        IFNE      0
     C     LMRFK         CHAIN     LLMRF                              33
     C     XXGN          COMP      ' '                                    33
     C     *IN33         IFEQ      '0'
     C     WRVERD        COMP      0                                      30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'SPB0007'     MSGNR
     C                   GOTO      UTTST
     C                   END
N04  C                   MOVE      WRVAL         XXVAL
     C     KODVAK        CHAIN     KODTVA                             30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     39            POSNBR
     C                   MOVE      'SPV0001'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   END
     C                   END
      *
     C     WRDTV         IFNE      0
     C                   MOVE      WRDTVD        UDD               2 0
     C                   MOVE      WRDTVM        UMM               2 0
     C                   MOVE      WRDTVÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAG2            1 0
     C     UFLAG2        IFEQ      1
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   END
      * TEST UTLØPSDATO
     C  N30LVDTU         IFEQ      'J'
     C     WRULDT        ORNE      0
     C                   MOVE      WRULDD        UDD               2 0
     C                   MOVE      WRULDM        UMM               2 0
     C                   MOVE      WRULDÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAG2            1 0
     C     UFLAG2        IFEQ      1
     C     WRULDT        ORLE      IDAG
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   END
      * TEST PRODUKSJONSDATO
     C  N30LVDTP         IFEQ      'J'
     C     WRPRDT        ORNE      0
     C                   MOVE      WRPRDD        UDD               2 0
     C                   MOVE      WRPRDM        UMM               2 0
     C                   MOVE      WRPRDÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAG2            1 0
     C     UFLAG2        IFEQ      1
     C     WRPRDT        ORGE      IDAG
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     41            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      UTTST
     C                   END
     C                   END
      *
      * TEST BATCHNR
     C  N30LVBATC        IFEQ      'J'
     C     WRSENR        ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'YBC0676'     MSGNR
     C                   GOTO      UTTST
     C                   END
      *
     C  N30LSTYPE        IFEQ      'P'
     C     WRSAE3        IFGT      1
     C     WRSAE3        ORGT      0
     C     WRSAE2        ANDGT     0
     C     WRSAE3        ORGT      0
     C     WRSAE1        ANDGT     0
     C     WRSAE3        ORGT      0
     C     WRSAE0        ANDGT     0
     C     LC(1)         IFEQ      *BLANKS
     C                   MOVE      WRLLOK        LC(1)
     C                   MOVE      WRPLID        PL(1)
     C                   END
     C     WRSAE0        IFGT      0
     C     WRSAE1        ORGT      0
     C     WRSAE2        ORGT      0
     C                   ADD       1             WRSAE3
     C                   END
     C                   CALL      'LL026R'
     C                   PARM                    LC
     C                   PARM                    PL
     C                   PARM      WRSAE3        USAE3             5 0
     C                   PARM                    UFLAG2            1 0
     C     UFLAG2        IFEQ      1
     C                   MOVE      *BLANKS       LC(1)
     C     WRSAE0        IFGT      0
     C     WRSAE1        ORGT      0
     C     WRSAE2        ORGT      0
     C                   SUB       1             WRSAE3
     C                   END
     C                   MOVE      *BLANKS       PL(1)
     C                   ELSE
     C                   MOVE      LC(1)         WRLLOK
     C                   MOVE      PL(1)         WRPLID
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       LC(1)
     C                   MOVE      *BLANKS       PL(1)
     C                   MOVE      *ZEROS        UFLAG2
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       LC(1)
     C                   MOVE      *BLANKS       PL(1)
     C                   MOVE      *ZEROS        UFLAG2
     C                   END
      *
     C     UTTST         ENDSR
      *
      ***********************************************
     C     NYPOS         BEGSR
      ***********************************************
     C                   Z-ADD     VAAN03        VAOANT
     C                   Z-ADD     VAAN03        VASALD
     C                   MOVE      *ZEROS        VASAE0
     C                   MOVE      *ZEROS        VASAE1
     C                   MOVE      *ZEROS        VASAE2
     C                   Z-ADD     1             VASAE3
     C     VASAE3        MULT      VAVKT3        VAVKTS
      * VED PALL-LAGER SKAL LIKE MANGE LINJER SOM ANTALL PALLER LAGES.
     C     2             DO        999           XN2               5 0
     C     LC(XN2)       IFEQ      *BLANKS
     C                   LEAVE
     C                   END
     C     3             CHAIN     LLTELL                             33
     C                   IF        *IN33
     C     1             CHAIN(N)  LLTELL                             33
     C                   IF        *IN33
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   END
     C     2             CHAIN(N)  LLTELL                             33
     C                   IF        *IN33
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   END
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   ELSE
     C                   ADD       1             LLREC1
     C                   UPDATE    LLTELLR
     C                   END
     C                   MOVE      LLREC1        VAMN
     C                   MOVE      LC(XN2)       VALLOK
     C                   MOVE      PL(XN2)       VAPLID
     C                   WRITE     LLAGJR
N04  C   89              WRITE     LLAGJEUR
     C     LVSN          IFEQ      'I'
     C                   CALL      'LL018R'
     C                   PARM                    VAGRUP
     C                   PARM                    VAKJED
     C                   PARM                    VAANR
     C                   PARM                    VALLOK
     C                   PARM                    VAMN
     C                   PARM                    VASALD
     C                   END
     C     MODUS         IFEQ      1
     C                   MOVEL     VALLOK        XXVA19
     C                   END
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      '1'           *IN51
     C                   WRITE     SUBFIL
     C                   MOVE      '0'           *IN51
     C                   ENDDO
      *
     C                   ENDSR
