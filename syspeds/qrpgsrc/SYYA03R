      *
      *
      *****************************************************************
      * PROGRAM SKAL SKRIVE UT FRAKTAVTALER                           *
      * INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER              *
      * LEDIGE INDIKATORER 01 02 05-26                                *
      * LEDIGE INDIKATORER 43-49 56-93                                *
      *****************************************************************
      *
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FFRATFRA   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYYA03D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FSYYA03P   O    E             PRINTER OFLIND(*IN27)
     D                 DS
     D  FTKNR                  1      8  0
     D  FTFRA                  9     13
     D  FTFRAN                14     16
     D  FTOPDT                17     18
     D  FTSK                  19     19
     D  DATA                   1     19
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  FIFT                   1     45
     D  FIFT30                 1     30
     D                 DS
     D  XINTF                  1     83
     D  VF                     1     83
     D                                     DIM(83)
     D                 DS
     D  XINTT                  1     83
     D  VT                     1     83
     D                                     DIM(83)
     D                 DS
     D  XVKT1                  1      5
     D  I1                     1      5
     D                                     DIM(5)
     D                 DS
     D  XVKT2                  1      5
     D  I2                     1      5
     D                                     DIM(5)
     D                 DS
     D  FTVAL                  1      3
     D  XFTVAL                 1      3
     D                 DS
     D  WSDTFD                 1      2  0
     D  WSDTFM                 3      4  0
     D  WSDTF≈                 5      6  0
     D  WSDTF                  1      6  0
     D                 DS
     D  WSDTTD                 1      2  0
     D  WSDTTM                 3      4  0
     D  WSDTT≈                 5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  W2DTF≈                 1      4  0
     D  W2DTFM                 5      6  0
     D  W2DTFD                 7      8  0
     D  W2DTF                  1      8  0
     D                 DS
     D  FRVK1                  1      5  0
     D  FRVK2                  6     10  0
     D  FRVK3                 11     15  0
     D  FRVK4                 16     20  0
     D  FRVK5                 21     25  0
     D  FRVK6                 26     30  0
     D  FRVK7                 31     35  0
     D  FRVK8                 36     40  0
     D  FRVK9                 41     45  0
     D  FRVK10                46     50  0
     D  FRVK11                51     55  0
     D  FRVK12                56     60  0
     D  VK                     1     60  0
     D                                     DIM(12)
     D  VKA                    1     60
     D                 DS
     D  FB01                   1      5  0
     D  XFB01                  2      5  2
     D  FB02                   6     10  0
     D  XFB02                  7     10  2
     D  FB03                  11     15  0
     D  XFB03                 12     15  2
     D  FB04                  16     20  0
     D  XFB04                 17     20  2
     D  FB05                  21     25  0
     D  XFB05                 22     25  2
     D  FB06                  26     30  0
     D  XFB06                 27     30  2
     D  FB07                  31     35  0
     D  XFB07                 32     35  2
     D  FB08                  36     40  0
     D  XFB08                 37     40  2
     D  FB09                  41     45  0
     D  XFB09                 42     45  2
     D  FB10                  46     50  0
     D  XFB10                 47     50  2
     D  FB11                  51     55  0
     D  XFB11                 52     55  2
     D  FB12                  56     60  0
     D  FB                     1     60  0
     D                                     DIM(12)
     D  XFB12                 57     60  2
     D  FTMAX3                61     65  0
     D  XMAX3                 62     65  2
     D                 DS
     D  FM01                   1      5  0
     D  FM02                   6     10  0
     D  FM03                  11     15  0
     D  FM04                  16     20  0
     D  FM05                  21     25  0
     D  FM06                  26     30  0
     D  FM07                  31     35  0
     D  FM08                  36     40  0
     D  FM09                  41     45  0
     D  FM10                  46     50  0
     D  FM11                  51     55  0
     D  FM12                  56     60  0
     D  FM                     1     60  0
     D                                     DIM(12)
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C                   MOVEA     '000000'      *IN(94)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SÿKDTA
     C                   GOTO      START
     C                   END
      *
     C                   EXSR      TESTB
     C  N30              EXSR      PRINT
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C******************************************
     C     TESTB         BEGSR
     C******************************************
      *
      * TEST KUNDENR
     C     WSKN          IFNE      0
     C     WSKN          ANDNE     99999999
     C                   MOVE      WSKN          KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            99
     C   99              MOVE      'SPK0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB
     C                   END
      *
      * TEST FRA-STED
     C     WSSDF         IFNE      *BLANKS
     C     WSSDF         CHAIN     STED2                              97
     C   97              MOVE      'SPS0012'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      SLTB
     C                   END
      *
      * TEST TIL-STED
     C     WSSDT         IFNE      *BLANKS
     C     WSSDT         CHAIN     STED2                              96
     C   96              MOVE      'SPS0013'     MSGNR
     C   96              SETON                                        30
     C   96              GOTO      SLTB
     C                   END
      *
      *** TEST FRA DATO
     C                   MOVE      WSDTF≈        U≈≈               2 0
     C                   MOVE      WSDTFM        UMM               2 0
     C                   MOVE      WSDTFD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      95
     C   95              MOVE      'SPD0001'     MSGNR
     C   95              SETON                                        30
     C   95              GOTO      SLTB
      *
      *** TEST TIL DATO
     C                   MOVE      WSDTT≈        U≈≈               2 0
     C                   MOVE      WSDTTM        UMM               2 0
     C                   MOVE      WSDTTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      94
     C   94              MOVE      'SPD0001'     MSGNR
     C   94              SETON                                        30
     C   94              GOTO      SLTB
      *
     C     SLTB          ENDSR
      *
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C     WSKN          IFEQ      99999999
     C                   Z-ADD     1             XKN
     C                   ELSE
     C     WSKN          IFEQ      0
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVE      *BLANKS       ADR1
     C                   MOVEL     XTXT1         ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *ZEROS        POSTNR
     C                   MOVE      *BLANKS       ADR3
     C                   END
     C                   MOVE      WSKN          XKN               8 0
     C                   END
     C                   MOVE      '1'           *IN27
     C                   MOVE      'DIV0782'     MSGNR
     C                   MOVE      *ZEROS        KUNDNR
     C     WSDTF≈        IFEQ      0
     C                   MOVE      *ZEROS        W2DTF
     C                   ELSE
     C                   MOVE      WSDTFD        W2DTFD
     C                   MOVE      WSDTFM        W2DTFM
     C     WSDTF≈        IFGT      50
     C     WSDTF≈        ADD       1900          W2DTF≈
     C                   ELSE
     C     WSDTF≈        ADD       2000          W2DTF≈
     C                   END
     C                   END
      *
     C     FRATNK        SETLL     FRATFRA
      *
     C     STPRT         TAG
     C     WSKN          IFEQ      99999999
     C                   READ      FRATFRA                                33
     C                   ELSE
     C     WSKN          READE     FRATFRA                                33
     C                   END
     C   33              WRITE     SYYA03P3
     C   33              GOTO      SLPRT
      * TEST DATO
     C     FTDT          IFNE      0
     C     FTDT          ANDLT     W2DTF
     C                   GOTO      STPRT
     C                   END
      * TEST FRANKATUR
     C     WSFR          IFNE      *BLANKS
     C     WSFR          ANDNE     FTFRAN
     C                   GOTO      STPRT
     C                   END
      * TEST OPPDRAGSTYPE
     C     WSOPDT        IFNE      *BLANKS
     C     WSOPDT        ANDNE     FTOPDT
     C                   GOTO      STPRT
     C                   END
      * TEST STED FRA
     C     WSSDF         IFNE      *BLANKS
     C     WSSDF         ANDNE     FTFRA
     C                   GOTO      STPRT
     C                   END
      * TEST STED TIL
     C     WSSDT         IFNE      *BLANKS
     C     WSSDT         ANDNE     FTTIL
     C                   GOTO      STPRT
     C                   END
      * TEST LANDKODE FRA
     C     FTFRA         CHAIN     STED2                              34
     C   34              GOTO      STPRT
     C     WSLK          IFNE      *BLANKS
     C     WSLK          ANDNE     ST2LK
     C                   GOTO      STPRT
     C                   END
      * TEST LANDKODE TIL
     C                   MOVE      ST2LK         XLKF
     C                   MOVE      ST2NVN        XSTDF
     C     FTTIL         CHAIN     STED2                              34
     C   34              GOTO      STPRT
     C     WSLK2         IFNE      *BLANKS
     C     WSLK2         ANDNE     ST2LK
     C                   GOTO      STPRT
     C                   END
     C                   MOVE      ST2LK         XLKT
     C                   MOVE      ST2NVN        XSTDT
      * TEST KUNDENUMMER
     C     WSKN          IFEQ      99999999
     C     FTKNR         ANDNE     KUNDNR
     C                   MOVE      FTKNR         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C     *IN34         IFEQ      '1'
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVEL     XTXT2         KNAVN
     C                   MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *ZEROS        POSTNR
     C                   MOVE      *BLANKS       ADR3
     C                   END
     C                   MOVE      '1'           *IN27
     C                   END
      * TEST VED GE                                                    TT
     C     FTOPDT        IFEQ      'GE'
     C                   MOVEL     XTXT3         KO1NTX
     C                   ELSE
     C     KODOTK        CHAIN     KODTOTY                            34                    A
     C   34              MOVE      *BLANKS       KO1NTX                                     KODE
     C   34              MOVEL     XTXT2         KO1NTX                                     KODE
     C                   END
     C     FTMM          COMP      0                                      51
     C     FTMM          COMP      1                                      52
     C     FTMM          COMP      2                                      53
     C     FTMM          COMP      3                                      54
     C     FTKOLL        COMP      ' '                                    61
     C  N61FTKOLL        COMP      'G'                                    61
     C     FTKOLL        COMP      'X'                                    62
     C     FTKOLL        COMP      'L'                                    63
     C     FTKOLL        COMP      'M'                                    64
     C     FTKOLL        COMP      'B'                                    65
     C     FTKOLL        COMP      'V'                                    66
     C     FTMAX3        COMP      *ZEROS                             6767
      *
     C                   MOVE      *BLANKS       XINTF
     C                   MOVE      *BLANKS       XINTT
     C                   MOVE      '99999'       FRVK12
     C     1             DO        12            XN                3 0          1<-B
     C     XN            SUB       1             XN2               3 0
     C*
     C* HOPPER UT AV LÿKKE VED 99999
     C* OG SKRIVER ALLE ELLER OVER
     C* IKKE VED 0 I BELÿP
     C*
     C     FB(XN)        IFEQ      0
     C                   MOVEA     *ZEROS        FM(XN)
     C                   GOTO      STPRT2
     C                   END
     C     VK(XN)        IFEQ      99999                                         2<-B
     C     XN            IFEQ      1
     C                   MOVE      ' Alle'       XVKT1
     C                   MOVE      '00000'       XVKT2
     C                   ELSE                                                     3
     C                   MOVE      ' Over'       XVKT1
     C                   MOVE      VK(XN2)       XVKT2
     C                   END                                                      3<-E
     C                   EXSR      MOVINT
     C                   GOTO      STPRT2
     C* VED IKKE 99999
     C                   ELSE                                                    2
     C     XN            IFEQ      1                                              3<-B
     C                   MOVE      '00001'       XVKT1
     C                   ELSE                                                     3
     C                   ADD       1             VK(XN2)
     C                   MOVE      VK(XN2)       XVKT1
     C                   END                                                      3<-E
     C                   MOVE      VK(XN)        XVKT2
     C                   EXSR      MOVINT
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     STPRT2        TAG
     C   27              ADD       1             SIDE
     C   27SIDE          IFNE      1
     C                   WRITE     SYYA03P3
     C                   END
     C   27              WRITE     SYYA03P1
     C     DATA          IFNE      DATAG
     C     VKA           ORNE      VKAG
     C     *IN27         OREQ      '1'
     C   27              MOVE      '0'           *IN27
     C                   WRITE     SYYA03P2
     C                   ELSE
     C                   WRITE     SYYA03P4
     C                   END
     C                   MOVE      DATA          DATAG            19
     C                   MOVE      VKA           VKAG             60
     C                   MOVE      'DIV0781'     MSGNR
      *
     C                   GOTO      STPRT
      *
     C     SLPRT         ENDSR
      *
     C***********************************************
     C     MOVINT        BEGSR
     C***********************************************
     C     XN            MULT      7             XN3               3 0
     C                   SUB       6             XN3
     C  N63
     CANN64              Z-ADD     1             XN5               1 0
     C   63
     COR 64              Z-ADD     2             XN5
     C                   MOVEA     '00'          *IN(34)
      *
      * START OVER
      *
     C     XVKT1         IFEQ      ' Over'
     C                   MOVEA     I1            VF(XN3)
      *
      * START LÿKKE 5
      *
     C     XN5           DO        5             XN4               3 0
      *
      * START LÿKKE 4
      *
     C   63
     COR 64XN4           IFEQ      4
     C                   MOVE      ','           VT(XN3)
     C                   MOVE      '1'           *IN34
     C                   ADD       1             XN3
     C                   END
      *
      * SLUTT LÿKKE 4
      *
      *
      * START 0
      *
     C     I2(XN4)       IFNE      '0'
     C     *IN34         OREQ      '1'
     C                   MOVE      '1'           *IN34
     C                   MOVE      I2(XN4)       VT(XN3)
     C                   END
      *
      * SLUTT 0
      *
     C                   ADD       1             XN3
     C                   END
      *
      * SLUTT LÿKKE 5
      *
      *
      * ELSE OVER (IKKE)
      *
     C                   ELSE
      *
      * START ALLE
      *
     C     XVKT1         IFEQ      ' Alle'
     C                   MOVEA     I1            VF(XN3)
     C                   ELSE
     C     XN5           DO        5             XN4               3 0
     C   63
     COR 64XN4           IFEQ      4
     C                   MOVE      ','           VF(XN3)
     C                   MOVE      ','           VT(XN3)
     C                   MOVE      '1'           *IN34
     C                   ADD       1             XN3
     C                   END
     C     I1(XN4)       IFNE      '0'
     C     *IN34         OREQ      '1'
     C                   MOVE      '1'           *IN34
     C                   MOVE      I1(XN4)       VF(XN3)
     C                   END
     C     I2(XN4)       IFNE      '0'
     C     *IN35         OREQ      '1'
     C                   MOVE      '1'           *IN35
     C                   MOVE      I2(XN4)       VT(XN3)
     C                   END
     C                   ADD       1             XN3
     C                   END
     C                   MOVE      '-'           VF(XN3)
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SÿKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   MOVE      *BLANKS       USÿKNV           30
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     25
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKN
     C                   PARM                    UFIRM
     C                   PARM                    USÿKNV
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSÿK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     19
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOPDT
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSÿK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     20
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFR
     C                   PARM                    USPED
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSÿK
     C                   END
      * FRA STED
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     22
     C                   MOVE      *BLANKS       ULK               2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDF
     C                   PARM                    USÿKNV
     C                   PARM                    ULK
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSÿK
     C                   END
      * TIL STED
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     22
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDT
     C                   PARM                    USÿKNV
     C                   PARM                    ULK
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSÿK
     C                   END
      * LANDKODE
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     19
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLK
     C                   PARM                    USPED
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSÿK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSÿK         ENDSR
      *
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KODOTK        KLIST
     C                   KFLD                    YOTUNI
     C                   KFLD                    FTOPDT
     C     FRATNK        KLIST
     C                   KFLD                    XKN
     C                   KFLD                    WSSDF
     C                   KFLD                    WSFR
     C                   KFLD                    WSOPDT
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
      *
     C                   MOVE      'J'           USPED             1
     C                   MOVE      'OTY'         YOTUNI            3
     C                   MOVE      UYEAR         WSDTF≈
     C                   MOVE      UMONTH        WSDTFM
     C                   MOVE      UDAY          WSDTFD
     C                   MOVE      UYEAR         WSDTT≈
     C                   MOVE      '12'          WSDTTM
     C                   MOVE      '31'          WSDTTD
     C                   MOVE      'DIV0000'     MSGNR
      *
     C     UFIRM         CHAIN     FIRM                               99
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
     C***********************************************
     C     HMSG          BEGSR
     C***********************************************
     C                   MOVE      'YBC0535'     XMSGNR
     C                   EXSR      HMSG2
     C                   MOVEL     XMSG          XTXT1            30
     C                   MOVE      'YBC0536'     XMSGNR
     C                   EXSR      HMSG2
     C                   MOVEL     XMSG          XTXT2            30
     C                   MOVE      'DIV5041'     XMSGNR
     C                   EXSR      HMSG2
     C                   MOVEL     XMSG          XTXT3            30
      *
     C                   ENDSR
      *
     C***********************************************
     C     HMSG2         BEGSR
     C***********************************************
     C                   Z-ADD     3             XLEVEL            1 0          NIV≈
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     132           XMSGL             4 0          LENGDE P≈ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR            7
     C                   PARM                    XMSG            132
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTFD        UDT1              2 0
     C                   MOVE      WSDTFM        UDT2              2 0
     C                   MOVE      WSDTF≈        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTFD
     C                   MOVE      UDT2          WSDTFM
     C                   MOVE      UDT3          WSDTF≈
      *
     C                   MOVE      WSDTTD        UDT1              2 0
     C                   MOVE      WSDTTM        UDT2              2 0
     C                   MOVE      WSDTT≈        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTTD
     C                   MOVE      UDT2          WSDTTM
     C                   MOVE      UDT3          WSDTT≈
      *
     C                   ENDSR
      *
