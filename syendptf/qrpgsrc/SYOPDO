********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 sh  PTF10 mindre feil
********************************************************************
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 MANGEL LOPNR VED KALL PÅ SYEF10B
10XXX * 02 YBC PTF10 FILTYPE
12248 * 03 YBC PTF12 VEKT, KOLLI ER UTVIDET.
********************************************************************
      *
      ***********************************************************
      *** PROGRAMMET VISER ETT OPPDRAGS TILHØRENDE DOKUMENTER ***
      ***********************************************************
      *
      *
     Faruserf   IF   E           K DISK
     FARKIVL02  IF   E           K DISK
     FARKEXT    IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMPDF   IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FSYOPDOFM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FDOKUF     IF   E           K DISK
     FDOKEC     IF   E           K DISK
     FDOKEB     IF   E           K DISK
     FBILLOF    IF   E           K DISK
     FDOKEF     IF   E           K DISK
     FDOKEM     IF   E           K DISK
     FHEADF     IF   E           K DISK
     FSADH      IF   E           K DISK
S03  F*SAEH      IF   E           K DISK
N03  FSAEH      IF   E           K DISK    PREFIX(E_)
     FSADTRH    IF   E           K DISK
     FTRUH      IF   E           K DISK
     FEDIM2     IF   E           K DISK
     FFIRM      IF   E           K DISK
     D                SDS
     D  UUSER                254    263
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D*** HØ, LE, BR, AN  BRUKES PGA. KALLER PÅ SYEF10B
     D HØ              S              3  2 DIM(12)
     D LE              S              3  2 DIM(12)
     D BR              S              3  2 DIM(12)
     D AN              S              3  0 DIM(12)
     D*
     D                 DS
     D  WS01A                  1     15
     D  WS02A                 16     30
     D  WS03A                 31     45
     D  WS04A                 46     60
     D  WS05A                 61     75
     D  WA                     1     75
     D                                     DIM(5)
     D                 DS
     D  WS01B                  1     76
     D  WS02B                 77    152
     D  WS03B                153    228
     D  WS04B                229    304
     D  WS05B                305    380
     D  WB                     1    380
     D                                     DIM(5)
     D                 DS
     D  artype                 1      2
     D  artyp1                 1      1
     D                UDS
     D  USG                   19     21
     c                   exsr      init
     C     START         TAG
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C   03
     COR 12              GOTO      SLUTT
     c     *in(10)       ifeq      '1'
     c                   call      'ARC003'
     c                   parm                    uavd
     c                   parm                    uopd
     C                   PARM                    URUNDE           10
     c                   goto      start
     c                   end
      *
      * STYKKGODSFRAKTBREV  5=vise
      *
     C     WSSTFB        IFEQ      '5'
     C                   Z-ADD     0             UFLAGG            1 0
     C                   Z-ADD     0             UFBNR             3 0
     C                   CALL      'SYFM21C'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFBNR
     C                   PARM                    UFLAGG
     C                   MOVE      *BLANKS       WSSTFB
     C                   END
      *
      * STYKKGODSFRAKTBREV  EPOST
      *
      *
     C     WSstfb        IFEQ      'E'
     C     HARPDF        ANDEQ     'J'
     c                   exsr      epofra
     C                   MOVE      *BLANKS       WSstfb
     c                   end
      *
     C*
      *
      * TOLLDEK IMPORT  5=vise
      *
     C     WSTDIM        IFEQ      '5'
     C                   Z-ADD     0             UFLAGG            1 0
     C                   CALL      'SAD005A'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   MOVE      *BLANKS       WSTDIM
     C                   END
      *
      *
      *
     C     WSTDIM        IFEQ      'E'
     C     HARPDF        andeq     'J'
     c                   exsr      eposad
     C                   MOVE      *BLANKS       WSTDIM
     c                   end
      *
      * TOLLDEK EXPORT  5=vise
      *
     C     WSTDEX        IFEQ      '5'
     C                   Z-ADD     0             UFLAGG            1 0
     C                   CALL      'SAD023A'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   MOVE      *BLANKS       WSTDEX
     C                   END
      *
      *
      * epost av sad eksaport
      *
     C     WSTDEX        IFEQ      'E'
     C     HARPDF        andeq     'J'
     c                   exsr      eposade
     C                   MOVE      *BLANKS       WSTDEX
     c                   end
      *
      *
      *
      * TRANSITERING MANUELL
      *
     C     WSTRMA        IFEQ      '5'
     C                   Z-ADD     0             UFLAGG            1 0
     C                   CALL      'SAD040A'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      *BLANKS       WSTRMA
     C                   END
      *
      *
      * TRANSITERING TET
      *
     C     WSTRTE        IFEQ      '5'
     C                   Z-ADD     0             UFLAGG            1 0
     C                   MOVE      'DSP'         UTYPE                    27
     C                   CALL      'TR011R'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UPRO              8 0
     C                   PARM                    USG
     C                   PARM                    UTYPE             3
     C                   PARM                    UWS              11
     C                   PARM                    UFLAGG
     C                   MOVE      *BLANKS       WSTRTE
     C                   END
      *
      *
      * epost av tet dokement
      *
     C     WSTRTE        IFEQ      'E'
     c                   exsr      epostet
     C                   MOVE      *BLANKS       WSTRTE
     c                   end
      *
      *
      *
      * TVINNLOGG
      *
     C  N71              MOVE      '0'           USYST
     C  N72              MOVE      '1'           USYST
     C  N73              MOVE      '2'           USYST
     C     WSTADL        IFEQ      '5'
     C                   CALL      'SAD003'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    USYST             1
     C                   MOVE      *BLANKS       WSTADL
     C                   END
      *
      *
      * CMR    5=vise
      *
     C     WSCMRF        IFEQ      '5'
     C*
     C                   Z-ADD     9             UFLAGG
     C     FILAND        IFEQ      *BLANKS
     C     FILAND        OREQ      'NO'
     C                   CALL      'SYEX10B'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    XMSG             62
     C                   PARM                    UFLAGG
     C                   ELSE
     C                   CALL      'SYEX10E'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    XMSG
     C                   PARM                    UFLAGG
     C                   END
     C                   MOVE      *BLANKS       WSCMRF
     C                   END
      *
      * CMR    E=epost
      *
     C     WSCMRF        IFEQ      'E'
     c     harpdf        andeq     'J'
     c                   exsr      eposCMR
     C                   MOVE      *BLANKS       WSCMRF
     c                   end
      *
     C*
     C* EXPORT TRUCK BILL OF LADING
     C*
     C     WSBILL        IFEQ      '5'
     C                   Z-ADD     9             UFLAGG
     C                   CALL      'SYEX10A'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    XMSG
     C                   PARM                    UFLAGG
     C                   MOVE      *BLANKS       WSBILL
     C                   END

     C     WSBILS        IFEQ      '5'
     C                   Z-ADD     1             UFLAGG            1 0
     C                   CALL      'SYSJ52I'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    BLSG
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      *BLANKS       WSBILS
     C                   END
     C*
     C*
     C* FLYFRAKTBREV  5=vise
     C*
     C     WSAWB         IFEQ      '5'
     C                   Z-ADD     1             UFLAGG
N01  C                   Z-ADD     1             ULOP              3 0
     C                   CALL      'SYEF10B'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
N01  C                   PARM                    ULOP
     C                   PARM                    XSTLF            15
     C                   PARM                    XKTLF            15
     C                   PARM                    XANRUT            1
     C                   PARM                    XFLYTM            1
     C                   PARM                    HØ
     C                   PARM                    LE
     C                   PARM                    BR
     C                   PARM                    AN
     C                   PARM                    XMSG             62
     C                   PARM                    UFLAGG
     c                   move      *blanks       WSAWB
     C                   END
     C*
     C*
     C* FLYFRAKTBREV som epost
     C*
     C     WSAWB         IFEQ      'E'
     c     harpdf        andeq     'J'
     c                   EXSR      EPOAWB
     c                   move      *blanks       WSAWB
     c                   end
     C*
      *
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C*
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C***********************************************
     C     ARCSR         BEGSR
     C***********************************************
     c     keyext        klist
     c                   kfld                    fifirm
     c                   kfld                    arcext
     C*
     C     arklagk       KLIST
     C                   KFLD                    fifirm
     C                   KFLD                    arklag
     C*
     c                   z-add     1             nr
     C*
     c                   setoff                                       34
      *
     c     keyark        setll     arkivl02
     c     *in(34)       doweq     '0'
     c     keyark        reade     arkivl02                               34
      *
      * avslutt
      *
     c     *in(34)       ifeq      '1'
     c     nr            oreq      5
     c                   goto      utarc
     c                   end
     c     artype        chain     ARKTXT                             33
      *
     C     ARKLAG        IFNE      *blanks
     c     arklagk       chain     arkext
     c                   else
     c     fifirm        chain     firmarc                            33
     c                   end
     c
      *
     c                   move      aravd         aavd              4
     c                   move      aropd         aopd              7
     C                   move      *blanks       updf
S02  c*                  movel     'http://'     updf             70
N02  c                   movel     'http://'     updf             76
     c     arinek        ifeq      'I'
     C     updf          CAT       arcpad:0      updf
     c                   else
     C     updf          CAT       arcpae:0      updf
     c                   end
     C     updf          CAT       '/':0         updf
     C     updf          CAT       arcane:0      updf
     C     updf          CAT       '/':0         updf
     C     updf          CAT       arlink:0      updf
S02  C*    '.pdf'        SCAN      updf                                   33
S02  C* N33'.PDF'        SCAN      updf                                   33
S02  C* N33'.'           SCAN      updf                                   33
N02  C     '.pdf'        SCAN      ARLINK                                 33
N02  C  N33'.PDF'        SCAN      ARLINK                                 33
N02  C  N33'.'           SCAN      ARLINK                                 33
     C     arklag        IFeq      *blanks
     C     *in33         andeq     '0'
     C     updf          CAT       '.pdf':0      updf
     C                   END
     c                   add       1             nr
     c                   movel     artxt         wa(nr)
     c                   movel     updf          wb(nr)
     c                   end
     C     utarc         ENDSR
     C***********************************************
     C     EPOAWB        BEGSR
     C***********************************************
     c                   movel     'Mail av AWB' AWBTX            40
     c                   MOVE      '*YES'        PDF               4
     c                   CALL      'EPOS06CL'
     C                   PARM                    AAVD
     C                   PARM                    AOPD
     c                   PARM                    AWBTX
     c                   PARM                    PDF
     C                   z-add     12            LINNBR
     C                   z-add     18            POSNBR
     c                   ENDSR
     C***********************************************
     C     EPOSAD        BEGSR
     C***********************************************
     C                   CALL      'FAX025B'
     C                   PARM                    SIAVD
     C                   PARM                    SITDN
     C*
     C                   z-add     5             LINNBR
     C                   z-add     18            POSNBR
     C                   ENDSR
     C***********************************************
     C     EPOSADE       BEGSR
     C***********************************************
     C                   CALL      'FAX025B'
     C                   PARM                    SEAVD
     C                   PARM                    SETDN
     C*
     C                   z-add     6             LINNBR
     C                   z-add     18            POSNBR
     C                   ENDSR
     C***********************************************
     C     EPOSTET       BEGSR
     C***********************************************
     C                   CALL      'FAX031CLAD'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C*
     C                   z-add     6             LINNBR
     C                   z-add     18            POSNBR
     C                   ENDSR
     C***********************************************
     C     epofra        begsr
     C***********************************************
n01  c                   move      'F'           dfri
     C                   Call      'FAX023B'
     C                   PARM                    DFRI
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   z-add     4             LINNBR
     C                   z-add     18            POSNBR
     C                   ENDSR
     C***********************************************
     C     eposcmr       begsr
     C***********************************************
     C                   Call      'FAX026A'
     C                   PARM                    DCAVD
     C                   PARM                    DCOPD
     C                   z-add     10            LINNBR
     C                   z-add     18            POSNBR
     C                   ENDSR
     C***********************************************
     C     init          begsr
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   MOVE      UAVD          KAVD              4 0
     C                   MOVE      UOPD          KOPD              7 0
     C                   MOVE      UAVD          AAVD              4
     C                   MOVE      UOPD          AOPD              7
     C                   READ      FIRM                                   33
     C                   MOVE      FIFIRM        UFIRM             2
     c                   move      'N'           HARPDF            1
     c                   move      'N'           HARARC            1
     C     FIFIRM        CHAIN     FIRMPDF                            33
     c  n33              move      'J'           HARPDF
     C     FIFIRM        CHAIN     FIRMARC                            33
     c  n33              move      'J'           HARARC
      *
      * GENERELL KEY
      *
     C     KEYGEN        KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KOPD
      *
      * TESTER STYKKGODSFRAKTBREV
      *
     C     KEY           KLIST
     C                   KFLD                    KKODE
     C                   KFLD                    KAVD
     C                   KFLD                    KOPD
      *
      * TESTER master samlast
      *
     C     KEYM          KLIST
     C                   KFLD                    MKODE
     C                   KFLD                    Mdest
     C                   KFLD                    mnr
      *
     C     KEYARK        KLIST
     C                   KFLD                    ASTAT
     C                   KFLD                    KAVD
     C                   KFLD                    KOPD
     C     KEYARK2       KLIST
     C                   KFLD                    ASTAT
     C                   KFLD                    KAVD
     C                   KFLD                    KOPD
      *
     c                   move      'I'           arinek
     c     uuser         chain     aruserf                            33
     c     keygen        chain     headf                              33
     C                   movel     hesaml        Mdest             3
     C                   move      hesaml        mnr               3 0
     C                   MOVE      'F'           KKODE             1
     C                   MOVE      'M'           MKODE             1
     c                   move      'N'           Flere             1
     c                   move      'A'           ASTAT             1
     C                   Z-ADD     1             NR                2 0
      *
      *
     c     key           setll     dokuf
     C     KEY           reade     DOKUF                                  70
     c  N70              do
      *
     c     key           reade     dokuf                                  33
     c  n33              move      'J'           flere
     c                   enddo
      *
      *
      *
      * TESTER TOLLDEK IMPORT
      *
     C     KEYGEN        CHAIN     SADH                               71
      *
      *
      *
      * TESTER TOLLDEK EXPORT
      *
     C     KEYGEN        CHAIN     SAEH                               72
      *
      *
      * TESTER TRANSITTERING
      *
     C     KEYGEN        CHAIN     SADTRH                             73
      *
      *
      * TESTER TRANSITTERING TET
      *
     C     KEYGEN        CHAIN     TRUH                               74
      *
      *
      * TESTER TVINNLOG
      *
     C     KEYGEN        CHAIN     EDIM2                              75
      *
      *
      * TESTER CMR-FRAKTBREV
      *
     C     KEYGEN        CHAIN     DOKEC                              76
      *
      *
      * TESTER BILLOFLADING  (enkel v land import)
      *
     C     KEYGEN        CHAIN     DOKEB                              77
      *
      *
      * TESTER FLYFRAKTBREV
      *
     C     KEY           CHAIN     DOKEF                              78
      *
      * TESTER billof lading sjømodul
      *
     C     KEYGEN        CHAIN     BILLOF                             79
      *
      * LEGGER UT LINJER MED TILLEGG TIL TOLLDEKLARASJONER
      *
      *
      * TESTER master samlast
      *
     C     KEYM          CHAIN     DOKEm                              34
      *
      * hent fra arkiv
      *
     C     HARARC        IFEQ      'J'
     C                   exsr      arcsr
     C                   END
     C                   ENDSR
     c*
     c*
