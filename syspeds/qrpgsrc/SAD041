********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 02 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10XXX * 03 YBC PTF10 NYTT PARAMETER FOR Å HÅNDTERE FEILDATO
********************************************************************
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE SAD-TRANSITT (HOVEDARK)     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05 06 08-11 15 16 18-23 25 26
      *** LEDIGE INDIKATORER 28 29 34 37-60 63-67
      ***        INDIKATOR   35 PÅ = SJØ-OPPDRAG
      ***        INDIKATOR   27 PÅ = MED STEMPEL
      ***********************************************************
      *
     FFRATXT    IF   E           K DISK
     FSADTRH    UF A E           K DISK
     FSADTRV    UF A E           K DISK
     FTARI      IF   E           K DISK
     FSTANDT    UF   E           K DISK
     FSADTRTB   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FDISP      IF   E           K DISK
     FSTED2D    IF   E           K DISK
     FTURER     IF   E           K DISK
     FUNIT      IF   E           K DISK
     FBILLOF    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   UF   E           K DISK
     FMULTKOD2  IF   E           K DISK
     FKODTA     IF   E           K DISK
     FSAD041FM  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  TUBILN                 1     10
     D  TUBIL8                 1      8
     D                 DS
     D  TUHENG                 1     10
     D  TUHEN8                 1      8
     D                 DS
     D  SEDDTÅ                 1      4  0
     D  SEDDTM                 5      6  0
     D  SEDDTD                 7      8  0
     D  SEDDT                  1      8  0
     D                 DS
     D  WSDDTD                 1      2  0
     D  WSDDTM                 3      4  0
     D  WSDDTÅ                 5      6  0
     D  WSDDT                  1      6  0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  SVTOPL                 1     45
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D                 DS
     D  WSVNT                  1      8  0
     D  WSVNT4                 1      4  0
      *
     C                   OPEN      SAD041FM
     C                   EXSR      INIT
      * VED ENDRING HOPPER TIL BILDE02 (HOVEDARK)
     C     UTYPE         IFEQ      'CHG'
     C     SATHK         CHAIN(N)  SADTRH                             33
     C                   MOVE      SEUR          WSUR
     C                   EXSR      TESTB1
     C                   GOTO      START2
     C                   END
      *
      * UIN05 ULIKE 1  -->  FRA TRANSPORTDESPONERING
     C     UIN05         IFNE      '1'
     C                   EXSR      SRU1
     C     USG           IFNE      *BLANKS
     C                   MOVE      USG           WSSG
     C                   ELSE
     C                   MOVE      HESG          WSSG
     C                   END
     C                   EXSR      MOVW2
     C*** TEST OM DET ER SJØ-OPPDRAG
     C     FIURBE        IFNE      'N'
     C     BILLK         CHAIN     BILLOF                             33
     C   33HEUR          IFEQ      'G'
     C                   MOVE      'G'           BLUR
     C                   MOVE      'G'           WSUR
     C                   ELSE
     C                   MOVE      *BLANKS       BLUR
     C                   END
     C     BLUR          COMP      'G'                                    35
     C                   ELSE
     C                   MOVE      *BLANKS       BLUR
     C                   SETOFF                                       35
     C                   END
     C                   GOTO      START2
     C                   END
      *...............................................
      * BILDE-1 INNLESING AV OPDNR./TARIFFØR OSV.
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C  N30
     CANN31              Z-ADD     5             LINNBR
     C  N30
     CAN 31              Z-ADD     9             LINNBR
     C  N30              Z-ADD     34            POSNBR
     C  N30WSSG          IFEQ      *BLANKS
     C                   Z-ADD     9             LINNBR
     C                   END
     C     FIURBE        COMP      'N'                                3535
     C                   EXFMT     BILDE01
     C                   MOVEA     '00'          *IN(98)
     C                   SETOFF                                       3095
      *
     C   12              GOTO      SLUTT
      *
     C                   EXSR      TESTB1
     C   30              GOTO      START
      *
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *ZEROS        SETDN
     C                   MOVE      *BLANKS       WSDTG
     C                   MOVE      *BLANKS       WSTLL
     C                   MOVE      *BLANKS       WSTLE
     C                   END
      *===============================================
      *
      *...............................................
      * BILDE-2 INNLESING AV HOVED OPPLYSNINGER AV SAD
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START2        TAG
     C  N30              Z-ADD     1             LINNBR
     C  N30
     CAN 35              Z-ADD     49            POSNBR
     C  N30
     CANN35              Z-ADD     55            POSNBR
     C     ST21          TAG
      *
     C                   EXSR      TSTOPL
      *
     C                   EXFMT     BILDE02
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000000'    *IN(68)
     C                   SETOFF                                       30
      *
     C                   TESTN                   WSVNTI               33
     C   33              MOVE      WSVNTI        WSVNT
     C  N33              MOVE      *ZEROS        WSVNT
      *
      *  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      ST21
     C                   END
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START2
     C                   END
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL BILDE01
     C   12              DO
     C     SATHK         CHAIN     SADTRH                             33
     C     XNYTDK        IFEQ      'N'
     C                   MOVE      ' '           SEST
     C                   END
     C  N33              UPDATE    SADTRHR
     C     UTYPE         IFEQ      'CR2'
     C                   MOVE      *ZEROS        WSTDN
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      SLUTT
     C                   END
     C                   END
      *
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START2
     C                   END
      *
     C   24              DO
     C                   EXSR      UTCMDL
     C                   GOTO      START2
     C                   END
      *
      * ----------- T E S T   B I L D E 0 2 ----------
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      *
      * ----- INGEN FEIL HITTIL  OPPDATER SADTRH -----
     C                   EXSR      OPDSAT
     C  N03
     CANN05              GOTO      START2
      * F3 = PRINT
     C   03              DO
     C                   Z-ADD     3             UFLAGG            1 0
     C                   CALL      'SAD041T'
     C                   PARM                    SEAVD
     C                   PARM                    SETDN
     C                   PARM                    UFLAGG
     C                   PARM                    UWS
     C                   GOTO      START3
     C                   END
      *
      *===============================================
      *
     C                   EXSR      TOSATV
     C   12              GOTO      START2
      *
     C     START3        TAG
     C     UTYPE         IFEQ      'CR2'
     C     *IN17         OREQ      '1'
     C                   MOVE      *ZEROS        WSTDN
     C  N03              DO
     C                   MOVE      *ZEROS        SETDN
     C                   MOVE      *ZEROS        SENTK
     C                   MOVE      *ZEROS        SEVKB
     C                   GOTO      START2
     C                   END
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C                   CLOSE     SAD041FM
      *                    SETON                     LR
     C                   RETURN
      *
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     2
     C     POSNBR        ANDLE     31
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNS
     C                   PARM                    WSNAS
     C                   PARM                    WSADS1
     C                   PARM                    WSADS2
     C                   PARM                    WSADS3
     C                   PARM                    ULKDUM            2
     C                   PARM                    UADRNR            5
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
S01  C*                  EXSR      SØKUNR
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNK
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAK
N01  C                   IF        WSKNK <> 0
N01  C                   EXSR      TESTKK
N01  C                   END
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
S01  C*                  EXSR      SØKUNR
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAS
N01  C                   IF        WSKNS <> 0
N01  C                   EXSR      TESTSS
N01  C                   END
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     26
S01  C*                  EXSR      SØKUNR
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAA
N01  C     WSKNA         IFNE      0
N01  C                   MOVE      WSKNA         KUNDNR
N01  C     KUND1K        CHAIN(N)  CUNDL01                            73
N01  C  N73              DO
N01  C                   MOVE      *BLANKS       WSADA3
N01  C                   MOVE      KNAVN         WSNAA
N01  C                   MOVE      ADR1          WSADA1
N01  C     POSTNR        IFEQ      0
N01  C                   MOVEL     ADR3          WSADA3
N01  C                   ELSE
N01  C                   MOVEL     POSTNR        WSADA3
N01  C                   MOVE      ADR3          WSADA3
N01  C                   END
N01  C                   ENDDO
N01  C                   END
     C                   Z-ADD     43            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKB
     C                   PARM                    USPED
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKM
     C                   PARM                    USPED
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKT
     C                   PARM                    USPED
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRM
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     5
     C     POSNBR        ANDLE     12
     C                   CALL      'SAD062A'
     C                   PARM                    WSVNTI
     C                   PARM                    USEDT
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKG1
     C                   PARM                    USPED
     C                   Z-ADD     56            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     66
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKG2
     C                   PARM                    USPED
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKG3
     C                   PARM                    USPED
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     43            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKG4
     C                   PARM                    USPED
     C                   Z-ADD     56            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     66
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKG5
     C                   PARM                    USPED
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKG6
     C                   PARM                    USPED
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTLKB
     C                   PARM                    USPED
     C                   Z-ADD     54            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK2        ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
      *** TEST OM DET ER SJØ-OPPDRAG
     C     FIURBE        IFNE      'N'
     C     BILLK         CHAIN     BILLOF                             33
     C   33              MOVE      WSUR          BLUR
     C     BLUR          COMP      'G'                                    35
     C                   ELSE
     C                   MOVE      *BLANKS       BLUR
     C                   SETOFF                                       35
     C                   END
      *** TEST AVDELING
     C     UAVD          CHAIN(N)  STANDT                             95
     C     *IN95         IFEQ      '0'
     C                   MOVE      *BLANKS       SEST
     C                   MOVE      *ZEROS        SETDN
     C     SECTNT        COMP      ' '                                2727
     C                   ELSE
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTB1
     C                   END
      *** TEST TARIFFØR
     C     KODSIK        CHAIN     KOSIR                              99
     C   99              DO
     C                   MOVE      'SPS0001'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END
      *
     C                   MOVE      'J'           XNYTDK            1
      *** TEST OM TASTET TOLLDEKNR. ER RIKTIG
      * WSTDN = 0  --> HENT STANDARD SAD-OPPLYSNINGER
     C     UTYPE         IFEQ      'CPY'                                        1<-B
     C     SATHKK        CHAIN(N)  SADTRH                             33
     C                   ELSE                                                   1
     C     WSTDN         IFNE      0                                             2<-B
     C     SATHK         CHAIN     SADTRH                             33
     C  N33SEST          IFNE      ' '                                            3<-B
     C     SEST          ANDNE     'K'
     C     SEST          ANDNE     'U'
     C     SEST          COMP      'P'                                9898
     C                   END                                                      3<-E
     C  N33
     CANN98SEWS          IFEQ      'A'                                            3<-B
     C     SEWS          COMP      UWS                                9898
     C                   END                                                      3<-E
     C  N33
     CANN98              MOVE      'E'           SEST
     C  N33              UPDATE    SADTRHR
     C  N33              MOVE      'N'           XNYTDK
     C   33HEADFK        CHAIN     HEADF                              98
      *
     C   98              DO                                                       3<-B
     C                   MOVE      'SPT0028'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *** HENT OPPLYSNINGER FRA HEADF/DOKUF
     C  N30
     CAN 33              MOVE      WSTDN         UTDN
     C  N30
     CAN 33              EXSR      SRU1
     C  N30
     CAN 33
     CAN 35              MOVE      'G'           BLUR
      *
      *** FLYTT DATA FRA FIL-VARIABLER TIL WS-VARIABLER
     C  N30              EXSR      MOVW2
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
      *
      *** TEST DEKLARASJONSTYPE
     C   35WSDTY         COMP      'FO'                               9999
     C   35
     CAN 99WSDTY         COMP      '  '                               9999
     C   99WSDTY         COMP      'EX'                               9999
      *
      *** TEST TRANSITTYPE
     C     WSDK          COMP      '  '                                   97
      *
      *** TEST AVSENDER
     C     WSKNK         IFNE      0
     C                   EXSR      TESTKK
     C                   END
     C  N96WSNAK         COMP      *BLANKS                                96
      *
      *** TEST ANTALL KOLLI
     C     WSNTK         COMP      0                                    9595
      *
      *** TRANSPORTMIDLETS IDENTITET OG NASJONALITET VED AVGANG/ANKOMST
     C     WSLKM         IFEQ      *BLANKS
     C                   GOTO      STTB20
     C                   END
     C                   MOVE      WSLKM         XLANDK
     C     KODS2K        CHAIN     KOS2R                              91
     C  N91WSFTM         COMP      *BLANKS                                91
     C     STTB20        TAG
      *
      *** TEST CONT.
     C     WSKDC         COMP      '0'                                9090
      * ENDRING PGA. SJØ-TOLLDEK.
     C   90WSKDC         COMP      '1'                                9090
      *
      *** TEST MOTTAKER
     C     WSKNS         IFNE      0
     C                   EXSR      TESTSS
     C                   END
     C  N88WSNAS         COMP      *BLANKS                                88
      *
      *** TRANSPORTMIDLETS IDENTITET OGNASJONALITET VED GRENSEPASSERING
     C                   MOVE      WSLKT         XLANDK
     C     KODS2K        CHAIN     KOS2R                              87
     C     WSTRID        COMP      *BLANKS                                86
      *
     C     STTB2         TAG
      *
      *** TEST TRANSPORTMÅTE
     C     WSTRM         IFGT      0
     C     KODS4K        CHAIN     KOS4R                              83
     C                   END
      *
      *** TEST HOVEDANSVARLIG
     C     WSKNA         IFEQ      0
     C     WSNAA         COMP      *BLANKS                                73
     C                   ELSE
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            73
     C  N73              DO
     C                   MOVE      *BLANKS       WSADA3
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSADA1
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSADA3
     C                   ELSE
     C                   MOVEL     POSTNR        WSADA3
     C                   MOVE      ADR3          WSADA3
     C                   END
     C                   END
     C                   END
      *
      *** TESTE OM INNTASTET TARIFFNR. ER RIKTIG.
     C     WSVNT         IFNE      0
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   85
     C     *IN85         DOWEQ     '0'
     C     TADATO        IFLE      USEDT
N02  C     TADTS         ANDEQ     0
N02  C     TADATO        ORLE      USEDT
N02  C     TADTS         ANDGE     USEDT
     C                   LEAVE
     C                   END
     C     TARIK         READPE    TARI                                   85
     C  N85              ENDDO
     C                   END
      *
     C     WSVKTB        IFEQ      0
     C     WSVKTN        IFNE      0
     C     WSVKTN        MULT(H)   1.1           WSVKTB
     C                   END
     C                   ELSE
     C     WSVKTN        IFEQ      0
     C     WSVKTB        MULT(H)   0.9           WSVKTN
     C                   END
     C                   END
      *
      *
      *** TEST TRANSITERINGSTOLLSTED
     C     WSSTG1        IFNE      *BLANKS
     C                   MOVE      WSLKG1        XLANDK
     C     KODS2K        CHAIN     KOS2R                              79
     C                   END
     C     WSSTG2        IFNE      *BLANKS
     C                   MOVE      WSLKG2        XLANDK
     C     KODS2K        CHAIN     KOS2R                              78
     C                   END
     C     WSSTG3        IFNE      *BLANKS
     C                   MOVE      WSLKG3        XLANDK
     C     KODS2K        CHAIN     KOS2R                              77
     C                   END
     C     WSSTG4        IFNE      *BLANKS
     C                   MOVE      WSLKG4        XLANDK
     C     KODS2K        CHAIN     KOS2R                              76
     C                   END
     C     WSSTG5        IFNE      *BLANKS
     C                   MOVE      WSLKG5        XLANDK
     C     KODS2K        CHAIN     KOS2R                              75
     C                   END
     C     WSSTG6        IFNE      *BLANKS
     C                   MOVE      WSLKG6        XLANDK
     C     KODS2K        CHAIN     KOS2R                              74
     C                   END
      *
      *** TEST BESTEMMELSESTOLLSTED OG LAND
     C     WSTSTB        IFNE      *BLANKS
     C                   MOVE      WSTLKB        XLANDK
     C     KODS2K        CHAIN     KOS2R                              72
     C                   END
      *
      * TEST TIDSFRIST (DATO)
     C     *IN27         IFEQ      '1'
     C     WSDDTD        ORNE      0
     C                   MOVE      WSDDTÅ        XÅR               2 0
     C                   MOVE      WSDDTM        XMND              2 0
     C                   MOVE      WSDDTD        XDAG              2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDAG
     C                   PARM                    XMND
     C                   PARM                    XÅR
     C                   PARM                    FLAGG             1 0
     C     FLAGG         COMP      1                                      80
     C                   END
      *
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
     C***********************************************
     C     HMSG          BEGSR
     C***********************************************
     C   99              DO
     C                   MOVE      'SPD0013'     MSGNR
     C                   Z-ADD     1             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   SETON                                        30
     C                   END
     C   97
     CANN30              DO
     C                   MOVE      'SPD0014'     MSGNR
     C                   Z-ADD     1             LINNBR
     C                   Z-ADD     55            POSNBR
     C                   SETON                                        30
     C                   END
     C   95
     CANN30              DO
     C                   MOVE      'SPN0003'     MSGNR
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     62            POSNBR
     C                   SETON                                        30
     C                   END
     C   96
     CANN30              DO
     C                   MOVE      'SPK0037'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETON                                        30
     C                   END
     C   91
     CANN30              DO
     C                   MOVE      'SPT0036'     MSGNR
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   SETON                                        30
     C                   END
     C   90
     CANN30              DO
     C                   MOVE      'SPK0041'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   SETON                                        30
     C                   END
     C   88
     CANN30              DO
     C                   MOVE      'SPK0038'     MSGNR
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETON                                        30
     C                   END
     C   87
     CANN30              DO
     C                   MOVE      'SPL0019'     MSGNR
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
     C   86
     CANN30              DO
     C                   MOVE      'YBC0206'     MSGNR
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     55            POSNBR
     C                   SETON                                        30
     C                   END
     C   83
     CANN30              DO
     C                   MOVE      'SPT0030'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
     C   85
     CANN30              DO
     C                   MOVE      'SPT0033'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   SETON                                        30
     C                   END
     C   73
     CANN30              DO
     C                   MOVE      'SPN0017'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETON                                        30
     C                   END
     C   79
     CANN30              DO
     C                   MOVE      'SPL0021'     MSGNR
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   SETON                                        30
     C                   END
     C   78
     CANN30              DO
     C                   MOVE      'SPL0022'     MSGNR
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     65            POSNBR
     C                   SETON                                        30
     C                   END
     C   77
     CANN30              DO
     C                   MOVE      'SPL0023'     MSGNR
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   SETON                                        30
     C                   END
     C   76
     CANN30              DO
     C                   MOVE      'SPL0024'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   SETON                                        30
     C                   END
     C   75
     CANN30              DO
     C                   MOVE      'SPL0025'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     65            POSNBR
     C                   SETON                                        30
     C                   END
     C   74
     CANN30              DO
     C                   MOVE      'SPL0026'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   SETON                                        30
     C                   END
     C   72
     CANN30              DO
     C                   MOVE      'SPL0027'     MSGNR
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
     C   70
     CANN30              DO
     C                   MOVE      'YBC0010'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   END
     C   69
     CANN30              DO
     C                   MOVE      'YBC0011'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   END
     C   80
     CANN30              DO
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     11            POSNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVW2         BEGSR
     C***********************************************
     C   35              MOVE      SEDTY         WSDTY
     C                   MOVE      SEDK          WSDK
     C                   MOVE      SELSTL        WSLSTL
     C                   MOVE      SEKNK         WSKNK
     C                   MOVE      SERG          WSRG
     C                   MOVE      SEVPOS        WSVPOS
     C                   MOVE      SENTK         WSNTK
     C                   MOVE      SENAK         WSNAK
     C                   MOVE      SEADK1        WSADK1
     C                   MOVE      SEVKB         WSVKB
     C                   MOVE      SELKAT        WSLKAT
     C                   MOVE      SEADK2        WSADK2
     C                   MOVE      SELKB         WSLKB
     C                   MOVE      SEFTB         WSFTB
     C                   MOVE      SEADK3        WSADK3
     C                   MOVE      SELKM         WSLKM
     C                   MOVE      SEFTM         WSFTM
     C                   MOVE      SEKNS         WSKNS
     C                   MOVE      SEKDC         WSKDC
     C                   MOVE      SENAS         WSNAS
     C                   MOVE      SELKT         WSLKT
     C                   MOVE      SETRID        WSTRID
     C                   MOVE      SEADS1        WSADS1
     C                   MOVE      SEADS2        WSADS2
     C                   MOVE      SEADS3        WSADS3
     C                   MOVE      SETRM         WSTRM
     C                   MOVE      SESTG1        WSSTG1
     C                   MOVE      SELKG1        WSLKG1
     C                   MOVE      SESTG2        WSSTG2
     C                   MOVE      SELKG2        WSLKG2
     C                   MOVE      SESTG3        WSSTG3
     C                   MOVE      SELKG3        WSLKG3
     C                   MOVE      SESTG4        WSSTG4
     C                   MOVE      SELKG4        WSLKG4
     C                   MOVE      SESTG5        WSSTG5
     C                   MOVE      SELKG5        WSLKG5
     C                   MOVE      SESTG6        WSSTG6
     C                   MOVE      SELKG6        WSLKG6
     C                   MOVE      SEKNA         WSKNA
     C                   MOVE      SENAA         WSNAA
     C                   MOVE      SEADA1        WSADA1
     C                   MOVE      SETLKB        WSTLKB
     C                   MOVE      SETSTB        WSTSTB
     C                   MOVE      SEADA3        WSADA3
     C                   MOVE      SEGFT1        WSGFT1
     C                   MOVE      SEGKD         WSGKD
     C                   MOVE      SEGFT2        WSGFT2
     C                   MOVE      SEDTG         WSDTG
     C                   MOVE      SETLL         WSTLL
     C                   MOVE      SETLE         WSTLE
     C                   MOVE      SECTN         WSCTN
     C                   MOVE      SEDFT1        WSDFT1
     C                   MOVE      SEDFT2        WSDFT2
     C                   MOVE      *ZEROS        WSDDT
      * TIDSFRIST (DATO) SKAL VÆRE 10 DAGER SENERE ENN DAGENSDATO
     C     SEDDTD        IFNE      0                                            1<-B
     C                   MOVE      SEDDTD        WSDDTD
     C                   MOVE      SEDDTM        WSDDTM
     C                   MOVE      SEDDTÅ        WSDDTÅ
     C                   END                                                    1<-E
     C   27SEDDTD        IFEQ      0                                            1<-B
     C                   MOVE      *ZEROS        UINNDT            6 0
     C                   Z-ADD     10            UANTDG            3 0
     C                   CALL      'SYFA20B'
     C                   PARM                    UINNDT
     C                   PARM                    UANTDG
     C     WSDDT         PARM                    UUTDT             6 0
N03  C                   PARM                    UFLAGG            1 0
     C                   END                                                    1<-E
      * HENTE STEMPEL
     C   27SECDS         IFEQ      *BLANKS                                      1<-B
     C     SECTNT        CHAIN     SADTRTB                            33
     C                   MOVE      STTDS         SECDS
     C                   MOVE      STTNV         SECNV
     C                   MOVE      STTAN         SECAN
     C                   MOVE      STTLK         SECLK
     C                   END                                                    1<-E
      *
     C                   MOVE      SECDS         WSCDS
     C                   MOVE      SECNV         WSCNV
     C                   MOVE      SECAN         WSCAN
     C                   MOVE      SECLK         WSCLK
      * TILBAKESENDES TIL
     C                   MOVE      SETS01        WSTS01
     C                   MOVE      SETS02        WSTS02
     C                   MOVE      SETS03        WSTS03
     C                   MOVE      SETS04        WSTS04
     C                   MOVE      SETS05        WSTS05
      *
     C     KODSIK        CHAIN     KOSIR                              33
     C     SETDN         IFEQ      0
     C     SESG          OREQ      *BLANKS
     C                   MOVE      WSSG          SESG
     C                   END
     C                   MOVE      KSINAV        SETARF
     C                   MOVE      UAVD          SEAVD
      *
      * HENTE 1. VARELINJE
     C     SADTVK        CHAIN(N)  SADTRV                             33
     C   33UTYPE         IFEQ      'CPY'
     C     KAVD          ANDNE     0
     C     SADTKK        CHAIN(N)  SADTRV                             33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      SVVNT         WSVNT
     C                   MOVE      SVVNT         WSVNTI
     C                   MOVE      SVVKTB        WSVKTB
     C                   MOVE      SVVKTN        WSVKTN
     C                   MOVE      SVNTM         WSNTM
     C                   MOVE      SVFT          WSFT
     C                   MOVE      SVNT          WSNT
     C                   MOVE      SVEH          WSEH
     C                   MOVE      SVVT          WSVT
     C                   MOVE      SVTOPL        WSTOPL
     C                   ELSE
     C                   MOVE      *ZEROS        WSVNT
     C                   MOVE      *BLANKS       WSVNTI
     C                   MOVE      *ZEROS        WSVKTB
     C                   MOVE      *ZEROS        WSVKTN
     C                   MOVE      *ZEROS        WSNTM
     C                   MOVE      *BLANKS       WSFT
     C                   MOVE      *ZEROS        WSNT
     C                   MOVE      *BLANKS       WSEH
     C                   MOVE      *BLANKS       WSVT
     C                   MOVE      *BLANKS       WSTOPL
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVSAT        BEGSR
     C***********************************************
     C   35              MOVE      WSDTY         SEDTY
     C  N35              MOVE      *BLANKS       SEDTY
     C                   MOVE      WSDK          SEDK
     C                   MOVE      WSKNS         SEKNS
     C                   MOVE      WSNAS         SENAS
     C                   MOVE      WSADS1        SEADS1
     C                   MOVE      WSADS2        SEADS2
     C                   MOVE      WSADS3        SEADS3
     C                   MOVE      WSNTK         SENTK
     C                   MOVE      WSVKB         SEVKB
     C                   MOVE      WSKDC         SEKDC
     C                   MOVE      WSLKAT        SELKAT
     C                   MOVE      WSKNK         SEKNK
     C                   MOVE      WSRG          SERG
     C                   MOVE      WSNAK         SENAK
     C                   MOVE      WSADK1        SEADK1
     C                   MOVE      WSADK2        SEADK2
     C                   MOVE      WSADK3        SEADK3
     C                   MOVE      WSTRID        SETRID
     C                   MOVE      WSLKT         SELKT
     C                   MOVE      WSVPOS        SEVPOS
     C                   MOVE      WSTRM         SETRM
     C                   MOVE      WSDTG         SEDTG
     C                   MOVE      WSTLL         SETLL
     C                   MOVE      WSTLE         SETLE
     C                   MOVE      WSSTG1        SESTG1
     C                   MOVE      WSLKG1        SELKG1
     C                   MOVE      WSSTG2        SESTG2
     C                   MOVE      WSLKG2        SELKG2
     C                   MOVE      WSSTG3        SESTG3
     C                   MOVE      WSLKG3        SELKG3
     C                   MOVE      WSSTG4        SESTG4
     C                   MOVE      WSLKG4        SELKG4
     C                   MOVE      WSSTG5        SESTG5
     C                   MOVE      WSLKG5        SELKG5
     C                   MOVE      WSSTG6        SESTG6
     C                   MOVE      WSLKG6        SELKG6
     C                   MOVE      WSKNA         SEKNA
     C                   MOVE      WSNAA         SENAA
     C                   MOVE      WSADA1        SEADA1
     C                   MOVE      WSADA3        SEADA3
     C                   MOVE      WSTSTB        SETSTB
     C                   MOVE      WSTLKB        SETLKB
     C                   MOVE      WSGKD         SEGKD
     C                   MOVE      WSGFT1        SEGFT1
     C                   MOVE      WSGFT2        SEGFT2
     C                   MOVE      WSFTB         SEFTB
     C                   MOVE      WSLKB         SELKB
     C                   MOVE      WSFTM         SEFTM
     C                   MOVE      WSLKM         SELKM
     C                   MOVE      KSINAV        SETARF
     C                   MOVE      WSLSTL        SELSTL
     C                   MOVE      UWS           SEWS
     C                   MOVE      WSCTN         SECTN
     C                   MOVE      WSDFT1        SEDFT1
     C                   MOVE      WSDFT2        SEDFT2
     C                   MOVE      WSDDTD        SEDDTD
     C                   MOVE      WSDDTM        SEDDTM
     C     WSDDTÅ        IFGT      50
     C     WSDDTÅ        ADD       1900          SEDDTÅ
     C                   ELSE
     C     WSDDTÅ        ADD       2000          SEDDTÅ
     C                   END
     C                   MOVE      WSCDS         SECDS
     C                   MOVE      WSCNV         SECNV
     C                   MOVE      WSCAN         SECAN
     C                   MOVE      WSCLK         SECLK
      * TILBAKESENDES TIL
     C                   MOVE      WSTS01        SETS01
     C                   MOVE      WSTS02        SETS02
     C                   MOVE      WSTS03        SETS03
     C                   MOVE      WSTS04        SETS04
     C                   MOVE      WSTS05        SETS05
      *
     C     SETDN         IFEQ      0
     C                   MOVE      WSSG          SESG
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTSS        BEGSR
     C***********************************************
     C                   MOVE      WSKNS         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            88
     C  N88              DO
     C                   MOVE      *BLANKS       WSADS3
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSADS1
     C                   MOVE      ADR2          WSADS2
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSADS3
     C                   ELSE
     C                   MOVEL     POSTNR        WSADS3
     C                   MOVE      ADR3          WSADS3
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTKK        BEGSR
     C***********************************************
     C                   MOVE      WSKNK         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            96
     C  N96
     CAN 13              MOVEL     WSRG          SYFORE
     C  N96              DO
     C                   UPDATE    KUNDR
     C     WSDTG         IFEQ      *BLANKS
     C     WSTLL         ANDEQ     *BLANKS
     C     WSTLE         ANDEQ     *BLANKS
     C                   GOTO      STTKK
     C                   END
     C     WSNAK         IFEQ      *BLANKS
     C     WSADK1        ANDEQ     *BLANKS
     C     WSADK2        ANDEQ     *BLANKS
     C     WSADK3        ANDEQ     *BLANKS
     C                   GOTO      STTKK
     C                   END
     C                   GOTO      SLTKK
     C     STTKK         TAG
     C                   MOVE      *BLANKS       WSADK3
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSADK1
     C                   MOVE      ADR2          WSADK2
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSADK3
     C                   ELSE
     C                   MOVEL     POSTNR        WSADK3
     C                   MOVE      ADR3          WSADK3
     C                   END
     C     SLTKK         TAG
     C                   TESTN                   SYFOR9               96
     C   96SYFOR9        COMP      *ZEROS                             9696
     C                   MOVE      *BLANKS       WSRG
     C   96              MOVEL     SYFORE        WSRG
     C  N96              MOVEL     SYREGN        WSRG
     C                   MOVE      '0'           *IN96
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSAT        BEGSR
     C***********************************************
     C     WSTDN         IFEQ      0
     C     UAVD          CHAIN     STANDT                             33
     C                   MOVE      SETDN         WSTDN
     C                   ADD       1             SETDN
     C                   UPDATE    STANDTR
     C                   END
      *
     C     SATHK         CHAIN     SADTRH                             33
     C  N33XNYTDK        IFEQ      'J'
     C                   UPDATE    SADTRHR
     C                   CLOSE     SAD041FM
     C                   RETURN
     C                   END
     C                   EXSR      MOVSAT
      *
     C                   MOVE      'E'           SEST
     C                   MOVE      BLUR          SEUR
     C   33              DO
     C                   MOVE      UAVD          SEAVD
     C                   MOVE      WSTDN         SETDN
     C                   MOVE      WSSG          SESG
     C                   MOVE      XLKA          SELKA
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           SEDT
     C                   WRITE     SADTRHR
     C                   MOVE      'N'           XNYTDK
     C                   END
     C  N33              UPDATE    SADTRHR
      *
      * OPPDATERE 1. VARELINJE
     C     SADTVK        CHAIN     SADTRV                             33
     C                   MOVE      WSVNT         SVVNT
     C                   MOVE      WSVKTB        SVVKTB
     C                   MOVE      WSVKTN        SVVKTN
     C                   MOVE      WSNTM         SVNTM
     C                   MOVE      WSFT          SVFT
     C                   MOVE      WSNT          SVNT
     C                   MOVE      WSEH          SVEH
     C                   MOVE      WSVT          SVVT
     C                   MOVE      WSTOPL        SVTOPL
     C     *IN33         IFEQ      '0'
     C                   UPDATE    SADTRVR
     C                   ELSE
     C                   MOVE      SEAVD         SVAVD
     C                   MOVE      SETDN         SVTDN
     C                   WRITE     SADTRVR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TOSATV        BEGSR
     C***********************************************
     C                   CALL      'SAD041A'
     C                   PARM                    SEAVD
     C                   PARM                    SETDN
     C                   PARM                    UWS
     C                   PARM      *IN35         UIN35             1
     C                   PARM                    UIN36
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   MOVE      '1'           *IN12
     C     SADTVK        CHAIN(N)  SADTRV                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      SVVNT         WSVNT
     C                   MOVE      SVVNT         WSVNTI
     C                   MOVE      SVVKTB        WSVKTB
     C                   MOVE      SVVKTN        WSVKTN
     C                   MOVE      SVNTM         WSNTM
     C                   MOVE      SVFT          WSFT
     C                   MOVE      SVNT          WSNT
     C                   MOVE      SVEH          WSEH
     C                   MOVE      SVVT          WSVT
     C                   MOVE      SVTOPL        WSTOPL
     C                   END
     C                   END
     C     UFLAGG        COMP      2                                      17
     C     UFLAGG        COMP      3                                      03
      *
     C                   ENDSR
      *
S01  C***********************************************
S01  C*    SØKUNR        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNK
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNS
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    WSKNA
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*    WSKNK         IFNE      0
S01  C*                  EXSR      TESTKK
S01  C*                  END
S01  C*    WSKNS         IFNE      0
S01  C*                  EXSR      TESTSS
S01  C*                  END
S01  C*    WSKNA         IFNE      0
S01  C*                  MOVE      WSKNA         KUNDNR
S01  C*    KUND1K        CHAIN(N)  CUNDL01                            73
S01  C* N73              DO
S01  C*                  MOVE      *BLANKS       WSADA3
S01  C*                  MOVE      KNAVN         WSNAA
S01  C*                  MOVE      ADR1          WSADA1
S01  C*    POSTNR        IFEQ      0
S01  C*                  MOVEL     ADR3          WSADA3
S01  C*                  ELSE
S01  C*                  MOVEL     POSTNR        WSADA3
S01  C*                  MOVE      ADR3          WSADA3
S01  C*                  END
S01  C*                  END
S01  C*                  END
S01   *
S01  C*                  ENDSR
S01   *
     C***********************************************
     C     SRU1          BEGSR
     C***********************************************
     C                   MOVE      UTDN          WSTDN
     C     SATHK         CHAIN     SADTRH                             98
     C  N98              MOVE      'E'           SEST
     C  N98              UPDATE    SADTRHR
     C  N98              GOTO      SLSRU
      *
      * HENT STANDARDVERDIER FOR AVDELING
     C     STANTK        CHAIN(N)  STANDT                             98
     C  N98              MOVE      *BLANKS       SEST
     C     BILLK         CHAIN     BILLOF                             98
     C   98              MOVE      *BLANKS       BLUR
      * HENT FRA LASTELISTE /TURER HVIS TRANSITTERING ER VALGT FRA TRANS-MOD
     C     UIN05         IFNE      '1'
     C                   EXSR      TURNR
     C                   GOTO      SLSRU
     C                   END
      * HENT FRA OPPDRAG
     C     HEADFK        CHAIN     HEADF                              98
     C                   MOVE      *ZEROS        WSTDN
      *
     C  N98WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          WSSG
     C                   END
     C     SETARF        IFEQ      *BLANKS
     C     KODSIK        CHAIN     KOSIR                              97
     C  N97              MOVE      KSINAV        SETARF
     C                   END
      *
      *** START N98
     C  N98              DO
      *
      *.................................................
      *** FLYTT DATA FRA HEADF TIL SADTRH
      ** MOTTAKER HENT NAVN/ADR FRA REGISTER - EVT FRA OPPDRAG
     C                   MOVE      HEKNK         SEKNS
     C                   MOVE      HEKNK         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'
     C                   MOVE      *ZEROS        SEKNS
     C                   MOVE      HENAK         SENAS
     C                   MOVE      HEADK1        SEADS1
     C                   MOVE      HEADK2        SEADS2
     C                   MOVE      HEADK3        SEADS3
     C                   ELSE
     C                   MOVE      KNAVN         SENAS
     C                   MOVE      ADR1          SEADS1
     C                   MOVE      ADR2          SEADS2
     C                   MOVE      *BLANKS       SEADS3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADS3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADS3
     C                   MOVE      ADR3          SEADS3
     C                   END
     C                   END
     C     HEUR          IFNE      'H'
     C                   MOVE      HELKA         SELKB
     C                   ELSE
     C                   MOVE      HETRI         SELKB
     C                   END
     C                   MOVE      *BLANKS       SEFTB
      *
     C                   MOVE      HEKNS         SEKNK
     C                   MOVE      HEKNS         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'
     C                   MOVE      *ZEROS        SEKNK
     C                   MOVE      *BLANKS       SERG
     C                   MOVE      HENAS         SENAK
     C                   MOVE      HEADS1        SEADK1
     C                   MOVE      HEADS2        SEADK2
     C                   MOVE      HEADS3        SEADK3
     C                   ELSE
     C                   MOVE      KNAVN         SENAK
     C                   MOVE      ADR1          SEADK1
     C                   MOVE      ADR2          SEADK2
     C                   MOVE      *BLANKS       SEADK3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADK3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADK3
     C                   MOVE      ADR3          SEADK3
     C                   TESTN                   SYFOR9               97
     C   97SYFOR9        COMP      *ZEROS                             9797
     C                   MOVE      *BLANKS       SERG
     C   97              MOVEL     SYFORE        SERG
     C  N97              MOVEL     SYREGN        SERG
     C                   END
     C                   END
      *
     C                   Z-ADD     HENT          SENTK
     C                   Z-ADD     HEVKT         SEVKB
     C                   MOVE      UTDN          WSTDN
     C     WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          SESG
     C                   END
      *
     C                   END
      *
     C     SLSRU         TAG
     C                   SETOFF                                       9897
      *
     C                   ENDSR
      *
     C***********************************************
     C     TURNR         BEGSR
     C***********************************************
     C                   MOVE      UAVD          DITUAV
     C                   Z-ADD     UANT          SENTK                           ANT KOLLI
     C                   MOVEL     'NORGE   '    SELKAT
     C     SYLAND        IFEQ      'DK'
     C                   MOVEL     'DANMARK'     SELKAT
     C                   END
     C     SYLAND        IFEQ      'NL'
     C                   MOVEL     'HOLLAND'     SELKAT
     C                   END
      *
     C     UIN05         IFEQ      'A'                                           T1-LISTE
     C     UIN05         OREQ      'C'                                           T1-SINGLE
     C                   MOVE      'T1'          SEDK
     C                   END
      *
     C     UIN05         IFEQ      'B'                                           T2-LISTE
     C     UIN05         OREQ      'D'                                           T2-SINGLE
     C                   MOVE      'T2'          SEDK
     C                   END
      *
     C     UIN05         IFEQ      'A'                                           *LISTE
     C     UIN05         OREQ      'B'
     C                   Z-ADD     1             SELSTL                          *ANT. LISTER
     C                   Z-ADD     UVPOS         SEVPOS                          *ANT VAREPOSTER
     C                   MOVEL     'DIVERSE'     SENAK
     C                   END
      *
     C     UIN05         IFEQ      'C'                                           *SINGLE
     C     UIN05         OREQ      'D'
     C                   Z-ADD     0             SELSTL                          *ANT LISTER
     C                   Z-ADD     UVKT          SEVKB                           *BRT. VEKT
     C     HEADFK        CHAIN     HEADF                              98
     C  N98              DO
      * (MOTTAKERFORTOLLING VED ENKELTPOSISJON - OVERSTYRES AV EVT- FORT.AGENT)
     C                   MOVE      HENAK         SENAS
     C                   MOVE      HEADK1        SEADS1
     C                   MOVE      HEADK2        SEADS2
     C                   MOVE      HEADK3        SEADS3
      * AVSENDER ENK-OPD.- VAREADRESSE (OVERSTYRES AV GITT KNR. SELGER)
     C                   MOVE      HENAS         SENAK
     C                   MOVE      HEADS1        SEADK1
     C                   MOVE      HEADS2        SEADK2
     C                   MOVE      HEADS3        SEADK3
      * GITT KUNDENR - AVSENDER- OVERSTYR VED LEV.ADR VED -ENKELT TDOK
     C     HEKNS         IFNE      *ZEROS
     C                   Z-ADD     HEKNS         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            98
     C  N98              DO
     C                   MOVE      *BLANKS       SEADK3
     C                   MOVE      KNAVN         SENAK
     C                   MOVE      ADR1          SEADK1
     C                   MOVE      ADR2          SEADK2
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADK3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADK3
     C                   MOVE      ADR3          SEADK3
     C                   END                                                    *POSTNR
     C                   END                                                    * END N98
     C                   END                                                    * HEKNS IFNE *ZEROS
      * ENK.T-PAPIR: ENDELIG FORT-LANDKODE: 2 FØRSTE AV DISP.SONE TIL
      *              BESTEMMELSESLAND     : 2 FØRSTE AV DISP.SONE TIL
      *              ENDELIG FORT-STED    : STEDSNAVN - TILSTED
     C     HEADFK        CHAIN     DISP                               98
      *
     C  N98              DO
     C                   MOVEL     DISONT        SELKB                           * BEST.LAND
      * ENDELIG TOLLSTED BLIR OVERSTYRT AV EVT AGENTENS LK/STED
     C                   MOVEL     DISONT        SETLKB                          * END. TOLLSTED
     C     LKBKEY        CHAIN     STED2D                             98         (LK+KODE)
     C  N98              MOVEL     ST2NVN        SETSTB                          * END. TOLLSTED
     C                   END                                                     *N98 DO
      *
     C                   END                                                     *N98
     C                   END                                                     *UIN05 C/D
      * HENT FRA EVT. TUR VED TRANSITT.
     C     TURERK        CHAIN     TURER                              98
     C   98              GOTO      ENDTUR
      * RUBR 18 - BILNR M.M. VED AVGANG
     C                   MOVEL     TULK          SELKM
     C                   MOVEL     TUBIL8        SEFTM                          (BIL/HENG. 8+8)
     C                   MOVE      TUHEN8        SEFTM                          (BIL/HENG. 8+8)
      * RUBR 21 - BILNR M.M. VED GRENSEPASS.
     C                   MOVEL     TULK          SELKT
     C                   MOVEL     TUBILN        SETRID
     C                   MOVE      TUTRMA        SETRM
     C                   MOVEL     TUTO1A        SESTG1
     C                   MOVEL     TUTO1B        SELKG1
      * DERSOM FORT.AGENT ER OPPGITT BENYTTES DENNE I RUBR. 8 (MM)
      * (BÅDE VED LISTE OG VED SINGLE)
     C     UKNFA         IFNE      *ZEROS
     C                   Z-ADD     UKNFA         KUNDNR
     C                   Z-ADD     UKNFA         SEKNS
     C     KUND1K        CHAIN(N)  CUNDL01                            98
     C  N98              DO
     C                   MOVE      *BLANKS       SEADS3
     C                   MOVE      KNAVN         SENAS
     C                   MOVE      ADR1          SEADS1
     C                   MOVE      ADR2          SEADS2
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADS3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADS3
     C                   MOVE      ADR3          SEADS3
     C                   END
      * ENDELIG TOLLSTED (R.53): 20 FØRSTE AV KPERS I FORTOLLINGSAGEN
     C                   MOVEL     KPERS         SETSTB
     C                   MOVEL     SYLAND        SETLKB
      * BESTEMMELSESLAND (R.17)                                        INGSAGEN
      * VED SINGLE TDOK ER R17 ALT GITT(TIL-LANDKODE PÅ OPPDRAG)
      * VED LISTE KAN EN KUN ANTA (HÅPE?) AT TURENS TIL-LANDKODE ER OK
     C     UIN05         IFNE      'C'
     C     UIN05         ANDNE     'D'
     C                   MOVEL     TUSONT        SELKB
     C                   END                                                    * END N98
     C                   END                                                    * END N98
      * AGENTNR GITT MEN FEIL....                                      N
     C   98              MOVE      *BLANKS       SETSTB
     C   98              MOVE      *BLANKS       SETLKB
     C   98              MOVE      *BLANKS       SELKB
     C                   END                                                    * UKNFA IFNE *ZEROS
      *
      * DEFAULT HOVEDANSVARLIG ER AVDELINGEN SELV
     C     KODTAK        CHAIN     KODTA                              98
     C  N98              MOVE      KOAKNR        SEKNA
     C  N98              MOVE      KOAKNR        KUNDNR
     C  N98KUND1K        CHAIN(N)  CUNDL01                            98
     C  N98              DO
     C                   MOVE      *BLANKS       SEADA3
     C                   MOVE      KNAVN         SENAA
     C                   MOVE      ADR1          SEADA1
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADA3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADA3
     C                   MOVE      ADR3          SEADA3
     C                   END
     C                   END
      * HENT OPP KLARTEKST - BESTEMMELSESLAND
     C                   MOVE      SELKB         XLANDK
     C     KODS2K        CHAIN     KOS2R                              98
     C  N98              MOVEL     KS2FTX        SEFTB
      *
      * GARANTIREFERANSE I UNITREG?? - I SÅ FALL GARANTIKODE 1
     C     UNITK         CHAIN     UNIT                               98
     C  N98              Z-ADD     1             SEGKD
     C  N98              MOVE      UNRETU        SEGFT1
     C     ENDTUR        ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYI            1
     C                   MOVE      'L'           DELSYI
     C     FRAT2K        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYB            1
     C     SATHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     SATHKK        KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KTDN
     C     SADTVK        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    SVLI
     C                   Z-ADD     1             SVLI
     C     SADTKK        KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KTDN
     C                   KFLD                    SVLI
     C     STANTK        KLIST
     C                   KFLD                    UAVD
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     TURERK        KLIST
     C                   KFLD                    DITUAV
     C                   KFLD                    UTUNR
     C     UNITK         KLIST
     C                   KFLD                    TUKNT2
     C                   KFLD                    TUBILN
     C     BILLK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODSIK        KLIST
     C                   KFLD                    XSIUNI
     C                   KFLD                    WSSG
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    XLANDK
     C     KODS4K        KLIST
     C                   KFLD                    XS4UNI
     C                   KFLD                    WSTRM
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C     LKBKEY        KLIST
     C                   KFLD                    SETLKB
     C                   KFLD                    DISTET
     C     TARIK         KLIST
     C                   KFLD                    WSVNT
     C                   KFLD                    TATAR
     C     TARIKM        KLIST
     C                   KFLD                    WSVNT
     C                   KFLD                    TATAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
      *
     C     *LIKE         DEFINE    SETDN         UTDN
     C     *LIKE         DEFINE    SESG          USG
     C     *LIKE         DEFINE    SEWS          UWS
     C     *LIKE         DEFINE    SECDS         WSCDS
     C     *LIKE         DEFINE    SECNV         WSCNV
     C     *LIKE         DEFINE    SECAN         WSCAN
     C     *LIKE         DEFINE    SECLK         WSCLK
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C     WSTDN         PARM      WSTDN         UTDN
     C     WSSG          PARM                    USG
     C                   PARM                    UTYPE             3
     C                   PARM                    UWS
      *** UIN05 = '1'   -> ORGINAL TRANSITT
      *** UIN05 = ANDRE -> TRANSITT FRA TRANSPORTDESPORNERING
     C                   PARM                    UIN05             1
      * PARAMETRE NÅR FRA TRANISTERINGSLISTE
     C                   PARM                    UUSG              3
     C                   PARM                    UTUAVD            4 0
     C                   PARM                    UTUOPD            7 0
     C                   PARM                    UTUNR             8 0
     C                   PARM                    UVPOS             7 0
     C                   PARM                    UANT              7 0
     C                   PARM                    UVKT              9 0
     C                   PARM                    UKNFA             8 0
      *
     C     UTYPE         IFEQ      'PRT'
     C     SATHK         CHAIN     SADTRH                             31
     C  N31              DO
     C                   MOVE      UWS           SEWS
     C                   MOVE      'K'           SEST
     C                   UPDATE    SADTRHR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   END
     C     UTYPE         COMP      'CHG'                                  31
     C     UTYPE         COMP      'CHG'                                  32
     C  N32UTYPE         COMP      'CPY'                                  32
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          KAVD              4 0
     C                   MOVE      WSTDN         KTDN              7 0
     C                   MOVE      *ZEROS        WSTDN
     C                   END
      *
     C     UIN05         IFNE      '1'                                           FRA TRANSP.MODUL
     C                   Z-ADD     UTUOPD        UTDN
     C                   Z-ADD     UTUAVD        UAVD
     C                   MOVE      UUSG          USG
     C                   MOVE      'SI'          XSIUNI            2
     C                   MOVE      USG           WSSG
     C     KODSIK        CHAIN     KOSIR                              33
     C                   END
      *
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        KUNDNR            8 0
     C                   MOVE      'SI'          XSIUNI            2
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      *BLANKS       XLANDK            2
     C                   MOVE      'S4 '         XS4UNI            3
     C                   MOVE      'N'           USPED             1
      *
      *** AVSENDER-/UTFØRSELSLAND
      *
S01  C*                  Z-ADD     3             SOANTK            1 0
S01  C*                  MOVE      'AVSENDER'    SOTXT1            8
S01  C*                  MOVE      'MOTTAKER'    SOTXT2            8
S01  C*                  MOVE      'H-ANSVAR'    SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C     *LIKE         DEFINE    *IN12         WIN03
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      SYLAND        XLKA              2
     C                   EXSR      UTCMDL
     C     UAVD          SETLL     BILLOF
     C     UAVD          READE     BILLOF                                 33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'G'           WSUR
     C                   ELSE
     C                   MOVE      ' '           WSUR
     C                   END
     C     HEADFK        SETLL     HEADF
     C                   READ      HEADF                                  36
     C                   MOVE      *IN36         UIN36             1
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           USEDT             8 0
      *
     C                   ENDSR
      *
     C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * AVSENDER   ...
     C     POSNBR        IFGE      13
     C     POSNBR        ANDLE     20
     C     LINNBR        ANDEQ     2
     C     WSKNK         ANDGT     0
     C                   MOVE      WSKNK         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
      * MOTTAGER   ...
     C     WSKNS         IFGT      0
     C                   MOVE      WSKNS         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
      *
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR            8 0
     C                   PARM                    XSKMOT            8
     C                   PARM                    UFLAGG
     C                   PARM                    DELSYI
      *
     C     SLVISO        ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   SETOFF                                       6162
      *** TEST OM SELGER OPPLYSNING. HVIS DET, SETT 61 PÅ
     C                   MOVE      WSKNS         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        61
      *
      *** TEST OM KJØPER OPPLYSNING. HVIS DET, SETT 62 PÅ
     C                   MOVE      WSKNK         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        62
      *
     C                   ENDSR
      *
     C***********************************************
     C     UTCMDL        BEGSR
     C***********************************************
     C     XCMD          IFEQ      0
     C                   MOVE      'YBC0456'     MSGLN1
     C                   MOVE      'DIV0032'     MSGLN2
     C                   MOVE      'YBC0457'     MSGLN3
     C                   MOVE      'DIV0029'     MSGLN4
     C                   ADD       1             XCMD              2 0
     C                   ELSE
     C     XCMD          IFEQ      1
     C                   MOVE      'DIV0024'     MSGLN1
     C                   MOVE      'YBC0458'     MSGLN2
     C                   MOVE      'SHU0433'     MSGLN3
     C  N36              ADD       1             XCMD
     C   36              Z-ADD     0             XCMD
     C                   ELSE
     C                   MOVE      'DIV0033'     MSGLN1
     C                   MOVE      'DIV0000'     MSGLN2
     C                   MOVE      'DIV0000'     MSGLN3
     C                   Z-ADD     0             XCMD
     C                   END
     C                   END
      *
     C                   ENDSR
      *
