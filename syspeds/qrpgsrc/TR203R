     FEDIM2     UF   E           K DISK
     FEDIS      UF   E           K DISK
     FTRUH09    UF   E           K DISK
     FTRUHFR    UF   E           K DISK
     FTRUHFS    UF   E           K DISK
     FTRUHGB    UF   E           K DISK
     FTRUHGN    UF   E           K DISK
     FTRUHK     UF   E           K DISK
     FTRUHL     UF   E           K DISK
     FTRUV      UF   E           K DISK
     FTRUVAM    UF   E           K DISK
     FTRUVCN    UF   E           K DISK
     FTRUVDK    UF   E           K DISK
     FTRUVFS    UF   E           K DISK
     FTRUVMN    UF   E           K DISK
     FTRUVTD    UF   E           K DISK
     FTRUVVT    UF   E           K DISK
     FTRUERR    UF   E           K DISK
     FTVINF     UF   E           K DISK
      *
     D                 DS
     D  XDT2                   1      6  0
     D  XD                     1      2  0
     D  XM                     3      4  0
     D  XÅ                     5      6  0
     D                 DS
     D  WDT                    1      8  0
     D  WÅ                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
      *
     C                   EXSR      INIT
      *
      *__________________________________________
      * SETLL, READ AND DELETE RECORDS FROM SADHD
      *""""""""""""""""""""""""""""""""""""""""""
     C     THDT          SETLL     TRUH09
     C                   READ      TRUH09                                 51
     C  N51THDT          COMP      WDT                                51
     C                   DOW       *IN51 = *OFF
     C                   IF        ((XAVD = 0) OR (THAVD = XAVD))
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EXSR      SRC
     C                   IF        XDLT = 'J'
     C                   EXSR      SRD
     C                   END
     C                   DELETE    TRUHR
     C                   END
     C                   READ      TRUH09                                 51
     C  N51THDT          COMP      WDT                                51
     C  N51              END
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      *___________________________________________
      * SETLL, READ AND DELETE RECORDS FROM TRUH??
      *"""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
      * TRUHFR
     C     TRUH09K       SETLL     TRUHFR
     C     TRUH09K       READE     TRUHFR                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUHFRR
     C     TRUH09K       READE     TRUHFR                                 52
     C                   ENDDO
      * TRUHFS
     C     TRUH09K       SETLL     TRUHFS
     C     TRUH09K       READE     TRUHFS                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUHFSR
     C     TRUH09K       READE     TRUHFS                                 52
     C                   ENDDO
      * TRUHGB
     C     TRUH09K       SETLL     TRUHGB
     C     TRUH09K       READE     TRUHGB                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUHGBR
     C     TRUH09K       READE     TRUHGB                                 52
     C                   ENDDO
      * TRUHGN
     C     TRUH09K       SETLL     TRUHGN
     C     TRUH09K       READE     TRUHGN                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUHGNR
     C     TRUH09K       READE     TRUHGN                                 52
     C                   ENDDO
      * TRUHK
     C     TRUH09K       SETLL     TRUHK
     C     TRUH09K       READE     TRUHK                                  52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUHKR
     C     TRUH09K       READE     TRUHK                                  52
     C                   ENDDO
      * TRUHL
     C     TRUH09K       SETLL     TRUHL
     C     TRUH09K       READE     TRUHL                                  52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUHLR
     C     TRUH09K       READE     TRUHL                                  52
     C                   ENDDO
      *
     C                   ENDSR
      *___________________________________________
      * SETLL, READ AND DELETE RECORDS FROM TRUV??
      *"""""""""""""""""""""""""""""""""""""""""""
     C     SRB           BEGSR
      * TRUVAM
     C     TRUH09K       SETLL     TRUVAM
     C     TRUH09K       READE     TRUVAM                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVAMR
     C     TRUH09K       READE     TRUVAM                                 52
     C                   ENDDO
      * TRUVCN
     C     TRUH09K       SETLL     TRUVCN
     C     TRUH09K       READE     TRUVCN                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVCNR
     C     TRUH09K       READE     TRUVCN                                 52
     C                   ENDDO
      * TRUVDK
     C     TRUH09K       SETLL     TRUVDK
     C     TRUH09K       READE     TRUVDK                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVDKR
     C     TRUH09K       READE     TRUVDK                                 52
     C                   ENDDO
      * TRUVFS
     C     TRUH09K       SETLL     TRUVFS
     C     TRUH09K       READE     TRUVFS                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVFSR
     C     TRUH09K       READE     TRUVFS                                 52
     C                   ENDDO
      * TRUVMN
     C     TRUH09K       SETLL     TRUVMN
     C     TRUH09K       READE     TRUVMN                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVMNR
     C     TRUH09K       READE     TRUVMN                                 52
     C                   ENDDO
      * TRUVTD
     C     TRUH09K       SETLL     TRUVTD
     C     TRUH09K       READE     TRUVTD                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVTDR
     C     TRUH09K       READE     TRUVTD                                 52
     C                   ENDDO
      * TRUVVT
     C     TRUH09K       SETLL     TRUVVT
     C     TRUH09K       READE     TRUVVT                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVVTR
     C     TRUH09K       READE     TRUVVT                                 52
     C                   ENDDO
      * TRUV
     C     TRUH09K       SETLL     TRUV
     C     TRUH09K       READE     TRUV                                   52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUVR
     C     TRUH09K       READE     TRUV                                   52
     C                   ENDDO
      *
     C                   ENDSR
      *___________________________________________
      * SETLL, READ AND DELETE RECORDS FROM TRUERR
      *"""""""""""""""""""""""""""""""""""""""""""
     C     SRC           BEGSR
     C     'O'           SETLL     TRUERR
     C     'O'           READE     TRUERR                                 52
     C                   DOW       *IN52 = *OFF
     C                   DELETE    TRUERRR
     C     'O'           READE     TRUERR                                 52
     C                   END
      *
     C                   ENDSR
      *_____________________________________________________
      * SETLL, READ AND DELETE RECORDS FROM EDIM2/EDIS/TVINF
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C     TRUH09K       SETLL     EDIM2
     C     TRUH09K       READE     EDIM2                                  52
     C                   DOW       *IN52 = *OFF
     C                   IF        M1001 = 'TET'
     C     MMN           SETLL     TVINF
     C     MMN           READE     TVINF                                  53
     C                   DOW       *IN53 = *OFF
     C                   DELETE    TVINFF
     C     MMN           READE     TVINF                                  53
     C                   END
     C     MSN           CHAIN     EDIS                               53
     C  N53              DELETE    EDISR
     C                   DELETE    EDIMR
     C                   ELSE
     C                   UPDATE    EDIMR
     C                   END
     C     TRUH09K       READE     EDIM2                                  52
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     TRUH09K       KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
      *_______________
      * PARAMETER LIST
      *"""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    XAVD
     C     XDT2          PARM                    XDT
     C                   PARM                    XDLT              1
      *____________
      * WORK FIELDS
      *""""""""""""
     C     *LIKE         DEFINE    THAVD         XAVD
     C     *LIKE         DEFINE    XDT2          XDT
      *____________
      * INIT FIELDS
      *""""""""""""
     C                   Z-ADD     XÅ            WÅ
     C                   Z-ADD     XM            WM
     C                   Z-ADD     XD            WD
     C                   IF        XÅ > 50
     C                   MOVEL     '19'          WÅ
     C                   ELSE
     C                   MOVEL     '20'          WÅ
     C                   ENDIF
      *
     C                   ENDSR
      *
