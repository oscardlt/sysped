********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 YBC PTF12 Ekstern ref. er ikke initiert før bruk.
12XXX * 02 YBC PTF12 Vis antall kolli og oppdrag pr HouseConsignment
12XXX * 03 YBC PTF12 Lengde på ref. i transitionsperiod er max 35
12XXX * 04 YBC PTF12 Blank bestemmelseland hvis den er på master/house
12307 * 05 CB  PTF12 Ikke krav til bestemmelseslandkode
      *              Lagt til mottaker
12313 * 06 CB  PTF12 Feil feilmelding vedr. vekter
12330 * 07 CB  PTF12 Ikke skriv til NCTSEIAM hvis TINAK er blank
12341 * 08 CB  PTF12 Fjern muligheten for reg av mottaker i PostT
12345 * 09 CB  PTF12 Test at AV/BE.LK og UCR-ref er blanke hvis de finnes på höyere nivå
XXXXX * 10 CB  PTF12 Ryddet vekk overgangsregler og adresser
12358 * 11 CB  PTF12 Enten både bruttovekt og antall kolli eller ingen av delene
      *              Ikke beregn bruttovekt automatiskt med netto som grunnlag
12366 * 12 CB  PTF12 UN-nr. må väre blankt eller kun siffer
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED EL.TRANSITTERING (Items)      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 09-11 13-16 18 20 23 24
      *** LEDIGE INDIKATORER 32 49-51 95-97
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.      ***
      ***   OG DEFINERES I PROGRAM                               ***
      **************************************************************
      *
     FSYPTFF    IF   E           K DISK
     FNCTSEH    IF   E           K DISK
     FNCTSEC    IF   E           K DISK
     FNCTSEI    UF A E           K DISK
     FTRKODL01  IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FTARI      IF   E           K DISK
     FNCTS013D  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     SFILE(SUBFIL2:ZRECN2)
     F                                     INFDS(FBAREA)
     D LI2             S              5  0 DIM(200)
N12  D WPOS            S              2  0
      *
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  W2CCH8                 1      8  0
     D  W2CCH                  1      6  0
     D                 DS
     D  TICCH8                 1      8  0
     D  TICCH                  1      6  0
     D                 DS
     D  W2CTX60                1     60
     D  W2CTX                  1    120
     D                 DS
     D  TICTX30                1     30
     D  TICTX60                1     60
     D  TICTX                  1    120
     D                 DS
     D  W2PMRK70               1     70
     D  W2PMRK                 1    120
     D                 DS
     D  TIPMRK70               1     70
     D  TIPMRK                 1    120
     D                 DS
     D  W2AITX70               1     70
     D  W2AITX                 1    120
     D                 DS
     D  TIAITX70               1     70
     D  TIAITX                 1    120
     D                 DS
     D  TIPDRF                 1     70
     D  TIPDRF_20              1     20
     D                 DS
     D  TIXEXT                 1     35
     D  TIXEXT_15              1     15
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI2
     C                   MOVE      *ZEROS        XLI2
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     NCTSEIK2      SETLL     NCTSEI
     C     START1        TAG
     C     NCTSECK       READE(N)  NCTSEI                                 94
     C  N94              MOVE      TILI2         W3LI2
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C                   DOW       *IN94 = *OFF
     C                   ADD       1             ZRECNO
     C                   MOVE      TILI2         XLI2              5 0
     C                   WRITE     SUBFIL
     C     NCTSECK       READE(N)  NCTSEI                                 94
     C  N94              MOVE      TILI2         W3LI2
     C  N94              ENDDO
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     ZRECNO        IFGT      1
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
N02  C                   IF        ULI = 0
N02  C                   EVAL      WSTOTNT = 0
N02  C                   EVAL      WSTOTOP = 0
N02  C                   ELSE
N02  C                   CALL      'NCTS013RA'
N02  C                   PARM                    UAVD
N02  C                   PARM                    UTDN
N02  C                   PARM                    ULI
N02  C                   PARM                    WSTOTNT
N02  C                   PARM                    WSTOTOP
N02  C                   END
N02   *
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      ***
      *
     C                   SETOFF                                       989930
      *
      *** F03 PÅ ---> AVBRYTTE SPØRRING
     C   03              MOVE      *ZEROS        UFLAGG
     C   03              GOTO      SLUTT
      *** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
      *** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              GOTO      START
      *** F6  ---> LAGE NYE DETALJE LINJER
     C   06              GOTO      START5
      *** F8  ---> VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C   08              GOTO      START7
      *
      *** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94NCTSEIK       SETLL     NCTSEI
     C  N94NCTSECK       READE(N)  NCTSEI                                 94
     C                   GOTO      START2
     C                   END
      *
      *** SJEKKE OM BRUKER HAR VALGT OPSJONER. HIVS SÅ,T UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   END
      *** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
      ***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
      *** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
      ***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
      *
      *** LAGE NYE DETALJE LINJER
     C     START5        TAG
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   EXSR      MOVB2
N01  C   06              CLEAR                   NCTSEIR
      *
     C     START6        TAG
     C  N30W2LI2         IFGT      0
     C                   EXSR      TSTOPL
     C                   END
     C                   EXFMT     VARELI
     C                   MOVEA     '000000000000'*IN(79)
     C                   MOVEA     '0000000000'  *IN(69)
     C                   MOVE      '0'           *IN30
      *
      *** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      START6
     C                   END
      *
     C   12W2LI2         IFGT      0
     C                   EXSR      DLTOPL
     C                   END
      *
      *** F12 --> AVBRYTTE REGISTRERING AV NYE DETALJE LINJER.
     C  N12              DO
      *** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
      *** FEILMELDING.
     C                   EXSR      TESTB1
     C   30              GOTO      START6
      *
     C     W2LI2         IFEQ      0
     C                   ADD       1             XLI2
     C                   MOVE      XLI2          W2LI2
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      START6
     C                   END
      *
      *** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDNCTSI
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
      *** VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
      *** 31 PÅ    ---> SORTERE PÅ TARIFFNR. + STATUS       (TRUV02)
      *** 31 AV    ---> SORTERE PÅ REGISTRERINGS REKKEFØLGE (TRUV)
     C     START7        TAG
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C                   MOVE      W3LI2         W3LIGM            5 0
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *
     C     W2DK          IFNE      *BLANKS
     C                   MOVE      '031'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2DK          YKODE
     C     TRK01K        CHAIN     TRKODL01                           90
     C     *IN90         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0809'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   IF        W2ALK <> *BLANKS
     C                   MOVE      W2ALK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             89
     C     *IN89         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     25            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
N09  C                   IF        *IN30=*OFF
N09  C     THALK         IFNE      *BLANKS
N09  C     TCALK         ORNE      *BLANKS
N09  C                   Z-ADD     2             LINNBR
N09  C                   Z-ADD     25            POSNBR
N09  C                   MOVE      'YBC2299'     MSGNR
N09  C                   MOVE      '1'           *IN30
N09  C                   ENDIF
N09  C                   ENDIF
     C                   END
      *
S09  C*                  IF        THBLK <> *BLANKS
S09  C*                  EVAL      W2BLK = *BLANKS
S09  C*                  END
     C                   IF        W2BLK <> *BLANKS
     C                   MOVE      W2BLK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             88
     C     *IN88         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     37            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
N09  C                   IF        *IN30=*OFF
N09  C     THBLK         IFNE      *BLANKS
N09  C     TCBLK         ORNE      *BLANKS
N09  C                   Z-ADD     2             LINNBR
N09  C                   Z-ADD     37            POSNBR
N09  C                   MOVE      'YBC2297'     MSGNR
N09  C                   MOVE      '1'           *IN30
N09  C                   ENDIF
N09  C                   ENDIF
     C                   END
N09  C                   IF        *IN30=*OFF
N09  C     W2UCR         IFNE      *BLANKS
N09  C     THUCR         IFNE      *BLANKS
N09  C     TCUCR         ORNE      *BLANKS
N09  C                   Z-ADD     2             LINNBR
N09  C                   Z-ADD     49            POSNBR
N09  C                   MOVE      'YBC2298'     MSGNR
N09  C                   MOVE      '1'           *IN30
N09  C                   ENDIF
N09  C                   ENDIF
N09  C                   ENDIF
      *
     C                   TESTN                   W2CCHI               33
     C                   MOVE      *ZEROS        W2VNT             8 0
     C   33              MOVEL     W2CCHI        W2VNT
     C   33              MOVE      W2VNT         W2VNT_M           8 0
     C   33              MOVE      '99'          W2VNT_M
      *
     C     W2VNT         IFNE      0
     C     W2VNT         SETLL     TARI
     C                   READ      TARI                                   33
     C  N33W2VNT_M       COMP      TATANR                               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      '1'           *IN87
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SPT0033'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2CTX         COMP      *BLANKS                                86
     C     *IN86         IFEQ      '1'
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      'YBC0840'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * 123456789012345678901234567890123456789012345678901234567890123456789012345678
      * Br.vekt og Kolli må begge ha en verdi eller begge må være null.
N11   * Regn ut nettovekt automatisk når den mangler.
N11  C     W2VKN         IFEQ      0
N11  C     W2VKB         MULT(H)   0.9           W2VKN
N11  C                   ENDIF
N11   * Bruttovekt må väre utfyllt når ant.kll er over null
N11  C     W2VKB         IFEQ      0
N11  C     W2PNT         IFGT      0
N11  C                   Z-ADD     4             LINNBR
N11  C                   Z-ADD     10            POSNBR
N11  C                   MOVE      'SPV0002'     MSGNR
N11  C                   EVAL      *IN30=*ON
N11  C                   ENDIF
N11  C                   ENDIF
N11   * Ant.kll må väre utfyllt når bruttovekt er over null
N11  C     W2VKB         IFGT      0
N11  C     W2PNT         IFEQ      0
N11  C                   Z-ADD     4             LINNBR
N11  C                   Z-ADD     63            POSNBR
N11  C                   MOVE      'SPV0002'     MSGNR
N11  C                   EVAL      *IN30=*ON
N11  C                   ENDIF
N11  C                   ENDIF
N11   *
S11  C*                  SELECT
S11  C*    W2VKB         WHENNE    0
S11  C*    W2VKN         IFEQ      0
S11  C*    W2VKB         MULT(H)   0.9           W2VKN
S11  C*                  END
S11  C*    W2VKN         WHENNE    0
S11  C*    W2VKB         IFEQ      0
S11  C*    W2VKN         MULT(H)   1.1           W2VKB
S11  C*                  END
S11  C*                  OTHER
S11  C*                  MOVE      '1'           *IN84
S11  C*    *IN30         IFEQ      '0'
S11  C*    W2PNT         ANDGT     0
S11  C*                  Z-ADD     4             LINNBR
S11  C*                  Z-ADD     10            POSNBR
S06  C*                  MOVE      'SPV0001'     MSGNR
S11  C*                  MOVE      'SPV0002'     MSGNR
S11  C*                  MOVE      '1'           *IN30
S11  C*                  END
S11  C*                  ENDSL
      *
     C     W2PTY         IFNE      *BLANKS
     C     W2PTY         ANDNE     'NE'
     C     W2PTY         ANDNE     'NF'
     C     W2PTY         ANDNE     'NG'
     C     W2PTY         ANDNE     'VQ'
     C     W2PTY         ANDNE     'VG'
     C     W2PTY         ANDNE     'VL'
     C     W2PTY         ANDNE     'VY'
     C     W2PTY         ANDNE     'VR'
     C     W2PTY         ANDNE     'VO'
     C     W2PTY         ANDNE     'VS'
     C     W2PMRK        IFEQ      *BLANKS
     C                   MOVEL     'ADR.'        W2PMRK
     C                   END
     C                   END
      *
     C*    W2PTY         IFNE      *BLANKS
     C                   MOVE      '017'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2PTY         YKODE
     C     TRK01K        CHAIN     TRKODL01                           83
     C     *IN83         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     54            POSNBR
     C                   MOVE      'YBC0816'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C*                  END
      *
     C     W2PTY         IFEQ      'NE'
     C     W2PTY         OREQ      'NF'
     C     W2PTY         OREQ      'NG'
     C     W2PTY         OREQ      'VQ'
     C     W2PTY         OREQ      'VG'
     C     W2PTY         OREQ      'VL'
     C     W2PTY         OREQ      'VY'
     C     W2PTY         OREQ      'VR'
     C     W2PTY         OREQ      'VO'
     C     W2PTY         OREQ      'VS'
     C                   MOVE      *ZEROS        W2PNT
     C                   END
      *
     C     W2PTY         IFEQ      'NE'
     C     W2PTY         OREQ      'NF'
     C     W2PTY         OREQ      'NG'
     C     W2NTS         COMP      0                                      82
     C     *IN82         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     78            POSNBR
     C                   MOVE      'YBC0825'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        W2NTS
     C                   END
N12   * Test UN-nr.
N12   /free
N12    if w2unnr <> *blanks;
N12      wpos = %check( '0123456789' : w2unnr );
N12        if wpos > *zero;
N12          linnbr=5;
N12          posnbr=90;
N12          msgnr='CBA0540';
N12          *in30=*on;
N12        endif;
N12    endif;
N12   /end-free
      *
     C     W2PDTY        IFNE      *BLANKS
     C     W2PDRF        ORNE      *BLANKS
     C                   IF        THDK = 'T2' OR THDK = 'T2F'
     C                             OR TCDK = 'T2' OR TCDK = 'T2F'
     C                             OR W2DK = 'T2' OR W2DK = 'T2F'
     C                   MOVE      '178'         YUNIK
     C                   ELSE
     C                   MOVE      '214'         YUNIK
     C                   END
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2PDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           81
     C     *IN81         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2PDRF        COMP      *BLANKS                                80
N03  C  N80              IF        %SUBST(W2PDRF:36:35) <> *BLANKS
N03  C                   EVAL      *IN80 = *ON
N03  C                   END
     C     *IN80         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     16            POSNBR
S03  C*                  MOVE      'YBC0823'     MSGNR
N03  C                   MOVE      'YBC2291'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2PDTP        IFNE      *BLANKS
     C                   MOVE      '017'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2PDTP        YKODE
     C     TRK01K        CHAIN     TRKODL01                           79
     C     *IN79         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   MOVE      'YBC0816'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2PDUN        IFNE      *BLANKS
     C                   MOVE      '349'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2PDUN        YKODE
     C     TRK01K        CHAIN     TRKODL01                           78
     C     *IN78         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   MOVE      'YBC2238'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2SDTY        IFNE      *BLANKS
     C     W2SDRF        ORNE      *BLANKS
     C                   MOVE      '213'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2SDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           77
     C     *IN77         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2SDRF        COMP      *BLANKS                                76
N03  C  N76              IF        %SUBST(W2SDRF:36:35) <> *BLANKS
N03  C                   EVAL      *IN76 = *ON
N03  C                   END
     C     *IN76         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     16            POSNBR
S03  C*                  MOVE      'YBC0810'     MSGNR
N03  C                   MOVE      'YBC2292'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2TDTY        IFNE      *BLANKS
     C     W2TDRF        ORNE      *BLANKS
     C                   MOVE      '754'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2TDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           75
     C     *IN75         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2TDRF        COMP      *BLANKS                                74
N03  C  N74              IF        %SUBST(W2TDRF:36:35) <> *BLANKS
N03  C                   EVAL      *IN74 = *ON
N03  C                   END
     C     *IN74         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     16            POSNBR
S03  C*                  MOVE      'YBC0810'     MSGNR
N03  C                   MOVE      'YBC2293'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2ADTY        IFNE      *BLANKS
     C     W2ADRF        ORNE      *BLANKS
     C                   MOVE      '380'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2ADTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           73
     C     *IN73         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2ADRF        COMP      *BLANKS                                72
N03  C  N72              IF        %SUBST(W2ADRF:36:35) <> *BLANKS
N03  C                   EVAL      *IN72 = *ON
N03  C                   END
     C     *IN72         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     16            POSNBR
S03  C*                  MOVE      'YBC0810'     MSGNR
N03  C                   MOVE      'YBC2294'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     W2AICD        IFNE      *BLANKS
     C     W2AITX        ORNE      *BLANKS
     C                   MOVE      '239'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2AICD        YKODE
     C     TRK01K        CHAIN     TRKODL01                           71
     C     *IN71         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0823'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     W2AITX        COMP      *BLANKS                                70
     C     *IN70         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     16            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     w2TRCH        IFNE      *BLANKS
     C                   MOVE      '116'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     W2TRCH        YKODE
     C     TRK01K        CHAIN     TRKODL01                           69
     C     *IN69         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
S05  C*                  Z-ADD     15            LINNBR
S05  C*                  Z-ADD     10            POSNBR
N05  C                   Z-ADD     14            LINNBR
N05  C                   Z-ADD     95            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     SLTB1         ENDSR
      *
      ***********************************************
     C     HENTSR        BEGSR
      ***********************************************
      *** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
      *** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
      *** OPSJON 2 ---> ENDRE DETALJE LINJE.
      *** OPSJON 4 ---> SLETTE DETALJE LINJE.
      *** OPSJON 5 ---> VISE DETALJE LINJE
      *** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGNCTSI
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTNCTSI
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISNCTSI
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISNCTSI      BEGSR
      ***********************************************
     C                   SETON                                        99
      *
     C     NCTSEIK1      CHAIN(N)  NCTSEI                             33
     C                   MOVE      TILI2         W2LI2
     C                   MOVE      TILIT         W2LIT
     C                   MOVE      TIDK          W2DK
     C                   MOVE      TIALK         W2ALK
     C                   MOVE      TIBLK         W2BLK
     C                   MOVE      TIUCR         W2UCR
     C                   MOVE      TICCH         W2CCH
     C                   MOVE      TICCCD        W2CCCD
     C                   MOVE      TICTX         W2CTX
     C                   MOVE      TICCUS        W2CCUS
     C                   MOVE      TIVKB         W2VKB
     C                   MOVE      TIVKN         W2VKN
     C                   MOVE      TIPTY         W2PTY
     C                   MOVE      TIPNT         W2PNT
     C                   MOVE      TINTS         W2NTS
     C                   MOVE      TIPMRK        W2PMRK
     C                   MOVE      TIUNNR        W2UNNR
     C                   MOVE      TICNR         W2CNR
     C                   MOVE      TIDFKD        W2DFKD
     C                   MOVE      TIPDTY        W2PDTY
     C                   MOVE      TIPDRF        W2PDRF
     C                   MOVE      TIPDGN        W2PDGN
     C                   MOVE      TIPDTP        W2PDTP
     C                   MOVE      TIPDAN        W2PDAN
     C                   MOVE      TIPDUN        W2PDUN
     C                   MOVE      TIPDPC        W2PDPC
     C                   MOVE      TIPDIN        W2PDIN
     C                   MOVE      TISDTY        W2SDTY
     C                   MOVE      TISDRF        W2SDRF
     C                   MOVE      TISDIN        W2SDIN
     C                   MOVE      TITDTY        W2TDTY
     C                   MOVE      TITDRF        W2TDRF
     C                   MOVE      TIADTY        W2ADTY
     C                   MOVE      TIADRF        W2ADRF
     C                   MOVE      TIAICD        W2AICD
     C                   MOVE      TIAITX        W2AITX
     C                   MOVE      TITRCH        W2TRCH
      *
     C                   EXSR      TSTOPL
      *
     C                   MOVE      W2DK          TIDK
     C                   MOVE      W2ALK         TIALK
     C                   MOVE      W2BLK         TIBLK
     C                   MOVE      W2UCR         TIUCR
     C                   MOVE      W2CCH         TICCH
     C                   MOVE      W2CCCD        TICCCD
     C                   MOVE      W2CTX         TICTX
     C                   MOVE      W2CCUS        TICCUS
     C                   MOVE      W2VKB         TIVKB
     C                   MOVE      W2VKN         TIVKN
     C                   MOVE      W2PTY         TIPTY
     C                   MOVE      W2PNT         TIPNT
     C                   MOVE      W2NTS         TINTS
     C                   MOVE      W2PMRK        TIPMRK
     C                   MOVE      W2UNNR        TIUNNR
     C                   MOVE      W2CNR         TICNR
     C                   MOVE      W2DFKD        TIDFKD
     C                   MOVE      W2PDTY        TIPDTY
     C                   MOVE      W2PDRF        TIPDRF
     C                   MOVE      W2PDGN        TIPDGN
     C                   MOVE      W2PDTP        TIPDTP
     C                   MOVE      W2PDAN        TIPDAN
     C                   MOVE      W2PDUN        TIPDUN
     C                   MOVE      W2PDPC        TIPDPC
     C                   MOVE      W2PDIN        TIPDIN
     C                   MOVE      W2SDTY        TISDTY
     C                   MOVE      W2SDRF        TISDRF
     C                   MOVE      W2SDIN        TISDIN
     C                   MOVE      W2TDTY        TITDTY
     C                   MOVE      W2TDRF        TITDRF
     C                   MOVE      W2ADTY        TIADTY
     C                   MOVE      W2ADRF        TIADRF
     C                   MOVE      W2AICD        TIAICD
     C                   MOVE      W2AITX        TIAITX
     C                   MOVE      W2TRCH        TITRCH
     C     STVIS         TAG
     C                   EXFMT     VAREL3
      *
     C   15              DO
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STVIS
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     DLTNCTSI      BEGSR
      ***********************************************
     C                   Z-ADD     ZRECNO        XRECN2            4 0
     C                   MOVE      *ZEROS        LI2
      *** OPERASJON 1
     C                   MOVE      TILI2         LI2(1)
     C                   Z-ADD     1             XN                3 0
     C     *IN98         DOWEQ     '0'                                          1<-B
     C     STDLT1        TAG
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '4'                                           2<-B
     C                   MOVE      *ZEROS        XN2               3 0
     C     XN2           DOWLT     XN                                             3<-B
     C                   ADD       1             XN2
     C                   END                                                      3<-E
     C                   ADD       1             XN
     C                   MOVE      TILI2         LI2(XN)
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *** OPERASJON 2
     C                   MOVE      '1'           *IN43
     C                   WRITE     SUBCTL2
     C                   MOVEA     '00'          *IN(43)
     C                   Z-ADD     *ZEROS        ZRECN2
     C                   MOVE      *ZEROS        XN2
     C     XN2           DOWLT     XN                                           1<-B
     C                   ADD       1             XN2
     C     NCTSECK       SETLL     NCTSEI
     C                   SETOFF                                       44
     C     STDLT2        TAG
     C     NCTSECK       READE(N)  NCTSEI                                 44
     C  N44              DO                                                      2<-B
     C     LI2(XN2)      IFEQ      TILI2                                          3<-B
     C                   ADD       1             ZRECN2
     C                   MOVE      TILI2         XLI2_2            5 0
     C                   WRITE     SUBFIL2
     C                   END                                                      3<-E
     C                   GOTO      STDLT2
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *** OPERASJON 3
     C                   Z-ADD     1             ZRECN2
     C     STDLT3        TAG
     C                   MOVEA     '11'          *IN(41)
     C                   WRITE     SUBCTL2
     C                   EXFMT     BUNN2
     C   25              GOTO      STDLT3
     C   12              Z-ADD     XRECN2        ZRECNO
     C  N12              DO                                                     1<-B
     C                   MOVE      *ZEROS        ZRECN2
     C     STDLT4        TAG
     C                   ADD       1             ZRECN2
     C     ZRECN2        CHAIN     SUBFIL2                            98
     C  N98              DO                                                      2<-B
     C     NCTSEIK1      CHAIN     NCTSEI                             41
     C  N41              DO                                                       3<-B
     C                   DELETE    NCTSEIR
     C                   MOVE      TILI2         W2LI2
     C                   MOVE      TILIT         W2LIT
     C                   EXSR      DLTOPL
     C                   GOTO      STDLT4
     C                   END                                                     2<-E
     C                   END
     C                   EXSR      MOVB1
     C                   END                                                    1<-E
     C                   SETOFF                                       4198
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGNCTSI      BEGSR
      ***********************************************
      *** FLYTTE DATA FRA SUBFIL TIL ARBEIDSVARIABLER
     C     NCTSEIK1      CHAIN(N)  NCTSEI                             33
     C                   EXSR      MOVNCTSW
      *
     C     STCHG         TAG
     C  N30              EXSR      TSTOPL
     C                   EXFMT     VARELI
     C                   MOVEA     '000000000000'*IN(79)
     C                   MOVEA     '0000000000'  *IN(69)
     C                   MOVE      '0'           *IN30
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      STCHG
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN12         IFEQ      '1'
     C                   UPDATE    SUBFIL
     C                   ELSE
      *** TESTE INNTASTEDE TADA. HVIS IKKE NOE FEIL, OPPDRATERE PÅ FIL
     C                   EXSR      TESTB1
     C   30              GOTO      STCHG
     C                   EXSR      OPDNCTSI
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDNCTSI      BEGSR
      ***********************************************
      *** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     NCTSEIK       CHAIN     NCTSEI                             33
      *** FLYTTE INNTASTET DATA TIL FIL-VARIABLER OG OPPDATERE DEM.
     C                   EXSR      MOVWNCTS
     C     *IN33         IFEQ      '0'
     C                   UPDATE    NCTSEIR
     C                   ELSE
     C                   WRITE     NCTSEIR
     C                   END
      *
      *** OPPDATERE PÅ SUBFIL
     C                   MOVE      TILI2         XLI2_2            5 0
      *
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     TILKOD        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVNCTSW      BEGSR
      ***********************************************
     C                   SETON                                        99
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   SETON                                        40
      *
     C                   MOVE      TILI2         W2LI2
     C                   MOVE      TILIT         W2LIT
     C                   MOVE      TIDK          W2DK
     C                   MOVE      TIALK         W2ALK
     C                   MOVE      TIBLK         W2BLK
     C                   MOVE      TIUCR         W2UCR
     C                   MOVE      TICCH         W2CCH
     C                   MOVE      TICCH         W2CCHI
     C                   MOVE      TICCCD        W2CCCD
     C                   MOVE      TICTX         W2CTX
     C                   MOVE      TICCUS        W2CCUS
     C                   MOVE      TIVKB         W2VKB
     C                   MOVE      TIVKN         W2VKN
     C                   MOVE      TIPTY         W2PTY
     C                   MOVE      TIPNT         W2PNT
     C                   MOVE      TINTS         W2NTS
     C                   MOVE      TIPMRK        W2PMRK
     C                   MOVE      TIUNNR        W2UNNR
     C                   MOVE      TICNR         W2CNR
     C                   MOVE      TIDFKD        W2DFKD
     C                   MOVE      TIPDTY        W2PDTY
     C                   MOVE      TIPDRF        W2PDRF
     C                   MOVE      TIPDGN        W2PDGN
     C                   MOVE      TIPDTP        W2PDTP
     C                   MOVE      TIPDAN        W2PDAN
     C                   MOVE      TIPDUN        W2PDUN
     C                   MOVE      TIPDPC        W2PDPC
     C                   MOVE      TIPDIN        W2PDIN
     C                   MOVE      TISDTY        W2SDTY
     C                   MOVE      TISDRF        W2SDRF
     C                   MOVE      TISDIN        W2SDIN
     C                   MOVE      TITDTY        W2TDTY
     C                   MOVE      TITDRF        W2TDRF
     C                   MOVE      TIADTY        W2ADTY
     C                   MOVE      TIADRF        W2ADRF
     C                   MOVE      TIAICD        W2AICD
     C                   MOVE      TIAITX        W2AITX
     C                   MOVE      TITRCH        W2TRCH
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWNCTS      BEGSR
      ***********************************************
     C                   MOVE      UAVD          TIAVD
     C                   MOVE      UTDN          TITDN
     C                   MOVE      ULI           TILI
     C                   MOVE      W2LI2         TILI2
     C                   MOVE      W2LIT         TILIT
     C                   MOVE      W2DK          TIDK
     C                   MOVE      W2ALK         TIALK
     C                   MOVE      W2BLK         TIBLK
     C                   MOVE      W2UCR         TIUCR
     C                   MOVE      W2CCHI        TICCH
     C                   MOVE      W2CCCD        TICCCD
     C                   MOVE      W2CTX         TICTX
     C                   MOVE      W2CCUS        TICCUS
     C                   MOVE      W2VKB         TIVKB
     C                   MOVE      W2VKN         TIVKN
     C                   MOVE      W2PTY         TIPTY
     C                   MOVE      W2PNT         TIPNT
     C                   MOVE      W2NTS         TINTS
     C                   MOVE      W2PMRK        TIPMRK
     C                   MOVE      W2UNNR        TIUNNR
     C                   MOVE      W2CNR         TICNR
     C                   MOVE      W2DFKD        TIDFKD
     C                   MOVE      W2PDTY        TIPDTY
     C                   MOVE      W2PDRF        TIPDRF
     C                   MOVE      W2PDGN        TIPDGN
     C                   MOVE      W2PDTP        TIPDTP
     C                   MOVE      W2PDAN        TIPDAN
     C                   MOVE      W2PDUN        TIPDUN
     C                   MOVE      W2PDPC        TIPDPC
     C                   MOVE      W2PDIN        TIPDIN
     C                   MOVE      W2SDTY        TISDTY
     C                   MOVE      W2SDRF        TISDRF
     C                   MOVE      W2SDIN        TISDIN
     C                   MOVE      W2TDTY        TITDTY
     C                   MOVE      W2TDRF        TITDRF
     C                   MOVE      W2ADTY        TIADTY
     C                   MOVE      W2ADRF        TIADRF
     C                   MOVE      W2AICD        TIAICD
     C                   MOVE      W2AITX        TIAITX
     C                   MOVE      W2TRCH        TITRCH
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB1         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       TIDK
     C                   MOVE      *BLANKS       TIALK
     C                   MOVE      *BLANKS       TIBLK
     C                   MOVE      *BLANKS       TIUCR
     C                   MOVE      *ZEROS        TICCH
     C                   MOVE      *BLANKS       TICCCD
     C                   MOVE      *BLANKS       TICTX
     C                   MOVE      *BLANKS       TICCUS
     C                   MOVE      *ZEROS        TIVKB
     C                   MOVE      *ZEROS        TIVKN
     C                   MOVE      *BLANKS       TIPTY
     C                   MOVE      *ZEROS        TIPNT
     C                   MOVE      *ZEROS        TINTS
     C                   MOVE      *BLANKS       TIPMRK
     C                   MOVE      *BLANKS       TIUNNR
     C                   MOVE      *BLANKS       TIPDTY
     C                   MOVE      *BLANKS       TIPDRF
     C                   MOVE      *BLANKS       TIPDGN
     C                   MOVE      *BLANKS       TIPDTP
     C                   MOVE      *BLANKS       TIPDAN
     C                   MOVE      *BLANKS       TIPDUN
     C                   MOVE      *BLANKS       TIPDPC
     C                   MOVE      *BLANKS       TIPDIN
     C                   MOVE      *BLANKS       TISDTY
     C                   MOVE      *BLANKS       TISDRF
     C                   MOVE      *BLANKS       TISDIN
     C                   MOVE      *BLANKS       TITDTY
     C                   MOVE      *BLANKS       TITDRF
     C                   MOVE      *BLANKS       TIADTY
     C                   MOVE      *BLANKS       TIADRF
     C                   MOVE      *BLANKS       TIAICD
     C                   MOVE      *BLANKS       TIAITX
     C                   MOVE      *BLANKS       TITRCH
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB2         BEGSR
      ***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *BLANKS       W2DK
     C                   MOVE      *BLANKS       W2ALK
     C                   MOVE      *BLANKS       W2BLK
     C                   MOVE      *BLANKS       W2UCR
     C                   MOVE      *ZEROS        W2LI2
     C                   MOVE      *ZEROS        W2CCH
     C                   MOVE      *BLANKS       W2CCCD
     C                   MOVE      *BLANKS       W2CTX
     C                   MOVE      *BLANKS       W2CCUS
     C                   MOVE      *ZEROS        W2VKB
     C                   MOVE      *ZEROS        W2VKN
     C                   MOVE      *BLANKS       W2PTY
     C                   MOVE      *ZEROS        W2PNT
     C                   MOVE      *ZEROS        W2NTS
     C                   MOVE      *BLANKS       W2PMRK
     C                   MOVE      *BLANKS       W2UNNR
     C                   MOVE      *BLANKS       W2CNR
     C                   MOVE      *BLANKS       W2DFKD
     C                   MOVE      *BLANKS       W2PDTY
     C                   MOVE      *BLANKS       W2PDRF
     C                   MOVE      *BLANKS       W2PDGN
     C                   MOVE      *BLANKS       W2PDTP
     C                   MOVE      *BLANKS       W2PDAN
     C                   MOVE      *BLANKS       W2PDUN
     C                   MOVE      *BLANKS       W2PDPC
     C                   MOVE      *BLANKS       W2PDIN
     C                   MOVE      *BLANKS       W2SDTY
     C                   MOVE      *BLANKS       W2SDRF
     C                   MOVE      *BLANKS       W2SDIN
     C                   MOVE      *BLANKS       W2TDTY
     C                   MOVE      *BLANKS       W2TDRF
     C                   MOVE      *BLANKS       W2ADTY
     C                   MOVE      *BLANKS       W2ADRF
     C                   MOVE      *BLANKS       W2AICD
     C                   MOVE      *BLANKS       W2AITX
     C                   MOVE      *BLANKS       W2TRCH
      *
     C                   ENDSR
      *
      ***********************************************
     C     SOKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      '031'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     W2DK          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2DK
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     26
     C                   CALL      'SYFI10L'
     C                   PARM                    W2ALK
     C                   PARM                    USPED
     C                   Z-ADD     37            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     37
     C     POSNBR        ANDLE     38
     C                   CALL      'SYFI10L'
     C                   PARM                    W2BLK
     C                   PARM                    USPED
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     15
     C                   EVAL      UCCH8 = *ZEROS
     C                   MOVEL     W2CCHI        UCCH8
     C                   CALL      'SAD062A'
     C                   PARM                    UCCH8             8
     C                   PARM                    UIDAG
     C                   MOVEL     UCCH8         W2CCHI
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     54
     C     POSNBR        ANDLE     55
     C                   MOVE      '017'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     W2PTY         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2PTY
     C                   Z-ADD     63            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   IF        THDK = 'T2' OR THDK = 'T2F'
     C                             OR TCDK = 'T2' OR TCDK = 'T2F'
     C                             OR W2DK = 'T2' OR W2DK = 'T2F'
     C                   MOVE      '178'         UUNIK
     C                   ELSE
     C                   MOVE      '214'         UUNIK             3
     C                   END
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     W2PDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2PDTY
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     23
     C                   MOVE      '017'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     W2PDTP        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2PDTP
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     34
     C     POSNBR        ANDLE     37
     C                   MOVE      '349'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     W2PDUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2PDUN
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   MOVE      '213'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2SDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2SDTY
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   MOVE      '754'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2TDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2TDTY
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   MOVE      '380'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2ADTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2ADTY
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      '239'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2AICD        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2AICD
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
S05  C*    LINNBR        IFEQ      15
S05  C*    POSNBR        ANDGE     10
S05  C*    POSNBR        ANDLE     10
N05  C     LINNBR        IFEQ      14
N05  C     POSNBR        ANDGE     95
N05  C     POSNBR        ANDLE     95
     C                   MOVE      '239'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     W2TRCH        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         W2TRCH
S05  C*                  Z-ADD     10            POSNBR
N05  C                   Z-ADD     95            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSOK         ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     NCTSEHK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     NCTSECK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    ULI
     C     NCTSEIK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    ULI
     C                   KFLD                    W2LI2
     C     NCTSEIK1      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    ULI
     C                   KFLD                    TILI2
     C     NCTSEIK2      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    ULI
     C                   KFLD                    W3LI2
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     TARIK         KLIST
     C                   KFLD                    W2CCH8
     C                   KFLD                    X2TAR
     C     KODS2K        KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C                   MOVE      'S2 '         KS2UNI
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    ULI               5 0
     C     *IN27         PARM      *IN27         UIN27             1
     C     *IN36         PARM      *IN36         UIN36             1
     C                   PARM                    UFLAGG            1 0
      *
     C                   MOVE      *ZEROS        XLI2
     C                   MOVE      *ZEROS        TILI2
     C                   MOVE      *ZEROS        TILIT
     C                   MOVE      *BLANKS       X2TAR             3
     C                   MOVE      *BLANKS       W2CTX
     C                   MOVE      *BLANKS       TICTX
     C                   MOVE      *BLANKS       W2CCUS
     C                   MOVE      *BLANKS       TICCUS
     C                   MOVE      *BLANKS       W2PMRK
     C                   MOVE      *BLANKS       TIPMRK
     C                   MOVE      *ZEROS        W2CCH8
     C                   MOVE      *ZEROS        TICCH
     C                   MOVE      'N'           USPED             1
      *
     C     'NCTS0100'    CHAIN     SYPTFF                             33
     C                   IF        *IN33
     C                   MOVE      99999999      X_FASE5           8 0
     C                   ELSE
     C                   MOVE      PTFDT         X_FASE5
     C                   END
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           UIDAG             8 0
      *
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C     NCTSECK       CHAIN     NCTSEC                             33
      *
     C                   ENDSR
      *
      ***********************************************
     C     TSTOPL        BEGSR
      ***********************************************
      *
     C                   ENDSR
      *
      ***********************************************
     C     DLTOPL        BEGSR
      ***********************************************
      *
     C                   ENDSR
      *
