     FEDIM2     UF   E           K DISK
     FEDIS      UF   E           K DISK
     FSAEHD     UF   E           K DISK
     FSAEHCMP   O  A E           K DISK
     FSAEV      UF   E           K DISK
     FSAEF      UF   E           K DISK
     FTVINF     UF   E           K DISK
     D                 DS
     D  XDT2                   1      6  0
     D  XD                     1      2  0
     D  XM                     3      4  0
     D  XÅ                     5      6  0
     D                 DS
EV5  D  WDT                    1      8  0
EV5  D  WÅ                     1      4  0
EV5  D  WM                     5      6  0
EV5  D  WD                     7      8  0
      *___________
      * KEY FIELDS
      *"""""""""""
     C     SAEHK         KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
      *____________
      * WORK FIELDS
      *""""""""""""
     C     *LIKE         DEFINE    SEAVD         XAVD
     C     *LIKE         DEFINE    XDT2          XDT
      *_______________
      * PARAMETER LIST
      *"""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    XAVD
     C     XDT2          PARM                    XDT
     C                   PARM                    XDLT              1
      *__________________________________________
      * SETLL, READ AND DELETE RECORDS FROM SAEHD
      *""""""""""""""""""""""""""""""""""""""""""
     C                   Z-ADD     XÅ            WÅ
     C                   Z-ADD     XM            WM
     C                   Z-ADD     XD            WD
NV5  C     XÅ            IFGT      50
NV5  C                   MOVEL     '19'          WÅ
NV5  C                   ELSE
NV5  C                   MOVEL     '20'          WÅ
NV5  C                   END
     C     SEDT          SETLL     SAEHD
     C                   READ      SAEHD                                  51
     C  N51SEDT          COMP      WDT                                51
     C     *IN51         DOWEQ     '0'                                          <----------I
     C     XAVD          IFEQ      SEAVD                                         <--------II
     C     XAVD          OREQ      0
     C                   EXSR      SRA                                          SAEV
     C                   EXSR      SRB                                          SAEF
     C     XDLT          IFEQ      'J'
     C                   EXSR      SRC                                          EDIM2/EDIS/TVINF
     C                   END
     C                   WRITE     SAEHRCMP
     C                   DELETE    SAEHR
     C                   END                                                     <--------II
     C                   READ      SAEHD                                  51
     C  N51SEDT          COMP      WDT                                51
     C  N51              END                                                    <----------I
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *_________________________________________
      * SETLL, READ AND DELETE RECORDS FROM SAEV
      *"""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
     C     SAEHK         SETLL     SAEV
     C     SAEHK         READE     SAEV                                   52
     C     *IN52         DOWEQ     '0'
     C                   DELETE    SAEVR
     C     SAEHK         READE     SAEV                                   52
     C                   END
     C                   ENDSR
      *_________________________________________
      * SETLL, READ AND DELETE RECORDS FROM SAEF
      *"""""""""""""""""""""""""""""""""""""""""
     C     SRB           BEGSR
     C     SAEHK         SETLL     SAEF
     C     SAEHK         READE     SAEF                                   52
     C     *IN52         DOWEQ     '0'
     C                   DELETE    SADFR
     C     SAEHK         READE     SAEF                                   52
     C                   END
     C                   ENDSR
      *_____________________________________________________
      * SETLL, READ AND DELETE RECORDS FROM EDIM2/EDIS/TVINF
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRC           BEGSR
     C                   MOVE      '0'           *IN52
     C     SAEHK         SETLL     EDIM2
     C     SAEHK         READE     EDIM2                                  52
      *
     C     *IN52         DOWEQ     '0'                                          <----------I
     C     M1001         IFEQ      '830'                                         <--------II
     C     MMN           SETLL     TVINF                                                  II
     C     MMN           READE     TVINF                                  53              II
     C     *IN53         DOWEQ     '0'                                            <------III
     C                   DELETE    TVINFF                                                III
     C     MMN           READE     TVINF                                  53             III
     C  N53              END                                                      <------III
     C     MSN           CHAIN     EDIS                               53                  II
     C  N53              DELETE    EDISR                                                  II
     C                   DELETE    EDIMR                                                  II
     C                   ELSE                                                             II
     C                   UPDATE    EDIMR                                                  II
     C                   END                                                     <--------II
     C     SAEHK         READE     EDIM2                                  52               I
     C  N52              END                                                    <----------I
     C                   ENDSR
