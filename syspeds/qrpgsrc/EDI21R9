      *
      **************************************************************
      *** PROGRAM SKAL SKRIVE UT STOCKRAPPORT
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 06-09 11-26
      *** LEDIGE INDIKATORER    44-50 53-89 93 94
      **************************************************************
      *
     Fsted2     IF   E           K DISK
     FPWDINT    IF   E           K DISK
     FEDIINN    IF   E           k DISK
     FGSSORL12  IF   E           K DISK
     FGSSORL23  IF   E           K DISK
     F                                     RENAME(GSSORFR:GSSORF23)
     FGSSPOF    IF   E           K DISK
     FGSSGDF    IF   E           K DISK
     FGSSBIF    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FGSSCGF    IF   E           K DISK
     FGSSCGL02  IF   E           K DISK
     F                                     RENAME(GSSCGFR:GSSCGF02)
     FGSSCCF    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FEDI21R9P  O    E             PRINTER OFLIND(*IN27)
     D TAB1            S              1    DIM(6) CTDATA PERRCD(1)
     D TAB2            S             15    DIM(6) ALT(TAB1)
     D F1              S              1    DIM(21)
     D F2              S              1    DIM(15)
     D F3              S              1    DIM(6)
     D                 DS
     D  XTNO                   1     12
     D  XAVD                   1      4
     D  XSLASH                 5      5
     D  XOPD                   6     12
     D                 DS
     D  ORSNM                  1     30
     D  XSNM27                 1     27
     D                 DS
     D  ORDSC                  1     30
     D  XDSC27                 1     27
     D  XDSC20                 1     20
     D                 DS
     D  ORDTL                  1      8  0
     D  ORDTLÅ                 1      4  0
     D  ORDTLM                 5      6  0
     D  ORDTLD                 7      8  0
     D                 DS
     D  XDTL                   1      6  0
     D  XDTLD                  1      2  0
     D  XDTLM                  3      4  0
     D  XDTLÅ                  5      6  0
     D                 DS
     D  ORDTWL                 1      8  0
     D  ORDTWÅ                 1      4  0
     D  ORDTWM                 5      6  0
     D  ORDTWD                 7      8  0
     D                 DS
     D  XDTWL                  1      6  0
     D  XDTWLD                 1      2  0
     D  XDTWLM                 3      4  0
     D  XDTWLÅ                 5      6  0
     D                 DS
     D  XCONO1                 1     20
     D  XCONO2                21     40
     D  XCONO3                41     60
     D  XCONO4                61     80
     D  XCONO5                81    100
     D  XCONO6               101    120
     D  CO                     1    120
     D                                     DIM(6)
     D XTXT01          C                   CONST('ON THE WAY     ')
     D                 DS
     D  XTID                   1     12  0
     D  XTID4                  1      4  0
     D                UDS
     D  UFIRM                  1      2
      *
     C                   WRITE     HEAD
     C                   EXSR      INIT
      *
     C                   EXSR      TESTB
     C                   MOVE      WSCNO         YCNO
     C                   MOVE      WSBCD         YBCD
     C                   TIME                    XTID
      *
     C     WSCNO         IFEQ      99999999                                     1<-B
     C                   MOVE      *ZEROS        YCNO
     C                   end                                                    1
      *START 42
      *
     C   42WSBCD         IFEQ      '99999'                                      1<-B
     C                   MOVE      *BLANKS       YBCD
     C                   ELSE                                                   1
     C                   MOVE      WSBCD         YBCD
     C                   END                                                    1<-E
      *
      *START 43
      *
     C   43              DO                                                     1<-B
     C     WSCG          SETLL     GSSCGL02                           32
     C     WSCG          READE     GSSCGL02                               32
     C   32              GOTO      SLPRT
     C                   MOVE      CGCNO         YCNO
     C                   MOVE      CGCNO         WSCNO
     C                   END                                                    1<-E
     C     WSPEND        IFEQ      '1'                                          1<-B
     C     WSPEND        OREQ      '3'
     C                   MOVE      '1'           *IN39
     C                   ELSE                                                   1
     C                   MOVE      '0'           *IN39
     C                   END                                                    1<-E
      *
     C     STPRT1        TAG
     C  N40GORK23        SETLL     GSSORL23
     C   40YBCD          SETLL     GSSORL12
     C     STPRT2        TAG
      *
      *START LES FIL
      *
     C     WSCNO         IFEQ      99999999                                     1<-B
     c     neste9        tag
     C                   READ      GSSORL23                               33
     c  N33ybcd          ifne      *blanks
     c     ybcd          andne     orbcd
     c                   goto      neste9
     c                   end
     C                   ELSE                                                   1
     C     WSBCD         IFEQ      *BLANKS                                       2<-B
     C  N40GORX23        READE     GSSORL23                               33
     C   40              READ      GSSORL12                               33
     C                   ELSE                                                    2
     C  N40GORK23        READE     GSSORL23                               33
     C   40YBCD          READE     GSSORL12                               99
     C                   END                                                     2<-E
      *
      * tester status ved 39 skal status P skrives
      *
     C     WSPEND        IFne      '1'                                          1<-B
     C  N33
     CAN 39ORST          CABNE     'P'           STPRT2
     c                   end
     C  N33
     CANN39ORST          CABEQ     'P'           STPRT2
     C   40
     CANN39
     CANN33ORST          IFGE      '5'                                           2<-B
     C     GORY12        SETLL     GSSORL12
     C                   GOTO      STPRT2
     C                   ELSE                                                    2
     C     ORST          IFLT      '0'                                            3<-B
     C     GORZ12        SETLL     GSSORL12
     C                   GOTO      STPRT2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      * START 43 READE
      *
     C   33*IN39         IFEQ      '1'                                          1<-B
     C     WSPEND        ANDEQ     '1'
     C                   GOTO      Slprt
     C                   END                                                    1<-E
     C   43
     CAN 33ORCNO         IFNE      YCNO                                         1<-B
     C     WSCG          READE     GSSCGL02                               32
     C   32              GOTO      SLPRT
     C                   MOVE      CGCNO         YCNO
     C                   MOVE      CGCNO         WSCNO
     C                   MOVE      CGCNO         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C   34              MOVE      *BLANKS       KNAVN
     C     WSPEND        IFEQ      '1'                                           2<-B
     C     WSPEND        OREQ      '3'
     C                   MOVE      '1'           *IN39
     C                   END                                                     2<-E
     C                   GOTO      STPRT1
     C                   END                                                    1<-E
      *
      * SKEKK SAMME LOCATION
      *
     C  N33              DO                                                     1<-B
     C     WSLC          IFNE      *BLANKS                                       2<-B
     C     WSLC          ANDNE     ORLC
     C                   GOTO      STPRT2
     C                   END                                                     2<-E
      *
     C     ORCNO         IFNE      XCNO                                          2<-B
     C                   MOVE      ORCNO         XCNO
     C                   MOVE      ORCNO         KUNDNR
     C                   MOVE      *BLANKS       XLC
     C     CUND1K        CHAIN     CUNDL01                            34
     C   34              MOVE      *BLANKS       KNAVN
     C                   MOVE      *ZEROS        XSIDE
     C     WSCPRL        IFEQ      'N'                                            3<-B
     C                   MOVE      '1'           *IN27
     C                   ELSE                                                     3
     C                   MOVE      '1'           *IN51
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C                   MOVE      'J'           XPRT              1
     C     ORBCD         IFNE      XBCD                                          2<-B
     C     ORBCD         CHAIN     CDBOAT                             34
     C   34              MOVE      *BLANKS       CBNAB
     C                   MOVE      ORBCD         XBCD
     C                   MOVE      *BLANKS       XLC               5
     C                   MOVE      *ZEROS        XSIDE             4 0
     c                   move      'J'           bruddb            1
     C     WSCPRL        IFEQ      'N'                                            3<-B
     C                   MOVE      '1'           *IN27
     C                   ELSE                                                     3
     C                   MOVE      '1'           *IN51
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C                   MOVE      *BLANKS       CO
     C     ORONO         SETLL     GSSGDF
     C     ORONO         SETLL     GSSPOF                             34
     C                   MOVE      *ZEROS        XN                1 0
     C     ORONO         READE     GSSPOF                                 34
     C     *IN34         DOWEQ     '0'
     C                   ADD       1             XN
     C                   MOVE      POCONO        CO(XN)
     C     ORONO         READE     GSSPOF                                 34
     C  N34              END
     C   40XN            IFEQ      1
     C                   MOVEL     '.'           CO(2)
     C                   END
      *
     C   40ORST          LOOKUP    TAB1          TAB2                     35
     C   40              MOVE      TAB2          XSTATU
     C   40ORTNO         IFEQ      0
     C                   MOVE      *BLANKS       XTNO
     C                   ELSE
     C                   MOVEL     ORTNO         XAVD
     C                   MOVE      '/'           XSLASH
     C                   MOVE      ORTNO         XOPD
     C                   END
      *
     C     XCONO4        COMP      *BLANKS                            3535
     C     XCONO5        COMP      *BLANKS                            3636
     C     XCONO6        COMP      *BLANKS                            3737
      *
     C                   MOVE      ORDTLD        XDTLD
     C                   MOVE      ORDTLM        XDTLM
     C                   MOVE      ORDTLÅ        XDTLÅ
     C                   MOVE      ORDTWD        XDTWLD
     C                   MOVE      ORDTWM        XDTWLM
     C                   MOVE      ORDTWÅ        XDTWLÅ
      *
     c     bruddb        ifeq      'J'
     C  N22              WRITE     GSS015PA
     c  N22              seton                                        22
     C   22              WRITE     GSS015PN
     c                   move      'N'           bruddb
     c                   setoff                                       27
     c                   end
     C   27              WRITE     GSS015PH
     C   27              MOVE      '0'           *IN27
     C     orst          comp      'P'                                    88
     C     orlc          CHAIN     STED2                              34
     C  N34              MOVE      ST2NVN        XLCNV
     C   34              MOVEL     XLC           XLCNV
     C   40ORLC          IFEQ      'ONWAY'
     C                   MOVE      XTXT01        XLCNV
     C                   END
     C                   WRITE     GSS015PP
     C                   WRITE     GSS015PB
     C   51              ADD       1             XSIDE
      *
      * leser tilleggslinjer
      *
     C     ORONO         READE     GSSGDF                                 34
     C     *IN34         DOWEQ     '0'
     C   27              WRITE     GSS015PH
     C   27              MOVE      '0'           *IN27
     C                   WRITE     GSS015PC
     C     ORONO         READE     GSSGDF                                 34
     C  N34              ENDDO
     c     ORRTNG        ifeq      'R'
     c                   write     gss015pr
     c                   end
      *
      * skriver locasjon
      * eller forventet locasjon
      *
     C                   GOTO      STPRT2
     C                   END                                                    1<-E
      *
     C     SLPRT         TAG
     C                   WRITE     BUNN
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     WSALL         IFEQ      'Y'
     C                   MOVE      *ZEROS        WSCG
     C                   END
      *
      * HVIS KUNDE ULIK 0
      *
     C     WSCNO         IFNE      0
     C     WSCNO         IFEQ      99999999
     C     WSALL         ANDNE     'Y'
     C*                  MOVE      *BLANKS       WSBCD
     C                   ELSE
     C                   MOVE      WSCNO         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            99
     C   99              GOTO      SLTB
     C     BICGR         IFNE      *BLANKS
     C     WSCNO         CHAIN     GSSCGF                             99
     C  N99BICGR         COMP      CGCG                               9999
     C   99              GOTO      SLTB
     C                   END
     C                   END
     C                   MOVE      '1'           *IN41
     C                   END
      *
      * HVIS BÅTKODE UTFYLLT
      *
     C     WSBCD         IFNE      *BLANKS
     C     WSALL         OREQ      'Y'
     C     WSBCD         CHAIN     CDBOAT                             98
     C   98              GOTO      SLTB
     C                   MOVE      CBKN          YCNO
     C   41WSCNO         IFNE      99999999
     C     CBKN          COMP      WSCNO                              9898
     C   98              GOTO      SLTB
     C                   MOVE      CBKN          KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   END
     C  N41              MOVE      '1'           *IN42
     C                   END
      *
     C     WSCG          IFNE      *BLANKS
     C     WSCNO         ANDEQ     0
     C     WSBCD         ANDEQ     *BLANKS
     C     WSCG          CHAIN     GSSCCF                             97
     C   97              GOTO      SLTB
     C                   MOVE      '1'           *IN43
     C                   END
      *
      *
      *
      *
     C     SLTB          ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    qtype             3
     C                   MOVE      'N'           WSCPRL            1
      *passordkontroll av bruker
     C     'pwd.....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         PWD               6
     C                   MOVEL     idata         ubiusi           10
     C     PWD           CHAIN     PWDINT                             33
     c                   end
     C     *IN33         IFEQ      '1'
     c                   write     bunn
     c                   seton                                        lr
     c                   return
     c                   end
      *kundenummer
     C     'kundenr.: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wscno             8 0
     c                   end
      *location
     C     'location: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wslc              5
     c                   end
      *vessel
     C     'vessel..: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wsbcd             5
     c                   end
      *firmakod
     C     'firmakod: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wsfc              3
     c                   end
      *transfer
     C     'transfer: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wsall             1
     c                   end
      *client group
     C     'cgroup..: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wscg              2
     c                   end
      *client group
     C     'pending.: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         wspend            1
     c                   end
      *
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     GORK23        KLIST
     C                   KFLD                    YCNO
     C                   KFLD                    YBCD
     C     GORX23        KLIST
     C                   KFLD                    YCNO
     C     GORY12        KLIST
     C                   KFLD                    ORBCD
     C                   KFLD                    ORLC
     C                   KFLD                    YST1
     C                   MOVE      '9'           YST1
     C     GORZ12        KLIST
     C                   KFLD                    ORBCD
     C                   KFLD                    ORLC
     C                   KFLD                    YST2
     C                   MOVE      '0'           YST2
     C     *LIKE         DEFINE    ORCNO         YCNO
     C     *LIKE         DEFINE    ORBCD         YBCD
     C     *LIKE         DEFINE    ORST          YST1
     C     *LIKE         DEFINE    ORST          YST2
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C     UBIUSI        CHAIN     GSSBIF                             33
     C     *IN33         IFEQ      '0'
      *
     C                   MOVE      *BLANKS       XTNO
     C     BICNO         IFNE      0
     C                   MOVE      '1'           *IN28
     C                   MOVE      BICNO         WSCNO
     C                   ELSE
     C     BICGR         IFNE      *BLANKS
     C                   MOVE      '1'           *IN29
     C                   MOVE      BICGR         WSCG
     C                   END
     C                   END
     C                   END
     C                   ENDSR
**
PPending
0On stock
1Packinglist
2Packinglist
3Proforma inv.
4Proforma inv.
