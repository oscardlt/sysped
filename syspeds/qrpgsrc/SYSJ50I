********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 NYTT PARAMETER FOR SYSJ16CL
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE BILL OF LADING                  ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01 02 05-07 19-26
      *** LEDIGE INDIKATORER 36-50 60-65
      *****************************************************************
      *
     FBILLOF    UF A E           K DISK
     FBLADRT    UF A E           K DISK
     FBLV1LF    UF A E           K DISK
     FBLV2      UF A E           K DISK
     FBLLOK     IF   E           K DISK
     FBOOKING   UF   E           K DISK
     FFRMDOC    UF   E           K DISK
     FHEADF     UF   E           K DISK
     FCDBLF     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FCDLAST    IF   E           K DISK
     FCDTRAF    IF   E           K DISK
     FCDTRAFL2  IF   E           K DISK
     F                                     RENAME(CDTRAFR:CDTRAF2R)
     FMULTKODT  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FTELL      UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFRATXT    IF   E           K DISK
     FFREETXT   IF   E           K DISK
     FSYSJ50FI  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D SOR             S              3  0 DIM(4)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  BONT1                  1      7  0
     D  BONT2                  8     14  0
     D  BONT3                 15     21  0
     D  BONT4                 22     28  0
     D  NT                     1     28  0
     D                                     DIM(4)
     D                 DS
     D  BOKDC1                 1      2
     D  BOKDC2                 3      4
     D  BOKDC3                 5      6
     D  BOKDC4                 7      8
     D  KC                     1      8
     D                                     DIM(4)
     D                 DS
     D  BOMN1                  1     20
     D  BOMN2                 21     40
     D  BOMN3                 41     60
     D  BOMN4                 61     80
     D  MN                     1     80
     D                                     DIM(4)
     D                 DS
     D  BOVS1                  1     25
     D  BOVS2                 26     50
     D  BOVS3                 51     75
     D  BOVS4                 76    100
     D  VS                     1    100
     D                                     DIM(4)
     D                 DS
     D  BOVKT1                 1      9  0
     D  BOVKT2                10     18  0
     D  BOVKT3                19     27  0
     D  BOVKT4                28     36  0
     D  VK                     1     36  0
     D                                     DIM(4)
     D                 DS
     D  BOM31                  1      7  3
     D  BOM32                  8     14  3
     D  BOM33                 15     21  3
     D  BOM34                 22     28  3
     D  M3                     1     28  3
     D                                     DIM(4)
     D                 DS
     D  WSNT01                 1      5  0
     D  WSNT02                 6     10  0
     D  WSNT03                11     15  0
     D  WSNT04                16     20  0
     D  NTV                    1     20  0
     D                                     DIM(4)
     D                 DS
     D  WSKD01                 1      2
     D  WSKD02                 3      4
     D  WSKD03                 5      6
     D  WSKD04                 7      8
     D  KCV                    1      8
     D                                     DIM(4)
     D                 DS
     D  WSMN01                 1     17
     D  WSMN02                18     34
     D  WSMN03                35     51
     D  WSMN04                52     68
     D  MNV                    1     68
     D                                     DIM(4)
     D                 DS
     D  WSVS01                 1     25
     D  WSVS02                26     50
     D  WSVS03                51     75
     D  WSVS04                76    100
     D  VSV                    1    100
     D                                     DIM(4)
     D                 DS
     D  WSVK01                 1      9  0
     D  WSVK02                10     18  0
     D  WSVK03                19     27  0
     D  WSVK04                28     36  0
     D  VKV                    1     36  0
     D                                     DIM(4)
     D                 DS
     D  WSM301                 1      9  3
     D  WSM302                10     18  3
     D  WSM303                19     27  3
     D  WSM304                28     36  3
     D  M3V                    1     36  3
     D                                     DIM(4)
     D                 DS
     D  WSEH01                 1      1
     D  WSEH02                 2      2
     D  WSEH03                 3      3
     D  WSEH04                 4      4
     D  EHV                    1      4  0
     D                                     DIM(4)
     D                 DS
     D  BLDTRÅ                 1      4  0
     D  BLDTRM                 5      6  0
     D  BLDTRD                 7      8  0
     D  BLDTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAÅ                 5      6  0
     D  WSDTA                  1      6  0
     D                 DS
     D  BLDTAÅ                 1      4  0
     D  BLDTAM                 5      6  0
     D  BLDTAD                 7      8  0
     D  BLDTA                  1      8  0
     D                 DS
     D  WSDTVD                 1      2  0
     D  WSDTVM                 3      4  0
     D  WSDTVÅ                 5      6  0
     D  WSDTVH                 1      6  0
     D                 DS
     D  BLDTVÅ                 1      4  0
     D  BLDTVM                 5      6  0
     D  BLDTVD                 7      8  0
     D  BLDTVH                 1      8  0
     D                 DS
     D  WSDV2D                 1      2  0
     D  WSDV2M                 3      4  0
     D  WSDV2Å                 5      6  0
     D  WSDVH2                 1      6  0
     D                 DS
     D  BLDV2Å                 1      4  0
     D  BLDV2M                 5      6  0
     D  BLDV2D                 7      8  0
     D  BLDVH2                 1      8  0
     D                 DS
     D  WSDLHD                 1      2  0
     D  WSDLHM                 3      4  0
     D  WSDLHÅ                 5      6  0
     D  WSDLOH                 1      6  0
     D                 DS
     D  BLDLHÅ                 1      4  0
     D  BLDLHM                 5      6  0
     D  BLDLHD                 7      8  0
     D  BLDLOH                 1      8  0
     D                 DS
     D  BODTÅ1                 1      4  0
     D  BODTM1                 5      6  0
     D  BODTD1                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  BODTÅ3                 1      4  0
     D  BODTM3                 5      6  0
     D  BODTD3                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  BODTÅ9                 1      4  0
     D  BODTM9                 5      6  0
     D  BODTD9                 7      8  0
     D  BODT9                  1      8  0
     D                 DS
     D  WSKNR                  1      8  0
     D  WSKNA                  9     16  0
     D  WSKNM                 17     24  0
     D  WSKNN                 25     32  0
     D  WSKNSA                33     40  0
     D  WSKNK                 41     48  0
     D  WSKNKA                49     56  0
     D  WSKNRA                57     64  0
     D  KN                     1     64
     D                 DS
     D  SOTXT1                 1      8
     D  SOTXT2                 9     16
     D  SOTXT3                17     24
     D  SOTXT4                25     32
     D  SOTXT5                33     40
     D  SOTXT6                41     48
     D  SOTXT7                49     56
     D  SOTXT8                57     64
     D  TXT                    1     64
     D                 DS
     D  XDK1                   1      1
     D  WSDKA                  2      2
     D  WSDKM                  3      3
     D  WSDKN                  4      4
     D  WSDKSA                 5      5
     D  WSDKK                  6      6
     D  WSDKKA                 7      7
     D  WSDKRA                 8      8
     D  KD                     1      8
     D                 DS
     D  W2NAA                  1     45
     D  WTNAA                 31     45
     D                 DS
     D  W2AD1A                 1     45
     D  WTAD1A                31     45
     D                 DS
     D  W2AD2A                 1     45
     D  WTAD2A                31     45
     D                 DS
     D  W2AD3A                 1     45
     D  WTAD3A                31     45
     D                 DS
     D  W2NAM                  1     45
     D  WTNAM                 31     45
     D                 DS
     D  W2AD1M                 1     45
     D  WTAD1M                31     45
     D                 DS
     D  W2AD2M                 1     45
     D  WTAD2M                31     45
     D                 DS
     D  W2AD3M                 1     45
     D  WTAD3M                31     45
     D                 DS
     D  W2NAN                  1     45
     D  WTNAN                 31     45
     D                 DS
     D  W2AD1N                 1     45
     D  WTAD1N                31     45
     D                 DS
     D  W2AD2N                 1     45
     D  WTAD2N                31     45
     D                 DS
     D  W2AD3N                 1     45
     D  WTAD3N                31     45
     D                 DS
     D  W2NAG                  1     45
     D  WTNAG                 31     45
     D                 DS
     D  W2AD1G                 1     45
     D  WTAD1G                31     45
     D                 DS
     D  W2AD2G                 1     45
     D  WTAD2G                31     45
     D                 DS
     D  W2AD3G                 1     45
     D  WTAD3G                31     45
     D                UDS
     D  UFIRM                  1      2
     D  UDSAVD                15     18
     D  UDSSG                 19     21
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      TSTOPL
     C  N30
     CANN04
     CANN14              Z-ADD     2             LINNBR
     C  N30
     CANN04
     CANN14              Z-ADD     59            POSNBR
     C  N30
     CAN 16              Z-ADD     3             LINNBR
     C  N30
     CAN 16              Z-ADD     65            POSNBR
     C     ST11          TAG
     C                   EXSR      TESTAD
     C*
     C*** TEST OM DET ER OPPLYSNINGER TIL OPPDRAG
     C     FREETK        SETLL     FREETXT
     C     FREETK        READE     FREETXT                                29
     C*
     C                   EXSR      KDTFMT
     C  N27              EXFMT     BILDE01I
     C   27              EXFMT     BILDE01E
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '0000000'     *IN(69)
     C                   MOVEA     '00000'       *IN(64)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
     C   08              DO
     C                   SELECT
     C     LINNBR        WHENGE    4
     C     LINNBR        ANDLE     5
     C                   EXSR      AVSADR
     C     LINNBR        WHENGE    6
     C     LINNBR        ANDLE     7
     C                   EXSR      MOTADR
     C     LINNBR        WHENGE    8
     C     LINNBR        ANDLE     9
     C                   EXSR      NTFADR
     C     LINNBR        WHENGE    15
     C     LINNBR        ANDLE     19
     C     POSNBR        ANDGE     41
     C                   EXSR      AGTADR
     C                   ENDSL
     C                   GOTO      START
     C                   END
     C*
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
     C*
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START
     C                   END
      * FRI SØKEVEI
     C   17              DO
     C     UOPD          IFEQ      *ZEROS
     C                   MOVE      'SHU0126'     MSGNR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      *ZEROS        OTIKU1            8 0
     C                   MOVE      *ZEROS        OTIKU2            8 0
     C                   CALL      'SYFA64'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
     C                   END
     C                   GOTO      ST11
     C                   END
     C* FREETEXT
     C   18              DO
     C     UOPD          IFEQ      *ZEROS
     C                   MOVE      'SPO0106'     MSGNR
     C                   SETON                                        30
     C                   GOTO      ST11
     C                   END
     C                   EXSR      VISFRE
     C                   GOTO      ST11
     C                   END
     C*
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C                   EXSR      OPDBL
     C  N27              EXSR      OPDBV                                        KUN IMPORT
     C   15              DO
     C     BLK           SETLL     BLV1LF
     C     BLK           READE(N)  BLV1LF                                 30
     C   30              MOVE      'DIV4241'     MSGNR
     C   30              GOTO      ST11
     C                   MOVE      'J'           WSTILO
     C                   GOTO      START3
     C                   END
     C*
     C*** BESTILLING AV UTSKRIFT / GÅ TIL OPPDRAG
     C     START2        TAG
     C   03              DO
     C                   EXFMT     BILDE02
     C   12              GOTO      START
     C*
     C     WSPRT         IFEQ      'J'
     C                   EXSR      UTBL
     C                   END
     C     WSADV         IFEQ      'J'
     C     WSFAX         OREQ      'J'
     C                   EXSR      UTADV
N01  C     UFLAG         CABEQ     '1'           START2
     C                   END
     C*
     C*** LAGE/ENDRE OPPDRAG
     C     START3        TAG
     C     WSTILO        IFEQ      'J'
     C                   MOVE      '?'           XHEST             1
     C     BLK           CHAIN     HEADF                              33
     C     HEST          IFEQ      ' '
     C     HEST          OREQ      'O'
     C     HEST          OREQ      'C'
     C     HEST          OREQ      'U'
     C     HEST          OREQ      'F'
     C                   MOVE      HEST          XHEST
     C                   MOVE      ' '           HEST
     C                   END
     C                   EXCEPT    NYOPST
     C*
     C                   MOVE      'B'           UKODE             1
     C                   MOVE      'CHG'         UTYPE             3
     C  N27              DO
     C                   CALL      'SYSJ10'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM      BLSG          USG2              3
     C                   PARM                    UTYPE             3
     C                   PARM                    UKODE
     C     XHEST         IFNE      '?'
     C     BLK           CHAIN     HEADF                              33
     C     HEST          IFNE      'X'
     C     XHEST         IFEQ      'U'
     C     HEOT          ANDNE     *BLANKS
     C                   MOVE      ' '           HEST
     C                   ELSE
     C                   MOVE      XHEST         HEST
     C                   END
     C                   END
     C                   EXCEPT    NYOPST
     C                   END
     C     UKODE         IFEQ      '1'
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      'X'           BLST
     C  N33              UPDATE    BILLOFR
     C                   GOTO      START
     C                   END
     C     UKODE         IFEQ      '6'
     C                   EXSR      MOVWS
     C                   MOVE      '1'           *IN16
     C                   GOTO      START
     C                   END
     C                   END
     C   27              DO
     C                   CALL      'SYSE10'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM      BLSG          USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C     XHEST         IFNE      '?'
     C     BLK           CHAIN     HEADF                              33
     C     HEST          IFNE      'X'
     C     XHEST         IFEQ      'U'
     C     HEOT          ANDNE     *BLANKS
     C                   MOVE      ' '           HEST
     C                   ELSE
     C                   MOVE      XHEST         HEST
     C                   END
     C                   END
     C                   EXCEPT    NYOPST
     C                   END
     C     UKODE         IFEQ      '1'
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      'X'           BLST
     C  N33              UPDATE    BILLOFR
     C                   GOTO      START
     C                   END
     C     UKODE         IFEQ      '6'
     C                   EXSR      MOVWS
     C                   MOVE      '1'           *IN16
     C                   GOTO      START
     C                   END
     C                   END
     C                   END
     C     UFLAGG        IFEQ      1
     C                   GOTO      START
     C                   END
     C                   Z-ADD     3             UFLAGG
     C                   GOTO      SLUTT
     C                   END
     C*
     C   10
     COR 11              DO
     C                   EXSR      TILV
     C  N27              EXSR      HENTBV                                       KUN IMPORT
     C                   MOVE      *ZEROS        NESTAV            4 0
     C                   MOVE      *ZEROS        NESTOP            7 0
     C                   CALL      'SYSJ50K'
     C                   PARM                    BLAVD
     C                   PARM                    BLOPD
     C                   PARM                    BLSG
     C                   PARM                    NESTAV
     C                   PARM                    NESTOP
     C     UFLAGG        IFEQ      3
     C                   SETON                                        03
     C                   GOTO      START2
     C                   ELSE
     C     UFLAGG        IFEQ      5
     C                   MOVE      'J'           WSTILO
     C                   GOTO      START3
     C                   ELSE
     C                   GOTO      START
     C                   END
     C                   END
     C                   END
     C*** TIL SIDE 2
     C   13              DO
     C                   CALL      'SYSJ50G'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM      WSDTR         UDTR              6 0
     C                   PARM                    BLSG
     C                   PARM                    BLUKE
     C                   PARM                    BLAAR
     C                   PARM                    UFLAGG
     C                   GOTO      START
     C                   END
     C*
     C   16              EXSR      MOVWS
     C*
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   MOVE      UOPD          UOPD2
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      ' '           BLST
     C  N33              UPDATE    BILLOFR
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTAD        BEGSR
     C***********************************************
     C                   SELECT
     C     W2AD0A        WHENNE    *BLANKS
     C                   MOVE      '1'           *IN34
     C                   MOVEL     W2AD0A        WSNAA
     C                   MOVEL     W2NAA         WSAD1A
     C                   MOVE      '(F8)'        WSAD1A
     C                   MOVEL     W2AD1A        WSAD2A
     C                   MOVEL     W2AD2A        WSAD3A
     C     W2AD4A        WHENNE    *BLANKS
     C     WTAD1A        ORNE      *BLANKS
     C     WTAD2A        ORNE      *BLANKS
     C     WTAD3A        ORNE      *BLANKS
     C                   MOVE      '1'           *IN34
     C                   MOVEL     W2NAA         WSNAA
     C                   MOVEL     W2AD1A        WSAD1A
     C                   MOVE      '(F8)'        WSAD1A
     C                   MOVEL     W2AD2A        WSAD2A
     C                   MOVEL     W2AD3A        WSAD3A
     C                   OTHER
     C                   MOVE      '0'           *IN34
     C                   ENDSL
      *
     C                   SELECT
     C     W2AD0M        WHENNE    *BLANKS
     C                   MOVE      '1'           *IN31
     C                   MOVEL     W2AD0M        WSNAM
     C                   MOVEL     W2NAM         WSAD1M
     C                   MOVE      '(F8)'        WSAD1M
     C                   MOVEL     W2AD1M        WSAD2M
     C                   MOVEL     W2AD2M        WSAD3M
     C     W2AD4M        WHENNE    *BLANKS
     C     WTAD1M        ORNE      *BLANKS
     C     WTAD2M        ORNE      *BLANKS
     C     WTAD3M        ORNE      *BLANKS
     C                   MOVE      '1'           *IN31
     C                   MOVEL     W2NAM         WSNAM
     C                   MOVEL     W2AD1M        WSAD1M
     C                   MOVE      '(F8)'        WSAD1M
     C                   MOVEL     W2AD2M        WSAD2M
     C                   MOVEL     W2AD3M        WSAD3M
     C                   OTHER
     C                   MOVE      '0'           *IN31
     C                   ENDSL
      *
     C                   SELECT
     C     W2AD0N        WHENNE    *BLANKS
     C                   MOVE      '1'           *IN32
     C                   MOVEL     W2AD0N        WSNAN
     C                   MOVEL     W2NAN         WSAD1N
     C                   MOVE      '(F8)'        WSAD1N
     C                   MOVEL     W2AD1N        WSAD2N
     C                   MOVEL     W2AD2N        WSAD3N
     C     W2AD4N        WHENNE    *BLANKS
     C     WTAD1N        ORNE      *BLANKS
     C     WTAD2N        ORNE      *BLANKS
     C     WTAD3N        ORNE      *BLANKS
     C                   MOVE      '1'           *IN32
     C                   MOVEL     W2NAN         WSNAN
     C                   MOVEL     W2AD1N        WSAD1N
     C                   MOVE      '(F8)'        WSAD1N
     C                   MOVEL     W2AD2N        WSAD2N
     C                   MOVEL     W2AD3N        WSAD3N
     C                   OTHER
     C                   MOVE      '0'           *IN32
     C                   ENDSL
      *
     C                   SELECT
     C     W2AD0G        WHENNE    *BLANKS
     C                   MOVE      '1'           *IN35
     C                   MOVEL     W2AD0G        WSNAG
     C                   MOVEL     W2NAG         WSAD1G
     C                   MOVE      '(F8)'        WSAD1G
     C                   MOVEL     W2AD1G        WSAD2G
     C                   MOVEL     W2AD2G        WSAD3G
     C     W2AD4G        WHENNE    *BLANKS
     C     WTAD1G        ORNE      *BLANKS
     C     WTAD2G        ORNE      *BLANKS
     C     WTAD3G        ORNE      *BLANKS
     C                   MOVE      '1'           *IN35
     C                   MOVEL     W2NAG         WSNAG
     C                   MOVEL     W2AD1G        WSAD1G
     C                   MOVE      '(F8)'        WSAD1G
     C                   MOVEL     W2AD2G        WSAD2G
     C                   MOVEL     W2AD3G        WSAD3G
     C                   OTHER
     C                   MOVE      '0'           *IN35
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C                   MOVE      'DIV0000'     MSGNR
     C     WSSG          IFEQ      *BLANKS
     C                   MOVE      USG           WSSG
     C                   ELSE
     C     KODSFK        CHAIN     KOSFR                              33
     C   33              MOVE      USG           WSSG
     C                   END
     C*
     C*** TEST BÅTKODE
     C     WSOB          IFNE      *BLANKS
     C     WSOB          CHAIN     CDBOAT                             99
     C   99              MOVE      'SPB0104'     MSGNR
     C   99              SETON                                        30
     C                   END
     C*
     C*** TEST UKE
     C     WSUKE         COMP      1                                    98
     C  N98WSUKE         COMP      53                                 98
     C   98
     CANN30              MOVE      'SPU0101'     MSGNR
     C   98
     CANN30              SETON                                        30
     C*
     C*** TEST REDERINR.
     C     WSKNR         IFEQ      *ZEROS
     C     WSTR          ANDNE     *BLANKS
     C     CDTRK2        CHAIN     CDTRAFL2                           97
     C  N97              MOVE      CTKN          WSKNR
     C                   END
     C                   MOVE      WSKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            97
     C  N97              MOVEL     KNAVN         WSNAR
     C   97              MOVE      *BLANKS       WSNAR
     C   97
     CANN30              MOVE      'SPK0121'     MSGNR
     C   97
     CANN30              SETON                                        30
     C*
     C*** TEST TRAFIKK
     C     CDTRK         CHAIN     CDTRAF                             96
     C  N96CTAKT         COMP      'I'                                    96
     C   96
     CANN30              MOVE      'SPT0102'     MSGNR
     C   96
     CANN30              SETON                                        30
     C*
     C*** TEST REISE
     C     WSREIS        COMP      *BLANKS                                95
     C   95
     CANN30              MOVE      'SPR0101'     MSGNR
     C   95
     CANN30              SETON                                        30
     C*
     C*** TEST AVSENDER.
     C  N34WSKNA         IFNE      0                                            1<-B
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            94
     C  N94WSNAA         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSAD1A
     C                   MOVE      ADR2          WSAD2A
     C                   MOVE      *BLANKS       WSAD3A
     C     POSTNR        IFEQ      0                                              3<-B
     C     SYPOGE        IFEQ      *BLANKS                                         4<-B
     C                   MOVEL     ADR3          WSAD3A
     C                   ELSE                                                      4
     C     SYPOGE        CAT       ADR3:1        WSAD3A
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3A
     C                   MOVE      ADR3          WSAD3A
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C  N94WSKNSA        IFEQ      0                                             2<-B
     C     FMOT          IFEQ      0                                              3<-B
     C                   MOVE      WSKNA         WSKNSA
     C                   ELSE                                                     3
     C                   MOVE      FMOT          WSKNSA
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C  N94WSNAA         COMP      *BLANKS                                94
     C   94
     CANN30              MOVE      'SPK0037'     MSGNR
     C   94
     CANN30              SETON                                        30
     C*
     C*** TEST MOTTAKER.
     C  N31WSKNM         IFNE      0                                            1<-B
     C                   MOVE      WSKNM         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            93
     C  N93WSNAM         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSAD1M
     C                   MOVE      ADR2          WSAD2M
     C                   MOVE      *BLANKS       WSAD3M
     C     POSTNR        IFEQ      0                                              3<-B
     C     SYPOGE        IFEQ      *BLANKS                                         4<-B
     C                   MOVEL     ADR3          WSAD3M
     C                   ELSE                                                      4
     C     SYPOGE        CAT       ADR3:1        WSAD3M
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3M
     C                   MOVE      ADR3          WSAD3M
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C  N93WSKNK         IFEQ      0                                             2<-B
     C     FMOT          IFEQ      0                                              3<-B
     C                   MOVE      WSKNM         WSKNK
     C                   ELSE                                                     3
     C                   MOVE      FMOT          WSKNK
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C  N93WSNAM         COMP      *BLANKS                                93
     C   93
     CANN30              MOVE      'SPK0038'     MSGNR
     C   93
     CANN30              SETON                                        30
     C*
     C*** TEST NOTIFY
     C  N32WSKNN         IFNE      0                                            1<-B
     C                   MOVE      WSKNN         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            92
     C  N92WSNAN         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAN
     C                   MOVE      ADR1          WSAD1N
     C                   MOVE      ADR2          WSAD2N
     C                   MOVE      *BLANKS       WSAD3N
     C     POSTNR        IFEQ      0                                              3<-B
     C     SYPOGE        IFEQ      *BLANKS                                         4<-B
     C                   MOVEL     ADR3          WSAD3N
     C                   ELSE                                                      4
     C     SYPOGE        CAT       ADR3:1        WSAD3N
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3N
     C                   MOVE      ADR3          WSAD3N
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C* N92      WSNAN     COMP *BLANKS                  92
     C   92
     CANN30              MOVE      'SPK0134'     MSGNR
     C   92
     CANN30              SETON                                        30
     C*
     C*** TEST SELGERS AGENT
     C     WSKNSA        IFNE      0
     C                   MOVE      WSKNSA        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            91
     C   91
     CANN30              MOVE      'SPK0001'     MSGNR
     C   91
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST KJØPER
     C     WSKNK         IFNE      0                                            1<-B
     C                   MOVE      WSKNK         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            90
     C  N90WSKNKA        IFEQ      0                                             2<-B
     C     FMOT          IFEQ      0                                              3<-B
     C                   MOVE      WSKNK         WSKNKA
     C                   ELSE                                                     3
     C                   MOVE      FMOT          WSKNKA
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C   90
     CANN30              MOVE      'SPK0001'     MSGNR
     C   90
     CANN30              SETON                                        30
     C                   END                                                    1<-E
     C*
     C*** TEST KJØPERS AGENT
     C     WSKNKA        IFNE      0
     C                   MOVE      WSKNKA        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            89
     C   89
     CANN30              MOVE      'SPK0001'     MSGNR
     C   89
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST REDERIS AGENT
     C     WSKNRA        IFNE      0
     C                   MOVE      WSKNRA        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            88
     C   88
     CANN30              MOVE      'SPK0001'     MSGNR
     C   88
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LASTESTED
     C     WSLSS         CHAIN     STED2                              87
     C   87
     CANN30              MOVE      'SPS0106'     MSGNR
     C   87
     CANN30              SETON                                        30
     C*
     C*** TEST LASTEHAVN
     C     WSLSH         CHAIN     STED2                              86
     C   86
     CANN30              MOVE      'SPS0102'     MSGNR
     C   86
     CANN30              SETON                                        30
     C*
     C*** TEST LOKAL BÅT
     C     WSLB          IFNE      *BLANKS
     C     WSLB          CHAIN     CDBOAT                             85
     C   85
     CANN30              MOVE      'SPB0102'     MSGNR
     C   85
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST VIA HAVN
     C     WSVH          IFNE      *BLANKS
     C     WSDTVH        ORNE      0
     C     WSVH          CHAIN     STED2                              84
     C*** KREVES IKKE VIA HAVN VED IMPORT (27 AV)
     C   84
     CANN27WSVH          COMP      *BLANKS                            8484
     C   84
     CANN30              MOVE      'SPS0103'     MSGNR
     C   84
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DATO TIL VIA HAVN
     C     WSDTVH        IFNE      0
     C                   MOVE      WSDTVÅ        UÅÅ               2 0
     C                   MOVE      WSDTVM        UMM               2 0
     C                   MOVE      WSDTVD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      83
     C   83
     CANN30              MOVE      'SPD0001'     MSGNR
     C   83
     CANN30              SETON                                        30
     C                   END
      *
      *** TEST VIA HAVN 2
     C     WSVH2         IFNE      *BLANKS
     C     WSDVH2        ORNE      0
     C     WSVH2         CHAIN     STED2                              68
      *** KREVES IKKE VIA HAVN  VED IMPORT (27 AV)
     C   68
     CANN27WSVH2         COMP      *BLANKS                            6868
     C   68
     CANN30              MOVE      'SPS0103'     MSGNR
     C   68
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DATO TIL VIA HAVN
     C     WSDVH2        IFNE      0
     C                   MOVE      WSDV2Å        UÅÅ               2 0
     C                   MOVE      WSDV2M        UMM               2 0
     C                   MOVE      WSDV2D        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      67
     C   67
     CANN30              MOVE      'SPD0001'     MSGNR
     C   67
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LOSSEHAVN
     C     WSLOH         CHAIN     STED2                              82
     C   82
     CANN30              MOVE      'SPS0104'     MSGNR
     C   82
     CANN30              SETON                                        30
     C*
     C*** TEST DATO TIL VIA HAVN
     C     WSDLOH        IFNE      0
     C                   MOVE      WSDLHÅ        UÅÅ               2 0
     C                   MOVE      WSDLHM        UMM               2 0
     C                   MOVE      WSDLHD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      66
     C   66
     CANN30              MOVE      'SPD0001'     MSGNR
     C   66
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LOSSESTED
     C     WSLOS         IFNE      *BLANKS
     C     WSLOS         CHAIN     STED2                              81
     C   81
     CANN30              MOVE      'SPS0105'     MSGNR
     C   81
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST AVGANG/ANKOMST DATO
     C                   MOVE      WSDTAÅ        UÅÅ               2 0
     C                   MOVE      WSDTAM        UMM               2 0
     C                   MOVE      WSDTAD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      80
     C   80
     CANN30              MOVE      'SPD0001'     MSGNR
     C   80
     CANN30              SETON                                        30
     C*
     C*** LAYOUT AV BILL OF LADING
     C     WSKDP         IFNE      *BLANKS
     C     WSKDP         CHAIN     CDBLF                              79
     C   79
     CANN30              MOVE      'SPK0130'     MSGNR
     C   79
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LASTETYPE
     C     WSLSTY        IFNE      *BLANKS
     C     WSLSTY        CHAIN     CDLAST                             78
     C   78
     CANN30              MOVE      'SPL0104'     MSGNR
     C   78
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST CC/PP
     C     WSCP          COMP      ' '                                7777
     C   77WSCP          COMP      'C'                                7777
     C   77WSCP          COMP      'P'                                7777
     C   77
     CANN30              MOVE      'SPC0101'     MSGNR
     C   77
     CANN30              SETON                                        30
     C*
     C*** STED
     C     *IN27         IFEQ      '1'
     C     WSSD          CHAIN     STED2                              76
     C   76
     CANN30              MOVE      'SPS0107'     MSGNR
     C   76
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DATO
     C     WSDTR         IFNE      0
     C                   MOVE      WSDTRÅ        UÅÅ               2 0
     C                   MOVE      WSDTRM        UMM               2 0
     C                   MOVE      WSDTRD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      75
     C   75
     CANN30              MOVE      'SPD0001'     MSGNR
     C   75
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST AGENT
     C  N35WSKNG         IFNE      0                                            1<-B
     C                   MOVE      WSKNG         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            74
     C   74
     CANN30              MOVE      'SPK0136'     MSGNR
     C   74
     CANN30              SETON                                        30
     C  N74WSNAG         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      KNAVN         WSNAG
     C                   MOVE      ADR1          WSAD1G
     C                   MOVE      ADR2          WSAD2G
     C                   MOVE      *BLANKS       WSAD3G
     C     POSTNR        IFEQ      0                                              3<-B
     C     SYPOGE        IFEQ      *BLANKS                                         4<-B
     C                   MOVEL     ADR3          WSAD3G
     C                   ELSE                                                      4
     C     SYPOGE        CAT       ADR3:1        WSAD3G
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C                   MOVEL     POSTNR        WSAD3G
     C                   MOVE      ADR3          WSAD3G
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C  N271             DO        4             XN                             1<-B
     C     KCV(XN)       IFEQ      *BLANKS                                       2<-B
     C     KCV(XN)       OREQ      'TA'
     C                   MOVE      *ZEROS        EHV(XN)
     C                   ELSE                                                    2
     C     KCV(XN)       CHAIN     CDCON4                             33
     C  N33              MOVEL     CC4FT         VSV(XN)
     C  N33              MOVE      CC4NT         EHV(XN)
     C   3373            SUB       XN            X2                3 0
     C   33              MOVE      '1'           *IN(X2)
     C   33
     CANN30              DO                                                       3<-B
     C                   MOVE      'SPK0131'     MSGNR
     C                   SETON                                        30
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** TEST PROSJEKTNR.
     C     TRMODUL       ifne      'J'
     C  N09WSPRO         COMP      0                                      73
     C   73
     CANN30              MOVE      'SPP0101'     MSGNR
     C   73
     CANN30              SETON                                        30
     c                   end
     C*
     C     *IN27         IFEQ      '0'
     C     *IN09         ANDNE     '1'
     C     *IN10         ANDNE     '1'
     C     *IN11         ANDNE     '1'
N01  C     WSKD01        ANDNE     '*C'
     C     WSNT01        COMP      *ZEROS                                 64
     C     WSVK01        COMP      *ZEROS                                 65
     C     *IN30         IFEQ      '0'
     C     *IN64         IFEQ      '1'
     C     *IN65         OREQ      '1'
     C                   MOVE      'JOV1031'     MSGNR
     C                   SETON                                        30
     C                   END
     C                   END
     C                   END
     C*
     C   30              EXSR      SETCUR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   65              Z-ADD     58            POSNBR
     C   64              Z-ADD     20            POSNBR
     C   69
     COR 70
     COR 71
     COR 72              Z-ADD     28            POSNBR
     C   73              Z-ADD     44            POSNBR
     C   74              Z-ADD     50            POSNBR
     C   75
     CANN27              Z-ADD     13            POSNBR
     C   75
     CAN 27              Z-ADD     63            POSNBR
     C   76              Z-ADD     46            POSNBR
     C   77              Z-ADD     11            POSNBR
     C   78              Z-ADD     69            POSNBR
     C   79              Z-ADD     69            POSNBR
     C   80              Z-ADD     49            POSNBR
     C   66              Z-ADD     14            POSNBR
     C   81              Z-ADD     27            POSNBR
     C   82              Z-ADD     8             POSNBR
     C   67              Z-ADD     75            POSNBR
     C   68              Z-ADD     69            POSNBR
     C   83              Z-ADD     56            POSNBR
     C   84              Z-ADD     50            POSNBR
     C   85              Z-ADD     38            POSNBR
     C   86              Z-ADD     26            POSNBR
     C   87              Z-ADD     8             POSNBR
     C   88              Z-ADD     71            POSNBR
     C   89              Z-ADD     51            POSNBR
     C   90              Z-ADD     31            POSNBR
     C   91              Z-ADD     11            POSNBR
     C   92              Z-ADD     6             POSNBR
     C   93              Z-ADD     6             POSNBR
     C   94              Z-ADD     6             POSNBR
     C   95              Z-ADD     47            POSNBR
     C   96              Z-ADD     37            POSNBR
     C   97              Z-ADD     6             POSNBR
     C   98              Z-ADD     70            POSNBR
     C   99              Z-ADD     59            POSNBR
     C*
     C   64
     COR 65              Z-ADD     17            LINNBR
     C   69              Z-ADD     20            LINNBR
     C   70              Z-ADD     19            LINNBR
     C   71              Z-ADD     18            LINNBR
     C   72              Z-ADD     17            LINNBR
     C   73              Z-ADD     2             LINNBR
     C   74              Z-ADD     15            LINNBR
     C   75
     COR 76
     COR 77
     CAN 27              Z-ADD     14            LINNBR
     C   77
     CANN27              Z-ADD     13            LINNBR
     C   78              Z-ADD     13            LINNBR
     C   79
     COR 80
     COR 81
     COR 66
     COR 82              Z-ADD     12            LINNBR
     C   83
     COR 67
     COR 68
     COR 84
     COR 85
     COR 86
     COR 87              Z-ADD     11            LINNBR
     C   88
     COR 89
     COR 90
     COR 91              Z-ADD     10            LINNBR
     C   92              Z-ADD     8             LINNBR
     C   93              Z-ADD     6             LINNBR
     C   94              Z-ADD     4             LINNBR
     C   95
     COR 96
     COR 97              Z-ADD     3             LINNBR
     C   98
     COR 99              Z-ADD     2             LINNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     AVSADR        BEGSR
     C***********************************************
     C     W2AD0A        IFEQ      *BLANKS
     C     W2AD4A        ANDEQ     *BLANKS
     C     WTNAA         ANDEQ     *BLANKS
     C     WTAD1A        ANDEQ     *BLANKS
     C     WTAD2A        ANDEQ     *BLANKS
     C     WTAD3A        ANDEQ     *BLANKS
     C                   MOVEL     WSNAA         W2NAA
     C                   MOVEL     WSAD1A        W2AD1A
     C                   MOVEL     WSAD2A        W2AD2A
     C                   MOVEL     WSAD3A        W2AD3A
     C                   END
      *
     C     STAVSR        TAG
     C                   EXFMT     ADRLINA
     C                   MOVE      '0'           *IN99
      *
     C     *IN12         IFEQ      '0'
     C     W2NAA         COMP      *BLANKS                                99
     C     *IN99         CABEQ     '1'           STAVSR
     C                   MOVEL     W2NAA         WSNAA
     C                   MOVEL     W2AD1A        WSAD1A
     C                   MOVEL     W2AD2A        WSAD2A
     C                   MOVEL     W2AD3A        WSAD3A
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOTADR        BEGSR
     C***********************************************
     C     W2AD0M        IFEQ      *BLANKS
     C     W2AD4M        ANDEQ     *BLANKS
     C     WTNAM         ANDEQ     *BLANKS
     C     WTAD1M        ANDEQ     *BLANKS
     C     WTAD2M        ANDEQ     *BLANKS
     C     WTAD3M        ANDEQ     *BLANKS
     C                   MOVEL     WSNAM         W2NAM
     C                   MOVEL     WSAD1M        W2AD1M
     C                   MOVEL     WSAD2M        W2AD2M
     C                   MOVEL     WSAD3M        W2AD3M
     C                   END
      *
     C     STMADR        TAG
     C                   EXFMT     ADRLINM
     C                   MOVE      '0'           *IN99
      *
     C     *IN12         IFEQ      '0'
     C     W2NAM         COMP      *BLANKS                                99
     C     *IN99         CABEQ     '1'           STMADR
     C                   MOVEL     W2NAM         WSNAM
     C                   MOVEL     W2AD1M        WSAD1M
     C                   MOVEL     W2AD2M        WSAD2M
     C                   MOVEL     W2AD3M        WSAD3M
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     NTFADR        BEGSR
     C***********************************************
     C     W2AD0N        IFEQ      *BLANKS
     C     W2AD4N        ANDEQ     *BLANKS
     C     WTNAN         ANDEQ     *BLANKS
     C     WTAD1N        ANDEQ     *BLANKS
     C     WTAD2N        ANDEQ     *BLANKS
     C     WTAD3N        ANDEQ     *BLANKS
     C                   MOVEL     WSNAN         W2NAN
     C                   MOVEL     WSAD1N        W2AD1N
     C                   MOVEL     WSAD2N        W2AD2N
     C                   MOVEL     WSAD3N        W2AD3N
     C                   END
      *
     C     STNADR        TAG
     C                   EXFMT     ADRLINN
     C                   MOVE      '0'           *IN99
      *
     C     *IN12         IFEQ      '0'
     C     W2NAN         COMP      *BLANKS                                99
     C     *IN99         CABEQ     '1'           STNADR
     C                   MOVEL     W2NAN         WSNAN
     C                   MOVEL     W2AD1N        WSAD1N
     C                   MOVEL     W2AD2N        WSAD2N
     C                   MOVEL     W2AD3N        WSAD3N
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     AGTADR        BEGSR
     C***********************************************
     C     W2AD0G        IFEQ      *BLANKS
     C     W2AD4G        ANDEQ     *BLANKS
     C     WTNAG         ANDEQ     *BLANKS
     C     WTAD1G        ANDEQ     *BLANKS
     C     WTAD2G        ANDEQ     *BLANKS
     C     WTAD3G        ANDEQ     *BLANKS
     C                   MOVEL     WSNAG         W2NAG
     C                   MOVEL     WSAD1G        W2AD1G
     C                   MOVEL     WSAD2G        W2AD2G
     C                   MOVEL     WSAD3G        W2AD3G
     C                   END
     C     STAGTR        TAG
     C                   EXFMT     ADRLING
     C                   MOVE      '0'           *IN99
      *
     C     *IN12         IFEQ      '0'
     C     W2NAG         COMP      *BLANKS                                99
     C     *IN99         CABEQ     '1'           STAGTR
     C                   MOVEL     W2NAG         WSNAG
     C                   MOVEL     W2AD1G        WSAD1G
     C                   MOVEL     W2AD2G        WSAD2G
     C                   MOVEL     W2AD3G        WSAD3G
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   MOVEA     '00000000'    *IN(51)
     C                   SETOFF                                       3359
     C*
     C     WSKNR         IFNE      0
     C                   MOVE      WSKNR         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        51
     C                   END
     C*
     C     WSKNA         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNA         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        52
     C                   END
     C*
     C     WSKNM         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNM         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        53
     C                   END
     C*
     C     WSKNN         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNN         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        54
     C                   END
     C*
     C     WSKNSA        IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNSA        KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        55
     C                   END
     C*
     C     WSKNK         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNK         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        56
     C                   END
     C*
     C     WSKNKA        IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNKA        KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        57
     C                   END
     C*
     C     WSKNRA        IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNRA        KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        58
     C                   END
     C*
     C     WSKNG         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNG         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        59
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTBO        BEGSR
     C***********************************************
     C     BOOKK         CHAIN(N)  BOOKING                            33
     C                   MOVE      BOSG          USG
     C                   MOVE      BOPRO         WSPRO
     C                   MOVE      BOAAR         WSAAR
     C                   MOVE      BOUKE         WSUKE
     C                   MOVE      BOKNR         WSKNR
     C                   MOVE      BOTR          WSTR
     C                   MOVE      BOKNA         WSKNA
     C                   MOVE      BOKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      BONAA         WSNAA
     C  N33              DO
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSAD1A
     C                   MOVE      ADR2          WSAD2A
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          WSAD3A
     C                   ELSE
     C     SYPOGE        CAT       ADR3:1        WSAD3A
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        WSAD3A
     C                   MOVE      ADR3          WSAD3A
     C                   END
     C                   END
     C                   MOVE      BOLB          WSLB
     C                   MOVE      BOLSH         WSLSH
     C                   MOVE      BODTD1        WSDTAD
     C                   MOVE      BODTM1        WSDTAM
     C                   MOVE      BODTÅ1        WSDTAÅ
     C                   MOVE      BOVH          WSVH
     C                   MOVE      BOOB          WSOB
     C                   MOVE      BOREIS        WSREIS
     C                   MOVE      BODTD3        WSDTVD
     C                   MOVE      BODTM3        WSDTVM
     C                   MOVE      BODTÅ3        WSDTVÅ
     C                   MOVE      BOLOH         WSLOH
     C                   MOVE      BODTD9        WSDLHD
     C                   MOVE      BODTM9        WSDLHM
     C                   MOVE      BODTÅ9        WSDLHÅ
     C                   MOVE      BOLOS         WSLOS
     C                   MOVE      BOLSTY        WSLSTY
     C                   MOVE      BOMM          WSMM
     C                   MOVE      BOLSS         WSLSS
     C                   MOVE      BOCH          WSCH
     C                   MOVE      BOMH          WSMH
     C                   MOVE      BOCP          WSCP
     C*
     C     BOOKK         CHAIN     BLLOK                              33
     C                   MOVE      BESD          WSSD
     C*
     C     BOAVDK        IFNE      0
     C                   MOVE      BOAVDK        UAVD2
     C                   MOVE      BOOPDK        UOPD2
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBLW        BEGSR
     C***********************************************
     C     BLATK         CHAIN(N)  BLADRT                             33
     C     *IN33         IFEQ      '1'
     C                   CLEAR                   BLADRTR
     C                   END
     C                   MOVE      BLPRO         WSPRO
     C                   MOVE      BLDTRD        WSDTRD
     C                   MOVE      BLDTRM        WSDTRM
     C                   MOVE      BLDTRÅ        WSDTRÅ
     C                   MOVE      BLKNR         WSKNR
     C                   MOVE      WSKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEL     KNAVN         WSNAR
     C   33              MOVE      *BLANKS       WSNAR
     C   33              SETOFF                                       33
     C                   MOVE      BLTR          WSTR
     C                   MOVE      BLOB          WSOB
     C                   MOVE      BLREIS        WSREIS
     C                   MOVE      BLBLNR        WSBLNR
     C                   MOVE      BLAAR         WSAAR
     C                   MOVE      BLUKE         WSUKE
     C                   MOVE      BLKNA         WSKNA
     C                   MOVE      BLDKA         WSDKA
     C                   MOVE      BLNAA         WSNAA
     C                   MOVE      BLAD1A        WSAD1A
     C                   MOVE      BLAD2A        WSAD2A
     C                   MOVE      BLAD3A        WSAD3A
     C                   MOVEL     BLAD0A        W2AD0A
     C                   MOVE      BTAD0A        W2AD0A
     C                   MOVEL     BLNAA         W2NAA
     C                   MOVE      BTNAA         W2NAA
     C                   MOVEL     BLAD1A        W2AD1A
     C                   MOVE      BTAD1A        W2AD1A
     C                   MOVEL     BLAD2A        W2AD2A
     C                   MOVE      BTAD2A        W2AD2A
     C                   MOVEL     BLAD3A        W2AD3A
     C                   MOVE      BTAD3A        W2AD3A
     C                   MOVEL     BLAD4A        W2AD4A
     C                   MOVE      BTAD4A        W2AD4A
     C                   MOVE      BLKNM         WSKNM
     C                   MOVE      BLDKM         WSDKM
     C                   MOVE      BLNAM         WSNAM
     C                   MOVE      BLAD1M        WSAD1M
     C                   MOVE      BLAD2M        WSAD2M
     C                   MOVE      BLAD3M        WSAD3M
     C                   MOVEL     BLAD0M        W2AD0M
     C                   MOVE      BTAD0M        W2AD0M
     C                   MOVEL     BLNAM         W2NAM
     C                   MOVE      BTNAM         W2NAM
     C                   MOVEL     BLAD1M        W2AD1M
     C                   MOVE      BTAD1M        W2AD1M
     C                   MOVEL     BLAD2M        W2AD2M
     C                   MOVE      BTAD2M        W2AD2M
     C                   MOVEL     BLAD3M        W2AD3M
     C                   MOVE      BTAD3M        W2AD3M
     C                   MOVEL     BLAD4M        W2AD4M
     C                   MOVE      BTAD4M        W2AD4M
     C                   MOVE      BLKNN         WSKNN
     C                   MOVE      BLDKN         WSDKN
     C                   MOVE      BLNAN         WSNAN
     C                   MOVE      BLAD1N        WSAD1N
     C                   MOVE      BLAD2N        WSAD2N
     C                   MOVE      BLAD3N        WSAD3N
     C                   MOVEL     BLAD0N        W2AD0N
     C                   MOVE      BTAD0N        W2AD0N
     C                   MOVEL     BLNAN         W2NAN
     C                   MOVE      BTNAN         W2NAN
     C                   MOVEL     BLAD1N        W2AD1N
     C                   MOVE      BTAD1N        W2AD1N
     C                   MOVEL     BLAD2N        W2AD2N
     C                   MOVE      BTAD2N        W2AD2N
     C                   MOVEL     BLAD3N        W2AD3N
     C                   MOVE      BTAD3N        W2AD3N
     C                   MOVEL     BLAD4N        W2AD4N
     C                   MOVE      BTAD4N        W2AD4N
     C                   MOVE      BLKNSA        WSKNSA
     C                   MOVE      BLDKSA        WSDKSA
     C                   MOVE      BLKNK         WSKNK
     C                   MOVE      BLDKK         WSDKK
     C                   MOVE      BLKNKA        WSKNKA
     C                   MOVE      BLDKKA        WSDKKA
     C                   MOVE      BLKNRA        WSKNRA
     C                   MOVE      BLDKRA        WSDKRA
     C                   MOVE      BLLSS         WSLSS
     C                   MOVE      BLLSS2        WSLSS2
     C                   MOVE      BLLSH         WSLSH
     C                   MOVE      BLLB          WSLB
     C                   MOVE      BLVH          WSVH
     C                   MOVE      BLDTVD        WSDTVD
     C                   MOVE      BLDTVM        WSDTVM
     C                   MOVE      BLDTVÅ        WSDTVÅ
     C                   MOVE      BLVH2         WSVH2
     C                   MOVE      BLDV2D        WSDV2D
     C                   MOVE      BLDV2M        WSDV2M
     C                   MOVE      BLDV2Å        WSDV2Å
     C                   MOVE      BLLOH         WSLOH
     C                   MOVE      BLDLHD        WSDLHD
     C                   MOVE      BLDLHM        WSDLHM
     C                   MOVE      BLDLHÅ        WSDLHÅ
     C                   MOVE      BLLOS         WSLOS
     C                   MOVE      BLLOS2        WSLOS2
     C                   MOVE      BLDTAD        WSDTAD
     C                   MOVE      BLDTAM        WSDTAM
     C                   MOVE      BLDTAÅ        WSDTAÅ
     C                   MOVE      BLKDP         WSKDP
     C                   MOVE      BLCH          WSCH
     C                   MOVE      BLMH          WSMH
     C                   MOVE      BLMM          WSMM
     C                   MOVE      BLMN          WSMN
     C                   MOVE      BLLSTY        WSLSTY
     C                   MOVE      BLKNG         WSKNG
     C                   MOVE      BLNAG         WSNAG
     C                   MOVE      BLAD1G        WSAD1G
     C                   MOVE      BLAD2G        WSAD2G
     C                   MOVE      BLAD3G        WSAD3G
     C                   MOVEL     BLAD0G        W2AD0G
     C                   MOVE      BTAD0G        W2AD0G
     C                   MOVEL     BLNAG         W2NAG
     C                   MOVE      BTNAG         W2NAG
     C                   MOVEL     BLAD1G        W2AD1G
     C                   MOVE      BTAD1G        W2AD1G
     C                   MOVEL     BLAD2G        W2AD2G
     C                   MOVE      BTAD2G        W2AD2G
     C                   MOVEL     BLAD3G        W2AD3G
     C                   MOVE      BTAD3G        W2AD3G
     C                   MOVEL     BLAD4G        W2AD4G
     C                   MOVE      BTAD4G        W2AD4G
     C                   MOVE      BLOLP         WSOLP
     C                   MOVE      BLOTP         WSOTP
     C                   MOVE      BLSFP         WSSFP
     C                   MOVE      BLDTP         WSDTP
     C                   MOVE      BLDLP         WSDLP
     C                   MOVE      BLMFP         WSMFP
     C                   MOVE      BLOLC         WSOLC
     C                   MOVE      BLOTC         WSOTC
     C                   MOVE      BLSFC         WSSFC
     C                   MOVE      BLDTC         WSDTC
     C                   MOVE      BLDLC         WSDLC
     C                   MOVE      BLMFC         WSMFC
     C                   MOVE      BLCP          WSCP
     C                   MOVE      BLNTBS        WSNTBS
     C                   MOVE      BLSD          WSSD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWS         BEGSR
     C***********************************************
     C                   MOVE      BLAVD         NESTAV
     C                   MOVE      BLOPD         NESTOP
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      ' '           BLST
     C  N33              UPDATE    BILLOFR
     C                   MOVE      UOPD          UOPD2
     C                   MOVE      *ZEROS        BLOPD
     C                   MOVE      *ZEROS        UOPD
     C                   MOVE      *BLANKS       WSBLNR
     C                   MOVE      *ZEROS        WSKNA
     C                   MOVE      *BLANKS       WSDKA
     C                   MOVE      *BLANKS       WSNAA
     C                   MOVE      *BLANKS       WSAD1A
     C                   MOVE      *BLANKS       WSAD2A
     C                   MOVE      *BLANKS       WSAD3A
     C                   MOVE      *BLANKS       W2AD0A
     C                   MOVE      *BLANKS       W2NAA
     C                   MOVE      *BLANKS       W2AD1A
     C                   MOVE      *BLANKS       W2AD2A
     C                   MOVE      *BLANKS       W2AD3A
     C                   MOVE      *BLANKS       W2AD4A
     C                   MOVE      *ZEROS        WSKNM
     C                   MOVE      *BLANKS       WSDKM
     C                   MOVE      *BLANKS       WSNAM
     C                   MOVE      *BLANKS       WSAD1M
     C                   MOVE      *BLANKS       WSAD2M
     C                   MOVE      *BLANKS       WSAD3M
     C                   MOVE      *BLANKS       W2AD0M
     C                   MOVE      *BLANKS       W2NAM
     C                   MOVE      *BLANKS       W2AD1M
     C                   MOVE      *BLANKS       W2AD2M
     C                   MOVE      *BLANKS       W2AD3M
     C                   MOVE      *BLANKS       W2AD4M
     C                   MOVE      *ZEROS        WSKNN
     C                   MOVE      *BLANKS       WSDKN
     C                   MOVE      *BLANKS       WSNAN
     C                   MOVE      *BLANKS       WSAD1N
     C                   MOVE      *BLANKS       WSAD2N
     C                   MOVE      *BLANKS       WSAD3N
     C                   MOVE      *BLANKS       W2AD0N
     C                   MOVE      *BLANKS       W2NAN
     C                   MOVE      *BLANKS       W2AD1N
     C                   MOVE      *BLANKS       W2AD2N
     C                   MOVE      *BLANKS       W2AD3N
     C                   MOVE      *BLANKS       W2AD4N
     C                   MOVE      *ZEROS        WSKNSA
     C                   MOVE      *BLANKS       WSDKSA
     C                   MOVE      *ZEROS        WSKNK
     C                   MOVE      *BLANKS       WSDKK
     C                   MOVE      *ZEROS        WSKNKA
     C                   MOVE      *BLANKS       WSDKKA
     C                   MOVE      *ZEROS        WSKNRA
     C                   MOVE      *BLANKS       WSDKRA
     C                   MOVE      *BLANKS       WSLOS
     C                   MOVE      *BLANKS       WSLOS2
     C                   MOVE      *BLANKS       WSKDP
     C                   MOVE      *BLANKS       WSCH
     C                   MOVE      *BLANKS       WSMH
     C                   MOVE      *BLANKS       WSLSTY
     C                   MOVE      *ZEROS        WSKNG
     C                   MOVE      *BLANKS       WSNAG
     C                   MOVE      *BLANKS       WSAD1G
     C                   MOVE      *BLANKS       WSAD2G
     C                   MOVE      *BLANKS       WSAD3G
     C                   MOVE      *BLANKS       W2AD0G
     C                   MOVE      *BLANKS       W2NAG
     C                   MOVE      *BLANKS       W2AD1G
     C                   MOVE      *BLANKS       W2AD2G
     C                   MOVE      *BLANKS       W2AD3G
     C                   MOVE      *BLANKS       W2AD4G
     C                   MOVE      *BLANKS       WSOLP
     C                   MOVE      *BLANKS       WSOTP
     C                   MOVE      *BLANKS       WSSFP
     C                   MOVE      *BLANKS       WSDTP
     C                   MOVE      *BLANKS       WSDLP
     C                   MOVE      *BLANKS       WSMFP
     C                   MOVE      *BLANKS       WSOLC
     C                   MOVE      *BLANKS       WSOTC
     C                   MOVE      *BLANKS       WSSFC
     C                   MOVE      *BLANKS       WSDTC
     C                   MOVE      *BLANKS       WSDLC
     C                   MOVE      *BLANKS       WSMFC
     C                   MOVE      *BLANKS       WSCP
     C                   MOVE      *BLANKS       WSNTBS
     C*                    MOVE *BLANKS   WSSD
     C                   MOVE      *ZEROS        NTV
     C                   MOVE      *BLANKS       KCV
     C                   MOVE      *BLANKS       MNV
     C                   MOVE      *BLANKS       VSV
     C                   MOVE      *ZEROS        VKV
     C                   MOVE      *ZEROS        M3V
     C                   MOVE      *BLANKS       EHV
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBL         BEGSR
     C***********************************************
     C   09WSPRO         IFEQ      0
     c     TRMODUL       andne     'J'
     C     UAVD          CHAIN     TELL                               33
     C   33XAVD0         CHAIN     TELL                               33
     C  N33              MOVE      TETURN        WSPRO
     C  N33              ADD       1             TETURN
     C  N33              UPDATE    TELLR
     C                   MOVE      *BLANKS       WSMN
     C     BLUR          IFEQ      'G'
     C     BOPRO         ANDEQ     0
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              MOVE      WSPRO         BOPRO
     C  N33              EXCEPT    NYPRO
     C                   END
     C                   END
     C*
     C     BLK           CHAIN     BILLOF                             33
     C                   EXSR      MOVWBL
     C  N33              DO
      * når fra TR-modul endre BL type også ved change..
     c     TRMODUL       ifeq      'J'
     C  N27              MOVE      'F'           BLUR
     C   27              MOVE      'G'           BLUR
     c                   end
     C                   UPDATE    BILLOFR
      *
      * OPPDATERE PÅ FREIGHT MANIFEST
     C     BLK           CHAIN     FRMDOC                             33
     C  N33              MOVE      BLBLNR        FMBLNR
     C  N33              UPDATE    FRMDOCR
     C*
     C*** OPPDATER OPPDRAG-REGISTER
     C     BLK           CHAIN(N)  HEADF                              33
     C  N33              DO
     C                   CALL      'SYSJ50K'
     C                   PARM                    BLAVD
     C                   PARM                    BLOPD
     C                   PARM                    BLSG
     C                   PARM                    NESTAV
     C                   PARM                    NESTOP
     C                   END
     C                   SETOFF                                       33
     C                   END
      *
     C   33              DO                                                     1<-B
     C     UOPD          IFEQ      0                                             2<-B
     C     UAVD          CHAIN     TELL                               33
     C   33XAVD0         CHAIN     TELL                               33
     C                   MOVE      TEOPDN        UOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   END                                                     2<-E
     C                   MOVE      UAVD          BLAVD
     C                   MOVE      UOPD          BLOPD
     C  N27              MOVE      'F'           BLUR
     C   27              MOVE      'G'           BLUR
     C     BLOB          CHAIN     CDBOAT                             33
     C                   MOVE      BLOB          BLBBK
     C                   MOVE      CBNAB         BLBBNA
     C                   MOVE      BLREIS        BLBREI
     C                   MOVE      BLBLNR        BLBBLN
     C                   MOVE      BLVH          BLBOMH
     C                   MOVE      *ZEROS        BLBDT
     C                   WRITE     BILLOFR
     C*
     C*** OPPDATER OPPDRAG-REGISTER
     C     UKUNBL        IFNE      'J'                                           2<-B
     C                   CALL      'SYSJ50K'
     C                   PARM                    BLAVD
     C                   PARM                    BLOPD
     C                   PARM                    BLSG
     C                   PARM                    NESTAV
     C                   PARM                    NESTOP
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     BLV1K3        SETLL     BLV1LF                             33
     C     BLV1K3        READE(N)  BLV1LF                                 33
     C   33UAVD2         IFNE      0
     C     UOPD2         ANDNE     0
     C                   EXSR      KOPIBV
     C                   ELSE
     C     BOOKK         CHAIN(N)  BOOKING                            33
     C  N33              EXSR      KOPIB2
     C                   END
     C*
     C                   MOVE      *ZEROS        NESTAV
     C                   MOVE      *ZEROS        NESTOP
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWBL        BEGSR
     C***********************************************
     C                   MOVE      'X'           BLST
     C     WSPRO         IFEQ      0
     C     UAVD          CHAIN     TELL                               30
     C   30XAVD0         CHAIN     TELL                               30
     C                   MOVE      TETURN        WSPRO
     C                   ADD       1             TETURN
     C                   UPDATE    TELLR
     C                   END
     C                   MOVE      WSPRO         BLPRO
     C                   MOVE      WSSG          BLSG
     C     WSDTR         IFEQ      0
     C                   MOVE      *ZEROS        BLDTR
     C                   ELSE
     C                   MOVE      WSDTRD        BLDTRD
     C                   MOVE      WSDTRM        BLDTRM
     C     WSDTRÅ        IFGT      50
     C     WSDTRÅ        ADD       1900          BLDTRÅ
     C                   ELSE
     C     WSDTRÅ        ADD       2000          BLDTRÅ
     C                   END
     C                   END
     C                   MOVE      WSKNR         BLKNR
     C                   MOVE      WSTR          BLTR
     C                   MOVE      WSREIS        BLREIS
     C                   MOVE      WSBLNR        BLBLNR
     C                   MOVE      WSOB          BLOB
     C                   MOVE      WSAAR         BLAAR
     C     WSAAR         IFGT      50
     C                   MOVE      '19'          BLACC
     C                   ELSE
     C                   MOVE      '20'          BLACC
     C                   END
     C                   MOVE      WSUKE         BLUKE
     C                   MOVE      WSKNA         BLKNA
     C                   MOVE      WSDKA         BLDKA
     C     *IN34         IFEQ      '0'
     C                   MOVE      WSNAA         BLNAA
     C                   MOVE      WSAD1A        BLAD1A
     C                   MOVE      WSAD2A        BLAD2A
     C                   MOVE      WSAD3A        BLAD3A
     C                   ELSE
     C                   MOVEL     W2NAA         BLNAA
     C                   MOVEL     W2AD1A        BLAD1A
     C                   MOVEL     W2AD2A        BLAD2A
     C                   MOVEL     W2AD3A        BLAD3A
     C                   END
     C                   MOVEL     W2AD0A        BLAD0A
     C                   MOVEL     W2AD4A        BLAD4A
     C                   MOVE      WSKNM         BLKNM
     C                   MOVE      WSDKM         BLDKM
     C     *IN31         IFEQ      '0'
     C                   MOVE      WSNAM         BLNAM
     C                   MOVE      WSAD1M        BLAD1M
     C                   MOVE      WSAD2M        BLAD2M
     C                   MOVE      WSAD3M        BLAD3M
     C                   ELSE
     C                   MOVEL     W2NAM         BLNAM
     C                   MOVEL     W2AD1M        BLAD1M
     C                   MOVEL     W2AD2M        BLAD2M
     C                   MOVEL     W2AD3M        BLAD3M
     C                   END
     C                   MOVEL     W2AD0M        BLAD0M
     C                   MOVEL     W2AD4M        BLAD4M
     C                   MOVE      WSKNN         BLKNN
     C                   MOVE      WSDKN         BLDKN
     C     *IN32         IFEQ      '0'
     C                   MOVE      WSNAN         BLNAN
     C                   MOVE      WSAD1N        BLAD1N
     C                   MOVE      WSAD2N        BLAD2N
     C                   MOVE      WSAD3N        BLAD3N
     C                   ELSE
     C                   MOVEL     W2NAN         BLNAN
     C                   MOVEL     W2AD1N        BLAD1N
     C                   MOVEL     W2AD2N        BLAD2N
     C                   MOVEL     W2AD3N        BLAD3N
     C                   END
     C                   MOVEL     W2AD0N        BLAD0N
     C                   MOVEL     W2AD4N        BLAD4N
     C                   MOVE      WSKNSA        BLKNSA
     C                   MOVE      WSDKSA        BLDKSA
     C                   MOVE      WSKNK         BLKNK
     C                   MOVE      WSDKK         BLDKK
     C                   MOVE      WSKNKA        BLKNKA
     C                   MOVE      WSDKKA        BLDKKA
     C                   MOVE      WSKNRA        BLKNRA
     C                   MOVE      WSDKRA        BLDKRA
     C                   MOVE      WSLSS         BLLSS
     C                   MOVE      WSLSS2        BLLSS2
     C                   MOVE      WSLSH         BLLSH
     C                   MOVE      WSLB          BLLB
     C                   MOVE      WSVH          BLVH
     C     WSDTVH        IFEQ      0
     C                   MOVE      *ZEROS        BLDTVH
     C                   ELSE
     C                   MOVE      WSDTVD        BLDTVD
     C                   MOVE      WSDTVM        BLDTVM
     C     WSDTVÅ        IFGT      50
     C     WSDTVÅ        ADD       1900          BLDTVÅ
     C                   ELSE
     C     WSDTVÅ        ADD       2000          BLDTVÅ
     C                   END
     C                   END
     C                   MOVE      WSVH2         BLVH2
     C     WSDVH2        IFEQ      0
     C                   MOVE      *ZEROS        BLDVH2
     C                   ELSE
     C                   MOVE      WSDV2D        BLDV2D
     C                   MOVE      WSDV2M        BLDV2M
     C     WSDV2Å        IFGT      50
     C     WSDV2Å        ADD       1900          BLDV2Å
     C                   ELSE
     C     WSDV2Å        ADD       2000          BLDV2Å
     C                   END
     C                   END
     C                   MOVE      WSLOH         BLLOH
     C     WSDLOH        IFEQ      0
     C                   MOVE      *ZEROS        BLDLOH
     C                   ELSE
     C                   MOVE      WSDLHD        BLDLHD
     C                   MOVE      WSDLHM        BLDLHM
     C     WSDLHÅ        IFGT      50
     C     WSDLHÅ        ADD       1900          BLDLHÅ
     C                   ELSE
     C     WSDLHÅ        ADD       2000          BLDLHÅ
     C                   END
     C                   END
     C                   MOVE      WSLOS         BLLOS
     C                   MOVE      WSLOS2        BLLOS2
     C                   MOVE      WSDTAD        BLDTAD
     C                   MOVE      WSDTAM        BLDTAM
     C     WSDTAÅ        IFGT      50
     C     WSDTAÅ        ADD       1900          BLDTAÅ
     C                   ELSE
     C     WSDTAÅ        ADD       2000          BLDTAÅ
     C                   END
     C                   MOVE      WSKDP         BLKDP
     C                   MOVE      WSCH          BLCH
     C                   MOVE      WSMH          BLMH
     C                   MOVE      WSMM          BLMM
     C                   MOVE      WSMN          BLMN
     C                   MOVE      WSLSTY        BLLSTY
     C                   MOVE      WSKNG         BLKNG
     C     *IN35         IFEQ      '0'
     C                   MOVE      WSNAG         BLNAG
     C                   MOVE      WSAD1G        BLAD1G
     C                   MOVE      WSAD2G        BLAD2G
     C                   MOVE      WSAD3G        BLAD3G
     C                   ELSE
     C                   MOVEL     W2NAG         BLNAG
     C                   MOVEL     W2AD1G        BLAD1G
     C                   MOVEL     W2AD2G        BLAD2G
     C                   MOVEL     W2AD3G        BLAD3G
     C                   END
     C                   MOVEL     W2AD0G        BLAD0G
     C                   MOVEL     W2AD4G        BLAD4G
     C                   MOVE      WSOLP         BLOLP
     C                   MOVE      WSOTP         BLOTP
     C                   MOVE      WSSFP         BLSFP
     C                   MOVE      WSDTP         BLDTP
     C                   MOVE      WSDLP         BLDLP
     C                   MOVE      WSMFP         BLMFP
     C                   MOVE      WSOLC         BLOLC
     C                   MOVE      WSOTC         BLOTC
     C                   MOVE      WSSFC         BLSFC
     C                   MOVE      WSDTC         BLDTC
     C                   MOVE      WSDLC         BLDLC
     C                   MOVE      WSMFC         BLMFC
     C                   MOVE      WSCP          BLCP
     C                   MOVE      WSNTBS        BLNTBS
     C                   MOVE      WSSD          BLSD
     C     BLOB          CHAIN     CDBOAT                             30
     C   30              MOVE      *BLANKS       CBNAB
     C   30              MOVE      '0'           *IN30
     C                   MOVE      BLOB          BLBBK
     C                   MOVE      CBNAB         BLBBNA
     C                   MOVE      BLREIS        BLBREI
     C                   MOVE      BLVH          BLBOMH
     C                   MOVE      BLBLNR        BLBBLN
     C  N27              MOVE      BLDTA         BLBDT
     C     BLATK         CHAIN     BLADRT                             99
     C  N99W2AD0A        IFEQ      *BLANKS
     C     W2AD4A        ANDEQ     *BLANKS
     C     WTNAA         ANDEQ     *BLANKS
     C     WTAD1A        ANDEQ     *BLANKS
     C     WTAD2A        ANDEQ     *BLANKS
     C     WTAD3A        ANDEQ     *BLANKS
     C     W2AD0M        ANDEQ     *BLANKS
     C     W2AD4M        ANDEQ     *BLANKS
     C     WTNAM         ANDEQ     *BLANKS
     C     WTAD1M        ANDEQ     *BLANKS
     C     WTAD2M        ANDEQ     *BLANKS
     C     WTAD3M        ANDEQ     *BLANKS
     C     W2AD0N        ANDEQ     *BLANKS
     C     W2AD4N        ANDEQ     *BLANKS
     C     WTNAN         ANDEQ     *BLANKS
     C     WTAD1N        ANDEQ     *BLANKS
     C     WTAD2N        ANDEQ     *BLANKS
     C     WTAD3N        ANDEQ     *BLANKS
     C     W2AD0G        ANDEQ     *BLANKS
     C     W2AD4G        ANDEQ     *BLANKS
     C     WTNAG         ANDEQ     *BLANKS
     C     WTAD1G        ANDEQ     *BLANKS
     C     WTAD2G        ANDEQ     *BLANKS
     C     WTAD3G        ANDEQ     *BLANKS
     C                   DELETE    BLADRTR
     C                   CLEAR                   BLADRTR
     C                   GOTO      SLMOVW
     C                   END
     C                   MOVE      BLAVD         BTAVD
     C                   MOVE      BLOPD         BTOPD
     C                   MOVE      W2AD0A        BTAD0A
     C                   MOVE      WTNAA         BTNAA
     C                   MOVE      WTAD1A        BTAD1A
     C                   MOVE      WTAD2A        BTAD2A
     C                   MOVE      WTAD3A        BTAD3A
     C                   MOVE      W2AD4A        BTAD4A
     C                   MOVE      W2AD0M        BTAD0M
     C                   MOVE      WTNAM         BTNAM
     C                   MOVE      WTAD1M        BTAD1M
     C                   MOVE      WTAD2M        BTAD2M
     C                   MOVE      WTAD3M        BTAD3M
     C                   MOVE      W2AD4M        BTAD4M
     C                   MOVE      W2AD0N        BTAD0N
     C                   MOVE      WTNAN         BTNAN
     C                   MOVE      WTAD1N        BTAD1N
     C                   MOVE      WTAD2N        BTAD2N
     C                   MOVE      WTAD3N        BTAD3N
     C                   MOVE      W2AD4N        BTAD4N
     C                   MOVE      W2AD0G        BTAD0G
     C                   MOVE      WTNAG         BTNAG
     C                   MOVE      WTAD1G        BTAD1G
     C                   MOVE      WTAD2G        BTAD2G
     C                   MOVE      WTAD3G        BTAD3G
     C                   MOVE      W2AD4G        BTAD4G
     C  N99              UPDATE    BLADRTR
     C   99              WRITE     BLADRTR
     C                   MOVE      '0'           *IN99
     C     SLMOVW        TAG
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KOPIBV        BEGSR
     C***********************************************
     C     BLV1K         SETLL     BLV1LF                             33
     C     STKBV1        TAG
     C     BLV1K         READE(N)  BLV1LF                                 33
     C  N33              DO
     C                   MOVE      BLAVD         BVAVD
     C                   MOVE      BLOPD         BVOPD
     C                   WRITE     BLV1R
     C                   GOTO      STKBV1
     C                   END
     C*
     C     BLV2K         SETLL     BLV2                               33
     C     STKBV2        TAG
     C     BLV2K         READE(N)  BLV2                                   33
     C  N33              DO
     C                   MOVE      BLAVD         BVAVD
     C                   MOVE      BLOPD         BVOPD
     C                   WRITE     BLV2R
     C                   GOTO      STKBV2
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KOPIB2        BEGSR
     C***********************************************
     C                   Z-ADD     0             BVLI
     C                   MOVE      BOAVD         BVAVD
     C                   MOVE      BOOPD         BVOPD
     C     1             DO        4             XN                4 0          1<-B
     C     NT(XN)        IFNE      0                                             2<-B
     C     MN(XN)        ORNE      *BLANKS
     C     VS(XN)        ORNE      *BLANKS
     C     VK(XN)        ORNE      0
     C     M3(XN)        ORNE      0
     C                   ADD       1             BVLI
     C                   MOVE      BVLI          BVSORT
     C                   MOVEL     MN(XN)        BVMN
     C                   MOVE      NT(XN)        BVNT
     C                   MOVE      VK(XN)        BVVKT
     C                   MOVE      M3(XN)        BVM3
     C                   MOVE      KC(XN)        BVKDC
     C                   MOVE      *ZEROS        BVENH
     C     KC(XN)        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      VS(XN)        BVVS
     C                   ELSE                                                     3
     C                   MOVE      KC(XN)        YKDC              2
     C     YKDC          CHAIN     CDCON4                             33
     C   33              MOVE      VS(XN)        BVVS
     C  N33              MOVEL     CC4FT         BVVS
     C  N33              MOVE      CC4NT         BVENH
     C  N33VS(XN)        IFNE      *BLANKS                                         4<-B
     C                   WRITE     BLV1R
     C                   MOVE      *BLANKS       BVMN
     C                   MOVEL     VS(XN)        BVVS
     C                   ADD       1             BVLI
     C                   MOVE      BVLI          BVSORT
     C                   MOVE      *ZEROS        BVNT
     C                   MOVE      *BLANKS       BVKDC
     C                   MOVE      *ZEROS        BVENH
     C                   MOVE      *ZEROS        BVVKT
     C                   MOVE      *ZEROS        BVM3
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   WRITE     BLV1R
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TILV          BEGSR
     C***********************************************
     C                   MOVE      WSDTR         UDTR              6 0
     C   11              GOTO      STTV2
     C*
     C     STTV1         TAG
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYSJ50E'
     C                   PARM                    UAVD
     C                   PARM                    BLOPD
     C                   PARM                    UDTR
     C                   PARM                    BLSG
     C                   PARM                    BLUKE
     C                   PARM                    BLAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      2
     C                   GOTO      STTV2
     C                   ELSE
     C                   GOTO      SLTV
     C                   END
     C*
     C     STTV2         TAG
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYSJ50F'
     C                   PARM                    UAVD
     C                   PARM                    BLOPD
     C                   PARM                    UDTR
     C                   PARM                    BLSG
     C                   PARM                    BLUKE
     C                   PARM                    BLAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      1
     C                   GOTO      STTV1
     C                   END
     C*
     C     SLTV          ENDSR
     C*
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
     C                   MOVE      TXT           UTXT             64
     C                   MOVE      KN            UKN              64
     C                   MOVE      KD            UKD               8
     C                   CALL      'SOEKUNBL'
     C                   PARM                    FIFIRM
     C                   PARM                    SOANTK
     C                   PARM                    UTXT
     C                   PARM                    UKN
     C                   PARM                    UKD
     C                   Z-ADD     0             UFLAGG
     C                   MOVE      UTXT          TXT
     C                   MOVE      UKN           KN
     C                   MOVE      UKD           KD
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKU2        BEGSR
     C***********************************************
     C                   CALL      'SOEKUN'
     C                   PARM                    FIFIRM
     C                   PARM                    SOANT2
     C                   PARM                    SOTXT9
     C                   PARM                    WSKNG
     C                   PARM                    SOTXT2
     C                   PARM                    SOKNR2
     C                   PARM                    SOTXT3
     C                   PARM                    SOKNR3
     C                   PARM                    SOTXT4
     C                   PARM                    SOKNR4
     C                   PARM                    SOTXT5
     C                   PARM                    SOKNR5
     C                   PARM                    SOTXT6
     C                   PARM                    SOKNR6
     C                   PARM                    SOTXT7
     C                   PARM                    SOKNR7
     C                   PARM                    SOTXT8
     C                   PARM                    SOKNR8
     C                   Z-ADD     0             UFLAGG
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     POSNBR        IFGE      6
     C     POSNBR        ANDLE     13
     C   51LINNBR        IFEQ      3
     C                   MOVE      SOTXT1        YSKMOT            8
     C                   MOVE      WSKNR         YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C   52LINNBR        IFEQ      4
     C                   MOVE      SOTXT2        YSKMOT
     C                   MOVE      WSKNA         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C   53LINNBR        IFEQ      6
     C                   MOVE      SOTXT3        YSKMOT
     C                   MOVE      WSKNM         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C   54LINNBR        IFEQ      8
     C                   MOVE      SOTXT4        YSKMOT
     C                   MOVE      WSKNN         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C                   END
     C*
     C     LINNBR        IFEQ      10
     C   55POSNBR        IFGE      11
     C     POSNBR        ANDLE     18
     C                   MOVE      SOTXT5        YSKMOT
     C                   MOVE      WSKNSA        YSKKNR
     C                   GOTO      STVISO
     C                   END
     C   56POSNBR        IFGE      31
     C     POSNBR        ANDLE     38
     C                   MOVE      SOTXT6        YSKMOT
     C                   MOVE      WSKNK         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C   57POSNBR        IFGE      51
     C     POSNBR        ANDLE     58
     C                   MOVE      SOTXT7        YSKMOT
     C                   MOVE      WSKNKA        YSKKNR
     C                   GOTO      STVISO
     C                   END
     C   58POSNBR        IFGE      71
     C     POSNBR        ANDLE     78
     C                   MOVE      SOTXT8        YSKMOT
     C                   MOVE      WSKNRA        YSKKNR
     C                   GOTO      STVISO
     C                   END
     C                   END
     C*
     C   59POSNBR        IFGE      50
     C     POSNBR        ANDLE     57
     C     LINNBR        IFEQ      15
     C                   MOVE      SOTXT9        YSKMOT            8
     C                   MOVE      WSKNG         YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C                   END
     C*
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     37
     C     POSNBR        ANDLE     40
     C                   Z-ADD     1             UFLAGG
     C                   Z-ADD     2             UKODE2            1 0
     C                   CALL      'SYSJ05'
     C                   PARM                    UKODE2
     C                   PARM      WSKNR         UKNR              8 0
     C                   PARM      WSTR          UTR               4
     C                   PARM                    ULK               2
     C                   PARM                    UDT               6 0
     C                   PARM                    UKD2              3
     C                   PARM                    UFLAGG
     C                   GOTO      SLVISO
     C                   END
     C*
     C                   MOVE      'DIV3730'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
     C*
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    YSKKNR
     C                   PARM                    YSKMOT
     C                   PARM                    UFLAGG
     C                   PARM                    HEUR01
     C*
     C     SLVISO        ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      3
     C     POSNBR        IFGE      6
     C     POSNBR        ANDLE     13
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C                   END
      *
     C  N34LINNBR        IFEQ      4
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
      *
     C  N31LINNBR        IFEQ      6
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
      *
     C  N32LINNBR        IFEQ      8
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      10
     C     POSNBR        IFGE      11
     C     POSNBR        ANDLE     18
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      31
     C     POSNBR        ANDLE     38
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      51
     C     POSNBR        ANDLE     58
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      71
     C     POSNBR        ANDLE     78
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK
     C                   END
     C                   END
     C*
     C  N35LINNBR        IFEQ      15
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     57
     C                   EXSR      SØKKU2
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   Z-ADD     1             UFLAGG
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     59
     C     POSNBR        ANDLE     63
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSOB
     C                   Z-ADD     70            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     37
     C     POSNBR        ANDLE     40
     C                   CALL      'SYSJ17A'
     C                   PARM      WSKNR         UKNR              8 0
     C                   PARM                    WSTR
     C     UKNR          IFNE      0
     C     WSTR          ANDNE     *BLANKS
     C                   MOVE      UKNR          WSKNR
     C                   END
     C                   Z-ADD     47            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLSS
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     30
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLSH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     38            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     38
     C     POSNBR        ANDLE     42
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSLB
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     54
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSVH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     56            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     73
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSVH2
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     75            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLOH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     27            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     27
     C     POSNBR        ANDLE     31
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLOS
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     73
     C                   CALL      'SYSJ14A'
     C                   PARM                    WSKDP
     C                   Z-ADD     80            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     71
     C                   CALL      'SYSJ19A'
     C                   PARM                    WSLSTY
     C                   Z-ADD     80            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     50
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSD
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     58            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C  N27POSNBR        IFLE      28
     C     POSNBR        ANDLE     29
     C     LINNBR        IFEQ      17
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKD01
     C     WSKD01        IFNE      *BLANKS
     C     WSKD01        CHAIN     CDCON4                             33
     C  N33              MOVEL     CC4FT         WSVS01
     C  N33              MOVE      CC4NT         WSEH01
     C                   END
     C                   Z-ADD     58            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      18
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKD02
     C     WSKD02        IFNE      *BLANKS
     C     WSKD02        CHAIN     CDCON4                             33
     C  N33              MOVEL     CC4FT         WSVS02
     C  N33              MOVE      CC4NT         WSEH02
     C                   END
     C                   Z-ADD     58            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      19
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKD03
     C     WSKD03        IFNE      *BLANKS
     C     WSKD03        CHAIN     CDCON4                             33
     C  N33              MOVEL     CC4FT         WSVS03
     C  N33              MOVE      CC4NT         WSEH03
     C                   END
     C                   Z-ADD     58            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      20
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKD04
     C     WSKD04        IFNE      *BLANKS
     C     WSKD04        CHAIN     CDCON4                             33
     C  N33              MOVEL     CC4FT         WSVS04
     C  N33              MOVE      CC4NT         WSEH04
     C                   END
     C                   Z-ADD     58            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     UTBL          BEGSR
     C***********************************************
     C     KODTVK        CHAIN     KOVR                               33
     C                   MOVE      *BLANKS       UPRT26           10
     C                   MOVE      *BLANKS       UPT26            10
     C  N33              Z-ADD     28            YPLNR             3 0
     C  N33KODTPK        CHAIN     KOPR                               33
     C  N33              MOVE      KOPNVN        UPRT28           10
     C  N33              MOVE      KOPTY         UPT28            10
     C     UPRT28        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT28
     C                   END
     C     UPT28         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT28
     C                   END
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      ' '           BLST
     C  N33              UPDATE    BILLOFR
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      UAVD          UDSAVD
     C                   MOVE      USG           UDSSG
     C                   MOVE      UOPD          UOPDF             7 0
     C                   MOVE      UOPD          UOPDT             7 0
     C                   MOVE      WSKOPI        UKOPI             2
     C                   CALL      'SYSJ15CL'
     C                   PARM                    UOPDF
     C                   PARM                    UOPDT
     C                   PARM                    UPRT26
     C                   PARM                    UPT26
     C                   PARM                    UPRT28
     C                   PARM                    UPT28
     C                   PARM                    WSJBK
     C                   PARM                    UKOPI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     UTADV         BEGSR
     C***********************************************
     C     KODTVK        CHAIN     KOVR                               33
     C  N33              Z-ADD     31            YPLNR             3 0
     C  N33KODTPK        CHAIN     KOPR                               33
     C  N33              MOVE      KOPNVN        UPRT31           10
     C  N33              MOVE      KOPTY         UPT31            10
     C     UPRT31        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT31
     C                   END
     C     UPT31         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT31
     C                   END
     C     BLK           CHAIN     BILLOF                             33
     C  N33              MOVE      ' '           BLST
     C  N33              UPDATE    BILLOFR
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      UAVD          UDSAVD
     C                   MOVE      USG           UDSSG
     C                   MOVE      UOPD          UOPDF
     C                   MOVE      UOPD          UOPDT
     C     WSADV         IFEQ      'J'
     C     WSFAX         ANDEQ     'J'
     C                   MOVE      'J'           UUTSKR            1
     C                   ELSE
     C                   MOVE      'N'           UUTSKR
     C                   END
     C                   CALL      'SYSJ16CL'
     C                   PARM                    UOPDF
     C                   PARM                    UOPDT
     C                   PARM                    UPRT31
     C                   PARM                    UPT31
     C                   PARM                    WSJBK
     C                   PARM                    WSFAX
     C                   PARM                    WSCVP
     C                   PARM                    UUTSKR
N01  C                   PARM                    UFLAG             1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BLK           KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     BLK2          KLIST
     C                   KFLD                    UAVD2
     C                   KFLD                    UOPD2
     C     BLATK         KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
     C     BOOKK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     BLV1K3        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     BLV1K         KLIST
     C                   KFLD                    UAVD2
     C                   KFLD                    UOPD2
     C     BLV2K         KLIST
     C                   KFLD                    UAVD2
     C                   KFLD                    UOPD2
     C     CDTRK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNR
     C                   KFLD                    WSTR
     C     CDTRK2        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSTR
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    YPLNR
     C     KODTVK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    UAVD
     C     FRATXK        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    HEUR01            1
     C     FRAT2K        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    HEUR02            1
     C     FREETK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     KODSFK        KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    WSSG
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    USG               3
     C                   PARM                    UKUNBL            1
     C*** UAVD2, UOPD2 <> 0  -->  KOPIERE B/L
     C                   PARM                    UAVD2             4 0
     C                   PARM                    UOPD2             7 0
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    ULUNIK            9 0
     C*
     C*** UFLAGG = 1  -->  IMPORT FRA SYSJ50H  27 AV
     C*** UFLAGG = 2  -->  EXPORT FRA SYSJ50H  28 AV
     C*** UFLAGG = 3  -->  EXPORT FRA SYSJ50A  28 PÅ
     C*** UFLAGG = 8  -->  IMPORT FRA SYTR10   27 AV
     C*** UFLAGG = 9  -->  EXPORT FRA SYTR10   28 AV
     c     UFLAGG        ifeq      8
     c                   move      'J'           TRMODUL           1
     c                   move      '1'           *IN50
     c                   move      1             UFLAGG
     c                   end
     c     UFLAGG        ifeq      9
     c                   move      'J'           TRMODUL           1
     c                   move      '1'           *IN50
     c                   move      2             UFLAGG
     c                   end
     C     UFLAGG        COMP      1                                  2727
     C   27UFLAGG        COMP      2                                  28
     C*
     C                   MOVE      'G'           HEUR01
     C     UFLAGG        IFEQ      1
     C                   MOVE      'F'           HEUR01
     C                   END
     C                   MOVE      *ZEROS        YFXLNR            2 0
     C                   MOVE      *ZEROS        XAVD0             4 0
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'P'           YPUNI             1
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      'SF'          KOSFUN
     C                   Z-ADD     8             SOANTK            1 0
     C                   Z-ADD     1             SOANT2            1 0
     C                   MOVE      *BLANKS       TXT
     C                   MOVE      *BLANKS       KD
     C                   MOVE      *ZEROS        KN
     C                   MOVE      *ZEROS        SOKNR2            8 0
     C                   MOVE      *ZEROS        SOKNR3            8 0
     C                   MOVE      *ZEROS        SOKNR4            8 0
     C                   MOVE      *ZEROS        SOKNR5            8 0
     C                   MOVE      *ZEROS        SOKNR6            8 0
     C                   MOVE      *ZEROS        SOKNR7            8 0
     C                   MOVE      *ZEROS        SOKNR8            8 0
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        BLDTR
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      *ZEROS        BLDTA
     C                   MOVE      *ZEROS        WSDTVH
     C                   MOVE      *ZEROS        BLDTVH
     C                   MOVE      *ZEROS        WSDVH2
     C                   MOVE      *ZEROS        BLDVH2
     C                   MOVE      *ZEROS        WSDLOH
     C                   MOVE      *ZEROS        BLDLOH
     C                   MOVE      *ZEROS        BODT1
     C                   MOVE      *ZEROS        BODT3
     C                   MOVE      *ZEROS        BODT9
     C                   MOVE      *ZEROS        NT
     C                   MOVE      *BLANKS       KC
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       VS
     C                   MOVE      *ZEROS        VK
     C                   MOVE      *ZEROS        M3
     C*
     C                   MOVE      'DIV3114'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT1            8
     C                   MOVE      'DIV3110'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C                   MOVE      'DIV3159'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT3            8
     C                   MOVE      'DIV3160'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT4            8
     C                   MOVE      'DIV3194'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT5            8
     C                   MOVE      'DIV1062'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT6            8
     C                   MOVE      'DIV3196'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT7            8
     C                   MOVE      'YBC0198'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT8            8
     C                   MOVE      'DIV1064'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT9            8
     C*
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM                               33
     C                   READ      FIRM                                   33
     C*
     C     BLK           CHAIN     BILLOF                             33
     C     *IN33         IFEQ      '0'
     C     BOOKK         CHAIN(N)  BOOKING                            33
     C  N33              MOVE      BOSG          BLSG
     C                   MOVE      BLSG          WSSG
     C                   MOVE      'X'           BLST
     C                   UPDATE    BILLOFR
     C                   EXSR      MOVBLW
     C* HVIS POST FINNES I BL-REG MEN IKKE I HEAD (EDI??)
     C*** OPPDATER OPPDRAG-REGISTER
     C     BLK           CHAIN(N)  HEADF                              33
     C     UKUNBL        IFNE      'J'                                           2<-B
     C     *IN33         ANDEQ     '1'                                           2<-B
     C                   CALL      'SYSJ50K'
     C                   PARM                    BLAVD
     C                   PARM                    BLOPD
     C                   PARM                    BLSG
     C                   PARM                    NESTAV
     C                   PARM                    NESTOP
     C                   END                                                     2<-E
     C                   ELSE
     C                   MOVE      USG           WSSG
     C                   MOVE      UDAY          WSDTRD
     C                   MOVE      UMONTH        WSDTRM
     C                   MOVE      UYEAR         WSDTRÅ
     C*
     C*** UAVD2, UOPD2 <> 0  -->  KOPIERE B/L
     C     UAVD2         IFNE      0
     C     UOPD2         ANDNE     0
     C     BLK2          CHAIN     BILLOF                             33
     C                   EXSR      MOVBLW
     C                   MOVE      USG           BLSG
     C                   MOVE      *ZEROS        BLOPD
     C                   MOVE      *ZEROS        BLPRO
     C                   MOVE      *ZEROS        WSPRO
     C                   END
     C                   END
     C*
     C*** IND. 28 PÅ  -->  FRA BOOKING (KOPI BOOKING/LOKAL B/L)
     C   28
     CAN 33              EXSR      HENTBO
      * HENTER 4 FØRSTE LINJER AV MODELL-1 (F10) PÅ SKJERMEN
      * KUN FOR IMPORT
     C  N27              EXSR      HENTBV
      *
     C     BLSG          IFNE      *BLANKS
     C     BLSG          ANDNE     USG
     C                   MOVE      'YBC0036'     MSGNR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTBV        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        NTV
     C                   MOVE      *BLANKS       KCV
     C                   MOVE      *BLANKS       MNV
     C                   MOVE      *BLANKS       VSV
     C                   MOVE      *ZEROS        VKV
     C                   MOVE      *ZEROS        M3V
     C                   MOVE      *BLANKS       EHV
     C     BLK           SETLL     BLV1LF                             33
     C                   MOVE      *ZEROS        XN
     C     STHBV         TAG
     C     BLK           READE(N)  BLV1LF                                 33
     C  N33XN            IFLT      4
     C                   ADD       1             XN
     C                   MOVE      BVNT          NTV(XN)
     C                   MOVE      BVMN          MNV(XN)
     C                   MOVE      BVVS          VSV(XN)
     C                   MOVE      BVVKT         VKV(XN)
     C                   MOVE      BVM3          M3V(XN)
     C                   MOVE      BVENH         EHV(XN)
     C                   MOVE      BVKDC         KCV(XN)
     C                   GOTO      STHBV
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBV         BEGSR
     C***********************************************
     C     1             DO        4             XN
     C                   Z-SUB     1             SOR(XN)
     C                   END
     C     BLK           SETLL     BLV1LF                             33
     C                   MOVE      *ZEROS        XN
     C     XN            DOWLT     4
     C     BLK           READE     BLV1LF                                 33
     C  N33              DELETE    BLV1R
     C  N33              ADD       1             XN
     C  N33              MOVE      BVSORT        SOR(XN)
     C   33              ADD       4             XN
     C                   END
     C                   MOVE      *ZEROS        BVSORT
      *
     C     1             DO        4             XN
     C     MNV(XN)       IFNE      *BLANKS
     C     VSV(XN)       ORNE      *BLANKS
     C     NTV(XN)       ORNE      0
     C     VKV(XN)       ORNE      0
     C     M3V(XN)       ORNE      0
     C     KCV(XN)       ORNE      *BLANKS
     C                   MOVE      BLAVD         BVAVD
     C                   MOVE      BLOPD         BVOPD
     C                   MOVE      XN            BVLI
     C     SOR(XN)       IFEQ      0
     C     SOR(XN)       OREQ      -1
     C                   MOVE      BVLI          BVSORT
     C                   ELSE
     C                   MOVE      SOR(XN)       BVSORT
     C                   END
     C                   MOVE      MNV(XN)       BVMN
     C                   MOVE      NTV(XN)       BVNT
     C                   MOVE      VSV(XN)       BVVS
     C                   MOVE      VKV(XN)       BVVKT
     C                   MOVE      M3V(XN)       BVM3
     C                   MOVE      EHV(XN)       BVENH
     C                   MOVE      KCV(XN)       BVKDC
     C                   WRITE     BLV1R
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTRD        UDT1              2 0
     C                   MOVE      WSDTRM        UDT2              2 0
     C                   MOVE      WSDTRÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   MOVE      WSDTAD        UDT1
     C                   MOVE      WSDTAM        UDT2
     C                   MOVE      WSDTAÅ        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTAD
     C                   MOVE      UDT2          WSDTAM
     C                   MOVE      UDT3          WSDTAÅ
     C*
     C                   MOVE      WSDTVD        UDT1
     C                   MOVE      WSDTVM        UDT2
     C                   MOVE      WSDTVÅ        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTVD
     C                   MOVE      UDT2          WSDTVM
     C                   MOVE      UDT3          WSDTVÅ
     C*
     C                   MOVE      WSDV2D        UDT1
     C                   MOVE      WSDV2M        UDT2
     C                   MOVE      WSDV2Å        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDV2D
     C                   MOVE      UDT2          WSDV2M
     C                   MOVE      UDT3          WSDV2Å
     C*
     C                   MOVE      WSDLHD        UDT1
     C                   MOVE      WSDLHM        UDT2
     C                   MOVE      WSDLHÅ        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDLHD
     C                   MOVE      UDT2          WSDLHM
     C                   MOVE      UDT3          WSDLHÅ
      *
     C                   ENDSR
      *
     OBOOKINGR  E            NYPRO
     O                       BOPRO
     OHEADFR    E            NYOPST
     O                       HEST
