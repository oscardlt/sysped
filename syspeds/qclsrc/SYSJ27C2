             PGM        PARM(&PAR1 &PAR2 &CVP1 &CVP2 &PRT33 &PT33 +
                          &PRT34 &PT34 &FTXT)
             DCL        VAR(&PAR1) TYPE(*CHAR) LEN(256)
             DCL        VAR(&PAR2) TYPE(*CHAR) LEN(256)
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(833)
             DCL        VAR(&FYLL) TYPE(*CHAR) LEN(1) VALUE('.') /* +
                          Sette '.' for å få riktig coverpage pga. +
                          faximile */
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(160)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(160)
             DCL        VAR(&PRT33) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PT33) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT34) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PT34) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAXSY) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FTXT) TYPE(*CHAR) LEN(900)
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCLF       FILE(FAXSEN)
             RCVF       RCDFMT(*FILE)
       /* */
             OVRMSGF    MSGF(QUSERMSG) TOMSGF(SYMSGF)
/*                      */
/*  E-MAIL              */
/*                      */
             CHGVAR     VAR(&EPOSTJ) VALUE(%SST(&PAR2 53 1))
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             CHGVAR     VAR(&PARM) VALUE(&PAR1 *CAT &PAR2 *CAT &CVP1 +
                          *CAT &CVP2 *CAT &FYLL)
             SBMJOB     CMD(CALL PGM(SYSJ27C2E) PARM(&PARM)) +
                          JOB(SNDFAXFAKT) JOBD(*USRPRF) +
                          JOBQ(SYJOBQNMAX)
             GOTO       CMDLBL(SLUTT)
             ENDDO
       /* */
             CHGVAR     VAR(&FAX) VALUE(%SST(&PAR2 51 1))
             IF         COND(&FAX = 'J') THEN(DO)
             CHGVAR     VAR(&FAXSY) VALUE(%SST(&PAR2 50 1))
             CHGVAR     VAR(&PARM) VALUE(&PAR1 *CAT &PAR2 *CAT &CVP1 +
                          *CAT &CVP2 *CAT &FYLL)
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*                         */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ27C2F) PARM(&PARM)) +
                          JOB(FAXMANIF) JOBD(*USRPRF) +
                          JOBQ(QFAX/QFAXJOBQ)
             ENDDO
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ27C2N) PARM(&PARM &FTXT)) +
                     JOB(MANIFEST) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             ENDDO
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ27C2B) PARM(&PARM &FTXT)) +
                     JOB(MANIFEST) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             ENDDO
             GOTO       CMDLBL(SLUTT)
             ENDDO
       /* */
             OVRPRTF    FILE(SYSJ27P) OUTQ(&PRT33) PAGESIZE(48 198) +
                          CPI(15) OVRFLW(45) FORMTYPE(&PT33)
             OVRPRTF    FILE(SYSJ27P2) OUTQ(&PRT34) PAGESIZE(48 198) +
                          CPI(15) OVRFLW(45) FORMTYPE(&PT34)
             CALL       PGM(SYSJ27C) PARM(&PAR1)
       /* */
 SLUTT:      ENDPGM
