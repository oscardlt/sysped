      *
      ************************************************************
      *** PROGRAM SKAL VISE OPPLYSNINGER AV SELGER/KJØPER      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 01-11 13-26                       ***
      *** LEDIGE INDIKATORER 27-32 34-99                       ***
      ************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 F16 = se arkiv
10XXX * 02 JOV PTF10 seperat indikator for vis/skul user/dato
********************************************************************
      *
      *
     FKOFAST    IF   E           K DISK
     FFRATXT    UF A E           K DISK
     FCUNDL01   IF   E           K DISK
N01  FARKIVL11  IF   E           K DISK
     FFRITXTSKD CF   E             WORKSTN
     D                SDS
     D  ZUSER                254    263
     D                 DS
     D  Idag                   1      8  0
     D    IdagHH               1      2  0
     D    IdagÅÅ               3      4  0
     D    IdagMM               5      6  0
     D    IdagDD               7      8  0
     D                 DS
     D  FXTXT                  1     79
     D  FXTXTBLANK            58     60
     D  FXTXTUSR              61     70
     D  FXTXTDT               72     79
     D                 DS
     D  WST1                   1     79
     D  WST2                  80    158
     D  WST3                 159    237
     D  WST4                 238    316
     D  WST5                 317    395
     D  WST6                 396    474
     D  WST7                 475    553
     D  WST8                 554    632
     D  WST9                 633    711
     D  WST10                712    790
     D  WST11                791    869
     D  WST12                870    948
     D  WST13                949   1027
     D  WST14               1028   1106
     D  WST15               1107   1185
     D  WST16               1186   1264
     D  WST17               1265   1343
     D  WST18               1344   1422
     D  WST19               1423   1501
     D  WST20               1502   1580
     D  WST21               1581   1659
     D  WST22               1660   1738
     D  WST23               1739   1817
     D  WST24               1818   1896
     D  WST25               1897   1975
     D  WST26               1976   2054
     D  WST27               2055   2133
     D  WST28               2134   2212
     D  WST29               2213   2291
     D  WST30               2292   2370
     D  WST31               2371   2449
     D  WST32               2450   2528
     D  WST33               2529   2607
     D  WST34               2608   2686
     D  WST35               2687   2765
     D  WST36               2766   2844
     D  WST37               2845   2923
     D  WST38               2924   3002
     D  WST39               3003   3081
     D  WST40               3082   3160
     D  WST41               3161   3239
     D  WST42               3240   3318
     D  WST43               3319   3397
     D  WST44               3398   3476
     D  WST45               3477   3555
     D  WST46               3556   3634
     D  WST47               3635   3713
     D  WST48               3714   3792
     D  WST49               3793   3871
     D  WST50               3872   3950
     D  WST51               3951   4029
     D  WST52               4030   4108
     D  WST53               4109   4187
     D  WST54               4188   4266
     D  WST55               4267   4345
     D  WST56               4346   4424
     D  WST57               4425   4503
     D  WST58               4504   4582
     D  WST59               4583   4661
     D  WST60               4662   4740
     D  WST61               4741   4819
     D  WST62               4820   4898
     D  WST63               4899   4977
     D  WST64               4978   5056
     D  WST65               5057   5135
     D  WST66               5136   5214
     D  WST67               5215   5293
     D  WST68               5294   5372
     D  WST69               5373   5451
     D  WST70               5452   5530
     D  WST71               5531   5609
     D  WST72               5610   5688
     D  WST73               5689   5767
     D  WST74               5768   5846
     D  WST75               5847   5925
     D  WST76               5926   6004
     D  WST77               6005   6083
     D  WST78               6084   6162
     D  WST79               6163   6241
     D  WST80               6242   6320
     D  TX                     1   6320
     D                                     DIM(80)
     D                 DS
     D  HA                     1     20
     D                                     DIM(20)
     D  HAR                    1     20
     C*
     C     KEYDEL        KLIST
     C                   KFLD                    UTYP
     C                   KFLD                    FDELSY            5
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    UKUNR
     C     FRATXK        KLIST
     C                   KFLD                    UKUNR
     C                   KFLD                    DELSYS
     C                   KFLD                    XFXLNR
     C                   MOVE      *ZEROS        XFXLNR            2 0
     C     FRATX2        KLIST
     C                   KFLD                    UKUNR
     C                   KFLD                    DELSYS
N01  C     ArkKey11      KLIST
N01  C                   KFLD                    ARSTAT
N01  C                   KFLD                    uuparu
N01  C                   move      'A'           ARSTAT
N01  C                   MOVEL     'K:'          uuparu
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UKUNR
     C                   PARM                    UTXT              8
     C                   PARM                    UFLAGG            1 0
     C                   PARM                    UDELSY            1
     C                   MOVE      UDELSY        UUUDEL            1
     C                   MOVEL     'DELSYS'      UTYP
     C*
     c                   move      20            IdagHH
     c                   move      uyear         IdagÅÅ
     c                   move      umonth        IdagMM
     c                   move      uday          IdagDD
     C*** UFLAGG=1 BETYR PROGRAMKALLE FRA REGISTRERINGSPROGRAM
     C*** UFLAGG<>1 BETYR PROGRAMKALLE FRA PROGRAM SOM SKAL VISE TEKST
     C     REFR          TAG
     C     UFLAGG        COMP      1                                      27
N02  c                   move      *on           *in28                          Teskt F10=Vis us/dat
     C*
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      *BLANKS       KNAVN
N01  C                   MOVE      KUNDNR        uuparu           10
N01  c     ArkKey11      chain     arkivl11                           34
      *
      *VEDLIKEHOLD
      *
     C     UDELSY        IFEQ      'V'
     C                   EXSR      SRHAR
     C     START0        TAG
     C                   EXFMT     BILDE00
     C                   SETOFF                                       7130
     C   12              GOTO      UT
     C     *IN04         IFEQ      '1'
     C                   CALL      'SYFAKDA'
     C                   PARM                    UTYP             10
     C                   PARM                    VEDL              1
     C                   PARM                    RETURK            5
     C                   MOVEL     RETURK        DELSYS
     C                   ELSE
     C                   MOVEL     WDELSY        DELSYS
     C                   END
     C     DELSYS        IFNE      ' '
     C                   MOVEL     DELSYS        FDELSY
     C     KEYDEL        CHAIN     KOFAST                             71
     C   71              MOVE      'SHU0429'     MSGNR
     C   71              SETON                                        30
     C   71              GOTO      START0
     C                   END
      *
      * IKKE VEDLIKEHOLD
      *
     C                   ELSE
     C                   MOVE      UDELSY        DELSYS
     C     FRATX2        CHAIN     FRATXT                             33
     C   33              MOVE      ' '           DELSYS
     C   33FRATX2        CHAIN     FRATXT                             33
     C                   END
     C*
     C*** HENT FRITEKST
     C*
     C     NYTAG         TAG
     C*
n02   * clear bilde
n02  C                   movea     *blanks       TX
n02   * Les alle eksisterende for valgt type
     C     FRATXK        SETLL     FRATXT
     C                   SETOFF                                       33
N02  c                   move      *zeros        XNR
     C     START         TAG
     C     FRATX2        READE(N)  FRATXT                                 33
     C  N33              MOVE      FXLNR         XNR               2 0
     c  N33UsrDat        Ifeq      'J'
     c     FXDT          andne     *zeros
     c                   MOVE      '   '         FXTXTBLANK
     c                   MOVE      FXUSR         FXTXTUSR
     c                   MOVE      FXDT          FXTXTDT
     c                   end
     C  N33              MOVE      FXTXT         TX(XNR)
     C  N33              GOTO      START
      *
     C     xnr           ifgt      20
     C                   move      '+'           o1
     c                   end
     C     xnr           ifgt      40
     C                   move      '+'           o2
     c                   end
     C     xnr           ifgt      60
     C                   move      '+'           o3
     c                   end
     C     xnr           ifgt      80
     C                   move      '+'           o4
     c                   end
     C*
     C                   MOVE      *BLANKS       ALLE
     C     DELSYS        IFEQ      ' '
     C                   MOVE      '*ALL'        ALLE
     C                   END
     c                   exsr      bildesr
      *
      * Vis dato tid for endring (on/off bryter)
     C     *IN10         IFEQ      '1'
     C     UsrDat        ifeq      'J'
     C                   MOVE      'N'           UsrDat            1
     C     UFLAGG        COMP      1                                      27
N02  c                   move      *on           *in28
     C                   else
     C                   MOVE      'J'           UsrDat
     c                   move      *off          *in27
N02  c                   move      *off          *in28
     C                   end
     c                   goto      NyTag
     C                   END
N01   * Arkiv
N01  C     *IN16         IFEQ      *ON
N01  C                   MOVEL     'K:'          uuparu
N01  C                   MOVE      KUNDNR        uuparu           10
N01  C                   CALL      'ARC003'
N01  C                   PARM                    uuuavd            4 0
N01  C                   PARM                    uuuopd            7 0
N01  C                   PARM                    uuparu
N01  C                   GOTO      NYTAG
N01  C                   END
N02   * F12 i vedlikegoldsmodus er identisk md F23 - til inngangsbildet
N02  c                   if        UFlagg=1 and *in12=*on
N02  c                   move      *on           *in23
N02  c                   endif
      * over til vedlikehold (inngangsbildet) også tillatt om en kommer fra oppdrag
     C   23              DO
     C                   MOVE      'N'           UsrDat                         =IKKE usr/date
     C                   MOVE      'V'           UDELSY
     C                   MOVE      '1'           UFLAGG
     C                   GOTO      REFR
     C                   END
     c
s02  C*  27
s02  C*N 12              GOTO      UT
N02   * 27=Åpen/vedlikehold - Oppdater
     C   27
     CANN12              EXSR      OPDFT
N02   * F3=rett ut (etter evt oppdatering)
N02  C   03              GOTO      UT
      * Ved spørring på annet delsystem enn blank - vis også blank før avslutt
     C     UDELSY        IFNE      'V'
     C     DELSYS        ANDNE     ' '
     C                   MOVE      ' '           DELSYS
     C     FRATX2        CHAIN     FRATXT                             33
     C  N33              GOTO      NYTAG
     C                   END
     C*
     C     UT            TAG
     C                   MOVE      UDELSY        DELSYS
     C                   MOVE      UUUDEL        UDELSY
     C*
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     OPDFT         BEGSR
     C***********************************************
     C                   Z-ADD     1             XNR
     C     XNR           DOWLE     80
     C                   MOVE      XNR           XFXLNR
     C     FRATXK        CHAIN     FRATXT                             33
     C     TX(XNR)       IFEQ      *BLANKS
     C  N33              DELETE    FRATXTR
     C                   ELSE
      * ved ny eller endret logg user/data
     C     *in33         ifeq      '1'
     C                   MOVE      Zuser         FXUSR
     C                   MOVE      Idag          FXDT
     C                   else
     C     TX(XNR)       ifne      FXTXT
     C                   MOVE      Zuser         FXUSR
     C                   MOVE      Idag          FXDT
     C                   end
     C                   end
     C                   MOVE      TX(XNR)       FXTXT
     C   33              MOVE      XNR           FXLNR
     C   33              MOVE      UKUNR         FXKNR
     C   33              WRITE     FRATXTR
     C  N33              UPDATE    FRATXTR
     C                   END
     C                   ADD       1             XNR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SRHAR         BEGSR
     C***********************************************
     C*** TESTER HVILKE DELSYSTEMER HAN HAR INFO PÅ
N02  C                   move      *blanks       DELSYS
     C                   Z-ADD     1             XX                2 0
     C     FRATXK        SETLL     FRATXT
     C                   SETOFF                                       33
     C     START2        TAG
     C     UKUNR         READE(N)  FRATXT                                 33
     C  N33DELSYS        IFEQ      ' '                                          DELSYS=filvariabelen
     C                   MOVE      'b'           HA(XX)
     C                   ELSE
     C                   MOVE      DELSYS        HA(XX)
     C                   END
     C  N33              ADD       1             XX
     C  N33FRATX2        SETGT     FRATXT
     C  N33              GOTO      START2
     C                   ENDSR
     C*
     C***********************************************
     C     bildesr       BEGSR
     C***********************************************
     c     b01           tag
     C                   EXFMT     BILDE01
     c   26              goto      b04
     c   25              goto      b02
     c                   goto      utbil
     c     b02           tag
     C                   EXFMT     BILDE02
     c   26              goto      b01
     c   25              goto      b03
     c                   goto      utbil
     c     b03           tag
     C                   EXFMT     BILDE03
     c   26              goto      b02
     c   25              goto      b04
     c                   goto      utbil
     c     b04           tag
     C                   EXFMT     BILDE04
     c   26              goto      b03
     c   25              goto      b01
     c     utbil         endsr
