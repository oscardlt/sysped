      *
      *** PROGRAM SKAL OPPDATERE STATISTIKK VED ENDRING P≈ OPPDRAG
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01-26
      *** LEDIGE INDIKATORE0 27-29 36-99
      * IND. 31 P≈ -> STATISTIKK BASERT P≈ OPPDRAGSDATO
      * IND. 31 AV -> STATISTIKK BASERT P≈ FAKTURADATO
      * IND. 32 P≈ -> LEGGE TIL NYE DATA
      * IND. 32 AV -> TREKKE FRA GAMLE DATA
      *
     FSTATVF    UF   E           K DISK
     FSTATLOGF  O  A E           K DISK
     FBLV1      IF   E           K DISK
     FFAK8      IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FSTED2D    IF   E           K DISK
     F                                     RENAME(STED2R:STED2RD)
     FFIRM      IF   E           K DISK
     FFIRSTA    UF   E           K DISK
     FTURER14   IF   E           K DISK
     FSTATHFL1  UF A F  590    25AIDISK    KEYLOC(1)
     FSTATOHL1  UF A F  590    25AIDISK    KEYLOC(1)
     FSTATDFL1  UF A E           K DISK
     FSTATODL1  UF A E           K DISK
     F                                     RENAME(STATDFR:STATDFRO)
     FSYST35FA  CF   E             WORKSTN USROPN
     F                                     MAXDEV(*FILE)
     F                                     INFDS(FEEDBK)
     D KN              S              8  0 DIM(99)
     D FV              S             11  0 DIM(13)
     D AV              S             11  0 DIM(13)
     D AS              S              9  0 DIM(13)
     D VG              S              9  0 DIM(13)
     D AT              S              9  0 DIM(13)
     D SS              S              9  0 DIM(13)
     D VS              S             11  0 DIM(13)
     D MS              S              9  3 DIM(13)
     D BL2             S              9  0 DIM(13)
     D B01             S              9  0 DIM(13)                              AI
     D B02             S              9  0 DIM(13)                              BI
     D B03             S              9  0 DIM(13)                              CI
     D B04             S              9  0 DIM(13)                              DI
     D B05             S              9  0 DIM(13)                              EI
     D B06             S              9  0 DIM(13)                              FI
     D B07             S              9  0 DIM(13)                              GI
     D B08             S              9  0 DIM(13)                              HI
     D B09             S              9  0 DIM(13)                              II
     D B10             S              9  0 DIM(13)                              JI
     D B11             S              9  0 DIM(13)                              AK
     D B12             S              9  0 DIM(13)                              BK
     D B13             S              9  0 DIM(13)                              CK
     D B14             S              9  0 DIM(13)                              DK
     D B15             S              9  0 DIM(13)                              EK
     D B16             S              9  0 DIM(13)                              FK
     D B17             S              9  0 DIM(13)                              GK
     D B18             S              9  0 DIM(13)                              HK
     D B19             S              9  0 DIM(13)                              IK
     D B20             S              9  0 DIM(13)                              JK
     D B21             S              9  0 DIM(13)                              XI
     D B22             S              9  0 DIM(13)                              XK
     D FEEDBK          DS
     D  STATUS           *STATUS
     D                 DS
     D  KOVK1                  1      5  0
     D  KOVK2                  6     10  0
     D  KOVK3                 11     15  0
     D  KOVK4                 16     20  0
     D  KOVK5                 21     25  0
     D  KOVK6                 26     30  0
     D  KOVK7                 31     35  0
     D  KOVK8                 36     40  0
     D  KOVK9                 41     45  0
     D  KOVK10                46     50  0
     D  KOVK11                51     55  0
     D  KOVK12                56     60  0
     D  FF                     1     65  0
     D                                     DIM(13) ASCEND
     D                 DS
     D  STBL01                 1      9  0
     D  STBL02                10     18  0
     D  STBL03                19     27  0
     D  STBL04                28     36  0
     D  STBL05                37     45  0
     D  STBL06                46     54  0
     D  STBL07                55     63  0
     D  STBL08                64     72  0
     D  STBL09                73     81  0
     D  STBL10                82     90  0
     D  STBL11                91     99  0
     D  STBL12               100    108  0
     D  STBL13               109    117  0
     D  BL                     1    117  0
     D                                     DIM(13)
     D                 DS
     D  FAC≈M                  1      6  0
     D  FACC                   1      2  0
     D  FA≈R                   3      4  0
     D  FAMND                  5      6  0
     D  XN                     5      6  0
     D                 DS
     D  WTIME                  1     14  0
     D  SLTM                   1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  W≈≈                   11     14  0
     D                 DS
     D  SLDT                   1      8  0
     D  SLDT≈≈                 1      4  0
     D  SLDTMM                 5      6  0
     D  SLDTDD                 7      8  0
     D                 DS
     D  XC≈M                   1      6  0
     D  XC≈MC                  1      2  0
     D  XC≈M≈                  3      4  0
     D  XC≈MM                  5      6  0
     D                 DS
     D  SLRI                   1      1
     D  XCC                    2      3  0
     D  X≈R                    4      5  0
     D  SLAVD                  6      9  0
     D  SLK1                  10     17
     D  SLK2                  18     25
     D  STAKEY                 1     25
     ISTATHFL1  NS
     I                             P   26  103  FV
     I                             P  104  181  AV
     I                             P  182  246  AS
     I                             P  247  311  VG
     I                             P  312  376  AT
     I                             P  377  441  SS
     I                             P  442  519  VS
     I                             P  520  584  MS
     I                             P  585  590 0STSTNR
     ISTATOHL1  NS
     I                             P   26  103  FV
     I                             P  104  181  AV
     I                             P  182  246  AS
     I                             P  247  311  VG
     I                             P  312  376  AT
     I                             P  377  441  SS
     I                             P  442  519  VS
     I                             P  520  584  MS
     I                             P  585  590 0STSTNR
      *
     C                   EXSR      INIT
      *
     C     STAVFK        CHAIN     STATVF                             33
     C     *IN33         IFEQ      '0'
     C                   DELETE    STATVFR
     C                   EXSR      TSTCHG
     C     *IN30         IFEQ      '1'
     C                   OPEN      SYST35FA
     C                   WRITE     WINDOWSZ
     C                   WRITE     BILDE01
     C                   READ      SYST35FA                             3030
     C                   EXSR      OPDST
     C                   CLOSE     SYST35FA
     C                   END
     C                   END
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     TSTCHG        BEGSR
     C***********************************************
     C     WSDT≈         IFGT      50
     C     WSDT≈         ADD       1900          WSDT≈4            4 0
     C                   ELSE
     C     WSDT≈         ADD       2000          WSDT≈4
     C                   END
      *
     C     HEVKT         COMP      WSVKT                              3030
     C  N30HEFBV         COMP      WSFBV                              3030
     C  N30HENT          COMP      WSNT                               3030
     C  N30HEM3          COMP      WSM3                               3030
     C  N30KOVPRO        IFEQ      'O'
     C     KOVPRO        OREQ      'B'
     C     HEDTM         COMP      WSDTM                              3030
     C  N30HEDT≈         COMP      WSDT≈4                             3030
     C                   END
     C  N30HESG          COMP      WSSG                               3030
     C  N30HEPRO         COMP      WSPRO                              3030
     C  N30HELKA         COMP      WSLKA                              3030
     C  N30HETRI         COMP      WSTRI                              3030
     C  N30HELKS         COMP      WSLKS                              3030
     C  N30HELKK         COMP      WSLKK                              3030
     C  N30HESDFF        COMP      WSSDFF                             3030
     C  N30HESDF         COMP      WSSDF                              3030
     C  N30HESDT         COMP      WSSDT                              3030
     C  N30HESDVT        COMP      WSSDVT                             3030
     C  N30HEKNA         COMP      WSKNA                              3030
     C  N30HEKNT         COMP      WSKNT                              3030
     C  N30HEKNS         COMP      WSKNS                              3030
     C  N30HEKNSF        COMP      WSKNSF                             3030
     C  N30HEKNK         COMP      WSKNK                              3030
     C  N30HEKNKF        COMP      WSKNKF                             3030
     C  N30HEOT          COMP      WSOT                               3030
     C  N30HEFR          COMP      WSFR                               3030
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDST         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        KN
      *
     C     HEUR          IFEQ      'H'
     C     HEPRO         CHAIN     TURER14                            30
     C   30              MOVE      *ZEROS        TURUND
     C   30              MOVE      *BLANKS       TUBILN
     C   30              MOVE      *BLANKS       TUBILK
     C                   ELSE
     C                   MOVE      *ZEROS        TURUND
     C                   MOVE      *BLANKS       TUBILN
     C                   MOVE      *BLANKS       TUBILK
     C                   END
      *
     C     HEVKT         COMP      WSVKT                              3030
     C  N30HEFBV         COMP      WSFBV                              3030
     C  N30HENT          COMP      WSNT                               3030
     C  N30HEM3          COMP      WSM3                               3030
     C  N30KOVPRO        IFEQ      'O'
     C     KOVPRO        OREQ      'B'
     C     HEDT≈         COMP      WSDT≈4                             3030
     C  N30HEDTM         COMP      WSDTM                              3030
     C                   END
      *
     C                   Z-ADD     1             VV                3 0
     C     HEFBV         IFGT      99999                                        1<-B
     C                   MOVE      99999         XFBV              5 0
     C                   ELSE                                                   1
     C                   MOVE      HEFBV         XFBV
     C                   END                                                    1<-E
     C     XFBV          LOOKUP    FF(VV)                             35  35
     C                   Z-ADD     1             V2                3 0
     C     WSFBV         IFGT      99999                                        1<-B
     C                   MOVE      99999         XFBV              5 0
     C                   ELSE                                                   1
     C                   MOVE      WSFBV         XFBV
     C                   END                                                    1<-E
     C     XFBV          LOOKUP    FF(V2)                             35  35
      *
      * FINNE FAKTURAMOTTAKERSNR SOM IKKE ST≈R P≈ OPPDRAG
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C     FAKUNR        IFNE      HEKNSF                                        2<-B
     C     FAKUNR        ANDNE     HEKNKF
     C     FAOPKO        ANDEQ     'O'
     C     1             DO        99            XN2               3 0            3<-B
     C     KN(XN2)       IFEQ      0                                              4<-B
     C                   MOVE      FAKUNR        KN(XN2)
     C                   END                                                      4<-E
     C     KN(XN2)       CABEQ     FAKUNR        STOPS1
     C                   ENDDO                                                    3<-E
     C     STOPS1        TAG
     C                   ENDIF                                                   2<-E
     C     FAK8K         READE     FAK8                                   33
     C                   ENDDO                                                  1<-E
      * FYLL VARIABLE I LOGGFIL.
     C                   EXSR      MOVSL
      * HENT STED/LANDKODE
     C                   EXSR      HSDLK
      * HENT TEUS
     C                   EXSR      HENTCO
      * OPPDATER AGENT
     C     FISTA         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNA         ORNE      WSKNA
     C                   EXSR      OPDA
     C                   END
     C                   END
      * OPPDATER AVDELING
     C     FISTB         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDB
     C                   END
      * OPPDATER RUNDTUR
     C     FISTC         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C     TURUND        ANDNE     0
     C                   EXSR      OPDC
     C                   END
      * OPPDATER FAKTURAMOTTAKER/OPPDRAGSTYPE
     C     FISTD         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HEOT          ORNE      WSOT
     C                   EXSR      OPDD
     C                   END
     C                   END
      * OPPDATER FRANKATUR
     C     FISTF         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEFR          ORNE      WSFR
     C                   EXSR      OPDF
     C                   END
     C                   END
      * OPPDATER FAKTURAMOTTAKER/FRANKATUR
     C     FISTG         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HEFR          ORNE      WSFR
     C                   EXSR      OPDG
     C                   END
     C                   END
      * OPPDATER FAKTURAMOTTAKER/FRA STED
     C     FISTH         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HESD81        ORNE      WSSD81
     C                   EXSR      OPDH
     C                   END
     C                   END
      * OPPDATER FAKTURAMOTTAKER/TIL STED
     C     FISTI         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HESD82        ORNE      WSSD82
     C                   EXSR      OPDI
     C                   END
     C                   END
      * OPPDATER KUNDER SOM "PART" P≈ OPPDRAG
     C     FISTJ         IFEQ      'X'                                          1<-B
     C     *IN30         IFEQ      '1'                                           2<-B
     C     HEKNS         ORNE      WSKNS
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNK         ORNE      WSKNK
     C     HEKNKF        ORNE      WSKNKF
     C                   EXSR      OPDJ
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * OPPDATER FAKTURAMOTTAKER
     C     FISTK         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C                   EXSR      OPDK
     C                   END
     C                   END
      * OPPDATER FRA/TIL LAND
     C     FISTL         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HELK4         ORNE      WSLK4
     C                   EXSR      OPDL
     C                   END
     C                   END
      * OPPDATER FRA/TIL REGION
     C     FISTM         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HERG4         ORNE      WSRG4
     C                   EXSR      OPDM
     C                   END
     C                   END
      * OPPDATER FRA/TIL STED
     C     FISTN         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HESD81        ORNE      WSSD81
     C     HESD82        ORNE      WSSD82
     C                   EXSR      OPDN
     C                   END
     C                   END
      * OPPDATER OPPDRAGSTYPE
     C     FISTO         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEOT          ORNE      WSOT
     C                   EXSR      OPDO
     C                   END
     C                   END
      * OPPDATER FRASTED
     C     FISTP         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HESD81        ORNE      WSSD81
     C                   EXSR      OPDP
     C                   END
     C                   END
      * OPPDATER TILSTED
     C     FISTQ         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HESD82        ORNE      WSSD82
     C                   EXSR      OPDQ
     C                   END
     C                   END
      * OPPDATER TUR
     C     FISTR         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEPRO         ORNE      WSPRO
     C                   EXSR      OPDR
     C                   END
     C                   END
      * OPPDATER SIGNATUR
     C     FISTS         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HESG          ORNE      WSSG
     C                   EXSR      OPDS
     C                   END
     C                   END
      * OPPDATER TRANSPORTÿR
     C     FISTT         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNT         ORNE      WSKNT
     C                   EXSR      OPDT
     C                   END
     C                   END
      * OPPDATER FAKTURAMOTTAKER/LAND
     C     FISTU         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HELKF         ORNE      WSLKF
     C     HELKT         ORNE      WSLKT
     C                   EXSR      OPDU
     C                   END
     C                   END
      * OPPDATER FAKTURAMOTTAKER/AGENT
     C     FISTV         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HEKNA         ORNE      WSKNA
     C                   EXSR      OPDV
     C                   END
     C                   END
      * OPPDATER VAREMOTAGER
     C     FISTW         IFEQ      'X'                                          1<-B
     C     *IN30         IFEQ      '1'                                           2<-B
     C     HEKNS         ORNE      WSKNS
     C     HEKNK         ORNE      WSKNK
     C                   EXSR      OPDW
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * OPPDATER FAKTURAMOTTAKER/REGION
     C     FISTX         IFEQ      'X'
     C     *IN30         IFEQ      '1'
     C     HEKNSF        ORNE      WSKNSF
     C     HEKNKF        ORNE      WSKNKF
     C     HERG4         ORNE      WSRG4
     C                   EXSR      OPDX
     C                   END
     C                   END
      * OPPDATER BILNUMMER
     C     FISTY         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C     TUBILN        ANDNE     *BLANKS
     C                   EXSR      OPDY
     C                   END
      * OPPDATER BILKODE
     C     FISTZ         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C     TUBILK        ANDNE     *BLANKS
     C                   EXSR      OPDZ
     C                   END
      *
      * OPPDATER STATISTIKK P≈ ANDRE FAKTURAMOTTAKERE
     C     1             DO        99            XN2
     C     KN(XN2)       IFNE      0
     C     FISTD         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDD2
     C                   END
     C     FISTG         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDG2
     C                   END
     C     FISTH         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDH2
     C                   END
     C     FISTI         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDI2
     C                   END
     C     FISTU         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDU2
     C                   END
     C     FISTV         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDV2
     C                   END
     C     FISTX         IFEQ      'X'
     C     *IN30         ANDEQ     '1'
     C                   EXSR      OPDX2
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVSL         BEGSR
     C***********************************************
     C     KODTAK        CHAIN     KODTA                              34
     C                   MOVE      HEAVD         SLAVD
     C                   MOVE      HEDTM         SLDTMG
     C                   MOVE      HEDT≈         SLDT≈G
     C                   MOVEL     HEDT≈         SLDTCG
     C                   MOVE      WSDTM         SLDTMN
     C                   MOVE      WSDT≈         SLDT≈N
     C                   MOVEL     WSDT≈4        SLDTCN
     C     HEDTMP        IFEQ      0
     C                   MOVE      HEDTM         SLDTM
     C                   MOVE      HEDT≈         SLDT≈
     C                   MOVEL     HEDT≈         SLDTC
     C                   ELSE
     C                   MOVE      HEDTMP        SLDTM
     C                   MOVE      HEDT≈P        SLDT≈
     C                   MOVE      HEDTCP        SLDTC
     C                   END
     C                   MOVE      HEVKT         SLVKTG
     C                   MOVE      WSVKT         SLVKTN
     C                   MOVE      HEFBV         SLVKBG
     C                   MOVE      WSFBV         SLVKBN
     C                   MOVE      HENT          SLNTG
     C                   MOVE      WSNT          SLNTN
     C                   MOVE      HEM3          SLM3G
     C                   MOVE      WSM3          SLM3N
     C                   MOVE      HEOPD         SLOPD
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDA          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C     HEKNA         IFNE      0
     C     WSKNA         ORNE      0
     C                   MOVE      'A'           SLRI
     C                   MOVE      HEKNA         SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      WSKNA         SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C     HEKNA         IFNE      0
     C                   EXSR      MINUS
     C                   END
     C     WSKNA         IFNE      0
     C                   EXSR      PLUSS
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDB          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'B'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HEAVD         SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     HEAVD         SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDC          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'C'           SLRI
     C                   MOVE      TURUND        SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      TURUND        SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDD          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'D'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HEOT          SLK2G
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSOT          SLK2N
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNKF        ANDNE     HEKNSF
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNKF        ANDNE     WSKNSF
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDD2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'D'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HEOT          SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSOT          SLK2N
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
     C                   WRITE     STLOGFR
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDF          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'F'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HEFR          SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     WSFR          SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDG          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'G'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HEFR          SLK2G
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSFR          SLK2N
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNKF        ANDNE     HEKNSF
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNKF        ANDNE     WSKNSF
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDG2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'G'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HEFR          SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSFR          SLK2N
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
     C                   WRITE     STLOGFR
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDH          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'H'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HESD81        SLK2G
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSSD81        SLK2N
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNKF        ANDNE     HEKNSF
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNKF        ANDNE     WSKNSF
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDH2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'H'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HESD81        SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSSD81        SLK2N
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
     C                   WRITE     STLOGFR
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDI          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'I'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HESD82        SLK2G
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSSD82        SLK2N
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNKF        ANDNE     HEKNSF
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNKF        ANDNE     WSKNSF
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDI2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'I'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HESD82        SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSSD82        SLK2N
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
     C                   WRITE     STLOGFR
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDJ          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK2N
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNS         IFNE      0
     C                   MOVE      HEKNS         SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNS         IFNE      0
     C                   MOVE      WSKNS         SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C     HEKNSF        ANDNE     HEKNS
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C     WSKNSF        ANDNE     WSKNS
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNK         IFNE      0
     C     HEKNK         ANDNE     HEKNS
     C     HEKNK         ANDNE     HEKNSF
     C                   MOVE      HEKNK         SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNK         IFNE      0
     C     WSKNK         ANDNE     WSKNS
     C     WSKNK         ANDNE     WSKNSF
     C                   MOVE      WSKNK         SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNKF        ANDNE     HEKNS
     C     HEKNKF        ANDNE     HEKNSF
     C     HEKNKF        ANDNE     HEKNK
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNKF        ANDNE     WSKNS
     C     WSKNKF        ANDNE     WSKNSF
     C     WSKNKF        ANDNE     WSKNK
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDK          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'K'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK2N
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNKF        ANDNE     HEKNSF
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNKF        ANDNE     WSKNSF
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDL          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'L'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HELK4         SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     WSLK4         SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   MOVEL     HELK4         XLK1              2
     C                   MOVE      HELK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C                   EXSR      MINUS
     C                   END
     C                   MOVEL     WSLK4         XLK1              2
     C                   MOVE      WSLK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C                   EXSR      PLUSS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDM          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C     HERG4         IFNE      *BLANKS
     C     WSRG4         ORNE      *BLANKS
     C                   MOVE      'M'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HERG4         SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     WSRG4         SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   MOVEL     HERG4         XRG1              2
     C                   MOVE      HERG4         XRG2              2
     C     XRG1          IFNE      *BLANKS
     C     XRG2          ANDNE     *BLANKS
     C                   EXSR      MINUS
     C                   END
     C                   MOVEL     WSRG4         XRG1              2
     C                   MOVE      WSRG4         XRG2              2
     C     XRG1          IFNE      *BLANKS
     C     XRG2          ANDNE     *BLANKS
     C                   EXSR      PLUSS
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDN          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'N'           SLRI
     C                   MOVE      HESD81        SLK1G
     C                   MOVE      HESD82        SLK2G
     C                   MOVE      WSSD81        SLK1N
     C                   MOVE      WSSD82        SLK2N
     C                   WRITE     STLOGFR
     C     HELKF         IFNE      *BLANKS
     C     HESDF         ANDNE     *BLANKS
     C     HELKT         ANDNE     *BLANKS
     C     HESDT         ANDNE     *BLANKS
     C                   EXSR      MINUS
     C                   END
     C     WSLKF         IFNE      *BLANKS
     C     WSSDF         ANDNE     *BLANKS
     C     WSLKT         ANDNE     *BLANKS
     C     WSSDT         ANDNE     *BLANKS
     C                   EXSR      PLUSS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDO          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'O'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HEOT          SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     WSOT          SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDP          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'P'           SLRI
     C                   MOVE      HESD81        SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      WSSD81        SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
      *
     C                   MOVEL     HESD81        XSD21             2
     C                   MOVE      HESD81        XSD22             5
     C     XSD21         IFNE      *BLANKS
     C     XSD22         ANDNE     *BLANKS
     C                   EXSR      MINUS
     C                   END
      *
     C                   MOVEL     WSSD81        XSD21             2
     C                   MOVE      WSSD81        XSD22             5
     C     XSD21         IFNE      *BLANKS
     C     XSD22         ANDNE     *BLANKS
     C                   EXSR      PLUSS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDQ          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'Q'           SLRI
     C                   MOVE      HESD82        SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      WSSD82        SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
      *
     C                   MOVEL     HESD82        XSD21             2
     C                   MOVE      HESD82        XSD22             5
     C     XSD21         IFNE      *BLANKS
     C     XSD22         ANDNE     *BLANKS
     C                   EXSR      MINUS
     C                   END
     C                   MOVEL     WSSD82        XSD21             2
     C                   MOVE      WSSD82        XSD22             5
     C     XSD21         IFNE      *BLANKS
     C     XSD22         ANDNE     *BLANKS
     C                   EXSR      PLUSS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDR          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C     HEPRO         IFNE      0
     C     WSPRO         ORNE      0
     C                   MOVE      'R'           SLRI
     C                   MOVE      HEPRO         SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      WSPRO         SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C     HEPRO         IFNE      0
     C                   EXSR      MINUS
     C                   END
     C     WSPRO         IFNE      0
     C                   EXSR      PLUSS
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDS          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'S'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HESG          SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     WSSG          SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDT          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C     HEKNT         IFNE      0
     C     WSKNT         ORNE      0
     C                   MOVE      'T'           SLRI
     C                   MOVE      HEKNT         SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      WSKNT         SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C     HEKNT         IFNE      0
     C                   EXSR      MINUS
     C                   END
     C     WSKNT         IFNE      0
     C                   EXSR      PLUSS
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDU          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'U'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HELK4         SLK2G
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSLK4         SLK2N
      *
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     HELK4         XLK1              2
     C                   MOVE      HELK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C     HEKNSF        ANDNE     0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C                   MOVEL     WSLK4         XLK1              2
     C                   MOVE      WSLK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C     WSKNSF        ANDNE     0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     HELK4         XLK1              2
     C                   MOVE      HELK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C     HEKNKF        ANDNE     0
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C                   MOVEL     WSLK4         XLK1              2
     C                   MOVE      WSLK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C     WSKNKF        ANDNE     0
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDU2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'U'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HELK4         SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSLK4         SLK2N
      *
     C                   MOVEL     HELK4         XLK1              2
     C                   MOVE      HELK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C                   EXSR      MINUS
     C                   END
     C                   MOVEL     WSLK4         XLK1              2
     C                   MOVE      WSLK4         XLK2              2
     C     XLK1          IFNE      *BLANKS
     C     XLK2          ANDNE     *BLANKS
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDV          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'V'           SLRI
     C                   MOVE      HEKNA         SLK2G
     C                   MOVE      WSKNA         SLK2N
      *
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C     HEKNA         ANDNE     0
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C     WSKNA         ANDNE     0
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HEKNA         ANDNE     0
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSKNA         ANDNE     0
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDV2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'V'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      HEKNA         SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      WSKNA         SLK2N
      *
     C     HEKNA         IFNE      0
     C                   EXSR      MINUS
     C                   END
     C     WSKNA         IFNE      0
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDW          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'W'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK2N
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNS         IFNE      0
     C     HEKNS         ANDNE     HEKNSF
     C                   MOVE      HEKNS         SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNS         IFNE      0
     C     WSKNS         ANDNE     WSKNSF
     C                   MOVE      WSKNS         SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNK         IFNE      0
     C     HEKNK         ANDNE     HEKNKF
     C                   MOVE      HEKNK         SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNK         IFNE      0
     C     WSKNK         ANDNE     WSKNKF
     C                   MOVE      WSKNK         SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDX          BEGSR
     C***********************************************
     C                   MOVE      'N'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'X'           SLRI
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HERG4         SLK2G
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSRG4         SLK2N
      *
     C     HEKNSF        IFNE      0
     C     WSKNSF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNSF        IFNE      0
     C     HERG4         ANDNE     *BLANKS
     C                   MOVE      HEKNSF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNSF        IFNE      0
     C     WSRG4         ANDNE     *BLANKS
     C                   MOVE      WSKNSF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   END
      *
     C     HEKNKF        IFNE      0
     C     WSKNKF        ORNE      0
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVE      *BLANKS       SLK1N
     C     HEKNKF        IFNE      0
     C     HERG4         ANDNE     *BLANKS
     C                   MOVE      HEKNKF        SLK1G
     C                   EXSR      MINUS
     C                   END
     C     WSKNKF        IFNE      0
     C     WSRG4         ANDNE     *BLANKS
     C                   MOVE      WSKNKF        SLK1N
     C                   EXSR      PLUSS
     C                   END
     C     SLK1G         IFNE      *BLANKS
     C     SLK1N         ORNE      *BLANKS
     C                   WRITE     STLOGFR
     C                   END
     C                   END
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDX2         BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'J'           XOPDKN            1
     C                   MOVE      'X'           SLRI
     C                   MOVE      KN(XN2)       SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      HERG4         SLK2G
     C                   MOVE      KN(XN2)       SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   MOVE      WSRG4         SLK2N
      *
     C     HERG4         IFNE      *BLANKS
     C                   EXSR      MINUS
     C                   END
     C     WSRG4         IFNE      *BLANKS
     C                   EXSR      PLUSS
     C                   END
     C                   WRITE     STLOGFR
      *
     C                   MOVE      'N'           XOPDKN            1
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDY          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'Y'           SLRI
     C                   MOVEL     TUBILN        SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVEL     TUBILN        SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDZ          BEGSR
     C***********************************************
     C                   MOVE      'J'           XOPDBL            1
     C                   MOVE      'Z'           SLRI
     C                   MOVE      *BLANKS       SLK1G
     C                   MOVEL     TUBILK        SLK1G
     C                   MOVE      *BLANKS       SLK2G
     C                   MOVE      *BLANKS       SLK1N
     C                   MOVEL     TUBILK        SLK1N
     C                   MOVE      *BLANKS       SLK2N
     C                   WRITE     STLOGFR
     C                   EXSR      MINUS
     C                   EXSR      PLUSS
      *
     C                   ENDSR
      *
     C***********************************************
     C     HSDLK         BEGSR
     C***********************************************
      * LAND-/STEDSKODE SKAL LIGGE I HELKF/HESDF OG HELKT/HESDT
      *                              WSLKF/WSSDF OG WSLKT/WSSDT
     C                   MOVE      *BLANKS       HELKF             2
     C                   MOVE      *BLANKS       HELKT             2
     C                   MOVE      *BLANKS       WSLKF             2
     C                   MOVE      *BLANKS       WSLKT             2
     C     HEUR          IFEQ      'H'                                          1<-B
      * TRANSPORT MODUL
     C                   MOVE      HELKA         HELKF
     C                   MOVE      HETRI         HELKT
     C                   MOVE      WSLKA         WSLKF
     C                   MOVE      WSTRI         WSLKT
     C     KOAPOS        IFEQ      'J'                                           2<-B
      * POSTAL --> HENT BASIS STED
     C                   MOVE      HELKA         ST2LK
     C                   MOVE      HESDF         ST2KOD
     C     STE2DK        CHAIN     STED2D                             35
     C                   MOVE      ST2KO2        HESDF
     C                   MOVE      HETRI         ST2LK
     C                   MOVE      HESDT         ST2KOD
     C     STE2DK        CHAIN     STED2D                             35
     C                   MOVE      ST2KO2        HESDT
     C                   MOVE      WSLKA         ST2LK
     C                   MOVE      WSSDF         ST2KOD
     C     STE2DK        CHAIN     STED2D                             35
     C                   MOVE      ST2KO2        WSSDF
     C                   MOVE      WSTRI         ST2LK
     C                   MOVE      WSSDT         ST2KOD
     C     STE2DK        CHAIN     STED2D                             35
     C                   MOVE      ST2KO2        WSSDT
     C                   END                                                     2<-E
      *
     C                   ELSE                                                   1
      * IKKE POSTAL BRUKER FOR FRAKT/VIDERE FRAKT HVIS DET FINNES.
      * ELLERS BRUKER FRA/TIL STED.
      *
     C     HESDFF        IFEQ      *BLANKS                                       2<-B
     C     KOAPOS        OREQ      'J'
     C     HEUR          IFEQ      'A'                                            3<-B
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVE      HELKA         HELKF
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      HESDFF        HESDF
     C                   MOVE      HELKS         HELKF
     C                   END                                                     2<-E
     C     HELKF         IFEQ      *BLANKS                                       2<-B
     C     HESDF         CHAIN     STED2                              35
     C     ST2LK         IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FILAND        HELKF
     C                   ELSE                                                     3
     C                   MOVE      ST2LK         HELKF
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     HESDVT        IFEQ      *BLANKS                                       2<-B
     C     KOAPOS        OREQ      'J'
     C     HEUR          IFNE      'A'                                            3<-B
     C     HEUR          ANDNE     'C'
     C     HEUR          ANDNE     'F'
     C                   MOVE      HELKA         HELKT
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      HESDVT        HESDT
     C                   MOVE      HELKK         HELKT
     C                   END                                                     2<-E
     C     HEUR          IFEQ      'E'                                           2<-B
     C                   MOVE      HELKF         HELKT
     C                   END                                                     2<-E
     C     HELKT         IFEQ      *BLANKS                                       2<-B
     C     HESDT         CHAIN     STED2                              35
     C     ST2LK         IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FILAND        HELKT
     C                   ELSE                                                     3
     C                   MOVE      ST2LK         HELKT
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C     WSSDFF        IFEQ      *BLANKS                                       2<-B
     C     KOAPOS        OREQ      'J'
     C     HEUR          IFEQ      'A'                                            3<-B
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVE      WSLKA         WSLKF
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      WSSDFF        WSSDF
     C                   MOVE      WSLKS         WSLKF
     C                   END                                                     2<-E
     C     WSLKF         IFEQ      *BLANKS                                       2<-B
     C     WSSDF         CHAIN     STED2                              35
     C     ST2LK         IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FILAND        WSLKF
     C                   ELSE                                                     3
     C                   MOVE      ST2LK         WSLKF
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     WSSDVT        IFEQ      *BLANKS                                       2<-B
     C     KOAPOS        OREQ      'J'
     C     HEUR          IFNE      'A'                                            3<-B
     C     HEUR          ANDNE     'C'
     C     HEUR          ANDNE     'F'
     C                   MOVE      WSLKA         WSLKT
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      WSSDVT        WSSDT
     C                   MOVE      WSLKK         WSLKT
     C                   END                                                     2<-E
     C     HEUR          IFEQ      'E'                                           2<-B
     C                   MOVE      WSLKF         WSLKT
     C                   END                                                     2<-E
     C     WSLKT         IFEQ      *BLANKS                                       2<-B
     C     WSSDT         CHAIN     STED2                              35
     C     ST2LK         IFEQ      *BLANKS                                        3<-B
     C                   MOVE      FILAND        WSLKT
     C                   ELSE                                                     3
     C                   MOVE      ST2LK         WSLKT
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *
      *
     C                   MOVEL     HELKF         HELK4             4            FRA/TIL LAND
     C                   MOVE      HELKT         HELK4
     C                   MOVE      HELKF         KLKLK
     C     KODLKK        CHAIN     KODTLK                             35
     C                   MOVEL     KLKLK2        HERG4             4            F/T REGION
     C                   MOVE      HELKT         KLKLK
     C     KODLKK        CHAIN     KODTLK                             35
     C                   MOVE      KLKLK2        HERG4
     C                   MOVEL     WSLKF         WSLK4             4            FRA/TIL LAND
     C                   MOVE      WSLKT         WSLK4
     C                   MOVE      WSLKF         KLKLK
     C     KODLKK        CHAIN     KODTLK                             35
     C                   MOVEL     KLKLK2        WSRG4             4            F/T REGION
     C                   MOVE      WSLKT         KLKLK
     C     KODLKK        CHAIN     KODTLK                             35
     C                   MOVE      KLKLK2        WSRG4
      *
     C                   MOVEL     HELKF         HESD81            8
     C                   MOVE      HESDF         HESD81
     C                   MOVEL     HELKT         HESD82            8
     C                   MOVE      HESDT         HESD82
     C                   MOVEL     WSLKF         WSSD81            8
     C                   MOVE      WSSDF         WSSD81
     C                   MOVEL     WSLKT         WSSD82            8
     C                   MOVE      WSSDT         WSSD82
      *
      *
     C                   ENDSR
      *
     C***********************************************
     C     MINUS         BEGSR
     C***********************************************
     C                   MOVE      SLK1G         SLK1
     C                   MOVE      SLK2G         SLK2
     C                   MOVE      '0'           *IN32
     C     XOPDKN        IFEQ      'J'
     C                   MOVE      SLK1          XKUNR             8 0
     C                   END
      *
     C     KOVPRO        IFEQ      'F'                                          1<-B
     C     KOVPRO        OREQ      'B'
     C                   MOVE      '0'           *IN31
     C                   MOVE      *ZEROS        XC≈M
     C                   MOVE      'N'           XOPDHF            1
     C                   EXSR      MOVBL0
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C     FAOPKO        CABNE     'O'           STMNS1
     C     XOPDKN        IFEQ      'J'                                            3<-B
     C     XKUNR         CABNE     FAKUNR        STMNS1
     C                   END                                                      3<-E
     C     XC≈M          IFEQ      0                                              3<-B
     C     XC≈M          OREQ      FAC≈M
     C                   EXSR      SUMBL
     C                   ELSE                                                     3
     C                   EXSR      OPDMN1
     C                   END                                                      3<-E
     C     STMNS1        TAG
     C     FAK8K         READE     FAK8                                   33
     C                   END                                                     2<-E
     C     XC≈M          IFEQ      0                                             2<-B
     C                   MOVE      SLDTM         XC≈MM
     C                   MOVE      SLDT≈         XC≈M≈
     C                   MOVE      SLDTC         XC≈MC
     C                   END                                                     2<-E
     C                   EXSR      OPDMN1
     C                   END                                                    1<-E
      *
     C     KOVPRO        IFEQ      'O'                                          1<-B
     C     KOVPRO        OREQ      'B'
     C                   MOVE      '1'           *IN31
     C                   MOVE      SLDTMG        XMN
     C                   MOVE      SLDT≈G        X≈R
     C                   MOVE      SLDTCG        XCC
     C                   EXSR      MOVBL0
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C     FAOPKO        CABNE     'O'           STMNS2
     C     XOPDKN        IFNE      'J'                                            3<-B
     C     XKUNR         OREQ      FAKUNR
     C                   MOVE      XMN           XN
     C                   EXSR      SUMBL
     C                   END                                                      3<-E
     C     STMNS2        TAG
     C     FAK8K         READE     FAK8                                   33
     C                   END                                                     2<-E
     C                   EXSR      OPDMN2
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C******************************************
     C     OPDMN1        BEGSR
     C******************************************
     C                   MOVE      XC≈MM         XMN               2 0
     C                   MOVE      XC≈M≈         X≈R
     C                   MOVE      XC≈MC         XCC
     C     STAKEY        CHAIN     STATHFL1                           34
     C     *IN34         IFEQ      '0'
     C     XOPDHF        IFEQ      'N'
      * HOVED STATISTIKKFIL OPPDATERES KUN EN GANG.
     C                   EXSR      SUBDTA
     C                   MOVE      'J'           XOPDHF
     C                   END
     C                   EXCEPT    CHGST
     C     XOPDBL        IFEQ      'J'
     C                   EXSR      OPDBL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C******************************************
     C     OPDMN2        BEGSR
     C******************************************
     C     STAKEY        CHAIN     STATOHL1                           34
     C     *IN34         IFEQ      '0'
     C                   EXSR      SUBDTA
     C                   EXCEPT    CHGSTO
     C     XOPDBL        IFEQ      'J'
     C                   EXSR      OPDBL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C******************************************
     C     SUBDTA        BEGSR
     C******************************************
      * TREKKER ANTALL OPPDRAG OG VEKTER FRA STATISTIKK
     C                   SUB       1             AS(XMN)
     C                   SUB       HEVKT         AV(XMN)
     C                   SUB       HEFBV         FV(XMN)
     C                   SUB       1             VG(VV)
     C                   SUB       1             AS(13)
     C                   SUB       HEVKT         AV(13)
     C                   SUB       HEFBV         FV(13)
     C                   SUB       1             VG(13)
     C     XANTCO        IFEQ      0                                            1<-B
     C                   SUB       1             SS(XMN)
     C                   SUB       1             SS(13)
     C                   SUB       HEVKT         VS(XMN)
     C                   SUB       HEVKT         VS(13)
     C                   SUB       HEM3          MS(XMN)
     C                   SUB       HEM3          MS(13)
     C                   ELSE                                                   1
     C                   SUB       XANTCO        AT(XMN)
     C                   SUB       XANTCO        AT(13)
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C******************************************
     C     OPDBL         BEGSR
     C******************************************
      * TREKKER BELÿP FRA STATISTIKK
     C     B01(13)       IFNE      0
     C                   MOVE      'AI'          STGR
     C                   MOVEA     B01           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B02(13)       IFNE      0
     C                   MOVE      'BI'          STGR
     C                   MOVEA     B02           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B03(13)       IFNE      0
     C                   MOVE      'CI'          STGR
     C                   MOVEA     B03           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B04(13)       IFNE      0
     C                   MOVE      'DI'          STGR
     C                   MOVEA     B04           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B05(13)       IFNE      0
     C                   MOVE      'EI'          STGR
     C                   MOVEA     B05           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B06(13)       IFNE      0
     C                   MOVE      'FI'          STGR
     C                   MOVEA     B06           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B07(13)       IFNE      0
     C                   MOVE      'GI'          STGR
     C                   MOVEA     B07           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B08(13)       IFNE      0
     C                   MOVE      'HI'          STGR
     C                   MOVEA     B08           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B09(13)       IFNE      0
     C                   MOVE      'II'          STGR
     C                   MOVEA     B09           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B10(13)       IFNE      0
     C                   MOVE      'JI'          STGR
     C                   MOVEA     B10           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B21(13)       IFNE      0
     C                   MOVE      'XI'          STGR
     C                   MOVEA     B21           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B11(13)       IFNE      0
     C                   MOVE      'AK'          STGR
     C                   MOVEA     B11           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B12(13)       IFNE      0
     C                   MOVE      'BK'          STGR
     C                   MOVEA     B12           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B13(13)       IFNE      0
     C                   MOVE      'CK'          STGR
     C                   MOVEA     B13           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B14(13)       IFNE      0
     C                   MOVE      'DK'          STGR
     C                   MOVEA     B14           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B15(13)       IFNE      0
     C                   MOVE      'EK'          STGR
     C                   MOVEA     B15           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B16(13)       IFNE      0
     C                   MOVE      'FK'          STGR
     C                   MOVEA     B16           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B17(13)       IFNE      0
     C                   MOVE      'GK'          STGR
     C                   MOVEA     B17           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B18(13)       IFNE      0
     C                   MOVE      'HK'          STGR
     C                   MOVEA     B18           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B19(13)       IFNE      0
     C                   MOVE      'IK'          STGR
     C                   MOVEA     B19           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B20(13)       IFNE      0
     C                   MOVE      'JK'          STGR
     C                   MOVEA     B20           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C     B22(13)       IFNE      0
     C                   MOVE      'XK'          STGR
     C                   MOVEA     B22           BL2
     C                   EXSR      OPDBL2
     C                   END
      *
     C                   EXSR      MOVBL0
      *
     C                   ENDSR
      *
     C******************************************
     C     MOVBL0        BEGSR
     C******************************************
     C                   MOVE      *ZEROS        B01
     C                   MOVE      *ZEROS        B02
     C                   MOVE      *ZEROS        B03
     C                   MOVE      *ZEROS        B04
     C                   MOVE      *ZEROS        B05
     C                   MOVE      *ZEROS        B06
     C                   MOVE      *ZEROS        B07
     C                   MOVE      *ZEROS        B08
     C                   MOVE      *ZEROS        B09
     C                   MOVE      *ZEROS        B10
     C                   MOVE      *ZEROS        B11
     C                   MOVE      *ZEROS        B12
     C                   MOVE      *ZEROS        B13
     C                   MOVE      *ZEROS        B14
     C                   MOVE      *ZEROS        B15
     C                   MOVE      *ZEROS        B16
     C                   MOVE      *ZEROS        B17
     C                   MOVE      *ZEROS        B18
     C                   MOVE      *ZEROS        B19
     C                   MOVE      *ZEROS        B20
     C                   MOVE      *ZEROS        B21
     C                   MOVE      *ZEROS        B22
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDBL2        BEGSR
     C***********************************************
     C  N31STAD1K        CHAIN     STATDFL1                           35
     C   31STAD1K        CHAIN     STATODL1                           35
     C     *IN35         IFEQ      '0'
     C  N32              SUB       BL2           BL
     C   32              ADD       BL2           BL
     C  N31              UPDATE    STATDFR
     C   31              UPDATE    STATDFRO
     C                   ELSE
     C                   MOVEA     BL2           BL
     C  N31              WRITE     STATDFR
     C   31              WRITE     STATDFRO
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     PLUSS         BEGSR
     C***********************************************
     C                   MOVE      SLK1N         SLK1
     C                   MOVE      SLK2N         SLK2
     C                   MOVE      '1'           *IN32
     C     XOPDKN        IFEQ      'J'
     C                   MOVE      SLK1          XKUNR             8 0
     C                   END
      *
     C     KOVPRO        IFEQ      'F'
     C     KOVPRO        OREQ      'B'
     C                   MOVE      '0'           *IN31
     C                   MOVE      *ZEROS        XC≈M
     C                   MOVE      'N'           XOPDHF            1
     C                   EXSR      MOVBL0
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C     FAOPKO        CABNE     'O'           STPLS1
     C     XOPDKN        IFEQ      'J'                                            3<-B
     C     XKUNR         CABNE     FAKUNR        STPLS1
     C                   END                                                      3<-E
     C     XC≈M          IFEQ      0                                              3<-B
     C     XC≈M          OREQ      FAC≈M
     C                   EXSR      SUMBL
     C                   ELSE                                                     3
     C                   EXSR      OPDPL1
     C                   END                                                      3<-E
     C     STPLS1        TAG
     C     FAK8K         READE     FAK8                                   33
     C                   END                                                     2<-E
     C     XC≈M          IFEQ      0                                             2<-B
     C                   MOVE      SLDTM         XC≈MM
     C                   MOVE      SLDT≈         XC≈M≈
     C                   MOVE      SLDTC         XC≈MC
     C                   END                                                     2<-E
     C                   EXSR      OPDPL1
     C                   END                                                    1<-E
      *
     C     KOVPRO        IFEQ      'O'
     C     KOVPRO        OREQ      'B'
     C                   MOVE      SLDTMN        XMN
     C                   MOVE      SLDT≈N        X≈R
     C                   MOVE      SLDTCN        XCC
     C                   MOVE      '1'           *IN31
     C                   EXSR      MOVBL0
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C     FAOPKO        CABNE     'O'           STPLS2
     C     XOPDKN        IFNE      'J'                                            3<-B
     C     XKUNR         OREQ      FAKUNR
     C                   MOVE      XMN           XN
     C                   EXSR      SUMBL
     C                   END                                                      3<-E
     C     STPLS2        TAG
     C     FAK8K         READE     FAK8                                   33
     C                   END                                                     2<-E
     C                   EXSR      OPDPL2
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C******************************************
     C     OPDPL1        BEGSR
     C******************************************
     C                   MOVE      XC≈MM         XMN               2 0
     C                   MOVE      XC≈M≈         X≈R
     C                   MOVE      XC≈MC         XCC
     C     STAKEY        CHAIN     STATHFL1                           34
     C     XOPDHF        IFEQ      'N'                                             4<-B
      * HOVED STATISTIKKFIL OPPDATERES KUN EN GANG.
     C     *IN34         IFEQ      '0'                                              5<-B
     C                   EXSR      ADDDTA
     C                   EXCEPT    CHGST
     C                   ELSE                                                       5
     C                   EXSR      AD2DTA
     C     FIFIRM        CHAIN     FIRSTA                             34
     C  N34              Z-ADD     FISTNR        STSTNR
     C  N34              ADD       1             FISTNR
     C  N34              UPDATE    FIRSTAR
     C                   EXCEPT    NYST
     C                   END                                                        5<-E
     C                   MOVE      'J'           XOPDHF
     C                   END                                                       4<-E
     C     XOPDBL        IFEQ      'J'
     C                   EXSR      OPDBL
     C                   END
      *
     C                   ENDSR
      *
     C******************************************
     C     OPDPL2        BEGSR
     C******************************************
     C     STAKEY        CHAIN     STATOHL1                           34
     C     *IN34         IFEQ      '0'                                           2<-B
     C                   EXSR      ADDDTA
     C                   EXCEPT    CHGSTO
     C                   ELSE                                                    2
     C                   EXSR      AD2DTA
     C     FIFIRM        CHAIN     FIRSTA                             34
     C  N34              Z-ADD     FISTNR        STSTNR
     C  N34              ADD       1             FISTNR
     C  N34              UPDATE    FIRSTAR
     C                   EXCEPT    NYSTO
     C                   END                                                     2<-E
     C     XOPDBL        IFEQ      'J'
     C                   EXSR      OPDBL
     C                   END
      *
     C                   ENDSR
      *
     C******************************************
     C     ADDDTA        BEGSR
     C******************************************
      * LEGGER ANTALL OPPDRAG OG VEKTER TIL STATISTIKK
     C                   ADD       1             AS(XMN)
     C                   ADD       WSVKT         AV(XMN)
     C                   ADD       WSFBV         FV(XMN)
     C                   ADD       1             VG(V2)
     C                   ADD       1             AS(13)
     C                   ADD       WSVKT         AV(13)
     C                   ADD       WSFBV         FV(13)
     C                   ADD       1             VG(13)
     C     XANTCO        IFEQ      0                                            1<-B
     C                   ADD       1             SS(XMN)
     C                   ADD       1             SS(13)
     C                   ADD       WSVKT         VS(XMN)
     C                   ADD       WSVKT         VS(13)
     C                   ADD       WSM3          MS(XMN)
     C                   ADD       WSM3          MS(13)
     C                   ELSE                                                   1
     C                   ADD       XANTCO        AT(XMN)
     C                   ADD       XANTCO        AT(13)
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C******************************************
     C     AD2DTA        BEGSR
     C******************************************
      * NULLSTILLER ALLE TABELLENE
     C                   MOVE      *ZEROS        AS
     C                   MOVE      *ZEROS        AV
     C                   MOVE      *ZEROS        FV
     C                   MOVE      *ZEROS        VG
     C                   MOVE      *ZEROS        SS
     C                   MOVE      *ZEROS        AT
      *
     C                   EXSR      ADDDTA
      *
     C                   ENDSR
      *
     C******************************************
     C     HENTCO        BEGSR
     C******************************************
     C     BLV1K         SETLL     BLV1                               35
     C                   MOVE      *ZEROS        XANTCO            9 0
     C     STHCO         TAG
     C     BLV1K         READE     BLV1                                   35
     C     *IN35         IFEQ      '0'
     C     BVNT          MULT      BVENH         XWORK             7 0
     C                   ADD       XWORK         XANTCO
     C                   GOTO      STHCO
     C                   END
      *
     C                   ENDSR
      *
     C******************************************
     C     SUMBL         BEGSR
     C******************************************
     C                   SELECT
     C     FAGGRP        WHENEQ    'AI'
     C                   ADD       FABELN        B01(XN)
     C                   ADD       FABELN        B01(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'BI'
     C                   ADD       FABELN        B02(XN)
     C                   ADD       FABELN        B02(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'CI'
     C                   ADD       FABELN        B03(XN)
     C                   ADD       FABELN        B03(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'DI'
     C                   ADD       FABELN        B04(XN)
     C                   ADD       FABELN        B04(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'EI'
     C                   ADD       FABELN        B05(XN)
     C                   ADD       FABELN        B05(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'FI'
     C                   ADD       FABELN        B06(XN)
     C                   ADD       FABELN        B06(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'GI'
     C                   ADD       FABELN        B07(XN)
     C                   ADD       FABELN        B07(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'HI'
     C                   ADD       FABELN        B08(XN)
     C                   ADD       FABELN        B08(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'II'
     C                   ADD       FABELN        B09(XN)
     C                   ADD       FABELN        B09(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'JI'
     C                   ADD       FABELN        B10(XN)
     C                   ADD       FABELN        B10(13)
     C                   ADD       FABELN        B21(XN)
     C                   ADD       FABELN        B21(13)
     C     FAGGRP        WHENEQ    'AK'
     C                   ADD       FABELN        B11(XN)
     C                   ADD       FABELN        B11(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'BK'
     C                   ADD       FABELN        B12(XN)
     C                   ADD       FABELN        B12(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'CK'
     C                   ADD       FABELN        B13(XN)
     C                   ADD       FABELN        B13(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'DK'
     C                   ADD       FABELN        B14(XN)
     C                   ADD       FABELN        B14(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'EK'
     C                   ADD       FABELN        B15(XN)
     C                   ADD       FABELN        B15(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'FK'
     C                   ADD       FABELN        B16(XN)
     C                   ADD       FABELN        B16(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'GK'
     C                   ADD       FABELN        B17(XN)
     C                   ADD       FABELN        B17(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'HK'
     C                   ADD       FABELN        B18(XN)
     C                   ADD       FABELN        B18(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'IK'
     C                   ADD       FABELN        B19(XN)
     C                   ADD       FABELN        B19(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C     FAGGRP        WHENEQ    'JK'
     C                   ADD       FABELN        B20(XN)
     C                   ADD       FABELN        B20(13)
     C                   ADD       FABELN        B22(XN)
     C                   ADD       FABELN        B22(13)
     C                   ENDSL
      *
     C                   MOVE      FAC≈M         XC≈M
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BLV1K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     FAK8K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     STAVFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     STAD1K        KLIST
     C                   KFLD                    STSTNR
     C                   KFLD                    STGR
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    KOAAVD
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C     KODLKK        KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    KLKLK
     C     STE2DK        KLIST
     C                   KFLD                    ST2LK
     C                   KFLD                    ST2KOD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UOPD              7
     C     SLUSR         PARM                    UUSRID           10
      *
     C                   MOVE      UAVD          HEAVD
     C                   MOVE      UOPD          HEOPD
     C                   MOVE      'A'           KOAUNI
     C                   MOVE      'V'           KOVUNI
     C                   MOVE      'LK'          KLKUNI
     C                   TIME                    WTIME
     C                   MOVE      WDD           SLDTDD
     C                   MOVE      WMM           SLDTMM
     C                   MOVE      W≈≈           SLDT≈≈
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM                               33
     C                   READ      FIRM                                   33
     C     FIFIRM        CHAIN(N)  FIRSTA                             33
     C     KODTVK        CHAIN     KODTV                              33
     C                   Z-ADD     99999         KOVK12
      *
     C                   ENDSR
      *
     OSTATHFL1  E            CHGST
     O                       XCC                  3
     O                       X≈R                  5
     O                       SLK1                13
     O                       SLK2                21
     O                       FV                 103P
     O                       AV                 181P
     O                       AS                 246P
     O                       VG                 311P
     O                       AT                 376P
     O                       SS                 441P
     O                       VS                 519P
     O                       MS                 584P
     O          EADD         NYST
     O                       SLRI                 1
     O                       XCC                  3
     O                       X≈R                  5
     O                       SLK1                13
     O                       SLK2                21
     O                       SLAVD               25
     O                       FV                 103P
     O                       AV                 181P
     O                       AS                 246P
     O                       VG                 311P
     O                       AT                 376P
     O                       SS                 441P
     O                       VS                 519P
     O                       MS                 584P
     O                       STSTNR             590P
     OSTATOHL1  E            CHGSTO
     O                       XCC                  3
     O                       X≈R                  5
     O                       SLK1                13
     O                       SLK2                21
     O                       FV                 103P
     O                       AV                 181P
     O                       AS                 246P
     O                       VG                 311P
     O                       AT                 376P
     O                       SS                 441P
     O                       VS                 519P
     O                       MS                 584P
     O          EADD         NYSTO
     O                       SLRI                 1
     O                       XCC                  3
     O                       X≈R                  5
     O                       SLK1                13
     O                       SLK2                21
     O                       SLAVD               25
     O                       FV                 103P
     O                       AV                 181P
     O                       AS                 246P
     O                       VG                 311P
     O                       AT                 376P
     O                       SS                 441P
     O                       VS                 519P
     O                       MS                 584P
     O                       STSTNR             590P
