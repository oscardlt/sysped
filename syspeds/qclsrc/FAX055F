             PGM        PARM(&AVD &TUR &KUNRA &BELJN &FAX15 &LAND)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BPARM) TYPE(*CHAR) LEN(450)
             DCL        VAR(&BPARM2) TYPE(*CHAR) LEN(520)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BELJN) TYPE(*CHAR) LEN(1)
             DCL        VAR(&E) TYPE(*CHAR) LEN(1) VALUE('E')
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&KUNRA) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNAVN) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNA12) TYPE(*CHAR) LEN(12)
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in01 på, betyr det avslutt program +
                          fra valgbilde. */
             DCL        VAR(&IN03) TYPE(*LGL) LEN(1) /* Hvis &in03 +
                          på, skal losseliste  være stående. */
             DCL        VAR(&IN04) TYPE(*LGL) LEN(1) /* Hvis &in04 +
                          på, skal printetype være 4224. */
             DCL        VAR(&JBK) TYPE(*CHAR) LEN(1) /* Jobbkø. */
             DCL        VAR(&FAXNR) TYPE(*CHAR) LEN(21)
             DCL        VAR(&FAX15) TYPE(*CHAR) LEN(15)
             DCL        VAR(&LAND) TYPE(*CHAR) LEN(2)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('T')
             DCL        VAR(&TX) TYPE(*CHAR) LEN(1) VALUE('N')
             DCLF       FILE(FAXSEN)
             RCVF       RCDFMT(*FILE)
    /* */
             CHGVAR     VAR(&FAXNR) VALUE(&FAX15)
    /* */
    /* HENTE FAXOPPLYSNINGER                               */
             CALL       PGM(FAXBIG) PARM(&JBK &IN03 &IN04 &IN01 +
                          &FAXNR &AVD &TUR &NAVN &PDATE &PTIME &TX +
                          &DOKNAVN &KUNRA &CVP1 &CVP2 &CVP3 &CVP4 +
                          &CVP5 &CVP6 &CVP7 &CVP8 &CVP &LAND &EPOST +
                          &EPOSTJ)
             IF         COND(&IN01 = '1') THEN(GOTO CMDLBL(SLUTT)) /* +
                          Hvis &IN01 på, avslutter program. */
/*                         */
/*  EPOST-SENDING          */
/*                         */
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             RTVJOBA    USER(&MAPPE)
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             CHGVAR     VAR(&BPARM2) VALUE(&FAXNR *CAT &DOKNA12 *CAT +
                          &MAPPE *CAT &PTIME *CAT &PDATE *CAT &NAVN +
                          *CAT &AVD *CAT &OPD *CAT &TUR *CAT &KODE +
                          *CAT &KUNRA *CAT &CVP1 *CAT &CVP2 *CAT +
                          &CVP3 *CAT &CVP4 *CAT &CVP5 *CAT &CVP6 +
                          *CAT &CVP7 *CAT &CVP8 *CAT &CVP *CAT +
                          &BELJN *CAT &EPOST *CAT &E)
             OVRPRTF    FILE(GODSLIST) DEVTYPE(*SCS) +
                          PAGESIZE(72 120) CPI(15) +
                          OVRFLW(70)  OUTQ(SY400OUTQ) +
                          FORMTYPE(*STD)
    /* */
             SBMJOB     CMD(CALL PGM(FAX055CLBE) PARM(&BPARM2)) +
                          JOB(SNDFAXGOD) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             RETURN
             ENDDO
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*                         */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             RTVJOBA    USER(&MAPPE)
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             CHGVAR     VAR(&BPARM) VALUE(&FAXNR *CAT &DOKNA12 *CAT +
                          &MAPPE *CAT &PTIME *CAT &PDATE *CAT &NAVN +
                          *CAT &AVD *CAT &OPD *CAT &TUR *CAT &KODE +
                          *CAT &KUNRA *CAT &CVP1 *CAT &CVP2 *CAT +
                          &CVP3 *CAT &CVP4 *CAT &CVP5 *CAT &CVP6 +
                          *CAT &CVP7 *CAT &CVP8 *CAT &CVP *CAT +
                          &BELJN *CAT &E)
             OVRPRTF    FILE(GODSLIST) DEV(*JOB) DEVTYPE(*AFPDS) +
                          PAGESIZE(72 120) CPI(15) FRONTMGN(0 0.5) +
                          OVRFLW(70) DRAWER(3) OUTQ(QFAX/QFAXOUTQ) +
                          FORMTYPE(*STD)
    /* */
             SBMJOB     CMD(CALL PGM(FAX055CLB) PARM(&BPARM)) +
                          JOB(SNDFAXGOD) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             OVRPRTF    FILE(GODSLIST) PAGESIZE(72 120) CPI(15) +
                          OVRFLW(70) DRAWER(3) +
                          OUTQ(&FAXLIB/&FAXUTK) FORMTYPE(*STD)
    /* */
             RTVJOBA    USER(&MAPPE)
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             SBMJOB     CMD(CALL PGM(FAX055CLB2) PARM(&FAXNR +
                          &DOKNA12 &MAPPE &PTIME &PDATE &NAVN &AVD +
                          &OPD &TUR &KODE &BELJN)) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             RTVJOBA    USER(&MAPPE)
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             CHGVAR     VAR(&DOKNA12) VALUE('GODSLIST')
             CHGVAR     VAR(&BPARM) VALUE(&FAXNR *CAT &DOKNA12 *CAT +
                          &MAPPE *CAT &PTIME *CAT &PDATE *CAT &NAVN +
                          *CAT &AVD *CAT &OPD *CAT &TUR *CAT &KODE +
                          *CAT &KUNRA *CAT &CVP1 *CAT &CVP2 *CAT +
                          &CVP3 *CAT &CVP4 *CAT &CVP5 *CAT &CVP6 +
                          *CAT &CVP7 *CAT &CVP8 *CAT &CVP *CAT +
                          &BELJN *CAT &E)
             OVRPRTF    FILE(GODSLIST) DEV(*JOB) DEVTYPE(*SCS) +
                          PAGESIZE(72 120) CPI(15) +
                          OVRFLW(70) OUTQ(FAX/FAXOUT) +
                          FORMTYPE(*STD)
    /* */
             SBMJOB     CMD(CALL PGM(FAX055CLBB) PARM(&BPARM)) +
                          JOB(SNDFAXGOD) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
    /* */
 SLUTT:      ENDPGM
