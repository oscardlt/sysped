      *
      ************************************************************
      *** UTSKRIFT AV TUR.RAPPORT                              ***
      ************************************************************
      *
     FFIRM      IF   E           K DISK
     FSYKS31FA  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  PARMDS                 1    256
     D  WSOPTU                 1      1
     D  WSFALI                 2      2
     D  WSUFLI                 3      3
     D  WSFKOS                 4      4
     D  WSBKOS                 5      5
     D  WSILIN                 6      6
     D  UUREGT                 7     13
     D  WSREGT                 7     13  0
     D  UUDBGT                14     18
     D  WSDBGT                14     18  2
     D  UURELT                19     25
     D  WSRELT                19     25  0
     D  UUDBLT                26     30
     D  WSDBLT                26     30  2
     D  WSAVRS                31     31
     D  UUPERF                32     37
     D  WSPERF                32     37  0
     D  UUPERT                38     43
     D  WSPERT                38     43  0
     D  UUAVDF                44     47
     D  WSAVDF                44     47  0
     D  UUAVDT                48     51
     D  WSAVDT                48     51  0
     D  WSAVDG                52     58
     D  WSORAN                59     59
     D  WSPERI                60     60
     D  WSGEIO                61     61
     D  WSGE01                62     64
     D  WSGE02                65     67
     D  WSGE03                68     70
     D  WSGE04                71     73
     D  WSGE05                74     76
     D  WSGE06                77     79
     D  WSGE07                80     82
     D  WSGE08                83     85
     D  WSGE09                86     88
     D  WSGE10                89     91
     D  WSGE11                92     94
     D  WSGE12                95     97
     D  WSGE13                98    100
     D  GE                    62    100
     D  WSSTIO               101    101
     D  WSSTGR               102    111
     D  SG                   102    111
     D                                     DIM(10)
     D  WSAVSL               112    112
     D  WSBAVD               113    113
     D  WSTURF               114    121  0
     D  UUTURF               114    121
     D  WSTURT               122    129  0
     D  UUTURT               122    129
     D  DUMMY                256    256
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UUPARM          256
     C                   PARM                    WSPRT
     C                   PARM                    WSFORM
     C                   PARM                    WSJOBQ
     C                   PARM                    UIN01             1
     C*
     C                   CLEAR                   PARMDS
     C                   CLEAR                   BILDE01
     C                   MOVE      '0'           UIN01
     C                   MOVEL     '*JOB'        WSPRT
     C                   MOVEL     '*STD'        WSFORM
     C                   MOVE      'J'           WSJOBQ
     C                   MOVE      'T'           WSOPTU
     C                   MOVE      'J'           WSFALI
     C                   MOVE      'N'           WSUFLI
     C                   MOVE      'J'           WSFKOS
     C                   MOVE      'N'           WSBKOS
     C                   MOVE      'N'           WSILIN
     C                   MOVE      'O'           WSORAN
     C                   MOVE      'N'           WSAVRS
     C                   MOVE      'O'           WSPERI
     C                   MOVE      'N'           WSAVSL
     C                   MOVE      'N'           WSBAVD
      * Når param. er definert i DS og siste del av den er blank
      * vil systemet utnytte "den ledige plassen" for de neste param.
      * Da kommer dette som "grums" i DS i mottakende RPG-program.
      * Aktiv bruk av siste tegn i DS hindrer dette.
     C                   MOVE      'X'           DUMMY
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C*
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   SETOFF                                       309899
     C                   SETOFF                                       9796
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
      * SØKING
     C     *IN04         IFEQ      *ON
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * Avd. fra/til
     C     LINNBR        IFEQ      13
     C     POSNBR        IFLT      33
     C                   CALL      'SYFA14B'
     C                   PARM                    XXAVD             4 0
     C                   Z-ADD     XXAVD         WSAVDF
     C                   Z-ADD     33            POSNBR
     C                   ELSE
     C                   CALL      'SYFA14B'
     C                   PARM                    XXAVD
     C                   Z-ADD     XXAVD         WSAVDT
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   END
     C                   GOTO      START
     C                   END
      * Avd.grp
     C     LINNBR        IFEQ      14
     C                   CALL      'SYFA59A'
     C                   PARM                    WSAVDG
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      START
     C                   END
      * Geb-koder
     C     LINNBR        IFEQ      16
     C                   EXSR      GEBSØK
     C                   GOTO      START
     C                   END
      * Stat. gruppe koder
     C     LINNBR        IFEQ      17
     C                   MOVE      'N'           UUPDAT            1
     C                   MOVEL     'GRITYPE'     KFTYPI           10
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYPI
     C                   PARM                    UUPDAT
     C                   PARM                    KFKOD             5
     C                   MOVEL     KFKOD         GRPKOD            1
     C     GRPKOD        IFNE      *BLANKS
     C     1             DO        10            NR                3 0
     C     SG(NR)        IFEQ      *BLANKS
     C                   MOVE      GRPKOD        SG(NR)
     C                   GOTO      START
     C                   END
     C                   END
     C                   END
     C                   GOTO      START
     C                   END
      *
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
     C*
     C     SLUTT         TAG
     C                   MOVE      PARMDS        UUPARM
     C*
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     GEBSØK        BEGSR
     C***********************************************
     C                   SELECT
     C     POSNBR        WHENGE    28
     C     POSNBR        ANDLE     30
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE01
     C                   Z-ADD     32            POSNBR
     C     POSNBR        WHENGE    32
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE02
     C                   Z-ADD     36            POSNBR
     C     POSNBR        WHENGE    36
     C     POSNBR        ANDLE     38
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE03
     C                   Z-ADD     40            POSNBR
     C     POSNBR        WHENGE    40
     C     POSNBR        ANDLE     42
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE04
     C                   Z-ADD     44            POSNBR
     C     POSNBR        WHENGE    44
     C     POSNBR        ANDLE     46
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE05
     C                   Z-ADD     48            POSNBR
     C     POSNBR        WHENGE    48
     C     POSNBR        ANDLE     50
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE06
     C                   Z-ADD     52            POSNBR
     C     POSNBR        WHENGE    52
     C     POSNBR        ANDLE     54
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE07
     C                   Z-ADD     56            POSNBR
     C     POSNBR        WHENGE    56
     C     POSNBR        ANDLE     58
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE08
     C                   Z-ADD     60            POSNBR
     C     POSNBR        WHENGE    60
     C     POSNBR        ANDLE     62
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE09
     C                   Z-ADD     64            POSNBR
     C     POSNBR        WHENGE    64
     C     POSNBR        ANDLE     66
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE10
     C                   Z-ADD     68            POSNBR
     C     POSNBR        WHENGE    68
     C     POSNBR        ANDLE     70
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE11
     C                   Z-ADD     72            POSNBR
     C     POSNBR        WHENGE    72
     C     POSNBR        ANDLE     74
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE12
     C                   Z-ADD     76            POSNBR
     C     POSNBR        WHENGE    76
     C     POSNBR        ANDLE     78
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE13
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   ENDSL
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     WSTURT        IFEQ      *ZEROS
     C                   MOVE      WSTURF        WSTURT
     C                   END
     C     WSTURF        IFEQ      *ZEROS
     C                   MOVE      'JOV1130'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      UTTEST
     C                   END
      *
     C     WSPEF         IFNE      *ZEROS
     C     WSPEF         IFGE      50
     C     WSPEF         ADD       190000        WSPERF
     C                   ELSE
     C     WSPEF         ADD       200000        WSPERF
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        WSPERF
     C                   END
     C     WSPET         IFNE      *ZEROS
     C     WSPET         IFGE      50
     C     WSPET         ADD       190000        WSPERT
     C                   ELSE
     C     WSPET         ADD       200000        WSPERT
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        WSPERT
     C                   END
     C     WSPERT        IFEQ      *ZEROS
     C                   MOVE      WSPERF        WSPERT
     C                   MOVE      WSPERF        WSPET
     C                   END
     C     WSAVDT        IFEQ      *ZEROS
     C                   MOVE      WSAVDF        WSAVDT
     C                   END
      * Div. verdier som rettes til dft. hvis...
     C     WSORAN        IFNE      'A'
     C                   MOVE      'O'           WSORAN
     C                   END
     C     WSPERI        IFNE      'F'
     C                   MOVE      'O'           WSPERI
     C                   END
     C     GE            IFNE      *BLANKS
     C     WSGEIO        ANDNE     'O'
     C                   MOVE      'I'           WSGEIO
     C                   END
     C     WSSTGR        IFNE      *BLANKS
     C     WSSTIO        ANDNE     'O'
     C                   MOVE      'I'           WSSTIO
     C                   END
     C     WSBAVD        IFEQ      ' '
     C                   MOVE      'N'           WSBAVD
     C                   END
     C*
     C     WSTURF        IFEQ      *ZEROS
     C     WSPERF        IFLT      195001
     C     WSPERF        ORGT      215001
     C     WSPERF        ORGT      WSPERT
     C                   MOVE      'JOV0905'     MSGNR
     C                   SETON                                        3099
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      UTTEST
     C                   END
     C                   END
      *
      *
     C     UTTEST        ENDSR
     C*
