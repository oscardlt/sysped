     FSYTIRCV   IP   F  256        DISK
     FKODTS8NY  UF A E           K DISK
     FSADSDNY   UF A E           K DISK
     D                 DS
     D  SDDTFÅ                 1      4  0
     D  SDDTFM                 5      6  0
     D  SDDTFD                 7      8  0
     D  SDDTF                  1      8  0
     D                 DS
     D  SDDTTÅ                 1      4  0
     D  SDDTTM                 5      6  0
     D  SDDTTD                 7      8  0
     D  SDDTT                  1      8  0
     D                 DS
     D  SATS                   1      8  2
     D  SATS1                  1      6  0
     D  SATS2                  7      8  0
     D                 DS
     D  KS8FTX                 1     52
     D  KS8MIL                52     52
     D  KS8ØRE                51     51
     D                 DS
     D  RDATA                  1    256
     D  RD                     1    256    DIM(256)
     D                 DS
     D  XAVGKD                 1      2
     D  AV                     1      2    DIM(2)
     D                 DS
     D  XSEKV                  1      3
     D  SE                     1      3    DIM(3)
     ISYTIRCV   NC  01
     I                                  1  256  RDATA
      *
     C                   IF        XINIT <> 'J'
     C     *ENTRY        PLIST
     C                   PARM                    INST              1
      * ER MODUL INSTALLERT ?????
     C     MODOK         IFNE      'J'
     C                   MOVEL     'SYTADINT'    UMODUL           15
     C                   MOVE      '       '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   MOVE      UMFLAG        INST
     C                   SETON                                        LR
     C                   RETURN
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
      *
      *
     C     SADSDK        KLIST
     C                   KFLD                    SDTNRF
     C                   KFLD                    SDKDAÆ
     C                   KFLD                    SDKDSÆ
     C                   KFLD                    SDDTF
      *
     C     KODS8H        KLIST
     C                   KFLD                    KS8AVG
     C                   KFLD                    KS8SKV
     C     KODS8K        KLIST
     C                   KFLD                    KS8AVG
     C                   KFLD                    XSEKVGM
      *
     C                   MOVE      '0'           INST
     C                   MOVE      'J'           XINIT             1
     C                   MOVE      *ZEROS        XTARNRGM          8 0
     C                   MOVE      *ZEROS        XDTFGM            8 0
     C                   MOVE      *ZEROS        XDTTGM            8 0
     C                   MOVE      *BLANKS       XSEKVGM           3
     C                   MOVE      'RT'          KS8AVG
     C                   END
      *
      * HENT TARIFFNR
     C                   MOVE      *ZEROS        XTARNR            8 0
     C     1             DO        8             XN                3 0
     C                   MULT      10            XTARNR
     C                   MOVE      RD(XN)        XTARNR
     C                   ENDDO
      * HENT FRADATO
     C                   MOVE      *ZEROS        XDTF              8 0
     C                   DO        10
     C                   ADD       1             XN
     C                   IF        RD(XN) <> '.'
     C                   MULT      10            XDTF
     C                   MOVE      RD(XN)        XDTF
     C                   END
     C                   ENDDO
      * HENT TILDATO
     C                   ADD       1             XN
     C                   MOVE      *ZEROS        XDTT              8 0
     C                   DO        10
     C                   ADD       1             XN
     C                   IF        RD(XN) <> '.'
     C                   MULT      10            XDTT
     C                   MOVE      RD(XN)        XDTT
     C                   END
     C                   ENDDO
      * LES FORBI TO ;
     C                   ADD       1             XN
     C     1             DO        2
     C                   DO        50
     C                   ADD       1             XN
     C                   IF        RD(XN) = ';'
     C                   LEAVE
     C                   END
     C                   ENDDO
     C                   ENDDO
      * HENT AVGIFTKODE
     C                   MOVE      *BLANKS       XAVGKD
     C                   MOVE      *ZEROS        XN2               3 0
     C                   DO        10
     C                   ADD       1             XN
     C                   IF        RD(XN) = ';'
     C                   LEAVE
     C                   ELSE
     C                   ADD       1             XN2
     C                   MOVE      RD(XN)        AV(XN2)
     C                   END
     C                   ENDDO
     C                   IF        XAVGKD <> 'RT'
     C                   GOTO      SLUTT
     C                   END
      * HENT SEKVENSNR
     C                   MOVE      *BLANKS       XSEKV
     C                   MOVE      *ZEROS        XN2               3 0
     C                   DO        10
     C                   ADD       1             XN
     C                   IF        RD(XN) = ';'
     C                   LEAVE
     C                   ELSE
     C                   ADD       1             XN2
     C                   MOVE      RD(XN)        SE(XN2)
     C                   END
     C                   ENDDO
      *
     C                   IF        ((XTARNR <> XTARNRGM) OR (XSEKV <> XSEKVGM))
     C                   EXSR      SRNYRT
     C                   END
      *
     C     SLUTT         TAG
     CLR                 EXSR      SRNYRT
      *
      ********************************************************
     C     SRNYRT        BEGSR
      ********************************************************
     C                   IF        XSEKVGM <> *BLANKS
      * HEADER/GRUNN-DEFINISJON MED BLANK I SEKVENS...
     C                   MOVE      *BLANKS       KS8SKV
     C     KODS8H        CHAIN     KODTS8NY                           33
     C     *IN33         IFEQ      '1'                                            3<-B
     C                   EVAL      KS8FTX = 'RÅVARETOLL'
     C                   MOVE      'K'           KS8STY
     C                   MOVE      9999999       KS8SAT
     C                   MOVE      ' '           KS8ØRE
     C                   WRITE     KOS8R
     C                   END                                                      3<-E
      * AVGIFT/SEKVENS (MED SATS.. FRA FØRSTE FOREKOMST.)
     C     KODS8K        CHAIN     KODTS8NY                           33
     C     *IN33         IFEQ      '1'                                            3<-B
     C                   EVAL      KS8FTX = 'RÅVARETOLL'
     C                   MOVE      XSEKV         KS8SKV
     C                   MOVE      'K'           KS8STY
     C                   MOVE      9999999       KS8SAT
     C                   MOVE      ' '           KS8ØRE
     C                   WRITE     KOS8R
     C                   END
      * OPPDATER SADSD
     C                   MOVE      XTARNRGM      SDTNRF
     C                   MOVE      'RT'          SDKDAÆ
     C                   MOVE      XSEKVGM       SDKDSÆ
     C                   MOVE      XDTFGM        SDDTF
     C                   MOVE      XDTTGM        SDDTT
     C                   MOVE      9999999       SDBLSÆ
     C                   WRITE     SADSDR
      *
     C                   END
      *
     C                   MOVE      XTARNR        XTARNRGM
     C                   MOVE      XDTF          XDTFGM
     C                   MOVE      XDTT          XDTTGM
     C                   MOVE      XSEKV         XSEKVGM
      *
     C                   ENDSR
      *
