INT   *
INT   * DET ER KUN INTERSP. PR DAGS DATO SOM BRUKER FORDELING
INT   * OGSÅ STANDARDPROG. INNEHOLDER FORELØPIN MANGE INTERSP-SPESIALER
INT   * SLIKE RENE SPESIALER SOM "GODT KAN LIGGE I STD" ER MERKET MED
INT   * KUN INT I MARGEN. (HINT OM TING SOM MÅ GJØRES MER FLEXIBELT
INT   * HVIS ANDRE KUNDER SKAL TA DET I BRUK....)
INT   *
INTER *INTERSPED*START
INTER * INTERSPEDSPESIALER SOM IKKE KAN LIGGE I STANDARD F.EKS PGA
INTER * BRUK AV FILER SOM ER REN INTERSP-SPESIAL M.M. ER MERKET
INTER * SOM VIST HER, OG ER "STJERNET UT AV  STANDARD"
INTER *INTERSPED*SLUTT
      ***********************************************************
      *** PROGRAM SKAL LAGE DISTRIBUSJONSOPPDRAG              ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-94 96-99
      ***********************************************************
      *
     FHEADF     IF A E           K DISK
     FDOKUF     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTPI1   IF   E           K DISK
     FSTED2D    IF   E           K DISK
     FTELL      UF   E           K DISK
     FFAKT      O    E           K DISK
     FFRISOK    O    E           K DISK
     FKODFRI    IF   E           K DISK
     FFRSTTG    IF   E           K DISK
INTER *INTERSPED*START
INTERF*VAFORDH3IF  E           K        DISK
INTERF*VAFORDV2IF  E           K        DISK
INTERF*VALAJL01IF  E           K        DISK                      A
INTERF*VALDAUT O   E           K        DISK
INTER *INTERSPED*SLUTT
INT  D                 DS
INT  D  WTIME                  1     14  0
INT  D  WTM                    1      6  0
INT  D  WDD                    7      8  0
INT  D  WMM                    9     10  0
INT  D  WÅÅ                   11     14  0
INT  D                 DS
INT  D  DATO                   1      8  0
INT  D  DTÅ                    1      4  0
INT  D  DTM                    5      6  0
INT  D  DTD                    7      8  0
INT  D                 DS
INT  D  DFVS2                  1     25
INT  D  BUTTXT                 1      7
INT  D  BUTNR                  9     11
     D                 DS
     D  DSSOK                  1     35
     D  DSAVD                  1      4
     D  DSOPD                  5     11
      *
     C                   EXSR      INIT
      *
     C     HEADFK        CHAIN     HEADF                              33
      *
      * KUNDENR FOR EVT RAB. ER MOTT. PÅ FORD.OPPDR.(MED 2 UNNTAK)
     C                   MOVE      *ZEROS        IIKUND
      * AVD-NR FOR EVT RAB. ER OPPDRAGSGIVENDE AVD
     C                   MOVE      HEAVD         IIAVD
      * HVIS DISTR. LAGES BASERT PÅ FR.BREV,HENT ENKELTE VERDIER DERFRA
     C     UFBNR         IFNE      *ZEROS
     C     DOKUFK        CHAIN     DOKUF                              33
     C     *IN33         IFEQ      '0'
INT   *             ER 001 ELLER 003 - DA LAGES IKKE!! DISTR.OPPDRAG
INT  C     BUTTXT        IFEQ      'BUTIKK:'
INT  C     BUTNR         IFEQ      '001'
INT  C     BUTNR         OREQ      '003'
INTER *INTERSPED*START* AUTOMATISK INNLAGG PÅ LAGER DERSOM BUTIKKNR
INTERC*                    EXSR LAGINN
INTER *INTERSPED*SLUTT
INT  C                   GOTO      SLUTT
INT  C                   ELSE
INT   * HVIS BUT.NR ULIK 001/003 - SJEKK OM ENKELTE ART. ER LAGERUTTAK
INT   *                    (FORØVRIG VANL. DISTR.M/SKAPING AV OPPDRAG)
INTER *INTERSPED*START* AUTOMATISK UTTAK AV LAGER DERSOM BUTIKKNR ...
INTERC*                    EXSR LAGUT
INTER *INTERSPED*SLUTT
INT  C                   END
INT  C                   END
     C                   MOVEL     DFKNM         KNRALF            8
     C                   TESTN                   KNRALF               33
     C     *IN33         IFEQ      '1'
     C                   MOVEL     KNRALF        HEKNK
     C                   END
     C                   MOVE      DFNAVM        HENAK
     C                   MOVE      DFAD1M        HEADK1
     C                   MOVE      *BLANKS       HEADK2
     C                   MOVE      DFAD3M        HEADK3
     C                   Z-ADD     DFNT          HENT
     C                   Z-ADD     DFVKT         HEVKT
     C                   Z-ADD     DFVKTF        HEFBV
     C                   Z-ADD     DFM3          HEM3
      *
     C                   END
     C                   END
      *
      * HVIS FØRSTE 4 AV SISTE ADR.LINJE IKKE ER NUM. SETT TILSTED...
     C                   MOVE      0583          XPOSTN            4 0
     C                   MOVEL     HEADK3        XPOSTA            4
     C                   TESTN                   XPOSTA               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      XPOSTA        XPOSTN
     C                   END
     C                   Z-ADD     HEAVD         XKUNR             8 0
     C     UIN10         IFEQ      '1'
     C                   MOVE      HEKNK         HEKNA
     C                   MOVE      *ZEROS        UAVDV
     C                   ENDIF
     C                   EXSR      GENIN
INT  C     HEAVD         IFNE      9699
     C                   EXSR      GENII
INT  C                   ENDIF
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
INTER *INTERSPED*START
INTER ******************************************
INTERC*          LAGINN    BEGSR
INTER ***********************************************
INTER * LES ALLE ARTIKLER SOM INNGÅR I ETT OPPDRAG
INTERC*          HEADFK    SETLLVAFORDH3             33
INTERC*          HEADFK    READEVAFORDH3                 33
INTERC*          *IN33     DOWEQ'0'
INTERC*                    MOVE VFHMN     VFVMN
INTERC*                    MOVE DFFBNR    VFVFBN
INTER * FOR HVER ARTIKKEL - FINN DETALJ-LINJE(R) FOR AKT. FRAKTBREV
INTERC*          VFBKEY    SETLLVAFORDV2
INTERC*          VFBKEY    READEVAFORDV2                 34
INTERC*          *IN34     DOWEQ'0'
INTER * DOBBELTFORSIKRING OM AT BUTIKKNR VIRKELIG SAMSVARER MED FR.BR.
INTERC*          VFVBNR    IFEQ '001  '
INTERC*          VFVBNR    OREQ '003  '
INTER * LAG INNLEGGS-POST" I INTERSPED LAGER.
INTER * HENT NESTE NR
INTERC*                    MOVE VFHPNR    VAKJED
INTERC*                    MOVE 9999999   VAMN
INTERC*          LKEY1     SETLLVALAJL01
INTERC*          LKEY1E    REDPEVALAJL01                 34
INTERC*  34                MOVE *ZEROS    VAMN
INTERC*                    ADD  1         VAMN
INTER * Skriver posten
INTERC*                    MOVELVFHHK     VAHK
INTERC*                    MOVELVFHANR    VAANR
INTERC*                    MOVELVFHFAR    VAFAR
INTERC*                    MOVELVFHSIZ    VASIZ
INTERC*                    MOVELVFHVB1    VAVARE
INTERC*                    Z-ADDVFHPRI    VAVERD
INTERC*                    Z-ADDVFWANT    VAOANT
INTERC*                    Z-ADDVAOANT    VASALD
INTERC*                    Z-ADDVFHTDT    VADATO
INTERC*                    Z-ADDVFWVEK    VAVKT
INTERC*                    MOVE *BLANKS   VABUSE
INTERC*                    MOVEL'*AUTO*'  VABUSE
INTERC*                    TIME           WTIME
INTERC*                    MOVE WDD       DTD
INTERC*                    MOVE WMM       DTM
INTERC*                    MOVE WÅÅ       DTÅ
INTERC*                    Z-ADDDATO      VABDAT
INTERC*                    Z-ADDWTM       VABKL
INTERC*                    MOVE VFHAVD    VAAVD
INTERC*                    MOVE VFHOPD    VAOPD
INTERC*                    MOVE VFVFBN    VAFBNR
INTERC*                    WRITEVALAJR
INTERC*                    END
INTERC*          VFBKEY    READEVAFORDV2                 34
INTERC*                    END
INTERC*          HEADFK    READEVAFORDH3                 33
INTERC*                    END
INTER * LEGG UT 9999/9999 I RETUR-PARAMETER FOR Å FLAGGE AT DISTR.
INTER * OPPDRAG IKKE SKAL LAGES
INTERC*                    MOVE 9999      UAVDV
INTERC*                    MOVE 9999999   UOPDV
INTERC*                    MOVE UOPDV     HEOPD              *RET-PARM
INTER *
INTERC*                    ENDSR
INTER *
INTER ******************************************
INTERC*          LAGUT     BEGSR
INTER ***********************************************
INTER * LES ALLE ARTIKLER SOM INNGÅR I ETT OPPDRAG
INTERC*          HEADFK    SETLLVAFORDH3             33
INTERC*          HEADFK    READEVAFORDH3                 33
INTERC*          *IN33     DOWEQ'0'
      * KODE FOR UTTAK FRA LAGER LIGGER PÅ HEADER-NIVÅ!!!
INTERC*          VFHILA    IFEQ 'L'
INTERC*                    MOVE VFHMN     VFVMN
INTERC*                    MOVE DFFBNR    VFVFBN
INTER * FOR HVER ARTIKKEL - FINN DETALJ-LINJE(R) FOR AKT. FRAKTBREV
INTERC*          VFBKEY    SETLLVAFORDV2
INTERC*          VFBKEY    READEVAFORDV2                 34
INTERC*          *IN34     DOWEQ'0'
INTER * DOBBELTFORSIKRING OM AT BUTIKKNR VIRKELIG SAMSVARER MED FR.BR.
INTERC*          VFVBNR    IFNE '001  '
INTERC*          VFVBNR    ANDNE'003  '
INTER * LAG UTTAKS-POST" I INTERSPED LAGER. (WORKFILE FOR VA029R)
INTER * Skriver posten
INTERC*                    MOVE VAGRUP    VDGRUP
INTERC*                    MOVE VFHPNR    VDKJED
INTERC*                    MOVELVFHHK     VDHK
INTERC*                    MOVELVFHANR    VDANR
INTERC*                    MOVELVFHFAR    VDFAR
INTERC*                    MOVELVFHSIZ    VDSIZ
INTERC*                    Z-ADDVFWANT    VDLENT
INTERC*                    Z-ADDVDLENT    VDREST
INTERC*                    Z-ADDVFHTDT    VDLDAT
INTERC*                    MOVE *BLANKS   VDBUSE
INTERC*                    MOVEL'*AUTO*'  VDBUSE
INTERC*                    MOVE VFHAVD    VDAVD
INTERC*                    MOVE VFHOPD    VDOPD
INTERC*                    MOVE VFVFBN    VDFBNR
INTERC*                    WRITEVALDAUTR
INTERC*                    END
INTERC*          VFBKEY    READEVAFORDV2                 34
INTERC*                    END
INTERC*                    END
INTERC*          HEADFK    READEVAFORDH3                 33
INTERC*                    END
INTER *
INTERC*                    ENDSR
INTER *INTERSPED*SLUTT
      *
      ******************************************
     C     GENIN         BEGSR
      ***********************************************
      *
      * GENERER INNLANDSOPPDRAG
      *
      * HVIS AVDELING = 0 , TILDEL AVDNR. IFØLGE POSTNR. TABELL
     C     UAVDV         IFEQ      *ZEROS
     C     KODPI1        SETLL     KODTPI1
     C                   READ      KODTPI1                                33
     C  N33XPOSTN        IFGE      PIPNRF
     C     XPOSTN        ANDLE     PIPNRT
     C                   MOVE      PIAVD         UAVDV
     C                   ENDIF                                                  <XPOSTN
     C                   ENDIF                                                  <UAVDV
      * HVIS AVDELING FORTSATT = 0 , SETT AVDNR. TIL 9600
     C     UAVDV         IFEQ      *ZEROS
     C                   MOVE      9600          UAVDV
     C                   ENDIF                                                  <UAVDV
      * TILDEL NYTT OPPDRAGSNUMMER FRA INNLANDSAVDELING
     C     UAVDV         CHAIN     TELL                               33
     C     *IN33         IFEQ      *OFF
     C                   MOVE      TEOPDN        HEOPD
     C                   MOVE      *BLANKS       HEST
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   ENDIF                                                  <*IN33
     C                   MOVE      UAVDV         HEAVD
      *
      *  HENT BÆRER FRA AVDELINGSOPPLYSNINGER
      *
     C     KODTAK        CHAIN     KODTA                              30
     C     *IN30         IFEQ      *OFF
     C                   MOVE      KOABÆR        HESTD
     C                   ELSE
     C                   MOVE      *ZEROS        HESTD
     C                   ENDIF                                                  <*IN30
      *
      * SETTER HEUR TIL B FOR Å BRUKE EXPORTPROGRAMMETS TURPLANLEGGING
     C                   MOVE      'B'           HEUR
     C* VERDI SOM FORTELLER AT DETTTE ER ET DISTR.OPPD
     C                   MOVE      'DI'          TRSLAG
     C                   MOVE      *ZEROS        HEPRO
     C                   MOVE      *ZEROS        HEPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   MOVE      'IN'          HEOT
     C                   MOVE      *BLANKS       HE01
     C                   MOVE      *BLANKS       HEPK1
     C                   MOVE      *BLANKS       HEPK2
     C                   MOVE      *BLANKS       HEPK3
     C                   MOVE      *BLANKS       HEPK4
     C                   MOVE      *BLANKS       HEPK5
     C                   MOVE      *BLANKS       HEPK6
     C                   MOVE      *BLANKS       HEPK7
     C                   MOVE      *BLANKS       HEPK8
     C                   MOVE      *BLANKS       HEPK9
     C                   MOVE      *BLANKS       HEKF
     C                   MOVE      *BLANKS       HEKFT1
     C                   MOVE      *BLANKS       HEFT1
     C                   MOVE      'NO'          HELKK
     C     KOAPOS        IFEQ      'J'
      * FRASTED
     C                   MOVE      'NO'          HELKS
     C                   MOVE      *BLANKS       HESDFF
     C                   MOVEL     '0583'        HESDFF
     C     STED1K        CHAIN     STED2D                             95
     C  N95              MOVE      ST2KO2        HESDF
      * TILSTED
     C                   MOVE      'NO'          HELKK
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVEL     XPOSTN        HESDVT
     C     STED2K        CHAIN     STED2D                             95
     C  N95              MOVE      ST2KO2        HESDT
     C                   MOVE      'NO'          HELKA
     C                   ENDIF                                                  <KOAPOS
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVEL     XPOSTN        HESDVT
      *
     C     UKDPL         IFNE      *BLANKS
     C                   MOVE      UKDPL         HEKDPL
     C                   ENDIF                                                  <W3KDPL
      * EN KOLLI UNDER 20 KG
     C     HENT          IFEQ      1
     C     HEFBV         ANDLE     20
     C                   MOVE      '1'           HEKDPL
     C                   ENDIF                                                  <HENT
      *
     C                   WRITE     HEADFR
      * OPPDATER FRI SØKEVEIER
     C                   MOVE      UAVD          FSAVD
     C                   MOVE      UOPD          FSOPD
     C                   MOVE      'GIN'         FSKODE
     C                   MOVE      *BLANKS       DSSOK
     C                   MOVE      HEAVD         DSAVD
     C                   MOVE      HEOPD         DSOPD
     C                   MOVE      DSSOK         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C  N33              MOVE      KFSODK        FSDOKK
     C   33              MOVE      *BLANKS       FSDOKK
     C                   WRITE     FRISOKR
     C                   MOVE      HEAVD         FSAVD
     C                   MOVE      HEOPD         FSOPD
     C                   MOVE      'GAV'         FSKODE
     C                   MOVE      UAVD          DSAVD
     C                   MOVE      UOPD          DSOPD
     C                   MOVE      DSSOK         FSSOK
     C                   MOVE      HEDTOP        FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C  N33              MOVE      KFSODK        FSDOKK
     C   33              MOVE      *BLANKS       FSDOKK
     C                   WRITE     FRISOKR
      *
     C                   ENDSR
      *
      ******************************************
     C     GENII         BEGSR
      ***********************************************
      *
      * GENERER INNTEKT PÅ INNLANDSOPPDRAG
     C                   MOVE      HEAVD         FAAVD
     C                   MOVE      HEOPD         FAOPD
     C                   MOVE      'X'           FASK
     C                   MOVE      'INI'         FAVK
     C                   MOVE      'W'           FAOPKO
     C                   MOVE      UCURR         FAVAL
     C                   MOVE      'N'           FAKDM
     C                   MOVE      'M'           FAKDA
     C                   Z-ADD     XKUNR         FAKUNR
     C                   MOVE      *ZEROS        XKUNR
      *
      *  FINNER LINJENUMMER FOR FAKTURAFIL
      *
     C                   MOVE      FAAVD         XGAVD             4 0
     C                   MOVE      FAOPD         XGOPD             7 0
     C     *LIKE         DEFINE    FALI          XGLI
     C                   MOVE      *ZEROS        XGLI
     C                   CALL      'SYGE06'
     C                   PARM                    XGAVD
     C                   PARM                    XGOPD
     C                   PARM                    XGLI
     C                   MOVE      XGLI          FALI
      *
      *  BEREGNER INNTEKT
      *
     C     *LOVAL        SETLL     FRSTTG
     C                   READ      FRSTTG                                 33
     C  N33TGEK          COMP      *BLANKS                                33
     C                   IF        *IN33
     C                   MOVE      '0101'        FRAII             4 0
     C                   MOVE      XPOSTN        TILII             4 0
     C                   Z-ADD     HELM          IILM              7 3
     C                   Z-ADD     HEM3          IIM3              7 3
INT  C     *LIKE         DEFINE    HEFBV         IIFBV
INT  C* M3 OMREGNET MED 200 KG  ---> TRANSPORTØR 1 = TOLLPOST
INT  C                   Z-ADD     HENT          IINT
INT  C*                    Z-ADD0         NULLTR  80
INT  C                   Z-ADD     9             UFLAGG            1 0
INT  C                   MOVE      'J'           UOVERS
INT  C                   Z-ADD     20            IIKNT
     C                   CALL      'SYFB03'
     C                   PARM                    FRAII
     C                   PARM                    TILII
     C                   PARM                    HEVKT
     C                   PARM                    IILM
     C                   PARM                    IIM3
     C                   PARM                    IIKNT             8 0
     C                   PARM                    INLFRA            9 0
     C                   PARM                    IIFBV
     C                   PARM                    IFLAGG            1 0
INT  C                   PARM                    UOVERS            1
INT  C                   PARM                    IIKUND            8 0
INT  C                   PARM                    IINT              7 0
INT  C                   PARM                    UTGSON            3
INT  C                   PARM                    UBL2              9 0
INT  C                   PARM                    URAB              3 1
INT  C                   PARM                    IIAVD             4 0
INT  C                   PARM                    IIOPD             7 0
INT  C                   PARM                    IIFBN             3 0
      *
     C                   Z-ADD     INLFRA        FABELN
     C                   Z-ADD     INLFRA        FABELV
     C                   ELSE
     C                   EXSR      TGIHTTP
     C                   END
     C                   Z-ADD     10248         FAKUNR
      *
      *  SKRIVER FAKTURALINJE
      *
     C                   WRITE     FAKTR
     C                   ENDSR
      *
      ***********************************************
     C     TGIHTTP       BEGSR
      ***********************************************
     C                   MOVE      'N'           UOVERS
     C                   MOVE      '0101'        U2PNF             4
     C                   MOVE      XPOSTN        U2PNT             4
     C                   MOVE      HENT          U2NT              7
     C                   MOVE      HEVKT         U2VKT             9
     C                   MOVE      HEM3          U2DM3             7
     C                   MOVE      *ZEROS        U2KNT             8
     C                   MOVE      *ZEROS        U2RAB             3
     C                   MOVE      '0'           U2FLAGG           1
     C                   MOVE      HEAVD         U2AVD             4
     C                   MOVE      HEOPD         U2OPD             7
INT  C*                  MOVE      IIAVD         U2AVD             4
INT  C*                  MOVE      IIOPD         U2OPD             7
INT  C                   MOVE      *ZEROS        U2KN              8
     C                   CALL      'SYFB05C'
     C                   PARM                    U2PNF
     C                   PARM                    U2PNT
     C                   PARM                    U2NT
     C                   PARM                    U2VKT
     C                   PARM                    U2DM3
     C                   PARM                    U2KNT
     C                   PARM                    U2BRTBL           9
     C                   PARM                    U2NETBL           9
     C                   PARM                    U2RAB
     C                   PARM                    U2FLAGG
     C                   PARM                    U2AVD
     C                   PARM                    U2OPD
     C                   PARM                    U2KN
     C                   IF        U2FLAGG = '0'
     C                   MOVE      U2BRTBL       U2BRTBL2          9 0
     C                   Z-ADD     U2BRTBL2      FABELN
     C                   Z-ADD     U2BRTBL2      FABELV
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UAVDV             4 0
     C                   PARM      HEOPD         UOPDV             7 0
     C                   PARM                    UIN10             1
     C                   PARM                    UKDPL             1
     C                   PARM                    UCURR             3
     C                   PARM                    UFBNR             3 0
      *
     C     KODPI1        KLIST
     C                   KFLD                    PIUNI
     C                   KFLD                    XPOSTN
     C                   MOVE      'PI '         PIUNI
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'A'           KOAUNI
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     DOKUFK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    UFBNR
     C                   MOVE      'F'           DFRI
     C     HDF2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     STED1K        KLIST
     C                   KFLD                    HELKS
     C                   KFLD                    HESDFF
     C     STED2K        KLIST
     C                   KFLD                    HELKK
     C                   KFLD                    HESDVT
      *
     C                   MOVE      *BLANKS       DSSOK
      *
INTER *INTERSPED*START
INTER * NØKKEL I DETALJ. FORDELINGSFIL.
INTERC*          VFBKEY    KLIST
INTERC*                    KFLD           VFVMN
INTERC*                    KFLD           VFVFBN
INTER * NØKLER I HODE LAGERFIL
INTERC*          LKEY1     KLIST
INTERC*                    KFLD           VAGRUP
INTERC*                    KFLD           VAKJED
INTERC*                    KFLD           VAMN
INTERC*          LKEY1E    KLIST
INTERC*                    KFLD           VAGRUP
INTERC*                    KFLD           VAKJED
INTERC*                    Z-ADD21800     VAGRUP
INTER *INTERSPED*SLUTT
      *
     C                   ENDSR
      *
