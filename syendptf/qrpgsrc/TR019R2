     FEDIM7     IF   E           K DISK    RENAME(EDIMR:EDIMR7)
     FFRISOK    IF   E           K DISK
     FFRISOL01  IF   E           K DISK    RENAME(FRISOKR:FRISOK9)
     FSAEH      IF   E           K DISK
     FSAEH1     IF   E           K DISK    RENAME(SAEHR:SAEH1R)
     FSAEH1B    IF   E           K DISK    RENAME(SAEHR:SAEH1BR)
     FSAEH2     IF   E           K DISK    RENAME(SAEHR:SAEH2R)
     FSAEH2B    IF   E           K DISK    RENAME(SAEHR:SAEH2BR)
     FSAEH3     IF   E           K DISK    RENAME(SAEHR:SAEH3R)
     FSAEH3B    IF   E           K DISK    RENAME(SAEHR:SAEH3BR)
     FSAEH4     IF   E           K DISK    RENAME(SAEHR:SAEH4R)
     FSAEH4B    IF   E           K DISK    RENAME(SAEHR:SAEH4BR)
     FSAEH5     IF   E           K DISK    RENAME(SAEHR:SAEH5R)
     FSAEH5B    IF   E           K DISK    RENAME(SAEHR:SAEH5BR)
     FSAEH12    IF   E           K DISK    RENAME(SAEHR:SAEH12R)
     FSAEH12B   IF   E           K DISK    RENAME(SAEHR:SAEH12BR)
     FSAEH6     IF   E           K DISK    RENAME(SAEHR:SAEH6R)
     FSAEH6B    IF   E           K DISK    RENAME(SAEHR:SAEH6BR)
     FSAEH10    IF   E           K DISK    RENAME(SAEHR:SAEH10R)
     FSAEH9     IF   E           K DISK    RENAME(SAEHR:SAEH9R)
     FSAEH13    IF   E           K DISK    RENAME(SAEHR:SAEH13R)
     FSAEH13B   IF   E           K DISK    RENAME(SAEHR:SAEH13BR)
     FSAEH17    IF   E           K DISK    RENAME(SAEHR:SAEH17R)
     FSAEH17B   IF   E           K DISK    RENAME(SAEHR:SAEH17BR)
     FSAEFNJL1  IF   E           K DISK    RENAME(SAEHR:SAEHRJ1)
     F                                     RENAME(SADFR:SAEFRJ1)
     FSAEFNJL2  IF   E           K DISK    RENAME(SAEHR:SAEHRJ2)
     F                                     RENAME(SADFR:SAEFRJ2)
     FSAEVCNL1  IF   E           K DISK    PREFIX(CN_)
     FSAEVCNL2  IF   E           K DISK    RENAME(SAEVCNR:SAEVCNR2)
     F                                     PREFIX(CN_)
     FSTANDE    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FTR019F    UF A E           K DISK
     FTR019D2   CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XUL≈≈                 11     14  0
     D                 DS
     D  UL≈≈                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  XDTDD                  1      2  0
     D  XDTMM                  3      4  0
     D  XDT≈≈                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDT≈≈2                 1      4  0
     D  XDTMM2                 5      6  0
     D  XDTDD2                 7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTS≈                  5      6  0
     D  WSDTS                  1      6  0
     D                 DS
     D  XDTS≈2                 1      4  0
     D  XDTSM2                 5      6  0
     D  XDTSD2                 7      8  0
     D  XDTS                   1      8  0
     D                 DS
     D  XDTKD                  1      2  0
     D  XDTKM                  3      4  0
     D  XDTK≈                  5      6  0
     D  WSDTK                  1      6  0
     D                 DS
     D  XDTK≈2                 1      4  0
     D  XDTKM2                 5      6  0
     D  XDTKD2                 7      8  0
     D  XDTK                   1      8  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTT≈                  5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  XDTT≈2                 1      4  0
     D  XDTTM2                 5      6  0
     D  XDTTD2                 7      8  0
     D  XDTT                   1      8  0
     D                 DS
     D  XDTRD                  1      2  0
     D  XDTRM                  3      4  0
     D  XDTR≈                  5      6  0
     D  WSDTRG                 1      6  0
     D                 DS
     D  XDTR≈2                 1      4  0
     D  XDTRM2                 5      6  0
     D  XDTRD2                 7      8  0
     D  XDTRG                  1      8  0
     D                 DS
     D  XSSD                   1      2  0
     D  XSSM                   3      4  0
     D  XSS≈                   5      6  0
     D  WSSEKD                 1      6  0
     D                 DS
     D  XSS≈2                  1      4  0
     D  XSSM2                  5      6  0
     D  XSSD2                  7      8  0
     D  XSEKDT                 1      8  0
     D                 DS
     D  SEDT≈                  1      4  0
     D  SEDTM                  5      6  0
     D  SEDTD                  7      8  0
     D  SEDT                   1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDT≈2                 5      6  0
     D  WSDT2                  1      6  0
     D                 DS
     D  SEVKB                  1     11  0
     D  SEVKB09                3     11  0
     D  WSVKB                  6     11  0
     D                 DS
     D  WSGN15                 1     15
     D  WSAAR                  1      4
     D  WSGN                   5     15
     D                 DS
     D  SENAK                  1     30
     D  WSNAK                  1     26
     D                 DS
     D                 DS
     D  WSDTD3                 1      2  0
     D  WSDTM3                 3      4  0
     D  WSDTA3                 5      6  0
     D  WSDT3                  1      6  0
     D                 DS
     D  SEAVD                  1      4  0
     D  SFAVD                  1      4  0
     D  SVAVD                  1      4  0
     D                 DS
     D  SETDN                  1      7  0
     D  SFOPDN                 1      7  0
     D  SVTDN                  1      7  0
     D                 DS
     D  SEFIF                  1     17
     D  SFTXT                  1     17
     D                 DS
     D  SEFID                  1      8  0
     D  SFDT                   1      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     C                   EXSR      INIT
     C                   GOTO      START
     C     START0        TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
     C   03              GOTO      SLUTT
     C                   IF        *IN04
     C                   EXSR      SÿKKUN
     C                   GOTO      START0
     C                   ENDIF
     C                   EXSR      TESTB1
     C   30              GOTO      START0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   EXSR      SETKEY
     C     START1        TAG
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END

     C     START2        TAG

     C  N94              DO
     C                   DO        19
     C                   EVAL      WSDT3   = 0
      * HVIS ekstern referanse isteden for mottakernavn
     C     FRIKEY        CHAIN     FRISOK                             39
     C     *IN39         IFEQ      *OFF
     C  N34
     CANN35              EVAL      WSNAK = FSSOK
     C                   ENDIF
     C                   ADD       1             ZRECNO
     C                   move      setll         xsetll
     C   38              moveL     M0068A        xsetll
     C                   move      setle         xsetle
     C   38              move      M0068B        xsetle
      * Sjekk om denne skal overf¯res
     C                   EVAL      WOVERFOR=*BLANKS
     C                   EVAL      *IN36=*OFF
     C     TR019FKEY     CHAIN     TR019F
     C                   IF        %FOUND(TR019F)
     C                   EVAL      WOVERFOR='X'
     C                   EVAL      *IN36=*ON
     C                   ENDIF
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECN2            5 0
     C     WSAAVD        IFEQ      0
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
     C  N94              MOVE      SEAVD         XAVDFF            4 0
     C  N94              MOVE      SETDN         XTDNFF            7 0
     C  N94              END
     C                   END
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
      * AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   07              EXSR      OVERFOR2
     C   07              GOTO      SLUTT
     C   08              EXSR      SETCUR
     C   08              GOTO      START0

      * BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END


     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C*                  GOTO      START3
     C                   GOTO      START

     C     SLUTT         TAG
     C     WSAAVD        IFNE      0
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C     WSSG          IFNE      *BLANKS
     C                   MOVE      WSSG          USG
     C                   END
     C                   EVAL      *INLR=*ON
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C                   SELECT
     C     WSNR          WHENEQ    1
     C                   MOVE      '1'           *IN99
     C                   EXSR      OVERFOR
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPSAD
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      OVERFOR3
     C                   ENDSL
     C                   END                                                     2<-E
     C                   END                                                    1<-E

     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99

     C                   ENDSR
     C***********************************************
     C     SÿKKUN        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR

     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     42
     C                   MOVE      *BLANKS       UKNAVN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNK
     C                   PARM                    FIFIRM
     C                   PARM                    UKNAVN
     C                   Z-ADD     55            POSNBR
     C                   END

     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     42
     C                   MOVE      *BLANKS       UKNAVN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    UKNAVN
     C                   Z-ADD     55            POSNBR
     C                   END

     C                   ENDSR
      ***********************************************
     C     SETCUR        BEGSR
      ***********************************************
     C                   Z-ADD     35            POSNBR
     C                   SELECT
     C                   WHEN      WFSSOK <> *BLANKS
     C                   Z-ADD     8             LINNBR
     C                   WHEN      WSDT   <> 0
     C                   Z-ADD     9             LINNBR
     C                   WHEN      WSTDN  <> 0
     C                   Z-ADD     10            LINNBR
     C                   WHEN      WSKNK  <> 0
     C                   Z-ADD     11            LINNBR
     C                   WHEN      WSKNS  <> 0
     C                   Z-ADD     12            LINNBR
     C                   WHEN      WSSG   <> *BLANKS
     C                   Z-ADD     13            LINNBR
     C                   WHEN      WSTLL  <> *BLANKS
     C                   Z-ADD     14            LINNBR
     C                   WHEN      WSGN   <> *BLANKS
     C                   Z-ADD     16            LINNBR
     C                   WHEN      WSST   <> *BLANKS
     C                   Z-ADD     17            LINNBR
     C                   WHEN      WSMI   <> *BLANKS
     C                   Z-ADD     18            LINNBR
     C                   OTHER
     C                   Z-ADD     8             LINNBR
     C                   ENDSL

     C                   ENDSR
     C***********************************************
     C     DSPSAD        BEGSR
     C***********************************************
     C                   CALL      'SAD023A'
     C                   PARM      SEAVD         U_AVD             4 0
     C                   PARM      SETDN         U_TDN             7 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              MOVE      XIN50         *IN50
     C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL
     C                   ENDSR
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KOANVN
     C     WSAAVD        IFNE      0
     C     WSTDN         ORNE      0
     C     WSAAVD        CHAIN     STANDE                             99
     C  N99KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB1
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C                   MOVEA     '000000000000'*IN(38)
     C                   MOVEA     '0'           *IN(37)
     C                   MOVEA     '0'           *IN(51)
     C                   MOVEA     '00'          *IN(34)

     C                   MOVE      WSTLE         WSTLEA            6
     C     WFSSOK        comp      *BLANKS                            4040
     C   40              EVAL      WFSSOKMAX = %TRIM(WFSSOK)
     C                             + '9999999999999999999999999999999999'
     C   40              GOTO      STTB1
     C     WSDT          COMP      *ZEROS                             4141
     C   41              GOTO      STTB1
     C     WSTDN         COMP      *ZEROS                             4242
     C   42              GOTO      STTB1
     C     WSKNK         COMP      *ZEROS                             4343
     C   43              GOTO      STTB1
     C     WSKNS         COMP      *ZEROS                             4444
     C   44              GOTO      STTB1
     C     WSSG          COMP      *BLANKS                            4545
     C   45              GOTO      STTB1
     C     WSTLL         COMP      *BLANKS                            4646
     C   46              GOTO      STTB1
     C     WSGN          COMP      *BLANKS                            4747
     C   47              GOTO      STTB1
     C     WSST          COMP      *BLANKS                            4949
     C   49              GOTO      STTB1
     C     WSMI          COMP      *BLANKS                            4848
     C   48              GOTO      STTB1
     C     WSSEKV        COMP      0                                  38
     C   38WSSEKD        COMP      0                                  38
     C   38              GOTO      STTB1
     C     WSRG          COMP      *BLANKS                            3737
     C   37              eval      koanvn='Foretaksnr:'
     C   37koanvn        cat       wsrg:1        koanvn
     C   37              GOTO      STTB1
     C     WSFN          COMP      *BLANKS                            3535
     C   35              GOTO      STTB1
     C     WSMRK         COMP      *BLANKS                            3434
     C   34              GOTO      STTB1

     C                   MOVE      'DIV0064'     MSGNR
     C                   SETON                                        3098
     C                   GOTO      SLTB1

     C     STTB1         TAG
     C   43              MOVE      WSKNK         KUNDNR
     C   43KUNDK         CHAIN     CUNDL01                            97
     C   97              MOVE      'SPK0035'     MSGNR
     C   44              MOVE      WSKNS         KUNDNR
     C   44KUNDK         CHAIN     CUNDL01                            96
     C   96
     CANN97              MOVE      'SPK0035'     MSGNR
     C   97
     COR 96              SETON                                        30

     C     SLTB1         ENDSR
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C   41              DO
     C     WSDT          IFEQ      0
     C                   MOVE      *ZEROS        XDT
     C                   ELSE
     C                   MOVE      XDTDD         XDTDD2
     C                   MOVE      XDTMM         XDTMM2
     C     XDT≈≈         IFGT      50
     C     XDT≈≈         ADD       1900          XDT≈≈2
     C                   ELSE
     C     XDT≈≈         ADD       2000          XDT≈≈2
     C                   END
     C                   END
     C                   END
     C   43              DO
     C                   SELECT
     C     WSDTK         WHENEQ    0
     C                   MOVE      *ZEROS        XDTK
     C                   OTHER
     C                   MOVE      XDTKD         XDTKD2
     C                   MOVE      XDTKM         XDTKM2
     C     XDTK≈         IFGT      50
     C     XDTK≈         ADD       1900          XDTK≈2
     C                   ELSE
     C     XDTK≈         ADD       2000          XDTK≈2
     C                   END
     C                   ENDSL
     C                   END
     C   44              DO
     C     WSDTS         IFEQ      0
     C                   MOVE      *ZEROS        XDTS
     C                   ELSE
     C                   MOVE      XDTSD         XDTSD2
     C                   MOVE      XDTSM         XDTSM2
     C     XDTS≈         IFGT      50
     C     XDTS≈         ADD       1900          XDTS≈2
     C                   ELSE
     C     XDTS≈         ADD       2000          XDTS≈2
     C                   END
     C                   END
     C                   END
     C   45              DO
     C     WSDTT         IFEQ      0
     C                   MOVE      *ZEROS        XDTT
     C                   ELSE
     C     WSDTT         IFEQ      999999
     C                   MOVE      99999999      XDTT
     C                   ELSE
     C                   MOVE      XDTTD         XDTTD2
     C                   MOVE      XDTTM         XDTTM2
     C     XDTT≈         IFGT      50
     C     XDTT≈         ADD       1900          XDTT≈2
     C                   ELSE
     C     XDTT≈         ADD       2000          XDTT≈2
     C                   END
     C                   END
     C                   END
     C                   END
     C   38              DO
     C     WSSEKD        IFEQ      0
     C                   MOVE      *ZEROS        XSEKDT
     C                   ELSE
     C                   MOVE      XSSD          XSSD2
     C                   MOVE      XSSM          XSSM2
     C     XSS≈          IFGT      50
     C     XSS≈          ADD       1900          XSS≈2
     C                   ELSE
     C     XSS≈          ADD       2000          XSS≈2
     C                   END
     C                   END
     C                   END
     C   37              DO
     C     WSDTRG        IFEQ      0
     C                   MOVE      *ZEROS        XDTRG
     C                   ELSE
     C                   MOVE      XDTRD         XDTRD2
     C                   MOVE      XDTRM         XDTRM2
     C     XDTR≈         IFGT      50
     C     XDTR≈         ADD       1900          XDTR≈2
     C                   ELSE
     C     XDTR≈         ADD       2000          XDTR≈2
     C                   END
     C                   END
     C                   END

     C     WSAAVD        IFEQ      0
     C                   EXSR      MINSAL
     C                   ELSE
     C                   EXSR      MINSAE
     C                   END

     C                   ENDSR
     C***********************************************
     C     MINSAE        BEGSR
     C***********************************************
      * SET KEY N≈R SÿK KUN I EN !!!!  AVDELING
     C   38edim7k        SETLL     edim7
     C   40FR1KEY        SETLL     FRISOL01
     C   41SAEH1K        SETLL     SAEH1
     C   42SAEHK         SETLL     SAEH
     C   43SAEH2K        SETLL     SAEH2
     C   44SAEH3K        SETLL     SAEH3
     C   45WSDTT         IFEQ      999999
     C     SAEH4K        SETGT     SAEH4
     C                   ELSE
     C     SAEH4K        SETLL     SAEH4
     C                   END
     C   46              IF        WSTLEA = *ZEROS
     C   46SAEH5K        SETLL     SAEH5
     C                   ELSE
     C     SAEH12K       SETLL     SAEH12
     C                   END
     C   47SAEH6K        SETLL     SAEH6
     C   48SAEH7K        SETLL     SAEH17
     C   49SAEH0K        SETLL     SAEH10
     C   37SAEH13K       SETLL     SAEH13
     C   35SAEFNJL1K     SETLL     SAEFNJL1
     C   34SAEVCNL1K     SETLL     SAEVCNL1
     C   34              EVAL      SETDN = 0
     C   34              MOVE      *BLANKS       X_MRK            17

     C                   ENDSR
     C***********************************************
     C     MINSAL        BEGSR
     C***********************************************
      * SET KEY N≈R SÿK I ALLE !!  AVDELINGER
     C   38edim7k        SETLL     edim7
     C   40FR1KEY        SETLL     FRISOL01
     C   41SAEA1K        SETLL     SAEH1B
     C   43SAEA2K        SETLL     SAEH2B
     C   44SAEA3K        SETLL     SAEH3B
     C   45WSDTT         IFEQ      999999
     C     SAEA4K        SETGT     SAEH4B
     C                   ELSE
     C     SAEA4K        SETLL     SAEH4B
     C                   END
     C   46              IF        WSTLEA = *ZEROS
     C   46WSTLL         SETLL     SAEH5B
     C                   ELSE
     C     SAEH12BK      SETLL     SAEH12B
     C                   END
     C   47WSGN15        SETLL     SAEH6B
     C   48SAEA7K        SETLL     SAEH17B
     C   49SAEA0K        SETLL     SAEH9
     C   37SAEH13BK      SETLL     SAEH13B
     C   35WSFN          SETLL     SAEFNJL2
     C   34WSMRK         SETLL     SAEVCNL2
     C   34              EVAL      SEAVD = 0
     C   34              EVAL      SETDN = 0
     C   34              EVAL      X_MRK = *BLANKS

     C                   ENDSR
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
      * LES REC N≈R SÿK KUN I EN !!!!  AVDELING
     C     STLREC        TAG
      * sekvens i EDIM
     C     *IN38         IFEQ      '1'
     C     LESNYSE1      TAG
     C                   SETOFF                                       33
     C                   READ      EDIM7                                  94
     C  N94SADEDIM       CHAIN     SAEH                               33
     C   33              GOTO      LESNYSE1
     C  N94WSAAVD        CABNE     MAVD          LESNYSE1
     C     EDIM7K2       SETGT     EDIM7
     C                   END
     C     *IN40         IFEQ      '1'
     C     LESNYFRI      TAG
     C                   SETOFF                                       33
     C     FR1KEYE       READE     FRISOL01                               94
     C  N94WFSSOKMAX     COMP      FSSOK                                94
     C  N94SADHFRI       CHAIN     SAEH                               33
     C   33              GOTO      LESNYFRI
     C                   END
     C   41WSAAVD        READE     SAEH1                                  94
     C   42WSAAVD        READE     SAEH                                   94
     C   43WSAAVD        READE     SAEH2                                  94
     C   43
     CANN94WSKNK         COMP      SEKNK                              9494
     C   44WSAAVD        READE     SAEH3                                  94
     C   44
     CANN94WSKNS         COMP      SEKNS                              9494
     C   45WSDTT         IFEQ      999999
     C     WSAAVD        READPE    SAEH4                                  94
     C  N94WSSG          COMP      SESG                               9494
     C                   ELSE
     C     WSAAVD        READE     SAEH4                                  94
     C  N94WSSG          COMP      SESG                               9494
     C                   END
     C   46              IF        WSTLEA = *ZEROS
     C   46WSAAVD        READE     SAEH5                                  94
     C                   ELSE
     C     SAEH12K2      READE     SAEH12                                 94
     C                   END
     C   47WSAAVD        READE     SAEH6                                  94
     C   48SAEH7K        READE     SAEH17                                 94
     C   49SAEH0K        READE     SAEH10                                 94
     C   37SAEH13KE      READE     SAEH13                                 94
     C   35WSAAVD        READE     SAEFNJL1                               94
     C   35              IF        *IN94 = *OFF
     C                   EVAL      X_FN = SEFIF
     C                   MOVE      SEFID         X_FN             26
     C     SAEHKO        CHAIN     SAEH                               33
     C                   EVAL      WSNAK = X_FN
     C                   END
     C   34WSAAVD        READE     SAEVCNL1                               94
     C   34              DOW       *IN94 = *OFF
     C                   IF        CN_SVTDN <> SETDN OR CN_SVCNR <> X_MRK
     C                   EVAL      SETDN = CN_SVTDN
     C                   EVAL      X_MRK = CN_SVCNR
     C                   LEAVE
     C                   END
     C     WSAAVD        READE     SAEVCNL1                               94
     C                   ENDDO
     C   34              IF        *IN94 = *OFF
     C     SAEHKO        CHAIN     SAEH                               33
     C                   EVAL      WSNAK = X_MRK
     C                   END

     C  N94
     CANN38
     CANN46
     CANN51
     CANN42              IF        SETDN < 0
     C                   GOTO      STLREC
     C                   END

     C  N94              DO
     C  N41
     CANN45
     CANN46
     CANN51
     CANN49SETDN         CABLT     0             STLREC
     C   41
     COR 45
     COR 46
     COR 51
     COR 38
     COR 49              IF        SETDN < 0
     C                   EVAL      SETDN = SETDN * -1
     C     SAEHKO        CHAIN     SAEH                               33
     C                   END
     C                   MOVE      SEDTD         WSDTD2
     C                   MOVE      SEDTM         WSDTM2
     C                   MOVE      SEDT≈         WSDT≈2
     C                   END

     C                   ENDSR
     C***********************************************
     C     LESRAL        BEGSR
     C***********************************************
      * LES REC N≈R SÿK I ALLE !!  AVDELINGER
     C     STLRAL        TAG
      * sekvens i EDIM
     C     *IN38         IFEQ      '1'
     C     LESNYSE2      TAG
     C                   SETOFF                                       33
     C                   READ      EDIM7                                  94
     C  N94SADEDIM       CHAIN     SAEH                               33
     C   33              GOTO      LESNYSE2
     C     EDIM7K2       SETGT     EDIM7
     C                   END
     C     *IN40         IFEQ      '1'
     C     LESNYFR2      TAG
     C                   SETOFF                                       33
     C     FR1KEYE       READE     FRISOL01                               94
     C  N94WFSSOKMAX     COMP      FSSOK                                94
     C  N94SADHFRI       CHAIN     SAEH                               33
     C   33              GOTO      LESNYFR2
     C                   END
     C   41              READ      SAEH1B                                 94
     C   43WSKNK         READE     SAEH2B                                 94
     C   44WSKNS         READE     SAEH3B                                 94
     C   45WSDTT         IFEQ      999999
     C     WSSG          READPE    SAEH4B                                 94
     C                   ELSE
     C     WSSG          READE     SAEH4B                                 94
     C                   END
     C   46              IF        WSTLEA = *ZEROS
     C   46              READ      SAEH5B                                 94
     C                   ELSE
     C     WSTLEA        READE     SAEH12B                                94
     C                   END
     C   47              READ      SAEH6B                                 94
     C   48SAEA7K        READE     SAEH17B                                94
     C   49SAEA0K        READE     SAEH9                                  94
     C   35              READ      SAEFNJL2                               94
     C   37WSRG          READE     SAEH13B                                94
     C   35              IF        *IN94 = *OFF
     C                   EVAL      X_FN = SEFIF
     C                   MOVE      SEFID         X_FN             26
     C     SAEHKO        CHAIN     SAEH                               33
     C                   EVAL      WSNAK = X_FN
     C                   END
     C   34              READ      SAEVCNL2                               94
     C   34              DOW       *IN94 = *OFF
     C                   IF        SVAVD <> SEAVD OR SVTDN <> SETDN
     C                             OR CN_SVCNR <> X_MRK
     C                   EVAL      SETDN = CN_SVTDN
     C                   EVAL      X_MRK = CN_SVCNR
     C                   LEAVE
     C                   END
     C                   READ      SAEVCNL2                               94
     C                   ENDDO
     C   34              IF        *IN94 = *OFF

     C     SAEHKO        CHAIN     SAEH                               33
     C                   EVAL      WSNAK = X_MRK
     C                   END
     C  N94              DO
     C  N46
     CanN38
     CANN51SETDN         CABLT     0             STLRAL
     C   46
     Cor 38
     COR 51              IF        SETDN < 0
     C                   EVAL      SETDN = SETDN * -1
     C     SAEHKO        CHAIN     SAEH                               33
     C                   END
     C                   MOVE      SEDTD         WSDTD2
     C                   MOVE      SEDTM         WSDTM2
     C                   MOVE      SEDT≈         WSDT≈2
     C                   END
     C                   ENDSR

     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *LIKE         DEFINE    SEAVD         UTHAVD
     C     *LIKE         DEFINE    SETDN         UTHTDN
     C     *ENTRY        PLIST
     C                   PARM                    UTHAVD
     C                   PARM                    UTHTDN
     C                   PARM                    ULI2              5 0
     C     EDIM7K        KLIST
     C                   KFLD                    XSEKDT
     C                   KFLD                    WSSEKV
     C     EDIM7K2       KLIST
     C                   KFLD                    M0068A
     C                   KFLD                    M0068B
     C     SADEDIM       KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C     SAEHK         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTDN
     C     SAEHKO        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     SAEH1K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    XDT
     C     SAEH2K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     SAEH3K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     SAEH4K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     SAEH5K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTLL
     C     SAEH6K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSGN15
     C     SAEH7K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSMI
     C     SAEH0K        KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSST
     C     SAEH12K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTLEA
     C                   KFLD                    WSTLL
     C     SAEH12K2      KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTLEA
     C     SAEH12BK      KLIST
     C                   KFLD                    WSTLEA
     C                   KFLD                    WSTLL
     C     SAEH13K       KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSRG
     C                   KFLD                    XDTRG
     C     SAEH13KE      KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSRG
     C     SAEH13BK      KLIST
     C                   KFLD                    WSRG
     C                   KFLD                    XDTRG
     C     SAEFNJL1K     KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSFN
     C     SAEVCNL1K     KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSMRK
     C     KUNDK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    XUNIK
     C                   KFLD                    WSAAVD
     C     SAEA1K        KLIST
     C                   KFLD                    XDT
     C     SAEA2K        KLIST
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     SAEA3K        KLIST
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     SAEA4K        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     SAEA7K        KLIST
     C                   KFLD                    WSMI
     C     SAEA0K        KLIST
     C                   KFLD                    WSST
     C     SADHFRI       KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C     FRIKEY        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    WSKODE
     C     FR1KEY        KLIST
     C                   KFLD                    WSKODE
     C                   KFLD                    WFSSOK
     C     FR1KEYE       KLIST
     C                   KFLD                    WSKODE

     C                   MOVE      'A'           XUNIK             1
     C                   MOVE      *ZEROS        WSSEKD
     C                   MOVE      *BLANKS       WFSSOKMAX        35
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        WSDTK
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        WSDTRG
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      *ZEROS        XDTS
     C                   MOVE      *ZEROS        XDTK
     C                   MOVE      *ZEROS        XDTT
     C                   MOVE      *ZEROS        XDTRG
     C                   MOVE      *ZEROS        SEDT
     C                   MOVE      *ZEROS        WSDT2
     C     *LIKE         DEFINE    FSKODE        WSKODE
     C                   MOVEL     '*CE'         WSKODE

     C                   MOVE      UAVD          WSAAVD
     C     KODTAK        CHAIN     KODTA                              30
     C                   MOVE      USG           WSSG
     C                   MOVE      '999999'      WSDTT
     C                   SETON                                        45

     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           WSAAR
      * T¯m workfile
     C     USG           SETLL     TR019F
     C     USG           READE     TR019F                                 30
     C     *IN30         DOWEQ     *OFF
     C                   DELETE    TR019FR
     C     USG           READE     TR019F                                 30
     C                   ENDDO
     C                   EVAL      *IN30=*OFF

     C                   ENDSR
     C***********************************************
     C     OVERFOR       BEGSR
     C***********************************************
     C     TR019FKEY     KLIST
     C                   KFLD                    USG
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN

     C     TR019FKEY     CHAIN     TR019F                             30
     C                   IF        *IN30
     C                   EVAL      TRSESG=USG
     C                   EVAL      TRSEAVD=SEAVD
     C                   EVAL      TRSETDN=SETDN
     C                   EVAL      WOVERFOR='X'
     C                   EVAL      *IN36=*ON
     C                   WRITE     TR019FR
     C                   ENDIF
     C                   EVAL      *IN30=*OFF

     C  N90              MOVE      *ZEROS        WSNR
     C  N90              MOVE      XIN50         *IN50
     C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL

     C                   ENDSR
     C***********************************************
     C     OVERFOR2      BEGSR
     C***********************************************
     C     USG           SETLL     TR019F
     C     USG           READE     TR019F                                 30
     C     *IN30         DOWEQ     *OFF
     C                   CALL      'TR019R3'
     C                   PARM                    UTHAVD
     C                   PARM                    UTHTDN
     C                   PARM                    TRSEAVD
     C                   PARM                    TRSETDN
     C                   PARM                    ULI2
     C                   DELETE    TR019FR
     C     USG           READE     TR019F                                 30
     C                   ENDDO
     C                   ENDSR
     C***********************************************
     C     OVERFOR3      BEGSR
     C***********************************************
     C     TR019FKEY     CHAIN     TR019F                             30
     C                   IF        *IN30=*OFF
     C                   EVAL      WOVERFOR=' '
     C                   EVAL      *IN36=*OFF
     C                   DELETE    TR019FR
     C                   ENDIF
     C                   EVAL      *IN30=*OFF

     C  N90              MOVE      *ZEROS        WSNR
     C  N90              MOVE      XIN50         *IN50
     C  N90              MOVE      XIN36         *IN36
     C  N90              UPDATE    SUBFIL

     C                   ENDSR
