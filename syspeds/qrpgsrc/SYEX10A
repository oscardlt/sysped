      *
     FDOKEB     UF A E           K DISK
     FHEADF     IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYEX10FA  CF   E             WORKSTN
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   SETOFF                                       27
     C   01              Z-ADD     1             UFLAGG
     C   01              GOTO      SLUTT
     C   02              Z-ADD     2             UFLAGG
     C   02              GOTO      SLUTT
     C   03
     CAN 29              Z-ADD     3             UFLAGG
     C   03
     CAN 29              GOTO      SLUTT
     C   06
     CAN 29              GOTO      SLUTT
     C   12
     CAN 29              Z-ADD     9             UFLAGG
     C   12
     CANN29              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
     C   04              EXSR      SØKKUN
      *
     C                   EXSR      TESTB
     C  N03
     CANN05
     CANN16              GOTO      START
      *
     C                   EXSR      OPDDOK
     C   03              Z-ADD     3             UFLAGG
     C   05              Z-ADD     5             UFLAGG
     C   16              Z-ADD     6             UFLAGG
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      ******************************************
     C     TESTB         BEGSR
      ******************************************
     C* TEST MOTTAGER
     C     WSKNM         IFNE      0
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              DO
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSADM1
     C                   MOVE      ADR2          WSADM2
     C                   MOVE      *BLANKS       WSADM3
     C     POSTNR        IFEQ      0
     C     sypoge        ifne      *blanks
     C                   move      *blanks       wsadm3
     C     wsadm3        CAT       sypoge:0      WSadm3
     C     wsadm3        cat       adr3:1        wsadm3
     c                   else
     C                   MOVEL     ADR3          WSADM3
     c                   end
     C                   ELSE
     C                   MOVEL     POSTNR        WSADM3
     C                   MOVE      ADR3          WSADM3
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     MOVHFW        BEGSR
      ***********************************************
     C                   MOVE      HEKNK         WSKNM
     C     KUND1K        CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      *OFF
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSADM1
     C                   MOVE      ADR2          WSADM2
     C                   MOVE      *BLANKS       WSADM3
     C     POSTNR        IFEQ      0
     C     sypoge        ifne      *blanks
     C                   move      *blanks       wsadm3
     C     wsadm3        CAT       sypoge:0      WSadm3
     C     wsadm3        cat       adr3:1        wsadm3
     c                   else
     C                   MOVEL     ADR3          WSADM3
     c                   end
     C                   ELSE
     C                   MOVEL     POSTNR        WSADM3
     C                   MOVE      ADR3          WSADM3
     C                   END
     C                   ELSE
     C                   MOVEL     HENAK         WSNAM
     C                   MOVEL     HEADK1        WSADM1
     C                   MOVEL     HEADK2        WSADM2
     C                   MOVEL     HEADK3        WSADM3
     C                   ENDIF
     C     HESDF         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSSDLA
     C     HESDT         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSSDLO
     C                   MOVE      HEGM1         WSGM1
     C                   MOVE      HENT          WSNT1
     C                   MOVE      HEVS1         WSVS1
     C                   Z-ADD     HEVKT         WSVKT1
     C                   Z-ADD     HEM3          WSM31
     C                   MOVE      HEGM2         WSGM2
     C                   MOVE      HEVS2         WSVS2
     C                   MOVE      'DIV0654'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     15            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XXXTXT          120
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
      *
     C                   MOVEL     XXXTXT        XTRE             15
     C                   MOVE      XTRE          WSABSL
     C                   SETON                                        33
      *
     C                   ENDSR
     C***********************************************
     C     MOVDBW        BEGSR
     C***********************************************
     C                   MOVE      DBKNM         WSKNM
     C                   MOVE      DBNAM         WSNAM
     C                   MOVE      DBADM1        WSADM1
     C                   MOVE      DBADM2        WSADM2
     C                   MOVE      DBADM3        WSADM3
     C                   MOVE      DBFORT        WSFORT
     C                   MOVE      DBSD          WSSD
     C                   MOVE      DBBÅTN        WSBÅTN
     C                   MOVE      DBSDLA        WSSDLA
     C                   MOVE      DBSDLO        WSSDLO
     C                   MOVE      DBSDM         WSSDM
     C                   MOVE      DBGM1         WSGM1
     C                   MOVE      DBNT1         WSNT1
     C                   MOVE      DBVS1         WSVS1
     C                   MOVE      DBVKT1        WSVKT1
     C                   MOVE      DBM31         WSM31
     C                   MOVE      DBGM2         WSGM2
     C                   MOVE      DBNT2         WSNT2
     C                   MOVE      DBVS2         WSVS2
     C                   MOVE      DBVKT2        WSVKT2
     C                   MOVE      DBM32         WSM32
     C                   MOVE      DBGM3         WSGM3
     C                   MOVE      DBNT3         WSNT3
     C                   MOVE      DBVS3         WSVS3
     C                   MOVE      DBVKT3        WSVKT3
     C                   MOVE      DBM33         WSM33
     C                   MOVE      DBGM4         WSGM4
     C                   MOVE      DBNT4         WSNT4
     C                   MOVE      DBVS4         WSVS4
     C                   MOVE      DBVKT4        WSVKT4
     C                   MOVE      DBM34         WSM34
     C                   MOVE      DBGM5         WSGM5
     C                   MOVE      DBNT5         WSNT5
     C                   MOVE      DBVS5         WSVS5
     C                   MOVE      DBVKT5        WSVKT5
     C                   MOVE      DBM35         WSM35
     C                   MOVE      DBGM6         WSGM6
     C                   MOVE      DBNT6         WSNT6
     C                   MOVE      DBVS6         WSVS6
     C                   MOVE      DBVKT6        WSVKT6
     C                   MOVE      DBM36         WSM36
     C                   MOVE      DBGM7         WSGM7
     C                   MOVE      DBNT7         WSNT7
     C                   MOVE      DBVS7         WSVS7
     C                   MOVE      DBVKT7        WSVKT7
     C                   MOVE      DBM37         WSM37
     C                   MOVE      DBGM8         WSGM8
     C                   MOVE      DBNT8         WSNT8
     C                   MOVE      DBVS8         WSVS8
     C                   MOVE      DBVKT8        WSVKT8
     C                   MOVE      DBM38         WSM38
     C                   MOVE      DBKDDP        WSKDDP
     C                   MOVE      DBSDDT        WSSDDT
     C                   MOVE      DBABSL        WSABSL
      *
     C                   ENDSR
     C***********************************************
     C     OPDDOK        BEGSR
      ***********************************************
     C     DOKEBK        CHAIN     DOKEB                              33
      *
     C   33              DO
     C                   MOVE      UAVD          DBAVD
     C                   MOVE      UOPD          DBOPD
     C                   END
      *
     C                   MOVE      ' '           DBST
     C                   MOVE      HESG          DBSG
     C                   MOVE      WSKNM         DBKNM
     C                   MOVE      WSNAM         DBNAM
     C                   MOVE      WSADM1        DBADM1
     C                   MOVE      WSADM2        DBADM2
     C                   MOVE      WSADM3        DBADM3
     C                   MOVE      WSFORT        DBFORT
     C                   MOVE      WSSD          DBSD
     C                   MOVE      WSBÅTN        DBBÅTN
     C                   MOVE      WSSDLA        DBSDLA
     C                   MOVE      WSSDLO        DBSDLO
     C                   MOVE      WSSDM         DBSDM
     C                   MOVE      WSGM1         DBGM1
     C                   MOVE      WSNT1         DBNT1
     C                   MOVE      WSVS1         DBVS1
     C                   MOVE      WSVKT1        DBVKT1
     C                   MOVE      WSM31         DBM31
     C                   MOVE      WSGM2         DBGM2
     C                   MOVE      WSNT2         DBNT2
     C                   MOVE      WSVS2         DBVS2
     C                   MOVE      WSVKT2        DBVKT2
     C                   MOVE      WSM32         DBM32
     C                   MOVE      WSGM3         DBGM3
     C                   MOVE      WSNT3         DBNT3
     C                   MOVE      WSVS3         DBVS3
     C                   MOVE      WSVKT3        DBVKT3
     C                   MOVE      WSM33         DBM33
     C                   MOVE      WSGM4         DBGM4
     C                   MOVE      WSNT4         DBNT4
     C                   MOVE      WSVS4         DBVS4
     C                   MOVE      WSVKT4        DBVKT4
     C                   MOVE      WSM34         DBM34
     C                   MOVE      WSGM5         DBGM5
     C                   MOVE      WSNT5         DBNT5
     C                   MOVE      WSVS5         DBVS5
     C                   MOVE      WSVKT5        DBVKT5
     C                   MOVE      WSM35         DBM35
     C                   MOVE      WSGM6         DBGM6
     C                   MOVE      WSNT6         DBNT6
     C                   MOVE      WSVS6         DBVS6
     C                   MOVE      WSVKT6        DBVKT6
     C                   MOVE      WSM36         DBM36
     C                   MOVE      WSGM7         DBGM7
     C                   MOVE      WSNT7         DBNT7
     C                   MOVE      WSVS7         DBVS7
     C                   MOVE      WSVKT7        DBVKT7
     C                   MOVE      WSM37         DBM37
     C                   MOVE      WSGM8         DBGM8
     C                   MOVE      WSNT8         DBNT8
     C                   MOVE      WSVS8         DBVS8
     C                   MOVE      WSVKT8        DBVKT8
     C                   MOVE      WSM38         DBM38
     C                   MOVE      WSKDDP        DBKDDP
     C                   MOVE      WSSDDT        DBSDDT
     C                   MOVE      WSABSL        DBABSL
      *
     C   33              WRITE     DOKEBR
     C  N33              UPDATE    DOKEBR
      *
     C                   ENDSR
     C***********************************************
     C     SØKKUN        BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNM
     C                   PARM                    UFIRM
     C                   PARM                    USØKKN           30
     C                   SETON                                        27
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     DOKEBK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSKNM
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UMSG             62
     C                   PARM                    UFLAGG            1 0
     C     UMSG          COMP      *BLANKS                            2828
     C     UFLAGG        COMP      9                                      29
     C                   Z-ADD     0             UFLAGG
      *
     C     HEADFK        CHAIN     HEADF                              33
     C  N33DOKEBK        CHAIN     DOKEB                              33
      *
      * IF REQUEST AND NOT FOUND RETURN
      *
     C   33
     CAN 29              SETON                                        LR
     C   33
     CAN 29              RETURN
      *
     C   33              EXSR      MOVHFW
     C  N33              EXSR      MOVDBW
      *
     C                   ENDSR
