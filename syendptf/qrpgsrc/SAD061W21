     H DFTACTGRP(*NO)
     fsadffa1   if   e           k disk
     fsad061fw21cf   e             workstn
     d                 ds
     d xdt                            6  0
     d  xdtd                          2  0 overlay(xdt)
     d  xdtm                          2  0 overlay(xdt:3)
     d  xdta                          2  0 overlay(xdt:5)
     d                 ds
     d wsfdt2                         8  0
     d  wsfdt2a                       2  0 overlay(wsfdt2:3)
     d  wsfdt2m                       2  0 overlay(wsfdt2:5)
     d  wsfdt2d                       2  0 overlay(wsfdt2:7)
     ‚*  Prototype for sad061w21
     d sad061w21       pr
     d uavd_                               like(uavd)
     d utdn_                               like(utdn)
     d urg_                                like(urg)
     d ufn_                                like(ufn)
     d ufn21_                              like(ufn21)
     d udt_                                like(udt)
     d uflagg_                             like(uflagg)
     ‚*  *ENTRY Interface for Main Procedure
     d sad061w21       pi
     d uavd                           4  0
     d utdn                           7  0
     d urg                           11
     d ufn                           17
     d ufn21                          4
     d udt                            6  0
     d uflagg                         1  0

     d xdt2            s              8  0
     d wsdt2           s              6  0


      /free
       uflagg = 0;
       if udt <> 999999;
       write windowsz;

       xdt = udt;
       xdt2 = 20000000 + xdta * 10000 + xdtm * 100 + xdtd - 10000;

       setll (ufn) sadffa1;
       reade (ufn) sadffa1;
       dow not %eof;
           select;
           when sfaftxt = ufn and sfaftxt21 = ufn21 and sfafdt > xdt2;
             if (sfafavd <> uavd or sfafopdn <> utdn);
               wsavd = sfafavd;
               wstdn = sfafopdn;
               wsfdt2 = sfafdt;
               wsfdt = wsfdt2d * 10000 + wsfdt2m * 100 + wsfdt2a;
               wsjn = 'N';
               exfmt bilde01;
               if wsjn = 'N';
                   uflagg = 1;
               endif;
               *inlr = *on;
               return;
             endif;
           endsl;

           reade (ufn) sadffa1;
       enddo;

       endif;

       *inlr = *on;
       return;

      /end-free
