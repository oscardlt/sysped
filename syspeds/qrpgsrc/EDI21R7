      *
     FFRISOK    IF A E           K DISK
     FzRISOK    IF A E           K DISK
     F                                     RENAME(frisokr:zrisokr)
     Fheurfil   IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FPWDINT    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FTELL      UF   E           K DISK
     Fztell     UF   E           K DISK
     FHEADF     IF A E           K DISK
     FZEADF     IF A E           K DISK
     F                                     RENAME(headfR:headfr2)
     FEDIINN    IF   E           k DISK
     FSNDDST    O  A E             DISK
     FFREETXT   o  a e             disk
     FZREETXT   o  a e             disk
     F                                     RENAME(freetxtr:zreetxtr)
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1     80
     D                                     DIM(80)                              Output string
     D  RDATA                  1     80
     D                 DS
     D  idata                  1     70
     D  DATA                   1     30
     D  D                      1     30
     D                                     DIM(30)                              Output string
     D                 DS
     D  NUMVAL                 1     30  0
     D  N                      1     30
     D                                     DIM(30)                              Output string
     D                 DS
     D  bruker1                1     10
     D  bruker2               11     20
     D  bruker3               21     30
     D  bruker4               31     40
     D  bruker5               41     50
     D  br                     1     50
     D                                     DIM(5)                               Output string
     D                 DS
     D  bootxt                 1     80
     D  ordfra                 1     10
     D  henas                 11     40
     d  avd                   42     45
     d  heavd                 47     50  0
     d  ordre                 52     57
     d  heopd                 59     65  0
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
     D                 DS
     D  HEDTR                  1      8  0
     D  UAAR                   1      4  0
     D  UMND                   5      6  0
     D  UDAG                   7      8  0
     D                 DS
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
     D html            C                   CONST('<pre><ul>')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     D YANSW2          C                   CONST('Du har lagt inn følg-
     D                                     ende ordre i vår dat-
     D                                     abase:      ')
     D YANSW3          C                   CONST('====================-
     D                                     ====================-
     D                                     =============')
     D YANSW4          C                   CONST('** Takk for ordren *-
     D                                     ***    Slutt     ***-
     D                                     *************')
     D PANSW1          C                   CONST('**Passord mangler**')
     D PANSW2          C                   CONST('**Passord er feil**')
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
     c                   return
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *************************************************************
     C     SRA           BEGSR
      *************************************************************
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     QTYPE         PARM      QTYPE         QTYPE             3
     C     Qvalue        PARM      Qvalue        Qvalue           15
     C     MAILA         PARM      MAILA         MAILA             8
     C     TCPJN         PARM      TCPJN         TCPJN             1
     C     MAILI         PARM      MAILI         MAILI            50
     c                   movel     qvalue        qvalu4            4
      *__________________
      * Define Nøkler
      *""""""""""""""""""
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
      *__________________
      * Define Workfields
      *""""""""""""""""""
     C                   Z-ADD     0             AX                4 0          Index for A
     C                   Z-ADD     1             BX                4 0          Index for B
     C                   Z-ADD     0             AXV               4 0          Leftindx A
     C                   Z-ADD     0             AXH               4 0          Rightindx A
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   READ      FIRM                                   33
     C                   IF        UYEAR > 50
     C                   EVAL      UAAR = UYEAR + 1900
     C                   ELSE
     C                   EVAL      UAAR = UYEAR + 2000
     C                   END
     C                   MOVE      UMONTH        UMND
     C                   MOVE      UDAY          UDAG
     C                   MOVE      HEDTR         HEDTOP
     c                   move      *zeros        heopd
     c                   move      'ordre fra:'  ordfra
     c                   move      'avd:'        avd
     c                   move      'ordre:'      ordre
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SRBTCP                                            SRBTCP /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *
     C                   EXSR      ORDER
     C     PWDK          IFNE      'N'
     C                   EXSR      OPDHE
     C                   EXSR      free
     C                   END
     C                   ENDSR
     C*
      *////////////////////////////////////////////////////////////
      *  ORDER                                              ORDER /
      *////////////////////////////////////////////////////////////
     C     ORDER         BEGSR
      *
     C     KODKW         KLIST
     C                   KFLD                    KOWUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'W'           KOWUNI
     C     KODKV         KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'V'           KOVUNI
     c     qvalu4        ifeq      'AIRE'
     C                   MOVE      'D'           HEUR
     C                   MOVE      *ZEROS        HEHAWB
     c                   else
     c     qvalu4        ifeq      'BILI'
     C                   MOVE      'A'           HEUR
     c                   else
     c     qvalu4        ifeq      'BILE'
     C                   MOVE      'B'           HEUR
     c                   else
     c     qvalu4        ifeq      'FLYI'
     c                   move      'E'           HEUR
     C                   MOVE      *ZEROS        HEHAWB
     c                   else
     c     qvalu4        ifeq      'GEN '
     c                   exsr      gensr
     C                   MOVE      *blanks       HEHAWB
     c                   end
     c                   end
     c                   end
     c                   end
     c                   end
     C                   MOVE      'C'           HEST
      *passordkontroll av bruker
     C     'pwd.....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         PWD               6
     C     PWD           CHAIN     PWDINT                             63
     C     *IN63         IFEQ      '1'
     C*passord feil
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      'N'           PWDK              1
     C                   END
     C*passord ikke funnet
     C                   ELSE
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     PANSW1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITe     E101CRR
     C                   MOVE      'N'           PWDK              1
     C                   END
     C     PWDK          IFEQ      'N'
     C                   GOTO      FEILP
     C                   END
      *avdeling
     C     'avd.....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      numkon
     C                   MOVE      NUMVAL        HEAVD
     C                   MOVE      NUMVAL        AAAVD             4
     C     KODKW         CHAIN     KODTW                              33
     C     KODKV         CHAIN     KODTV                              33
     C                   END
      *signatur
     C     'sign....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HESG
     C                   END
      *sted fra
     C     'fland...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HELKS
     C                   MOVEL     idata         HELKA
     C                   END
     C     'fra.....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HESDF
     C                   END
      *sted til
     C     'tland...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HELKK
     C                   MOVEL     idata         HEtri
     C                   END
     C     'dest....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HESDT
     C                   END
      *prefix flyselskap
     c     qvalu4        ifeq      'AIRE'
     C     'prefix..: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HEKNT
     c                   MOVE      NUMVAL        WSFLY             3 0
     C                   MOVEL     DATA          AAFLY             3
     C                   END
     C                   END
     C                   z-add     0             kundnr
      *kundenummer avsender
     C     'avs.....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
     C     NUMVAL        IFNE      *ZEROS
     C                   MOVE      NUMVAL        KUNDNR
     C                   END
     C                   END
     C                   MOVE      KUNDNR        HEKNS
     c                   move      kundnr        trknfa
     c                   move      'S'           trkdak
     C                   MOVE      KUNDNR        HEKNSF
     C     KUNKEY        CHAIN     CUNDL01                            33
     C     *IN33         IFNE      '1'
     C                   MOVE      KNAVN         HENAS
     C                   MOVE      ADR1          HEADS1
     C                   MOVE      adr2          HEADS2
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          HEADS3
     C                   ELSE
     C                   MOVE      ENGAD3        HEADS3
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        HEADS3
     C                   MOVE      ADR3          HEADS3
     C                   END
     C                   ELSE
     C                   MOVEL     'Ukjent'      HENAS
     C                   MOVE      HEKNS         HENAS
     C                   END
     C* NAVN ADR MANUELLT LAGT INN skal overstyr kundenr
     C     'navna...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         ifne      *blanks
     C                   MOVE      *blanks       HENAS
     C                   MOVE      *blanks       HEADS1
     C                   MOVE      *blanks       HEADS2
     C                   MOVE      *blanks       HEADS3
     C                   MOVEL     idata         HENAS
     C                   END
     C     'adr1a...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         andne     *blanks
     C                   MOVEL     idata         HEADS1
     C                   END
     C     'adr2a...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         andne     *blanks
     C                   MOVEL     idata         HEADS2
     C                   END
     C     'adr3a...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         andne     *blanks
     C                   MOVEL     idata         HEADS3
     C                   END
     C                   END
      *kundenummer mottager
     C                   z-add     0             kundnr
     C     'mottaker: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HEKNK
     C                   MOVE      NUMVAL        KUNDNR
     C     KUNKEY        CHAIN     CUNDL01                            33
     C     *IN33         IFNE      '1'
     c     trknfa        ifeq      *zeros
     c                   move      kundnr        trknfa
     c                   move      'K'           trkdak
     c                   end
     C                   MOVE      KNAVN         HENAK
     C                   MOVE      ADR1          HEADK1
     C                   MOVE      adr2          HEADK2
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          HEADK3
     C                   ELSE
     C                   MOVE      ENGAD3        HEADK3
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        HEADK3
     C                   MOVE      ADR3          HEADK3
     C                   END
     C                   ELSE
     C                   MOVEL     'Ukjent'      HENAK
     C                   MOVE      HEKNK         HENAK
     C                   END
     C                   END
     C* NAVN ADR MANUELLT LAGT INN
     C     'navn....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         ifne      *blanks
     C                   MOVE      *blanks       HEADK1
     C                   MOVE      *blanks       HEADK2
     C                   MOVE      *blanks       HEADK3
     C                   MOVEL     idata         HENAK
     C                   END
     C     'adr1....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         andne     *blanks
     C                   MOVEL     idata         HEADK1
     C                   END
     C     'adr2....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         andne     *blanks
     C                   MOVEL     idata         HEADK2
     C                   END
     C     'adr3....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     c     idata         andne     *blanks
     C                   MOVEL     idata         HEADK3
     C                   END
     C                   END
      *oppdragstype
     C     'ot......: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HEOT
     C                   END
      *delterm
     C     'delterm.: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HEFR
     C                   END
      *antall kolli
     C     'kolli...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
     C                   MOVE      NUMVAL        HENT
     C                   MOVEL     DATA          AANT              7
     C                   END
      *vekt
     C     'vekt....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
     C                   z-add     NUMVAL        HEVKT
     C                   MOVEL     DATA          AAVKT             9
     C                   END
      *
      *volum i kubikk
     C     'volum...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
      *
     C                   SELECT
     C                   WHEN      XDESIMAL = 0
     C                   MULT      1000          NUMVAL
     C                   WHEN      XDESIMAL = 1
     C                   MULT      100           NUMVAL
     C                   WHEN      XDESIMAL = 2
     C                   MULT      10            NUMVAL
     C                   WHEN      XDESIMAL = 4
     C                   DIV(H)    10            NUMVAL
     C                   WHEN      XDESIMAL = 5
     C                   DIV(H)    100           NUMVAL
     C                   ENDSL
      *
     C                   MOVE      NUMVAL        HEM3
     C                   MOVEL     DATA          AAM3              7
     C                   END
     C                   EXSR      FINNVK
      *vareslag
     C     'vare....: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HEVS1
     C                   END
      *vareslag
     C     'vare2...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HEVS2
     C                   END
      *
      *VAREVERDI
     C     'verdi...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      NUMKON
      *
     C                   SELECT
     C                   WHEN      XDESIMAL = 0
     C                   MULT      100           NUMVAL
     C                   WHEN      XDESIMAL = 1
     C                   MULT      10            NUMVAL
     C                   WHEN      XDESIMAL = 2
     C                   MULT      1             NUMVAL
     C                   WHEN      XDESIMAL = 4
     C                   DIV(H)    100           NUMVAL
     C                   WHEN      XDESIMAL = 5
     C                   DIV(H)    1000          NUMVAL
     C                   ENDSL
      *
     C                   MOVE      NUMVAL        TRVERB
     C                   MOVEL     DATA          ARVERB            7
     C                   END
      *
      *fra og tildato
      *
     C     'fradato.: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         trsdfd
     C                   END
     C     'tildato.: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         trsdtd
     C                   END
      *merk1
     C     'merk1...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HEGM1
     C                   END
      *merk2
     C     'merk2...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         HEGM2
     C                   END
     C     FEILP         TAG
     C     'maila...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         MAILA
     C                   END
     C     'maili...: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         MAILI
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NUMKON                                             NUMKON/
      *////////////////////////////////////////////////////////////
     C     NUMKON        BEGSR
     C                   MOVE      *ZEROS        NUMVAL
     C                   MOVE      *ZEROS        XDESIMAL          1 0
     C                   Z-ADD     30            NM                2 0
     C                   Z-ADD     30            NN                2 0
     C                   DO        30
     C     D(NM)         IFGE      '0'
     C     D(NM)         ANDLE     '9'
     C                   MOVE      D(NM)         N(NN)
     C                   SUB       1             NN
     C                   ELSE
     C     D(NM)         IFEQ      '.'
     C     D(NM)         OREQ      ','
     C                   EVAL      XDESIMAL = 30 - NN
     C                   END
     C                   END
     C                   SUB       1             NM
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SHISR                                              SHISR /
      *////////////////////////////////////////////////////////////
     C     SHISR         BEGSR
      *
      * sender svar til den som har sendt ordren
      *
      * Heading
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     html          RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     YANSW2        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Underline
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     YANSW3        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * Blank linje
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * vår odre
     C                   MOVE      '/'           SLASH             1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Vår ref....:'RDATA
     C     RDATA         CAT       AAAVD:1       RDATA
     C     RDATA         CAT       SLASH:1       RDATA
     C     RDATA         CAT       AAOPD:1       RDATA
     C     RDATA         CAT       SLASH:1       RDATA
     C     RDATA         CAT       HESG:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * fra til sted
     C                   MOVE      '-'           BINDE             1
     C                   MOVE      '/'           slash             1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Fra-til....:'RDATA
     C     RDATA         CAT       HELKS:1       RDATA
     C     RDATA         CAT       slash:1       RDATA
     C     RDATA         CAT       HESDF:1       RDATA
     C     RDATA         CAT       BINDE:1       RDATA
     C     RDATA         CAT       HELKK:1       RDATA
     C     RDATA         CAT       slash:1       RDATA
     C     RDATA         CAT       HESDT:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * flyselskap
     c     qvalu4        ifeq      'AIRE'
     C                   MOVE      '-'           BINDE             1
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Flyselskap.:'RDATA
     C     RDATA         CAT       AAFLY:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     c                   end
      *
      * avsender
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Avsender...:'RDATA
     C     RDATA         CAT       HENAS:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * mottager
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Mottager...:'RDATA
     C     RDATA         CAT       HENAK:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Adr 1......:'RDATA
     C     RDATA         CAT       HEADK1:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Adr 2......:'RDATA
     C     RDATA         CAT       HEADK2:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Adr 3......:'RDATA
     C     RDATA         CAT       HEADK3:1      RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * oppdragstype
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Opd.type...:'RDATA
     C     RDATA         CAT       HEOT:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * del.term
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Lev.bet....:'RDATA
     C     RDATA         CAT       HEFR:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * antall kolli
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Ant. kolli.:'RDATA
     C     RDATA         CAT       AANT:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * vekt
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Vekt.......:'RDATA
     C     RDATA         CAT       AAVKT:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * kubikk
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Kubikk.....:'RDATA
     C     RDATA         CAT       AAM3:1        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      *
      * vareslag
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Vareslag...:'RDATA
     C     RDATA         CAT       HEVS1:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      * deres ordre
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Deres ref..:'RDATA
     C     RDATA         CAT       HERFA:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
      *
      * merknad1
     C     HEGM1         IFNE      *BLANKS
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Merknad 1..:'RDATA
     C     RDATA         CAT       HEGM1:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      *
      * merknad2
     C     HEGM2         IFNE      *BLANKS
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     'Merknad 2..:'RDATA
     C     RDATA         CAT       HEGM2:1       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
     C                   END
      *
      *
      * Blank linje,
     C                   MOVE      *BLANKS       RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      * End of Info
     C                   MOVE      *BLANKS       RDATA
     C                   MOVEL     YANSW4        RDATA
     C                   MOVE      X'0D'         RDATA
     C                   WRITE     E101CRR
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  OPDHE                                              OPDHE /
      *////////////////////////////////////////////////////////////
     C     OPDHE         BEGSR
      *
      * skriving direkte til headf
      *
     c     qtype         ifne      'BOF'
     c     qtype         andne     'bof'
     c**   qvalu4        andne     'GEN '
     C     HEAVD         CHAIN     TELL                               33
     C     *IN33         IFNE      '1'
     C                   MOVE      TEOPDN        HEOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
      *oppdaterer fri søkevei
     C                   EXSR      SRFRI
     C                   WRITE     HEADFR
     C                   MOVE      HEOPD         AAOPD             7
     c                   endif
     c                   else
      *
      * skriving til Z-filer
      *
     c                   z-add     0             heavd
     c                   z-add     0             heopd
     c                   move      *blanks       hest
     c     fifirm        chain     ztell                              33
     c  n33              z-add     zunik         heunik
     c  n33              add       1             zunik
     c  n33              update    ztellr
      *oppdaterer fri søkevei
     C                   EXSR      SRFRI
     C                   WRITE     HEADFR2
     c                   end
     c*
     c* sender svar til den som har booket oppdraget
     c*
     C                   EXSR      SHISR
     c* henter brukere som skal ha melding fra fil på nytt
     c* ved generell booking
     c     qvalu4        ifeq      'gen'
     c     qvalu4        oreq      'GEN'
     c     heurkey       chain     heurfil                            33
     c   33              move      *zeros        heavd
     c                   end
     c*
     c* sender meldinger til lokale saksbehandlere
     c*
     C     1             DO        5             NM                2 0
     c     br(nm)        ifne      *blanks
     c                   call      'EDI20STC'
     c                   parm                    br(nm)
     c                   parm                    bootxt
     C                   ENDif
     c                   enddo
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     FINNVK        BEGSR
     C***********************************************
     C*
     C*** GETS FREIGHTWEIGHT
     C     HELM          MULT      KOVLKG        XLMLM             9 0
     C     HEM3          MULT      KOVKKG        XM3DE            12 3
     C                   ADD       0.999         XM3DE
     C                   Z-ADD     XM3DE         XM3M3             9 0
     C     HEVKT         COMP      XLMLM                              33
     C   33              Z-ADD     HEVKT         HEFBV
     C  N33              Z-ADD     XLMLM         HEFBV
     C     HEFBV         COMP      XM3M3                              33
     C  N33              Z-ADD     XM3M3         HEFBV
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     SRFRI         BEGSR
     C***********************************************
     C*
     C                   MOVE      HEAVD         FSAVD
     C                   MOVE      HEOPD         FSOPD
     C                   MOVEL     'ORD'         FSKODE
     c                   move      heunik        fsunik
      *order 1
     C     'order1..: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         FSSOK
     c     LO:UP         XLATE     FSSOK         FSSOK
     c                   movel     fssok         fsreff
     c     qtype         ifne      'BOF'
     c     qtype         andne     'bof'
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     c                   else
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     zRISOKR
     c                   end
     c                   movel     FSSOK         hereff
     c                   movel     FSSOK         herfa
     c                   move      heunik        frunik
     C                   END
     c                   exsr      frisokg
     C                   ENDSR
     C*
     C***********************************************
     C     gensr         BEGSR
     C***********************************************
     C*
     C     'prefcar.: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         prefcar          10
     c     LO:UP         XLATE     prefcar       prefcar
     C                   END
     C*
     C     'custclea: '  chain     ediinn                             33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     idata         custclea         10
     c     LO:UP         XLATE     custclea      custclea
     C                   END
     c     heurkey       klist
     c                   kfld                    prefcar
     c                   kfld                    custclea
     c     heurkey       chain     heurfil                            33
     c   33              move      *zeros        heavd
     C  N33              MOVE      HEAVD         AAAVD             4
     c*
     c                   endsr
     C*
     C***********************************************
     C     frisokg       BEGSR
     C***********************************************
     C*generell frisøk
     C                   MOVE      HEAVD         FSAVD
     C                   MOVE      HEOPD         FSOPD
     c                   movea     '0'           *in(33)
      *order 1
     C     'fri       '  setll     ediinn
     C     *IN33         doweq     '0'
     c                   read      ediinn                                 33
     c     *in33         ifeq      '0'
     C                   MOVEL     iKEY          FSSOK6            6
     c     LO:UP         XLATE     FSSOK6        FSSOK6
     c                   movel     fssok6        fsso3a            3
     c                   move      fssok6        fsso3b            3
     C     FSSO3A        COMP      'FRI'                              3333
     c     *in33         ifeq      '0'
     C                   MOVE      FSSO3B        FSKODE
     C                   MOVEL     idata         FSSOK
     c     LO:UP         XLATE     FSSOK         FSSOK
     c     qtype         ifne      'BOF'
     c     qtype         andne     'bof'
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     FRISOKR
     c                   else
     C                   MOVE      HEDTOP        FSDTOP
     C                   WRITE     zRISOKR
     C                   END
     C                   END
     c                   END
     c                   END
     C                   ENDSR
     C*
     C***********************************************
     C     free          BEGSR
     C***********************************************
     C*generell info til fritext på ordre
      *   frie merkelinjer
     c                   move      heavd         frtavd
     c                   move      heopd         frtopd
     c                   move      hedtr         frtdt
     c                   move      heunik        frunik
     c                   movel     hereff        frreff
     c                   move      *zeros        frtli
     c                   move      'A'           frtkod
     c                   movea     '0'           *in(33)
      *start lesing
     C     'info      '  setll     ediinn
     C     *IN33         doweq     '0'
     c                   read      ediinn                                 33
     c     *in33         ifeq      '0'
     C                   MOVEL     iKEY          info04            4
     C     info04        COMP      'info'                             3333
     c     *in33         ifeq      '0'
     c                   add       1             frtli
     C                   MOVEL     idata         frttxt
     c     qtype         ifne      'BOF'
     c     qtype         andne     'bof'
     c     qvalu4        andne     'GEN '
     c                   write     freetxtr
     c                   else
     c                   write     zreetxtr
     C                   END
     C                   END
     c                   END
     c                   END
     C                   ENDSR
