     FZILLOF    UF   E           K DISK
     F                                     RENAME(BILLOFR:ZILLOFR)
     FZLV1      IF   E           K DISK
     F                                     RENAME(BLV1R:ZLV1R)
     FZLV2      IF   E           K DISK
     F                                     RENAME(BLV2R:ZLV2R)
     FZRISOL01  IF   E           K DISK
     F                                     RENAME(FRISOKR:ZRISOKR)
     FZREETXT1  IF   E           K DISK
     F                                     RENAME(FREETXTR:ZREETXTR)
     FZEADL02   UF   E           K DISK
     F                                     RENAME(HEADFR:ZEADFR)
     FTELL      UF   E           K DISK
     FBILLOF    O  A E             DISK
     FBLV1      UF A E           K DISK
     FBLV2      O  A E             DISK
     FFRISOK    O  A E             DISK
     FKODFRI    IF   E           K DISK
     FFREETXT   O  A E             DISK
     FHEADF     O  A E             DISK
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
     C     *ENTRY        PLIST
     C                   PARM                    ULUNIK            9 0
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     BLV1KEY       KLIST
     C                   KFLD                    BLAVD
     C                   KFLD                    BLOPD
      *_____________
      * Init av felt
      *"""""""""""""
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Flytt                                                SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR

      *____________
      * Hent ZILLOF
      *""""""""""""
     C     ULUNIK        CHAIN     ZILLOF                             33
      *____________________
      * Hent oppdragsnummer
      *"""""""""""""""""""
     C     BLAVD         CHAIN     TELL                               33
     C                   MOVE      TEOPDN        BLOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR

     C                   UPDATE    ZILLOFR
      *_______
      * BILLOF
      *"""""""
     C                   MOVE      *BLANKS       BLAD1G
     C                   MOVE      *BLANKS       BLAD2G
     C                   MOVE      *BLANKS       BLAD3G
     C                   MOVE      *BLANKS       BLAD4G
     C                   MOVE      *BLANKS       BLBREI
     C                   WRITE     BILLOFR
      *_____
      * BLV1
      *"""""
     c                   move      'J'           SumLin            1
     c     SumLin        ifeq      'N'
      * skriv linjene eksakt som de er
     C     ULUNIK        SETLL     ZLV1
     C     ULUNIK        READE     ZLV1                                   33
     C     *IN33         DOWEQ     *OFF
     C                   Z-ADD     BLAVD         BVAVD
     C                   Z-ADD     BLOPD         BVOPD
     C                   WRITE     BLV1R
     C     ULUNIK        READE     ZLV1                                   33
     c                   end
     c                   else
      * samle vekt volum i en første sumlinje
     C     ULUNIK        SETLL     ZLV1
     C     ULUNIK        READE     ZLV1                                   33
     C                   MOVE      'J'           XV1LIN            1
     C                   MOVE      *BLANKS       XVMN             17
     C                   MOVE      *BLANKS       XVVS             25
     C                   MOVE      *ZEROS        XVNT              5 0
     C                   MOVE      *ZEROS        XVVKT             9 0
     C                   MOVE      *ZEROS        XVM3              9 3
     C     *IN33         DOWEQ     *OFF
     C     XVMN          IFEQ      BVMN
     C                   MOVE      *BLANKS       BVMN
     C                   END
     C     XVMN          IFEQ      *BLANKS
     C                   MOVE      BVMN          XVMN
     C                   END
     C     XVVS          IFEQ      BVVS
     C                   MOVE      *BLANKS       BVVS
     C                   END
     C     XVVS          IFEQ      *BLANKS
     C                   MOVE      BVVS          XVVS
     C                   END
     C                   ADD       BVNT          XVNT
     C                   ADD       BVVKT         XVVKT
     C                   ADD       BVM3          XVM3
     C     XV1LIN        IFEQ      'N'
     C                   MOVE      *ZEROS        BVNT
     C                   MOVE      *ZEROS        BVVKT
     C                   MOVE      *ZEROS        BVM3
     C                   END
     C     BVMN          IFNE      *BLANKS
     C     BVVS          ORNE      *BLANKS
     C     XV1LIN        OREQ      'J'
     C                   Z-ADD     BLAVD         BVAVD
     C                   Z-ADD     BLOPD         BVOPD
     C                   WRITE     BLV1R
     C                   MOVE      'N'           XV1LIN
     C                   END
     C     ULUNIK        READE     ZLV1                                   33
     C  N33              ENDDO
     C     BLV1KEY       SETLL     BLV1
     C     BLV1KEY       READE     BLV1                                   33
     C     *IN33         IFEQ      '0'
     C                   MOVE      XVNT          BVNT
     C                   MOVE      XVVKT         BVVKT
     C                   MOVE      XVM3          BVM3
     C                   UPDATE    BLV1R
     C                   END
     c                   end
      *_____
      * BLV2
      *"""""
     C     ULUNIK        SETLL     ZLV2
     C     ULUNIK        READE     ZLV2                                   33
     C     *IN33         DOWEQ     *OFF
     C                   Z-ADD     BLAVD         BVAVD
     C                   Z-ADD     BLOPD         BVOPD
     C                   WRITE     BLV2R
     C     ULUNIK        READE     ZLV2                                   33
     C  N33              ENDDO
      *_______
      * FRISOK
      *"""""""
     C     ULUNIK        SETLL     ZRISOL01
     C     ULUNIK        READE     ZRISOL01                               33
     C     *IN33         DOWEQ     *OFF
     C                   Z-ADD     BLAVD         FSAVD
     C                   Z-ADD     BLOPD         FSOPD
     C                   MOVE      BLDTA         FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C  N33              MOVE      KFSODK        FSDOKK
     C                   WRITE     FRISOKR
     C     ULUNIK        READE     ZRISOL01                               33
     C  N33              ENDDO
      *________
      * FREETXT
      *""""""""
     C     ULUNIK        SETLL     ZREETXT1
     C     ULUNIK        READE     ZREETXT1                               33
     C     *IN33         DOWEQ     *OFF
     C                   Z-ADD     BLAVD         FRTAVD
     C                   Z-ADD     BLOPD         FRTOPD
     C                   WRITE     FREETXTR
     C     ULUNIK        READE     ZREETXT1                               33
     C  N33              ENDDO
      *________
      * HEADF
      *""""""""
     C                   TIME                    XULTID
     C                   MOVE      XULDD         XIDAGD
     C                   MOVE      XULMM         XIDAGM
     C                   MOVE      XULÅÅ         XIDAGÅ
     C     ULUNIK        SETLL     ZEADL02
     C     ULUNIK        READE     ZEADL02                                33
     C     *IN33         DOWEQ     *OFF
     C                   Z-ADD     BLAVD         HEAVD
     C                   Z-ADD     BLOPD         HEOPD
     C                   WRITE     HEADFR
     C                   MOVE      'P'           HEST
     C                   UPDATE    ZEADFR
     C     ULUNIK        READE     ZEADL02                                33
     C  N33              ENDDO
     C                   ENDSR
