***** **************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr *Sek Sig Vers  Beskrivelse...........................
""""" *"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12348 * 01 CB  PTF12 VISE FRA OG MED VAREPOSTNR FOR HELE TRANSITERINGEN
***** **************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED TET-IMPORT LOSSEMERKNADER     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 07 09-11 13 14 16-24
      *** LEDIGE INDIKATORER 28 29 34-36 47-51 57-73 95-97
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.      ***
      ***   OG DEFINERES I PROGRAM                               ***
      **************************************************************
      *
     FNCTSIC    UF A E           K DISK
     FNCTSII    UF A E           K DISK
     F*NCTSIC02  IF   E           K DISK    RENAME(NCTSICR:NCTSICR2)
     FTRKODL01  IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FNCTS065D  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D LI              S              5  0 DIM(200)
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  TCNAS                  1     70A
     D  TCNAS_30               1     30A
     D                 DS
     D  TCNAK                  1     70A
     D  TCNAK_30               1     30A
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UIN27                 12     12
     D  UIN34                 13     13
     D  U1N07                 15     17
     D  UKDC                  28     28
      * OBS! HUSK INITIERE ALLE FELTER PÅ TR011R
     D  UPARM2                 1    128
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI
     C                   MOVE      *ZEROS        XLI
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C* N31TRV2K         SETLL     TRIL02
     C*  31TRV1K         SETLL     TRIL
     C     NCTSIC1K      SETLL     NCTSIC
     C     START1        TAG
     C* N31TRHK          READE     TRIL02                                 94
     C*  31TRHK          READE(N)  TRIL                                   94
     C     NCTSIC1K      READE(N)  NCTSIC
     C  N94
     CAN 31              MOVE      TCLI          W3LI
     C   94              MOVE      *BLANKS       WSNR
     C                   MOVE      *ZEROS        XLI               5 0
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        99998
     C                   ADD       1             ZRECNO
     C                   EXSR      HENTDT
N01  C                   EXSR      SUMITEM
     C                   WRITE     SUBFIL
     C* N31TRHK          READE     TRIL02                                 94
     C*  31TRHK          READE(N)  TRIL                                   94
     C     NCTSIC1K      READE(N)  NCTSIC                                 94
     C  N94
     CAN 31              MOVE      TCLI          W3LI
     C  N94              END
     C                   END
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     ZRECNO        IFGT      1
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      ***
      *
     C                   SETOFF                                       989930
      *
      *** F03 OG 27 PÅ ---> AVBRYTTE SPØRRING
     C   03
     CAN 27              MOVE      *ZEROS        UFLAGG
     C   03
     CAN 27              GOTO      SLUTT
      *** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
      *** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
     C   03              DO
     C                   EXSR      PRINT
      *** F12 ---> AVBRYTTE F3
     C   12              Z-ADD     4             LINNBR
     C   12              Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
      *
      *** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              GOTO      START
      *** F6  ---> LAGE NYE DETALJE LINJER
     C   06              GOTO      START5
      *** F8  ---> VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C   08              GOTO      START7
      *
      *** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94NCTSIC1K      READE(N)  NCTSIC
     C                   GOTO      START2
     C                   END
      *
      *** SJEKKE OM BRUKER HAR VALGT OPSJONER. HIVS SÅ,T UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   END
      *** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
      ***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
      *** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
      ***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
      *
      *** LAGE NYE DETALJE LINJER
     C     START5        TAG
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   EXSR      MOVB2
      *
     C     START6        TAG
     C  N30WSLI          IFGT      0
     C                   EXSR      TSTOPL
     C                   END
     C                   EXFMT     VARELI
     C                   MOVEA     '0000000000'  *IN(81)
     C                   MOVE      '0'           *IN30
      *
      *** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      START6
     C                   END
      *
     C   12WSLI          IFGT      0
     C                   EXSR      DLTOPL
     C                   END
      *
      *** F12 --> AVBRYTTE REGISTRERING AV NYE DETALJE LINJER.
     C  N12              DO
      *** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
      *** FEILMELDING.
     C                   EXSR      TESTB1
     C   30              GOTO      START6
      *
     C     WSLI          IFEQ      0
     C                   ADD       1             XLI
     C                   MOVE      XLI           WSLI
     C                   END
      *
      *** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDNCTS
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      START6
     C                   END
      *
     C                   MOVE      'N'           XOPDWF            1
     C                   EXSR      WRKITEM
      *
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
      *** VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
      *** 31 PÅ    ---> SORTERE PÅ TARIFFNR. + STATUS       (TRUV02)
      *** 31 AV    ---> SORTERE PÅ REGISTRERINGS REKKEFØLGE (TRUV)
     C     START7        TAG
     C*                  MOVE      *ZEROS        W3VNT
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C                   MOVE      W3LI          W3LIGM            5 0
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     HENTDT        BEGSR
      ***********************************************
     C     TCLI          IFGT      XLI
     C                   MOVE      TCLI          XLI               5 0
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *
     C                   IF        WSVKTB = 0
     C                   MOVE      'SPV0002'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSTATY        IFNE      0
     C                   MOVE      '750'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTATY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           89
     C     *IN89         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2194'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   IF        WSTAID = *BLANKS AND WSTATY <> 0
     C                   MOVE      'YBC2193'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   MOVE      '1'           *IN88
     C                   MOVE      '1'           *IN30
     C                   END
      * Landkode til transportmiddel
     C                   IF        WSTAID <> *BLANKS OR WSTALK <> *BLANKS
     C                   MOVE      WSTALK        KS2LK
     C     KODTS2K       CHAIN     KODTS2                             87
     C   87              IF        *IN30 = *OFF
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C     WSSDTY        IFNE      *BLANKS
     C                   MOVE      '213'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           86
     C   86              IF        *IN30 = *OFF
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2246'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   IF        WSSDRF = *BLANKS AND WSSDTY <> *BLANKS
     C                   MOVE      'YBC2252'     MSGNR
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   MOVE      '1'           *IN85
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSTDTY        IFNE      *BLANKS
     C                   MOVE      '754'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           84
     C   84              IF        *IN30 = *OFF
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2249'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   IF        WSTDRF = *BLANKS AND WSTDTY <> *BLANKS
     C                   MOVE      'YBC2253'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   MOVE      '1'           *IN83
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSADTY        IFNE      *BLANKS
     C                   MOVE      '380'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSADTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           82
     C   82              IF        *IN30 = *OFF
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2249'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   IF        WSADRF = *BLANKS AND WSADTY <> *BLANKS
     C                   MOVE      'YBC2250'     MSGNR
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   MOVE      '1'           *IN81
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     SLTB1         ENDSR
      *
      ***********************************************
     C     HENTSR        BEGSR
      ***********************************************
      *** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
      *** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
      *** OPSJON 2 ---> ENDRE DETALJE LINJE.
      *** OPSJON 4 ---> SLETTE DETALJE LINJE.
      *** OPSJON 5 ---> VISE DETALJE LINJE
      *** OPSJON 9 ---> FJERNE ENDRING
      *** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGNCTS
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTNCTS
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISNCTS
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '8'
     C                   MOVE      ' '           WSNR
     C                   MOVE      'J'           XOPDWF            1
     C                   EXSR      WRKITEM
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '9'
     C                   MOVE      ' '           WSNR
     C                   EXSR      REKNCTS
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISNCTS       BEGSR
      ***********************************************
     C                   SETON                                        99
      *
     C                   MOVE      TCLI          WSLI
     C*                  MOVE      NIDTY         WSDTY
     C*                  MOVE      NIDREF        WSDREF
     C*                  EXSR      TSTOPL
     C*                  MOVE      WSDTY         NIDTY
     C*                  MOVE      WSDREF        NIDREF
     C     STVIS         TAG
     C                   EXFMT     VAREL3
      *
     C   15              DO
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STVIS
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     DLTNCTS       BEGSR
      ***********************************************
     C*    TCVKTB        IFEQ      0
     C                   SETON                                        99
      *
     C                   MOVE      TCLI          WSLI
     C*                  MOVE      NIDTY         WSDTY
     C*                  MOVE      NIDREF        WSDREF
     C                   EXSR      TSTOPL
     C*                  MOVE      WSDTY         NIDTY
     C*                  MOVE      WSDREF        NIDREF
     C     STDLT         TAG
     C                   EXFMT     VAREL3
      *
     C     *IN15         IFEQ      '1'
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STDLT
     C                   END
      *
     C     *IN12         IFEQ      '0'
     C     NCTSICK       CHAIN     NCTSIC                             33
     C                   EVAL      TC01 = 'S'
     C*                  DELETE    NCTSICR
     C                   UPDATE    NCTSICR
     C     NCTSICK       SETLL     NCTSII
     C     NCTSICK       READE     NCTSII                                 33
     C                   DOW       *IN33 = *OFF
     C*                  DELETE    NCTSIIR
     C                   EVAL      TC01 = 'S'
     C                   UPDATE    NCTSIIR
     C     NCTSICK       READE     NCTSII                                 33
     C                   ENDDO
     C                   EXSR      DLTOPL
     C                   EXSR      MOVB1
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
     C*                  END
      *
     C                   ENDSR
      *
      ***********************************************
     C     REKNCTS       BEGSR
      ***********************************************
     C     TCVKTB        IFNE      0
     C     NCTSICK2      CHAIN     NCTSIC                             33
     C                   EXSR      MOVB1
     C                   UPDATE    NCTSICR
     C                   EXSR      DLTOPL
     C                   MOVE      ' '           WSNR
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   WRITE     SUBCTL
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGNCTS       BEGSR
      ***********************************************
      *** FLYTTE DATA FRA SUBFIL TIL ARBEIDSVARIABLER
     C                   EXSR      MOVNCTSW
      *
     C     STCHG         TAG
     C  N30              EXSR      TSTOPL
     C                   EXFMT     VARELI
     C                   MOVEA     '0000000000'  *IN(81)
     C                   MOVE      '0'           *IN30
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      STCHG
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN12         IFEQ      '1'
      *** F12 ---> AVBRYTTE ENDRING
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
     C                   ELSE
      *** TESTE INNTASTEDE TADA. HVIS IKKE NOE FEIL, OPPDRATERE PÅ FIL
     C                   EXSR      TESTB1
     C   30              GOTO      STCHG
     C                   EXSR      OPDNCTS
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDNCTS       BEGSR
      ***********************************************
      *** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     NCTSICK       CHAIN     NCTSIC                             33
      *** FLYTTE INNTASTET DATA TIL FIL-VARIABLER OG OPPDATERE DEM.
     C                   EXSR      MOVWNCTS
     C     *IN33         IFEQ      '0'
     C                   UPDATE    NCTSICR
     C                   ELSE
     C                   EXSR      MOVB3
     C                   MOVE      UAVD          TCAVD
     C                   MOVE      UTDN          TCTDN
     C                   WRITE     NCTSICR
     C                   END
      *
     C                   EXSR      HENTDT
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     TILKOD        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   MOVE      UAVD          TCAVD
     C                   MOVE      UTDN          TCTDN
      *
     C*  53LINNBR        IFEQ      8
     C*    POSNBR        ANDGE     10
     C*    POSNBR        ANDLE     42
     C*                  MOVE      *BLANKS       WXMN             17
     C*                  MOVE      *BLANKS       WXMNSK            2
     C*                  MOVE      '1'           UIN272            1
     C*                  CALL      'TR071R'
     C*                  PARM                    TCAVD
     C*                  PARM                    TCTDN
     C*                  PARM                    WSLI
     C*                  PARM                    XLI2
     C*                  PARM                    WXMN
     C*                  PARM                    WXMNSK
     C*                  PARM                    TVMN
     C*                  PARM                    TVMNSK
     C*                  PARM                    UIN27
     C*                  END
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKITEM       BEGSR
      ***********************************************
      *
     C                   CALL      'NCTS066R'
     C                   PARM      UAVD          UAVD2             4 0
     C                   PARM      UTDN          UTDN2             7 0
     C                   PARM      TCLI          ULI2              5 0
     C     *IN27         PARM      *IN27         UIN27             1
     C     *IN36         PARM      *IN36         UIN36             1
     C                   PARM                    UFLAGG            1 0
      *
      * Summere bruttovekt
     C     NCTSICK2      CHAIN     NCTSIC                             33
     C                   EVAL      NCVKTB = 0
     C     NCTSICK2      SETLL     NCTSII
     C     NCTSICK2      READE     NCTSII                                 33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      TN01 = 'S'
     C                   WHEN      NNVKB > 0
     C                   EVAL      NCVKTB = NCVKTB + NNVKB
     C                   WHEN      TNVKB > 0
     C                   EVAL      NCVKTB = NCVKTB + TNVKB
     C                   ENDSL
     C     NCTSICK2      READE     NCTSII                                 33
     C                   ENDDO
     C                   UPDATE    NCTSICR
      *
     C                   IF        XOPDWF = 'J'
     C                   UPDATE    SUBFIL
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVNCTSW      BEGSR
      ***********************************************
     C                   SETON                                        99
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   SETON                                        40
      *
     C                   MOVE      TCLI          WSLI
      *
     C                   MOVE      NCVKTB        WSVKTB
     C                   MOVE      NCTATY        WSTATY
     C                   MOVE      NCTAID        WSTAID
     C                   MOVE      NCTALK        WSTALK
     C                   MOVE      NCSDTY        WSSDTY
     C                   MOVE      NCSDRF        WSSDRF
     C                   MOVE      NCSDIN        WSSDIN
     C                   MOVE      NCTDTY        WSTDTY
     C                   MOVE      NCTDRF        WSTDRF
     C                   MOVE      NCADTY        WSADTY
     C                   MOVE      NCADRF        WSADRF
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWNCTS      BEGSR
      ***********************************************
     C                   MOVE      WSLI          TCLI
     C                   MOVE      WSVKTB        NCVKTB
     C                   MOVE      WSTATY        NCTATY
     C                   MOVE      WSTAID        NCTAID
     C                   MOVE      WSTALK        NCTALK
     C                   MOVE      WSSDTY        NCSDTY
     C                   MOVE      WSSDRF        NCSDRF
     C                   MOVE      WSSDIN        NCSDIN
     C                   MOVE      WSTDTY        NCTDTY
     C                   MOVE      WSTDRF        NCTDRF
     C                   MOVE      WSADTY        NCADTY
     C                   MOVE      WSADRF        NCADRF
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB1         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       TC01
     C                   MOVE      *ZEROS        NCVKTB
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB2         BEGSR
      ***********************************************
     C                   SETOFF                                       40
     C                   CLEAR                   NCTSICR
     C                   MOVEA     '000'         *IN(42)
     C                   MOVEA     '000'         *IN(52)
      *
     C                   MOVE      *ZEROS        WSLI
     C                   MOVE      *ZEROS        WSVKTB
     C                   MOVE      *ZEROS        WSTATY
     C                   MOVE      *BLANKS       WSTAID
     C                   MOVE      *BLANKS       WSTALK
     C                   MOVE      *BLANKS       WSSDTY
     C                   MOVE      *BLANKS       WSSDRF
     C                   MOVE      *BLANKS       WSSDIN
     C                   MOVE      *BLANKS       WSTDTY
     C                   MOVE      *BLANKS       WSTDRF
     C                   MOVE      *BLANKS       WSADTY
     C                   MOVE      *BLANKS       WSADRF
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB3         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       TC01
     C                   MOVE      *ZEROS        TCVKTB
     C                   MOVE      *ZEROS        TCSECI
     C                   MOVE      *BLANKS       TCTINS
     C                   MOVE      *BLANKS       TCNAS
     C                   MOVE      *BLANKS       TCAD1S
     C                   MOVE      *BLANKS       TCPNS
     C                   MOVE      *BLANKS       TCPSS
     C                   MOVE      *BLANKS       TCLKS
     C                   MOVE      *BLANKS       TCNAK
     C                   MOVE      *BLANKS       TCAD1K
     C                   MOVE      *BLANKS       TCPNK
     C                   MOVE      *BLANKS       TCPSK
     C                   MOVE      *ZEROS        TCTATY
     C                   MOVE      *BLANKS       TCTAID
     C                   MOVE      *BLANKS       TCTALK
     C                   MOVE      *BLANKS       TCPDTY
     C                   MOVE      *BLANKS       TCPDRF
     C                   MOVE      *BLANKS       TCPDIN
     C                   MOVE      *BLANKS       TCSDTY
     C                   MOVE      *BLANKS       TCSDRF
     C                   MOVE      *ZEROS        TCSDLN
     C                   MOVE      *BLANKS       TCSDIN
     C                   MOVE      *BLANKS       TCTDTY
     C                   MOVE      *BLANKS       TCTDRF
     C                   MOVE      *BLANKS       TCADTY
     C                   MOVE      *BLANKS       TCADRF
     C                   MOVE      *BLANKS       TCAICD
     C                   MOVE      *BLANKS       TCAITX
      *
     C                   ENDSR
      *
      ***********************************************
     C     PRINT         BEGSR
      ***********************************************
     C   03              Z-ADD     3             UFLAGG            1 0
      *
     C     UIN27         IFEQ      '0'
     C                   MOVE      '044'         U1N07
     C                   MOVE      '1'           UIN34
     C                   CALL      'NCTS063R'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      12
     C                   END
      *
     C     SLPRT         ENDSR
      *
      ***********************************************
     C     SOKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   MOVE      '750'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSTATY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSTATY
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTALK
     C                   PARM                    USPED
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     15
     C                   MOVE      '213'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSSDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSSDTY
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     15
     C                   MOVE      '754'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSTDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSTDTY
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     15
     C                   MOVE      '380'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSADTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSADTY
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSOK         ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     NCTSIC1K      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     NCTSICK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    WSLI
     C*    TRV1K         KLIST
     C*                  KFLD                    UAVD
     C*                  KFLD                    UTDN
     C*                  KFLD                    W3LI
     C     NCTSICK2      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    TCLI
     C*    TRV2K         KLIST
     C*                  KFLD                    UAVD
     C*                  KFLD                    UTDN
     C*                  KFLD                    W3VNT
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
      *
     C     *ENTRY        PLIST
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C                   MOVE      UIN27         *IN27
     C                   MOVE      *ZEROS        XLI
      *
     C                   MOVE      *ZEROS        TCLI
     C                   MOVE      'N'           USPED             1
     C                   EVAL      KS2UNI = 'S2'
     C                   MOVEA     '01'          *IN(31)
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           UIDAG             8 0
      *
     C                   ENDSR
      *
      ***********************************************
     C     TSTOPL        BEGSR
      ***********************************************
     C                   MOVEA     '00000'       *IN(42)
     C                   MOVEA     '00000'       *IN(52)
     C                   MOVE      NCVKTB        X1VKTB           13 3
     C                   MOVE      NCTATY        X1TATY            2 0
     C                   MOVE      NCTAID        X1TAID           35
     C                   MOVE      NCTALK        X1TALK            2
     C                   MOVE      NCSDTY        X1SDTY            4
     C                   MOVE      NCSDRF        X1SDRF           70
     C                   MOVE      NCSDIN        X1SDIN           35
     C                   MOVE      NCTDTY        X1TDTY            4
     C                   MOVE      NCTDRF        X1TDRF           70
     C                   MOVE      NCADTY        X1ADTY            4
     C                   MOVE      NCADRF        X1ADRF           70
      *
     C                   MOVE      TCVKTB        X2VKTB           13 3
     C                   MOVE      TCSECI        X2SECI            1 0
     C                   MOVE      TCTINS        X2TINS           17
     C                   MOVE      TCNAS         X2NAS            70
     C                   MOVE      TCAD1S        X2AD1S           70
     C                   MOVE      TCPNS         X2PNS            17
     C                   MOVE      TCPSS         X2PSS            35
     C                   MOVE      TCLKS         X2LKS            35
     C                   MOVE      TCTINK        X2TINK           17
     C                   MOVE      TCNAK         X2NAK            70
     C                   MOVE      TCAD1K        X2AD1K           70
     C                   MOVE      TCPNK         X2PNK            17
     C                   MOVE      TCPSK         X2PSK            35
     C                   MOVE      TCLKK         X2LKK            35
     C                   MOVE      TCTATY        X2TATY            2 0
     C                   MOVE      TCTAID        X2TAID           35
     C                   MOVE      TCTALK        X2TALK            2
     C                   MOVE      TCPDTY        X2PDTY            4
     C                   MOVE      TCPDRF        X2PDRF           70
     C                   MOVE      TCSDTY        X2SDTY            4
     C                   MOVE      TCSDRF        X2SDRF           70
     C                   MOVE      TCSDIN        X2SDIN           35
     C                   MOVE      TCTDTY        X2TDTY            4
     C                   MOVE      TCTDRF        X2TDRF           70
     C                   MOVE      TCADTY        X2ADTY            4
     C                   MOVE      TCADRF        X2ADRF           70
      *
     C                   MOVE      X1VKTB        NCVKTB
     C                   MOVE      X1TATY        NCTATY
     C                   MOVE      X1TAID        NCTAID
     C                   MOVE      X1TALK        NCTALK
     C                   MOVE      X1SDTY        NCSDTY
     C                   MOVE      X1SDRF        NCSDRF
     C                   MOVE      X1SDIN        NCSDIN
     C                   MOVE      X1TDTY        NCTDTY
     C                   MOVE      X1TDRF        NCTDRF
     C                   MOVE      X1ADTY        NCADTY
     C                   MOVE      X1ADRF        NCADRF
      *
     C                   MOVE      X2VKTB        TCVKTB
     C                   MOVE      X2SECI        TCSECI
     C                   MOVE      X2TINS        TCTINS
     C                   MOVE      X2NAS         TCNAS
     C                   MOVE      X2AD1S        TCAD1S
     C                   MOVE      X2PNS         TCPNS
     C                   MOVE      X2PSS         TCPSS
     C                   MOVE      X2LKS         TCLKS
     C                   MOVE      X2TINK        TCTINK
     C                   MOVE      X2NAK         TCNAK
     C                   MOVE      X2AD1K        TCAD1K
     C                   MOVE      X2PNK         TCPNK
     C                   MOVE      X2PSK         TCPSK
     C                   MOVE      X2LKK         TCLKK
     C                   MOVE      X2TATY        TCTATY
     C                   MOVE      X2TAID        TCTAID
     C                   MOVE      X2TALK        TCTALK
     C                   MOVE      X2PDTY        TCPDTY
     C                   MOVE      X2PDRF        TCPDRF
     C                   MOVE      X2SDTY        TCSDTY
     C                   MOVE      X2SDRF        TCSDRF
     C                   MOVE      X2SDIN        TCSDIN
     C                   MOVE      X2TDTY        TCTDTY
     C                   MOVE      X2TDRF        TCTDRF
     C                   MOVE      X2ADTY        TCADTY
     C                   MOVE      X2ADRF        TCADRF
      *
     C                   ENDSR
      *
      ***********************************************
     C     DLTOPL        BEGSR
      ***********************************************
      *
     C*    TRVK          SETLL     TRILMN
     C*    TRVK          READE     TRILMN                                 33
     C*    *IN33         DOWEQ     '0'
     C*    TVMN          IFEQ      *BLANKS
     C*                  DELETE    TRILMNR
     C*                  ELSE
     C*                  MOVE      TVMN          NVMN
     C*                  MOVE      TVMNSK        NVMNSK
     C*                  UPDATE    TRILMNR
     C*                  END
     C*    TRVK          READE     TRILMN                                 33
     C* N33              END
      *
     C                   ENDSR
      *
N01   ***********************************************
N01  C     SUMITEM       BEGSR
N01   ***********************************************
N01  C                   EVAL      *IN39=*OFF
N01  C                   EVAL      WTNLIT=*ZEROS
N01  C                   EVAL      WTNPNT=*ZEROS
N01  C     NCTSICK2      SETLL     NCTSII
N01  C     NCTSICK2      READE     NCTSII                                 39
N01  C  N39              EVAL      WTNLIT=TNLIT
N01  C                   DOW       *IN39 = *OFF
N01  C                   ADD       TNPNT         WTNPNT
N01  C     NCTSICK2      READE     NCTSII                                 39
N01  C                   ENDDO
N01  C                   ENDSR
