********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10004 * 01 YBC PTF10 LEVERANDØRSNR ER ØKT TIL 5.0
10004 * 02 SH  PTF10 NY DANGEROUS GOODS
10XXX * 03 YBC PTF10 VINDU FOR Å VISE OPPDRAG
10XXX * 04 YBC PTF10 RETT FEIL DSPISO
10XXX * 05 YBC PTF10 HENT UDS
10XXX * 06 SH  PTF10 farge varebeskrivelse dangerous goods
10XXX * 07 YBC PTF10 NY OPSJON FOR SIMULERING AV UTLEGG
10027 * 08 YBC PTF10 VIS ORDRETYPE
10XXX * 09 YBC PTF10 BEVARE UDS ETTER KALL PÅ SKILLEARK
10XXX * 10 YBC PTF10 SETT STARTVERDI PÅ SJEKKING AV ARKIVERTE DOK.
10XXX * 11 YBC PTF10 OPPDATER FAKTURA NÅR STATUS > 4
10XXX * 12 YBC PTF10 OPSJON 8,9 BRUKES IKKE, FJERNES
10217 * 13 YBC PTF10 FLERE DEFAULT PRINTER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 14 YBC PTF11 SØK PÅ ORDRE PÅ OPPRINNELIG LOKASJON
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED ORDRE
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 07 09-24
      *** LEDIGE INDIKATORER 31 32 34-37 60-89 95-97
      **************************************************************
      *
N07  FGSS052F   IF A E           K DISK    USROPN
     FGSSORFUP  UF   E           K DISK
     FGSSORF    IF   E           K DISK    RENAME(GSSORFR:GSSORF00)
     FGSSORL01  IF   E           K DISK    RENAME(GSSORFR:GSSORF01)
     FGSSORL02  IF   E           K DISK    RENAME(GSSORFR:GSSORF02)
     FGSSORL03  IF   E           K DISK    RENAME(GSSORFR:GSSORF03)
     FGSSORL04  IF   E           K DISK    RENAME(GSSORFR:GSSORF04)
     FGSSORL05  IF   E           K DISK    RENAME(GSSORFR:GSSORF05)
     FGSSORL06  IF   E           K DISK    RENAME(GSSORFR:GSSORF06)
     FGSSORL08  IF   E           K DISK    RENAME(GSSORFR:GSSORF08)
     FGSSORL13  IF   E           K DISK    RENAME(GSSORFR:GSSORF13)
     FGSSORL14  IF   E           K DISK    RENAME(GSSORFR:GSSORF14)
     FGSSORL15  IF   E           K DISK    RENAME(GSSORFR:GSSORF15)
     FGSSORL16  IF   E           K DISK    RENAME(GSSORFR:GSSORF16)
     FGSSORL27  IF   E           K DISK    RENAME(GSSORFR:GSSORF27)
     FGSSORL28  IF   E           K DISK    RENAME(GSSORFR:GSSORF28)
N14  FGSSORL33  IF   E           K DISK    RENAME(GSSORFR:GSSORF33)
N14  F                                     PREFIX(O3_)
N14  FGSSORL34  IF   E           K DISK    RENAME(GSSORFR:GSSORF34)
N14  F                                     PREFIX(O4_)
N14  FGSSORL35  IF   E           K DISK    RENAME(GSSORFR:GSSORF35)
N14  F                                     PREFIX(O5_)
     FGSSRFL01  IF   E           K DISK
     FHEADF     UF   E           K DISK
     FGSSPAF    UF   E           K DISK
     FGSSPOF    IF   E           K DISK
     FGSSPOL01  IF   E           K DISK    RENAME(GSSPOFR:GSSPOF01)
     FGSSPOL02  IF   E           K DISK    RENAME(GSSPOFR:GSSPOF02)
     FGSSBIF    IF   E           K DISK
     FGSSCGF    IF   E           K DISK
     FGSSOLF    IF   E           K DISK
     FGSSLGL03  UF   E           K DISK
     FGSSFGF    IF   E           K DISK
N02  FGSSDGF    IF   E           K DISK
     FARKIVL11  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FGSSSFF    IF   E           K DISK
     FGSS010D   CF   E             WORKSTN SFILE(GSS010DA:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  ORDTLÅ                 1      4  0
     D  ORDTLM                 5      6  0
     D  ORDTLD                 7      8  0
     D  ORDTL                  1      8  0
     D                 DS
     D  WXDTLD                 1      2  0
     D  WXDTLM                 3      4  0
     D  WXDTLÅ                 5      6  0
     D  WXDTL                  1      6  0
     D                 DS
     D  WSDTLD                 1      2  0
     D  WSDTLM                 3      4  0
     D  WSDTLÅ                 5      6  0
     D  WSDTL                  1      6  0
     D                 DS
     D  YDTLÅ                  1      4  0
     D  YDTLM                  5      6  0
     D  YDTLD                  7      8  0
     D  YDTL                   1      8  0
N14  D                 DS
N14  D  WSDTLORD               1      2  0
N14  D  WSDTLORM               3      4  0
N14  D  WSDTLORÅ               5      6  0
N14  D  WSDTLOR                1      6  0
N14  D                 DS
N14  D  YDTLORÅ                1      4  0
N14  D  YDTLORM                5      6  0
N14  D  YDTLORD                7      8  0
N14  D  YDTLOR                 1      8  0
     D                 DS
     D  WSDTLFD                1      2  0
     D  WSDTLFM                3      4  0
     D  WSDTLFÅ                5      6  0
     D  WSDTLF                 1      6  0
     D                 DS
     D  YDTLFÅ                 1      4  0
     D  YDTLFM                 5      6  0
     D  YDTLFD                 7      8  0
     D  YDTLF                  1      8  0
     D                 DS
     D  WSDTLTD                1      2  0
     D  WSDTLTM                3      4  0
     D  WSDTLTÅ                5      6  0
     D  WSDTLT                 1      6  0
     D                 DS
     D  YDTLTÅ                 1      4  0
     D  YDTLTM                 5      6  0
     D  YDTLTD                 7      8  0
     D  YDTLT                  1      8  0
     D                 DS
     D  POCONO                 1     20
     D  XPOCONO                1     19
     D                 DS
     D  ORDSC                  1     30
S08  D* WXDSC                  1     18
N08  D  WXDSC                  1     16
     D SAVUDS         UDS
     D  UFIRM                  1      2
     D  UBIUSI               101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
N13  D  UBIPRP               149    158
N13  D  UBIPRI               159    168
N07  D                SDS
N07  D  UUSER                254    263
      *
     C                   EXSR      INIT
     C   33              GOTO      SLUTT
     C     BG1           TAG
     C                   IF        ((*IN08 = '0') AND (*IN12 = '0'))
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   END
      *
     C     BG2           TAG
     C                   EXFMT     GSS010DX
     C                   MOVEA     '00'          *IN(98)
     C                   MOVE      '0'           *IN30
N14  C                   MOVE      '0'           *IN38
     C                   MOVEA     '0000000000'  *IN(40)
     C                   MOVEA     '000000000'   *IN(51)
     C                   MOVE      *BLANKS       XBCD              5
      *
     C   03              GOTO      SLUTT
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      BG2
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      BG2
     C                   MOVE      WSST          W2ST
      *
     C   42
     COR 52              EXSR      SUMVKT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN(93)
     C                   WRITE     GSS010DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *BLANKS       WSNR
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C                   EXSR      LESREC
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        8
     C                   ADD       1             ZRECNO
     C                   MOVE      ORDTLD        WXDTLD
     C                   MOVE      ORDTLM        WXDTLM
     C                   MOVE      ORDTLÅ        WXDTLÅ
     C                   MOVEL     ORSNM         WXSNM
     C   40              MOVEL     RFREF         WXDSC
     C     ORONO         CHAIN(N)  GSSPAF                             50
     C     *IN50         IFEQ      '1'
     C                   MOVE      'C'           PAPKD
     C                   END
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   WRITE     GSS010DA
     C                   MOVE      ZRECNO        XRECNO            5 0
     C                   EXSR      LESREC
     C  N94              END
     C                   END
      *
     C     START3        TAG
     C  N30              Z-ADD     6             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS010DG
     C                   ELSE
     C                   WRITE     GSS010DC
     C                   EXFMT     GSS010DB
     C                   END
      *
      *** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
      *
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTORD
     C                   GOTO      START3
     C                   END
     C   23              DO
     C     *IN95         IFEQ      '1'
     C                   SETOFF                                       95
     C                   ELSE
     C                   SETON                                        95
     C                   GOTO      START
     C                   ENDIF
     C                   ENDDO
     C   08
     COR 12              DO
     C                   Z-ADD     GMLIN         LINNBR
     C                   IF        (*IN49 OR *IN59)
     C                   Z-ADD     18            POSNBR
     C                   ELSE
     C                   Z-ADD     28            POSNBR
     C                   END
     C                   GOTO      BG1
     C                   END
N07  C   10              DO
N07  C                   CALL      'GSS052C'
N07  C                   GOTO      START
N07  C                   END
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C  N94XXONO         CHAIN(N)  GSSORFUP                           25
     C  N94GSPO2K        CHAIN     GSSPOF                             25
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      *BLANKS                                      1<-B
     C     W2ST          ORNE      WSST
     C     W2BCD         ORNE      *BLANKS
     C     W2CNO         ORNE      0
     C     W2SNO         ORNE      0
     C     W2DTL         ORNE      0
     C     W2ONO         ORNE      0
     C     W2LC          ORNE      *BLANKS
     C     W2CONO        ORNE      *BLANKS
     C     W2NR          IFEQ      *BLANKS                                       2<-B
     C                   EXSR      NYSØK
     C   30              GOTO      BG2
     C   42
     COR 52              EXSR      SUMVKT
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          COMP      '1'                                    06
     C   06              DO                                                       3<-B
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2ONO         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'GSS0025'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYOPT
     C                   END                                                      3<-E
     C                   MOVE      W2ST          WSST
     C                   MOVE      *BLANKS       W2BCD
     C                   MOVE      *ZEROS        W2CNO
     C                   MOVE      *ZEROS        W2SNO
     C                   MOVE      *ZEROS        W2DTL
     C                   MOVE      *ZEROS        W2ONO
     C                   MOVE      *BLANKS       W2LC
     C                   MOVE      *BLANKS       W2CONO
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HHENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     SØKUNR        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSCNO
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     c                   CALL      'GSS051R'
     c                   parm                    wscono
     c                   parm                    wscon2           20
      * ved tastet ordrenummer setter * i status
     C     WSONO         IFne      9999999
     C     WSONO         andgt     0
     C                   move      '*'           wsst
     C                   move      '*'           w2st
     C                   end
      * leser i fil1 eller 2 avhengig om søkebegrep finnes direkte
      *
     C     WSCONO        chain     gsspol01                           33
     c                   move      'N'           podir             1
     c  N33              move      'J'           podir             1
      *
     C     WSLC          IFNE      *BLANKS
     C     BILOC         ANDNE     *BLANKS
     C                   MOVE      BILOC         WSLC
     C                   END
      *
     C     WSBCD         IFEQ      *BLANKS
     C     WSCNO         ANDEQ     0
     C     WSSNO         ANDEQ     0
     C     WSSNMS        ANDEQ     *BLANKS
     C     WSDTL         ANDEQ     0
     C     WSONO         ANDEQ     0
     C     WSLC          ANDEQ     *BLANKS
     C     WSCONO        ANDEQ     *BLANKS
     C     WSKD          ANDEQ     *BLANKS
N14  C     WSLCOR        ANDEQ     *BLANKS
     C     XBCD          IFEQ      *BLANKS
     C                   MOVE      'GSS0024'     MSGNR
     C                   MOVE      '1'           *IN99
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLTB2
     C                   ELSE
     C                   MOVE      XBCD          WSBCD
     C                   END
     C                   END
      *
     C     WSCNO         IFEQ      0
     C     WSBCD         ANDNE     *BLANKS
     C     WSBCD         CHAIN     CDBOAT                             33
     C  N33CBKN          IFNE      0
     C                   MOVE      CBKN          WSCNO
     C                   END
     C                   END
      *
     C     UBICGR        IFNE      *BLANKS
     C     WSCNO         CHAIN     GSSCGF                             98
     C  N98UBICGR        COMP      CGCG                               9898
     C   98              DO
     C                   MOVE      'GSS0050'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLTB2
     C                   END
     C                   END
     C     UBICNO        IFNE      0
     C                   MOVE      UBICNO        WSCNO
     C                   END
      *
     C     STTB20        TAG
     C     WSST          COMP      '*'                                4141
     C  N41WSLC          IFNE      *BLANKS
     C     WSDTL         ANDNE     *ZEROS
     C                   MOVE      '1'           *IN45
     C                   GOTO      STTB23
     C                   END
     C   41              GOTO      STTB21
     C     UBICGR        IFNE      *BLANKS
     C     UBICNO        ORNE      0
     C                   MOVE      '1'           *IN43
     C                   GOTO      STTB23
     C                   END
     C     WSBCD         COMP      *BLANKS                            4242
     C   42WSDTL         IFEQ      0
     C                   GOTO      STTB23
     C                   ELSE
     C                   MOVE      '0'           *IN42
     C                   MOVE      '1'           *IN45
     C                   GOTO      STTB23
     C                   END
     C     WSLC          COMP      *BLANKS                            4747
     C   47              GOTO      STTB23
     C     WSCONO        COMP      *BLANKS                            4848
      *
     C   48              GOTO      STTB23
     C     WSCNO         COMP      *ZEROS                             4343
     C   43              GOTO      STTB23
     C     WSSNO         COMP      *ZEROS                             4444
     C   44              GOTO      STTB23
     C     WSSNMS        COMP      *BLANKS                            4949
     C   49              GOTO      STTB23
     C     WSDTL         COMP      *ZEROS                             4545
     C   45              GOTO      STTB23
     C     WSONO         IFEQ      9999999
     C                   MOVE      '1'           *IN56
     C                   GOTO      STTB23
     C                   ELSE
     C     WSONO         COMP      *ZEROS                             4646
     C   46              GOTO      STTB23
     C                   END
     C     WSKD          COMP      *BLANKS                            4040
     C   40              GOTO      STTB23
N14  C     WSLCOR        COMP      *BLANKS                            3838
N14  C   38              GOTO      STTB23
      *
      * KOMMER RETT HIT VED * I STATUS  41 ER PÅ
      *
     C     STTB21        TAG
     C     UBICGR        IFNE      *BLANKS
     C     UBICNO        ORNE      0
     C                   MOVE      '1'           *IN53
     C                   GOTO      STTB22
     C                   END
     C     WSBCD         COMP      *BLANKS                            5252
     C   52              GOTO      STTB22
     C     WSLC          COMP      *BLANKS                            5757
     C   57              GOTO      STTB22
     C     WSCONO        IFNE      *BLANKS
     C                   MOVE      '0'           *IN53
     C                   MOVE      '*'           WSST
     C                   MOVE      '*'           W2ST
     C                   GOTO      STTB20
     C                   END
     C     WSCNO         COMP      *ZEROS                             5353
     C   53              GOTO      STTB22
     C     WSSNO         COMP      *ZEROS                             5454
     C   54              GOTO      STTB22
     C     WSSNMS        COMP      *BLANKS                            5959
     C   59              GOTO      STTB22
     C     WSDTL         COMP      *ZEROS                             5555
     C   55              GOTO      STTB22
     C     WSKD          COMP      *BLANKS                            4040
     C   40              MOVE      '*'           WSST
     C   40              GOTO      STTB22
N14  C     WSLCOR        COMP      *BLANKS                            3838
N14  C   38              GOTO      STTB22
     C                   MOVE      '9999999'     WSONO
     C                   MOVE      '1'           *IN56
     C                   GOTO      STTB23
      *
     C     STTB22        TAG
     C                   MOVE      '0'           *IN41
      *
     C     STTB23        TAG
     C                   MOVE      WSST          YST
     C                   MOVE      WSBCD         YBCD
     C                   MOVE      WSCNO         YCNO
     C                   MOVE      WSSNO         YSNO
     C                   MOVE      WSSNMS        YSNM
     C                   MOVE      WSKD          YKD
     C                   MOVE      WSREF         YREF
     C     WSDTL         IFEQ      0
     C                   MOVE      *ZEROS        YDTL
     C                   ELSE
     C                   MOVE      WSDTLD        YDTLD
     C                   MOVE      WSDTLM        YDTLM
     C                   MOVE      WSDTLÅ        YDTLÅ
     C     WSDTLÅ        IFGT      50
     C                   MOVEL     '19'          YDTLÅ
     C                   ELSE
     C                   MOVEL     '20'          YDTLÅ
     C                   END
     C                   END
     C                   MOVE      WSONO         YONO
     C                   MOVE      WSLC          YLC
     C                   MOVE      WSCONO        YCONO
     C                   MOVE      WSCON2        YCON2
N14  C                   MOVE      WSLCOR        YLCOR
N14  C     WSDTLOR       IFEQ      0
N14  C                   MOVE      *ZEROS        YDTLOR
N14  C                   ELSE
N14  C                   MOVE      WSDTLORD      YDTLORD
N14  C                   MOVE      WSDTLORM      YDTLORM
N14  C                   MOVE      WSDTLORÅ      YDTLORÅ
N14  C     WSDTLORÅ      IFGT      50
N14  C                   MOVEL     '19'          YDTLORÅ
N14  C                   ELSE
N14  C                   MOVEL     '20'          YDTLORÅ
N14  C                   END
N14  C                   END
     C     CUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      *BLANKS       KNAVN
     C   33              MOVEL     '*UNKNOW'     KNAVN
     C     WSBCD         CHAIN     CDBOAT                             33
     C   33              MOVE      *BLANKS       CBNAB
     C   33              MOVEL     '*UNKNOW'     CBNAB
     C     WSSNO         CHAIN     GSSSFF                             33
     C  N33              MOVE      SFNM          WSSNM
     C   33              MOVE      *BLANKS       WSSNM
     C   33              MOVEL     '*UNKNOW'     WSSNM
     C   41              Z-ADD     4             GMLIN             3 0
     C   52              Z-ADD     11            GMLIN
     C   53              Z-ADD     14            GMLIN
     C   54              Z-ADD     15            GMLIN
     C   55              Z-ADD     16            GMLIN
     C   57              Z-ADD     12            GMLIN
     C   42              Z-ADD     11            GMLIN
     C   47              Z-ADD     12            GMLIN
     C   48              Z-ADD     13            GMLIN
     C   43              Z-ADD     14            GMLIN
     C   44              Z-ADD     15            GMLIN
     C   45              Z-ADD     16            GMLIN
     C   56
     COR 46              Z-ADD     17            GMLIN
     C   49
     COR 59              DO
     C                   Z-ADD     18            GMLIN
     C                   IF        WSDTLF = 0
     C                   EVAL      YDTLF = 0
     C                   ELSE
     C                   MOVE      WSDTLFD       YDTLFD
     C                   MOVE      WSDTLFM       YDTLFM
     C                   EVAL      YDTLFÅ = 2000 + WSDTLFÅ
     C                   END
     C                   IF        WSDTLT = 0
     C                   IF        WSDTLF = 0
     C                   EVAL      YDTLT = 99999999
     C                   ELSE
     C                   EVAL      YDTLT = YDTLF
     C                   END
     C                   ELSE
     C                   MOVE      WSDTLTD       YDTLTD
     C                   MOVE      WSDTLTM       YDTLTM
     C                   EVAL      YDTLTÅ = 2000 + WSDTLTÅ
     C                   END
     C                   END
     C   40              Z-ADD     20            GMLIN
N14  C   38              Z-ADD     21            GMLIN
     C*
     C     SLTB2         ENDSR
     C*
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   MOVE      WSST          XST               1
     C                   MOVE      WSBCD         XBCD              5
     C                   CLEAR                   GSS010DX
     C                   MOVE      XST           WSST
     C     W2ST          IFNE      WSST
     C                   MOVE      W2ST          WSST
     C                   END
     C     W2BCD         IFNE      *BLANKS
     C                   MOVE      W2BCD         WSBCD
     C                   END
     C     W2CNO         IFNE      0
     C                   MOVE      W2CNO         WSCNO
     C                   END
     C     W2SNO         IFNE      0
     C                   MOVE      W2SNO         WSSNO
     C                   END
     C     W2DTL         IFNE      0
     C                   MOVE      W2DTL         WSDTL
     C                   END
     C     W2ONO         IFNE      0
     C                   MOVE      W2ONO         WSONO
     C                   END
     C     W2LC          IFNE      *BLANKS
     C     BILOC         IFEQ      *BLANKS
     C                   MOVE      W2LC          WSLC
     C                   ELSE
     C                   MOVE      BILOC         WSLC
     C                   END
     C                   END
     C     W2CONO        IFNE      *BLANKS
     C                   MOVE      W2CONO        WSCONO
     C                   END
      *
     C                   MOVE      *BLANKS       W2BCD
     C                   MOVE      *ZEROS        W2CNO
     C                   MOVE      *ZEROS        W2SNO
     C                   MOVE      *ZEROS        W2DTL
     C                   MOVE      *ZEROS        W2ONO
     C                   MOVE      *BLANKS       W2LC
     C                   MOVE      *BLANKS       W2CONO
      *
N14  C                   MOVE      '0'           *IN38
     C                   MOVEA     '0000000000'  *IN(40)
     C                   MOVEA     '000000000'   *IN(51)
     C                   EXSR      TESTB
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYOPT         BEGSR
     C***********************************************
     C     W2ONO         CHAIN     GSSORF                             98
     C   98              MOVE      'GSS0026'     MSGNR
     C   98              GOTO      SLOPT
     C     UBICGR        IFNE      *BLANKS                                      1<-B
     C     ORCNO         CHAIN     GSSCGF                             98
     C  N98CGCG          COMP      UBICGR                             9898
     C   98              MOVE      'GSS0029'     MSGNR
     C   98              GOTO      SLOPT
     C                   END                                                    1<-E
     C     UBICNO        IFNE      0                                            1<-B
     C     UBICNO        ANDNE     ORCNO
     C                   MOVE      '1'           *IN98
     C                   MOVE      'GSS0030'     MSGNR
     C                   GOTO      SLOPT
     C                   END                                                    1<-E
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    '2'
     C     ORST          IFNE      '0'
     C     ORST          ANDNE     'P'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'GSS0027'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   EXSR      CHGORD
     C     W2NR          WHENEQ    '3'
     C                   EXSR      CPYORD
     C     W2NR          WHENEQ    '4'
     C                   EXSR      DLTORD
     C     W2NR          WHENEQ    '5'
     C                   EXSR      DSPORD
S12  C*    W2NR          WHENEQ    '8'
S12  C*                  EXSR      CSLORD
     C     W2NR          WHENEQ    'A'
     C                   EXSR      DOCUMO
     C     W2NR          WHENEQ    'U'
     C                   EXSR      UPLDOC
S12  C*    W2NR          WHENEQ    '9'
S12  C*                  EXSR      PICORD
     C     W2NR          WHENEQ    'P'
     C                   EXSR      PARORD
     C     W2NR          WHENEQ    'C'
     C                   EXSR      COMORD
N02  C     W2NR          WHENEQ    'D'
n02  C                   EXSR      DGSR
     C     W2NR          WHENEQ    'N'
     C                   EXSR      NCMORD
     C     W2NR          WHENEQ    'L'
     C                   EXSR      LOKORD
     C     W2NR          WHENEQ    'I'
     C                   EXSR      INVOIC
     C     W2NR          WHENEQ    'S'
     C                   EXSR      SYSPOR
     C     W2NR          WHENEQ    'E'
     C                   EXSR      EMAILO
      * Skriv Skanner skilleark (typen vil være privat/begynner på Z..)
     C     WSNR          WHENEQ    'B'
     C                   EXSR      SKILLE
      * Q = over til ISO
     C     WSNR          WHENEQ    'Q'
     C                   EXSR      DSPISO
     C                   OTHER
     C                   MOVE      'GSS0009'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDSL
      *
     C     SLOPT         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *BLANKS       W2NR
      *
     C                   ENDSR
      *
     C***********************************************
     C     HHENT         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVE      '0'           *IN99
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS010DA                               98
     C   98              DO
     C   99              MOVE      '0'           *IN98
     C                   GOTO      SLHENT
     C                   END
      *
     C     ZRECNO        DIV       8             LINNBR
     C                   MVR                     XLIN              1 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     21            LINNBR
     C                   ELSE
     C     XLIN          MULT      2             LINNBR
     C                   ADD       5             LINNBR
     C                   END
      *
     C                   SELECT
     C     WSNR          WHENEQ    '2'
     C     ORST          IFNE      '0'
     C     ORST          ANDNE     'P'
     C                   MOVE      '1'           *IN98
     C                   MOVE      'GSS0027'     MSGNR
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS010DA
     C                   GOTO      SLHENT
     C                   END
     C                   EXSR      CHGORD
     C     WSNR          WHENEQ    '3'
     C                   EXSR      CPYORD
     C     WSNR          WHENEQ    '4'
     C                   EXSR      DLTORD
     C     WSNR          WHENEQ    '5'
     C                   EXSR      DSPORD
S12  C*    WSNR          WHENEQ    '8'
S12  C*                  EXSR      CSLORD
S12  C*    WSNR          WHENEQ    '9'
S12  C*                  EXSR      PICORD
     C     WSNR          WHENEQ    'P'
     C                   EXSR      PARORD
     C     WSNR          WHENEQ    'C'
     C                   EXSR      COMORD
N02  C     WSNR          WHENEQ    'D'
n02  C                   EXSR      DGSR
     C     WSNR          WHENEQ    'N'
     C                   EXSR      NCMORD
     C     WSNR          WHENEQ    'L'
     C                   EXSR      LOKORD
     C     WSNR          WHENEQ    'I'
     C                   EXSR      INVOIC
     C     WSNR          WHENEQ    'S'
     C                   EXSR      SYSPOR
     C     WSNR          WHENEQ    'T'
     C                   EXSR      SECURE
     C     WSNR          WHENEQ    'E'
     C                   EXSR      EMAILO
     C     WSNR          WHENEQ    'A'
     C                   EXSR      DOCUMO
     C     WSNR          WHENEQ    'U'
     C                   EXSR      UPLDOC
      * Skriv Skanner skilleark (typen vil være privat/begynner på Z..)
     C     WSNR          WHENEQ    'B'
     C                   EXSR      SKILLE
      * Q = ISO
     C     WSNR          WHENEQ    'Q'
     C                   EXSR      DSPISO
N07  C     WSNR          WHENEQ    'G'
N07  C                   EXSR      DSPINV
     C                   OTHER
     C                   MOVE      '1'           *IN98
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS010DA
     C                   GOTO      SLHENT
     C                   ENDSL
     C                   MOVE      '1'           *IN99
      *
     C                   END
      *
     C     SLHENT        TAG
     C                   MOVE      '0'           *IN99
     C   98MSGNR         IFEQ      *BLANKS
     C                   MOVE      'GSS0009'     MSGNR
     C                   END
     C   98              MOVE      '1'           *IN30
     C  N30              Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
N05  C                   MOVE      FIFIRM        UFIRM
N05  C                   MOVE      BICGR         UBICGR
N05  C                   MOVE      BICNO         UBICNO
N05  C                   MOVE      BIFC          UBIFC
N05  C                   MOVE      BIPRT         UBIPRT
N05  C                   MOVE      BIPRTM        UBIPRM
N13  C                   MOVE      BIPRTP        UBIPRP
N13  C                   MOVE      BIPRTI        UBIPRI
N05  C                   OUT       SAVUDS
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C   41GORK01        SETGT     GSSORL01
     C   42GORK02        SETGT     GSSORL08
     C   43GORK03        SETGT     GSSORL13
     C   44GORK04        SETGT     GSSORL14
     C   45GORK05        SETLL     GSSORL15
     C   46GORKEY        SETLL     GSSORF
     C   47GORK06        SETGT     GSSORL16
     C   48GPOK01        SETLL     GSSPOL01
     C   48GPOK02        SETLL     GSSPOL02
     C   49GORK28        SETLL     GSSORL28
     C   40GRFK01        SETLL     GSSRFL01
     c   52wslc          ifeq      *blanks
     C     GORK12        SETGT     GSSORL02
     c                   else
     C     wsdtl         ifeq      *zeros
     C     GORK12B       SETGT     GSSORL02
     c                   else
     C     GORK12B       SETLL     GSSORL02
     c                   end
     c                   end
     C   53GORK13        SETGT     GSSORL03
     C   54GORK14        SETGT     GSSORL04
     C   55GORK15        SETLL     GSSORL05
     C   56GORKEY        SETGT     GSSORF
     C   57GORK16        SETGT     GSSORL06
     C   59GORK27        SETLL     GSSORL27
N14  C                   IF        *IN38
N14  C     GORK3X        SETLL     GSSORL33
N14  C     GORK3X        SETLL     GSSORL34
N14  C     GORK3X        SETLL     GSSORL35
N14  C                   MOVE      'J'           XLES33            1
N14  C                   MOVE      'J'           XLES34            1
N14  C                   MOVE      'J'           XLES35            1
N14  C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
     C     STLF          TAG
     C   41GORK01        READPE    GSSORL01                               94
     C   42GORK02        READPE    GSSORL08                               94
     c     *in42         ifeq      '1'
     c     *in94         andeq     '0'
     c     wsport        andne     *blanks
     c     wsport        andne     orport
     c                   goto      stlf
     c                   end
     C   43GORK03        READPE    GSSORL13                               94
     C   44GORK04        READPE    GSSORL14                               94
     C   45              READ      GSSORL15                               94
     C   46              READ      GSSORF                                 94
     C   47GORK06        READPE    GSSORL16                               94
     c   48podir         ifeq      'J'
     C                   READ      GSSPOL01                               94
     c                   else
     C                   READ      GSSPOL02                               94
     c                   end
      *
     C   49              READ      GSSORL28                               94
     C   40WSKD          READE     GSSRFL01                               94
     C   52wsdtl         ifeq      *zeros
     C   52GORK12        READPE    GSSORL02                               94
     C                   else
     C   52GORK12        READE     GSSORL02                               94
     c                   end
     C   53GORK13        READPE    GSSORL03                               94
     C   54GORK14        READPE    GSSORL04                               94
     C   55YST           READE     GSSORL05                               94
     C   56              READP     GSSORF                                 94
     C   57GORK16        READPE    GSSORL06                               94
     C   59GORK01        READE     GSSORL27                               94
N14  C                   IF        *IN38
N14  C                   IF        XLES33 = 'J'
N14  C     WSLCOR        READE     GSSORL33                               33
N14  C   33              EVAL      XLES33 = 'X'
N14  C   33              EVAL      O3_ORDTL = 99999999
N14  C                   END
N14  C                   IF        XLES34 = 'J'
N14  C     WSLCOR        READE     GSSORL34                               33
N14  C   33              EVAL      XLES34 = 'X'
N14  C   33              EVAL      O4_ORDTL2 = 99999999
N14  C                   END
N14  C                   IF        XLES35 = 'J'
N14  C     WSLCOR        READE     GSSORL35                               33
N14  C   33              EVAL      XLES35 = 'X'
N14  C   33              EVAL      O5_ORDTL3 = 99999999
N14  C                   END
N14  C                   IF        XLES33='X' AND XLES34='X' AND XLES35='X'
N14  C                   EVAL      *IN94 = *ON
N14  C                   END
N14  C                   IF        *IN94 = *OFF
N14  C                   SELECT
N14  C                   WHEN      O3_ORDTL<=O4_ORDTL2 AND O3_ORDTL<=O5_ORDTL3
N14  C     O3_ORONO      CHAIN     GSSORF                             33
N14  C                   EVAL      XLES33 = 'J'
N14  C                   IF        XLES34 <> 'X'
N14  C                   EVAL      XLES34 = 'N'
N14  C                   END
N14  C                   IF        XLES35 <> 'X'
N14  C                   EVAL      XLES35 = 'N'
N14  C                   END
N14  C                   WHEN      O4_ORDTL2<=O5_ORDTL3
N14  C     O4_ORONO      CHAIN     GSSORF                             33
N14  C                   EVAL      XLES34 = 'J'
N14  C                   IF        XLES33 <> 'X'
N14  C                   EVAL      XLES33 = 'N'
N14  C                   END
N14  C                   IF        XLES35 <> 'X'
N14  C                   EVAL      XLES35 = 'N'
N14  C                   END
N14  C                   OTHER
N14  C                   EVAL      XLES35 = 'J'
N14  C                   IF        XLES33 <> 'X'
N14  C                   EVAL      XLES33 = 'N'
N14  C                   END
N14  C                   IF        XLES34 <> 'X'
N14  C                   EVAL      XLES34 = 'N'
N14  C                   END
N14  C     O5_ORONO      CHAIN     GSSORF                             33
N14  C                   ENDSL
N14  C                   IF        WSLCOR2 <> *BLANKS AND WSLCOR2 <> ORLC
N14  C                   GOTO      STLF
N14  C                   END
N14  C                   END
N14  C                   END
      *
     C  N94              DO
     C   48POONO         CHAIN     GSSORF                             33
     C   40RFONO         CHAIN     GSSORF                             33
     C  N48GSSPOK        CHAIN     GSSPOF                             33
     C                   SELECT
      * kun blank ved N
     C     WSRTNG        WHENEQ    'N'
     C     ORRTNG        CABEQ     'R'           STLF
     C     ORRTNG        CABEQ     'S'           STLF
      * kun R ved R
     C     WSRTNG        WHENEQ    'R'
     C     ORRTNG        CABNE     'R'           STLF
      * kun S ved S
     C     WSRTNG        WHENEQ    'S'
     C     ORRTNG        CABNE     'S'           STLF
     C                   ENDSL
     C  N48
     CAN 33              MOVE      *BLANKS       POCONO
     C  N42
     CANN52WSBCD         IFNE      *BLANKS
     C     WSBCD         ANDNE     ORBCD
     C                   GOTO      STLF
     C                   END
     c   52wsport        ifne      *blanks
     c     wsport        andne     orport
     c                   goto      stlf
     c                   end
     C  N47
     CANN57WSLC          IFNE      *BLANKS
     C     WSLC          ANDNE     ORLC
     C                   GOTO      STLF
     C                   END
     C  N48WSCONO        IFNE      *BLANKS
     c     wscono        ifne      pocono
     c     wscon2        andne     pocon2
     C                   GOTO      STLF
     C                   END
     C                   END
     C  N43
     CANN53WSCNO         IFNE      0
     C     WSCNO         ANDNE     ORCNO
     C                   GOTO      STLF
     C                   END
     C  N44
     CANN54WSSNO         IFNE      0
     C     WSSNO         ANDNE     ORSNO
     C                   GOTO      STLF
     C                   END
     C  N45
     CANN55WSDTL         IFNE      0
     C     YDTL          ANDGT     ORDTL
     C                   GOTO      STLF
     C                   END
     C     BILOC         IFNE      *BLANKS
     C     BILOC         ANDNE     ORLC
     C                   GOTO      STLF
     C                   END
     C   49
     COR 59ORDTL         IFLT      YDTLF
     C     ORDTL         ORGT      YDTLT
     C                   GOTO      STLF
     C                   END
     C                   MOVE      ORONO         XXONO             7 0
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SUMVKT        BEGSR
     C***********************************************
     C     GORKSV        KLIST
     C                   KFLD                    YST2              1
     C                   KFLD                    YBCD
      *
     C                   MOVE      '1'           YST2
     C                   MOVE      *ZEROS        WSWT
     C     GORKSV        SETLL     GSSORL02                           33
     C     STSUMV        TAG
     C     GORKSV        READE     GSSORL02                               33
     C     *IN33         IFEQ      '0'
     C                   ADD       ORWT          WSWT
     C                   GOTO      STSUMV
     C                   ELSE
     C     YST2          IFEQ      '1'
     C                   MOVE      '2'           YST2
     C                   GOTO      STSUMV
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     GORK01        KLIST
     C                   KFLD                    YST
     C     *LIKE         DEFINE    ORST          YST
     C     GORK02        KLIST
     C                   KFLD                    YBCD
     C     *LIKE         DEFINE    ORBCD         YBCD
     C     GORK03        KLIST
     C                   KFLD                    YCNO
     C     *LIKE         DEFINE    ORCNO         YCNO
     C     GORK04        KLIST
     C                   KFLD                    YSNO
     C     *LIKE         DEFINE    ORSNO         YSNO
     C     GORK05        KLIST
     C                   KFLD                    YDTL
     C     GORKEY        KLIST
     C                   KFLD                    YONO
     C     *LIKE         DEFINE    ORONO         YONO
     C     GORK06        KLIST
     C                   KFLD                    YLC
     C     *LIKE         DEFINE    ORLC          YLC
     C     GORK12        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YBCD
     C     GORK12B       KLIST
     C                   KFLD                    YST
     C                   KFLD                    YBCD
     C                   KFLD                    YLC
     C     GORK13        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YCNO
     C     GORK14        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YSNO
     C     GORK15        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YDTL
     C     GORK16        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YLC
     C     GORK27        KLIST
     C                   KFLD                    YST
     C                   KFLD                    YSNM
     C                   KFLD                    YDTLF
     C     GORK28        KLIST
     C                   KFLD                    YSNM
     C                   KFLD                    YDTLF
N14  C     GORK3X        KLIST
N14  C                   KFLD                    YLCOR
N14  C                   KFLD                    YDTLOR
N14  C     *LIKE         DEFINE    ORLC          YLCOR
     C     *LIKE         DEFINE    ORSNM         YSNM
     C     GRFK01        KLIST
     C                   KFLD                    YKD
     C                   KFLD                    YREF
     C     *LIKE         DEFINE    RFKD          YKD
     C     *LIKE         DEFINE    RFREF         YREF
     C     GPOK01        KLIST
     C                   KFLD                    YCONO
     C     *LIKE         DEFINE    POCONO        YCONO
     C     GPOK02        KLIST
     C                   KFLD                    YCON2
     C     *LIKE         DEFINE    POCONO        YCON2
     C     GSSPOK        KLIST
     C                   KFLD                    ORONO
     C                   KFLD                    YLNO
     C     GSPO2K        KLIST
     C                   KFLD                    XXONO
     C                   KFLD                    YLNO
     C     GSPO3K        KLIST
     C                   KFLD                    UONO
     C                   KFLD                    YLNO
     C     *LIKE         DEFINE    POLNO         YLNO
     C                   Z-ADD     1             YLNO
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSCNO
     C     GSSLGL03K1    KLIST
     C                   KFLD                    XLGFTYP1
     C                   KFLD                    OLONO
     C                   KFLD                    LGLNO
     C                   MOVE      'UNSEC'       XLGFTYP1          5
     C     GSSLGL03K2    KLIST
     C                   KFLD                    XLGFTYP2
     C                   KFLD                    OLONO
     C                   KFLD                    LGLNO
     C                   MOVE      'SECUR'       XLGFTYP2          5
     C     GSSLGL03K3    KLIST
     C                   KFLD                    XLGFTYP3
     C                   KFLD                    ORONO
     C                   MOVE      'UNSEC'       XLGFTYP3          5
      *
     C     KEYS11        KLIST
     C                   KFLD                    ARSTAT
     C                   KFLD                    URUNDE           10
     C                   MOVE      'A'           ARSTAT
     C                   MOVEL     'SS:'         URUNDE
      *
     C     UBIUSI        CHAIN     GSSBIF                             33
     C     *IN33         IFEQ      '0'
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      *ZEROS        WSDTL
     C                   MOVE      *ZEROS        WXDTL
     C                   MOVE      *ZEROS        ORDTL
     C                   MOVE      *ZEROS        YDTL
     C                   MOVE      *ZEROS        WSDTLF
     C                   MOVE      *ZEROS        WSDTLT
     C                   MOVE      *ZEROS        YDTLF
     C                   MOVE      *ZEROS        YDTLT
N14  C                   MOVE      *ZEROS        WSDTLOR
N14  C                   MOVE      *ZEROS        YDTLOR
     C                   MOVE      '0'           WSST
     C     *DTAARA       DEFINE    *LDA          SAVUDS
     C                   IN        SAVUDS
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      BICGR         UBICGR
     C                   MOVE      BICNO         UBICNO
     C                   MOVE      BIFC          UBIFC
     C                   MOVE      BIPRT         UBIPRT
     C                   MOVE      BIPRTM        UBIPRM
N13  C                   MOVE      BIPRTP        UBIPRP
N13  C                   MOVE      BIPRTI        UBIPRI
     C                   OUT       SAVUDS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG            1 0
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     30
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSBCD
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     35
     C                   EXSR      SØKUNR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     28
S01  C*    POSNBR        ANDLE     30
N01  C     POSNBR        ANDLE     32
     C                   CALL      'GSS005R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSSNO
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   MOVEL     'SSORDREF'    UTYP             10
     C                   MOVE      'N'           UUPDAT            1
     C                   CALL      'SYKUKD'
     C                   PARM                    UTYP
     C                   PARM                    UUPDAT
     C                   PARM                    WSKD
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'GSS0013'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     CRTORD        BEGSR
     C***********************************************
     C                   MOVE      'CRT'         UTYPE             3
     C                   MOVE      *ZEROS        UONO
     C     *LIKE         DEFINE    ORONO         UONO
      *
     C     BILOC         IFEQ      *BLANKS
     C                   MOVE      WSLC          ULC               5
     C                   ELSE
     C                   MOVE      BILOC         ULC
     C                   END
     C                   CALL      'GSS011R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    WSBCD
     C                   PARM                    WSCNO
     C                   PARM                    WSSNO
     C                   PARM                    ULC
      *
     C                   MOVE      '1'           *IN90
     C                   EXSR      VISORD
     C                   MOVE      '0'           *IN90
      *
     C                   ENDSR
      *
     C***********************************************
     C     VISORD        BEGSR
     C***********************************************
     C     UONO          IFNE      0                                            1<-B
     C     GSPO3K        CHAIN     GSSPOF                             33
     C     UONO          CHAIN(N)  GSSORFUP                           33
     C     *IN33         IFEQ      '0'                                           2<-B
     C                   MOVE      ORDTLD        WXDTLD
     C                   MOVE      ORDTLM        WXDTLM
     C                   MOVE      ORDTLÅ        WXDTLÅ
     C                   MOVEL     ORSNM         WXSNM
     C     *IN90         IFEQ      '1'                                            3<-B
     C                   ADD       1             XRECNO
     C                   MOVE      XRECNO        ZRECNO
     C     ORONO         CHAIN(N)  GSSPAF                             50
     C     *IN50         IFEQ      '1'
     C                   MOVE      'C'           PAPKD
     C                   END
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   WRITE     GSS010DA
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     *IN90         IFEQ      '0'                                          1<-B
     C                   MOVE      *BLANKS       WSNR
     C     ORONO         CHAIN(N)  GSSPAF                             50
     C     *IN50         IFEQ      '1'
     C                   MOVE      'C'           PAPKD
     C                   END
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C                   MOVE      'CHG'         UTYPE             3
     C                   MOVE      ORONO         UONO
      *
     C                   CALL      'GSS011R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    WSBCD
     C                   PARM                    WSCNO
     C                   PARM                    WSSNO
     C                   PARM                    WSLC
      *
     C  N90              EXSR      VISORD
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYORD        BEGSR
     C***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      '1'           *IN99
     C                   MOVE      *BLANKS       WSNR
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
      *
     C                   MOVE      'CPY'         UTYPE             3
     C                   MOVE      ORONO         UONO
     C                   CALL      'GSS011R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    WSBCD
     C                   PARM                    WSCNO
     C                   PARM                    WSSNO
     C                   PARM                    WSLC
      *
     C  N90UONO          IFNE      0
     C                   MOVE      '1'           *IN90
     C                   EXSR      VISORD
     C                   MOVE      '0'           *IN90
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C                   exfmt     SLETT
     C     *IN23         ifeq      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS010DA
     c                   else
     C     ORONO         CHAIN     GSSORFUP                           33
     C  N33ORST          IFEQ      '0'
     C     ORST          OREQ      'P'
     C                   MOVE      'D'           ORST
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   END
     C  N33              UPDATE    GSSORFR
     C                   end
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPORD        BEGSR
     C***********************************************
     C     *IN90         IFEQ      '0'
     C                   MOVE      '1'           *IN99
     C                   MOVE      *BLANKS       WSNR
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
      *
     C                   MOVE      'DSP'         UTYPE             3
     C                   MOVE      ORONO         UONO
     C                   CALL      'GSS011R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    WSBCD
     C                   PARM                    WSCNO
     C                   PARM                    WSSNO
     C                   PARM                    WSLC
      *
     C                   ENDSR
      *
     C***********************************************
     C     PICORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C     ORONO         CHAIN     GSSORFUP                           33
     C  N33ORST          IFEQ      '0'
     C                   MOVE      '1'           ORST
     C                   ADD       ORWT          WSWT
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   END
     C  N33              UPDATE    GSSORFR
      *
      *
     C                   ENDSR
      *
     C***********************************************
     C     CSLORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C     ORONO         CHAIN     GSSORFUP                           33
     C  N33ORST          IFEQ      '1'
     C                   MOVE      '0'           ORST
     C                   MOVE      *ZEROS        ORTNO
     C                   SUB       ORWT          WSWT
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C     ORST          COMP      '1'                                    50
     C   50ORTNO         COMP      0                                      50
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   END
     C  N33              UPDATE    GSSORFR
      *
     C                   ENDSR
      *
     C***********************************************
     C     PARORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C     ORONO         CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'P'           PAPKD
     C                   UPDATE    GSSPAFR
     C                   CALL      'GSS010RA'
     C                   PARM      ORONO         UONO
     C                   PARM                    ORBCD
     C                   PARM                    POCONO
     C                   PARM                    PAPKD
     C                   END
      *
     C  N90              EXSR      VISORD
      *
     C                   ENDSR
      *
     C***********************************************
     C     COMORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C                   MOVE      ORONO         UONO
     C     ORONO         CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'C'           PAPKD
     C                   UPDATE    GSSPAFR
     C                   CALL      'GSS010RA'
     C                   PARM      ORONO         UONO
     C                   PARM                    ORBCD
     C                   PARM                    POCONO
     C                   PARM                    PAPKD
     C                   END
      *
     C  N90              EXSR      VISORD
      *
     C                   ENDSR
      *
     C***********************************************
     C     NCMORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C                   MOVE      ORONO         UONO
     C     ORONO         CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      ' '           PAPKD
     C                   UPDATE    GSSPAFR
     C                   CALL      'GSS010RA'
     C                   PARM      ORONO         UONO
     C                   PARM                    ORBCD
     C                   PARM                    POCONO
     C                   PARM                    PAPKD
     C                   END
      *
     C  N90              EXSR      VISORD
      *
     C                   ENDSR
      *
     C***********************************************
     C     LOKORD        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C     ORST          IFEQ      '0'
     C                   MOVE      'CHG'         UTYPE
     C                   ELSE
     C                   MOVE      'DSP'         UTYPE
     C                   END
     C                   CALL      'GSS018R'
     C                   PARM      ORONO         UONO
     C                   PARM                    UTYPE
     C                   PARM                    ORPOS1
     C                   PARM                    ORCLI
      *
     C  N90              EXSR      VISORD
      *
     C                   ENDSR
      *
     C***********************************************
     C     INVOIC        BEGSR
     C***********************************************
     C                   MOVE      'DSP'         UTYPE
     C     ORST          IFGE      '0'
     C     ORST          ANDLE     '6'
     C                   MOVE      'CHG'         UTYPE
     C                   END
     C     ORST          IFEQ      'P'
     C                   MOVE      'CHG'         UTYPE
     C                   END
     C                   CALL      'GSS012R'
     C                   PARM      ORONO         UONO
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
N11   *
N11  C                   IF        ORST >= '4'
N11  C                   CALL      'GSS032R'
N11  C                   PARM      ORTNO         UTNO             11 0
N11  C                   PARM      ORONO         UONO
N11  C                   END
N11   *
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   ENDSR
N02  C***********************************************
N02  C     DGSR          BEGSR
N02  C***********************************************
N02  C                   CALL      'GSS075R'
N02  C                   PARM      ORONO         UONO
N02  C     *IN90         IFEQ      '0'
N02  C                   MOVE      *BLANKS       WSNR
N02  C                   UPDATE    GSS010DA
N02  C                   END
N02  C                   ENDSR
     C***********************************************
     C     SYSPOR        BEGSR
     C***********************************************
     C                   CLEAR                   BILDE01
     C                   Z-ADD     0             ANTOR             1 0
     C     HEAKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
      * ORDRE 1
      *
     C     ORTNO         IFNE      *ZEROS
     C                   MOVEL     ORTNO         HEAVD
     C                   MOVE      ORTNO         HEOPD
     C     HEAKEY        CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '0'
     C                   MOVE      HEUR          SYDEN1
     C                   MOVEL     ORTNO         SYAVD1
     C                   MOVE      ORTNO         SYORD1
     C                   ADD       1             ANTOR
     C                   END
     C                   END
      *
      * ORDRE 2
      *
     C     ORTNO2        IFNE      *ZEROS
     C                   MOVEL     ORTNO2        HEAVD
     C                   MOVE      ORTNO2        HEOPD
     C     HEAKEY        CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '0'
     C                   MOVE      HEUR          SYDEN2
     C                   MOVEL     ORTNO2        SYAVD2
     C                   MOVE      ORTNO2        SYORD2
     C                   ADD       1             ANTOR
     C                   END
     C                   END
      *
      * ORDRE 3
      *
     C     ORTNO3        IFNE      *ZEROS
     C                   MOVEL     ORTNO3        HEAVD
     C                   MOVE      ORTNO3        HEOPD
     C     HEAKEY        CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '0'
     C                   MOVE      HEUR          SYDEN3
     C                   MOVEL     ORTNO3        SYAVD3
     C                   MOVE      ORTNO3        SYORD3
     C                   ADD       1             ANTOR
     C                   END
     C                   END
      * INGEN ORDRE FUNNET
     C     ANTOR         IFEQ      0
     C                   GOTO      UTSYSP
     C                   END
      *
     C     ANTOR         IFGT      1
S03  C*                  WRITE     WINDOWSZ
     C     VELTAG        TAG
     C                   EXFMT     BILDE01
     C   12              GOTO      UTSYSP
     C     SYVEL1        IFEQ      '1'
     C                   MOVEL     ORTNO         HEAVD
     C                   MOVE      ORTNO         HEOPD
     C                   MOVE      SYDEL1        UUR               1
     C                   ELSE
     C     SYVEL2        IFEQ      '1'
     C                   MOVEL     ORTNO2        HEAVD
     C                   MOVE      ORTNO2        HEOPD
     C                   MOVE      SYDEL2        UUR               1
     C                   ELSE
     C     SYVEL3        IFEQ      '1'
     C                   MOVEL     ORTNO3        HEAVD
     C                   MOVE      ORTNO3        HEOPD
     C                   MOVE      SYDEL2        UUR               1
     C                   ELSE
     C                   GOTO      VELTAG
     C                   END
     C                   END
     C                   END
     C                   END
     C     HEAKEY        CHAIN(N)  HEADF                              33
      * VED HEUR = S MÅ DELSYSTEM VELGES
     C     *IN33         IFEQ      '0'
     C     HEUR          IFEQ      'S'
     C     UUR           ANDEQ     ' '
     C                   GOTO      VELTAG
     C                   END
     C     HEST          IFNE      'X'
     C                   MOVE      'CHG'         UTYPE             3
     C                   MOVE      HEAVD         UAVD2             4 0
     C                   MOVE      HEOPD         UOPD2             7 0
     C                   MOVE      HESG          USG2              3
      *
      *
     C     HEAKEY        CHAIN     HEADF                              33
     C                   MOVE      HEST          XST               1
     C     HEST          IFNE      'C'
     C     HEST          ANDNE     'U'
     C                   MOVE      ' '           HEST
     C                   END
     C  N33              EXCEPT    NYOPDS
      *
     C                   EXSR      WRKOPD
      *
     C     HEAKEY        CHAIN     HEADF                              33
     C     XST           IFEQ      'U'                                          1<-B
     C     HEOT          ANDNE     *BLANKS
     C                   MOVE      ' '           HEST
     C                   ELSE                                                   1
     C                   MOVE      XST           HEST
     C                   END                                                    1<-E
     C  N33              EXCEPT    NYOPDS
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   END
     C                   END
     C     UTSYSP        ENDSR
      *
     C***********************************************
     C     SECURE        BEGSR
     C***********************************************
     C  N90              MOVE      '1'           *IN99
     C     GSSLGL03K3    SETLL     GSSLGL03
     C     GSSLGL03K3    READE     GSSLGL03                               33
     C                   DOW       *IN33 = *OFF
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           LGHDT
     C                   MOVE      WTM           LGHTID
     C                   MOVE      'SECUR'       LGFTYP
     C                   UPDATE    GSSLGFR
     C     GSSLGL03K3    READE     GSSLGL03                               33
     C                   ENDDO
      *
     C  N90              EXSR      VISORD
      *
     C                   ENDSR
      *
      ***********************************************
     C     WRKOPD        BEGSR
      ***********************************************
     C                   MOVE      ' '           UKODE             1
     C                   MOVE      ' '           UDUMMY            1
     C                   MOVE      *ZEROS        UAVDNY            4 0
      *
     C                   SELECT
      * LAND IMPORT
     C     HEUR          WHENEQ    'A'
     C                   CALL      'SYFA10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE             1
     C                   PARM                    UDUMMY            1
     C                   PARM                    UAVDNY
      * LAND EXPORT
     C     HEUR          WHENEQ    'B'
     C                   CALL      'SYEX10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY
     C                   PARM                    UAVDNY
      * FLY IMPORT
     C     HEUR          WHENEQ    'C'
     C                   CALL      'SYFI10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * FLY EXPORT
     C     HEUR          WHENEQ    'D'
     C                   CALL      'SYEF10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * FLY INNLAND
     C     HEUR          WHENEQ    'E'
     C                   CALL      'SYIN10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * SJØ IMPORT
     C     HEUR          WHENEQ    'F'
     C                   CALL      'SYSJ10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      * SJØ EXPORT
     C     HEUR          WHENEQ    'G'
     C                   CALL      'SYSE10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
      *
      * BÅT
     C     HEUR          WHENEQ    'S'
      * FRA LAND EXPORT
     C     UUR           IFEQ      'B'
     C                   CALL      'SYEX10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY
     C                   PARM                    UAVDNY
     C                   ENDIF                                                  <UUR
      * FRA FLY EXPORT
     C     UUR           IFEQ      'D'
     C                   CALL      'SYEF10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
     C                   ENDIF                                                  <UUR
      * FRA SJØ EXPORT
     C     UUR           IFEQ      'G'
     C                   CALL      'SYSE10'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
     C                   PARM                    USG2
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UAVDNY
     C                   ENDIF                                                  <UUR
     C                   ENDSL
      *
     C                   ENDSR
     C***********************************************
     C     EMAILO        BEGSR
     C***********************************************
     C                   MOVE      ORONO         AAONO             7
     C                   MOVE      ORCNO         AASNO             8
     C                   CALL      'GSS043A'
     C                   PARM                    AAONO
     C                   PARM                    AASNO
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   ENDSR
     C***********************************************
     C     DOCUMO        BEGSR
     C***********************************************
     C                   MOVE      ORONO         URUNDE           10
     C                   MOVEL     'SS:'         URUNDE
     C                   CALL      'ARC003'
     C                   PARM                    avd               4 0
     C                   PARM                    opd               7 0
     C                   PARM                    urunde
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
     C                   ENDSR
      ***********************************************
     C     UPLDOC        BEGSR
      ***********************************************
     C                   MOVE      ORONO         URUNDE           10
     C                   MOVEL     'SS:'         URUNDE
     C                   CALL      'ARC021'
     C                   PARM                    avd               4 0
     C                   PARM                    opd               7 0
     C                   PARM                    urunde
     C                   IF        *IN90 = '0'
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
      *
     C                   ENDSR
      *
N07   ***********************************************
N07  C     DSPINV        BEGSR
N07   ***********************************************
N07  C     GSS052FK      KLIST
N07  C                   KFLD                    G52USE
N07  C                   KFLD                    G52ONO
N07  C                   OPEN      GSS052F
N07  C                   EVAL      G52USE = UUSER
N07  C                   EVAL      G52ONO = ORONO
N07  C     GSS052FK      CHAIN     GSS052F                            33
N07  C   33              WRITE     GSS052FR
N07  C                   CLOSE     GSS052F
N07  C                   MOVE      *BLANKS       WSNR
N07  C                   EXSR      SJEKSECUR
N07  C                   UPDATE    GSS010DA
N07   *
N07  C                   ENDSR
N07   *
     C***********************************************
     C     SJEKSECUR     BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(27)
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE     GSSOLF                                 33
     C                   DOW       *IN33 = *OFF
     C                   MOVE      OLLNO         LGLNO
      * SJEKK OM KOLLI ER IKKE "SECURED"
     C     GSSLGL03K1    CHAIN(N)  GSSLGL03                           33
     C                   IF        *IN33 = *OFF
     C                   MOVEA     '10'          *IN(27)
     C                   LEAVE
     C                   ELSE
      * SJEKK OM KOLLI ER "SECURED"
     C     GSSLGL03K2    CHAIN(N)  GSSLGL03                           33
     C                   IF        *IN33 = *OFF
     C                   MOVEA     '01'          *IN(27)
     C                   ELSE
     C                   MOVEA     '00'          *IN(27)
     C                   END
     C                   END
     C     ORONO         READE     GSSOLF                                 33
     C  N33              ENDDO
      *
      * SJEKK OM FARLIG GODS
     C     ORONO         CHAIN     GSSFGF                             33
     C  N33              MOVE      '1'           *IN(29)
     C   33              MOVE      '0'           *IN(29)
n02  C     ORONO         CHAIN     GSSDGF                             33
n02  C  N33              MOVE      '1'           *IN(28)
n02  C   33              MOVE      '0'           *IN(28)
      * SJEKK OM DOKUMENT ER ARKIVERT
N10  C                   MOVE      'A'           ARSTAT
N10  C                   MOVEL     'SS:'         URUNDE
     C                   MOVE      ORONO         URUNDE
     C     KEYS11        SETLL     ARKIVL11
     C     KEYS11        READE     ARKIVL11                               33
     C                   IF        *IN33
     C                   MOVE      '0'           *IN35
     C                   ELSE
     C                   MOVE      '1'           *IN35
     C                   END
N07   *
N07  C     GSS052FK2     KLIST
N07  C                   KFLD                    UUSER
N07  C                   KFLD                    ORONO
N07  C                   OPEN      GSS052F
N07  C     GSS052FK2     CHAIN     GSS052F                            33
N07  C  N33              MOVE      '1'           *IN(39)
N07  C   33              MOVE      '0'           *IN(39)
N07  C                   CLOSE     GSS052F
      *
     C                   MOVE      '0'           *IN(33)
      *
     C                   ENDSR
      *
     C***********************************************
     C     Skille        BEGSR
     C***********************************************
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     ORONO         SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS010DA
     C                   END
N09  C                   OUT       SAVUDS
     C                   ENDSR
      ***********************************************
     C     DSPISO        BEGSR
      ***********************************************
S04  C*                  move      orono         uoro
     C                   CALL      'SYIS10A'
     C                   PARM                    FIFIRM
     C                   PARM      HEAVD         UAVD2             4 0
     C                   PARM      HEOPD         UOPD2             7 0
S04  C*                  PARM                    UORO              7 0
N04  C                   PARM                    UORO              8 0
      *
     C     *IN90         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     C                   UPDATE    GSS010DA
     C                   END
     C                   ENDSR
      *
     OHEADFR    E            NYOPDS
     O                       HEST
