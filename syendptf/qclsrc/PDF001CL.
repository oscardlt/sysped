/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10247 * 01 YBC PTF10 NY PRINTERFIL SAD61PF                              */
/* 10264 * 02 YBC PTF10 NY PRINTERFIL SAD61PFT                             */
/* 10318 * 03 YBC PTF10 SAD52PF, 15CPI, 19LPI                              */
/* 11XXX * 04 YBC PTF11 REGKORT ER ENDRET TIL SAD61PFR                     */
/* 12001 * 05 YBC PTF12 MVA ETTER 01.01.2017                               */
/* 12234 * 06 YBC PTF12 SEND SHIPMENT TIL CW1                              */
/* D I INFOPRINT SH   */
/* *********************************************************************   */
/*       * ÅPNE SAD I PDF-FORMAT                                           */

             PGM        PARM(&AVD &OPD &KODE &STMF &BANE &VISE +
                          &FINST &FINSD &INFOP)
             DCL        VAR(&HOVED) TYPE(*CHAR) LEN(10)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FINST) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FINSD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAXTYP) TYPE(*CHAR) LEN(1) VALUE('A')
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PRT1) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT3) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
/*N06*/      DCL        VAR(&TYPE) TYPE(*CHAR) LEN(3) VALUE('REL')
/*N06*/      DCL        VAR(&IMPEXP) TYPE(*CHAR) LEN(3)
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&FINSD) VALUE('J')
             CHGVAR     VAR(&FINST) VALUE('J')
/*           SKJEKK OM PDF FINNES FRA FØR  */
             OVRPRTF    FILE(QSYSPRT) OUTQ(OUTMAIL)
             DSPLNK     OBJ(&BANE) OUTPUT(*PRINT) OBJTYPE(*STMF) +
                          DETAIL(*NAME) DSPOPT(*USER)
             MONMSG     MSGID(CPFA0A9) EXEC(GOTO CMDLBL(VIDERE))
             DLTSPLF    FILE(QSYSPRT) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             IF         COND(&VISE = 'J') THEN(DO)
             CALL       PGM(PDF001) PARM(&STMF)
             ENDDO
             RETURN
/*S03                     120) LPI(9) CPI(15) FRONTMGN(.43 .16) + */
/*S03                     OVRFLW(106) FRONTOVL(FSAD38) +          */
/*                                                                 */
/* IKKE DIREKTE TIL PDF                                            */
/*                                                                 */
 VIDERE:     IF         COND(&INFOP *NE 'D') THEN(DO)
             OVRPRTF    FILE(SAD52PF) DEVTYPE(*AFPDS) PAGESIZE(108 +
                          120) LPI(9) CPI(15) FRONTMGN(.24 0) +
                          OVRFLW(106) FRONTOVL(FSAD38 0 0.2) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) /*E03*/
             OVRPRTF    FILE(SAD61PF) DEVTYPE(*AFPDS) PAGESIZE(108 +
                          120) LPI(9) CPI(15) FRONTMGN(.24 0) +
                          OVRFLW(106) FRONTOVL(FSAD38 0 0.2) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) /*N01*/
             OVRPRTF    FILE(TOLLDEK2) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          83) LPI(6) CPI(10) OVRFLW(72) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)
/*S02        OVRPRTF    FILE(DATALIST) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          83) LPI(6) CPI(10) OVRFLW(72) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)    */
/*N02*/      OVRPRTF    FILE(SAD52PFT) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) LPI(6) CPI(15) OVRFLW(72) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)
/*N02*/      OVRPRTF    FILE(SAD61PFT) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) LPI(6) CPI(15) OVRFLW(72) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)
/*S04        OVRPRTF    FILE(REGKORT) DEVTYPE(*SCS) PAGESIZE(48 132) +
                          LPI(6) CPI(10) OVRFLW(48) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)   */
/*N04*/      OVRPRTF    FILE(SAD61PFR) DEVTYPE(*SCS) PAGESIZE(72 80) +
                          LPI(6) CPI(10) OVRFLW(70) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)
                          ENDDO
/*                                                                 */
/*      DIREKTE TIL PDF                                            */
/*                                                                 */
             IF         COND(&INFOP = 'D') THEN(DO)
             OVRPRTF    FILE(SAD52PF) DEVTYPE(*AFPDS) PAGESIZE(108 +
                          120) LPI(9) CPI(15) FRONTMGN(.24 0) +
                          OVRFLW(106) FRONTOVL(FSAD38 0 0.2) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF)
             OVRPRTF    FILE(SAD61PF) DEVTYPE(*AFPDS) PAGESIZE(108 +
                          120) LPI(9) CPI(15) FRONTMGN(.24 0) +
                          OVRFLW(106) FRONTOVL(FSAD38 0 0.2) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF)
             OVRPRTF    FILE(TOLLDEK2) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          83) LPI(6) CPI(10) OVRFLW(72) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)
/*S02        OVRPRTF    FILE(DATALIST) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          83) LPI(6) CPI(10) OVRFLW(72) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)    */
/*N02*/      OVRPRTF    FILE(SAD52PFT) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) LPI(6) CPI(15) OVRFLW(72) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)
/*N02*/      OVRPRTF    FILE(SAD61PFT) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) LPI(6) CPI(15) OVRFLW(72) PAGRTT(0) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) HOLD(*YES)
/*S04        OVRPRTF    FILE(REGKORT) DEVTYPE(*SCS) PAGESIZE(48 132) +
                          LPI(6) CPI(10) OVRFLW(48) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)   */
/*N04*/      OVRPRTF    FILE(SAD61PFR) DEVTYPE(*SCS) PAGESIZE(72 80) +
                          LPI(6) CPI(10) OVRFLW(70) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD)
                          ENDDO
             OVRDBF     FILE(WFILEIMP) MBR(ARKIV)
             OVRDBF     FILE(WFILEEXP) MBR(ARKIV)
             IF         COND(&KODE = 'I') THEN(DO)
/*S01        CHGVAR     VAR(&HOVED) VALUE('TOLLDEK')  */
/*N01*/      CHGVAR     VAR(&HOVED) VALUE('SAD61PF')
/*N05*/      CLRPFM     FILE(QTEMP/SADVAVG)
/*N05*/      MONMSG     MSGID(CPF0000) EXEC(DO)
/*N05*/      CRTDUPOBJ  OBJ(SADVAVG) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
/*N05*/      ENDDO
             CALL       PGM(SAD61P) PARM(&FAXTYP &AVD &OPD &PRT1 +
                          &PRT2 &PRT3)
             ENDDO
             IF         COND(&KODE = 'E') THEN(DO)
             CHGVAR     VAR(&HOVED) VALUE('SAD52PF')
             CALL       PGM(SAD52P) PARM(&FAXTYP &AVD &OPD &PRT1 +
                          &PRT2 &PRT3)
             ENDDO
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&HOVED) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
             IF         COND(&INFOP = 'J') THEN(DO)
/*           CHGVAR     VAR(&FILEN) VALUE('TOLLDEK')  */
             CALL       PGM(INF001CL) PARM(&HOVED &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             IF         COND(&VISE = 'J') THEN(DO)
             CALL       PGM(PDF001) PARM(&STMF)
             ENDDO
             DLTSPLF    FILE(&HOVED) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
/*FINNES TILLEGGSARK*/
             RLSSPLF    FILE(TOLLDEK2) JOB(&QNBR/&QUSER/&QJOB)
             MONMSG     MSGID(CPF3309 CPF3340 CPF3304 CPF3303) +
                          EXEC(CHGVAR VAR(&FINST) VALUE('N')) /*N02*/
/*FINNES DATALISTE*/
/*S02        RLSSPLF    FILE(DATALIST) JOB(&QNBR/&QUSER/&QJOB)       */
/*S02        MONMSG     MSGID(CPF3309 CPF3340 CPF3304) EXEC(CHGVAR +
                          VAR(&FINSD) VALUE('N'))                    */
/*N02*/      IF         COND(&KODE = 'I') THEN(DO)
/*N02*/      RLSSPLF    FILE(SAD61PFT) JOB(&QNBR/&QUSER/&QJOB)
             MONMSG     MSGID(CPF3309 CPF3340 CPF3304 CPF3303) +
                          EXEC(CHGVAR VAR(&FINSD) VALUE('N')) /*N02*/
/*N02*/      ENDDO
/*N02*/      ELSE       CMD(DO)
/*N02*/      RLSSPLF    FILE(SAD52PFT) JOB(&QNBR/&QUSER/&QJOB)
             MONMSG     MSGID(CPF3309 CPF3340 CPF3304 CPF3303) +
                          EXEC(CHGVAR VAR(&FINSD) VALUE('N')) /*N02*/
/*N02*/      ENDDO
/*N06  START */
             DLYJOB     DLY(2)
             IF         COND(&KODE = 'I') THEN(DO)
             CHGVAR     VAR(&IMPEXP) VALUE('IMP')
             ENDDO
             ELSE       CMD(DO)
             CHGVAR     VAR(&IMPEXP) VALUE('EXP')
             ENDDO
             CALL       PGM(SYXML53) PARM(&AVD &OPD &TYPE &IMPEXP)
/*N06  SLUTT */
/*           DLTSPLF    FILE(TOLLDEK2) JOB(&QNBR/&QUSER/&QJOB) + */
/*                        SPLNBR(*LAST)                          */
/*           MONMSG     MSGID(CPF0000)                           */
/*           DLTSPLF    FILE(DATALIST) JOB(&QNBR/&QUSER/&QJOB) + */
/*                        SPLNBR(*LAST)                          */
/*           MONMSG     MSGID(CPF0000)                           */
/*           DLTSPLF    FILE(REGKORT) JOB(&QNBR/&QUSER/&QJOB) +  */
/*                        SPLNBR(*LAST)                          */
/*           MONMSG     MSGID(CPF0000)                           */
 SLUTT:      ENDPGM
