      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TDCE011R MODULE(*LIBL/TDCE011R *LIBL/INCGI)
CRTPGM*        ACTGRP(CGI) AUT(*USE)
      *
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FDKXV      IF   E           K DISK    USROPN
     FDKXVAM    IF   E           K DISK    USROPN
     FDKXVCN    IF   E           K DISK    USROPN
     FDKXVDK    IF   E           K DISK    USROPN
     FDKXVFS    IF   E           K DISK    USROPN
     FDKXVMN    IF   E           K DISK    USROPN
     FDKXVTD    IF   E           K DISK    USROPN
     FDKXVVT    IF   E           K DISK    USROPN
     FDKXVFV    IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D AVD             S              4
     D AVDN            S              4  0
     D OPD             S              7
     D OPDN            S              7  0
     D LIN             S              5
     D LINN            S              5  0
     D JSONstring      s          32000
     D Error           S            150
     D AntLest         S              9  0
     D                 DS
     D  TVVT1                  1     48
     D  TVVT2                 49     96
     D  TVVT3                 97    144
     D  TVVT4                145    192
     D  TVVT5                193    240
     D  TVVT6                241    288
     D  VT                     1    288    DIM(6)
     D                 DS
     D  TVDTY1                 1      4
     D  TVDREF1                5     24
     D  TVDSK1                25     26
     D  TVDO1                 27     52
     D  TVDOSK1               53     54
     D  TVMTXT1               55    102
     D  TVMSK1               103    104
     D  TVTLO1               105    109
     D  TVEXKD1              110    110  0
     D  TVEXLK1              111    112
     D  TVDTY2               113    116
     D  TVDREF2              117    136
     D  TVDSK2               137    138
     D  TVDO2                139    164
     D  TVDOSK2              165    166
     D  TVMTXT2              167    214
     D  TVMSK2               215    216
     D  TVTLO2               217    221
     D  TVEXKD2              222    222  0
     D  TVEXLK2              223    224
     D  TVDTY3               225    228
     D  TVDREF3              229    248
     D  TVDSK3               249    250
     D  TVDO3                251    276
     D  TVDOSK3              277    278
     D  TVMTXT3              279    326
     D  TVMSK3               327    328
     D  TVTLO3               329    333
     D  TVEXKD3              334    334  0
     D  TVEXLK3              335    336
     D  TVDTY4               337    340
     D  TVDREF4              341    360
     D  TVDSK4               361    362
     D  TVDO4                363    388
     D  TVDOSK4              389    390
     D  TVMTXT4              391    438
     D  TVMSK4               439    440
     D  TVTLO4               441    445
     D  TVEXKD4              446    446  0
     D  TVEXLK4              447    448
     D  DK                     1    448    DIM(4)
     D                 DS
     D  TVDTY                  1      4
     D  TVDREF                 5     24
     D  TVDSK                 25     26
     D  TVDO                  27     52
     D  TVDOSK                53     54
     D  TVMTXT                55    102
     D  TVMSK                103    104
     D  TVTLO                105    109
     D  TVEXKD               110    110  0
     D  TVEXLK               111    112
     D  DKORG                  1    112
     D                 DS
     D  TVCNR1                 1     17
     D  TVCNR2                18     34
     D  TVCNR3                35     51
     D  TVCNR4                52     68
     D  TVCNR5                69     85
     D  TVCNR6                86    102
     D  CN                     1    102    DIM(6)
     D                 DS
     D  TVMN1                  1     42
     D  TVMN2                 43     84
     D  TVMN3                 85    126
     D  TVMN4                127    168
     D  TVMN5                169    210
     D  MN1                    1    210    DIM(5)
     D                 DS
     D  TVEH1                  1      2
     D  TVEH2                  3      4
     D  TVEH3                  5      6
     D  TVEH4                  7      8
     D  TVEH5                  9     10
     D  MN2                    1     10    DIM(5)
     D                 DS
     D  TVNT1                  1      5  0
     D  TVNT2                  6     10  0
     D  TVNT3                 11     15  0
     D  TVNT4                 16     20  0
     D  TVNT5                 21     25  0
     D  MN3                    1     25  0 DIM(5)
     D                 DS
     D  TVNTEH1                1      5  0
     D  TVNTEH2                6     10  0
     D  TVNTEH3               11     15  0
     D  TVNTEH4               16     20  0
     D  TVNTEH5               21     25  0
     D  MN4                    1     25  0 DIM(5)
     D                 DS
     D  TVFV1                  1      2
     D  TVFV2                  3      4
     D  TVFV3                  5      6
     D  TVFV4                  7      8
     D  TVFV5                  9     10
     D  FS1                    1     10    DIM(5)
     D                 DS
     D  TVFVNT1                1     11  3
     D  TVFVNT2               12     22  3
     D  TVFVNT3               23     33  3
     D  TVFVNT4               34     44  3
     D  TVFVNT5               35     55  3
     D  FS2                    1     55  3 DIM(5)
     D                 DS
     D  TVTDT1                 1      6
     D  TVTDT2                 7     12
     D  TVTDT3                13     18
     D  TVTDT4                19     24
     D  TVTDT5                25     30
     D  TD1                    1     30    DIM(5)
     D                 DS
     D  TVTDR1                 1     20
     D  TVTDR2                21     40
     D  TVTDR3                41     60
     D  TVTDR4                61     80
     D  TVTDR5                81    100
     D  TD2                    1    100    DIM(5)
     D                 DS
     D  TVTDSK1                1      2
     D  TVTDSK2                3      4
     D  TVTDSK3                5      6
     D  TVTDSK4                7      8
     D  TVTDSK5                9     10
     D  TD3                    1     10    DIM(5)
     D                 DS
     D  TVTDO1                 1     26
     D  TVTDO2                27     52
     D  TVTDO3                53     78
     D  TVTDO4                79    104
     D  TVTDO5               105    130
     D  TD4                    1    130    DIM(5)
     D                 DS
     D  TVTDOS1                1      2
     D  TVTDOS2                3      4
     D  TVTDOS3                5      6
     D  TVTDOS4                7      8
     D  TVTDOS5                9     10
     D  TD5                    1     10    DIM(5)

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT

     C                   CALLP     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   CALLP     wrtsection('top')
      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬avd¬ : ¬'+%trim(%editc(AVDN:'Z'))+'¬, '
        +'¬opd¬ : ¬'+%trim(%editc(OPDN:'Z'))+'¬, '
        +'¬lin¬ : ¬'+%trim(%editc(LINN:'Z'))+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ¬oneline¬ : [';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     C                   CALL      'JSONFIX'
     C                   PARM                    JSONstring
     C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   CALLP     wrtsection('JSONlin')
      * Hæmta detta ena ærendet.

     C     Error         IFEQ      *blanks
     C                   MOVE      *BLANKS       VT
     C                   MOVE      *BLANKS       DK
     C                   MOVE      *ZEROS        TVEXKD1
     C                   MOVE      *ZEROS        TVEXKD2
     C                   MOVE      *ZEROS        TVEXKD3
CBN  C                   MOVE      *ZEROS        TVEXKD4
     C                   MOVE      *BLANKS       CN
     C                   MOVE      *BLANKS       MN1
     C                   MOVE      *BLANKS       MN2
     C                   MOVEA     *ZEROS        MN3
     C                   MOVE      *ZEROS        MN4
     C                   MOVE      *BLANKS       FS1
     C                   MOVE      *ZEROS        FS2
     C                   MOVE      *BLANKS       TD1
     C                   MOVE      *BLANKS       TD2
     C                   MOVE      *BLANKS       TD3
     C                   MOVE      *BLANKS       TD4
     C                   MOVE      *BLANKS       TD5
     C     DKXVKey       CHAIN     DKXV                               55
     C     *IN55         IFEQ      '0'
     C                   MOVE      TVVT          VT(1)
     C                   MOVE      DKORG         DK(1)
     C                   MOVE      TVCNR         CN(1)
     C                   MOVE      TVMN          MN1(1)
     C                   MOVE      TVEH          MN2(1)
     C                   MOVE      TVNT          MN3(1)
     C                   MOVE      TVNTEH        MN4(1)
     C                   MOVE      TVFV          FS1(1)
     C                   MOVE      TVFVNT        FS2(1)
     C                   MOVE      TVTDT         TD1(1)
     C                   MOVE      TVTDR         TD2(1)
     C                   MOVE      TVTDSK        TD3(1)
     C                   MOVE      TVTDO         TD4(1)
     C                   MOVE      TVTDOS        TD5(1)
     C     DKXVKey       CHAIN     DKXVAM                             33
     C                   IF        *IN33
     C                   EVAL      TVKNS  = 0
     C                   EVAL      TVNAS  = *BLANKS
     C                   EVAL      TVADS1 = *BLANKS
     C                   EVAL      TVPNS  = *BLANKS
     C                   EVAL      TVPSS  = *BLANKS
     C                   EVAL      TVLKS  = *BLANKS
     C                   EVAL      TVSKS  = *BLANKS
     C                   EVAL      TVTINS = *BLANKS
     C                   EVAL      TVKNK  = 0
     C                   EVAL      TVNAK  = *BLANKS
     C                   EVAL      TVADK1 = *BLANKS
     C                   EVAL      TVPNK  = *BLANKS
     C                   EVAL      TVPSK  = *BLANKS
     C                   EVAL      TVLKK  = *BLANKS
     C                   EVAL      TVSKK  = *BLANKS
     C                   EVAL      TVTINK = *BLANKS
     C                   END
     C     DKXVKey       CHAIN     DKXVFV                             33
      *
     C                   Z-ADD     1             XN                3 0
     C     DKXVKey       SETLL     DKXVCN
     C     DKXVKey       READE     DKXVCN                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      TVCNR         CN(XN)
     C     DKXVKey       READE     DKXVCN                                 33
     C                   ENDDO
      *
     C                   Z-ADD     1             XN                3 0
     C     DKXVKey       SETLL     DKXVDK
     C     DKXVKey       READE     DKXVDK                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      DKORG         DK(XN)
     C     DKXVKey       READE     DKXVDK                                 33
     C                   ENDDO
      *
     C                   Z-ADD     1             XN                3 0
     C     DKXVKey       SETLL     DKXVFS
     C     DKXVKey       READE     DKXVFS                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      TVFV          FS1(XN)
     C                   MOVE      TVFVNT        FS2(XN)
     C     DKXVKey       READE     DKXVFS                                 33
     C  N33              ENDDO
      *
     C                   Z-ADD     1             XN                3 0
     C     DKXVKey       SETLL     DKXVMN
     C     DKXVKey       READE     DKXVMN                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      TVMN          MN1(XN)
     C                   MOVE      TVEH          MN2(XN)
     C                   MOVE      TVNT          MN3(XN)
     C                   MOVE      TVNTEH        MN4(XN)
     C     DKXVKey       READE     DKXVMN                                 33
     C  N33              ENDDO
      *
     C                   Z-ADD     1             XN                3 0
     C     DKXVKey       SETLL     DKXVTD
     C     DKXVKey       READE     DKXVTD                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      TVTDT         TD1(XN)
     C                   MOVE      TVTDR         TD2(XN)
     C                   MOVE      TVTDSK        TD3(XN)
     C                   MOVE      TVTDO         TD4(XN)
     C                   MOVE      TVTDOS        TD5(XN)
     C     DKXVKey       READE     DKXVTD                                 33
     C  N33              ENDDO
      *
     C                   Z-ADD     1             XN                3 0
     C     DKXVKey       SETLL     DKXVVT
     C     DKXVKey       READE     DKXVVT                                 33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN                3 0
     C                   MOVE      TVVT          VT(XN)
     C     DKXVKey       READE     DKXVVT                                 33
     C                   ENDDO
      *
      *
      * ............................................................................................
      * Skriv en JSON-Array-linje pr menypunkt - komma før hvert nytt element
      * ............................................................................................
      /free
          JSONstring=*blanks;
       JSONstring=%trim(JSONstring)+'{'
          +'¬tvavd¬ : ¬'+%trim(%editc(TVAVD:'Z'))+'¬, '
          +'¬tvtdn¬ : ¬'+%trim(%editc(TVTDN:'Z'))+'¬, '
          +'¬tvli¬ : ¬'+%trim(%editc(TVLI:'Z'))+'¬, '
          +'¬tvvnt¬ : ¬'+%trim(%editc(TVVNT:'4'))+'¬, '
          +'¬tvdk¬ : ¬'+%trim(TVDK)+'¬, '
          +'¬tvvt¬ : ¬'+%trim(TVVT1)+'¬, '
          +'¬tvvt2¬ : ¬'+%trim(TVVT2)+'¬, '
          +'¬tvvt3¬ : ¬'+%trim(TVVT3)+'¬, '
          +'¬tvvt4¬ : ¬'+%trim(TVVT4)+'¬, '
          +'¬tvvt5¬ : ¬'+%trim(TVVT5)+'¬, '
          +'¬tvvt6¬ : ¬'+%trim(TVVT6)+'¬, '
          +'¬tvvtsk¬ : ¬'+%trim(TVVTSK)+'¬, '
          +'¬tvvktb¬ : ¬'+%trim(%editc(TVVKTB:'4'))+'¬, '
          +'¬tvvktn¬ : ¬'+%trim(%editc(TVVKTN:'4'))+'¬, '
          +'¬tvalk¬ : ¬'+%trim(TVALK)+'¬, '
          +'¬tvblk¬ : ¬'+%trim(TVBLK)+'¬, '
          +'¬tvtdt¬ : ¬'+%trim(TVTDT1)+'¬, '
          +'¬tvtdt2¬ : ¬'+%trim(TVTDT2)+'¬, '
          +'¬tvtdt3¬ : ¬'+%trim(TVTDT3)+'¬, '
          +'¬tvtdt4¬ : ¬'+%trim(TVTDT4)+'¬, '
          +'¬tvtdt5¬ : ¬'+%trim(TVTDT5)+'¬, '
          +'¬tvtdr¬ : ¬'+%trim(TVTDR1)+'¬, '
          +'¬tvtdr2¬ : ¬'+%trim(TVTDR2)+'¬, '
          +'¬tvtdr3¬ : ¬'+%trim(TVTDR3)+'¬, '
          +'¬tvtdr4¬ : ¬'+%trim(TVTDR4)+'¬, '
          +'¬tvtdr5¬ : ¬'+%trim(TVTDR5)+'¬, '
          +'¬tvtdsk¬ : ¬'+%trim(TVTDSK1)+'¬, '
          +'¬tvtdsk2¬ : ¬'+%trim(TVTDSK2)+'¬, '
          +'¬tvtdsk3¬ : ¬'+%trim(TVTDSK3)+'¬, '
          +'¬tvtdsk4¬ : ¬'+%trim(TVTDSK4)+'¬, '
          +'¬tvtdsk5¬ : ¬'+%trim(TVTDSK5)+'¬, '
          +'¬tvtdo¬ : ¬'+%trim(TVTDO1)+'¬, '
          +'¬tvtdo2¬ : ¬'+%trim(TVTDO2)+'¬, '
          +'¬tvtdo3¬ : ¬'+%trim(TVTDO3)+'¬, '
          +'¬tvtdo4¬ : ¬'+%trim(TVTDO4)+'¬, '
          +'¬tvtdo5¬ : ¬'+%trim(TVTDO5)+'¬, '
          +'¬tvtdos¬ : ¬'+%trim(TVTDOS1)+'¬, '
          +'¬tvtdos2¬ : ¬'+%trim(TVTDOS2)+'¬, '
          +'¬tvtdos3¬ : ¬'+%trim(TVTDOS3)+'¬, '
          +'¬tvtdos4¬ : ¬'+%trim(TVTDOS4)+'¬, '
          +'¬tvtdos5¬ : ¬'+%trim(TVTDOS5)+'¬, '
          +'¬tvdty¬ : ¬'+%trim(TVDTY1)+'¬, '
          +'¬tvdref¬ : ¬'+%trim(TVDREF1)+'¬, '
          +'¬tvdsk¬ : ¬'+%trim(TVDSK1)+'¬, '
          +'¬tvdo¬ : ¬'+%trim(TVDO1)+'¬, '
          +'¬tvdosk¬ : ¬'+%trim(TVDOSK1)+'¬, '
          +'¬tvmtxt¬ : ¬'+%trim(TVMTXT1)+'¬, '
          +'¬tvmsk¬ : ¬'+%trim(TVMSK1)+'¬, '
          +'¬tvtlo¬ : ¬'+%trim(TVTLO1)+'¬, '
          +'¬tvexkd¬ : ¬'+%trim(%editc(TVEXKD1:'Z'))+'¬, '
          +'¬tvexlk¬ : ¬'+%trim(TVEXLK1)+'¬, '
          +'¬tvdty2¬ : ¬'+%trim(TVDTY2)+'¬, '
          +'¬tvdref2¬ : ¬'+%trim(TVDREF2)+'¬, '
          +'¬tvdsk2¬ : ¬'+%trim(TVDSK2)+'¬, '
          +'¬tvdo2¬ : ¬'+%trim(TVDO2)+'¬, '
          +'¬tvdosk2¬ : ¬'+%trim(TVDOSK2)+'¬, '
          +'¬tvmtxt2¬ : ¬'+%trim(TVMTXT2)+'¬, '
          +'¬tvmsk2¬ : ¬'+%trim(TVMSK2)+'¬, '
          +'¬tvtlo2¬ : ¬'+%trim(TVTLO2)+'¬, '
          +'¬tvexkd2¬ : ¬'+%trim(%editc(TVEXKD2:'Z'))+'¬, '
          +'¬tvexlk2¬ : ¬'+%trim(TVEXLK2)+'¬, '
          +'¬tvdty3¬ : ¬'+%trim(TVDTY3)+'¬, '
          +'¬tvdref3¬ : ¬'+%trim(TVDREF3)+'¬, '
          +'¬tvdsk3¬ : ¬'+%trim(TVDSK3)+'¬, '
          +'¬tvdo3¬ : ¬'+%trim(TVDO3)+'¬, '
          +'¬tvdosk3¬ : ¬'+%trim(TVDOSK3)+'¬, '
          +'¬tvmtxt3¬ : ¬'+%trim(TVMTXT3)+'¬, '
          +'¬tvmsk3¬ : ¬'+%trim(TVMSK3)+'¬, '
          +'¬tvtlo3¬ : ¬'+%trim(TVTLO3)+'¬, '
          +'¬tvexkd3¬ : ¬'+%trim(%editc(TVEXKD3:'Z'))+'¬, '
          +'¬tvexlk3¬ : ¬'+%trim(TVEXLK3)+'¬, '
          +'¬tvdty4¬ : ¬'+%trim(TVDTY4)+'¬, '
          +'¬tvdref4¬ : ¬'+%trim(TVDREF4)+'¬, '
          +'¬tvdsk4¬ : ¬'+%trim(TVDSK4)+'¬, '
          +'¬tvdo4¬ : ¬'+%trim(TVDO4)+'¬, '
          +'¬tvdosk4¬ : ¬'+%trim(TVDOSK4)+'¬, '
          +'¬tvmtxt4¬ : ¬'+%trim(TVMTXT4)+'¬, '
          +'¬tvmsk4¬ : ¬'+%trim(TVMSK4)+'¬, '
          +'¬tvtlo4¬ : ¬'+%trim(TVTLO4)+'¬, '
          +'¬tvexkd4¬ : ¬'+%trim(%editc(TVEXKD4:'Z'))+'¬, '
          +'¬tvexlk4¬ : ¬'+%trim(TVEXLK4)+'¬, '
          +'¬tvavd2¬ : ¬'+%trim(%editc(TVAVD2:'Z'))+'¬, '
          +'¬tvtdn2¬ : ¬'+%trim(%editc(TVTDN2:'Z'))+'¬, '
          +'¬tvcnr¬ : ¬'+%trim(TVCNR1)+'¬, '
          +'¬tvcnr2¬ : ¬'+%trim(TVCNR2)+'¬, '
          +'¬tvcnr3¬ : ¬'+%trim(TVCNR3)+'¬, '
          +'¬tvcnr4¬ : ¬'+%trim(TVCNR4)+'¬, '
          +'¬tvcnr5¬ : ¬'+%trim(TVCNR5)+'¬, '
          +'¬tvcnr6¬ : ¬'+%trim(TVCNR6)+'¬, '
          +'¬tvmn¬ : ¬'+%trim(TVMN1)+'¬, '
          +'¬tvmn2¬ : ¬'+%trim(TVMN2)+'¬, '
          +'¬tvmn3¬ : ¬'+%trim(TVMN3)+'¬, '
          +'¬tvmn4¬ : ¬'+%trim(TVMN4)+'¬, '
          +'¬tvmn5¬ : ¬'+%trim(TVMN5)+'¬, '
          +'¬tvmnsk¬ : ¬'+%trim(TVMNSK)+'¬, '
          +'¬tveh¬ : ¬'+%trim(TVEH1)+'¬, '
          +'¬tveh2¬ : ¬'+%trim(TVEH2)+'¬, '
          +'¬tveh3¬ : ¬'+%trim(TVEH3)+'¬, '
          +'¬tveh4¬ : ¬'+%trim(TVEH4)+'¬, '
          +'¬tveh5¬ : ¬'+%trim(TVEH5)+'¬, '
          +'¬tvnt¬ : ¬'+%trim(%editc(TVNT1:'Z'))+'¬, '
          +'¬tvnt2¬ : ¬'+%trim(%editc(TVNT2:'Z'))+'¬, '
          +'¬tvnt3¬ : ¬'+%trim(%editc(TVNT3:'Z'))+'¬, '
          +'¬tvnt4¬ : ¬'+%trim(%editc(TVNT4:'Z'))+'¬, '
          +'¬tvnt5¬ : ¬'+%trim(%editc(TVNT5:'Z'))+'¬, '
          +'¬tvnteh¬ : ¬'+%trim(%editc(TVNTEH1:'Z'))+'¬, '
          +'¬tvnteh2¬ : ¬'+%trim(%editc(TVNTEH2:'Z'))+'¬, '
          +'¬tvnteh3¬ : ¬'+%trim(%editc(TVNTEH3:'Z'))+'¬, '
          +'¬tvnteh4¬ : ¬'+%trim(%editc(TVNTEH4:'Z'))+'¬, '
          +'¬tvnteh5¬ : ¬'+%trim(%editc(TVNTEH5:'Z'))+'¬, '
          +'¬tvfv¬ : ¬'+%trim(TVFV1)+'¬, '
          +'¬tvfv2¬ : ¬'+%trim(TVFV2)+'¬, '
          +'¬tvfv3¬ : ¬'+%trim(TVFV3)+'¬, '
          +'¬tvfv4¬ : ¬'+%trim(TVFV4)+'¬, '
          +'¬tvfv5¬ : ¬'+%trim(TVFV5)+'¬, '
          +'¬tvfvnt¬ : ¬'+%trim(%editc(TVFVNT:'4'))+'¬, '
          +'¬tvfvnt2¬ : ¬'+%trim(%editc(TVFVNT2:'4'))+'¬, '
          +'¬tvfvnt3¬ : ¬'+%trim(%editc(TVFVNT3:'4'))+'¬, '
          +'¬tvfvnt4¬ : ¬'+%trim(%editc(TVFVNT4:'4'))+'¬, '
          +'¬tvfvnt5¬ : ¬'+%trim(%editc(TVFVNT5:'4'))+'¬, '
          +'¬tvkns¬ : ¬'+%trim(%editc(TVKNS:'Z'))+'¬, '
          +'¬tvnas¬ : ¬'+%trim(TVNAS)+'¬, '
          +'¬tvads1¬ : ¬'+%trim(TVADS1)+'¬, '
          +'¬tvpns¬ : ¬'+%trim(TVPNS)+'¬, '
          +'¬tvpss¬ : ¬'+%trim(TVPSS)+'¬, '
          +'¬tvlks¬ : ¬'+%trim(TVLKS)+'¬, '
          +'¬tvsks¬ : ¬'+%trim(TVSKS)+'¬, '
          +'¬tvtins¬ : ¬'+%trim(TVTINS)+'¬, '
          +'¬tvknk¬ : ¬'+%trim(%editc(TVKNK:'Z'))+'¬, '
          +'¬tvnak¬ : ¬'+%trim(TVNAK)+'¬, '
          +'¬tvadk1¬ : ¬'+%trim(TVADK1)+'¬, '
          +'¬tvpnk¬ : ¬'+%trim(TVPNK)+'¬, '
          +'¬tvpsk¬ : ¬'+%trim(TVPSK)+'¬, '
          +'¬tvlkk¬ : ¬'+%trim(TVLKK)+'¬, '
          +'¬tvskk¬ : ¬'+%trim(TVSKK)+'¬, '
          +'¬tvtink¬ : ¬'+%trim(TVTINK)+'¬, '
          +'¬tvln¬ : ¬'+%trim(%editc(TVLN:'Z'))+'¬, '
          +'¬tvtkbm¬ : ¬'+%trim(TVTKBM)+'¬, '
          +'¬tvkref¬ : ¬'+%trim(TVKREF)+'¬, '
          +'¬tvfgkd¬ : ¬'+%trim(TVFGKD)+'¬, '
          +'¬tvknss¬ : ¬'+%trim(%editc(TVKNSS:'Z'))+'¬, '
          +'¬tvnass¬ : ¬'+%trim(TVNASS)+'¬, '
          +'¬tvadss1¬ : ¬'+%trim(TVADSS1)+'¬, '
          +'¬tvpnss¬ : ¬'+%trim(TVPNSS)+'¬, '
          +'¬tvpsss¬ : ¬'+%trim(TVPSSS)+'¬, '
          +'¬tvlkss¬ : ¬'+%trim(TVLKSS)+'¬, '
          +'¬tvskss¬ : ¬'+%trim(TVSKSS)+'¬, '
          +'¬tvtinss¬ : ¬'+%trim(TVTINSS)+'¬, '
          +'¬tvknks¬ : ¬'+%trim(%editc(TVKNKS:'Z'))+'¬, '
          +'¬tvnaks¬ : ¬'+%trim(TVNAKS)+'¬, '
          +'¬tvadks1¬ : ¬'+%trim(TVADKS1)+'¬, '
          +'¬tvpnks¬ : ¬'+%trim(TVPNKS)+'¬, '
          +'¬tvpsks¬ : ¬'+%trim(TVPSKS)+'¬, '
          +'¬tvlkks¬ : ¬'+%trim(TVLKKS)+'¬, '
          +'¬tvskks¬ : ¬'+%trim(TVSKKS)+'¬, '
          +'¬tvtinks¬ : ¬'+%trim(TVTINKS)+'¬, '
          +'¬tvrefl¬ : ¬'+%trim(%editc(TVREFL:'Z'))+'¬}';
      /end-free
     C                   CALL      'JSONFIX'
     C                   PARM                    JSONstring
     C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   CALLP     wrtsection('JSONlin')

     C                   ENDIF
     C                   ENDIF
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     C                   EVAL      JSONstring =']}'
     C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   CALLP     wrtsection('JSONlin')
      * Quit
     C                   EXSR      EXIT
      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     EXIT          BEGSR
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     DKXV
     C  N50              CLOSE     DKXVAM
     C  N50              CLOSE     DKXVCN
     C  N50              CLOSE     DKXVDK
     C  N50              CLOSE     DKXVFS
     C  N50              CLOSE     DKXVMN
     C  N50              CLOSE     DKXVTD
     C  N50              CLOSE     DKXVVT
     C  N50              CLOSE     DKXVFV

      * Do not delete the CALL to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   CALLP     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   ENDSR
      *********************************************************
     C     Parse         BEGSR
      *********************************************************
      * Get input
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      AVD     = zhbgetvar('AVD')
     C                   EVAL      AVDN    = c2n2(AVD)
     C                   EVAL      OPD     = zhbgetvar('OPD')
     C                   EVAL      OPDN    = c2n2(OPD)
     C                   EVAL      LIN     = zhbgetvar('LIN')
     C                   EVAL      LINN    = c2n2(LIN)
     C                   ENDSR
      *********************************************************
     C     INIT          BEGSR
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C     BILIBL        IFEQ      *blanks
     C                   CALLb     'INCGI'
     C                   PARM                    BISTDL
     C                   else
     C                   CALL      BILIBL
     C                   end

     C     DKXVKey       klist
     C                   kfld                    AVDN
     C                   kfld                    OPDN
     C                   kfld                    LINN

     C   50              EVAL      Error = 'Invalid userID'
     C  N50              OPEN      DKXV
     C  N50              OPEN      DKXVAM
     C  N50              OPEN      DKXVCN
     C  N50              OPEN      DKXVDK
     C  N50              OPEN      DKXVFS
     C  N50              OPEN      DKXVMN
     C  N50              OPEN      DKXVTD
     C  N50              OPEN      DKXVVT
     C  N50              OPEN      DKXVFV

     C                   ENDSR
