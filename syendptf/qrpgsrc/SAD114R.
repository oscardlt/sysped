      *
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE KURERMANIFEST (OPPDRAG)     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-02 06-08 10 11 13-26
      *** LEDIGE INDIKATORER 27-29 31 32 34-48 50-81          ***
      ***********************************************************
      *
     FSADH      IF   E           K DISK
     FSADKMCL1  UF A E           K DISK
     FSADKML02  IF   E           K DISK
     FTRACKF    O  A E             DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     F*TRKODL01  IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FSAD114D   CF   E             WORKSTN INFDS(FBAREA)
     D                SDS
     D  UUSR                 254    263
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRA                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  KMDTRA                 1      4  0
     D  KMDTRM                 5      6  0
     D  KMDTRD                 7      8  0
     D  KMDTR                  1      8  0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
      *...............................................
      * BILDE-1 INNLESING AV HOVED OPPLYSNINGER AV TUR
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '00000000'    *IN(80)
     C                   SETOFF                                       30
      *
      *  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ UT
     C   12              GOTO      SLUTT
      *
      * ----------- T E S T   B I L D E 0 1 ----------
     C                   EXSR      TESTB1
     C   30              GOTO      START
      *
     C                   EXSR      OPDOPD
      *
     C                   IF        MCAVD = 0
     C                   CALL      'SAD117R'
     C                   PARM                    UPRO
     C                   PARM      MCCN          UCN
     C                   PARM                    MCVOEC
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C                   IF        UFLAGG = 1
     C                   GOTO      START
     C                   END
     C                   END
      *
     C     SLUTT         TAG
     C                   SELECT
     C                   WHEN      *IN12
     C                   EVAL      UFLAGG = 1
     C                   OTHER
     C                   EVAL      UFLAGG = 0
     C                   ENDSL
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * SØK AVSENDER
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAS
     C                   IF        WSKNS <> 0
     C                   EXSR      TESTS
     C                   END
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     91
     C     POSNBR        ANDLE     92
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKS
     C                   PARM                    USPED
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      * FRISØK MOTTAKER
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     30
     C                   CALL      'SYTR04A'
     C                   PARM                    WSKNK
     C                   IF        WSKNK <> 0
     c                   exsr      testK
     c                   end
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     91
     C     POSNBR        ANDLE     92
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKK
     C                   PARM                    USPED
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVGANGSTOLLSTED
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     93
     C     POSNBR        ANDLE     96
     C*                  EVAL      UUNIK = '013'
     C*                  EVAL      UKODE = WSTRFT
     C*                  MOVE      'ANK'         UTYPE2            3
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK             3
     C*                  PARM                    UKODE            10
     C*                  PARM                    UTYPE2
     C*                  MOVEL     UKODE         WSTRFT
     C                   eval      KFTYP='SADKMTDOCT'
     C                   MOVE      'N'           UUPDAT            1
     C                   MOVE      *BLANKS       XKFKOD            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XKFKOD
     c                   MOVEL     XKFKOD        WSTRFT
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     95
     C     POSNBR        ANDLE     97
     C                   CALL      'SAD061F'
     C                   PARM                    WSVAL
     C                   PARM                    USIDT             8 0
     C                   Z-ADD     108           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     108
     C     POSNBR        ANDLE     109
     C                   MOVE      'N'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKA
     C                   PARM                    USPED
     C                   Z-ADD     108           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      *
      *** TEST AVDSENDER
     C     WSKNS         IFNE      0
     C                   EXSR      TESTS
     C                   END
      *
     C*    WSRGS         COMP      *BLANKS                                98
     C     WSNAS         COMP      *BLANKS                                97
     C     WSADS1        COMP      *BLANKS                                96
     C     WSPNS         COMP      *BLANKS                                95
     C     WSADS3        COMP      *BLANKS                                94
      *
     C     KODTS2KS      CHAIN     KODTS2                             93
      *
     C                   IF        WSCMS <> *BLANKS OR WSCMST <> *BLANKS
     C                   IF        WSCMS = *BLANKS
     C                   EVAL      *IN92 = *ON
     C                   ELSE
     C     '@'           SCAN      WSCMS                                  33
     C  N33              EVAL      WSCMST = 'TE'
     C   33              EVAL      WSCMST = 'EM'
     C                   END
     C                   END
      *
      *** TEST MOTTAKER
     C     WSKNK         IFNE      0
     C                   EXSR      TESTK
     C                   END
      *
     C*    WSRGK         COMP      *BLANKS                                90
     C     WSNAK         COMP      *BLANKS                                89
     C     WSADK1        COMP      *BLANKS                                88
     C     WSPNK         COMP      *BLANKS                                87
     C     WSADK3        COMP      *BLANKS                                86
      *
     C     KODTS2KK      CHAIN     KODTS2                             85
      *
     C                   IF        WSCMK <> *BLANKS OR WSCMKT <> *BLANKS
     C                   IF        WSCMK = *BLANKS
     C                   EVAL      *IN84 = *ON
     C                   ELSE
     C     '@'           SCAN      WSCMK                                  33
     C  N33              EVAL      WSCMKT = 'TE'
     C   33              EVAL      WSCMST = 'EM'
     C                   END
     C                   END
      *
     C                   EVAL      WSTRF = %scanRpl(' ':'':WSTRF)
     C     WSTRF         COMP      *BLANKS                                83
      *
     C*                  MOVEL     WSTRFT        TKKODE
     C*    TRKODL01K     CHAIN     TRKODL01                           82
     C                   eval      KFTYP='SADKMTDOCT'
     c                   eval      KFKOD=WSTRFT
     C     KOFASTkey     CHAIN     KOFAST                             82
      *
     C                   IF        UTDN = 0
      * MANUELL REGISTRERING CONSIGNMENT (OPPDRAG)
     C     WSVAL         CHAIN     KODTVAL2                           81
      *
     C     KODTS2KA      CHAIN     KODTS2                             80
     C                   END
      *
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG          BEGSR
      ***********************************************
     C   99              MOVE      'YBC2053'     MSGNR
     C   99              DO
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   98
     CANN30              DO
     C                   MOVE      'YBC2054'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
     C   97
     CANN30              DO
     C                   MOVE      'YBC2055'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   96
     CANN30              DO
     C                   MOVE      'YBC2056'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     46            POSNBR
     C                   END
     C   95
     CANN30              DO
     C                   MOVE      'YBC2052'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     46            POSNBR
     C                   END
     C   94
     CANN30              DO
     C                   MOVE      'YBC2057'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   END
     C   93
     CANN30              DO
     C                   MOVE      'YBC2058'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     91            POSNBR
     C                   END
     C   92
     CANN30              DO
     C                   MOVE      'YBC2059'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   91
     CANN30              DO
     C                   MOVE      'YBC2060'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   90
     CANN30              DO
     C                   MOVE      'YBC2061'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
     C   89
     CANN30              DO
     C                   MOVE      'YBC2062'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   88
     CANN30              DO
     C                   MOVE      'YBC2063'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     46            POSNBR
     C                   END
     C   87
     CANN30              DO
     C                   MOVE      'YBC2070'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     46            POSNBR
     C                   END
     C   86
     CANN30              DO
     C                   MOVE      'YBC2064'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     56            POSNBR
     C                   END
     C   85
     CANN30              DO
     C                   MOVE      'YBC2065'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     91            POSNBR
     C                   END
     C   84
     CANN30              DO
     C                   MOVE      'YBC2066'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   83
     CANN30              DO
     C                   MOVE      'YBC2075'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   82
     CANN30              DO
     C                   MOVE      'YBC2076'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     93            POSNBR
     C                   END
     C   81
     CANN30              DO
     C                   MOVE      'SPV0014'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
     C   80
     CANN30              DO
     C                   MOVE      'SPL0013'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     28            POSNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVKMW        BEGSR
      ***********************************************
     C                   MOVE      KMDTRD        WSDTRD
     C                   MOVE      KMDTRM        WSDTRM
     C                   MOVE      KMDTRA        WSDTRA
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UTDN          WSTDN
     C                   MOVE      UCN           WSCN
      *
     C                   MOVE      MCKNS         WSKNS
     C                   MOVE      MCRGS         WSRGS
     C                   MOVE      MCNAS         WSNAS
     C                   MOVE      MCADS1        WSADS1
     C                   MOVE      MCADS2        WSADS2
     C                   MOVE      MCPNS         WSPNS
     C                   MOVE      MCADS3        WSADS3
     C                   MOVE      MCLKS         WSLKS
     C                   MOVE      MCCMS         WSCMS
     C                   MOVE      MCCMST        WSCMST
     C                   MOVE      MCCPS         WSCPS
     C                   MOVE      MCKNK         WSKNK
     C                   MOVE      MCRGK         WSRGK
     C                   MOVE      MCNAK         WSNAK
     C                   MOVE      MCADK1        WSADK1
     C                   MOVE      MCADK2        WSADK2
     C                   MOVE      MCPNK         WSPNK
     C                   MOVE      MCADK3        WSADK3
     C                   MOVE      MCLKK         WSLKK
     C                   MOVE      MCCMK         WSCMK
     C                   MOVE      MCCMKT        WSCMKT
     C                   MOVE      MCCPK         WSCPK
     C                   IF        UTYPE = 'CPY'
     C                   MOVE      *BLANKS       WSTRF
     C                   MOVE      *BLANKS       WSTRFT
     C                   ELSE
     C                   MOVE      MCTRF         WSTRF
     C                   MOVE      MCTRFT        WSTRFT
     C                   END
     C                   MOVE      MCTYPE        WSTYPE
     C                   MOVE      MCVAL         WSVAL
     C                   MOVE      MCLKA         WSLKA
     C                   MOVE      MCVOEC        WSVOEC
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWKM        BEGSR
      ***********************************************
     C                   MOVE      WSKNS         MCKNS
     C                   MOVE      WSRGS         MCRGS
     C                   MOVE      WSNAS         MCNAS
     C                   MOVE      WSADS1        MCADS1
     C                   MOVE      WSADS2        MCADS2
     C                   MOVE      WSPNS         MCPNS
     C                   MOVE      WSADS3        MCADS3
     C                   MOVE      WSLKS         MCLKS
     C                   MOVE      WSCMS         MCCMS
     C                   MOVE      WSCMST        MCCMST
     C                   MOVE      WSCPS         MCCPS
     C                   MOVE      WSKNK         MCKNK
     C                   MOVE      WSRGK         MCRGK
     C                   MOVE      WSNAK         MCNAK
     C                   MOVE      WSADK1        MCADK1
     C                   MOVE      WSADK2        MCADK2
     C                   MOVE      WSPNK         MCPNK
     C                   MOVE      WSADK3        MCADK3
     C                   MOVE      WSLKK         MCLKK
     C                   MOVE      WSCMK         MCCMK
     C                   MOVE      WSCMKT        MCCMKT
     C                   MOVE      WSCPK         MCCPK
     C                   MOVE      WSTRF         MCTRF
     C                   MOVE      WSTRFT        MCTRFT
     C                   MOVE      WSTYPE        MCTYPE
     C                   MOVE      WSVAL         MCVAL
     C                   MOVE      WSLKA         MCLKA
     C                   MOVE      WSVOEC        MCVOEC
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVSAW        BEGSR
      ***********************************************
     C                   MOVE      KMDTRD        WSDTRD
     C                   MOVE      KMDTRM        WSDTRM
     C                   MOVE      KMDTRA        WSDTRA
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UTDN          WSTDN
      *
     C                   MOVE      SIKNS         WSKNS
     C                   MOVE      *BLANKS       WSRGS
     C                   MOVE      SINAS         WSNAS
     C                   MOVE      SIADS1        WSADS1
     C                   MOVE      SIADS2        WSADS2
     C                   MOVEL     SIADS3        WSPNS
     C                   MOVEL     SIADS3        WSADS3
     C                   MOVE      *BLANKS       WSLKS
     C                   MOVE      *BLANKS       WSCMS
     C                   MOVE      *BLANKS       WSCMST
     C                   MOVE      *BLANKS       WSCPS
     C                   MOVE      SIKNK         WSKNK
     C                   MOVE      SIRG          WSRGK
     C                   MOVE      SINAK         WSNAK
     C                   MOVE      SIADK1        WSADK1
     C                   MOVE      SIADK2        WSADK2
     C                   MOVEL     SIADK3        WSPNK
     C                   MOVEL     SIADK3        WSADK3
     C                   MOVE      'NO'          WSLKK
     C                   MOVE      *BLANKS       WSCMK
     C                   MOVE      *BLANKS       WSCMKT
     C                   MOVE      *BLANKS       WSCPK
     C                   MOVE      *BLANKS       WSTRF
     C                   MOVE      *BLANKS       WSTRFT
     C                   EVAL      WSTYPE = '11'
     C                   MOVE      *BLANKS       WSVAL
     C                   MOVE      *BLANKS       WSLKA
     C                   MOVE      *BLANKS       WSVOEC
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTS         BEGSR
      ***********************************************
     C                   MOVE      WSKNS         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            99
     C  N99kundnr        comp      0                                      99
     C  N99              DO
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSADS1
     C                   MOVE      ADR2          WSADS2
     C                   EVAL      WSADS3 = ADR3
     C                   EVAL      WSPNS  = *BLANKS
     C     POSTNR        IFEQ      0
     C                   EVAL      WSPNS = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPNS
     C                   END
     C                   IF        SYFOR9 <> *ZEROS
     C                   EVAL      WSRGS = SYRG
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTK         BEGSR
      ***********************************************
     C                   MOVE      WSKNK         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            91
     C  N91kundnr        comp      0                                      91
     C  N91              DO
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSADK1
     C                   MOVE      ADR2          WSADK2
     C                   EVAL      WSADK3 = ADR3
     C                   EVAL      WSPNK  = *BLANKS
     C     POSTNR        IFEQ      0
     C                   EVAL      WSPNK = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPNK
     C                   END
     C                   IF        SYFOR9 <> *ZEROS
     C                   EVAL      WSRGK = SYRG
     C                   END
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDOPD        BEGSR
      ***********************************************
      *
     C                   IF        UTYPE = 'CPY'
     C                   EVAL      *IN33 = *ON
     C                   ELSE
     C     SADKMCL1K     CHAIN     SADKMCL1                           33
     C                   END
      *
     C                   EXSR      TTSR
      *
      * FLYTTER SKJERMVARIABLE TIL FILVARIABLE
      *
     C                   EXSR      MOVWKM
      *
      * 33 ER PÅ VED NY OPD
      *
     C                   IF        *IN33                                        1<-B
     C                   EVAL      MCAVD  = UAVD
     C                   EVAL      MCPRO  = UPRO
     C                   EVAL      MCTDN  = UTDN
     C                   IF        UTYPE = 'MAN'
     C                             OR UTYPE = 'CPY'
     C                   EVAL      MCCN   = X_NESTECN
     C                   EVAL      UCN    = MCCN
     C                   ELSE
     C                   EVAL      MCCN   = UCN
     C                   END
     C                   EVAL      MCST   = ' '
     C                   WRITE     SADKMCFR
     C                   ELSE
     C                   UPDATE    SADKMCFR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     SADKML02K     KLIST
     C                   KFLD                    UPRO
     C     SADKMCL1K     KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    UCN
     C     SADKMCL1KM1   KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    MAX_UCN
     C     SADKMCL1KM2   KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SADhk         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTS2KA      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSLKA
     C     KODTS2KS      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSLKS
     C     KODTS2KK      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    WSLKK
     C*    TRKODL01K     KLIST
     C*                  KFLD                    TKUNIK
     C*                  KFLD                    TKKODE
     C     KOFASTkey     KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UPRO              8 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    UCN               2 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVE      'N'           USPED             1
     C                   EVAL      KS2UNI = 'S2'
     C*                  EVAL      TKUNIK = '013'
     C                   EVAL      WSDTR  = 0
     C                   EVAL      KMDTR  = 0
      *
     C     UTYPE         COMP      'DSP'                                  49
      *
     C                   SELECT
     C                   WHEN      UTYPE = 'PLK' OR UTYPE = 'PLA'
     C                   EVAL      *IN33 = *ON
     C                   WHEN      UTYPE = 'MAN'
     C                   Z-ADD     99            MAX_UCN           2 0
     C     SADKMCL1KM1   SETGT     SADKMCL1
     C     SADKMCL1KM2   READPE(N) SADKMCL1                               33
     C  N33MCCN          ADD       1             X_NESTECN         2 0
     C   33              Z-ADD     1             X_NESTECN         2 0
     C                   CLEAR                   SADKMCFR
     C                   EVAL      *IN33 = *ON
     C                   WHEN      UTYPE = 'CPY'
     C                   Z-ADD     99            MAX_UCN           2 0
     C     SADKMCL1KM1   SETGT     SADKMCL1
     C     SADKMCL1KM2   READPE(N) SADKMCL1                               33
     C  N33MCCN          ADD       1             X_NESTECN         2 0
     C   33              Z-ADD     1             X_NESTECN         2 0
     C     SADKMCL1K     CHAIN(N)  SADKMCL1                           33
     C                   EVAL      MCCN = 0
     C                   EVAL      *IN33 = *OFF
     C                   OTHER
     C     SADKML02K     CHAIN     SADKML02                           33
     C     SADKMCL1K     CHAIN(N)  SADKMCL1                           33
     C                   ENDSL
     C                   IF        *IN33
     C     SADHK         CHAIN     SADH                               33
     C                   EXSR      MOVSAW
     C                   IF        UTYPE = 'PLA'
     C                   EXSR      OPDOPD
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
     C                   ELSE
     C                   EXSR      MOVKMW
     C                   END
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
      ***********************************************
     C     TTSR          BEGSR
      ***********************************************
     C                   EVAL      TTAVD  = UAVD
     C                   EVAL      TTOPD  = UTDN
     C                   EVAL      TTTUR  = UPRO
     C                   EVAL      TTACTI = 'KMC'
     C                   MOVE      WDT           TTDATE
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      UUSR          TTUSER
     C                   IF        *IN33
     C                   EVAL      TTTEXT = 'Oppdrag er plukket til manifest.'
     C                   EVAL      TTTEXL = 'Oppdrag er plukket til manifest.'
     C                   EVAL      TTEDEV = 'CRT'
     C                   ELSE
     C                   EVAL      TTTEXT = 'Info. av oppdrag er endret.'
     C                   EVAL      TTTEXL = 'Info. av oppdrag er endret.'
     C                   EVAL      TTEDEV = 'CHG'
     C                   END
     C                   EVAL      TTUSER = UUSR
      *
     C                   WRITE     TRACKFR
     C                   ENDSR
      *
