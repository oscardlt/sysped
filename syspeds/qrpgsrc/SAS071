     F********************************************************************
     F* genererer flyfrakt export  for SAS
     f* sonepriser er tatt ut
     F********************************************************************
     Fsastill   iF   E           k disk
     Fsted2d    iF a E           k disk
     Fsted2     uF   E           k disk
     F                                     RENAME(sted2r:ste2R)
     Fairlh     uF a E           k disk
     Fairld     uF a E           k disk
     Fairldwrk  uF a E           k disk
N01  Fnoflypj   IP   E           k DISK
     Ftactdesi  if   E           K disk
     F*asgro    if   E           k disk
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     c     *entry        plist
     c                   parm                    ei                1
     c  n99              exsr      init
     c                   seton                                        99
     c                   exsr      lesfil
     clr                 exsr      opdhaw
     c*****************************************************
     c     init          begsr
     c*****************************************************
     c     ei            ifeq      'E'
     c     'A'           chain     sastill                            33
     c                   end
     c                   endsr
     c*****************************************************
     c     lesfil        begsr
     c*****************************************************
      * skjekk om sone > 2
      * da gjelder tilleggsfil  ved > enn 2
     c                   movel     flkode        flkod5            5
     c     flkod5        chain(n)  sted2                              40
     c* N40st2son        comp      2                                  40
     c                   setoff                                       33
     c     *loval        setll     tactdesi
     c     *in(33)       doweq     '0'
     c                   read      tactdesi                               33
     c     *in(33)       ifeq      '0'
     c**** sasson        chain     sasgro                             34
     c                   exsr      oppdat
     c                   endif
     c                   enddo
     c                   endsr
     c*****************************************************
     c     oppdat        begsr
     c*****************************************************
     c*
     c* skjekker om stedet er i stedsregisteret
     c*
     c     keyste        klist
     c                   kfld                    st2lk
     c                   kfld                    st2kod
     c*
     c                   move      saslk         st2lk
     c                   move      *blanks       st2kod
     c                   movel     sasflp        st2kod
     c*
     c* slett alle eksisterende koder med denne nøkkel
     c*
     c                   setoff                                       77
     c     st2kod        setll     sted2
     c     *in77         doweq     '0'
     c     st2kod        reade     sted2                                  77
     c  N77              delete    ste2r
     c                   end
     c*
     c     keyste        chain     sted2d                             34
     c     *in(34)       ifeq      '1'
     c                   movel     sasste        st2nvn
     C     LO:UP         XLATE     st2nvn        st2nvn
     c                   move      saslk         st2lk
     c                   write     sted2r
     c                   end
     c*
     c     keyhea        klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   move      flkode        airpfr
     c                   move      sasflp        airpto
     c*
     c* tact  = 0
     c*
     c                   z-add     0             airlin
     c     keyhea        chain     airlh                              34
     c                   move      'NOK'         aircur
     c     *in(34)       ifeq      '1'
     c                   write     airlhr
     c                   else
     c                   update    airlhr
     c                   end
     c                   exsr      detsr
     c                   endsr
     c*
     c*******************************************************************
     c     detsr         begsr
     c*******************************************************************
     c     keydet        klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   kfld                    airccp
     c*
     c* priority cargo
     c*
     c     saspri        ifeq      'J'
     c                   move      'P'           airccp
     c*
     c*
     c*
     c* SAS sletter records
     c*
     c                   setoff                                       34
     c     keydet        setll     airld
     c     *in(34)       doweq     '0'
     c     keydet        reade     airld                                  34
     c  n34              delete    airldr
     c                   enddo
     c*
     c* skriver ny record N rate
     c*
     c                   z-add     spmini        airgrn
     c                   z-add     spNrat        airawb
     c                   z-add     44            airwei
     c                   move      'N'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c*
     c*
     c* skriver ny record q rate
     c*
     c                   z-add     0             airgrn
     c                   z-add     spq045        airawb
     c                   z-add     99            airwei
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c*
     c*
     c* skriver ny record q rate
     c*
     c                   z-add     0             airgrn
     c                   z-add     spq100        airawb
     c                   z-add     99999         airwei
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c*
     c                   endif
     c*
     c* genraral cargo
     c*
     c     sasgen        ifeq      'J'
     c                   move      ' '           airccp
     c*
     c*  sletter records
     c*
     c                   setoff                                       34
     c     keydet        setll     airld
     c     *in(34)       doweq     '0'
     c     keydet        reade     airld                                  34
     c  n34              delete    airldr
     c                   enddo
     c*
     c* skriver ny record N rate
     c*
     c                   z-add     sgmini        airgrn
     c                   z-add     sgnrat        airawb
     c                   z-add     44            airwei
     c                   move      'N'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c*
     c*
     c* skriver ny record q rate
     c*
     c*
     c*
     c* skriver ny record q rate ved  +45
     c*
     c     sgq045        ifne      *zeros
     c                   z-add     0             airgrn
     c                   z-add     sgq045        airawb
     c     sgq100        ifeq      0
     c     sgq250        andeq     0
     c     sgq300        andeq     0
     c     sgq500        andeq     0
     c     sgqmil        andeq     0
     c                   z-add     99999         airwei
     c                   else
     c     sgq100        ifne      0
     c                   z-add     99            airwei
     c                   else
     c     sgq250        ifne      0
     c                   z-add     249           airwei
     c                   else
     c     sgq300        ifne      0
     c                   z-add     299           airwei
     c                   else
     c     sgq500        ifne      0
     c                   z-add     499           airwei
     c                   else
     c                   z-add     999           airwei
     c                   end
     c                   end
     c                   end
     c                   end
     c                   end
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c                   end
      *
     c*
     c*
     c*
     c* skriver ny record q rate ved  +100
     c*
     c     sgq100        ifne      *zeros
     c                   z-add     0             airgrn
     c                   z-add     sgq100        airawb
     c     sgq250        ifeq      0
     c     sgq300        andeq     0
     c     sgq500        andeq     0
     c     sgqmil        andeq     0
     c                   z-add     99999         airwei
     c                   else
     c     sgq250        ifne      0
     c                   z-add     249           airwei
     c                   else
     c     sgq300        ifne      0
     c                   z-add     299           airwei
     c                   else
     c     sgq500        ifne      0
     c                   z-add     499           airwei
     c                   else
     c                   z-add     999           airwei
     c                   end
     c                   end
     c                   end
     c                   end
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c                   end
      *
     c*
     c*
     c*
     c* skriver ny record q rate ved  +250
     c*
     c     sgq250        ifne      *zeros
     c                   z-add     0             airgrn
     c                   z-add     sgq250        airawb
     c     sgq300        ifeq      0
     c     sgq500        andeq     0
     c     sgqmil        andeq     0
     c                   z-add     99999         airwei
     c                   else
     c     sgq300        ifne      0
     c                   z-add     299           airwei
     c                   else
     c     sgq500        ifne      0
     c                   z-add     499           airwei
     c                   else
     c                   z-add     999           airwei
     c                   end
     c                   end
     c                   end
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c                   end
      *
     c*
     c*
     c* skriver ny record q rate ved  +300
     c*
     c     sgq300        ifne      *zeros
     c                   z-add     0             airgrn
     c                   z-add     sgq300        airawb
     c     sgq500        ifeq      0
     c     sgqmil        andeq     0
     c                   z-add     99999         airwei
     c                   else
     c     sgq500        ifne      0
     c                   z-add     499           airwei
     c                   else
     c                   z-add     999           airwei
     c                   end
     c                   end
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c                   end
      *
     c*
     c*
     c*
     c* skriver ny record q rate ved  +500
     c*
     c     sgq500        ifne      *zeros
     c                   z-add     0             airgrn
     c                   z-add     sgq500        airawb
     c     sgqmil        ifeq      0
     c                   z-add     99999         airwei
     c                   else
     c                   z-add     999           airwei
     c                   end
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c                   end
      *
     c*
      *
      *
     c     sgqmil        ifne      0
     c                   z-add     0             airgrn
     c                   z-add     sgqmil        airawb
     c                   z-add     99999         airwei
     c                   move      'Q'           aircod
     c   40              add       tilleg        airawb
     c                   write     airldr
     c                   end
     c*
     c                   end
     c*
     c                   endsr
     c*
     c*******************************************************************
     c     opdhaw        begsr
     c*******************************************************************
     c* leger eventuelle HAWB data tilbake
     c*
     c     keyd          klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   kfld                    airccp
     c                   kfld                    aircod
     c                   kfld                    airwei
     c                   setoff                                       33
     c     *loval        setll     airldwrk
     c     *in(33)       doweq     '0'
     c                   read      airldwrk                               33
     c     *in(33)       ifeq      '0'
     c     airham        ifne      0
     c     airhaw        orne      0
     c                   move      airham        wirham           13 2
     c                   move      airhaw        wirhaw           13 2
     c     keyd          chain     airld                              34
     c     *in(34)       ifeq      '0'
     c                   move      wirham        airham
     c                   move      wirhaw        airhaw
     c                   update    airldr
     c                   endif
     c                   endif
     c                   endif
     c                   enddo
     c                   endsr
