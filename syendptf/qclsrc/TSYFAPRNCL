/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 11XXX * 01 JOV PTF12 NY PARAM &AOR= ARBORD INT/EKST BAK CM /INGN MERKING*/
/* 11XXX * 02 JOV PTF12 PARAM &ASUSER V/FERDIGM.FAKT. + &LALI &GOLI &TUKO  */
/* ********************************************************************    */
             PGM        PARM(&JBK &VBST &VBLI +
                          &VBEK &TPST &TPLI &OF &VF &TPFB &FP &IFFB +
                          &LOSS &FFAK &KOWFET &CM &AOR &SAKODE &SATYPE +
                          &WSAVD &WSSG &WSPRO &WSOPD &WSGN &WSDT1 +
                          &WSDT2 &WSSUM &WSOT1 &WSOT2 &WSOT3 &WSOT4 +
                          &WSOT5 &WSMS1 &WSMS2 &WSMS3 &WSMS4 &WSMS5 +
                          &WSMS6 &WSPRT &WSPRT2 &ASUSER &LALI &GOLI &TUKO)

             DCL        VAR(&WSAVD) TYPE(*DEC) LEN(4 0)
             DCL        VAR(&WSSG) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WSPRO) TYPE(*DEC) LEN(8 0)
             DCL        VAR(&WSOPD) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&WSGN) TYPE(*CHAR) LEN(15)
             DCL        VAR(&WSDT1) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&WSDT2) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&WSSUM) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WSOT1) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSOT2) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSOT3) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSOT4) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSOT5) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSMS1) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSMS2) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSMS3) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSMS4) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSMS5) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSMS6) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WSPRT) TYPE(*CHAR) LEN(10)
             DCL        VAR(&WSPRT2) TYPE(*CHAR) LEN(10)
/*N02*/      DCL        VAR(&ASUSER) TYPE(*CHAR) LEN(10)
/*N02*/      DCL        VAR(&LALI) TYPE(*CHAR) LEN(1)
/*N02*/      DCL        VAR(&GOLI) TYPE(*CHAR) LEN(1)
/*N02*/      DCL        VAR(&TUKO) TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN01) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in01 på, betyr det avslutt program +
                          fra valgbilde. */
             DCL        VAR(&IN03) TYPE(*LGL) LEN(1) /* Hvis &in03 +
                          på, skal losseliste  være stående. */
             DCL        VAR(&IN04) TYPE(*LGL) LEN(1) /* Hvis &in04 +
                          på, skal printetype være 4224. */
             DCL        VAR(&IN05) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in05 på, betyr programkallinng fra +
                          BORDERAUR. */
             DCL        VAR(&IN06) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in06 på, betyr programkalleing fra +
                          MANEFEST. */
             DCL        VAR(&IN07) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in07 på, betyr programkallinng fra +
                          KREDITERING. */
             DCL        VAR(&IN08) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          If &in08=1 , meens invoicing on order- +
                          type         */
             DCL        VAR(&SAKODE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SATYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KOWFET) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AWB) TYPE(*LGL) LEN(1) /* MAWB-liste +
                          type. */
             DCL        VAR(&KOPIE) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &KOPI = 1, betyr det kopiering av +
                          flyfraktbrev-eksport. */
             DCL        VAR(&CM) TYPE(*CHAR) LEN(1)
/*N01*/      DCL        VAR(&AOR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KOPI) TYPE(*CHAR) LEN(1) /* Hvis &KOPI +
                          =J, skal KOPIER SKRIVES          . */
             DCL        VAR(&LG) TYPE(*CHAR) LEN(1) /* Hvis 'L', +
                          benytter linjegods fraktbrev. ellers vanlig +
                          frakbrev. */
             DCL        VAR(&EKSP) TYPE(*CHAR) LEN(1) /* Hvis 'J', +
                          benytter ekspress fraktbrev. */
             DCL        VAR(&LT) TYPE(*CHAR) LEN(1) /* Hvis 'L', +
                          benytter linjegodstollpass. */
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('F') /* +
                          Kode = 'F', 'T'. */
             DCL        VAR(&VB) TYPE(*CHAR) LEN(1) /* Hvis &VB = +
                          'J', skal sende valgbilde ut til bruker. */
             DCL        VAR(&PO) TYPE(*CHAR) LEN(1) /* Hvis &PO = +
                          'J', skal sortere på postnr. */
    /* FØLGENDE 5 PARAMETRE LEDIGE FOR ANNET BRUK (SYFA12) */
             DCL        VAR(&VBST) TYPE(*CHAR) LEN(1) /* LEDIG   */

             DCL        VAR(&VBLI) TYPE(*CHAR) LEN(1) /* LEDIG   */

             DCL        VAR(&VBEK) TYPE(*CHAR) LEN(1) /* LEDIG   */

             DCL        VAR(&TPST) TYPE(*CHAR) LEN(1) /* LEDIG   */

             DCL        VAR(&TPLI) TYPE(*CHAR) LEN(1) /* LEDIG   */

    /* */
             DCL        VAR(&OF) TYPE(*CHAR) LEN(1) /* +
                          Oppdragsformular. */
             DCL        VAR(&VF) TYPE(*CHAR) LEN(1) /* Vanlig +
                          fraktbrev. */
             DCL        VAR(&TPFB) TYPE(*CHAR) LEN(1) /* Tollpass +
                          fraktbrev. */
             DCL        VAR(&FP) TYPE(*CHAR) LEN(1) /* Forpassing +
                          SAD. */
             DCL        VAR(&IFFB) TYPE(*CHAR) LEN(1) /* Innenland +
                          flyfraktbrev. */
             DCL        VAR(&LOSS) TYPE(*CHAR) LEN(1) /* Losseliste. */
             DCL        VAR(&FFAK) TYPE(*CHAR) LEN(1) /* Ferdig +
                          Ferdig meldte fakturaer. */
             DCL        VAR(&MS) TYPE(*CHAR) LEN(2) /* Meldesedler */
             DCL        VAR(&JBK) TYPE(*CHAR) LEN(1) /* Jobbkø. */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TIME) TYPE(*CHAR) LEN(6)
             DCL        VAR(&EDS) TYPE(*CHAR) LEN(39)  +
                                  VALUE('*BLANKS')
             DCL        VAR(&SKIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&TYP) TYPE(*CHAR) LEN(2) VALUE('ZO')
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PRT) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRT2) TYPE(*CHAR) LEN(10)
    /*N01 - DOBBELTDEFINERE NUM-ALFA */
/*N01*/      DCL        VAR(&WSAVDA) TYPE(*CHAR) LEN(4)
/*N01*/      DCL        VAR(&WSOPDA) TYPE(*CHAR) LEN(7)
/*N01*/      DCL        VAR(&WSPROA) TYPE(*CHAR) LEN(8)
    /*N01 - FLYTTE TIL ALFA */
/*N01*/      CHGVAR     VAR(&WSAVDA) VALUE(&WSAVD)
/*N01*/      CHGVAR     VAR(&WSOPDA) VALUE(&WSOPD)
/*N01*/      CHGVAR     VAR(&WSPROA) VALUE(&WSPRO)
    /* HENTE AVDELING, SIGNATUR OG FIRMAKODE */
    /* HENTE OPPLYSNINGER OM HVA SLAGS UTSKRIFT MAN ØNSKER */
    /* KOMMER I DENNE WEBVARIANTEN INN SOM PARAMETER TIL DETTE PROGRAMET */
             CALL       PGM(TSYFAPR2) PARM(&JBK &VBST &VBLI &VBEK +
                          &TPST &TPLI &OF &VF &TPFB &FP &IFFB &LOSS +
                          &FFAK &KOWFET &CM &AOR &SAKODE &SATYPE &WSSG +
                          &WSGN &WSSUM &WSOT1 &WSOT2 &WSOT3 &WSOT4 +
                          &WSOT5 &WSMS1 &WSMS2 &WSMS3 &WSMS4 &WSMS5 +
                          &WSMS6 &WSPRT &WSPRT2 &WSAVD &WSPRO +
                          &WSOPD &WSDT1 &WSDT2 &ASUSER &LALI &GOLI &TUKO)
    /* PARAMERTRE FOR PRINT AV SKILLEARK */
             RTVDTAARA  DTAARA(*LDA (80 1)) RTNVAR(&SKIL)
             RTVDTAARA  DTAARA(*LDA (22 8)) RTNVAR(&TUR)
    /* SKRIVER UT OPPDRAGSFORMULAR */
             IF         COND(&OF = 'J') THEN(DO)
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFA40CLJ)) JOB(OPPDRAG) +
                          JOBD(*USRPRF) JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFA40CLJ)
                        ENDDO
                        ENDDO
    /* SKRIVER UT VANLIG FRAKTBREV */
             IF         COND(&VF = 'J') THEN(DO)
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFA12CLJ) PARM(&KODE &VB &EKSP +
                          &LG &PO)) JOB(FRBREV) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFA12CLJ) PARM(&KODE &VB &EKSP &LG &PO)
                        ENDDO
                        ENDDO

             CHGVAR     VAR(&KODE) VALUE('T')

    /* TOLLPASSFRAKTBREV */
             IF         COND(&TPFB = 'J') THEN(DO)
    /* STANDARD */
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFA12CLJ) PARM(&KODE &VB &EKSP +
                          &LT &PO)) JOB(TOLLPASS) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFA12CLJ) PARM(&KODE &VB &EKSP &LT &PO)
                        ENDDO
                        ENDDO
    /* FORPASSING PÅ SAD */
             IF         COND(&FP = 'J') THEN(DO)
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFA41CLJ)) JOB(FORPASSING) +
                          JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFA41CLJ)
                        ENDDO
                        ENDDO
    /* FLYFRAKTBREV INNLAND*/
             IF         COND(&IFFB = 'J') THEN(DO)
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYEF14CLI) PARM(&AWB &KOPIE +
                          &KOWFET)) JOB(FRBREV) JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYEF14CLI) PARM(&AWB &KOPIE &KOWFET)
                        ENDDO
                        ENDDO
    /* LOSSELISTE */
             IF         COND(&LOSS = 'J') THEN(DO)
             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&TIME)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &TIME)
             RMVM       FILE(ASSAM) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(ASSAM) MBR(&UNIK)
             OVRDBF     FILE(ASSAM) TOFILE(ASSAM) MBR(&UNIK)
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFI48CLJ) PARM(&IN03 &IN04 &EDS)) +
                          JOB(LOSSELI) JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFI48CLJ) PARM(&IN03 &IN04 &EDS)
                        ENDDO
             RMVM       FILE(ASSAM) MBR(&UNIK)
             MONMSG     MSGID(CPF0000)
                        ENDDO
    /* SKILLEARK- SAMMEN MED/UAVHENGIG AV LOSSELISTE */
             IF         COND(&SKIL = 'S') THEN(DO)
             CALL       PGM(ARCA000T) PARM(&TYP &TUR)
                        ENDDO
    /* SKILLEARK- TYPE 2                             */
             IF         COND(&SAKODE *NE '  ') THEN(DO)
             CALL       PGM(ARCA000T) PARM(&SAKODE &TUR)
                        ENDDO
    /* SKRIVER UT FERDIGMELDTE FAKTURAER */
             IF         COND(&FFAK = 'J') THEN(DO)
         /*&KOPI=W=FRA WEB,, BRUK ASUSER FRA LDA 401-410 I STEDET FOR ZUSER*/
 /*N02*/     CHGVAR     VAR(&KOPI) VALUE('W')
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFA20CLJ) PARM(&FFAK &IN05 +
                          &IN06 &IN07 &IN08 &KOPI)) JOB(FAKTURA) +
                          JOBD(*USRPRF) JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFA20CLJ) PARM(&FFAK &IN05 &IN06 &IN07 +
                          &IN08 &KOPI)
                        ENDDO
 /*N02*/     CHGVAR     VAR(&KOPI) VALUE(' ')
                        ENDDO
    /* SKRIVER UT MELDESEDLER */
             RTVDTAARA  DTAARA(*LDA (49 2)) RTNVAR(&MS) /* Hente +
                          oppdragstype fra UDS. */
             IF         COND(&MS *NE '  ') THEN(DO)
             CHGVAR     VAR(&FFAK) VALUE(' ')
             CHGVAR     VAR(&IN08) VALUE('1')
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYFA20CLJ) PARM(&FFAK &IN05 +
                          &IN06 &IN07 &IN08 &KOPI)) JOB(MELDES) +
                          JOBD(*USRPRF) JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYFA20CLJ) PARM(&FFAK &IN05 &IN06 &IN07 +
                          &IN08 &KOPI)
                        ENDDO
                        ENDDO
    /* SKRIVER UT CMR-FRAKTBREV          */
             IF         COND(&CM = 'J') THEN(DO)
             CHGDTAARA  DTAARA(*LDA (30 5)) VALUE('00000')
             IF         COND(&JBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYEX43CLJ) PARM(&IN01 &IN01)) +
                          JOB(CMR) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYEX43CLJ) PARM(&IN01 &IN01)
                        ENDDO
                        ENDDO

    /* SKRIVER UT ARBEIDSORDRE &AOR=TYPE */
 /*N01*/     IF         COND(&AOR *NE ' ') THEN(DO)
 /*N01*/     IF         COND(&JBK = 'J') THEN(DO)
 /*N01*/     SBMJOB     CMD(CALL PGM(SYTR40CB) PARM(&WSAVDA &WSPROA +
                          &WSOPDA &AOR)) JOB(ARBORDRE) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
 /*N01*/                ENDDO
 /*N01*/     ELSE       CMD(DO)
 /*N01*/     CALL       PGM(SYTR40CB) PARM(&WSAVDA &WSPROA &WSOPDA &AOR)
 /*N01*/                ENDDO
 /*N01*/                ENDDO

    /* SKRIVER UT LASTELISTE TRANSP-MODUL (SE SYTRTU FELLESUTSK/TUR..) */
 /*N02*/     IF         COND(&LALI = 'J') THEN(DO)
 /*N02*/     CHGDTAARA  DTAARA(*LDA (126 10)) VALUE(&ASUSER)
 /*N02*/     IF         COND(&JBK = 'J') THEN(DO)
 /*N02*/     SBMJOB     CMD(CALL PGM(SYFA54CD) PARM(&WSAVDA &WSPROA)) +
                          JOB(LASTELISTE) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
 /*N02*/                ENDDO
 /*N02*/     ELSE       CMD(DO)
 /*N02*/     CALL       PGM(SYFA54CD) PARM(&WSAVDA &WSPROA)
 /*N02*/                ENDDO
 /*N02*/                ENDDO

    /* SKRIVER UT GODSLISTE TRANSP-MODUL (SE SYTRTU FELLESUTSK/TUR..) */
 /*N02*/     IF         COND(&GOLI = 'J') THEN(DO)
 /*N02*/     CHGDTAARA  DTAARA(*LDA (126 10)) VALUE(&ASUSER)
 /*N02*/     IF         COND(&JBK = 'J') THEN(DO)
 /*N02*/     SBMJOB     CMD(CALL PGM(PRTGLPDAC) PARM(&WSAVDA &WSPROA)) +
                          JOB(GODSLISTE) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
 /*N02*/                ENDDO
 /*N02*/     ELSE       CMD(DO)
 /*N02*/     CALL       PGM(PRTGLPDAC) PARM(&WSAVDA &WSPROA)
 /*N02*/                ENDDO
 /*N02*/                ENDDO

    /* SKRIVER UT TURKOPNVOLUTT TRANSP-MODUL (SE SYTRTU FELLESUTSK/TUR..) */
    /* MERK WSAVD/WSTUR = NUMERISKE PARAMETRE */
 /*N02*/     IF         COND(&TUKO = 'J') THEN(DO)
 /*N02*/     CHGDTAARA  DTAARA(*LDA (126 10)) VALUE(&ASUSER)
 /*N02*/     IF         COND(&JBK = 'J') THEN(DO)
 /*N02*/     SBMJOB     CMD(CALL PGM(SYTR22CD) PARM(&WSAVD &WSSG &WSPRO)) +
                          JOB(TURKONV) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
 /*N02*/                ENDDO
 /*N02*/     ELSE       CMD(DO)
 /*N02*/     CALL       PGM(SYTR22CD) PARM(&WSAVD &WSSG &WSPRO)
 /*N02*/                ENDDO
 /*N02*/                ENDDO

 SLUTT:      ENDPGM
