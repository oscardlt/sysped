      * SYSPED-SYEDI For Kingsrød/Kronos INVOIC D.01B
      *
      * 1. SYSPED SYKS37 legger ut poster i INTFAS
      *
      * 2. Dette programmet leser fra INTFAS
      *
      * 3. Dette programmet legger ut til EDI-filer i SYEDI.
      *
      * 4. SYEDI lager automatisk EDIFACT utifra EDI-filene.
      *
     FINTFAS    UF   E           K DISK
     FEDIC      UF   E             DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FFRISOK    IF   E           K DISK
     FTRACKT    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FSTED2D    IF   E           K DISK
     FEUNH      O  A E             DISK
     FEDIM      O  A E             DISK
     FEUNS      O  A E             DISK
     FEALC01B   O  A E             DISK
     FECNT01B   O  A E             DISK
     FECOM01B   O  A E             DISK
     FECTA01B   O  A E             DISK
     FECUX01B   O  A E             DISK
     FEDTM01B   O  A E             DISK
     FEFII01B   O  A E             DISK
     FEFTX01B   O  A E             DISK
     FELIN01B   O  A E             DISK
     FELOC01B   O  A E             DISK
     FEMEA01B   O  A E             DISK
     FEMOA01B   O  A E             DISK
     FENAD01B   O  A E             DISK
     FEPAI01B   O  A E             DISK
     FEPAT01B   O  A E             DISK
     FEPRI01B   O  A E             DISK
     FEQTY01B   O  A E             DISK
     FERFF01B   O  A E             DISK
     FETAX01B   O  A E             DISK
     FETDT01B   O  A E             DISK
     FETOD01B   O  A E             DISK
      *___________________________
      * Arrays for string handling
      *"""""""""""""""""""""""""""
     D                 DS
     D  WTID                   1      6  0
     D  WDATO                  7     14  0
     D                 DS
     D  WKID                   1     19
     D  WKID1                  1      8  0
     D  WKID2                  9     15  0
     D  WKID3                 16     19  0
     D                 DS
     D  XKID                   1     20
     D  XKID1                  1     19
     D  XKID2                 20     20  0
     D                 DS
     D  WSIREF                 1     12
     D  WSIREF1                1      4S 0
     D  WSIREF2                5      5    INZ('/')
     D  WSIREF3                6     12S 0
      *____________________________________
      * DS for leftjustify numericel fields
      *""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN153                  1     15  3
     D  ØA153H                 1     12
     D  ØA153X                 5     12
     D  ØA153D                13     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)
      */////////////
      * MAIN LOGIC /
      */////////////
     C                   EXSR      SRINIT
     C                   EXSR      SRA
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      * SR                                                  ALC39 /
      *////////////////////////////////////////////////////////////
     C     ALC39         BEGSR
     C*                  Z-ADD     0             WREP1
      *____________
      *
      *""""""""""""
     C                   ADD       1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   ALCR
     C                   Z-ADD     WMN           AMN
     C                   Z-ADD     39            AGN
     C                   Z-ADD     WREP0         AREP0
     C                   Z-ADD     WREP1         AREP1
     C                   EVAL      A5463 = 'C'
     C                   EVAL      A4471 = '6'
     C                   EVAL      A7161 = INVK
     C     KODTGEK       CHAIN     KODTGE                             33
     C                   EVAL      A7160A = KGEENT
     C                   WRITE     ALCR
      *
     C                   EXSR      MOA42
     C                   EXSR      TAX44
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  COM05 /
      *////////////////////////////////////////////////////////////
     C     COM05         BEGSR
     C                   Z-ADD     0             WREP2
      *_________________________________
      * Communication contact, Telephone
      *"""""""""""""""""""""""""""""""""
     C                   CLEAR                   CTAR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     5             CGN
     C                   Z-ADD     WREP0         CREP0
     C                   Z-ADD     WREP1         CREP1
     C                   ADD       1             WREP2
     C                   Z-ADD     WREP2         CREP2
     C                   EVAL      C3155='TE'
     C                   EVAL      C3148='+4723194800'
     C                   WRITE     COMR
      *___________________________
      * Communication contact, Fax
      *"""""""""""""""""""""""""""
     C                   CLEAR                   CTAR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     5             CGN
     C                   Z-ADD     WREP0         CREP0
     C                   Z-ADD     WREP1         CREP1
     C                   ADD       1             WREP2
     C                   Z-ADD     WREP2         CREP2
     C                   EVAL      C3155='FX'
     C                   EVAL      C3148='+4723194801'
     C                   WRITE     COMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  CTA05 /
      *////////////////////////////////////////////////////////////
     C     CTA05         BEGSR
     C                   Z-ADD     1             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   CLEAR                   CTAR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     5             CGN
     C                   Z-ADD     WREP0         CREP0
     C                   Z-ADD     WREP1         CREP1
      *___________________
      * Purchasing contact
      *"""""""""""""""""""
     C                   MOVEL     'IC'          C3139
     C                   EVAL      C3412=KPERS
     C                   WRITE     CTAR
     C                   EXSR      COM05
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  CUX07 /
      *////////////////////////////////////////////////////////////
     C     CUX07         BEGSR
      *_________
      * Currency
      *"""""""""
     C                   CLEAR                   CUXR
     C                   Z-ADD     WMN           CMN
     C                   Z-ADD     7             CGN
     C                   Z-ADD     WREP0         CREP0

     C                   EVAL      C6347A='2'
     C                   IF        INVAL = *BLANKS
     C                   EVAL      C6345A='NOK'
     C                   ELSE
     C                   EVAL      C6345A=INVAL
     C                   END
     C                   EVAL      C6345A='NOK'
     C                   EVAL      C6343A='4'
     C                   WRITE     CUXR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
      *____________
      * Invoic date
      *""""""""""""
     C                   CLEAR                   DTMR
     C                   Z-ADD     1             WREP0
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     0             DGN
     C                   Z-ADD     WREP0         DREP0
     C                   EVAL      D2005 = '35'
     C                   MOVEL     INDATO        D2380
     C                   MOVEL     '102'         D2379
     C                   WRITE     DTMR
      *____________
      * Message date
      *""""""""""""
     C                   CLEAR                   DTMR
     C                   Z-ADD     2             WREP0
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     0             DGN
     C                   Z-ADD     WREP0         DREP0
     C                   EVAL      D2005 = '137'
     C                   MOVEL     WDATO         D2380
     C                   MOVEL     '102'         D2379
     C                   WRITE     DTMR
      *____________
      * Payment due date
      *""""""""""""
     C                   IF        INBELN >= 0
     C                   CLEAR                   DTMR
     C                   Z-ADD     3             WREP0
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     0             DGN
     C                   Z-ADD     WREP0         DREP0
     C                   EVAL      D2005 = '140'
     C                   MOVEL     INDAFF        D2380
     C                   MOVEL     '102'         D2379
     C                   WRITE     DTMR
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DTM08 /
      *////////////////////////////////////////////////////////////
     C     DTM08         BEGSR
     C                   Z-ADD     1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   DTMR
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     8             DGN
     C                   Z-ADD     WREP0         DREP0
     C                   Z-ADD     WREP1         DREP1
      *_____________
      * Forfallsdato
      *"""""""""""""
     C                   MOVEL     '13'          D2005
     C                   MOVEL     INDAFF        D2380
     C                   MOVEL     '102'         D2379
     C                   WRITE     DTMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DTM26 /
      *////////////////////////////////////////////////////////////
     C     DTM26         BEGSR
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   DTMR
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     26            DGN
     C                   Z-ADD     WREP0         DREP0
     C                   Z-ADD     WREP1         DREP1
      *_____________
      * Leveringsdato
      *"""""""""""""
     C                   SELECT
     C                   WHEN      TXATAD <> 0
     C                   EVAL      D2005 = '35'
     C                   MOVEL     TXATAD        XAN12            12
     C                   MOVE      TXATAK        XAN12
     C                   WHEN      TXETAD <> 0
     C                   EVAL      D2005 = '17'
     C                   MOVEL     TXATAD        XAN12            12
     C                   MOVE      TXATAK        XAN12
     C                   OTHER
     C                   EVAL      D2005 = '2'
     C                   MOVEL     HEDTOP        XAN12            12
     C                   MOVE      '0000'        XAN12
     C                   ENDSL
     C                   EVAL      D2380 = XAN12
     C                   MOVEL     '102'         D2379
     C                   WRITE     DTMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                DTM46_F /
      *////////////////////////////////////////////////////////////
     C     DTM46_F       BEGSR
     C                   Z-ADD     1             WREP3
     C                   CLEAR                   DTMR
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     46            DGN
     C                   Z-ADD     WREP0         DREP0
     C                   Z-ADD     WREP1         DREP1
     C                   Z-ADD     WREP2         DREP2
     C                   Z-ADD     WREP3         DREP3
      *_____________
      * Fra dato
      *"""""""""""""
     C                   EVAL      D2005 = '133'
     C                   SELECT
     C                   WHEN      TXATDD > 0
     C                   MOVEL     TXATDD        XAN12            12
     C                   MOVE      TXATDK        XAN12
     C                   WHEN      TXETDD > 0
     C                   MOVEL     TXETDD        XAN12            12
     C                   MOVE      TXETDK        XAN12
     C                   OTHER
     C                   MOVEL     HEDTOP        XAN12            12
     C                   MOVE      '0000'        XAN12
     C                   ENDSL
     C                   EVAL      D2380 = XAN12
     C                   MOVEL     '203'         D2379
     C                   WRITE     DTMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                DTM46_T /
      *////////////////////////////////////////////////////////////
     C     DTM46_T       BEGSR
     C                   Z-ADD     1             WREP3
     C                   CLEAR                   DTMR
     C                   Z-ADD     WMN           DMN
     C                   Z-ADD     46            DGN
     C                   Z-ADD     WREP0         DREP0
     C                   Z-ADD     WREP1         DREP1
     C                   Z-ADD     WREP2         DREP2
     C                   Z-ADD     WREP3         DREP3
      *_____________
      * Til dato
      *"""""""""""""
     C                   EVAL      D2005 = '132'
     C                   SELECT
     C                   WHEN      TXATAD > 0
     C                   MOVEL     TXATAD        XAN12
     C                   MOVE      TXATAK        XAN12
     C                   WHEN      TXETAD > 0
     C                   MOVEL     TXETAD        XAN12
     C                   MOVE      TXETAK        XAN12
     C                   OTHER
     C                   MOVEL     HEDTOP        XAN12
     C                   MOVE      '0000'        XAN12
     C                   ENDSL
     C                   EVAL      D2380 = XAN12
     C                   MOVEL     '203'         D2379
     C                   WRITE     DTMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * EDIM0                                                EDIM0/
      *////////////////////////////////////////////////////////////
     C     EDIM0         BEGSR
     C                   CLEAR                   EDIMR
     C                   MOVEL     INSEID        M0004
     C                   MOVEL     INMOID        M0010
     C                   MOVEL     U0062A        M0062
     C                   MOVEL     U0065         M0065
     C                   MOVEL     U1004         M0068
     C                   MOVEL     U1001         M1001
     C                   MOVEL     U1004         M1004
     C                   Z-ADD     WMN           MMN
     C                   MOVE      'S'           MSR
     C                   MOVEL     WDATO         MDT
     C                   MOVEL     WTID          MTM
     C                   EVAL      MAVD = HEAVD
     C                   EVAL      MTDN = HEOPD
     C                   WRITE     EDIMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  FTX26 /
      *////////////////////////////////////////////////////////////
     C     FTX26         BEGSR
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   FTXR
     C                   Z-ADD     WMN           FMN
     C                   Z-ADD     26            FGN
     C                   Z-ADD     WREP0         FREP0
     C                   Z-ADD     WREP1         FREP1
      *_____________
      * Goodsbeskrivelse
      *"""""""""""""
     C                   EVAL      F4451  = 'AAA'
     C                   EVAL      F4440A = HEVS1
     C                   EVAL      F4440B = HEVS2
     C                   WRITE     FTXR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  FII02 /
      *////////////////////////////////////////////////////////////
     C     FII02         BEGSR
     C                   Z-ADD     1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   FIIR
     C                   Z-ADD     WMN           FMN
     C                   Z-ADD     2             FGN
     C                   Z-ADD     WREP0         FREP0
     C                   Z-ADD     WREP1         FREP1
      *_______________
      * Receiving Bank
      *"""""""""""""""
     C                   EVAL      F3035='BF'
     C                   EVAL      F3194='NO' + %TRIM(SYRG)
     C*                  EVAL      F3433='Sparebank 1'
     C*                  EVAL      F3434='SWIFT LABANOKK'
     C*                  EVAL      F3207='NO'
     C                   WRITE     FIIR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  LIN26 /
      *////////////////////////////////////////////////////////////
     C     LIN26         BEGSR

     C                   ADD       1             WREP0
     C                   CLEAR                   LINR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     26            LGN
     C                   Z-ADD     WREP0         LREP0
     C                   Z-ADD     WREP0         ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           L1082A
     C                   WRITE     LINR

     C                   EXSR      MEA26
     C                   EXSR      QTY26
     C                   EXSR      DTM26
     C                   EXSR      FTX26
     C                   EXSR      RFF30
     C*                  EXSR      PAC31
     C                   EXSR      NAD35
      *
     C                   MOVE      *ZEROS        X_BELN           13 2
     C*                  MOVE      *ZEROS        X_BELV           13 2
     C                   Z-ADD     0             WREP1
     C                   EXSR      ALC39
     C     INTKEY        READE     INTFAS                                 51
     C                   DOW       *IN51 = *OFF
     C                   IF        INUAVD = HEAVD AND INUOPD = HEOPD
     C                   EVAL      INST='X'
     C                   UPDATE    INTFASR
     C                   EXSR      ALC39
     C                   ELSE
     C                   LEAVE
     C                   END
     C     INTKEY        READE     INTFAS                                 51
     C                   ENDDO
      *
     C                   EXSR      MOA27
     C                   EXSR      TDT45

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  LOC10 /
      *////////////////////////////////////////////////////////////
     C     LOC10         BEGSR
     C                   Z-ADD     0             WREP1
      *___________________
      * Place of departure
      *"""""""""""""""""""
     C                   ADD       1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     10            LGN
     C                   Z-ADD     WREP0         LREP0
     C                   Z-ADD     WREP1         LREP1
     C                   EVAL      L3227='5'
     C                   EVAL      L3225='OSL'
     C                   WRITE     LOCR
      *__________________
      * Place of delivery
      *""""""""""""""""""
     C                   ADD       1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     10            LGN
     C                   Z-ADD     WREP0         LREP0
     C                   Z-ADD     WREP1         LREP1
     C                   EVAL      L3227='7'
     C                   EVAL      L3225='ANYWHERE'
     C                   WRITE     LOCR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  LOC12 /
      *////////////////////////////////////////////////////////////
     C     LOC12         BEGSR
     C                   Z-ADD     0             WREP1
      *___________________
      * Place of departure
      *"""""""""""""""""""
     C                   ADD       1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     12            LGN
     C                   Z-ADD     WREP0         LREP0
     C                   Z-ADD     WREP1         LREP1
     C                   EVAL      L3227='1'
     C                   EVAL      L3225='SAR'
     C                   EVAL      L3224='SARPSBORG'
     C                   WRITE     LOCR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  LOC46 /
      *////////////////////////////////////////////////////////////
     C     LOC46         BEGSR
     C                   Z-ADD     0             WREP2
      *___________________
      * Place of departure
      *"""""""""""""""""""
     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     46            LGN
     C                   ADD       1             WREP2
     C                   Z-ADD     WREP0         LREP0
     C                   Z-ADD     WREP1         LREP1
     C                   Z-ADD     WREP2         LREP2
     C                   EVAL      L3227='9'
     C     STED2DKF      CHAIN     STED2D                             33
     C                   EVAL      L3225=HESDF
     C                   EVAL      L3224=ST2NVN
     C                   WRITE     LOCR
      *
     C                   EXSR      DTM46_F
      *___________________
      * Place of delivery
      *"""""""""""""""""""
     C                   CLEAR                   LOCR
     C                   Z-ADD     WMN           LMN
     C                   Z-ADD     46            LGN
     C                   ADD       1             WREP2
     C                   Z-ADD     WREP0         LREP0
     C                   Z-ADD     WREP1         LREP1
     C                   Z-ADD     WREP2         LREP2
     C                   EVAL      L3227='7'
     C     STED2DKT      CHAIN     STED2D                             33
     C                   EVAL      L3225=HESDT
     C                   EVAL      L3224=ST2NVN
     C                   WRITE     LOCR
      *
     C                   EXSR      DTM46_T
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MEA26 /
      *////////////////////////////////////////////////////////////
     C     MEA26         BEGSR
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   MEAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     26            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   EVAL      M6311 = 'WT'
     C                   EVAL      M6313 = 'G'
     C                   EVAL      M6411 = 'KGM'
     C                   Z-ADD     HENT          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M6314
     C                   WRITE     MEAR
      *
     C                   IF        HEM3 > 0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         MREP1
     C                   EVAL      M6311 = 'VOL'
     C                   EVAL      M6313 = 'AAW'
     C                   EVAL      M6411 = 'MTQ'
     C                   Z-ADD     HEM3          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M6314
     C                   WRITE     QTYR
     C                   END
      *
     C                   IF        HELM > 0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         MREP1
     C                   EVAL      M6311 = 'LMT'
     C                   EVAL      M6313 = 'LN'
     C                   EVAL      M6411 = 'MTR'
     C                   Z-ADD     HELM          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M6314
     C                   WRITE     MEAR
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA27 /
      *////////////////////////////////////////////////////////////
     C     MOA27         BEGSR
     C                   Z-ADD     0             WREP1
      *____________
      * Bruttofrakt
      *""""""""""""
     C                   ADD       1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     27            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   MOVEL     '203'         M5025
     C*    INVAL         IFEQ      *BLANKS
     C*    INVAL         OREQ      'NOK'
     C                   EVAL      ØN153=X_BELN
     C                   MOVEL     'NOK'         M6345
     C*                  ELSE
     C*                  EVAL      ØN153=X_BELV
     C*                  MOVEL     INVAL         M6345
     C*                  ENDIF
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   WRITE     MOAR
     C*                  ADD       INBELN        WINBELN
     C*                  ADD       INBELV        WINBELV
     C*    INMVA         IFEQ      'J'
     C*                  ADD       INBELN        WINBELNM
     C*                  ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA42 /
      *////////////////////////////////////////////////////////////
     C     MOA42         BEGSR
     C*                  Z-ADD     0             WREP2
      *____________
      *
      *""""""""""""
     C                   ADD       1             WREP2
     C                   Z-ADD     0             WREP3
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     42            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   Z-ADD     WREP2         MREP2
     C                   EVAL      M5025 = '8'
     C*    INVAL         IFEQ      *BLANKS
     C*    INVAL         OREQ      'NOK'
     C                   EVAL      ØN153=INBELN
     C                   MOVEL     'NOK'         M6345
     C*                  ELSE
     C*                  EVAL      ØN153=INBELV
     C*                  MOVEL     INVAL         M6345
     C*                  ENDIF
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   WRITE     MOAR
      *
     C                   ADD       INBELN        WINBELN
     C                   ADD       INBELV        WINBELV
     C     INMVA         IFEQ      'J'
     C                   ADD       INBELN        WINBELNM
     C                   ENDIF
     C                   ADD       INBELN        X_BELN
     C*                  ADD       INBELV        X_BELV
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA44 /
      *////////////////////////////////////////////////////////////
     C     MOA44         BEGSR
     C                   Z-ADD     0             WREP3
      *____________
      * MVA
      *""""""""""""
     C                   ADD       1             WREP3
     C                   Z-ADD     0             WREP4
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     42            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   Z-ADD     WREP2         MREP2
     C                   Z-ADD     WREP3         MREP3
     C                   MOVEL     '124'         M5025
     C     INVAL         IFEQ      *BLANKS
     C     INVAL         OREQ      'NOK'
     C                   IF        INMVA = 'J'
     C                   EVAL      ØN153=INBELN*0,25
     C                   ELSE
     C                   EVAL      ØN153=0
     C                   END
     C                   MOVEL     'NOK'         M6345
     C                   ELSE
     C                   IF        INMVA = 'J'
     C                   EVAL      ØN153=INBELV*0,25
     C                   ELSE
     C                   EVAL      ØN153=0
     C                   END
     C                   MOVEL     INVAL         M6345
     C                   ENDIF
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   WRITE     MOAR
      *
      *____________
      * MVA GRUNNLAG
      *""""""""""""
     C                   ADD       1             WREP3
     C                   Z-ADD     WREP3         MREP3
     C                   MOVEL     '125'         M5025
     C     INVAL         IFEQ      *BLANKS
     C     INVAL         OREQ      'NOK'
     C                   EVAL      ØN153=INBELN
     C                   ELSE
     C                   EVAL      ØN153=INBELV
     C                   ENDIF
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   WRITE     MOAR
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA50 /
      *////////////////////////////////////////////////////////////
     C     MOA50         BEGSR
      *__________
      * Momsbelöp
      *""""""""""
     C                   Z-ADD     1             WREP0
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     50            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   MOVEL     '176'         M5025
     C                   EVAL      ØN153= WINBELNM * 0.25
     C                   EVAL      WMOMS=ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   MOVEL     'NOK'         M6345
     C                   WRITE     MOAR
      *_____________
      * Fakturabeløp
      *"""""""""""""
     C                   ADD       1             WREP0
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     50            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   MOVEL     '77'          M5025
     C*                  IF        C6345A='NOK'
     C                   Z-ADD     WINBELN       ØN153
     C                   ADD       WMOMS         ØN153
     C*                  ELSE
     C*                  Z-ADD     WINBELV       ØN153
     C*                  ENDIF
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C*                  MOVEL     INVAL         M6345
     C                   EVAL      M6345 = 'NOK'
     C                   WRITE     MOAR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA52 /
      *////////////////////////////////////////////////////////////
     C     MOA52         BEGSR
      *__________
      * Momsbelöp
      *""""""""""
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     52            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   MOVEL     '124'         M5025
     C                   EVAL      ØN153= WINBELNM * 0.25
     C                   EVAL      WMOMS=ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   MOVEL     'NOK'         M6345
     C                   WRITE     MOAR
      *_____________
      * Momsgrunnlag
      *"""""""""""""
     C                   ADD       1             WREP1
     C                   CLEAR                   MOAR
     C                   Z-ADD     WMN           MMN
     C                   Z-ADD     52            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   MOVEL     '125'         M5025
     C                   Z-ADD     WINBELN       ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M5004
     C                   MOVEL     'NOK'         M6345
     C                   WRITE     MOAR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  NAD02 /
      *////////////////////////////////////////////////////////////
     C     NAD02         BEGSR
      *________________
      * Vendor/Supplier
      *""""""""""""""""
     C                   CLEAR                   NADR
     C                   Z-ADD     WMN           NMN
     C                   Z-ADD     2             NGN
     C                   Z-ADD     1             WREP0
     C                   Z-ADD     WREP0         NREP0

     C                   MOVEL     'II'          N3035
     C     KODTAK        CHAIN     KODTA                              33
     C     CUNDL01KA     CHAIN     CUNDL01                            33
     C*                  MOVEL     KUNDNR        N3039
     C                   EVAL      N3039 = WINSEID
     C                   EVAL      N1131 = '9'
     C                   EVAL      N3036A=KNAVN
     C                   EVAL      N3042A=ADR1
     C                   EVAL      N3042B=ADR2
     C                   EVAL      N3164=ADR3
     C                   MOVEL     POSTNR        N3251
     C                   EVAL      N3207='NO'
     C                   WRITE     NADR

     C                   EXSR      FII02
     C                   EXSR      RFF03
     C                   EXSR      CTA05
      *______
      * Buyer
      *""""""
     C                   CLEAR                   NADR
     C                   Z-ADD     WMN           NMN
     C                   Z-ADD     2             NGN
     C                   ADD       1             WREP0
     C                   Z-ADD     WREP0         NREP0

     C                   MOVEL     'IV'          N3035
      * hente navn og adresse fra kunderegister.
     C     CUNDL01KK     CHAIN     CUNDL01                            61
     C                   EVAL      N3039 = WINMOID
     C                   EVAL      N1131 = '9'
     C                   EVAL      N3036A=KNAVN
     C                   EVAL      N3042A=ADR1
     C                   EVAL      N3042B=ADR2
     C                   EVAL      N3164=ADR3
     C                   MOVEL     POSTNR        N3251
     C                   EVAL      N3207=SYLAND
     C                   WRITE     NADR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  NAD35 /
      *////////////////////////////////////////////////////////////
     C     NAD35         BEGSR
     C                   Z-ADD     0             WREP1
      *________________
      * Selger
      *""""""""""""""""
     C                   CLEAR                   NADR
     C                   Z-ADD     WMN           NMN
     C                   Z-ADD     35            NGN
     C                   Z-ADD     WREP0         NREP0
     C                   ADD       1             WREP1
     C                   MOVE      WREP1         NREP1

     C                   MOVEL     'CZ'          N3035
     C                   MOVEL     HEKNS         N3039
     C                   EVAL      N1131 = 'ZZZ'
     C                   EVAL      N3036A=HENAS
     C                   EVAL      N3042A=HEADS1
     C                   EVAL      N3042B=HEADS2
     C     ' '           SCAN      HEADS3        XPOS              3 0    33
     C                   EVAL      N3164=%SUBST(HEADS3:XPOS+1:30-XPOS)
     C                   EVAL      N3251=%SUBST(HEADS3:1:31-XPOS)
     C                   EVAL      N3207=HELKA
     C                   WRITE     NADR

      *______
      * Leveringsadresse
      *""""""
     C                   CLEAR                   NADR
     C                   ADD       1             WREP1
     C                   Z-ADD     0             WREP2
     C                   CLEAR                   NADR
     C                   Z-ADD     WMN           NMN
     C                   Z-ADD     35            NGN
     C                   Z-ADD     WREP0         NREP0
     C                   Z-ADD     WREP1         NREP1

     C                   MOVEL     'DP'          N3035
     C                   EVAL      N3036A=HENAK
     C                   EVAL      N3042A=HEADK1
     C                   EVAL      N3042B=HEADK2
     C     ' '           SCAN      HEADK3        XPOS                     33
     C                   EVAL      N3164=%SUBST(HEADK3:XPOS+1:30-XPOS)
     C                   EVAL      N3251=%SUBST(HEADK3:1:31-XPOS)
     C                   EVAL      N3207=HETRI
     C                   WRITE     NADR

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  PAI00 /
      *////////////////////////////////////////////////////////////
     C     PAI00         BEGSR
     C                   Z-ADD     1             WREP0
     C                   CLEAR                   PAIR
     C                   Z-ADD     WMN           PMN
     C                   Z-ADD     0             PGN
     C                   Z-ADD     WREP0         PREP0
     C                   EVAL      P4439='1'
     C                   EVAL      P4431='14'
     C                   EVAL      P4461='ZZZ'
     C                   WRITE     PAIR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  PAT08 /
      *////////////////////////////////////////////////////////////
     C     PAT08         BEGSR
      *______________
      * Payment terms
      *""""""""""""""
     C                   Z-ADD     1             WREP0
     C                   CLEAR                   PATR
     C                   Z-ADD     WMN           PMN
     C                   Z-ADD     8             PGN
     C                   Z-ADD     WREP0         PREP0
     C                   MOVEL     '1'           P4279
     C                   WRITE     PATR
      *
     C*                  EXSR      DTM08
     C*                  EXSR      PCD08
     C*                  EXSR      MOA08
     C*                  EXSR      FII08
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  PRI28 /
      *////////////////////////////////////////////////////////////
     C     PRI28         BEGSR
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   PRIR
     C                   Z-ADD     WMN           PMN
     C                   Z-ADD     28            PGN
     C                   Z-ADD     WREP0         PREP0
     C                   Z-ADD     WREP1         PREP1
     C                   MOVEL     'INF'         P5125
     C                   MOVEL     '1'           P5118
     C                   MOVEL     'PE'          P5375
     C                   WRITE     PRIR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  QTY26 /
      *////////////////////////////////////////////////////////////
     C     QTY26         BEGSR
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   QTYR
     C                   Z-ADD     WMN           QMN
     C                   Z-ADD     26            QGN
     C                   Z-ADD     WREP0         QREP0
     C                   Z-ADD     WREP1         QREP1
     C                   EVAL      Q6063 = '106'
     C                   Z-ADD     HENT          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           Q6060
     C                   EVAL      Q6411 = 'PCE'
     C                   WRITE     QTYR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
     C                   Z-ADD     0             WREP0
      *_________________________
      * Consignor's reference No
      *"""""""""""""""""""""""""
     C                   CLEAR                   RFFR
     C                   Z-ADD     WMN           RMN
     C                   Z-ADD     1             RGN
     C                   ADD       1             WREP0
     C                   Z-ADD     WREP0         RREP0
     C                   EXSR      MOD10
     C                   MOVEL     'CU'          R1153
     C                   MOVEL     HERFA         R1154
     C                   WRITE     RFFR
      *___________________
      * Invoice Number
      *"""""""""""""""""""
     C                   CLEAR                   RFFR
     C                   Z-ADD     WMN           RMN
     C                   Z-ADD     1             RGN
     C                   ADD       1             WREP0
     C                   Z-ADD     WREP0         RREP0
     C                   MOVEL     'IV'          R1153
     C                   MOVEL     INFANR        R1154
     C                   WRITE     RFFR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF03 /
      *////////////////////////////////////////////////////////////
     C     RFF03         BEGSR
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   RFFR
     C                   Z-ADD     WMN           RMN
     C                   Z-ADD     3             RGN
     C                   Z-ADD     WREP0         RREP0
     C                   Z-ADD     WREP1         RREP1
      *___________
      * VAT number
      *"""""""""""
     C                   EVAL      R1153='VA'
     C                   EVAL      R1154=SYRG
     C                   WRITE     RFFR
      *
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         RREP1
     C                   EVAL      R1153='ADE'
     C                   EVAL      R1154=BANKG
     C                   WRITE     RFFR
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF30 /
      *////////////////////////////////////////////////////////////
     C     RFF30         BEGSR
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 33
     C                   DOW       *IN33 = *OFF
     C                   IF        FSKODE = 'CU'
     C                   Z-ADD     1             WREP1
     C                   CLEAR                   RFFR
     C                   Z-ADD     WMN           RMN
     C                   Z-ADD     30            RGN
     C                   Z-ADD     WREP0         RREP0
     C                   Z-ADD     WREP1         RREP1
     C                   MOVEL     FSKODE        R1153
     C                   MOVEL     FSSOK         R1154
     C                   WRITE     RFFR
     C                   LEAVE
     C                   END
     C     HEADFK        READE     FRISOK                                 33
     c                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for init                                        SRINIT /
      *////////////////////////////////////////////////////////////
     C     SRINIT        BEGSR
      *
     C     *ENTRY        PLIST
     C                   PARM                    WINSEID
     C                   PARM                    WINMOID
     C                   PARM                    UUFANR            7
      * HENTE DAGENS DATO OG TID
     C                   CALL      'SYGE15C'
     C                   PARM                    WDATO
     C                   PARM                    WTID
      * INIT AV ARBEIDSFELT
     C     *LIKE         DEFINE    DREP0         WREP0
     C     *LIKE         DEFINE    DREP1         WREP1
     C     *LIKE         DEFINE    DREP2         WREP2
     C     *LIKE         DEFINE    DREP3         WREP3
     C     *LIKE         DEFINE    DREP4         WREP4
     C     *LIKE         DEFINE    UMN           WMN
     C     *LIKE         DEFINE    INBELN        WINBELN
     C     *LIKE         DEFINE    INBELV        WINBELV
     C     *LIKE         DEFINE    INBELN        WINBELNM
     C     *LIKE         DEFINE    INBELN        WMOMS
     C     *LIKE         DEFINE    INST          WINST
     C     *LIKE         DEFINE    INSEID        WINSEID
     C     *LIKE         DEFINE    INMOID        WINMOID
     C     *LIKE         DEFINE    INFANR        WINFANR
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W_ØN153          15 3
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      UUFANR        WINFANR
     C                   EVAL      KOAUNI = 'A'
     C                   EVAL      KGEUNI = 'GE'
      * DEF AV KEYS
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    INUAVD
     C     KODTGEK       KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    INVK
     C     CUNDL01KA     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     CUNDL01KK     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    INKUNR
     C     INTKEY        KLIST
     C                   KFLD                    WINST
     C                   KFLD                    WINSEID
     C                   KFLD                    WINMOID
     C                   KFLD                    WINFANR
     C     HEADFK        KLIST
     C                   KFLD                    INUAVD
     C                   KFLD                    INUOPD
     C     STED2DKF      KLIST
     C                   KFLD                    HELKA
     C                   KFLD                    HESDF
     C     STED2DKT      KLIST
     C                   KFLD                    HETRI
     C                   KFLD                    HESDT
      *
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                    SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *________________________
      * Retreive message number
      *""""""""""""""""""""""""
     C     1             CHAIN     EDIC                               52
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   Z-ADD     CMN           WMN
     C                   MOVE      '1'           *IN41
      *_____________________
      * Les oppdragsregister
      *"""""""""""""""""""""
     C     HEADFK        CHAIN     HEADF                              52
      *_________________________
      * Les fakturatransaksjoner
      *"""""""""""""""""""""""""
     C     INTKEY        SETLL     INTFAS
     C     INTKEY        READE     INTFAS                                 51
     C     *IN51         DOWEQ     '0'
      *____________________________
      * Slett transkasjonspost
      *""""""""""""""""""""""""""""
     C                   EVAL      INST='X'
     C                   UPDATE    INTFASR
      *_____________________
      * Les oppdragsregister
      *"""""""""""""""""""""
     C     HEADFK        CHAIN     HEADF                              52
      *_________________
      * EDIFACT Detaljer
      *"""""""""""""""""
     C                   EXSR      LIN26
      *__________________
      * Les neste faktura
      *""""""""""""""""""
     C*    INTKEY        READE     INTFAS                                 51
     C                   ENDDO
     C*    INTKEY        SETLL     INTFAS
     C*    INTKEY        READE(N)  INTFAS                                 51
      *_________________
      * Hoveopplysninger
      *"""""""""""""""""
     C                   EXSR      SRB
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                    SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_____________
      * ADD SEGMENTS
      *"""""""""""""
     C                   EXSR      DTM00
     C*                  EXSR      PAI00
     C*                  EXSR      FTX00
     C                   EXSR      RFF01
     C                   EXSR      NAD02
     C                   EXSR      CUX07
     C                   EXSR      PAT08
     C                   EXSR      TOD12
     C                   EXSR      UNS00
     C                   EXSR      MOA50
     C                   EXSR      TAX52
      *_____________
      * WRITE TO UNH
      *"""""""""""""
     C                   EXSR      UNH00
      *______________
      * WRITE TO EDIM
      *""""""""""""""
     C                   EXSR      EDIM0
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leftjustify num.fields                              SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Remove neg sign.
     C                   IF        ØN153 < 0
     C                   Z-SUB     ØN153         ØN153
     C                   ENDIF
      * Move correct value into alpha 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA153D        IFEQ      '000'
     C                   MOVE      ØA153H        ØA12
     C                   ELSE
     C                   MOVEL     ØA153X        ØA12
     C                   MOVE      '.   '        ØA12
     C                   MOVE      ØA153D        ØA12
     C                   END
      * search from left and find first sign over 0
     C     1             DO        11            ØX
     C     Ø12(ØX)       IFNE      '0'
     C                   GOTO      SRNE1
     C                   END
     C                   END
     C     SRNE1         TAG
      * Leftjustify to a new field
     C     ØA153D        IFNE      '000'
     C     ØA153X        IFEQ      '00000000'
     C                   SUB       1             ØX
     C                   ENDIF
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TAX44 /
      *////////////////////////////////////////////////////////////
     C     TAX44         BEGSR
     C                   Z-ADD     0             WREP2
      *____________
      *
      *""""""""""""
     C                   ADD       1             WREP2
     C                   Z-ADD     0             WREP3
     C                   CLEAR                   TAXR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     44            TGN
     C                   Z-ADD     WREP0         TREP0
     C                   Z-ADD     WREP1         TREP1
     C                   Z-ADD     WREP2         TREP2
     C                   EVAL      T5283 = '7'
     C                   EVAL      T5153 = 'VAT'
     C                   IF        INMVA = 'J'
     C                   EVAL      T5278 = '25.00'
     C                   EVAL      T5305 = 'S'
     C                   ELSE
     C                   EVAL      T5278 = '0.00'
     C                   EVAL      T5305 = 'E'
     C                   ENDIF
     C                   WRITE     TAXR
      *
     C*                  EXSR      MOA44
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TAX52 /
      *////////////////////////////////////////////////////////////
     C     TAX52         BEGSR
      *__________
      * VAT
      *""""""""""
     C                   Z-ADD     1             WREP0
     C                   CLEAR                   TAXR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     52            TGN
     C                   Z-ADD     WREP0         TREP0
     C                   MOVEL     '7'           T5283
     C                   MOVEL     'VAT'         T5153
     C                   MOVEL     '25.00'       T5278
     C                   MOVEL     'S'           T5305
     C                   WRITE     TAXR

     C                   Z-ADD     TREP0         WREP0
     C                   EXSR      MOA52

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TDT45 /
      *////////////////////////////////////////////////////////////
     C     TDT45         BEGSR
     C                   Z-ADD     0             WREP1
      *_________
      * Main leg
      *"""""""""
     C                   CLEAR                   TODR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     45            TGN
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP0         TREP0
     C                   Z-ADD     WREP1         TREP1
     C                   EVAL      T8051='20'
     C                   EVAL      T8067='12'
     C                   WRITE     TDTR

     C                   EXSR      LOC46

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TOD12 /
      *////////////////////////////////////////////////////////////
     C     TOD12         BEGSR
     C                   Z-ADD     0             WREP0
     C                   Z-ADD     0             WREP1
      *_________
      * Main leg
      *"""""""""
     C                   CLEAR                   TODR
     C                   Z-ADD     WMN           TMN
     C                   Z-ADD     12            TGN
     C                   ADD       1             WREP0
     C                   Z-ADD     WREP0         TREP0
     C                   EVAL      T4055='6'
     C                   EVAL      T4215='CC'
     C                   EVAL      T4053=HEFR
     C                   WRITE     TODR

     C                   EXSR      LOC12

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * UNH00                                               UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
     C                   CLEAR                   UNHR
     C                   Z-ADD     WMN           UMN
     C                   MOVEL     WMN           U0062A
     C                   MOVEL     'INVOIC'      U0065
     C                   MOVEL     'D'           U0052
     C                   MOVEL     '01B'         U0054
     C                   MOVEL     'UN'          U0051
     C*                  MOVEL     'GEIINV'      U0057
     C                   IF        INBELN >= 0
     C                   MOVEL     '780'         U1001
     C                   ELSE
     C                   MOVEL     '381'         U1001
     C                   END
     C                   MOVEL     INFANR        U1004
     C                   MOVEL     '9'           U1225
     C                   MOVEL     U0062A        U0062B
     C                   WRITE     UNHR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  UNS00 /
      *////////////////////////////////////////////////////////////
     C     UNS00         BEGSR
     C                   Z-ADD     1             WREP0
     C                   CLEAR                   UNSR
     C                   Z-ADD     WMN           UMN
     C                   Z-ADD     0             UGN
     C                   Z-ADD     WREP0         UREP0
     C                   MOVEL     'S'           U0081
     C                   WRITE     UNSR
     C                   ENDSR
      *_________________________________________
      *  MOD10     -    UTREGNING AV MOD-10 KONTROLLFELT (WBAK)
      *""""""""""""""""""""""""""""""""""""""""""
     C     MOD10         BEGSR
     C*                  Z-ADD     WB07          WKID1
     C*                  Z-ADD     WB06          WKID2
     C*                  Z-ADD     0             WKID3
     C*                  MOVE      *ZEROS        WKID4            21
     C*                  MOVE      WKID          WKID4
     C*                  CALL      'SYGE09'
     C*                  PARM                    WKID4
     C*                  PARM                    WKID5             1 0
     C*                  MOVE      WKID5         WKID6             1 0
      *
     C*                  MOVEL     WKID          XKID1
     C*                  Z-ADD     WKID6         XKID2
     C                   ENDSR
