     FTACTL01   IF   e           K DISK
     FAIRLD     O  A E           K DISK
     c     *entry        plist
     c                   parm                    airlinp           3
     c                   parm                    tacar1
     c                   parm                    airpfr
     c                   parm                    airpto
     c                   parm                    taflig
     c                   move      airlinp       airlin
     c*
     c     key           klist
     c                   kfld                    tacar1
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   kfld                    taflig
     c*
     c                   exsr      finccp
      *
     c
     c     key           setll     tactl01
     c     *in33         doweq     '0'
     c     key           reade     tactl01                                33
     c     *in33         ifeq      '0'
     C     TAKOD1        ANDNE     'SC'
      * blank er iata-pris
     c     tavekt        ifeq      0
     c                   z-add     tabelo        mini              9 2
     c                   else
     c     tavekt        ifeq      1
     c                   z-add     tabelo        norm              9 2
     c                   else
     c     tavekt        sub       1             airwei
     c     mini          ifne      0
     c                   z-add     mini          airgrn
     c                   z-add     norm          airawb
     c                   move      *zeros        mini
     c                   move      *zeros        norm
     c                   move      'N'           aircod
      * skriv N-record
     c                   write     airldr
     c                   z-add     tabelo        forige            9 2
     c                   z-add     0             airgrn
     c                   else
     c     tavekt        sub       1             airwei
     c                   z-add     forige        airawb
     c                   z-add     tabelo        forige
      * skriv N-record
     c                   move      'Q'           aircod
     c                   write     airldr
     c                   end
     c                   end
     c                   end
     c                   end
     c                   end
     c                   z-add     99999         airwei
     c                   z-add     forige        airawb
      * skriv Q-record
     c     norm          ifeq      0
     c     mini          andeq     0
     c                   move      'Q'           aircod
     c                   else
     c                   move      'N'           aircod
     c                   z-add     mini          airgrn
     c                   z-add     norm          airawb
     c                   end
     c                   write     airldr
     c                   seton                                        lr
     c                   return
      *************************************************************************
     c     finccp        begsr
      *************************************************************************
     c     taflig        ifeq      'SK01'
     c                   move      'P'           airccp
     c                   end
     c     taflig        ifeq      'SK02'
     c                   move      ' '           airccp
     c                   end
     c     taflig        ifeq      'LH40'
     c                   move      'Z'           airccp
     c                   end
     c                   endsr
