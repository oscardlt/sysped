********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO
10262 * 02 YBC PTF10 SATS ER UTVIDERT TIL 7.2, INGEN MERKING
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT TOLLTARIFF                   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-40 46-50 56-60    ***
      ***                    66-70 73-98                      ***
      ***********************************************************
      *
     FKODTFM    IF   E           K DISK
     FTARI      IF   E           K DISK
     FSAD011FM  CF   E             WORKSTN
     FDATALIST  O    F  198        PRINTER OFLIND(*INOF)
     F                                     FORMLEN(48)
     F                                     FORMOFL(43)
     D                 DS
S01  D* TAALL                  1    228
N01  D  TAALL                  1    388
     D  TATANR                 1      8  0
     D  TATAR                  9     11
     D  TADATO                12     19  0
     D  TAORDK                20     20
     D  TAORDB                21     27  2
     D  TAEFTK                28     28
     D  TAEFTB                29     35  2
     D  TAEFK                 36     36
     D  TAEFB                 37     43  2
     D  TATXT                 44    123
     D  TAKAPN               124    125  0
     D  TAALFA               126    140
     D  TASTK                141    141
     D  TAKAP                142    142
     D  TAKAPA               143    146
     D  TAENHE               147    149
     D  TAREST               150    151
     D  TAKDAÆ               152    153
     D  TAKDSÆ               154    156
     D  TAEØSB               157    163  2
     D  TAEØSK               164    164
     D  TATSJB               165    171  2
     D  TATSJK               172    172
     D  TATYRB               173    179  2
     D  TATYRK               180    180
     D  TAISRB               181    187  2
     D  TAISRK               188    188
     D  TAELLB               189    195  2
     D  TAELLK               196    196
     D  TABULB               197    203  2
     D  TABULK               204    204
     D  TAPOLB               205    211  2
     D  TAPOLK               212    212
     D  TAROMB               213    219  2
     D  TAROMK               220    220
     D  TAUNGB               221    227  2
     D  TAUNGK               228    228
     D  TASLOB               229    235  2
     D  TASLOK               236    236
     D  TAMULB               237    243  2
     D  TAMULK               244    244
     D  TAOULB               245    251  2
     D  TAOULK               252    252
     D  TAGRLB               253    259  2
     D  TAGRLK               260    260
     D  TAFÆRB               261    267  2
     D  TAFÆRK               268    268
     D  TAISTB               269    275  2
     D  TAISTK               276    276
     D  TAMARB               277    283  2
     D  TAMARK               284    284
     D  TAMEXB               285    291  2
     D  TAMEXK               292    292
     D  TAVGAB               293    299  2
     D  TAVGAK               300    300
     D  TAN01B               301    307  2
     D  TAN01K               308    308
     D  TAN02B               309    315  2
     D  TAN02K               316    316
     D  TAN03B               317    323  2
     D  TAN03K               324    324
     D  TAN04B               325    331  2
     D  TAN04K               332    332
     D  TAN05B               333    339  2
     D  TAN05K               340    340
     D  TAN06B               341    347  2
     D  TAN06K               348    348
     D  TAN07B               349    355  2
     D  TAN07K               356    356
     D  TAN08B               357    363  2
     D  TAN08K               364    364
     D  TAN09B               365    371  2
     D  TAN09K               372    372
     D  TAN10B               373    379  2
     D  TAN10K               380    380
N01  D  TADTS                381    388  0
     D                 DS
S01  D* XAALL                  1    228
N01  D  XAALL                  1    388
     D  XATANR                 1      8  0
     D  XATAR                  9     11
     D  XADATO                12     19  0
     D  XAORDK                20     20
     D  XAORDB                21     27  2
     D  XAEFTK                28     28
     D  XAEFTB                29     35  2
     D  XAEFK                 36     36
     D  XAEFB                 37     43  2
     D  XATXT                 44    123
     D  XAKAPN               124    125  0
     D  XAALFA               126    140
     D  XASTK                141    141
     D  XAKAP                142    142
     D  XAKAPA               143    146
     D  XAENHE               147    149
     D  XAREST               150    151
     D  XAKDAÆ               152    153
     D  XAKDSÆ               154    156
     D  XAEØSB               157    163  2
     D  XAEØSK               164    164
     D  XATSJB               165    171  2
     D  XATSJK               172    172
     D  XATYRB               173    179  2
     D  XATYRK               180    180
     D  XAISRB               181    187  2
     D  XAISRK               188    188
     D  XAELLB               189    195  2
     D  XAELLK               196    196
     D  XABULB               197    203  2
     D  XABULK               204    204
     D  XAPOLB               205    211  2
     D  XAPOLK               212    212
     D  XAROMB               213    219  2
     D  XAROMK               220    220
     D  XAUNGB               221    227  2
     D  XAUNGK               228    228
     D  XASLOB               229    235  2
     D  XASLOK               236    236
     D  XAMULB               237    243  2
     D  XAMULK               244    244
     D  XAOULB               245    251  2
     D  XAOULK               252    252
     D  XAGRLB               253    259  2
     D  XAGRLK               260    260
     D  XAFÆRB               261    267  2
     D  XAFÆRK               268    268
     D  XAISTB               269    275  2
     D  XAISTK               276    276
     D  XAMARB               277    283  2
     D  XAMARK               284    284
     D  XAMEXB               285    291  2
     D  XAMEXK               292    292
     D  XAVGAB               293    299  2
     D  XAVGAK               300    300
     D  XAN01B               301    307  2
     D  XAN01K               308    308
     D  XAN02B               309    315  2
     D  XAN02K               316    316
     D  XAN03B               317    323  2
     D  XAN03K               324    324
     D  XAN04B               325    331  2
     D  XAN04K               332    332
     D  XAN05B               333    339  2
     D  XAN05K               340    340
     D  XAN06B               341    347  2
     D  XAN06K               348    348
     D  XAN07B               349    355  2
     D  XAN07K               356    356
     D  XAN08B               357    363  2
     D  XAN08K               364    364
     D  XAN09B               365    371  2
     D  XAN09K               372    372
     D  XAN10B               373    379  2
     D  XAN10K               380    380
N01  D  XADTS                381    388
     C*
     C     *ENTRY        PLIST
     C     LASER         PARM      LASER         LASER             1
     C     STRING        PARM      STRING        STRING            5
     C     COPY          PARM      COPY          COPY              2 0
     C*
     C     STRING        IFNE      *BLANKS
     C     STRING        CHAIN     KODTFM                             33
     C                   END
     C     LASER         IFEQ      'A'
     C                   SETON                                        88
     C                   END
     C     TARIK         KLIST
     C                   KFLD                    WSFRA
     C                   KFLD                    XTAR
     C                   MOVE      *BLANKS       XTAR              3
     C*
     C                   EXSR      GETMSG
     C                   Z-ADD     -1            XKAP2
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     C                   SETOFF                                       30
     C   03              GOTO      SLUTT
     C*
     C     WSFRA         COMP      WSTIL                              99
     C   99              MOVE      'SPD0007'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      START
     C*
     C                   MOVE      *ZEROS        XATANR
     C     TARIK         SETLL     TARI
     C     START2        TAG
     C                   READ      TARI                                   60
     C  N60TATANR        COMP      WSTIL                              60
     C   60XPRT          IFEQ      'J'
     C                   MOVE      'N'           XPRT              1
     C                   GOTO      START3
     C                   END
     C  N60              DO
     C                   MOVE      'J'           XPRT
     C     TATANR        IFEQ      XATANR
     C                   MOVE      TAALL         XAALL
     C                   GOTO      START2
     C                   END
     C     START3        TAG
     C                   MOVE      XAALL         XAALL2          228
     C                   MOVE      TAALL         XAALL
     C                   MOVE      XAALL2        TAALL
     C                   MOVEL     TATANR        XKAP              4 0
     C     XKAP          IFNE      XKAP2
     C  N33              EXCEPT    DLHEAD
     C  N33              SETON                                        33
     C   OF              EXCEPT    DLHEAD
     C                   EXCEPT    DLKAP
     C                   MOVE      XKAP          XKAP2             4 0
     C                   END
     C*
     C     TAORDK        COMP      'F'                                    41
     C     TAORDK        COMP      'P'                                    42
     C     TAORDK        COMP      'W'                                    43
     C     TAORDK        COMP      'V'                                    44
     C     TAORDK        COMP      'A'                                    45
     C     TAEFTK        COMP      'F'                                    51
     C     TAEFTK        COMP      'P'                                    52
     C     TAEFTK        COMP      'W'                                    53
     C     TAEFTK        COMP      'V'                                    54
     C     TAEFTK        COMP      'A'                                    55
     C     TAEFK         COMP      'F'                                    61
     C     TAEFK         COMP      'P'                                    62
     C     TAEFK         COMP      'W'                                    63
     C     TAEFK         COMP      'V'                                    64
     C     TAEFK         COMP      'A'                                    65
     C*
     C     TAKAP         COMP      *BLANKS                            7171
     C     TASTK         COMP      'J'                                    72
     C                   MOVEL     TAREST        XREST1            1
     C                   MOVE      TAREST        XREST2            1
     C                   MOVE      TATANR        XTANR4            4 0
     C*
     C   OF              EXCEPT    DLHEAD
     C                   EXCEPT    DLDET
     C  N60              GOTO      START2
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     GETMSG        BEGSR
     C***********************************************
     C                   MOVE      'DIV1393'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     90            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT1            90
     C                   MOVE      'DIV1394'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     90            XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT2            90
     C                   MOVE      'DIV1395'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     4             XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT3             4
     C                   MOVE      'DIV1396'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     3             XMSGL
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XTXT4             3
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETTXT        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG            100
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     O*
     ODATALIST  E            DLHEAD           01
     O                       KFMT1               75
     ODATALIST  E            DLHEAD           02
     O                       KFMT2               75
     O               88                          90 '¤&l'
     O               88      COPY                92
     O               88                          93 'X'
     O               88                         100 '¤(s12H'
     O               88                         106 '¤&l1O'
     ODATALIST  E            DLHEAD           03
     O               88                          10 '¤&a-3R'
     O               88                          35 '¤(12U¤(s0p20h0s3b4099T'
     ODATALIST  E            DLHEAD           03
     O               88                          24 '¤*c3350A¤*c190B¤*c11G¤*c'
     O               88                          26 '2P'
     ODATALIST  E            DLHEAD           04
     O                                           24 '------------------------'
     O                                           48 '------------------------'
     O                                           72 '------------------------'
     O                                           96 '------------------------'
     O                                          120 '------------------------'
     O                                          144 '------------------------'
     O                                          168 '------------------------'
     O          E            DLHEAD           05
     O                       XTXT1               90
     O                       XTXT2              180
     O          E            DLKAP            06
     O                                           24 '------------------------'
     O                                           48 '------------------------'
     O                                           72 '------------------------'
     O                                           96 '------------------------'
     O                                          120 '------------------------'
     O                                          144 '------------------------'
     O                                          168 '------------------------'
     O          E            DLKAP          2 06
     O               88                          25 '¤(12U¤(s0p20h0s0b4099T'
     O          E            DLKAP       1  0
     O                       XKAP                10 '  .  '
     O                       TAALFA              27
     O          E            DLKAP          2
     O                       XKAP                10 '  .  '
     O                       TAALFA              27
     O          E            DLDET          1
     O                       XREST1               1
     O                       XREST2               3
     O                                            7 '.'
     O                       XTANR4              11
     O                       TATXT              108
     O               41      XTXT3              115
     O               42      TAORDB             122 '   0 ,  '
     O               42                         123 '%'
     O               43      TAORDB             122 '   0 ,  '
     O               43                         126 'p100'
     O               44      TAORDB             122 '   0 ,  '
     O               45      TAORDB             122 '   0 ,  '
     O               45      TAENHE             125
     O               51      XTXT3              131
     O               52      TAEFTB             138 '   0 ,  '
     O               52                         139 '%'
     O               53      TAEFTB             138 '   0 ,  '
     O               53                         140 'p100'
     O               54      TAEFTB             138 '   0 ,  '
     O               55      TAEFTB             138 '   0 ,  '
     O               55      TAENHE             141
     O               61      XTXT3              147
     O               62      TAEFB              154 '   0 ,  '
     O               62                         155 '%'
     O               63      TAEFB              154 '   0 ,  '
     O               63                         158 'p100'
     O               64      TAEFB              154 '   0 ,  '
     O               65      TAEFB              154 '   0 ,  '
     O               65      TAENHE             157
     O               71      TAKAP              173
     O               71      TAKAPA             177
     O               72      XTXT4              167
