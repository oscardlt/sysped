      *
      ************************************************************
      * SKRIV UT OPPDRAGSSTATISTIKK BASET PÅ INNPARAM. FRA SYST01A
      ************************************************************
      *
     FHEADDT    IF   E           K DISK
     FHEADDTU   IF   E           K DISK
     F                                     RENAME(HEADFR:HEADFUR)
     FFIRM      IF   E           K DISK
     FKODTV     IF   E           K DISK
     FFAKT      IF   E           K DISK
     FFAK10     IF   E           K DISK
     F                                     RENAME(FAKTR:FAKT10R)
     FCUNDL01   IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FWST01     UF A E           K DISK
     FSYST01PE  O    E             PRINTER OFLIND(*IN98)
     FSYST01PF  O    E             PRINTER OFLIND(*IN99)
      * Antall sendinger pr/vg DETALJ (ETT statistikkbrudd)
      * B-Vekt pr vektgr
      * Vekt pr vektgr
      * Antall sendinger pr/vg TOTALT
     D AT              S              7  0 DIM(12)
      * B-Vekt pr vektgr TOTALT
     D BT              S              9  0 DIM(12)
      * Vekt pr vektgr TOTALT
     D VT              S              9  0 DIM(12)
      * KUNDENR SOM FINNES SOM PART PÅ OPPDRAG EL FAKTURA...
     D KKK             S              8  0 DIM(20)
      * Include/omit Avdelinger
      * Include/omit Faktura kunder
      * Include/omit Varemottaker kunder  ("Part")
      * Include/omit Flyselskap
      * Include/omit Oppdragstyper
      * Include/omit Frankaturer
      * Include/omit Landkoder..
      * Include/omit Frasted  ..
      * Include/omit Tilsted  ..
      * Include/omit "Urspr.kode"
      *___________________________
      * Finner Jobnbr
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  KOVK1                  1      5  0
     D  KOVK2                  6     10  0
     D  KOVK3                 11     15  0
     D  KOVK4                 16     20  0
     D  KOVK5                 21     25  0
     D  KOVK6                 26     30  0
     D  KOVK7                 31     35  0
     D  KOVK8                 36     40  0
     D  KOVK9                 41     45  0
     D  KOVK10                46     50  0
     D  KOVK11                51     55  0
     D  KOVK12                56     60  0
     D  FF                     1     60  0 DIM(12) ASCEND
     D                 DS
     D  AD01                   1      7  0
     D  AD02                   8     14  0
     D  AD03                  15     21  0
     D  AD04                  22     28  0
     D  AD05                  29     35  0
     D  AD06                  36     42  0
     D  AD07                  43     49  0
     D  AD08                  50     56  0
     D  AD09                  57     63  0
     D  AD10                  64     70  0
     D  AD11                  71     77  0
     D  AD12                  78     84  0
     D  AD                     1     84  0 DIM(12)
     D                 DS
     D  BD01                   1      9  0
     D  BD02                  10     18  0
     D  BD03                  19     27  0
     D  BD04                  28     36  0
     D  BD05                  37     45  0
     D  BD06                  46     54  0
     D  BD07                  55     63  0
     D  BD08                  64     72  0
     D  BD09                  73     81  0
     D  BD10                  82     90  0
     D  BD11                  91     99  0
     D  BD12                 100    108  0
     D  BD                     1    108  0 DIM(12)
     D                 DS
     D  VD01                   1      9  0
     D  VD02                  10     18  0
     D  VD03                  19     27  0
     D  VD04                  28     36  0
     D  VD05                  37     45  0
     D  VD06                  46     54  0
     D  VD07                  55     63  0
     D  VD08                  64     72  0
     D  VD09                  73     81  0
     D  VD10                  82     90  0
     D  VD11                  91     99  0
     D  VD12                 100    108  0
     D  VD                     1    108  0 DIM(12)
      *
      * DS. FOR PARAMETER 1...
     D                 DS
     D  DSUTV1                 1    256
     D  WSDTF                  2      7  0                                             ÅÅMMDD
     D  WSDTT                  8     13  0                                             ÅÅMMDD
     D  WSBEL                 14     14
     D  WSOTIO                15     15
     D  WSOT01                16     17
     D  WSOT02                18     19
     D  WSOT03                20     21
     D  WSOT04                22     23
     D  WSOT05                24     25
     D  WSOT06                26     27
     D  WSOT07                28     29
     D  WSOT08                30     31
     D  WSOT09                32     33
     D  WSOT10                34     35
     D  IOT                   16     35    DIM(10)
     D  IOT310                20     35
     D*
     D  WSFRIO                36     36
     D  WSFR01                37     39
     D  WSFR02                40     42
     D  WSFR03                43     45
     D  WSFR04                46     48
     D  WSFR05                49     51
     D  WSFR06                52     54
     D  WSFR07                55     57
     D  WSFR08                58     60
     D  WSFR09                61     63
     D  WSFR10                64     66
     D  IFR                   37     66    DIM(10)
     D  IFR310                43     66
     D*
     D  WSAVIO                67     67
     D  WSAV01                68     71  0
     D  WSAV02                72     75  0
     D  WSAV03                76     79  0
     D  WSAV04                80     83  0
     D  WSAV05                84     87  0
     D  WSAV06                88     91  0
     D  WSAV07                92     95  0
     D  WSAV08                96     99  0
     D  WSAV09               100    103  0
     D  WSAV10               104    107  0
     D  IAV                   68    107  0 DIM(10)
     D  IAV310                76    107
     D* KUNDENR FAKT.MOT.
     D  WSFKIO               108    108
     D  WSFK01               109    116  0
     D  WSFK02               117    124  0
     D  WSFK03               125    132  0
     D  WSFK04               133    140  0
     D  WSFK05               141    148  0
     D  WSFK06               149    156  0
     D  WSFK07               157    164  0
     D  WSFK08               165    172  0
     D  WSFK09               173    180  0
     D  WSFK10               181    188  0
     D  IFK                  109    188  0 DIM(10)
     D  IFK310               125    188
     D*
     D  WSLKIO               189    189
     D  WSLK01               190    191
     D  WSLK02               192    193
     D  WSLK03               194    195
     D  WSLK04               196    197
     D  WSLK05               198    199
     D  WSLK06               200    201
     D  WSLK07               202    203
     D  WSLK08               204    205
     D  WSLK09               206    207
     D  WSLK10               208    209
     D  ILK                  190    209    DIM(10)
     D  ILK310               194    209
     D*
     D  WSURIO               210    210
     D  WSUR01               211    211
     D  WSUR02               212    212
     D  WSUR03               213    213
     D  WSUR04               214    214
     D  WSUR05               215    215
     D  WSUR06               216    216
     D  WSUR07               217    217
     D  WSUR08               218    218
     D  WSUR09               219    219
     D  WSUR10               220    220
     D  IUR                  211    220    DIM(10)
     D  IUR310               213    220
      *
     D  WSLAYO               246    250
     D  WSTYPE               251    255
     D  WSTYP3               251    253
     D* PARAMETER SOM DATASTRUKTUR MAN IKKE AVSLUTTE MED BLANK.....
     D  DUMMY1               256    256
      *
     D* DS. FOR PARAMETER 2...
     D                 DS
     D  DSUTV2                 1    256
     D* BLANK ETTER SPLITT...1-9
     D* FRA-STED
     D  WSFSIO                10     10
     D  WSFS01                11     15
     D  WSFS02                16     20
     D  WSFS03                21     25
     D  WSFS04                26     30
     D  WSFS05                31     35
     D  WSFS06                36     40
     D  WSFS07                41     45
     D  WSFS08                46     50
     D  WSFS09                51     55
     D  WSFS10                56     60
     D  IFS                   11     60    DIM(10)
     D  IFS310                21     60
     D* TIL-STED
     D  WSTSIO                61     61
     D  WSTS01                62     66
     D  WSTS02                67     71
     D  WSTS03                72     76
     D  WSTS04                77     81
     D  WSTS05                82     86
     D  WSTS06                87     91
     D  WSTS07                92     96
     D  WSTS08                97    101
     D  WSTS09               102    106
     D  WSTS10               107    111
     D  ITS                   62    111    DIM(10)
     D  ITS310                72    111
     D* KUNDENR "PART" (KJØPER/SELGER)
     D  WSKNIO               112    112
     D  WSKN01               113    120  0
     D  WSKN02               121    128  0
     D  WSKN03               129    136  0
     D  WSKN04               137    144  0
     D  WSKN05               145    152  0
     D  WSKN06               153    160  0
     D  WSKN07               161    168  0
     D  WSKN08               169    176  0
     D  WSKN09               177    184  0
     D  WSKN10               185    192  0
     D  IKN                  113    192  0 DIM(10)
     D  IKN310               129    192
     D* FLYSELSKAP
     D  WSFLIO               193    193
     D  WSFL01               194    196  0
     D  WSFL02               197    199  0
     D  WSFL03               200    202  0
     D  WSFL04               203    205  0
     D  WSFL05               206    208  0
     D  WSFL06               209    211  0
     D  WSFL07               212    214  0
     D  WSFL08               215    217  0
     D  WSFL09               218    220  0
     D  WSFL10               221    223  0
     D  IFL                  194    223  0 DIM(10)
     D  IFL310               200    223
     D* PARAMETER SOM DATASTRUKTUR MAN IKKE AVSLUTTE MED BLANK.....
     D  DUMMY2               256    256
     D*
     D* DATASRUKTUR FOR KEYFELTET I STATISTIKK WORKFIL
     D                 DS
     D  WKEY1                  1     10
     D  WKEY2                 11     15
     D  WKE2GN                11     25
     D  WKEY3                 20     24
     D  WKEY4                 25     29
     D  WKEY5                 30     34
     D  WKEY6                 35     39
     D  WSTKEY                 1     39
     D                 DS
     D  WTIME                  1     14  0
     D  TID                    1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     C*
     C                   EXSR      INIT
      *
     C     WSURIO        IFNE      'I'
     C                   MOVE      '0'           *IN50
     C                   EXSR      SELSOR
     C                   ELSE
     C                   MOVE      '1'           *IN50
     C                   SORTA     IUR
     C                   Z-ADD     10            NR                2 0
     C     IUR(NR)       DOWNE     ' '
     C                   MOVE      IUR(NR)       HEUR
     C                   EXSR      SELSOR
     C                   SUB       1             NR                       33
     C  N33              END
     C                   END
      *
     C                   EXSR      PRINT
      *
     C                   EXSR      GRATOT
      *
     C                   EXSR      TØMWRK
      *
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SELSOR        BEGSR
     C***********************************************
      * Selekter/sorter poster som skal være med
     C  N50DATOFK        SETLL     HEADDT
     C   50URDTFK        SETLL     HEADDTU
      *
     C  N50              READ      HEADDT                                 94
     C   50HEUR          READE     HEADDTU                                94
      * Hvis dato for høy på 1. post ikke vits i å lete mer
     C     *IN94         IFEQ      '0'
     C     HEDTOP        ANDGT     WSDTT8
     C                   MOVE      '1'           *IN94
     C                   END
      *
     C     *IN94         DOWEQ     '0'                                          B1
     C                   EXSR      INCOMI
      * Hvis posten skal med, legg avd/opdnr ut i workfile m/sortering
     C     INCLUD        IFEQ      'J'
     C                   EXSR      SKRIVW
     C                   END
      *
     C  N50              READ      HEADDT                                 94
     C   50HEUR          READE     HEADDTU                                94
      * Forbi tildato??
     C     *IN94         IFEQ      '0'
     C     HEDTOP        ANDGT     WSDTT8
     C                   MOVE      '1'           *IN94
     C                   END
      *
     C                   END                                                    B1
      *
      *
     C                   ENDSR
     C***********************************************
     C     SKRIVW        BEGSR
     C***********************************************
      * KONPONERE KEY...
      *
     C     WSTYP3        IFEQ      'FSE'
     C                   MOVEL     FLYSEL        WKEY1
     C                   END
     C     WSTYPE        IFEQ      'FSEAW'
     C                   MOVE      HEGN          WKE2GN
     C                   END
     C     WSTYPE        IFEQ      'FSEDE'
     C                   MOVE      HESDF         WKEY2
     C                   MOVE      HESDT         WKEY4
     C                   END
     C     WSTYPE        IFEQ      'FSESA'
     C                   MOVE      HENAA         WSTKEY
     C                   END
      *
      * Hent beløp
     C     WSBEL         IFEQ      'J'
     C                   EXSR      BELØP
     C                   END
      *
     C                   WRITE     WST01R
      *
      *
     C     UTSKW         ENDSR
      *
     C***********************************************
     C     BELØP         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSTINT
     C                   MOVE      *ZEROS        WSTKOS
     C                   MOVE      *ZEROS        WSTFCC                          CCFrakt
     C                   MOVE      *ZEROS        WSTICC                          CCinntekter
     C                   MOVE      *ZEROS        WSTFPP                          PPFrakt
     C                   MOVE      *ZEROS        WSTIPP                          PPinntekter
     C                   MOVE      *ZEROS        WSTISA                          SAmlast-int
      *
     C     FAKKEY        SETLL     FAKT
      *
     C     FAKKEY        READE     FAKT                                   33
     C     *IN33         DOWEQ     '0'
     C* NÅR KOSTN.SYSTEM EVT. TAS I BRUK MÅ DISSE LINJER AKTIVERES
     C     FAKDA         IFNE      'K'
     C                   ADD(H)    FABELN        WSTINT
     C* Hvis flyselskapsrap. Eksport skill CC/PP....
     C     WSTYP3        IFEQ      'FSE'
     C                   EXSR      CCPP
     C                   END
     C                   ELSE
     C                   ADD(H)    FABELN        WSTKOS
     C                   END
      *
     C     FAKKEY        READE     FAKT                                   33
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CCPP          BEGSR
     C***********************************************
      * Chaine fraktbrev?????
     C                   SELECT
     C     FASK          WHENEQ    'F'
     C     FAVK          IFEQ      'FFE'
     C     FAVK          OREQ      'AWB'
     C     FAVK          OREQ      'AW '
     C     FAVK          OREQ      'MC '
     C                   ADD       FABELN        WSTFCC                          CCfrakt
     C                   ELSE
     C                   ADD       FABELN        WSTICC                          CCinntekter
     C                   END
     C     FASK          WHENEQ    'S'
     C                   ADD       FABELN        WSTISA                          SAmlast-int
     C                   OTHER
     C     FAVK          IFEQ      'FFE'
     C     FAVK          OREQ      'AWB'
     C     FAVK          OREQ      'AW '
     C     FAVK          OREQ      'MC '
     C                   ADD       FABELN        WSTFPP                          PPfrakt
     C                   ELSE
     C                   ADD       FABELN        WSTIPP                          PPinntekter
     C                   END
     C                   ENDSL
     C                   ENDSR
      *
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C                   MOVE      'N'           MINST1            1
     C     WSTUNI        SETLL     WST01
      *
     C     WSTUNI        READE     WST01                                  94
     C     *IN94         IFEQ      '0'
      *Hindre brudd ved 1. / sikre at siste brudd(ved EOF) blir skrevet
     C                   MOVE      WSTKEY        FORIGE           39
     C                   MOVE      'J'           MINST1
     C                   END
      *
     C     *IN94         DOWEQ     '0'                                          B1
      * Hvis ulik forige key, skriv total for FORIGE begrep (key)
     C     WSTKEY        IFNE      FORIGE
     C                   MOVEL     FORIGE        TXBRUD           39
     C     WSTYPE        IFEQ      'XXXXX'
     C                   MOVEL     FORIGE        KUNDEF            8
     C                   MOVE      KUNDEF        YYKUND
     C     KUNKEY        CHAIN     CUNDL01                            33
     C   33              MOVE      *BLANKS       TX2BRU
     C  N33              MOVEL     KNAVN         TX2BRU
     C                   END
     C     WSTYP3        IFEQ      'FSE'
     C                   MOVEL     FORIGE        KFSFNR
     C                   MOVE      *BLANKS       TX2BRU
     C     KFSFNR        IFNE      *ZEROS
     C     KFSKEY        CHAIN     KODTFS                             33
     C  N33              MOVEL     KFSNAV        TX2BRU
     C                   END
     C                   END
      * Ekstern layout (A4)
     C     WSLAYO        IFEQ      'A4   '
     C     *IN98         IFEQ      '1'
     C                   ADD       1             SIDE
     C                   WRITE     HEADPE
     C                   MOVE      '0'           *IN98
     C                   END
     C                   WRITE     DETE
     C                   ELSE
      * Intern layout (198 tegns liste)
     C     *IN99         IFEQ      '1'
     C                   ADD       1             SIDE
     C                   WRITE     HEADP
     C                   MOVE      '0'           *IN99
     C                   END
      * FINN DEKN.B.
     C     DETINT        ADD       DETKOS        DETRES
     C     DETINT        IFEQ      *ZEROS
     C     DETKOS        IFLT      *ZEROS
     C                   Z-SUB     999.99        DETDB1
     C                   ELSE
     C                   MOVE      *ZEROS        DETDB1
     C                   END
     C                   ELSE
     C     DETRES        DIV(H)    DETINT        DETDBX            7 4
     C     DETDBX        MULT      100           DETDB1
     C                   END
     C                   WRITE     DET
     C                   END
     C* Blank variabler for å akkumulere neste brudd
     C                   MOVEA     *ZEROS        AD                              Ant pr vg
     C                   MOVEA     *ZEROS        BD                              Ant pr vg
     C                   MOVEA     *ZEROS        VD                              Vekt pr vg
     C                   MOVE      *ZEROS        DETVKB            9 0           Brutto vekt
     C                   MOVE      *ZEROS        DETVKF            9 0           Fr.ber vekt
     C                   MOVE      *ZEROS        ANTOPD            7 0           Ant. totalt
     C                   MOVE      *ZEROS        ANTFOR            7 0           Ant. fort.
     C                   MOVE      *ZEROS        ANTKOL            7 0           Ant. kolli
     C                   MOVE      *ZEROS        DETINT           11 0           Frakter
     C                   MOVE      *ZEROS        DETKOS           11 0           Gebyrer
     C                   MOVE      *ZEROS        DETRES           11 0           RESULTAT
     C                   MOVE      *ZEROS        DETFCC           11 0           FRAKT CC
     C                   MOVE      *ZEROS        DETFPP           11 0           FRAKT PP
     C                   MOVE      *ZEROS        DETFSA           11 0           FRAKT SAML.
     C                   MOVE      *ZEROS        DETICC           11 0           GEBYR CC
     C                   MOVE      *ZEROS        DETIPP           11 0           GEBYR PP
     C                   MOVE      *ZEROS        DETISA           11 0           GEBYR SAML.
     C                   END
      *
     C                   MOVE      WSTKEY        FORIGE
     C                   EXSR      AKKUM
     C     WSTUNI        READE     WST01                                  94
     C                   END                                                    B1
      *
     C     MINST1        IFEQ      'J'
     C                   MOVEL     FORIGE        TXBRUD
     C     WSTYPE        IFEQ      'XXXXX'
     C                   MOVEL     FORIGE        KUNDEF            8
     C                   MOVE      KUNDEF        YYKUND
     C     KUNKEY        CHAIN     CUNDL01                            33
     C   33              MOVE      *BLANKS       TX2BRU
     C  N33              MOVEL     KNAVN         TX2BRU
     C                   END
     C     WSTYP3        IFEQ      'FSE'
     C                   MOVEL     FORIGE        KFSFNR
     C                   MOVE      *BLANKS       TX2BRU
     C     KFSFNR        IFNE      *ZEROS
     C     KFSKEY        CHAIN     KODTFS                             33
     C  N33              MOVEL     KFSNAV        TX2BRU
     C                   END
     C                   END
      * Ekstern layout (A4)
     C     WSLAYO        IFEQ      'A4   '
     C     *IN98         IFEQ      '1'
     C                   ADD       1             SIDE
     C                   WRITE     HEADPE
     C                   MOVE      '0'           *IN98
     C                   END
     C                   WRITE     DETE
     C                   ELSE
     C     *IN99         IFEQ      '1'
     C                   ADD       1             SIDE
     C                   WRITE     HEADP
     C                   MOVE      '0'           *IN99
     C                   END
      * FINN DEKN.B.
     C     DETINT        ADD       DETKOS        DETRES
     C     DETINT        IFEQ      *ZEROS
     C     DETKOS        IFLT      *ZEROS
     C                   Z-SUB     999.99        DETDB1
     C                   ELSE
     C                   MOVE      *ZEROS        DETDB1
     C                   END
     C                   ELSE
     C     DETRES        DIV(H)    DETINT        DETDBX            7 4
     C     DETDBX        MULT      100           DETDB1
     C                   END
     C                   WRITE     DET
     C                   END
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     GRATOT        BEGSR
     C***********************************************
      *
     C                   MOVE      *BLANKS       TXBRUD
     C                   MOVEL     '***  TOT'    TXTOT            16
     C                   MOVE      'ALT  ***'    TXTOT
     C                   MOVEL     TXTOT         TXBRUD
     C                   MOVE      *BLANKS       TX2BRU
     C                   MOVE      TOTOPD        ANTOPD
     C                   MOVE      TOTFOR        ANTFOR
     C                   MOVE      TOTKOL        ANTKOL
     C                   MOVE      TOTINT        DETINT
     C                   MOVE      TOTKOS        DETKOS
     C                   MOVE      TOTVKB        DETVKB
     C                   MOVE      TOTVKF        DETVKF
     C                   MOVE      TOTFCC        DETFCC
     C                   MOVE      TOTFPP        DETFPP
     C                   MOVE      TOTFSA        DETFSA
     C                   MOVE      TOTICC        DETICC
     C                   MOVE      TOTIPP        DETIPP
     C                   MOVE      TOTISA        DETISA
     C                   MOVEA     AT            AD
     C                   MOVEA     BT            BD
     C                   MOVEA     VT            VD
      *
      * Ekstern layout (A4)
     C     WSLAYO        IFEQ      'A4   '
     C                   WRITE     DETE
     C                   ELSE
     C                   WRITE     DET
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     AKKUM         BEGSR
     C***********************************************
      *
     C     WSBEL         IFEQ      'J'
      * Sum INNTEKT   detalj/total
     C                   ADD       WSTINT        DETINT
     C                   ADD       WSTINT        TOTINT
      * Sum KOSTNAD   detalj/total
     C                   ADD       WSTKOS        DETKOS
     C                   ADD       WSTKOS        TOTKOS
      * HVIS FLYSTAT. MED BELØP.
     C     *IN40         IFEQ      '1'
      * Sum CC-/PP-/SAMLASTER-FRAKT detalj/total
     C                   ADD       WSTFCC        DETFCC
     C                   ADD       WSTFCC        TOTFCC
     C                   ADD       WSTFPP        DETFPP
     C                   ADD       WSTFPP        TOTFPP
     C                   ADD       WSTFSA        DETFSA
     C                   ADD       WSTFSA        TOTFSA
      * Sum CC-/PP-/SAMLASTER-GEBYR detalj/total
     C                   ADD       WSTICC        DETICC
     C                   ADD       WSTICC        TOTICC
     C                   ADD       WSTIPP        DETIPP
     C                   ADD       WSTIPP        TOTIPP
     C                   ADD       WSTISA        DETISA
     C                   ADD       WSTISA        TOTISA
     C                   END
     C                   END
      * Sum Brutto vekter  detalj/total
     C                   ADD       HEVKT         DETVKB
     C                   ADD       HEVKT         TOTVKB
      * Sum Fr.ber vekter  detalj/total
     C                   ADD       HEFBV         DETVKF
     C                   ADD       HEFBV         TOTVKF
      * Antall totalt
     C                   ADD       1             ANTOPD
     C                   ADD       1             TOTOPD
      *
      *
      *
      * VISSE FELTER BRUKES KUN VED A4-LAYOUT
     C     WSLAYO        IFEQ      'A4   '
      * Sum kolli  detalj/total
     C                   ADD       HENT          ANTKOL
     C                   ADD       HENT          TOTKOL
      * VISSE FELTER BRUKES KUN VED 198-KAR.LISTE-LAYOUT
     C                   ELSE                                                    X1
      * Finn vektgruppe.. ( => VV )
     C     HEFBV         IFGT      99999                                          B2
     C                   MOVE      99999         XFBV              5 0
     C                   ELSE                                                     X2
     C                   MOVE      HEFBV         XFBV
     C                   END                                                      E2
     C                   Z-ADD     1             VV                2 0
     C     XFBV          LOOKUP    FF(VV)                             33  33
      * Antall i vektgrp -detalj/total
     C                   ADD       1             AD(VV)                         *i vekt.gr
     C                   ADD       1             AT(VV)                         *TOTSUM i vg
     C                   ADD       HEVKT         BD(VV)                         *i vekt.gr
     C                   ADD       HEVKT         BT(VV)                         *TOTSUM i vg
     C                   ADD       HEFBV         VD(VV)                         *i vekt.gr
     C                   ADD       HEFBV         VT(VV)                         *TOTSUM i vg
      * Antall fortollet, Importoppdrag
     C     HEUR          IFEQ      'C'                                            B2
     C     HEUR          OREQ      'F'                                            B2
     C     HEPK4         IFEQ      'P'                                             B3
     C     HEPK4         OREQ      'J'
     C                   ADD       1             ANTFOR
     C                   ADD       1             TOTFOR
     C                   END                                                       e3
     C                   ELSE                                                     X2
      * eksportoppdrag fortollet...
     C     HEPK6         IFEQ      'P'                                             b3
     C     HEPK6         OREQ      'J'
     C                   ADD       1             ANTFOR
     C                   ADD       1             TOTFOR
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
      *
      *
     C                   ENDSR
     C*
     C***********************************************
     C     INCOMI        BEGSR
     C***********************************************
      *
     C                   MOVE      'J'           INCLUD            1
      *
      * ______________________________
      * SLETTET?
      * """"""""""""""""""""""""""""""
     C     HEST          IFEQ      'S'
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
      *
      * ______________________________
      * Ursprungskode- Include / Omit (include er alt håndtert)
      * """"""""""""""""""""""""""""""
      *
     C     WSURIO        IFNE      ' '                                           B1
     C     WSURIO        ANDNE     'I'
     C     WSURIO        IFEQ      'O'                                            B2
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     HEUR          LOOKUP    IUR                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                     X2
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HEUR          IFLT      IUR(1)                                          B3
     C     HEUR          ORGT      IUR(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
      *
      *
      * ______________________________
      * Avdeling     - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C     WSAVIO        IFNE      ' '
     C     WSAVIO        IFEQ      'I'
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     HEAVD         LOOKUP    IAV                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE
     C     WSAVIO        IFEQ      'O'
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     HEAVD         LOOKUP    IAV                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HEAVD         IFLT      IAV(1)                                           B4
     C     HEAVD         ORGT      IAV(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
      *
      *
      * ______________________________
      * Faktura kundenr - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C     WSFKIO        IFNE      ' '                                          B1
      * PARTER SOM FINNES INN I ARRAYET KKK
     C                   EXSR      KKKFAK
     C     WSFKIO        IFEQ      'I'                                           B2
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C                   Z-ADD     1             NR
     C     NXKFK1        TAG
     C     KKK(NR)       IFEQ      *ZEROS
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C     KKK(NR)       LOOKUP    IFK                                    80
     C  N80              ADD       1             NR
     C  N80              GOTO      NXKFK1
     C                   ELSE                                                    X2
     C     WSFKIO        IFEQ      'O'                                            B3
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C                   Z-ADD     1             NR
     C     NXKFK2        TAG
     C     KKK(NR)       IFEQ      *ZEROS
     C                   GOTO      UTFKIO
     C                   END
     C     KKK(NR)       LOOKUP    IFK                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
      * SJEKK ALLE..(INGEN MÅ MATCHE)
     C  N80              ADD       1             NR
     C  N80              GOTO      NXKFK2
     C                   ELSE                                                     X3
      * Ved Fra-til må begrepet (EN AV) være i området f.o.m. - t.o.m.
     C                   Z-ADD     1             NR
     C     NXKFK3        TAG
     C     KKK(NR)       IFEQ      *ZEROS
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C     KKK(NR)       IFLT      IFK(1)
     C     KKK(NR)       ORLT      IFK(2)
     C                   ADD       1             NR
     C                   GOTO      NXKFK3
     C                   END
     C                   END                                                      E3
     C                   END                                                     E2
     C                   END                                                    E1
     C     UTFKIO        TAG
      *
      *
      *
      * ______________________________
      * Parts-kundenr(varemotaker) - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C     WSKNIO        IFNE      ' '                                          B1
      * PARTER SOM FINNES INN I ARRAYET KKK
     C                   EXSR      KKKPAR
     C     WSKNIO        IFEQ      'I'                                           B2
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C                   Z-ADD     1             NR
     C     NXKNP1        TAG
     C     KKK(NR)       IFEQ      *ZEROS
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C     KKK(NR)       LOOKUP    IKN                                    80
     C  N80              ADD       1             NR
     C  N80              GOTO      NXKNP1
     C                   ELSE                                                    X2
     C     WSKNIO        IFEQ      'O'                                            B3
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C                   Z-ADD     1             NR
     C     NXKNP2        TAG
     C     KKK(NR)       IFEQ      *ZEROS
     C                   GOTO      UTKNIO
     C                   END
     C     KKK(NR)       LOOKUP    IKN                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
      * SJEKK ALLE..(INGEN MÅ MATCHE)
     C  N80              ADD       1             NR
     C  N80              GOTO      NXKNP2
     C                   ELSE                                                     X3
      * Ved Fra-til må begrepet (EN AV) være i området f.o.m. - t.o.m.
     C                   Z-ADD     1             NR
     C     NXKNP3        TAG
     C     KKK(NR)       IFEQ      *ZEROS
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C     KKK(NR)       IFLT      IKN(1)
     C     KKK(NR)       ORLT      IKN(2)
     C                   ADD       1             NR
     C                   GOTO      NXKNP3
     C                   END
     C                   END                                                      E3
     C                   END                                                     E2
     C                   END                                                    E1
     C     UTKNIO        TAG
      *
      *
      *
      * ______________________________
      * Oppdr.type    - Include / Omit
      * """"""""""""""""""""""""""""""
     C     WSOTIO        IFNE      ' '                                          B1
     C     WSOTIO        IFEQ      'I'                                           B2
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     HEOT          LOOKUP    IOT                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE                                                     X2
      * Ved omit måbegrepet IKKE finnes i-arrayet (->80 off)
     C     WSOTIO        IFEQ      'O'                                             B3
     C                   SETOFF                                       80
     C     HEOT          LOOKUP    IOT                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HEOT          IFLT      IOT(1)                                           B4
     C     HEOT          ORGT      IOT(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
      *
      *
      * ______________________________
      * Frankatur     - Include / Omit
      * """"""""""""""""""""""""""""""
     C     WSFRIO        IFNE      ' '
     C     WSFRIO        IFEQ      'I'
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     HEFR          LOOKUP    IFR                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE
     C     WSFRIO        IFEQ      'O'
      * Ved omit måbegrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     HEFR          LOOKUP    IFR                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HEFR          IFLT      IFR(1)                                           B4
     C     HEFR          ORGT      IFR(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
      * ______________________________
      * Landkode     - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C     WSLKIO        IFNE      ' '
      * Begrepet blankt i oppd. Ved OMIT:XX XX alltid OK,ellers IKKE OK
      * (Blank på LK er umulig på annet enn uferdige/Edimottatte oppdr)
     C     HELKA         IFEQ      *BLANKS
     C     WSLKIO        IFEQ      'O'
     C                   GOTO      UTLKIO
     C                   ELSE
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C                   END
      *
     C     WSLKIO        IFEQ      'I'
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     HELKA         LOOKUP    ILK                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE
     C     WSLKIO        IFEQ      'O'
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     HELKA         LOOKUP    ILK                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HELKA         IFLT      ILK(1)                                            B4
     C     HELKA         ORGT      ILK(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
     C     UTLKIO        TAG
      *
      * ______________________________
      * Frasted      - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C     WSFSIO        IFNE      ' '
      * Begrepet blankt i oppd. Ved OMIT:XX XX alltid OK,ellers IKKE OK
     C     HESDF         IFEQ      *BLANKS
     C     WSFSIO        IFEQ      'O'
     C                   GOTO      UTFSIO
     C                   ELSE
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C                   END
      *
     C     WSFSIO        IFEQ      'I'
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     HESDF         LOOKUP    IFS                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE
     C     WSFSIO        IFEQ      'O'
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     HESDF         LOOKUP    IFS                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HESDF         IFLT      IFS(1)                                           B4
     C     HESDF         ORGT      IFS(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
     C     UTFSIO        TAG
      *
      * ______________________________
      * Tilsted      - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C     WSTSIO        IFNE      ' '
      * Begrepet blankt i oppd. Ved OMIT:XX XX alltid OK,ellers IKKE OK
     C     HESDT         IFEQ      *BLANKS
     C     WSTSIO        IFEQ      'O'
     C                   GOTO      UTTSIO
     C                   ELSE
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C                   END
      *
     C     WSTSIO        IFEQ      'I'
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     HESDT         LOOKUP    ITS                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE
     C     WSTSIO        IFEQ      'O'
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     HESDT         LOOKUP    ITS                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     HESDT         IFLT      ITS(1)                                            B4
     C     HESDT         ORGT      ITS(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
     C     UTTSIO        TAG
      *
      *
      * ______________________________
      * FLYSELSKAP   - Include / Omit
      * """"""""""""""""""""""""""""""
      *
     C                   MOVE      HEKNT         FLYSEL            3 0
     C     WSFLIO        IFNE      ' '
      * Begrepet blankt i oppd. Ved OMIT:XX XX alltid OK,ellers IKKE OK
     C     FLYSEL        IFEQ      *ZEROS
     C     WSFLIO        IFEQ      'O'
     C                   GOTO      UTFLIO
     C                   ELSE
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END
     C                   END
      *
     C     WSFLIO        IFEQ      'I'
      * Ved include må begrepet finnes i -arrayet (->80 on)
     C                   SETOFF                                       80
     C     FLYSEL        LOOKUP    IFL                                    80
     C  N80              MOVE      'N'           INCLUD
     C  N80              GOTO      UTINOM
     C                   ELSE
     C     WSTSIO        IFEQ      'O'
      * Ved omit må begrepet IKKE finnes i -arrayet (->80 off)
     C                   SETOFF                                       80
     C     FLYSEL        LOOKUP    IFL                                    80
     C   80              MOVE      'N'           INCLUD
     C   80              GOTO      UTINOM
     C                   ELSE                                                      X3
      * Ved Fra-til må begrepet være i området f.o.m. - t.o.m.
     C     FLYSEL        IFLT      IFL(1)                                            B4
     C     FLYSEL        ORGT      IFL(2)
     C                   MOVE      'N'           INCLUD
     C                   GOTO      UTINOM
     C                   END                                                        E4
     C                   END                                                       E3
     C                   END                                                      E2
     C                   END                                                     E1
     C     UTFLIO        TAG
      *
     C     UTINOM        ENDSR
      *
      *
     C***********************************************
     C     KKKPAR        BEGSR
     C***********************************************
     C                   MOVEA     *ZEROS        KKK
     C                   MOVE      *ZEROS        NR
     C     HEKNK         IFNE      *ZEROS
     C                   ADD       1             NR
     C                   MOVE      HEKNK         KKK(NR)
     C                   END
     C     HEKNKF        IFNE      *ZEROS
     C                   ADD       1             NR
     C                   MOVE      HEKNKF        KKK(NR)
     C                   END
     C     HEKNS         IFNE      *ZEROS
     C                   ADD       1             NR
     C                   MOVE      HEKNS         KKK(NR)
     C                   END
     C     HEKNSF        IFNE      *ZEROS
     C                   ADD       1             NR
     C                   MOVE      HEKNSF        KKK(NR)
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     KKKFAK        BEGSR
     C***********************************************
      * HVIS EN VIL HA ALLE KUNDENR OGSÅ DE PÅ ÅPNE FAKTURALINJER
      * MÅ EN HELLER LESE ALLE PÅ FAKT......(TREGERE)
     C                   MOVEA     *ZEROS        KKK
     C                   MOVE      *ZEROS        NR
     C                   MOVE      *ZEROS        FAKUNR
     C     FLKUNR        TAG
     C     FAK10K        SETGT     FAK10
     C     FAKKEY        READE     FAK10                                  33
     C     *IN33         IFEQ      '0'
     C                   ADD       1             NR
     C                   MOVE      FAKUNR        KKK(NR)
     C                   GOTO      FLKUNR
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C     UTVAL1        PARM      UTVAL1        UTVAL1          256
     C     UTVAL2        PARM      UTVAL2        UTVAL2          256
      *
     C                   MOVE      UTVAL1        DSUTV1
     C                   MOVE      UTVAL2        DSUTV2
     C     WSDTF         IFGT      501231
     C     WSDTF         ADD       19000000      WSDTF8            8 0
     C                   ELSE
     C     WSDTF         ADD       20000000      WSDTF8
     C                   END
     C     WSDTT         IFGT      501231
     C     WSDTT         ADD       19000000      WSDTT8            8 0
     C                   ELSE
     C     WSDTT         ADD       20000000      WSDTT8
     C                   END
      *
      *
      *
     C     DATOFK        KLIST
     C                   KFLD                    WSDTF8
      *
     C     URDTFK        KLIST
     C                   KFLD                    HEUR
     C                   KFLD                    WSDTF8
      *
     C     KODVKE        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C                   MOVE      'V'           KOVUNI
     C                   MOVE      *ZEROS        KOVAVD
      *
     C     KFSKEY        KLIST
     C                   KFLD                    KFSUNI
     C                   KFLD                    KFSFNR
     C                   MOVE      'FS'          KFSUNI
      *
     C     FAKKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
      *
     C     FAK10K        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FAKUNR
      *
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YYKUND            8 0
      *
     C     TYPKEY        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'ST01TYPE'    KFTYP
      *
     C                   MOVEA     *ZEROS        AD
     C                   MOVEA     *ZEROS        BD
     C                   MOVEA     *ZEROS        VD
     C                   MOVEA     *ZEROS        AT
     C                   MOVEA     *ZEROS        BT
     C                   MOVEA     *ZEROS        VT
     C                   MOVE      *ZEROS        TOTVKB            9 0
     C                   MOVE      *ZEROS        TOTVKF            9 0
     C                   MOVE      *ZEROS        TOTOPD            7 0
     C                   MOVE      *ZEROS        TOTFOR            7 0
     C                   MOVE      *ZEROS        TOTKOL            7 0
     C                   MOVE      *ZEROS        TOTINT           11 0
     C                   MOVE      *ZEROS        TOTKOS           11 0
     C                   MOVE      *ZEROS        TOTRES           11 0
     C                   MOVE      *ZEROS        TOTFCC           11 0
     C                   MOVE      *ZEROS        TOTFPP           11 0
     C                   MOVE      *ZEROS        TOTFSA           11 0
     C                   MOVE      *ZEROS        TOTICC           11 0
     C                   MOVE      *ZEROS        TOTIPP           11 0
     C                   MOVE      *ZEROS        TOTISA           11 0
     C                   Z-ADD     1             SIDE              4 0
      *
     C                   MOVEL     WSTYPE        KFKOD
     C     TYPKEY        CHAIN     KOFAST                             33
     C                   MOVEL     KFTXT         TXTYPE
      *
     C                   MOVE      ZJOBNR        WSTUNI
     C                   EXSR      TØMWRK
      * Hente dagens dato og klokkeslett.
     C                   TIME                    WTIME
      *
     C                   READ      FIRM                                   33
      * VEKTGRUPPEINNDELING..
     C     KODVKE        CHAIN     KODTV                              33
     C                   MOVE      99999         KOVK12
     C* Initier faste incl/omit ledetekster..
     C                   MOVE      *BLANKS       TXAVIO            8
     C                   MOVE      *BLANKS       TXFKIO            8
     C                   MOVE      *BLANKS       TXKNIO            8
     C                   MOVE      *BLANKS       TXOTIO            8
     C                   MOVE      *BLANKS       TXFRIO            8
     C                   MOVE      *BLANKS       TXLKIO            8
     C                   MOVE      *BLANKS       TXFSIO            8
     C                   MOVE      *BLANKS       TXTSIO            8
     C     WSAVIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXAVIO
     C                   ELSE
     C     WSAVIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXAVIO
     C                   ELSE
     C     WSAVIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXAVIO
     C                   END
     C                   END
     C                   END
     C     WSFKIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXFKIO
     C                   ELSE
     C     WSFKIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXFKIO
     C                   ELSE
     C     WSFKIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXFKIO
     C                   END
     C                   END
     C                   END
     C     WSKNIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXKNIO
     C                   ELSE
     C     WSKNIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXKNIO
     C                   ELSE
     C     WSKNIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXKNIO
     C                   END
     C                   END
     C                   END
     C     WSOTIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXOTIO
     C                   ELSE
     C     WSOTIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXOTIO
     C                   ELSE
     C     WSOTIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXOTIO
     C                   END
     C                   END
     C                   END
     C     WSFRIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXFRIO
     C                   ELSE
     C     WSFRIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXFRIO
     C                   ELSE
     C     WSFRIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXFRIO
     C                   END
     C                   END
     C                   END
     C     WSLKIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXLKIO
     C                   ELSE
     C     WSLKIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXLKIO
     C                   ELSE
     C     WSLKIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXLKIO
     C                   END
     C                   END
     C                   END
     C     WSFSIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXFSIO
     C                   ELSE
     C     WSFSIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXFSIO
     C                   ELSE
     C     WSFSIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXFSIO
     C                   END
     C                   END
     C                   END
     C     WSTSIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXTSIO
     C                   ELSE
     C     WSTSIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXTSIO
     C                   ELSE
     C     WSTSIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXTSIO
     C                   END
     C                   END
     C                   END
     C     WSURIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXURIO
     C                   ELSE
     C     WSURIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXURIO
     C                   ELSE
     C     WSURIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXURIO
     C                   END
     C                   END
     C                   END
     C     WSFLIO        IFEQ      'I'
     C                   MOVE      'Inkluder'    TXFLIO
     C                   ELSE
     C     WSFLIO        IFEQ      'O'
     C                   MOVE      'Overse  '    TXFLIO
     C                   ELSE
     C     WSFLIO        IFEQ      'F'
     C                   MOVE      'Fra-Til '    TXFLIO
     C                   END
     C                   END
     C                   END
      * FLYSELSK..
     C     WSTYP3        IFEQ      'FSE'
     C     WSBEL         ANDEQ     'J'
     C                   MOVE      '1'           *IN40
     C                   ELSE
     C                   MOVE      '0'           *IN40
     C                   END
      *
      * Skriv 1.side (seleksjoner) + Heading på førte ordinære side
     C     WSLAYO        IFEQ      'A4   '
     C                   WRITE     HEAD1E
     C                   WRITE     HEADPE
     C                   ELSE
     C                   WRITE     HEAD1
     C                   WRITE     HEADP
     C                   END
      *
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     TØMWRK        BEGSR
     C***********************************************
      * Tømme workfile.
     C     WSTUNI        SETLL     WST01
     C     WSTUNI        READE     WST01                                  33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    WST01R
     C     WSTUNI        READE     WST01                                  33
     C                   END
      *
     C                   CLEAR                   WST01R
     C                   MOVE      ZJOBNR        WSTUNI
     C                   ENDSR
     C*
