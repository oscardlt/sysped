      *
      ************************************************************
      *** PROGRAM LISTER BUDSJETT MOT COSTNADER                ***
      ************************************************************
      *
     FHEADF     IP   E           K DISK
     FFAK2      IF   E           K DISK
     FLISTE     O    F  132        PRINTER OFLIND(*INOF)
     D G               S              3    DIM(10)
     D                 DS
     D  HEDTÅ                  1      4  0
     D  HEDTÅ2                 3      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D  FILD                   1      6  0
     D*
     D                 DS
     D  AARF                   1      4  0
     D  MNDF                   5      6  0
     D  FRADAT                 1      6  0
     D*
     D                 DS
     D  AART                   1      4  0
     D  MNDT                   5      6  0
     D  TILDAT                 1      6  0
     I*
     C*
     C     *ENTRY        PLIST
     C                   PARM                    MNDFA             2
     C                   PARM                    AARFA             2
     C                   PARM                    MNDTA             2
     C                   PARM                    AARTA             2
     C                   PARM                    IO                1
     C                   PARM                    FEE01             3
     C                   PARM                    FEE02             3
     C                   PARM                    FEE03             3
     C                   PARM                    FEE04             3
     C                   PARM                    FEE05             3
     C                   PARM                    FEE06             3
     C                   PARM                    FEE07             3
     C                   PARM                    FEE08             3
     C                   PARM                    FEE09             3
     C                   PARM                    FEE10             3
     C*
     C  N99              EXSR      INIT
     C*
     C     FILD          IFGE      FRADAT
     C     FILD          ANDLE     TILDAT
     C                   EXSR      TSTFAK
     C                   END
     CLR                 EXCEPT    DETA
     CLR                 EXCEPT    TOT
     C*
     C****************************************************
     C     TSTFAK        BEGSR
     C****************************************************
     C     FAKEY         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C*
     C                   MOVE      *ZEROS        DETBUD           13 2
     C                   MOVE      *ZEROS        DETCOS           13 2
     C*
     C*
     C     FAKEY         SETLL     FAK2
     C*
     C     STFA          TAG
     C     FAKEY         READE     FAK2                                   33
     C   33              GOTO      SLFA
     C*
     C     FAVK          LOOKUP    G                                      30
     C*
     C     FAKDA         IFEQ      'K'
     C     IO            IFEQ      'I'
     C   30              SUB       FABELN        DETCOS
     C                   ELSE
     C     IO            IFEQ      'O'
     C  N30              SUB       FABELN        DETCOS
     C                   ELSE
     C                   SUB       FABELN        DETCOS
     C                   END
     C                   END
     C                   ELSE
     C     FAKDUK        IFEQ      'B'
     C     FABELU        IFNE      *ZEROS
     C     IO            IFEQ      'I'
     C   30              ADD       FABELU        DETBUD
     C                   ELSE
     C     IO            IFEQ      'O'
     C  N30              ADD       FABELU        DETBUD
     C                   ELSE
     C                   ADD       FABELU        DETBUD
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C                   GOTO      STFA
     C     SLFA          TAG
     C     DETBUD        IFNE      *ZEROS
     C*          DETCOS    IFEQ 0
     C     DETBUD        ANDNE     DETCOS
     C     DETBUD        SUB       DETCOS        DETDIF           13 2
     C   OF              EXCEPT    HEAD
     C     FORIGE        IFNE      0
     C     HEAVD         ANDNE     FORIGE
     C                   EXCEPT    DETA
     C                   END
     C                   MOVE      HEAVD         FORIGE            4 0
     C                   ADD       DETBUD        AVDBUD           13 2
     C                   ADD       DETCOS        AVDCOS           13 2
     C                   ADD       DETDIF        AVDDIF           13 2
     C                   ADD       DETBUD        TOTBUD           13 2
     C                   ADD       DETCOS        TOTCOS           13 2
     C                   ADD       DETDIF        TOTDIF           13 2
     C   OF              EXCEPT    HEAD
     C                   EXCEPT    DET
     C                   END
     C                   ENDSR
     C****************************************************
     C     INIT          BEGSR
     C****************************************************
     C                   MOVE      FEE01         G(1)
     C                   MOVE      FEE02         G(2)
     C                   MOVE      FEE03         G(3)
     C                   MOVE      FEE04         G(4)
     C                   MOVE      FEE05         G(5)
     C                   MOVE      FEE06         G(6)
     C                   MOVE      FEE07         G(7)
     C                   MOVE      FEE08         G(8)
     C                   MOVE      FEE09         G(9)
     C                   MOVE      FEE10         G(10)
     C                   SORTA     G
     C                   SETON                                        99
     C                   MOVE      *ZEROS        FRADAT
     C                   MOVE      MNDFA         MNDF
     C     AARFA         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        AARF
     C                   ELSE
     C                   MOVE      AARFA         AARF
     C     AARFA         IFGT      '5012'
     C                   MOVEL     '19'          AARF
     C                   ELSE
     C                   MOVEL     '20'          AARF
     C                   END
     C                   END
     C                   MOVE      *ZEROS        TILDAT
     C                   MOVE      MNDTA         MNDT
     C     AARTA         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        AART
     C                   ELSE
     C                   MOVE      AARTA         AART
     C     AARTA         IFGT      '50'
     C                   MOVEL     '19'          AART
     C                   ELSE
     C                   MOVEL     '20'          AART
     C                   END
     C                   END
     C                   EXCEPT    HEAD
     C                   ENDSR
     OLISTE     E            HEAD             02
     O                                           30 'LIST OF BUDGET/COST'
     O                       MNDFA               36
     O                       AARFA               38
     O                                           41 '->'
     O                       MNDTA               44
     O                       AARTA               46
     O                                           60 'DATE'
     O                       UDAY                63
     O                                           64 '.'
     O                       UMONTH              66
     O                                           67 '.'
     O                       UYEAR               69
     O                                           74 'PAGE'
     O                       PAGE                79
     OLISTE     E            HEAD             03
     O                                           12 'SELECTIONS:'
     O                       IO                  14
     O                                           26 'FEECODES:'
     O                       G(1)                32
     O                       G(2)                36
     O                       G(3)                40
     O                       G(4)                44
     O                       G(5)                48
     O                       G(6)                52
     O                       G(7)                56
     O                       G(8)                60
     O                       G(9)                64
     O                       G(10)               68
     OLISTE     E            HEAD             05
     O                                           14 'DEPA.ORDNO.INI'
     O                                           19 'DATE'
     O                                           42 'BUDGET'
     O                                           61 'COSTS'
     O                                           80 'DIFFERENCE'
     OLISTE     E            HEAD           1 06
     O                                           24 '------------------------'
     O                                           48 '------------------------'
     O                                           72 '------------------------'
     O                                           80 '--------'
     OLISTE     E            DET            1
     O                       HEAVD                4
     O                                            5 '/'
     O                       HEOPD               12
     O                                           13 '/'
     O                       HESG                16
     O                       HEDTD               19
     O                                           20 '.'
     O                       HEDTM               22
     O                                           23 '.'
     O                       HEDTÅ2              25
     O                       DETBUD        J     42
     O                       DETCOS        J     61
     O                       DETDIF        J     80
     OLISTE     E            DETA        1  2
     O                       FORIGE               4
     O                                           22 '** TOT DEP**'
     O                       AVDBUD        JB    42
     O                       AVDCOS        JB    61
     O                       AVDDIF        JB    80
     OLISTE     E            TOT         1  2
     O                       FORIGE               4
     O                                           22 '** TOT FIRM **'
     O                       TOTBUD        JB    42
     O                       TOTCOS        JB    61
     O                       TOTDIF        JB    80
