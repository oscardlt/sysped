      *
      ***********************************************************
      *** PROGRAM SKAL HENT NESTE GODSNR                      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 35-99                      ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Motta kode for lager/løpenr(3 siste siffer i GN)
********************************************************************
      *
     FGODSFI    IF   E           K DISK
     FGODSGF    UF A E           K DISK
     FKALENDER  IF   E           K DISK
     D                 DS
     D  XGN                    1     15
     D  XGN1                   1      4
     D  XGN2                   5      9
     D  XGN3                  10     12
     D  XGN4                  13     13
     D  XGN5                   1     12
     D  XGN6                   1     13
     D                 DS
     D  WDT                    1      8
     D  WDTÅ                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  XDT                    1      6
     D  XDTD                   1      2
     D  XDTM                   3      4
     D  XDTÅ                   5      6
      *
     C                   EXSR      INIT
      *
     C                   EXSR      SRGN
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     SRGN          BEGSR
      ***********************************************
      * ÅRSTALL
     C                   IF        UÅR = *BLANKS
     C                   MOVEL     WDTÅ          XGN1
     C                   ELSE
     C                   MOVEL     UÅR           XGN1
     C                   END
      * BEVILGILINGSKODE
     C                   IF        UKODE = *BLANKS
     C     *LOVAL        SETLL     GODSFI
     C                   READ      GODSFI                                 33
     C                   MOVEL     GFLBKO        XGN2
     C                   ELSE
     C                   MOVE      UKODE         XGN2
     C                   END
      * DAGNR
     C                   IF        UDGNR = *BLANKS
     C                   MOVE      WDT           XN08              8 0
     C     XN08          CHAIN     KALENDER                           33
     C                   MOVE      KADGNR        XGN3
     C                   ELSE
     C                   MOVE      UDGNR         XGN3
     C                   END
      * LØPENR
S01  C*                  MOVE      '0'           XGN4
N01  C                   MOVE      Ulager        XGN4
     C     XGN6          CHAIN     GODSGF                             33
     C                   MOVE      '0'           *IN34
     C  N33              IF        GGGN2 = '00'
     C                   UPDATE    GODSGFR
     C                   MOVE      XGN4          XN01              1 0
     C     *IN34         DOWEQ     '0'
     C                   ADD       1             XN01
     C                   MOVE      XN01          XGN4
     C     XGN6          CHAIN     GODSGF                             34
     C  N34              IF        GGGN2 <> '00'
     C                   LEAVE
     C                   END
     C                   ENDDO
     C                   END
      *
     C                   IF        *IN34
     C                   MOVE      '00'          XGN                            LØPENR
     C                   MOVE      XGN6          GGGN1
     C                   MOVE      '01'          GGGN2
     C                   WRITE     GODSGFR
     C                   ELSE
      *
      * NESTE NUMMER
      *
     C                   IF        *IN33 = *OFF
     C                   MOVE      GGGN2         XGN                            LØPENR
     C                   MOVE      GGGN2         XN02              2 0
     C                   ADD       1             XN02
     C                   MOVE      XN02          GGGN2
     C                   UPDATE    GODSGFR
     C                   ELSE
      * FØRSTE PÅ ANGITT DATO
     C                   MOVE      '01'          XGN                            LØPENR
     C                   MOVE      XGN6          GGGN1
     C                   MOVE      '02'          GGGN2
     C                   WRITE     GODSGFR
     C                   END
     C                   END
      *
     C                   EVAL      UGN = XGN
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UÅR               4
     C                   PARM                    UKODE             5
     C                   PARM                    UDGNR             3
N01  C                   PARM                    ULager            1
     C                   PARM                    UGN              15
N01   * innparameter for lager/godsnrserie (3. siste siffer av godsnummeret)
N01  c     Ulager        iflt      '0'
N01  c     Ulager        orgt      '9'
N01  c                   movel     '0'           Ulager
N01  c                   endif
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM               6
      *
     C                   ENDSR
      *
