     FLLBL1F    IF   E           K DISK
     FLLMRF     IF   E           K DISK
     FLLLISF    IF   E           K DISK
     FLLAGJL07  IF   E           K DISK
     FLLAGJD01  IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FSTANDI    IF   E           K DISK
     FSADH      O  A E             DISK
     FSADF      O  A E             DISK
     D TX              S             17    DIM(90)
     D BL              S             12  2 DIM(90)
     D VK              S              3    DIM(90)
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
      *
      * HENT FAKTURAVERDI
     C     *LOVAL        SETLL     LLBL1F
     C                   READ      LLBL1F                                 33
     C     *IN33         DOWEQ     '0'
     C     LAGJ7K        SETLL     LLAGJL07
     C     LAGJ7K        READE     LLAGJL07                               34
     C     *IN34         DOWEQ     '0'
     C     LLISK         CHAIN     LLLISF                             35
     C     LITXT         IFEQ      *BLANKS
     C                   MOVEL     'UKJENT'      LITXT
     C                   END
     C     1             DO        90            XN                3 0
     C     TX(XN)        IFEQ      LITXT
     C     TX(XN)        OREQ      *BLANKS
     C                   LEAVE
     C                   END
     C                   ENDDO
     C                   MOVEL     LITXT         TX(XN)
     C                   MOVE      *ZEROS        XDLANT            7 0
     C     LAGD1K        SETLL     LLAGJD01
     C     LAGD1K        READE     LLAGJD01                               35
     C     *IN35         DOWEQ     '0'
     C     VDLTYP        IFEQ      'PLIST'
     C                   ADD       VDLANT        XDLANT
     C                   END
     C     LAGD1K        READE     LLAGJD01                               35
     C  N35              ENDDO
     C     XDLANT        MULT      VAVERD        XN112            11 2
     C                   ADD       XN112         BL(XN)
     C                   MOVEL     VAFAR         VK(XN)
     C                   MOVE      VADATO        XDT               8 0
     C     LAGJ7K        READE     LLAGJL07                               34
     C  N34              ENDDO
     C                   READ      LLBL1F                                 33
     C  N33              ENDDO
      *
     C     TX(2)         IFNE      *BLANKS
     C                   MOVE      UAVD          SFAVD
     C                   MOVE      UTDN          SFOPDN
     C                   MOVE      VK(1)         KVAKOD
     C     KODVAK        SETGT     KODTVAL2
     C     KVAKOD        READPE    KODTVAL2                               33
     C  N33              MOVE      KVAOMR        XOMR              3 0
     C  N33              MOVE      KVAOMR        SFOM28
     C  N33              MOVE      KVAKRS        SFKR28
     C                   MOVE      VK(1)         SFVK28
     C                   MOVE      TX(1)         SFTXT
     C                   MOVE      BL(1)         SFBL28
     C                   MOVE      XDT           SFDT
     C                   WRITE     SADFR
     C                   ADD       BL(1)         XBEL3            11 2
     C                   END
      *
     C                   MOVE      VK(1)         XVK               3
     C                   MOVE      'J'           XENVAL            1
     C                   MOVE      UAVD          SFAVD
     C                   MOVE      UTDN          SFOPDN
     C     2             DO        90            XN                3 0
     C     VK(XN)        IFEQ      *BLANKS
     C                   LEAVE
     C                   END
     C     VK(XN)        IFNE      XVK
     C                   MOVE      'N'           XENVAL
     C                   END
     C                   MOVE      VK(XN)        KVAKOD
     C     KODVAK        SETGT     KODTVAL2
     C     KVAKOD        READPE    KODTVAL2                               33
     C  N33              MOVE      KVAOMR        XOMR              3 0
     C  N33              MOVE      KVAOMR        SFOM28
     C  N33              MOVE      KVAKRS        SFKR28
     C                   MOVE      VK(XN)        SFVK28
     C                   MOVE      TX(XN)        SFTXT
     C                   MOVE      BL(XN)        SFBL28
     C                   MOVE      XDT           SFDT
     C                   WRITE     SADFR
     C                   ADD       BL(XN)        XBEL3            11 2
     C                   ENDDO
      *
     C     XENVAL        IFEQ      'N'
     C                   MOVE      *ZEROS        XBEL3
     C                   MOVE      'NOK'         XVAL3             3
     C                   Z-ADD     100           XOMR              3 0
     C     1             DO        90            XN                3 0
     C     VK(XN)        IFEQ      *BLANKS
     C                   LEAVE
     C                   END
     C                   MOVE      VK(XN)        KVAKOD
     C     KODVAK        SETGT     KODTVAL2
     C     KVAKOD        READPE    KODTVAL2                               33
     C     BL(XN)        MULT(H)   KVAKRS        XWORK            15 3
     C                   DIV(H)    KVAOMR        XWORK
     C                   ADD(H)    XWORK         XBEL3
     C                   ENDDO
     C                   ELSE
     C                   MOVE      VK(1)         XVAL3
     C                   END
      *
      * LAGE SADH
     C     HEAVD         CHAIN     STANDI                             33
     C     HEADFK        CHAIN     HEADF                              33
     C     KUNKEY        CHAIN     CUNDL01                            33
     C     *LOVAL        SETLL     LLBL1F                             33
     C                   READ      LLBL1F                                 33
     C     LMRFK         CHAIN     LLMRF                              33
     C                   MOVE      HEAVD         SIAVD
     C                   MOVE      HEOPD         SITDN
     C                   MOVE      HESG          SISG
     C                   MOVE      ' '           SIST
     C                   MOVEL     MRGN          SIGN
     C                   MOVE      *ZEROS        SIKNS
     C                   MOVE      MRLNA         SINAS
     C                   MOVE      MRLAD1        SIADS1
     C                   MOVE      MRLAD2        SIADS2
     C                   MOVE      *BLANKS       SIADS3
     C     MRLPN         IFEQ      0
     C                   MOVEL     MRLAD3        SIADS3
     C                   ELSE
     C                   MOVEL     MRLPN         SIADS3
     C                   CAT       MRLAD3:1      SIADS3
     C                   END
     C                   MOVE      HELKA         SILKA
     C                   MOVE      HEKNK         SIKNK
     C                   MOVE      KNAVN         SINAK
     C                   MOVE      ADR1          SIADK1
     C                   MOVE      ADR2          SIADK2
     C                   MOVE      *BLANKS       SIADK3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SIADK3
     C                   ELSE
     C                   MOVEL     POSTNR        SIADK3
     C                   MOVE      ADR3          SIADK3
     C                   END
     C                   TESTN                   SYFOR9               33
     C   33SYFOR9        COMP      *ZEROS                             3333
     C                   MOVE      *ZEROS        SIRG
     C   33              MOVEL     SYFORE        SIRG
     C                   MOVEL     SYKONT        SIKTA
     C                   MOVE      SYKONT        SIKTB
     C                   MOVE      SYFR02        SIKTC
     C                   Z-ADD     HENT          SINTK
     C                   Z-ADD     HEVKT         SIVKB
     C                   MOVE      XVAL3         SIVAL3
     C                   MOVE      XBEL3         SIBEL3
     C                   MOVEL     MRGN          SIGN
     C     TX(2)         IFEQ      *BLANKS
     C                   MOVE      XDT           SIFID
     C                   MOVEL     TX(1)         SIFIF
     C                   MOVE      BL(1)         SIBEL3
     C                   ELSE
     C                   MOVEL     'F15  ER '    SIFIF
     C                   MOVE      'BENYTTET'    SIFIF
     C                   MOVE      99999999      SIFID
     C                   END
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           SIDT
     C                   WRITE     SADHR
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UGRPA             8
     C                   PARM                    UPNRA             8
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    UALN              5
      *
     C     LAGJ7K        KLIST
     C                   KFLD                    XGRP
     C                   KFLD                    XPNR
     C                   KFLD                    BLMRNR
     C     LAGD1K        KLIST
     C                   KFLD                    XGRP
     C                   KFLD                    XPNR
     C                   KFLD                    VAMN
     C     LLISK         KLIST
     C                   KFLD                    VAMN
     C                   KFLD                    LILN
     C     LMRFK         KLIST
     C                   KFLD                    XGRP
     C                   KFLD                    XPNR
     C                   KFLD                    BLMRNR
     C     KODVAK        KLIST
     C                   KFLD                    KVAKOD
     C                   KFLD                    XVADT
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     KUNKEY        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    HEKNK
      *
     C                   MOVE      UGRPA         XGRP              8 0
     C                   MOVE      UPNRA         XPNR              8 0
     C                   Z-ADD     1             LILN
     C                   MOVE      99999999      XVADT             8 0
     C                   MOVE      UAVD          HEAVD
     C                   MOVE      UTDN          HEOPD
      *
     C                   ENDSR
      *
