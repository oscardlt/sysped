      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED EKSTRA GODSBESKRIVELSER
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 04 07-11 13-24
      *** LEDIGE INDIKATORER 28 29 31 32 34-90 95-97
      **************************************************************
      *
     FGSSGDF    UF A E           K DISK
     FGSS014D   CF   E             WORKSTN
     F                                     SFILE(GSS014D1:ZRECNO)
     F                                     INFDS(FBAREA)
     D A               S              1    DIM(15)
     D B               S              1    DIM(15)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  GDDSC                  1     55
     D  XDLT                   1      7
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN(93)
     C                   WRITE     GSS014D2
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C  N05              MOVE      W2LNO         YLNO              3 0
     C                   MOVE      *ZEROS        W2LNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     GDFK          SETLL     GSSGDF
     C     START1        TAG
     C     UONO          READE(N)  GSSGDF                                 94
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        7
     C                   ADD       1             ZRECNO
     C                   MOVE      GDLNO         XLNO              3 0
     C                   WRITE     GSS014D1
     C     UONO          READE(N)  GSSGDF                                 94
     C  N94              END
     C                   END
      *
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C   27              Z-ADD     5             LINNBR
     C   27              Z-ADD     5             POSNBR
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS014D5
     C                   ELSE
     C                   WRITE     GSS014D3
     C                   EXFMT     GSS014D2
     C                   END
      *
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
      *
     C   03              Z-ADD     3             UFLAGG
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
     C   25              DO
     C                   MOVE      '0'           *IN25
     C  N98GDFK4         CHAIN(N)  GSSGDF                             33
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      *BLANKS
     C                   SELECT
     C     W2NR          WHENEQ    '1'
     C                   EXSR      CRTGDF
     C     W2NR          WHENEQ    '2'
     C     GDFK2         CHAIN(N)  GSSGDF                             33
     C  N33              EXSR      CHGGDF
     C     W2NR          WHENEQ    '4'
     C     GDFK2         CHAIN     GSSGDF                             33
     C     *IN33         IFEQ      '0'
     C                   DELETE    GSSGDFR
     C                   MOVE      '1'           *IN05
     C                   END
     C                   ENDSL
     C  N33              MOVE      *BLANKS       W2NR
     C  N33              MOVE      *ZEROS        W2LNO
     C   05              GOTO      START
     C                   GOTO      START3
     C                   END
      *
     C     W2LNO         CABNE     0             START
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
      *
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     HENT          BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XLIN2             3 0
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS014D1                               98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       7             LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     7             XLIN2
     C                   ELSE
     C                   Z-ADD     XLIN          XLIN2
     C                   END
     C     WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   MOVE      '1'           *IN99
     C     XDLT          COMP      '*DELETE'                              98
     C   98              UPDATE    GSS014D1
     C   98              GOTO      SLHENT
     C                   EXSR      CHGGDF
     C                   UPDATE    GSS014D1
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '4'
     C                   MOVE      '1'           *IN99
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C     GDFK3         CHAIN     GSSGDF                             33
     C  N33              DELETE    GSSGDF
     C                   MOVE      ' '           WSNR
     C                   MOVE      *BLANKS       GDDSC
     C                   MOVE      '*DELETE'     XDLT
     C                   MOVE      *ZEROS        GDLNO
     C                   UPDATE    GSS014D1
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C     XLIN2         ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              SETON                                            30
      *
     C                   ENDSR
      *
      ***********************************************
     C     CRTGDF        BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       WSDSC
     C     STCRT         TAG
     C                   EXFMT     GSS014D4
     C     *IN12         IFEQ      '0'
     C     WSDSC         CABEQ     *BLANKS       STCRT
     C                   ADD       1             YLNO2
     C                   MOVE      UONO          GDONO
     C                   MOVE      YLNO2         GDLNO
     C                   MOVE      WSDSC         GDDSC
     C                   WRITE     GSSGDFR
     C     XRECNO        ADD       1             ZRECNO
     C                   MOVE      ZRECNO        XRECNO
     C                   WRITE     GSS014D1
     C                   END
     C                   MOVE      *BLANKS       W2NR
     C                   WRITE     WINDOWSZ
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGGDF        BEGSR
      ***********************************************
     C                   MOVE      GDDSC         WSDSC
     C     STCHG         TAG
     C                   EXFMT     GSS014D4
     C     *IN12         IFEQ      '0'
     C     WSDSC         CABEQ     *BLANKS       STCHG
     C     GDFK3         CHAIN     GSSGDF                             33
     C                   MOVE      WSDSC         GDDSC
     C                   UPDATE    GSSGDFR
     C                   END
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     GDFK          KLIST
     C                   KFLD                    UONO
     C                   KFLD                    YLNO
     C     GDFK2         KLIST
     C                   KFLD                    UONO
     C                   KFLD                    W2LNO
     C     GDFK3         KLIST
     C                   KFLD                    UONO
     C                   KFLD                    GDLNO
     C     GDFK4         KLIST
     C                   KFLD                    UONO
     C                   KFLD                    XLNO
     C     GDFKM         KLIST
     C                   KFLD                    UONO
     C                   KFLD                    YLNO2
      *
     C     *ENTRY        PLIST
     C                   PARM                    UONO              7 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C     UTYPE         COMP      'DSP'                                  27
     C                   Z-ADD     999           YLNO2             3 0
     C     GDFKM         SETLL     GSSGDF
     C     UONO          READPE(N) GSSGDF                                 33
     C     *IN33         IFEQ      '0'
     C                   MOVE      GDLNO         YLNO2
     C                   ELSE
     C                   MOVE      *ZEROS        YLNO2
     C                   END
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
