      *
      ***********************************************************
      *** PROGRAM sender epost på jobber med MSGW             ***
      ***********************************************************
      *
     Fsydrstat  IF   E             DISK
     F                                     USROPN
     Fsydrsbsj  UF   E           K DISK
     D                 DS
     D  TEXTDS                 1    132
     D  JOBNVN                 4     13
     D  BRUKER                17     26
     D  JOBB                  30     35
     D  JOBTYP                39     48
     D  AKTIVE                49     58
      *
     C                   EXSR      INIT
     C*
     C*
     C* merker alle poster 'N' i aktive
     c                   exsr      tomm
     C* setter active i J
     c                   exsr      test
      * sjekk active  evt start
     c     nede          ifeq      'N'
     c                   exsr      testa
     c                   end
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     c     *entry        plist
     c                   parm                    usbs             10
     C     keyst0        KLIST
     C                   KFLD                    usbs             10
     C     keyst         KLIST
     C                   KFLD                    WSSBS            10
     C                   KFLD                    WSJOB            10
     C                   ENDSR
     C*
     C***********************************************
     C     test          BEGSR
     C***********************************************
     c                   call      'SYDR01CL0'
     c                   parm                    usbs
     c                   open      sydrstat
     c                   setoff                                       33
     c                   move      'N'           startl            1
     c                   move      'J'           nede              1
     c     *in33         doweq     '0'
     c                   read      sydrstat                               33
     c     *in33         ifeq      '0'
     c                   move      'N'           nede              1
     c                   move      TEXT          TEXTDS
     c     startl        ifeq      'J'
     c     jobnvn        andne     *blanks
     c                   eval      wsjob=jobnvn
     c                   eval      wssbs=usbs
     c     keyst         chain     sydrsbsj                           34
     c     *in34         ifeq      '0'
     c     aktive        ifeq      'ACTIVE'
     c                   MOVE      'J'           SYAKT
     c                   eval      syjobt=jobtyp
     c                   eval      syjobn=jobb
     c                   eval      syuser=bruker
     c                   update    sydrsbsjr
     c                   end
     c     aktive        ifeq      'MSGW'
     c                   MOVE      'M'           SYAKT
     c                   eval      syjobt=jobtyp
     c                   eval      syjobn=jobb
     c                   eval      syuser=bruker
     c                   update    sydrsbsjr
     c                   end
     c                   end
     c                   end
     c     jobnvn        ifeq      'Jobbnavn'
     c                   move      'J'           startl
     c                   end
     c                   end
     c                   enddo
     c                   close     sydrstat
     c                   endsr
      ***********************************************
     C     tomm          BEGSR
     C***********************************************
     c                   setoff                                       33
     c     keyst0        setll     sydrsbsj
     c     *in(33)       doweq     '0'
     c                   read      sydrsbsj                               33
     c     *in(33)       ifeq      '0'
     c                   move      'N'           syakt
     C                   MOVE      *blanks       syjobn
     C                   MOVE      *blanks       syuser
     c                   update    sydrsbsjr
     c                   end
     c                   enddo
     c                   endsr
      ***********************************************
     C     testa         BEGSR
     C***********************************************
     c                   setoff                                       33
     c     keyst0        setll     sydrsbsj
     c     *in(33)       doweq     '0'
     c                   read      sydrsbsj                               33
     c     *in(33)       ifeq      '0'
     c     sybru         andeq     'J'
     c     syakt         andeq     'M'
     c                   exsr      sendepost
     c                   end
     c                   enddo
     c                   endsr
     C***********************************************
     C     Sendepost     BEGSR
     C***********************************************
     c                   call      'SYDR01SNDE'
     c                   parm                    usbs
     c                   parm                    sypgm
     c                   parm                    sylib
     c                   parm                    syjob
     c                   parm                    syjobq
     c                   parm                    syjobd
     c                   parm                    syjobn
     c                   parm                    syuser
     c                   endsr
