/* VISE FRAKTBREV I PDF           */
/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 JOV PTF10 TUR=UDS 22, KODE=G-> GODSL/TUR/FRAKTBREV (gf)      */
/* 10XXX * 02 JOV PTF11 LPI(12) + SIDESTØRRELSE/OVERFLOW DOBLET SYBRINGTMS */
/*                              + SIDEBREDDE- 90->100                      */
/* ********************************************************************    */
             PGM        PARM(&AVD &OPD &FBN &KODE &STMF &BANE &VISE &INFOP)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PDFDIR) TYPE(*CHAR) LEN(1) VALUE('J')
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) VALUE('00') +
                          /* Antall utskrifter. */
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)            /* +
                          Kode = 'F', 'T'. 'F'=fraktbrev, +
                          'T'=tollpassfraktbrev  */
             DCL        VAR(&VB) TYPE(*CHAR) LEN(1) VALUE(' ') /* +
                          Hvis &VB = 'J',  VALGBILDE              +
                          til bruker. */
             DCL        VAR(&PO) TYPE(*CHAR) LEN(1) VALUE('F')  /* +
                          Hvis &PO = 'J',SORT   F=FAX             */
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FBN) TYPE(*CHAR) LEN(3)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
    /* SKRIVER UT FRAKTBREVKOPI           */
    /*                                    */

             CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
/*V10        CHGDTAARA  DTAARA(*LDA (22 8)) VALUE(&OPD *CAT &FBN) */
/*V10*/      CHGDTAARA  DTAARA(*LDA (22 8)) VALUE('00000000')
/*V10*/      CHGDTAARA  DTAARA(*LDA (82 7)) VALUE(&OPD)
/*V10*/      CHGDTAARA  DTAARA(*LDA (89 3)) VALUE(&FBN)
/* Kode G = alle fraktbrev på tur, &opd=1-7 av tur, &FBN=6-8 av tur */
/*N01*/      IF         COND(&KODE = 'G') THEN(DO)
/*N01*/      CHGVAR     VAR(&KODE) VALUE('F')
/*N01*/      CHGDTAARA  DTAARA(*LDA (22 7)) VALUE(&OPD)
/*N01*/      CHGDTAARA  DTAARA(*LDA (27 3)) VALUE(&FBN)
/*N01*/      CHGDTAARA  DTAARA(*LDA (82 10)) VALUE('0000000000')
/*N01*/      ENDDO
             CHGDTAARA  DTAARA(*LDA (64 6)) VALUE('000000')

/******************************************************************/
/*     F         SYFA20P  FRAKTBREV          **********************/
/******************************************************************/
             IF         COND(&KODE = 'F') THEN(DO)
             IF         COND(&INFOP = 'D') THEN(OVRPRTF +
                        FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 80) LPI(12) CPI(10) OVRFLW(140) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF))
             ELSE       CMD(OVRPRTF FILE(SYFA12P) DEV(FAX3812) +
                          DEVTYPE(*AFPDS) PAGESIZE(140 80) LPI(12) +
                          CPI(10) OVRFLW(140) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD))
                          ENDDO
/*                                                               */

/******************************************************************/
/*     T         SYFA20P  TOLLPASSFRAKTBREV  **********************/
/******************************************************************/
             IF         COND(&KODE = 'T') THEN(DO)
             IF         COND(&INFOP = 'D') THEN(OVRPRTF +
                        FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 80) LPI(12) CPI(10) OVRFLW(140) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF))
                          ELSE CMD(OVRPRTF +
                        FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 80) LPI(12) CPI(10) OVRFLW(140) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD))
                          ENDDO
/*                                                               */
             CALL       PGM(SYFA12) PARM(&PRANT &KODE &VB &PO &PDFDIR)

/******************************************************************/
/*     RETURNER VED DIREKTE = D              **********************/
/******************************************************************/
             IF         COND(&INFOP = 'D') THEN(RETURN)
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(SYFA12P) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
             IF         COND(&INFOP = 'J') THEN(DO)
             CHGVAR     VAR(&FILEN) VALUE('SYFA12P')
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
/**  VENT NOEN SEKUNDER SLIK AT FILEN ER FERDIG "PRINTET" FØR SLETT */
/**  CPF34A4 = DU PRØVDE Å HOLDE TILBAKE ELLER SLETTE FIL SYFA12P...*/
/**     .....  MENS DEN BLE SKREVET UT (STATUS PRT).................*/
             IF         COND(&INFOP = 'N') THEN(DO)
             DLYJOB     DLY(3)
             DLTSPLF    FILE(SYFA12P) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
             ENDDO
    /* */
 SLUTT:      ENDPGM
