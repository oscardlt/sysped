********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 FEILRETTING PGA. 7-SIFRE OPPDRAGSNR
10XXX * 02 JOV PTF10 Utlev-forhold / rev image - på tvers
10XXX * 03 JOV PTF10 Produkt POZX4=Abbonementstransport (så godt som FREJAspesial)
10XXX * 04 YBC PTF10 POSTADRESSE TIL UTLEVERINGSSTED
      * 05 JOV PTF10 TG MYPACK via BRING - hardkodet på PRODKODE
********************************************************************
     H FTRANS
     FDOKUF     IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FFIRFB     UF   E           K DISK
     FDOKUFM    UF A E           K DISK
     FHEADF     IF   E           K DISK
N03  FKALENDER  IF   E           K DISK
     FLLHEAD07  IF   E           K DISK
     FLLLINE    IF   E           K DISK
     FZBARC     O    F   66        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D A4              S              1    DIM(4)                               Input string
     D B4              S              1    DIM(4)                               Output string
     D Æ               S              1    DIM(20)                              Input string
     D Å               S              1    DIM(20)                              Output string
     D                 DS
     D  DATA                   1     66
     D  DATA1                  4     66
     D  DATA3                  1      3
     D  TG2                    6     14
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS
      * Gør om antall kolli
     D  LANUMA                 1      4  0
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  WRK                    1      4  0
     D                 DS
     D  WPCN                   1      4  0
     D  WPCA                   1      4
     D  WPCB                   2      4
N02  D                 DS
N02  D  HEFT1                  1     51
N02  D  HEFT1A                 1     30
N02  D  HEFT1B                31     45
     D                 DS
     D  DF1004                 1     35
     D  DF1004A                2     10
     D                 DS
     D  WTIME                  1     14  0
     D  WTID                   1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D  WTIDA                  1      2
     D  WTIDB                  3      4
     D  WDDA                   7      8
     D  WMMA                   9     10
     D  WÅÅA                  11     14
N03  D                 DS
N03  D  Idag                   1      8  0
N03  D  WÅÅi                   1      4  0
N03  D  WMMi                   5      6  0
N03  D  WDDi                   7      8  0
     D                 DS
S01  D* WREF                   1     18
N01  D  WREF                   1     20
     D  WRA                    1      4
     D  WRB                    5      5
S01  D* WRC                    6     10
S01  D* WRD                   11     11
S01  D* WRE                   12     14
S01  D* WRF                   15     15
S01  D* WRg                   16     18
N01  D  WRC                    6     12
N01  D  WRD                   13     13
N01  D  WRE                   14     16
N01  D  WRF                   17     17
N01  D  WRg                   18     20
     D                 DS
     D  KOID                   1     18
     D  DSIDPK                 1      1
     D  DSIDLA                 2      3
     D  DSIDLE                 4      8
     D  DSIDNR                 9     18
     D                 DS
     D  ALI65                  1     65
     D  ALI65a                 1     50
     D  ALI65b                51     65
     D                 DS
     D  ALI1                   1     50
     D  ALI2                  51    100
     D  ALI3                 101    150
     D  ALI4                 151    200
     D  ALI5                 201    250
     D  ALI                    1    250    DIM(5)
     D                 DS
     D  DFPRO1                 1     30
     D  DFPR15                 1      5
      * Input Parameter
     C     *ENTRY        PLIST
     C                   PARM                    WFIRM             2
     C                   PARM                    WMLAYO            2
     C                   PARM                    WFAVD
     C                   PARM                    WFOPD
     C                   PARM                    WFFBNR
     C                   PARM                    uukopi            1
      * Open Printerfile
     C                   OPEN      ZBARC                                55
      * Execute init routine only once
     C                   EXSR      SRINIT
      * Juster ALT xx dots til venstre (60 dots er ca 1 cm til venstre)
      * (Forenkler kundetilpasning)
     C                   MOVE      '0  '         LSDOTS            3
     C     DOKKEY        CHAIN     DOKUF                              55
     C     HEAKEY        CHAIN     HEADF                              55
N05  c     DFPROK        ifeq      'TG9M'
N05  c     DFPROK        oreq      'TG9MB'
N05  C                   eval      DFPROK ='P412 '
N05  c                   eval      DFKNS  ='00098287279'
N05  c                   eval      DFKNM  =*blanks
N05  c                   endif
     C                   EXSR      SRINKOID
N02   * EDI ventekode telle som utlev.forbehold
N02  c     DFVEN         Ifne      ' '
N02  c     HEFT1A        ifeq      *blanks                                      Ikke utlev.forb.h.
N02  c     HEKFT1        orne      *blanks                                      eller er utkvittert
N02  c                   eval      HEFT1a='Ventekode '
N02  c                             +DFVEN+' på fr.br'
N02  c                   eval      HEKFT1=' '
N02  c                   endif
N02  c                   endif
      * Loop number of pieces
     C                   Z-ADD     1             WPCN
     C     WPCN          DO        DFNTLA        WPCN
      * Execute Label Init
      * Send Default Instructions  (flyttet fra sr0001/sr0001K)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    ZBARCA
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    ZBARCA
     c     uukopi        ifne      'J'
     C                   EXSR      SR0001
     C                   else
     c                   EXSR      SR0001K
     c                   end
      * Execute Label top Text
     C                   EXSR      SR0010
      * Strekkode EAN 128
     C                   EXSR      SR0190
      * Execute Label Lines vert/hor
     C                   EXSR      SR0005
      * Til postnummer
     C                   EXSR      SR0040
      * Execute Shipper Name/address 1
     C                   EXSR      SR0080
      * Execute Shipper Name/address 2
     C     DFAD1S        IFNE      *BLANKS
     C                   EXSR      SR0090
     C                   ENDIF
      * Execute Shipper Name/address 3
     C*    DFAD2S        IFNE      *BLANKS
     C*                  EXSR      SR0100
     C*                  ENDIF
      * Execute Shipper Name/address 4
     C     DFAD3S        IFNE      *BLANKS
     C                   EXSR      SR0105
     C                   ENDIF
      * Execute Consignee Name/address 1
     C                   EXSR      SR0110
      * Execute End Label Format
     C                   EXSR      SREND
      *
     C                   ENDDO
      * Close Prinerfile
     C                   CLOSE     ZBARC                                55
      * End Program
     C                   seton                                        LR
     C                   RETURN
      *_____________________________________________________
      * Execute Label Init
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
     C                   MOVE      *BLANKS       KOID
      * Hent kolli-id, dersom dette er definert
     C     KOLLIID       IFEQ      'J'
     C     WFIRM         CHAIN     FIRFB                              33
     C                   ADD       1             FIIDNR
     C                   UPDATE    FIRFBR
     C                   MOVE      '3'           DSIDPK
     C                   MOVE      FIIDLA        DSIDLA
     C                   MOVE      FIIDLE        DSIDLE
     C                   MOVEL     FIIDNR        DSIDNR
     C                   MOVE      *ZEROS        UAN22            22
     C                   MOVE      KOID          UAN22
     C                   CALL      'SYGE08'
     C                   PARM                    UAN22
     C                   MOVE      UAN22         KOID
     C                   ADD       1             FMMKNR
     C                   MOVEL     KOID          FMMRK1
     C                   WRITE     DOKUFMR
     C                   END
     C*
     C                   ENDSR
      *_____________________________________________________
      * Execute Label Init copyprint
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001K       BEGSR
     C                   MOVE      *BLANKS       KOID
     c                   z-add     wpcn          FMMKNR
     c                   move      '0'           *in33
     C     DOKUFMKE2     SETLL     DOKUFM
     C     DOKUFMKE2     READE(N)  DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
     C     FMST          IFEQ      'I'
     C     FMST          OREQ      'E'
     C                   MOVEL     FMMRK1        KOID
     C                   goto      utkoid
     C                   END
     C     DOKUFMKE2     READE     DOKUFM                                 33
     C                   END
     C     UTKOID        TAG
      * hvis ikke finner kolliid på posisjonen hentes id
     C     KOID          IFEQ      *blanks
     c     kolliid       andeq     'J'
     c                   sub       1             FMMKNR
     C                   exsr      sr0001
     C                   end
     C     ut01k         ENDSR
      *____________________________________________________
      * Execute Label Lines Hor/Vert
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0005        BEGSR
      * First horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,200'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Second horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,420'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,3'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Third horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,545'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
N02   * venstre lodrette strek
N02   * svart box:GBw,h,t(width,hight,thick(thick mer enn 1/2 av lengste dim w/h=helsvart))
N02   *                  (kan også sette en dim=0 og bruke kun thicknes for å definere svart boks)
N02  C                   eval      Data = '^FO1,206^GB0,339,6^FS'
N02  C                   EXCEPT    ZBARCA
N02   * høyre  lodrette strek (men ikke når det er utlev.forbehold..)
N02  C     HEFT1A        IFeq      *blanks                                       UTLforbehold
N02  C     HEKFT1        orne      *blanks                                       IKKE KVITTE
N02   * svart box:GBw,h,t(width,hight,thick(thick mer enn 1/2 av lengste dim w/h=helsvart))
N02   *                  (kan også sette en dim=0 og bruke kun thicknes for å definere svart boks)
N02  C                   eval      Data = '^FO714,206^GB0,339,6^FS'
N02  C                   EXCEPT    ZBARCA
N02  C                   endif
      * Forth horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,655'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,3'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Fifth horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,810'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,3'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Sixth horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,910'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,3'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * seventh horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,1160'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,3'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * eight horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,1235'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Execute Label top Text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C     LSDOTS        IFNE      '0  '
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     LSDOTS        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      * Kundenummer/Aktørnummer, ledetekst
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '100,700'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kundenr/Aktø'DATA1
     C     DATA1         CAT       'rnr':0       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Kundenummer/Aktørnummer, variabel
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '300,700'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFKNS         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Produktkode - tekst
     C     DFPROK        IFNE      *BLANKS
     C                   MOVEL     DFPROK        WFKOD
     C     KOKEY         CHAIN     KOFAST                             56
     C     *IN56         IFEQ      *OFF
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,740'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KFTXT         DATA1
     C     DFPR15        IFEQ      'RETUR'
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       DFPRO1:0      DATA1
     C                   END
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
     C                   ENDIF
      * Produktkode ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '570,775'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'ProduktID'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Produktkode kode
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '650,775'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   SELECT
     C     WFKOD         WHENEQ    'POZX1'
     C     DFPR15        IFNE      'RETUR'
     C                   MOVEL     '1002'        DATA1
     C                   ELSE
     C                   MOVEL     '1224'        DATA1
     C                   END
     C     WFKOD         WHENEQ    'POZX2'
     C     DFPR15        IFNE      'RETUR'
     C                   MOVEL     '1854'        DATA1
     C                   ELSE
     C                   MOVEL     '1224'        DATA1
     C                   END
     C     WFKOD         WHENEQ    'POZB1'
     C                   MOVEL     '1006'        DATA1
     C     WFKOD         WHENEQ    'PO7  '
     C     DFPR15        IFNE      'RETUR'
     C                   MOVEL     '1000'        DATA1
     C                   ELSE
     C                   MOVEL     '1225'        DATA1
     C                   END
N03  C     WFKOD         WHENEQ    'POZX4'
N03  C                   MOVEL     '1885'        DATA1
     C     WFKOD         WHENEQ    'PO12 '
     C     DFPR15        IFNE      'RETUR'
     C                   MOVEL     '1202'        DATA1
     C                   ELSE
     C                   MOVEL     '1207'        DATA1
     C                   END
     C     WFKOD         WHENEQ    'PO2  '
     C                   MOVEL     '1312'        DATA1
     C     WFKOD         WHENEQ    'PO2  '
     C                   MOVEL     '1312'        DATA1
     C     WFKOD         WHENEQ    'POXHD'
     C                   MOVEL     '1736'        DATA1
     C     WFKOD         WHENEQ    'PO8  '
     C                   MOVEL     '1020'        DATA1
     C     WFKOD         WHENEQ    'POZX3'
     C                   MOVEL     '1884'        DATA1
     C     WFKOD         WHENEQ    'PO9  '
     C                   MOVEL     '1988'        DATA1
     C                   ENDSL
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Produktkode prioritet
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
s03  C*                  MOVEL     '570,660'     DATA1
N03  C                   MOVEL     '610,660'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',130,90'     DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   SELECT
     C     WFKOD         WHENEQ    'POZX1'
     C     WFKOD         OREQ      'POZX2'
     C     WFKOD         OREQ      'POZX4'
     C                   MOVEL     '   1'        DATA1
     C     WFKOD         WHENEQ    'PO7  '
     C     WFKOD         OREQ      'PO8  '
     C     WFKOD         OREQ      'PO9 '
     C     WFKOD         OREQ      'POZB1'
     C     WFKOD         OREQ      'POZX3'
     C                   MOVEL     '   2'        DATA1
     C     WFKOD         WHENEQ    'PO12'
     C                   MOVEL     '   3'        DATA1
     C     WFKOD         WHENEQ    'POXHD'
     C                   MOVEL     'H  2'        DATA1
     C     WFKOD         WHENEQ    'PO2  '
     C                   MOVEL     'HP 2'        DATA1
     C                   ENDSL
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
N03   * tillegskoder ved POZX4 Abbonementstransport
N03  C     WFKOD         IFEQ      'POZX4'
N03  c                   move      ' '           LØRD              1
N03  c                   move      ' '           FLER              1
N03  C     KAUDG         ifeq      'Fr'                                         Print FRED=Lev LØRD.
N03  c                   move      'L'           LØRD
N03  c                   endif
N03  c     DFNT          ifgt      1
N03  c                   move      'F'           FLER
N03  c                   endif
N03  C                   eval      Data = '^FO500,670^A0,90,90'                  FO=x/y A0=font h,w
N03  C                             + '^FD'+LØRD+'AT'+FLER+'^FS'
N03  C                   EXCEPT    ZBARCA
N03  c                   endif
      *
N02   * Utlev.forbehold??  - REV IMAGE(må lage svart box først) på tvers ute til høyre
N02  C     HEFT1A        IFNE      *blanks                                       UTLforbehold
N02  C     HEKFT1        ANDEQ     *blanks                                       IKKE KVITTE
N02   * svart box:GBw,h,t(width,hight,thick(thick mer enn 1/2 av lengste dim w/h=helsvart))
N02   *                  (kan også sette en dim=0 og bruke kun thicknes for å definere svart boks)
N02  C                   eval      Data = '^FO657,50^GB0,575,82^FS'
N02  C                   EXCEPT    ZBARCA
N02   * ^Afo,h,w' f=font(0=scalable),o=orienN=norm,R=90%(I=180/B=270),w=height,w=width
N02  C                   eval      Data = '^FO660,60^A0R,75,75'                  FO=x/y A0=font h,w
N02  C                             + '^FR^FD'+%trim(HEFT1A)+'^FS'
N02  C                   EXCEPT    ZBARCA
N02  C                   ENDIF
      * KolliID - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,555'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'KolliID/Lise'DATA1
     C     DATA1         CAT       'nce plate':0 DATA1
     C     DATA1         CAT       'no':1        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * KolliID - nummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,575'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '00'          DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Volum - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '550,555'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Volum dm3'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Sendningsnummer - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,610'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'SendningsID/'DATA1
     C     DATA1         CAT       'Consignmen':0DATA1
     C     DATA1         CAT       'tID':0       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Sendningsnummer - nummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,630'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '401'         DATA1
     C     DATA1         CAT       DF1004:0      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Kolli - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
s03  C*                  MOVEL     '400,610'     DATA1
n03  C                   MOVEL     '470,555'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kolli'       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
N03  c     DFNTLA        ifgt      1
N03  C                   eval      Data = '^FO460,575^A0,30,40'                  FO=x/y A0=font h,w
N03  C                             + '^FD'+%trim(%editc(WPCN:'Z'))
N03  C                             + '/' + %trim(%editc(DFNTLA:'Z'))
N03  C                             +'^FS'
N03  C                   EXCEPT    ZBARCA
N03  c                   endif
      * Kollivekt - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '550,610'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',18,18'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kollivekt'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Gironummer - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '250,820'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',14,14'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kontonr'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Gironummer, data
     C                   IF        DFBELE > 0
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '250,840'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFPRO2        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Postoppkrav  ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,820 '     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',14,14'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Beløp kr'    DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Postoppkrav, beløp
     C                   IF        DFBELE > 0
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,840'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     DFBELE        ØN152
     C                   EXSR      SRNE1
     C                   MOVEL     ØAN           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Postoppkrav, COD-tekst hardkodet
     C                   IF        DFBELE > 0
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '600,840'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'COD'         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Postoppkrav, OPPKRAV-tekst hardkodet
     C                   IF        DFBELE > 0
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '550,870'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'OPPKRAV'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Postoppkrav, Firkant runt teksten
     C                   IF        DFBELE > 0
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,820'     DATA1
     C                   EXCEPT    ZBARCA
      * Black Box Instruction
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '180,0,80'    DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Varedeklarasjon/Referanse - ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,1165'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',14,14'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Innhold/Ref' DATA1
     C     DATA1         CAT       'eranse':0    DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Varedeklarasjon/Referanse - referanse
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,1200'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',25,25'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WFAVD         WRA
     C                   MOVEL     '/'           WRB
     C                   MOVEL     WFOPD         WRC
     C                   MOVEL     '/'           WRD
     C                   MOVEL     WFFBNR        WRE
     C                   MOVEL     '/'           WRF
     C                   MOVEL     DFSG          WRG
     C                   MOVEL     WREF          DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Varedeklarasjon/Referanse - godsmerking
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '300,1200'    DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',25,25'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFGM          DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Senders ref
      * Data Position
     C     DFSREF        IFEQ      *BLANKS
     C                   EVAL      DFSREF = HERFA
     C                   END
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '500,1200'    DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',25,25'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFSREF        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Transportinstruksjoner, ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,920 '     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',14,14'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Transportins'DATA1
     C     DATA1         CAT       'truksjoner':0DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * DERSOM FRA PLUKKSEDDEL HENT ART / ANT.. #XXX*YY,#XXX*YY,#XXX*YY,OSV
     C                   EXSR      SRGENALI
     C     1             DO        5             li
     C     ALI(li)       CABEQ     *BLANKS       UTALI
     C                   EXSR      SRPRTALI
     C                   END
     C     UTALI         TAG
     C                   ENDSR
      *_____________________________________________________
      * Generer inntil 5 linjer med art/ant fra LOGI
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRGENALI      BEGSR
     C                   z-add     940           VertPlas          4 0
     C                   MOVEA     *blanks       ALI
     C                   move      *zeros        li                2 0
     C     HEAKEY        Chain     LLHEAD07                           33
     C     *IN33         CABEQ     '1'           UtGAli
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE     LLLINE                                 33
     C     *IN33         DOWEQ     *OFF
     C                   z-add     LLWNT0        ant3              3 0
     C                   move      ant3          ant3a             3
     C                   CAT       '#':0         ALI65
     C                   CAT       LLANR:0       ALI65
     C                   CAT       '*':0         ALI65
     C                   CAT       ant3a:0       ALI65
     C                   CAT       ',':0         ALI65
      * kommet lenger enn 50, lagre forige, påbegynn ny
     C     ALI65B        IFNE      *Blanks
     C                   add       1             li
     C                   MOVEA     ALI50GM       ALI(li)
     C     li            cabge     5             UtgAlix
     C                   Eval      ALI65 = '#' + LLANR
     C                   CAT       '*':0         ALI65
     C                   CAT       ant3a:0       ALI65
     C                   CAT       ',':0         ALI65
     C                   End
      * bevar hittil akkumulert...
     C                   MOVE      ALI65a        ALI50GM          50
     C     LHMN          READE     LLLINE                                 33
     C                   end
      * lagre siste linje som var under arbeid
     C     Utgalix       tag
     C     Li            iflt      5
     C                   add       1             li
     C                   MOVEA     ALI50GM       ALI(li)
     c                   end
     C     Utgali        ENDSR
      *_____________________________________________________
      * Print en linje med art/ant
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRPRTALI      BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   Move      VertPlas      VertPlasA         4
     C     '18,'         CAT       VertPlasA:0   DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',25,25'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     ALI(li)       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * øk vert. plassering med 40 (ny linje)
     C                   add       40            VertPlas          4 0
     C                   ENDSR
      *_____________________________________________________
      * Til postnummer
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0040        BEGSR
      * Print leading text-1
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,280'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Utleveringsa'DATA1
     C     DATA1         CAT       'dresse':0    DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Destination Code
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,305'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',130,90'     DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFPOUL        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Destination Name
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '240,310'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
N04  C                   IF        DFADUL = *BLANKS
     C                   MOVEL     DFAD1L        DATA1
N04  C                   ELSE
N04  C                   MOVEL     DFADUL        DATA1
N04  C                   END
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Postadresser, ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,430'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Postadresse' DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Postadresser, linje-1
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,460'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFAD1M        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Postadresser, linje-2
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,490'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFAD3M        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Telefonnummer, ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '380,460'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Telefon/Phon'DATA1
     C     DATA1         CAT       'e':0         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Telefonnummer, data
     C                   IF        DFBELE > 0
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '380,490'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFLEVI        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0080        BEGSR
      * Ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,50'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Fra/From'    DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Ledetekst - 2
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '250,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Pakket dato' DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Dato - klokkeslett
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '450,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WDDA          DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WMMA:0        DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WÅÅA:0        DATA1
     C     DATA1         CAT       WTIDA:2       DATA1
     C     DATA1         CAT       ':':0         DATA1
     C     DATA1         CAT       WTIDB:0       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *Adress variabel - 2
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,83'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',15,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFNAVS        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0090        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,100'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',15,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFAD1S        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 3
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0100        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,117'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',15,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFAD2S        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 4
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0105        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,135'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',15,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVE      '.'           DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFPNLS        DATA1
     C     DATA1         CAT       DFAD3S:1      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0110        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,210'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',12,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/To'      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,233'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',45,45'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFNAVL        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *____________________________________________________
      * Strekkode EAN128
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0190        BEGSR
      * LEDETEKST
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,1250'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',25,25'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'LICENCE PLAT'DATA1
     C     DATA1         CAT       'E No':0      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * SELVE STREKKODEN
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '50,1290'     DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   EVAL      DATA1='N,220,N,N,Y,N'
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>800'      DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * SKRIV UT KOLLI ID UNDER STREKKODEN
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '100,1520'    DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '00'          DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      * SRNE1 er helt omskreven
      *_____________________________________________________
      * Leftjustify num.fields
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRNE1         BEGSR
      * Move correct value into alpha 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C     ØADEC         ANDEQ     'N'                                          <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      ',  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C                   END                                                    <-------------I
      * search from left and find first sign over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   LEAVE                                                               II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      * Reset decimal indicator
     C                   MOVE      'N'           ØADEC
      *
     C                   ENDSR
      *_____________________________________________________
      * Center text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCENT        BEGSR
     C                   MOVEA     *BLANKS       Å
      * Find rightmost character of input
     C     SRB1          TAG
     C     ÆX            CABEQ     0             CENT99
     C     Æ(ÆX)         IFEQ      *BLANKS
     C                   SUB       1             ÆX
     C                   GOTO      SRB1
     C                   ENDIF
      * Sub from the rightmost counter
      * This is only valid if formtype A0 us used because blank
      * caracters uses less space in grafic mode.
     C     DATA3         IFEQ      '^A0'
     C                   SELECT
     C     ÆX            WHENLT    19
     C     ÆX            ANDGE     15
     C                   SUB       2             ÆX
     C     ÆX            WHENLT    14
     C     ÆX            ANDGE     10
     C                   SUB       4             ÆX
     C     ÆX            WHENLT    9
     C     ÆX            ANDGE     5
     C                   SUB       6             ÆX
     C     ÆX            WHENLT    4
     C                   SUB       8             ÆX
     C                   ENDSL
     C                   ENDIF
      * Calculate left positions of output
     C     18            SUB       ÆX            ÆX
     C     ÆX            IFGE      2
     C     ÆX            DIV       2             ÆX
     C                   ADD       1             ÆX
     C                   ELSE
     C                   Z-ADD     1             ÆX
     C                   ENDIF
      * Move input to output arrary
     C                   MOVEA     Æ             Å(ÆX)
      *
     C     CENT99        ENDSR
      *_____________________________________________________
      * Initialise subroutine, set character set
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WB3               3            B3
     C                   MOVE      'B3'          WB3               3            B3
      *
     C                   MOVEL     WA            WBC               3            B3
     C                   MOVE      'BC'          WBC               3            B3
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WFR               3            FR
     C                   MOVE      'FR'          WFR               3            FR
      *
     C                   MOVEL     WA            WLS               3            XZ
     C                   MOVE      'LS'          WLS               3            XZ
      *
     C                   Z-ADD     0             ØX                3 0          Index for Ø
     C                   MOVE      *BLANKS       ØAN              12            Num alpha
     C                   MOVE      'N'           ØADEC             1            Decimal Indicator
     C                   Z-ADD     0             ÆX                3 0
      * Define workfields
     C     *LIKE         DEFINE    DFRI          WFRI
     C     *LIKE         DEFINE    DFAVD         WFAVD
     C     *LIKE         DEFINE    DFOPD         WFOPD
     C     *LIKE         DEFINE    DFFBNR        WFFBNR
     C     *LIKE         DEFINE    KFTYP         WFTYP
     C     *LIKE         DEFINE    KFKOD         WFKOD
     C                   MOVEL     'F'           WFRI
     C                   MOVEL     'FRBREVPRO'   WFTYP
     C     DOKKEY        KLIST
     C                   KFLD                    WFRI
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C                   KFLD                    WFFBNR
     C     HEAKEY        KLIST
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C     FAKTKE        KLIST
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C                   KFLD                    WFFBNR
     C     KOKEY         KLIST
     C                   KFLD                    WFTYP
     C                   KFLD                    WFKOD
     C     DOKUFMKEY     KLIST
     C                   KFLD                    FMRI
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     C     DOKUFMKE2     KLIST
     C                   KFLD                    FMRI
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     c                   KFLD                    FMMKNR
      * HENTE DAGENS DATO OG TID
     C                   TIME                    WTIME
n03  C                   Move      WÅÅ           WÅÅi
n03  C                   Move      WMM           WMMi
n03  C                   Move      WDD           WDDi
n03  c     Idag          chain     KALENDER
      *
     C                   Move      *zeros        AntExtL           4 0
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to end Label Format
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C     LSDOTS        IFNE      '0  '
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     0             DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to INIT Colli_ID handling
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINKOID      BEGSR
      * SKAL KOLLI-ID TILDELES??
     C                   MOVE      'N'           KOLLIID           1
     C     WFIRM         CHAIN(N)  FIRFB                              33
     C     *IN33         IFEQ      '0'
     C     FIIDNR        ANDNE     *ZEROS
     C                   MOVE      'J'           KOLLIID
      * SLETT EVT. TIDLIGERE TILDELT KOLLIID
     C                   MOVE      DFRI          FMRI
     C                   MOVE      DFAVD         FMAVD
     C                   MOVE      DFOPD         FMOPD
     C                   MOVE      DFFBNR        FMFBNR
     C                   MOVE      *ZEROS        FMLINR
     C     DOKUFMKEY     SETLL     DOKUFM
     C     DOKUFMKEY     READE     DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
     C     FMST          IFEQ      'E'
     C                   ADD       1             AntExtL
     C                   END
     C     FMST          IFEQ      'I'
     C     uukopi        ifne      'J'
     C                   DELETE    DOKUFMR
     C                   else
     C                   UPDATE    DOKUFMR
     c                   end
     C                   ELSE
     C                   UPDATE    DOKUFMR
     C                   END
     C     DOKUFMKEY     READE     DOKUFM                                 33
     C                   END
      * INITIER FOR UTLEGGING AV NYE
     C                   MOVE      *ZEROS        FMMKNR
     C                   MOVE      *ZEROS        FMLONR
     C                   MOVE      *BLANKS       FMMRK1
     C                   MOVE      'I'           FMST
     C                   END
      *
      *
      * Eksterne lapper er funnet, simuler kopi.
     C     AntExtL       IFNE      *zeros
     C                   Move      'J'           uukopi
     C                   z-add     AntExtL       DFNTLA
     C                   END
      *
     C                   ENDSR
     OZBARC     E            ZBARCA
     O                       DATA
** TABELL FOR OVERSETTELSE TIL Æ,Ø,Å FOR ZEBRA STRIPE PRINTERE
ZBARC     9E7B
ZBARC     E07C
ZBARC     9F5B
ZBARC     9CC0
ZBARC     BB6A
ZBARC     47D0
