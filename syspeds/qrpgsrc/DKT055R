     FDKT055D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FDKTFI     UF   E             DISK
     FEDII      IF   E           K DISK
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_______________________
      * Hent firmaopplysninger
      *"""""""""""""""""""""""
     C     1             CHAIN(N)  DKTFI                              51
     C                   CLEAR                   DKT055DA
     C                   EVAL      ZVTF_0004T=DKTF_0004T
     C                   EVAL      ZVTF_0010T=DKTF_0010T
     C                   EVAL      ZVTF_0022T=DKTF_0022T
     C                   EVAL      ZVTF_0031T=DKTF_0031T
     C                   EVAL      ZVTF_FTIPT=DKTF_FTIPT
     C                   EVAL      ZVTF_FTUST=DKTF_FTUST
     C                   EVAL      ZVTF_FTPWT=DKTF_FTPWT
     C                   EVAL      ZVTF_0004P=DKTF_0004P
     C                   EVAL      ZVTF_0010P=DKTF_0010P
     C                   EVAL      ZVTF_0022P=DKTF_0022P
     C                   EVAL      ZVTF_0031P=DKTF_0031P
     C                   EVAL      ZVTF_FTIPP=DKTF_FTIPP
     C                   EVAL      ZVTF_FTUSP=DKTF_FTUSP
     C                   EVAL      ZVTF_FTPWP=DKTF_FTPWP
     C                   EVAL      ZVTF_LSLI=DKTF_LSLI
      *_______________
      * Behandle bilde
      *"""""""""""""""
     C     SRB1          TAG

     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     DKT055DØ
     C                   EXFMT     DKT055DA
     C                   EVAL      *IN30=*OFF
     C                   EVAL      *IN31=*OFF
     C                   EVAL      *IN32=*OFF
     C                   EVAL      *IN33=*OFF
     C                   EVAL      *IN34=*OFF
     C                   EVAL      *IN35=*OFF
     C                   EVAL      *IN36=*OFF
     C                   EVAL      *IN37=*OFF
     C                   EVAL      *IN38=*OFF
     C                   EVAL      *IN41=*OFF
     C                   EVAL      *IN42=*OFF
     C                   EVAL      *IN43=*OFF
     C                   EVAL      *IN44=*OFF
     C                   EVAL      *IN45=*OFF
     C                   EVAL      *IN46=*OFF
     C                   EVAL      *IN47=*OFF
     C                   EVAL      *IN48=*OFF
      *_______________
      * F3,F12=Avlsutt
      *"""""""""""""""
     C                   IF         *IN03
     C                   GOTO      SRB9
     C                   ENDIF
     C                   IF         *IN12
     C                   GOTO      SRB9
     C                   ENDIF
      *_______
      * F4=Søk
      *"""""""
     C                   IF        *IN04

     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * Avsændarid
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDEQ     32
     C                   CALL      'EDI52R'
     C                   PARM                    ZVTF_0004T
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDEQ     32
     C                   CALL      'EDI52R'
     C                   PARM                    ZVTF_0010T
     C                   GOTO      SRB1
     C                   ENDIF

     C                   ENDIF
      *___________
      * Test input
      *"""""""""""
     C     SRB2          TAG
      *-----------------------TEST---------------------------
      * Avsændarid må vare utfyllt
     C     ZVTF_0004T    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN31=*ON
     C                   MOVE      'DKT0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Avsændarid må finnes
     C     ZVTF_0004T    CHAIN     EDII                               30
     C                   IF        *IN30
     C                   EVAL      *IN31=*ON
     C                   MOVE      'DKT0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid må vare utfyllt
     C     ZVTF_0010T    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN32=*ON
     C                   MOVE      'DKT0002'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid må finnes
     C     ZVTF_0010T    CHAIN     EDII                               30
     C                   IF        *IN30
     C                   EVAL      *IN32=*ON
     C                   MOVE      'DKT0002'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Løsenord må vare utfyllt
     C     ZVTF_0022T    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN33=*ON
     C                   MOVE      'DKT0004'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Brugerid må vare utfyllt
     C     ZVTF_FTUST    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN34=*ON
     C                   MOVE      'DKT0008'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Løsenord må vare utfyllt
     C     ZVTF_FTPWT    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN35=*ON
     C                   MOVE      'DKT0004'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      *-----------------------PROD---------------------------
      * Avsændarid må vare utfyllt
     C     ZVTF_0004P    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN41=*ON
     C                   MOVE      'DKT0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Avsændarid må finnes
     C     ZVTF_0004P    CHAIN     EDII                               30
     C                   IF        *IN30
     C                   EVAL      *IN41=*ON
     C                   MOVE      'DKT0001'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid må vare utfyllt
     C     ZVTF_0010P    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN42=*ON
     C                   MOVE      'DKT0002'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Mottagarid må finnes
     C     ZVTF_0010P    CHAIN     EDII                               30
     C                   IF        *IN30
     C                   EVAL      *IN42=*ON
     C                   MOVE      'DKT0002'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Løsenord må vare utfyllt
     C     ZVTF_0022P    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN43=*ON
     C                   MOVE      'DKT0004'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Brugerid må vare utfyllt
     C     ZVTF_FTUSP    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN44=*ON
     C                   MOVE      'DKT0008'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      * Løsenord må vare utfyllt
     C     ZVTF_FTPWP    IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN45=*ON
     C                   MOVE      'DKT0004'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF
      *-----------------------GEMENSAMT----------------------
      * Bibliotek for LSOUTPUT må være utfyllt
     C     ZVTF_LSLI     IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   EVAL      *IN47=*ON
     C                   MOVE      'DKT0009'     ZMSGNO
     C                   GOTO      SRB1
     C                   ENDIF

     C     1             CHAIN     DKTFI                              51

     C                   EVAL      DKTF_0004T=ZVTF_0004T
     C                   EVAL      DKTF_0010T=ZVTF_0010T
     C                   EVAL      DKTF_0022T=ZVTF_0022T
     C                   EVAL      DKTF_0031T=ZVTF_0031T
     C                   EVAL      DKTF_FTIPT=ZVTF_FTIPT
     C                   EVAL      DKTF_FTUST=ZVTF_FTUST
     C                   EVAL      DKTF_FTPWT=ZVTF_FTPWT
     C                   EVAL      DKTF_0004P=ZVTF_0004P
     C                   EVAL      DKTF_0010P=ZVTF_0010P
     C                   EVAL      DKTF_0022P=ZVTF_0022P
     C                   EVAL      DKTF_0031P=ZVTF_0031P
     C                   EVAL      DKTF_FTIPP=ZVTF_FTIPP
     C                   EVAL      DKTF_FTUSP=ZVTF_FTUSP
     C                   EVAL      DKTF_FTPWP=ZVTF_FTPWP
     C                   EVAL      DKTF_LSLI=ZVTF_LSLI
     C                   UPDATE    DKTFIR

     C   30              GOTO      SRB1

     C     SRB9          ENDSR
