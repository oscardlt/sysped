/* D I INFOPRINT SH   */
/* UTKØ OUTMAIL       */
             PGM        PARM(&AVD &OPD &STMF &BANE &VISE &INFOP)
             DCL        VAR(&DRAWER) TYPE(*CHAR) LEN(7)
             DCL        VAR(&DRAWUT) TYPE(*CHAR) LEN(11)
             DCL        VAR(&COPIES)  TYPE(*CHAR) LEN(6)
             DCL        VAR(&LOGO)  TYPE(*CHAR) LEN(9)
             DCL        VAR(&PNAVN)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PT) TYPE(*CHAR) LEN(10) /* Papirtype til +
                          fakturaer. */
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
             DCL        VAR(&MSGTXT) TYPE(*CHAR) LEN(12) /* +
                          Meldingtekst */
             DCL        VAR(&UFAX) TYPE(*CHAR) LEN(10) VALUE('E') /* +
                          KALLES FRA FAXRUTINE. */
    /* */
             DCL        VAR(&LASER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAKT) TYPE(*DEC) LEN(3 0) VALUE(013) /* KJ.KVITT */
             DCL        VAR(&LPI2) TYPE(*DEC) LEN(2 0)
    /* */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
    /* */
VIDERE:      CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
             CHGDTAARA  DTAARA(*LDA (22 8)) VALUE('00000000')
             CHGDTAARA  DTAARA(*LDA (100 1)) VALUE('F')
             CHGDTAARA  DTAARA(*LDA (101 7)) VALUE(&OPD)
             CHGDTAARA  DTAARA(*LDA (108 30)) +
                          VALUE('000000000000000000000000000000')
             CHGDTAARA  DTAARA(*LDA (138 29)) +
                          VALUE('0000000000000000000')
             CHGDTAARA  DTAARA(*LDA (209 8)) VALUE('00000000')
             CHGDTAARA  DTAARA(*LDA (231 3)) VALUE('000')

    /* */
             CALL       PGM(GETPRN) PARM(&AVD &FAKT &PNAVN &FORM +
                          &LASER &LPI2 &DRAWER &COPIES &LOGO &DRAWUT)

    /*                                    */
    /*                                    */
    /* START FOR PDF DOKUMENTER           */
    /*                                    */
/* */
             IF         COND(&INFOP *NE 'D') THEN(DO)
             OVRPRTF    FILE(SYFK40PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(60) +
                          FNTCHRSET(*LIBL/C0D0GT10 *LIBL/T1V10277) +
                          FRONTOVL(&LOGO) OUTQ(OUTMAIL)
             OVRPRTF    FILE(SYFK40P2) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(57) FRONTOVL(&LOGO) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD)
             ENDDO
             IF         COND(&INFOP = 'D') THEN(DO)
             OVRPRTF    FILE(SYFK40PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(60) +
                          FNTCHRSET(*LIBL/C0D0GT10 *LIBL/T1V10277) +
                          FRONTOVL(&LOGO) OUTQ(OUTMAIL) +
                          FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF)
             OVRPRTF    FILE(SYFK40P2) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(57) FRONTOVL(&LOGO) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) +
                          TOSTMF(&BANE) WSCST(*PDF)
             ENDDO
    /*            */
             OVRMSGF    MSGF(QUSERMSG) TOMSGF(SYMSGF)
             CALL       PGM(SYFK40) PARM(&PRANT &UFAX)
    /* */
             CHGVAR     VAR(&FILEN) VALUE('SYFK40PF')
    /* VED RETUR S ER DET SJØ LAYOUT  */
             IF         COND(&UFAX = 'S') THEN(DO)
             CHGVAR     VAR(&FILEN) VALUE('SYFK40P2')
                          ENDDO
    /* */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE          */
/* UTEN INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILEN) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE           */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
    /* */

 SLUTT:      ENDPGM
