********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 må teste kundefil ved kundegruppe
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT STATISTIKK
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01 02 05-11 13-24 26
      *** LEDIGE INDIKATORER 31 32 63 68-70 74-89 91-94
      ***********************************************************
      *
     FKODTFM    IF   E           K DISK
     FAVDGR     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FSTED2D    IF   E           K DISK
     FBILK      IF   E           K DISK
     FTRAN      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FUNIT      IF   E           K DISK
     FUNITL01   IF   E           K DISK
     F                                     RENAME(UNITR:UNITRL1)
     FUNITL03   IF   E           K DISK
     F                                     RENAME(UNITR:UNITRL3)
     FSTATHFL1  IF   E           K DISK
     FSTATHFL2  IF   E           K DISK
     F                                     RENAME(STATHFR:STATHFR2)
     FSTATOHL1  IF   E           K DISK
     F                                     RENAME(STATHFR:STATOHR1)
     FSTATOHL2  IF   E           K DISK
     F                                     RENAME(STATHFR:STATOHR2)
     FSTATDFL1  IF   E           K DISK
     FSTATODL1  IF   E           K DISK
     F                                     RENAME(STATDFR:STATODR1)
     FSTATWRKF  UF A E           K DISK
     FSTATWRFF  UF   E           K DISK
     F                                     RENAME(STWRKFR:STWRFFR)
     FSTATWR2F  UF A E           K DISK
     FKUFAST    IF   E           K DISK
     FSYFA46FM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FSYFA46PF  O    E             PRINTER
     D TABGR1          S              1    DIM(10) CTDATA PERRCD(1)
     D TABGR2          S              3  0 DIM(10) ALT(TABGR1)
     D TABGR3          S              3  0 DIM(10) CTDATA PERRCD(1)
     D TABGR4          S              1    DIM(10) ALT(TABGR3)
      *
     D T               S             20    DIM(13)                              LEDERTEKST
     D BL2             S             11  0 DIM(13)                              BELØP
     D EL9             S             11  0 DIM(13)                              ELEMENT I WRKFILE
     D EL92            S              9  3 DIM(13)                              M3 LCL I WRKFILE
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTCÅ                 1      4  0
     D  WSDTC                  1      2  0
     D  WSDTÅ                  3      4  0
     D                 DS
     D  SWDTCÅ                 1      4  0
     D  SWDTC                  1      2  0
     D  SWDTÅ                  3      4  0
     D                 DS
     D  YDTCÅ                  1      4  0
     D  YDTC                   1      2  0
     D  YDTÅ                   3      4  0
     D                 DS
     D  YDTCÅ2                 1      4  0
     D  YDTC2                  1      2  0
     D  YDTÅ2                  3      4  0
     D                 DS
     D  STK1                   1      8
     D  STK112                 1      2
     D  STK113                 1      2
     D  STK132                 3      4
     D  STK145                 4      8
     D                 DS
     D  STK2                   1      8
     D  STK212                 1      2
     D  STK245                 4      8
     D  STK252                 5      6
     D  STK263                 6      8
     D  STK272                 7      8
     D                 DS
     D  STGR                   1      2
     D  STGR11                 1      1
     D  STGR21                 2      2
     D                 DS
     D  SWK1                   1      8
     D  SWK112                 1      2
     D  SWK113                 1      3
     D  SWK132                 3      4
     D  SWK145                 4      8
     D                 DS
     D  SWK2                   1      8
     D  SWK212                 1      2
     D  SWK245                 4      8
     D  SWK252                 5      6
     D  SWK263                 6      8
     D  SWK272                 7      8
     D                 DS
     D  XXKN                   1      8  0
     D  XXKNX                  1      8  0
     D                 DS
     D  WSAVD1                 1      4  0
     D  WSAVD2                 5      8  0
     D  WSAVD3                 9     12  0
     D  WSAVD4                13     16  0
     D  WSAVD5                17     20  0
     D  AVD                    1     20  0
     D                                     DIM(5)                               AVDELING
     D  AVD20                  1     20
     D                 DS
     D  STBL01                 1      9  0
     D  STBL02                10     18  0
     D  STBL03                19     27  0
     D  STBL04                28     36  0
     D  STBL05                37     45  0
     D  STBL06                46     54  0
     D  STBL07                55     63  0
     D  STBL08                64     72  0
     D  STBL09                73     81  0
     D  STBL10                82     90  0
     D  STBL11                91     99  0
     D  STBL12               100    108  0
     D  STBL13               109    117  0
     D  BL                     1    117  0
     D                                     DIM(13)                              BELØP
     D                 DS
     D  STFB01                 1     11  0
     D  STFB02                12     22  0
     D  STFB03                23     33  0
     D  STFB04                34     44  0
     D  STFB05                45     55  0
     D  STFB06                56     66  0
     D  STFB07                67     77  0
     D  STFB08                78     88  0
     D  STFB09                89     99  0
     D  STFB10               100    110  0
     D  STFB11               111    121  0
     D  STFB12               122    132  0
     D  STFB13               133    143  0
     D  FB                     1    143  0
     D                                     DIM(13)                              FRAKTBEREGN.VEKT
     D                 DS
     D  STV01                  1     11  0
     D  STV02                 12     22  0
     D  STV03                 23     33  0
     D  STV04                 34     44  0
     D  STV05                 45     55  0
     D  STV06                 56     66  0
     D  STV07                 67     77  0
     D  STV08                 78     88  0
     D  STV09                 89     99  0
     D  STV10                100    110  0
     D  STV11                111    121  0
     D  STV12                122    132  0
     D  STV13                133    143  0
     D  V                      1    143  0
     D                                     DIM(13)                              AKTUELL VEKT
     D                 DS
     D  STA01                  1      9  0
     D  STA02                 10     18  0
     D  STA03                 19     27  0
     D  STA04                 28     36  0
     D  STA05                 37     45  0
     D  STA06                 46     54  0
     D  STA07                 55     63  0
     D  STA08                 64     72  0
     D  STA09                 73     81  0
     D  STA10                 82     90  0
     D  STA11                 91     99  0
     D  STA12                100    108  0
     D  STA13                109    117  0
     D  A                      1    117  0
     D                                     DIM(13)                              ANT. I PERIODE
     D                 DS
     D  STAV01                 1      9  0
     D  STAV02                10     18  0
     D  STAV03                19     27  0
     D  STAV04                28     36  0
     D  STAV05                37     45  0
     D  STAV06                46     54  0
     D  STAV07                55     63  0
     D  STAV08                64     72  0
     D  STAV09                73     81  0
     D  STAV10                82     90  0
     D  STAV11                91     99  0
     D  STAV12               100    108  0
     D  STAV13               109    117  0
     D  AV                     1    117  0
     D                                     DIM(13)                              ANT. I VEKTGRUPPE
     D                 DS
     D  STSS01                 1      9  0
     D  STSS02                10     18  0
     D  STSS03                19     27  0
     D  STSS04                28     36  0
     D  STSS05                37     45  0
     D  STSS06                46     54  0
     D  STSS07                55     63  0
     D  STSS08                64     72  0
     D  STSS09                73     81  0
     D  STSS10                82     90  0
     D  STSS11                91     99  0
     D  STSS12               100    108  0
     D  STSS13               109    117  0
     D  SS                     1    117  0
     D                                     DIM(13)                              ANT. SEND. STKGOD
     D                 DS
     D  STAT01                 1      9  0
     D  STAT02                10     18  0
     D  STAT03                19     27  0
     D  STAT04                28     36  0
     D  STAT05                37     45  0
     D  STAT06                46     54  0
     D  STAT07                55     63  0
     D  STAT08                64     72  0
     D  STAT09                73     81  0
     D  STAT10                82     90  0
     D  STAT11                91     99  0
     D  STAT12               100    108  0
     D  STAT13               109    117  0
     D  AT                     1    117  0
     D                                     DIM(13)                              ANT. SEND. CONTAI
     D                 DS
     D  STVS01                 1     11  0
     D  STVS02                12     22  0
     D  STVS03                23     33  0
     D  STVS04                34     44  0
     D  STVS05                45     55  0
     D  STVS06                56     66  0
     D  STVS07                67     77  0
     D  STVS08                78     88  0
     D  STVS09                89     99  0
     D  STVS10               100    110  0
     D  STVS11               111    121  0
     D  STVS12               122    132  0
     D  STVS13               133    143  0
     D  VS                     1    143  0
     D                                     DIM(13)                              AKT.VEKT LCL
     D                 DS
     D  STM301                 1      9  3
     D  STM302                10     18  3
     D  STM303                19     27  3
     D  STM304                28     36  3
     D  STM305                37     45  3
     D  STM306                46     54  3
     D  STM307                55     63  3
     D  STM308                64     72  3
     D  STM309                73     81  3
     D  STM310                82     90  3
     D  STM311                91     99  3
     D  STM312               100    108  3
     D  STM313               109    117  3
     D  MS                     1    117  3
     D                                     DIM(13)                              M3 LCL
     D                 DS
     D  SWE01                  1     11  0
     D  SWE02                 12     22  0
     D  SWE03                 23     33  0
     D  SWE04                 34     44  0
     D  SWE05                 45     55  0
     D  SWE06                 56     66  0
     D  SWE07                 67     77  0
     D  SWE08                 78     88  0
     D  SWE09                 89     99  0
     D  SWE10                100    110  0
     D  SWE11                111    121  0
     D  SWE12                122    132  0
     D  SWE13                133    143  0
     D  EL                     1    143  0
     D                                     DIM(13)                              ELEMENT I WRKFILE
     D                 DS
     D  SWM01                  1      9  3
     D  SWM02                 10     18  3
     D  SWM03                 19     27  3
     D  SWM04                 28     36  3
     D  SWM05                 37     45  3
     D  SWM06                 46     54  3
     D  SWM07                 55     63  3
     D  SWM08                 64     72  3
     D  SWM09                 73     81  3
     D  SWM10                 82     90  3
     D  SWM11                 91     99  3
     D  SWM12                100    108  3
     D  SWM13                109    117  3
     D  EL2                    1    117  3
     D                                     DIM(13)                              M3 LCL I WRKFILE
     D                 DS
     D  XDB01                  1      7  2
     D  XDB02                  8     14  2
     D  XDB03                 15     21  2
     D  XDB04                 22     28  2
     D  XDB05                 29     35  2
     D  XDB06                 36     42  2
     D  XDB07                 43     49  2
     D  XDB08                 50     56  2
     D  XDB09                 57     63  2
     D  XDB10                 64     70  2
     D  XDB11                 71     77  2
     D  XDB12                 78     84  2
     D  XDB13                 85     91  2
     D  DB                     1     91  2
     D                                     DIM(13)                              DEKNINGSBIDRAG
     D                 DS
     D  XINKGR                 1     19
     D  GR                     1     19
     D                                     DIM(19)                              INK. GR. (PF) PER
     D                 DS
     D  WSGRA                  1      1
     D  WSGRB                  2      2
     D  WSGRC                  3      3
     D  WSGRD                  4      4
     D  WSGRE                  5      5
     D  WSGRF                  6      6
     D  WSGRG                  7      7
     D  WSGRH                  8      8
     D  WSGRI                  9      9
     D  WSGRJ                 10     10
     D  XGR                    1     10
     D                                     DIM(10)                              INK. GR. (FM) PER
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     BILDE1
     C   03              GOTO      SLUTT
     C                   SETOFF                                       30
     C     WSRI          IFEQ      ' '
     C     WSPRO         OREQ      ' '
     C                   GOTO      START
     C                   END
     C                   EXSR      TESTB1
     c     sh            tag
     C   30              GOTO      START
     C                   MOVE      'DIV0000'     MSGNR
     C     *IN43         IFEQ      '1'
     C                   MOVE      'B'           W2KGT
     C                   ELSE
     C                   MOVE      *BLANKS       W2KG
     C                   MOVE      *BLANKS       W2KGT
     C                   END
      *
     C     START2        TAG
     C  N30
     CANN04
     CANN39              Z-ADD     5             LINNBR
     C  N30
     CANN04
     CANN39              Z-ADD     33            POSNBR
     C  N30
     CANN04
     CAN 39              Z-ADD     12            LINNBR
     C  N30
     CANN04
     CAN 39              Z-ADD     64            POSNBR
     C                   EXFMT     BILDE2
     C                   MOVEA     '00000'       *IN(96)
     C                   MOVE      '0'           *IN30
     C                   MOVE      'DIV0000'     MSGNR
     C   41
     COR 43
     COR 47
     COR 48
     COR 49
     COR 50
     COR 56
     COR 57              MOVE      WSKN          WSKNX
     C   59
     COR 61
     COR 62
     COR 65
     COR 67
     COR 66              MOVE      WSKNX         WSKN
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START2
     C                   END
     C   12              DO
     C                   MOVE      ' '           WSRI
     C                   GOTO      START
     C                   END
     C   13              DO
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYPI
     C                   PARM                    UUPDAT
     C                   PARM                    KFKOD
     C                   GOTO      START2
     C                   END
     C   14              DO
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYPK
     C                   PARM                    UUPDAT
     C                   PARM                    KFKOD
     C                   GOTO      START2
     C                   END
      *
     C     WSDTÅ         IFGT      50
     C                   MOVE      '19'          WSDTC
     C                   ELSE
     C                   MOVE      '20'          WSDTC
     C                   END
     C                   MOVE      WSDTCÅ        YDTCÅ
     C     WSDTCÅ        SUB       1             YDTCÅ2
     C                   MOVE      WSAVD         YAVD2             4 0
      *
     C                   EXSR      TESTB2
      * Hvis minst en post finnes på valgt begrep....
     C     *IN30         IFEQ      '0'
     C   43WSKN          IFNE      99999999
     C                   MOVE      *BLANKS       W2KG
     C                   MOVE      'D'           W2KGT
     C                   END
     C   43W2KG          COMP      *BLANKS                            3838
      * FYLLE ÅRETS STATISTIKK PÅ ARBEIDSFIL
     C                   EXSR      FYLLWF
      * FYLLE FJORÅRETS STATISTIKK PÅ ARBEIDSFIL
     C                   EXSR      FYLWF2
      * SKRIV UT STATISTIKK
     C                   EXSR      PRINT
      * TØM FJORÅRETS STATISTIKK SOM IKKE HAR ÅRETS STATISTIKK
     C                   EXSR      TØMWF
     C   43              MOVE      'B'           W2KGT
      *
     C                   MOVE      'DIV0581'     MSGNR
     C                   END
     c                   goto      sh
     C                   GOTO      START2
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVEA     '00000000'    *IN(39)
     C                   MOVEA     '00000000'    *IN(47)
     C                   MOVEA     '00000'       *IN(55)
     C                   MOVEA     '00'          *IN(61)
     C                   MOVEA     '0000'        *IN(64)
     C                   MOVE      WSRI          YRI
     C     WSPRO         COMP      'O'                                    28
      *
     C     WSRI          COMP      '1'                                    39
     C   39              DO
     C                   MOVE      'B'           YRI
     C                   MOVE      *ZEROS        WSAVD
     C                   MOVE      *BLANKS       WSAVDG
     C                   GOTO      SLTB1
     C                   END
     C     WSRI          COMP      'C'                                    40
     C   40              GOTO      SLTB1
     C     WSRI          COMP      'A'                                    41
     C   41              GOTO      SLTB1
     C     WSRI          COMP      'B'                                    42
     C   42              GOTO      SLTB1
     C     WSRI          COMP      'K'                                    43
     C   43              GOTO      SLTB1
     C     WSRI          COMP      'L'                                    44
     C   44              GOTO      SLTB1
     C     WSRI          COMP      'O'                                    45
     C   45              GOTO      SLTB1
     C     WSRI          COMP      'S'                                    46
     C   46              GOTO      SLTB1
     C     WSRI          COMP      'T'                                    47
     C   47              GOTO      SLTB1
     C     WSRI          COMP      'U'                                    48
     C   48              GOTO      SLTB1
     C     WSRI          COMP      'V'                                    49
     C   49              GOTO      SLTB1
     C     WSRI          COMP      'W'                                    50
     C   50              GOTO      SLTB1
     C     WSRI          COMP      'Y'                                    51
     C   51              GOTO      SLTB1
     C     WSRI          COMP      'Z'                                    52
     C   52              GOTO      SLTB1
     C     WSRI          COMP      'P'                                    53
     C   53              GOTO      SLTB1
     C     WSRI          COMP      'Q'                                    54
     C   54              GOTO      SLTB1
     C     WSRI          COMP      'N'                                    55
     C   55              GOTO      SLTB1
     C     WSRI          COMP      'R'                                    56
     C   56              GOTO      SLTB1
     C     WSRI          COMP      'X'                                    57
     C   57              GOTO      SLTB1
     C     WSRI          COMP      'M'                                    58
     C   58              GOTO      SLTB1
     C     WSRI          COMP      'D'                                    59
     C   59              GOTO      SLTB1
     C     WSRI          COMP      'F'                                    64
     C   64              GOTO      SLTB1
     C     WSRI          COMP      'G'                                    65
     C   65              GOTO      SLTB1
     C     WSRI          COMP      'J'                                    66
     C   66              GOTO      SLTB1
     C     WSRI          COMP      'H'                                    61
     C   61              GOTO      SLTB1
     C     WSRI          COMP      'I'                                    62
     C   62              GOTO      SLTB1
     C     WSRI          COMP      'E'                                    67
     C   67              GOTO      SLTB1
     C                   SETON                                        30
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C   40WSRUND        COMP      0                                      99    RUNDTUR
     C   41WSKN          COMP      0                                      99    AGENT
     C   42WSAVD         COMP      0                                      99    AVDELING
     C   42
     CANN99              MOVE      *BLANKS       WSAVDG
     C   42
     CAN 99WSAVDG        COMP      *BLANKS                                99    AVD.GRUPPE
     C   43WSKN          COMP      0                                      99    FAK.MOTTAGER
     C   44WSLK          COMP      *BLANKS                                99    LAND FRA
     C   44W2LK          COMP      *BLANKS                                98    LAND TIL
     C   45WSOT          COMP      *BLANKS                                99    OPPDRAGSTYPE
     C   46WSSG          COMP      *BLANKS                                99    SIGNATUR
     C   47WSKN          COMP      0                                      99    TRANSPORTØR
     C   48WSKN          COMP      0                                      99    FAK.MOTTAGER
     C   48W2LKF         COMP      *BLANKS                                98    FRA LAND
     C   48W2LKT         COMP      *BLANKS                                97    TIL LAND
     C   49WSKN          COMP      0                                      99    FAK.MOTTAGER
     C   49W2KN          COMP      0                                      98    AGENT
     C   50WSKN          COMP      0                                      99    VAREMOTTAGER
     C   51WSBN          IFEQ      *BLANKS                                      BILNR
     C     W2KN          ANDEQ     *ZEROS                                       BILKODE
     C     W2TRME        ANDEQ     *BLANKS                                      TRANS.MÅTE
     C     W2INCR        COMP      ' '                                    99    TRANS.KODE
     C                   END
     C   52WSBK          COMP      *BLANKS                                99    BILKODE
     C   53WSLK          COMP      *BLANKS                                99    LAND FRA
     C   53
     CANN99WSSD          COMP      *BLANKS                                99    STED FRA
     C   54WSLK          COMP      *BLANKS                                99    LAND TIL
     C   54
     CANN99WSSD          COMP      *BLANKS                                99    STED TIL
     C   55WSLK          COMP      *BLANKS                                99    FRALAND
     C   55
     CANN99WSSD          COMP      *BLANKS                                99    FRASTED
     C   55W2LK          COMP      *BLANKS                                98    TILLAND
     C   55
     CANN98W2SD          COMP      *BLANKS                                98    TILSTED
     C   56WSTUR         COMP      *ZEROS                                 99    TUR
     C   57WSKN          COMP      0                                      99    FAK.MOTTAGER
     C   57W2RGF         COMP      *BLANKS                                98    FRA REGION
     C   57W2RGT         COMP      *BLANKS                                97    TIL REGION
     C   58WSRG          COMP      *BLANKS                                99    FRA REGION
     C   58W2RG          COMP      *BLANKS                                98    TIL REGION
     C   59WSKN          COMP      0                                      99    FAK.MOTTAGER
     C   59W2OT          COMP      *BLANKS                                98    OPPDRAGSTYPE
     C   64WSFR          COMP      *BLANKS                                99    FRANKATUR
     C   65WSKN          COMP      0                                      99    FAK.MOTTAGER
     C   65W2FR          COMP      *BLANKS                                98    FRANKATUR
     C   66WSKN          COMP      0                                      99    "PART"
     C   67WSKN          COMP      0                                      99    AGENT
     C   67W2FR          COMP      *BLANKS                                98    FRANKATUR
     C   61WSKN          COMP      0                                      99    FAKT.MOTT.
     C   61W2LK          COMP      *BLANKS                                98    FRALAND
     C   61
     CANN98W2SD          COMP      *BLANKS                                98    FRASTED
     C   62WSKN          COMP      0                                      99    FAKT.MOTT.
     C   62W2LK          COMP      *BLANKS                                98    TILLAND
     C   62
     CANN98W2SD          COMP      *BLANKS                                98    TILSTED
      *
     C   99              DO
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     33            POSNBR
     C   40              MOVE      'SPT0046'     MSGNR
     C   41              MOVE      'SPK0008'     MSGNR
     C   42              MOVE      'SPA0004'     MSGNR
     C   43              MOVE      'SPK0031'     MSGNR
     C   44              MOVE      'SPL0001'     MSGNR
     C   45              MOVE      'SPO0007'     MSGNR
     C   46              MOVE      'SPS0001'     MSGNR
     C   47              MOVE      'SPT0105'     MSGNR
     C   48              MOVE      'SPK0031'     MSGNR
     C   49              MOVE      'SPK0031'     MSGNR
     C   50              MOVE      'YBC0412'     MSGNR
     C   51              MOVE      'YBC0413'     MSGNR
     C   52              MOVE      'YBC0414'     MSGNR
     C   53              MOVE      'YBC0408'     MSGNR
     C   54              MOVE      'YBC0409'     MSGNR
     C   55              MOVE      'YBC0408'     MSGNR
     C   56              MOVE      'YBC0415'     MSGNR
     C   57              MOVE      'SPK0031'     MSGNR
     C   58              MOVE      'YBC0410'     MSGNR
     C   59              MOVE      'SPK0031'     MSGNR
     C   64              MOVE      'SPF0013'     MSGNR
     C   65              MOVE      'SPK0031'     MSGNR
     C   66              MOVE      'SPK0115'     MSGNR
     C   67              MOVE      'SPK0008'     MSGNR
     C   61              MOVE      'SPK0115'     MSGNR
     C   62              MOVE      'SPK0115'     MSGNR
     C                   GOTO      SLTB2
     C                   END
      *
     C   98              DO
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     33            POSNBR
     C   44              MOVE      'SPL0001'     MSGNR
     C   48              MOVE      'SPL0001'     MSGNR
     C   49              MOVE      'SPK0008'     MSGNR
     C   55              MOVE      'YBC0409'     MSGNR
     C   57              MOVE      'YBC0410'     MSGNR
     C   58              MOVE      'YBC0411'     MSGNR
     C   59              MOVE      'SPO0007'     MSGNR
     C   65              MOVE      'SPF0013'     MSGNR
     C   67              MOVE      'SPF0013'     MSGNR
     C   61              MOVE      'YBC0408'     MSGNR
     C   62              MOVE      'YBC0409'     MSGNR
     C                   GOTO      SLTB2
     C                   END
      *
     C   97              DO
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     33            POSNBR
     C   48              MOVE      'SPL0001'     MSGNR
     C   57              MOVE      'YBC0411'     MSGNR
     C                   GOTO      SLTB2
     C                   END
      *
      * TEST AVDELINGSGRUPPE
      *
     C  N39WSAVDG        IFNE      *BLANKS
     C     WSAVDG        SETLL     AVDGR
     C     WSAVDG        READE     AVDGR                                  96
     C     *IN96         IFEQ      '1'
     C                   MOVE      *ON           *IN30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   MOVE      'TRO0248'     MSGNR
     C                   GOTO      SLTB2
     C                   END
     C                   END
      *
      * SJEKK AT FRA/TIL M.M. ER RIKTIG UTFYLT..
      * VED VISSE VALG (F.EKS BILNR) SETT DIV. TILLEGSINDIKATORE
      *
     C     WSMNDT        IFLT      WSMNDF
     C                   MOVE      'YBC0420'     MSGNR
     C                   MOVE      '1'           *IN95
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLTB2
     C                   END
      *
      * VED BILNR - HVILKET BEGREP..(34/35/36 OFF = FRA/TIL BILNR)
     C   51              SELECT
     C     WSBN          WHENNE    *BLANKS
     C                   MOVEA     '000'         *IN(34)
     C     W2KN          WHENNE    *ZEROS
     C                   MOVEA     '100'         *IN(34)
     C     W2KN          SETLL     UNIT                               33
     C     W2KN          READE     UNIT                                   33
     C  N33              MOVEL     UNBILN        WSBN
     C     W2TRME        WHENNE    *BLANKS
     C                   MOVEA     '010'         *IN(34)
     C     W2TRME        SETLL     UNITL03                            33
     C     W2TRME        READE     UNITL03                                33
     C  N33              MOVEL     UNBILN        WSBN
     C     W2INCR        WHENNE    *BLANKS
     C                   MOVEA     '001'         *IN(34)
     C     TRANK         SETLL     TRAN                               33
     C     STTB2X        TAG
     C                   READ      TRAN                                   33
     C  N33              MOVE      VMINCR        XINCR             1
     C  N33W2INCR        IFEQ      XINCR
     C                   MOVE      VMTRAN        W2KN
     C     W2KN          SETLL     UNIT                               33
     C     W2KN          READE     UNIT                                   33
     C  N33              MOVEL     UNBILN        WSBN
     C   33              MOVE      '0'           *IN33
     C   33              GOTO      STTB2X
     C                   ELSE
     C                   GOTO      STTB2X
     C                   END
     C                   ENDSL
     C   51              DO
     C                   MOVE      *BLANKS       UNBILN
     C                   MOVEL     WSBN          UNBILN
     C     UNBILN        CHAIN     UNITL01                            33
     C                   END
      *
     C     *IN39         IFEQ      '0'
     C     AVD20         COMP      *ZEROS                                 37
     C   37WSAVDG        COMP      *BLANKS                                37
     C   37
     CAN 42              MOVE      WSAVD         WSAVD1
     C   37
     CAN 42              MOVE      '0'           *IN37
     C                   MOVE      *ZEROS        XA                1 0
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
      *
      * SJEKK AT DET FINNES MINST EN POST PÅ VALGT BEGREP
      *
     C                   SETOFF                                       60
     C  N37
     CANN39WSAVDG        SETLL     AVDGR                              33
     C   39              MOVE      *ZEROS        KOAAVD
     C   39KODTAK        SETLL     KODTA                              33
     C  N37
     CANN39
     COR 39              EXSR      HAVD                                         HENT AVD.
     C                   EXSR      LAGKEY
     C                   EXSR      SETKEY
     C                   EXSR      LESPOS
      * 60 - ON = DET FINNES IKKE STATISTIKK FOR INNTASTET DATA....
     C   60              DO
     C                   SETON                                        9930
     C                   MOVE      'SPS0003'     MSGNR
     C                   END
      *
     C     *IN30         IFEQ      '0'
     C     AVD20         COMP      *ZEROS                             7171
     C     WSAVDG        COMP      *BLANKS                            7272
     C                   MOVE      *BLANKS       XINKGR
     C                   Z-ADD     1             XN2               3 0
     C     1             DO        10            XN                3 0
     C     XGR(XN)       IFEQ      'J'
     C     XN            LOOKUP    TABGR3        TABGR4                   33
     C                   MOVE      TABGR4        GR(XN2)
     C                   ADD       2             XN2
     C                   END
     C                   END
     C     XINKGR        COMP      *BLANKS                            7373
     C                   END
      *
     C     SLTB2         ENDSR
      *
     C***********************************************
     C     HAVD          BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSAVD
     C                   MOVE      '0'           *IN33
     C     *IN39         IFEQ      '0'                                          1<-B
     C     AVD20         IFEQ      *ZEROS                                        2<-B
     C     WSAVDG        READE     AVDGR                                  33
     C  N33              MOVE      AAVD          WSAVD
     C                   ELSE                                                    2
     C     XA            ADD       1             XN
     C     XN            DO        5             XA                               3<-B
     C     AVD(XA)       IFNE      0                                               4<-B
     C                   MOVE      AVD(XA)       WSAVD
     C                   GOTO      STHAVD
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C                   READ      KODTA                                  33
     C  N33              MOVE      KOAAVD        WSAVD
     C                   END                                                    1<-E
      *
      * VED STATISTIKK BASERT PÅ BILNR --> FINNE 1. BILNR VED NY AVD.
     C     STHAVD        TAG
     C   51WSAVD         IFNE      0                                            1<-B
     C                   SELECT                                                  2<-B
     C     *IN34         WHENEQ    '1'
     C     W2KN          SETLL     UNIT                               33
     C     W2KN          READE     UNIT                                   33
     C  N33              MOVEL     UNBILN        WSBN
     C     *IN35         WHENEQ    '1'
     C     W2TRME        SETLL     UNITL03                            33
     C     W2TRME        READE     UNITL03                                33
     C  N33              MOVEL     UNBILN        WSBN
     C     *IN36         WHENEQ    '1'
     C     TRANK         SETLL     TRAN                               33
     C     STHAV2        TAG
     C                   READ      TRAN                                   33
     C  N33              MOVE      VMINCR        XINCR
     C  N33W2INCR        IFEQ      XINCR                                          3<-B
     C                   MOVE      VMTRAN        W2KN
     C     W2KN          SETLL     UNIT                               33
     C     W2KN          READE     UNIT                                   33
     C  N33              MOVEL     UNBILN        WSBN
     C   33              MOVE      '0'           *IN33
     C   33              GOTO      STHAV2
     C                   ELSE                                                     3
     C                   GOTO      STHAV2
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     LAGKEY        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       YK1
     C                   MOVE      *BLANKS       YK2
     C   39              MOVEL     WSAVD         YK1
     C   40
     COR 41
     COR 43
     COR 47
     COR 48
     COR 49
     COR 50WSKN          IFEQ      99999999
     C                   MOVE      '00000001'    YK1
     C                   ELSE
     C                   MOVE      WSKN          YK1
     C                   END
     C   40WSRUND        IFEQ      99999999
     C                   MOVE      '00000001'    YK1
     C                   ELSE
     C                   MOVE      WSRUND        YK1
     C                   END
     C   56WSTUR         IFEQ      99999999
     C                   MOVE      '00000001'    YK1
     C                   ELSE
     C                   MOVE      WSTUR         YK1
     C                   END
     C   57
     COR 59
     COR 61
     COR 62
     COR 65
     COR 67
     COR 66WSKN          IFEQ      99999999
     C                   MOVE      '00000001'    YK1
     C                   ELSE
     C                   MOVE      WSKN          YK1
     C                   END
     C   42              MOVEL     WSAVD         YK1
     C   44WSLK          IFEQ      '* '
     C                   MOVEL     ' A'          YK1X4             4
     C                   ELSE
     C                   MOVEL     WSLK          YK1X4
     C                   END
     C   44W2LK          IFEQ      '* '
     C                   MOVE      ' A'          YK1X4             4
     C                   ELSE
     C                   MOVE      W2LK          YK1X4
     C                   END
     C   44              MOVEL     YK1X4         YK1
     C   45WSOT          IFEQ      '* '
     C                   MOVEL     ' A'          YK1
     C                   ELSE
     C                   MOVEL     WSOT          YK1
     C                   END
     C   46WSSG          IFEQ      '*  '
     C                   MOVEL     '  A'         YK1
     C                   ELSE
     C                   MOVEL     WSSG          YK1
     C                   END
     C   48W2LKF         IFEQ      '* '
     C                   MOVEL     ' A'          YK2X4             4
     C                   ELSE
     C                   MOVEL     W2LKF         YK2X4
     C                   END
     C   48W2LKT         IFEQ      '* '
     C                   MOVE      ' A'          YK2X4
     C                   ELSE
     C                   MOVE      W2LKT         YK2X4
     C                   END
     C   48              MOVE      YK2X4         YK2
     C   49W2KN          IFEQ      99999999
     C                   MOVE      '00000001'    YK2
     C                   ELSE
     C                   MOVE      W2KN          YK2
     C                   END
     C   51WSBN          IFEQ      '*       '
     C                   MOVE      '       A'    YK1
     C                   ELSE
     C                   MOVEL     WSBN          YK1
     C                   END
     C   52WSBK          IFEQ      '*  '
     C                   MOVEL     '  A'         YK1
     C                   ELSE
     C                   MOVEL     WSBK          YK1
     C                   END
     C   53
     COR 54
     COR 55WSLK          IFEQ      '* '
     C                   MOVEL     ' A'          YK1
     C                   ELSE
     C                   MOVEL     WSLK          YK1
     C                   END
     C   53
     COR 54
     COR 55WSSD          IFEQ      '*    '
     C                   MOVE      '    A'       YK1
     C                   ELSE
     C                   MOVE      WSSD          YK1
     C                   END
     C   61
     COR 62
     COR 55W2LK          IFEQ      '* '
     C                   MOVEL     ' A'          YK2
     C                   ELSE
     C                   MOVEL     W2LK          YK2
     C                   END
     C   61
     COR 62
     COR 55W2SD          IFEQ      '*    '
     C                   MOVE      '    A'       YK2
     C                   ELSE
     C                   MOVE      W2SD          YK2
     C                   END
     C   57W2RGF         IFEQ      '* '
     C                   MOVEL     ' A'          YK2X4             4
     C                   ELSE
     C                   MOVEL     W2RGF         YK2X4
     C                   END
     C   57W2RGT         IFEQ      '* '
     C                   MOVE      ' A'          YK2X4
     C                   ELSE
     C                   MOVE      W2RGT         YK2X4
     C                   END
     C   57              MOVE      YK2X4         YK2
     C   58WSRG          IFEQ      '* '
     C                   MOVEL     ' A'          YK1X4             4
     C                   ELSE
     C                   MOVEL     WSRG          YK1X4
     C                   END
     C   58W2RG          IFEQ      '* '
     C                   MOVE      ' A'          YK1X4
     C                   ELSE
     C                   MOVE      W2RG          YK1X4
     C                   END
     C   58              MOVEL     YK1X4         YK1
     C   59W2OT          IFEQ      '* '
     C                   MOVE      '       A'    YK2
     C                   ELSE
     C                   MOVE      W2OT          YK2
     C                   END
     C   64WSFR          IFEQ      '*  '
     C                   MOVEL     '  A'         YK1
     C                   ELSE
     C                   MOVEL     WSFR          YK1
     C                   END
     C   65W2FR          IFEQ      '*  '
     C                   MOVE      '       A'    YK2
     C                   ELSE
     C                   MOVE      W2FR          YK2
     C                   END
     C   67W2FR          IFEQ      '*  '
     C                   MOVE      '       A'    YK2
     C                   ELSE
     C                   MOVE      W2FR          YK2
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C  N28
     CANN37STAT1K        SETLL     STATHFL1
     C   28
     CANN37STAT1K        SETLL     STATOHL1
     C  N28
     CAN 37STAT2K        SETLL     STATHFL2
     C   28
     CAN 37STAT2K        SETLL     STATOHL2
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESPOS        BEGSR
     C***********************************************
      *
      * LESER EN!!! POST FRA STATISTIKKFILA ETTER VALGT BEGREP....
      *
     C     STLP          TAG
     C  N28
     CANN37STA21K        READE     STATHFL1                               60
     C   28
     CANN37STA21K        READE     STATOHL1                               60
     C  N28
     CAN 37STA22K        READE     STATHFL2                               60
     C   28
     CAN 37STA22K        READE     STATOHL2                               60
      *
     C  N60
     CAN 43WSKN          IFEQ      99999999
     C     W2KG          ANDNE     '  '
     C                   MOVE      STK1          KUNDNR
N01  C     CUND1K        CHAIN     CUNDL01                            33
S01  C* N43W2KG          COMP      KUNDGR                             4343
S01  C*  43              GOTO      STLP
S01  C*                  MOVE      '1'           *IN43
n01  C     W2KG          IFNE      KUNDGR
N01  C                   GOTO      STLP
N01  C                   END
     C                   END
     C  N60              EXSR      TSTPOS
     C  N60
     CAN 33              GOTO      STLP
      *
     C   60
     CANN37
     COR 60
     CAN 39              DO
      * SLUTT FOR DENNE AVDELINGEN, LES NESTE AVDELING
      * WSAVD = 0 ELLER KALLE PÅ HAVD ---> IKKE FLERE AVDELINGER
     C                   EXSR      HAVD
     C     WSAVD         IFNE      0
     C                   EXSR      LAGKEY
     C                   EXSR      SETKEY
     C                   MOVE      '0'           *IN60
     C                   GOTO      STLP
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TSTPOS        BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN33
      *
     C     YK2           IFNE      STK2                                         1<-B
     C                   SELECT                                                  2<-B
      *
     C     *IN48         WHENEQ    '1'
     C     W2LKT         IFNE      '* '                                           3<-B
     C     W2LKT         ANDNE     STK272
     C     W2LKF         COMP      '* '                               606033
     C                   ELSE                                                     3
     C     W2LKF         IFNE      '* '                                            4<-B
     C     W2LKF         COMP      STK252                             6060
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     *IN49         WHENEQ    '1'
     C     W2KN          COMP      99999999                           6060
      *
     C     *IN55         WHENEQ    '1'
     C     *IN61         OREQ      '1'
     C     *IN62         OREQ      '1'
     C     W2SD          IFNE      '*    '                                        3<-B
     C     W2SD          ANDNE     STK245
     C     W2LK          COMP      '* '                               606033
     C                   ELSE                                                     3
     C     W2LK          IFNE      '* '                                            4<-B
     C     W2LK          COMP      STK212                             6060
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     *IN48         WHENEQ    '1'
     C     W2RGT         IFNE      '* '                                           3<-B
     C     W2RGT         ANDNE     STK272
     C     W2RGF         COMP      '* '                               606033
     C                   ELSE                                                     3
     C     W2RGF         IFNE      '* '                                            4<-B
     C     W2RGF         COMP      STK252                             6060
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     *IN59         WHENEQ    '1'
     C     W2OT          COMP      '* '                               6060
      *
     C     *IN65         WHENEQ    '1'
     C     *IN67         OREQ      '1'
     C     W2FR          COMP      '*  '                              6060
      *
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
      *
     C     STK1          IFNE      YK1                                          1<-B
     C                   SELECT                                                  2<-B
      *
     C     *IN39         WHENEQ    '1'
     C                   MOVE      '1'           *IN60
      *
     C     *IN40         WHENEQ    '1'
     C     *IN41         OREQ      '1'
     C     *IN43         OREQ      '1'
     C     *IN47         OREQ      '1'
     C     *IN48         OREQ      '1'
     C     *IN49         OREQ      '1'
     C     *IN50         OREQ      '1'
     C     *IN56         OREQ      '1'
     C     *IN57         OREQ      '1'
     C     *IN59         OREQ      '1'
     C     *IN61         OREQ      '1'
     C     *IN62         OREQ      '1'
     C     *IN65         OREQ      '1'
     C     *IN66         OREQ      '1'
     C     *IN67         OREQ      '1'
     C     WSKN          COMP      99999999                           6060
     C  N60YK2           COMP      STK2                               3333
      *
     C     *IN42         WHENEQ    '1'
     C                   MOVE      '1'           *IN60
      *
     C     *IN44         WHENEQ    '1'
     C     W2LK          IFNE      '* '                                           3<-B
     C     W2LK          ANDNE     STK132
     C     WSLK          COMP      '* '                               606033
     C                   ELSE                                                     3
     C     WSLK          IFNE      '* '                                            4<-B
     C     WSLK          COMP      STK112                             6060
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     *IN45         WHENEQ    '1'
     C     WSOT          COMP      '* '                               6060
      *
     C     *IN46         WHENEQ    '1'
     C     WSSG          COMP      '*  '                              6060
      *
     C     *IN51         WHENEQ    '1'
     C                   SELECT                                                   3<-B
     C     *IN34         WHENEQ    '1'
     C     W2KN          READE     UNIT                                   60
     C  N60              MOVE      UNBILN        YK1
     C  N60              EXSR      SETKEY
     C     *IN35         WHENEQ    '1'
     C     W2TRME        READE     UNITL03                                60
     C  N60              MOVE      UNBILN        YK1
     C  N60              EXSR      SETKEY
     C     *IN36         WHENEQ    '1'
     C     W2KN          READE     UNIT                                   60
     C     *IN60         IFEQ      '1'                                             4<-B
     C     STTPS1        TAG
     C                   MOVE      '0'           *IN60
     C                   READ      TRAN                                   60
     C  N60              MOVE      VMINCR        XINCR
     C  N60W2INCR        IFEQ      XINCR                                            5<-B
     C                   MOVE      VMTRAN        W2KN
     C     W2KN          SETLL     UNIT
     C     W2KN          READE     UNIT                                   60
     C   60              GOTO      STTPS1
     C                   ELSE                                                       5
     C                   GOTO      STTPS1
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C     *IN60         IFEQ      '0'                                             4<-B
     C                   MOVE      UNBILN        YK1
     C                   EXSR      SETKEY
     C                   MOVE      '1'           *IN33
     C                   END                                                       4<-E
     C                   OTHER
     C     WSBN          COMP      '*       '                         6060
     C                   END                                                      3<-E
      *
     C     *IN52         WHENEQ    '1'
     C     WSBK          COMP      '*  '                              6060
      *
     C     *IN53         WHENEQ    '1'
     C     *IN54         OREQ      '1'
     C     *IN55         OREQ      '1'
     C     WSSD          IFNE      '*    '                                        3<-B
     C     WSSD          ANDNE     STK145
     C     WSLK          COMP      '* '                               606033
     C                   ELSE                                                     3
     C     WSLK          IFNE      '* '                                            4<-B
     C     WSLK          COMP      STK112                             6060
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     *IN58         WHENEQ    '1'
     C     W2RG          IFNE      '* '                                           3<-B
     C     W2RG          ANDNE     STK132
     C     WSRG          COMP      '* '                               606033
     C                   ELSE                                                     3
     C     WSRG          IFNE      '* '                                            4<-B
     C     WSRG          COMP      STK112                             6060
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     *IN64         WHENEQ    '1'
     C     WSFR          COMP      '*  '                              6060
      *
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     FYLLWF        BEGSR
     C***********************************************
     C     *IN60         DOWEQ     '0'
     C                   EXSR      OPDWF
     C                   EXSR      LESPOS
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     FYLWF2        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       SWK1
     C                   MOVE      *BLANKS       SWK2
     C                   MOVE      YDTCÅ2        WSDTCÅ
     C                   MOVE      YAVD2         WSAVD
     C                   EXSR      TESTB2
      *
     C     *IN60         DOWEQ     '0'
     C                   EXSR      OPDWF
     C                   EXSR      LESPOS
     C                   END
      *
     C                   MOVE      YDTCÅ         WSDTCÅ
     C                   MOVEA     '00000'       *IN(96)
     C                   MOVE      '0'           *IN30
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDWF         BEGSR
     C***********************************************
     C                   MOVE      ' '           XUTDB             1
     C     STK1          IFNE      SWK1
     C     STK2          ORNE      SWK2
     C                   MOVE      ' '           XUTDBT            1
     C                   END
     C                   MOVE      *ZEROS        XNT               3 0
     C                   MOVE      *ZEROS        XNTT              3 0
     C                   MOVE      WSDTCÅ        SWDTCÅ
     C                   MOVE      STK1          SWK1
     C                   MOVE      STK2          SWK2
      *
      * OPPDATERE FRAKTBEREGNET VEKT
     C     *IN29         IFEQ      '0'                                          IKKE SJØ-ST.
     C                   Z-ADD     1             SWLN
     C                   MOVE      T(1)          SWTXT
     C                   Z-ADD     FB            BL2
     C                   EXSR      OPDWF2
     C                   END
      * OPPDATERE AKTUELL VEKT
     C                   Z-ADD     2             SWLN
     C                   MOVE      T(2)          SWTXT
     C                   Z-ADD     V             BL2
     C                   EXSR      OPDWF2
      * OPPDATERE ANTALL OPPDRAG I PERIODE
     C                   Z-ADD     3             SWLN
     C                   MOVE      T(3)          SWTXT
     C                   Z-ADD     A             BL2
     C                   EXSR      OPDWF2
      * OPPDATERE ANTALL OPPDRAG I VEKTGRUPPER
     C     *IN29         IFEQ      '0'                                          IKKE SJØ-ST.
     C     WSMNDF        IFEQ      1
     C     WSMNDT        ANDEQ     12
     C                   Z-ADD     4             SWLN
     C                   MOVE      T(4)          SWTXT
     C                   Z-ADD     AV            BL2
     C                   EXSR      OPDWF2
     C                   END
     C                   END
      *
     C     *IN29         IFEQ      '1'                                          SJØ-STAT.
      * OPPDATERE AKT. VEKT LCL I PERIODE
     C                   Z-ADD     5             SWLN
     C                   MOVE      T(11)         SWTXT
     C                   Z-ADD     VS            BL2
     C                   EXSR      OPDWF2
      * OPPDATERE ANTALL OPPDRAG LCL I PERIODE
     C                   Z-ADD     6             SWLN
     C                   MOVE      T(12)         SWTXT
     C                   Z-ADD     SS            BL2
     C                   EXSR      OPDWF2
      * OPPDATERE AKT. M3 LCL I PERIODE
     C                   Z-ADD     7             SWLN
     C                   MOVE      T(13)         SWTXT
     C                   Z-ADD     MS            BL2
     C                   EXSR      OPDWF4
      * OPPDATERE ANTALL TEUS I PERIODE
     C                   Z-ADD     8             SWLN
     C                   MOVE      T(5)          SWTXT
     C                   Z-ADD     AT            BL2
     C                   EXSR      OPDWF2
      * OPPDATERE ANTALL STYKKGODS I PERIODE
     C                   END
      *
      * OPPDATERE INNTEKTER / KOSTNADER
     C     WSINNT        IFEQ      'J'
     C     WSKOST        OREQ      'J'
     C                   EXSR      OPDIK
     C                   END
      * OPPDATERE ANTALL LINJER PÅ ARBERIDSFIL-2
     C     XNT           IFGT      0
     C                   MOVE      STAVD         SWAVD
     C                   MOVE      XNT           SWNT
     C     STWF2K        CHAIN(N)  STATWR2F                           33
     C   33*IN43         IFEQ      '0'
     C     W2KGT         OREQ      'D'
     C     W2KGT         OREQ      'B'
     C                   WRITE     STWR2FR
     C                   END
     C   33
     CAN 43WSKN          IFEQ      99999999
     C     W2KGT         IFEQ      'T'
     C     W2KGT         OREQ      'B'
     C                   EXSR      OPD992
     C                   END
     C                   END
     C                   END
     C     XNTT          IFGT      0
     C                   MOVE      *ZEROS        SWAVD
     C   39
     COR 42              MOVE      *ZEROS        SWK1
     C     *IN43         IFEQ      '0'
     C     W2KGT         OREQ      'D'
     C     W2KGT         OREQ      'B'
     C     STWF2K        CHAIN     STATWR2F                           33
     C   33              MOVE      XNTT          SWNT
     C   33              WRITE     STWR2FR
     C  N33              ADD       XNTT          SWNT
     C  N33              UPDATE    STWR2FR
     C                   END
     C   43WSKN          IFEQ      99999999
     C     W2KGT         IFEQ      'T'
     C     W2KGT         OREQ      'B'
     C                   EXSR      OPD992
     C                   END
     C                   END
     C   39
     COR 42              MOVE      STK1          SWK1
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDWF2        BEGSR
     C***********************************************
      * DETALJER
     C     WSAVDK        IFEQ      'D'
     C     WSAVDK        OREQ      'B'
     C                   MOVE      STAVD         SWAVD
     C                   EXSR      OPDWF3
     C                   END
      *
      * TOTALL
     C     WSAVDK        IFEQ      'T'
     C     WSAVDK        OREQ      'B'
     C   39
     COR 42              MOVE      *ZEROS        SWK1
     C                   MOVE      *ZEROS        SWAVD
     C                   EXSR      OPDWF3
     C   39
     COR 42              MOVE      STK1          SWK1
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDWF3        BEGSR
     C***********************************************
     C     STWRKK        CHAIN     STATWRKF                           33
     C     *IN33         IFEQ      '1'                                          1<-B
     C     SWAVD         IFEQ      0                                             2<-B
     C     XUTDBT        IFEQ      'J'                                            3<-B
     C                   MOVE      'X'           XUTDBT
     C                   ADD       3             XNTT
     C                   ELSE                                                     3
     C                   ADD       1             XNTT
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     XUTDB         IFEQ      'J'                                            3<-B
     C                   MOVE      'X'           XUTDB
     C                   ADD       3             XNT
     C                   ELSE                                                     3
     C                   ADD       1             XNT
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   Z-ADD     BL2           EL
     C     *IN43         IFEQ      '0'
     C     W2KGT         OREQ      'D'
     C     W2KGT         OREQ      'B'
     C                   WRITE     STWRKFR
     C                   END
     C                   ELSE                                                   1
     C                   ADD       BL2           EL
     C     *IN43         IFEQ      '0'
     C     W2KGT         OREQ      'D'
     C     W2KGT         OREQ      'B'
     C                   UPDATE    STWRKFR
     C                   END
     C                   END                                                    1<-E
      *
     C   43WSKN          IFEQ      99999999
     C     W2KGT         IFEQ      'T'
     C     W2KGT         OREQ      'B'
     C                   Z-ADD     BL2           EL
     C                   MOVE      *ZEROS        EL2
     C                   EXSR      OPD999
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDWF4        BEGSR
     C***********************************************
      * DETALJER
     C     WSAVDK        IFEQ      'D'
     C     WSAVDK        OREQ      'B'
     C                   MOVE      STAVD         SWAVD
     C                   EXSR      OPDWF5
     C                   END
      *
      * TOTALL
     C     WSAVDK        IFEQ      'T'
     C     WSAVDK        OREQ      'B'
     C   39
     COR 42              MOVE      *ZEROS        SWK1
     C                   MOVE      *ZEROS        SWAVD
     C                   EXSR      OPDWF5
     C   39
     COR 42              MOVE      STK1          SWK1
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDWF5        BEGSR
     C***********************************************
     C     STWRKK        CHAIN     STATWRKF                           33
     C     *IN33         IFEQ      '1'                                           2<-B
     C     SWAVD         IFEQ      0                                              3<-B
     C     XUTDBT        IFEQ      'J'                                             4<-B
     C                   MOVE      'X'           XUTDBT
     C                   ADD       3             XNTT
     C                   ELSE                                                      4
     C                   ADD       1             XNTT
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     XUTDB         IFEQ      'J'                                             4<-B
     C                   MOVE      'X'           XUTDB
     C                   ADD       3             XNT
     C                   ELSE                                                      4
     C                   ADD       1             XNT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   Z-ADD     MS            EL2
     C     *IN43         IFEQ      '0'
     C     W2KGT         OREQ      'D'
     C     W2KGT         OREQ      'B'
     C                   WRITE     STWRKFR
     C                   END
     C                   ELSE                                                    2
     C                   ADD       MS            EL2
     C     *IN43         IFEQ      '0'
     C     W2KGT         OREQ      'D'
     C     W2KGT         OREQ      'B'
     C                   UPDATE    STWRKFR
     C                   END
     C                   END                                                     2<-E
      *
     C   43WSKN          IFEQ      99999999
     C     W2KGT         IFEQ      'T'
     C     W2KGT         OREQ      'B'
     C                   MOVE      *ZEROS        EL
     C                   Z-ADD     MS            EL2
     C                   EXSR      OPD999
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPD999        BEGSR
     C***********************************************
     C                   MOVE      SWK1          S9K1              8
     C                   MOVE      SWAVD         S9AVD             5 0
     C                   MOVE      '99999999'    SWK1
     C                   MOVE      *ZEROS        SWAVD
     C                   MOVEA     EL            EL9
     C                   MOVEA     EL2           EL92
     C     STWRKK        CHAIN     STATWRKF                           33
     C     *IN33         IFEQ      '1'
     C                   WRITE     STWRKFR
     C                   ELSE
     C                   ADD       EL9           EL
     C                   ADD       EL92          EL2
     C                   UPDATE    STWRKFR
     C                   END
     C                   MOVE      S9K1          SWK1
     C                   MOVE      S9AVD         SWAVD
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPD992        BEGSR
     C***********************************************
     C                   MOVE      SWK1          S9K1              8
     C                   MOVE      SWAVD         S9AVD             5 0
     C                   MOVE      SWNT          S9NT              3 0
     C                   Z-ADD     900           SWNT
     C                   MOVE      '99999999'    SWK1
     C                   MOVE      *ZEROS        SWAVD
     C     STWF2K        CHAIN     STATWR2F                           33
     C     *IN33         IFEQ      '1'
     C                   WRITE     STWR2FR
     C                   ELSE
     C                   UPDATE    STWR2FR
     C                   END
     C                   MOVE      S9K1          SWK1
     C                   MOVE      S9AVD         SWAVD
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDIK         BEGSR
     C***********************************************
     C  N28STATDK        SETLL     STATDFL1
     C   28STATDK        SETLL     STATODL1
      *
     C     STOPIK        TAG
     C                   MOVE      '0'           *IN33
     C  N28STATDK        READE     STATDFL1                               33
     C   28STATDK        READE     STATODL1                               33
     C     *IN33         IFEQ      '0'                                          1<-B
     C     STGR11        IFEQ      'X'                                           2<-B
     C                   GOTO      STOPIK
     C                   END                                                     2<-E
      *
     C     1             DO        13            XN                              2<-B
     C                   MOVE      BL(XN)        BL2(XN)
     C                   END                                                     2<-E
      *
     C     STGR11        LOOKUP    TABGR1        TABGR2                   30
     C                   MOVE      TABGR2        XN
     C*          XGR,XN    CABEQ'N'       STOPIK
     C     XGR(XN)       CABNE     'J'           STOPIK
      *
     C     WSINNT        IFEQ      'J'                                           2<-B
     C     STGR21        ANDEQ     'I'
      * OPPDATERE SUM AV INNTEKTER
     C     XUTDB         IFEQ      ' '
     C                   MOVE      'I'           XUTDB
     C                   END
     C     XUTDBT        IFEQ      ' '
     C                   MOVE      'I'           XUTDBT
     C                   ELSE
     C     XUTDBT        IFEQ      'K'
     C                   MOVE      'J'           XUTDBT
     C                   END
     C                   END
     C                   Z-ADD     9             SWLN
     C                   MOVE      T(7)          SWTXT
     C                   EXSR      OPDWF2
      * OPPDATERE INNTEKTER
     C     WSGRUP        CABEQ     'N'           STOPIK
     C     WSSORT        IFEQ      '1'                                            3<-B
     C     TABGR2        ADD       12            SWLN
     C                   ELSE                                                     3
     C     TABGR2        MULT      2             SWLN
     C                   ADD       11            SWLN
     C                   END                                                      3<-E
     C                   MOVEL     STGR          KFKOD
     C     FASTIK        CHAIN     KUFAST                             30
     C   30              MOVE      *BLANKS       SWTXT
     C  N30              MOVEL     KFTXT         SWTXT
     C                   EXSR      OPDWF2
     C                   END                                                     2<-E
      *
     C     WSKOST        IFEQ      'J'                                           2<-B
     C     STGR21        ANDEQ     'K'
      * OPPDATERE SUM AV KOSTNADER
     C     XUTDB         IFEQ      'I'
     C                   MOVE      'J'           XUTDB
     C                   END
     C     XUTDBT        IFEQ      ' '
     C                   MOVE      'K'           XUTDBT
     C                   ELSE
     C     XUTDBT        IFEQ      'I'
     C                   MOVE      'J'           XUTDBT
     C                   END
     C                   END
     C                   Z-ADD     10            SWLN
     C                   MOVE      T(8)          SWTXT
     C                   EXSR      OPDWF2
      * OPPDATERE KOSTNADER
     C     WSGRUP        CABEQ     'N'           STOPIK
     C     WSSORT        IFEQ      '1'                                            3<-B
     C     TABGR2        ADD       22            SWLN
     C                   ELSE                                                     3
     C     TABGR2        MULT      2             SWLN
     C                   ADD       12            SWLN
     C                   END                                                      3<-E
     C                   MOVEL     STGR          KFKOD
     C     FASTKK        CHAIN     KUFAST                             30
     C   30              MOVE      *BLANKS       SWTXT
     C  N30              MOVEL     KFTXT         SWTXT
     C                   EXSR      OPDWF2
     C                   END                                                     2<-E
      *
     C                   GOTO      STOPIK
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XSIDE
     C                   MOVE      WSDTCÅ        SWDTCÅ
     C                   MOVE      *BLANKS       SWK1
     C                   MOVE      *BLANKS       SWK2
     C                   MOVE      *BLANKS       YK1
     C                   MOVE      *BLANKS       YK2
     C                   MOVE      *ZEROS        SWAVD
     C                   Z-SUB     1             YAVD              5 0
      *
     C     STWRPK        SETLL     STATWRKF                           33
     C     STPRT         TAG
     C     STWRP2        READE     STATWRKF                               33
     C     *IN33         IFEQ      '0'                                          1<-B
      *
     C                   DELETE    STWRKFR
      *
     C     YK1           IFNE      SWK1                                          2<-B
     C     YK2           ORNE      SWK2
     C     YAVD          ORNE      SWAVD
      * SKRIV FJORÅRETS STATISTIKK
     C     YAVD          IFNE      -1                                             3<-B
     C                   EXSR      PRINT3
     C                   END                                                      3<-E
      *
     C                   EXSR      HPTXT
     C     SWAVD         COMP      0                                      90
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD1
     C                   WRITE     LHEAD2
     C                   MOVE      SWK1          YK1
     C                   MOVE      SWK2          YK2
     C                   MOVE      SWAVD         YAVD
     C                   MOVE      *ZEROS        BL2
     C                   END                                                     2<-E
      *
     C                   EXSR      PRINT2
     C                   GOTO      STPRT
      *
     C                   END                                                    1<-E
      * SKRIV FJORÅRETS STATISTIKK
     C                   EXSR      PRINT3
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRINT2        BEGSR
     C***********************************************
     C                   EXSR      SUMPER
     C     EL(13)        CABEQ     0             SLPRT2
      *
     C     SWLN          IFEQ      4                                            1<-B
     C     *IN29         ANDEQ     '0'
     C                   WRITE     LDET2                                        VEKTGRUPPER
     C                   END                                                    1<-E
      *
     C     SWLN          IFEQ      9                                            1<-B
     C                   MOVEA     EL            BL2
     C                   END                                                    1<-E
      *
     C     SWLN          IFEQ      7                                            1<-B
     C                   WRITE     LDET5
     C                   ELSE                                                   1
     C                   WRITE     LDET1
     C                   END                                                    1<-E
      *
     C     SWLN          IFEQ      10                                           1<-B
     C     WSINNT        ANDEQ     'J'
     C     BL2(13)       ANDGT     0
     C                   ADD       BL2           EL
     C                   MOVE      T(9)          SWTXT
     C                   WRITE     LDET1
     C     1             DO        13            XN
     C     BL2(XN)       IFEQ      0
     C                   MOVE      *ZEROS        DB(XN)
     C                   ELSE
     C     EL(XN)        DIV(H)    BL2(XN)       XWORK             9 4
     C     XWORK         MULT      100           DB(XN)
     C                   END
     C                   END
     C                   MOVE      T(10)         SWTXT
     C                   WRITE     LDET3
     C                   END                                                    1<-E
      *
     C     SLPRT2        ENDSR
      *
     C***********************************************
     C     PRINT3        BEGSR
     C***********************************************
     C                   WRITE     LDET4
      *
     C                   MOVE      SWK1          XBK1              8
     C                   MOVE      SWK2          XBK2              8
     C                   MOVE      SWAVD         XBAVD             4 0
     C     STWRFK        CHAIN     STATWR2F                           33
     C     *IN33         IFEQ      '0'                                          1<-B
     C                   ADD       SWNT          XNT               3 0
     C                   DELETE    STWR2FR
     C     WSMNDF        IFEQ      1
     C     WSMNDT        ANDEQ     12
     C                   ADD       2             XNT
     C                   END
     C     XNT           IFGT      30                                            2<-B
     C                   ADD       1             XSIDE
     C                   WRITE     LHEAD1
     C                   END                                                     2<-E
     C                   WRITE     LHEAD2
      * BEVARE ÅRETS STATISTIKK
     C                   MOVE      SWLN          XBLN              3 0
     C                   MOVE      SWTXT         XBTXT            20
     C                   MOVEA     EL            FB
     C                   MOVEA     EL2           MS
      *
     C                   MOVE      *ZEROS        BL2
     C     STWRFK        SETLL     STATWRFF                           33
     C     STPRT3        TAG
     C     STWRFK        READE     STATWRFF                               33
     C     *IN33         IFEQ      '0'                                           2<-B
     C                   DELETE    STWRFFR
     C                   EXSR      PRINT2
     C                   GOTO      STPRT3
     C                   END                                                     2<-E
      * FLYTTE ÅRETS STATISTIKK TILBAKE
     C                   MOVE      YDTCÅ         SWDTCÅ
     C                   MOVE      XBLN          SWLN
     C                   MOVE      XBTXT         SWTXT
     C                   MOVEA     FB            EL
     C                   MOVEA     MS            EL2
     C                   END                                                    1<-E
     C                   MOVE      XBK1          SWK1
     C                   MOVE      XBK2          SWK2
     C                   MOVE      XBAVD         SWAVD
      *
     C                   ENDSR
      *
     C***********************************************
     C     HPTXT         BEGSR
     C***********************************************
      * HENT ANTALL LINJER
     C     STWF2K        CHAIN     STATWR2F                           33
     C                   MOVE      SWNT          XNT
     C                   DELETE    STWR2FR
      *
     C                   MOVE      *BLANKS       XTXT1
     C                   MOVE      *BLANKS       XTXT2
     C                   MOVE      *BLANKS       XTXT3
      *
     C   41
     COR 43
     COR 48
     COR 49
     COR 50
     COR 57
     COR 59              DO
     C                   MOVE      SWK1          KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      SWK1          XXKN
     C                   MOVE      KNAVN         XTXT1
     C   43XXKN          IFEQ      99999999
     C                   MOVE      XKN999        XTXT1
     C                   END
     C                   END
     C   65
     COR 61
     COR 62
     COR 67
     COR 66              DO
     C                   MOVE      SWK1          KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      SWK1          XXKN
     C                   MOVE      KNAVN         XTXT1
     C                   END
      *
     C   44              DO
     C                   MOVE      SWK112        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK112        XXLK
     C                   MOVE      KLKNVN        XTXT1
     C                   MOVE      SWK132        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK132        X2LK
     C                   MOVE      KLKNVN        XTXT2
     C                   END
      *
     C   45              DO
     C                   MOVE      SWK112        KO1KOD
     C     KODOTK        CHAIN     KODTOTY                            33
     C                   MOVE      SWK112        XXOT
     C                   MOVEL     KO1NTX        XTXT1
     C                   END
      *
     C   46              DO
     C                   MOVE      SWK113        KOSFSI
     C     KODSFK        CHAIN     KODTSF                             33
     C                   MOVE      SWK113        XXSG
     C                   MOVEL     KOSFNV        XTXT1
     C                   END
      *
     C   47              DO
     C                   MOVE      SWK1          VMTRAN
     C     TRANK         CHAIN     TRAN                               33
     C                   MOVE      SWK1          XXKN
     C                   MOVE      VMNAVN        XTXT1
     C                   END
      *
     C   48              DO
     C                   MOVE      SWK252        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK252        X2LKF
     C                   MOVE      KLKNVN        XTXT2
     C                   MOVE      SWK272        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK272        X2LKT
     C                   MOVE      KLKNVN        XTXT3
     C                   END
      *
     C   49              DO
     C                   MOVE      SWK2          KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      SWK2          X2KN
     C                   MOVE      KNAVN         XTXT2
     C                   END
      *
     C   51              DO
     C                   MOVEL     SWK1          XXBN
     C                   END
      *
     C   52              DO
     C     SWK113        CHAIN     BILK                               33
     C                   MOVE      SWK113        XXBK
     C                   MOVEL     BKTXT         XTXT1
     C                   END
      *
     C   53
     COR 54
     COR 55              DO
     C                   MOVE      SWK112        ST2LK
     C                   MOVE      SWK145        ST2KOD
     C     STE2DK        CHAIN     STED2D                             33
     C                   MOVE      SWK112        XXLK
     C                   MOVE      SWK145        XXSD
     C                   MOVE      ST2NVN        XTXT1
     C                   END
      *
     C   61
     COR 62
     COR 55              DO
     C                   MOVE      SWK212        ST2LK
     C                   MOVE      SWK245        ST2KOD
     C     STE2DK        CHAIN     STED2D                             33
     C                   MOVE      SWK212        X2LK
     C                   MOVE      SWK245        X2SD
     C                   MOVE      ST2NVN        XTXT2
     C                   END
      *
     C   57              DO
     C                   MOVE      SWK252        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK252        X2RGF
     C                   MOVE      KLKNVN        XTXT2
     C                   MOVE      SWK272        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK272        X2RGT
     C                   MOVE      KLKNVN        XTXT3
     C                   END
      *
     C   58              DO
     C                   MOVE      SWK112        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK112        XXRG
     C                   MOVE      KLKNVN        XTXT1
     C                   MOVE      SWK132        KLKLK
     C     KODLKK        CHAIN     KODTLK                             33
     C                   MOVE      SWK132        X2RG
     C                   MOVE      KLKNVN        XTXT2
     C                   END
      *
     C   59              DO
     C                   MOVE      SWK272        KO1KOD
     C     KODOTK        CHAIN     KODTOTY                            33
     C                   MOVE      SWK272        X2OT
     C                   MOVEL     KO1NTX        XTXT2
     C                   END
      *
     C   64              DO
     C                   MOVE      SWK113        KFRKOD
     C     KODFRK        CHAIN     KODTFR                             33
     C                   MOVE      SWK113        XXFR
     C                   MOVEL     KFRNTX        XTXT1
     C                   END
      *
     C   65
     COR 67              DO
     C                   MOVE      SWK263        KFRKOD
     C     KODFRK        CHAIN     KODTFR                             33
     C                   MOVE      SWK263        X2FR
     C                   MOVEL     KFRNTX        XTXT2
     C                   END
      *
     C* N39                DO
     C                   MOVE      SWAVD         KOAAVD
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      SWAVD         XXAVD
     C                   MOVEL     KOANVN        XTXT4
     C*                    END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SUMPER        BEGSR
      * SUMMERE FRA PERIODE TIL PERIODE
     C***********************************************
     C     WSMNDF        IFNE      1
     C     WSMNDT        ORNE      12
     C     WSMNDF        SUB       1             XMND              3 0
     C     1             DO        XMND          XN
     C                   MOVE      *ZEROS        EL(XN)
     C                   MOVE      *ZEROS        EL2(XN)
     C                   END
     C     WSMNDT        ADD       1             XMND
     C     XMND          DO        13            XN
     C                   MOVE      *ZEROS        EL(XN)
     C                   MOVE      *ZEROS        EL2(XN)
     C                   END
     C     WSMNDF        DO        WSMNDT        XN
     C                   ADD       EL(XN)        EL(13)
     C                   ADD       EL2(XN)       EL2(13)
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C   41
     COR 43
     COR 48
     COR 49
     COR 50
     COR 56
     COR 57LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   MOVE      *BLANKS       USØKNV           30
     C                   CALL      'SOEKKUN'
     C     WSKN          PARM      WSKN          UKN               8 0
     C                   PARM                    FIFIRM
     C                   PARM                    USØKNV
     C                   GOTO      SLSØK
     C                   END
     C   65
     COR 59
     COR 61
     COR 62
     COR 67
     COR 66LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   MOVE      *BLANKS       USØKNV           30
     C                   CALL      'SOEKKUN'
     C     WSKNX         PARM      WSKNX         UKN
     C                   PARM                    FIFIRM
     C                   PARM                    USØKNV
     C                   GOTO      SLSØK
     C                   END
      *
     C   42LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     36
     C                   CALL      'SYFA14B'
     C                   PARM                    WSAVD
     C                   GOTO      SLSØK
     C                   END
      *
     C   44
     COR 53
     COR 54
     COR 55LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLK
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   47LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   CALL      'SYTR04A'
     C     WSKN          PARM      WSKN          UKN               8 0
     C                   GOTO      SLSØK
     C                   END
      *
     C   53
     COR 54
     COR 55LINNBR        IFEQ      5
     C     POSNBR        ANDGE     37
     C     POSNBR        ANDLE     41
     C                   MOVE      *BLANKS       UNVN             30
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSD
     C                   PARM                    UNVN
     C                   PARM                    WSLK
     C                   GOTO      SLSØK
     C                   END
      *
     C   45LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOT
     C                   GOTO      SLSØK
     C                   END
      *
     C   58LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    WSRG
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   64LINNBR        IFEQ      5
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFR
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   44
     COR 61
     COR 62
     COR 55LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    W2LK
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   61
     COR 62
     COR 55LINNBR        IFEQ      6
     C     POSNBR        ANDGE     37
     C     POSNBR        ANDLE     41
     C                   MOVE      *BLANKS       UNVN             30
     C                   CALL      'SYFI10F'
     C                   PARM                    W2SD
     C                   PARM                    UNVN
     C                   PARM                    W2LK
     C                   GOTO      SLSØK
     C                   END
      *
     C   48LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    W2LKF
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   49LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   MOVE      *BLANKS       USØKNV           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    W2KN
     C                   PARM                    FIFIRM
     C                   PARM                    USØKNV
     C                   GOTO      SLSØK
     C                   END
      *
     C   51LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   CALL      'SYTR04A'
     C     W2KN          PARM      W2KN          UKN               8 0
     C                   GOTO      SLSØK
     C                   END
      *
     C   57LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    W2RGF
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   58LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    W2RG
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   59LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10C'
     C                   PARM                    W2OT
     C                   GOTO      SLSØK
     C                   END
      *
     C   65LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   CALL      'SYFI10G'
     C                   PARM                    W2FR
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   67LINNBR        IFEQ      6
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   CALL      'SYFI10G'
     C                   PARM                    W2FR
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   48LINNBR        IFEQ      7
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    W2LKT
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C   57LINNBR        IFEQ      7
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    W2RGT
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C  N42
     CANN39LINNBR        IFEQ      9
     C     POSNBR        IFGE      33
     C     POSNBR        ANDLE     36
     C                   CALL      'SYFA14B'
     C     WSAVD1        PARM      WSAVD1        UAVDSK            4 0
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      39
     C     POSNBR        ANDLE     42
     C                   CALL      'SYFA14B'
     C     WSAVD2        PARM      WSAVD2        UAVDSK
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      45
     C     POSNBR        ANDLE     48
     C                   CALL      'SYFA14B'
     C     WSAVD3        PARM      WSAVD3        UAVDSK
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      51
     C     POSNBR        ANDLE     54
     C                   CALL      'SYFA14B'
     C     WSAVD4        PARM      WSAVD4        UAVDSK
     C                   Z-ADD     57            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     POSNBR        IFGE      57
     C     POSNBR        ANDLE     60
     C                   CALL      'SYFA14B'
     C     WSAVD5        PARM      WSAVD5        UAVDSK
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     64            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C                   END
      *
     C  N39LINNBR        IFEQ      10
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     39
     C                   CALL      'SYFA59A'
     C                   PARM                    WSAVDG
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     TØMWF         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        YDTCÅ
     C     YDTC          SETLL     STATWRKF                           33
     C     STTØM1        TAG
     C                   READ      STATWRKF                               33
     C     *IN33         IFEQ      '0'
     C                   DELETE    STWRKFR
     C                   GOTO      STTØM1
     C                   END
     C     YDTC          SETLL     STATWR2F                           33
     C     STTØM2        TAG
     C                   READ      STATWR2F                               33
     C     *IN33         IFEQ      '0'
     C                   DELETE    STWR2FR
     C                   GOTO      STTØM2
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     TRANK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    VMTRAN
     C     STE2DK        KLIST
     C                   KFLD                    ST2LK
     C                   KFLD                    ST2KOD
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    KOAAVD
     C                   MOVE      'A'           KOAUNI
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C                   MOVE      'V'           KOVUNI
     C     KODFRK        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    KFRKOD
     C                   MOVE      'FR'          KFRUNI
     C     KODOTK        KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    KO1KOD
     C                   MOVE      'OTY'         KO1UNI
     C     KODLKK        KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    KLKLK
     C                   MOVEL     'LK'          KLKUNI
     C     KODSFK        KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    KOSFSI
     C                   MOVE      'SF'          KOSFUN
     C     STAT1K        KLIST
     C                   KFLD                    YRI               1
     C                   KFLD                    WSDTC
     C                   KFLD                    WSDTÅ
     C                   KFLD                    WSAVD
     C                   KFLD                    YK1
     C                   KFLD                    YK2
     C     STA21K        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    WSDTC
     C                   KFLD                    WSDTÅ
     C                   KFLD                    WSAVD
     C     STAT2K        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    WSDTC
     C                   KFLD                    WSDTÅ
     C                   KFLD                    YK1
     C                   KFLD                    YK2
     C     STA22K        KLIST
     C                   KFLD                    YRI
     C                   KFLD                    WSDTC
     C                   KFLD                    WSDTÅ
     C     STATDK        KLIST
     C                   KFLD                    STSTNR
     C     STWRKK        KLIST
     C                   KFLD                    SWDTC
     C                   KFLD                    SWDTÅ
     C                   KFLD                    SWK1
     C                   KFLD                    SWK2
     C                   KFLD                    SWAVD
     C                   KFLD                    SWLN
     C     STWF2K        KLIST
     C                   KFLD                    SWDTC
     C                   KFLD                    SWDTÅ
     C                   KFLD                    SWK1
     C                   KFLD                    SWK2
     C                   KFLD                    SWAVD
     C     STWRPK        KLIST
     C                   KFLD                    SWDTC
     C                   KFLD                    SWDTÅ
     C                   KFLD                    SWK1
     C                   KFLD                    SWK2
     C                   KFLD                    SWAVD
     C     STWRP2        KLIST
     C                   KFLD                    SWDTC
     C                   KFLD                    SWDTÅ
     C     STWRFK        KLIST
     C                   KFLD                    YDTC2
     C                   KFLD                    YDTÅ2
     C                   KFLD                    YK1
     C                   KFLD                    YK2
     C                   KFLD                    YAVD
     C     FASTIK        KLIST
     C                   KFLD                    KFTYPI           10
     C                   KFLD                    KFKOD
     C                   MOVEL     'GRITYPE'     KFTYPI
     C     FASTKK        KLIST
     C                   KFLD                    KFTYPK           10
     C                   KFLD                    KFKOD
     C                   MOVEL     'GRKTYPE'     KFTYPK
     C                   MOVE      'N'           UUPDAT            1
      *
     C     *ENTRY        PLIST
     C                   PARM                    USJØ              1
     C     LASER         PARM      LASER         LASER             1
     C     STRING        PARM      STRING        STRING            5
     C     COPYA         PARM      COPYA         COPYA             2
     C                   MOVE      COPYA         COPY              2 0
     C     STRING        IFNE      *BLANKS
     C     STRING        CHAIN     KODTFM                             33
     C                   END
     C     LASER         IFEQ      'A'
     C                   SETON                                        88
     C                   END
     C     USJØ          COMP      'J'                                    29
      *
     C                   MOVE      *BLANKS       YK1               8
     C                   MOVE      *BLANKS       YK2               8
     C                   MOVE      'J'           USPED             1
      *
     C                   MOVE      *ZEROS        AVD20
     C                   MOVE      *ZEROS        WSKN
     C                   MOVE      *ZEROS        XXKN
     C                   MOVE      *ZEROS        EL
     C                   MOVE      *ZEROS        EL2
     C                   MOVE      'D'           WSAVDK
     C                   MOVE      UYEAR         WSDTÅ
     C     UYEAR         IFGT      50
     C                   MOVE      '19'          WSDTC
     C                   ELSE
     C                   MOVE      '20'          WSDTC
     C                   END
     C                   MOVE      '01'          WSMNDF
     C                   MOVE      '12'          WSMNDT
     C                   MOVE      'J'           WSINNT
     C                   MOVE      'J'           WSKOST
     C                   MOVE      'J'           WSGRUP
     C                   MOVEA     'JJJJJJJJ'    XGR(1)
     C                   MOVEA     'JJ'          XGR(9)
     C                   MOVE      '1'           WSSORT
      *
     C                   READ      FIRM                                   27
     C                   MOVE      *ZEROS        KOVAVD
     C     KODTVK        CHAIN     KODTV                              27
     C     KOVPRO        COMP      'B'                                2727
     C   27              MOVE      KOVPRO        WSPRO
      *
     C                   EXSR      HTXT
      *
     C                   ENDSR
      *
     C***********************************************
     C     HTXT          BEGSR
     C***********************************************
     C                   MOVE      'YBC0439'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     20            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(1)
      *
     C                   MOVE      'YBC0440'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(2)
      *
     C                   MOVE      'YBC0441'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(3)
      *
     C                   MOVE      'YBC0442'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(4)
      *
     C                   MOVE      'YBC0463'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(5)
      *
     C                   MOVE      'YBC0464'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(6)
      *
     C                   MOVE      'YBC0443'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(7)
      *
     C                   MOVE      'YBC0444'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(8)
      *
     C                   MOVE      'YBC0445'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(9)
      *
     C                   MOVE      'YBC0446'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(10)
      *
     C                   MOVE      'YBC0710'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(11)
      *
     C                   MOVE      'YBC0709'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(12)
      *
     C                   MOVE      'YBC0711'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          T(13)
      *
     C                   Z-ADD     30            XMSGL             4 0          LENGDE PÅ MELDING
     C                   MOVE      'YBC0871'     XMSGNR
     C                   Z-ADD     0             XRETUR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          XKN999           30
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             80
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
      *
     C                   ENDSR
      *
**
A001
B002
C003
D004
E005
F006
G007
H008
I009
J010
**
001A
002B
003C
004D
005E
006F
007G
008H
009I
010J
