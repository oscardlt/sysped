      * ESCAPE XML special characters
      *  "  --> &quot;
      *  <  --> &lt;
      *  >  --> &gt;
      *  &  --> &amp;
      *
      *  For example, the text:
      *    "Me, Myself & <I>"
      *  should be encoded in XML as:
      *    &quot;Me, myself &amp; &lt;I&gt;&quot;
      *
      *
      * Prototype
     D XMLesc          PR                  ExtPgm('XMLESCAPE')
     D   XMLStr                   32000A
      * Program Interface
     D XMLesc          PI
     D   XMLStr                   32000A
      *
     c* test             move      *blanks       XMLStr        32000
     c* test             eval      XMLStr = '"Me, Myself & <I>"'
      *
      *  &  --> &amp;  (må ta & først, siden den skaper nye &..)
     c                   z-add     1             pos               5 0
     c                   dow       pos <> 0
     c                   EVAL      pos  = %scan ('&' : XMLStr : pos)
     c                   if        pos <> 0
     c                   eval      XMLStr = %replace ('&amp;': XMLStr: Pos :1)
     c                   eval      pos=pos+5
     c                   endif
     c                   enddo
      *  "  --> &quot;
     c                   z-add     1             pos               5 0
     c                   dow       pos <> 0
     c                   EVAL      pos  = %scan ('"' : XMLStr : pos)
     c                   if        pos <> 0
     c                   eval      XMLStr = %replace ('&quot;': XMLStr: Pos :1)
     c                   eval      pos=pos+6
     c                   endif
     c                   enddo
      *  <  --> &lt;
     c                   z-add     1             pos               5 0
     c                   dow       pos <> 0
     c                   EVAL      pos  = %scan ('<' : XMLStr : pos)
     c                   if        pos <> 0
     c                   eval      XMLStr = %replace ('&lt;': XMLStr: Pos :1)
     c                   eval      pos=pos+4
     c                   endif
     c                   enddo
      *  >  --> &gt;
     c                   z-add     1             pos               5 0
     c                   dow       pos <> 0
     c                   EVAL      pos  = %scan ('>' : XMLStr : pos)
     c                   if        pos <> 0
     c                   eval      XMLStr = %replace ('&gt;': XMLStr: Pos :1)
     c                   eval      pos=pos+4
     c                   endif
     c                   enddo
      *
     C                   RETURN
