10XXX * 01 CB  PTF10 Extra mængenhet 999 999 999 = 0
P11042* 02 CB  PTF11  erstatt kode B00 med 1MT fra og med 20150101
P11046* 03 CB  PTF11  Deklarantes namn blev fel ibland
P11XXX* 04 CB  PTF11  Ombudstyp nu variabel
P11094* 05 CB  PTF11  Nya berækningsenheter
P11130* 06 CB  PTF11  Møjlighet till fler varuposter
N06  H Option( *SrcStmt ) DftActGrp( *No ) BndDir( 'QC2LE' )
     FSVIH      IF   E           K DISK
     FSVIV1     UF   E           K DISK
     FSVIVA     UF   E           K DISK
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1  30000
     D                                     DIM(30000)                           Input string
     D  ADS                    1  30000
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1  30000
     D                                     DIM(30000)                           Output string
     D  BDS                    1  30000
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN154                  1     15  4
     D  ØA154H                 1     11
     D  ØA154D                12     15
     D                 DS
     D  ØA16                   1     16
     D  Ø16                    1     16
     D                                     DIM(16)                              Num edit
      *____________
      * DS for EORI
      *""""""""""""
     D                 DS
     D  WEORI                  1     17
     D  WEORIA                 1      2
     D  WEORIB                 3     17
N06   *__________
N06   * Variabler
N06   *""""""""""
N06  D FILE_o          s               *
N06  D String          s            512a
N06  D rc              s             10i 0
N06  D Data            s          30000a   Varying
N06  D Codepage        s              5a   Varying
N06   *___________________________
N06   * IFS Stream file funksjoner
N06   *"""""""""""""""""""""""""""
N06  Dopen             Pr              *   ExtProc( '_C_IFS_fopen' )
N06  D                                 *   Value Options( *String )
N06  D                                 *   Value Options( *String )
N06
N06  Dfputs            Pr            10i 0 ExtProc( '_C_IFS_fputs' )
N06  D                                 *   Value Options( *String )
N06  D                                 *   Value
N06
N06  Dclose            Pr            10i 0 ExtProc( '_C_IFS_fclose' )
N06  D                                 *   Value
N06  D RunCmd          PR                  EXTPGM('QCMDEXC')
N06  D  Cmd                         200A   CONST
N06  D  Len                          15P 5 CONST
N06   *   SYEDI data area
N06  D EDIDTA          DS           256
N06  D  UELIBF               171    180
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SVIH_SYAV     UVIH_SYAV
     C     *LIKE         DEFINE    SVIH_SYOP     UVIH_SYOP
     C     *LIKE         DEFINE    SVIV_VANO     UVIV_VANO

     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             7 0
     C                   Z-ADD     80            LEN               5 0
     C                   MOVEL     'EUNOAO  '    TABLE            10
     C                   MOVEL     '*LIBL   '    LIB              10
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
     C     KEYB          KLIST
     C                   KFLD                    SVIV_SYAV
     C                   KFLD                    SVIV_SYOP
     C                   KFLD                    SVIV_SYLI
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                5 0          Index for B
     C                   Z-ADD     0             AXV               5 0          Leftindx A
     C                   Z-ADD     0             AXH               5 0          Rightindx A
     C                   MOVE      'R'           WDIR              1            Search direction
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVIH_SYAV
     C                   PARM                    UVIH_SYOP
S06  C*                  PARM      BDS           UDATA         30000
N06   * Åpne dataarea
N06  C     *DTAARA       DEFINE                  EDIDTA
N06  C                   IN        EDIDTA
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     SVIH
N06   *______________
N06   * Øppna IFS-fil
N06   *""""""""""""""
N06  C                   MOVE      SVIH_SYAV     WAVD              4
N06  C                   MOVE      SVIH_SYOP     WOPD              7
N06  C                   MOVE      *BLANKS       WFILNAM         256
N06  C                   EVAL      WFILNAM = '/' + %trimr(UELIBF)
N06  C                             + '/EDISE/TEMP/SVIU' + WAVD + '-' + WOPD
N06
N06  C                   EVAL      Codepage = '819'
N06  C                   EVAL      FILE_o = open( %TrimR( WfilNam )
N06  C                             : 'w, codepage=' + Codepage )
N06
N06  C                   EVAL      rc = close( FILE_o )
N06
N06  C                   EVAL      FILE_o = open( %TrimR( WfilNam )
N06  C                             : 'w' )
N06
      *_____________
      * Huvudsektion
      *"""""""""""""
      * Meddelandeingress
     C                   EXSR      UNH00
      * Meddelandebørjan
     C                   EXSR      BGM00
      * Plats lokaliseringsidentifikation
     C                   EXSR      LOC00
      * Generell indikator
     C     SVIH_MTYP     IFNE      'DBK'
     C     SVIH_MTYP     ANDNE     'HBK'
     C                   EXSR      GIS00
     C                   ENDIF
      * Referenser
     C                   EXSR      RFF01
      * Transportdetaljer
     C                   EXSR      TDT04
      * Namm och adress, Behørig att begæra klarering
     C     SVIH_MTYP     IFNE      'DBK'
     C     SVIH_MTYP     ANDNE     'HBK'
     C                   EXSR      NAD06B
      * Namm och adress, Avsændare
     C                   EXSR      NAD06C
      * Namm och adress, Mottagare (importør)
     C                   EXSR      NAD06D
      * Namm och adress, Deklarant
     C                   EXSR      NAD06F
      * Namm och adress, Ombud
     C                   EXSR      NAD06A
      * Leveransvillkår
     C                   EXSR      TOD07
      * Belopp
     C                   EXSR      MOA08
     C                   ENDIF
      * Seksjonskille
     C                   EXSR      UNSD
      *______________
      * Detaljsektion
      *""""""""""""""
      * Skrive ut meldingsvarelinjer til EDIFACT-fil
     C     SVIH_MTYP     IFNE      'DBK'
     C     SVIH_MTYP     ANDNE     'HBK'
     C                   EXSR      CST30
     C                   ENDIF
      * Seksjonskille
     C                   EXSR      UNSS
      *_____________
      * Summasektion
      *"""""""""""""
      * Meddelandeslut
     C                   EXSR      CNT00
      * Meddelandeslut
     C                   EXSR      UNT00
N06   *______________
N06   * Stæng IFS-fil
N06   *""""""""""""""
N06  C                   EVAL      rc = close( FILE_o )
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_________________
      * Trim left blanks
      *"""""""""""""""""
     C                   MOVEL(P)  ADS           ADS2          30000
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS=%TRIML(ADS2)
      *_______________
      * Find positions
      *""""""""""""""""
     C                   EVAL      AXV=1
     C     ' '           CHECKR    ADS           AXH
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WDIR          ANDEQ     'R'
     C     WCHAR         IFEQ      ';'                                                      III
     C                   MOVE      ':'           WCHAR
     C                   ENDIF                                                    <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   ENDIF                                                   <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I

     C                   ENDDO                                                  <-------------I
N06   * Skriv till IFS-fil
N06  C                   EVAL      Data = %trimr(BDS)
N06  C                   EVAL      rc = fputs(Data : File_o)
N06  C                   EVAL      BX=1
N06  C                   EVAL      BDS=*BLANKS

     C                   MOVE      'Y'           WCHART
     C                   EVAL      ADS=*BLANKS
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA16
     C     ØA154D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA154H        ØA16                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA154H        ØA16                                         I
     C                   MOVE      '.    '       ØA16                                         I
     C                   MOVE      ØA154D        ØA16                                         I
     C     Ø16(16)       IFEQ      '0'
     C                   MOVE      ' '           Ø16(16)
     C     Ø16(15)       IFEQ      '0'
     C                   MOVE      ' '           Ø16(15)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        15            ØX                             <-------------I
     C     Ø16(ØX)       IFNE      '0'                                           <-----------II
     C     Ø16(ØX)       IFEQ      '.'                                           <-----------II
     C                   SUB       1             ØX
     C                   ENDIF                                                   <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø16(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandeingress                                  UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVEL     'UNH+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVEL     SVIH_SYAV     W0062            11
     C                   MOVE      SVIH_SYOP     W0062
     C                   MOVEL     W0062         ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVEL     'CUSDEC'      ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEA     ':D:96B:U'    A(1)
     C                   MOVEA     'N:145050'    A(9)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL(P)  WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandebørjan                                   BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='BGM+'+SVIH_MTYP+':::'+SVIH_DEK1+'++'
     C                             + SVIH_DEK2+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontroll totaler                                   CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
      * Antall kolli
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_KOTA
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+11:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kommunikationskontakter, Ombud                    COM06A /
      *////////////////////////////////////////////////////////////
     C     COM06A        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'COM+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationsnummer
     C                   MOVEL     SVIH_OMTL     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskanal kvalificerare
     C                   MOVEL     'TE'          ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kommunikationskontakter, Deklarant                COM06F /
      *////////////////////////////////////////////////////////////
     C     COM06F        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'COM+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationsnummer
     C                   MOVEL     SVIH_DKTL     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskanal kvalificerare
     C                   MOVEL     'TE'          ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Handlæggare, Deklarant                            CTA06A /
      *////////////////////////////////////////////////////////////
     C     CTA06A        BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='CTA+AH+:'+%trimr(SVIH_OMHA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Handlæggare, Ombud                                CTA06F /
      *////////////////////////////////////////////////////////////
     C     CTA06F        BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='CTA+AH+:'+%trimr(SVIH_DKHA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varupostnivå                                       CST30 /
      *////////////////////////////////////////////////////////////
     C     CST30         BEGSR

     C                   EVAL      *IN20=*OFF
     C                   EVAL      UVIV_VANO=0
     C     KEYA          SETLL     SVIV1
     C     KEYA          READE     SVIV1                                  20
     C     *IN20         DOWEQ     *OFF
     C                   ADD       1             UVIV_VANO
     C                   EVAL      SVIV_VANO=UVIV_VANO
     C                   UPDATE    SVIVR

     C                   IF        SVIV_VATA = *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='CST+'+'0'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ELSE
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_VANO
     C                   EXSR      SRNE
     C                   EVAL      ADS='CST+'+%trimr(ØAN)+'+'+SVIV_VATA+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Andra segment under CST
     C                   EXSR      FTX30
     C                   EXSR      LOC30
     C                   EXSR      MEA30
     C                   EXSR      PAC31
     C                   EXSR      MOA33
     C                   EXSR      RFF35
     C                   EXSR      DOC37A
     C                   EXSR      DOC37B
     C                   EXSR      GIS40
     C                   EXSR      TAX41

      * Læs næsta varulinje
     C     KEYA          READE     SVIV1                                  20
     C  N20              ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fakturanummer                                     DOC37A /
      *////////////////////////////////////////////////////////////
     C     DOC37A        BEGSR

     C     *LIKE         DEFINE    SVIV_BIT1     ZVIV_BITX
     C     *LIKE         DEFINE    SVIV_BII1     ZVIV_BIIX

     C                   EVAL      ZVIV_BITX=SVIV_BIT1
     C                   EVAL      ZVIV_BIIX=SVIV_BII1
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT2
     C                   EVAL      ZVIV_BIIX=SVIV_BII2
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT3
     C                   EVAL      ZVIV_BIIX=SVIV_BII3
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT4
     C                   EVAL      ZVIV_BIIX=SVIV_BII4
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT5
     C                   EVAL      ZVIV_BIIX=SVIV_BII5
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT6
     C                   EVAL      ZVIV_BIIX=SVIV_BII6
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT7
     C                   EVAL      ZVIV_BIIX=SVIV_BII7
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT8
     C                   EVAL      ZVIV_BIIX=SVIV_BII8
     C                   EXSR      DOC37AA

     C                   EVAL      ZVIV_BITX=SVIV_BIT9
     C                   EVAL      ZVIV_BIIX=SVIV_BII9
     C                   EXSR      DOC37AA

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bilagda handlingar                               DOC37AA /
      *////////////////////////////////////////////////////////////
     C     DOC37AA       BEGSR

     C     ZVIV_BITX     IFNE      *BLANKS
     C     ZVIV_BIIX     ORNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'DOC+ZBH:::'  ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     ZVIV_BITX     IFNE      *BLANKS
     C                   MOVEL     ZVIV_BITX     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     ZVIV_BIIX     IFNE      *BLANKS
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     ZVIV_BIIX     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tidigare handlingar (tullid)                      DOC37B /
      *////////////////////////////////////////////////////////////
     C     DOC37B        BEGSR
     C     SVIV_TIX1     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK1)+'::'
     C                             + %trimr(SVIV_TIT1)+'+'
     C                             + %trimr(SVIV_TIX1)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX2     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK2)+'::'
     C                             + %trimr(SVIV_TIT2)+'+'
     C                             + %trimr(SVIV_TIX2)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK3)+'::'
     C                             + %trimr(SVIV_TIT3)+'+'
     C                             + %trimr(SVIV_TIX3)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX4     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK4)+'::'
     C                             + %trimr(SVIV_TIT4)+'+'
     C                             + %trimr(SVIV_TIX4)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX5     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK5)+'::'
     C                             + %trimr(SVIV_TIT5)+'+'
     C                             + %trimr(SVIV_TIX5)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX6     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK6)+'::'
     C                             + %trimr(SVIV_TIT6)+'+'
     C                             + %trimr(SVIV_TIX6)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX7     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK7)+'::'
     C                             + %trimr(SVIV_TIT7)+'+'
     C                             + %trimr(SVIV_TIX7)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX8     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK8)+'::'
     C                             + %trimr(SVIV_TIT8)+'+'
     C                             + %trimr(SVIV_TIX8)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_TIX9     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+190:'+%trimr(SVIV_TIK9)+'::'
     C                             + %trimr(SVIV_TIT9)+'+'
     C                             + %trimr(SVIV_TIX9)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varuslag                                           FTX30 /
      *////////////////////////////////////////////////////////////
     C     FTX30         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varuslag
     C                   MOVEL     SVIV_VASL     ADS
     C                   EXSR      SRÅ
     C     SVIV_VAS2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_VAS2     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_VAS3     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_VAS3     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_VAS4     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_VAS4     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

      *_________________________
      * Særskilda upplysningar-1
      *"""""""""""""""""""""""""
     C     SVIV_SUKO     IFNE      *BLANKS
     C     SVIV_SUTX     ORNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+SU++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Særskilda upplysningar, kod
     C     SVIV_SUKO     IFNE      *BLANKS
     C                   MOVEL     SVIV_SUKO     ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Referensnummer
     C     SVIV_SUTX     IFNE      *BLANKS
     C                   MOVEL     SVIV_SUTX     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT2     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT3     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT3     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT4     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT4     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT5     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT5     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
      *_________________________
      * Særskilda upplysningar-2
      *"""""""""""""""""""""""""
     C     SVIV_SUK6     IFNE      *BLANKS
     C     SVIV_SUT6     ORNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+SU++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Særskilda upplysningar, kod
     C     SVIV_SUK6     IFNE      *BLANKS
     C                   MOVEL     SVIV_SUK6     ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Referensnummer
     C     SVIV_SUT6     IFNE      *BLANKS
     C                   MOVEL     SVIV_SUT6     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT7     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT7     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT8     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT8     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUT9     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUT9     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUTA     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUTA     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
      *_________________________
      * Særskilda upplysningar-3
      *"""""""""""""""""""""""""
     C     SVIV_SUKB     IFNE      *BLANKS
     C     SVIV_SUTB     ORNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+SU++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Særskilda upplysningar, kod
     C     SVIV_SUKB     IFNE      *BLANKS
     C                   MOVEL     SVIV_SUKB     ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Referensnummer
     C     SVIV_SUTB     IFNE      *BLANKS
     C                   MOVEL     SVIV_SUTB     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUTC     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUTC     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUTD     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUTD     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUTE     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUTE     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_SUTF     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     SVIV_SUTF     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Godsbeskrivning                                    GDS31 /
      *////////////////////////////////////////////////////////////
     C     GDS31         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'GDS+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Artikkelnummers kvalificerare
     C                   MOVEL     '5'           ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS00 /
      *////////////////////////////////////////////////////////////
     C     GIS00         BEGSR
      *__________
      * Container
      *""""""""""
     C     SVIH_MTYP     IFNE      'TNU'
     C     SVIH_CONT     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+%trimr(SVIH_CONT)+':109'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ELSE
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+'0'+':109'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________________________________
      * Avdragsrætt enligt merværdesskattelagen ?
      *""""""""""""""""""""""""""""""""""""""""""
     C     SVIH_MTYP     IFEQ      'OMP'
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+J:AML'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________
      * Importærendekod
      *""""""""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+SVIH_TART+':71'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________________
      * Kvalitetssækrad ?
      *""""""""""""""""""
     C     SVIH_KVAL     IFEQ      'J'
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+J:ZKS'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS40 /
      *////////////////////////////////////////////////////////////
     C     GIS40         BEGSR
      *___________
      * Førmånskod
      *"""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+SVIV_FOKD+':116'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________________
      * Åtgærdsindikator
      *"""""""""""""""""
     C     SVIV_CALL     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+'+SVIV_CALL+':Z11'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *________________
      * Førfarande 37:1
      *""""""""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+1:ZF::'+SVIV_EUP1+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________
      * Førfarande 37:2
      *""""""""""""""""
     C     SVIV_EUP2     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+2:ZF::'+SVIV_EUP2+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *___________
      * Tillægskod
      *""""""""""""
     C     SVIV_VATI     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+3:ZA::'+SVIV_VATI+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_VAT4     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+4:ZA::'+SVIV_VAT4+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_VAT5     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+5:ZA::'+SVIV_VAT5+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plats/lokaliseringsidentifikation                  LOC00 /
      *////////////////////////////////////////////////////////////
     C     LOC00         BEGSR
      *_____________
      * Godslokalkod
      *"""""""""""""
     C     SVIH_MTYP     IFNE      'TNU'
     C     SVIH_GOLK     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '18'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIH_GOLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
      *________________
      * Avsændningsland
      *""""""""""""""""
     C     SVIH_MTYP     IFNE      'HBK'
     C     SVIH_AVUT     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '35'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIH_AVUT     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plats/lokaliseringsidentifikation                  LOC30 /
      *////////////////////////////////////////////////////////////
     C     LOC30         BEGSR
      *______________
      * Ursprungsland
      *""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '27'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIV_ULKD     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Id av lager
      *""""""""""""
     C     SVIV_LAGI     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     'ZIL'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     SVIV_LAGI     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Typ av lager
     C                   MOVEL     SVIV_LAGT     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '::'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C                   MOVEL     SVIV_LAGL     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Ombud                            NAD06A /
      *////////////////////////////////////////////////////////////
     C     NAD06A        BEGSR
     C     SVIH_OMEO     IFNE      *BLANKS
     C                   EVAL      WEORI=SVIH_OMEO
N04  C     SVIH_OMTY     IFEQ      *BLANKS
N04  C                   EVAL      SVIH_OMTY='2'
N04  C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+AE+'+%trimr(WEORIB)
     C                             + ':'+%trimr(WEORIA)
N04  C                             + '+' +%trimr(SVIH_OMTY)+WAPSTR
S04  C*                            + '+2'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskontakter
     C                   EXSR      CTA06A
     C                   EXSR      COM06A
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Behørig att begæra klarering     NAD06B /
      *////////////////////////////////////////////////////////////
     C     NAD06B        BEGSR
     C                   EVAL      WEORI=SVIH_KLEO
     C     SVIH_KLEO     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+BK+'+%trimr(WEORIB)
     C                             + ':'+%trimr(WEORIA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Avsændare                        NAD06C /
      *////////////////////////////////////////////////////////////
     C     NAD06C        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CZ+++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Navn
     C                   MOVEL     SVIH_AVNA     ADS
     C                   EXSR      SRÅ
      * Adress-1
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     SVIH_AVA1     IFEQ      *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     SVIH_AVA1     ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * Adress-2
     C     SVIH_AVA2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     SVIH_AVA2     ADS
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postadress
     C                   MOVEL     SVIH_AVPA     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postnummer
     C                   MOVEL     SVIH_AVPN     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C                   MOVEL     SVIH_AVLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Mottagare (importør)             NAD06D /
      *////////////////////////////////////////////////////////////
     C     NAD06D        BEGSR

     C                   ADD       1             W0074

     C                   MOVEL     'NAD+CN+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   EVAL      WEORI=SVIH_MOEO
     C                   EVAL      ADS=%trimr(WEORIB)
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   EVAL      ADS=%trimr(WEORIA)
     C                   EXSR      SRÅ

     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   EVAL      ADS=%trimr(SVIH_MONA)
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   EVAL      ADS=%trimr(SVIH_MOA1)
     C                   EXSR      SRÅ

     C     SVIH_MOA2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ADS=%trimr(SVIH_MOA2)
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   EVAL      ADS=%trimr(SVIH_MOPA)
     C                   EXSR      SRÅ

     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   EVAL      ADS=%trimr(SVIH_MOPN)
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     SVIH_MOLK     IFEQ      *BLANKS
     C                   MOVEL     'SE'          ADS
     C                   ELSE
     C                   MOVEL     SVIH_MOLK     ADS
     C                   ENDIF
     C                   EXSR      SRÅ

     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Namn och adress, Deklarant                        NAD06F /
      *////////////////////////////////////////////////////////////
     C     NAD06F        BEGSR
     C                   EVAL      WEORI=SVIH_DKEO
E03   * Segmentnavn + EORI
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+DT+'+%trimr(WEORIB)
     C                             + ':'+%trimr(WEORIA)
N03  C                             +'++'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
N03   * Namn
N03  C                   EVAL      ADS=%trimr(SVIH_DKNA)
N03  C                   EXSR      SRÅ
      * Adress-1
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ADS=%trimr(SVIH_DKA1)
     C                   EXSR      SRÅ
      * Adress-2
     C     SVIH_DKA2     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ADS=%trimr(SVIH_DKA2)
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Postadress
     C                   EVAL      ADS=%trimr(SVIH_DKPA)+'++'+%trimr(SVIH_DKPN)
     C                             + '+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Landkod
     C                   MOVEL     SVIH_DKLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kommunikationskontakter
     C                   EXSR      CTA06F
     C                   EXSR      COM06F
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSD /
      *////////////////////////////////////////////////////////////
     C     UNSD          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVEL     'UNS+D'       ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSS /
      *////////////////////////////////////////////////////////////
     C     UNSS          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVEL     'UNS+S'       ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Valutor, fraktkostnad                             CUX06E /
      *////////////////////////////////////////////////////////////
     C     CUX06E        BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_VUKU
     C                   EXSR      SRNE
     C                   EVAL      ADS='CUX+++'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mått varulinje                                     MEA30 /
      *////////////////////////////////////////////////////////////
     C     MEA30         BEGSR
      *__________
      * Nettovikt
      *""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'MEA+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måttapplikations kvalificerare
     C                   MOVEL     'WT+AAA'      ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måttenhetens kvalificerare
     C                   MOVEL     'KGM'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Mått p
     C                   EVAL      ØN154=SVIV_NETO
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *___________
      * Bruttovikt
      *"""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'MEA+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måttapplikations kvalificerare
     C                   MOVEL     'WT+AAB'      ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måttenhetens kvalificerare
     C                   MOVEL     'KGM'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Mått p
     C                   EVAL      ØN154=SVIV_BRUT
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________
      * Annan kvantitet
      *""""""""""""""""
     C                   IF        SVIV_ANKV <> 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_ANKV
     C                   EXSR      SRNE
N01  C                   IF        SVIV_ANKV = 999999999
N01  C                   EVAL      ADS='MEA+WT+AAS+AQU:'+'0'+WAPSTR
N01  C                   ELSE
     C                   EVAL      ADS='MEA+WT+AAS+AQU:'+%trimr(ØAN)+WAPSTR
N01  C                   ENDIF
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Belopp, huvudnivå                                  MOA08 /
      *////////////////////////////////////////////////////////////
     C     MOA08         BEGSR
      *_____________________
      * Totalt fakturabelopp
      *"""""""""""""""""""""
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_FABL
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+39:'+%trimr(ØAN)+':'
     C                             + %trimr(SVIH_VAKD)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________
      * Førsækringssats
      *""""""""""""""""
     C                   IF        SVIH_VUFO > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_VUFO
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+70:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________
      * Annan rabatt
      *"""""""""""""
     C                   IF        SVIH_ANRA > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_ANRA
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+103:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *____________
      * Kassarabatt
      *""""""""""""
     C                   IF        SVIH_KARA > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_KARA
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+142:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________
      * Fraktkostnad
      *"""""""""""""
     C                   IF        SVIH_VUFR > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_VUFR
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+144:'+%trimr(ØAN)+':'
     C                             + %trimr(SVIH_VUVA)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EXSR      CUX06E
     C                   ENDIF
      *________________
      * Andra kostnader
      *""""""""""""""""
     C                   IF        SVIH_OVKO > 0
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIH_OVKO
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+160:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Statistiskt værde                                  MOA33 /
      *////////////////////////////////////////////////////////////
     C     MOA33         BEGSR
      *____________
      * Varans pris
      *""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'MOA+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beloppstypkvalificerare
     C                   MOVEL     '66'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Belopp
     C                   EVAL      ØN154=SVIV_FABL
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________________
      * Statistiskt værde
      *""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'MOA+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beloppstypkvalificerare
     C                   MOVEL     '123'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Belopp
     C                   EVAL      ØN154=SVIV_STVA
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Førpackning                                        PAC31 /
      *////////////////////////////////////////////////////////////
     C     PAC31         BEGSR
      * Linje-1
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_KOTA
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C     SVIV_KOTA     IFEQ      *ZEROS
     C     SVIV_KOSL     ANDEQ     'VL  '
     C     SVIV_KOSL     OREQ      'VR  '
     C     SVIV_KOSL     OREQ      'VY  '
     C     SVIV_KOSL     OREQ      'VO  '
     C     SVIV_KOSL     OREQ      'VG  '
     C     SVIV_KOSL     OREQ      'VQ  '
     C                   EVAL      ØAN=*BLANKS
     C                   ENDIF
     C                   EVAL      ADS='PAC+6+++'+%trimr(SVIV_KOSL)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     *LIKE         DEFINE    SVIV_GODM     ZVIV_GODM
     C                   EVAL      ZVIV_GODM=SVIV_GODM
     C                   EXSR      PCI32
      * Linje-2
     C     SVIV_KOS2     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_KOT2
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C     SVIV_KOT2     IFEQ      *ZEROS
     C     SVIV_KOS2     IFEQ      'VL  '
     C     SVIV_KOS2     OREQ      'VR  '
     C     SVIV_KOS2     OREQ      'VY  '
     C     SVIV_KOS2     OREQ      'VO  '
     C     SVIV_KOS2     OREQ      'VG  '
     C     SVIV_KOS2     OREQ      'VQ  '
     C                   EVAL      ØAN=*BLANKS
     C                   ENDIF
     C                   ENDIF
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS='PAC+6+++'+%trimr(SVIV_KOS2)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   EVAL      ZVIV_GODM=SVIV_GOD2
     C                   EXSR      PCI32
      * Linje-3
     C     SVIV_KOS3     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_KOT3
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C     SVIV_KOT3     IFEQ      *ZEROS
     C     SVIV_KOS3     IFEQ      'VL  '
     C     SVIV_KOS3     OREQ      'VR  '
     C     SVIV_KOS3     OREQ      'VY  '
     C     SVIV_KOS3     OREQ      'VO  '
     C     SVIV_KOS3     OREQ      'VG  '
     C     SVIV_KOS3     OREQ      'VQ  '
     C                   EVAL      ØAN=*BLANKS
     C                   ENDIF
     C                   ENDIF
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS='PAC+6+++'+%trimr(SVIV_KOS3)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   EVAL      ZVIV_GODM=SVIV_GOD3
     C                   EXSR      PCI32
      * Linje-4
     C     SVIV_KOS4     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_KOT4
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C     SVIV_KOT4     IFEQ      *ZEROS
     C     SVIV_KOS4     IFEQ      'VL  '
     C     SVIV_KOS4     OREQ      'VR  '
     C     SVIV_KOS4     OREQ      'VY  '
     C     SVIV_KOS4     OREQ      'VO  '
     C     SVIV_KOS4     OREQ      'VG  '
     C     SVIV_KOS4     OREQ      'VQ  '
     C                   EVAL      ØAN=*BLANKS
     C                   ENDIF
     C                   ENDIF
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS='PAC+6+++'+%trimr(SVIV_KOS4)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   EVAL      ZVIV_GODM=SVIV_GOD4
     C                   EXSR      PCI32
      * Linje-5
     C     SVIV_KOS5     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN154=SVIV_KOT5
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C     SVIV_KOT5     IFEQ      *ZEROS
     C     SVIV_KOS5     IFEQ      'VL  '
     C     SVIV_KOS5     OREQ      'VR  '
     C     SVIV_KOS5     OREQ      'VY  '
     C     SVIV_KOS5     OREQ      'VO  '
     C     SVIV_KOS5     OREQ      'VG  '
     C     SVIV_KOS5     OREQ      'VQ  '
     C                   EVAL      ØAN=*BLANKS
     C                   ENDIF
     C                   ENDIF
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS='PAC+6+++'+%trimr(SVIV_KOS5)+':'
     C                             + %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   EVAL      ZVIV_GODM=SVIV_GOD5
     C                   EXSR      PCI32
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Førpackningsidentifikation                         PCI32 /
      *////////////////////////////////////////////////////////////
     C     PCI32         BEGSR
     C     ZVIV_GODM     IFNE      *BLANKS
     C                   EVAL      ADS=*BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     35            SUBST     ZVIV_GODM:1   ADS
     C                   EXSR      SRÅ
     C     7             SUBST     ZVIV_GODM:36  ZVIV_GODX         7
     C     ZVIV_GODX     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     ZVIV_GODX     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
      *_______
      * Tullid
      *"""""""
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ZTI:'+%trimr(SVIH_TUID)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________________
      * Uppgiftlæmnarens referansnummer
      *""""""""""""""""""""""""""""""""
     C     SVIH_MTYP     IFNE      'HBK'
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ABE:'+%trimr(SVIH_RFAB)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_______________________________
      * Uppskjuten betalning, referens
      *"""""""""""""""""""""""""""""""
     C     SVIH_MTYP     IFNE      'HBK'
     C     SVIH_UPPS     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ABI:'+%trimr(SVIH_UPPS)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *________________________________________
      * Ytterligare referensnummer (godsnummer)
      *""""""""""""""""""""""""""""""""""""""""
     C     SVIH_RFAC     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ACD:'+%trimr(SVIH_RFAC)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIH_RFAC2    IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ACD:'+%trimr(SVIH_RFAC2)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________
      * Klareringsenhets id.
      *"""""""""""""""""""""
     C     SVIH_KENH     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+CLU:'+%trimr(SVIH_KENH)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF35 /
      *////////////////////////////////////////////////////////////
     C     RFF35         BEGSR
      *__________
      * Container
      *""""""""""
     C     SVIH_MTYP     IFNE      'TNU'
     C     SVIH_CONT     IFEQ      '1'
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO01)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     SVIV_CO02     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO02)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO03     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO03)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO04     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO04)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO05     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO05)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO06     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO06)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO07     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO07)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO08     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO08)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO09     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO09)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO10     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO10)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO11     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO11)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO12     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO12)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO13     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO13)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO14     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO14)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO15     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO15)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO16     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO16)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO17     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO17)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO18     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO18)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO19     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO19)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C     SVIV_CO20     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(SVIV_CO20)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tull/Skatt/Avgifter                                TAX41 /
      *////////////////////////////////////////////////////////////
     C     TAX41         BEGSR
     C                   EVAL      *IN21=*OFF
     C     KEYB          SETLL     SVIVA
     C     KEYB          READE     SVIVA                                  21
     C     *IN21         DOWEQ     *OFF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'TAX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kvalificerare
     C                   MOVEL     '6'           ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftskod
     C                   MOVEL     SVIVA_ABK     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beskattningsgrund
     C                   EVAL      ØN154=SVIVA_ABG
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ

N02  C     SVIVA_ABK     CABEQ     '1MT'         TAX41E

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Sats
     C                   MOVEL     ':::'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   IF        SVIVA_ABS > 0
     C                   EVAL      ØN154=SVIVA_ABS
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
     C                   ENDIF
      * Enhet

     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     SVIVA_ABX     IFNE      *BLANKS
N05  C     WDT           IFGE      '20160201'
N05  C                   SELECT
N05  C     SVIVA_ABX     WHENEQ    'AX  '
N05  C                   EVAL      SVIVA_ABX='ASVX'
N05  C     SVIVA_ABX     WHENEQ    'DE  '
N05  C                   EVAL      SVIVA_ABX='DTNE'
N05  C     SVIVA_ABX     WHENEQ    'DG  '
N05  C                   EVAL      SVIVA_ABX='DTNG'
N05  C     SVIVA_ABX     WHENEQ    'DM  '
N05  C                   EVAL      SVIVA_ABX='DTNM'
N05  C     SVIVA_ABX     WHENEQ    'DZ  '
N05  C                   EVAL      SVIVA_ABX='DTNZ'
N05  C     SVIVA_ABX     WHENEQ    'KA  '
N05  C                   EVAL      SVIVA_ABX='KGMA'
N05  C     SVIVA_ABX     WHENEQ    'HM  '
N05  C                   EVAL      SVIVA_ABX='HMT '
N05  C     SVIVA_ABX     WHENEQ    'KG  '
N05  C                   EVAL      SVIVA_ABX='DTN '
N05  C     SVIVA_ABX     WHENEQ    'KC  '
N05  C                   EVAL      SVIVA_ABX='KCL '
N05  C     SVIVA_ABX     WHENEQ    'KU  '
N05  C                   EVAL      SVIVA_ABX='MTQ '
N05  C     SVIVA_ABX     WHENEQ    'KT  '
N05  C                   EVAL      SVIVA_ABX='KGMT'
N05  C     SVIVA_ABX     WHENEQ    'KV  '
N05  C                   EVAL      SVIVA_ABX='MTK '
N05  C     SVIVA_ABX     WHENEQ    'L   '
N05  C                   EVAL      SVIVA_ABX='LTR '
N05  C     SVIVA_ABX     WHENEQ    'ST  '
N05  C                   EVAL      SVIVA_ABX='NAR '
N05  C     SVIVA_ABX     WHENEQ    'P   '
N05  C                   EVAL      SVIVA_ABX='NPR '
N05  C     SVIVA_ABX     WHENEQ    'ME  '
N05  C                   EVAL      SVIVA_ABX='KMT '
N05  C     SVIVA_ABX     WHENEQ    'TE  '
N05  C                   EVAL      SVIVA_ABX='TNE '
N05  C     SVIVA_ABX     WHENEQ    'TI  '
N05  C                   EVAL      SVIVA_ABX='TNEI'
N05  C                   ENDSL
N05  C                   ENDIF
     C                   MOVEL     SVIVA_ABX     ADS
     C                   ELSE
     C                   MOVEL     '%'           ADS
     C                   ENDIF
     C                   EXSR      SRÅ

      * Slutt segment
N02  C     TAX41E        TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     KEYB          READE     SVIVA                                  21
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetaljer                                  TDT04 /
      *////////////////////////////////////////////////////////////
     C     TDT04         BEGSR
     C     SVIH_MTYP     IFNE      'TNU'
      *______________________________
      * Typ av inrikes transportmedel
      *""""""""""""""""""""""""""""""
     C     SVIH_TRIN     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+1++'+%trimr(SVIH_TRIN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________________
      * Typ av aktivt transportmedel
      *"""""""""""""""""""""""""""""
     C     SVIH_TRGR     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+11++'+%trimr(SVIH_TRGR)+'+++++:::'
     C                             + %trimr(SVIH_TRAI)+':'+%trimr(SVIH_TRAL)
     C                             + WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leveransvillkår                                    TOD07 /
      *////////////////////////////////////////////////////////////
     C     TOD07         BEGSR
     C     SVIH_LEKD     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TOD+5++'+%trimr(SVIH_LEKD)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Ort
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+1+'+%trimr(SVIH_LEOR)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                      UNT00 /
      *////////////////////////////////////////////////////////////
     C     UNT00         BEGSR

     C                   ADD       1             W0074
     C                   EVAL      ØN154=W0074
     C                   EXSR      SRNE

     C                   EVAL      ADS='UNT+' + %trimr(ØAN) + '+'
     C                                 + %trimr(W0062) + WAPSTR
     C                   EVAL      AXV=1
     C     ' '           CHECKR(E) ADS           AXH
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
     C                   ENDSR
