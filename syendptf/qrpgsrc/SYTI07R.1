      * 21069060, 21069093, 21069098, 35019010, 35022090 dobbel sats
     H DFTACTGRP(*NO)
      *
      ***********************************************************
      *** PROGRAM SKAL KONVERTER LANDGRUPPER FRA TVINN        ***
      ***********************************************************
      *
     FXMLRCAF   IF   E           K DISK
     FXMLRCVF   IF   E           K DISK
     FTARINY    UF A E           K DISK
     FTARI      IF   E           K DISK    RENAME(TARIR:TARIRG)
     F                                     PREFIX(G_)
     FTARIKAP   IF   F   19     4AIDISK    KEYLOC(1)
     FKODTS2    IF   E           K DISK
      *
     D                sds
     D ZUSER                 254    263
     D                 ds
     D xsats82                 1      8  2
     D xsats                   2      8  2
      *  Prototype for syti07r
     d syti07r         pr
     d usn_                                like(usn)
      *  *ENTRY Interface for Main Procedure
     d syti07r         pi
     d usn                            9
      *  Prototype for 'SYGE15C'
     d syge15c         pr                  extpgm('SYGE15C')
     d wdt_                                like(wdt)
     d wtm_                                like(wtm)
      *----------------------------------------------------------------------
      * Stand Alone Fields - TOP
      *----------------------------------------------------------------------
     d wdt             s              8
     d wtm             s              6
     d xidag           s              8s 0
     d xan08           s              8A
     d xlandgr         s              5A
     d xenhet          s              1A
     d xfomdato        s              8s 0
     d xtomdato        s              8s 0
     d x1_xrlev1       s                   like(xrlev1)
     d x1_xrlev2       s                   like(xrlev2)
     d x2_xrlev1       s                   like(xrlev1)
     d x2_xrlev2       s                   like(xrlev2)
     d x2_xrlev3       s                   like(xrlev3)
     d x3_xrlev1       s                   like(xrlev1)
     d x3_xrlev2       s                   like(xrlev2)
     d x3_xrlev3       s                   like(xrlev3)
     d x3_xrlev4       s                   like(xrlev4)
     d x4_xrlev1       s                   like(xrlev1)
     d x4_xrlev2       s                   like(xrlev2)
     d x4_xrlev3       s                   like(xrlev3)
     d x4_xrlev4       s                   like(xrlev4)
     d x4_xrlev5       s                   like(xrlev5)
     d x5_xrlev1       s                   like(xrlev1)
     d x5_xrlev2       s                   like(xrlev2)
     d x5_xrlev3       s                   like(xrlev3)
     d x5_xrlev4       s                   like(xrlev4)
     d x5_xrlev5       s                   like(xrlev5)
     d x5_xrlev6       s                   like(xrlev6)
     d x_tatanr        s                   like(tatanr)
     d x_taalfa        s                   like(taalfa)
     d x_tatxt         s                   like(tatxt)
     d x_taordk        s                   like(taordk)
     d x_taordb        s                   like(taordb)
     d x_taeftk        s                   like(taeftk)
     d x_taeftb        s                   like(taeftb)
     d x_taefk         s                   like(taefk)
     d x_taefb         s                   like(taefb)
     d x_tastk         s                   like(tastk)
     d x_taenhe        s                   like(taenhe)
     d x_taeÿsk        s                   like(taeÿsk)
     d x_taeÿsb        s                   like(taeÿsb)
     d x_tatsjk        s                   like(tatsjk)
     d x_tatsjb        s                   like(tatsjb)
     d x_tatyrk        s                   like(tatyrk)
     d x_tatyrb        s                   like(tatyrb)
     d x_taisrk        s                   like(taisrk)
     d x_taisrb        s                   like(taisrb)
     d x_taellk        s                   like(taellk)
     d x_taellb        s                   like(taellb)
     d x_tabulk        s                   like(tabulk)
     d x_tabulb        s                   like(tabulb)
     d x_tapolk        s                   like(tapolk)
     d x_tapolb        s                   like(tapolb)
     d x_taromk        s                   like(taromk)
     d x_taromb        s                   like(taromb)
     d x_taungk        s                   like(taungk)
     d x_taungb        s                   like(taungb)
     d x_taslok        s                   like(taslok)
     d x_taslob        s                   like(taslob)
     d x_tamulk        s                   like(tamulk)
     d x_tamulb        s                   like(tamulb)
     d x_taoulk        s                   like(taoulk)
     d x_taoulb        s                   like(taoulb)
     d x_tagrlk        s                   like(tagrlk)
     d x_tagrlb        s                   like(tagrlb)
     d x_taf∆rk        s                   like(taf∆rk)
     d x_taf∆rb        s                   like(taf∆rb)
     d x_taistk        s                   like(taistk)
     d x_taistb        s                   like(taistb)
     d x_tamark        s                   like(tamark)
     d x_tamarb        s                   like(tamarb)
     d x_tamexk        s                   like(tamexk)
     d x_tamexb        s                   like(tamexb)
     d x_tavgak        s                   like(tavgak)
     d x_tavgab        s                   like(tavgab)
     d x_tan01k        s                   like(tan01k)
     d x_tan01b        s                   like(tan01b)
     d x_tan02k        s                   like(tan02k)
     d x_tan02b        s                   like(tan02b)
     d x_tan03k        s                   like(tan03k)
     d x_tan03b        s                   like(tan03b)
     d x_tan04k        s                   like(tan04k)
     d x_tan04b        s                   like(tan04b)
     d x_tan05k        s                   like(tan05k)
     d x_tan05b        s                   like(tan05b)
     d x_tan06k        s                   like(tan06k)
     d x_tan06b        s                   like(tan06b)
     d x_tan07k        s                   like(tan07k)
     d x_tan07b        s                   like(tan07b)
     d x_tan08k        s                   like(tan08k)
     d x_tan08b        s                   like(tan08b)
     d x_tan09k        s                   like(tan09k)
     d x_tan09b        s                   like(tan09b)
     d x_tan10k        s                   like(tan10k)
     d x_tan10b        s                   like(tan10b)
     d x_tan11k        s                   like(tan11k)
     d x_tan11b        s                   like(tan11b)
     d x_tan12k        s                   like(tan12k)
     d x_tan12b        s                   like(tan12b)
     d x_tan13k        s                   like(tan13k)
     d x_tan13b        s                   like(tan13b)
     d x_tan14k        s                   like(tan14k)
     d x_tan14b        s                   like(tan14b)
     d x_tan15k        s                   like(tan15k)
     d x_tan15b        s                   like(tan15b)
     d x_tan16k        s                   like(tan16k)
     d x_tan16b        s                   like(tan16b)
     d x_tan17k        s                   like(tan17k)
     d x_tan17b        s                   like(tan17b)
     d x_tan18k        s                   like(tan18k)
     d x_tan18b        s                   like(tan18b)
     d x_tan19k        s                   like(tan19k)
     d x_tan19b        s                   like(tan19b)
     d x_tan20k        s                   like(tan20k)
     d x_tan20b        s                   like(tan20b)
     d x_tan21k        s                   like(tan21k)
     d x_tan21b        s                   like(tan21b)
     d x_tan22k        s                   like(tan22k)
     d x_tan22b        s                   like(tan22b)
     d x_tan23k        s                   like(tan23k)
     d x_tan23b        s                   like(tan23b)
     d x_tan24k        s                   like(tan24k)
     d x_tan24b        s                   like(tan24b)
     d x_tan25k        s                   like(tan25k)
     d x_tan25b        s                   like(tan25b)
     d x_tan26k        s                   like(tan26k)
     d x_tan26b        s                   like(tan26b)
     d p_tatanr        s                   like(tatanr)
     d p_taalfa        s                   like(taalfa)
     d p_tatxt         s                   like(tatxt)
     d p_taordk        s                   like(taordk)
     d p_taordb        s                   like(taordb)
     d p_taeftk        s                   like(taeftk)
     d p_taeftb        s                   like(taeftb)
     d p_taefk         s                   like(taefk)
     d p_taefb         s                   like(taefb)
     d p_tastk         s                   like(tastk)
     d p_taenhe        s                   like(taenhe)
     d p_taeÿsk        s                   like(taeÿsk)
     d p_taeÿsb        s                   like(taeÿsb)
     d p_tatsjk        s                   like(tatsjk)
     d p_tatsjb        s                   like(tatsjb)
     d p_tatyrk        s                   like(tatyrk)
     d p_tatyrb        s                   like(tatyrb)
     d p_taisrk        s                   like(taisrk)
     d p_taisrb        s                   like(taisrb)
     d p_taellk        s                   like(taellk)
     d p_taellb        s                   like(taellb)
     d p_tabulk        s                   like(tabulk)
     d p_tabulb        s                   like(tabulb)
     d p_tapolk        s                   like(tapolk)
     d p_tapolb        s                   like(tapolb)
     d p_taromk        s                   like(taromk)
     d p_taromb        s                   like(taromb)
     d p_taungk        s                   like(taungk)
     d p_taungb        s                   like(taungb)
     d p_taslok        s                   like(taslok)
     d p_taslob        s                   like(taslob)
     d p_tamulk        s                   like(tamulk)
     d p_tamulb        s                   like(tamulb)
     d p_taoulk        s                   like(taoulk)
     d p_taoulb        s                   like(taoulb)
     d p_tagrlk        s                   like(tagrlk)
     d p_tagrlb        s                   like(tagrlb)
     d p_taf∆rk        s                   like(taf∆rk)
     d p_taf∆rb        s                   like(taf∆rb)
     d p_taistk        s                   like(taistk)
     d p_taistb        s                   like(taistb)
     d p_tamark        s                   like(tamark)
     d p_tamarb        s                   like(tamarb)
     d p_tamexk        s                   like(tamexk)
     d p_tamexb        s                   like(tamexb)
     d p_tavgak        s                   like(tavgak)
     d p_tavgab        s                   like(tavgab)
     d p_tan01k        s                   like(tan01k)
     d p_tan01b        s                   like(tan01b)
     d p_tan02k        s                   like(tan02k)
     d p_tan02b        s                   like(tan02b)
     d p_tan03k        s                   like(tan03k)
     d p_tan03b        s                   like(tan03b)
     d p_tan04k        s                   like(tan04k)
     d p_tan04b        s                   like(tan04b)
     d p_tan05k        s                   like(tan05k)
     d p_tan05b        s                   like(tan05b)
     d p_tan06k        s                   like(tan06k)
     d p_tan06b        s                   like(tan06b)
     d p_tan07k        s                   like(tan07k)
     d p_tan07b        s                   like(tan07b)
     d p_tan08k        s                   like(tan08k)
     d p_tan08b        s                   like(tan08b)
     d p_tan09k        s                   like(tan09k)
     d p_tan09b        s                   like(tan09b)
     d p_tan10k        s                   like(tan10k)
     d p_tan10b        s                   like(tan10b)
     d p_tan11k        s                   like(tan11k)
     d p_tan11b        s                   like(tan11b)
     d p_tan12k        s                   like(tan12k)
     d p_tan12b        s                   like(tan12b)
     d p_tan13k        s                   like(tan13k)
     d p_tan13b        s                   like(tan13b)
     d p_tan14k        s                   like(tan14k)
     d p_tan14b        s                   like(tan14b)
     d p_tan15k        s                   like(tan15k)
     d p_tan15b        s                   like(tan15b)
     d p_tan16k        s                   like(tan16k)
     d p_tan16b        s                   like(tan16b)
     d p_tan17k        s                   like(tan17k)
     d p_tan17b        s                   like(tan17b)
     d p_tan18k        s                   like(tan18k)
     d p_tan18b        s                   like(tan18b)
     d p_tan19k        s                   like(tan19k)
     d p_tan19b        s                   like(tan19b)
     d p_tan20k        s                   like(tan20k)
     d p_tan20b        s                   like(tan20b)
     d p_tan21k        s                   like(tan21k)
     d p_tan21b        s                   like(tan21b)
     d p_tan22k        s                   like(tan22k)
     d p_tan22b        s                   like(tan22b)
     d p_tan23k        s                   like(tan23k)
     d p_tan23b        s                   like(tan23b)
     d p_tan24k        s                   like(tan24k)
     d p_tan24b        s                   like(tan24b)
     d p_tan25k        s                   like(tan25k)
     d p_tan25b        s                   like(tan25b)
     d p_tan26k        s                   like(tan26k)
     d p_tan26b        s                   like(tan26b)
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ∆ÿ≈')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzÊ¯Â')
     ITARIKAP   NS  02
     I                                  5   19  NYALFA

      *----------------------------------------------------------------------
      /free

       exsr init;

       exsr srxml1;

       *inlr = *on;
       return;

       //**********************************************                ------
       begsr srxml1;
       //**********************************************

         X1_XRLEV1 = 1;
         X1_XRLEV2 = 0;

         chain (xrsn:x1_xrlev1:x1_xrlev2) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'versjon';
           when xrnv = 'vare';
             exsr srxml2;
           endsl;
           x1_xrlev1 = x1_xrlev1 + 1;
           chain (xrsn:x1_xrlev1:x1_xrlev2) xmlrcvf;
         enddo;

         endsr;

       //**********************************************
       begsr srxml2;
       //**********************************************

         clear tarir;

         x2_xrlev1 = xrlev1;
         x2_xrlev2 = 1;
         x2_xrlev3 = 0;

         chain (xrsn:x2_xrlev1:x2_xrlev2:x2_xrlev3) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'id';
             x_tatanr = %dec(xrverd:8:0);
           when xrnv = 'enhet';
             select;
             when xrverd = 'Kg' or xrverd = 'K';
               x_taordk = 'V';
             when xrverd = 'P';
               x_taordk = 'P';
             when xrverd = 'S';
               x_taordk = 'A';
             endsl;
           when xrnv = 'enhetBeskrivelse';
           when xrnv = 'annenEnhet';
             if xrverd <> *blanks;
               x_tastk = 'J';
               x_taenhe = xrverd;
             endif;
           when xrnv = 'annenEnhetBeskrivelse';
           when xrnv = 'avtalesatser';
             exsr srxml3;
           endsl;
           x2_xrlev2 = x2_xrlev2 + 1;
           chain (xrsn:x2_xrlev1:x2_xrlev2:x2_xrlev3) xmlrcvf;
         enddo;

         exsr opdtar;

       endsr;

       //**********************************************
       begsr srxml3;
       //**********************************************

         x3_xrlev1 = xrlev1;
         x3_xrlev2 = xrlev2;
         x3_xrlev3 = 1;
         x3_xrlev4 = 0;

         chain (xrsn:x3_xrlev1:x3_xrlev2:x3_xrlev3:x3_xrlev4) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'avtale';
             exsr srxml4;
           endsl;
           x3_xrlev3 = x3_xrlev3 + 1;
           chain (xrsn:x3_xrlev1:x3_xrlev2:x3_xrlev3:x3_xrlev4) xmlrcvf;
         enddo;

       endsr;

       //**********************************************
       begsr srxml4;
       //**********************************************

         x4_xrlev1 = xrlev1;
         x4_xrlev2 = xrlev2;
         x4_xrlev3 = xrlev3;
         x4_xrlev4 = 1;
         x4_xrlev5 = 0;

         chain (xrsn:x4_xrlev1:x4_xrlev2:x4_xrlev3:x4_xrlev4:x4_xrlev5)
               xmlrcvf;
         dow %found;
           select;
           when xrnv = 'landgruppe';
             xlandgr = xrverd;
           when xrnv = 'sats';
             exsr srxml5;
           endsl;
           x4_xrlev4 = x4_xrlev4 + 1;
           chain (xrsn:x4_xrlev1:x4_xrlev2:x4_xrlev3:x4_xrlev4:x4_xrlev5)
                 xmlrcvf;
         enddo;

       endsr;

       //**********************************************
       begsr srxml5;
       //**********************************************

         x5_xrlev1 = xrlev1;
         x5_xrlev2 = xrlev2;
         x5_xrlev3 = xrlev3;
         x5_xrlev4 = xrlev4;
         x5_xrlev5 = 1;
         x5_xrlev6 = 0;

         chain (xrsn:x5_xrlev1:x5_xrlev2:x5_xrlev3:x5_xrlev4:x5_xrlev5
               :x5_xrlev6) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'satsVerdi';
             xsats82 = %dec(xrverd:8:2);
             if xlandgr = 'TALL';
               x_taordb = xsats;
             endif;
           when xrnv = 'satsEnhet';
             select;
             when xrverd = 'K';
               xenhet = 'V';
             when xrverd = 'S' or xrverd = 'L';
               xenhet = 'A';
             when xrverd = 'P';
               xenhet = 'P';
             when xrverd = 'H';
               xenhet = 'W';
             when xsats = 0;
               xenhet = 'F';
             other;
               xenhet = 'V';
             endsl;
             if xlandgr = 'TALL';
               x_taordk = xenhet;
             endif;
           when xrnv = 'fomdato';
             xan08    = %subst(xrverd:1:4) + %subst(xrverd:6:2)
                      + %subst(xrverd:9:2);
             xfomdato = %dec(xan08:8:0);
           when xrnv = 'tomdato';
             if xrverd = *blanks;
               xtomdato = 0;
             else;
               xan08    = %subst(xrverd:1:4) + %subst(xrverd:6:2)
                        + %subst(xrverd:9:2);
               xtomdato = %dec(xan08:8:0);
             endif;
           endsl;
           x5_xrlev5 = x5_xrlev5 + 1;
           chain (xrsn:x5_xrlev1:x5_xrlev2:x5_xrlev3:x5_xrlev4:x5_xrlev5
                 :x5_xrlev6) xmlrcvf;
         enddo;

         select;
         //when xlandgr = 'TALL';            //Alle land/ordinÊr
         //  x_taordb = xsats;
         when xlandgr = 'TEF';             //EU-land
           if xenhet = *blanks;
             x_taefk = x_taordk;
           else;
             x_taefk = xenhet;
           endif;
           x_taefb = xsats;
         when xlandgr = 'TEFT';            //EFTA-land
           if xenhet = *blanks;
             x_taeftk = x_taordk;
           else;
             x_taeftk = xenhet;
           endif;
           x_taeftb = xsats;
         when xlandgr = 'TIST';            //IN, LK, TH. India, Srilanka, Thailand
           if xenhet = *blanks;
             x_taistk = x_taordk;
           else;
             x_taistk = xenhet;
           endif;
           x_taistb = xsats;
         when xlandgr = 'TGCC';            //SA, AE, QA, BH, KW, OM. Gulf-land
           if xenhet = *blanks;
             x_tan13k = x_taordk;
           else;
             x_tan13k = xenhet;
           endif;
           x_tan13b = xsats;
         when xlandgr = 'TGS1';            //Minst utviklede land
           if xenhet = *blanks;
             x_tamulk = x_taordk;
           else;
             x_tamulk = xenhet;
           endif;
           x_tamulb = xsats;
         when xlandgr = 'TGS2';            //OrdinÊre utviklingsland
           if xenhet = *blanks;
             x_taoulk = x_taordk;
           else;
             x_taoulk = xenhet;
           endif;
           x_taoulb = xsats;
         when xlandgr = 'TGS7' or xlandgr = 'TGS8' or xlandgr = 'TGS9';  //BW, NA, SZ
           if xenhet = *blanks;
             x_tan11k = x_taordk;
           else;
             x_tan11k = xenhet;
           endif;
           x_tan11b = xsats;
         when xlandgr = 'TGSP';            //GSP-land, lavere mellominnteksland
           if xenhet = *blanks;
             x_tan12k = x_taordk;
           else;
             x_tan12k = xenhet;
           endif;
           x_tan12b = xsats;
         when xlandgr = 'TH';              //GL. Gr¯nland
           if xenhet = *blanks;
             x_tagrlk = x_taordk;
           else;
             x_tagrlk = xenhet;
           endif;
           x_tagrlb = xsats;
         when xlandgr = 'TI';              //FO, FÊr¯yene
           if xenhet = *blanks;
             x_taf∆rk = x_taordk;
           else;
             x_taf∆rk = xenhet;
           endif;
           x_taf∆rb = xsats;
         when xlandgr = 'TOES';            //EÿS-land
           if xenhet = *blanks;
             x_taeÿsk = x_taordk;
           else;
             x_taeÿsk = xenhet;
           endif;
           x_taeÿsb = xsats;
         when xlandgr = 'TSAC';            //BW, NA, SZ, ZA, LS. SACU-land
           if xenhet = *blanks;
             x_tan02k = x_taordk;
           else;
             x_tan02k = xenhet;
           endif;
           x_tan02b = xsats;
         when xlandgr = 'TTYR';            //TR, Tyrkia
           if xenhet = *blanks;
             x_tatyrk = x_taordk;
           else;
             x_tatyrk = xenhet;
           endif;
           x_tatyrb = xsats;
         when xlandgr = 'TXI';             //PS. Vestbreddeb og Gazastripen
           if xenhet = *blanks;
             x_tavgak = x_taordk;
           else;
             x_tavgak = xenhet;
           endif;
           x_tavgab = xsats;
         when xlandgr = 'TSZ';             //Swaziland
           if xenhet = *blanks;
             x_tatsjk = x_taordk;
           else;
             x_tatsjk = xenhet;
           endif;
           x_tatsjb = xsats;
         when xlandgr = 'TCL';             //Chile
           if xenhet = *blanks;
             x_tabulk = x_taordk;
           else;
             x_tabulk = xenhet;
           endif;
           x_tabulb = xsats;
         when xlandgr = 'TMK';             //Nord-Makedonia
           if xenhet = *blanks;
             x_tapolk = x_taordk;
           else;
             x_tapolk = xenhet;
           endif;
           x_tapolb = xsats;
         when xlandgr = 'TKR';             //SÿR-KOREA
           if xenhet = *blanks;
             x_taromk = x_taordk;
           else;
             x_taromk = xenhet;
           endif;
           x_taromb = xsats;
         when xlandgr = 'TRS';             //Serbia
           if xenhet = *blanks;
             x_tan05k = x_taordk;
           else;
             x_tan05k = xenhet;
           endif;
           x_tan05b = xsats;
         when xlandgr = 'TAL';             //Albania
           if xenhet = *blanks;
             x_tan06k = x_taordk;
           else;
             x_tan06k = xenhet;
           endif;
           x_tan06b = xsats;
         when xlandgr = 'TUA';             //UKRAINA
           if xenhet = *blanks;
             x_tan07k = x_taordk;
           else;
             x_tan07k = xenhet;
           endif;
           x_tan07b = xsats;
         when xlandgr = 'TJO';             //Jordan
           if xenhet = *blanks;
             x_taungk = x_taordk;
           else;
             x_taungk = xenhet;
           endif;
           x_taungb = xsats;
         when xlandgr = 'TTN';             //TUNISIA
           if xenhet = *blanks;
             x_taslok = x_taordk;
           else;
             x_taslok = xenhet;
           endif;
           x_taslob = xsats;
         when xlandgr = 'TMA';             //Marokko
           if xenhet = *blanks;
             x_tamark = x_taordk;
           else;
             x_tamark = xenhet;
           endif;
           x_tamarb = xsats;
         when xlandgr = 'TPE';             //Peru
           if xenhet = *blanks;
             x_tan08k = x_taordk;
           else;
             x_tan08k = xenhet;
           endif;
           x_tan08b = xsats;
         when xlandgr = 'TME';             //Montenegro
           if xenhet = *blanks;
             x_tan09k = x_taordk;
           else;
             x_tan09k = xenhet;
           endif;
           x_tan09b = xsats;
         when xlandgr = 'THK';             //Hongkong
           if xenhet = *blanks;
             x_tan10k = x_taordk;
           else;
             x_tan10k = xenhet;
           endif;
           x_tan10b = xsats;
         when xlandgr = 'TMX';             //Mexico
           if xenhet = *blanks;
             x_tamexk = x_taordk;
           else;
             x_tamexk = xenhet;
           endif;
           x_tamexb = xsats;
         when xlandgr = 'TLB';             //Libanon
           if xenhet = *blanks;
             x_tan01k = x_taordk;
           else;
             x_tan01k = xenhet;
           endif;
           x_tan01b = xsats;
         when xlandgr = 'TEG';             //Egypt
           if xenhet = *blanks;
             x_tan03k = x_taordk;
           else;
             x_tan03k = xenhet;
           endif;
           x_tan03b = xsats;
         when xlandgr = 'TCA';             //Canada
           if xenhet = *blanks;
             x_tan04k = x_taordk;
           else;
             x_tan04k = xenhet;
           endif;
           x_tan04b = xsats;
         when xlandgr = 'TPA';             //Panama
           if xenhet = *blanks;
             x_tan14k = x_taordk;
           else;
             x_tan14k = xenhet;
           endif;
           x_tan14b = xsats;
         when xlandgr = 'TCR';             //Costa Rica
           if xenhet = *blanks;
             x_tan15k = x_taordk;
           else;
             x_tan15k = xenhet;
           endif;
           x_tan15b = xsats;
         when xlandgr = 'TCO';             //Columbia
           if xenhet = *blanks;
             x_tan16k = x_taordk;
           else;
             x_tan16k = xenhet;
           endif;
           x_tan16b = xsats;
         when xlandgr = 'TBA';             //BOSNIA-HERCEGOVINA
           if xenhet = *blanks;
             x_tan17k = x_taordk;
           else;
             x_tan17k = xenhet;
           endif;
           x_tan17b = xsats;
         when xlandgr = 'TGE';             //Georgia
           if xenhet = *blanks;
             x_tan18k = x_taordk;
           else;
             x_tan18k = xenhet;
           endif;
           x_tan18b = xsats;
         when xlandgr = 'TIL';             //Israel
           if xenhet = *blanks;
             x_taisrk = x_taordk;
           else;
             x_taisrk = xenhet;
           endif;
           x_taisrb = xsats;
         when xlandgr = 'TPH';             //Filippinene
           if xenhet = *blanks;
             x_tan19k = x_taordk;
           else;
             x_tan19k = xenhet;
           endif;
           x_tan19b = xsats;
         when xlandgr = 'TGB';             //Storbritania
           if xenhet = *blanks;
             x_tan20k = x_taordk;
           else;
             x_tan20k = xenhet;
           endif;
           x_tan20b = xsats;
         when xlandgr = 'TID';             //Indonesia
           if xenhet = *blanks;
             x_tan22k = x_taordk;
           else;
             x_tan22k = xenhet;
           endif;
           x_tan22b = xsats;
         when xlandgr = 'TEC';             //ECUADOR
           if xenhet = *blanks;
             x_tan23k = x_taordk;
           else;
             x_tan23k = xenhet;
           endif;
           x_tan23b = xsats;
         endsl;

       endsr;

       //**********************************************
       begsr opdtar;
       //**********************************************

         chain (x_tatanr) tari;
         if %found and g_taalfa <> *blanks;
           x_taalfa = g_taalfa;
           x_tatxt  = g_tatxt;
         else;
      /end-free
     C                   MOVEL     X_TATANR      TANR4             4 0
     C     TANR4         CHAIN     TARIKAP                            33
     C  N33              MOVE      NYALFA        X_TAALFA
      /free
         endif;
         chain (x_tatanr) tariny;
         tatanr = x_tatanr;
         tadato = xfomdato;
         tadts  = xtomdato;
         tadtr  = xidag;
         taalfa = x_taalfa;
         tatxt  = x_tatxt;
         taordk = x_taordk;
         taordb = x_taordb;
         taeftk = x_taeftk;
         taeftb = x_taeftb;
         taefk  = x_taefk;
         taefb  = x_taefb;
         tastk  = x_tastk;
         taenhe = x_taenhe;
         taeÿsk = x_taeÿsk;
         taeÿsb = x_taeÿsb;
         tatsjk = x_tatsjk;
         tatsjb = x_tatsjb;
         tatyrk = x_tatyrk;
         tatyrb = x_tatyrb;
         taisrk = x_taisrk;
         taisrb = x_taisrb;
         taellk = x_taellk;
         taellb = x_taellb;
         tabulk = x_tabulk;
         tabulb = x_tabulb;
         tapolk = x_tapolk;
         tapolb = x_tapolb;
         taromk = x_taromk;
         taromb = x_taromb;
         taungk = x_taungk;
         taungb = x_taungb;
         taslok = x_taslok;
         taslob = x_taslob;
         tamulk = x_tamulk;
         tamulb = x_tamulb;
         taoulk = x_taoulk;
         taoulb = x_taoulb;
         tagrlk = x_tagrlk;
         tagrlb = x_tagrlb;
         taf∆rk = x_taf∆rk;
         taf∆rb = x_taf∆rb;
         taistk = x_taistk;
         taistb = x_taistb;
         tamark = x_tamark;
         tamarb = x_tamarb;
         tamexk = x_tamexk;
         tamexb = x_tamexb;
         tavgak = x_tavgak;
         tavgab = x_tavgab;
         tan01k = x_tan01k;
         tan01b = x_tan01b;
         tan02k = x_tan02k;
         tan02b = x_tan02b;
         tan03k = x_tan03k;
         tan03b = x_tan03b;
         tan04k = x_tan04k;
         tan04b = x_tan04b;
         tan05k = x_tan05k;
         tan05b = x_tan05b;
         tan06k = x_tan06k;
         tan06b = x_tan06b;
         tan07k = x_tan07k;
         tan07b = x_tan07b;
         tan08k = x_tan08k;
         tan08b = x_tan08b;
         tan09k = x_tan09k;
         tan09b = x_tan09b;
         tan10k = x_tan10k;
         tan10b = x_tan10b;
         tan11k = x_tan11k;
         tan11b = x_tan11b;
         tan12k = x_tan12k;
         tan12b = x_tan12b;
         tan13k = x_tan13k;
         tan13b = x_tan13b;
         tan14k = x_tan14k;
         tan14b = x_tan14b;
         tan15k = x_tan15k;
         tan15b = x_tan15b;
         tan16k = x_tan16k;
         tan16b = x_tan16b;
         tan17k = x_tan17k;
         tan17b = x_tan17b;
         tan18k = x_tan18k;
         tan18b = x_tan18b;
         tan19k = x_tan19k;
         tan19b = x_tan19b;
         tan20k = x_tan20k;
         tan20b = x_tan20b;
         tan21k = x_tan21k;
         tan21b = x_tan21b;
         tan22k = x_tan22k;
         tan22b = x_tan22b;
         tan23k = x_tan23k;
         tan23b = x_tan23b;
         tan24k = x_tan24k;
         tan24b = x_tan24b;
         tan25k = x_tan25k;
         tan25b = x_tan25b;
         tan26k = x_tan26k;
         tan26b = x_tan26b;
         if %found;
           update tarir;
         else;
           write tarir;
         endif;

         x_tatanr = 0;
         xfomdato = 0;
         xtomdato = 0;
         x_taalfa = *blanks;
         x_tatxt  = *blanks;
         x_taordk = *blanks;
         x_taordb = 0;
         x_taeftk = *blanks;
         x_taeftb = 0;
         x_taefk  = *blanks;
         x_taefb  = 0;
         x_tastk  = *blanks;
         x_taenhe = *blanks;
         x_taeÿsk = *blanks;
         x_taeÿsb = 0;
         x_tatsjk = *blanks;
         x_tatsjb = 0;
         x_tatyrk = *blanks;
         x_tatyrb = 0;
         x_taisrk = *blanks;
         x_taisrb = 0;
         x_taellk = *blanks;
         x_taellb = 0;
         x_tabulk = *blanks;
         x_tabulb = 0;
         x_tapolk = *blanks;
         x_tapolb = 0;
         x_taromk = *blanks;
         x_taromb = 0;
         x_taungk = *blanks;
         x_taungb = 0;
         x_taslok = *blanks;
         x_taslob = 0;
         x_tamulk = *blanks;
         x_tamulb = 0;
         x_taoulk = *blanks;
         x_taoulb = 0;
         x_tagrlk = *blanks;
         x_tagrlb = 0;
         x_taf∆rk = *blanks;
         x_taf∆rb = 0;
         x_taistk = *blanks;
         x_taistb = 0;
         x_tamark = *blanks;
         x_tamarb = 0;
         x_tamexk = *blanks;
         x_tamexb = 0;
         x_tavgak = *blanks;
         x_tavgab = 0;
         x_tan01k = *blanks;
         x_tan01b = 0;
         x_tan02k = *blanks;
         x_tan02b = 0;
         x_tan03k = *blanks;
         x_tan03b = 0;
         x_tan04k = *blanks;
         x_tan04b = 0;
         x_tan05k = *blanks;
         x_tan05b = 0;
         x_tan06k = *blanks;
         x_tan06b = 0;
         x_tan07k = *blanks;
         x_tan07b = 0;
         x_tan08k = *blanks;
         x_tan08b = 0;
         x_tan09k = *blanks;
         x_tan09b = 0;
         x_tan10k = *blanks;
         x_tan10b = 0;
         x_tan11k = *blanks;
         x_tan11b = 0;
         x_tan12k = *blanks;
         x_tan12b = 0;
         x_tan13k = *blanks;
         x_tan13b = 0;
         x_tan14k = *blanks;
         x_tan14b = 0;
         x_tan15k = *blanks;
         x_tan15b = 0;
         x_tan16k = *blanks;
         x_tan16b = 0;
         x_tan17k = *blanks;
         x_tan17b = 0;
         x_tan18k = *blanks;
         x_tan18b = 0;
         x_tan19k = *blanks;
         x_tan19b = 0;
         x_tan20k = *blanks;
         x_tan20b = 0;
         x_tan21k = *blanks;
         x_tan21b = 0;
         x_tan22k = *blanks;
         x_tan22b = 0;
         x_tan23k = *blanks;
         x_tan23b = 0;
         x_tan24k = *blanks;
         x_tan24b = 0;
         x_tan25k = *blanks;
         x_tan25b = 0;
         x_tan26k = *blanks;
         x_tan26b = 0;

       endsr;

       //**********************************************
       begsr init;
       //**********************************************

         xrsn = %dec(usn:9:0);
         syge15c ( wdt : wtm );
         xidag = %dec(wdt:8:0);
         xsats82 = 0;

       endsr;

      /end-free
