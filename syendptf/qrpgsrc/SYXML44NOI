     FKALENDER2 IF   E           K DISK
     FKODTSIA1  IF   E           K DISK
     FSADIUF    UF A E           K DISK
     FXMLRCVF   IF   E           K DISK
     FXMLRCVF01 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR01)
     FXMLRCVF02 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR02)
     FXMLRCVF03 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR03)
     FXMLRCAF   IF   E           K DISK
     FEDIS      IF   E           K DISK
     FEDIM      O  A E             DISK
     FEDIC      UF   E             DISK
     FCUNDL01   UF A E           K DISK
     FSYPARL3   UF A E           K DISK
     FFIRKU     UF   E           K DISK
     FTELLGE    UF   E           K DISK
     FHEADF     UF A E           K DISK
     FSADH      UF A E           K DISK
     FSADHTST   IF   E           K DISK    PREFIX(H_)
     F                                     RENAME(SADHR:H_SADHR)
     FSTANDI    UF   E           K DISK
     FFRISOL01  IF A E           K DISK
     FFIRM      IF   E           K DISK
     FKODTLB    IF   E           K DISK
     FKODTSI    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FSYXML44F  UF A E           K DISK

     D                 DS
     D  XTXT                   1     15
     D  XT                     1     15    DIM(15)
     D                 DS
     D  XTAL                   1     15  3
     D  XTALH                  1     12  0
     D  XTALD1                13     13
     D  XTALD2                14     14
     D  XTALD3                15     15
     D                 DS
     D  XCHKTAL                1     10
     D  XCT                    1     10    DIM(10)
     D                 DS
     D  SIKTC                  1      1
     D  SIKTA                  2      6  0
     D  SIKTB                  7      8  0
     D  SIKT8                  1      8
     D  SIKT7                  2      8
     D                 DS
     D  HEAVD                  1      4  0
     D  SIAVD                  1      4  0
     D  SVAVD                  1      4  0
     D  FSAVD                  1      4  0
     D  HEOPD                  5     11  0
     D  SITDN                  5     11  0
     D  SVTDN                  5     11  0
     D  FSOPD                  5     11  0
     D  HESG                  12     14
     D  SISG                  12     14
     D  X14S                   1     14
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTR                  1      8  0
     D  SIDT                   1      8  0
     D  FSDTOP                 1      8  0
     D                 DS
     D  HENAS                  1     30
     D  SINAS                  1     30
     D                 DS
     D  HEADS1                 1     30
     D  SIADS1                 1     30
     D                 DS
     D  HEADS2                 1     30
     D  SIADS2                 1     30
     D                 DS
     D  HEADS3                 1     30
     D  SIADS3                 1     30
     D                 DS
     D  HENAK                  1     30
     D  SINAK                  1     30
     D                 DS
     D  HEKNK                  1      8  0
     D  SIKNK                  1      8  0
     D                 DS
     D  HEADK1                 1     30
     D  SIADK1                 1     30
     D                 DS
     D  HEADK2                 1     30
     D  SIADK2                 1     30
     D                 DS
     D  HEADK3                 1     30
     D  SIADK3                 1     30
     D                 DS
     D  HEGN                   1     15
     D  SIGN                   1     15
     D                 DS
     D  HEPOS1                 1      7
     D  SIPOS                  1      9
     D                 DS
     D  HEVKT                  1      9  0
     D  SIVKB                  1      9  0
     D                 DS
     D  HENT                   1      7  0
     D  SINTK                  1      7  0
     D                 DS
     D  HEFR                   1      3
     D  SILV                   1      3
     D                 DS
     D  HETRM                  1      2  0
     D  SITRM                  1      2  0
     D                 DS
     D  HETRI                  1      2
     D  SILKT                  1      2
     D                 DS
     D  SI27                   1     27
     D  SIBELC                 1     11  2
     D  SIRAB                 12     15  2
     D                 DS
     D  KLBXXX                 1     35
     D  KLBHAD                 1      1
     D                 DS
     D  SYRG                   1     14
     D  SYFORE                 1      9
     D                 DS
     D  KS8FTX                 1     52
     D  KS8MIL                52     52
     D  KS8ØRE                51     51
     D                 DS
     D  XCRN25                 1     25
     D  XCRN                   1     15
     D  XPOS                  17     25
     D                 DS
     D  WSIRG14                1     14
     D  WSIRG2                 1      2
     D  WSIRG9                 3     11
     D  WSIRG9B                1      9

     C                   EXSR      INIT

     C                   EXSR      SRXML0

     C                   EVAL      *INLR = *ON
      ***********************************************
     C     SRXML0        BEGSR
      ***********************************************
      * HENT KODE FOR IMPORT ELLER EKSPORT, STED FOR Å IDENTIFISERE HVILKEN AVDELING
     C     XRSN          SETLL     XMLRCVF
     C     XRSN          READE     XMLRCVF                                33
     C                   DOW       *IN33 = *OFF

     C                   SELECT
     C                   WHEN      XRNV = 'ShipmentFileNumber'
     C                   MOVEL     XRVERD        XSHPNBR          35
     C                   WHEN      XRNV = 'BranchCode'
     C                   MOVEL     XRVERD        XBRANCH           3
     C                   WHEN      XRNV = 'DepartmentCode'
     C                   MOVEL     XRVERD        XDEPART           3
     C                   WHEN      XRNV = 'HousebillNumber'
     C                   MOVEL     XRVERD        XHAWB             9
     C                   WHEN      XRNV   = 'ModeOfTransport'
     C                   MOVEL     XRVERD        XTRTYPE          10
     C                   WHEN      XRNV = 'MasterbillNumber'
     C                   MOVEL     XRVERD        XMAWB            35
     C                   LEAVE
     C                   ENDSL

     C     XRSN          READE     XMLRCVF                                33
     C                   ENDDO
      * Programet avslutas om det inte finns en giltig departmentcode
     C                   SELECT
     C                   WHEN      XDEPART = 'FIA'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'FOI'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'FPI'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'PIA'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'FIS'
     C                   EVAL      HEUR   = 'F'
     C                   WHEN      XDEPART = 'FFI'
     C                   EVAL      HEUR   = 'F'
     C                   WHEN      XDEPART = 'FLI'
     C                   EVAL      HEUR   = 'F'
     C                   ENDSL
     C     HEUR          CABEQ     *BLANKS       SLSRXML0
      * Hvis tolldek skal lages må meldingen inneholde referanse CRN=Godsnummer
     C                   EVAL      *IN33=*OFF
     C     XRSN          SETLL     XMLRCVF
     C     XRSN          READE     XMLRCVF                                33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XRVERD = 'CRN'
     C                   MOVEL     XRVERD        XCRNC             3
     C                   WHEN      XRNV = 'Number'
     C                   IF        XCRNC='CRN'

     C     '-'           SCAN      XRVERD        WP                2 0    41
     C  N41'/'           SCAN      XRVERD        WP                       41

     C     *IN41         IFEQ      *OFF
     C                   MOVEL     XRVERD        XCRN
     C                   EVAL      XPOS='001'
     C                   ELSE

     C     WP            SUB       1             WP1               2 0
     C     WP1           SUBST(P)  XRVERD:1      XCRN

     C     WP            ADD       1             WP2               2 0
     C     9             SUBST(P)  XRVERD:WP2    XPOS

     C                   ENDIF

     C                   LEAVE
     C                   ENDIF
     C                   ENDSL
     C     XRSN          READE     XMLRCVF                                33
     C                   ENDDO
      * HENT MELDINGS REFERANSE IMPORT
     C                   Z-ADD     1             X000_XRLEV1
     C                   Z-ADD     0             X000_XRLEV2
     C                   Z-ADD     0             X000_XRLEV3
     C                   Z-ADD     0             X000_XRLEV4
     C                   Z-ADD     0             X000_XRLEV5
     C                   Z-ADD     0             X000_XRLEV6
     C                   Z-ADD     0             X000_XRLEV7
     C                   Z-ADD     0             X000_XRLEV8
     C                   Z-ADD     0             X000_XRLEV9
     C     XMLKEY00      CHAIN     XMLRCVF                            33
     C     *IN33         CABEQ     *ON           SLSRXML0
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XRNV = 'Filing'
     C                   EXSR      SRXML101
     C                   IF        NY_HEADF='N'
     C                   IF        NY_SADH='N'
     C                   GOTO      SLSRXML0
     C                   ENDIF
     C                   ENDIF
     C                   IF        NOT %FOUND(STANDI)
     C                   GOTO      SLSRXML0
     C                   ENDIF
     C                   WHEN      XRNV = 'Shipment'
     C                   EXSR      SRXML102
     C                   IF        NOT %FOUND(STANDI)
     C                   GOTO      SLSRXML0
     C                   ENDIF
     C                   ENDSL
     C                   ADD       1             X000_XRLEV1
     C     XMLKEY00      CHAIN     XMLRCVF                            33
     C                   ENDDO

     C     SLSRXML0      ENDSR
      ***********************************************
     C     SRXML101      BEGSR
      ***********************************************

     C                   MOVE      *BLANKS       XTRM              3
     C                   MOVE      *BLANKS       XSITRID          17
     C                   MOVE      *BLANKS       XSILKT            2
     C                   MOVE      *BLANKS       XSILKA            2
     C                   MOVE      *BLANKS       XSIFT4           45
     C                   EVAL      X001_XRLEV1 = XRLEV1
     C                   Z-ADD     1             X001_XRLEV2
     C                   Z-ADD     0             X001_XRLEV3
     C                   Z-ADD     0             X001_XRLEV4
     C                   Z-ADD     0             X001_XRLEV5
     C                   Z-ADD     0             X001_XRLEV6
     C                   Z-ADD     0             X001_XRLEV7
     C                   Z-ADD     0             X001_XRLEV8
     C                   Z-ADD     0             X001_XRLEV9
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XRNV = 'ShipmentFileNumber'
     C                   EXSR      SRXML302
     C                   IF        NY_HEADF='N'
     C                   IF        NY_SADH='N'
     C                   GOTO      SLSRXML1
     C                   ENDIF
     C                   ENDIF
     C                   IF        NOT %FOUND(STANDI)
     C                   GOTO      SLSRXML1
     C                   ENDIF
     C                   WHEN      XRNV = 'ModeOfTransport'
     C                   EVAL      XTRM    = XRVERD
     C                   WHEN      XRNV = 'TransportMeansName'
     C                   EVAL      XSITRID = XRVERD
     C                   WHEN      XRNV = 'CarrierNationality'
     C                   EVAL      XSILKT  = XRVERD
     C                   WHEN      XRNV = 'CountryCode'
     c                   IF        XRPATH = '/CustomsFiling/Shipment/Housebill/+
     c                                       /Origin'
     C                   EVAL      XSILKA  = XRVERD
     C                   ENDIF
     C                   WHEN      XRNV   = 'TransportUnits'
     C                   EXSR      TransU
     C                   ENDSL
     C                   ADD       1             X001_XRLEV2
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   ENDDO
     C     SLSRXML1      ENDSR
      ***********************************************
     C     SRXML102      BEGSR
      ***********************************************
     C                   EVAL      X001_XRLEV1 = XRLEV1
     C                   Z-ADD     1             X001_XRLEV2
     C                   Z-ADD     0             X001_XRLEV3
     C                   Z-ADD     0             X001_XRLEV4
     C                   Z-ADD     0             X001_XRLEV5
     C                   Z-ADD     0             X001_XRLEV6
     C                   Z-ADD     0             X001_XRLEV7
     C                   Z-ADD     0             X001_XRLEV8
     C                   Z-ADD     0             X001_XRLEV9
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XRNV = 'Housebill'
     C                   EXSR      SRXML201
     C                   LEAVE
     C                   ENDSL
     C                   ADD       1             X001_XRLEV2
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   ENDDO
     C                   EXSR      SKRIVNYSAD

     C                   ENDSR
      ***********************************************
     C     SRXML201      BEGSR
      ***********************************************
     C                   EVAL      X002_XRLEV1 = X001_XRLEV1
     C                   EVAL      X002_XRLEV2 = X001_XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0

     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * HENT INFOR. FRA <ModeOfTransport>
     C                   WHEN      XRNV = 'ModeOfTransport'                      2
     C                   EXSR      SRXML303
      * HENT INFOR. FRA <Shipper>
     C                   WHEN      XRNV = 'Shipper'                              2
     C                   EXSR      SRXML305
      * HENT INFOR. FRA <Consignee>
     C                   WHEN      XRNV = 'Consignee'                            2
     C                   EXSR      SRXML306
      * HENT INFOR. FRA <TODCode>
     C                   WHEN      XRNV = 'INCOTerms'                            2
     C                   EXSR      SRXML307
      * HENT INFOR. FRA <TotalPackages>
     C                   WHEN      XRNV = 'TotalPackages'                        2
     C                   EXSR      SRXML309
      * HENT INFOR. FRA <TotalWeight>
     C                   WHEN      XRNV = 'TotalWeight'                          2
     C                   EXSR      SRXML310
      * HENT INFOR. FRA <ValueOfGoods>
     C                   WHEN      XRNV = 'ValueOfGoods'                         2
     C                   EXSR      SRXML311
     C                   ENDSL
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E

     C     SLXML201      ENDSR
      ***********************************************
     C     SRXML302      BEGSR
      ***********************************************
     C                   EVAL      FSSOK  = XRVERD

     C                   EVAL      FSKODE = '*CR'
     C     FRISOL01K     CHAIN     FRISOL01                           33
     C                   IF        *IN33=*OFF
     C                   MOVE      FSAVD         XXAVD
     C                   MOVE      FSOPD         XXTDN
     C     XXAVD         CHAIN(N)  STANDI
     C                   IF        NOT %FOUND(STANDI)
     C                   GOTO      SLXML302
     C                   ENDIF
     C     SADHK         CHAIN(N)  HEADF                              33
     C                   ENDIF

      * HEADF finnes ikke fra før
     C                   IF        *IN33
     C                   MOVE      'J'           NY_HEADF          1
     C                   EXSR      HENTTELL
     C                   EVAL      SIDP   = 40
     C                   EVAL      SITRID = XSITRID
     C                   EVAL      SILKT  = XSILKT
     C                   IF        XSILKA <> *BLANKS
     C                   EVAL      SILKA  = XSILKA
     C                   END
     C                   IF        XCRN <> *BLANKS
     C                   MOVE      'J'           NY_SADH
     C                   ENDIF
      * HEADF finnes fra før
     C                   ELSE
     C                   MOVE      'N'           NY_HEADF          1
     C                   MOVE      FSAVD         XXAVD
     C                   MOVE      FSOPD         XXTDN
      * Finnes SADH ?
     C                   MOVE      'J'           NY_SADH           1
     C     SADHK         CHAIN     SADHTST
     C                   IF        %FOUND(SADHTST)
     C                   MOVE      'N'           NY_SADH           1
     C                   ENDIF
     C
     C                   END
      * Ordne med gods og posisjonsnummer
      * 1 Finnes allerede på HEADF
     C                   IF        NY_HEADF='N'
      * Allerede fixet i og med chain til HEADF, ligger i DS i starten
     C                   ENDIF
      * 2 Kommer i filen
     C                   IF        NY_HEADF='J'
     C                   IF        XCRN <> *BLANKS
     C                   MOVEL     XCRN          SIGN
     C                   MOVEL     XPOS          SIPOS
     C                   IF        XPOS = *BLANKS
     C                   EVAL      XPOS='001'
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * 3 Må lages nytt godsnummer
     C                   IF        NY_HEADF='J'
     C                   IF        XCRN = *BLANKS
     C                   EXSR      LAGGN
     C                   ENDIF
     C                   ENDIF

     C     SLXML302      ENDSR
      ***********************************************
     C     SRXML303      BEGSR
      ***********************************************
     C                   SELECT
     C                   WHEN      XRVERD = '1'
     C                   MOVE      '1'           SIKDC
     C                   EVAL      SITRM  = 10
     C                   WHEN      XRVERD = '4'
     C                   MOVE      '0'           SIKDC
     C                   EVAL      SITRM  = 40
     C                   WHEN      XRVERD = '3'
     C                   MOVE      '0'           SIKDC
     C                   EVAL      SITRM  = 30
     C                   ENDSL

     C                   ENDSR
      ***********************************************
     C     SRXML305      BEGSR
      ***********************************************
      * INFOR. FRA <Shipper>

     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0

     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'AccountNumber'                        2
     C                   WHEN      XRNV = 'Name'                                 2
     C                   EVAL      SINAS  = XRVERD
     C                   WHEN      XRNV = 'Address'                              2
     C                   EXSR      SRXMLSHIPP
     C                   ENDSL                                                   2<-E

     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C                   EVAL      X003_XRLEV5 = 0
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E

     C     KODTS2K       CHAIN     KODTS2                             33
     C                   SELECT
     C                   WHEN      *IN33
     C                   EVAL      SIDTY  = *BLANKS
     C                   WHEN      KS2PRE = 'A' OR KS2PRE = 'B' OR KS2PRE = 'C'
     C                   EVAL      SIDTY  = 'EU'
     C                   OTHER
     C                   EVAL      SIDTY  = 'IM'
     C                   ENDSL

     C                   ENDSR
      ***********************************************
     C     SRXML306      BEGSR
      ***********************************************
      * INFOR. FRA <Consignee>
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0

     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'AccountNumber'                        2
     C                   EVAL      XSYPAID='CWACC'
     C                   MOVEL     XRVERD        XSYVRDA
     C     SYPARKEY      CHAIN     SYPARL3
     C                   IF        %FOUND(SYPARL3)
     C                   EVAL      SIKNK=SYKUNR
     C                   ELSE
     C                   EXSR      NYTTKNR
     C                   EVAL      SIKNK=SYKUNR
     C                   ENDIF
     C                   WHEN      XRNV = 'Name'                                 2
     C                   EVAL      SINAK  = XRVERD
     C                   WHEN      XRNV = 'Address'
     C                   EXSR      SRXMLCONSI
     C                   WHEN      XRNV = 'TaxID'
     C                   EVAL      WSIRG14=XRVERD
     C                   IF        WSIRG2='NO'
     C                   EVAL      SIRG = WSIRG9
     C                   ELSE
     C                   EVAL      SIRG = WSIRG9B
     C                   ENDIF
     C                   WHEN      XRNV = 'Contact'                              2
     C                   EXSR      SRXML306A
     C                   WHEN      XRNV = 'VATNumber'                            2
     C                   EVAL      SIRG   = XRVERD
     C                   WHEN      XRNV = 'RegistrationNumber'                   2
     C                   EVAL      SIRG   = XRVERD
     C                   WHEN      XRNV = 'CustomsAccountNumber'                 2
     C                   MOVEL     XRVERD        XCHKTAL
     C                   MOVE      *ZEROS        XNR08             8 0
     C                   MOVE      *ZEROS        XNR01             1 0
     C     1             DO        10            XN                               3<-B
     C                   IF        XCT(XN) >= '0' AND XCT(XN) <= '9'               4<-B
     C                   MULT      10            XNR08
     C                   MOVE      XCT(XN)       XNR08
     C                   ADD       1             XNR01
     C                   IF        XNR01 = 8                                        5<-B
     C                   LEAVE
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   ENDDO                                                    3<-E
     C                   MOVE      XNR08         SIKT8
     C                   IF        SIKTC = '0' AND XNR01 < 8                      3<-B
     C                   MOVE      ' '           SIKTC
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E

     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C                   EVAL      X003_XRLEV5 = 0
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E

     C                   ENDSR
      ***********************************************
     C     SRXML306A     BEGSR
      ***********************************************
     C                   EVAL      X003_XRLEV4 = XRLEV4

     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Name'                                 2
     C                   WHEN      XRNV = 'Phone'                                2
     C                   ENDSL                                                   2<-E

     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E

     C                   ENDSR
      ***********************************************
     C     SRXML307      BEGSR
      ***********************************************
      * INFOR. FRA <TODCode>
     C                   EVAL      SILV   = XRVERD

     C     KODTLBK       CHAIN     KODTLB                             33
     C                   SELECT
     C                   WHEN      *IN33
     C                   EVAL      SILVT  = *BLANKS
     C                   WHEN      KLBHAD = 'A'
     C                   EVAL      SILVT  = SIADS3
     C                   WHEN      KLBHAD = 'M'
     C                   EVAL      SILVT  = SIADK3
     C                   ENDSL

     C                   ENDSR
      ***********************************************
     C     SRXML309      BEGSR
      ***********************************************
      * INFOR. FRA <NumberOfPackages>
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SINTK

     C                   ENDSR
      ***********************************************
     C     SRXML310      BEGSR
      ***********************************************
      * INFOR. FRA <GrossWeight>
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SIVKB

     C                   ENDSR
      ***********************************************
     C     SRXML311      BEGSR
      ***********************************************
      * INFOR. FRA <ValueOfGoods>
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 0
     C                   EVAL      X003_XRLEV5 = 0

     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'ValueOfGoods'                         2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SIBEL3
     C     XMLRCAFK      CHAIN     XMLRCAF
     C                   IF        %FOUND
     C                   IF        XRATN = 'currencycode'
     C                   EVAL      SIVAL3 = XRATV
     C                   ENDIF
     C                   ENDIF
     c                   move      sival3        TRVERV
     C     KODTVAL2K3    SETGT     KODTVAL2
     C     SIVAL3        READPE    KODTVAL2                               33
     C* N33              MOVE      KVAOMR        XOMRF             3 0
     C* N33              MOVE      KVAKRS        SIVKU
     C                   ENDSL                                                   2<-E

     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E

     c                   z-add     sibel3        TRVERB
     C                   ENDSR
      ***********************************************
     C     SKRIVNYSAD    BEGSR
      ***********************************************
     C                   MOVE      'N'           WHEPK4            1
     C                   IF        NY_SADH='J'
     C                   IF        XCRN <> *BLANKS
     C                   MOVE      *ZEROS        SIKDH
     C                   MOVE      *BLANKS       SIKDTR
     C                   MOVE      *ZEROS        SIAS
     C                   MOVE      *BLANKS       SIVALR
     C                   MOVE      *ZEROS        SIBELR
     C                   MOVE      *ZEROS        SIBELS
     C                   MOVE      *ZEROS        SIMP
     C                   MOVE      *BLANKS       SIDTØ
     C                   MOVE      *BLANKS       SI0035

     C                   IF        SISG = *BLANKS
     C                   MOVE      'CW1'         SISG
     C                   ENDIF
     C                   IF        SITARF = *BLANKS
     C     KODTSIK       CHAIN     KODTSI                             33
     C                   EVAL      SITARF = KSINAV
     C                   ENDIF
     C                   MOVE      ' '           SIUR
     C                   MOVE      ' '           SIST
     C                   MOVE      SIVAL2        SIVALB
     C                   MOVE      *ZEROS        SIBELC
     C                   MOVE      *ZEROS        SIRAB
     C                   EVAL      SIKDLS='A '

     C                   IF        SIKNK <> 0
     C     CUNDL01K      CHAIN(N)  CUNDL01
     C                   IF        %FOUND(CUNDL01)
     C                   IF        SIKTB = *ZEROS
     C                   MOVEL     SYKONT        SIKTA
     C                   MOVE      SYKONT        SIKTB
     C                   MOVE      SYFR02        SIKTC
     C                   ENDIF
     C                   IF        SYRG <>' '
     C                   IF        SYMVJN='J'
     C                   EVAL      SIKDLS='A8'
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF

     C                   WRITE     SADHR
     C                   EVAL      NY_SADH='N'
     C                   MOVE      'J'           WHEPK4            1
     C                   IF        NY_HEADF='N'
     C     SADHK         CHAIN     HEADF
     C                   IF        %FOUND(HEADF)
     C                   EVAL      HEPK4='J'
     C                   UPDATE    HEADFR
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * OPPDATER KUNDE HVIS DET IKKE FINNES I KUNDEREGISTER
     C                   IF        SIKNK <> 0
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   IF        *IN33
     C                   CLEAR                   KUNDR
     C                   MOVEL     'A'           AKTKOD
     C                   MOVEL     FIFIRM        FIRMA
     C                   Z-ADD     SIKNK         KUNDNR
     C                   MOVEL     SINAK         KNAVN
     C                   EVAL      SYLAND = XSELKA2
     C                   MOVEL     SIADK1        ADR1
     C                   MOVEL     SIADK2        ADR2
     C                   IF        SYLAND = 'NO' or SYLAND = '  '
N23  C                   MOVEL     SIADK3        POSTNR
     C                   ELSE
N23  C                   MOVEL     SIADK3        SYPOGE
     C                   ENDIF
N23  C                   EVAL      ADR3  = %SUBST(SIADK3:6:24)
     C                   MOVEL     SINAK         SONAVN
     C                   MOVEL     SIKTA         SYKONT
     C                   MOVE      SIKTB         SYKONT
     C                   MOVE      SIKTC         SYFR02
     C                   MOVEL     SIRG          SYRG
     C                   EVAL      BETBET='D0'
     C                   EVAL      SYMVJN='N'
     C                   WRITE     KUNDR
     C                   ELSE
     C*                  MOVEL     SINAK         KNAVN
     C*                  MOVEL     SIADK1        ADR1
     C*                  MOVEL     SIADK2        ADR2
     C*                  MOVEL     SIADK3        ADR3
     C*                  MOVEL     SINAK         SONAVN
     C                   UPDATE    KUNDR
     C                   END
     C                   END

     C                   IF        NY_HEADF='J'
     C                   SELECT
     C                   WHEN      XDEPART = 'FIA'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'FOI'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'FPI'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'PIA'
     C                   EVAL      HEUR   = 'C'
     C                   WHEN      XDEPART = 'FIS'
     C                   EVAL      HEUR   = 'F'
     C                   WHEN      XDEPART = 'FFI'
     C                   EVAL      HEUR   = 'F'
     C                   WHEN      XDEPART = 'FLI'
     C                   EVAL      HEUR   = 'F'
     C                   ENDSL
     C                   EVAL      HERFA  = FSSOK
     C                   EVAL      HERFK  = FSSOK
     C                   EVAL      HEKDFS = 'X'
     C                   EVAL      HEOT   = '0 '
     C                   IF        SIKDC  = '1'
     C                   EVAL      HETRCN = SITRID
     C                   EVAL      HETRC  = 1
     C                   ELSE
     C                   EVAL      HETRC  = 0
     C                   END
     C                   EVAL      TRVERV=SIVAL3
     C                   EVAL      TRVERB=SIBEL3
     C                   MOVE      'X'           hekdpl
     C                   MOVE      WHEPK4        hepk4
     C                   MOVE      XHAWB         HEHAWB
     C                   MOVE      'CW1'         HESG
     C                   EVAL      HEKDL='A '
     C                   IF        SYRG <>' '
     C                   IF        SYMVJN='J'
     C                   EVAL      HEKDL='A8'
     C                   ENDIF
     C                   ENDIF
     C                   WRITE     hEADFR
     C                   ENDIF

     C     1             CHAIN     EDIC                               20
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   EVAL      M0004  = S0004
     C                   EVAL      M0010  = S0010
     C                   EVAL      M0035  = S0035
     C                   EVAL      M0062  = S0020
     C                   EVAL      M0065  = 'XMLCW '
     C                   EVAL      M0068  = FSSOK
     C                   EVAL      M1001  = 'XML'
     C                   EVAL      M1225  = 'IMP'
     C                   EVAL      MSN    = SSN
     C                   EVAL      MMN    = CMN
     C                   EVAL      MSR    = SSR
     C                   EVAL      MST    = 'C'
     C                   EVAL      M1N07  = 'CW '
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   EVAL      MAVD   = SIAVD
     C                   EVAL      MTDN   = SITDN
     C                   WRITE     EDIMR

     C                   ENDSR
      ***********************************************
     C     KNVTAL        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTAL
     C     1             DO        15            XN                3 0          1<-B
     C                   IF        XT(XN) = *BLANKS OR XT(XN) = '.'              2<-B
     C                             OR XT(XN) < '0' OR XT(XN) > '9'
     C                   LEAVE
     C                   ENDIF                                                   2<-E
     C                   MULT      10            XTALH
     C                   MOVE      XT(XN)        XTALH
     C                   ENDDO                                                  1<-E

     C                   IF        XT(XN) = '.'                                 1<-B
     C                   ADD       1             XN
     C                   MOVE      XT(XN)        XTALD1
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                 2<-B
     C                   MOVE      XT(XN)        XTALD2
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                  3<-B
     C                   MOVE      XT(XN)        XTALD3
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E

     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    USN               9

     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    SIKNK
     C     SADHK         KLIST
     C                   KFLD                    XXAVD
     C                   KFLD                    XXTDN
     C     FRISOL01K     KLIST
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
     C     KODTLBK       KLIST
     C                   KFLD                    KLBUNI
     C                   KFLD                    SILV
     C     KODTSIK       KLIST
     C                   KFLD                    KSIUNI
     C                   KFLD                    SISG
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    SILKA
     C     KODTVAL2K3    KLIST
     C                   KFLD                    SIVAL3
     C                   KFLD                    WDT08
     C     XMLKEY00      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X000_XRLEV1
     C                   KFLD                    X000_XRLEV2
     C                   KFLD                    X000_XRLEV3
     C                   KFLD                    X000_XRLEV4
     C                   KFLD                    X000_XRLEV5
     C                   KFLD                    X000_XRLEV6
     C                   KFLD                    X000_XRLEV7
     C                   KFLD                    X000_XRLEV8
     C                   KFLD                    X000_XRLEV9
     C     XMLKEY01      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X001_XRLEV1
     C                   KFLD                    X001_XRLEV2
     C                   KFLD                    X001_XRLEV3
     C                   KFLD                    X001_XRLEV4
     C                   KFLD                    X001_XRLEV5
     C                   KFLD                    X001_XRLEV6
     C                   KFLD                    X001_XRLEV7
     C                   KFLD                    X001_XRLEV8
     C                   KFLD                    X001_XRLEV9
     C     XMLKEY02      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X002_XRLEV1
     C                   KFLD                    X002_XRLEV2
     C                   KFLD                    X002_XRLEV3
     C                   KFLD                    X002_XRLEV4
     C     XMLKEY03      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEY031     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C     XMLKEY032     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C                   KFLD                    X003_XRLEV6
     C     XMLKEY033     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLRCAFK      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    XRLEV1
     C                   KFLD                    XRLEV2
     C                   KFLD                    XRLEV3
     C                   KFLD                    XRLEV4
     C                   KFLD                    XRLEV5
     C                   KFLD                    XRLEV6
     C     SYPARKEY      KLIST
     C                   KFLD                    XSYPAID
     C                   KFLD                    XSYVRDA

     C     *LIKE         DEFINE    SITRID        XTRID
     C     *LIKE         DEFINE    XRLEV1        X000_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X000_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X000_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X000_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X000_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X000_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X000_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X000_XRLEV8
     C     *LIKE         DEFINE    XRLEV9        X000_XRLEV9
     C     *LIKE         DEFINE    XRLEV1        X001_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X001_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X001_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X001_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X001_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X001_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X001_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X001_XRLEV8
     C     *LIKE         DEFINE    XRLEV9        X001_XRLEV9
     C     *LIKE         DEFINE    XRLEV1        X002_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X002_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X002_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X002_XRLEV4
     C     *LIKE         DEFINE    XRLEV1        X003_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X003_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X003_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X003_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X003_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X003_XRLEV6
     C     *LIKE         DEFINE    XRLEV1        X102_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X102_XRLEV2
     C     *LIKE         DEFINE    XRNV          X001_XRNV
     C     *LIKE         DEFINE    SVAVD         XSVAVD
     C     *LIKE         DEFINE    SVTDN         XSVTDN
     C     *LIKE         DEFINE    SYPAID        XSYPAID
     C     *LIKE         DEFINE    SYVRDA        XSYVRDA
     C     *LIKE         DEFINE    SYRECN        XSYRECN
     C     *LIKE         DEFINE    HEAVD         XXAVD
     C     *LIKE         DEFINE    SITDN         XXTDN

     C                   MOVE      USN           XRSN
     C                   MOVE      'LB'          KLBUNI
     C                   MOVE      'SI'          KSIUNI
     C                   MOVE      'S2 '         KS2UNI

     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT08             8 0

     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     XRSN          CHAIN     EDIS                               33

     C                   ENDSR
     C***********************************************
     C     HENTTELL      BEGSR
     C***********************************************
     C                   SELECT

     C                   WHEN      XBRANCH = 'BGO'
     C                   SELECT
     C                   WHEN      XDEPART = 'FIA'
     C                   EVAL      XXAVD=511
     C                   WHEN      XDEPART = 'FOI'
     C                   EVAL      XXAVD=511
     C                   WHEN      XDEPART = 'FPI'
     C                   EVAL      XXAVD=511
     C                   ENDSL

     C                   WHEN      XBRANCH = 'OSL'
     C                   SELECT
     C                   WHEN      XDEPART = 'FIA'
     C                   EVAL      XXAVD=221
     C                   WHEN      XDEPART = 'FOI'
     C                   EVAL      XXAVD=221
     C                   WHEN      XDEPART = 'FPI'
     C                   EVAL      XXAVD=221
     C                   WHEN      XDEPART = 'FIS'
     C                   EVAL      XXAVD=271
     C                   WHEN      XDEPART = 'FFI'
     C                   EVAL      XXAVD=271
     C                   WHEN      XDEPART = 'FLI'
     C                   EVAL      XXAVD=271
     C                   WHEN      XDEPART = 'PIA'
     C                   EVAL      XXAVD=221
     C                   ENDSL
     C                   ENDSL
     C*                  EVAL      XXAVD=9911

     C                   IF        XXAVD=221
     C     3             SUBST(P)  XMAWB:1       XMAWB3            3
     C                   IF        XMAWB3='TRK' or XMAWB3='R04' or XMAWB3='R40'
     C                   EVAL      XXAVD=211
     C                   ENDIF
     C                   ENDIF


     C     XXAVD         CHAIN     STANDI                             33
     C                   IF        %FOUND(STANDI)
     C                   MOVE      SITDN         XSITDN            7 0
     C                   ADD       1             SITDN
     C                   UPDATE    STANDIR
     C                   ENDIF
     C                   EVAL      SITARF = *BLANKS
     C                   MOVE      XSITDN        SITDN
     C                   MOVE      *BLANKS       SIST
     C                   MOVE      WDT           SIDT
     C                   WRITE     FRISOKR
     C     *LIKE         DEFINE    FSSOK         WFSSOK
     C                   EVAL      WFSSOK=FSSOK
      * Skriv Cargowise referanse
     C                   EVAL      FSKODE='CW1'
     C                   WRITE     FRISOKR
      * Skriv HAWB nummer
     C                   EVAL      FSKODE='HWB'
     C                   EVAL      FSSOK=*BLANKS
     C                   EVAL      FSSOK=XHAWB
     C                   WRITE     FRISOKR
      * Skriv MAWB nummer
     C                   EVAL      FSKODE='MWB'
     C                   EVAL      FSSOK=*BLANKS
     C                   EVAL      FSSOK=XMAWB
     C                   WRITE     FRISOKR
      * Still tilbake fskode
     C                   EVAL      FSKODE='*CR'
     C                   EVAL      FSSOK=WFSSOK

     C                   ENDSR
      ***********************************************
     C     Transu        BEGSR
      ***********************************************
     C                   EVAL      X002_XRLEV1 = X001_XRLEV1
     C                   EVAL      X002_XRLEV2 = X001_XRLEV2
     C                   EVAL      X002_XRLEV3 = 3
     C                   EVAL      X002_XRLEV4 = 1

     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF
     C                   SELECT

     C                   WHEN      XRNV = 'TransportUnitID'
     C                   EVAL      XSIFT4 = XRVERD
     C                   LEAVE
     C                   ENDSL
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO

     C                   ENDSR
      ***********************************************
     C     SRXMLshipp    BEGSR
      ***********************************************
     C                   EVAL      X003_XRLEV4 = XRLEV4

     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XRNV = 'AddressLine1'
     C                   EVAL      SIADS1 = XRVERD
     C                   WHEN      XRNV = 'PostalCode'
     C                   EVAL      SIADS3 = XRVERD
     C                   WHEN      XRNV = 'City'
     C                   IF        SIADS3 = *BLANKS                               3<-B
     C                   EVAL      SIADS3 = XRVERD
     C                   ELSE                                                     3
     C                   CAT       XRVERD:1      SIADS3
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'CountryCode'
     C                   IF        XSILKA = *BLANKS                               3<-B
     C                   EVAL      SILKA  = XRVERD
     C                   END                                                      3<-E
     C                   ENDSL

     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO

     C                   ENDSR
      ***********************************************
     C     SRXMLconsi    BEGSR
      ***********************************************
     C                   EVAL      X003_XRLEV4 = XRLEV4

     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XRNV = 'AddressLine1'
     C                   EVAL      SIADK1 = XRVERD
     C                   WHEN      XRNV = 'PostalCode'
     C                   EVAL      SIADK3 = XRVERD
     C                   WHEN      XRNV = 'City'
     C                   IF        SIADK3 = *BLANKS                               3<-B
     C                   EVAL      SIADK3 = XRVERD
     C                   ELSE                                                     3
     C                   CAT       XRVERD:1      SIADK3
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'CountryCode'
     C                   MOVEL     XRVERD        XSELKA2           2
     C                   ENDSL

     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO

     C                   ENDSR
      *______________________________________________
      * Hent nytt kundenummer                 NYTTKNR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     NyttKnr       BEGSR
      * Hent neste ledige kundenummer
     C     FIFIRM        CHAIN     FIRKU
     C                   IF        %FOUND(FIRKU)
     C                   EVAL      SIKNK=FIKUNE
     C                   ADD       1             FIKUNE
     C                   UPDATE    FIRKUR
     C                   ENDIF
      * Hent recordnumber til SYPARF
     C     'SYPAR   '    CHAIN     TELLGE
     C                   IF        %FOUND(TELLGE)
     C                   MOVE      GENO          XSYRECN
     C                   ADD       1             GENO
     C                   UPDATE    TELLGER
     C                   ENDIF
      * Skriv til SYPARF
     C                   CLEAR                   SYPARFR
     C                   EVAL      SYRECN=XSYRECN
     C                   EVAL      SYPAID='CWACC'
     C                   EVAL      SYVRDA=XSYVRDA
     C                   EVAL      SYKUNR=SIKNK
     C                   WRITE     SYPARFR
     C                   ENDSR
      *______________________________________________
      * Lag nytt godsnummer                     LAGGN
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     LAGGN         BEGSR
      * Hvis dette er en master kan det allerede finnes et godsnummer.
     C                   IF        XMAWB <> *BLANKS
     C     XMAWB         CHAIN     SYXML44F
     C                   IF        %FOUND(SYXML44F)
     C                   ADD       1             CW1POS
     C                   UPDATE    SYXML44FR
     C                   MOVEL     CW1GNR        SIGN
     C                   MOVEL     CW1POS        SIPOS
     C                   GOTO      LAGGN1
     C                   ENDIF
     C                   ENDIF
     C                   IF        XXAVD=511
     c                   goto      laggn9
     C                   endif
      * Lag helt nytt gods og posnr
     C                   IF        XMAWB <> *BLANKS
     C                   MOVEL     XMAWB         UTURN
     C                   MOVEL     XMAWB         UKJENN
     C                   MOVEL     XMAWB         UMRN
     C                   ELSE
     C                   MOVEL     XSHPNBR       UTURN
     C                   MOVEL     XSHPNBR       UKJENN
     C                   MOVEL     XSHPNBR       UMRN
     C                   ENDIF
     C                   CALL      'SYXML46NOI'
     C                   PARM      XXAVD         UAVD              4 0
     C                   PARM      'CW1'         USIGN             3
     C                   PARM      WDT08         UDATO             8 0
     C                   PARM                    UGRENSP          20
     C                   PARM                    UTURN            17
     C                   PARM                    UKJENN           13
     C                   PARM                    UMRN             20
     C                   PARM                    UGODSN           15
     C                   PARM                    UERRORC           1
     C                   MOVEL     UGODSN        SIGN
     C                   MOVEL     '001'         SIPOS
     C                   IF        XMAWB <> *BLANKS
     C                   MOVEL     XMAWB         CW1MAWB
     C                   MOVEL     SIGN          CW1GNR
     C                   EVAL      CW1POS=1
     C                   WRITE     SYXML44FR
     C                   ENDIF
      * Lag retur til CW1 inneholdende Gods og posnr
     C     LAGGN1        TAG
     C                   CALL      'SYXML47NOI'
     C                   PARM                    XSHPNBR
     C                   PARM                    SIGN
     C                   PARM                    SIPOS
     C     LAGGN9        ENDSR
