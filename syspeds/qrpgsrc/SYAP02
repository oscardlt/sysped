      *
     FA4ARK     O    F   90        PRINTER
     D                 DS
     D  XARKB                  5      6  0
     D  XARKH                  8      9  0
     D  XARK                   1     10
     D                 DS
     D  XPAR1H                 1      2  0
     D  XPAR1D                 4      5  0
     D  XPAR2H                 7      8  0
     D  XPAR2D                10     11  0
     D  XPAR                   1     11
     C*
     C     TAGB1         TAG
     C                   EXSR      INIT
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C* KALLES KUN EN GANG
     C*
     C                   MOVEL     '0,0,  , '    XARK
     C                   MOVE      ','           XARK
     C* ZARKB              =    ARKBREDDE I TOMMER     (2,0)
     C* ZARKH              =    ARKHØYDE  I TOMMER     (2,0)
     C                   Z-ADD     12            XARKH
     C                   Z-ADD     9             XARKB
     C                   MOVEL     'A4ARK   '    XFNAME
     C                   MOVEL     '  .  ,  '    XPAR
     C                   MOVE      '.  '         XPAR
     C*
     C*
     C*
     C                   EXSR      PRINT
     C     UTI           ENDSR
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C*
     C                   EXSR      ZSTART
     C*
     C* TEGNE SIRKEL
     C                   EXSR      ZSIRK
     C                   EXSR      ZSLUTT
     C*
     C                   ENDSR
     C*
     C********************************************************************D260
     C     ZSTART        BEGSR
     C********************************************************************
     C                   EXCEPT    PR
     C*
     C*  ZSTART - DEFINERER ARKET UTSEENDE
     C*
     C                   MOVEL     'BEGSEG  '    XOPTIO            8
     C                   MOVEL     XARK          XPARM            80
     C*
     C                   EXSR      ZROUT
     C*
     C                   ENDSR
     C*
     C*
     C*
     C******************************************
     C     ZPOS1         BEGSR
     C******************************************
     C*
     C* PARAMETER 1 = TOMMER FRA VENSTRE
     C* PARAMETER 2 = TOMMER UNDENIFRA
     C*
     C                   MOVEL     'POSITION'    XOPTIO
     C                   MOVE      05            XPAR1H
     C                   MOVE      35            XPAR1D
     C                   MOVE      09            XPAR2H
     C                   MOVE      25            XPAR2D
     C                   EXSR      ZROUT
     C                   ENDSR
     C*
     C*
     C******************************************
     C     ZPOS2         BEGSR
     C******************************************
     C*
     C* PARAMETER 1 = TOMMER FRA VENSTRE
     C* PARAMETER 2 = TOMMER UNDENIFRA
     C*
     C                   MOVEL     'POSITION'    XOPTIO
     C                   MOVE      05            XPAR1H
     C                   MOVE      30            XPAR1D
     C                   MOVE      09            XPAR2H
     C                   MOVE      65            XPAR2D
     C                   EXSR      ZROUT
     C*
     C                   ENDSR
     C*
     C******************************************
     C     ZSLUTT        BEGSR
     C*
     C* AVSLUTTER UTSKRIFT PÅ SIDEN
     C*
     C******************************************
     C*
     C* FORTELLER AT DET ER SLUTT PÅ IPDF
     C*
     C                   MOVEL     'ENDSEG  '    XOPTIO
     C                   MOVEL     *BLANKS       XPARM
     C                   EXSR      ZROUT
     C                   EXCEPT    DETAPF
     C                   ENDSR
     C*
     C********************************************************************
     C     ZROUT         BEGSR
     C********************************************************************
     C*
     C* KALLER ASSEMBLERRUTINE FOR IPDF
     C*
     C                   CALL      'SUBR51'
     C                   PARM                    XFNAME            8
     C                   PARM                    XOPTIO
     C                   PARM                    XPARM
     C                   PARM                    XRTCDE            2
     C                   MOVE      *BLANKS       XPARM
     C*
     C                   ENDSR
     C*
     C*
     C******************************************
     C     ZSIRK         BEGSR
     C*
     C*
     C******************************************
     C*
     C*
     C                   MOVEL     'MARKTYPE'    XOPTIO
     C                   MOVE      *BLANKS       XPARM
     C                   MOVEL     'CIRCLE'      XPARM
     C                   EXSR      ZROUT
     C                   EXSR      ZPOS1
     C*
     C                   MOVEL     'MARKER  '    XOPTIO
     C                   MOVE      *BLANKS       XPARM
     C                   EXSR      ZROUT
     C                   EXSR      ZPOS2
     C*
     C                   MOVEL     'CIRCLE  '    XOPTIO
     C                   MOVE      *BLANKS       XPARM
     C                   MOVEL     '0.75  '      XPARM
     C                   EXSR      ZROUT
     C                   ENDSR
     C*
     O*
     O* UTLISTING FOR 4224-PRINTER
     O*
     OA4ARK     E            DETAPF
     OA4ARK     E            PR
     O                                            1 '.'
