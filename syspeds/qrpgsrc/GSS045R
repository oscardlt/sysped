     D TABÅR           S              4  0 DIM(67) CTDATA PERRCD(1)
     D TABUKEDAG       S              1  0 DIM(67) ALT(TABÅR)
     D JULDATO         S               D   DATFMT(*JUL)
     D DAG1            S              3  0
     D UKENR           S              2  0
      *
     D                 DS
     D  DATO                   1      8  0
     D  ÅR                     1      4  0
     D  MND                    5      6  0
     D  DAG                    7      8  0
      *
     C     *ENTRY        PLIST
     C                   PARM                    UDT               8
     C                   PARM                    UUKEDAG           1
     C                   PARM                    UUKENR            2
     C                   PARM                    UUJULDAG          3
      *
     C                   MOVE      UDT           DATO
     C     *YMD          MOVE      DATO          JULDATO
     C                   MOVE      JULDATO       JULDAG2           6
     C                   MOVE      JULDAG2       JULDAG            3 0
     C                   MOVE      JULDAG        UUJULDAG          3
     C     ÅR            LOOKUP    TABÅR         TABUKEDAG                33
     C                   EVAL      DAG1 = JULDAG - TABUKEDAG
     C                   IF        DAG1 <= 0
      * Nå er vi i begynnelse av året. Enten uke 1 eller 52 eller 53.
     C                   SELECT
     C                   WHEN      TABuKEDAG < 5
     C                   EVAL      UKENR = 1
     C                   WHEN      TABuKEDAG = 5
     C                   EVAL      UKENR = 53
     C                   OTHER
     C                   EVAL      UKENR = 52
     C                   ENDSL
     C                   ELSE
     C                   IF        TABUKEDAG < 5
     C                   EVAL      UKENR = (JULDAG - (9 - TABUKEDAG)) / 7 + 2
     C                   ELSE
     C                   EVAL      UKENR = (JULDAG - (9 - TABUKEDAG)) / 7 + 1
     C                   ENDIF
     C                   ENDIF
      *
     C     JULDAG        ADD       TABUKEDAG     XDAG              3 0
     C                   SUB       1             XDAG
     C     XDAG          DIV       7             UKEDAG            3 0
     C                   MULT      7             UKEDAG
     C                   EVAL      UKEDAG=XDAG-UKEDAG
     C                   IF        UKEDAG=0
     C                   EVAL      UKEDAG=7
     C                   ENDIF
      *
     C                   MOVE      UKENR         UUKENR
     C                   MOVE      UKEDAG        UUKEDAG
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
**
19847
19852
19863
19874
19885
19897
19901
19912
19923
19935
19946
19957
19961
19973
19984
19995
20006
20011
20022
20033
20044
20056
20067
20071
20082
20094
20105
20116
20127
20132
20143
20154
20165
20177
20181
20192
20203
20215
20226
20237
20241
20253
20264
20275
20286
20291
20302
20313
20324
20336
20347
20351
20362
20374
20385
20396
20407
20412
20423
20434
20445
20457
20461
20472
20483
20495
20506
