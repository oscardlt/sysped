/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 YBC PTF10 NYTT PARAMETER INTEG                               */
/* 10XXX * 02 YBC PTF10 LAGRE UTSKRIFT I PDF-FORMAT PÅ MAPPE /pdf/SSPLUKKLISTE*/
/* ********************************************************************    */
/* 11XXX * 03 YBC PTF11 ARC006 HAR FÅTT NYE PARAMETRE                      */
/* 11XXX * 04 YBC PTF11 AVSENDERS EPOSTADRESSE.                            */
/* 11XXX * 05 SH  PTF11 ARC006 flere parametre og nå 80 lange CVP          */
/* ********************************************************************    */
/*E01+E04*/  PGM        PARM(&KEY2 &WSUSER &WSKDB &WSNAB &WSSTD +
                          &MAIXAVS &MAIX1 &MAIX2 &MAIX3 &MAIX4 &MAIX5 +
                          &WSNEDDT &WSSHCO &END &INTEG)
             DCL        VAR(&KEY2) TYPE(*CHAR) LEN(30)
             DCL        VAR(&WSUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&WSKDB) TYPE(*CHAR) LEN(5)
             DCL        VAR(&WSNAB) TYPE(*CHAR) LEN(30)
             DCL        VAR(&WSSTD) TYPE(*CHAR) LEN(5)
/*N04*/      DCL        VAR(&MAIXAVS) TYPE(*CHAR) LEN(51)
             DCL        VAR(&MAIX1) TYPE(*CHAR) LEN(51)
             DCL        VAR(&MAIX2) TYPE(*CHAR) LEN(51)
             DCL        VAR(&MAIX3) TYPE(*CHAR) LEN(51)
             DCL        VAR(&MAIX4) TYPE(*CHAR) LEN(51)
             DCL        VAR(&MAIX5) TYPE(*CHAR) LEN(51)
/*N04*/      DCL        VAR(&MAILAVS) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MAIL1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MAIL2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MAIL3) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MAIL4) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MAIL5) TYPE(*CHAR) LEN(50)
             DCL        VAR(&WSNEDDT) TYPE(*CHAR) LEN(10)
             DCL        VAR(&WSSHCO) TYPE(*CHAR) LEN(541)
/*N01*/      DCL        VAR(&INTEG) TYPE(*CHAR) LEN(6)
             DCL        VAR(&END) TYPE(*CHAR) LEN(1)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&EMNE) TYPE(*CHAR) LEN(44)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
             DCL        VAR(&MANAUT) TYPE(*CHAR) LEN(1) VALUE('M')
             DCL        VAR(&IE) TYPE(*CHAR) LEN(1) VALUE('E')
             DCL        VAR(&EPO50) TYPE(*CHAR) LEN(50)
/*N03*/      DCL        VAR(&FLERE) TYPE(*CHAR) LEN(1)
/*N03*/      DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
/*N03*/      DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
/*N03*/      DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
/*N03*/      DCL        VAR(&KN) TYPE(*CHAR) LEN(8)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP9) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP10) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP11) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP12) TYPE(*CHAR) LEN(80)
             DCL        VAR(&BANE1) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE2) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE3) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE4) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE5) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE6) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE7) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE8) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE9) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN10) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN11) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN12) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN13) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN14) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN15) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN16) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN17) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN18) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN19) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN20) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN21) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN22) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN23) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN24) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN25) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN26) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN27) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN28) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN29) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN30) TYPE(*CHAR) LEN(70)
/*N02*/      DCL        VAR(&BANE) TYPE(*CHAR) LEN(70)

             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
/*N04*/      CHGVAR     VAR(&MAILAVS) VALUE(&MAIXAVS)
             CHGVAR     VAR(&MAIL1) VALUE(&MAIX1)
             CHGVAR     VAR(&MAIL2) VALUE(&MAIX2)
             CHGVAR     VAR(&MAIL3) VALUE(&MAIX3)
             CHGVAR     VAR(&MAIL4) VALUE(&MAIX4)
             CHGVAR     VAR(&MAIL5) VALUE(&MAIX5)
    /*KUN FOR Å VISE VERDI I JOBBLOGG                              */
    /*       CHGJOB     LOG(4 0 *SECLVL) LOGCLPGM(*YES)            */
    /*   CHGDTAARA  DTAARA(*LDA (1 20))     VALUE(&KEY2)           */
    /*   CHGDTAARA  DTAARA(*LDA (30 10))    VALUE(&WSUSER)         */
    /*   CHGDTAARA  DTAARA(*LDA (60 5))     VALUE(&WSKDB)          */
    /*   CHGDTAARA  DTAARA(*LDA (66 30))    VALUE(&WSNAB)          */
    /*   CHGDTAARA  DTAARA(*LDA (101 50))   VALUE(&MAIL1)          */
    /*   CHGDTAARA  DTAARA(*LDA (151 50))   VALUE(&MAIL2)          */
    /*   CHGDTAARA  DTAARA(*LDA (201 50))   VALUE(&MAIL3)          */
    /*   CHGDTAARA  DTAARA(*LDA (251 50))   VALUE(&MAIL4)          */
    /*   CHGDTAARA  DTAARA(*LDA (301 50))   VALUE(&MAIL5)          */
    /*   CHGDTAARA  DTAARA(*LDA (401 541))   VALUE(&WSSHCO)        */
    /*   CHGDTAARA  DTAARA(*LDA (950 1))   VALUE(&END)             */
    /*                                                             */
             OVRPRTF    FILE(SS002PF) DEVTYPE(*AFPDS) PAGESIZE(50 +
                          115) LPI(6) CPI(10) FRONTMGN(0.14 0) +
                          OVRFLW(44) PAGRTT(*AUTO) OUTQ(SYCGIOUTQ) +
                          FORMTYPE(*STD) HOLD(*YES) SPLFOWN(*JOB)

/*E01*/      CALL       PGM(SS002PR) PARM(&KEY2 &WSUSER &WSKDB +
                          &WSNAB &WSSTD &MAIL1 &MAIL2 &MAIL3 &MAIL4 +
                          &MAIL5 &WSNEDDT &WSSHCO &END &INTEG)
/*Emne */
             CHGVAR     VAR(&EMNE) VALUE('Requsted pick/shipping +
                          list for ' *CAT &WSKDB)
/*Body  (FYLLES OPP I SOURCE-FILE) */
             CHGVAR     VAR(&CVP2) VALUE('Pls pick and ship the +
                          requsted POs   ')
             CHGVAR     VAR(&CVP3) VALUE('according to attached +
                          PDF-document.')
             CHGVAR     VAR(&CVP4) VALUE('to ship: ' *CAT &WSKDB +
                          *CAT ' ' *CAT &WSNAB *CAT ' ')
             CHGVAR     VAR(&CVP5) VALUE('.')
             CHGVAR     VAR(&CVP6) VALUE('Need date: ' *CAT &WSNEDDT +
                          *CAT ' ')
             CHGVAR     VAR(&CVP7) VALUE('.')
             CHGVAR     VAR(&CVP8) VALUE('Odered by eSped user: ' *CAT +
                          &WSUSER   *CAT ' ')

/*S04        CHGVAR     VAR(&EPO50) VALUE(&MAIL1)  */
/*N04*/      CHGVAR     VAR(&EPO50) VALUE(&MAILAVS)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &QNBR)
             ADDPFM     FILE(ARKSRC) MBR(&UNIK)
             MONMSG     MSGID(CPF0000)
             CLRPFM     FILE(ARKSRC) MBR(&UNIK)
             OVRDBF     FILE(ARKSRC) TOFILE(*LIBL/ARKSRC) MBR(&UNIK)
             OVRDBF     FILE(ARKEPO) TOFILE(ARKEPOW)
/*E03*/      CALL       PGM(ARC006) PARM(&CVP2 &CVP3 &CVP4 &CVP5 +
                          &CVP6 &CVP7 &CVP8 &CVP9 &CVP10 +
                          &CVP11 &CVP12 &IE &CVP1 &EPO50 +
                          &MANAUT &BANE1 &BANE2 &BANE3 &BANE4 +
                          &BANE5 &BANE6 &BANE7 &BANE8 &BANE9 &BAN10 +
                          &BAN11 &BAN12 &BAN13 &BAN14 &BAN15 &BAN16 +
                          &BAN17 &BAN18 &BAN19 &BAN20 &BAN21 &BAN22 +
                          &BAN23 &BAN24 &BAN25 &BAN26 &BAN27 &BAN28 +
                          &BAN29 &BAN30 &FLERE &AVD &OPD &TUR &KN)
  /* bruk mime&mail for å konv til PDF/sende */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*N02  Lagre pdf-utskrift i mappe /tmp/SSPLUKKLISTE                     */
/*N02*/     CHGVAR     VAR(&BANE) VALUE('/pdf/SSPLUKKLISTE/' *CAT +
                         &UNIK *CAT '.pdf')
/*N02*/     CVTSPLFPDF SPLF(SS002PF) JOB(&QNBR/&QUSER/&QJOB) +
                         TOPDF(&BANE)
  /*   takler ikke flere adr omgangen hvis de er blank                  */
/*E04*/      EMLSTMF    SUBJECT(&EMNE) FROMNAME(&MAILAVS) +
                          FROMADDR(&MAILAVS) TO(&MAIL1/&MAIL1/*TO +
                          &MAIL2/&MAIL2/*TO &MAIL3/&MAIL3/*TO +
                          &MAIL4/&MAIL4/*TO &MAIL5/&MAIL5/*TO) +
                          STMF(&BANE)
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)

 SLUTT:      ENDPGM
