      *
      ***************************************************************
      *** SKRIVER UT RAPPORT - KOSTNADSBILAG MED VALGT STATUS     ***
      ***                                                         ***
      *** PROGRAMMERT AV TORE BRÅSTAD, SYSTEMA A/S, MAI 1994      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01-99                                ***
      ***************************************************************
      *
     FKOSTA13   IF   E           K DISK
     FKOSTB2    IF   E           K DISK
     FLEVEL01   IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYKS63P   O    E             PRINTER
     IKUNDR
     I              BANKG                       SYBAGI
     I              POSTG                       SYPOGI
     C*
     C     *ENTRY        PLIST
     C                   PARM                    WSUSER           10
     C                   PARM                    WSSTAT            1
     C                   PARM                    UUFDTO            6
     C                   PARM                    UUFTID            4
     C                   PARM                    UUTDTO            6
     C                   PARM                    UUTTID            4
     C                   PARM                    WSPRIN           10
     C                   PARM                    WSA4              1
     C*
     C                   MOVE      WSUSER        PUSER
     C                   MOVE      WSUSER        KEYUSR           10
     C                   MOVE      WSSTAT        PSTAT
     C                   MOVE      WSSTAT        KEYSTA            1
     C*
     C     LESKEY        KLIST
     C                   KFLD                    KEYSTA
     C                   KFLD                    KEYUSR
     C*
     C     LEVKY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    PLEVNR
     C*
     C     KUNKY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    PKUNNR
     C*
     C     BKEY          KLIST
     C                   KFLD                    KABNR
     C*
     C                   READ      FIRM                                   16
     C*
     C     START         TAG
     C     LESKEY        SETLL     KOSTAR
     C     LESKEY        READE     KOSTAR                                 10
     C                   Z-ADD     1             USIDE
     C                   WRITE     HODE
     C                   EXSR      FORMA
     C                   WRITE     DETA
     C     START1        TAG
     C     BKEY          SETLL     KOSTBR
     C                   READ      KOSTBR                                 10
     C                   Z-ADD     KBBNR         WBBNR             6 0
     C                   MOVEL     KBVK          WBVK              3
     C     *IN10         DOWEQ     '0'
     C     KBBNR         IFEQ      WBBNR
     C     KBVK          IFEQ      WBVK
     C                   EXSR      FORMB
     C                   WRITE     DETB                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C                   ELSE
     C                   EXSR      SJEKK2
     C                   WRITE     SUM1                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C                   SETOFF                                       4041
     C                   Z-ADD     0             VFDEB
     C                   Z-ADD     0             VFKRE
     C                   Z-ADD     0             VPDEB
     C                   Z-ADD     0             VPKRE
     C                   MOVE      *BLANKS       WBVK
     C                   MOVEL     KBVK          WBVK
     C                   EXSR      FORMB
     C                   WRITE     DETB                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C                   END
     C                   ELSE
     C                   EXSR      SJEKK2
     C                   WRITE     SUM1                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C                   SETOFF                                       4041
     C                   Z-ADD     KBBNR         WBBNR
     C                   Z-ADD     KBBNR         PBBNR
     C                   Z-ADD     0             VFDEB
     C                   Z-ADD     0             VFKRE
     C                   Z-ADD     0             VPDEB
     C                   Z-ADD     0             VPKRE
     C                   MOVE      *BLANKS       WBVK
     C                   MOVEL     KBVK          WBVK
     C                   READ      KOSTAR                                 10
     C     KAST          IFNE      WSSTAT
     C     KAUSER        ORNE      WSUSER
     C                   SETON                                        1030
     C                   GOTO      SLUTT
     C                   END
     C                   EXSR      FORMA
     C                   WRITE     DETA                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C                   GOTO      START1
     C                   END
     C                   READ      KOSTBR                                 10
     C                   END
     C*
     C                   EXSR      FORMB
     C                   WRITE     DETB                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C                   EXSR      SJEKK2
     C                   WRITE     SUM1                                 90
     C     *IN90         IFEQ      '1'
     C                   ADD       1             USIDE
     C                   WRITE     HODE
     C                   END
     C*
     C     SLUTT         TAG
     C   30              WRITE     SUM2                                 90
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***************************************************************
     C*
     C     FORMA         BEGSR
     C*
     C                   Z-ADD     KABNR         PBBNR
     C                   Z-ADD     KABDT         PABDT
     C                   Z-ADD     KALNR         PLEVNR
     C*
     C     LEVKY         CHAIN     LEVER                              15
     C                   MOVE      *BLANKS       PLEV
     C  N15              MOVEL     LNAVN         PLEV
     C*
     C                   MOVE      *BLANKS       PVAL
     C                   MOVEL     KAVAL         PVAL
     C                   Z-ADD     KAVKU         PKURS
     C     KABL          IFLE      0
     C                   Z-ADD     KABL          PFKRE
     C                   Z-ADD     0             PFDEB
     C                   ADD       KABL          FKRE
     C                   ELSE
     C                   Z-ADD     KABL          PFDEB
     C                   Z-ADD     0             PFKRE
     C                   ADD       KABL          FDEB
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     FORMB         BEGSR
     C*
     C                   MOVE      *BLANKS       PBVK
     C                   MOVEL     KBVK          PBVK
     C                   MOVE      KBKDM         PBKDM
     C                   Z-ADD     KBAVD         PAVD
     C                   Z-ADD     KBOPD         POPD
     C                   Z-ADD     KBKN          PKUNNR
     C*
     C     KUNKY         CHAIN     KUNDR                              17
     C                   MOVE      *BLANKS       PKUN
     C  N17              MOVEL     KNAVN         PKUN
     C*
     C     KBBLHB        IFGE      0
     C                   Z-ADD     KBBLHB        PFDB1
     C                   Z-ADD     0             PFKR1
     C                   ADD       KBBLHB        FDEB
     C     KBKDM         IFEQ      0
     C                   ADD       KBBLHB        VFDEB
     C                   ELSE
     C                   ADD       KBBLHB        VPDEB
     C                   END
     C                   ELSE
     C                   Z-ADD     KBBLHB        PFKR1
     C                   Z-ADD     0             PFDB1
     C                   ADD       KBBLHB        FKRE
     C     KBKDM         IFEQ      1
     C                   ADD       KBBLHB        VFKRE
     C                   ELSE
     C                   ADD       KBBLHB        VPKRE
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***************************************************************
     C*
     C     SJEKK2        BEGSR
     C*
     C     VPDEB         IFNE      0
     C     VPKRE         ORNE      0
     C                   MOVE      *BLANKS       KGVK
     C                   MOVEL     WBVK          KGVK
     C                   SETON                                        40
     C                   END
     C*
     C     VFDEB         IFNE      0
     C     VFKRE         ORNE      0
     C                   MOVE      *BLANKS       KB1VK
     C                   MOVEL     WBVK          KB1VK
     C                   SETON                                        41
     C                   END
     C*
     C                   ENDSR
     C*
