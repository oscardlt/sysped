********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10004 * 01 YBC PTF10 LEVERANDØRSNR ER ØKT TIL 5.0
10XXX * 02 sh  PTF10 endring farlig gods  .
10XXX * 03 YBC PTF10 BÅTKODE='*ALL' -> ENDELIG TRIP MED TRANSIT-TRIP FUNKSJONER
10XXX * 04 YBC PTF10 VED PLUKKING SETTER STATUS TILBAKE
10XXX * 05 YBC PTF10 OPPDATER BOXNR PÅ GSSOLF
10XXX * 06 YBC PTF10 LOGG OPTION
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED ORDRE PÅ TUREN             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07 09 11 13-24          ***
      *** LEDIGE INDIKATORER 31 32 34-37 39 42-90 95-97
      ***********************************************************
      *
     FGSSORF    UF   E           K DISK
     FGSSOWL01  UF   E           K DISK    PREFIX(W1_)
     FGSSORL06  IF   E           K DISK
     F                                     RENAME(GSSORFR:GSSORFR6)
     FGSSORL07  IF   E           K DISK
     F                                     RENAME(GSSORFR:GSSORFR7)
     FGSSORL17  UF   E           K DISK
     F                                     RENAME(GSSORFR:GSSORR17)
N04  FGSSORL21  UF   E           K DISK    RENAME(GSSORFR:GSSORFR21)
     FGSSPAF    IF   E           K DISK
     FGSSOLF    UF   E           K DISK
     FGSSPOF    IF   E           K DISK
     FGSSPOL01  IF   E           K DISK
     F                                     RENAME(GSSPOFR:GSSPOFR1)
N04  F*GSSTRF    IF   E           K DISK
N04  FGSSTRF    UF   E           K DISK
     FGSSCGF    IF   E           K DISK
     FGSSLGL03  IF   E           K DISK
N06  FGSSLGF    O  A E             DISK    RENAME(GSSLGFR:GSSLGFRUP)
     FGSSFGF    IF   E           K DISK
N02  FGSSDGF    IF   E           K DISK
     FGSS024D   CF   E             WORKSTN
     F                                     SFILE(GSS024DA:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D TN              S             11  0 DIM(100)
     D CNF             S              3  0 DIM(100)
     D CNT             S              3  0 DIM(100)
     D                 DS
     D  POCONO                 1     20
N01  D  POCONO18               1     18
     D  XPLUKK                 1      7
     D                 DS
     D  ORFT4                  1     30
     D  ORAREA                 1      2
     D  ORPÅR                  4      7
     D  ORPUKE                 8      9
     D                 DS
     D  OLMN                   1     35
     D  OLMNPRE                1      3
     D  OLMNTNO                4     14
     D  OLMNBOX               15     17
     D                UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UUSID                101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
     D  UBILOC               144    148
N06  D                SDS
N06  D  UUSER                254    263
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     GSS024DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
N04   *
N04   * SETT STATUS TILBAKE VED PLUKKING AV ORDRE FRA TRIP
N04  C   03
N04  COR 07
N04  COR 10
N04  COR 12              IF        XBACKST = 'J'
N04  C     UTNO          SETLL     GSSORL21
N04  C     UTNO          READE     GSSORL21                               33
N04  C                   DOW       *IN33 = *OFF
N04  C                   MOVE      '1'           ORST
N04  C                   IF        ORLC = 'ONWAY'
N04  C                   MOVE      ORLC2         ORLC
N04  C                   MOVE      ORLC3         ORLC2
N04  C                   MOVE      *BLANKS       ORLC3
N04  C                   MOVE      ORDTL2        ORDTL
N04  C                   MOVE      ORDTL3        ORDTL2
N04  C                   MOVE      *ZEROS        ORDTL3
N04  C                   END
N04  C                   UPDATE    GSSORFR21
N04  C     UTNO          READE     GSSORL21                               33
N04  C                   ENDDO
N04  C     UTNO          CHAIN     GSSTRF                             33
N04  C                   MOVE      '1'           TRST
N04  C                   UPDATE    GSSTRFR
N04  C                   Z-SUB     3             UFLAGG
N04  C                   GOTO      SLUTT
N04  C                   END
N04   *
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C   40GORK06        SETLL     GSSORL06
     C  N40
     CAN 41GORX06        SETLL     GSSORL06
     C  N40
     CANN41GORK07        SETLL     GSSORL07
     C     START1        TAG
     C   40GORY06        READE     GSSORL06                               94
     C  N40
     CAN 41GORX06        READE     GSSORL06                               94
     C  N40
     CANN41GORY07        READE     GSSORL07                               94
     C  N94UBILOC        IFNE      *BLANKS
     C     UBILOC        ANDNE     ORLC
     C                   GOTO      START1
     C                   END
     C  N94TRBCD         IFNE      *BLANKS
N03  C     TRBCD         ANDNE     '*ALL'
     C     TRBCD         ANDNE     ORBCD
     C                   GOTO      START1
     C                   END
     C  N94UBICGR        IFNE      *BLANKS
     C     ORCNO         CHAIN     GSSCGF                             33
     C  N33CGCG          COMP      UBICGR                             3333
     C   33              GOTO      START1
     C                   END
     C  N94TRRTNG        CABNE     ORRTNG        START1
     C     *IN94         IFEQ      '0'
     C     ORONO         CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      'C'           PAPKD
     C                   ELSE
     C     PAPKD         CABEQ     ' '           START1
     C                   END
     C                   MOVE      PAPKD         XPKD              1
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C     ORONO         SETLL     GSSPOF                             33
     C     ORONO         READE     GSSPOF                                 33
     C   33              MOVE      *BLANKS       POCONO
     C  N40              MOVE      ORLC          XLCBCD
     C   40              MOVE      ORBCD         XLCBCD
     C                   MOVE      XPKD          PAPKD
     C                   EXSR      SJEKSECUR
     C                   WRITE     GSS024DA
     C     ST21          TAG
     C   40GORY06        READE     GSSORL06                               94
     C  N40
     CAN 41GORX06        READE     GSSORL06                               94
     C  N40
     CANN41GORY07        READE     GSSORL07                               94
     C  N94UBILOC        IFNE      *BLANKS
     C     UBILOC        ANDNE     ORLC
     C                   GOTO      ST21
     C                   END
     C  N94TRBCD         IFNE      *BLANKS
N03  C     TRBCD         ANDNE     '*ALL'
     C     TRBCD         ANDNE     ORBCD
     C                   GOTO      ST21
     C                   END
     C  N94UBICGR        IFNE      *BLANKS
     C     ORCNO         CHAIN     GSSCGF                             33
     C  N33CGCG          COMP      UBICGR                             3333
     C   33              GOTO      ST21
     C                   END
     C  N94TRRTNG        CABNE     ORRTNG        ST21
     C     *IN94         IFEQ      '0'
     C     ORONO         CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      'C'           PAPKD
     C                   ELSE
     C     PAPKD         CABEQ     ' '           ST21
     C                   END
     C                   MOVE      PAPKD         XPKD              1
     C                   END
     C  N94              MOVE      ORONO         ORONOROLL         7 0
     C  N94              END
     C                   END
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS024DG
     C                   ELSE
     C                   WRITE     GSS024DB
     C                   EXFMT     GSS024DC
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C***
     C*
     C                   SETOFF                                       9830
     C                   MOVE      *ZEROS        UFLAGG
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
      *** PLUKK ALLE ORDRE T.O.M. TRANSPORTUKE
     C   07              DO
     C                   EXSR      PLUUKE
     C   12              GOTO      START3
     C                   Z-ADD     1             UFLAGG
     C                   GOTO      SLUTT
     C                   END
      *** SØK FRA
     C   08              GOTO      START6
      *** SKRIV UT
     C   10              DO
     C                   MOVE      '0'           *IN99
     C     STPRT         TAG
     C                   EXFMT     GSS024DX
     C                   MOVE      '0'           *IN99
     C   12              GOTO      START3
     C     WSPRT         COMP      *BLANKS                                99
     C   99              GOTO      STPRT
      *
     C     XST           IFEQ      '1'
     C                   MOVE      'PRT'         UTYPE             3
     C                   ELSE
     C                   MOVE      'CPY'         UTYPE
     C                   END
     C                   MOVE      TRCNO         UCNO2             8
     C                   MOVE      TRTNO         UTNO2            11
      *
     C     WSFAX         IFEQ      'Y'
     C                   CALL      'GSS034C'
     C                   PARM                    UCNO2
     C                   PARM                    UUTFAX            1
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    UVALK             3
     C                   PARM                    UMOD              1
     C                   PARM                    UCOMM             1
     C                   PARM                    UKNC              8
     C     UUTFAX        CABEQ     'J'           STPRT2
     C                   GOTO      STPRT
     C                   END
      *
     C     WSCPY         IFEQ      0
     C                   Z-ADD     1             WSCPY
     C                   END
     C                   MOVE      WSCPY         UCPY              1
      *
     C                   CALL      'GSS022R'
     C                   PARM                    UTNO2
     C                   PARM                    UTYPE
     C                   PARM                    UCPY
     C                   PARM                    WSPRT
     C                   PARM                    WSFAX
      *
     C     STPRT2        TAG
     C                   GOTO      SLUTT
     C                   END
      *** AVSLUTT
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C     ORONOROLL     CHAIN(N)  GSSORF                             33
     C                   GOTO      START2
     C                   END
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C     WSNR          IFEQ      'P'
     C     UINGEN        OREQ      'N'
     C                   MOVE      ' '           WSNR
     C                   GOTO      START
     C                   END
     C     WSNR          IFEQ      'T'
     C                   Z-ADD     1             UFLAGG
     C                   GOTO      SLUTT
     C                   END
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
      *
      *** SØK FRA
     C     START6        TAG
     C                   EXFMT     GSS024DE
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     19            POSNBR
     C   12              GOTO      START3
     C  N40W2LC          COMP      *BLANKS                            4141
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      ' '           UINGEN            1
     C                   MOVE      *ZEROS        TN
     C                   MOVE      *ZEROS        CNF
     C                   MOVE      *ZEROS        CNT
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS024DA                               98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '1'
     C                   MOVE      ' '           WSNR
     C     XPLUKK        COMP      '*PICKED'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      PCKORD
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C     XPLUKK        COMP      '*PICKED'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      DSPORD
     C   12              GOTO      SLHENT
     C                   END
     C  N40WSNR          IFEQ      'P'
     C     XPLUKK        COMP      '*PICKED'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      PPOORD
     C                   GOTO      SLHENT
     C                   END
     C  N40WSNR          IFEQ      'T'
     C     XPLUKK        COMP      '*PICKED'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      PALORD
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
      *
     C                   IF        UINGEN = 'N'
     C                   MOVE      ' '           UINGEN
     C                   MOVE      '0'           USTF
     C     1             DO        100           XNR
     C                   IF        TN(XNR) = 0
     C                   LEAVE
     C                   END
     C                   MOVE      'N'           UINGEN2
     C                   MOVE      TN(XNR)       UTNO2X
     C                   MOVE      CNF(XNR)      UCLNF
     C                   MOVE      CNT(XNR)      UCLNT
     C                   CALL      'GSS036R'
     C                   PARM                    UTNO2X           11 0
     C                   PARM                    UTNO
     C                   PARM                    USTF              1
     C                   PARM      XST           USTT              1
     C                   PARM                    UWT
     C                   PARM                    UCLNF             3 0
     C                   PARM                    UCLNT             3 0
     C                   PARM                    UINGEN2           1
     C                   IF        UINGEN2 = 'N'
     C                   MOVE      'N'           UINGEN
     C                   END
     C                   ENDDO
     C                   END
      *
     C                   ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              DO
     C                   MOVE      'GSS0009'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     PCKORD        BEGSR
     C***********************************************
     C                   MOVE      '1'           *IN99
     C     ORONO         CHAIN     GSSORF                             33
     C  N33              DO
N04   *
N04  C                   IF        ((XST > '1') AND (XST < '4'))
N04  C                   MOVE      'J'           XBACKST           1
N04  C                   END
N04   *
     C                   MOVE      XST           ORST
     C                   MOVE      UTNO          ORTNO
     C                   ADD       ORWT          UWT
     C   28
     CAN 40              DO
     C                   MOVE      ORLC2         ORLC3
     C                   MOVE      ORLC          ORLC2
     C                   MOVE      'ONWAY'       ORLC
     C                   MOVE      ORDTL2        ORDTL3
     C                   MOVE      ORDTL         ORDTL2
     C                   MOVE      TRDTL         ORDTL
     C                   END
     C                   UPDATE    GSSORFR
N06  C                   EVAL      XOPT = '*PCK'
N06  C                   EXSR      OPDLOG
     C                   EXSR      OPDWEB
     C                   EXSR      OPDLOK
     C                   MOVE      *ZEROS        ORONO
     C                   MOVE      *BLANKS       POCONO
     C                   MOVE      '*PICKED'     XPLUKK
     C                   MOVE      *ZEROS        ORSNO
     C                   MOVE      *ZEROS        ORCLI
     C                   MOVE      *ZEROS        ORWT
     C                   MOVE      *ZEROS        ORVOL
     C                   MOVE      *BLANKS       ORPOS1
     C                   MOVE      *BLANKS       ORLC
     C                   MOVE      *ZEROS        ORCLNF
     C                   MOVE      *ZEROS        ORCLNT
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    GSS024DA
      *
     C                   ENDSR
      *
     C***********************************************
     C     PPOORD        BEGSR
     C***********************************************
     C     POCONO        SETLL     GSSPOL01
     C     POCONO        READE     GSSPOL01                               33
     C     *IN33         DOWEQ     '0'
     C     POONO         CHAIN     GSSORF                             34
     C     *IN34         IFEQ      '0'
     C     ORST          IFEQ      '0'
     C     ORBCD         ANDEQ     TRBCD
     C                   MOVE      ' '           PAPKD
     C     ORONO         CHAIN     GSSPAF                             34
     C     *IN34         IFEQ      '1'
     C     PAPKD         ORNE      ' '
     C                   MOVE      XST           ORST
     C                   MOVE      UTNO          ORTNO
     C                   ADD       ORWT          UWT
     C                   END
     C                   END
     C                   EXSR      OPDLOK
     C                   UPDATE    GSSORFR
N06  C                   EVAL      XOPT = '*PPO'
N06  C                   EXSR      OPDLOG
     C                   EXSR      OPDWEB
     C                   END
     C     POCONO        READE     GSSPOL01                               33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     PALORD        BEGSR
     C***********************************************
     C     GORY07        SETLL     GSSORL07
     C     GORY07        READE     GSSORL07                               33
     C     *IN33         DOWEQ     '0'
     C     ORONO         CHAIN     GSSPAF                             34
     C     *IN34         IFEQ      '1'
     C     PAPKD         ORNE      ' '
     C     ORONO         CHAIN     GSSORF                             34
     C     *IN34         IFEQ      '0'
     C                   MOVE      XST           ORST
     C                   MOVE      UTNO          ORTNO
     C                   ADD       ORWT          UWT
     C                   UPDATE    GSSORFR
N06  C                   EVAL      XOPT = '*PAL'
N06  C                   EXSR      OPDLOG
     C                   EXSR      OPDWEB
     C                   EXSR      OPDLOK
     C                   END
     C                   END
     C     GORY07        READE     GSSORL07                               33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     PLUUKE        BEGSR
     C***********************************************
     C                   MOVE      UYEAR         WSPÅR
     C                   MOVE      '*ALL'        WSAREA
     C                   MOVE      '0'           *IN99
     C     STPUK         TAG
     C                   EXFMT     GSS024DP
     C                   MOVE      '0'           *IN99
      *
     C   12              GOTO      SLPUK
      *
     C     WSPUKE        IFLT      1
     C     WSPUKE        ORGT      53
     C                   MOVE      '1'           *IN99
     C                   MOVE      'SPU0101'     MSGNR
     C                   GOTO      STPUK
     C                   END
     C                   MOVE      WSPÅR         W2PÅR             4
     C                   MOVEL     '20'          W2PÅR
     C                   MOVE      WSPUKE        W2PUKE            2
      *
     C     TRLOCF        SETLL     GSSORL17
     C     TRLOCF        READE     GSSORL17                               33
     C     *IN33         DOWEQ     '0'
     C     ORPÅR         IFNE      *BLANKS
     C     ORPUKE        ANDNE     *BLANKS
     C     ORPÅR         ANDNE     *ZEROS
     C     ORPUKE        ANDNE     *ZEROS
     C     WSAREA        IFEQ      '*ALL'
     C     WSAREA        OREQ      ORAREA
     C                   SELECT
     C     ORPÅR         WHENLT    W2PÅR
     C                   MOVE      XST           ORST
     C                   MOVE      UTNO          ORTNO
     C                   ADD       ORWT          UWT
     C                   EXSR      OPDLOK
     C     ORPÅR         WHENEQ    W2PÅR
     C     ORPUKE        ANDLE     W2PUKE
     C                   MOVE      XST           ORST
     C                   MOVE      UTNO          ORTNO
     C                   ADD       ORWT          UWT
     C                   EXSR      OPDLOK
     C                   ENDSL
     C                   END
     C                   END
     C                   UPDATE    GSSORR17
N06  C                   EVAL      XOPT = '*PUK'
N06  C                   EXSR      OPDLOG
     C     TRLOCF        READE     GSSORL17                               33
     C  N33              ENDDO
      *
     C     SLPUK         ENDSR
      *
     C***********************************************
     C     OPDLOK        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XXMNTNO          11 0
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE     GSSOLF                                 34
     C     *IN34         DOWEQ     '0'
     C                   IF        OLTNO <> 0
     C                   MOVE      *BLANKS       OLMN
     C                   MOVE      '995'         OLMNPRE
     C                   MOVE      OLTNO         OLMNTNO
     C                   MOVE      OLBOX         OLMNBOX
     C                   IF        ((ORCLNF = 0) OR (ORCLNF > OLBOX))
     C                   MOVE      OLBOX         ORCLNF
     C                   END
     C                   IF        ((ORCLNT = 0) OR (ORCLNT < OLBOX))
     C                   MOVE      OLBOX         ORCLNT
     C                   END
     C                   ELSE
     C                   IF        OLMNPRE = '995'
     C                   MOVE      OLMNTNO       XXMNTNO
     C                   MOVE      OLMNBOX       OLMNBOX2          3 0
     C                   IF        ((ORCLNF = 0) OR (ORCLNF > OLMNBOX2))
     C                   MOVE      OLMNBOX2      ORCLNF
     C                   END
     C                   IF        ((ORCLNT = 0) OR (ORCLNT < OLMNBOX2))
     C                   MOVE      OLMNBOX2      ORCLNT
     C                   END
     C                   END
     C                   END
S05  C*                  MOVE      *ZEROS        OLBOX
N05  C                   MOVE      OLMNBOX       OLBOX
N05  C                   IF        OLBOX = 0
     C                   MOVE      ' '           OLST
N05  C                   ELSE
N05  C                   MOVE      'L'           OLST
N05  C                   END
     C                   MOVE      UTNO          OLTNO
     C                   UPDATE    GSSOLFR
     C     ORONO         READE     GSSOLF                                 34
     C  N34              ENDDO
      *
      * SJEKK ORDRE MED SAMME KOLLINR
     C                   IF        ((ORCLNF <> 0) AND (ORTNO2 <> 0))
     C     1             DO        100           XNR               3 0
     C                   IF        ORCLNT = 0
     C                   EVAL      ORCLNT = ORCLNF
     C                   END
     C                   SELECT
     C                   WHEN      TN(XNR) = 0
     C                   LEAVE
     C                   WHEN      TN(XNR) = ORTNO2
     C                   SELECT
     C                   WHEN      ((CNF(XNR)<=ORCLNF) AND (CNT(XNR)>=ORCLNT))
     C                   GOTO      OPDFRAFØR
     C                   WHEN      ((CNF(XNR)<=ORCLNF) AND (CNT(XNR)>=ORCLNF))
     C                   IF        CNT(XNR) < ORCLNT
     C                   EVAL      CNT(XNR) = ORCLNT
     C                   END
     C                   GOTO      OPDFRAFØR
     C                   WHEN      ((CNF(XNR)<=ORCLNT) AND (CNT(XNR)>=ORCLNT))
     C                   IF        CNF(XNR) > ORCLNF
     C                   EVAL      CNF(XNR) = ORCLNF
     C                   END
     C                   GOTO      OPDFRAFØR
     C                   WHEN      ((CNF(XNR)>ORCLNF) AND (CNT(XNR)<ORCLNT))
     C                   EVAL      CNF(XNR) = ORCLNF
     C                   EVAL      CNT(XNR) = ORCLNT
     C                   GOTO      OPDFRAFØR
     C                   ENDSL
     C                   ENDSL
     C                   ENDDO
     C                   MOVE      ORTNO2        TN(XNR)
     C                   MOVE      ORCLNF        CNF(XNR)
     C                   MOVE      ORCLNT        CNT(XNR)
     C                   MOVE      'N'           UINGEN
     C     OPDFRAFØR     TAG
     C                   ELSE
     C                   IF        ((ORCLNF <> 0) AND (XXMNTNO <> 0))
     C     1             DO        100           XNR               3 0
     C                   IF        ORCLNT = 0
     C                   EVAL      ORCLNT = ORCLNF
     C                   END
     C                   SELECT
     C                   WHEN      TN(XNR) = 0
     C                   LEAVE
     C                   WHEN      TN(XNR) = XXMNTNO
     C                   SELECT
     C                   WHEN      ((CNF(XNR)<=ORCLNF) AND (CNT(XNR)>=ORCLNT))
     C                   GOTO      OPDFRAFØR2
     C                   WHEN      ((CNF(XNR)<=ORCLNF) AND (CNT(XNR)>=ORCLNF))
     C                   IF        CNT(XNR) < ORCLNT
     C                   EVAL      CNT(XNR) = ORCLNT
     C                   END
     C                   GOTO      OPDFRAFØR2
     C                   WHEN      ((CNF(XNR)<=ORCLNT) AND (CNT(XNR)>=ORCLNT))
     C                   IF        CNF(XNR) > ORCLNF
     C                   EVAL      CNF(XNR) = ORCLNF
     C                   END
     C                   GOTO      OPDFRAFØR2
     C                   WHEN      ((CNF(XNR)>ORCLNF) AND (CNT(XNR)<ORCLNT))
     C                   EVAL      CNF(XNR) = ORCLNF
     C                   EVAL      CNT(XNR) = ORCLNT
     C                   GOTO      OPDFRAFØR2
     C                   ENDSL
     C                   ENDSL
     C                   ENDDO
     C                   MOVE      XXMNTNO       TN(XNR)
     C                   MOVE      ORCLNF        CNF(XNR)
     C                   MOVE      ORCLNT        CNT(XNR)
     C                   MOVE      'N'           UINGEN
     C     OPDFRAFØR2    TAG
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPORD        BEGSR
     C***********************************************
     C                   MOVE      '1'           *IN99
     C                   MOVE      'DSP'         UTYPE             3
     C                   MOVE      ORONO         UONO
     C     *LIKE         DEFINE    ORONO         UONO
     C     *LIKE         DEFINE    ORBCD         UBCD
     C     *LIKE         DEFINE    ORCNO         UCNO
     C     *LIKE         DEFINE    ORSNO         USNO
     C     *LIKE         DEFINE    ORLC          ULC
     C                   CALL      'GSS011R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    UBCD
     C                   PARM                    UCNO
     C                   PARM                    USNO
     C                   PARM                    ULC
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   EXSR      SJEKSECUR
     C                   UPDATE    GSS024DA
      *
     C                   ENDSR
      *
N06   ***********************************************
N06  C     OPDLOG        BEGSR
N06   ***********************************************
N06  C                   CALL      'SYGE15C'
N06  C                   PARM                    WDT               8
N06  C                   PARM                    WTM               6
N06  C                   MOVE      WDT           LGDT
N06  C                   MOVE      WTM           LGTID
N06  C                   MOVE      WDT           LGHDT
N06  C                   MOVE      WTM           LGHTID
N06  C                   EVAL      LGUSER = UUSER
N06  C                   EVAL      LGPGM  = 'GSS024R'
N06  C                   EVAL      LGNIVÅ = 3
N06  C                   EVAL      LGFTYP = XOPT
N06  C                   EVAL      LGONO  = ORONO
N06  C                   EVAL      LGNGM  = 0
N06  C                   SELECT
N06  C                   WHEN      XOPT = '*PCK'
N06  C                   EVAL      LGTXT = 'Order is picked up to trip.'
N06  C                   EVAL      LGNNY  = UTNO
N06  C                   WHEN      XOPT = '*PPO'
N06  C                   EVAL      LGTXT = 'Order picked to trip by PO.nr.'
N06  C                   EVAL      LGNNY  = UTNO
N06  C                   WHEN      XOPT = '*PAL'
N06  C                   EVAL      LGTXT = 'Order picked to trip by ALL.'
N06  C                   EVAL      LGNNY  = UTNO
N06  C                   WHEN      XOPT = '*PUK'
N06  C                   EVAL      LGTXT = 'Order picked to trip by WEEK.'
N06  C                   EVAL      LGNNY  = UTNO
N06  C                   ENDSL
N06  C                   WRITE     GSSLGFRUP
N06   *
N06  C                   ENDSR
N06   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     GORK06        KLIST
     C                   KFLD                    YST
     C                   KFLD                    TRLOCF
     C                   KFLD                    W2BCD
     C     GORY06        KLIST
     C                   KFLD                    YST
     C                   KFLD                    TRLOCF
     C     GORX06        KLIST
     C                   KFLD                    YST
     C                   KFLD                    W2LC
     C     GORK07        KLIST
     C                   KFLD                    YST
     C                   KFLD                    TRBCD
     C                   KFLD                    TRCNO
     C                   KFLD                    W2ONO
     C     *LIKE         DEFINE    ORST          YST
     C                   MOVE      '0'           YST
     C     GORY07        KLIST
     C                   KFLD                    YST
     C                   KFLD                    TRBCD
     C                   KFLD                    TRCNO
     C     GSSLGL03K1    KLIST
     C                   KFLD                    XLGFTYP1
     C                   KFLD                    OLONO
     C                   KFLD                    LGLNO
     C                   MOVE      'UNSEC'       XLGFTYP1          5
     C     GSSLGL03K2    KLIST
     C                   KFLD                    XLGFTYP2
     C                   KFLD                    OLONO
     C                   KFLD                    LGLNO
     C                   MOVE      'SECUR'       XLGFTYP2          5
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO             11 0
     C                   PARM                    UWT               7 1
     C                   PARM                    UFLAGG            1 0
      *
     C                   CLEAR                   GSSORFR
     C     WSPRT         IFEQ      *BLANKS
     C                   MOVE      UBIPRT        WSPRT
     C                   END
     C                   MOVE      *ZEROS        *IN
     C                   MOVE      *ZEROS        W2ONO
     C                   MOVE      *BLANKS       W2BCD
     C                   Z-ADD     1             WSCPY
N06  C                   MOVE      *BLANKS       XOPT              4
     C                   MOVE      '1'           UMOD              1
     C                   MOVE      'N'           WSFAX
S04  C*    UTNO          CHAIN     GSSTRF                             33
N04  C     UTNO          CHAIN(N)  GSSTRF                             33
     C     TRBCD         COMP      *BLANKS                                40
N03  C  N40TRBCD         COMP      '*ALL'                                 40
     C  N40TRLOCF        COMP      *BLANKS                            4040
     C   40TRST          COMP      '2'                                28  28
     C  N28UFLAGG        COMP      1                                      28
     C                   MOVE      *ZEROS        UFLAGG
     C     TRST          IFEQ      'X'
     C                   MOVE      '1'           XST               1
     C                   ELSE
     C                   MOVE      TRST          XST
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SJEKSECUR     BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN27
     C                   MOVE      '0'           *IN29
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE(N)  GSSOLF                                 33
     C                   DOW       *IN33 = *OFF
     C                   MOVE      OLLNO         LGLNO
      * SJEKK OM KOLLI ER IKKE "SECURED"
     C     GSSLGL03K1    CHAIN     GSSLGL03                           33
     C                   IF        *IN33 = *OFF
     C                   MOVE      '1'           *IN27
     C                   MOVE      '0'           *IN29
     C                   LEAVE
     C                   ELSE
      * SJEKK OM KOLLI ER "SECURED"
     C     GSSLGL03K2    CHAIN     GSSLGL03                           33
     C                   IF        *IN33 = *OFF
     C                   MOVE      '0'           *IN27
     C                   MOVE      '1'           *IN29
     C                   ELSE
     C                   MOVE      '0'           *IN27
     C                   MOVE      '0'           *IN29
     C                   END
     C                   END
     C     ORONO         READE(N)  GSSOLF                                 33
     C  N33              ENDDO
      *
      * SJEKK OM FARLIG GODS
     C     ORONO         CHAIN     GSSFGF                             33
     C  N33              MOVE      '1'           *IN(38)
     C   33              MOVE      '0'           *IN(38)
N02  C     ORONO         CHAIN     GSSDGF                             33
N02  C  N33              MOVE      '1'           *IN(39)
N02  C   33              MOVE      '0'           *IN(39)
     C                   MOVE      '0'           *IN33
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDWEB        BEGSR
     C***********************************************
     C     ORONO         CHAIN     GSSOWL01                           33
     C                   IF        *IN33 = *OFF
     C                   IF        W1_ORST <> 'P'
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      'P'           W1_ORST
     C                   MOVE      UUSID         W1_ORUSRP
     C                   MOVE      WDT           W1_ORDTP
     C                   MOVE      WTM           W1_ORTMP
     C                   END
     C                   UPDATE    GSSOWFR
     C                   END
      *
     C                   ENDSR
      *
