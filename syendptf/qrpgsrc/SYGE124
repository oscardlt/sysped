********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 SH  PTF12 merket en feil chang har rettet direkte i programmet
      *    SH  PTF12 merket med E01
********************************************************************
      *
     D XFACT           S              3S 0
     D XCHKSUM         S              7S 0
     D XTALL           S              7S 0
     D XDIF            S              3S 0
     D XCTRSIF         S              1S 0
      *
     C     *ENTRY        PLIST
     C                   PARM                    UCON             11
     C                   PARM                    UCTR              1
     C                   PARM                    UOK               1
      *
     C     1             DO        10            XN                3 0
     C                   SELECT
     C                   WHEN      XN = 1
     C                   EVAL      XFACT = 1
     C                   WHEN      XN = 2
     C                   EVAL      XFACT = 2
     C                   WHEN      XN = 3
     C                   EVAL      XFACT = 4
     C                   WHEN      XN = 4
     C                   EVAL      XFACT = 8
     C                   WHEN      XN = 5
     C                   EVAL      XFACT = 16
     C                   WHEN      XN = 6
     C                   EVAL      XFACT = 32
     C                   WHEN      XN = 7
     C                   EVAL      XFACT = 64
     C                   WHEN      XN = 8
     C                   EVAL      XFACT = 128
     C                   WHEN      XN = 9
     C                   EVAL      XFACT = 256
     C                   WHEN      XN = 10
     C                   EVAL      XFACT = 512
     C                   ENDSL
      *
     C                   SELECT
     C                   WHEN      %SUBST(UCON:XN:1) = '1'
     C                   EVAL      XCHKSUM = XCHKSUM + 1 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '2'
     C                   EVAL      XCHKSUM = XCHKSUM + 2 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '3'
     C                   EVAL      XCHKSUM = XCHKSUM + 3 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '4'
     C                   EVAL      XCHKSUM = XCHKSUM + 4 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '5'
     C                   EVAL      XCHKSUM = XCHKSUM + 5 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '6'
     C                   EVAL      XCHKSUM = XCHKSUM + 6 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '7'
     C                   EVAL      XCHKSUM = XCHKSUM + 7 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '8'
     C                   EVAL      XCHKSUM = XCHKSUM + 8 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = '9'
     C                   EVAL      XCHKSUM = XCHKSUM + 9 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'A'
     C                   EVAL      XCHKSUM = XCHKSUM + 10 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'B'
     C                   EVAL      XCHKSUM = XCHKSUM + 12 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'C'
     C                   EVAL      XCHKSUM = XCHKSUM + 13 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'D'
     C                   EVAL      XCHKSUM = XCHKSUM + 14 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'E'
     C                   EVAL      XCHKSUM = XCHKSUM + 15 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'F'
     C                   EVAL      XCHKSUM = XCHKSUM + 16 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'G'
     C                   EVAL      XCHKSUM = XCHKSUM + 17 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'H'
     C                   EVAL      XCHKSUM = XCHKSUM + 18 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'I'
     C                   EVAL      XCHKSUM = XCHKSUM + 19 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'J'
     C                   EVAL      XCHKSUM = XCHKSUM + 20 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'K'
     C                   EVAL      XCHKSUM = XCHKSUM + 21 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'L'
     C                   EVAL      XCHKSUM = XCHKSUM + 23 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'M'
     C                   EVAL      XCHKSUM = XCHKSUM + 24 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'N'
     C                   EVAL      XCHKSUM = XCHKSUM + 25 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'O'
     C                   EVAL      XCHKSUM = XCHKSUM + 26 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'P'
     C                   EVAL      XCHKSUM = XCHKSUM + 27 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'Q'
     C                   EVAL      XCHKSUM = XCHKSUM + 28 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'R'
     C                   EVAL      XCHKSUM = XCHKSUM + 29 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'S'
     C                   EVAL      XCHKSUM = XCHKSUM + 30 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'T'
     C                   EVAL      XCHKSUM = XCHKSUM + 31 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'U'
     C                   EVAL      XCHKSUM = XCHKSUM + 32 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'V'
     C                   EVAL      XCHKSUM = XCHKSUM + 34 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'W'
     C                   EVAL      XCHKSUM = XCHKSUM + 35 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'X'
     C                   EVAL      XCHKSUM = XCHKSUM + 36 * XFACT
     C                   WHEN      %SUBST(UCON:XN:1) = 'Y'
     C                   EVAL      XCHKSUM = XCHKSUM + 37 * XFACT
E01  C                   WHEN      %SUBST(UCON:XN:1) = 'Z'
     C                   EVAL      XCHKSUM = XCHKSUM + 38 * XFACT
     C                   ENDSL
      *
     C                   ENDDO
      *
      *
     C                   EVAL      XTALL = XCHKSUM / 11
     C                   EVAL      XTALL = XTALL * 11
     C                   EVAL      XDIF = XCHKSUM - XTALL
     C                   IF        XDIF = 10
     C                   EVAL      XDIF = 0
     C                   END
     C                   EVAL      XCTRSIF = XDIF
     C                   MOVE      XCTRSIF       UCTR
      *
     C                   SELECT
     C                   WHEN      %SUBST(UCON:11:1) = ' '
     C                   EVAL      %SUBST(UCON:11:1) = UCTR
     C                   EVAL      UOK = 'J'
     C                   WHEN      %SUBST(UCON:11:1) = UCTR
     C                   EVAL      UOK = 'J'
     C                   OTHER
     C                   EVAL      UOK = 'N'
     C                   ENDSL
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
