CB    * Lagt inn lengre feltdefinisjon vedr. UPDHTMLVAR
      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TNCE002R MODULE(*LIBL/TNCE002R *LIBL/INCGI)
CRTPGM*        ACTGRP(CGI) AUT(*USE)
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 FJERN REKORD-LÅS PÅ SVXH
11133 * 02 YBC PTF11 VEKT ER ENDRET FRA 9.1 TIL 11.3, EGET FELT FOR GARANTI
********************************************************************
      *
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FSVXH      UF A E           K DISK    USROPN
     F                                     PREFIX(X_)
     FSVXSTD    UF   E           K DISK    USROPN
     F                                     PREFIX(X_)
     FSVTHA2    IF   E           K DISK    USROPN
     F                                     RENAME(SVTHAR:SVTHAR2)
     FSVTHA     IF   E           K DISK    USROPN
     FSVXV      IF A E           K DISK    USROPN
     FSVXVAM    IF A E           K DISK    USROPN
     FSVXVVT    IF A E           K DISK    USROPN
     FSVXVDK    IF A E           K DISK    USROPN
     FSVXVCN    IF A E           K DISK    USROPN
     FSVXVMN    IF A E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D THAVD_A         S              4
     D THAVD           S              4  0
     D THTDN_A         S              7
     D THTDN           S              7  0
     D NEWSYAVA        S              4
     D NEWAVD          S              4  0
     D NEWOPD          S              7  0
     D NEWSIGN         S              3
     D WMODE           S              2
     D WSIGN           S              3
     D THSG            S              3
     D THST            S              1
     D THDT_A          S              8
     D THDT            S              8  0
     D THPRO_A         S              8
     D THPRO           S              8  0
     D THENKL          S              1
     D THDK            S              5
     D THKNA_A         S              8
     D THKNA           S              8  0
     D THNAA           S             30
     D THADA1          S             30
     D THPNA           S              9
     D THPSA           S             24
     D THLKA           S              2
     D THSKA           S              2
     D THTINA          S             17
     D THKNS_A         S              8
     D THKNS           S              8  0
     D THNAS           S             30
     D THADS1          S             30
     D THPNS           S              9
     D THPSS           S             24
     D THLKS           S              2
     D THSKS           S              2
     D THTINS          S             17
     D THKNK_A         S              8
     D THKNK           S              8  0
     D THNAK           S             30
     D THADK1          S             30
     D THPNK           S              9
     D THPSK           S             24
     D THLKK           S              2
     D THSKK           S              2
     D THTINK          S             17
     D THBLK           S              2
     D THLSD           S             17
     D THLASD          S             17
     D THLAS2          S             17
     D THALK           S              2
     D THTRM_A         S              2
     D THTRM           S              2  0
     D THTRMI_A        S              2
     D THTRMI          S              2  0
     D THTAID          S             27
     D THTASK          S              2
     D THTALK          S              2
     D THTGID          S             27
     D THTGSK          S              2
     D THTGLK          S              2
     D THSKFD          S              2
     D THCATS          S              8
     D THTSD1          S              8
     D THTSD2          S              8
     D THTSD3          S              8
     D THTSD4          S              8
     D THTSD5          S              8
     D THTSD6          S              8
     D THTSD7          S              8
     D THTSD8          S              8
     D THTSB           S              8
     D THDDT_A         S              8
     D THDDT           S              8  0
     D THDFKD          S             20
     D THDFSK          S              2
     D THDKR           S              2
     D THDANT_A        S              4
     D THDANT          S              4  0
     D THDDTK_A        S              8
     D THDDTK          S              8  0
     D THDATS          S              8
     D THDKAV          S             35
     D THDKSK          S              2
     D THGKD_A         S              8
     D THGKD           S              8  0
     D THGFT1          S             24
     D THGFT2          S             35
     D THGADK          S              4
     D THGBL_A         S             13
     D THGBL           S             13  2
     D THGVK           S              3
     D THGBGI_A        S              1
     D THGBGI          S              1  0
     D THGBGU          S              2
     D THKDC           S              1
     D THTSSD          S              8
     D THTSN1          S             35
     D THTSN2          S             35
     D THTSPN          S              9
     D THTSLK          S              2
     D THTSSK          S              2
     D THLSTL_A        S              4
     D THLSTL          S              4  0
     D THVPOS_A        S              5
     D THVPOS          S              5  0
     D THNTK_A         S              7
     D THNTK           S              7  0
S02  D*THVKB_A         S              9
S02  D*THVKB           S              9  1
N02  D THVKB_A         S             12
N02  D THVKB           S             11  3
     D THDST           S             15
     D THDSK           S              2
     D THTARF          S             16
     D THWS            S             10
     D THTRNR          S             18
     D THTRDT_A        S              8
     D THTRDT          S              8  0
     D THOMD_A         S              1
     D THOMD           S              1  0
     D THBIND          S            140
     D THTET_A         S              1
     D THTET           S              1  0
     D THMF            S              3
     D THMP_A          S              1
     D THMP            S              1  0
     D THPKL           S              1
     D THKDV           S              1
     D TH0035          S              1
     D THTUID          S             14
     D THSGDK          S              6
     D THSGME          S              3
     D THSGUT          S              6
     D THSGID          S             10
     D THSGDT          S             12
     D THBYTE_A        S              7
     D THBYTE          S              7  0
     D JSONstring      S          32000
     D Error           S            150

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C  N50              EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬thavd¬ : ¬'+%trim(%editc(THAVD:'Z'))+'¬, '
        +'¬thtdn¬ : ¬'+%trim(%editc(THTDN:'Z'))+'¬, '
        +'¬newavd¬ : ¬'+%trim(%editc(NEWAVD:'Z'))+'¬, '
        +'¬newopd¬ : ¬'+%trim(%editc(NEWOPD:'Z'))+'¬, '
        +'¬newsign¬ : ¬'+%trim(NEWSIGN)+'¬, '
        +'¬mode¬ : ¬'+%trim(WMODE)+'¬, '
        +'¬thtuid¬ : ¬'+%trim(THTUID)+'¬, '
        +'¬thsg¬ : ¬'+%trim(THSG)+'¬, '
        +'¬thst¬ : ¬'+%trim(THST)+'¬, '
        +'¬thdt¬ : ¬'+%trim(%editc(THDT:'Z'))+'¬, '
        +'¬thpro¬ : ¬'+%trim(%editc(THPRO:'Z'))+'¬, '
        +'¬thenkl¬ : ¬'+%trim(THENKL)+'¬, '
        +'¬thdk¬ : ¬'+%trim(THDK)+'¬, '
        +'¬thkna¬ : ¬'+%trim(%editc(THKNA:'Z'))+'¬, '
        +'¬thnaa¬ : ¬'+%trim(THNAA)+'¬, '
        +'¬thada1¬ : ¬'+%trim(THADA1)+'¬, '
        +'¬thpna¬ : ¬'+%trim(THPNA)+'¬, '
        +'¬thpsa¬ : ¬'+%trim(THPSA)+'¬, '
        +'¬thlka¬ : ¬'+%trim(THLKA)+'¬, '
        +'¬thska¬ : ¬'+%trim(THSKA)+'¬, '
        +'¬thtina¬ : ¬'+%trim(THTINA)+'¬, '
        +'¬thkns¬ : ¬'+%trim(%editc(THKNS:'Z'))+'¬, '
        +'¬thnas¬ : ¬'+%trim(THNAS)+'¬, '
        +'¬thads1¬ : ¬'+%trim(THADS1)+'¬, '
        +'¬thpns¬ : ¬'+%trim(THPNS)+'¬, '
        +'¬thpss¬ : ¬'+%trim(THPSS)+'¬, '
        +'¬thlks¬ : ¬'+%trim(THLKS)+'¬, '
        +'¬thsks¬ : ¬'+%trim(THSKS)+'¬, '
        +'¬thtins¬ : ¬'+%trim(THTINS)+'¬, '
        +'¬thknk¬ : ¬'+%trim(%editc(THKNK:'Z'))+'¬, '
        +'¬thnak¬ : ¬'+%trim(THNAK)+'¬, '
        +'¬thadk1¬ : ¬'+%trim(THADK1)+'¬, '
        +'¬thpnk¬ : ¬'+%trim(THPNK)+'¬, '
        +'¬thpsk¬ : ¬'+%trim(THPSK)+'¬, '
        +'¬thlkk¬ : ¬'+%trim(THLKK)+'¬, '
        +'¬thskk¬ : ¬'+%trim(THSKK)+'¬, '
        +'¬thtink¬ : ¬'+%trim(THTINK)+'¬, '
        +'¬thblk¬ : ¬'+%trim(THBLK)+'¬, '
        +'¬thlsd¬ : ¬'+%trim(THLSD)+'¬, '
        +'¬thlasd¬ : ¬'+%trim(THLASD)+'¬, '
        +'¬thlas2¬ : ¬'+%trim(THLAS2)+'¬, '
        +'¬thalk¬ : ¬'+%trim(THALK)+'¬, '
        +'¬thtrm¬ : ¬'+%trim(%editc(THTRM:'Z'))+'¬, '
        +'¬thtrmi¬ : ¬'+%trim(%editc(THTRMI:'Z'))+'¬, '
        +'¬thtaid¬ : ¬'+%trim(THTAID)+'¬, '
        +'¬thtask¬ : ¬'+%trim(THTASK)+'¬, '
        +'¬thtalk¬ : ¬'+%trim(THTALK)+'¬, '
        +'¬thtgid¬ : ¬'+%trim(THTGID)+'¬, '
        +'¬thtgsk¬ : ¬'+%trim(THTGSK)+'¬, '
        +'¬thtglk¬ : ¬'+%trim(THTGLK)+'¬, '
        +'¬thskfd¬ : ¬'+%trim(THSKFD)+'¬, '
        +'¬thcats¬ : ¬'+%trim(THCATS)+'¬, '
        +'¬thtsd1¬ : ¬'+%trim(THTSD1)+'¬, '
        +'¬thtsd2¬ : ¬'+%trim(THTSD2)+'¬, '
        +'¬thtsd3¬ : ¬'+%trim(THTSD3)+'¬, '
        +'¬thtsd4¬ : ¬'+%trim(THTSD4)+'¬, '
        +'¬thtsd5¬ : ¬'+%trim(THTSD5)+'¬, '
        +'¬thtsd6¬ : ¬'+%trim(THTSD6)+'¬, '
        +'¬thtsd7¬ : ¬'+%trim(THTSD7)+'¬, '
        +'¬thtsd8¬ : ¬'+%trim(THTSD8)+'¬, '
        +'¬thtsb¬ : ¬'+%trim(THTSB)+'¬, '
        +'¬thddt¬ : ¬'+%trim(%editc(THDDT:'Z'))+'¬, '
        +'¬thdfkd¬ : ¬'+%trim(THDFKD)+'¬, '
        +'¬thdfsk¬ : ¬'+%trim(THDFSK)+'¬, '
        +'¬thdkr¬ : ¬'+%trim(THDKR)+'¬, '
        +'¬thdant¬ : ¬'+%trim(%editc(THDANT:'Z'))+'¬, '
        +'¬thddtk¬ : ¬'+%trim(%editc(THDDTK:'Z'))+'¬, '
        +'¬thdats¬ : ¬'+%trim(THDATS)+'¬, '
        +'¬thdkav¬ : ¬'+%trim(THDKAV)+'¬, '
        +'¬thdksk¬ : ¬'+%trim(THDKSK)+'¬, '
        +'¬thgkd¬ : ¬'+%trim(%editc(THGKD:'3'))+'¬, '
        +'¬thgft1¬ : ¬'+%trim(THGFT1)+'¬, '
        +'¬thgft2¬ : ¬'+%trim(THGFT2)+'¬, '
        +'¬thgadk¬ : ¬'+%trim(THGADK)+'¬, '
        +'¬thgbl¬ : ¬'+%trim(%editc(THGBL:'K'))+'¬, '
        +'¬thgvk¬ : ¬'+%trim(THGVK)+'¬, '
        +'¬thgbgi¬ : ¬'+%trim(%editc(THGBGI:'3'))+'¬, '
        +'¬thgbgu¬ : ¬'+%trim(THGBGU)+'¬, '
        +'¬thkdc¬ : ¬'+%trim(THKDC)+'¬, '
        +'¬thtssd¬ : ¬'+%trim(THTSSD)+'¬, '
        +'¬thtsn1¬ : ¬'+%trim(THTSN1)+'¬, '
        +'¬thtsn2¬ : ¬'+%trim(THTSN2)+'¬, '
        +'¬thtspn¬ : ¬'+%trim(THTSPN)+'¬, '
        +'¬thtslk¬ : ¬'+%trim(THTSLK)+'¬, '
        +'¬thtssk¬ : ¬'+%trim(THTSSK)+'¬, '
        +'¬thlstl¬ : ¬'+%trim(%editc(THLSTL:'Z'))+'¬, '
        +'¬thvpos¬ : ¬'+%trim(%editc(THVPOS:'Z'))+'¬, '
        +'¬thntk¬ : ¬'+%trim(%editc(THNTK:'Z'))+'¬, '
        +'¬thvkb¬ : ¬'+%trim(%editc(THVKB:'4'))+'¬, '
        +'¬thdst¬ : ¬'+%trim(THDST)+'¬, '
        +'¬thdsk¬ : ¬'+%trim(THDSK)+'¬, '
        +'¬thtarf¬ : ¬'+%trim(THTARF)+'¬, '
        +'¬thws¬ : ¬'+%trim(THWS)+'¬, '
        +'¬thtrnr¬ : ¬'+%trim(THTRNR)+'¬, '
        +'¬thtrdt¬ : ¬'+%trim(%editc(THTRDT:'Z'))+'¬, '
        +'¬thomd¬ : ¬'+%trim(%editc(THOMD:'Z'))+'¬, '
        +'¬thbind¬ : ¬'+%trim(THBIND)+'¬, '
        +'¬thtet¬ : ¬'+%trim(%editc(THTET:'Z'))+'¬, '
        +'¬thmf¬ : ¬'+%trim(THMF)+'¬, '
        +'¬thmp¬ : ¬'+%trim(%editc(THMP:'Z'))+'¬, '
        +'¬thpkl¬ : ¬'+%trim(THPKL)+'¬, '
        +'¬thkdv¬ : ¬'+%trim(THKDV)+'¬, '
        +'¬th0035¬ : ¬'+%trim(TH0035)+'¬, '
        +'¬thsgdk¬ : ¬'+%trim(THSGDK)+'¬, '
        +'¬thsgme¬ : ¬'+%trim(THSGME)+'¬, '
        +'¬thsgut¬ : ¬'+%trim(THSGUT)+'¬, '
        +'¬thsgid¬ : ¬'+%trim(THSGID)+'¬, '
        +'¬thsgdt¬ : ¬'+%trim(THSGDT)+'¬, '
        +'¬thbyte¬ : ¬'+%trim(%editc(THBYTE:'Z'))+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     c                   eval      JSONstring ='"orderupdate" : ['
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     SVXH
     C  N50              CLOSE     SVXSTD
     C  N50              CLOSE     SVTHA
     C  N50              CLOSE     SVTHA2

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER   = zhbgetvar('USER')
     C                   EVAL      THAVD_A  = zhbgetvar('THAVD')
     C                   EVAL      THAVD    = c2n2(THAVD_A)
     C                   EVAL      THTDN_A  = zhbgetvar('THTDN')
     C                   EVAL      THTDN    = c2n2(THTDN_A)
     C                   EVAL      NEWSYAVA = zhbgetvar('NEWAVD')
     C                   EVAL      NEWAVD   = c2n2(NEWSYAVA)
     C                   EVAL      NEWSIGN  = zhbgetvar('NEWSIGN')
     C                   EVAL      WMODE    = zhbgetvar('MODE')
     C                   EVAL      THSG     = zhbgetvar('THSG')
     C                   EVAL      WSIGN    = zhbgetvar('SIGN')
     C                   EVAL      THST     = zhbgetvar('THST')
     C                   EVAL      THDT_A   = zhbgetvar('THDT')
     C                   EVAL      THDT     = c2n2(THDT_A)
     C                   EVAL      THPRO_A  = zhbgetvar('THPRO')
     C                   EVAL      THPRO    = c2n2(THPRO_A)
     C                   EVAL      THENKL   = zhbgetvar('THENKL')
     C                   EVAL      THDK     = zhbgetvar('THDK')
     C                   EVAL      THKNA_A  = zhbgetvar('THKNA')
     C                   EVAL      THKNA    = c2n2(THKNA_A)
     C                   EVAL      THNAA    = zhbgetvar('THNAA')
     C                   EVAL      THADA1   = zhbgetvar('THADA1')
     C                   EVAL      THPNA    = zhbgetvar('THPNA')
     C                   EVAL      THPSA    = zhbgetvar('THPSA')
     C                   EVAL      THLKA    = zhbgetvar('THLKA')
     C                   EVAL      THSKA    = zhbgetvar('THSKA')
     C                   EVAL      THTINA   = zhbgetvar('THTINA')
     C                   EVAL      THKNS_A  = zhbgetvar('THKNS')
     C                   EVAL      THKNS    = c2n2(THKNS_A)
     C                   EVAL      THNAS    = zhbgetvar('THNAS')
     C                   EVAL      THADS1   = zhbgetvar('THADS1')
     C                   EVAL      THPNS    = zhbgetvar('THPNS')
     C                   EVAL      THPSS    = zhbgetvar('THPSS')
     C                   EVAL      THLKS    = zhbgetvar('THLKS')
     C                   EVAL      THSKS    = zhbgetvar('THSKS')
     C                   EVAL      THTINS   = zhbgetvar('THTINS')
     C                   EVAL      THKNK_A  = zhbgetvar('THKNK')
     C                   EVAL      THKNK    = c2n2(THKNK_A)
     C                   EVAL      THNAK    = zhbgetvar('THNAK')
     C                   EVAL      THADK1   = zhbgetvar('THADK1')
     C                   EVAL      THPNK    = zhbgetvar('THPNK')
     C                   EVAL      THPSK    = zhbgetvar('THPSK')
     C                   EVAL      THLKK    = zhbgetvar('THLKK')
     C                   EVAL      THSKK    = zhbgetvar('THSKK')
     C                   EVAL      THTINK   = zhbgetvar('THTINK')
     C                   EVAL      THBLK    = zhbgetvar('THBLK')
     C                   EVAL      THLSD    = zhbgetvar('THLSD')
     C                   EVAL      THLASD   = zhbgetvar('THLASD')
     C                   EVAL      THLAS2   = zhbgetvar('THLAS2')
     C                   EVAL      THALK    = zhbgetvar('THALK')
     C                   EVAL      THTRM_A  = zhbgetvar('THTRM')
     C                   EVAL      THTRM    = c2n2(THTRM_A)
     C                   EVAL      THTRMI_A = zhbgetvar('THTRMI')
     C                   EVAL      THTRMI   = c2n2(THTRMI_A)
     C                   EVAL      THTAID   = zhbgetvar('THTAID')
     C                   EVAL      THTASK   = zhbgetvar('THTASK')
     C                   EVAL      THTALK   = zhbgetvar('THTALK')
     C                   EVAL      THTGID   = zhbgetvar('THTGID')
     C                   EVAL      THTGSK   = zhbgetvar('THTGSK')
     C                   EVAL      THTGLK   = zhbgetvar('THTGLK')
     C                   EVAL      THSKFD   = zhbgetvar('THSKFD')
     C                   EVAL      THCATS   = zhbgetvar('THCATS')
     C                   EVAL      THTSD1   = zhbgetvar('THTSD1')
     C                   EVAL      THTSD2   = zhbgetvar('THTSD2')
     C                   EVAL      THTSD3   = zhbgetvar('THTSD3')
     C                   EVAL      THTSD4   = zhbgetvar('THTSD4')
     C                   EVAL      THTSD5   = zhbgetvar('THTSD5')
     C                   EVAL      THTSD6   = zhbgetvar('THTSD6')
     C                   EVAL      THTSD7   = zhbgetvar('THTSD7')
     C                   EVAL      THTSD8   = zhbgetvar('THTSD8')
     C                   EVAL      THTSB    = zhbgetvar('THTSB')
     C                   EVAL      THDDT_A  = zhbgetvar('THDDT')
     C                   EVAL      THDDT    = c2n2(THDDT_A)
     C                   EVAL      THDFKD   = zhbgetvar('THDFKD')
     C                   EVAL      THDFSK   = zhbgetvar('THDFSK')
     C                   EVAL      THDKR    = zhbgetvar('THDKR')
     C                   EVAL      THDANT_A = zhbgetvar('THDANT')
     C                   EVAL      THDANT   = c2n2(THDANT_A)
     C                   EVAL      THDDTK_A = zhbgetvar('THDDTK')
     C                   EVAL      THDDTK   = c2n2(THDDTK_A)
     C                   EVAL      THDATS   = zhbgetvar('THDATS')
     C                   EVAL      THDKAV   = zhbgetvar('THDKAV')
     C                   EVAL      THDKSK   = zhbgetvar('THDKSK')
     C                   EVAL      THGKD_A  = zhbgetvar('THGKD')
     C                   EVAL      THGKD    = c2n2(THGKD_A)
     C                   EVAL      THGFT1   = zhbgetvar('THGFT1')
     C                   EVAL      THGFT2   = zhbgetvar('THGFT2')
     C                   EVAL      THGADK   = zhbgetvar('THGADK')
     C                   EVAL      THGBL_A  = zhbgetvar('THGBL')
     C                   EVAL      THGBL    = c2n2(THGBL_A)
     C                   EVAL      THGVK    = zhbgetvar('THGVK')
     C                   EVAL      THGBGI_A = zhbgetvar('THGBGI')
     C                   EVAL      THGBGI   = c2n2(THGBGI_A)
     C                   EVAL      THGBGU   = zhbgetvar('THGBGU')
     C                   EVAL      THKDC    = zhbgetvar('THKDC')
     C                   EVAL      THTSSD   = zhbgetvar('THTSSD')
     C                   EVAL      THTSN1   = zhbgetvar('THTSN1')
     C                   EVAL      THTSN2   = zhbgetvar('THTSN2')
     C                   EVAL      THTSPN   = zhbgetvar('THTSPN')
     C                   EVAL      THTSLK   = zhbgetvar('THTSLK')
     C                   EVAL      THTSSK   = zhbgetvar('THTSSK')
     C                   EVAL      THLSTL_A = zhbgetvar('THLSTL')
     C                   EVAL      THLSTL   = c2n2(THLSTL_A)
     C                   EVAL      THVPOS_A = zhbgetvar('THVPOS')
     C                   EVAL      THVPOS   = c2n2(THVPOS_A)
     C                   EVAL      THNTK_A  = zhbgetvar('THNTK')
     C                   EVAL      THNTK    = c2n2(THNTK_A)
     C                   EVAL      THVKB_A  = zhbgetvar('THVKB')
     C                   EVAL      THVKB    = c2n2(THVKB_A)
     C                   EVAL      THDST    = zhbgetvar('THDST')
     C                   EVAL      THDSK    = zhbgetvar('THDSK')
     C*                  EVAL      THTARF   = zhbgetvar('THTARF')
     C                   EVAL      THWS     = zhbgetvar('THWS')
     C                   EVAL      THTRNR   = zhbgetvar('THTRNR')
     C                   EVAL      THTRDT_A = zhbgetvar('THTRDT')
     C                   EVAL      THTRDT   = c2n2(THTRDT_A)
     C                   EVAL      THOMD_A  = zhbgetvar('THOMD')
     C                   EVAL      THOMD    = c2n2(THOMD_A)
     C                   EVAL      THBIND   = zhbgetvar('THBIND')
     C                   EVAL      THTET_A  = zhbgetvar('THTET')
     C                   EVAL      THTET    = c2n2(THTET_A)
     C                   EVAL      THMF     = zhbgetvar('THMF')
     C                   EVAL      THMP_A   = zhbgetvar('THMP')
     C                   EVAL      THMP     = c2n2(THMP_A)
     C                   EVAL      THPKL    = zhbgetvar('THPKL')
     C                   EVAL      THKDV    = zhbgetvar('THKDV')
     C*                  EVAL      TH0035   = zhbgetvar('TH0035')
     C*                  EVAL      THTUID   = zhbgetvar('THTUID')
     C*                  EVAL      THSGDK   = zhbgetvar('THSGDK')
     C*                  EVAL      THSGME   = zhbgetvar('THSGME')
     C*                  EVAL      THSGUT   = zhbgetvar('THSGUT')
     C*                  EVAL      THSGID   = zhbgetvar('THSGID')
     C*                  EVAL      THSGDT   = zhbgetvar('THSGDT')
     C*                  EVAL      THBYTE_A = zhbgetvar('THBYTE')
     C*                  EVAL      THBYTE   = c2n2(THBYTE_A)
     c                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end
      *
     C     SVXHKey       klist
     C                   kfld                    THAVD
     C                   kfld                    THTDN
     C     SVXHKeyG      klist
     C                   kfld                    GM_THAVD
     C                   kfld                    GM_THTDN
     C     *LIKE         DEFINE    X_THAVD       GM_THAVD
     C     *LIKE         DEFINE    X_THTDN       GM_THTDN
      *
     C   50              eval      Error = 'Invalid userID'
     C  N50              OPEN      SVXH
     C  N50              OPEN      SVXSTD
     C  N50              OPEN      SVTHA
     C  N50              OPEN      SVTHA2
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C     THSG          CHAIN     SVTHA                              33
     C                   MOVEL     SVTH_NAMN     THTARF

     c                   endsr
      *
      *______________________________________________________
      * TEST                                             TEST
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TEST          BEGSR
      * Hæmta userid
     C     WSUSER        CHAIN     SVTHA2
      * Hæmta ærende
     C     WMODE         IFNE      'A'
     C     SVXHKey       CHAIN     SVXH                               55
N01  C                   ELSE
N01  C                   EVAL      *IN55 = *ON
     C                   ENDIF
      * MODE A=Add  D=Delete  U=Update
     C                   SELECT
     C     WMODE         WHENEQ    'A'
     C                   eval      Error = *blanks
     C                   EXSR      SRA
     C     WMODE         WHENEQ    'C'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   UPDATE    SVXHR
     C                   eval      Error = *blanks
     C                   EXSR      SRC
     C                   ENDIF
     C     WMODE         WHENEQ    'D'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRD
     C                   ENDIF
     C     WMODE         WHENEQ    'S'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRS
     C                   ENDIF
     C     WMODE         WHENEQ    'U'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRU
     C                   ENDIF
     C                   OTHER
N01  C  N55              UPDATE    SVXHR
     C                   eval      Error = 'Wrong mode'
     C                   ENDSL
     C                   ENDSR
      *______________________________________________________
      * Add                                               SRA
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
     C                   CLEAR                   SVXHR
      * Hæmta uppdragsnummer
     C     THAVD         CHAIN     SVXSTD                             52
     C                   ADD       1             X_THTDN
     C                   UPDATE    SVXSTDR
     C                   EVAL      THTDN    = X_THTDN
     C                   EVAL      THST     = ' '
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = WSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
      * Hæmta tullid
     C                   CALL      'SVG001R'
     C                   PARM                    WTUID            10
     C*                  PARM                    X_THTUID
     C                   MOVE      UYEAR         XÅR               2
     C                   EVAL      X_THTUID = 'SE' + XÅR + WTUID
      * Write
     C                   WRITE     SVXHR
      * Oppdater WEB-variabler
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THST     = X_THST
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THNAA    = X_THNAA
     C                   EVAL      THADA1   = X_THADA1
     C                   EVAL      THPNA    = X_THPNA
     C                   EVAL      THPSA    = X_THPSA
     C                   EVAL      THLKA    = X_THLKA
     C                   EVAL      THSKA    = X_THSKA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THADS1   = X_THADS1
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THSKS    = X_THSKS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THADK1   = X_THADK1
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THSKK    = X_THSKK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THLSD    = X_THLSD
     C                   EVAL      THLASD   = X_THLASD
     C                   EVAL      THLAS2   = X_THLAS2
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTRMI   = X_THTRMI
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTASK   = X_THTASK
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGSK   = X_THTGSK
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THSKFD   = X_THSKFD
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THDDT    = X_THDDT
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THDFSK   = X_THDFSK
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKSK   = X_THDKSK
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THGBGI   = X_THGBGI
     C                   EVAL      THGBGU   = X_THGBGU
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THDSK    = X_THDSK
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
     C                   EVAL      THSGDK   = X_THSGDK
     C                   EVAL      THSGUT   = X_THSGUT
     C                   EVAL      THSGID   = X_THSGID
     C                   EVAL      THSGDT   = X_THSGDT
     C                   EVAL      THBYTE   = X_THBYTE
      *
     C                   ENDSR
      *______________________________________________________
      * Copy                                              SRC
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRC           BEGSR
     C                   EVAL      WSIGN = X_THSG
      * Hæmta uppdragsnummer
     C     NEWAVD        CHAIN     SVXSTD                             52
     C                   ADD       1             X_THTDN
     C                   UPDATE    SVXSTDR
     C                   EVAL      NEWOPD   = X_THTDN
      *
     C                   EVAL      GM_THAVD = THAVD
     C                   EVAL      GM_THTDN = THTDN
     C     SVXHKeyG      CHAIN(N)  SVXH                               55
     C                   EVAL      X_THAVD  = NEWAVD
     C                   EVAL      X_THTDN  = NEWOPD
     C                   EVAL      THAVD    = NEWAVD
     C                   EVAL      THTDN    = NEWOPD
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = NEWSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
     C                   EVAL      X_THTRNR = *BLANKS
     C                   EVAL      X_THTRDT = 0
     C                   EVAL      X_THOMD  = 0
     C                   EVAL      X_THBIND = *BLANKS
     C                   EVAL      X_THMF   = *BLANKS
     C                   EVAL      X_THMP   = 0
     C                   EVAL      X_THSGDK = *BLANKS
     C                   EVAL      X_THSGME = *BLANKS
     C                   EVAL      X_THSGUT = *BLANKS
     C                   EVAL      X_THSGID = *BLANKS
     C                   EVAL      X_THSGDT = *BLANKS
     C                   EVAL      X_THBYTE = 0
      * Hæmta tullid
     C                   CALL      'SVG001R'
     C                   PARM                    WTUID            10
     C                   MOVE      UYEAR         XÅR               2
     C                   EVAL      X_THTUID = 'SE' + XÅR + WTUID
      * Write
     C                   WRITE     SVXHR
      * Oppdater WEB-variabler
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THST     = X_THST
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THTUID   = X_THTUID
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THNAA    = X_THNAA
     C                   EVAL      THADA1   = X_THADA1
     C                   EVAL      THPNA    = X_THPNA
     C                   EVAL      THPSA    = X_THPSA
     C                   EVAL      THLKA    = X_THLKA
     C                   EVAL      THSKA    = X_THSKA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THADS1   = X_THADS1
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THSKS    = X_THSKS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THADK1   = X_THADK1
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THSKK    = X_THSKK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THLSD    = X_THLSD
     C                   EVAL      THLASD   = X_THLASD
     C                   EVAL      THLAS2   = X_THLAS2
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTRMI   = X_THTRMI
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTASK   = X_THTASK
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGSK   = X_THTGSK
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THSKFD   = X_THSKFD
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THDDT    = X_THDDT
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THDFSK   = X_THDFSK
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKSK   = X_THDKSK
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THGBGI   = X_THGBGI
     C                   EVAL      THGBGU   = X_THGBGU
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THDSK    = X_THDSK
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
     C                   EVAL      THSGDK   = X_THSGDK
     C                   EVAL      THSGUT   = X_THSGUT
     C                   EVAL      THSGID   = X_THSGID
     C                   EVAL      THSGDT   = X_THSGDT
     C                   EVAL      THBYTE   = X_THBYTE
      * Kopiera också varuposter
     C                   OPEN      SVXV
     C                   OPEN      SVXVAM
     C                   OPEN      SVXVVT
     C                   OPEN      SVXVDK
     C                   OPEN      SVXVCN
     C                   OPEN      SVXVMN

     C     SVXHKeyG      SETLL     SVXV
     C     SVXHKeyG      READE     SVXV                                   52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVR
     C     SVXHKeyG      READE     SVXV                                   52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVAM
     C     SVXHKeyG      READE     SVXVAM                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVAMR
     C     SVXHKeyG      READE     SVXVAM                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVVT
     C     SVXHKeyG      READE     SVXVVT                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVVTR
     C     SVXHKeyG      READE     SVXVVT                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVDK
     C     SVXHKeyG      READE     SVXVDK                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVDKR
     C     SVXHKeyG      READE     SVXVDK                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVCN
     C     SVXHKeyG      READE     SVXVCN                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVCNR
     C     SVXHKeyG      READE     SVXVCN                                 52
     C                   ENDDO

     C     SVXHKeyG      SETLL     SVXVMN
     C     SVXHKeyG      READE     SVXVMN                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     SVXVMNR
     C     SVXHKeyG      READE     SVXVMN                                 52
     C                   ENDDO

     C                   CLOSE     SVXV
     C                   CLOSE     SVXVAM
     C                   CLOSE     SVXVVT
     C                   CLOSE     SVXVDK
     C                   CLOSE     SVXVCN
     C                   CLOSE     SVXVMN

     C                   ENDSR
      *______________________________________________________
      * Delete                                            SRD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C                   EVAL      X_THST    = 'D'
     C                   EVAL      THST      = 'D'
     C                   UPDATE    SVXHR
     C                   ENDSR
      *______________________________________________________
      * Skicka                                            SRS
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRS           BEGSR
     C                   eval      Error = *blanks
     C                   UPDATE    SVXHR
      *____________________
      * Skapa edifact + fil
      *""""""""""""""""""""
     C                   CALL      'SVX013R'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM      '015'         X1N07             3
     C                   PARM                    UFLAGG            1 0
     C                   ENDSR
      *______________________________________________________
      * Update                                            SRU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRU           BEGSR
      *                  EVAL      X_THSG   = THSG
     C                   EVAL      X_THST   = THST
      *                  EVAL      X_THDT   = THDT
      *                  EVAL      X_THTUID = THTUID
     C                   EVAL      X_THPRO  = THPRO
     C                   EVAL      X_THENKL = THENKL
     C                   EVAL      X_THDK   = THDK
     C                   EVAL      X_THKNA  = THKNA
     C                   EVAL      X_THNAA  = THNAA
     C                   EVAL      X_THADA1 = THADA1
     C                   EVAL      X_THPNA  = THPNA
     C                   EVAL      X_THPSA  = THPSA
     C                   EVAL      X_THLKA  = THLKA
     C                   EVAL      X_THSKA  = THSKA
     C                   EVAL      X_THTINA = THTINA
     C                   EVAL      X_THKNS  = THKNS
     C                   EVAL      X_THNAS  = THNAS
     C                   EVAL      X_THADS1 = THADS1
     C                   EVAL      X_THPNS  = THPNS
     C                   EVAL      X_THPSS  = THPSS
     C                   EVAL      X_THLKS  = THLKS
     C                   EVAL      X_THSKS  = THSKS
     C                   EVAL      X_THTINS = THTINS
     C                   EVAL      X_THKNK  = THKNK
     C                   EVAL      X_THNAK  = THNAK
     C                   EVAL      X_THADK1 = THADK1
     C                   EVAL      X_THPNK  = THPNK
     C                   EVAL      X_THPSK  = THPSK
     C                   EVAL      X_THLKK  = THLKK
     C                   EVAL      X_THSKK  = THSKK
     C                   EVAL      X_THTINK = THTINK
     C                   EVAL      X_THBLK  = THBLK
     C                   EVAL      X_THLSD  = THLSD
     C                   EVAL      X_THLASD = THLASD
     C                   EVAL      X_THLAS2 = THLAS2
     C                   EVAL      X_THALK  = THALK
     C                   EVAL      X_THTRM  = THTRM
     C                   EVAL      X_THTRMI = THTRMI
     C                   EVAL      X_THTAID = THTAID
     C                   EVAL      X_THTASK = THTASK
     C                   EVAL      X_THTALK = THTALK
     C                   EVAL      X_THTGID = THTGID
     C                   EVAL      X_THTGSK = THTGSK
     C                   EVAL      X_THTGLK = THTGLK
     C                   EVAL      X_THSKFD = THSKFD
     C                   EVAL      X_THCATS = THCATS
     C                   EVAL      X_THTSD1 = THTSD1
     C                   EVAL      X_THTSD2 = THTSD2
     C                   EVAL      X_THTSD3 = THTSD3
     C                   EVAL      X_THTSD4 = THTSD4
     C                   EVAL      X_THTSD5 = THTSD5
     C                   EVAL      X_THTSD6 = THTSD6
     C                   EVAL      X_THTSD7 = THTSD7
     C                   EVAL      X_THTSD8 = THTSD8
     C                   EVAL      X_THTSB  = THTSB
     C                   EVAL      X_THDDT  = THDDT
     C                   EVAL      X_THDFKD = THDFKD
     C                   EVAL      X_THDFSK = THDFSK
     C                   EVAL      X_THDKR  = THDKR
     C                   EVAL      X_THDANT = THDANT
     C                   EVAL      X_THDKAV = THDKAV
     C                   EVAL      X_THDKSK = THDKSK
     C                   EVAL      X_THGKD  = THGKD
     C                   EVAL      X_THGFT1 = THGFT1
     C                   EVAL      X_THGFT2 = THGFT2
     C                   EVAL      X_THGADK = THGADK
     C                   EVAL      X_THGBL  = THGBL
     C                   EVAL      X_THGVK  = THGVK
     C                   EVAL      X_THGBGI = THGBGI
     C                   EVAL      X_THGBGU = THGBGU
     C                   EVAL      X_THKDC  = THKDC
     C                   EVAL      X_THTSSD = THTSSD
     C                   EVAL      X_THTSN1 = THTSN1
     C                   EVAL      X_THTSN2 = THTSN2
     C                   EVAL      X_THTSPN = THTSPN
     C                   EVAL      X_THTSLK = THTSLK
     C                   EVAL      X_THTSSK = THTSSK
     C                   EVAL      X_THLSTL = THLSTL
     C                   EVAL      X_THVPOS = THVPOS
     C                   EVAL      X_THNTK  = THNTK
     C                   EVAL      X_THVKB  = THVKB
     C                   EVAL      X_THDST  = THDST
     C                   EVAL      X_THDSK  = THDSK
     C                   EVAL      X_THTARF = THTARF
     C                   EVAL      X_THWS   = THWS
     C                   EVAL      X_THTRNR = THTRNR
     C                   EVAL      X_THTRDT = THTRDT
     C                   EVAL      X_THOMD  = THOMD
     C                   EVAL      X_THBIND = THBIND
     C                   EVAL      X_THTET  = THTET
     C                   EVAL      X_THMF   = THMF
     C                   EVAL      X_THMP   = THMP
     C                   EVAL      X_THPKL  = THPKL
     C                   EVAL      X_THKDV  = THKDV
     C*                  EVAL      X_TH0035 = TH0035
     C*                  EVAL      X_THSGDK = THSGDK
     C*                  EVAL      X_THSGUT = THSGUT
     C*                  EVAL      X_THSGID = THSGID
     C*                  EVAL      X_THSGDT = THSGDT
     C*                  EVAL      X_THBYTE = THBYTE
     C                   UPDATE    SVXHR
     C                   ENDSR
