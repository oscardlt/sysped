      *
     FTURER14   IF   E           K DISK
     FHEAD14    IF   E           K DISK
     FDOKUF     IF   E           K DISK
     FDOKUFM    IF   E           K DISK
     FSTSTUR    UF A E           K DISK
     FSTSOPD    UF A E           K DISK
     FSTSFBR    UF A E           K DISK
     FSTSCLI    UF A E           K DISK
     FSTSCLI1   UF   E           K DISK
     F                                     RENAME(STSCLIR:STSCLIR1)
     FSTS01D    CF   E             WORKSTN
     D                 DS
     D  FMMRK1                 1     35
     D  FMCLID                 1     20
     D                 DS
     D  XDT                    1      8  0
     D  XDT≈≈                  1      4  0
     D  XDTMM                  5      6  0
     D  XDTDD                  7      8  0
     D                 DS
     D  XTIME                  1     14  0
     D  XTID                   1      4  0
     D  XDD                    7      8  0
     D  XMM                    9     10  0
     D  X≈≈                   11     14  0
     D                SDS
     D  XUSER                254    263
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     STS01D01
     C                   MOVE      '0'           *IN30
     C   03              GOTO      SLUTT
     C     WSPRO         CHAIN     TURER14                            30
     C     *IN30         IFEQ      '1'
     C                   MOVE      'YBC1698'     MSGNR
     C                   GOTO      START
     C                   END
      *
     C                   EXSR      HANTAL
      *
     C     START2        TAG
     C     *IN30         IFEQ      '0'
     C     STANOK        ANDGE     STANOP
     C                   MOVE      'JOV1155'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   EXFMT     STS01D02
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   12              GOTO      START
     C   10              DO
     C                   EXSR      HANT2
     C                   GOTO      START
     C                   ENDDO
     C   20              DO
     C     TURKEY        CHAIN     STSTUR                             33
     C                   DELETE    STSTURR
     C                   GOTO      START2
     C                   ENDDO
      *
     C     WSCLID        IFNE      *BLANKS
     C                   EXSR      TESTB2
     C  N30              MOVE      *BLANKS       WSCLID
     C                   END
     C                   GOTO      START2
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HANTAL        BEGSR
     C***********************************************
     C     TURKEY        CHAIN(N)  STSTUR                             33
     C     *IN33         IFEQ      '1'                                          1<-B
      * TÿM GAMLE DATA P≈ STATUSFIL
      * OPD
     C     TURKEY        SETLL     STSOPD
     C     TURKEY        READE     STSOPD                                 33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C                   DELETE    STSOPDR
     C     TURKEY        READE     STSOPD                                 33
     C  N33              ENDDO                                                   2<-E
      * FBR
     C     TURKEY        SETLL     STSFBR
     C     TURKEY        READE     STSFBR                                 33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C                   DELETE    STSFBRR
     C     TURKEY        READE     STSFBR                                 33
     C  N33              ENDDO                                                   2<-E
      * CLI
     C     TURKEY        SETLL     STSCLI
     C     TURKEY        READE     STSCLI                                 33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C                   DELETE    STSCLIR
     C     TURKEY        READE     STSCLI                                 33
     C  N33              ENDDO                                                   2<-E
      *
      * HENT NYE DATA
     C                   CLEAR                   STSTURR
     C                   MOVE      *BLANKS       STTYPE
     C                   MOVE      WSPRO         STPRO
     C*                    Z-ADDTUAO      STANOP
      *
     C                   EXSR      HOPD
      *
     C                   WRITE     STSTURR
      *
     C                   END                                                    1<-E
      *
      * HENT ANTALL FOR ≈ VISE P≈ SKJERMEN
     C                   EXSR      HANTS
      *
     C                   ENDSR
      *
     C***********************************************
     C     HOPD          BEGSR
     C***********************************************
     C     WSPRO         SETLL     HEAD14
     C     WSPRO         READE     HEAD14                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             STANOP
     C                   CLEAR                   STSOPDR
     C                   MOVE      STTYPE        SOTYPE
     C                   MOVE      WSPRO         SOPRO
     C                   MOVE      HEAVD         SOAVD
     C                   MOVE      HEOPD         SOOPD
      *
     C                   EXSR      HFBR
      *
     C                   WRITE     STSOPDR
     C     WSPRO         READE     HEAD14                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     HFBR          BEGSR
     C***********************************************
     C     DOKUFK        SETLL     DOKUF
     C     DOKUFK        READE     DOKUF                                  33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             SOANFB
     C                   CLEAR                   STSFBRR
     C                   MOVE      SOTYPE        SFTYPE
     C                   MOVE      WSPRO         SFPRO
     C                   MOVE      DFAVD         SFAVD
     C                   MOVE      DFOPD         SFOPD
     C                   MOVE      DFFBNR        SFFBNR
      *
     C                   EXSR      HCLI
      *
     C                   WRITE     STSFBRR
     C     DOKUFK        READE     DOKUF                                  33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     HCLI          BEGSR
     C***********************************************
     C     DOKFMK        SETLL     DOKUFM
     C     DOKFMK        READE     DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             SFANKI
     C                   CLEAR                   STSCLIR
     C                   MOVE      SFTYPE        SCTYPE
     C                   MOVE      WSPRO         SCPRO
     C                   MOVE      FMAVD         SCAVD
     C                   MOVE      FMOPD         SCOPD
     C                   MOVE      FMFBNR        SCFBNR
     C                   MOVEL     FMMRK1        TMP18            18
     C                   MOVEL     '00'          SCCLID
     C                   MOVE      TMP18         SCCLID
     C                   WRITE     STSCLIR
     C     DOKFMK        READE     DOKUFM                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     HANTS         BEGSR
     C***********************************************
      * HENT TURENS TOTALER FOR
      * FRAKTBREV / FBR. KONTROLLERT.
     C                   MOVE      *ZEROS        WSANFB
     C                   MOVE      *ZEROS        WSANFK
     C     TURKEY        SETLL     STSOPD
     C     TURKEY        READE(N)  STSOPD                                 33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C                   ADD       SOANFB        WSANFB
     C                   ADD       SOANFK        WSANFK
     C     TURKEY        READE(N)  STSOPD                                 33
     C  N33              ENDDO                                                  1<-E
      * KOLLIID / KLID KONTROLLERT.
     C                   MOVE      *ZEROS        WSANKI
     C                   MOVE      *ZEROS        WSANKK
     C     TURKEY        SETLL     STSFBR
     C     TURKEY        READE(N)  STSFBR                                 33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C                   ADD       SFANKI        WSANKI
     C                   ADD       SFANKK        WSANKK
     C     TURKEY        READE(N)  STSFBR                                 33
     C  N33              ENDDO                                                  1<-E
      *
      * TURENS ANTAL OPPDRAG / ANTALL OPPDRAG KONTROLLERT.
     C     STANOP        COMP      STANOK                               5050
      *
     C                   ENDSR
      *
     C***********************************************
     C     HANT2         BEGSR
     C***********************************************
     C     TURKEY        CHAIN     STSTUR                             33
     C     *IN33         IFEQ      '1'                                          1<-B
     C                   EXSR      HANTAL
     C                   ELSE                                                   1
      * HENT NYE DATA
     C     WSPRO         SETLL     HEAD14
     C     WSPRO         READE     HEAD14                                 33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C     OPDKEY        CHAIN     STSOPD                             34
     C     *IN34         IFEQ      '1'                                            3<-B
     C                   EXSR      HOPD
     C                   Z-ADD     TUAO          STANOP
     C                   MOVE      *BLANKS       STSTAT
     C                   ELSE                                                     3
     C                   EXSR      HFBR2
     C                   UPDATE    STSOPDR
     C                   END                                                      3<-E
     C     WSPRO         READE     HEAD14                                 33
     C  N33              ENDDO                                                   2<-E
      *
     C                   UPDATE    STSTURR
     C                   END                                                    1<-E
      *
      * HENT ANTALL FOR ≈ VISE P≈ SKJERMEN
     C                   EXSR      HANTS
      *
     C                   ENDSR
      *
     C***********************************************
     C     HFBR2         BEGSR
     C***********************************************
     C     DOKUFK        SETLL     DOKUF
     C     DOKUFK        READE     DOKUF                                  33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C     FBRKEY        CHAIN     STSFBR                             33
     C     *IN33         IFEQ      '1'                                           2<-B
     C                   EXSR      HCLI
     C                   MOVE      *BLANKS       STSTAT
     C                   MOVE      *BLANKS       SOSTAT
     C                   ELSE                                                    2
      * HENT NYE DATA
     C                   EXSR      HCLI2
      *
     C                   UPDATE    STSFBRR
     C                   END                                                     2<-E
     C     DOKUFK        READE     DOKUF                                  33
     C  N33              ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     HCLI2         BEGSR
     C***********************************************
     C     DOKFMK        SETLL     DOKUFM
     C     DOKFMK        READE     DOKUFM                                 33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C     CLIKEY        CHAIN(N)  STSCLI                             33
     C     *IN33         IFEQ      '1'                                           2<-B
     C                   MOVE      *BLANKS       STSTAT
     C                   MOVE      *BLANKS       SOSTAT
     C                   MOVE      *BLANKS       SFSTAT
     C                   ADD       1             SFANKI
     C                   CLEAR                   STSCLIR
     C                   MOVE      SFTYPE        SCTYPE
     C                   MOVE      WSPRO         SCPRO
     C                   MOVE      FMAVD         SCAVD
     C                   MOVE      FMOPD         SCOPD
     C                   MOVE      FMFBNR        SCFBNR
     C                   MOVEL     FMMRK1        SCCLID
     C                   WRITE     STSCLIR
     C                   END                                                     2<-E
     C     DOKFMK        READE     DOKUFM                                 33
     C  N33              ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     CLIK1         CHAIN     STSCLI1                            30
     C     *IN30         IFEQ      '1'                                          1<-B
      * KOLLI-ID FINNES IKKE P≈ TUR
     C                   MOVE      'YBC1699'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   ELSE                                                   1
     C     SCSTAT        IFEQ      'X'                                           2<-B
      * KOLLI-ID ER KONTROLLERT FRA FÿR.
     C                   MOVE      'YBC1700'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   ELSE                                                    2
     C                   TIME                    XTIME
     C                   MOVE      XDD           XDTDD
     C                   MOVE      XMM           XDTMM
     C                   MOVE      X≈≈           XDT≈≈
     C                   MOVE      XDT           SCDT
     C                   MOVE      XTID          SCTID
     C                   MOVE      XUSER         SCUSER
     C                   MOVE      'X'           SCSTAT
     C     FBRK1         CHAIN     STSFBR                             33
     C                   ADD       1             SFANKK                          *FIL
     C                   ADD       1             WSANKK                          *P≈ SKJERM
     C     SFANKK        IFGE      SFANKI                                         3<-B
     C                   MOVE      'X'           SFSTAT
     C     OPDK1         CHAIN     STSOPD                             33
     C                   ADD       1             SOANFK                          *FIL
     C                   ADD       1             WSANFK                          *P≈ SKJERM
     C     SOANFK        IFGE      SOANFB                                          4<-B
     C                   MOVE      'X'           SOSTAT
     C     TURKEY        CHAIN     STSTUR                             33         *FIL
     C                   ADD       1             STANOK                          *SKJERM/FIL
     C     STANOK        IFGE      STANOP                                           5<-B
     C                   MOVE      'X'           STSTAT
     C                   END                                                        5<-E
     C                   UPDATE    STSTURR
     C                   END                                                       4<-E
     C                   UPDATE    STSOPDR
     C                   END                                                      3<-E
     C                   UPDATE    STSFBRR
     C                   END                                                     2<-E
      *
     C                   UPDATE    STSCLIR1
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *LIKE         DEFINE    STTYPE        YTYPE
      *
     C     TURKEY        KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C     OPDKEY        KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     FBRKEY        KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
     C     CLIKEY        KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMCLID
     C     OPDK1         KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C                   KFLD                    SFAVD
     C                   KFLD                    SFOPD
     C     FBRK1         KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C                   KFLD                    SCAVD
     C                   KFLD                    SCOPD
     C                   KFLD                    SCFBNR
     C     CLIK1         KLIST
     C                   KFLD                    YTYPE
     C                   KFLD                    WSPRO
     C                   KFLD                    WSCLID
     C     DOKUFK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     DOKFMK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
      *
     C                   MOVE      *BLANKS       YTYPE
     C                   MOVE      'F'           DFRI
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
