     F********************************************************************
     F* genererer flyfrakt innland for Lufthansa
     f* sonepriser er tatt ut
     F********************************************************************
     Fsted2d    iF a E           k disk
     Fairlh     uF a E           k disk
     Fairld     uF a E           k disk
     Fairldwrk  uF a E           k disk
N01  Fnoflypj   IP   E           k DISK
     Flhrater   if   E             disk
     F                                     USROPN
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     c                   exsr      opdste
     c                   exsr      lesfil
     clr                 exsr      opdhaw
     c*****************************************************
     c     lesfil        begsr
     c*****************************************************
     c                   setoff                                       33
     c     *in(33)       doweq     '0'
     c                   read      lhrater                                33
     c     *in(33)       ifeq      '0'
     c     F3            andne     'Standard  '
     c     F3            andne     *blanks
     c                   exsr      oppdat
     c                   endif
     c                   enddo
     c                   close     lhrater
     c                   endsr
     c*****************************************************
     c     oppdat        begsr
     c*****************************************************
     c*
     c* skjekker om stedet er i stedsregisteret
     c*
     c     keyste        klist
     c                   kfld                    st2lk
     c                   kfld                    st2kod
     c     keyhea        klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
      * fraflyplasss Norge
     c                   move      flkode        airpfr
      * til flyplass utland
     c     F2            ifne      *blanks
     c                   movel     F2            airpto
     c                   movel     f2            flypl5            5
     c                   end
     c*
     c* lh
     c*
     c                   z-add     20            airlin
     c     keyhea        chain     airlh                              34
     c                   move      'NOK'         aircur
     c     *in(34)       ifeq      '1'
     c                   write     airlhr
     c                   else
     c                   update    airlhr
     c                   end
     c                   exsr      detsr
     c                   endsr
     c*
     c*******************************************************************
     c     detsr         begsr
     c*******************************************************************
     c     keydet        klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   kfld                    airccp
     c*
     c* type pris
     c*
     c     F3            ifeq      'td.Pro    '
     c                   move      ' '           airccp
     c                   end
     c     F3            ifeq      'td.X      '
     c                   move      'X'           airccp
     c                   end
     c     F3            ifeq      'td.Flash  '
     c                   move      'Z'           airccp
     c                   end
     c*
     c*
     c*
     c* LH  sletter records
     c*
     c                   setoff                                       34
     c     keydet        setll     airld
     c     *in(34)       doweq     '0'
     c     keydet        reade     airld                                  34
     c  n34              delete    airldr
     c                   enddo
     c*
     c* skriver ny record N rate
     c*
     c                   z-add     F4            airgrn
     c                   z-add     F5            airawb
     c                   z-add     44            airwei
     c                   move      'N'           aircod
     c                   write     airldr
     c*
     c*
     c* skriver ny record q rate
     c*
     c                   z-add     0             airgrn
     c                   z-add     F6            airawb
     c                   z-add     99            airwei
     c                   move      'Q'           aircod
     c                   write     airldr
     c*
     c*
     c* skriver ny record q rate
     c*
     c                   z-add     0             airgrn
     c                   z-add     F7            airawb
     c     f8            ifeq      0
     c                   z-add     99999         airwei
     c                   else
     c                   z-add     499           airwei
     c                   end
     c                   move      'Q'           aircod
     c                   write     airldr
     c*
     c*
     c* skriver ny record q rate
     c*
     c     f8            ifne      0
     c                   z-add     0             airgrn
     c                   z-add     F8            airawb
     c                   z-add     99999         airwei
     c                   move      'Q'           aircod
     c                   write     airldr
     c                   end
     c*
     c                   endsr
     c*
     c*******************************************************************
     c     opdhaw        begsr
     c*******************************************************************
     c* leger eventuelle HAWB data tilbake
     c*
     c     keyd          klist
     c                   kfld                    airlin
     c                   kfld                    airpfr
     c                   kfld                    airpto
     c                   kfld                    airccp
     c                   kfld                    aircod
     c                   kfld                    airwei
     c                   setoff                                       35
     c     *loval        setll     airldwrk
     c     *in(35)       doweq     '0'
     c                   read      airldwrk                               35
     c     *in(35)       ifeq      '0'
     c     airham        ifne      0
     c     airhaw        orne      0
     c                   move      airham        wirham           13 2
     c                   move      airhaw        wirhaw           13 2
     c     keyd          chain     airld                              34
     c     *in(34)       ifeq      '0'
     c                   move      wirham        airham
     c                   move      wirhaw        airhaw
     c                   update    airldr
     c                   endif
     c                   endif
     c                   endif
     c                   enddo
     c                   endsr
     c******************************************************
     c     opdste        begsr
     c******************************************************
     c*
     c                   open      lhrater
     c                   setoff                                       33
     c     *in(33)       doweq     '0'
     c                   read      lhrater                                33
     c     *in(33)       ifeq      '0'
      *
      * start navn og flyplass
      *
     c     f1            ifne      *blanks
     c     f2            andne     *blanks
     c     f9            andne     *blanks
     c                   movel     f1            st2nvn
     c                   movel     f2            st2kod
     c                   movel     f9            st2lk
      *
     c     keyste        chain     sted2d                             34
     c     *in(34)       ifeq      '1'
     C     LO:UP         XLATE     st2nvn        st2nvn
     c                   write     sted2r
     c                   end
     c                   end
      *
      * slutt hovedløkke
      *
     c                   endif
     c                   enddo
     c                   close     lhrater
     c                   open      lhrater
     c                   setoff                                       33
     c                   endsr
