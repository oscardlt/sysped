      **************************************************************
      *** PROGRAM FOR Å SKRIVE LAGERLISTE                        ***
      **************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 JOV PTF11 Håndterer også Dansk(*in51)/Svensk(*in52) tollager
      *              TO DO-Svensk/dansk tekst - trimming
11XXX * 02 YBC PTF11 HENT FAKTURANR FRA LLLISF HVIS MRKREF = *BLANKS
11XXX * 03 CB  PTF11 Liten test av landkode vedr. MRN-NR
11XXX * 04 JOV PTF11 Farlieg tegn i vavare
********************************************************************
      *
     FKODTFM    IF   E           K DISK
     FLLMRFL08  IF   E           K DISK
     FLLAGJL07  IF   E           K DISK
     FLLAGJS07  IF   E           K DISK
     F                                     RENAME(LLAGJR:LLAGJRS7)
N01  FLLAGJFEU  IF   E           K DISK
     FLLAGJD01  IF   E           K DISK
     FLLHEAD    IF   E           K DISK
N01  FLLLISF    IF   E           K DISK
N01  FXXTOLLAG  O  A F 9999        DISK
N01  FFIRM      IF   E           K DISK
     FSADH      IF   E           K DISK
     FSAEH      IF   E           K DISK
N01  FSVIH      IF   E           K DISK
N01  FSVEH      IF   E           K DISK
N01  FLLSERL03  IF   E           K DISK
     FHEADF     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FLL025DPF  O    E             PRINTER OFLIND(*IN66)
     D Data9999        S           9999
     D                 DS
     D  MRMOTT                 1     15
     D  XXMOTT                 1     10
     D                 DS
     D  VAVARE                 1     35
     D  VAVARX                 1     15
     D                 DS
     D  XTID                   1      6  0
     D  XDTD                   7      8  0
     D  XDTM                   9     10  0
     D  XDTÅ                  11     14  0
     D  XTIME                  1     14  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                UDS
     D  UFIRM                  1      2
      *
     C                   EXSR      INIT
      *
      * FINN ALLE MOTTAKSRAPPORTER SOM PEKER PÅ GITTE GODSNR...
     C     WSGNF         SETLL     LLMRFL08
     C                   READ      LLMRFL08                               94
     C   94              GOTO      SLUTT
     C     NEXTMR        TAG
     C     MRGN          IFLE      WSGNT
     C     KUNDNR        IFEQ      0
     C     KUNDNR        ORNE      0
     C     KUNDNR        ANDEQ     MRKJED
     C                   EXSR      ENMRAP
     C                   END
     C                   READ      LLMRFL08                               94
     C  N94              GOTO      NEXTMR
     C                   END
      *
     C     SLUTT         TAG
      * SKRIV TOTALEN TILHØRENDE SIST LESTE BRUDD (MINST 1 POST LEST)
      * SAMT GRAND TOTAL
     C     POST1         IFEQ      'N'
s01  C*                  WRITE     TOTAL
s01  C*                  WRITE     GTOTAL
n01  C  N55              WRITE     TOTAL
n01  C  N55              WRITE     GTOTAL
     C                   ENDIF
      *
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      ******************************************************
     C     ENMRAP        BEGSR
      ******************************************************
     C  N50MRAKEY        SETLL     LLAGJL07                               39
     C   50MRAKEY        SETLL     LLAGJS07                               39
      *
     C     NYLIN         TAG
      *
     C  N50MRAKEY        READE     LLAGJL07                               39
     C   50MRAKEY        READE     LLAGJS07                               39
      *
      *
     C     *IN39         IFEQ      *OFF                                         B1
N04  c     ';':' '       XLATE     VAVARE        VAVARE
N04  c     '"':' '       XLATE     VAVARE        VAVARE
     C                   MOVE      VAKJED        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C   33              EVAL      KNAVN = '*UKJENT'
      *
      *       BEVAR BRUDDNØKKEL HVIS OK
     C                   MOVE      MRGN          NYBRUD           15
      *
      * SJEKK ANDRE FILTER, HOPP TIL NESTE
      * FRA/TIL ARTIKKEL
     C     WSARTF        IFNE      *BLANKS
     C     VAANR         ANDLT     WSARTF
     C                   GOTO      NYLIN
     C                   ENDIF
     C     WSARTT        IFNE      *BLANKS
     C     VAANR         ANDGT     WSARTT
     C                   GOTO      NYLIN
     C                   ENDIF
      * FRA/TIL LAGERLOKASJON
     C     WSLAGF        IFNE      *BLANKS
     C     VALLOK        ANDLT     WSLAGF
     C                   GOTO      NYLIN
     C                   ENDIF
     C     WSLAGT        IFNE      *BLANKS
     C     VALLOK        ANDGT     WSLAGT
     C                   GOTO      NYLIN
     C                   ENDIF
      * TYPE (P.T. HIDDEN)
     C     WSTYPE        IFNE      *BLANKS
     C     VAHK          ANDNE     WSTYPE
     C                   GOTO      NYLIN
     C                   END
      *
     C     *IN50         IFEQ      '0'
     C     WSSALD        ANDEQ     '0'
     C     VASALD        ANDNE     *ZEROS
     C                   GOTO      NYLIN
     C                   END
      *
      *
      *
      *  POSTEN ER OK - SJEKK FOR BRUDDVERDIER
      * BRUDD (OG DETTE ER IKKE FØRSTE LESTE POST) SKRIV DELTOTAL
      *
     C     NYBRUD        IFNE      GMBRUD
      *
     C     POST1         IFEQ      'N'
S01  C*                  WRITE     TOTAL
N01  C  N55              WRITE     TOTAL
     C                   MOVE      *ZEROS        TOTPOS
     C                   MOVE      *ZEROS        TOTSAL
     C                   MOVE      *ZEROS        TOTUPL
     C                   END
      *
      * SIDESKIFT VED BRUDD??
     C     WSBRUD        IFEQ      'J'
     C                   MOVE      *ON           *IN66
     C                   END
      *
     C                   END
      *
      *
      *
N01   *Tariffnr
N01  c                   move      *blanks       XXMOTT
N01  c     VAMN          setll     LLLISF
N01  c     VAMN          reade     LLLISF                                 33
N01  c     *in33         doweq     '0'
N01  c     LIKD          ifeq      'TAR'
N01  c                   movel     LITXT         XXMOTT
N01  c                   endif
N01  c     VAMN          reade     LLLISF                                 33
N01  c                   enddo
N01   *Købs-faktura
N01  c*                  movel     MRLREF        VALLOK
N01  c                   movel     MRLREF        KJFAKT           25
N01  c     FILAND        ifeq      'SE'
N01  c*                  eval      VALLOK = %subst(MRKREF:1:17)
N01  c                   eval      KJFAKT = %subst(MRKREF:1:17)
N01  c                   movel     VALLOK        GOLOKK            3            GodsLokalkod
N01  c                   endif
N02   *
N02  C                   IF        KJFAKT = *BLANKS
N02  C     VAMN          setll     LLLISF
N02  C     VAMN          reade     LLLISF                                 33
N02  C     *in33         doweq     '0'
N02  C     LIKD          ifeq      'FAK'
N02  C                   eval      KJFAKT = %subst(LITXT:1:17)
N02  C                   LEAVE
N02  C                   endif
N02  C     VAMN          reade     LLLISF                                 33
N02  C                   enddo
N02  C                   END
N02   *
N01   *Origin
N01  C     LLAGJFEUK     CHAIN     LLAGJFEU                           33
N01  C                   if        *IN33='0' and VAOPLK<>'  '
N01  c                   move      VAOPLK        OriLk             2
N01  c                   else
N01  c                   eval      OriLk = %SUBST(MRTRNR:17:2)
N01  c                   endif
N01   * blank 'Ori:CN' (f.eks) fra ..
N03  c     FILAND        IFEQ      'DK'
N01  c                   move      '      '      MRTRNR
N03  C                   ENDIF
      * OVERFLOW (ELLER STYRT SIDEBRUDD PR LAGERLOKASJON/DATO)
     C     *IN66         IFEQ      *ON
S01  C*                  WRITE     HEAD                                 66
N01  C  N55              WRITE     HEAD                                 66
     C     WSDET         IFNE      'J'
S01  C*                  WRITE     HEASTR                                        STREK
N01  C  N55              WRITE     HEASTR                                        STREK
     C                   END
     C                   END
N01  c                   if        WSFILE = 'J'
N01  c                   exsr      PRTSNRFIL
N01  c                   select
N01  c     FILAND        wheneq    'DK'
N01  c                   eval      Data9999 = 'TILskr;'                         Type;'
N01  c                             + %trim(MRGN)+'.;'                           Eksp.nr. TILskr;'
N01  c                             + %trim(XXMOTT)+';'                          Varenr.;'
N01  c                             + %trim(MRTRNR)+';'                          Proc. TILskr.;'
N01  c                             + %trim(ORILK)+';'                           Origin;'
N01  c                             + %trim(%editc(KUNDNR:'Z'))+';'              Kundenr
N01  c                             + %trim(KNAVN)+';'                           Kundenavn
N01  c                             + %trim(VAANR)+';'                           Stylenummer;'
N01  c                             + %trim(VAVARE)+';'                          Varebeskrivelse;'
N01  c                             + %trim(VAFAR)+';'                           Valuta;'
N01  c                             + %trim(%editc(VAVERD:'3'))+';'              Enhetsverdi;'
N01  c                             + %trim(KJFAKT)+';'                          Køpsfakturanr;'
N01  c                             + %trim(%editw(VADATO:'    .  .  '))+';'     Dato TILskrivning;
N01  c                             + %trim(%editc(VAOANT:'3'))+';'              Antal TILskrevet;'
N01  c                             + %trim(%editc(VASALD:'3'))+';'              Saldo;'
N01  c                             + ';'                                        Dato FRAskrivning;
N01  c                             + ';'                                        Antal FRAskrevet;'
N01  c                             + ';'                                        Eksp.nr. FRAskr;'
N01  c                             + ';'                                        Proc. FRAskr.'
N01  c                             + ';'                                        Syspedref uttak
N01  c                             + %trim(%editc(VAOANT:'3'))+';'              Netto INN
N01  c                             + ';'                                        Netto UT
N01  c                             + %trim(%editc(VASALD:'3'))+';'              SALDO
N01  c                             + %trim(SERTXTFIL)                           SERIEnr (INN/UT)
N01  c     FILAND        wheneq    'SE'
N01  c                   eval      Data9999 = 'INNLEGG;'
N01  c                             + %trim(GOLOKK)+';'
N01  c                             + %trim(MRGN)+';'
N01  c                             + %trim(MRTRNR)+';'
N01  c                             + %trim(%editc(KUNDNR:'Z'))+';'
N01  c                             + %trim(KNAVN)+';'
N01  c                             + %trim(VAANR)+';'
N01  c                             + %trim(VAVARE)+';'
N01  c                             + %trim(ORILK)+';'
N01  c                             + %trim(VAFAR)+';'                           Farge=Valuta :=)
N01  c                             + %trim(%editc(VAVERD:'3'))+';'
N01  c                             + %trim(KJFAKT)+';'                          lok lånes til K-fakt
N01  c                             + %trim(%editc(MRMRNR:'Z'))+';'
N01  c                             + %trim(%editw(VADATO:'    .  .  '))+';'
N01  c                             + %trim(%editc(VAOANT:'3'))+';'
N01  c                             + %trim(%editc(VASALD:'3'))+';'
N01  c                             + ';'                                        Antall uttak
N01  c                             + ';'                                        Dato uttak
N01  c                             + ';'                                        TullID/ref uttak
N01  c                             + ';'                                        Syspedref uttak
N01  c                             + %trim(%editc(VAOANT:'3'))+';'              Netto INN
N01  c                             + ';'                                        Netto UT
N01  c                             + %trim(%editc(VASALD:'3'))+';'              SALDO
N01  c                             + %trim(SERTXTFIL)                           SERIEnr (INN/UT)
N01  c                   other
N01  c                   eval      Data9999 = 'INNLEGG;'
N01  c                             + %trim(MRGN)+';'
N01  c                             + %trim(MRTRNR)+';'
N01  c                             + %trim(%editc(KUNDNR:'Z'))+';'
N01  c                             + %trim(KNAVN)+';'
N01  c                             + %trim(VAANR)+';'
N01  c                             + %trim(VAVARE)+';'
N01  c                             + %trim(ORILK)+';'
N01  c                             + %trim(VAFAR)+';'                           Farge=Valuta :=)
N01  c                             + %trim(%editc(VAVERD:'3'))+';'
N01  c                             + %trim(KJFAKT)+';'                          lok lånes til K-fakt
N01  c                             + %trim(%editc(MRMRNR:'Z'))+';'
N01  c                             + %trim(%editw(VADATO:'    .  .  '))+';'
N01  c                             + %trim(%editc(VAOANT:'3'))+';'
N01  c                             + %trim(%editc(VASALD:'3'))+';'
N01  c                             + ';'                                        Antall uttak
N01  c                             + ';'                                        Dato uttak
N01  c                             + ';'                                        TullID/ref uttak
N01  c                             + ';'                                        Syspedref uttak
N01  c                             + %trim(%editc(VAOANT:'3'))+';'              Netto INN
N01  c                             + ';'                                        Netto UT
N01  c                             + %trim(%editc(VASALD:'3'))+';'              SALDO
N01  c                             + %trim(SERTXTFIL)                           SERIEnr (INN/UT)
N01  c                   endsl
N01  c                   Except    CsvLin
N01  c                   endif
      * DOBBELTTREKT STREK FØR NESTE POST KUN NÅR SUBDETALJER SKRIVES
     C     WSDET         IFNE      'J'
S01  C*                  WRITE     DETALJ                               66
N01  C  N55              WRITE     DETALJ                               66
     C                   ELSE
S01  C*                  WRITE     DETSTR                                        STREK
S01  C*                  WRITE     DETALJ                               66
N01  C  N55              WRITE     DETSTR                                        STREK
N01  C  N55              WRITE     DETALJ                               66
N01  C                   EXSR      PRTSNR
     C                   EXSR      SUBDET
     C                   END
      *
      *
     C                   MOVE      NYBRUD        GMBRUD           15
     C                   MOVE      'N'           POST1             1
     C                   ADD       1             TOTPOS
     C                   ADD       VASALD        TOTSAL
     C                   ADD       VAOANT        TOTUPL
     C                   ADD       1             GTOPOS
     C                   ADD       VASALD        GTOSAL
     C                   ADD       VAOANT        GTOUPL
     C                   GOTO      NYLIN
      * END 39 *OFF
     C                   ENDIF                                                  E1
      *
      *
     C                   ENDSR
      *
      *
      ******************************************************
     C     SUBDET        BEGSR
      ******************************************************
     C     DETKEY        KLIST
     C                   KFLD                    VAGRUP
     C                   KFLD                    VAKJED
     C                   KFLD                    VAMN
      *
     C     DETKEY        SETLL     LLAGJD01
     C     DETKEY        READE     LLAGJD01                               33
      * DETALJOVERSKRIFT
S01  C* N33              WRITE     HEADET
N01  C  N33
N01  CanN55              WRITE     HEADET
     C     *IN33         DOWEQ     '0'
      * SIDEBRUDD...
     C     *IN66         IFEQ      *ON
S01  C*                  WRITE     HEAD                                 66
S01  C*                  WRITE     HEADET                               66
N01  C  N55              WRITE     HEAD                                 66
N01  C  N55              WRITE     HEADET                               66
     C                   END
      * HVIS UTTAK BASERT  PÅ PLUKKSEDDEL HENT REF DERFRA...
     C     VDLTYP        IFEQ      'PLIST'
     C     VDMNL         ANDNE     *ZEROS
     C     VDMNL         CHAIN     LLHEAD                             33
     C     *IN33         IFEQ      '0'
N01   * DOKUMENTASJON PÅ UTTAK LIGGER ENTEN I TEKSTEN ELLER HENTES FRA FORTOLLING
N01   * (DANSK FORTOLLING OPPDATERER TEKSTEN DIREKTE - bør med tiden kanskje
N01   *    også endres slik et "egen-fortolling" henter direkte fra toll-filene ??)
N01  c     FILAND        ifeq      'NO'
     C     SADKEY        CHAIN     SADH                               33
     C     *IN33         IFEQ      '0'
     C                   Eval      VDTEXT = 'Eks:'+SITLE+' Løp:'+SITLL
     C                   Goto      FortOK
     C                   END
     C     SADKEY        CHAIN     SAEH                               33
     C     *IN33         IFEQ      '0'
     C                   Eval      VDTEXT = 'Eks:'+SETLE+' Løp:'+SETLL
     C                   Goto      FortOK
     C                   END
N01  c                   ENDIF
N01   * SVENSK FORTOLLING - kan hente tullid fra ÆRENDET
N01  c     FILAND        ifeq      'SE'
N01  C   52SADKEY        CHAIN     SVIH                               33
N01  C   52*IN33         IFEQ      '0'
N01  C                   Eval      VDTEXT = 'T.Id: ' +SVIH_TUID
N01  C                                      +' (St:' +SVIH_SYST+')'
N01  C                   Goto      FortOK
N01  C                   END
N01  C   52SADKEY        CHAIN     SVEH                               33
N01  C   52*IN33         IFEQ      '0'
N01  C                   Eval      VDTEXT = 'T.Id: '+SVEH_TUID
N01  C                                      +' (St:' +SVEH_SYST+')'
N01  C                   Goto      FortOK
N01  C                   END
N01  C                   END
     C     SADKEY        CHAIN     HEADF                              33
     C     *IN33         IFEQ      '0'
     C     HETLL         IFNE      *BLANKS
     C                   Eval      VDTEXT = 'Eks:'+HETLE+' Løp:'+HETLL
     C                   Goto      FortOK
     C                   END
     C     HETLL         IFNE      *BLANKS
     C                   Eval      VDTEXT = 'Nytt godsnr:'+HEGNN
     C                   Goto      FortOK
     C                   END
     C                   END
     C     FortOK        TAG
     C                   END
     C                   END
KINGS * fjern grums fra excel-konvertering
KINGSC                   IF        %subst(VDTEXT:25:1)='('
KINGSc                   move      '      '      VDTEXT
KINGSC                   endif
N01   * hent sertifikat Detalj/uttak (må sjekke om logikken her kan ha flere sert på ett uttak)
N01  C                   move      *blanks       SNSN
N01  C     SerkeyD       chain     LLSERL03                           33
N01  C                   movel     SNSN          SNSN20           20
N01  c** flere ??        exsr      PRTSNRD
N01  c                   if        WSFILE = 'J'
N01  c                   exsr      PRTSNRFILD
N01  c                   move      *blanks       AvdOpd           12
N01  c                   eval      AvdOpd = %trim(%editc(VDAVD:'Z'))+'/'
N01  c                                    + %trim(%editc(VDOPD:'Z'))
N01  c                   select
N01  c     FILAND        wheneq    'DK'
N01  c                   eval      Data9999 = 'FRAskr;'                         Type;'
N01  c                             + %trim(MRGN)+'.;'                           Eksp.nr. TILskr;'
N01  c                             + %trim(XXMOTT)+';'                          Varenr.;'
N01  c                             + %trim(MRTRNR)+';'                          Proc. TILskr.;'
N01  c                             + %trim(ORILK)+';'                           Origin;'
N01  c                             + %trim(%editc(KUNDNR:'Z'))+';'              Kundenr
N01  c                             + %trim(KNAVN)+';'                           Kundenavn
N01  c                             + %trim(VAANR)+';'                           Stylenummer;'
N01  c                             + %trim(VAVARE)+';'                          Varebeskrivelse;'
N01  c                             + %trim(VAFAR)+';'                           Valuta;'
N01  c                             + %trim(%editc(VAVERD:'3'))+';'              Enhetsverdi;'
N01  c                             + %trim(KJFAKT)+';'                          Køpsfakturanr;'
N01  c                             + %trim(%editw(VADATO:'    .  .  '))+';'     Dato TILskrivning;'
N01  c                             + %trim(%editc(VAOANT:'3'))+';'              Antal TILskrevet;'
N01  c                             + %trim(%editc(VASALD:'3'))+';'              Saldo;'
N01  c                             + %trim(%editw(VDLDAT:'    .  .  '))+';'     Dato FRAskrivning;'
N01  c                             + %trim(%editc(VDLANT:'3'))+';'              Antal FRAskrevet;'
N01  c                             + %subst(VDTEXT:1:13)+'.;'                   Eksp.nr. FRAskr;'
N01  c                             + %subst(VDTEXT:17:7)+';'                    Proc. FRAskr.'
N01  c                             + %trim(AVDOPD)+';'                          SYSPEDREF
N01  c                             + ';'                                        Netto INN
N01  c                             + %trim(%editc(VDLANT:'3'))+';'              Netto UT
N01  c                             + ';'                                        SALDO
N01  c                             + %trim(SERTXTFIL)                           sertifikater
N01  c     FILAND        wheneq    'SE'
N01  c                   eval      Data9999 = 'Uttak;'
N01  c                             + %trim(GOLOKK)+';'
N01  c                             + %trim(MRGN)+';'
N01  c                             + %trim(MRTRNR)+';'
N01  c                             + %trim(%editc(KUNDNR:'Z'))+';'
N01  c                             + %trim(KNAVN)+';'
N01  c                             + %trim(VAANR)+';'
N01  c                             + %trim(VAVARE)+';'
N01  c                             + %trim(ORILK)+';'
N01  c                             + %trim(VAFAR)+';'                           Farge=Valuta :=)
N01  c                             + %trim(%editc(VAVERD:'3'))+';'
N01  c                             + %trim(KJFAKT)+';'
N01  c                             + %trim(%editc(MRMRNR:'Z'))+';'
N01  c                             + %trim(%editw(VADATO:'    .  .  '))+';'
N01  c                             + %trim(%editc(VAOANT:'3'))+';'
N01  c                             + %trim(%editc(VASALD:'3'))+';'
N01  c                             + %trim(%editc(VDLANT:'3'))+';'
N01  c                             + %trim(%editw(VDLDAT:'    .  .  '))+';'
N01  c                             + %trim(VDTEXT)+';'                          tullid/løpenr
N01  c                             + %trim(AVDOPD)+';'
N01  c                             + ';'                                        Netto INN
N01  c                             + %trim(%editc(VDLANT:'3'))+';'              Netto UT
N01  c                             + ';'                                        SALDO
N01  c                             + %trim(SERTXTFIL)
N01  c                   other
N01  c                   eval      Data9999 = 'Uttak;'
N01  c                             + %trim(MRGN)+';'
N01  c                             + %trim(MRTRNR)+';'
N01  c                             + %trim(%editc(KUNDNR:'Z'))+';'
N01  c                             + %trim(KNAVN)+';'
N01  c                             + %trim(VAANR)+';'
N01  c                             + %trim(VAVARE)+';'
N01  c                             + %trim(ORILK)+';'
N01  c                             + %trim(VAFAR)+';'                           Farge=Valuta :=)
N01  c                             + %trim(%editc(VAVERD:'3'))+';'
N01  c                             + %trim(KJFAKT)+';'
N01  c                             + %trim(%editc(MRMRNR:'Z'))+';'
N01  c                             + %trim(%editw(VADATO:'    .  .  '))+';'
N01  c                             + %trim(%editc(VAOANT:'3'))+';'
N01  c                             + %trim(%editc(VASALD:'3'))+';'
N01  c                             + %trim(%editc(VDLANT:'3'))+';'
N01  c                             + %trim(%editw(VDLDAT:'    .  .  '))+';'
N01  c                             + %trim(VDTEXT)+';'                          tullid/løpenr
N01  c                             + %trim(AVDOPD)+';'
N01  c                             + ';'                                        Netto INN
N01  c                             + %trim(%editc(VDLANT:'3'))+';'              Netto UT
N01  c                             + ';'                                        SALDO
N01  c                             + %trim(SERTXTFIL)
N01  c                   endsl
N01  c                   Except    CsvLin
N01  c                   endif
S01  C*                  WRITE     DETDET
N01  C  N55              WRITE     DETDET
     C     DETKEY        READE     LLAGJD01                               33
     C                   END
     C                   ENDSR
      *
N01   *
N01   ******************************************************
N01  C     PRTSNR        BEGSR
N01   ******************************************************
N01   *
N01  C                   MOVE      0             ANTSER            3 0
N01  C                   MOVE      *BLANKS       SERTXT          120
N01  C     VAMN          SETLL     LLSERL03
N01  C     VAMN          READE     LLSERL03                               33
N01  C     *IN33         DOWEQ     '0'
N01  c                   move      *blanks       SERST             3
N01  c                   if        SNST = 'P'
N01  c                   eval      SERST= '(P)'
N01  c                   else
N01  c                   eval      SERST= '( )'
N01  c                   endif
N01  C                   EVAL      SERTXT = %TRIM(SERTXT)+'  '
N01  C                                    + %TRIM(SNSN)+ SERST
N01  C                   ADD       1             ANTSER
N01  C     ANTSER        IFEQ      5
N01   * SIDEBRUDD...
N01  C     *IN66         IFEQ      *ON
N01  C  N55              WRITE     HEAD                                 66
N01  C  N55              WRITE     HEADET                               66
N01  C                   END
N01  C  N55              WRITE     SERLIN
N01  C                   MOVE      0             ANTSER
N01  C                   MOVE      *BLANKS       SERTXT
N01  C                   ENDIF
N01  C     VAMN          READE     LLSERL03                               33
N01  C                   ENDDO
N01   *
N01  C     ANTSER        IFGT      0
N01   * SIDEBRUDD...
N01  C     *IN66         IFEQ      *ON
N01  C  N55              WRITE     HEAD                                 66
N01  C  N55              WRITE     HEADET                               66
N01  C                   END
N01  C  N55              WRITE     SERLIN
N01  C                   ENDIF
N01  C                   ENDSR
N01   *
N01   ******************************************************
N01  C     PRTSNRFIL     BEGSR
N01   ******************************************************
N01   *
N01  C                   MOVE      0             ANTSER
N01  C                   MOVE      *BLANKS       SERTXTFIL      9000
N01  C     VAMN          SETLL     LLSERL03
N01  C     VAMN          READE     LLSERL03                               33
N01  C     *IN33         DOWEQ     '0'
N01  C                   ADD       1             ANTSER
N01  c                   move      *blanks       SERST             3
N01  c                   if        SNST = 'P'
N01  c                   eval      SERST= '(P)'
N01  c                   else
N01  c                   eval      SERST= '( )'
N01  c                   endif
N01  C     ANTSER        IFEQ      1
N01  C                   EVAL      SERTXTFIL = %TRIM(SNSN)+ SERST
N01  C                   else
N01  C                   EVAL      SERTXTFIL = %TRIM(SERTXTFIL)+'  '
N01  C                                    + %TRIM(SNSN)+ SERST
N01  C                   endif
N01  C     VAMN          READE     LLSERL03                               33
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
N01   ******************************************************
N01  C     PRTSNRFILD    BEGSR
N01   ******************************************************
N01   *
N01  C                   MOVE      0             ANTSER
N01  C                   MOVE      *BLANKS       SERTXTFIL      9000
N01  C     SerkeyD       SETLL     LLSERL03
N01  C     SerkeyD       READE     LLSERL03                               33
N01  C     *IN33         DOWEQ     '0'
N01  C                   ADD       1             ANTSER
N01  C     ANTSER        IFEQ      1
N01  C                   EVAL      SERTXTFIL = %TRIM(SNSN)
N01  C                   else
N01  C                   EVAL      SERTXTFIL = %TRIM(SERTXTFIL)+'  '
N01  C                                    + %TRIM(SNSN)
N01  C                   endif
N01  C     SerkeyD       READE     LLSERL03                               33
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
      ******************************************************
     C     INIT          BEGSR
      ******************************************************
     C     *ENTRY        PLIST
     C                   PARM                    WSGNF            15            GODNR    FRA
     C                   PARM                    WSGNT            15            GODSNR   TIL
     C                   PARM                    WSARTF           15            ARTIKKEL FRA
     C                   PARM                    WSARTT           15            ARTIKKEL TIL
     C                   PARM                    UPNR              8            LAGERKUNDE
     C                   PARM                    WSLAGF           25            LAG.LOK. FRA
     C                   PARM                    WSLAGT           25            LAG.LOK. TIL
     C                   PARM                    WSDET             1            SUBDETALJER
     C                   PARM                    WSSALD            1            KUN SALDO...
     C                   PARM                    WSTYPE            3            KUN KRT/HPL
     C                   PARM                    WSBRUD            1            SIDEBRUDD
     C     LASER         PARM      LASER         LASER             1
     C     STRING        PARM      STRING        STRING            5
     C     COPY          PARM      COPY          COPY              2 0
N01  C                   PARM                    WSFILE            1
      *
     C     STRING        IFNE      *BLANKS
     C     STRING        CHAIN     KODTFM                             33
     C                   END
     C     LASER         IFEQ      'A'
     C                   SETON                                        88
     C                   END
      * 50 ON=LES LF SOM BARE INKL. POSTER MED SALDO ULIK 0
     C     WSSALD        COMP      '+'                                    50
      * 50 ON = KUN POSTER MED SALDO ULIK 0
      * 50 OFF= HVIS WSSALD ' ' -> SKRIV ALLE POSTER
      * 50 OFF= HVIS WSSALD '0' -> SKRIV KUN POSTER MED SALDO 0
      *
N01  c     UFIRM         chain     FIRM
N01   * 51 ON = DK
N01  C     FILAND        COMP      'DK'                                   51
N01   * 52 ON = SE
N01  C     FILAND        COMP      'SE'                                   52
N01   * 55 ON = KUN TIL FIL / IKKE PRINT
N01  c     WSFILE        ifeq      'F'
N01  c                   move      *on           *in55
N01  c                   move      'J'           WSFILE
N01  C                   endif
      *
     C     MRAKEY        KLIST
     C                   KFLD                    MRGRUP
     C                   KFLD                    MRKJED
     C                   KFLD                    MRMRNR
     C     SADKEY        KLIST
     C                   KFLD                    LHAVD
     C                   KFLD                    LHOPD
     C     CUNDL01K      KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
N01  C     LLAGJFEUK     KLIST
N01  C                   KFLD                    VAGRUP
N01  C                   KFLD                    VAKJED
N01  C                   KFLD                    VAMN
N01  C     SerkeyD       KLIST
N01  C                   KFLD                    VDMN
N01  C                   KFLD                    VDVN
      *
     C                   MOVE      *ZEROS        GTOPOS            9 0
     C                   MOVE      *ZEROS        GTOSAL            9 0
     C                   MOVE      *ZEROS        GTOUPL            9 0
     C                   TIME                    XTIME
     C                   MOVE      XDTD          XIDAGD
     C                   MOVE      XDTM          XIDAGM
     C                   MOVE      XDTÅ          XIDAGÅ
     C*
      *
      * *IN66=SIDEBRUDD (FRAMTVING PÅ 1. SIDE)
     C                   MOVE      *ON           *IN66
      *
      *
     C     WSARTF        IFEQ      *BLANKS
     C                   MOVEL     *BLANKS       WSARTF
     C                   END
     C     WSARTT        IFEQ      *BLANKS
     C                   MOVEL     '99999999'    WSARTT
     C                   END
     C                   MOVE      UPNR          KUNDNR
N01  C                   IF        KUNDNR = 0
S01  C*                  EVAL      KNAVN = 'ALLE'
N01  c                   select
N01  c     FILAND        wheneq    'DK'
N01  C                   EVAL      KNAVN = 'ALLE TOLDLAGERKUNDER'
N01  c     FILAND        wheneq    'SE'
N01  C                   EVAL      KNAVN = 'ALLE TOLLAGERKUNDER'
N01  c                   other
N01  C                   EVAL      KNAVN = 'ALLE TOLLAGERKUNDER'
N01  c                   endsl
     C                   ELSE
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C   33              EVAL      KNAVN = '*UKJENT'
     C                   END
N01  c                   eval      KUNKNR = KUNDNR
N01  c                   eval      KUNKNAV= KNAVN
      *
N01  c                   if        WSFILE = 'J'
N01  c                   select
N01  c     FILAND        wheneq    'DK'
N01  c                   move      *blanks       DATA9999
N01  c                   eval      Data9999 = 'ToldlagerListe for '
N01  c                                      + %trim(FIFT)+ ' - ' + KNAVN
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Eksp.Nr fra '+ WSGNF
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Eksp.Nr til '+ WSGNT
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = *blanks
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'MERK: Verdier for TILskrivning e'
N01  c                             +'r duplisert til alle "FRAskrivninger" for '
N01  c                             +'bedre sortering/filtreringsmuligheter.'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Det betyr at summering av disse '
N01  c                             +'kolonnene er "farlig". (Om en ikke først '
N01  c                             +'filtrerer på type.)'
N01  c                             +'  For totalsummering se kolonnene '
N01  c                             +'INN Netto, UT Netto, SALDO'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Mange av kolonnene er medtatt '
N01  c                             +'kun av interne kontroll-hensyn. '
N01  c                             +'Skal dokumentet brukes eksternt slett de '
N01  c                             +'kolonner som det ikke er behov for.'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'OBS!  Poster med Dato Uttak= '
N01  c                             +'99999999 = "på gang". Dvs allokert '
N01  c                             +'til en plukkseddel som ennå ikke er full'
N01  c                             +'ført. Rent datamessig er disse allerede '
N01  c                             +'trukket fra artikkelens saldo (men '
N01  c                             +'rent fysisk kan jo varene ennå ligge på '
N01  c                             +'lageret. Ved telling/rapportering må en ta'
N01  c                             +' hensyn til dette.)'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = *blanks
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Type;'
N01  c                                      + 'Eksp.nr. TILskr;'
N01  c                                      + 'Varenr.;'
N01  c                                      + 'Proc. TILskr.;'
N01  c                                      + 'Origin;'
N01  c                                      + 'Kundenummer;'
N01  c                                      + 'Kundenavn;'
N01  c                                      + 'Stylenummer;'
N01  c                                      + 'Varebeskrivelse;'
N01  c                                      + 'Valuta;'
N01  c                                      + 'Enhetsverdi;'
N01  c                                      + 'Køpsfakturanr;'
N01  c                                      + 'Dato TILskrivning;'
N01  c                                      + 'Antal TILskrevet;'
N01  c                                      + 'Saldo;'
N01  c                                      + 'Dato FRAskrivning;'
N01  c                                      + 'Antal FRAskrevet;'
N01  c                                      + 'Eksp.nr. FRAskr;'
N01  c                                      + 'Proc. FRAskr;'
N01  c                                      + 'SyspedRef Uttak;'
N01  c                                      + 'INN Netto;'
N01  c                                      + 'UT Netto;'
N01  c                                      + 'SALDO;'
N01  c                                      + 'SerieNummer'
N01  c     FILAND        wheneq    'SE'
N01  c                   move      *blanks       DATA9999
N01  c                   eval      Data9999 = 'TollagerListe for '
N01  c                                      + %trim(FIFT)+ ' - ' + KNAVN
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Gods.Nr fra '+ WSGNF
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Gods.Nr til '+ WSGNT
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = *blanks
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'MERK: Verdiene for INNLEGG er '
N01  c                             +'duplisert til alle "Uttak" for bedre '
N01  c                             +'sortering/filtreringsmuligheter.'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Det betyr at summering av disse '
N01  c                             +'kolonnene er "farlig". (Om en ikke først '
N01  c                             +'filtrerer på type.)'
N01  c                             +'  For totalsummering se kolonnene '
N01  c                             +'INN Netto, UT Netto, SALDO'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Mange av kolonnene er medtatt '
N01  c                             +'kun av interne kontroll-hensyn. '
N01  c                             +'Skal dokumentet brukes eksternt slett de '
N01  c                             +'kolonner som det ikke er behov for.'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'OBS!  Poster med Dato Uttak= '
N01  c                             +'99999999 = "på gang". Dvs allokert '
N01  c                             +'til en plukkseddel som ennå ikke er full'
N01  c                             +'ført. Rent datamessig er disse allerede '
N01  c                             +'trukket fra artikkelens saldo (men '
N01  c                             +'rent fysisk kan jo varene ennå ligge på '
N01  c                             +'lageret. Ved telling/rapportering må en ta'
N01  c                             +' hensyn til dette.)'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = *blanks
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Type;'
N01  c                                      + 'GodsLokalKod;'
N01  c                                      + 'Godsnummer;'
N01  c                                      + 'MRNnummer;'
N01  c                                      + 'Kundenummer;'
N01  c                                      + 'Kundenavn;'
N01  c                                      + 'Varenummer;'
N01  c                                      + 'Varebeskrivelse;'
N01  c                                      + 'VareOrigin;'
N01  c                                      + 'Valuta;'
N01  c                                      + 'Enhetsverdi;'
N01  c                                      + 'Køpsfakturanr;'
N01  c                                      + 'Mottaksrapportnr;'
N01  c                                      + 'Dato INNLEGG;'
N01  c                                      + 'Antal INNLEGG;'
N01  c                                      + 'Saldo;'
N01  c                                      + 'Antal Uttak;'
N01  c                                      + 'Dato Uttak;'
N01  c                                      + 'TullID Uttak;'
N01  c                                      + 'SyspedRef Uttak;'
N01  c                                      + 'INN Netto;'
N01  c                                      + 'UT Netto;'
N01  c                                      + 'SALDO;'
N01  c                                      + 'SerieNummer'
N01  c                   other
N01  c                   move      *blanks       DATA9999
N01  c                   eval      Data9999 = 'TollagerListe for '
N01  c                                      + %trim(FIFT)+ ' - ' + KNAVN
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Gods.Nr fra '+ WSGNF
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Gods.Nr til '+ WSGNT
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = *blanks
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'MERK: Verdiene for INNLEGG er '
N01  c                             +'duplisert til alle "Uttak" for bedre '
N01  c                             +'sortering/filtreringsmuligheter.'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Det betyr at summering av disse '
N01  c                             +'kolonnene er "farlig". (Om en ikke først '
N01  c                             +'filtrerer på type.)'
N01  c                             +'  For totalsummering se kolonnene '
N01  c                             +'INN Netto, UT Netto, SALDO'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Mange av kolonnene er medtatt '
N01  c                             +'kun av interne kontroll-hensyn. '
N01  c                             +'Skal dokumentet brukes eksternt slett de '
N01  c                             +'kolonner som det ikke er behov for.'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'OBS!  Poster med Dato Uttak= '
N01  c                             +'99999999 = "på gang". Dvs allokert '
N01  c                             +'til en plukkseddel som ennå ikke er full'
N01  c                             +'ført. Rent datamessig er disse allerede '
N01  c                             +'trukket fra artikkelens saldo (men '
N01  c                             +'rent fysisk kan jo varene ennå ligge på '
N01  c                             +'lageret. Ved telling/rapportering må en ta'
N01  c                             +' hensyn til dette.)'
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = *blanks
N01  c                   Except    CsvLin
N01  c                   eval      Data9999 = 'Type;'
N01  c                                      + 'Godsnummer;'
N01  c                                      + 'MRNnummer;'
N01  c                                      + 'Kundenummer;'
N01  c                                      + 'Kundenavn;'
N01  c                                      + 'Varenummer;'
N01  c                                      + 'Varebeskrivelse;'
N01  c                                      + 'VareOrigin;'
N01  c                                      + 'Valuta;'
N01  c                                      + 'Enhetsverdi;'
N01  c                                      + 'Køpsfakturanr;'
N01  c                                      + 'Mottaksrapportnr;'
N01  c                                      + 'Dato INNLEGG;'
N01  c                                      + 'Antal INNLEGG;'
N01  c                                      + 'Saldo;'
N01  c                                      + 'Antal Uttak;'
N01  c                                      + 'Dato Uttak;'
N01  c                                      + 'Eksp/Løpenr Uttak;'
N01  c                                      + 'SyspedRef Uttak;'
N01  c                                      + 'INN Netto;'
N01  c                                      + 'UT Netto;'
N01  c                                      + 'SALDO;'
N01  c                                      + 'SerieNummer'
N01  c                   endsl
N01  c                   Except    CsvLin
N01  c                   endif
     C                   ENDSR
      *
N01  OXXTOLLAG  EADD         CsvLin
N01  O                       Data9999          9999
