********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 CB  PTF10 Fjernet all merking
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 02 YBC PTF11 OPPRETT MAPPE I IFS VED EHF
11XXX * 03 SH  PTF11 Pod signatur
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 04 YBC PTF12 Opprett mappe ved nettverk=A pga. EHF
12XXX * 05 JOV PTF12 Avvikende mappe pr EDI-type
12XXX * 06 JOV PTF12 chain avikende mappe først/SÅ standard (ingen merking)
12XXX * 07 JOV PTF12 Vindu for å bekrevfte sletting av EDI-part
12XXX * 08 JOV PTF12 user TULLTAXAn er RESERVERt for nedlasting - opsjon I -> EDIRE1K
********************************************************************
      *
     FEDI50D    CF   E             WORKSTN
     F                                     SFILE(EDI50DA:ZRECNO)
     FEDII      UF A E           K DISK
     FEDII1     IF   E           K DISK
     F                                     RENAME(EDIIR:EDIIR1)
     FEDII3     IF   E           K DISK
     F                                     RENAME(EDIIR:EDIIR3)
     FEDII4     IF   E           K DISK
     F                                     RENAME(EDIIR:EDIIR4)
     FEDII5     IF   E           K DISK
     F                                     RENAME(EDIIR:EDIIR5)
     F*DIIF     UF A E           K DISK
N05  FEDIIAM    IF   E           K DISK
     D QCMDA           S            512
     D QCMDL           S             15  5
     D QWDIR           S            512
     DWKAT             DS
     D  WSFTXT                 1    650
     D    WSFTX01              1     65
     D    WSFTX02             66    130
     D    WSFTX03            131    195
     D    WSFTX04            196    260
     D    WSFTX05            261    325
     D    WSFTX06            326    390
     D    WSFTX07            391    455
     D    WSFTX08            456    520
     D    WSFTX09            521    585
     D    WSFTX10            586    650
     D                 DS
     D  INFTXT                 1    650
     D    INFTX01              1     65
     D    INFTX02             66    130
     D    INFTX03            131    195
     D    INFTX04            196    260
     D    INFTX05            261    325
     D    INFTX06            326    390
     D    INFTX07            391    455
     D    INFTX08            456    520
     D    INFTX09            521    585
     D    INFTX10            586    650
N03  D                 DS
N03  D  WSPOD                  1    650
N03  D    WSPOD01              1     65
N03  D    WSPOD02             66    130
N03  D    WSPOD03            131    195
N03  D    WSPOD04            196    260
N03  D    WSPOD05            261    325
N03  D    WSPOD06            326    390
N03  D    WSPOD07            391    455
N03  D    WSPOD08            456    520
N03  D    WSPOD09            521    585
N03  D    WSPOD10            586    650
N03  D                 DS
N03  D  INPOD                  1    650
N03  D    INPOD01              1     65
N03  D    INPOD02             66    130
N03  D    INPOD03            131    195
N03  D    INPOD04            196    260
N03  D    INPOD05            261    325
N03  D    INPOD06            326    390
N03  D    INPOD07            391    455
N03  D    INPOD08            456    520
N03  D    INPOD09            521    585
N03  D    INPOD10            586    650
      *   SYEDI data area
     D EDIDTA          DS           256
     D  UELIBF               171    180
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
     C     *LIKE         DEFINE    ZRECNO        WRECNO
     C     *LIKE         DEFINE    INID          WNID
     C     *LIKE         DEFINE    INID          WNID2
     C                   MOVE      *BLANKS       WNID3            35
     C                   MOVE      *BLANKS       WNID4            35
     C     *LIKE         DEFINE    *IN03         WIN03
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WNID
      * Åpne dataarea
     C     *DTAARA       DEFINE                  EDIDTA
     C                   IN        EDIDTA
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *
     C                   MOVE      *BLANKS       ZNID
     C                   MOVE      *BLANKS       ZNNA
     C                   EVAL      ZNNETW=*BLANKS
     C                   EVAL      ZNEX=*BLANKS
      *
     C     SRB1          TAG
      *______________
      * Tømme Subfile
      *""""""""""""""
     C                   MOVE      '1'           *IN93
     C                   WRITE     EDI50DB
     C                   MOVEA     '000'         *IN(93)
     C                   Z-ADD     *ZERO         ZRECNO
     C                   Z-ADD     *ZERO         WRECNO
     C                   MOVE      *BLANKS       WNID
     C                   MOVEA     '000'         *IN(61)
     C     ZNNA          IFNE      *BLANKS
     C                   MOVE      *ON           *IN61
     C                   ENDIF
     C     ZNNETW        IFNE      *BLANKS
     C                   EVAL      *IN62=*ON
     C                   ENDIF
     C     ZNEX          IFNE      *BLANKS
     C                   EVAL      *IN63=*ON
     C                   ENDIF
      *_____________
      * Fyll Subfile
      *"""""""""""""
      *          KEYA      SETLLEDII1
     C     ZNID          SETLL     EDII1
     C     ZNNA          SETLL     EDII3
     C     ZNNETW        SETLL     EDII4
     C     ZNEX          SETLL     EDII5
     C                   SELECT
     C     *IN61         WHENEQ    *ON
     C                   READ      EDII3                                  94
     C     *IN62         WHENEQ    *ON
     C                   READ      EDII4                                  94
     C     *IN63         WHENEQ    *ON
     C                   READ      EDII5                                  94
     C                   OTHER
     C                   READ      EDII1                                  94
     C                   ENDSL
      *
     C     *IN94         DOWEQ     '0'

     C     INFTX01       COMP      *BLANKS                            6060
     C                   ADD       1             ZRECNO
     C                   Z-ADD     ZRECNO        WRECNO
     C                   WRITE     EDI50DA
     C                   SELECT
     C     *IN61         WHENEQ    *ON
     C                   READ      EDII3                                  94
     C     *IN62         WHENEQ    *ON
     C                   READ      EDII4                                  94
     C     *IN63         WHENEQ    *ON
     C                   READ      EDII5                                  94
     C                   OTHER
     C                   READ      EDII1                                  94
     C                   ENDSL
     C  N94              END
      *
     C     ZRECNO        IFEQ      0
     C                   MOVE      ' '           INID
     C                   ADD       1             ZRECNO
     C                   EVAL      *IN60=*OFF
     C                   WRITE     EDI50DA
     C                   ENDIF
     C                   Z-ADD     1             ZRECNO
      *_______________
      * Behandle bilde
      *"""""""""""""""
     C     SRB3          TAG
      *
N05  C                   MOVE      '1'           *in55                          N55=varsel mapper
     C                   MOVEA     '11'          *IN(91)
     C                   MOVE      *BLANKS       ZNID
     C                   MOVE      *BLANKS       ZNNA
     C                   EVAL      ZNNETW=*BLANKS
     C                   EVAL      ZNEX=*BLANKS
     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     EDI50DØ
     C                   WRITE     EDI50DC
     C                   EXFMT     EDI50DB
      *
     C     *IN03         IFEQ      '0'
     C     *IN12         ANDEQ     '0'
      *
     C                   MOVEA     '00'          *IN(91)
      *_____________
      * F5=Frisk opp
      *"""""""""""""
     C     *IN05         CABEQ     '1'           SRB1
      *___________
      * F6=Lage ny
      *"""""""""""
     C     *IN06         IFEQ      '1'
     C                   EXSR      SRBA
     C     *IN03         CABEQ     '1'           ut
     C                   GOTO      SRB3
     C                   END
      *_______
      * Valg ?
      *"""""""
     C                   MOVE      '0'           *IN52
     C                   MOVE      '0'           *IN95
     C     *IN52         DOWEQ     '0'
      *
     C                   READC     EDI50DA                                52
     C     *IN52         IFEQ      '0'
     C     ZOP           CASEQ     '2'           SRBB                           Endre
     C     ZOP           CASEQ     '3'           SRBC                           Kopiere
     C     ZOP           CASEQ     '4'           SRBD                           Slette
     C     ZOP           CASEQ     '5'           SRBE                           Vise
N05  C     ZOP           CASEQ     '6'           SRB6                           Avvikende mappe
     C     ZOP           CASEQ     '8'           SRB8                           Fritekst
N03  C     ZOP           CASEQ     '9'           SRB9                           POD SIGNATUR
     C     ZOP           CASEQ     'I'           SRIFSI                         IFS Inn
     C     ZOP           CASEQ     'U'           SRIFSU                         IFS Inn
     C                   END
     C                   END
      *
     C  N52              END
      *
     C     ZNID          CABNE     *BLANKS       SRB1
     C     ZNNA          CABNE     *BLANKS       SRB1
     C     ZNNETW        CABNE     *BLANKS       SRB1
     C     ZNEX          CABNE     *BLANKS       SRB1
     C     *IN03         CABEQ     '1'           ut
     C     *IN95         CABEQ     '1'           SRB1
     C     *IN95         CABEQ     '0'           SRB3
      *
     C                   END
      *
     C     ut            ENDSR
      *////////////////////////////////////////////////////////////
      *  Lage ny                                             SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
      *____________
      * Blanke felt
      *""""""""""""
     C                   MOVE      '0'           *IN41
     C                   MOVE      '0'           *IN42
     C                   MOVEA     '0000'        *IN(30)
     C                   MOVE      *BLANKS       INID
     C                   MOVE      *BLANKS       IN0007
     C                   MOVE      *BLANKS       IN0022
     C                   MOVE      *BLANKS       IN0026
     C                   MOVE      *BLANKS       IN0032
     C                   MOVE      *BLANKS       INNA
     C                   MOVE      *BLANKS       INACC
     C                   MOVE      *BLANKS       INUSR
     C                   MOVE      *BLANKS       INPW
     C                   MOVE      *BLANKS       INNETW
     C                   MOVE      *BLANK        INTCHN
     C                   MOVE      *BLANK        INTCUS
     C                   MOVE      *BLANK        INTCPW
     C                   MOVE      *BLANK        INTCRD
     C                   MOVE      *BLANK        INTCRDT
     C                   MOVE      *BLANK        INTCRF
     C                   MOVE      *BLANK        INTCLL
     C                   MOVE      *BLANK        INTCLF
     C                   MOVE      *BLANK        INEX
     C                   MOVE      *BLANK        INOUSR
     C                   MOVE      *BLANK        INOADR
     C                   MOVE      *BLANK        INLIND
     C                   MOVE      *BLANK        INCTLD
     C                   MOVE      *BLANKS       INDEVD
     C                   MOVE      *BLANKS       INOFID
     C                   MOVE      *BLANKS       INOFPW
     C                   MOVE      *BLANKS       INOFXL
     C                   MOVE      *BLANKS       INOFXN
     C                   MOVE      *BLANKS       INSPASV
     C                   MOVE      *BLANKS       INBIN
     C                   MOVE      *BLANKS       INEBCDIC
     C                   MOVE      *BLANKS       INASCII
     C                   MOVE      *BLANKS       INCODPAG
     C                   MOVE      *BLANKS       INENDLIN
     C                   MOVE      *BLANKS       INIFSR
     C                   MOVE      *BLANKS       INIFSS
     C                   MOVE      *BLANKS       INCMDF1
     C                   MOVE      *BLANKS       INCMDF2
     C                   MOVE      *BLANKS       INCMDF3
     C                   MOVE      *BLANKS       INCMDE1
     C                   MOVE      *BLANKS       INCMDE2
     C                   MOVE      *BLANKS       INCMDE3
     C                   MOVE      *BLANKS       INEVRYG

     C     SRBA1         TAG

     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     EDI50DØ
     C                   EXFMT     EDI50DD
     C                   MOVEA     '0000'        *IN(30)
     C     *IN03         IFEQ      '0'
     C     *IN12         ANDEQ     '0'
      *____________
      * Teste input-1
      *""""""""""""
      * Post må ikke finnes fra før.
     C                   MOVE      ÅNID          WNID
     C     KEYA          CHAIN     EDII                               53
     C     *IN53         IFEQ      '0'
     C                   MOVE      'SY00100'     ZMSGNO
     C                   MOVEA     '1110'        *IN(30)
     C                   GOTO      SRBA1
     C                   END
      *____________
      * Teste input-2
      *""""""""""""
     C                   WRITE     EDI50DØ
     C                   IF        ÅNEX = 'E'
     C                   SELECT
     C     ÅNNETW        WHENEQ    '3'
     C                   EXFMT     EDI50D3
     C                   EXFMT     EDI50D32
     C     ÅNNETW        WHENEQ    '4'
     C                   EXFMT     EDI50D4
     C     ÅNNETW        WHENEQ    '6'
     C                   EXFMT     EDI50D6
     C     ÅNNETW        WHENEQ    '7'
     C                   EXFMT     EDI50D7
     C     ÅNNETW        WHENEQ    '8'
     C                   EXFMT     EDI50D8
     C     ÅNNETW        WHENEQ    '9'
     C                   EXFMT     EDI50D9
     C     ÅNNETW        WHENEQ    'A'
     C                   EXFMT     EDI50D0
     C     ÅNNETW        WHENEQ    'B'
     C                   EXFMT     EDI50DN
     C     ÅNNETW        WHENEQ    'E'
     C                   EXFMT     EDI50DP
     C     ÅNNETW        WHENEQ    '0'
     C                   EXFMT     EDI50D1
     C                   ENDSL
     C                   ENDIF
     C     *IN12         CABEQ     '1'           SRBA1
     C     *IN03         IFEQ      '0'
      *___________________
      * Adda post til  FIL
      *"""""""""""""""""""
     C                   MOVE      ÅNID          INID
     C                   MOVE      ÅN0007        IN0007
     C                   MOVE      ÅN0022        IN0022
     C                   MOVE      ÅN0026        IN0026
     C                   MOVE      ÅN0032        IN0032
     C                   MOVE      ÅNNA          INNA
     C                   MOVE      ÅNNETW        INNETW
     C                   MOVE      ÅNTCHN        INTCHN
     C                   MOVE      ÅNTCUS        INTCUS
     C                   MOVE      ÅNTCPW        INTCPW
     C                   MOVE      ÅNTCRD        INTCRD
     C                   MOVE      ÅNTCRDT       INTCRDT
     C                   MOVE      ÅNTCRF        INTCRF
     C                   MOVE      ÅNTCLL        INTCLL
     C                   MOVE      ÅNTCLF        INTCLF
     C                   MOVE      ÅNEX          INEX
     C                   MOVE      ÅNOUSR        INOUSR
     C                   MOVE      ÅNOADR        INOADR
     C                   MOVE      ÅNLIND        INLIND
     C                   MOVE      ÅNCTLD        INCTLD
     C                   MOVE      ÅNDEVD        INDEVD
     C                   MOVE      ÅNOFID        INOFID
     C                   MOVE      ÅNOFPW        INOFPW
     C                   MOVE      ÅNOFXL        INOFXL
     C                   MOVE      ÅNOFXN        INOFXN
     C                   MOVE      ÅNSPASV       INSPASV
     C                   MOVE      ÅNBIN         INBIN
     C                   MOVE      ÅNEBCDIC      INEBCDIC
     C                   MOVE      ÅNASCII       INASCII
     C                   MOVE      ÅNCODPAG      INCODPAG
     C                   MOVE      ÅNENDLIN      INENDLIN
     C                   MOVE      ÅNIFSR        INIFSR
     C                   MOVE      ÅNIFSS        INIFSS
     C                   MOVE      ÅNCMDF1       INCMDF1
     C                   MOVE      ÅNCMDF2       INCMDF2
     C                   MOVE      ÅNCMDF3       INCMDF3
     C                   MOVE      ÅNCMDE1       INCMDE1
     C                   MOVE      ÅNCMDE2       INCMDE2
     C                   MOVE      ÅNCMDE3       INCMDE3
     C                   MOVE      ÅNEVRYG       INEVRYG
     C                   MOVE      ÅNDUPCTL      INDUPCTL
     C                   WRITE     EDIIR
      *____________________
      * LAG KATALOGSTRULTUR
      *""""""""""""""""""""
N04  C                   IF        INNETW = 'A' AND INEX = 'E'
N04  C                             AND %SUBST(INID:1:2) <> 'NO'
N04  C                   EVAL      INTCRD = '*IFS'
N04  C                   END
     C     INTCRD        IFEQ      '*IFS'
     C     INTCLL        OREQ      '*IFS'
     C                   CALL      'EDI45C'
     C                   PARM                    INID
N02  C                   ELSE
N02  C                   IF        INNETW = 'A' AND INEX = 'E'
N02  C     '/ehf'        SCAN      INTCRD                                 33
N02  C  N33'/EHF'        SCAN      INTCRD                                 33
N02  C   33              CALL      'EDI45C'
N02  C                   PARM                    INID
N02  C                   END
     C                   ENDIF
      *______________________
      * Adda post til  SUBFIL
      *""""""""""""""""""""""
     C                   ADD       1             WRECNO
     C                   Z-ADD     WRECNO        ZRECNO
     C                   EVAL      *IN60=*OFF
     C                   WRITE     EDI50DA
      *
     C                   ENDIF
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Endre                                               SRBB /
      *////////////////////////////////////////////////////////////
     C     SRBB          BEGSR
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   MOVE      *BLANKS       ZOP
     C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
      *____________
      * Flytte felt
      *""""""""""""
     C                   MOVE      INID          WNID
N05  C     KEYA          CHAIN     EDIIAM                             55        N55 = varsel
     C     KEYA          CHAIN(N)  EDII                               53
     C                   MOVE      '1'           *IN41
     C                   MOVE      '0'           *IN42
     C                   MOVEA     '0000'        *IN(30)
     C                   MOVE      INID          ÅNID
     C                   MOVE      IN0007        ÅN0007
     C                   MOVE      IN0022        ÅN0022
     C                   MOVE      IN0026        ÅN0026
     C                   MOVE      IN0032        ÅN0032
     C                   MOVE      INNA          ÅNNA
     C                   MOVE      INNETW        ÅNNETW
     C                   MOVE      INTCHN        ÅNTCHN
     C                   MOVE      INTCUS        ÅNTCUS
     C                   MOVE      INTCPW        ÅNTCPW
     C                   MOVE      INTCRD        ÅNTCRD
     C                   MOVE      INTCRDT       ÅNTCRDT
     C                   MOVE      INTCRF        ÅNTCRF
     C                   MOVE      INTCLL        ÅNTCLL
     C                   MOVE      INTCLF        ÅNTCLF
     C                   MOVE      INEX          ÅNEX
     C                   MOVE      INOUSR        ÅNOUSR
     C                   MOVE      INOADR        ÅNOADR
     C                   MOVE      INLIND        ÅNLIND
     C                   MOVE      INCTLD        ÅNCTLD
     C                   MOVE      INDEVD        ÅNDEVD
     C                   MOVE      INOFID        ÅNOFID
     C                   MOVE      INOFPW        ÅNOFPW
     C                   MOVE      INOFXL        ÅNOFXL
     C                   MOVE      INOFXN        ÅNOFXN
     C                   MOVE      INSPASV       ÅNSPASV
     C                   MOVE      INBIN         ÅNBIN
     C                   MOVE      INEBCDIC      ÅNEBCDIC
     C                   MOVE      INASCII       ÅNASCII
     C                   MOVE      INCODPAG      ÅNCODPAG
     C                   MOVE      INENDLIN      ÅNENDLIN
     C                   MOVE      INIFSR        ÅNIFSR
     C                   MOVE      INIFSS        ÅNIFSS
     C                   MOVE      INCMDF1       ÅNCMDF1
     C                   MOVE      INCMDF2       ÅNCMDF2
     C                   MOVE      INCMDF3       ÅNCMDF3
     C                   MOVE      INCMDE1       ÅNCMDE1
     C                   MOVE      INCMDE2       ÅNCMDE2
     C                   MOVE      INCMDE3       ÅNCMDE3
     C                   MOVE      INEVRYG       ÅNEVRYG
     C                   MOVE      INDUPCTL      ÅNDUPCTL
      *
     C     SRBB1         TAG
      *
     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     EDI50DØ
     C                   EXFMT     EDI50DD
     C                   MOVEA     '000'         *IN(30)
     C     *IN12         IFEQ      '0'
      *____________
      * Teste input
      *""""""""""""
     C   30              GOTO      SRBB1
      *____________
      * Teste input-2
      *""""""""""""
     C                   WRITE     EDI50DØ
     C                   IF        ÅNEX = 'E'
     C                   SELECT
     C     ÅNNETW        WHENEQ    '3'
     C                   EXFMT     EDI50D3
     C                   EXFMT     EDI50D32
     C     ÅNNETW        WHENEQ    '4'
     C                   EXFMT     EDI50D4
     C     ÅNNETW        WHENEQ    '6'
     C                   EXFMT     EDI50D6
     C     ÅNNETW        WHENEQ    '7'
     C                   EXFMT     EDI50D7
     C     ÅNNETW        WHENEQ    '8'
     C                   EXFMT     EDI50D8
     C     ÅNNETW        WHENEQ    '9'
     C                   EXFMT     EDI50D9
     C     ÅNNETW        WHENEQ    'A'
     C                   EXFMT     EDI50D0
     C     ÅNNETW        WHENEQ    'B'
     C                   EXFMT     EDI50DN
     C     ÅNNETW        WHENEQ    'E'
     C                   EXFMT     EDI50DP
     C     ÅNNETW        WHENEQ    '0'
     C                   EXFMT     EDI50D1
     C                   ENDSL
     C                   ENDIF
     C     *IN12         CABEQ     '1'           SRBB1
     C     *IN03         IFEQ      '0'
      *______________
      * Oppdatere FIL
      *""""""""""""""
     C                   MOVE      ÅNID          WNID
     C     KEYA          CHAIN     EDII                               53
     C                   MOVE      ÅN0007        IN0007
     C                   MOVE      ÅN0022        IN0022
     C                   MOVE      ÅN0026        IN0026
     C                   MOVE      ÅN0032        IN0032
     C                   MOVE      ÅNNA          INNA
     C                   MOVE      ÅNNETW        INNETW
     C                   MOVE      ÅNTCHN        INTCHN
     C                   MOVE      ÅNTCUS        INTCUS
     C                   MOVE      ÅNTCPW        INTCPW
     C                   MOVE      ÅNTCRD        INTCRD
     C                   MOVE      ÅNTCRDT       INTCRDT
     C                   MOVE      ÅNTCRF        INTCRF
     C                   MOVE      ÅNTCLL        INTCLL
     C                   MOVE      ÅNTCLF        INTCLF
     C                   MOVE      ÅNEX          INEX
     C                   MOVE      ÅNOUSR        INOUSR
     C                   MOVE      ÅNOADR        INOADR
     C                   MOVE      ÅNLIND        INLIND
     C                   MOVE      ÅNCTLD        INCTLD
     C                   MOVE      ÅNDEVD        INDEVD
     C                   MOVE      ÅNOFID        INOFID
     C                   MOVE      ÅNOFPW        INOFPW
     C                   MOVE      ÅNOFXL        INOFXL
     C                   MOVE      ÅNOFXN        INOFXN
     C                   MOVE      ÅNSPASV       INSPASV
     C                   MOVE      ÅNBIN         INBIN
     C                   MOVE      ÅNEBCDIC      INEBCDIC
     C                   MOVE      ÅNASCII       INASCII
     C                   MOVE      ÅNCODPAG      INCODPAG
     C                   MOVE      ÅNENDLIN      INENDLIN
     C                   MOVE      ÅNIFSR        INIFSR
     C                   MOVE      ÅNIFSS        INIFSS
     C                   MOVE      ÅNCMDF1       INCMDF1
     C                   MOVE      ÅNCMDF2       INCMDF2
     C                   MOVE      ÅNCMDF3       INCMDF3
     C                   MOVE      ÅNCMDE1       INCMDE1
     C                   MOVE      ÅNCMDE2       INCMDE2
     C                   MOVE      ÅNCMDE3       INCMDE3
     C                   MOVE      ÅNEVRYG       INEVRYG
     C                   MOVE      ÅNDUPCTL      INDUPCTL
     C                   UPDATE    EDIIR
      *____________________
      * LAG KATALOGSTRULTUR
      *""""""""""""""""""""
N04  C                   IF        INNETW = 'A' AND INEX = 'E'
N04  C                             AND %SUBST(INID:1:2) <> 'NO'
N04  C                   EVAL      INTCRD = '*IFS'
N04  C                   END
     C     INTCRD        IFEQ      '*IFS'
     C     INTCLL        OREQ      '*IFS'
     C                   CALL      'EDI45C'
     C                   PARM                    INID
     C                   ENDIF
      *
     C                   END
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kopiere                                             SRBC /
      *////////////////////////////////////////////////////////////
     C     SRBC          BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   MOVE      INID          WNID
     C     KEYA          CHAIN(N)  EDII                               53
     C                   MOVE      INID          ÅNID
     C                   MOVE      IN0007        ÅN0007
     C                   MOVE      IN0022        ÅN0022
     C                   MOVE      IN0026        ÅN0026
     C                   MOVE      IN0032        ÅN0032
     C                   MOVE      INNA          ÅNNA
     C                   MOVE      INNETW        ÅNNETW
     C                   MOVE      INTCHN        ÅNTCHN
     C                   MOVE      INTCUS        ÅNTCUS
     C                   MOVE      INTCPW        ÅNTCPW
     C                   MOVE      INTCRD        ÅNTCRD
     C                   MOVE      INTCRDT       ÅNTCRDT
     C                   MOVE      INTCRF        ÅNTCRF
     C                   MOVE      INTCLL        ÅNTCLL
     C                   MOVE      INTCLF        ÅNTCLF
     C                   MOVE      INEX          ÅNEX
     C                   MOVE      INOUSR        ÅNOUSR
     C                   MOVE      INOADR        ÅNOADR
     C                   MOVE      INLIND        ÅNLIND
     C                   MOVE      INCTLD        ÅNCTLD
     C                   MOVE      INDEVD        ÅNDEVD
     C                   MOVE      INOFID        ÅNOFID
     C                   MOVE      INOFPW        ÅNOFPW
     C                   MOVE      INOFXL        ÅNOFXL
     C                   MOVE      INOFXN        ÅNOFXN
     C                   MOVE      INSPASV       ÅNSPASV
     C                   MOVE      INBIN         ÅNBIN
     C                   MOVE      INEBCDIC      ÅNEBCDIC
     C                   MOVE      INASCII       ÅNASCII
     C                   MOVE      INCODPAG      ÅNCODPAG
     C                   MOVE      INENDLIN      ÅNENDLIN
     C                   MOVE      INIFSR        ÅNIFSR
     C                   MOVE      INIFSS        ÅNIFSS
     C                   MOVE      INCMDF1       ÅNCMDF1
     C                   MOVE      INCMDF2       ÅNCMDF2
     C                   MOVE      INCMDF3       ÅNCMDF3
     C                   MOVE      INCMDE1       ÅNCMDE1
     C                   MOVE      INCMDE2       ÅNCMDE2
     C                   MOVE      INCMDE3       ÅNCMDE3
     C                   MOVE      INEVRYG       ÅNEVRYG
     C                   MOVE      INDUPCTL      ÅNDUPCTL
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   MOVE      *BLANKS       ZOP
     C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
      *____________________________
      * Kalle på rutine for Lage Ny
      *""""""""""""""""""""""""""""
     C                   EXSR      SRBA
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Slette                                              SRBD /
      *////////////////////////////////////////////////////////////
     C     SRBD          BEGSR
      *______________
      * Oppdatere FIL
      *""""""""""""""
     C                   MOVEL     INID          WNID
     C     KEYA          CHAIN     EDII                               53
N07  C                   EXFMT     DELETE
N07  C     *in11         ifne      '1'
N07  C                   MOVE      *BLANKS       ZOP
N07  C     INFTX01       COMP      *BLANKS                            6060
N07  C                   UPDATE    EDI50DA
N07  C                   goto      UtSrBd
N07  C                   endif
     C                   DELETE    EDIIR
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   MOVE      *BLANKS       ZOP
     C                   MOVE      *BLANKS       INID
     C                   MOVE      *BLANKS       INNA
N07  C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
     C                   MOVE      '1'           *IN95
      *
N07  C     UtSrBd        tag
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Vise                                                SRBE /
      *////////////////////////////////////////////////////////////
     C     SRBE          BEGSR
      *____________
      * Flytte felt
      *""""""""""""
     C                   MOVE      '1'           *IN41
     C                   MOVE      '1'           *IN42
     C                   MOVEA     '0000'        *IN(30)
     C                   MOVE      INID          WNID
N05  C     KEYA          CHAIN     EDIIAM                             55        N55 = varsel
     C     KEYA          CHAIN(N)  EDII                               53
     C                   MOVE      INID          ÅNID
     C                   MOVE      IN0007        ÅN0007
     C                   MOVE      IN0022        ÅN0022
     C                   MOVE      IN0026        ÅN0026
     C                   MOVE      IN0032        ÅN0032
     C                   MOVE      INNA          ÅNNA
     C                   MOVE      INNETW        ÅNNETW
     C                   MOVE      INTCHN        ÅNTCHN
     C                   MOVE      INTCUS        ÅNTCUS
     C                   MOVE      INTCPW        ÅNTCPW
     C                   MOVE      INTCRD        ÅNTCRD
     C                   MOVE      INTCRDT       ÅNTCRDT
     C                   MOVE      INTCRF        ÅNTCRF
     C                   MOVE      INTCLL        ÅNTCLL
     C                   MOVE      INTCLF        ÅNTCLF
     C                   MOVE      INEX          ÅNEX
     C                   MOVE      INOUSR        ÅNOUSR
     C                   MOVE      INOADR        ÅNOADR
     C                   MOVE      INLIND        ÅNLIND
     C                   MOVE      INCTLD        ÅNCTLD
     C                   MOVE      INDEVD        ÅNDEVD
     C                   MOVE      INOFID        ÅNOFID
     C                   MOVE      INOFPW        ÅNOFPW
     C                   MOVE      INOFXL        ÅNOFXL
     C                   MOVE      INOFXN        ÅNOFXN
     C                   MOVE      INSPASV       ÅNSPASV
     C                   MOVE      INBIN         ÅNBIN
     C                   MOVE      INEBCDIC      ÅNEBCDIC
     C                   MOVE      INASCII       ÅNASCII
     C                   MOVE      INCODPAG      ÅNCODPAG
     C                   MOVE      INENDLIN      ÅNENDLIN
     C                   MOVE      INIFSR        ÅNIFSR
     C                   MOVE      INIFSS        ÅNIFSS
     C                   MOVE      INCMDF1       ÅNCMDF1
     C                   MOVE      INCMDF2       ÅNCMDF2
     C                   MOVE      INCMDF3       ÅNCMDF3
     C                   MOVE      INCMDE1       ÅNCMDE1
     C                   MOVE      INCMDE2       ÅNCMDE2
     C                   MOVE      INCMDE3       ÅNCMDE3
     C                   MOVE      INEVRYG       ÅNEVRYG
     C                   MOVE      INDUPCTL      ÅNDUPCTL
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C                   MOVE      *BLANKS       ZOP
     C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
      *____________
      * Teste input-2
      *""""""""""""
     C                   WRITE     EDI50DØ
     C                   IF        ÅNEX = 'E'
     C                   SELECT
     C     ÅNNETW        WHENEQ    '3'
     C                   EXFMT     EDI50D3
     C                   EXFMT     EDI50D32
     C     ÅNNETW        WHENEQ    '4'
     C                   EXFMT     EDI50D4
     C     ÅNNETW        WHENEQ    '6'
     C                   EXFMT     EDI50D6
     C     ÅNNETW        WHENEQ    '7'
     C                   EXFMT     EDI50D7
     C     ÅNNETW        WHENEQ    '8'
     C                   EXFMT     EDI50D8
     C     ÅNNETW        WHENEQ    '9'
     C                   EXFMT     EDI50D9
     C     ÅNNETW        WHENEQ    'A'
     C                   EXFMT     EDI50D0
     C     ÅNNETW        WHENEQ    'B'
     C                   EXFMT     EDI50DN
     C     ÅNNETW        WHENEQ    'E'
     C                   EXFMT     EDI50DP
     C     ÅNNETW        WHENEQ    '0'
     C                   EXFMT     EDI50D1
     C                   ENDSL
     C                   ENDIF
     C                   ENDSR
N05
N05   *////////////////////////////////////////////////////////////
N05   *  Avvikende mappe                                     SRB6 /
N05   *////////////////////////////////////////////////////////////
N05  C     SRB6          BEGSR
N05  C                   MOVEL     INID          WNID
N05  C                   CALL      'EDI50BR'
N05  C                   parm                    WNID
N05   *_________________
N05   * Oppdatere SUBFIL
N05   *"""""""""""""""""
N05  C                   MOVE      *BLANKS       ZOP
S07  C*                  MOVE      *BLANKS       INID
S07  C*                  MOVE      *BLANKS       INNA
N05  C     INFTX01       COMP      *BLANKS                            6060
N05  C                   UPDATE    EDI50DA
S07  C*                  MOVE      '1'           *IN95
N05
N05  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekst                                            SRB8 /
      *////////////////////////////////////////////////////////////
     C     SRB8          BEGSR
      *______________
      * Oppdatere FIL
      *""""""""""""""
     C                   MOVEL     INID          WNID
     C     KEYA          CHAIN(N)  EDII                               53

     C                   MOVE      INFTXT        WSFTXT
     C                   EXFMT     FRITXT
     C     *in12         cabeq     '1'           UtFtxt
     C
     C     KEYA          CHAIN     EDII                               53
     C                   MOVE      WSFTXT        INFTXT
     C                   UPDATE    EDIIR
     C
      *_________________
      * Oppdatere SUBFIL
      *"""""""""""""""""
     C     UtFtxt        tag
     C                   MOVE      *BLANKS       ZOP
S07  C*                  MOVE      *BLANKS       INID
S07  C*                  MOVE      *BLANKS       INNA
     C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
S07  C*                  MOVE      '1'           *IN95
     C
     C                   ENDSR
N03   *////////////////////////////////////////////////////////////
N03   *  POD signatur                                        SRB9
N03   *////////////////////////////////////////////////////////////
N03  C     SRB9          BEGSR
N03   *______________
N03   * Oppdatere FIL
N03   *""""""""""""""
N03  C                   MOVEL     INID          WNID
N03  C     KEYA          CHAIN(N)  EDII                               53
N03
N03  C                   MOVE      INPOD         WSPOD
N03  C                   EXFMT     POD
N03  C     *in12         cabeq     '1'           Utpod
N03  C
N03  C     KEYA          CHAIN     EDII                               53
N03  C                   MOVE      WSPOD         INPOD
N03  C                   UPDATE    EDIIR
N03  C
N03   *_________________
N03   * Oppdatere SUBFIL
N03   *"""""""""""""""""
N03  C     Utpod         tag
N03  C                   MOVE      *BLANKS       ZOP
S07  C*                  MOVE      *BLANKS       INID
S07  C*                  MOVE      *BLANKS       INNA
N03  C     INFTX01       COMP      *BLANKS                            6060
N03  C                   UPDATE    EDI50DA
S07  C*                  MOVE      '1'           *IN95
     C
N03  C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Se i lokal katalogstruktur INN                    SRIFSI /
      *////////////////////////////////////////////////////////////
     C     SRIFSI        BEGSR
      * Vise fil
     C                   IF        INEX='E'

     C                   EVAL      QWDIR = *BLANKS
     C                   EVAL      QWDIR='/'+%trimr(UELIBF)+'/EDIRE/*'

     C                   IF        INTCLL = '*IFS'
     C                   EVAL      QWDIR = *BLANKS
     C                   EVAL      QWDIR='/'+%trimr(UELIBF)+'X/'+%trimr(INID)
     C                             + '/EDIRE/*'
     C                   ENDIF
N08  C                   IF        INID='TULLTAXAN'
N08  C                   EVAL      QWDIR = *BLANKS
N08  C                   EVAL      QWDIR='/'+%trimr(UELIBF)+'X/'+%trimr(INID)
N08  C                             + '/EDIRE1K/*'
N08  C                   ENDIF

     C                   IF        INIFSR <> *BLANKS
     C                   EVAL      QWDIR = *BLANKS
     C                   EVAL      QWDIR='/'+%trimr(INIFSR)+'/*'
     C                   ENDIF

     C                   EVAL      QCMDA = *BLANKS
     C                   EVAL      QCMDA = 'WRKLNK OBJ(' + X'7D'
     C                             + %trimr(QWDIR) + X'7D'
     C                             + ')'
     C                   EVAL      QCMDL = %len(%trim(QCMDA))
     C                   CALL      'QCMDEXC'                            98
     C                   PARM                    QCMDA
     C                   PARM                    QCMDL

     C                   ENDIF
      * Oppdatere SUBFIL
     C                   MOVE      *BLANKS       ZOP
     C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Se i lokal katalogstruktur UT                     SRIFSU /
      *////////////////////////////////////////////////////////////
     C     SRIFSU        BEGSR
      * Vise fil
     C                   IF        INEX='E'

     C                   EVAL      QWDIR = *BLANKS
     C                   EVAL      QWDIR='/'+%trimr(UELIBF)+'/EDISE/*'

     C                   IF        INTCRD = '*IFS'
     C                   EVAL      QWDIR = *BLANKS
     C                   EVAL      QWDIR='/'+%trimr(UELIBF)+'X/'+%trimr(INID)
     C                             + '/EDISE/*'
     C                   ENDIF

     C                   IF        INIFSS <> *BLANKS
     C                   EVAL      QWDIR = *BLANKS
     C                   EVAL      QWDIR='/'+%trimr(INIFSS)+'/*'
     C                   ENDIF

     C                   EVAL      QCMDA = *BLANKS
     C                   EVAL      QCMDA = 'WRKLNK OBJ(' + X'7D'
     C                             + %trimr(QWDIR) + X'7D'
     C                             + ')'
     C                   EVAL      QCMDL = %len(%trim(QCMDA))
     C                   CALL      'QCMDEXC'                            98
     C                   PARM                    QCMDA
     C                   PARM                    QCMDL

     C                   ENDIF
      * Oppdatere SUBFIL
     C                   MOVE      *BLANKS       ZOP
     C     INFTX01       COMP      *BLANKS                            6060
     C                   UPDATE    EDI50DA
     C                   ENDSR
