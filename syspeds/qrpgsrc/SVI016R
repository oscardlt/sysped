     FSVTAR1    IF   E           K DISK
     FSVTLK     IF   E           K DISK
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRBAAA
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *________________
      * Arbetsvariablar
      *""""""""""""""""
     C     *LIKE         DEFINE    SVTA_IE       ZVTA_IE
     C     *LIKE         DEFINE    SVTA_SAT      ZVTA_SAT
     C                   EVAL      ZVTA_IE='I'
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    ZVIV_ULKD         2
     C                   PARM                    ZVIV_VATA        10
     C                   PARM                    ZVTA_SAT
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     SVTAKEY       KLIST
     C                   KFLD                    ZVTA_IE
     C                   KFLD                    ZVIV_VATA
     C     SVTLKKEY      KLIST
     C                   KFLD                    ZVIV_ULKD
     C                   KFLD                    SVTA_RG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Automatisk avgiftsberækning, Tull                 SRBAAA /
      *////////////////////////////////////////////////////////////
     C     SRBAAA        BEGSR
      * Læs tulltariffen
     C     SVTAKEY       SETLL     SVTAR1
     C     SVTAKEY       READE     SVTAR1                                 55
     C     *IN55         DOWEQ     *OFF
      * Endast sekvens 1
     C     SVTA_SEKV     CABNE     1             SRBAAA2
      * Stæmmer MEAS_TYP_ID
     C     SVTA_MTI      COMP      '103'                                  56
     C  N56SVTA_MTI      COMP      '106'                                  56
     C  N56SVTA_MTI      COMP      '142'                                  56
     C  N56              GOTO      SRBAAA2
      * Er landkoden riktig ?
     C     SVTA_RG       CABEQ     ZVIV_ULKD     SRBAAA1
      * Eller stæmmer regionen ?
     C     SVTLKKEY      CHAIN     SVTLK                              56
     C     *IN56         CABEQ     *ON           SRBAAA2
     C     SRBAAA1       TAG
      * Datum, Land eller region stæmmer, flytta in i array
     C                   EVAL      ZVTA_SAT=SVTA_SAT
     C                   LEAVE
     C     SRBAAA2       TAG
     C     SVTAKEY       READE     SVTAR1                                 55
     C                   ENDDO
     C                   ENDSR
