      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED EL.TRANSITTERING (LINJE)      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 09-11 13-16 18 20 23 24
      *** LEDIGE INDIKATORER 49-59 61-63 95-97
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.      ***
      ***   OG DEFINERES I PROGRAM                               ***
      **************************************************************
      *
     FNCTSIV    UF A E           K DISK
     FTRKODL01  IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FNCTS062D  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     SFILE(SUBFIL2:ZRECN2)
     F                                     INFDS(FBAREA)
     D LI              S              1  0 DIM(9)
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  TVADT                  1      8  0
     D  TVADTC                 1      2  0
     D  TVADTA                 3      4  0
     D  TVADTM                 5      6  0
     D  TVADTD                 7      8  0
     D                 DS
     D  WSADT                  1      6  0
     D  WSADTD                 1      2  0
     D  WSADTM                 3      4  0
     D  WSADTA                 5      6  0
     D                 DS
     D  TVASD                  1     35
     D  TVASD_20               1     20
     D                 DS
     D  TVTXT                  1    512
     D  TVTXT_35               1     35
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UIN27                 12     12
     D  UIN34                 13     13
     D  UIN36                 14     14
     D  U1N07                 15     17
     D  UWS2                  18     27
      * OBS! HUSK INITIERE ALLE FELTER PÅ TR061R
     D  UPARM2                 1    128
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI
     C                   MOVE      *ZEROS        XLI
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     NCTSIVK1      SETLL     NCTSIV
     C     START1        TAG
     C     NCTSIHK       READE(N)  NCTSIV                                 94
     C  N94              MOVE      TVLI          W3LI
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        99998
     C                   MOVE      TVADTA        WSADTA
     C                   MOVE      TVADTM        WSADTM
     C                   MOVE      TVADTD        WSADTD
     C                   ADD       1             ZRECNO
     C                   MOVE      TVLI          XLI               1 0
     C                   WRITE     SUBFIL
     C     NCTSIHK       READE(N)  NCTSIV                                 94
     C  N94              MOVE      TVLI          W3LI
     C  N94              END
     C                   END
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      ***
      *
     C                   SETOFF                                       989930
      *
      *** F03 OG 27 PÅ ---> AVBRYTTE SPØRRING
     C   03
     CAN 27              MOVE      *ZEROS        UFLAGG
     C   03
     CAN 27              GOTO      SLUTT
      *
      *** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START3
     C                   END
      *
      *** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
      *** F17 ---> SOM F3 + BEHOLDE EN DEL OPPLYSN. FOR NESTE TOLLDEK.
     C   03
     COR 17              DO
     C                   EXSR      SNDNCTS
      *** F12 ---> AVBRYTTE F3/F17
     C   12              Z-ADD     4             LINNBR
     C   12              Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
      *
      *** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              GOTO      START
      *** F6  ---> LAGE NYE DETALJE LINJER
     C   06              GOTO      START5
      *** F8  ---> VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C   08              GOTO      START7
      *
      *** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94NCTSIVK       SETLL     NCTSIV
     C  N94NCTSIHK       READE(N)  NCTSIV                                 94
     C                   GOTO      START2
     C                   END
      *
      *** SJEKKE OM BRUKER HAR VALGT OPSJONER. HIVS SÅ,T UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   END
      *** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
      ***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
      *** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
      ***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
      *
      *** LAGE NYE DETALJE LINJER
     C     START5        TAG
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   EXSR      MOVB2
      *
     C     START6        TAG
     C  N30WSLI          IFGT      0
     C                   EXSR      TSTOPL
     C                   END
     C                   EXFMT     VARELI
     C                   MOVEA     '000000000000'*IN(79)
     C                   MOVEA     '000'         *IN(76)
     C                   MOVE      '0'           *IN74
     C                   MOVE      '0'           *IN30
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START6
     C                   END
      *
      *** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      START6
     C                   END
      *
     C   12WSLI          IFGT      0
     C                   EXSR      DLTOPL
     C                   END
      *
      *** F12 --> AVBRYTTE REGISTRERING AV NYE DETALJE LINJER.
     C  N12              DO
      *** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
      *** FEILMELDING.
     C                   EXSR      TESTB1
     C   30              GOTO      START6
      *
     C     WSLI          IFEQ      0
     C                   ADD       1             XLI
     C                   MOVE      XLI           WSLI
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      START6
     C                   END
      *
      *** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDNCTS
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
      *** VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
      *** 31 PÅ    ---> SORTERE PÅ TARIFFNR. + STATUS       (TRUV02)
      *** 31 AV    ---> SORTERE PÅ REGISTRERINGS REKKEFØLGE (TRUV)
     C     START7        TAG
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C                   MOVE      W3LI          W3LIGM            1 0
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
      * Kode for hendelse
     C                   MOVE      '019'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSKD          YKODE
     C     TRK01K        CHAIN     TRKODL01                           90
     C     *IN90         IFEQ      '1'
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'YBC2233'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Beskrivelse av hendelse
     C     WSTXT         COMP      *BLANKS                                89
     C     *IN89         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     35            POSNBR
     C                   MOVE      'YBC2234'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Hendelses dato
     C                   CALL      'TESTDATO'
     C                   PARM      WSADTD        UDD               2 0
     C                   PARM      WSADTM        UMM               2 0
     C                   PARM      WSADTA        UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      86
     C     *IN88         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Autoritet
     C     WSAAUT        COMP      *BLANKS                                87
     C     *IN87         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   MOVE      'YBC2235'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Sted
     C     WSASD         COMP      *BLANKS                                86
     C     *IN86         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2236'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Land
     C                   MOVE      WSALK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             85
     C     *IN85         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     58            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Kvalifikator
     C                   MOVE      '038'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSQID         YKODE
     C     TRK01K        CHAIN     TRKODL01                           84
     C     *IN84         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2237'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * UN lokasjonskode
     C                   MOVE      '244'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSD          YKODE
     C     TRK01K        CHAIN     TRKODL01                           83
     C     *IN83         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2225'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      * Land
     C                   MOVE      WSLK          KS2LK
     C     KODS2K        CHAIN     KODTS2                             82
     C     *IN82         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     42            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSTTY         IFNE      0
     C                   MOVE      '750'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTTY         YKODE
     C     TRK01K        CHAIN     TRKODL01                           78
     C     *IN78         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   MOVE      'YBC2195'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      * Transportmiddels landkode
     C     WSTLK         IFNE      *BLANKS
     C                   MOVE      WSTLK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             76
     C     *IN76         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     HENTSR        BEGSR
      ***********************************************
      *** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
      *** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
      *** OPSJON 2 ---> ENDRE DETALJE LINJE.
      *** OPSJON 4 ---> SLETTE DETALJE LINJE.
      *** OPSJON 5 ---> VISE DETALJE LINJE
      *** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGNCTS
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTNCTS
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISNCTS
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     VISNCTS       BEGSR
      ***********************************************
     C                   SETON                                        99
      *
     C                   MOVE      TVLI          WSLI
     C                   MOVE      TVADTA        WSADTA
     C                   MOVE      TVADTM        WSADTM
     C                   MOVE      TVADTD        WSADTD
     C                   EXSR      TSTOPL
     C                   MOVE      WSLI          TVLI
     C     STVIS         TAG
     C                   EXFMT     VAREL3
      *
     C   15              DO
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STVIS
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     DLTNCTS       BEGSR
      ***********************************************
     C                   Z-ADD     ZRECNO        XRECN2            4 0
     C                   MOVE      *ZEROS        LI
      *** OPERASJON 1
     C                   MOVE      TVLI          LI(1)
     C                   Z-ADD     1             XN                3 0
     C     *IN98         DOWEQ     '0'                                          1<-B
     C     STDLT1        TAG
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '4'                                           2<-B
     C                   MOVE      *ZEROS        XN2               3 0
     C     XN2           DOWLT     XN                                             3<-B
     C                   ADD       1             XN2
     C                   END                                                      3<-E
     C                   ADD       1             XN
     C                   MOVE      TVLI          LI(XN)
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *** OPERASJON 2
     C                   MOVE      '1'           *IN43
     C                   WRITE     SUBCTL2
     C                   MOVEA     '00'          *IN(43)
     C                   Z-ADD     *ZEROS        ZRECN2
     C                   MOVE      *ZEROS        XN2
     C     XN2           DOWLT     XN                                           1<-B
     C                   ADD       1             XN2
     C                   MOVE      LI(XN2)       WSLI
     C     NCTSIVK       CHAIN(N)  NCTSIV                             44
     C  N44              ADD       1             ZRECN2
     C  N44              WRITE     SUBFIL2
     C                   END                                                    1<-E
      *
      *** OPERASJON 3
     C                   Z-ADD     1             ZRECN2
     C     STDLT3        TAG
     C                   MOVEA     '11'          *IN(41)
     C                   WRITE     SUBCTL2
     C                   EXFMT     BUNN2
     C   25              GOTO      STDLT3
     C   12              Z-ADD     XRECN2        ZRECNO
     C  N12              DO                                                     1<-B
     C                   MOVE      *ZEROS        ZRECN2
     C     STDLT4        TAG
     C                   ADD       1             ZRECN2
     C     ZRECN2        CHAIN     SUBFIL2                            98
     C  N98              DO                                                      2<-B
     C     NCTSIVK2      CHAIN     NCTSIV                             41
     C  N41              DO                                                       3<-B
     C                   DELETE    NCTSIVR
     C                   MOVE      TVLI          WSLI
     C                   EXSR      DLTOPL
     C                   END
     C                   GOTO      STDLT4                                         3<-E
     C                   END                                                     2<-E
     C                   EXSR      MOVB1
     C                   END                                                    1<-E
     C                   SETOFF                                       4198
      *
     C                   ENDSR
      *
      ***********************************************
     C     CHGNCTS       BEGSR
      ***********************************************
      *** FLYTTE DATA FRA SUBFIL TIL ARBEIDSVARIABLER
     C                   EXSR      MOVNCTSW
      *
     C     STCHG         TAG
     C  N30              EXSR      TSTOPL
     C                   EXFMT     VARELI
     C                   MOVEA     '000000000000'*IN(79)
     C                   MOVEA     '000'         *IN(76)
     C                   MOVE      '0'           *IN30
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      STCHG
     C                   END
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      STCHG
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN12         IFEQ      '1'
      *** F12 ---> AVBRYTTE ENDRING
     C                   UPDATE    SUBFIL
     C                   ELSE
      *** TESTE INNTASTEDE TADA. HVIS IKKE NOE FEIL, OPPDRATERE PÅ FIL
     C                   EXSR      TESTB1
     C   30              GOTO      STCHG
     C                   EXSR      OPDNCTS
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDNCTS       BEGSR
      ***********************************************
      *** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     NCTSIVK       CHAIN     NCTSIV                             33
      *** FLYTTE INNTASTET DATA TIL FIL-VARIABLER OG OPPDATERE DEM.
     C                   EXSR      MOVWNCTS
     C     *IN33         IFEQ      '0'
     C                   UPDATE    NCTSIVR
     C                   ELSE
     C                   WRITE     NCTSIVR
     C                   END
      *
      *** OPPDATERE PÅ SUBFIL
      *
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     TILKOD        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      15
     C                   CALL      'NCTS066R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C*                  PARM                    WSDFKD
     C*                  PARM                    WSDFSK
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      20
     C                   CALL      'NCTS067R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C*                  PARM                    WSCNR
     C                   PARM                    UIN27
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVNCTSW      BEGSR
      ***********************************************
     C                   SETON                                        99
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   SETON                                        40
      *
     C                   MOVE      TVLI          WSLI
     C                   MOVE      TVKD          WSKD
     C                   MOVE      TVTXT         WSTXT
     C                   MOVE      TVADTA        WSADTA
     C                   MOVE      TVADTM        WSADTM
     C                   MOVE      TVADTD        WSADTD
     C                   MOVE      TVAAUT        WSAAUT
     C                   MOVE      TVASD         WSASD
     C                   MOVE      TVALK         WSALK
     C                   MOVE      TVQID         WSQID
     C                   MOVE      TVSD          WSSD
     C                   MOVE      TVLK          WSLK
     C                   MOVE      TVAD1         WSAD1
     C                   MOVE      TVPN          WSPN
     C                   MOVE      TVPS          WSPS
     C                   MOVE      TVCNR         WSCNR
     C                   MOVE      TVANTS        WSANTS
     C                   MOVE      TVSID         WSSID
     C                   MOVE      TVKDC         WSKDC
     C                   MOVE      TVTTY         WSTTY
     C                   MOVE      TVTID         WSTID
     C                   MOVE      TVTLK         WSTLK
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWNCTS      BEGSR
      ***********************************************
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
     C                   MOVE      ' '           TV01
     C                   MOVE      WSLI          TVLI
     C                   MOVE      WSKD          TVKD
     C                   MOVE      WSTXT         TVTXT
     C                   MOVE      20            TVADTC
     C                   MOVE      WSADTA        TVADTA
     C                   MOVE      WSADTM        TVADTM
     C                   MOVE      WSADTD        TVADTD
     C                   MOVE      WSAAUT        TVAAUT
     C                   MOVE      WSASD         TVASD
     C                   MOVE      WSALK         TVALK
     C                   MOVE      WSQID         TVQID
     C                   MOVE      WSSD          TVSD
     C                   MOVE      WSLK          TVLK
     C                   MOVE      WSAD1         TVAD1
     C                   MOVE      WSPN          TVPN
     C                   MOVE      WSPS          TVPS
     C                   MOVE      WSCNR         TVCNR
     C                   MOVE      WSANTS        TVANTS
     C                   MOVE      WSSID         TVSID
     C                   MOVE      WSKDC         TVKDC
     C                   MOVE      WSTTY         TVTTY
     C                   MOVE      WSTID         TVTID
     C                   MOVE      WSTLK         TVTLK
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB1         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       TV01
     C                   MOVE      *ZEROS        TVLI
     C                   MOVE      *BLANKS       TVKD
     C                   MOVE      *BLANKS       TVTXT
     C                   MOVE      *ZEROS        TVADT
     C                   MOVE      *BLANKS       TVAAUT
     C                   MOVE      *BLANKS       TVASD
     C                   MOVE      *BLANKS       TVALK
     C                   MOVE      *BLANKS       TVQID
     C                   MOVE      *BLANKS       TVSD
     C                   MOVE      *BLANKS       TVLK
     C                   MOVE      *BLANKS       TVAD1
     C                   MOVE      *BLANKS       TVPN
     C                   MOVE      *BLANKS       TVPS
     C                   MOVE      *BLANKS       TVCNR
     C                   MOVE      *ZEROS        TVANTS
     C                   MOVE      *BLANKS       TVSID
     C                   MOVE      *ZEROS        TVKDC
     C                   MOVE      *ZEROS        TVTTY
     C                   MOVE      *BLANKS       TVTID
     C                   MOVE      *BLANKS       TVTLK
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB2         BEGSR
      ***********************************************
     C                   SETOFF                                       40
     C                   MOVEA     '00'          *IN(28)
     C                   MOVE      *ZEROS        WSLI
     C                   MOVE      *BLANKS       WSKD
     C                   MOVE      *BLANKS       WSTXT
     C                   MOVE      *ZEROS        WSADT
     C                   MOVE      *BLANKS       WSAAUT
     C                   MOVE      *BLANKS       WSASD
     C                   MOVE      *BLANKS       WSALK
     C                   MOVE      *BLANKS       WSQID
     C                   MOVE      *BLANKS       WSSD
     C                   MOVE      *BLANKS       WSLK
     C                   MOVE      *BLANKS       WSAD1
     C                   MOVE      *BLANKS       WSPN
     C                   MOVE      *BLANKS       WSPS
     C                   MOVE      *BLANKS       WSCNR
     C                   MOVE      *ZEROS        WSANTS
     C                   MOVE      *BLANKS       WSSID
     C                   MOVE      *ZEROS        WSKDC
     C                   MOVE      *ZEROS        WSTTY
     C                   MOVE      *BLANKS       WSTID
     C                   MOVE      *BLANKS       WSTLK
      *
     C                   ENDSR
      *
      ***********************************************
     C     SNDNCTS       BEGSR
      ***********************************************
     C   17              Z-ADD     2             UFLAGG            1 0
     C   03              Z-ADD     3             UFLAGG            1 0
      *
     C     UTYPE         IFNE      'DSP'
     C     UIN34         IFEQ      '1'
     C                   MOVE      '007'         U1N07
     C                   ELSE
     C                   MOVE      '   '         U1N07
     C                   END
     C                   CALL      'NCTS063R'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
      *
     C     UFLAGG        COMP      1                                      12
     C                   END
      *
     C     SLSND         ENDSR
      *
      ***********************************************
     C     SOKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     28
     C                   MOVE      '019'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSKD          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSKD
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     58
     C     POSNBR        ANDLE     59
     C                   CALL      'SYFI10L'
     C                   PARM                    WSALK
     C                   PARM                    USPED
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     12
     C                   MOVE      '038'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSQID         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSQID
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     28
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSD          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSSD
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     43
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLK
     C                   PARM                    USPED
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   MOVE      '750'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTTY         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSTTY
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTLK
     C                   PARM                    USPED
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     NCTSIHK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     NCTSIVK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    WSLI
     C     NCTSIVK1      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3LI
     C     NCTSIVK2      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    TVLI
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     KODS2K        KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C                   MOVE      'S2 '         KS2UNI
      *
     C     *ENTRY        PLIST
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C                   MOVE      UIN27         *IN27
     C                   MOVE      UIN36         *IN36
     C                   MOVE      *ZEROS        XLI
     C                   MOVE      *ZEROS        WSADT
     C                   MOVE      *ZEROS        TVADT
     C                   MOVE      *BLANKS       UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
      *
     C                   MOVE      *ZEROS        TVLI
     C                   MOVE      'N'           USPED             1
      *
     C                   ENDSR
      *
      ***********************************************
     C     TSTOPL        BEGSR
      ***********************************************
     C                   MOVEA     '00'          *IN(28)
      *** TEST OM FLERE CONTAINERNR
     C*    NCTSIVK       SETLL     TRIVCN
     C*    NCTSIVK       READE(N)  TRIVCN                                 33
     C* N33              SETON                                        28
      *** TEST OM FLERE FORSEGLING
     C*    NCTSIVK       SETLL     TRIVFS
     C*    NCTSIVK       READE(N)  TRIVFS                                 33
     C* N33              SETON                                        29
      *
     C                   ENDSR
      *
      ***********************************************
     C     DLTOPL        BEGSR
      ***********************************************
      *** SLETTE CONTAINERNR PGA. AVBRYT NY REGISTRERING
     C*    NCTSIVK       SETLL     TRIVCN
     C*    NCTSIVK       READE     TRIVCN                                 33
     C*    *IN33         DOWEQ     '0'
     C*                  DELETE    TRIVCNR
     C*    NCTSIVK       READE     TRIVCN                                 33
     C* N33              ENDDO
      *** SLETTE FORSEGLING PGA. AVBRYT NY REGISTRERING
     C*    NCTSIVK       SETLL     TRIVFS
     C*    NCTSIVK       READE     TRIVFS                                 33
     C*    *IN33         DOWEQ     '0'
     C*                  DELETE    TRIVFSR
     C*    NCTSIVK       READE     TRIVFS                                 33
     C* N33              ENDDO
      *
     C                   ENDSR
      *
