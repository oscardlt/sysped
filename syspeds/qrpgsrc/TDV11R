      ***********************************************************
      *** PROGRAMMET LEGGER KLART MANIFEST FOR SENDING SOM AZF***
      *** SENDER KUN EN OG EN AV GANGEN.                      ***
      *** LR SETTES IKKE PÅ.                                  ***
      ***********************************************************
     H DATEDIT(*YMD)
     FFIRM      IF   E           K DISK
     FSAMLB     IF A E           K DISK
     FDOKEM     IF A E           K DISK
     FHEAD11    IF A E           K DISK
     FDOKEF     IF A E           K DISK
     FSTED2     IF   E           K DISK
     FLOCL01    IF   E           K DISK
     FCNFF      UF   E             DISK
     FLOGF      O    E             DISK
     FAZF00F    O    E             DISK
     FAZF03F    O    E             DISK
     FAZF04F    O    E             DISK
     FAZF40F    O    E             DISK
     FAZF05F    O    E             DISK
     FAZF06F    O    E             DISK
      *
     D WR1             S              1    DIM(9)
     D WR2             S              1    DIM(17)
     D WR3             S              1    DIM(30)
     D AR1             S              1    DIM(30)
     D AR2             S              1    DIM(30)
     D                 DS
     D  KA                     1     24
     D                                     DIM(6)
     D  DFNT1                  1      4
     D  DFNT2                  5      8
     D  DFNT3                  9     12
     D  DFNT4                 13     16
     D  DFNT5                 17     20
     D  DFNT6                 21     24
     D                 DS
     D  VE                     1     42  1
     D                                     DIM(6)
     D  DFVKT1                 1      7  1
     D  DFVKT2                 8     14  1
     D  DFVKT3                15     21  1
     D  DFVKT4                22     28  1
     D  DFVKT5                29     35  1
     D  DFVKT6                36     42  1
     D                 DS
     D  VA                     1    250
     D                                     DIM(10)
     D  DFVS1                  1     25
     D  DFVS2                 26     50
     D  DFVS3                 51     75
     D  DFVS4                 76    100
     D  DFVS5                101    125
     D  DFVS6                126    150
     D  DFVS7                151    175
     D  DFVS8                176    200
     D  DFVS9                201    225
     D  DFVS10               226    250
     D                 DS
     D  DS142                  1     31
     D  HEAVD                  1      4  0
     D  SLASJ                  5      5
     D  HEOPD                  6     12  0
     D  SLASJ2                13     13
     D  HESG                  14     16
     D  SLASJ3                17     17
     D  HESAML                18     23
     D                 DS
     D  DFCCPP                 1      2
     D  WDFCP1                 1      1
     D  WDFCP2                 2      2
     D                 DS
     D  WRKALF                 1     20
     D  WRKA17                 1     17
     D  WRKAL3                18     20
     D                 DS            11
     D NUM             C                   CONST(' 0123456789')
     D                 DS
     D  SMMAWB                 1     11  0
     D  MAWB3                  1      3  0
     D  MAWB8                  4     11  0
     D                SDS
     D  WUSER                254    263
      *
      * Endre feltnavn fra DOKEM
     IDOKEMR
     I              DFST                        ØFST
     I              DFSDF                       ØFSDF
     I              DFXX1A                      ØFXX1A
     I              DFNAS                       ØFNAS
     I              DFKDDC                      ØFKDDC
     I              DFBLDC                      ØFBLDC
     I              DFINF1                      ØFINF1
     I              DFINF2                      ØFINF2
     I              DFVS7                       ØFVS7
     I              DFVS8                       ØFVS8
     I              DFVS9                       ØFVS9
     I              DFVS10                      ØFVS10
     I              DFXX2A                      ØFXX2A
     I              DFFT                        ØFFT
     I              DFSG                        ØFSG
     I              DFFSN                       ØFFSN
     I              DFROA1                      ØFROA1
     I              DFROB1                      ØFROB1
     I              DFROC1                      ØFROC1
     I              DFROA2                      ØFROA2
     I              DFROB2                      ØFROB2
     I              DFROC2                      ØFROC2
     I              DFROA3                      ØFROA3
     I              DFROB3                      ØFROB3
     I              DFROC3                      ØFROC3
     I              DFVAL                       ØFVAL
     I              DFCCPP                      ØFCCPP
     I              DFDVCA                      ØFDVCA
     I              DFDVCU                      ØFDVCU
     I              DFBELF                      ØFBELF
     I              DFINFA                      ØFINFA
     I              DFINFB                      ØFINFB
     I              DFINFC                      ØFINFC
     I              DFNT1                       ØFNT1
     I              DFVKT1                      ØFVKT1
     I              DFRC1                       ØFRC1
     I              DFCOM1                      ØFCOM1
     I              DFFBV1                      ØFFBV1
     I              DFRK1                       ØFRK1
     I              DFRPR1                      ØFRPR1
     I              DFBLT1                      ØFBLT1
     I              DFVS1                       ØFVS1
     I              DFNT2                       ØFNT2
     I              DFVKT2                      ØFVKT2
     I              DFRC2                       ØFRC2
     I              DFCOM2                      ØFCOM2
     I              DFFBV2                      ØFFBV2
     I              DFRK2                       ØFRK2
     I              DFRPR2                      ØFRPR2
     I              DFBLT2                      ØFBLT2
     I              DFVS2                       ØFVS2
     I              DFNT3                       ØFNT3
     I              DFVKT3                      ØFVKT3
     I              DFRC3                       ØFRC3
     I              DFCOM3                      ØFCOM3
     I              DFFBV3                      ØFFBV3
     I              DFRK3                       ØFRK3
     I              DFRPR3                      ØFRPR3
     I              DFBLT3                      ØFBLT3
     I              DFVS3                       ØFVS3
     I              DFNT4                       ØFNT4
     I              DFVKT4                      ØFVKT4
     I              DFRC4                       ØFRC4
     I              DFCOM4                      ØFCOM4
     I              DFFBV4                      ØFFBV4
     I              DFRK4                       ØFRK4
     I              DFRPR4                      ØFRPR4
     I              DFBLT4                      ØFBLT4
     I              DFVS4                       ØFVS4
     I              DFNT5                       ØFNT5
     I              DFVKT5                      ØFVKT5
     I              DFRC5                       ØFRC5
     I              DFCOM5                      ØFCOM5
     I              DFFBV5                      ØFFBV5
     I              DFRK5                       ØFRK5
     I              DFRPR5                      ØFRPR5
     I              DFBLT5                      ØFBLT5
     I              DFVS5                       ØFVS5
     I              DFNT6                       ØFNT6
     I              DFVKT6                      ØFVKT6
     I              DFRC6                       ØFRC6
     I              DFCOM6                      ØFCOM6
     I              DFFBV6                      ØFFBV6
     I              DFRK6                       ØFRK6
     I              DFRPR6                      ØFRPR6
     I              DFBLT6                      ØFBLT6
     I              DFVS6                       ØFVS6
     I              DFNTT                       ØFNTT
     I              DFBLT                       ØFBLT
     I              DFVKTT                      ØFVKTT
     I              DFBLA                       ØFBLA
     I              DFBLAV                      ØFBLAV
     I              DFXX3A                      ØFXX3A
     I              DFRI                        ØFRI
     I              DFSD                        ØFSD
     I              DFLNR                       ØFLNR
     I              DFCMN                       ØFCMN
     I              DFTRID                      ØFTRID
      ***********************************************
      *
     C                   EXSR      INIT
      *
     C     *IN90         IFEQ      '0'
     C                   EXSR      WRTINH                                       <Write inhouse
     C     *IN90         IFEQ      '0'
     C                   EXSR      WRTLOG                                       <Write log
     C                   EXSR      SNDTAQ                                       <Send dataq
     C                   ENDIF                                                  <*IN90
     C                   ENDIF                                                  <*IN90
      *
     C     ENDPGM        TAG
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    PSMSD
     C                   PARM                    PSMLNR
     C                   PARM                    PGID
     C                   PARM                    PGIDNE
     C                   PARM                    PGPACP
     C                   PARM                    PGPACA
     C                   PARM                    PGCPAI
     C                   PARM                    PGCPAA
     C                   PARM                    PGMTM1
     C                   PARM                    PGMTM2
     C                   PARM                    PGMTM3
      *
     C     *LIKE         DEFINE    SMSD          PSMSD
     C     *LIKE         DEFINE    SMLNR         PSMLNR
     C     *LIKE         DEFINE    LGID          PGID
     C     *LIKE         DEFINE    LGIDNE        PGIDNE
     C     *LIKE         DEFINE    LGPACP        PGPACP
     C     *LIKE         DEFINE    LGPACA        PGPACA
     C     *LIKE         DEFINE    LGCPAI        PGCPAI
     C     *LIKE         DEFINE    LGCPAA        PGCPAA
     C     *LIKE         DEFINE    SMSD          WSMSD
     C     *LIKE         DEFINE    SMLNR         WSMLNR
     C     *LIKE         DEFINE    LGMTM1        PGMTM1
     C     *LIKE         DEFINE    LGMTM2        PGMTM2
     C     *LIKE         DEFINE    LGMTM3        PGMTM3
      *
     C                   MOVE      PSMSD         WSMSD
     C                   Z-ADD     PSMLNR        WSMLNR
     C                   MOVEL     WSMSD         VAR1              6
     C                   MOVE      WSMLNR        VAR1
     C                   MOVE      'F'           UNRI              1
     C                   MOVE      'M'           UMRI              1
     C                   Z-ADD     0             MX                3 0
     C                   MOVE      *BLANKS       WRK              30
      *
     C     SAMKEY        KLIST
     C                   KFLD                    WSMSD
     C                   KFLD                    WSMLNR
     C     DOKEKY        KLIST
     C                   KFLD                    UNRI
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     DOKEMK        KLIST
     C                   KFLD                    UMRI
     C                   KFLD                    SMSD
     C                   KFLD                    SMLNR
      * Dummy write
     C     *IN90         IFEQ      *ON
     C     *IN90         ANDEQ     *OFF
     C                   WRITE     HEADFR
     C                   WRITE     DOKEFR
     C                   WRITE     SAMLAR
     C                   WRITE     DOKEMR
     C                   ENDIF
      * Nullstilling av recordformater og variabler siden ikke LR
     C                   CLEAR                   HEADFR
     C                   CLEAR                   DOKEFR
     C                   CLEAR                   SAMLAR
     C                   CLEAR                   DOKEMR
      *
     C     *IN99         IFEQ      *OFF
     C                   READ      FIRM                                   90
     C                   MOVE      *ON           *IN99
     C                   ENDIF
     C     SAMKEY        CHAIN     SAMLB                              90
     C     *IN90         CABEQ     '1'           INIT99
     C     DOKEMK        CHAIN     DOKEM                              90
     C     *IN90         CABEQ     '1'           INIT99
     C                   MOVEL     WUSER         WWUSER           17
     C     WWUSER        CHAIN     LOCL01                             90
     C     *IN90         CABEQ     '1'           INIT99
     C     1             CHAIN     CNFF                               9090
     C     *IN90         CABEQ     '1'           INIT99
      * HENTER NESTE LEDIGE TRANSAKSJONS ID
     C                   ADD       1             CNRECN
     C                   UPDATE    CNFR
      * HVIS ALT GIKK GREIT KAN RUTINEN UTFØRES
     C     INIT99        TAG
     C                   ENDSR
      ***********************************************
     C     FINVER        BEGSR
      ***********************************************
      *
     C                   ENDSR
      ***********************************************
     C     WRTINH        BEGSR
      ***********************************************
      * Tar vare på opplysninger om masteren. (SAMLB og DOKEM)
     C                   CLEAR                   AZF00R
     C                   Z-ADD     CNRECN        G00REC
     C                   MOVEL     VAR1          G0142
     C                   Z-ADD     MAWB3         G0231
     C                   Z-ADD     MAWB8         G0233
     C                   MOVEL     ØFSDF         G0241
     C                   MOVEL     ØFSD          G0242
     C                   Z-ADD     ØFNTT         G0253
     C                   MOVEL     'K'           G0254
     C                   Z-ADD     ØFVKTT        G0255
      * Lager løkke for å ta vare på HWB opplysninger.
     C     SMPRO         SETLL     HEAD11                                 92
     C     *IN92         IFEQ      *OFF
     C                   MOVE      *ON           *IN90
     C                   GOTO      WRT99
     C                   ENDIF
     C     SMPRO         READE     HEAD11                                 92
     C     *IN92         DOWEQ     *OFF
     C     DOKEKY        CHAIN     DOKEF                              90
     C     *IN90         CABEQ     *ON           WRT99
     C                   CLEAR                   AZF03R
     C                   Z-ADD     CNRECN        G03REC                         <FELLES
     C                   MOVEL     HEHAWB        G033
     C                   MOVEL     HESDF         G0351
     C                   MOVEL     HESDT         G0352
     C                   Z-ADD     DFNTT         G0371
     C                   MOVEL     'K'           G0373
     C                   Z-ADD     DFVKTT        G0374
      * SKRIVER POSTER TIL AZF04F (WAYBILL DETAILS)
      * KUN TOTALER OG FØRSTE VAREBESKRIVELSE
      * ENDRET PÅ TELEFON MED HANSSON DEN 5.2.95
      *                    Z-ADD1         MX
      *                    DO   6
      *          KA,MX     IFNE *BLANKS
      *          VE,MX     ORNE *ZEROS
      *                    CLEARAZF04R
      *                    Z-ADDCNRECN    G04REC           <FELLES
      *          NUM       CHECKKA,MX     RES     10
      *          RES       IFEQ 0
      *                    MOVE KA,MX     WRK40   40
      *                    Z-ADDWRK40     G0431
      *                    MOVE 'K'       G0433
      *                    Z-ADDVE,MX     G0434
      *                    MOVELHEHAWB    G04999
      *                    WRITEAZF04R
      *                    END                             <KA1,MX
      *                    ENDIF
      *          VA,MX     IFNE *BLANKS
      *                    CLEARAZF40R
      *                    Z-ADDCNRECN    G40REC           <FELLES
      *                    MOVELVA,MX     G0444
      *                    MOVELHEHAWB    G40999
      *                    WRITEAZF40R
      *                    ENDIF
      *                    ADD  1         MX
      *                    ENDDO                           <DO 6
     C                   CLEAR                   AZF04R
     C                   Z-ADD     CNRECN        G04REC                         <FELLES
     C                   MOVEL     HEHAWB        G04999
     C                   Z-ADD     DFNTT         G0431
     C                   MOVEL     'K'           G0433
     C                   Z-ADD     DFVKTT        G0434
     C                   WRITE     AZF04R
     C                   CLEAR                   AZF40R
     C                   Z-ADD     CNRECN        G40REC                         <FELLES
     C                   MOVEL     HEHAWB        G40999
     C                   MOVEL     DFVS1         G0444
     C                   WRITE     AZF40R
      * Shipper Name and Address
     C                   MOVEL     HENAS         G053
     C                   MOVEL     HEADS1        G0552
     C                   Z-ADD     1             XW                3 0
     C                   Z-ADD     0             MY                3 0
     C                   MOVEA     *BLANKS       WR3
     C                   MOVEA     *BLANKS       WR2
     C                   MOVEA     *BLANKS       WR1
     C                   MOVEA     HEADS3        WR3
     C     WR3(XW)       DOWNE     *BLANK
     C     XW            ANDLE     9
     C                   MOVE      WR3(XW)       WR1(XW)
     C                   ADD       1             XW
     C                   ENDDO
     C                   DO        17
     C                   ADD       1             XW
     C                   ADD       1             MY
     C                   MOVE      WR3(XW)       WR2(MY)
     C                   ENDDO
     C                   MOVEA     WR2           G0562
     C                   MOVEL     *BLANKS       G0564
     C                   MOVEL     HELKS         G0572
     C     G0572         IFEQ      *BLANKS
     C     HESDF         CHAIN     STED2                              66
     C     *IN66         IFEQ      *OFF
     C                   MOVEL     ST2LK         G0572
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     WR1           G0574
     C     DFTLFS        IFNE      *BLANKS
     C                   CLEAR                   AZF05R
     C                   Z-ADD     CNRECN        G05REC                         <FELLES
     C                   MOVEL     'TE'          G0582
     C                   MOVEL     DFTLFS        G0584
     C                   WRITE     AZF05R
     C                   ENDIF
      * Consignee Name and Address
     C                   MOVEL     HENAK         G063
     C                   MOVEL     HEADK1        G0652
     C                   Z-ADD     1             XW                3 0
     C                   Z-ADD     0             MY
     C                   MOVEA     *BLANKS       WR3
     C                   MOVEA     *BLANKS       WR2
     C                   MOVEA     *BLANKS       WR1
     C                   MOVEA     HEADK3        WR3
     C     WR3(XW)       DOWNE     *BLANK
     C     XW            ANDLE     9
     C                   MOVE      WR3(XW)       WR1(XW)
     C                   ADD       1             XW
     C                   ENDDO
     C                   DO        17
     C                   ADD       1             XW
     C                   ADD       1             MY
     C                   MOVE      WR3(XW)       WR2(MY)
     C                   ENDDO
     C                   MOVEA     WR2           G0662
     C     G0662         IFEQ      *BLANKS
     C                   MOVEL     HEADK2        G0662
     C                   ENDIF
     C                   MOVEL     *BLANKS       G0664
     C                   MOVEL     HELKK         G0672
     C     G0672         IFEQ      *BLANKS
     C                   MOVEL     HELKA         G0672
     C                   ENDIF
     C     G0672         IFEQ      *BLANKS
     C     HESDT         CHAIN     STED2                              66
     C     *IN66         IFEQ      *OFF
     C                   MOVEL     ST2LK         G0672
     C                   ENDIF
     C                   ENDIF
     C                   MOVEA     WR1           G0674
     C     DFTLFK        IFNE      *BLANKS
     C                   CLEAR                   AZF06R
     C                   Z-ADD     CNRECN        G06REC                         <FELLES
     C                   MOVEL     'TE'          G0682
     C                   MOVEL     DFTLFK        G0684
     C                   WRITE     AZF06R
     C                   ENDIF
      * Charge Declarations
     C                   MOVEL     DFVAL         G073
     C                   MOVEL     WDFCP1        G075
     C                   MOVEL     DFDVCA        WRK
     C                   EXSR      CHKNUM
     C     *IN91         IFEQ      '0'
     C     *IN92         ANDEQ     '0'
     C                   MOVE      *BLANKS       WRKALF
     C                   MOVE      WRK           WRKA17
     C                   MOVE      *ZEROS        WRKAL3
     C                   MOVE      WRKALF        G0771
     C                   ELSE
     C                   Z-ADD     0             G0771
     C                   ENDIF
     C                   MOVEL     DFDVCU        WRK
     C                   EXSR      CHKNUM
     C     *IN91         IFEQ      '0'
     C     *IN92         ANDEQ     '0'
     C                   MOVE      *BLANKS       WRKALF
     C                   MOVE      WRK           WRKA17
     C                   MOVE      *ZEROS        WRKAL3
     C                   MOVE      WRKALF        G0791
     C                   ELSE
     C                   Z-ADD     0             G0791
     C                   ENDIF
     C                   Z-ADD     DFBELF        G07111
     C                   WRITE     AZF03R
      *
     C     SMPRO         READE     HEAD11                                 92
     C                   ENDDO                                                  <*IN92
     C                   WRITE     AZF00R
     C     WRT99         ENDSR
      ***********************************************
     C     WRTLOG        BEGSR
      ***********************************************
     C                   CLEAR                   LOGR
     C                   MOVE      PGID          LGID
     C                   MOVE      PGIDNE        LGIDNE
     C                   MOVE      PGPACP        LGPACP
     C                   MOVE      PGPACA        LGPACA
     C                   MOVE      PGCPAI        LGCPAI
     C                   MOVE      PGCPAA        LGCPAA
     C                   MOVE      PGMTM1        LGMTM1
     C                   MOVE      PGMTM2        LGMTM2
     C                   MOVE      PGMTM3        LGMTM3
     C                   Z-ADD     CNRECN        LGRECN
     C                   Z-ADD     CNRECN        LGTRID
     C                   MOVEL     LOID          LGSID
     C                   MOVEL     'AZF'         LGMSID
     C                   MOVEL     'T'           LGTR
     C                   MOVEL     'A'           LGSTAT
     C                   MOVEL     UDATE         LGDATE
     C                   TIME                    LGTIME
      *
     C                   WRITE     LOGR
      *
     C                   ENDSR
      ***********************************************
     C     SNDTAQ        BEGSR
      ***********************************************
     C                   MOVEL     'SMADTATQ'    QTNAME           10
     C                   MOVEL     '*LIBL'       QTLIB            10
     C                   Z-ADD     9             QTLEN             5 0
     C                   MOVEL     *BLANKS       QTFIEL            9
     C                   MOVEL     LGRECN        QTFIEL
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QTNAME
     C                   PARM                    QTLIB
     C                   PARM                    QTLEN
     C                   PARM                    QTFIEL
      *
     C                   ENDSR
     C***********************************************
     C     CHKNUM        BEGSR
     C***********************************************
     C                   MOVE      *OFF          *IN91
     C                   Z-ADD     30            ÆX                3 0
     C                   Z-ADD     30            ÆY                3 0
     C                   MOVEA     *BLANKS       AR1
     C                   MOVEA     *BLANKS       AR2
     C                   MOVEA     WRK           AR1
     C     WRK           CABEQ     *BLANKS       CHK99                    92
      * POSISJONER TIL SISTE TEGN I FELTET
     C     AR1(ÆX)       DOWEQ     *BLANK
     C                   SUB       1             ÆX
     C                   ENDDO
      * ERSTATT BLANK MED NULL OG SJEKK OM DET BARE ER TALL
     C     ÆX            DOWGT     0
     C     AR1(ÆX)       IFEQ      *BLANK
     C                   MOVE      '0'           AR1(ÆX)
     C                   ENDIF
     C     AR1(ÆX)       IFGE      '0'
     C     AR1(ÆX)       ANDLE     '9'
     C                   MOVE      AR1(ÆX)       AR2(ÆY)
     C                   SUB       1             ÆX
     C                   SUB       1             ÆY
     C                   ELSE                                                   <AR1,ÆX
      * FELTET INNEHOLDER IKKE BARE TALL. 91 BLIR SATT PÅ
     C                   MOVE      *ON           *IN91
     C                   GOTO      CHK99
     C                   END                                                    <AR1,ÆX
     C                   ENDDO                                                  <ÆX
      * FYLL OPP RESTEN AV FELTET MED NULL
     C     ÆY            DOWGT     0
     C                   MOVE      '0'           AR2(ÆY)
     C                   SUB       1             ÆY
     C                   ENDDO
      *
     C                   MOVEA     AR2           WRK              30
      *
     C     CHK99         ENDSR
