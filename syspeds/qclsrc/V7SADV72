             PGM
             DCL        VAR(&LIB1) TYPE(*CHAR) LEN(10) +
                          VALUE('V7SADFV7')
             DCL        VAR(&LIB2) TYPE(*CHAR) LEN(10) +
                          VALUE('V7SADOV7')
             DCL        VAR(&LIB3) TYPE(*CHAR) LEN(10) VALUE('SYSPEDF')
             DCL        VAR(&LIB4) TYPE(*CHAR) LEN(10) VALUE('SYSPEDO')
             DCL        VAR(&TOMME) TYPE(*CHAR) LEN(1) VALUE('N')
             DCLF       FILE(V7SYSF/V7SADD72) RCDFMT(BILDE01)

             ADDLIBLE   LIB(V7SYSF)
             MONMSG     MSGID(CPF0000)
             CHGJOB     JOB(*) LOG(4 00 *SECLVL) LOGCLPGM(*YES)
LOOP1:
             SNDRCVF    DEV(*FILE) RCDFMT(*FILE)
             IF         COND(&IN03 = '1') THEN(GOTO CMDLBL(SLUTT))
             CHGVAR     VAR(&IN30) VALUE('0')
             CHGVAR     VAR(&IN31) VALUE('0')

             CHKOBJ     OBJ(QSYS/&LIB3) OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801 CPF9810) EXEC(CHGVAR +
                          VAR(&IN30) VALUE('1'))
             CHKOBJ     OBJ(QSYS/&LIB4) OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801 CPF9810) EXEC(CHGVAR +
                          VAR(&IN31) VALUE('1'))

             IF         COND(&IN30 = '1' *OR &IN31 = '1') THEN(GOTO +
                          CMDLBL(LOOP1))
             IF         COND(&IN32 = '1' *OR &IN33 = '1') THEN(GOTO +
                          CMDLBL(LOOP1))

             CALL       PGM(SYSPED/INLIBL)
             RMVLIBLE   LIB(SYENDRE)
             RMVLIBLE   LIB(SYEDIE)
             ADDLIBLE   LIB(V7SYSF)

             /* STOPP DELSYSTEM */
             ENDSBS     SBS(SY400SBS) OPTION(*IMMED)
             MONMSG     MSGID(CPF0000)
             ENDSBS     SBS(SYEDISBS) OPTION(*IMMED)
             MONMSG     MSGID(CPF0000)
             DLYJOB     DLY(15)

             /* KONVERTER FILER */
             CRTLIB     LIB(&LIB1)
             CRTLIB     LIB(&LIB2)
             CPYF       FROMFILE(V7SYSF/SYPTFF) TOFILE(&LIB3/SYPTFF) +
                          MBROPT(*ADD)
             CPYF       FROMFILE(V7SYSF/TVINE) TOFILE(&LIB3/TVINE) +
                          MBROPT(*ADD)
             CHGCURLIB  CURLIB(V7SYSF)
             CALL       PGM(V7FKC09) PARM('STANDI' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC10) PARM('STANDE' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC11) PARM('SADH' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC12) PARM('SAEH' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC15) PARM('ZADH' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC16) PARM('ZAEH' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC17) PARM('SADTRH' &LIB3 &LIB1 &TOMME)
             CALL       PGM(V7FKC19) PARM('STANDT' &LIB3 &LIB1 &TOMME)

             CHGCURLIB  CURLIB(V7SYSO)
             ADDLIBLE   LIB(V7SYSF)
             MONMSG     MSGID(CPF0000)
             CALL       PGM(V7FKC11) PARM('SADH' &LIB4 &LIB2 &TOMME)
             CALL       PGM(V7FKC12) PARM('SAEH' &LIB4 &LIB2 &TOMME)
             CALL       PGM(V7FKC13) PARM('SADHCMP' &LIB4 &LIB2 &TOMME)
             CALL       PGM(V7FKC14) PARM('SAEHCMP' &LIB4 &LIB2 &TOMME)
             CALL       PGM(V7FKC17) PARM('SADTRH' &LIB4 &LIB2 &TOMME)
             CALL       PGM(V7FKC18) PARM('SADTRCMP' &LIB4 &LIB2 +
                          &TOMME)
             CHGCURLIB  CURLIB(*CRTDFT)
             RMVLIBLE   LIB(V7SYSF)

 SLUTT:      ENDPGM
