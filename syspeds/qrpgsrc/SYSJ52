********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL SPØRRE PÅ BOOKING (HENTE SØKEVEI)            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01 02 05-26                            ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-84                      ***
      *****************************************************************
      *
     FKODTA     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FBOOKLF03  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYSJ52FM  CF   E             WORKSTN INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTÅ                   1      2  0
     D  XDTM                   3      4  0
     D  XDTD                   5      6  0
     D  XDT                    1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18
     D  USG                   19     21
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C  N30
     CANN04WSAVD         IFEQ      0
     C                   Z-ADD     3             LINNBR
     C                   ELSE
     C                   Z-ADD     7             LINNBR
     C                   END
     C  N30
     CANN04              Z-ADD     28            POSNBR
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C   03              GOTO      SLUTT
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '0000000'     *IN(85)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C*
     C                   MOVE      WSDTD         XDTD
     C                   MOVE      WSDTM         XDTM
     C                   MOVE      WSDTÅ         XDTÅ
     C                   MOVE      XDT           UDT               6 0
     C                   Z-ADD     0             UFLAGG            1 0
     C                   CALL      'SYSJ52A'
     C                   PARM                    WSAVD
     C                   PARM                    UDT
     C                   PARM                    WSNR
     C                   PARM                    WSÅR
     C                   PARM                    WSUKE
     C                   PARM                    WSUKET
     C                   PARM                    WSKNR
     C                   PARM                    WSTR
     C                   PARM                    WSKNA
     C                   PARM                    WSLB
     C                   PARM                    WSLSH
     C                   PARM                    WSKNS
     C                   PARM                    WSOB
     C                   PARM                    WSOPD
     C                   PARM                    WSREFN
     C                   PARM                    WSLOH
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      -3
     C                   MOVE      WSAVD         UAVD2
     C                   MOVE      WSOPD         UOPD2
     C                   ELSE
     C     UFLAGG        IFNE      3
     C                   GOTO      START
     C                   END
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C*
     C     WSDT          IFNE      0
     C                   MOVE      WSDTÅ         UÅÅ               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      98
     C   98
     CANN30              MOVE      'SPD0001'     MSGNR
     C   98              SETON                                        30
     C                   END
     C*
     C     WSNR          COMP      0                                      97
     C  N97WSNR          COMP      11                                 97
     C   97
     CANN30              MOVE      'SPN0104'     MSGNR
     C   97              SETON                                        30
     C*
     C     WSUKE         COMP      53                                 96
     C   96
     CANN30              MOVE      'SPU0101'     MSGNR
     C   96              SETON                                        30
     C*
     C     WSUKET        IFEQ      0
     C                   MOVE      WSUKE         WSUKET
     C                   ELSE
     C     WSUKET        COMP      53                                 95
     C   95
     CANN30              MOVE      'SPU0101'     MSGNR
     C   95              SETON                                        30
     C                   END
     C*
     C  N96WSNR          IFEQ      1
     C     WSUKE         COMP      0                                      96
     C   96
     CANN30              MOVE      'SPU0101'     MSGNR
     C   96              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      2
     C     KUNDRK        CHAIN     CUNDL01                            94
     C   94
     CANN30              MOVE      'SPK0121'     MSGNR
     C   94              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      3
     C     BOOK3K        SETLL     BOOKLF03
     C     WSAVD         READE     BOOKLF03                               93
     C  N93WSTR          COMP      BOTR                               9393
     C   93
     CANN30              MOVE      'SPT0102'     MSGNR
     C   93              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      4
     C     KUNDAK        CHAIN     CUNDL01                            92
     C   92
     CANN30              MOVE      'SPK0126'     MSGNR
     C   92              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      5
     C     WSLB          CHAIN     CDBOAT                             91
     C   91
     CANN30              MOVE      'SPB0102'     MSGNR
     C   91              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      6
     C     WSLSH         CHAIN     STED2                              90
     C   90
     CANN30              MOVE      'SPS0102'     MSGNR
     C   90              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      7
     C     KUNDSK        CHAIN     CUNDL01                            89
     C   89
     CANN30              MOVE      'SPK0122'     MSGNR
     C   89              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      8
     C     WSOB          CHAIN     CDBOAT                             88
     C   88
     CANN30              MOVE      'SPB0103'     MSGNR
     C   88              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      9
     C     WSOPD         COMP      0                                      87
     C   87
     CANN30              MOVE      'SPO0016'     MSGNR
     C   87              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      10
     C     WSREFN        COMP      *BLANKS                                86
     C   86
     CANN30              MOVE      'DIV4103'     MSGNR
     C   86              SETON                                        30
     C                   END
     C*
     C     WSNR          IFEQ      11
     C     WSLOH         CHAIN     STED2                              85
     C   85
     CANN30              MOVE      'SPS0104'     MSGNR
     C   85              SETON                                        30
     C                   END
     C*
     C   30              DO
     C   86
     COR 85
     COR 87
     COR 88              Z-ADD     28            POSNBR
     C   89
     COR 90
     COR 91
     COR 92
     COR 93
     COR 94              Z-ADD     28            POSNBR
     C   95              Z-ADD     59            POSNBR
     C   96              Z-ADD     42            POSNBR
     C   97
     COR 98
     COR 99              Z-ADD     28            POSNBR
     C   85              Z-ADD     20            LINNBR
     C   86              Z-ADD     19            LINNBR
     C   87              Z-ADD     18            LINNBR
     C   88              Z-ADD     17            LINNBR
     C   89              Z-ADD     16            LINNBR
     C   90              Z-ADD     15            LINNBR
     C   91              Z-ADD     14            LINNBR
     C   92              Z-ADD     13            LINNBR
     C   93              Z-ADD     12            LINNBR
     C   94              Z-ADD     11            LINNBR
     C   95
     COR 96              Z-ADD     10            LINNBR
     C   97              Z-ADD     8             LINNBR
     C   98              Z-ADD     7             LINNBR
     C   99              Z-ADD     3             LINNBR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     35
S01  C*                  EXSR      SØKKUN
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     12            LINNBR
N01  C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     35
S01  C*                  EXSR      SØKKUN
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     14            LINNBR
N01  C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     35
S01  C*                  EXSR      SØKKUN
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     17            LINNBR
N01  C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     29
     C                   CALL      'SYSJ17A'
     C                   PARM                    WSKNR
     C                   PARM                    WSTR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSLB
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLSH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSOB
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     28
     C     POSNBR        ANDLE     32
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLOH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
S01  C***********************************************
S01  C*    SØKKUN        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNR
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNA
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    WSKNS
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVD
     C     KUNDRK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNR
     C     KUNDAK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNA
     C     KUNDSK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNS
     C     BOOK3K        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSTR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD2             4 0
     C                   PARM                    UOPD2             7 0
     C*
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      UYEAR         WSÅR
     C     UAVD2         IFEQ      0
     C                   TESTN                   UAVD                 33
     C   33              MOVE      UAVD          WSAVD
     C  N33              MOVE      *ZEROS        WSAVD
     C                   ELSE
     C                   MOVE      UAVD2         WSAVD
     C                   END
     C*
S01  C*                  Z-ADD     3             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
S01  C*
S01  C*                  MOVE      'DIV3114'     XMSGNR            7            MELDING-ID
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIVÅ
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV3110'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*                  MOVE      'DIV3111'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT3            8
     C*
     C                   SETOFF                                       33
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      FIFIRM        UFIRM
     C*
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    HENTMS        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    XMSG             62
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
