     FEDIRE1K   IF   E           K DISK
     FEUROOH    O    E             DISK
     FEUROOL    O    E             DISK
     D                 DS
     D  RDATA                  1   1024
     D  RTYP                   1      2
     D                 DS
     D  FE                     1    256
     D                                     DIM(256)
     D  FELT                   1    256
     D                 DS
     D  AA                     1   1024
     D                                     DIM(1024)
     D  AADS                   1   1024
     D                 DS
     D  ZDEC                   1      7  6
     D  ZDEC6                  2      7
     D  ZHEL                  11     22  0
     D                 DS
     D  A                      1     79
     D                                     DIM(79)
     D                 DS
     D  B                      1     18
     D                                     DIM(18)
      */////////////
      * MAIN LOGIC /
      */////////////
     C                   EXSR      SRINIT
     C     UMBR          SETLL     EDIRE1K
     C     UMBR          READE     EDIRE1K                                91
     C     *IN91         DOWEQ     *OFF

     C                   SELECT
     C     RTYP          WHENEQ    '00'
     C                   EXSR      HODE00
     C     RTYP          WHENEQ    '10'
     C                   EXSR      HODE10
     C     RTYP          WHENEQ    '11'
     C                   EXSR      HODE11
     C     RTYP          WHENEQ    '20'
     C                   EXSR      LINJE20
     C                   OTHER
     C                   ENDSL

     C     UMBR          READE     EDIRE1K                                91
     C                   ENDDO

     C     LR            TAG
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      * SR for init                                        SRINIT /
      *////////////////////////////////////////////////////////////
     C     SRINIT        BEGSR
     C     *ENTRY        PLIST
     C                   PARM                    UMBR             10
      * Hente dagens dato og tid
     C                   CALL      'SYGE15C'
     C                   PARM                    WDATO             8
     C                   PARM                    WTID              6
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * HODE 00 Start av fil                               HODE00 /
      *////////////////////////////////////////////////////////////
     C     HODE00        BEGSR
      * Init
     C                   MOVEL     RDATA         AADS
     C                   Z-ADD     1             WX
      * 0. Posttype
     C                   EXSR      GETDED
      * 1. Teknisk avsender
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH1
      * 2. Teknisk mottager
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH2
      * 3. Teknisk dato
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH3
      * 4. Teknisk klokkeslett
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH4
      * 5. Teknisk referanse
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH5
      * 6. Funksjonsreferanse
     C                   EXSR      GETDED
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * HODE 10 Hode 1
      *////////////////////////////////////////////////////////////
     C     HODE10        BEGSR
      * Init
     C                   MOVEL     RDATA         AADS
     C                   Z-ADD     1             WX
      * 0. Posttype
     C                   EXSR      GETDED
      * 1. Ordrenummer
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH6
      * 2. Ordredato
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH7
      * 3. Transportkode
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH8
      * 4. Lev.bet kode
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH9
      * 5. Lev.bet sted
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH10
      * 6. Fra landkode
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH11
      * 7. Til landkode
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH12
      * 8. Fra sted
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH13
      * 9. Til sted
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH14
      * 10. Facility
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH15
      * 11. Lev. Referanse
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH16
      * 23. Innkjøper
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH23
      * 24. Innkjøper
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH24
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * HODE 11 Leverandør
      *////////////////////////////////////////////////////////////
     C     HODE11        BEGSR
      * Init
     C                   MOVEL     RDATA         AADS
     C                   Z-ADD     1             WX
      * 0. Posttype
     C                   EXSR      GETDED
      * 1. Leverandørnummer
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH17
      * 2. Navn
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH18
      * 3. Adresse1
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH19
      * 4. Adresse2
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH20
      * 5. Adresse3
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH10
      * 6. Adresse4
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH11
      * 25. Epost
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH25
      * 26. Ref hos Lev
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH26
      * 27. Telefon
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH27
      * 28. FAx
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOH28
      * Skriv post
     C                   WRITE     EUROOHR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * Ordrelinje                                        LINJE20 /
      *////////////////////////////////////////////////////////////
     C     LINJE20       BEGSR
      * Ordrenummer
     C                   MOVEL     EUROOH5       EUROOL1
      * Teknisk referanse
     C                   MOVEL     EUROOH6       EUROOL2
      * Init
     C                   MOVEL     RDATA         AADS
     C                   Z-ADD     1             WX                4 0
      * 0. Posttype
     C                   EXSR      GETDED
      * 1. Linjenummer
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL3
      * 2. Underlinjenummer
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL4
      * 3. Art.nr Europris
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL5
      * 4. Art.nr Leverandør
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL6
      * 5. Art. beskrivelse
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL7
      * 6. Art. beskrivelse
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL8
      * 7. Ant. F-pak bestillt
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL9
      * 8. Ant. D-pak bestillt
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL10
      * 9. Bvekt bestillt
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL11
      * 9. Nvekt bestillt
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL12
      * 10. Volume, M3 bstillt
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL13
      * 11. Shipdato, tidligest
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL14
      * 12. Shipdato, forventet
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL15
      * 13. Shipdato, senest
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL16
      * 14. Ankomstdato, forventet
     C                   EXSR      GETDED
     C                   MOVEL     FELT          EUROOL17
      * Skriv post
     C                   WRITE     EUROOLR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * Get Data Element                                   GETDED /
      *////////////////////////////////////////////////////////////
     C     GETDED        BEGSR
     C                   MOVEA     *BLANKS       FE
     C     WX            IFGE      1023
     C                   GOTO      ENDDED
     C                   ENDIF
     C     1             DO        256           NR                3 0
     C                   MOVE      AA(WX)        TEGN              1
     C                   ADD       1             WX
     C     TEGN          IFEQ      ';'
     C                   GOTO      ENDDED
     C                   ENDIF
     C                   MOVEA     TEGN          FE(NR)
     C     WX            IFGE      1023
     C                   GOTO      ENDDED
     C                   ENDIF
     C                   ENDDO
     C     ENDDED        ENDSR
      *////////////////////////////////////////////////////////////
      *  Get numerical value                               GETNUM /
      *////////////////////////////////////////////////////////////
     C     GETNUM        BEGSR
     C                   MOVE      *ZEROS        ZHEL
     C                   MOVE      *ZEROS        ZDEC
     C                   MOVE      *ZEROS        B
     C                   Z-ADD     1             AX                2 0
     C                   Z-ADD     1             BX                2 0
      * Get Integer
     C     A(AX)         DOWGE     '0'
     C     ZHEL          MULT      10            ZHEL
     C                   MOVE      A(AX)         ZHEL
     C                   ADD       1             AX
     C                   ENDDO
      * Decimal point ?
     C     A(AX)         IFEQ      '.'
     C     A(AX)         OREQ      ','
     C                   ADD       1             AX
     C     A(AX)         DOWGE     '0'
     C                   MOVE      A(AX)         B(BX)
     C                   ADD       1             AX
     C                   ADD       1             BX
     C                   ENDDO
     C                   MOVEA     B             ZDEC6
     C                   ENDIF
      * Concatenate
     C                   Z-ADD     ZHEL          ZNUM             18 6
     C                   ADD       ZDEC          ZNUM
     C                   ENDSR
