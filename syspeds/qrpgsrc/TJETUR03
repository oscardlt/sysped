      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TJETUR03 MODULE(*LIBL/TJETUR03 *LIBL/INCGI)
CRTPGM*        ACTGRP(CGI) AUT(*USE)
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 JOV PTF11 lagt til turs oppdr.type
********************************************************************
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FTURER     UF A E           K DISK    USROPN
     F                                     PREFIX(X)
     FTURER14   IF A E             DISK    USROPN
     F                                     RENAME(TURERR:TURERR14)
     FTELL      UF   E           K DISK    USROPN
     FTELLRU    UF   E           K DISK    USROPN
     FBRPARF    IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D WMODE           S              2
     D JSONstring      S          32000
     D Error           S            150
     D WA              S             15
     D AVDZER          S              4  0

     D UPC             C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C                   EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬tuavd¬ : ¬'+%trim(%editc(WTUAVD:'Z'))+'¬, '
        +'¬tupro¬ : ¬'+%trim(%editc(WTUPRO:'Z'))+'¬, '
        +'¬mode¬ : ¬'+%trim(WMODE)+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     c                   eval      JSONstring ='"updatetrip" : ['
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     TURER
     C  N50              CLOSE     TURER14
     C  N50              CLOSE     TELL
     C  N50              CLOSE     TELLRU
     C  N50              CLOSE     BRPARF

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      WMODE   = zhbgetvar('MODE')
     C                   EVAL      TUST    = zhbgetvar('TUST')
     C                   EVAL      WA         = zhbgetvar('TUAVD')
     C                   EVAL      WTUAVD     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUPRO')
     C                   EVAL      WTUPRO     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUDT')
     C                   EVAL      TUDT       = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUKNA')
     C                   EVAL      TUKNA      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUKNT')
     C                   EVAL      TUKNT      = c2n2(WA)
     C                   EVAL      TUNAT      = zhbgetvar('TUNAT')
     C                   EVAL      TUAD1T     = zhbgetvar('TUAD1T')
     C                   EVAL      TUAD2T     = zhbgetvar('TUAD2T')
     C                   EVAL      TUAD3T     = zhbgetvar('TUAD3T')
     C                   EVAL      TUBILN     = zhbgetvar('TUBILN')
     C     LO:UPC        XLATE     TUBILN        TUBILN
     C                   EVAL      TUTARF     = zhbgetvar('TUTARF')
     C     LO:UPC        XLATE     TUTARF        TUTARF
     C                   EVAL      TULK       = zhbgetvar('TULK')
     C     LO:UPC        XLATE     TULK          TULK
     C                   EVAL      TUXXX1     = zhbgetvar('TUXXX1')
     C     LO:UPC        XLATE     TUXXX1        TUXXX1
     C                   EVAL      TUSDF      = zhbgetvar('TUSDF')
     C     LO:UPC        XLATE     TUSDF         TUSDF
     C                   EVAL      TUSDT      = zhbgetvar('TUSDT')
     C     LO:UPC        XLATE     TUSDT         TUSDT
     C                   EVAL      WA         = zhbgetvar('TUAO')
     C                   EVAL      TUAO       = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTS')
     C                   EVAL      TUTS       = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTVKT')
     C                   EVAL      TUTVKT     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTLM')
     C                   EVAL      TUTLM      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTM3')
     C                   EVAL      TUTM3      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TULAST')
     C                   EVAL      TULAST     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUBUSJ')
     C                   EVAL      TUBUSJ     = c2n2(WA)
     C                   EVAL      TUXXX2     = zhbgetvar('TUXXX2')
     C                   EVAL      TUTST1     = zhbgetvar('TUTST1')
     C                   EVAL      TUTST2     = zhbgetvar('TUTST2')
     C                   EVAL      TUTST3     = zhbgetvar('TUTST3')
     C                   EVAL      TUTST4     = zhbgetvar('TUTST4')
     C                   EVAL      TUTST5     = zhbgetvar('TUTST5')
     C                   EVAL      TUAVRE     = zhbgetvar('TUAVRE')
     C                   EVAL      WA         = zhbgetvar('TUAVNR')
     C                   EVAL      TUAVNR     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TURUND')
     C                   EVAL      TURUND     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TURACC')
     C                   EVAL      TURACC     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TURAAR')
     C                   EVAL      TURAAR     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TURMND')
     C                   EVAL      TURMND     = c2n2(WA)
     C                   EVAL      TUOPDT     = zhbgetvar('TUOPDT')
     C     LO:UPC        XLATE     TUOPDT        TUOPDT
     C                   EVAL      WA         = zhbgetvar('TUTRMA')
     C                   EVAL      TUTRMA     = c2n2(WA)
     C                   EVAL      TUHENG     = zhbgetvar('TUHENG')
     C     LO:UPC        XLATE     TUHENG        TUHENG
     C                   EVAL      TULKH      = zhbgetvar('TULKH')
     C     LO:UPC        XLATE     TULKH         TULKH
     C                   EVAL      TUCON1     = zhbgetvar('TUCON1')
     C     LO:UPC        XLATE     TUCON1        TUCON1
     C                   EVAL      TULKC1     = zhbgetvar('TULKC1')
     C     LO:UPC        XLATE     TULKC1        TULKC1
     C                   EVAL      TUCON2     = zhbgetvar('TUCON2')
     C     LO:UPC        XLATE     TUCON2        TUCON2
     C                   EVAL      TULKC2     = zhbgetvar('TULKC2')
     C     LO:UPC        XLATE     TULKC2        TULKC2
     C                   EVAL      WA         = zhbgetvar('TUTARA')
     C                   EVAL      TUTARA     = c2n2(WA)
     C                   EVAL      TUBILK     = zhbgetvar('TUBILK')
     C     LO:UPC        XLATE     TUBILK        TUBILK
     C                   EVAL      WA         = zhbgetvar('TUKNT2')
     C                   EVAL      TUKNT2     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUSJA1')
     C                   EVAL      TUSJA1     = c2n2(WA)
     C                   EVAL      TUSJN1     = zhbgetvar('TUSJN1')
     C     LO:UPC        XLATE     TUSJN1        TUSJN1
     C                   EVAL      WA         = zhbgetvar('TUSJA2')
     C                   EVAL      TUSJA2     = c2n2(WA)
     C                   EVAL      TUSJN2     = zhbgetvar('TUSJN2')
     C     LO:UPC        XLATE     TUSJN2        TUSJN2
     C                   EVAL      TUSTEF     = zhbgetvar('TUSTEF')
     C     LO:UPC        XLATE     TUSTEF        TUSTEF
     C                   EVAL      TUSONF     = zhbgetvar('TUSONF')
     C     LO:UPC        XLATE     TUSONF        TUSONF
     C                   EVAL      WA         = zhbgetvar('TUDTT')
     C                   EVAL      TUDTT      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTM')
     C                   EVAL      TUTM       = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTMT')
     C                   EVAL      TUTMT      = c2n2(WA)
     C                   EVAL      TUSTET     = zhbgetvar('TUSTET')
     C     LO:UPC        XLATE     TUSTET        TUSTET
     C                   EVAL      TUSONT     = zhbgetvar('TUSONT')
     C     LO:UPC        XLATE     TUSONT        TUSONT
     C                   EVAL      WA         = zhbgetvar('TUKVKT')
     C                   EVAL      TUKVKT     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUKAM3')
     C                   EVAL      TUKAM3     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUKALM')
     C                   EVAL      TUKALM     = c2n2(WA)
     C                   EVAL      TUTO1A     = zhbgetvar('TUTO1A')
     C                   EVAL      TUTO1B     = zhbgetvar('TUTO1B')
     C                   EVAL      TUTVAL     = zhbgetvar('TUTVAL')
     C                   EVAL      TUTAKO     = zhbgetvar('TUTAKO')
     C                   EVAL      WA         = zhbgetvar('TUTBEL')
     C                   EVAL      TUTBEL     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTREF')
     C                   EVAL      TUTREF     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUHOYB')
     C                   EVAL      TUHØYB     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUHOYH')
     C                   EVAL      TUHØYH     = c2n2(WA)
     C                   EVAL      TUSG       = zhbgetvar('TUSG')
     C     LO:UPC        XLATE     TUSG          TUSG
     C                   EVAL      WA         = zhbgetvar('TUANT1')
     C                   EVAL      TUANT1     = c2n2(WA)
     C                   EVAL      TUENH1     = zhbgetvar('TUENH1')
     C                   EVAL      WA         = zhbgetvar('TUANT2')
     C                   EVAL      TUANT2     = c2n2(WA)
     C                   EVAL      TUENH2     = zhbgetvar('TUENH2')
     C                   EVAL      WA         = zhbgetvar('TUKM')
     C                   EVAL      TUKM       = c2n2(WA)
     C                   EVAL      TUBLNR     = zhbgetvar('TUBLNR')
     C     LO:UPC        XLATE     TUBLNR        TUBLNR
     C                   EVAL      TUBKD      = zhbgetvar('TUBKD')
     C     LO:UPC        XLATE     TUBKD         TUBKD
     C                   EVAL      TUBNV      = zhbgetvar('TUBNV')
     C     LO:UPC        XLATE     TUBNV         TUBNV
     C                   EVAL      WA         = zhbgetvar('TUETD')
     C                   EVAL      TUETD      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUETA')
     C                   EVAL      TUETA      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUATD')
     C                   EVAL      TUATD      = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUATA')
     C                   EVAL      TUATA      = c2n2(WA)
     C                   EVAL      TUCKD1     = zhbgetvar('TUCKD1')
     C                   EVAL      TUCKD2     = zhbgetvar('TUCKD2')
     C                   EVAL      WA         = zhbgetvar('TUPOEN')
     C                   EVAL      TUPOEN     = c2n2(WA)
     C                   EVAL      WA         = zhbgetvar('TUTLM2')
     C                   EVAL      TUTLM2     = c2n2(WA)
     C                   EVAL      TUSTN1     = zhbgetvar('TUSTN1')
     C                   EVAL      TUSTN2     = zhbgetvar('TUSTN2')
     C                   EVAL      TUSTN3     = zhbgetvar('TUSTN3')
     C                   EVAL      TUSTN4     = zhbgetvar('TUSTN4')
     C                   EVAL      TUSTN5     = zhbgetvar('TUSTN5')
     C                   EVAL      TUSTN6     = zhbgetvar('TUSTN6')
     C                   EVAL      TUSTN7     = zhbgetvar('TUSTN7')
     C                   EVAL      TUSTN8     = zhbgetvar('TUSTN8')
     C                   EVAL      TUSTN9     = zhbgetvar('TUSTN9')
     C                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end
OddEv * hent Parametre som går igjen i mange prog:
OddEv *      Odd/Even/Rowhead-farger,Logobilde,Språk,Intern/Ekstern bruker,  mm
OddEvc                   call      'ESGETPAR'
OddEvc                   parm                    BIBRID
OddEvc                   parm                    BIFIRM
OddEvc                   parm                    BIKUNR
OddEvc                   parm                    BIKNG
OddEvc                   parm                    RowHead          10
OddEvc                   parm                    Odd              10
OddEvc                   parm                    Even             10
OddEvc                   parm                    LogoImg          50
OddEvc                   parm                    XSPRÅK            2
OddEvc                   parm                    XINTERN           1
OddEvc                   parm                    ParmDS1        1024
OddEvc                   parm                    ParmDS2        1024
OddEvc                   parm                    ParmDS3        1024
      *
     C     TURKEY        KLIST
     C                   KFLD                    WTUAVD
     C                   KFLD                    WTUPRO
     C     BrParKey      klist
     C                   kfld                    PABRID
     C                   kfld                    PAKUNR
     C                   kfld                    PAID
     C     *LIKE         DEFINE    TUAVD         WTUAVD
     C     *LIKE         DEFINE    TUPRO         WTUPRO
     C                   MOVE      BIBRID        PABRID
     C                   MOVE      *zeros        PAKUNR
      *
     C   50              eval      Error = 'Invalid userID'
     C  N50              OPEN      TURER
     C  N50              OPEN      TURER14
     C  N50              OPEN      TELL
     C  N50              OPEN      TELLRU
     C  N50              OPEN      BRPARF
      * Dummy read for å få feltbeskrivelse
     C  N50
     CAN 50              READ      TURER14

     C                   IF        *IN50=*OFF
     C                   IF        WMODE='A'
     C                   IF        WTUAVD=*ZEROS
     C                   MOVE      'TURPL'       PAID
     C     BrParKey      chain     BRPARF                             33
N03  C  N33              MOVEL     PAVRDA        XTURTYPE          1
     C   33              MOVE      'O'           XTURTYPE
     C                   IF        XTURTYPE = 'O'
     C                   MOVE      'OSAVD'       PAID
     C                   ELSE
     C                   MOVE      'LTAVD'       PAID
     C                   END
     C     BrParKey      CHAIN     BRPARF                             33
     C                   Z-ADD     PAVRDN        WTUAVD
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF

     c                   endsr
      *______________________________________________________
      * TEST                                             TEST
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TEST          BEGSR
     C     WMODE         IFNE      'A'
     C     TURKEY        CHAIN     TURER                              55
     C                   ENDIF
      * MODE A=Add  D=Delete  U=Update
     C                   SELECT
     C     WMODE         WHENEQ    'A'
     C                   eval      Error = *blanks
     C                   EXSR      SRA
     C     WMODE         WHENEQ    'D'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Trip not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRD
     C                   ENDIF
     C     WMODE         WHENEQ    'U'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Trip not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRU
     C                   ENDIF
     C                   OTHER
     C                   eval      Error = 'Wrong mode'
     C                   ENDSL
     C                   ENDSR
      *______________________________________________________
      * Add                                               SRA
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR

     C                   CLEAR                   TURERR

     C                   EVAL      XTUAVD=WTUAVD

     C     XTUAVD        CHAIN     TELL                               33
     C  N33              MOVE      TETURN        XTUPRO
     C  N33              MOVE      TETURN        WTUPRO
     C  N33              ADD       1             TETURN
     C  N33              UPDATE    TELLR
     C     XTUAVD        CHAIN     TELLRU                             34
     C   34AVDZER        CHAIN     TELLRU                             34
     C  N34              MOVE      TERUND        XTURUND
     C  N34              ADD       1             TERUND
     C  N34              UPDATE    TELLRUR

     C                   IF        TUSG=*BLANKS
     C                   EVAL      TUSG='WEB'
     C                   ENDIF
     C                   EVAL      XTUSG=TUSG
     C                   EVAL      TUKNA=BIKUNR
     C                   EVAL      XTUKNA=TUKNA

     C                   WRITE     TURERR
     C                   ENDSR
      *______________________________________________________
      * Delete                                            SRD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C                   DELETE    TURERR
     C                   ENDSR
      *______________________________________________________
      * Update                                            SRU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRU           BEGSR
     C*                  EVAL      XTUST=TUST
     C                   EVAL      XTUDT=TUDT
     C*                  EVAL      XTUKNA=TUKNA
     C*                  EVAL      XTUKNT=TUKNT
     C                   EVAL      XTUNAT=TUNAT
     C*                  EVAL      XTUAD1T=TUAD1T
     C*                  EVAL      XTUAD2T=TUAD2T
     C*                  EVAL      XTUAD3T=TUAD3T
     C                   EVAL      XTUBILN=TUBILN
     C*                  EVAL      XTUTARF=TUTARF
     C                   EVAL      XTULK=TULK
     C*                  EVAL      XTUXXX1=TUXXX1
     C                   EVAL      XTUSDF=TUSDF
     C                   EVAL      XTUSDT=TUSDT
     C*                  EVAL      XTUAO=TUAO
     C*                  EVAL      XTUTS=TUTS
     C*                  EVAL      XTUTVKT=TUTVKT
     C*                  EVAL      XTUTLM=TUTLM
     C*                  EVAL      XTUTM3=TUTM3
     C*                  EVAL      XTULAST=TULAST
     C*                  EVAL      XTUBUSJ=TUBUSJ
     C*                  EVAL      XTUXXX2=TUXXX2
     C*                  EVAL      XTUTST1=TUTST1
     C*                  EVAL      XTUTST2=TUTST2
     C*                  EVAL      XTUTST3=TUTST3
     C*                  EVAL      XTUTST4=TUTST4
     C*                  EVAL      XTUTST5=TUTST5
     C*                  EVAL      XTUAVRE=TUAVRE
     C*                  EVAL      XTUAVNR=TUAVNR
     C*                  EVAL      XTURUND=TURUND
     C                   EVAL      XTURACC=TURACC
     C                   EVAL      XTURAAR=TURAAR
     C                   EVAL      XTURMND=TURMND
N01  C                   EVAL      XTUOPDT=TUOPDT
     C*                  EVAL      XTUTRMA=TUTRMA
     C                   EVAL      XTUHENG=TUHENG
     C                   EVAL      XTULKH=TULKH
     C                   EVAL      XTUCON1=TUCON1
     C                   EVAL      XTULKC1=TULKC1
     C                   EVAL      XTUCON2=TUCON2
     C                   EVAL      XTULKC2=TULKC2
     C                   EVAL      XTUTARA=TUTARA
     C                   EVAL      XTUBILK=TUBILK
     C                   EVAL      XTUKNT2=TUKNT2
     C                   EVAL      XTUSJA1=TUSJA1
     C                   EVAL      XTUSJN1=TUSJN1
     C                   EVAL      XTUSJA2=TUSJA2
     C                   EVAL      XTUSJN2=TUSJN2
     C                   EVAL      XTUSTEF=TUSTEF
     C                   EVAL      XTUSONF=TUSONF
     C                   EVAL      XTUDTT=TUDTT
     C                   EVAL      XTUTM=TUTM
     C                   EVAL      XTUTMT=TUTMT
     C                   EVAL      XTUSTET=TUSTET
     C                   EVAL      XTUSONT=TUSONT
     C*                  EVAL      XTUKVKT=TUKVKT
     C*                  EVAL      XTUKAM3=TUKAM3
     C*                  EVAL      XTUKALM=TUKALM
     C*                  EVAL      XTUTO1A=TUTO1A
     C*                  EVAL      XTUTO1B=TUTO1B
     C                   EVAL      XTUTVAL=TUTVAL
     C                   EVAL      XTUTAKO=TUTAKO
     C                   EVAL      XTUTBEL=TUTBEL
     c                   if        TUTBEL<>0 and TUTAKO = ' '
     C                   EVAL      XTUTAKO='A'
     c                   endif
     C*                  EVAL      XTUTREF=TUTREF
     C*                  EVAL      XTUHØYB=TUHØYB
     C*                  EVAL      XTUHØYH=TUHØYH
     C*                  EVAL      XTUSG=TUSG
     C*                  EVAL      XTUANT1=TUANT1
     C*                  EVAL      XTUENH1=TUENH1
     C*                  EVAL      XTUANT2=TUANT2
     C*                  EVAL      XTUENH2=TUENH2
     C*                  EVAL      XTUKM=TUKM
     C*                  EVAL      XTUBLNR=TUBLNR
     C*                  EVAL      XTUBKD=TUBKD
     C*                  EVAL      XTUBNV=TUBNV
     C*                  EVAL      XTUETD=TUETD
     C*                  EVAL      XTUETA=TUETA
     C*                  EVAL      XTUATD=TUATD
     C*                  EVAL      XTUATA=TUATA
     C*                  EVAL      XTUCKD1=TUCKD1
     C*                  EVAL      XTUCKD2=TUCKD2
     C*                  EVAL      XTUPOEN=TUPOEN
     C*                  EVAL      XTUTLM2=TUTLM2
     C*                  EVAL      XTUSTN1=TUSTN1
     C*                  EVAL      XTUSTN2=TUSTN2
     C*                  EVAL      XTUSTN3=TUSTN3
     C*                  EVAL      XTUSTN4=TUSTN4
     C*                  EVAL      XTUSTN5=TUSTN5
     C*                  EVAL      XTUSTN6=TUSTN6
     C*                  EVAL      XTUSTN7=TUSTN7
     C*                  EVAL      XTUSTN8=TUSTN8
     C*                  EVAL      XTUSTN9=TUSTN9
     C                   UPDATE    TURERR
     C                   ENDSR
